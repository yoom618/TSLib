Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 17.993672609329224
Epoch: 1, Steps: 89 | Train Loss: 0.867 Vali Loss: 0.475 Vali Acc: 0.907 Test Loss: 0.475 Test Acc: 0.907
Validation loss decreased (inf --> -0.907377).  Saving model ...
Epoch: 2 cost time: 17.256359577178955
Epoch: 2, Steps: 89 | Train Loss: 0.645 Vali Loss: 0.746 Vali Acc: 0.888 Test Loss: 0.746 Test Acc: 0.888
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 17.35365056991577
Epoch: 3, Steps: 89 | Train Loss: 0.438 Vali Loss: 0.767 Vali Acc: 0.923 Test Loss: 0.767 Test Acc: 0.923
Validation loss decreased (-0.907377 --> -0.922694).  Saving model ...
Epoch: 4 cost time: 18.3454270362854
Epoch: 4, Steps: 89 | Train Loss: 0.489 Vali Loss: 0.549 Vali Acc: 0.953 Test Loss: 0.549 Test Acc: 0.953
Validation loss decreased (-0.922694 --> -0.952641).  Saving model ...
Epoch: 5 cost time: 18.000117301940918
Epoch: 5, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.838 Vali Acc: 0.933 Test Loss: 0.838 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 18.833216667175293
Epoch: 6, Steps: 89 | Train Loss: 0.510 Vali Loss: 0.529 Vali Acc: 0.970 Test Loss: 0.529 Test Acc: 0.970
Validation loss decreased (-0.952641 --> -0.970050).  Saving model ...
Epoch: 7 cost time: 17.503763914108276
Epoch: 7, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.806 Vali Acc: 0.939 Test Loss: 0.806 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 19.05503487586975
Epoch: 8, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.671 Vali Acc: 0.969 Test Loss: 0.671 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 20.06986713409424
Epoch: 9, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.900 Vali Acc: 0.944 Test Loss: 0.900 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 18.175901651382446
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.798 Vali Acc: 0.953 Test Loss: 0.798 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 18.259313821792603
Epoch: 11, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.119 Vali Acc: 0.945 Test Loss: 1.119 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 17.976444244384766
Epoch: 12, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.989 Vali Acc: 0.944 Test Loss: 0.989 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 12.953600645065308
Epoch: 13, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.696 Vali Acc: 0.967 Test Loss: 0.696 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 18.07518458366394
Epoch: 14, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.703 Vali Acc: 0.971 Test Loss: 0.703 Test Acc: 0.971
Validation loss decreased (-0.970050 --> -0.970745).  Saving model ...
Epoch: 15 cost time: 15.56190824508667
Epoch: 15, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.108 Vali Acc: 0.960 Test Loss: 1.108 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 13.858376264572144
Epoch: 16, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.895 Vali Acc: 0.966 Test Loss: 0.895 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 13.86392092704773
Epoch: 17, Steps: 89 | Train Loss: 0.252 Vali Loss: 1.686 Vali Acc: 0.930 Test Loss: 1.686 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 12.317070007324219
Epoch: 18, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.852 Vali Acc: 0.971 Test Loss: 0.852 Test Acc: 0.971
Validation loss decreased (-0.970745 --> -0.971440).  Saving model ...
Epoch: 19 cost time: 13.594602346420288
Epoch: 19, Steps: 89 | Train Loss: 0.146 Vali Loss: 1.032 Vali Acc: 0.958 Test Loss: 1.032 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 12.668037176132202
Epoch: 20, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.923 Vali Acc: 0.973 Test Loss: 0.923 Test Acc: 0.973
Validation loss decreased (-0.971440 --> -0.972832).  Saving model ...
Epoch: 21 cost time: 12.604833364486694
Epoch: 21, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.991 Vali Acc: 0.969 Test Loss: 0.991 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 13.83483338356018
Epoch: 22, Steps: 89 | Train Loss: 0.154 Vali Loss: 1.359 Vali Acc: 0.953 Test Loss: 1.359 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 12.396244049072266
Epoch: 23, Steps: 89 | Train Loss: 0.331 Vali Loss: 1.179 Vali Acc: 0.961 Test Loss: 1.179 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 13.668492317199707
Epoch: 24, Steps: 89 | Train Loss: 0.297 Vali Loss: 0.818 Vali Acc: 0.971 Test Loss: 0.818 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 11.35584807395935
Epoch: 25, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.872 Vali Acc: 0.968 Test Loss: 0.872 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 12.196530103683472
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.942 Vali Acc: 0.967 Test Loss: 0.942 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 11.96461534500122
Epoch: 27, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.329 Vali Acc: 0.950 Test Loss: 1.329 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 11.421724796295166
Epoch: 28, Steps: 89 | Train Loss: 0.109 Vali Loss: 1.133 Vali Acc: 0.966 Test Loss: 1.133 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 12.039790630340576
Epoch: 29, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.937 Vali Acc: 0.965 Test Loss: 0.937 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 12.122746706008911
Epoch: 30, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.909 Vali Acc: 0.974 Test Loss: 0.909 Test Acc: 0.974
Validation loss decreased (-0.972832 --> -0.973529).  Saving model ...
Epoch: 31 cost time: 10.671682596206665
Epoch: 31, Steps: 89 | Train Loss: 0.078 Vali Loss: 1.131 Vali Acc: 0.958 Test Loss: 1.131 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 11.6483633518219
Epoch: 32, Steps: 89 | Train Loss: 0.170 Vali Loss: 1.677 Vali Acc: 0.945 Test Loss: 1.677 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 7.4040772914886475
Epoch: 33, Steps: 89 | Train Loss: 0.355 Vali Loss: 1.742 Vali Acc: 0.932 Test Loss: 1.742 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 10.707366943359375
Epoch: 34, Steps: 89 | Train Loss: 0.056 Vali Loss: 1.019 Vali Acc: 0.967 Test Loss: 1.019 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 11.330376625061035
Epoch: 35, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.958 Vali Acc: 0.973 Test Loss: 0.958 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 10.487576484680176
Epoch: 36, Steps: 89 | Train Loss: 0.093 Vali Loss: 1.090 Vali Acc: 0.964 Test Loss: 1.090 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 11.077390670776367
Epoch: 37, Steps: 89 | Train Loss: 0.110 Vali Loss: 1.256 Vali Acc: 0.960 Test Loss: 1.256 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 10.667057991027832
Epoch: 38, Steps: 89 | Train Loss: 0.113 Vali Loss: 1.928 Vali Acc: 0.945 Test Loss: 1.928 Test Acc: 0.945
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 10.404167652130127
Epoch: 39, Steps: 89 | Train Loss: 0.083 Vali Loss: 1.229 Vali Acc: 0.974 Test Loss: 1.229 Test Acc: 0.974
Validation loss decreased (-0.973529 --> -0.974222).  Saving model ...
Epoch: 40 cost time: 9.700684070587158
Epoch: 40, Steps: 89 | Train Loss: 0.047 Vali Loss: 1.667 Vali Acc: 0.951 Test Loss: 1.667 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 9.730066061019897
Epoch: 41, Steps: 89 | Train Loss: 0.046 Vali Loss: 1.559 Vali Acc: 0.949 Test Loss: 1.559 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 7.644696950912476
Epoch: 42, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.117 Vali Acc: 0.962 Test Loss: 1.117 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 10.343534469604492
Epoch: 43, Steps: 89 | Train Loss: 0.063 Vali Loss: 1.666 Vali Acc: 0.945 Test Loss: 1.666 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 11.133420705795288
Epoch: 44, Steps: 89 | Train Loss: 0.121 Vali Loss: 1.595 Vali Acc: 0.962 Test Loss: 1.595 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 11.095540761947632
Epoch: 45, Steps: 89 | Train Loss: 0.136 Vali Loss: 1.914 Vali Acc: 0.954 Test Loss: 1.914 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 10.687924146652222
Epoch: 46, Steps: 89 | Train Loss: 0.096 Vali Loss: 1.433 Vali Acc: 0.960 Test Loss: 1.433 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 8.109897136688232
Epoch: 47, Steps: 89 | Train Loss: 0.164 Vali Loss: 1.522 Vali Acc: 0.954 Test Loss: 1.522 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 10.216253995895386
Epoch: 48, Steps: 89 | Train Loss: 0.042 Vali Loss: 1.533 Vali Acc: 0.953 Test Loss: 1.533 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 10.78153371810913
Epoch: 49, Steps: 89 | Train Loss: 0.058 Vali Loss: 2.016 Vali Acc: 0.944 Test Loss: 2.016 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 7127628
model size : 36.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.75830340385437
Epoch: 1, Steps: 89 | Train Loss: 0.852 Vali Loss: 0.539 Vali Acc: 0.880 Test Loss: 0.539 Test Acc: 0.880
Validation loss decreased (inf --> -0.880217).  Saving model ...
Epoch: 2 cost time: 8.843615770339966
Epoch: 2, Steps: 89 | Train Loss: 0.626 Vali Loss: 0.481 Vali Acc: 0.926 Test Loss: 0.481 Test Acc: 0.926
Validation loss decreased (-0.880217 --> -0.926179).  Saving model ...
Epoch: 3 cost time: 9.22566819190979
Epoch: 3, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.650 Vali Acc: 0.916 Test Loss: 0.650 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.076228618621826
Epoch: 4, Steps: 89 | Train Loss: 0.449 Vali Loss: 0.821 Vali Acc: 0.914 Test Loss: 0.821 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.846429109573364
Epoch: 5, Steps: 89 | Train Loss: 0.445 Vali Loss: 0.627 Vali Acc: 0.955 Test Loss: 0.627 Test Acc: 0.955
Validation loss decreased (-0.926179 --> -0.955425).  Saving model ...
Epoch: 6 cost time: 7.603510856628418
Epoch: 6, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.555 Vali Acc: 0.959 Test Loss: 0.555 Test Acc: 0.959
Validation loss decreased (-0.955425 --> -0.958908).  Saving model ...
Epoch: 7 cost time: 9.69694972038269
Epoch: 7, Steps: 89 | Train Loss: 0.258 Vali Loss: 1.081 Vali Acc: 0.928 Test Loss: 1.081 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.268064260482788
Epoch: 8, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.492 Vali Acc: 0.970 Test Loss: 0.492 Test Acc: 0.970
Validation loss decreased (-0.958908 --> -0.970051).  Saving model ...
Epoch: 9 cost time: 9.153806924819946
Epoch: 9, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.015 Vali Acc: 0.941 Test Loss: 1.015 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.634590864181519
Epoch: 10, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.553 Vali Acc: 0.971 Test Loss: 0.553 Test Acc: 0.971
Validation loss decreased (-0.970051 --> -0.970747).  Saving model ...
Epoch: 11 cost time: 9.046969175338745
Epoch: 11, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.726 Vali Acc: 0.960 Test Loss: 0.726 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.362218856811523
Epoch: 12, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.502 Vali Acc: 0.976 Test Loss: 0.502 Test Acc: 0.976
Validation loss decreased (-0.970747 --> -0.975622).  Saving model ...
Epoch: 13 cost time: 10.383982181549072
Epoch: 13, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.964 Vali Acc: 0.947 Test Loss: 0.964 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.769760370254517
Epoch: 14, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.649 Vali Acc: 0.964 Test Loss: 0.649 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.59747052192688
Epoch: 15, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.866 Vali Acc: 0.961 Test Loss: 0.866 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 10.589908361434937
Epoch: 16, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.700 Vali Acc: 0.973 Test Loss: 0.700 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.408303499221802
Epoch: 17, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.975 Vali Acc: 0.964 Test Loss: 0.975 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.987186431884766
Epoch: 18, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.897 Vali Acc: 0.969 Test Loss: 0.897 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 10.876296043395996
Epoch: 19, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.901 Vali Acc: 0.964 Test Loss: 0.901 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 10.479424476623535
Epoch: 20, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.968 Vali Acc: 0.970 Test Loss: 0.968 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.692323923110962
Epoch: 21, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.860 Vali Acc: 0.966 Test Loss: 0.860 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.576611042022705
Epoch: 22, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.698 Vali Acc: 0.973 Test Loss: 0.698 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 7127628
model size : 36.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.561280012130737
Epoch: 1, Steps: 89 | Train Loss: 0.840 Vali Loss: 0.538 Vali Acc: 0.867 Test Loss: 0.538 Test Acc: 0.867
Validation loss decreased (inf --> -0.866986).  Saving model ...
Epoch: 2 cost time: 7.431865453720093
Epoch: 2, Steps: 89 | Train Loss: 0.459 Vali Loss: 0.423 Vali Acc: 0.926 Test Loss: 0.423 Test Acc: 0.926
Validation loss decreased (-0.866986 --> -0.926180).  Saving model ...
Epoch: 3 cost time: 10.580915689468384
Epoch: 3, Steps: 89 | Train Loss: 0.349 Vali Loss: 0.721 Vali Acc: 0.910 Test Loss: 0.721 Test Acc: 0.910
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.578177690505981
Epoch: 4, Steps: 89 | Train Loss: 0.310 Vali Loss: 1.018 Vali Acc: 0.909 Test Loss: 1.018 Test Acc: 0.909
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.462441682815552
Epoch: 5, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.939 Vali Acc: 0.912 Test Loss: 0.939 Test Acc: 0.912
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 10.6048104763031
Epoch: 6, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.507 Vali Acc: 0.959 Test Loss: 0.507 Test Acc: 0.959
Validation loss decreased (-0.926180 --> -0.958909).  Saving model ...
Epoch: 7 cost time: 10.579958438873291
Epoch: 7, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.576 Vali Acc: 0.949 Test Loss: 0.576 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.491657495498657
Epoch: 8, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.758 Vali Acc: 0.960 Test Loss: 0.758 Test Acc: 0.960
Validation loss decreased (-0.958909 --> -0.959602).  Saving model ...
Epoch: 9 cost time: 9.95041799545288
Epoch: 9, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.691 Vali Acc: 0.956 Test Loss: 0.691 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 10.685539245605469
Epoch: 10, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.723 Vali Acc: 0.965 Test Loss: 0.723 Test Acc: 0.965
Validation loss decreased (-0.959602 --> -0.965174).  Saving model ...
Epoch: 11 cost time: 11.204678773880005
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.669 Vali Acc: 0.964 Test Loss: 0.669 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 11.862433195114136
Epoch: 12, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.458 Vali Acc: 0.974 Test Loss: 0.458 Test Acc: 0.974
Validation loss decreased (-0.965174 --> -0.974229).  Saving model ...
Epoch: 13 cost time: 11.045623540878296
Epoch: 13, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.850 Vali Acc: 0.963 Test Loss: 0.850 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.590521812438965
Epoch: 14, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.596 Vali Acc: 0.965 Test Loss: 0.596 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 10.054998397827148
Epoch: 15, Steps: 89 | Train Loss: 0.148 Vali Loss: 1.006 Vali Acc: 0.953 Test Loss: 1.006 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.87789273262024
Epoch: 16, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.706 Vali Acc: 0.970 Test Loss: 0.706 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 10.678795337677002
Epoch: 17, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.601 Vali Acc: 0.972 Test Loss: 0.601 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 10.160982608795166
Epoch: 18, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.532 Vali Acc: 0.977 Test Loss: 0.532 Test Acc: 0.977
Validation loss decreased (-0.974229 --> -0.977014).  Saving model ...
Epoch: 19 cost time: 10.099445104598999
Epoch: 19, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.714 Vali Acc: 0.964 Test Loss: 0.714 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 9.221392154693604
Epoch: 20, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.715 Vali Acc: 0.969 Test Loss: 0.715 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.914189100265503
Epoch: 21, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.779 Vali Acc: 0.971 Test Loss: 0.779 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 10.603854179382324
Epoch: 22, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.679 Vali Acc: 0.969 Test Loss: 0.679 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 10.290991306304932
Epoch: 23, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.782 Vali Acc: 0.963 Test Loss: 0.782 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 10.56369137763977
Epoch: 24, Steps: 89 | Train Loss: 0.167 Vali Loss: 1.140 Vali Acc: 0.960 Test Loss: 1.140 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 10.160566806793213
Epoch: 25, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.943 Vali Acc: 0.967 Test Loss: 0.943 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 7.949742078781128
Epoch: 26, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.735 Vali Acc: 0.972 Test Loss: 0.735 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 11.350905895233154
Epoch: 27, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.767 Vali Acc: 0.969 Test Loss: 0.767 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 10.768280982971191
Epoch: 28, Steps: 89 | Train Loss: 0.096 Vali Loss: 1.344 Vali Acc: 0.949 Test Loss: 1.344 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 7127628
model size : 36.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.840277433395386
Epoch: 1, Steps: 89 | Train Loss: 0.768 Vali Loss: 0.347 Vali Acc: 0.918 Test Loss: 0.347 Test Acc: 0.918
Validation loss decreased (inf --> -0.917824).  Saving model ...
Epoch: 2 cost time: 10.111980438232422
Epoch: 2, Steps: 89 | Train Loss: 0.378 Vali Loss: 0.341 Vali Acc: 0.926 Test Loss: 0.341 Test Acc: 0.926
Validation loss decreased (-0.917824 --> -0.926180).  Saving model ...
Epoch: 3 cost time: 10.383022785186768
Epoch: 3, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.762 Vali Acc: 0.889 Test Loss: 0.762 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 10.79297399520874
Epoch: 4, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.843 Vali Acc: 0.934 Test Loss: 0.843 Test Acc: 0.934
Validation loss decreased (-0.926180 --> -0.933836).  Saving model ...
Epoch: 5 cost time: 10.581021785736084
Epoch: 5, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.715 Vali Acc: 0.928 Test Loss: 0.715 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.749888896942139
Epoch: 6, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.445 Vali Acc: 0.949 Test Loss: 0.445 Test Acc: 0.949
Validation loss decreased (-0.933836 --> -0.949160).  Saving model ...
Epoch: 7 cost time: 9.856267213821411
Epoch: 7, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.543 Vali Acc: 0.943 Test Loss: 0.543 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.51444149017334
Epoch: 8, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.698 Vali Acc: 0.957 Test Loss: 0.698 Test Acc: 0.957
Validation loss decreased (-0.949160 --> -0.956818).  Saving model ...
Epoch: 9 cost time: 9.604882955551147
Epoch: 9, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.252 Vali Acc: 0.978 Test Loss: 0.252 Test Acc: 0.978
Validation loss decreased (-0.956818 --> -0.977713).  Saving model ...
Epoch: 10 cost time: 9.43087887763977
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.376 Vali Acc: 0.961 Test Loss: 0.376 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.323745965957642
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.420 Vali Acc: 0.971 Test Loss: 0.420 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.644285917282104
Epoch: 12, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.561 Vali Acc: 0.964 Test Loss: 0.561 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.289437532424927
Epoch: 13, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.311 Vali Acc: 0.980 Test Loss: 0.311 Test Acc: 0.980
Validation loss decreased (-0.977713 --> -0.979802).  Saving model ...
Epoch: 14 cost time: 8.107685804367065
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.441 Vali Acc: 0.975 Test Loss: 0.441 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.3424813747406
Epoch: 15, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.488 Vali Acc: 0.971 Test Loss: 0.488 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.72469425201416
Epoch: 16, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.718 Vali Acc: 0.962 Test Loss: 0.718 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.697891473770142
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.847 Vali Acc: 0.963 Test Loss: 0.847 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.452818870544434
Epoch: 18, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.483 Vali Acc: 0.978 Test Loss: 0.483 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.578682661056519
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.646 Vali Acc: 0.965 Test Loss: 0.646 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.309178829193115
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.696 Vali Acc: 0.964 Test Loss: 0.696 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.167691469192505
Epoch: 21, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.645 Vali Acc: 0.966 Test Loss: 0.645 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.64991569519043
Epoch: 22, Steps: 89 | Train Loss: 0.144 Vali Loss: 1.201 Vali Acc: 0.944 Test Loss: 1.201 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.69216251373291
Epoch: 23, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.800 Vali Acc: 0.970 Test Loss: 0.800 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 7127628
model size : 36.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.721889972686768
Epoch: 1, Steps: 89 | Train Loss: 0.939 Vali Loss: 0.356 Vali Acc: 0.924 Test Loss: 0.356 Test Acc: 0.924
Validation loss decreased (inf --> -0.924091).  Saving model ...
Epoch: 2 cost time: 10.042852878570557
Epoch: 2, Steps: 89 | Train Loss: 0.561 Vali Loss: 0.760 Vali Acc: 0.877 Test Loss: 0.760 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 10.201453685760498
Epoch: 3, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.680 Vali Acc: 0.919 Test Loss: 0.680 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 9.593697309494019
Epoch: 4, Steps: 89 | Train Loss: 0.456 Vali Loss: 1.169 Vali Acc: 0.914 Test Loss: 1.169 Test Acc: 0.914
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 10.428953170776367
Epoch: 5, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.614 Vali Acc: 0.940 Test Loss: 0.614 Test Acc: 0.940
Validation loss decreased (-0.924091 --> -0.940105).  Saving model ...
Epoch: 6 cost time: 8.603939771652222
Epoch: 6, Steps: 89 | Train Loss: 0.376 Vali Loss: 1.087 Vali Acc: 0.937 Test Loss: 1.087 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.145286321640015
Epoch: 7, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.861 Vali Acc: 0.939 Test Loss: 0.861 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 9.5549476146698
Epoch: 8, Steps: 89 | Train Loss: 0.403 Vali Loss: 0.750 Vali Acc: 0.951 Test Loss: 0.750 Test Acc: 0.951
Validation loss decreased (-0.940105 --> -0.950550).  Saving model ...
Epoch: 9 cost time: 9.712318897247314
Epoch: 9, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.669 Vali Acc: 0.967 Test Loss: 0.669 Test Acc: 0.967
Validation loss decreased (-0.950550 --> -0.967264).  Saving model ...
Epoch: 10 cost time: 10.365529537200928
Epoch: 10, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.740 Vali Acc: 0.971 Test Loss: 0.740 Test Acc: 0.971
Validation loss decreased (-0.967264 --> -0.970745).  Saving model ...
Epoch: 11 cost time: 10.162925004959106
Epoch: 11, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.665 Vali Acc: 0.964 Test Loss: 0.665 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 9.874836683273315
Epoch: 12, Steps: 89 | Train Loss: 0.281 Vali Loss: 1.194 Vali Acc: 0.946 Test Loss: 1.194 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.881834030151367
Epoch: 13, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.707 Vali Acc: 0.966 Test Loss: 0.707 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.303766250610352
Epoch: 14, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.785 Vali Acc: 0.971 Test Loss: 0.785 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.356265544891357
Epoch: 15, Steps: 89 | Train Loss: 0.248 Vali Loss: 1.056 Vali Acc: 0.960 Test Loss: 1.056 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.322324514389038
Epoch: 16, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.724 Vali Acc: 0.968 Test Loss: 0.724 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.918562650680542
Epoch: 17, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.726 Vali Acc: 0.970 Test Loss: 0.726 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.30030608177185
Epoch: 18, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.085 Vali Acc: 0.952 Test Loss: 1.085 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 10.234827041625977
Epoch: 19, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.810 Vali Acc: 0.973 Test Loss: 0.810 Test Acc: 0.973
Validation loss decreased (-0.970745 --> -0.972833).  Saving model ...
Epoch: 20 cost time: 7.625743627548218
Epoch: 20, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.902 Vali Acc: 0.971 Test Loss: 0.902 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 9.397890090942383
Epoch: 21, Steps: 89 | Train Loss: 0.124 Vali Loss: 1.398 Vali Acc: 0.945 Test Loss: 1.398 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 9.253164768218994
Epoch: 22, Steps: 89 | Train Loss: 0.130 Vali Loss: 1.239 Vali Acc: 0.962 Test Loss: 1.239 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 9.628313779830933
Epoch: 23, Steps: 89 | Train Loss: 0.287 Vali Loss: 1.262 Vali Acc: 0.951 Test Loss: 1.262 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.4006874561309814
Epoch: 24, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.713 Vali Acc: 0.977 Test Loss: 0.713 Test Acc: 0.977
Validation loss decreased (-0.972833 --> -0.977012).  Saving model ...
Epoch: 25 cost time: 9.842740297317505
Epoch: 25, Steps: 89 | Train Loss: 0.065 Vali Loss: 1.075 Vali Acc: 0.958 Test Loss: 1.075 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 10.417148113250732
Epoch: 26, Steps: 89 | Train Loss: 0.081 Vali Loss: 1.323 Vali Acc: 0.964 Test Loss: 1.323 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.976990461349487
Epoch: 27, Steps: 89 | Train Loss: 0.094 Vali Loss: 1.616 Vali Acc: 0.953 Test Loss: 1.616 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 10.487720251083374
Epoch: 28, Steps: 89 | Train Loss: 0.087 Vali Loss: 1.230 Vali Acc: 0.959 Test Loss: 1.230 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 10.159123420715332
Epoch: 29, Steps: 89 | Train Loss: 0.202 Vali Loss: 1.058 Vali Acc: 0.967 Test Loss: 1.058 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.494555950164795
Epoch: 30, Steps: 89 | Train Loss: 0.114 Vali Loss: 1.415 Vali Acc: 0.940 Test Loss: 1.415 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 10.050077438354492
Epoch: 31, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.432 Vali Acc: 0.943 Test Loss: 1.432 Test Acc: 0.943
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 10.178711891174316
Epoch: 32, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.320 Vali Acc: 0.958 Test Loss: 1.320 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 10.3254234790802
Epoch: 33, Steps: 89 | Train Loss: 0.163 Vali Loss: 1.308 Vali Acc: 0.961 Test Loss: 1.308 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 10.186311960220337
Epoch: 34, Steps: 89 | Train Loss: 0.058 Vali Loss: 1.324 Vali Acc: 0.955 Test Loss: 1.324 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 5030476
model size : 28.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.938252210617065
Epoch: 1, Steps: 89 | Train Loss: 0.928 Vali Loss: 0.373 Vali Acc: 0.924 Test Loss: 0.373 Test Acc: 0.924
Validation loss decreased (inf --> -0.924091).  Saving model ...
Epoch: 2 cost time: 9.106537103652954
Epoch: 2, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.528 Vali Acc: 0.907 Test Loss: 0.528 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.971835851669312
Epoch: 3, Steps: 89 | Train Loss: 0.488 Vali Loss: 0.481 Vali Acc: 0.949 Test Loss: 0.481 Test Acc: 0.949
Validation loss decreased (-0.924091 --> -0.949160).  Saving model ...
Epoch: 4 cost time: 9.22480583190918
Epoch: 4, Steps: 89 | Train Loss: 0.397 Vali Loss: 0.955 Vali Acc: 0.918 Test Loss: 0.955 Test Acc: 0.918
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.86717438697815
Epoch: 5, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.786 Vali Acc: 0.929 Test Loss: 0.786 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.060027599334717
Epoch: 6, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.473 Vali Acc: 0.962 Test Loss: 0.473 Test Acc: 0.962
Validation loss decreased (-0.949160 --> -0.962391).  Saving model ...
Epoch: 7 cost time: 9.957785606384277
Epoch: 7, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.656 Vali Acc: 0.954 Test Loss: 0.656 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.719882726669312
Epoch: 8, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.396 Vali Acc: 0.918 Test Loss: 1.396 Test Acc: 0.918
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.730568647384644
Epoch: 9, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.548 Vali Acc: 0.969 Test Loss: 0.548 Test Acc: 0.969
Validation loss decreased (-0.962391 --> -0.968657).  Saving model ...
Epoch: 10 cost time: 7.184057712554932
Epoch: 10, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.952 Vali Acc: 0.946 Test Loss: 0.952 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.988847970962524
Epoch: 11, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.704 Vali Acc: 0.961 Test Loss: 0.704 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.869694948196411
Epoch: 12, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.681 Vali Acc: 0.975 Test Loss: 0.681 Test Acc: 0.975
Validation loss decreased (-0.968657 --> -0.974924).  Saving model ...
Epoch: 13 cost time: 9.392111778259277
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.686 Vali Acc: 0.971 Test Loss: 0.686 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 9.475349426269531
Epoch: 14, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.677 Vali Acc: 0.975 Test Loss: 0.677 Test Acc: 0.975
Validation loss decreased (-0.974924 --> -0.974924).  Saving model ...
Epoch: 15 cost time: 8.788286685943604
Epoch: 15, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.569 Vali Acc: 0.980 Test Loss: 0.569 Test Acc: 0.980
Validation loss decreased (-0.974924 --> -0.979799).  Saving model ...
Epoch: 16 cost time: 9.412338972091675
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.936 Vali Acc: 0.959 Test Loss: 0.936 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 9.313148021697998
Epoch: 17, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.026 Vali Acc: 0.962 Test Loss: 1.026 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.629610776901245
Epoch: 18, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.652 Vali Acc: 0.981 Test Loss: 0.652 Test Acc: 0.981
Validation loss decreased (-0.979799 --> -0.981191).  Saving model ...
Epoch: 19 cost time: 10.582844972610474
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.670 Vali Acc: 0.976 Test Loss: 0.670 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 10.43533706665039
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.752 Vali Acc: 0.976 Test Loss: 0.752 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 9.154906749725342
Epoch: 21, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.871 Vali Acc: 0.967 Test Loss: 0.871 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 9.668938159942627
Epoch: 22, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.750 Vali Acc: 0.970 Test Loss: 0.750 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 9.724729776382446
Epoch: 23, Steps: 89 | Train Loss: 0.283 Vali Loss: 1.029 Vali Acc: 0.968 Test Loss: 1.029 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 8.876476526260376
Epoch: 24, Steps: 89 | Train Loss: 0.473 Vali Loss: 0.661 Vali Acc: 0.978 Test Loss: 0.661 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 9.772260665893555
Epoch: 25, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.832 Vali Acc: 0.969 Test Loss: 0.832 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 9.7499098777771
Epoch: 26, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.704 Vali Acc: 0.973 Test Loss: 0.704 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 7.9271461963653564
Epoch: 27, Steps: 89 | Train Loss: 0.051 Vali Loss: 1.076 Vali Acc: 0.958 Test Loss: 1.076 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 9.6218421459198
Epoch: 28, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.718 Vali Acc: 0.979 Test Loss: 0.718 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 5030476
model size : 28.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.458111763000488
Epoch: 1, Steps: 89 | Train Loss: 0.899 Vali Loss: 0.307 Vali Acc: 0.927 Test Loss: 0.307 Test Acc: 0.927
Validation loss decreased (inf --> -0.926877).  Saving model ...
Epoch: 2 cost time: 9.118222713470459
Epoch: 2, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.442 Vali Acc: 0.925 Test Loss: 0.442 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 8.337806224822998
Epoch: 3, Steps: 89 | Train Loss: 0.429 Vali Loss: 0.455 Vali Acc: 0.951 Test Loss: 0.455 Test Acc: 0.951
Validation loss decreased (-0.926877 --> -0.950553).  Saving model ...
Epoch: 4 cost time: 8.242666482925415
Epoch: 4, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.532 Vali Acc: 0.945 Test Loss: 0.532 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.717084646224976
Epoch: 5, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.670 Vali Acc: 0.948 Test Loss: 0.670 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.392807483673096
Epoch: 6, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.560 Vali Acc: 0.953 Test Loss: 0.560 Test Acc: 0.953
Validation loss decreased (-0.950553 --> -0.952641).  Saving model ...
Epoch: 7 cost time: 8.020359516143799
Epoch: 7, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.589 Vali Acc: 0.962 Test Loss: 0.589 Test Acc: 0.962
Validation loss decreased (-0.952641 --> -0.961693).  Saving model ...
Epoch: 8 cost time: 7.908431768417358
Epoch: 8, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.982 Vali Acc: 0.928 Test Loss: 0.982 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.246923446655273
Epoch: 9, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.632 Vali Acc: 0.958 Test Loss: 0.632 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.64956283569336
Epoch: 10, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.744 Vali Acc: 0.958 Test Loss: 0.744 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.240453481674194
Epoch: 11, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.735 Vali Acc: 0.966 Test Loss: 0.735 Test Acc: 0.966
Validation loss decreased (-0.961693 --> -0.965870).  Saving model ...
Epoch: 12 cost time: 8.264261245727539
Epoch: 12, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.587 Vali Acc: 0.971 Test Loss: 0.587 Test Acc: 0.971
Validation loss decreased (-0.965870 --> -0.971443).  Saving model ...
Epoch: 13 cost time: 8.701005220413208
Epoch: 13, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.785 Vali Acc: 0.967 Test Loss: 0.785 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.247019052505493
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.897 Vali Acc: 0.955 Test Loss: 0.897 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.34126329421997
Epoch: 15, Steps: 89 | Train Loss: 0.085 Vali Loss: 1.244 Vali Acc: 0.953 Test Loss: 1.244 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.204857349395752
Epoch: 16, Steps: 89 | Train Loss: 0.185 Vali Loss: 1.031 Vali Acc: 0.949 Test Loss: 1.031 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.59382700920105
Epoch: 17, Steps: 89 | Train Loss: 0.092 Vali Loss: 1.093 Vali Acc: 0.948 Test Loss: 1.093 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.546386957168579
Epoch: 18, Steps: 89 | Train Loss: 0.230 Vali Loss: 1.253 Vali Acc: 0.953 Test Loss: 1.253 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 6.808383941650391
Epoch: 19, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.687 Vali Acc: 0.970 Test Loss: 0.687 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.606616497039795
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.645 Vali Acc: 0.971 Test Loss: 0.645 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.135864973068237
Epoch: 21, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.736 Vali Acc: 0.968 Test Loss: 0.736 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.208519458770752
Epoch: 22, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.710 Vali Acc: 0.964 Test Loss: 0.710 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 5030476
model size : 28.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.746512174606323
Epoch: 1, Steps: 89 | Train Loss: 0.829 Vali Loss: 0.341 Vali Acc: 0.915 Test Loss: 0.341 Test Acc: 0.915
Validation loss decreased (inf --> -0.915038).  Saving model ...
Epoch: 2 cost time: 8.351193189620972
Epoch: 2, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.300 Vali Acc: 0.947 Test Loss: 0.300 Test Acc: 0.947
Validation loss decreased (-0.915038 --> -0.947072).  Saving model ...
Epoch: 3 cost time: 8.88537859916687
Epoch: 3, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.454 Vali Acc: 0.948 Test Loss: 0.454 Test Acc: 0.948
Validation loss decreased (-0.947072 --> -0.948463).  Saving model ...
Epoch: 4 cost time: 8.286155939102173
Epoch: 4, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.388 Vali Acc: 0.951 Test Loss: 0.388 Test Acc: 0.951
Validation loss decreased (-0.948463 --> -0.950553).  Saving model ...
Epoch: 5 cost time: 7.5721657276153564
Epoch: 5, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.416 Vali Acc: 0.962 Test Loss: 0.416 Test Acc: 0.962
Validation loss decreased (-0.950553 --> -0.961695).  Saving model ...
Epoch: 6 cost time: 8.576953887939453
Epoch: 6, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.567 Vali Acc: 0.941 Test Loss: 0.567 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.145355939865112
Epoch: 7, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.314 Vali Acc: 0.962 Test Loss: 0.314 Test Acc: 0.962
Validation loss decreased (-0.961695 --> -0.961696).  Saving model ...
Epoch: 8 cost time: 7.611925840377808
Epoch: 8, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.836 Vali Acc: 0.942 Test Loss: 0.836 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.489867687225342
Epoch: 9, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.439 Vali Acc: 0.964 Test Loss: 0.439 Test Acc: 0.964
Validation loss decreased (-0.961696 --> -0.963784).  Saving model ...
Epoch: 10 cost time: 8.275861740112305
Epoch: 10, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.442 Vali Acc: 0.964 Test Loss: 0.442 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.071676254272461
Epoch: 11, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.500 Vali Acc: 0.959 Test Loss: 0.500 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 7.975326776504517
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.390 Vali Acc: 0.974 Test Loss: 0.390 Test Acc: 0.974
Validation loss decreased (-0.963784 --> -0.973534).  Saving model ...
Epoch: 13 cost time: 7.330004692077637
Epoch: 13, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.532 Vali Acc: 0.961 Test Loss: 0.532 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.450283527374268
Epoch: 14, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.510 Vali Acc: 0.969 Test Loss: 0.510 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.35493016242981
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.618 Vali Acc: 0.947 Test Loss: 0.618 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.305124998092651
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.760 Vali Acc: 0.958 Test Loss: 0.760 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.792889356613159
Epoch: 17, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.602 Vali Acc: 0.966 Test Loss: 0.602 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.23443078994751
Epoch: 18, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.565 Vali Acc: 0.969 Test Loss: 0.565 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.249645233154297
Epoch: 19, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.605 Vali Acc: 0.964 Test Loss: 0.605 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 9.715403318405151
Epoch: 20, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.542 Vali Acc: 0.973 Test Loss: 0.542 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.394457101821899
Epoch: 21, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.592 Vali Acc: 0.967 Test Loss: 0.592 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.163371562957764
Epoch: 22, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.832 Vali Acc: 0.951 Test Loss: 0.832 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 5030476
model size : 28.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.624621152877808
Epoch: 1, Steps: 89 | Train Loss: 0.914 Vali Loss: 0.561 Vali Acc: 0.879 Test Loss: 0.561 Test Acc: 0.879
Validation loss decreased (inf --> -0.878824).  Saving model ...
Epoch: 2 cost time: 8.993143796920776
Epoch: 2, Steps: 89 | Train Loss: 0.670 Vali Loss: 0.635 Vali Acc: 0.907 Test Loss: 0.635 Test Acc: 0.907
Validation loss decreased (-0.878824 --> -0.906679).  Saving model ...
Epoch: 3 cost time: 9.604694604873657
Epoch: 3, Steps: 89 | Train Loss: 0.559 Vali Loss: 0.802 Vali Acc: 0.919 Test Loss: 0.802 Test Acc: 0.919
Validation loss decreased (-0.906679 --> -0.918516).  Saving model ...
Epoch: 4 cost time: 9.705023527145386
Epoch: 4, Steps: 89 | Train Loss: 0.466 Vali Loss: 0.960 Vali Acc: 0.927 Test Loss: 0.960 Test Acc: 0.927
Validation loss decreased (-0.918516 --> -0.926871).  Saving model ...
Epoch: 5 cost time: 9.49006986618042
Epoch: 5, Steps: 89 | Train Loss: 0.490 Vali Loss: 0.699 Vali Acc: 0.930 Test Loss: 0.699 Test Acc: 0.930
Validation loss decreased (-0.926871 --> -0.930355).  Saving model ...
Epoch: 6 cost time: 8.688819408416748
Epoch: 6, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.464 Vali Acc: 0.964 Test Loss: 0.464 Test Acc: 0.964
Validation loss decreased (-0.930355 --> -0.963784).  Saving model ...
Epoch: 7 cost time: 9.54432225227356
Epoch: 7, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.835 Vali Acc: 0.938 Test Loss: 0.835 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 9.703800916671753
Epoch: 8, Steps: 89 | Train Loss: 0.365 Vali Loss: 0.751 Vali Acc: 0.953 Test Loss: 0.751 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.011670589447021
Epoch: 9, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.757 Vali Acc: 0.963 Test Loss: 0.757 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 9.187530755996704
Epoch: 10, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.864 Vali Acc: 0.952 Test Loss: 0.864 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.742717027664185
Epoch: 11, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.831 Vali Acc: 0.945 Test Loss: 0.831 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 9.738940477371216
Epoch: 12, Steps: 89 | Train Loss: 0.370 Vali Loss: 1.130 Vali Acc: 0.939 Test Loss: 1.130 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.4296293258667
Epoch: 13, Steps: 89 | Train Loss: 0.248 Vali Loss: 1.137 Vali Acc: 0.945 Test Loss: 1.137 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.8852739334106445
Epoch: 14, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.988 Vali Acc: 0.963 Test Loss: 0.988 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 9.425024509429932
Epoch: 15, Steps: 89 | Train Loss: 0.220 Vali Loss: 1.170 Vali Acc: 0.958 Test Loss: 1.170 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 9.14457368850708
Epoch: 16, Steps: 89 | Train Loss: 0.286 Vali Loss: 1.662 Vali Acc: 0.928 Test Loss: 1.662 Test Acc: 0.928
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 3981900
model size : 24.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.166476249694824
Epoch: 1, Steps: 89 | Train Loss: 0.903 Vali Loss: 0.530 Vali Acc: 0.902 Test Loss: 0.530 Test Acc: 0.902
Validation loss decreased (inf --> -0.901805).  Saving model ...
Epoch: 2 cost time: 8.642816543579102
Epoch: 2, Steps: 89 | Train Loss: 0.766 Vali Loss: 0.703 Vali Acc: 0.887 Test Loss: 0.703 Test Acc: 0.887
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 9.358326196670532
Epoch: 3, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.578 Vali Acc: 0.932 Test Loss: 0.578 Test Acc: 0.932
Validation loss decreased (-0.901805 --> -0.932445).  Saving model ...
Epoch: 4 cost time: 8.409352779388428
Epoch: 4, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.567 Vali Acc: 0.956 Test Loss: 0.567 Test Acc: 0.956
Validation loss decreased (-0.932445 --> -0.956122).  Saving model ...
Epoch: 5 cost time: 8.412328720092773
Epoch: 5, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.510 Vali Acc: 0.960 Test Loss: 0.510 Test Acc: 0.960
Validation loss decreased (-0.956122 --> -0.960301).  Saving model ...
Epoch: 6 cost time: 9.024960279464722
Epoch: 6, Steps: 89 | Train Loss: 0.460 Vali Loss: 0.712 Vali Acc: 0.946 Test Loss: 0.712 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.375844478607178
Epoch: 7, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.649 Vali Acc: 0.963 Test Loss: 0.649 Test Acc: 0.963
Validation loss decreased (-0.960301 --> -0.963085).  Saving model ...
Epoch: 8 cost time: 9.610613107681274
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.097 Vali Acc: 0.938 Test Loss: 1.097 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 9.120406866073608
Epoch: 9, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.647 Vali Acc: 0.962 Test Loss: 0.647 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 9.004150390625
Epoch: 10, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.624 Vali Acc: 0.973 Test Loss: 0.624 Test Acc: 0.973
Validation loss decreased (-0.963085 --> -0.972835).  Saving model ...
Epoch: 11 cost time: 7.59078049659729
Epoch: 11, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.635 Vali Acc: 0.974 Test Loss: 0.635 Test Acc: 0.974
Validation loss decreased (-0.972835 --> -0.974228).  Saving model ...
Epoch: 12 cost time: 8.872161865234375
Epoch: 12, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.860 Vali Acc: 0.953 Test Loss: 0.860 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.276094675064087
Epoch: 13, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.676 Vali Acc: 0.975 Test Loss: 0.676 Test Acc: 0.975
Validation loss decreased (-0.974228 --> -0.974924).  Saving model ...
Epoch: 14 cost time: 9.31555461883545
Epoch: 14, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.826 Vali Acc: 0.964 Test Loss: 0.826 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.126386880874634
Epoch: 15, Steps: 89 | Train Loss: 0.097 Vali Loss: 1.223 Vali Acc: 0.955 Test Loss: 1.223 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 9.852834701538086
Epoch: 16, Steps: 89 | Train Loss: 0.133 Vali Loss: 1.096 Vali Acc: 0.955 Test Loss: 1.096 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 9.858655452728271
Epoch: 17, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.817 Vali Acc: 0.966 Test Loss: 0.817 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.4939491748809814
Epoch: 18, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.840 Vali Acc: 0.967 Test Loss: 0.840 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 8.854892015457153
Epoch: 19, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.859 Vali Acc: 0.962 Test Loss: 0.859 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.680192232131958
Epoch: 20, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.899 Vali Acc: 0.960 Test Loss: 0.899 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 8.382944345474243
Epoch: 21, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.924 Vali Acc: 0.971 Test Loss: 0.924 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.03599500656128
Epoch: 22, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.822 Vali Acc: 0.967 Test Loss: 0.822 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 8.073752641677856
Epoch: 23, Steps: 89 | Train Loss: 0.286 Vali Loss: 1.429 Vali Acc: 0.949 Test Loss: 1.429 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 3981900
model size : 24.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.72238802909851
Epoch: 1, Steps: 89 | Train Loss: 0.881 Vali Loss: 0.445 Vali Acc: 0.918 Test Loss: 0.445 Test Acc: 0.918
Validation loss decreased (inf --> -0.917823).  Saving model ...
Epoch: 2 cost time: 8.73686695098877
Epoch: 2, Steps: 89 | Train Loss: 0.517 Vali Loss: 0.712 Vali Acc: 0.884 Test Loss: 0.712 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.0408735275268555
Epoch: 3, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.518 Vali Acc: 0.944 Test Loss: 0.518 Test Acc: 0.944
Validation loss decreased (-0.917823 --> -0.944285).  Saving model ...
Epoch: 4 cost time: 9.228730201721191
Epoch: 4, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.410 Vali Acc: 0.963 Test Loss: 0.410 Test Acc: 0.963
Validation loss decreased (-0.944285 --> -0.963088).  Saving model ...
Epoch: 5 cost time: 8.661930561065674
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.410 Vali Acc: 0.966 Test Loss: 0.410 Test Acc: 0.966
Validation loss decreased (-0.963088 --> -0.965873).  Saving model ...
Epoch: 6 cost time: 9.649904012680054
Epoch: 6, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.857 Vali Acc: 0.938 Test Loss: 0.857 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.097689390182495
Epoch: 7, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.864 Vali Acc: 0.940 Test Loss: 0.864 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.493921518325806
Epoch: 8, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.860 Vali Acc: 0.949 Test Loss: 0.860 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.8215415477752686
Epoch: 9, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.708 Vali Acc: 0.958 Test Loss: 0.708 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 8.288609743118286
Epoch: 10, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.773 Vali Acc: 0.964 Test Loss: 0.773 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.34247875213623
Epoch: 11, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.831 Vali Acc: 0.969 Test Loss: 0.831 Test Acc: 0.969
Validation loss decreased (-0.965873 --> -0.968655).  Saving model ...
Epoch: 12 cost time: 9.317100286483765
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.712 Vali Acc: 0.963 Test Loss: 0.712 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 8.778218030929565
Epoch: 13, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.850 Vali Acc: 0.967 Test Loss: 0.850 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 8.909024000167847
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 1.074 Vali Acc: 0.962 Test Loss: 1.074 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 8.921251058578491
Epoch: 15, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.008 Vali Acc: 0.961 Test Loss: 1.008 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 7.997381210327148
Epoch: 16, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.740 Vali Acc: 0.968 Test Loss: 0.740 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 9.100894689559937
Epoch: 17, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.802 Vali Acc: 0.971 Test Loss: 0.802 Test Acc: 0.971
Validation loss decreased (-0.968655 --> -0.970744).  Saving model ...
Epoch: 18 cost time: 8.637939929962158
Epoch: 18, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.620 Vali Acc: 0.977 Test Loss: 0.620 Test Acc: 0.977
Validation loss decreased (-0.970744 --> -0.977013).  Saving model ...
Epoch: 19 cost time: 8.867842674255371
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.703 Vali Acc: 0.974 Test Loss: 0.703 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.824507236480713
Epoch: 20, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.573 Vali Acc: 0.979 Test Loss: 0.573 Test Acc: 0.979
Validation loss decreased (-0.977013 --> -0.979103).  Saving model ...
Epoch: 21 cost time: 8.737619400024414
Epoch: 21, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.669 Vali Acc: 0.975 Test Loss: 0.669 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.318347215652466
Epoch: 22, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.638 Vali Acc: 0.970 Test Loss: 0.638 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 7.87484335899353
Epoch: 23, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.585 Vali Acc: 0.978 Test Loss: 0.585 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 9.128512382507324
Epoch: 24, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.697 Vali Acc: 0.974 Test Loss: 0.697 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.516480684280396
Epoch: 25, Steps: 89 | Train Loss: 0.098 Vali Loss: 1.279 Vali Acc: 0.948 Test Loss: 1.279 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.521434307098389
Epoch: 26, Steps: 89 | Train Loss: 0.254 Vali Loss: 1.034 Vali Acc: 0.964 Test Loss: 1.034 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.1027672290802
Epoch: 27, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.920 Vali Acc: 0.966 Test Loss: 0.920 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 8.807627201080322
Epoch: 28, Steps: 89 | Train Loss: 0.115 Vali Loss: 1.332 Vali Acc: 0.956 Test Loss: 1.332 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.798175573348999
Epoch: 29, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.917 Vali Acc: 0.967 Test Loss: 0.917 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 9.99057674407959
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.666 Vali Acc: 0.979 Test Loss: 0.666 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 3981900
model size : 24.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.015503406524658
Epoch: 1, Steps: 89 | Train Loss: 0.795 Vali Loss: 0.361 Vali Acc: 0.913 Test Loss: 0.361 Test Acc: 0.913
Validation loss decreased (inf --> -0.912949).  Saving model ...
Epoch: 2 cost time: 6.938893795013428
Epoch: 2, Steps: 89 | Train Loss: 0.358 Vali Loss: 0.301 Vali Acc: 0.939 Test Loss: 0.301 Test Acc: 0.939
Validation loss decreased (-0.912949 --> -0.939412).  Saving model ...
Epoch: 3 cost time: 7.867835283279419
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.344 Vali Acc: 0.943 Test Loss: 0.344 Test Acc: 0.943
Validation loss decreased (-0.939412 --> -0.942893).  Saving model ...
Epoch: 4 cost time: 7.747704744338989
Epoch: 4, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.570 Vali Acc: 0.947 Test Loss: 0.570 Test Acc: 0.947
Validation loss decreased (-0.942893 --> -0.947070).  Saving model ...
Epoch: 5 cost time: 8.18531084060669
Epoch: 5, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.313 Vali Acc: 0.969 Test Loss: 0.313 Test Acc: 0.969
Validation loss decreased (-0.947070 --> -0.969356).  Saving model ...
Epoch: 6 cost time: 9.46875262260437
Epoch: 6, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.419 Vali Acc: 0.963 Test Loss: 0.419 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.935606002807617
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.422 Vali Acc: 0.949 Test Loss: 0.422 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.581862688064575
Epoch: 8, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.489 Vali Acc: 0.955 Test Loss: 0.489 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 9.018244504928589
Epoch: 9, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.362 Vali Acc: 0.969 Test Loss: 0.362 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 9.781515121459961
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.416 Vali Acc: 0.969 Test Loss: 0.416 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 9.29626750946045
Epoch: 11, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.466 Vali Acc: 0.966 Test Loss: 0.466 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 9.841982364654541
Epoch: 12, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.603 Vali Acc: 0.966 Test Loss: 0.603 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 8.13887357711792
Epoch: 13, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.195 Vali Acc: 0.941 Test Loss: 1.195 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 9.860121726989746
Epoch: 14, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.778 Vali Acc: 0.953 Test Loss: 0.778 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 9.923454284667969
Epoch: 15, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.507 Vali Acc: 0.968 Test Loss: 0.507 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9693593314763231
model parameter : 3981900
model size : 24.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.737698078155518
Epoch: 1, Steps: 89 | Train Loss: 1.018 Vali Loss: 0.677 Vali Acc: 0.866 Test Loss: 0.677 Test Acc: 0.866
Validation loss decreased (inf --> -0.866288).  Saving model ...
Epoch: 2 cost time: 8.38519549369812
Epoch: 2, Steps: 89 | Train Loss: 0.588 Vali Loss: 0.716 Vali Acc: 0.891 Test Loss: 0.716 Test Acc: 0.891
Validation loss decreased (-0.866288 --> -0.891358).  Saving model ...
Epoch: 3 cost time: 8.417734861373901
Epoch: 3, Steps: 89 | Train Loss: 0.554 Vali Loss: 0.694 Vali Acc: 0.919 Test Loss: 0.694 Test Acc: 0.919
Validation loss decreased (-0.891358 --> -0.918517).  Saving model ...
Epoch: 4 cost time: 8.631664991378784
Epoch: 4, Steps: 89 | Train Loss: 0.365 Vali Loss: 0.641 Vali Acc: 0.919 Test Loss: 0.641 Test Acc: 0.919
Validation loss decreased (-0.918517 --> -0.918517).  Saving model ...
Epoch: 5 cost time: 8.603510856628418
Epoch: 5, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.743 Vali Acc: 0.952 Test Loss: 0.743 Test Acc: 0.952
Validation loss decreased (-0.918517 --> -0.951942).  Saving model ...
Epoch: 6 cost time: 7.955034255981445
Epoch: 6, Steps: 89 | Train Loss: 0.500 Vali Loss: 0.594 Vali Acc: 0.955 Test Loss: 0.594 Test Acc: 0.955
Validation loss decreased (-0.951942 --> -0.954729).  Saving model ...
Epoch: 7 cost time: 8.007520198822021
Epoch: 7, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.714 Vali Acc: 0.955 Test Loss: 0.714 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.274456024169922
Epoch: 8, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.639 Vali Acc: 0.961 Test Loss: 0.639 Test Acc: 0.961
Validation loss decreased (-0.954729 --> -0.960996).  Saving model ...
Epoch: 9 cost time: 8.293511629104614
Epoch: 9, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.656 Vali Acc: 0.954 Test Loss: 0.656 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 9.094560146331787
Epoch: 10, Steps: 89 | Train Loss: 0.302 Vali Loss: 0.787 Vali Acc: 0.965 Test Loss: 0.787 Test Acc: 0.965
Validation loss decreased (-0.960996 --> -0.965173).  Saving model ...
Epoch: 11 cost time: 8.682700872421265
Epoch: 11, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.714 Vali Acc: 0.957 Test Loss: 0.714 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.033380270004272
Epoch: 12, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.667 Vali Acc: 0.970 Test Loss: 0.667 Test Acc: 0.970
Validation loss decreased (-0.965173 --> -0.970049).  Saving model ...
Epoch: 13 cost time: 7.790264368057251
Epoch: 13, Steps: 89 | Train Loss: 0.120 Vali Loss: 1.442 Vali Acc: 0.943 Test Loss: 1.442 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.734469175338745
Epoch: 14, Steps: 89 | Train Loss: 0.376 Vali Loss: 1.168 Vali Acc: 0.954 Test Loss: 1.168 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 9.79836130142212
Epoch: 15, Steps: 89 | Train Loss: 0.167 Vali Loss: 1.069 Vali Acc: 0.955 Test Loss: 1.069 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 9.53183364868164
Epoch: 16, Steps: 89 | Train Loss: 0.112 Vali Loss: 1.003 Vali Acc: 0.953 Test Loss: 1.003 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 9.449713706970215
Epoch: 17, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.866 Vali Acc: 0.965 Test Loss: 0.866 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 9.310637474060059
Epoch: 18, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.809 Vali Acc: 0.970 Test Loss: 0.809 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 9.46462368965149
Epoch: 19, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.851 Vali Acc: 0.969 Test Loss: 0.851 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.180723428726196
Epoch: 20, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.249 Vali Acc: 0.955 Test Loss: 1.249 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 10.110749006271362
Epoch: 21, Steps: 89 | Train Loss: 0.107 Vali Loss: 1.466 Vali Acc: 0.923 Test Loss: 1.466 Test Acc: 0.923
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 9.885030269622803
Epoch: 22, Steps: 89 | Train Loss: 0.161 Vali Loss: 1.023 Vali Acc: 0.961 Test Loss: 1.023 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 3457612
model size : 22.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.679279088973999
Epoch: 1, Steps: 89 | Train Loss: 1.012 Vali Loss: 0.542 Vali Acc: 0.889 Test Loss: 0.542 Test Acc: 0.889
Validation loss decreased (inf --> -0.888574).  Saving model ...
Epoch: 2 cost time: 9.055000305175781
Epoch: 2, Steps: 89 | Train Loss: 0.667 Vali Loss: 0.708 Vali Acc: 0.900 Test Loss: 0.708 Test Acc: 0.900
Validation loss decreased (-0.888574 --> -0.900411).  Saving model ...
Epoch: 3 cost time: 8.673335075378418
Epoch: 3, Steps: 89 | Train Loss: 0.558 Vali Loss: 0.712 Vali Acc: 0.932 Test Loss: 0.712 Test Acc: 0.932
Validation loss decreased (-0.900411 --> -0.932444).  Saving model ...
Epoch: 4 cost time: 9.151753187179565
Epoch: 4, Steps: 89 | Train Loss: 0.395 Vali Loss: 0.490 Vali Acc: 0.951 Test Loss: 0.490 Test Acc: 0.951
Validation loss decreased (-0.932444 --> -0.950552).  Saving model ...
Epoch: 5 cost time: 7.615490198135376
Epoch: 5, Steps: 89 | Train Loss: 0.303 Vali Loss: 0.565 Vali Acc: 0.953 Test Loss: 0.565 Test Acc: 0.953
Validation loss decreased (-0.950552 --> -0.953337).  Saving model ...
Epoch: 6 cost time: 9.982069492340088
Epoch: 6, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.673 Vali Acc: 0.952 Test Loss: 0.673 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.757157802581787
Epoch: 7, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.789 Vali Acc: 0.941 Test Loss: 0.789 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.305124521255493
Epoch: 8, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.760 Vali Acc: 0.955 Test Loss: 0.760 Test Acc: 0.955
Validation loss decreased (-0.953337 --> -0.954728).  Saving model ...
Epoch: 9 cost time: 9.35232663154602
Epoch: 9, Steps: 89 | Train Loss: 0.268 Vali Loss: 0.747 Vali Acc: 0.964 Test Loss: 0.747 Test Acc: 0.964
Validation loss decreased (-0.954728 --> -0.963781).  Saving model ...
Epoch: 10 cost time: 7.421267509460449
Epoch: 10, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.837 Vali Acc: 0.943 Test Loss: 0.837 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 9.685933351516724
Epoch: 11, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.797 Vali Acc: 0.964 Test Loss: 0.797 Test Acc: 0.964
Validation loss decreased (-0.963781 --> -0.964477).  Saving model ...
Epoch: 12 cost time: 9.27865219116211
Epoch: 12, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.761 Vali Acc: 0.966 Test Loss: 0.761 Test Acc: 0.966
Validation loss decreased (-0.964477 --> -0.965870).  Saving model ...
Epoch: 13 cost time: 9.059369087219238
Epoch: 13, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.550 Vali Acc: 0.975 Test Loss: 0.550 Test Acc: 0.975
Validation loss decreased (-0.965870 --> -0.974925).  Saving model ...
Epoch: 14 cost time: 9.560443639755249
Epoch: 14, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.634 Vali Acc: 0.969 Test Loss: 0.634 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 9.477643251419067
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.542 Vali Acc: 0.978 Test Loss: 0.542 Test Acc: 0.978
Validation loss decreased (-0.974925 --> -0.978407).  Saving model ...
Epoch: 16 cost time: 9.536763668060303
Epoch: 16, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.507 Vali Acc: 0.979 Test Loss: 0.507 Test Acc: 0.979
Validation loss decreased (-0.978407 --> -0.979104).  Saving model ...
Epoch: 17 cost time: 8.041120767593384
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.630 Vali Acc: 0.976 Test Loss: 0.630 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.7040393352508545
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.586 Vali Acc: 0.976 Test Loss: 0.586 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.882872104644775
Epoch: 19, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.669 Vali Acc: 0.974 Test Loss: 0.669 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 7.5178306102752686
Epoch: 20, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.690 Vali Acc: 0.976 Test Loss: 0.690 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 7.623689889907837
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.814 Vali Acc: 0.969 Test Loss: 0.814 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.16297698020935
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.710 Vali Acc: 0.969 Test Loss: 0.710 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.484017610549927
Epoch: 23, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.952 Vali Acc: 0.967 Test Loss: 0.952 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.601379156112671
Epoch: 24, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.772 Vali Acc: 0.974 Test Loss: 0.772 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 9.101111650466919
Epoch: 25, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.825 Vali Acc: 0.971 Test Loss: 0.825 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.31873345375061
Epoch: 26, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.998 Vali Acc: 0.970 Test Loss: 0.998 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 3457612
model size : 22.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.103667259216309
Epoch: 1, Steps: 89 | Train Loss: 0.946 Vali Loss: 0.623 Vali Acc: 0.880 Test Loss: 0.623 Test Acc: 0.880
Validation loss decreased (inf --> -0.879520).  Saving model ...
Epoch: 2 cost time: 8.672471284866333
Epoch: 2, Steps: 89 | Train Loss: 0.565 Vali Loss: 0.625 Vali Acc: 0.907 Test Loss: 0.625 Test Acc: 0.907
Validation loss decreased (-0.879520 --> -0.907375).  Saving model ...
Epoch: 3 cost time: 8.969979286193848
Epoch: 3, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.909 Vali Acc: 0.902 Test Loss: 0.909 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.405898094177246
Epoch: 4, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.460 Vali Acc: 0.954 Test Loss: 0.460 Test Acc: 0.954
Validation loss decreased (-0.907375 --> -0.954034).  Saving model ...
Epoch: 5 cost time: 6.94732666015625
Epoch: 5, Steps: 89 | Train Loss: 0.400 Vali Loss: 0.423 Vali Acc: 0.960 Test Loss: 0.423 Test Acc: 0.960
Validation loss decreased (-0.954034 --> -0.960302).  Saving model ...
Epoch: 6 cost time: 7.9486870765686035
Epoch: 6, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.453 Vali Acc: 0.956 Test Loss: 0.453 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.302226543426514
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.660 Vali Acc: 0.946 Test Loss: 0.660 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.241294860839844
Epoch: 8, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.719 Vali Acc: 0.949 Test Loss: 0.719 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.1671271324157715
Epoch: 9, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.762 Vali Acc: 0.948 Test Loss: 0.762 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.887500047683716
Epoch: 10, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.633 Vali Acc: 0.957 Test Loss: 0.633 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 7.710644721984863
Epoch: 11, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.410 Vali Acc: 0.974 Test Loss: 0.410 Test Acc: 0.974
Validation loss decreased (-0.960302 --> -0.973534).  Saving model ...
Epoch: 12 cost time: 8.319846630096436
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.385 Vali Acc: 0.980 Test Loss: 0.385 Test Acc: 0.980
Validation loss decreased (-0.973534 --> -0.979801).  Saving model ...
Epoch: 13 cost time: 7.7513487339019775
Epoch: 13, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.636 Vali Acc: 0.974 Test Loss: 0.636 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.414726734161377
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.586 Vali Acc: 0.967 Test Loss: 0.586 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.758343696594238
Epoch: 15, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.513 Vali Acc: 0.974 Test Loss: 0.513 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 8.27930498123169
Epoch: 16, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.771 Vali Acc: 0.960 Test Loss: 0.771 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 8.65476369857788
Epoch: 17, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.707 Vali Acc: 0.959 Test Loss: 0.707 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.515056848526001
Epoch: 18, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.806 Vali Acc: 0.974 Test Loss: 0.806 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 7.806584358215332
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.648 Vali Acc: 0.974 Test Loss: 0.648 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 7.902924537658691
Epoch: 20, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.681 Vali Acc: 0.972 Test Loss: 0.681 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 9.06165099143982
Epoch: 21, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.796 Vali Acc: 0.963 Test Loss: 0.796 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.34778356552124
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.662 Vali Acc: 0.974 Test Loss: 0.662 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 3457612
model size : 22.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.363497734069824
Epoch: 1, Steps: 89 | Train Loss: 0.849 Vali Loss: 0.419 Vali Acc: 0.901 Test Loss: 0.419 Test Acc: 0.901
Validation loss decreased (inf --> -0.901110).  Saving model ...
Epoch: 2 cost time: 6.951199054718018
Epoch: 2, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.302 Vali Acc: 0.942 Test Loss: 0.302 Test Acc: 0.942
Validation loss decreased (-0.901110 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 8.932432889938354
Epoch: 3, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.403 Vali Acc: 0.942 Test Loss: 0.403 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 8.626793146133423
Epoch: 4, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.428 Vali Acc: 0.947 Test Loss: 0.428 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947071).  Saving model ...
Epoch: 5 cost time: 7.097974061965942
Epoch: 5, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.484 Vali Acc: 0.967 Test Loss: 0.484 Test Acc: 0.967
Validation loss decreased (-0.947071 --> -0.966569).  Saving model ...
Epoch: 6 cost time: 7.551846504211426
Epoch: 6, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.509 Vali Acc: 0.947 Test Loss: 0.509 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 8.45850157737732
Epoch: 7, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.655 Vali Acc: 0.946 Test Loss: 0.655 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 8.151893138885498
Epoch: 8, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.445 Vali Acc: 0.966 Test Loss: 0.445 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 8.795416355133057
Epoch: 9, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.587 Vali Acc: 0.962 Test Loss: 0.587 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 7.246800899505615
Epoch: 10, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.437 Vali Acc: 0.967 Test Loss: 0.437 Test Acc: 0.967
Validation loss decreased (-0.966569 --> -0.967266).  Saving model ...
Epoch: 11 cost time: 7.9709837436676025
Epoch: 11, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.505 Vali Acc: 0.964 Test Loss: 0.505 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 8.161115407943726
Epoch: 12, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.543 Vali Acc: 0.969 Test Loss: 0.543 Test Acc: 0.969
Validation loss decreased (-0.967266 --> -0.969354).  Saving model ...
Epoch: 13 cost time: 8.180668354034424
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.473 Vali Acc: 0.977 Test Loss: 0.473 Test Acc: 0.977
Validation loss decreased (-0.969354 --> -0.977015).  Saving model ...
Epoch: 14 cost time: 8.660683870315552
Epoch: 14, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.495 Vali Acc: 0.972 Test Loss: 0.495 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.167877674102783
Epoch: 15, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.633 Vali Acc: 0.968 Test Loss: 0.633 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 8.201740503311157
Epoch: 16, Steps: 89 | Train Loss: 0.284 Vali Loss: 0.897 Vali Acc: 0.948 Test Loss: 0.897 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 8.120316505432129
Epoch: 17, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.524 Vali Acc: 0.973 Test Loss: 0.524 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.721855163574219
Epoch: 18, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.614 Vali Acc: 0.974 Test Loss: 0.614 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.628565311431885
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.586 Vali Acc: 0.968 Test Loss: 0.586 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 8.142837047576904
Epoch: 20, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.719 Vali Acc: 0.964 Test Loss: 0.719 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 7.417208433151245
Epoch: 21, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.840 Vali Acc: 0.962 Test Loss: 0.840 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 7.376418352127075
Epoch: 22, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.578 Vali Acc: 0.969 Test Loss: 0.578 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 7.140249729156494
Epoch: 23, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.694 Vali Acc: 0.967 Test Loss: 0.694 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 3457612
model size : 22.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.026897668838501
Epoch: 1, Steps: 89 | Train Loss: 0.981 Vali Loss: 0.774 Vali Acc: 0.842 Test Loss: 0.774 Test Acc: 0.842
Validation loss decreased (inf --> -0.841914).  Saving model ...
Epoch: 2 cost time: 8.573564529418945
Epoch: 2, Steps: 89 | Train Loss: 0.751 Vali Loss: 0.970 Vali Acc: 0.854 Test Loss: 0.970 Test Acc: 0.854
Validation loss decreased (-0.841914 --> -0.853751).  Saving model ...
Epoch: 3 cost time: 8.288269519805908
Epoch: 3, Steps: 89 | Train Loss: 1.019 Vali Loss: 0.624 Vali Acc: 0.931 Test Loss: 0.624 Test Acc: 0.931
Validation loss decreased (-0.853751 --> -0.931052).  Saving model ...
Epoch: 4 cost time: 7.660221338272095
Epoch: 4, Steps: 89 | Train Loss: 0.612 Vali Loss: 0.821 Vali Acc: 0.913 Test Loss: 0.821 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.932053327560425
Epoch: 5, Steps: 89 | Train Loss: 0.351 Vali Loss: 0.625 Vali Acc: 0.937 Test Loss: 0.625 Test Acc: 0.937
Validation loss decreased (-0.931052 --> -0.937320).  Saving model ...
Epoch: 6 cost time: 7.711812496185303
Epoch: 6, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.727 Vali Acc: 0.940 Test Loss: 0.727 Test Acc: 0.940
Validation loss decreased (-0.937320 --> -0.940104).  Saving model ...
Epoch: 7 cost time: 7.971736907958984
Epoch: 7, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.887 Vali Acc: 0.942 Test Loss: 0.887 Test Acc: 0.942
Validation loss decreased (-0.940104 --> -0.942192).  Saving model ...
Epoch: 8 cost time: 8.252968072891235
Epoch: 8, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.898 Vali Acc: 0.957 Test Loss: 0.898 Test Acc: 0.957
Validation loss decreased (-0.942192 --> -0.956816).  Saving model ...
Epoch: 9 cost time: 8.233078956604004
Epoch: 9, Steps: 89 | Train Loss: 0.330 Vali Loss: 0.642 Vali Acc: 0.962 Test Loss: 0.642 Test Acc: 0.962
Validation loss decreased (-0.956816 --> -0.961693).  Saving model ...
Epoch: 10 cost time: 8.116466283798218
Epoch: 10, Steps: 89 | Train Loss: 0.135 Vali Loss: 1.306 Vali Acc: 0.931 Test Loss: 1.306 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 8.295910358428955
Epoch: 11, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.815 Vali Acc: 0.961 Test Loss: 0.815 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.255257844924927
Epoch: 12, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.266 Vali Acc: 0.925 Test Loss: 1.266 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 8.690597772598267
Epoch: 13, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.931 Vali Acc: 0.955 Test Loss: 0.931 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 7.645950794219971
Epoch: 14, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.761 Vali Acc: 0.962 Test Loss: 0.761 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 8.55303406715393
Epoch: 15, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.710 Vali Acc: 0.965 Test Loss: 0.710 Test Acc: 0.965
Validation loss decreased (-0.961693 --> -0.965174).  Saving model ...
Epoch: 16 cost time: 7.644450664520264
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.799 Vali Acc: 0.969 Test Loss: 0.799 Test Acc: 0.969
Validation loss decreased (-0.965174 --> -0.968655).  Saving model ...
Epoch: 17 cost time: 7.179202079772949
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 2.355 Vali Acc: 0.920 Test Loss: 2.355 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.489616632461548
Epoch: 18, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.973 Vali Acc: 0.967 Test Loss: 0.973 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.587636470794678
Epoch: 19, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.040 Vali Acc: 0.958 Test Loss: 1.040 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.159840822219849
Epoch: 20, Steps: 89 | Train Loss: 0.178 Vali Loss: 1.075 Vali Acc: 0.964 Test Loss: 1.075 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 8.015891790390015
Epoch: 21, Steps: 89 | Train Loss: 0.198 Vali Loss: 1.076 Vali Acc: 0.967 Test Loss: 1.076 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 7.7180891036987305
Epoch: 22, Steps: 89 | Train Loss: 0.112 Vali Loss: 1.100 Vali Acc: 0.963 Test Loss: 1.100 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.224466800689697
Epoch: 23, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.411 Vali Acc: 0.944 Test Loss: 1.411 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.497843503952026
Epoch: 24, Steps: 89 | Train Loss: 0.208 Vali Loss: 1.426 Vali Acc: 0.952 Test Loss: 1.426 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 8.186286449432373
Epoch: 25, Steps: 89 | Train Loss: 0.063 Vali Loss: 1.182 Vali Acc: 0.967 Test Loss: 1.182 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 8.69655704498291
Epoch: 26, Steps: 89 | Train Loss: 0.142 Vali Loss: 1.228 Vali Acc: 0.960 Test Loss: 1.228 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 3195468
model size : 21.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.3156099319458
Epoch: 1, Steps: 89 | Train Loss: 0.967 Vali Loss: 0.648 Vali Acc: 0.868 Test Loss: 0.648 Test Acc: 0.868
Validation loss decreased (inf --> -0.868378).  Saving model ...
Epoch: 2 cost time: 8.3092360496521
Epoch: 2, Steps: 89 | Train Loss: 0.688 Vali Loss: 1.079 Vali Acc: 0.870 Test Loss: 1.079 Test Acc: 0.870
Validation loss decreased (-0.868378 --> -0.869766).  Saving model ...
Epoch: 3 cost time: 8.211371421813965
Epoch: 3, Steps: 89 | Train Loss: 0.785 Vali Loss: 0.477 Vali Acc: 0.943 Test Loss: 0.477 Test Acc: 0.943
Validation loss decreased (-0.869766 --> -0.942892).  Saving model ...
Epoch: 4 cost time: 7.750695466995239
Epoch: 4, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.696 Vali Acc: 0.912 Test Loss: 0.696 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.520504474639893
Epoch: 5, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.881 Vali Acc: 0.936 Test Loss: 0.881 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.652786493301392
Epoch: 6, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.776 Vali Acc: 0.958 Test Loss: 0.776 Test Acc: 0.958
Validation loss decreased (-0.942892 --> -0.957513).  Saving model ...
Epoch: 7 cost time: 8.03105115890503
Epoch: 7, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.431 Vali Acc: 0.964 Test Loss: 0.431 Test Acc: 0.964
Validation loss decreased (-0.957513 --> -0.964480).  Saving model ...
Epoch: 8 cost time: 7.22014307975769
Epoch: 8, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.663 Vali Acc: 0.947 Test Loss: 0.663 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.299811840057373
Epoch: 9, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.800 Vali Acc: 0.958 Test Loss: 0.800 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.6004319190979
Epoch: 10, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.778 Vali Acc: 0.962 Test Loss: 0.778 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 7.867922782897949
Epoch: 11, Steps: 89 | Train Loss: 0.133 Vali Loss: 1.030 Vali Acc: 0.956 Test Loss: 1.030 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 6.550310850143433
Epoch: 12, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.592 Vali Acc: 0.978 Test Loss: 0.592 Test Acc: 0.978
Validation loss decreased (-0.964480 --> -0.977710).  Saving model ...
Epoch: 13 cost time: 7.738032579421997
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.988 Vali Acc: 0.946 Test Loss: 0.988 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 8.482089519500732
Epoch: 14, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.636 Vali Acc: 0.974 Test Loss: 0.636 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 7.417506456375122
Epoch: 15, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.737 Vali Acc: 0.962 Test Loss: 0.737 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.429903507232666
Epoch: 16, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.668 Vali Acc: 0.968 Test Loss: 0.668 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.472656726837158
Epoch: 17, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.715 Vali Acc: 0.967 Test Loss: 0.715 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 7.8535284996032715
Epoch: 18, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.560 Vali Acc: 0.977 Test Loss: 0.560 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.614458560943604
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.984 Vali Acc: 0.965 Test Loss: 0.984 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 8.435454845428467
Epoch: 20, Steps: 89 | Train Loss: 0.380 Vali Loss: 1.752 Vali Acc: 0.948 Test Loss: 1.752 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.936550140380859
Epoch: 21, Steps: 89 | Train Loss: 0.210 Vali Loss: 1.122 Vali Acc: 0.959 Test Loss: 1.122 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 6.846831321716309
Epoch: 22, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.952 Vali Acc: 0.965 Test Loss: 0.952 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 3195468
model size : 21.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.083342790603638
Epoch: 1, Steps: 89 | Train Loss: 0.908 Vali Loss: 0.489 Vali Acc: 0.897 Test Loss: 0.489 Test Acc: 0.897
Validation loss decreased (inf --> -0.896931).  Saving model ...
Epoch: 2 cost time: 7.041288137435913
Epoch: 2, Steps: 89 | Train Loss: 0.598 Vali Loss: 0.412 Vali Acc: 0.943 Test Loss: 0.412 Test Acc: 0.943
Validation loss decreased (-0.896931 --> -0.942893).  Saving model ...
Epoch: 3 cost time: 7.393321514129639
Epoch: 3, Steps: 89 | Train Loss: 0.495 Vali Loss: 0.650 Vali Acc: 0.916 Test Loss: 0.650 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.75032114982605
Epoch: 4, Steps: 89 | Train Loss: 0.399 Vali Loss: 0.687 Vali Acc: 0.930 Test Loss: 0.687 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.215901613235474
Epoch: 5, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.595 Vali Acc: 0.950 Test Loss: 0.595 Test Acc: 0.950
Validation loss decreased (-0.942893 --> -0.949855).  Saving model ...
Epoch: 6 cost time: 7.458930015563965
Epoch: 6, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.533 Vali Acc: 0.962 Test Loss: 0.533 Test Acc: 0.962
Validation loss decreased (-0.949855 --> -0.962390).  Saving model ...
Epoch: 7 cost time: 6.466143608093262
Epoch: 7, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.465 Vali Acc: 0.961 Test Loss: 0.465 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.993248701095581
Epoch: 8, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.522 Vali Acc: 0.969 Test Loss: 0.522 Test Acc: 0.969
Validation loss decreased (-0.962390 --> -0.968658).  Saving model ...
Epoch: 9 cost time: 7.700663089752197
Epoch: 9, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.640 Vali Acc: 0.967 Test Loss: 0.640 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.245014667510986
Epoch: 10, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.712 Vali Acc: 0.969 Test Loss: 0.712 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.147071123123169
Epoch: 11, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.724 Vali Acc: 0.970 Test Loss: 0.724 Test Acc: 0.970
Validation loss decreased (-0.968658 --> -0.970048).  Saving model ...
Epoch: 12 cost time: 7.504918813705444
Epoch: 12, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.683 Vali Acc: 0.960 Test Loss: 0.683 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 7.646164655685425
Epoch: 13, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.632 Vali Acc: 0.965 Test Loss: 0.632 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 7.49955940246582
Epoch: 14, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.925 Vali Acc: 0.964 Test Loss: 0.925 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 7.6413586139678955
Epoch: 15, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.633 Vali Acc: 0.966 Test Loss: 0.633 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.0620691776275635
Epoch: 16, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.603 Vali Acc: 0.971 Test Loss: 0.603 Test Acc: 0.971
Validation loss decreased (-0.970048 --> -0.970746).  Saving model ...
Epoch: 17 cost time: 7.949673175811768
Epoch: 17, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.464 Vali Acc: 0.978 Test Loss: 0.464 Test Acc: 0.978
Validation loss decreased (-0.970746 --> -0.977711).  Saving model ...
Epoch: 18 cost time: 7.410231351852417
Epoch: 18, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.563 Vali Acc: 0.978 Test Loss: 0.563 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.42905879020691
Epoch: 19, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.699 Vali Acc: 0.971 Test Loss: 0.699 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.0171544551849365
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.653 Vali Acc: 0.976 Test Loss: 0.653 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 7.825670003890991
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.600 Vali Acc: 0.970 Test Loss: 0.600 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.14530348777771
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.625 Vali Acc: 0.973 Test Loss: 0.625 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 7.07660436630249
Epoch: 23, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.696 Vali Acc: 0.974 Test Loss: 0.696 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.72858452796936
Epoch: 24, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.583 Vali Acc: 0.978 Test Loss: 0.583 Test Acc: 0.978
Validation loss decreased (-0.977711 --> -0.978406).  Saving model ...
Epoch: 25 cost time: 6.856642961502075
Epoch: 25, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.754 Vali Acc: 0.960 Test Loss: 0.754 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.840681791305542
Epoch: 26, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.540 Vali Acc: 0.975 Test Loss: 0.540 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.497654676437378
Epoch: 27, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.715 Vali Acc: 0.969 Test Loss: 0.715 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 7.299206972122192
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.627 Vali Acc: 0.976 Test Loss: 0.627 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 7.316425561904907
Epoch: 29, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.594 Vali Acc: 0.979 Test Loss: 0.594 Test Acc: 0.979
Validation loss decreased (-0.978406 --> -0.979103).  Saving model ...
Epoch: 30 cost time: 6.993692874908447
Epoch: 30, Steps: 89 | Train Loss: 0.034 Vali Loss: 1.155 Vali Acc: 0.966 Test Loss: 1.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 8.173495769500732
Epoch: 31, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.696 Vali Acc: 0.968 Test Loss: 0.696 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 7.786742925643921
Epoch: 32, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.770 Vali Acc: 0.962 Test Loss: 0.770 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 6.595132112503052
Epoch: 33, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.761 Vali Acc: 0.971 Test Loss: 0.761 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 7.907951831817627
Epoch: 34, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.918 Vali Acc: 0.968 Test Loss: 0.918 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 8.294132947921753
Epoch: 35, Steps: 89 | Train Loss: 0.098 Vali Loss: 1.237 Vali Acc: 0.954 Test Loss: 1.237 Test Acc: 0.954
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 7.96599268913269
Epoch: 36, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.879 Vali Acc: 0.971 Test Loss: 0.879 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 7.880404949188232
Epoch: 37, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.981 Vali Acc: 0.971 Test Loss: 0.981 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 9.31342601776123
Epoch: 38, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.909 Vali Acc: 0.969 Test Loss: 0.909 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 7.250977039337158
Epoch: 39, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.775 Vali Acc: 0.974 Test Loss: 0.775 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 3195468
model size : 21.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.72651219367981
Epoch: 1, Steps: 89 | Train Loss: 0.861 Vali Loss: 0.404 Vali Acc: 0.923 Test Loss: 0.404 Test Acc: 0.923
Validation loss decreased (inf --> -0.923394).  Saving model ...
Epoch: 2 cost time: 7.191706895828247
Epoch: 2, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.447 Vali Acc: 0.902 Test Loss: 0.447 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 5.469348192214966
Epoch: 3, Steps: 89 | Train Loss: 0.369 Vali Loss: 0.324 Vali Acc: 0.956 Test Loss: 0.324 Test Acc: 0.956
Validation loss decreased (-0.923394 --> -0.956125).  Saving model ...
Epoch: 4 cost time: 7.1966211795806885
Epoch: 4, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.390 Vali Acc: 0.949 Test Loss: 0.390 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.1128129959106445
Epoch: 5, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.352 Vali Acc: 0.965 Test Loss: 0.352 Test Acc: 0.965
Validation loss decreased (-0.956125 --> -0.965178).  Saving model ...
Epoch: 6 cost time: 7.2575860023498535
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.429 Vali Acc: 0.958 Test Loss: 0.429 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.676166296005249
Epoch: 7, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.364 Vali Acc: 0.965 Test Loss: 0.364 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.229548215866089
Epoch: 8, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.329 Vali Acc: 0.972 Test Loss: 0.329 Test Acc: 0.972
Validation loss decreased (-0.965178 --> -0.972142).  Saving model ...
Epoch: 9 cost time: 7.657083511352539
Epoch: 9, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.406 Vali Acc: 0.968 Test Loss: 0.406 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.518662214279175
Epoch: 10, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.379 Vali Acc: 0.969 Test Loss: 0.379 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.5062339305877686
Epoch: 11, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.698 Vali Acc: 0.950 Test Loss: 0.698 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.172100782394409
Epoch: 12, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.494 Vali Acc: 0.963 Test Loss: 0.494 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 7.4461510181427
Epoch: 13, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.649 Vali Acc: 0.958 Test Loss: 0.649 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 7.3655524253845215
Epoch: 14, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.927 Vali Acc: 0.942 Test Loss: 0.927 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.008473873138428
Epoch: 15, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.372 Vali Acc: 0.972 Test Loss: 0.372 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 7.301331996917725
Epoch: 16, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.541 Vali Acc: 0.967 Test Loss: 0.541 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.50379753112793
Epoch: 17, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.471 Vali Acc: 0.979 Test Loss: 0.471 Test Acc: 0.979
Validation loss decreased (-0.972142 --> -0.979104).  Saving model ...
Epoch: 18 cost time: 6.988247632980347
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.415 Vali Acc: 0.977 Test Loss: 0.415 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 9.4772047996521
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.400 Vali Acc: 0.974 Test Loss: 0.400 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 9.482721328735352
Epoch: 20, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.653 Vali Acc: 0.966 Test Loss: 0.653 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 9.645329475402832
Epoch: 21, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.533 Vali Acc: 0.973 Test Loss: 0.533 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 9.821710348129272
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.504 Vali Acc: 0.972 Test Loss: 0.504 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 9.55457329750061
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.485 Vali Acc: 0.976 Test Loss: 0.485 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.600319623947144
Epoch: 24, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.471 Vali Acc: 0.974 Test Loss: 0.471 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 9.436025857925415
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.978 Test Loss: 0.424 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 10.240365266799927
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.424 Vali Acc: 0.978 Test Loss: 0.424 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 8.972142457962036
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.425 Vali Acc: 0.978 Test Loss: 0.425 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 3195468
model size : 21.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 13.388761758804321
Epoch: 1, Steps: 89 | Train Loss: 0.952 Vali Loss: 0.624 Vali Acc: 0.873 Test Loss: 0.624 Test Acc: 0.873
Validation loss decreased (inf --> -0.872556).  Saving model ...
Epoch: 2 cost time: 6.439933776855469
Epoch: 2, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.526 Vali Acc: 0.907 Test Loss: 0.526 Test Acc: 0.907
Validation loss decreased (-0.872556 --> -0.906680).  Saving model ...
Epoch: 3 cost time: 9.951107501983643
Epoch: 3, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.831 Vali Acc: 0.894 Test Loss: 0.831 Test Acc: 0.894
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.020715475082397
Epoch: 4, Steps: 89 | Train Loss: 0.476 Vali Loss: 1.742 Vali Acc: 0.870 Test Loss: 1.742 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 9.814784049987793
Epoch: 5, Steps: 89 | Train Loss: 0.579 Vali Loss: 0.769 Vali Acc: 0.944 Test Loss: 0.769 Test Acc: 0.944
Validation loss decreased (-0.906680 --> -0.943586).  Saving model ...
Epoch: 6 cost time: 9.328101873397827
Epoch: 6, Steps: 89 | Train Loss: 0.272 Vali Loss: 1.030 Vali Acc: 0.941 Test Loss: 1.030 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.756568431854248
Epoch: 7, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.814 Vali Acc: 0.950 Test Loss: 0.814 Test Acc: 0.950
Validation loss decreased (-0.943586 --> -0.949853).  Saving model ...
Epoch: 8 cost time: 11.43160343170166
Epoch: 8, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.998 Vali Acc: 0.944 Test Loss: 0.998 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 10.989532470703125
Epoch: 9, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.677 Vali Acc: 0.964 Test Loss: 0.677 Test Acc: 0.964
Validation loss decreased (-0.949853 --> -0.964478).  Saving model ...
Epoch: 10 cost time: 8.91467571258545
Epoch: 10, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.762 Vali Acc: 0.965 Test Loss: 0.762 Test Acc: 0.965
Validation loss decreased (-0.964478 --> -0.965173).  Saving model ...
Epoch: 11 cost time: 10.368704319000244
Epoch: 11, Steps: 89 | Train Loss: 0.280 Vali Loss: 1.099 Vali Acc: 0.954 Test Loss: 1.099 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 10.443058967590332
Epoch: 12, Steps: 89 | Train Loss: 0.292 Vali Loss: 0.961 Vali Acc: 0.955 Test Loss: 0.961 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 10.64634084701538
Epoch: 13, Steps: 89 | Train Loss: 0.112 Vali Loss: 1.772 Vali Acc: 0.927 Test Loss: 1.772 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 10.658522129058838
Epoch: 14, Steps: 89 | Train Loss: 0.370 Vali Loss: 1.131 Vali Acc: 0.951 Test Loss: 1.131 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 10.419374942779541
Epoch: 15, Steps: 89 | Train Loss: 0.155 Vali Loss: 1.121 Vali Acc: 0.947 Test Loss: 1.121 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 10.781649112701416
Epoch: 16, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.840 Vali Acc: 0.972 Test Loss: 0.840 Test Acc: 0.972
Validation loss decreased (-0.965173 --> -0.972136).  Saving model ...
Epoch: 17 cost time: 10.796295881271362
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.849 Vali Acc: 0.964 Test Loss: 0.849 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 10.42720890045166
Epoch: 18, Steps: 89 | Train Loss: 0.092 Vali Loss: 1.080 Vali Acc: 0.955 Test Loss: 1.080 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.895764112472534
Epoch: 19, Steps: 89 | Train Loss: 0.340 Vali Loss: 1.094 Vali Acc: 0.955 Test Loss: 1.094 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 9.208446502685547
Epoch: 20, Steps: 89 | Train Loss: 0.176 Vali Loss: 1.314 Vali Acc: 0.937 Test Loss: 1.314 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 10.745231866836548
Epoch: 21, Steps: 89 | Train Loss: 0.241 Vali Loss: 1.224 Vali Acc: 0.955 Test Loss: 1.224 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 9.989463567733765
Epoch: 22, Steps: 89 | Train Loss: 0.116 Vali Loss: 1.025 Vali Acc: 0.969 Test Loss: 1.025 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 10.538849830627441
Epoch: 23, Steps: 89 | Train Loss: 0.081 Vali Loss: 1.166 Vali Acc: 0.968 Test Loss: 1.166 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 9.381657838821411
Epoch: 24, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.959 Vali Acc: 0.971 Test Loss: 0.959 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.555642366409302
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 1.091 Vali Acc: 0.964 Test Loss: 1.091 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 9.736539602279663
Epoch: 26, Steps: 89 | Train Loss: 0.108 Vali Loss: 1.674 Vali Acc: 0.940 Test Loss: 1.674 Test Acc: 0.940
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 3064396
model size : 21.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 12.709243774414062
Epoch: 1, Steps: 89 | Train Loss: 0.933 Vali Loss: 0.607 Vali Acc: 0.868 Test Loss: 0.607 Test Acc: 0.868
Validation loss decreased (inf --> -0.868378).  Saving model ...
Epoch: 2 cost time: 10.924390316009521
Epoch: 2, Steps: 89 | Train Loss: 0.638 Vali Loss: 0.746 Vali Acc: 0.907 Test Loss: 0.746 Test Acc: 0.907
Validation loss decreased (-0.868378 --> -0.907374).  Saving model ...
Epoch: 3 cost time: 9.880512714385986
Epoch: 3, Steps: 89 | Train Loss: 0.593 Vali Loss: 0.819 Vali Acc: 0.903 Test Loss: 0.819 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 9.396352291107178
Epoch: 4, Steps: 89 | Train Loss: 0.485 Vali Loss: 0.933 Vali Acc: 0.907 Test Loss: 0.933 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 10.368920803070068
Epoch: 5, Steps: 89 | Train Loss: 0.426 Vali Loss: 0.619 Vali Acc: 0.944 Test Loss: 0.619 Test Acc: 0.944
Validation loss decreased (-0.907374 --> -0.944284).  Saving model ...
Epoch: 6 cost time: 9.910889148712158
Epoch: 6, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.071 Vali Acc: 0.930 Test Loss: 1.071 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 10.942728042602539
Epoch: 7, Steps: 89 | Train Loss: 0.328 Vali Loss: 0.455 Vali Acc: 0.973 Test Loss: 0.455 Test Acc: 0.973
Validation loss decreased (-0.944284 --> -0.972837).  Saving model ...
Epoch: 8 cost time: 10.625663042068481
Epoch: 8, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.580 Vali Acc: 0.961 Test Loss: 0.580 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.419470548629761
Epoch: 9, Steps: 89 | Train Loss: 0.201 Vali Loss: 1.027 Vali Acc: 0.935 Test Loss: 1.027 Test Acc: 0.935
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.070098161697388
Epoch: 10, Steps: 89 | Train Loss: 0.464 Vali Loss: 0.923 Vali Acc: 0.953 Test Loss: 0.923 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 10.758917331695557
Epoch: 11, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.683 Vali Acc: 0.962 Test Loss: 0.683 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.744103670120239
Epoch: 12, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.555 Vali Acc: 0.969 Test Loss: 0.555 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.114313364028931
Epoch: 13, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.489 Vali Acc: 0.974 Test Loss: 0.489 Test Acc: 0.974
Validation loss decreased (-0.972837 --> -0.973533).  Saving model ...
Epoch: 14 cost time: 4.358267784118652
Epoch: 14, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.517 Vali Acc: 0.978 Test Loss: 0.517 Test Acc: 0.978
Validation loss decreased (-0.973533 --> -0.977711).  Saving model ...
Epoch: 15 cost time: 10.350772857666016
Epoch: 15, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.942 Vali Acc: 0.963 Test Loss: 0.942 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 9.342580556869507
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.944 Vali Acc: 0.963 Test Loss: 0.944 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 9.473084926605225
Epoch: 17, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.678 Vali Acc: 0.969 Test Loss: 0.678 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 10.447847843170166
Epoch: 18, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.712 Vali Acc: 0.968 Test Loss: 0.712 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 9.119000673294067
Epoch: 19, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.818 Vali Acc: 0.971 Test Loss: 0.818 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 9.991255283355713
Epoch: 20, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.740 Vali Acc: 0.972 Test Loss: 0.740 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.807446002960205
Epoch: 21, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.693 Vali Acc: 0.974 Test Loss: 0.693 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.238629579544067
Epoch: 22, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.788 Vali Acc: 0.966 Test Loss: 0.788 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 9.057496070861816
Epoch: 23, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.730 Vali Acc: 0.971 Test Loss: 0.730 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 9.358136415481567
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.882 Vali Acc: 0.964 Test Loss: 0.882 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 3064396
model size : 21.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.868852376937866
Epoch: 1, Steps: 89 | Train Loss: 0.897 Vali Loss: 0.668 Vali Acc: 0.866 Test Loss: 0.668 Test Acc: 0.866
Validation loss decreased (inf --> -0.865592).  Saving model ...
Epoch: 2 cost time: 9.47981572151184
Epoch: 2, Steps: 89 | Train Loss: 0.467 Vali Loss: 0.448 Vali Acc: 0.923 Test Loss: 0.448 Test Acc: 0.923
Validation loss decreased (-0.865592 --> -0.923394).  Saving model ...
Epoch: 3 cost time: 8.735500812530518
Epoch: 3, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.673 Vali Acc: 0.925 Test Loss: 0.673 Test Acc: 0.925
Validation loss decreased (-0.923394 --> -0.924784).  Saving model ...
Epoch: 4 cost time: 8.596739053726196
Epoch: 4, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.460 Vali Acc: 0.946 Test Loss: 0.460 Test Acc: 0.946
Validation loss decreased (-0.924784 --> -0.946374).  Saving model ...
Epoch: 5 cost time: 9.111254215240479
Epoch: 5, Steps: 89 | Train Loss: 0.327 Vali Loss: 0.741 Vali Acc: 0.935 Test Loss: 0.741 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 9.765878200531006
Epoch: 6, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.322 Vali Acc: 0.974 Test Loss: 0.322 Test Acc: 0.974
Validation loss decreased (-0.946374 --> -0.973534).  Saving model ...
Epoch: 7 cost time: 6.661885976791382
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.454 Vali Acc: 0.964 Test Loss: 0.454 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 8.828957557678223
Epoch: 8, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.569 Vali Acc: 0.966 Test Loss: 0.569 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 9.573698282241821
Epoch: 9, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.569 Vali Acc: 0.967 Test Loss: 0.569 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.99632453918457
Epoch: 10, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.611 Vali Acc: 0.964 Test Loss: 0.611 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.634842157363892
Epoch: 11, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.758 Vali Acc: 0.969 Test Loss: 0.758 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.35567855834961
Epoch: 12, Steps: 89 | Train Loss: 0.188 Vali Loss: 1.089 Vali Acc: 0.960 Test Loss: 1.089 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 8.308655738830566
Epoch: 13, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.601 Vali Acc: 0.973 Test Loss: 0.601 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 7.498387336730957
Epoch: 14, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.800 Vali Acc: 0.970 Test Loss: 0.800 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.059789419174194
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.706 Vali Acc: 0.968 Test Loss: 0.706 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.962657928466797
Epoch: 16, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.273 Vali Acc: 0.943 Test Loss: 1.273 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 3064396
model size : 21.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.30768895149231
Epoch: 1, Steps: 89 | Train Loss: 0.815 Vali Loss: 0.372 Vali Acc: 0.921 Test Loss: 0.372 Test Acc: 0.921
Validation loss decreased (inf --> -0.921305).  Saving model ...
Epoch: 2 cost time: 4.338202714920044
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.387 Vali Acc: 0.926 Test Loss: 0.387 Test Acc: 0.926
Validation loss decreased (-0.921305 --> -0.926180).  Saving model ...
Epoch: 3 cost time: 7.27893853187561
Epoch: 3, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.519 Vali Acc: 0.936 Test Loss: 0.519 Test Acc: 0.936
Validation loss decreased (-0.926180 --> -0.935928).  Saving model ...
Epoch: 4 cost time: 6.894096851348877
Epoch: 4, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.595 Vali Acc: 0.931 Test Loss: 0.595 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.814608097076416
Epoch: 5, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.305 Vali Acc: 0.976 Test Loss: 0.305 Test Acc: 0.976
Validation loss decreased (-0.935928 --> -0.975624).  Saving model ...
Epoch: 6 cost time: 3.9244465827941895
Epoch: 6, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.433 Vali Acc: 0.962 Test Loss: 0.433 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.748341798782349
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.324 Vali Acc: 0.973 Test Loss: 0.324 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.014057159423828
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.473 Vali Acc: 0.958 Test Loss: 0.473 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 10.14751672744751
Epoch: 9, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.575 Vali Acc: 0.962 Test Loss: 0.575 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 10.863829135894775
Epoch: 10, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.399 Vali Acc: 0.970 Test Loss: 0.399 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 10.539205551147461
Epoch: 11, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.441 Vali Acc: 0.962 Test Loss: 0.441 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 10.302817106246948
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.482 Vali Acc: 0.970 Test Loss: 0.482 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 9.513304233551025
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.927 Vali Acc: 0.939 Test Loss: 0.927 Test Acc: 0.939
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 10.172515153884888
Epoch: 14, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.524 Vali Acc: 0.962 Test Loss: 0.524 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 11.105210065841675
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.568 Vali Acc: 0.965 Test Loss: 0.568 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 3064396
model size : 21.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.4009270668029785
Epoch: 1, Steps: 89 | Train Loss: 0.921 Vali Loss: 0.361 Vali Acc: 0.897 Test Loss: 0.361 Test Acc: 0.897
Validation loss decreased (inf --> -0.896932).  Saving model ...
Epoch: 2 cost time: 5.430240869522095
Epoch: 2, Steps: 89 | Train Loss: 0.293 Vali Loss: 0.505 Vali Acc: 0.886 Test Loss: 0.505 Test Acc: 0.886
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.922877788543701
Epoch: 3, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.314 Vali Acc: 0.949 Test Loss: 0.314 Test Acc: 0.949
Validation loss decreased (-0.896932 --> -0.949161).  Saving model ...
Epoch: 4 cost time: 9.60540509223938
Epoch: 4, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.879 Vali Acc: 0.920 Test Loss: 0.879 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 9.202070236206055
Epoch: 5, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.363 Vali Acc: 0.964 Test Loss: 0.363 Test Acc: 0.964
Validation loss decreased (-0.949161 --> -0.964481).  Saving model ...
Epoch: 6 cost time: 9.225701332092285
Epoch: 6, Steps: 89 | Train Loss: 0.139 Vali Loss: 1.215 Vali Acc: 0.916 Test Loss: 1.215 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 9.577706813812256
Epoch: 7, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.375 Vali Acc: 0.970 Test Loss: 0.375 Test Acc: 0.970
Validation loss decreased (-0.964481 --> -0.970052).  Saving model ...
Epoch: 8 cost time: 6.929244518280029
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.534 Vali Acc: 0.955 Test Loss: 0.534 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 8.171766519546509
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.526 Vali Acc: 0.939 Test Loss: 0.526 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 8.733505249023438
Epoch: 10, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.521 Vali Acc: 0.959 Test Loss: 0.521 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 8.671361207962036
Epoch: 11, Steps: 89 | Train Loss: 0.080 Vali Loss: 1.094 Vali Acc: 0.924 Test Loss: 1.094 Test Acc: 0.924
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 9.737487316131592
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.527 Vali Acc: 0.958 Test Loss: 0.527 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.763056516647339
Epoch: 13, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.569 Vali Acc: 0.960 Test Loss: 0.569 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.6944756507873535
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.666 Vali Acc: 0.942 Test Loss: 0.666 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 9.548067331314087
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.433 Vali Acc: 0.974 Test Loss: 0.433 Test Acc: 0.974
Validation loss decreased (-0.970052 --> -0.973533).  Saving model ...
Epoch: 16 cost time: 8.1460862159729
Epoch: 16, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.376 Vali Acc: 0.973 Test Loss: 0.376 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 8.524774312973022
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.639 Vali Acc: 0.958 Test Loss: 0.639 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.270586729049683
Epoch: 18, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.704 Vali Acc: 0.948 Test Loss: 0.704 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.4633166790008545
Epoch: 19, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.572 Vali Acc: 0.958 Test Loss: 0.572 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 8.285918951034546
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.572 Vali Acc: 0.959 Test Loss: 0.572 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.477373361587524
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.449 Vali Acc: 0.973 Test Loss: 0.449 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.101633787155151
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.437 Vali Acc: 0.975 Test Loss: 0.437 Test Acc: 0.975
Validation loss decreased (-0.973533 --> -0.974926).  Saving model ...
Epoch: 23 cost time: 7.561919450759888
Epoch: 23, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.644 Vali Acc: 0.964 Test Loss: 0.644 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 8.725462913513184
Epoch: 24, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.801 Vali Acc: 0.952 Test Loss: 0.801 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 5.865728378295898
Epoch: 25, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.616 Vali Acc: 0.971 Test Loss: 0.616 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.987057447433472
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.614 Vali Acc: 0.968 Test Loss: 0.614 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.638108253479004
Epoch: 27, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.564 Vali Acc: 0.971 Test Loss: 0.564 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.5347580909729
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.669 Vali Acc: 0.963 Test Loss: 0.669 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 7.651193141937256
Epoch: 29, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.611 Vali Acc: 0.971 Test Loss: 0.611 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 10.058472871780396
Epoch: 30, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.795 Vali Acc: 0.967 Test Loss: 0.795 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 10.158675193786621
Epoch: 31, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.908 Vali Acc: 0.958 Test Loss: 0.908 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 10.022064924240112
Epoch: 32, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.879 Vali Acc: 0.967 Test Loss: 0.879 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 3301708
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.96300458908081
Epoch: 1, Steps: 89 | Train Loss: 0.915 Vali Loss: 0.333 Vali Acc: 0.903 Test Loss: 0.333 Test Acc: 0.903
Validation loss decreased (inf --> -0.903200).  Saving model ...
Epoch: 2 cost time: 8.943033218383789
Epoch: 2, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.492 Vali Acc: 0.913 Test Loss: 0.492 Test Acc: 0.913
Validation loss decreased (-0.903200 --> -0.912948).  Saving model ...
Epoch: 3 cost time: 8.163486242294312
Epoch: 3, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.244 Vali Acc: 0.956 Test Loss: 0.244 Test Acc: 0.956
Validation loss decreased (-0.912948 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 8.526930809020996
Epoch: 4, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.510 Vali Acc: 0.923 Test Loss: 0.510 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.200327157974243
Epoch: 5, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.317 Vali Acc: 0.956 Test Loss: 0.317 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.673913955688477
Epoch: 6, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.612 Vali Acc: 0.940 Test Loss: 0.612 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 9.22393798828125
Epoch: 7, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.444 Vali Acc: 0.953 Test Loss: 0.444 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 8.070499181747437
Epoch: 8, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.346 Vali Acc: 0.967 Test Loss: 0.346 Test Acc: 0.967
Validation loss decreased (-0.956126 --> -0.966570).  Saving model ...
Epoch: 9 cost time: 10.137062311172485
Epoch: 9, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.302 Vali Acc: 0.970 Test Loss: 0.302 Test Acc: 0.970
Validation loss decreased (-0.966570 --> -0.970053).  Saving model ...
Epoch: 10 cost time: 9.922375917434692
Epoch: 10, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.472 Vali Acc: 0.964 Test Loss: 0.472 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.441228866577148
Epoch: 11, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.498 Vali Acc: 0.973 Test Loss: 0.498 Test Acc: 0.973
Validation loss decreased (-0.970053 --> -0.972836).  Saving model ...
Epoch: 12 cost time: 9.747481346130371
Epoch: 12, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.569 Vali Acc: 0.955 Test Loss: 0.569 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 9.688069105148315
Epoch: 13, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.318 Vali Acc: 0.974 Test Loss: 0.318 Test Acc: 0.974
Validation loss decreased (-0.972836 --> -0.974231).  Saving model ...
Epoch: 14 cost time: 9.840716361999512
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.571 Vali Acc: 0.962 Test Loss: 0.571 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 8.537657260894775
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.468 Vali Acc: 0.967 Test Loss: 0.468 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 10.345162630081177
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.486 Vali Acc: 0.971 Test Loss: 0.486 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 10.125534296035767
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.518 Vali Acc: 0.967 Test Loss: 0.518 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 9.638553857803345
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.775 Vali Acc: 0.965 Test Loss: 0.775 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.327483177185059
Epoch: 19, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.767 Vali Acc: 0.947 Test Loss: 0.767 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 9.979710340499878
Epoch: 20, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.540 Vali Acc: 0.973 Test Loss: 0.540 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 9.892014741897583
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.476 Vali Acc: 0.973 Test Loss: 0.476 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 9.778796672821045
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.536 Vali Acc: 0.966 Test Loss: 0.536 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 9.42606782913208
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.527 Vali Acc: 0.966 Test Loss: 0.527 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 3301708
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.668756008148193
Epoch: 1, Steps: 89 | Train Loss: 0.891 Vali Loss: 0.213 Vali Acc: 0.939 Test Loss: 0.213 Test Acc: 0.939
Validation loss decreased (inf --> -0.939413).  Saving model ...
Epoch: 2 cost time: 7.525549650192261
Epoch: 2, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.301 Vali Acc: 0.938 Test Loss: 0.301 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 6.035226821899414
Epoch: 3, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.334 Vali Acc: 0.947 Test Loss: 0.334 Test Acc: 0.947
Validation loss decreased (-0.939413 --> -0.947072).  Saving model ...
Epoch: 4 cost time: 8.34232759475708
Epoch: 4, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.645 Vali Acc: 0.916 Test Loss: 0.645 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 8.035116910934448
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.355 Vali Acc: 0.962 Test Loss: 0.355 Test Acc: 0.962
Validation loss decreased (-0.947072 --> -0.962392).  Saving model ...
Epoch: 6 cost time: 9.732845544815063
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.508 Vali Acc: 0.944 Test Loss: 0.508 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.626168489456177
Epoch: 7, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.287 Vali Acc: 0.971 Test Loss: 0.287 Test Acc: 0.971
Validation loss decreased (-0.962392 --> -0.971446).  Saving model ...
Epoch: 8 cost time: 9.288732051849365
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.256 Vali Acc: 0.971 Test Loss: 0.256 Test Acc: 0.971
Validation loss decreased (-0.971446 --> -0.971446).  Saving model ...
Epoch: 9 cost time: 9.860672950744629
Epoch: 9, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.309 Vali Acc: 0.974 Test Loss: 0.309 Test Acc: 0.974
Validation loss decreased (-0.971446 --> -0.974231).  Saving model ...
Epoch: 10 cost time: 9.98618221282959
Epoch: 10, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.257 Vali Acc: 0.971 Test Loss: 0.257 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 10.778024435043335
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.342 Vali Acc: 0.969 Test Loss: 0.342 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 9.279348611831665
Epoch: 12, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.430 Vali Acc: 0.960 Test Loss: 0.430 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 10.065617799758911
Epoch: 13, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.529 Vali Acc: 0.972 Test Loss: 0.529 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 10.540132761001587
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.498 Vali Acc: 0.963 Test Loss: 0.498 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 9.425144910812378
Epoch: 15, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.383 Vali Acc: 0.972 Test Loss: 0.383 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 9.656597375869751
Epoch: 16, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.543 Vali Acc: 0.964 Test Loss: 0.543 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 9.857312440872192
Epoch: 17, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.646 Vali Acc: 0.955 Test Loss: 0.646 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 7.98805832862854
Epoch: 18, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.536 Vali Acc: 0.961 Test Loss: 0.536 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 7.239811420440674
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.375 Vali Acc: 0.981 Test Loss: 0.375 Test Acc: 0.981
Validation loss decreased (-0.974231 --> -0.980498).  Saving model ...
Epoch: 20 cost time: 7.885179758071899
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.355 Vali Acc: 0.974 Test Loss: 0.355 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.175860404968262
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.377 Vali Acc: 0.973 Test Loss: 0.377 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.667286157608032
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.470 Vali Acc: 0.978 Test Loss: 0.470 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.9862470626831055
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.320 Vali Acc: 0.978 Test Loss: 0.320 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.869393825531006
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.474 Vali Acc: 0.979 Test Loss: 0.474 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.7684924602508545
Epoch: 25, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.420 Vali Acc: 0.982 Test Loss: 0.420 Test Acc: 0.982
Validation loss decreased (-0.980498 --> -0.981890).  Saving model ...
Epoch: 26 cost time: 8.437606573104858
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.419 Vali Acc: 0.981 Test Loss: 0.419 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 8.305344581604004
Epoch: 27, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.521 Vali Acc: 0.968 Test Loss: 0.521 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 7.518561840057373
Epoch: 28, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.443 Vali Acc: 0.978 Test Loss: 0.443 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 8.370301961898804
Epoch: 29, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.676 Vali Acc: 0.951 Test Loss: 0.676 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 7.627822399139404
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.550 Vali Acc: 0.971 Test Loss: 0.550 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 7.102205753326416
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.671 Vali Acc: 0.959 Test Loss: 0.671 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 7.000168085098267
Epoch: 32, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.465 Vali Acc: 0.974 Test Loss: 0.465 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 6.709753751754761
Epoch: 33, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.531 Vali Acc: 0.965 Test Loss: 0.531 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 4.405917167663574
Epoch: 34, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.388 Vali Acc: 0.969 Test Loss: 0.388 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.938401937484741
Epoch: 35, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.360 Vali Acc: 0.979 Test Loss: 0.360 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 3301708
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.812536716461182
Epoch: 1, Steps: 89 | Train Loss: 0.894 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (inf --> -0.937324).  Saving model ...
Epoch: 2 cost time: 3.5948777198791504
Epoch: 2, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
Validation loss decreased (-0.937324 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 7.634137153625488
Epoch: 3, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
Validation loss decreased (-0.944984 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 5.809453248977661
Epoch: 4, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.499 Vali Acc: 0.908 Test Loss: 0.499 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.559996604919434
Epoch: 5, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
Validation loss decreased (-0.955430 --> -0.965179).  Saving model ...
Epoch: 6 cost time: 3.8204855918884277
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.282 Vali Acc: 0.956 Test Loss: 0.282 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.7361109256744385
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.369 Vali Acc: 0.960 Test Loss: 0.369 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.467180252075195
Epoch: 8, Steps: 89 | Train Loss: 0.118 Vali Loss: 1.231 Vali Acc: 0.925 Test Loss: 1.231 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.760008811950684
Epoch: 9, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.351 Vali Acc: 0.958 Test Loss: 0.351 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.798994541168213
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.220 Vali Acc: 0.974 Test Loss: 0.220 Test Acc: 0.974
Validation loss decreased (-0.965179 --> -0.974232).  Saving model ...
Epoch: 11 cost time: 4.737924575805664
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.680 Vali Acc: 0.949 Test Loss: 0.680 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.75948691368103
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.277 Vali Acc: 0.969 Test Loss: 0.277 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.078278541564941
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.292 Vali Acc: 0.974 Test Loss: 0.292 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 9.151276111602783
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.286 Vali Acc: 0.969 Test Loss: 0.286 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.625030517578125
Epoch: 15, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.297 Vali Acc: 0.973 Test Loss: 0.297 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 9.319029331207275
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.486 Vali Acc: 0.952 Test Loss: 0.486 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 9.07854175567627
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.372 Vali Acc: 0.963 Test Loss: 0.372 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 10.415674686431885
Epoch: 18, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.404 Vali Acc: 0.968 Test Loss: 0.404 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 9.451633214950562
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.310 Vali Acc: 0.977 Test Loss: 0.310 Test Acc: 0.977
Validation loss decreased (-0.974232 --> -0.977016).  Saving model ...
Epoch: 20 cost time: 10.34592890739441
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.378 Vali Acc: 0.969 Test Loss: 0.378 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.3021252155303955
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.352 Vali Acc: 0.967 Test Loss: 0.352 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 8.852638721466064
Epoch: 22, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.458 Vali Acc: 0.964 Test Loss: 0.458 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 8.437044143676758
Epoch: 23, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.302 Vali Acc: 0.978 Test Loss: 0.302 Test Acc: 0.978
Validation loss decreased (-0.977016 --> -0.977713).  Saving model ...
Epoch: 24 cost time: 9.14952540397644
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.401 Vali Acc: 0.969 Test Loss: 0.401 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 9.274343490600586
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.364 Vali Acc: 0.979 Test Loss: 0.364 Test Acc: 0.979
Validation loss decreased (-0.977713 --> -0.979105).  Saving model ...
Epoch: 26 cost time: 8.803505659103394
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.395 Vali Acc: 0.973 Test Loss: 0.395 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 9.013547420501709
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.362 Vali Acc: 0.974 Test Loss: 0.362 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 8.59479570388794
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.401 Vali Acc: 0.969 Test Loss: 0.401 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 9.039798498153687
Epoch: 29, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.445 Vali Acc: 0.966 Test Loss: 0.445 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 8.352985382080078
Epoch: 30, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.341 Vali Acc: 0.981 Test Loss: 0.341 Test Acc: 0.981
Validation loss decreased (-0.979105 --> -0.980498).  Saving model ...
Epoch: 31 cost time: 8.627984285354614
Epoch: 31, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.394 Vali Acc: 0.977 Test Loss: 0.394 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 8.10344648361206
Epoch: 32, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.354 Vali Acc: 0.978 Test Loss: 0.354 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.763994932174683
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.372 Vali Acc: 0.978 Test Loss: 0.372 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 9.259962797164917
Epoch: 34, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.454 Vali Acc: 0.967 Test Loss: 0.454 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 8.160054206848145
Epoch: 35, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.470 Vali Acc: 0.965 Test Loss: 0.470 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 10.128895044326782
Epoch: 36, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.506 Vali Acc: 0.967 Test Loss: 0.506 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 9.27549695968628
Epoch: 37, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.390 Vali Acc: 0.975 Test Loss: 0.390 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 8.29865050315857
Epoch: 38, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.402 Vali Acc: 0.975 Test Loss: 0.402 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 9.03381061553955
Epoch: 39, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.398 Vali Acc: 0.971 Test Loss: 0.398 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 9.683223485946655
Epoch: 40, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.366 Vali Acc: 0.973 Test Loss: 0.366 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 3301708
model size : 17.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.37333869934082
Epoch: 1, Steps: 89 | Train Loss: 0.904 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (inf --> -0.918521).  Saving model ...
Epoch: 2 cost time: 8.173885822296143
Epoch: 2, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.272 Vali Acc: 0.942 Test Loss: 0.272 Test Acc: 0.942
Validation loss decreased (-0.918521 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 6.222311973571777
Epoch: 3, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.387 Vali Acc: 0.927 Test Loss: 0.387 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.0455322265625
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.446 Vali Acc: 0.947 Test Loss: 0.446 Test Acc: 0.947
Validation loss decreased (-0.942198 --> -0.947071).  Saving model ...
Epoch: 5 cost time: 7.256551742553711
Epoch: 5, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.583 Vali Acc: 0.925 Test Loss: 0.583 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.858951807022095
Epoch: 6, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.263 Vali Acc: 0.969 Test Loss: 0.263 Test Acc: 0.969
Validation loss decreased (-0.947071 --> -0.968660).  Saving model ...
Epoch: 7 cost time: 4.030029535293579
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.379 Vali Acc: 0.969 Test Loss: 0.379 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.141864538192749
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.393 Vali Acc: 0.961 Test Loss: 0.393 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.6073830127716064
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.574 Vali Acc: 0.935 Test Loss: 0.574 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 8.139963626861572
Epoch: 10, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.588 Vali Acc: 0.948 Test Loss: 0.588 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 9.615789413452148
Epoch: 11, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.654 Vali Acc: 0.948 Test Loss: 0.654 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 8.589051246643066
Epoch: 12, Steps: 89 | Train Loss: 0.176 Vali Loss: 1.137 Vali Acc: 0.909 Test Loss: 1.137 Test Acc: 0.909
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 9.08218240737915
Epoch: 13, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.624 Vali Acc: 0.960 Test Loss: 0.624 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 9.05159306526184
Epoch: 14, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.809 Vali Acc: 0.946 Test Loss: 0.809 Test Acc: 0.946
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 8.047959566116333
Epoch: 15, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.537 Vali Acc: 0.961 Test Loss: 0.537 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.752024173736572
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.493 Vali Acc: 0.969 Test Loss: 0.493 Test Acc: 0.969
Validation loss decreased (-0.968660 --> -0.969354).  Saving model ...
Epoch: 17 cost time: 8.22079849243164
Epoch: 17, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.629 Vali Acc: 0.953 Test Loss: 0.629 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 9.024147272109985
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.589 Vali Acc: 0.957 Test Loss: 0.589 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 8.149985074996948
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.638 Vali Acc: 0.961 Test Loss: 0.638 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 8.9273099899292
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.843 Vali Acc: 0.958 Test Loss: 0.843 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 9.413877725601196
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.584 Vali Acc: 0.966 Test Loss: 0.584 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 8.691686153411865
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.569 Vali Acc: 0.967 Test Loss: 0.569 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 8.591635704040527
Epoch: 23, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.650 Vali Acc: 0.969 Test Loss: 0.650 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 8.75495958328247
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.524 Vali Acc: 0.971 Test Loss: 0.524 Test Acc: 0.971
Validation loss decreased (-0.969354 --> -0.970747).  Saving model ...
Epoch: 25 cost time: 5.115068197250366
Epoch: 25, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.814 Vali Acc: 0.956 Test Loss: 0.814 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 9.88686227798462
Epoch: 26, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.828 Vali Acc: 0.951 Test Loss: 0.828 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 9.479806184768677
Epoch: 27, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.678 Vali Acc: 0.960 Test Loss: 0.678 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 9.891632795333862
Epoch: 28, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.602 Vali Acc: 0.968 Test Loss: 0.602 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 9.275399446487427
Epoch: 29, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.799 Vali Acc: 0.959 Test Loss: 0.799 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 9.606765508651733
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.639 Vali Acc: 0.969 Test Loss: 0.639 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 8.691304206848145
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.977 Vali Acc: 0.948 Test Loss: 0.977 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 9.650768756866455
Epoch: 32, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.667 Vali Acc: 0.971 Test Loss: 0.667 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 9.268847465515137
Epoch: 33, Steps: 89 | Train Loss: 0.086 Vali Loss: 1.027 Vali Acc: 0.937 Test Loss: 1.027 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 9.095427513122559
Epoch: 34, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.727 Vali Acc: 0.969 Test Loss: 0.727 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 2253132
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.116493701934814
Epoch: 1, Steps: 89 | Train Loss: 0.897 Vali Loss: 0.299 Vali Acc: 0.921 Test Loss: 0.299 Test Acc: 0.921
Validation loss decreased (inf --> -0.921306).  Saving model ...
Epoch: 2 cost time: 8.866395711898804
Epoch: 2, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.368 Vali Acc: 0.923 Test Loss: 0.368 Test Acc: 0.923
Validation loss decreased (-0.921306 --> -0.922698).  Saving model ...
Epoch: 3 cost time: 6.262547969818115
Epoch: 3, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.357 Vali Acc: 0.944 Test Loss: 0.357 Test Acc: 0.944
Validation loss decreased (-0.922698 --> -0.943590).  Saving model ...
Epoch: 4 cost time: 8.634251594543457
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.406 Vali Acc: 0.942 Test Loss: 0.406 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.9689249992370605
Epoch: 5, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.263 Vali Acc: 0.960 Test Loss: 0.263 Test Acc: 0.960
Validation loss decreased (-0.943590 --> -0.960304).  Saving model ...
Epoch: 6 cost time: 8.504756450653076
Epoch: 6, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.305 Vali Acc: 0.964 Test Loss: 0.305 Test Acc: 0.964
Validation loss decreased (-0.960304 --> -0.963785).  Saving model ...
Epoch: 7 cost time: 7.91015887260437
Epoch: 7, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.384 Vali Acc: 0.951 Test Loss: 0.384 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.374366760253906
Epoch: 8, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.352 Vali Acc: 0.967 Test Loss: 0.352 Test Acc: 0.967
Validation loss decreased (-0.963785 --> -0.967267).  Saving model ...
Epoch: 9 cost time: 6.113284587860107
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.405 Vali Acc: 0.967 Test Loss: 0.405 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 8.574710845947266
Epoch: 10, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.547 Vali Acc: 0.958 Test Loss: 0.547 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 8.481728076934814
Epoch: 11, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.479 Vali Acc: 0.958 Test Loss: 0.479 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.890729427337646
Epoch: 12, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.674 Vali Acc: 0.951 Test Loss: 0.674 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.877633333206177
Epoch: 13, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.457 Vali Acc: 0.960 Test Loss: 0.457 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 9.06339168548584
Epoch: 14, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.509 Vali Acc: 0.965 Test Loss: 0.509 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 7.315264701843262
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.354 Vali Acc: 0.980 Test Loss: 0.354 Test Acc: 0.980
Validation loss decreased (-0.967267 --> -0.979801).  Saving model ...
Epoch: 16 cost time: 8.426547288894653
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.433 Vali Acc: 0.973 Test Loss: 0.433 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.321085691452026
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.411 Vali Acc: 0.978 Test Loss: 0.411 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 10.108834505081177
Epoch: 18, Steps: 89 | Train Loss: 0.078 Vali Loss: 1.510 Vali Acc: 0.917 Test Loss: 1.510 Test Acc: 0.917
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 10.312361717224121
Epoch: 19, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.477 Vali Acc: 0.973 Test Loss: 0.477 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 9.202621698379517
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.598 Vali Acc: 0.973 Test Loss: 0.598 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 10.848047256469727
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.500 Vali Acc: 0.977 Test Loss: 0.500 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 9.901145696640015
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.627 Vali Acc: 0.964 Test Loss: 0.627 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 8.409745931625366
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.526 Vali Acc: 0.969 Test Loss: 0.526 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 7.441721677780151
Epoch: 24, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.375 Vali Acc: 0.976 Test Loss: 0.375 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 9.34500503540039
Epoch: 25, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.592 Vali Acc: 0.969 Test Loss: 0.592 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 2253132
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 11.346364736557007
Epoch: 1, Steps: 89 | Train Loss: 0.879 Vali Loss: 0.261 Vali Acc: 0.925 Test Loss: 0.261 Test Acc: 0.925
Validation loss decreased (inf --> -0.925485).  Saving model ...
Epoch: 2 cost time: 7.527472257614136
Epoch: 2, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.235 Vali Acc: 0.942 Test Loss: 0.235 Test Acc: 0.942
Validation loss decreased (-0.925485 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 7.471731185913086
Epoch: 3, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.246 Vali Acc: 0.959 Test Loss: 0.246 Test Acc: 0.959
Validation loss decreased (-0.942198 --> -0.958911).  Saving model ...
Epoch: 4 cost time: 7.575162172317505
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
Validation loss decreased (-0.958911 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 6.725850343704224
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.409 Vali Acc: 0.939 Test Loss: 0.409 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 7.438209056854248
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.415 Vali Acc: 0.945 Test Loss: 0.415 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 7.2591233253479
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.571 Vali Acc: 0.921 Test Loss: 0.571 Test Acc: 0.921
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.316378355026245
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971446).  Saving model ...
Epoch: 9 cost time: 7.429731130599976
Epoch: 9, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.288 Vali Acc: 0.969 Test Loss: 0.288 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.922040939331055
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.587 Vali Acc: 0.955 Test Loss: 0.587 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 7.805362224578857
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.286 Vali Acc: 0.969 Test Loss: 0.286 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 8.024215698242188
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.323 Vali Acc: 0.968 Test Loss: 0.323 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 8.221065998077393
Epoch: 13, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.287 Vali Acc: 0.974 Test Loss: 0.287 Test Acc: 0.974
Validation loss decreased (-0.971446 --> -0.973535).  Saving model ...
Epoch: 14 cost time: 7.760692358016968
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.376 Vali Acc: 0.970 Test Loss: 0.376 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 7.781799554824829
Epoch: 15, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.651 Vali Acc: 0.949 Test Loss: 0.651 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 7.55055046081543
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.351 Vali Acc: 0.971 Test Loss: 0.351 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 7.369435548782349
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.323 Vali Acc: 0.981 Test Loss: 0.323 Test Acc: 0.981
Validation loss decreased (-0.973535 --> -0.980498).  Saving model ...
Epoch: 18 cost time: 7.220004081726074
Epoch: 18, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.458 Vali Acc: 0.962 Test Loss: 0.458 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 8.888773918151855
Epoch: 19, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.471 Vali Acc: 0.969 Test Loss: 0.471 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 8.347582340240479
Epoch: 20, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.510 Vali Acc: 0.976 Test Loss: 0.510 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 8.633737325668335
Epoch: 21, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.434 Vali Acc: 0.981 Test Loss: 0.434 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 8.189629554748535
Epoch: 22, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.434 Vali Acc: 0.978 Test Loss: 0.434 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 8.10149335861206
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.478 Vali Acc: 0.971 Test Loss: 0.478 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 8.435909748077393
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.370 Vali Acc: 0.978 Test Loss: 0.370 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.980355739593506
Epoch: 25, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.376 Vali Acc: 0.981 Test Loss: 0.376 Test Acc: 0.981
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 7.662435293197632
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.506 Vali Acc: 0.979 Test Loss: 0.506 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 7.511906147003174
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.463 Vali Acc: 0.979 Test Loss: 0.463 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 2253132
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.652648687362671
Epoch: 1, Steps: 89 | Train Loss: 0.861 Vali Loss: 0.229 Vali Acc: 0.935 Test Loss: 0.229 Test Acc: 0.935
Validation loss decreased (inf --> -0.935234).  Saving model ...
Epoch: 2 cost time: 7.703686237335205
Epoch: 2, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.935234 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 7.533502578735352
Epoch: 3, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.948466 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 7.996537923812866
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.990998983383179
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.242 Vali Acc: 0.963 Test Loss: 0.242 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 8.13541293144226
Epoch: 6, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.319 Vali Acc: 0.960 Test Loss: 0.319 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.770171642303467
Epoch: 7, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.195 Vali Acc: 0.969 Test Loss: 0.195 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 7.840646505355835
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.217 Vali Acc: 0.969 Test Loss: 0.217 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 8.14949655532837
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.237 Vali Acc: 0.966 Test Loss: 0.237 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 8.320132970809937
Epoch: 10, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.379 Vali Acc: 0.962 Test Loss: 0.379 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.791544675827026
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.402 Vali Acc: 0.960 Test Loss: 0.402 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 8.271029710769653
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.262 Vali Acc: 0.974 Test Loss: 0.262 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.973535).  Saving model ...
Epoch: 13 cost time: 7.4629740715026855
Epoch: 13, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.290554523468018
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.224 Vali Acc: 0.980 Test Loss: 0.224 Test Acc: 0.980
Validation loss decreased (-0.973535 --> -0.979803).  Saving model ...
Epoch: 15 cost time: 6.534573793411255
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.259 Vali Acc: 0.974 Test Loss: 0.259 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 8.076482057571411
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.243 Vali Acc: 0.973 Test Loss: 0.243 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 7.978250741958618
Epoch: 17, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.327 Vali Acc: 0.962 Test Loss: 0.327 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.768537521362305
Epoch: 18, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.224 Vali Acc: 0.973 Test Loss: 0.224 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 8.049429416656494
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.263 Vali Acc: 0.971 Test Loss: 0.263 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 8.096896886825562
Epoch: 20, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.197 Vali Acc: 0.981 Test Loss: 0.197 Test Acc: 0.981
Validation loss decreased (-0.979803 --> -0.981196).  Saving model ...
Epoch: 21 cost time: 6.824553489685059
Epoch: 21, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 8.424888372421265
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.976 Test Loss: 0.184 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 9.203334093093872
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.286 Vali Acc: 0.972 Test Loss: 0.286 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 8.51585602760315
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.246 Vali Acc: 0.978 Test Loss: 0.246 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 8.381908178329468
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.494 Vali Acc: 0.969 Test Loss: 0.494 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 8.710397243499756
Epoch: 26, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.534 Vali Acc: 0.962 Test Loss: 0.534 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 9.403856992721558
Epoch: 27, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.370 Vali Acc: 0.967 Test Loss: 0.370 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 9.611004829406738
Epoch: 28, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.326 Vali Acc: 0.973 Test Loss: 0.326 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 8.272408485412598
Epoch: 29, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.294 Vali Acc: 0.975 Test Loss: 0.294 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 8.515507698059082
Epoch: 30, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.241 Vali Acc: 0.980 Test Loss: 0.241 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 2253132
model size : 13.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 10.145345687866211
Epoch: 1, Steps: 89 | Train Loss: 0.893 Vali Loss: 0.349 Vali Acc: 0.897 Test Loss: 0.349 Test Acc: 0.897
Validation loss decreased (inf --> -0.896932).  Saving model ...
Epoch: 2 cost time: 8.333181381225586
Epoch: 2, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.565 Vali Acc: 0.881 Test Loss: 0.565 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.326669216156006
Epoch: 3, Steps: 89 | Train Loss: 0.220 Vali Loss: 0.320 Vali Acc: 0.936 Test Loss: 0.320 Test Acc: 0.936
Validation loss decreased (-0.896932 --> -0.935930).  Saving model ...
Epoch: 4 cost time: 6.6507720947265625
Epoch: 4, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.350 Vali Acc: 0.947 Test Loss: 0.350 Test Acc: 0.947
Validation loss decreased (-0.935930 --> -0.947072).  Saving model ...
Epoch: 5 cost time: 7.363101005554199
Epoch: 5, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.428 Vali Acc: 0.951 Test Loss: 0.428 Test Acc: 0.951
Validation loss decreased (-0.947072 --> -0.950553).  Saving model ...
Epoch: 6 cost time: 6.009831428527832
Epoch: 6, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.408 Vali Acc: 0.949 Test Loss: 0.408 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.876779556274414
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.636 Vali Acc: 0.925 Test Loss: 0.636 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.741909980773926
Epoch: 8, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.472 Vali Acc: 0.953 Test Loss: 0.472 Test Acc: 0.953
Validation loss decreased (-0.950553 --> -0.952642).  Saving model ...
Epoch: 9 cost time: 8.3245210647583
Epoch: 9, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.577 Vali Acc: 0.957 Test Loss: 0.577 Test Acc: 0.957
Validation loss decreased (-0.952642 --> -0.956819).  Saving model ...
Epoch: 10 cost time: 8.047456502914429
Epoch: 10, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.616 Vali Acc: 0.950 Test Loss: 0.616 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.579548358917236
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.509 Vali Acc: 0.964 Test Loss: 0.509 Test Acc: 0.964
Validation loss decreased (-0.956819 --> -0.963783).  Saving model ...
Epoch: 12 cost time: 7.767634153366089
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.597 Vali Acc: 0.967 Test Loss: 0.597 Test Acc: 0.967
Validation loss decreased (-0.963783 --> -0.967264).  Saving model ...
Epoch: 13 cost time: 7.608872652053833
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.568 Vali Acc: 0.964 Test Loss: 0.568 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 7.957861423492432
Epoch: 14, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.788 Vali Acc: 0.944 Test Loss: 0.788 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 8.520636081695557
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.492 Vali Acc: 0.968 Test Loss: 0.492 Test Acc: 0.968
Validation loss decreased (-0.967264 --> -0.967962).  Saving model ...
Epoch: 16 cost time: 5.941519498825073
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.592 Vali Acc: 0.955 Test Loss: 0.592 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.773013353347778
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.610 Vali Acc: 0.958 Test Loss: 0.610 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.871120929718018
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.451 Vali Acc: 0.969 Test Loss: 0.451 Test Acc: 0.969
Validation loss decreased (-0.967962 --> -0.968658).  Saving model ...
Epoch: 19 cost time: 7.138599872589111
Epoch: 19, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.711 Vali Acc: 0.955 Test Loss: 0.711 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 7.802993059158325
Epoch: 20, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.815 Vali Acc: 0.955 Test Loss: 0.815 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 7.17576003074646
Epoch: 21, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.579 Vali Acc: 0.968 Test Loss: 0.579 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 7.249128341674805
Epoch: 22, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.618 Vali Acc: 0.969 Test Loss: 0.618 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 8.268839597702026
Epoch: 23, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.745 Vali Acc: 0.959 Test Loss: 0.745 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 7.8138415813446045
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.507 Vali Acc: 0.969 Test Loss: 0.507 Test Acc: 0.969
Validation loss decreased (-0.968658 --> -0.969354).  Saving model ...
Epoch: 25 cost time: 8.112107515335083
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.626 Vali Acc: 0.960 Test Loss: 0.626 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.175832271575928
Epoch: 26, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.582 Vali Acc: 0.966 Test Loss: 0.582 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 7.766194105148315
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.527 Vali Acc: 0.974 Test Loss: 0.527 Test Acc: 0.974
Validation loss decreased (-0.969354 --> -0.974229).  Saving model ...
Epoch: 28 cost time: 7.701059103012085
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.645 Vali Acc: 0.964 Test Loss: 0.645 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 7.91938042640686
Epoch: 29, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.619 Vali Acc: 0.974 Test Loss: 0.619 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.5339272022247314
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.602 Vali Acc: 0.971 Test Loss: 0.602 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 7.232342720031738
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.599 Vali Acc: 0.971 Test Loss: 0.599 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.76236629486084
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.563 Vali Acc: 0.976 Test Loss: 0.563 Test Acc: 0.976
Validation loss decreased (-0.974229 --> -0.975621).  Saving model ...
Epoch: 33 cost time: 9.040623903274536
Epoch: 33, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.583 Vali Acc: 0.977 Test Loss: 0.583 Test Acc: 0.977
Validation loss decreased (-0.975621 --> -0.977014).  Saving model ...
Epoch: 34 cost time: 8.921897888183594
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.619 Vali Acc: 0.971 Test Loss: 0.619 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 8.75422215461731
Epoch: 35, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.575 Vali Acc: 0.972 Test Loss: 0.575 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 9.446380376815796
Epoch: 36, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.754 Vali Acc: 0.969 Test Loss: 0.754 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 8.881379127502441
Epoch: 37, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.761 Vali Acc: 0.964 Test Loss: 0.761 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 8.188755750656128
Epoch: 38, Steps: 89 | Train Loss: 0.042 Vali Loss: 1.037 Vali Acc: 0.953 Test Loss: 1.037 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 7.765584468841553
Epoch: 39, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.954 Vali Acc: 0.963 Test Loss: 0.954 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 7.8339667320251465
Epoch: 40, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.763 Vali Acc: 0.968 Test Loss: 0.763 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 7.217972278594971
Epoch: 41, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.931 Vali Acc: 0.958 Test Loss: 0.931 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 8.741918802261353
Epoch: 42, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.834 Vali Acc: 0.965 Test Loss: 0.834 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 8.601666688919067
Epoch: 43, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.938 Vali Acc: 0.964 Test Loss: 0.938 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1728844
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.123073816299438
Epoch: 1, Steps: 89 | Train Loss: 0.886 Vali Loss: 0.349 Vali Acc: 0.900 Test Loss: 0.349 Test Acc: 0.900
Validation loss decreased (inf --> -0.899718).  Saving model ...
Epoch: 2 cost time: 7.978679418563843
Epoch: 2, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.470 Vali Acc: 0.896 Test Loss: 0.470 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 7.525507926940918
Epoch: 3, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.268 Vali Acc: 0.951 Test Loss: 0.268 Test Acc: 0.951
Validation loss decreased (-0.899718 --> -0.951251).  Saving model ...
Epoch: 4 cost time: 7.175148010253906
Epoch: 4, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.429 Vali Acc: 0.920 Test Loss: 0.429 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.796741485595703
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.619 Vali Acc: 0.921 Test Loss: 0.619 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 7.599839210510254
Epoch: 6, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.401 Vali Acc: 0.961 Test Loss: 0.401 Test Acc: 0.961
Validation loss decreased (-0.951251 --> -0.960999).  Saving model ...
Epoch: 7 cost time: 6.557072877883911
Epoch: 7, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.520 Vali Acc: 0.949 Test Loss: 0.520 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.342108964920044
Epoch: 8, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.383 Vali Acc: 0.974 Test Loss: 0.383 Test Acc: 0.974
Validation loss decreased (-0.960999 --> -0.973534).  Saving model ...
Epoch: 9 cost time: 7.315104246139526
Epoch: 9, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.676 Vali Acc: 0.938 Test Loss: 0.676 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.169853925704956
Epoch: 10, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.445 Vali Acc: 0.967 Test Loss: 0.445 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.883707284927368
Epoch: 11, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.477 Vali Acc: 0.965 Test Loss: 0.477 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.054712295532227
Epoch: 12, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.440 Vali Acc: 0.966 Test Loss: 0.440 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.981254816055298
Epoch: 13, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.632 Vali Acc: 0.962 Test Loss: 0.632 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.909603595733643
Epoch: 14, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.583 Vali Acc: 0.962 Test Loss: 0.583 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 8.177661180496216
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.612 Vali Acc: 0.966 Test Loss: 0.612 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 8.516179084777832
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.604 Vali Acc: 0.963 Test Loss: 0.604 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.686646938323975
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.567 Vali Acc: 0.966 Test Loss: 0.567 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 6.421070098876953
Epoch: 18, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.497 Vali Acc: 0.974 Test Loss: 0.497 Test Acc: 0.974
Validation loss decreased (-0.973534 --> -0.974229).  Saving model ...
Epoch: 19 cost time: 7.660081386566162
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.516 Vali Acc: 0.969 Test Loss: 0.516 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 8.17856740951538
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.483 Vali Acc: 0.971 Test Loss: 0.483 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 8.173696041107178
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.440 Vali Acc: 0.976 Test Loss: 0.440 Test Acc: 0.976
Validation loss decreased (-0.974229 --> -0.976319).  Saving model ...
Epoch: 22 cost time: 7.183891534805298
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.453 Vali Acc: 0.974 Test Loss: 0.453 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 7.609018802642822
Epoch: 23, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.542 Vali Acc: 0.976 Test Loss: 0.542 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 6.789463758468628
Epoch: 24, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.519 Vali Acc: 0.968 Test Loss: 0.519 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 6.719365835189819
Epoch: 25, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.490 Vali Acc: 0.974 Test Loss: 0.490 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 7.012607097625732
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 1.045 Vali Acc: 0.938 Test Loss: 1.045 Test Acc: 0.938
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 7.055527925491333
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.427 Vali Acc: 0.974 Test Loss: 0.427 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 7.283006191253662
Epoch: 28, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.572 Vali Acc: 0.972 Test Loss: 0.572 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 6.6521666049957275
Epoch: 29, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.528 Vali Acc: 0.971 Test Loss: 0.528 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 6.031790494918823
Epoch: 30, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.391 Vali Acc: 0.978 Test Loss: 0.391 Test Acc: 0.978
Validation loss decreased (-0.976319 --> -0.977712).  Saving model ...
Epoch: 31 cost time: 7.136462450027466
Epoch: 31, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.582 Vali Acc: 0.967 Test Loss: 0.582 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.503192663192749
Epoch: 32, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.391 Vali Acc: 0.978 Test Loss: 0.391 Test Acc: 0.978
Validation loss decreased (-0.977712 --> -0.978408).  Saving model ...
Epoch: 33 cost time: 6.926124811172485
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.414 Vali Acc: 0.976 Test Loss: 0.414 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 7.067942380905151
Epoch: 34, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.581 Vali Acc: 0.966 Test Loss: 0.581 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.744082927703857
Epoch: 35, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.442 Vali Acc: 0.972 Test Loss: 0.442 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 6.8696980476379395
Epoch: 36, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.504 Vali Acc: 0.971 Test Loss: 0.504 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 6.723729848861694
Epoch: 37, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.368 Vali Acc: 0.982 Test Loss: 0.368 Test Acc: 0.982
Validation loss decreased (-0.978408 --> -0.981890).  Saving model ...
Epoch: 38 cost time: 6.918290615081787
Epoch: 38, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.483 Vali Acc: 0.974 Test Loss: 0.483 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.477105617523193
Epoch: 39, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.519 Vali Acc: 0.974 Test Loss: 0.519 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 6.5834619998931885
Epoch: 40, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.439 Vali Acc: 0.978 Test Loss: 0.439 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 6.826725721359253
Epoch: 41, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.435 Vali Acc: 0.980 Test Loss: 0.435 Test Acc: 0.980
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 6.991392135620117
Epoch: 42, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.650 Vali Acc: 0.970 Test Loss: 0.650 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 7.071102857589722
Epoch: 43, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.561 Vali Acc: 0.975 Test Loss: 0.561 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 6.813259601593018
Epoch: 44, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.653 Vali Acc: 0.976 Test Loss: 0.653 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 6.460846900939941
Epoch: 45, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.627 Vali Acc: 0.971 Test Loss: 0.627 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 5.863579511642456
Epoch: 46, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.646 Vali Acc: 0.976 Test Loss: 0.646 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 7.197331190109253
Epoch: 47, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.763 Vali Acc: 0.964 Test Loss: 0.763 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 1728844
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.519133806228638
Epoch: 1, Steps: 89 | Train Loss: 0.875 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (inf --> -0.919217).  Saving model ...
Epoch: 2 cost time: 7.03922700881958
Epoch: 2, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.272 Vali Acc: 0.931 Test Loss: 0.272 Test Acc: 0.931
Validation loss decreased (-0.919217 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 6.723465919494629
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.255 Vali Acc: 0.955 Test Loss: 0.255 Test Acc: 0.955
Validation loss decreased (-0.931056 --> -0.954733).  Saving model ...
Epoch: 4 cost time: 6.209472417831421
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.368 Vali Acc: 0.940 Test Loss: 0.368 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.276051998138428
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.296 Vali Acc: 0.966 Test Loss: 0.296 Test Acc: 0.966
Validation loss decreased (-0.954733 --> -0.965874).  Saving model ...
Epoch: 6 cost time: 7.228602647781372
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.269 Vali Acc: 0.956 Test Loss: 0.269 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.725806713104248
Epoch: 7, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.392 Vali Acc: 0.955 Test Loss: 0.392 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.51944899559021
Epoch: 8, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.535 Vali Acc: 0.951 Test Loss: 0.535 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 5.753790378570557
Epoch: 9, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.433 Vali Acc: 0.961 Test Loss: 0.433 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.162399053573608
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.353 Vali Acc: 0.971 Test Loss: 0.353 Test Acc: 0.971
Validation loss decreased (-0.965874 --> -0.971445).  Saving model ...
Epoch: 11 cost time: 6.698222875595093
Epoch: 11, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.371 Vali Acc: 0.962 Test Loss: 0.371 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.298127174377441
Epoch: 12, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.398 Vali Acc: 0.969 Test Loss: 0.398 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.503676176071167
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.532 Vali Acc: 0.960 Test Loss: 0.532 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.846849679946899
Epoch: 14, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.903 Vali Acc: 0.940 Test Loss: 0.903 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.893186092376709
Epoch: 15, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.653 Vali Acc: 0.952 Test Loss: 0.653 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.241100549697876
Epoch: 16, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.378 Vali Acc: 0.973 Test Loss: 0.378 Test Acc: 0.973
Validation loss decreased (-0.971445 --> -0.972837).  Saving model ...
Epoch: 17 cost time: 7.298739910125732
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.410 Vali Acc: 0.970 Test Loss: 0.410 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.401731014251709
Epoch: 18, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.455 Vali Acc: 0.961 Test Loss: 0.455 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 6.917149066925049
Epoch: 19, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.556 Vali Acc: 0.970 Test Loss: 0.556 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.808533430099487
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.427 Vali Acc: 0.981 Test Loss: 0.427 Test Acc: 0.981
Validation loss decreased (-0.972837 --> -0.980497).  Saving model ...
Epoch: 21 cost time: 6.861786365509033
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.978 Test Loss: 0.408 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.618976354598999
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.408 Vali Acc: 0.978 Test Loss: 0.408 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.863837242126465
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.408 Vali Acc: 0.981 Test Loss: 0.408 Test Acc: 0.981
Validation loss decreased (-0.980497 --> -0.980497).  Saving model ...
Epoch: 24 cost time: 5.954550504684448
Epoch: 24, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.421 Vali Acc: 0.981 Test Loss: 0.421 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.496400356292725
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.521 Vali Acc: 0.967 Test Loss: 0.521 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.57400107383728
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.485 Vali Acc: 0.964 Test Loss: 0.485 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.804487228393555
Epoch: 27, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.448 Vali Acc: 0.976 Test Loss: 0.448 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.680726528167725
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.526 Vali Acc: 0.976 Test Loss: 0.526 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 6.584207057952881
Epoch: 29, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.516 Vali Acc: 0.973 Test Loss: 0.516 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 6.890997886657715
Epoch: 30, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.346 Vali Acc: 0.983 Test Loss: 0.346 Test Acc: 0.983
Validation loss decreased (-0.980497 --> -0.983283).  Saving model ...
Epoch: 31 cost time: 6.980384349822998
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.473 Vali Acc: 0.976 Test Loss: 0.473 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 6.7570695877075195
Epoch: 32, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.429 Vali Acc: 0.982 Test Loss: 0.429 Test Acc: 0.982
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 6.810956001281738
Epoch: 33, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.486 Vali Acc: 0.972 Test Loss: 0.486 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 6.709240913391113
Epoch: 34, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.643 Vali Acc: 0.961 Test Loss: 0.643 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 7.047806024551392
Epoch: 35, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.526 Vali Acc: 0.970 Test Loss: 0.526 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 7.321835279464722
Epoch: 36, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.714 Vali Acc: 0.957 Test Loss: 0.714 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.852208852767944
Epoch: 37, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.759 Vali Acc: 0.962 Test Loss: 0.759 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 7.8863747119903564
Epoch: 38, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.660 Vali Acc: 0.966 Test Loss: 0.660 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 6.68159031867981
Epoch: 39, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.446 Vali Acc: 0.971 Test Loss: 0.446 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 7.319282054901123
Epoch: 40, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.425 Vali Acc: 0.976 Test Loss: 0.425 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1728844
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.23871397972107
Epoch: 1, Steps: 89 | Train Loss: 0.881 Vali Loss: 0.240 Vali Acc: 0.936 Test Loss: 0.240 Test Acc: 0.936
Validation loss decreased (inf --> -0.935931).  Saving model ...
Epoch: 2 cost time: 6.100412130355835
Epoch: 2, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.232 Vali Acc: 0.939 Test Loss: 0.232 Test Acc: 0.939
Validation loss decreased (-0.935931 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 7.123526096343994
Epoch: 3, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.362 Vali Acc: 0.923 Test Loss: 0.362 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.5913238525390625
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.224 Vali Acc: 0.964 Test Loss: 0.224 Test Acc: 0.964
Validation loss decreased (-0.939413 --> -0.963786).  Saving model ...
Epoch: 5 cost time: 7.144093036651611
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.236 Vali Acc: 0.969 Test Loss: 0.236 Test Acc: 0.969
Validation loss decreased (-0.963786 --> -0.969357).  Saving model ...
Epoch: 6 cost time: 5.72265625
Epoch: 6, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.279 Vali Acc: 0.963 Test Loss: 0.279 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.330507755279541
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.268 Vali Acc: 0.965 Test Loss: 0.268 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.400959014892578
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
Validation loss decreased (-0.969357 --> -0.969357).  Saving model ...
Epoch: 9 cost time: 6.505634784698486
Epoch: 9, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.326 Vali Acc: 0.964 Test Loss: 0.326 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.00630521774292
Epoch: 10, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.333 Vali Acc: 0.947 Test Loss: 0.333 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.037083387374878
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.976 Test Loss: 0.211 Test Acc: 0.976
Validation loss decreased (-0.969357 --> -0.975625).  Saving model ...
Epoch: 12 cost time: 6.971360206604004
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.429 Vali Acc: 0.964 Test Loss: 0.429 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.742525339126587
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.253 Vali Acc: 0.978 Test Loss: 0.253 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977713).  Saving model ...
Epoch: 14 cost time: 5.760937929153442
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.293 Vali Acc: 0.977 Test Loss: 0.293 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.144028663635254
Epoch: 15, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.423 Vali Acc: 0.966 Test Loss: 0.423 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.555619478225708
Epoch: 16, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.434 Vali Acc: 0.958 Test Loss: 0.434 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 6.841681241989136
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.547 Vali Acc: 0.944 Test Loss: 0.547 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 7.191145181655884
Epoch: 18, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.262 Vali Acc: 0.970 Test Loss: 0.262 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 7.299649715423584
Epoch: 19, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.278 Vali Acc: 0.976 Test Loss: 0.278 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 7.334069490432739
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.253 Vali Acc: 0.981 Test Loss: 0.253 Test Acc: 0.981
Validation loss decreased (-0.977713 --> -0.980499).  Saving model ...
Epoch: 21 cost time: 6.522569179534912
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.271 Vali Acc: 0.978 Test Loss: 0.271 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.201004505157471
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.332 Vali Acc: 0.976 Test Loss: 0.332 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.809435844421387
Epoch: 23, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 7.421336650848389
Epoch: 24, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.330 Vali Acc: 0.974 Test Loss: 0.330 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.301680326461792
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.405 Vali Acc: 0.969 Test Loss: 0.405 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.633998394012451
Epoch: 26, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.440 Vali Acc: 0.976 Test Loss: 0.440 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.866153717041016
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.350 Vali Acc: 0.971 Test Loss: 0.350 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 6.981652021408081
Epoch: 28, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.358 Vali Acc: 0.971 Test Loss: 0.358 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.305172920227051
Epoch: 29, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.322 Vali Acc: 0.974 Test Loss: 0.322 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.651658773422241
Epoch: 30, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.280 Vali Acc: 0.978 Test Loss: 0.280 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1728844
model size : 11.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.60133171081543
Epoch: 1, Steps: 89 | Train Loss: 0.954 Vali Loss: 0.523 Vali Acc: 0.861 Test Loss: 0.523 Test Acc: 0.861
Validation loss decreased (inf --> -0.861415).  Saving model ...
Epoch: 2 cost time: 6.853471040725708
Epoch: 2, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.229 Vali Acc: 0.946 Test Loss: 0.229 Test Acc: 0.946
Validation loss decreased (-0.861415 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 6.749166011810303
Epoch: 3, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.319 Vali Acc: 0.949 Test Loss: 0.319 Test Acc: 0.949
Validation loss decreased (-0.946377 --> -0.949161).  Saving model ...
Epoch: 4 cost time: 6.844427585601807
Epoch: 4, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.432 Vali Acc: 0.931 Test Loss: 0.432 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.1474292278289795
Epoch: 5, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.390 Vali Acc: 0.955 Test Loss: 0.390 Test Acc: 0.955
Validation loss decreased (-0.949161 --> -0.955428).  Saving model ...
Epoch: 6 cost time: 4.7073986530303955
Epoch: 6, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.379 Vali Acc: 0.947 Test Loss: 0.379 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.045981168746948
Epoch: 7, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.593 Vali Acc: 0.939 Test Loss: 0.593 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.13981556892395
Epoch: 8, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.444 Vali Acc: 0.958 Test Loss: 0.444 Test Acc: 0.958
Validation loss decreased (-0.955428 --> -0.957516).  Saving model ...
Epoch: 9 cost time: 5.853661775588989
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.425 Vali Acc: 0.960 Test Loss: 0.425 Test Acc: 0.960
Validation loss decreased (-0.957516 --> -0.960302).  Saving model ...
Epoch: 10 cost time: 7.465827226638794
Epoch: 10, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.391 Vali Acc: 0.972 Test Loss: 0.391 Test Acc: 0.972
Validation loss decreased (-0.960302 --> -0.972141).  Saving model ...
Epoch: 11 cost time: 7.1894683837890625
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.479 Vali Acc: 0.960 Test Loss: 0.479 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.822175979614258
Epoch: 12, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.524 Vali Acc: 0.962 Test Loss: 0.524 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.888088703155518
Epoch: 13, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.522 Vali Acc: 0.968 Test Loss: 0.522 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.037572145462036
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.470 Vali Acc: 0.965 Test Loss: 0.470 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.117096900939941
Epoch: 15, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.640 Vali Acc: 0.962 Test Loss: 0.640 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.3915112018585205
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.490 Vali Acc: 0.976 Test Loss: 0.490 Test Acc: 0.976
Validation loss decreased (-0.972141 --> -0.976318).  Saving model ...
Epoch: 17 cost time: 7.0088770389556885
Epoch: 17, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.500 Vali Acc: 0.971 Test Loss: 0.500 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 6.919796466827393
Epoch: 18, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.461 Vali Acc: 0.968 Test Loss: 0.461 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 7.215615749359131
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.372 Vali Acc: 0.980 Test Loss: 0.372 Test Acc: 0.980
Validation loss decreased (-0.976318 --> -0.979801).  Saving model ...
Epoch: 20 cost time: 5.94487190246582
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.481 Vali Acc: 0.972 Test Loss: 0.481 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 7.05216383934021
Epoch: 21, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.700 Vali Acc: 0.945 Test Loss: 0.700 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.626999378204346
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.681 Vali Acc: 0.963 Test Loss: 0.681 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 6.788029670715332
Epoch: 23, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.535 Vali Acc: 0.971 Test Loss: 0.535 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 7.52114462852478
Epoch: 24, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.640 Vali Acc: 0.967 Test Loss: 0.640 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.6318488121032715
Epoch: 25, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.493 Vali Acc: 0.975 Test Loss: 0.493 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 7.489141941070557
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.494 Vali Acc: 0.976 Test Loss: 0.494 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 8.064278841018677
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.577 Vali Acc: 0.970 Test Loss: 0.577 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 7.687897205352783
Epoch: 28, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.854 Vali Acc: 0.958 Test Loss: 0.854 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 6.878873348236084
Epoch: 29, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.738 Vali Acc: 0.963 Test Loss: 0.738 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 1466700
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.301480054855347
Epoch: 1, Steps: 89 | Train Loss: 0.946 Vali Loss: 0.554 Vali Acc: 0.855 Test Loss: 0.554 Test Acc: 0.855
Validation loss decreased (inf --> -0.855148).  Saving model ...
Epoch: 2 cost time: 6.135177135467529
Epoch: 2, Steps: 89 | Train Loss: 0.333 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
Validation loss decreased (-0.855148 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 6.761608123779297
Epoch: 3, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.290 Vali Acc: 0.942 Test Loss: 0.290 Test Acc: 0.942
Validation loss decreased (-0.935234 --> -0.941501).  Saving model ...
Epoch: 4 cost time: 6.781558513641357
Epoch: 4, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.344 Vali Acc: 0.946 Test Loss: 0.344 Test Acc: 0.946
Validation loss decreased (-0.941501 --> -0.946375).  Saving model ...
Epoch: 5 cost time: 6.880711317062378
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.396 Vali Acc: 0.950 Test Loss: 0.396 Test Acc: 0.950
Validation loss decreased (-0.946375 --> -0.949857).  Saving model ...
Epoch: 6 cost time: 6.153416872024536
Epoch: 6, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.481 Vali Acc: 0.950 Test Loss: 0.481 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.719203472137451
Epoch: 7, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.482 Vali Acc: 0.939 Test Loss: 0.482 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.323991775512695
Epoch: 8, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.391 Vali Acc: 0.962 Test Loss: 0.391 Test Acc: 0.962
Validation loss decreased (-0.949857 --> -0.962392).  Saving model ...
Epoch: 9 cost time: 7.198956727981567
Epoch: 9, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.420 Vali Acc: 0.963 Test Loss: 0.420 Test Acc: 0.963
Validation loss decreased (-0.962392 --> -0.963088).  Saving model ...
Epoch: 10 cost time: 5.943541765213013
Epoch: 10, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.398 Vali Acc: 0.967 Test Loss: 0.398 Test Acc: 0.967
Validation loss decreased (-0.963088 --> -0.967266).  Saving model ...
Epoch: 11 cost time: 6.371053695678711
Epoch: 11, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.539 Vali Acc: 0.958 Test Loss: 0.539 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.230550289154053
Epoch: 12, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.542 Vali Acc: 0.964 Test Loss: 0.542 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.205796718597412
Epoch: 13, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.549 Vali Acc: 0.964 Test Loss: 0.549 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.2025463581085205
Epoch: 14, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.456 Vali Acc: 0.975 Test Loss: 0.456 Test Acc: 0.975
Validation loss decreased (-0.967266 --> -0.974926).  Saving model ...
Epoch: 15 cost time: 6.78070068359375
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.541 Vali Acc: 0.963 Test Loss: 0.541 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.720235109329224
Epoch: 16, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.680 Vali Acc: 0.953 Test Loss: 0.680 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.4828081130981445
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.489 Vali Acc: 0.968 Test Loss: 0.489 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.914462566375732
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.456 Vali Acc: 0.970 Test Loss: 0.456 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.15203857421875
Epoch: 19, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.411 Vali Acc: 0.974 Test Loss: 0.411 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.020442485809326
Epoch: 20, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.405 Vali Acc: 0.977 Test Loss: 0.405 Test Acc: 0.977
Validation loss decreased (-0.974926 --> -0.977015).  Saving model ...
Epoch: 21 cost time: 6.932256460189819
Epoch: 21, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.708 Vali Acc: 0.967 Test Loss: 0.708 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.670265197753906
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.602 Vali Acc: 0.968 Test Loss: 0.602 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.507471323013306
Epoch: 23, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.716 Vali Acc: 0.955 Test Loss: 0.716 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 6.736569881439209
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.436 Vali Acc: 0.976 Test Loss: 0.436 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.855650186538696
Epoch: 25, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.441 Vali Acc: 0.973 Test Loss: 0.441 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.773823022842407
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.536 Vali Acc: 0.967 Test Loss: 0.536 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.757842779159546
Epoch: 27, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.580 Vali Acc: 0.970 Test Loss: 0.580 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 7.145773410797119
Epoch: 28, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.524 Vali Acc: 0.970 Test Loss: 0.524 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 7.004071474075317
Epoch: 29, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.607 Vali Acc: 0.963 Test Loss: 0.607 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.412412643432617
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.604 Vali Acc: 0.964 Test Loss: 0.604 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1466700
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.565149068832397
Epoch: 1, Steps: 89 | Train Loss: 0.934 Vali Loss: 0.503 Vali Acc: 0.876 Test Loss: 0.503 Test Acc: 0.876
Validation loss decreased (inf --> -0.876040).  Saving model ...
Epoch: 2 cost time: 6.426091432571411
Epoch: 2, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.876040 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 6.528585433959961
Epoch: 3, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.356 Vali Acc: 0.927 Test Loss: 0.356 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.8198230266571045
Epoch: 4, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.353 Vali Acc: 0.950 Test Loss: 0.353 Test Acc: 0.950
Validation loss decreased (-0.948466 --> -0.949857).  Saving model ...
Epoch: 5 cost time: 6.572652816772461
Epoch: 5, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.303 Vali Acc: 0.956 Test Loss: 0.303 Test Acc: 0.956
Validation loss decreased (-0.949857 --> -0.956125).  Saving model ...
Epoch: 6 cost time: 6.733339071273804
Epoch: 6, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.322 Vali Acc: 0.962 Test Loss: 0.322 Test Acc: 0.962
Validation loss decreased (-0.956125 --> -0.962392).  Saving model ...
Epoch: 7 cost time: 7.180785894393921
Epoch: 7, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.378 Vali Acc: 0.959 Test Loss: 0.378 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.1763129234313965
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.487 Vali Acc: 0.959 Test Loss: 0.487 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 6.525080680847168
Epoch: 9, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.516 Vali Acc: 0.954 Test Loss: 0.516 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.632143020629883
Epoch: 10, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.471 Vali Acc: 0.958 Test Loss: 0.471 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.539005279541016
Epoch: 11, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.422 Vali Acc: 0.971 Test Loss: 0.422 Test Acc: 0.971
Validation loss decreased (-0.962392 --> -0.971444).  Saving model ...
Epoch: 12 cost time: 6.73496150970459
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.517 Vali Acc: 0.965 Test Loss: 0.517 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.072818279266357
Epoch: 13, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.507 Vali Acc: 0.965 Test Loss: 0.507 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.964367866516113
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.373 Vali Acc: 0.979 Test Loss: 0.373 Test Acc: 0.979
Validation loss decreased (-0.971444 --> -0.979105).  Saving model ...
Epoch: 15 cost time: 6.4258341789245605
Epoch: 15, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.357 Vali Acc: 0.978 Test Loss: 0.357 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.841707944869995
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.526 Vali Acc: 0.969 Test Loss: 0.526 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.444973707199097
Epoch: 17, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.724 Vali Acc: 0.955 Test Loss: 0.724 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 7.564877033233643
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.533 Vali Acc: 0.967 Test Loss: 0.533 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 7.66607928276062
Epoch: 19, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.426 Vali Acc: 0.965 Test Loss: 0.426 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.885090351104736
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.515 Vali Acc: 0.974 Test Loss: 0.515 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 7.411787748336792
Epoch: 21, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.521 Vali Acc: 0.971 Test Loss: 0.521 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 7.326154470443726
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.563 Vali Acc: 0.969 Test Loss: 0.563 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 8.15416169166565
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.523 Vali Acc: 0.975 Test Loss: 0.523 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 8.259388446807861
Epoch: 24, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.741 Vali Acc: 0.966 Test Loss: 0.741 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 1466700
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.463363885879517
Epoch: 1, Steps: 89 | Train Loss: 0.890 Vali Loss: 0.339 Vali Acc: 0.907 Test Loss: 0.339 Test Acc: 0.907
Validation loss decreased (inf --> -0.906682).  Saving model ...
Epoch: 2 cost time: 6.6992998123168945
Epoch: 2, Steps: 89 | Train Loss: 0.217 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.906682 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 7.7978057861328125
Epoch: 3, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
Validation loss decreased (-0.951948 --> -0.968661).  Saving model ...
Epoch: 4 cost time: 7.789252519607544
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 7.061081886291504
Epoch: 5, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.435 Vali Acc: 0.937 Test Loss: 0.435 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.147810697555542
Epoch: 6, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.304 Vali Acc: 0.960 Test Loss: 0.304 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 7.461506366729736
Epoch: 7, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.389 Vali Acc: 0.938 Test Loss: 0.389 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.080360174179077
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.249 Vali Acc: 0.965 Test Loss: 0.249 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.418412208557129
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.295 Vali Acc: 0.964 Test Loss: 0.295 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.088942050933838
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.689 Vali Acc: 0.933 Test Loss: 0.689 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 7.5081946849823
Epoch: 11, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.295 Vali Acc: 0.967 Test Loss: 0.295 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 6.884789943695068
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.287 Vali Acc: 0.965 Test Loss: 0.287 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.824437379837036
Epoch: 13, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.273 Vali Acc: 0.964 Test Loss: 0.273 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9686629526462396
model parameter : 1466700
model size : 10.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.14510440826416
Epoch: 1, Steps: 89 | Train Loss: 0.912 Vali Loss: 0.343 Vali Acc: 0.898 Test Loss: 0.343 Test Acc: 0.898
Validation loss decreased (inf --> -0.898325).  Saving model ...
Epoch: 2 cost time: 6.580976724624634
Epoch: 2, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.305 Vali Acc: 0.939 Test Loss: 0.305 Test Acc: 0.939
Validation loss decreased (-0.898325 --> -0.938716).  Saving model ...
Epoch: 3 cost time: 7.811536073684692
Epoch: 3, Steps: 89 | Train Loss: 0.321 Vali Loss: 0.457 Vali Acc: 0.903 Test Loss: 0.457 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.394912481307983
Epoch: 4, Steps: 89 | Train Loss: 0.269 Vali Loss: 0.587 Vali Acc: 0.902 Test Loss: 0.587 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 7.311166048049927
Epoch: 5, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.780 Vali Acc: 0.905 Test Loss: 0.780 Test Acc: 0.905
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.521845102310181
Epoch: 6, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.448 Vali Acc: 0.947 Test Loss: 0.448 Test Acc: 0.947
Validation loss decreased (-0.938716 --> -0.947071).  Saving model ...
Epoch: 7 cost time: 7.424156188964844
Epoch: 7, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.610 Vali Acc: 0.936 Test Loss: 0.610 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 7.071044921875
Epoch: 8, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.517 Vali Acc: 0.956 Test Loss: 0.517 Test Acc: 0.956
Validation loss decreased (-0.947071 --> -0.956123).  Saving model ...
Epoch: 9 cost time: 6.214447736740112
Epoch: 9, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.549 Vali Acc: 0.954 Test Loss: 0.549 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.881147623062134
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.332 Vali Acc: 0.977 Test Loss: 0.332 Test Acc: 0.977
Validation loss decreased (-0.956123 --> -0.977016).  Saving model ...
Epoch: 11 cost time: 7.010006904602051
Epoch: 11, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.503 Vali Acc: 0.961 Test Loss: 0.503 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.5500102043151855
Epoch: 12, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.473 Vali Acc: 0.967 Test Loss: 0.473 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 7.056693077087402
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.862 Vali Acc: 0.944 Test Loss: 0.862 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.983446836471558
Epoch: 14, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.463 Vali Acc: 0.956 Test Loss: 0.463 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 7.05548095703125
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.450 Vali Acc: 0.969 Test Loss: 0.450 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.754631519317627
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.507 Vali Acc: 0.960 Test Loss: 0.507 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.622268438339233
Epoch: 17, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.435 Vali Acc: 0.976 Test Loss: 0.435 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.5614142417907715
Epoch: 18, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.599 Vali Acc: 0.964 Test Loss: 0.599 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.25246000289917
Epoch: 19, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.473 Vali Acc: 0.969 Test Loss: 0.473 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.562428712844849
Epoch: 20, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.658 Vali Acc: 0.967 Test Loss: 0.658 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1335628
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.242466926574707
Epoch: 1, Steps: 89 | Train Loss: 0.909 Vali Loss: 0.389 Vali Acc: 0.883 Test Loss: 0.389 Test Acc: 0.883
Validation loss decreased (inf --> -0.883004).  Saving model ...
Epoch: 2 cost time: 6.868603706359863
Epoch: 2, Steps: 89 | Train Loss: 0.324 Vali Loss: 0.258 Vali Acc: 0.960 Test Loss: 0.258 Test Acc: 0.960
Validation loss decreased (-0.883004 --> -0.959607).  Saving model ...
Epoch: 3 cost time: 7.135645151138306
Epoch: 3, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.410 Vali Acc: 0.930 Test Loss: 0.410 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.576741456985474
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.347 Vali Acc: 0.947 Test Loss: 0.347 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.981642246246338
Epoch: 5, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.495 Vali Acc: 0.948 Test Loss: 0.495 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 7.780436992645264
Epoch: 6, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.329 Vali Acc: 0.961 Test Loss: 0.329 Test Acc: 0.961
Validation loss decreased (-0.959607 --> -0.960999).  Saving model ...
Epoch: 7 cost time: 7.6752564907073975
Epoch: 7, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.348 Vali Acc: 0.968 Test Loss: 0.348 Test Acc: 0.968
Validation loss decreased (-0.960999 --> -0.967963).  Saving model ...
Epoch: 8 cost time: 7.172264575958252
Epoch: 8, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.433 Vali Acc: 0.955 Test Loss: 0.433 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 7.045265436172485
Epoch: 9, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.439 Vali Acc: 0.963 Test Loss: 0.439 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 7.613020896911621
Epoch: 10, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.424 Vali Acc: 0.954 Test Loss: 0.424 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.8271095752716064
Epoch: 11, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.622 Vali Acc: 0.951 Test Loss: 0.622 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.519345045089722
Epoch: 12, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.638 Vali Acc: 0.955 Test Loss: 0.638 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.331857442855835
Epoch: 13, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.758 Vali Acc: 0.947 Test Loss: 0.758 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 6.873181581497192
Epoch: 14, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.490 Vali Acc: 0.970 Test Loss: 0.490 Test Acc: 0.970
Validation loss decreased (-0.967963 --> -0.970051).  Saving model ...
Epoch: 15 cost time: 7.070075273513794
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.563 Vali Acc: 0.967 Test Loss: 0.563 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.684348821640015
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.560 Vali Acc: 0.965 Test Loss: 0.560 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.917598247528076
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.447 Vali Acc: 0.969 Test Loss: 0.447 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.4523961544036865
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.670 Vali Acc: 0.966 Test Loss: 0.670 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.727708578109741
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.646 Vali Acc: 0.970 Test Loss: 0.646 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.748966455459595
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.764 Vali Acc: 0.957 Test Loss: 0.764 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.544999837875366
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.693 Vali Acc: 0.963 Test Loss: 0.693 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 6.00266432762146
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.525 Vali Acc: 0.974 Test Loss: 0.525 Test Acc: 0.974
Validation loss decreased (-0.970051 --> -0.973532).  Saving model ...
Epoch: 23 cost time: 6.537179231643677
Epoch: 23, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.492 Vali Acc: 0.977 Test Loss: 0.492 Test Acc: 0.977
Validation loss decreased (-0.973532 --> -0.977015).  Saving model ...
Epoch: 24 cost time: 6.904721021652222
Epoch: 24, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.591 Vali Acc: 0.969 Test Loss: 0.591 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.106183767318726
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.513 Vali Acc: 0.967 Test Loss: 0.513 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 6.533965587615967
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.396 Vali Acc: 0.978 Test Loss: 0.396 Test Acc: 0.978
Validation loss decreased (-0.977015 --> -0.977712).  Saving model ...
Epoch: 27 cost time: 5.9748616218566895
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.415 Vali Acc: 0.978 Test Loss: 0.415 Test Acc: 0.978
Validation loss decreased (-0.977712 --> -0.978408).  Saving model ...
Epoch: 28 cost time: 7.198050022125244
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.480 Vali Acc: 0.974 Test Loss: 0.480 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.9688825607299805
Epoch: 29, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.624 Vali Acc: 0.959 Test Loss: 0.624 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 7.273191452026367
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.657 Vali Acc: 0.964 Test Loss: 0.657 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 6.820200681686401
Epoch: 31, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.812 Vali Acc: 0.958 Test Loss: 0.812 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 7.339893341064453
Epoch: 32, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.701 Vali Acc: 0.963 Test Loss: 0.701 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 6.2464704513549805
Epoch: 33, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.616 Vali Acc: 0.972 Test Loss: 0.616 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 6.995236396789551
Epoch: 34, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.727 Vali Acc: 0.964 Test Loss: 0.727 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 6.687329053878784
Epoch: 35, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.596 Vali Acc: 0.973 Test Loss: 0.596 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 7.854970693588257
Epoch: 36, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.583 Vali Acc: 0.974 Test Loss: 0.583 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 7.195115089416504
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.579 Vali Acc: 0.974 Test Loss: 0.579 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1335628
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.394922733306885
Epoch: 1, Steps: 89 | Train Loss: 0.906 Vali Loss: 0.380 Vali Acc: 0.883 Test Loss: 0.380 Test Acc: 0.883
Validation loss decreased (inf --> -0.883005).  Saving model ...
Epoch: 2 cost time: 6.812407970428467
Epoch: 2, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.341 Vali Acc: 0.935 Test Loss: 0.341 Test Acc: 0.935
Validation loss decreased (-0.883005 --> -0.934537).  Saving model ...
Epoch: 3 cost time: 6.3227317333221436
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.300 Vali Acc: 0.951 Test Loss: 0.300 Test Acc: 0.951
Validation loss decreased (-0.934537 --> -0.951250).  Saving model ...
Epoch: 4 cost time: 5.941654682159424
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.366 Vali Acc: 0.945 Test Loss: 0.366 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.3240437507629395
Epoch: 5, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.699 Vali Acc: 0.914 Test Loss: 0.699 Test Acc: 0.914
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.553506374359131
Epoch: 6, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.354 Vali Acc: 0.960 Test Loss: 0.354 Test Acc: 0.960
Validation loss decreased (-0.951250 --> -0.959606).  Saving model ...
Epoch: 7 cost time: 6.263622522354126
Epoch: 7, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.390 Vali Acc: 0.942 Test Loss: 0.390 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.525296211242676
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.363 Vali Acc: 0.968 Test Loss: 0.363 Test Acc: 0.968
Validation loss decreased (-0.959606 --> -0.967963).  Saving model ...
Epoch: 9 cost time: 6.872142791748047
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.464 Vali Acc: 0.960 Test Loss: 0.464 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.1623828411102295
Epoch: 10, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.435 Vali Acc: 0.956 Test Loss: 0.435 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.675394773483276
Epoch: 11, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.486 Vali Acc: 0.962 Test Loss: 0.486 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.865426063537598
Epoch: 12, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.379 Vali Acc: 0.967 Test Loss: 0.379 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.788774251937866
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.481 Vali Acc: 0.964 Test Loss: 0.481 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.275720119476318
Epoch: 14, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
Validation loss decreased (-0.967963 --> -0.974927).  Saving model ...
Epoch: 15 cost time: 7.584425449371338
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.260 Vali Acc: 0.978 Test Loss: 0.260 Test Acc: 0.978
Validation loss decreased (-0.974927 --> -0.978410).  Saving model ...
Epoch: 16 cost time: 7.7860095500946045
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.283 Vali Acc: 0.976 Test Loss: 0.283 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.676979064941406
Epoch: 17, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.375 Vali Acc: 0.974 Test Loss: 0.375 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 7.054744243621826
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.392 Vali Acc: 0.968 Test Loss: 0.392 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 7.356089115142822
Epoch: 19, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.600 Vali Acc: 0.959 Test Loss: 0.600 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 7.1888158321380615
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.479 Vali Acc: 0.964 Test Loss: 0.479 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 7.425046682357788
Epoch: 21, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.619 Vali Acc: 0.967 Test Loss: 0.619 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.905276298522949
Epoch: 22, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.506 Vali Acc: 0.969 Test Loss: 0.506 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 7.24722146987915
Epoch: 23, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.360 Vali Acc: 0.978 Test Loss: 0.360 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.942949056625366
Epoch: 24, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.384 Vali Acc: 0.978 Test Loss: 0.384 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 6.807398319244385
Epoch: 25, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.431 Vali Acc: 0.967 Test Loss: 0.431 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1335628
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.432963609695435
Epoch: 1, Steps: 89 | Train Loss: 0.887 Vali Loss: 0.297 Vali Acc: 0.902 Test Loss: 0.297 Test Acc: 0.902
Validation loss decreased (inf --> -0.901808).  Saving model ...
Epoch: 2 cost time: 6.881690740585327
Epoch: 2, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.242 Vali Acc: 0.950 Test Loss: 0.242 Test Acc: 0.950
Validation loss decreased (-0.901808 --> -0.949858).  Saving model ...
Epoch: 3 cost time: 7.069467067718506
Epoch: 3, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.339 Vali Acc: 0.928 Test Loss: 0.339 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 7.0893168449401855
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.291 Vali Acc: 0.949 Test Loss: 0.291 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.928725242614746
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.447 Vali Acc: 0.932 Test Loss: 0.447 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 6.138545751571655
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.273 Vali Acc: 0.974 Test Loss: 0.273 Test Acc: 0.974
Validation loss decreased (-0.949858 --> -0.974231).  Saving model ...
Epoch: 7 cost time: 7.251070022583008
Epoch: 7, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.311 Vali Acc: 0.966 Test Loss: 0.311 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.383876323699951
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.78010892868042
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.254 Vali Acc: 0.972 Test Loss: 0.254 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.63848090171814
Epoch: 10, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.451 Vali Acc: 0.945 Test Loss: 0.451 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 7.039015531539917
Epoch: 11, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.448 Vali Acc: 0.958 Test Loss: 0.448 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 7.3384411334991455
Epoch: 12, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.500 Vali Acc: 0.959 Test Loss: 0.500 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.2593772411346436
Epoch: 13, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.416 Vali Acc: 0.971 Test Loss: 0.416 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.7859461307525635
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.403 Vali Acc: 0.964 Test Loss: 0.403 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.7659595012664795
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.376 Vali Acc: 0.975 Test Loss: 0.376 Test Acc: 0.975
Validation loss decreased (-0.974231 --> -0.974927).  Saving model ...
Epoch: 16 cost time: 6.294310092926025
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.359 Vali Acc: 0.976 Test Loss: 0.359 Test Acc: 0.976
Validation loss decreased (-0.974927 --> -0.976320).  Saving model ...
Epoch: 17 cost time: 6.968526840209961
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.301 Vali Acc: 0.982 Test Loss: 0.301 Test Acc: 0.982
Validation loss decreased (-0.976320 --> -0.981891).  Saving model ...
Epoch: 18 cost time: 7.275067329406738
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.333 Vali Acc: 0.976 Test Loss: 0.333 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.855684757232666
Epoch: 19, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.329 Vali Acc: 0.980 Test Loss: 0.329 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.042854070663452
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.390 Vali Acc: 0.974 Test Loss: 0.390 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.720290422439575
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.567 Vali Acc: 0.962 Test Loss: 0.567 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.60410213470459
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.649 Vali Acc: 0.956 Test Loss: 0.649 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.550111770629883
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.367 Vali Acc: 0.975 Test Loss: 0.367 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 6.863437652587891
Epoch: 24, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.516 Vali Acc: 0.968 Test Loss: 0.516 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.747561693191528
Epoch: 25, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.405 Vali Acc: 0.974 Test Loss: 0.405 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.150375604629517
Epoch: 26, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.671 Vali Acc: 0.951 Test Loss: 0.671 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.569442510604858
Epoch: 27, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.430 Vali Acc: 0.962 Test Loss: 0.430 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 1335628
model size : 10.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.649767398834229
Epoch: 1, Steps: 89 | Train Loss: 0.905 Vali Loss: 0.392 Vali Acc: 0.891 Test Loss: 0.392 Test Acc: 0.891
Validation loss decreased (inf --> -0.890665).  Saving model ...
Epoch: 2 cost time: 6.582900524139404
Epoch: 2, Steps: 89 | Train Loss: 0.339 Vali Loss: 0.368 Vali Acc: 0.925 Test Loss: 0.368 Test Acc: 0.925
Validation loss decreased (-0.890665 --> -0.924787).  Saving model ...
Epoch: 3 cost time: 6.4268598556518555
Epoch: 3, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.437 Vali Acc: 0.928 Test Loss: 0.437 Test Acc: 0.928
Validation loss decreased (-0.924787 --> -0.927572).  Saving model ...
Epoch: 4 cost time: 6.251471996307373
Epoch: 4, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.914 Vali Acc: 0.872 Test Loss: 0.914 Test Acc: 0.872
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.071104049682617
Epoch: 5, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.467 Vali Acc: 0.937 Test Loss: 0.467 Test Acc: 0.937
Validation loss decreased (-0.927572 --> -0.936625).  Saving model ...
Epoch: 6 cost time: 6.3448145389556885
Epoch: 6, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.672 Vali Acc: 0.920 Test Loss: 0.672 Test Acc: 0.920
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.916163682937622
Epoch: 7, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.482 Vali Acc: 0.944 Test Loss: 0.482 Test Acc: 0.944
Validation loss decreased (-0.936625 --> -0.944285).  Saving model ...
Epoch: 8 cost time: 6.920703172683716
Epoch: 8, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.526 Vali Acc: 0.949 Test Loss: 0.526 Test Acc: 0.949
Validation loss decreased (-0.944285 --> -0.949159).  Saving model ...
Epoch: 9 cost time: 6.588571071624756
Epoch: 9, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.439 Vali Acc: 0.961 Test Loss: 0.439 Test Acc: 0.961
Validation loss decreased (-0.949159 --> -0.960998).  Saving model ...
Epoch: 10 cost time: 6.796524524688721
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.366 Vali Acc: 0.964 Test Loss: 0.366 Test Acc: 0.964
Validation loss decreased (-0.960998 --> -0.963785).  Saving model ...
Epoch: 11 cost time: 6.258765697479248
Epoch: 11, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.656 Vali Acc: 0.946 Test Loss: 0.656 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.611101388931274
Epoch: 12, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.679 Vali Acc: 0.946 Test Loss: 0.679 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.261197328567505
Epoch: 13, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.663 Vali Acc: 0.949 Test Loss: 0.663 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.574751377105713
Epoch: 14, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.724 Vali Acc: 0.947 Test Loss: 0.724 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.143584251403809
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.631 Vali Acc: 0.962 Test Loss: 0.631 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 6.146337032318115
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.705 Vali Acc: 0.959 Test Loss: 0.705 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 6.775980472564697
Epoch: 17, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.806 Vali Acc: 0.939 Test Loss: 0.806 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.5393760204315186
Epoch: 18, Steps: 89 | Train Loss: 0.082 Vali Loss: 1.239 Vali Acc: 0.922 Test Loss: 1.239 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 6.508328437805176
Epoch: 19, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.724 Vali Acc: 0.946 Test Loss: 0.724 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 7.164187669754028
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.700 Vali Acc: 0.960 Test Loss: 0.700 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9637883008356546
model parameter : 1270092
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.918878555297852
Epoch: 1, Steps: 89 | Train Loss: 0.895 Vali Loss: 0.352 Vali Acc: 0.900 Test Loss: 0.352 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 6.71798038482666
Epoch: 2, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.362 Vali Acc: 0.932 Test Loss: 0.362 Test Acc: 0.932
Validation loss decreased (-0.900414 --> -0.931751).  Saving model ...
Epoch: 3 cost time: 6.548521041870117
Epoch: 3, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.556 Vali Acc: 0.896 Test Loss: 0.556 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.160911560058594
Epoch: 4, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.367 Vali Acc: 0.956 Test Loss: 0.367 Test Acc: 0.956
Validation loss decreased (-0.931751 --> -0.956124).  Saving model ...
Epoch: 5 cost time: 6.596814870834351
Epoch: 5, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.545 Vali Acc: 0.930 Test Loss: 0.545 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.239351987838745
Epoch: 6, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.481 Vali Acc: 0.948 Test Loss: 0.481 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.771193504333496
Epoch: 7, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.397 Vali Acc: 0.960 Test Loss: 0.397 Test Acc: 0.960
Validation loss decreased (-0.956124 --> -0.959606).  Saving model ...
Epoch: 8 cost time: 5.9785332679748535
Epoch: 8, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.653 Vali Acc: 0.946 Test Loss: 0.653 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.446685314178467
Epoch: 9, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.591 Vali Acc: 0.949 Test Loss: 0.591 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.027254104614258
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.419 Vali Acc: 0.970 Test Loss: 0.419 Test Acc: 0.970
Validation loss decreased (-0.959606 --> -0.970052).  Saving model ...
Epoch: 11 cost time: 6.432684659957886
Epoch: 11, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.377 Vali Acc: 0.971 Test Loss: 0.377 Test Acc: 0.971
Validation loss decreased (-0.970052 --> -0.970748).  Saving model ...
Epoch: 12 cost time: 6.471956491470337
Epoch: 12, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.433 Vali Acc: 0.974 Test Loss: 0.433 Test Acc: 0.974
Validation loss decreased (-0.970748 --> -0.973533).  Saving model ...
Epoch: 13 cost time: 5.490245342254639
Epoch: 13, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.489 Vali Acc: 0.960 Test Loss: 0.489 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.143470764160156
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.674 Vali Acc: 0.947 Test Loss: 0.674 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.938957452774048
Epoch: 15, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.452 Vali Acc: 0.973 Test Loss: 0.452 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.285719156265259
Epoch: 16, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.449 Vali Acc: 0.975 Test Loss: 0.449 Test Acc: 0.975
Validation loss decreased (-0.973533 --> -0.974926).  Saving model ...
Epoch: 17 cost time: 7.029329776763916
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.408 Vali Acc: 0.980 Test Loss: 0.408 Test Acc: 0.980
Validation loss decreased (-0.974926 --> -0.979801).  Saving model ...
Epoch: 18 cost time: 6.501433610916138
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.503 Vali Acc: 0.974 Test Loss: 0.503 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.781559228897095
Epoch: 19, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.558 Vali Acc: 0.971 Test Loss: 0.558 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.1847968101501465
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.660 Vali Acc: 0.954 Test Loss: 0.660 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.873708724975586
Epoch: 21, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.599 Vali Acc: 0.957 Test Loss: 0.599 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.597644090652466
Epoch: 22, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.573 Vali Acc: 0.969 Test Loss: 0.573 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.908349990844727
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.427 Vali Acc: 0.971 Test Loss: 0.427 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.74790620803833
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.419 Vali Acc: 0.976 Test Loss: 0.419 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.758768558502197
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.423 Vali Acc: 0.976 Test Loss: 0.423 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.773625373840332
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.600 Vali Acc: 0.957 Test Loss: 0.600 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.8075971603393555
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.682 Vali Acc: 0.962 Test Loss: 0.682 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 1270092
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.2470972537994385
Epoch: 1, Steps: 89 | Train Loss: 0.878 Vali Loss: 0.328 Vali Acc: 0.914 Test Loss: 0.328 Test Acc: 0.914
Validation loss decreased (inf --> -0.913646).  Saving model ...
Epoch: 2 cost time: 6.046092510223389
Epoch: 2, Steps: 89 | Train Loss: 0.298 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
Validation loss decreased (-0.913646 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 6.027208089828491
Epoch: 3, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.415 Vali Acc: 0.933 Test Loss: 0.415 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 6.288137674331665
Epoch: 4, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.357 Vali Acc: 0.934 Test Loss: 0.357 Test Acc: 0.934
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 5.38209080696106
Epoch: 5, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.346 Vali Acc: 0.955 Test Loss: 0.346 Test Acc: 0.955
Validation loss decreased (-0.936627 --> -0.954732).  Saving model ...
Epoch: 6 cost time: 6.271641969680786
Epoch: 6, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.341 Vali Acc: 0.958 Test Loss: 0.341 Test Acc: 0.958
Validation loss decreased (-0.954732 --> -0.958214).  Saving model ...
Epoch: 7 cost time: 6.168751955032349
Epoch: 7, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.253 Vali Acc: 0.973 Test Loss: 0.253 Test Acc: 0.973
Validation loss decreased (-0.958214 --> -0.972839).  Saving model ...
Epoch: 8 cost time: 5.831562042236328
Epoch: 8, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.375 Vali Acc: 0.963 Test Loss: 0.375 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 6.437056541442871
Epoch: 9, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.736 Vali Acc: 0.937 Test Loss: 0.736 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.967471122741699
Epoch: 10, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.484 Vali Acc: 0.955 Test Loss: 0.484 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 6.700859546661377
Epoch: 11, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.467 Vali Acc: 0.962 Test Loss: 0.467 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 7.690662145614624
Epoch: 12, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.429 Vali Acc: 0.964 Test Loss: 0.429 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 7.08610725402832
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.323 Vali Acc: 0.974 Test Loss: 0.323 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.974231).  Saving model ...
Epoch: 14 cost time: 7.167134046554565
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.444 Vali Acc: 0.971 Test Loss: 0.444 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.1633217334747314
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.414 Vali Acc: 0.967 Test Loss: 0.414 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.609059810638428
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.340 Vali Acc: 0.978 Test Loss: 0.340 Test Acc: 0.978
Validation loss decreased (-0.974231 --> -0.977712).  Saving model ...
Epoch: 17 cost time: 6.839653253555298
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.281 Vali Acc: 0.976 Test Loss: 0.281 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 7.228660345077515
Epoch: 18, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.618 Vali Acc: 0.961 Test Loss: 0.618 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.835146188735962
Epoch: 19, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.306 Vali Acc: 0.975 Test Loss: 0.306 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 6.11726713180542
Epoch: 20, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.465 Vali Acc: 0.971 Test Loss: 0.465 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 6.3946373462677
Epoch: 21, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.661 Vali Acc: 0.956 Test Loss: 0.661 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.382231950759888
Epoch: 22, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.040 Vali Acc: 0.939 Test Loss: 1.040 Test Acc: 0.939
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 6.35685133934021
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.558 Vali Acc: 0.978 Test Loss: 0.558 Test Acc: 0.978
Validation loss decreased (-0.977712 --> -0.978407).  Saving model ...
Epoch: 24 cost time: 6.5436930656433105
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.859 Vali Acc: 0.964 Test Loss: 0.859 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.816592693328857
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.512 Vali Acc: 0.978 Test Loss: 0.512 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.892096757888794
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.518 Vali Acc: 0.977 Test Loss: 0.518 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.081422805786133
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.474 Vali Acc: 0.978 Test Loss: 0.474 Test Acc: 0.978
Validation loss decreased (-0.978407 --> -0.978408).  Saving model ...
Epoch: 28 cost time: 6.227631568908691
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.512 Vali Acc: 0.973 Test Loss: 0.512 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 6.27691650390625
Epoch: 29, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.465 Vali Acc: 0.975 Test Loss: 0.465 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.819607734680176
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.491 Vali Acc: 0.977 Test Loss: 0.491 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.892892360687256
Epoch: 31, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.673 Vali Acc: 0.960 Test Loss: 0.673 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 6.554780006408691
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.441 Vali Acc: 0.980 Test Loss: 0.441 Test Acc: 0.980
Validation loss decreased (-0.978408 --> -0.979801).  Saving model ...
Epoch: 33 cost time: 6.002944469451904
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.528 Vali Acc: 0.972 Test Loss: 0.528 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 6.415972709655762
Epoch: 34, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.425 Vali Acc: 0.978 Test Loss: 0.425 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 6.89768648147583
Epoch: 35, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.497 Vali Acc: 0.975 Test Loss: 0.497 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 5.857235670089722
Epoch: 36, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.365 Vali Acc: 0.982 Test Loss: 0.365 Test Acc: 0.982
Validation loss decreased (-0.979801 --> -0.981891).  Saving model ...
Epoch: 37 cost time: 6.250837802886963
Epoch: 37, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.361 Vali Acc: 0.983 Test Loss: 0.361 Test Acc: 0.983
Validation loss decreased (-0.981891 --> -0.983283).  Saving model ...
Epoch: 38 cost time: 6.329653978347778
Epoch: 38, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.345 Vali Acc: 0.981 Test Loss: 0.345 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 6.237355470657349
Epoch: 39, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.410 Vali Acc: 0.983 Test Loss: 0.410 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 5.873497486114502
Epoch: 40, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.398 Vali Acc: 0.980 Test Loss: 0.398 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 5.995389699935913
Epoch: 41, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.510 Vali Acc: 0.976 Test Loss: 0.510 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 5.039883852005005
Epoch: 42, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.444 Vali Acc: 0.968 Test Loss: 0.444 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 5.535220384597778
Epoch: 43, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.604 Vali Acc: 0.968 Test Loss: 0.604 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 5.858731269836426
Epoch: 44, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.719 Vali Acc: 0.962 Test Loss: 0.719 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 5.281841516494751
Epoch: 45, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.651 Vali Acc: 0.962 Test Loss: 0.651 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 5.846086740493774
Epoch: 46, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.581 Vali Acc: 0.975 Test Loss: 0.581 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 5.768162727355957
Epoch: 47, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.598 Vali Acc: 0.967 Test Loss: 0.598 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1270092
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.159655570983887
Epoch: 1, Steps: 89 | Train Loss: 0.874 Vali Loss: 0.248 Vali Acc: 0.935 Test Loss: 0.248 Test Acc: 0.935
Validation loss decreased (inf --> -0.935234).  Saving model ...
Epoch: 2 cost time: 5.811272621154785
Epoch: 2, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.239 Vali Acc: 0.948 Test Loss: 0.239 Test Acc: 0.948
Validation loss decreased (-0.935234 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 5.88829231262207
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.246 Vali Acc: 0.958 Test Loss: 0.246 Test Acc: 0.958
Validation loss decreased (-0.948466 --> -0.957518).  Saving model ...
Epoch: 4 cost time: 6.340377330780029
Epoch: 4, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.296 Vali Acc: 0.937 Test Loss: 0.296 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.0897417068481445
Epoch: 5, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.272 Vali Acc: 0.960 Test Loss: 0.272 Test Acc: 0.960
Validation loss decreased (-0.957518 --> -0.959607).  Saving model ...
Epoch: 6 cost time: 5.968290090560913
Epoch: 6, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.400 Vali Acc: 0.942 Test Loss: 0.400 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.023496627807617
Epoch: 7, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.307 Vali Acc: 0.966 Test Loss: 0.307 Test Acc: 0.966
Validation loss decreased (-0.959607 --> -0.965874).  Saving model ...
Epoch: 8 cost time: 5.382052421569824
Epoch: 8, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.282 Vali Acc: 0.972 Test Loss: 0.282 Test Acc: 0.972
Validation loss decreased (-0.965874 --> -0.972142).  Saving model ...
Epoch: 9 cost time: 5.552312135696411
Epoch: 9, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.285 Vali Acc: 0.969 Test Loss: 0.285 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.056841135025024
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.248 Vali Acc: 0.971 Test Loss: 0.248 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.167287588119507
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.363 Vali Acc: 0.958 Test Loss: 0.363 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.875827789306641
Epoch: 12, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.335 Vali Acc: 0.959 Test Loss: 0.335 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.354108572006226
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.384 Vali Acc: 0.964 Test Loss: 0.384 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.813673973083496
Epoch: 14, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.352 Vali Acc: 0.967 Test Loss: 0.352 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.151503086090088
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.363 Vali Acc: 0.968 Test Loss: 0.363 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.987535715103149
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.295 Vali Acc: 0.966 Test Loss: 0.295 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.770265340805054
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.250 Vali Acc: 0.978 Test Loss: 0.250 Test Acc: 0.978
Validation loss decreased (-0.972142 --> -0.978410).  Saving model ...
Epoch: 18 cost time: 4.562708377838135
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.267 Vali Acc: 0.975 Test Loss: 0.267 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.117999076843262
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.985 Test Loss: 0.223 Test Acc: 0.985
Validation loss decreased (-0.978410 --> -0.984677).  Saving model ...
Epoch: 20 cost time: 5.386215925216675
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.279 Vali Acc: 0.978 Test Loss: 0.279 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.803039789199829
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.289 Vali Acc: 0.978 Test Loss: 0.289 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.650835037231445
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.315 Vali Acc: 0.974 Test Loss: 0.315 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.479079484939575
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.394 Vali Acc: 0.976 Test Loss: 0.394 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 6.277462482452393
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.290 Vali Acc: 0.980 Test Loss: 0.290 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.5119309425354
Epoch: 25, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.223 Vali Acc: 0.982 Test Loss: 0.223 Test Acc: 0.982
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.744939088821411
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.415 Vali Acc: 0.960 Test Loss: 0.415 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.928327560424805
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.297 Vali Acc: 0.977 Test Loss: 0.297 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.4409260749816895
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.330 Vali Acc: 0.980 Test Loss: 0.330 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.421897888183594
Epoch: 29, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.590 Vali Acc: 0.961 Test Loss: 0.590 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9846796657381616
model parameter : 1270092
model size : 9.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.092381954193115
Epoch: 1, Steps: 89 | Train Loss: 1.038 Vali Loss: 0.363 Vali Acc: 0.895 Test Loss: 0.363 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 4.519327640533447
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.894843 --> -0.951252).  Saving model ...
Epoch: 3 cost time: 5.2566938400268555
Epoch: 3, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.258 Vali Acc: 0.948 Test Loss: 0.258 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.28684663772583
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.175 Vali Acc: 0.964 Test Loss: 0.175 Test Acc: 0.964
Validation loss decreased (-0.951252 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 5.253694534301758
Epoch: 5, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.315 Vali Acc: 0.940 Test Loss: 0.315 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.209678411483765
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.463860988616943
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.960 Test Loss: 0.205 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.426872491836548
Epoch: 8, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.267 Vali Acc: 0.951 Test Loss: 0.267 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.722180128097534
Epoch: 9, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.304 Vali Acc: 0.950 Test Loss: 0.304 Test Acc: 0.950
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.296013593673706
Epoch: 10, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.378 Vali Acc: 0.953 Test Loss: 0.378 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.599216938018799
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.291 Vali Acc: 0.971 Test Loss: 0.291 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971446).  Saving model ...
Epoch: 12 cost time: 5.156769514083862
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.969 Test Loss: 0.265 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.40328574180603
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.527430534362793
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.281 Vali Acc: 0.960 Test Loss: 0.281 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.3557844161987305
Epoch: 15, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.331 Vali Acc: 0.963 Test Loss: 0.331 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.50449013710022
Epoch: 16, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.384 Vali Acc: 0.960 Test Loss: 0.384 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.326149940490723
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.351 Vali Acc: 0.966 Test Loss: 0.351 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.230942964553833
Epoch: 18, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.516 Vali Acc: 0.966 Test Loss: 0.516 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.71703314781189
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.466 Vali Acc: 0.960 Test Loss: 0.466 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.310683012008667
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.414 Vali Acc: 0.975 Test Loss: 0.414 Test Acc: 0.975
Validation loss decreased (-0.971446 --> -0.974926).  Saving model ...
Epoch: 21 cost time: 4.669338941574097
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.389 Vali Acc: 0.976 Test Loss: 0.389 Test Acc: 0.976
Validation loss decreased (-0.974926 --> -0.975623).  Saving model ...
Epoch: 22 cost time: 4.950254917144775
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.420 Vali Acc: 0.972 Test Loss: 0.420 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.197150230407715
Epoch: 23, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.371 Vali Acc: 0.967 Test Loss: 0.371 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.09721302986145
Epoch: 24, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.406 Vali Acc: 0.962 Test Loss: 0.406 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.253101587295532
Epoch: 25, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.434 Vali Acc: 0.960 Test Loss: 0.434 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.116022825241089
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.355 Vali Acc: 0.971 Test Loss: 0.355 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.321661472320557
Epoch: 27, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.358 Vali Acc: 0.969 Test Loss: 0.358 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.346735954284668
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.406 Vali Acc: 0.960 Test Loss: 0.406 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.088814735412598
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.351 Vali Acc: 0.975 Test Loss: 0.351 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.905193328857422
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.443 Vali Acc: 0.962 Test Loss: 0.443 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.335610866546631
Epoch: 31, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.539 Vali Acc: 0.965 Test Loss: 0.539 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 1585356
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.235041379928589
Epoch: 1, Steps: 89 | Train Loss: 1.026 Vali Loss: 0.368 Vali Acc: 0.893 Test Loss: 0.368 Test Acc: 0.893
Validation loss decreased (inf --> -0.893450).  Saving model ...
Epoch: 2 cost time: 4.559007406234741
Epoch: 2, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.193 Vali Acc: 0.947 Test Loss: 0.193 Test Acc: 0.947
Validation loss decreased (-0.893450 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 4.8138267993927
Epoch: 3, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.287 Vali Acc: 0.934 Test Loss: 0.287 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.466217994689941
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.182 Vali Acc: 0.960 Test Loss: 0.182 Test Acc: 0.960
Validation loss decreased (-0.947073 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 4.598861217498779
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.455 Vali Acc: 0.915 Test Loss: 0.455 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.386460542678833
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.188 Vali Acc: 0.966 Test Loss: 0.188 Test Acc: 0.966
Validation loss decreased (-0.959608 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 4.0319788455963135
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.274 Vali Acc: 0.956 Test Loss: 0.274 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.091826677322388
Epoch: 8, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.211 Vali Acc: 0.964 Test Loss: 0.211 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.4398534297943115
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.242 Vali Acc: 0.967 Test Loss: 0.242 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966571).  Saving model ...
Epoch: 10 cost time: 4.537932634353638
Epoch: 10, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.570 Vali Acc: 0.930 Test Loss: 0.570 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.379515647888184
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.268 Vali Acc: 0.967 Test Loss: 0.268 Test Acc: 0.967
Validation loss decreased (-0.966571 --> -0.967268).  Saving model ...
Epoch: 12 cost time: 5.320521116256714
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.352 Vali Acc: 0.960 Test Loss: 0.352 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.932180881500244
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.510 Vali Acc: 0.936 Test Loss: 0.510 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.2643983364105225
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.363 Vali Acc: 0.961 Test Loss: 0.363 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.216185569763184
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.312 Vali Acc: 0.967 Test Loss: 0.312 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.265011787414551
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.282 Vali Acc: 0.974 Test Loss: 0.282 Test Acc: 0.974
Validation loss decreased (-0.967268 --> -0.974231).  Saving model ...
Epoch: 17 cost time: 4.544643878936768
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.306 Vali Acc: 0.978 Test Loss: 0.306 Test Acc: 0.978
Validation loss decreased (-0.974231 --> -0.978409).  Saving model ...
Epoch: 18 cost time: 4.714641332626343
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.348 Vali Acc: 0.973 Test Loss: 0.348 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.642126798629761
Epoch: 19, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.298 Vali Acc: 0.971 Test Loss: 0.298 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.072979688644409
Epoch: 20, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.357 Vali Acc: 0.969 Test Loss: 0.357 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.667814493179321
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.272 Vali Acc: 0.978 Test Loss: 0.272 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.492800951004028
Epoch: 22, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.412 Vali Acc: 0.968 Test Loss: 0.412 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.0169243812561035
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.333 Vali Acc: 0.978 Test Loss: 0.333 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.897964715957642
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.362 Vali Acc: 0.974 Test Loss: 0.362 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.607069253921509
Epoch: 25, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.399 Vali Acc: 0.974 Test Loss: 0.399 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.862689733505249
Epoch: 26, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.437 Vali Acc: 0.973 Test Loss: 0.437 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.644680500030518
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.447 Vali Acc: 0.974 Test Loss: 0.447 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1585356
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.479357957839966
Epoch: 1, Steps: 89 | Train Loss: 1.011 Vali Loss: 0.353 Vali Acc: 0.896 Test Loss: 0.353 Test Acc: 0.896
Validation loss decreased (inf --> -0.895540).  Saving model ...
Epoch: 2 cost time: 4.981946229934692
Epoch: 2, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.895540 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 5.648078918457031
Epoch: 3, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 5.143749713897705
Epoch: 4, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.185 Vali Acc: 0.962 Test Loss: 0.185 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961697).  Saving model ...
Epoch: 5 cost time: 4.80247950553894
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.194 Vali Acc: 0.961 Test Loss: 0.194 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.121079444885254
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.228 Vali Acc: 0.967 Test Loss: 0.228 Test Acc: 0.967
Validation loss decreased (-0.961697 --> -0.967268).  Saving model ...
Epoch: 7 cost time: 4.396154880523682
Epoch: 7, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.286 Vali Acc: 0.952 Test Loss: 0.286 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.5057148933410645
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.7717907428741455
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.975 Test Loss: 0.194 Test Acc: 0.975
Validation loss decreased (-0.967268 --> -0.974928).  Saving model ...
Epoch: 10 cost time: 4.489738941192627
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.230 Vali Acc: 0.968 Test Loss: 0.230 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.315011739730835
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.274 Vali Acc: 0.967 Test Loss: 0.274 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.033788681030273
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.366 Vali Acc: 0.958 Test Loss: 0.366 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.830393552780151
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.301 Vali Acc: 0.972 Test Loss: 0.301 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.602623462677002
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.211 Vali Acc: 0.976 Test Loss: 0.211 Test Acc: 0.976
Validation loss decreased (-0.974928 --> -0.976321).  Saving model ...
Epoch: 15 cost time: 4.966627359390259
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.304 Vali Acc: 0.965 Test Loss: 0.304 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.104625225067139
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.416 Vali Acc: 0.959 Test Loss: 0.416 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.908723831176758
Epoch: 17, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.267 Vali Acc: 0.973 Test Loss: 0.267 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.358843088150024
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.418 Vali Acc: 0.957 Test Loss: 0.418 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.719835996627808
Epoch: 19, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.290 Vali Acc: 0.972 Test Loss: 0.290 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.817610502243042
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.253 Vali Acc: 0.978 Test Loss: 0.253 Test Acc: 0.978
Validation loss decreased (-0.976321 --> -0.977713).  Saving model ...
Epoch: 21 cost time: 4.427211761474609
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.267 Vali Acc: 0.977 Test Loss: 0.267 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.5184645652771
Epoch: 22, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.261 Vali Acc: 0.980 Test Loss: 0.261 Test Acc: 0.980
Validation loss decreased (-0.977713 --> -0.979802).  Saving model ...
Epoch: 23 cost time: 5.0412304401397705
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.321 Vali Acc: 0.971 Test Loss: 0.321 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.711345672607422
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.288 Vali Acc: 0.977 Test Loss: 0.288 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.805862188339233
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.327 Vali Acc: 0.974 Test Loss: 0.327 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.208937644958496
Epoch: 26, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.320 Vali Acc: 0.974 Test Loss: 0.320 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.354991674423218
Epoch: 27, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.405 Vali Acc: 0.960 Test Loss: 0.405 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.211732387542725
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.306 Vali Acc: 0.978 Test Loss: 0.306 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 4.583531618118286
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.310 Vali Acc: 0.976 Test Loss: 0.310 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 4.147806406021118
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.302 Vali Acc: 0.978 Test Loss: 0.302 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 4.212421178817749
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.978 Test Loss: 0.301 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.4494123458862305
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.301 Vali Acc: 0.978 Test Loss: 0.301 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 1585356
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.5063066482543945
Epoch: 1, Steps: 89 | Train Loss: 1.036 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
Validation loss decreased (inf --> -0.915039).  Saving model ...
Epoch: 2 cost time: 4.666854381561279
Epoch: 2, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.915039 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 4.793302774429321
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.156 Vali Acc: 0.963 Test Loss: 0.156 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 4.1579365730285645
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.963090 --> -0.972143).  Saving model ...
Epoch: 5 cost time: 3.959256172180176
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.151 Vali Acc: 0.963 Test Loss: 0.151 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.792964220046997
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.314 Vali Acc: 0.955 Test Loss: 0.314 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.242077827453613
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.973 Test Loss: 0.141 Test Acc: 0.973
Validation loss decreased (-0.972143 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 5.4004857540130615
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.931224346160889
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975625).  Saving model ...
Epoch: 10 cost time: 4.319543361663818
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.219 Vali Acc: 0.964 Test Loss: 0.219 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.983009099960327
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.548729419708252
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.521 Vali Acc: 0.937 Test Loss: 0.521 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.399197816848755
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.556706190109253
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.966 Test Loss: 0.227 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.464357614517212
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.241 Vali Acc: 0.962 Test Loss: 0.241 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.4808216094970703
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.972 Test Loss: 0.229 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.5648508071899414
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.194 Vali Acc: 0.974 Test Loss: 0.194 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.5148510932922363
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.255 Vali Acc: 0.971 Test Loss: 0.255 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.514524459838867
Epoch: 19, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.212 Vali Acc: 0.971 Test Loss: 0.212 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 1585356
model size : 8.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.079446792602539
Epoch: 1, Steps: 89 | Train Loss: 1.077 Vali Loss: 0.355 Vali Acc: 0.891 Test Loss: 0.355 Test Acc: 0.891
Validation loss decreased (inf --> -0.890665).  Saving model ...
Epoch: 2 cost time: 3.7587332725524902
Epoch: 2, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.302 Vali Acc: 0.916 Test Loss: 0.302 Test Acc: 0.916
Validation loss decreased (-0.890665 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 3.3864195346832275
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.246 Vali Acc: 0.942 Test Loss: 0.246 Test Acc: 0.942
Validation loss decreased (-0.915735 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 3.6429972648620605
Epoch: 4, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.261 Vali Acc: 0.942 Test Loss: 0.261 Test Acc: 0.942
Validation loss decreased (-0.941502 --> -0.942198).  Saving model ...
Epoch: 5 cost time: 3.462876319885254
Epoch: 5, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.193 Vali Acc: 0.957 Test Loss: 0.193 Test Acc: 0.957
Validation loss decreased (-0.942198 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 3.9360852241516113
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
Validation loss decreased (-0.956823 --> -0.963090).  Saving model ...
Epoch: 7 cost time: 3.6846466064453125
Epoch: 7, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.251 Vali Acc: 0.964 Test Loss: 0.251 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963786).  Saving model ...
Epoch: 8 cost time: 3.6867966651916504
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.966 Test Loss: 0.238 Test Acc: 0.966
Validation loss decreased (-0.963786 --> -0.965875).  Saving model ...
Epoch: 9 cost time: 3.486630916595459
Epoch: 9, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.563223361968994
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.329 Vali Acc: 0.955 Test Loss: 0.329 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4611575603485107
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.270 Vali Acc: 0.961 Test Loss: 0.270 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.695011615753174
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.362 Vali Acc: 0.957 Test Loss: 0.362 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.3501648902893066
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.308 Vali Acc: 0.953 Test Loss: 0.308 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.325526714324951
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.317 Vali Acc: 0.962 Test Loss: 0.317 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.546914577484131
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.276 Vali Acc: 0.969 Test Loss: 0.276 Test Acc: 0.969
Validation loss decreased (-0.965875 --> -0.969357).  Saving model ...
Epoch: 16 cost time: 3.658358573913574
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.365 Vali Acc: 0.957 Test Loss: 0.365 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6999542713165283
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.414 Vali Acc: 0.953 Test Loss: 0.414 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.779839038848877
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.385 Vali Acc: 0.962 Test Loss: 0.385 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.7658908367156982
Epoch: 19, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.334 Vali Acc: 0.960 Test Loss: 0.334 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9057652950286865
Epoch: 20, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.325 Vali Acc: 0.974 Test Loss: 0.325 Test Acc: 0.974
Validation loss decreased (-0.969357 --> -0.974231).  Saving model ...
Epoch: 21 cost time: 3.640207052230835
Epoch: 21, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.518 Vali Acc: 0.953 Test Loss: 0.518 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.328177213668823
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.342 Vali Acc: 0.976 Test Loss: 0.342 Test Acc: 0.976
Validation loss decreased (-0.974231 --> -0.976320).  Saving model ...
Epoch: 23 cost time: 4.685026168823242
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.457 Vali Acc: 0.959 Test Loss: 0.457 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.8964273929595947
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.448 Vali Acc: 0.960 Test Loss: 0.448 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.9139208793640137
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.421 Vali Acc: 0.966 Test Loss: 0.421 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.413419723510742
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.407 Vali Acc: 0.974 Test Loss: 0.407 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.773656845092773
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.947 Test Loss: 0.693 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.179638624191284
Epoch: 28, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.387 Vali Acc: 0.977 Test Loss: 0.387 Test Acc: 0.977
Validation loss decreased (-0.976320 --> -0.977016).  Saving model ...
Epoch: 29 cost time: 4.670454502105713
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.369 Vali Acc: 0.976 Test Loss: 0.369 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.491056442260742
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.411 Vali Acc: 0.972 Test Loss: 0.411 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.307363033294678
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.427 Vali Acc: 0.969 Test Loss: 0.427 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.639132976531982
Epoch: 32, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.413 Vali Acc: 0.973 Test Loss: 0.413 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.8276450634002686
Epoch: 33, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.478 Vali Acc: 0.967 Test Loss: 0.478 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.893286466598511
Epoch: 34, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.556 Vali Acc: 0.969 Test Loss: 0.556 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.9730165004730225
Epoch: 35, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.410 Vali Acc: 0.976 Test Loss: 0.410 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 3.920258045196533
Epoch: 36, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.579 Vali Acc: 0.951 Test Loss: 0.579 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.352699041366577
Epoch: 37, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.382 Vali Acc: 0.975 Test Loss: 0.382 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.89102578163147
Epoch: 38, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.419 Vali Acc: 0.971 Test Loss: 0.419 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1061068
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.291688442230225
Epoch: 1, Steps: 89 | Train Loss: 1.065 Vali Loss: 0.347 Vali Acc: 0.892 Test Loss: 0.347 Test Acc: 0.892
Validation loss decreased (inf --> -0.892058).  Saving model ...
Epoch: 2 cost time: 4.467055082321167
Epoch: 2, Steps: 89 | Train Loss: 0.233 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
Validation loss decreased (-0.892058 --> -0.919913).  Saving model ...
Epoch: 3 cost time: 4.496676206588745
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.212 Vali Acc: 0.945 Test Loss: 0.212 Test Acc: 0.945
Validation loss decreased (-0.919913 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 5.328771114349365
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.237 Vali Acc: 0.946 Test Loss: 0.237 Test Acc: 0.946
Validation loss decreased (-0.944984 --> -0.946376).  Saving model ...
Epoch: 5 cost time: 5.434213876724243
Epoch: 5, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.212 Vali Acc: 0.961 Test Loss: 0.212 Test Acc: 0.961
Validation loss decreased (-0.946376 --> -0.961001).  Saving model ...
Epoch: 6 cost time: 4.733454465866089
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.970750).  Saving model ...
Epoch: 7 cost time: 4.5527567863464355
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.200 Vali Acc: 0.971 Test Loss: 0.200 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.2480034828186035
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.359 Vali Acc: 0.954 Test Loss: 0.359 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.8954408168792725
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.204 Vali Acc: 0.971 Test Loss: 0.204 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.6744866371154785
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.292 Vali Acc: 0.960 Test Loss: 0.292 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.888052463531494
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.258 Vali Acc: 0.971 Test Loss: 0.258 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.608329772949219
Epoch: 12, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
Validation loss decreased (-0.970750 --> -0.975625).  Saving model ...
Epoch: 13 cost time: 4.5058753490448
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.268 Vali Acc: 0.964 Test Loss: 0.268 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6707053184509277
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.280 Vali Acc: 0.974 Test Loss: 0.280 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.997722864151001
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8929407596588135
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.340 Vali Acc: 0.967 Test Loss: 0.340 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.68563175201416
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8169357776641846
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.364 Vali Acc: 0.964 Test Loss: 0.364 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.5346434116363525
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.545 Vali Acc: 0.948 Test Loss: 0.545 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.7260048389434814
Epoch: 20, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.504 Vali Acc: 0.955 Test Loss: 0.504 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.490786075592041
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.353 Vali Acc: 0.973 Test Loss: 0.353 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.8395087718963623
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.372 Vali Acc: 0.967 Test Loss: 0.372 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 1061068
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.929912567138672
Epoch: 1, Steps: 89 | Train Loss: 1.054 Vali Loss: 0.321 Vali Acc: 0.898 Test Loss: 0.321 Test Acc: 0.898
Validation loss decreased (inf --> -0.897629).  Saving model ...
Epoch: 2 cost time: 3.387936592102051
Epoch: 2, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.278 Vali Acc: 0.935 Test Loss: 0.278 Test Acc: 0.935
Validation loss decreased (-0.897629 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 7.281902313232422
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
Validation loss decreased (-0.934538 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 5.104488134384155
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.283 Vali Acc: 0.947 Test Loss: 0.283 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.2929277420043945
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.169 Vali Acc: 0.964 Test Loss: 0.169 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 4.192881107330322
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.260 Vali Acc: 0.963 Test Loss: 0.260 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8640618324279785
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 3.7190287113189697
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 9 cost time: 3.4232940673828125
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.968 Test Loss: 0.194 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3405368328094482
Epoch: 10, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9653499126434326
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.299 Vali Acc: 0.948 Test Loss: 0.299 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6448659896850586
Epoch: 12, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.248 Vali Acc: 0.963 Test Loss: 0.248 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.633392810821533
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
Validation loss decreased (-0.972143 --> -0.977018).  Saving model ...
Epoch: 14 cost time: 3.622929811477661
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.272 Vali Acc: 0.971 Test Loss: 0.272 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4186768531799316
Epoch: 15, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.401 Vali Acc: 0.958 Test Loss: 0.401 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2711100578308105
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.319 Vali Acc: 0.967 Test Loss: 0.319 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.562588691711426
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.306 Vali Acc: 0.969 Test Loss: 0.306 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.510538339614868
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.258 Vali Acc: 0.969 Test Loss: 0.258 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.2777516841888428
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.356 Vali Acc: 0.969 Test Loss: 0.356 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.4355595111846924
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.365 Vali Acc: 0.967 Test Loss: 0.365 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.43759822845459
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.271 Vali Acc: 0.974 Test Loss: 0.271 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.5987069606781006
Epoch: 22, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.307 Vali Acc: 0.974 Test Loss: 0.307 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.6471872329711914
Epoch: 23, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.275 Vali Acc: 0.976 Test Loss: 0.275 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1061068
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.917738199234009
Epoch: 1, Steps: 89 | Train Loss: 1.076 Vali Loss: 0.277 Vali Acc: 0.928 Test Loss: 0.277 Test Acc: 0.928
Validation loss decreased (inf --> -0.928270).  Saving model ...
Epoch: 2 cost time: 3.4642088413238525
Epoch: 2, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.928270 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 3.4292187690734863
Epoch: 3, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.146 Vali Acc: 0.968 Test Loss: 0.146 Test Acc: 0.968
Validation loss decreased (-0.951948 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 3.5499963760375977
Epoch: 4, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 3.605513572692871
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4672563076019287
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.7277846336364746
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 3.754985809326172
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.106 Vali Acc: 0.981 Test Loss: 0.106 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.981197).  Saving model ...
Epoch: 9 cost time: 3.071106195449829
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.879861831665039
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.939098358154297
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.349 Vali Acc: 0.944 Test Loss: 0.349 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.2650651931762695
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.215 Vali Acc: 0.972 Test Loss: 0.215 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.6804428100585938
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.211 Vali Acc: 0.970 Test Loss: 0.211 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.505040407180786
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.634873151779175
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.323940992355347
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.271 Vali Acc: 0.962 Test Loss: 0.271 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.6364450454711914
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.281 Vali Acc: 0.970 Test Loss: 0.281 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.6589927673339844
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.977 Test Loss: 0.210 Test Acc: 0.977
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 1061068
model size : 6.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.117205858230591
Epoch: 1, Steps: 89 | Train Loss: 1.041 Vali Loss: 0.313 Vali Acc: 0.916 Test Loss: 0.313 Test Acc: 0.916
Validation loss decreased (inf --> -0.915735).  Saving model ...
Epoch: 2 cost time: 3.769336700439453
Epoch: 2, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.335 Vali Acc: 0.909 Test Loss: 0.335 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.890314817428589
Epoch: 3, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.221 Vali Acc: 0.953 Test Loss: 0.221 Test Acc: 0.953
Validation loss decreased (-0.915735 --> -0.953340).  Saving model ...
Epoch: 4 cost time: 3.657714605331421
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.259 Vali Acc: 0.951 Test Loss: 0.259 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.439664840698242
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.445253610610962
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.299 Vali Acc: 0.954 Test Loss: 0.299 Test Acc: 0.954
Validation loss decreased (-0.953340 --> -0.954036).  Saving model ...
Epoch: 7 cost time: 3.663518190383911
Epoch: 7, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.250 Vali Acc: 0.965 Test Loss: 0.250 Test Acc: 0.965
Validation loss decreased (-0.954036 --> -0.965179).  Saving model ...
Epoch: 8 cost time: 3.8872992992401123
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.297 Vali Acc: 0.958 Test Loss: 0.297 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.675959587097168
Epoch: 9, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.231 Vali Acc: 0.972 Test Loss: 0.231 Test Acc: 0.972
Validation loss decreased (-0.965179 --> -0.972143).  Saving model ...
Epoch: 10 cost time: 3.978059768676758
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.290 Vali Acc: 0.961 Test Loss: 0.290 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8448309898376465
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.339 Vali Acc: 0.963 Test Loss: 0.339 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.062991380691528
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.416 Vali Acc: 0.947 Test Loss: 0.416 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.6428866386413574
Epoch: 13, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.257 Vali Acc: 0.973 Test Loss: 0.257 Test Acc: 0.973
Validation loss decreased (-0.972143 --> -0.972839).  Saving model ...
Epoch: 14 cost time: 3.8518898487091064
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.337 Vali Acc: 0.964 Test Loss: 0.337 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.4811465740203857
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.369 Vali Acc: 0.953 Test Loss: 0.369 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4182727336883545
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.447 Vali Acc: 0.969 Test Loss: 0.447 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.7016289234161377
Epoch: 17, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.327 Vali Acc: 0.974 Test Loss: 0.327 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.974231).  Saving model ...
Epoch: 18 cost time: 3.8818910121917725
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.362 Vali Acc: 0.968 Test Loss: 0.362 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4331600666046143
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.344 Vali Acc: 0.972 Test Loss: 0.344 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.4175074100494385
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.414 Vali Acc: 0.962 Test Loss: 0.414 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.6009302139282227
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.363 Vali Acc: 0.969 Test Loss: 0.363 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.00152063369751
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.343 Vali Acc: 0.972 Test Loss: 0.343 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.6467597484588623
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.972 Test Loss: 0.337 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.463395595550537
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.331 Vali Acc: 0.972 Test Loss: 0.331 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.482760429382324
Epoch: 25, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.327 Vali Acc: 0.971 Test Loss: 0.327 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.4000096321105957
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.323 Vali Acc: 0.972 Test Loss: 0.323 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.493277072906494
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.324 Vali Acc: 0.972 Test Loss: 0.324 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 798924
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.877825021743774
Epoch: 1, Steps: 89 | Train Loss: 1.032 Vali Loss: 0.306 Vali Acc: 0.914 Test Loss: 0.306 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 3.42397141456604
Epoch: 2, Steps: 89 | Train Loss: 0.240 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.914342 --> -0.922003).  Saving model ...
Epoch: 3 cost time: 3.4546265602111816
Epoch: 3, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.191 Vali Acc: 0.959 Test Loss: 0.191 Test Acc: 0.959
Validation loss decreased (-0.922003 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 3.550682544708252
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964482).  Saving model ...
Epoch: 5 cost time: 3.393111228942871
Epoch: 5, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.311 Vali Acc: 0.939 Test Loss: 0.311 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.476452589035034
Epoch: 6, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.196 Vali Acc: 0.969 Test Loss: 0.196 Test Acc: 0.969
Validation loss decreased (-0.964482 --> -0.968661).  Saving model ...
Epoch: 7 cost time: 3.6781363487243652
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.200 Vali Acc: 0.975 Test Loss: 0.200 Test Acc: 0.975
Validation loss decreased (-0.968661 --> -0.974928).  Saving model ...
Epoch: 8 cost time: 3.4965927600860596
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.338 Vali Acc: 0.952 Test Loss: 0.338 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1791820526123047
Epoch: 9, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.178 Vali Acc: 0.977 Test Loss: 0.178 Test Acc: 0.977
Validation loss decreased (-0.974928 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 3.473644256591797
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.298 Vali Acc: 0.958 Test Loss: 0.298 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.4253554344177246
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.974 Test Loss: 0.217 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.3651976585388184
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.325 Vali Acc: 0.960 Test Loss: 0.325 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.5858914852142334
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.245 Vali Acc: 0.976 Test Loss: 0.245 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.590334415435791
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.274 Vali Acc: 0.969 Test Loss: 0.274 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.337109088897705
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.283 Vali Acc: 0.968 Test Loss: 0.283 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.320918560028076
Epoch: 16, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.326 Vali Acc: 0.970 Test Loss: 0.326 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.4581029415130615
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.397 Vali Acc: 0.967 Test Loss: 0.397 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.4906442165374756
Epoch: 18, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.505 Vali Acc: 0.967 Test Loss: 0.505 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.3439388275146484
Epoch: 19, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.438 Vali Acc: 0.965 Test Loss: 0.438 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 798924
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.493205785751343
Epoch: 1, Steps: 89 | Train Loss: 1.029 Vali Loss: 0.291 Vali Acc: 0.923 Test Loss: 0.291 Test Acc: 0.923
Validation loss decreased (inf --> -0.923395).  Saving model ...
Epoch: 2 cost time: 3.4528982639312744
Epoch: 2, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.245 Vali Acc: 0.932 Test Loss: 0.245 Test Acc: 0.932
Validation loss decreased (-0.923395 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 3.631758689880371
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.161 Vali Acc: 0.963 Test Loss: 0.161 Test Acc: 0.963
Validation loss decreased (-0.931752 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 3.2394027709960938
Epoch: 4, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.169 Vali Acc: 0.969 Test Loss: 0.169 Test Acc: 0.969
Validation loss decreased (-0.963090 --> -0.968661).  Saving model ...
Epoch: 5 cost time: 3.311441421508789
Epoch: 5, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.210 Vali Acc: 0.962 Test Loss: 0.210 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4085822105407715
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.217 Vali Acc: 0.961 Test Loss: 0.217 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.521483898162842
Epoch: 7, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.167 Vali Acc: 0.975 Test Loss: 0.167 Test Acc: 0.975
Validation loss decreased (-0.968661 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 3.3580708503723145
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.3687682151794434
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.964 Test Loss: 0.219 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.1958885192871094
Epoch: 10, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.193 Vali Acc: 0.971 Test Loss: 0.193 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.525946855545044
Epoch: 11, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.441 Vali Acc: 0.932 Test Loss: 0.441 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.5093729496002197
Epoch: 12, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.352 Vali Acc: 0.964 Test Loss: 0.352 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.1351640224456787
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.378 Vali Acc: 0.951 Test Loss: 0.378 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3699564933776855
Epoch: 14, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.277 Vali Acc: 0.971 Test Loss: 0.277 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.46243953704834
Epoch: 15, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.282 Vali Acc: 0.963 Test Loss: 0.282 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.446789264678955
Epoch: 16, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.300 Vali Acc: 0.967 Test Loss: 0.300 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.4366941452026367
Epoch: 17, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.296 Vali Acc: 0.967 Test Loss: 0.296 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 798924
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.039345502853394
Epoch: 1, Steps: 89 | Train Loss: 1.050 Vali Loss: 0.250 Vali Acc: 0.942 Test Loss: 0.250 Test Acc: 0.942
Validation loss decreased (inf --> -0.941502).  Saving model ...
Epoch: 2 cost time: 5.344658136367798
Epoch: 2, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.207 Vali Acc: 0.945 Test Loss: 0.207 Test Acc: 0.945
Validation loss decreased (-0.941502 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 5.721500635147095
Epoch: 3, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.958215).  Saving model ...
Epoch: 4 cost time: 6.055287837982178
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.166 Vali Acc: 0.963 Test Loss: 0.166 Test Acc: 0.963
Validation loss decreased (-0.958215 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.7618794441223145
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.174 Vali Acc: 0.962 Test Loss: 0.174 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.109723329544067
Epoch: 6, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 5.295104503631592
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 8 cost time: 6.107934474945068
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975625).  Saving model ...
Epoch: 9 cost time: 6.222229719161987
Epoch: 9, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.242 Vali Acc: 0.959 Test Loss: 0.242 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.848626375198364
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.229 Vali Acc: 0.958 Test Loss: 0.229 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.926554203033447
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.80296516418457
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.976 Test Loss: 0.153 Test Acc: 0.976
Validation loss decreased (-0.975625 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 5.778764724731445
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.976 Test Loss: 0.151 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.511080026626587
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.977 Test Loss: 0.164 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 15 cost time: 5.593047380447388
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.317 Vali Acc: 0.955 Test Loss: 0.317 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.344808101654053
Epoch: 16, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.527142286300659
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.169 Vali Acc: 0.981 Test Loss: 0.169 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.981196).  Saving model ...
Epoch: 18 cost time: 5.6505255699157715
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.301 Vali Acc: 0.958 Test Loss: 0.301 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.817943572998047
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.205 Vali Acc: 0.970 Test Loss: 0.205 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 6.52884578704834
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.755077123641968
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.978 Test Loss: 0.179 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 6.110701322555542
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.251 Vali Acc: 0.970 Test Loss: 0.251 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.71953821182251
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.252 Vali Acc: 0.971 Test Loss: 0.252 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.674898624420166
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.282 Vali Acc: 0.964 Test Loss: 0.282 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.822555303573608
Epoch: 25, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.174 Vali Acc: 0.980 Test Loss: 0.174 Test Acc: 0.980
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.653424978256226
Epoch: 26, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 6.300186395645142
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.267 Vali Acc: 0.974 Test Loss: 0.267 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 798924
model size : 5.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.184863328933716
Epoch: 1, Steps: 89 | Train Loss: 1.078 Vali Loss: 0.396 Vali Acc: 0.890 Test Loss: 0.396 Test Acc: 0.890
Validation loss decreased (inf --> -0.889968).  Saving model ...
Epoch: 2 cost time: 5.417216062545776
Epoch: 2, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.889968 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 6.231092214584351
Epoch: 3, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.947770 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 5.144281387329102
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.419 Vali Acc: 0.914 Test Loss: 0.419 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.402346611022949
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.674772024154663
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.249 Vali Acc: 0.953 Test Loss: 0.249 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.458169937133789
Epoch: 7, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.268 Vali Acc: 0.954 Test Loss: 0.268 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.138395309448242
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.278 Vali Acc: 0.949 Test Loss: 0.278 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 6.888442754745483
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.377 Vali Acc: 0.952 Test Loss: 0.377 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 6.445558309555054
Epoch: 10, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.362 Vali Acc: 0.944 Test Loss: 0.362 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 6.273468494415283
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.368 Vali Acc: 0.955 Test Loss: 0.368 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 5.671964883804321
Epoch: 12, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.350 Vali Acc: 0.953 Test Loss: 0.350 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 6.352326154708862
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.388 Vali Acc: 0.956 Test Loss: 0.388 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9575208913649025
model parameter : 667852
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.719703912734985
Epoch: 1, Steps: 89 | Train Loss: 1.069 Vali Loss: 0.384 Vali Acc: 0.893 Test Loss: 0.384 Test Acc: 0.893
Validation loss decreased (inf --> -0.892754).  Saving model ...
Epoch: 2 cost time: 5.6741859912872314
Epoch: 2, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.892754 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 6.389926433563232
Epoch: 3, Steps: 89 | Train Loss: 0.158 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
Validation loss decreased (-0.944287 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 5.930712699890137
Epoch: 4, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.452 Vali Acc: 0.900 Test Loss: 0.452 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.709238290786743
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.318 Vali Acc: 0.949 Test Loss: 0.318 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 6.366038799285889
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.264 Vali Acc: 0.954 Test Loss: 0.264 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 6.925453186035156
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.237 Vali Acc: 0.962 Test Loss: 0.237 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 6.579331159591675
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964482).  Saving model ...
Epoch: 9 cost time: 6.324015140533447
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.249 Vali Acc: 0.971 Test Loss: 0.249 Test Acc: 0.971
Validation loss decreased (-0.964482 --> -0.971446).  Saving model ...
Epoch: 10 cost time: 6.149795293807983
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.229 Vali Acc: 0.971 Test Loss: 0.229 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.029115200042725
Epoch: 11, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.286 Vali Acc: 0.972 Test Loss: 0.286 Test Acc: 0.972
Validation loss decreased (-0.971446 --> -0.972142).  Saving model ...
Epoch: 12 cost time: 6.487114429473877
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.389 Vali Acc: 0.952 Test Loss: 0.389 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.362192392349243
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.376 Vali Acc: 0.953 Test Loss: 0.376 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.464796543121338
Epoch: 14, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.508 Vali Acc: 0.947 Test Loss: 0.508 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 6.233672857284546
Epoch: 15, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.477 Vali Acc: 0.955 Test Loss: 0.477 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 6.458950996398926
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.324 Vali Acc: 0.971 Test Loss: 0.324 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 6.186141729354858
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.299 Vali Acc: 0.974 Test Loss: 0.299 Test Acc: 0.974
Validation loss decreased (-0.972142 --> -0.974231).  Saving model ...
Epoch: 18 cost time: 6.031382322311401
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.319 Vali Acc: 0.971 Test Loss: 0.319 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.477730751037598
Epoch: 19, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.261 Vali Acc: 0.975 Test Loss: 0.261 Test Acc: 0.975
Validation loss decreased (-0.974231 --> -0.974928).  Saving model ...
Epoch: 20 cost time: 6.622232913970947
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.283 Vali Acc: 0.971 Test Loss: 0.283 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.985937118530273
Epoch: 21, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.342 Vali Acc: 0.968 Test Loss: 0.342 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.406137704849243
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.236 Vali Acc: 0.978 Test Loss: 0.236 Test Acc: 0.978
Validation loss decreased (-0.974928 --> -0.977714).  Saving model ...
Epoch: 23 cost time: 6.917083263397217
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.288 Vali Acc: 0.976 Test Loss: 0.288 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 7.1166040897369385
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.331 Vali Acc: 0.971 Test Loss: 0.331 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.204178810119629
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.429 Vali Acc: 0.958 Test Loss: 0.429 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 7.467389106750488
Epoch: 26, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.781 Vali Acc: 0.939 Test Loss: 0.781 Test Acc: 0.939
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 6.290245532989502
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.382 Vali Acc: 0.969 Test Loss: 0.382 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 6.741942882537842
Epoch: 28, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.398 Vali Acc: 0.965 Test Loss: 0.398 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 6.285093545913696
Epoch: 29, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.328 Vali Acc: 0.968 Test Loss: 0.328 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 7.134403705596924
Epoch: 30, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.402 Vali Acc: 0.976 Test Loss: 0.402 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 6.002368688583374
Epoch: 31, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.515 Vali Acc: 0.967 Test Loss: 0.515 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 6.579904317855835
Epoch: 32, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.382 Vali Acc: 0.973 Test Loss: 0.382 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 667852
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.030102729797363
Epoch: 1, Steps: 89 | Train Loss: 1.065 Vali Loss: 0.378 Vali Acc: 0.900 Test Loss: 0.378 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 6.147855043411255
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.279 Vali Acc: 0.932 Test Loss: 0.279 Test Acc: 0.932
Validation loss decreased (-0.900414 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 6.190638303756714
Epoch: 3, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.167 Vali Acc: 0.965 Test Loss: 0.167 Test Acc: 0.965
Validation loss decreased (-0.931752 --> -0.965179).  Saving model ...
Epoch: 4 cost time: 5.702775001525879
Epoch: 4, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.978358507156372
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.7848286628723145
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.143 Vali Acc: 0.977 Test Loss: 0.143 Test Acc: 0.977
Validation loss decreased (-0.965179 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 5.962871074676514
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.536375045776367
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.266 Vali Acc: 0.953 Test Loss: 0.266 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.580126047134399
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.969 Test Loss: 0.235 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.66566014289856
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.226 Vali Acc: 0.967 Test Loss: 0.226 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.10982608795166
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.275 Vali Acc: 0.971 Test Loss: 0.275 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.707356929779053
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.256 Vali Acc: 0.974 Test Loss: 0.256 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 6.509691476821899
Epoch: 13, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.378 Vali Acc: 0.948 Test Loss: 0.378 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 6.303987264633179
Epoch: 14, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.355 Vali Acc: 0.956 Test Loss: 0.355 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.966919183731079
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.280 Vali Acc: 0.974 Test Loss: 0.280 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 6.380513906478882
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.374 Vali Acc: 0.964 Test Loss: 0.374 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 667852
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.83445143699646
Epoch: 1, Steps: 89 | Train Loss: 1.086 Vali Loss: 0.314 Vali Acc: 0.916 Test Loss: 0.314 Test Acc: 0.916
Validation loss decreased (inf --> -0.915735).  Saving model ...
Epoch: 2 cost time: 5.590958595275879
Epoch: 2, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
Validation loss decreased (-0.915735 --> -0.952644).  Saving model ...
Epoch: 3 cost time: 5.31522011756897
Epoch: 3, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.126 Vali Acc: 0.969 Test Loss: 0.126 Test Acc: 0.969
Validation loss decreased (-0.952644 --> -0.968662).  Saving model ...
Epoch: 4 cost time: 6.078204393386841
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.054969787597656
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.123 Vali Acc: 0.981 Test Loss: 0.123 Test Acc: 0.981
Validation loss decreased (-0.968662 --> -0.980500).  Saving model ...
Epoch: 6 cost time: 5.777951240539551
Epoch: 6, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.106 Vali Acc: 0.974 Test Loss: 0.106 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.431793212890625
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.446545362472534
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.152986288070679
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.297 Vali Acc: 0.962 Test Loss: 0.297 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.049400806427002
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.963247060775757
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.203 Vali Acc: 0.973 Test Loss: 0.203 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 6.031054258346558
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 6.081484794616699
Epoch: 13, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.257 Vali Acc: 0.968 Test Loss: 0.257 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 5.108478546142578
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.269 Vali Acc: 0.962 Test Loss: 0.269 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.435845136642456
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.238 Vali Acc: 0.980 Test Loss: 0.238 Test Acc: 0.980
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 667852
model size : 5.01MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.975246429443359
Epoch: 1, Steps: 89 | Train Loss: 1.033 Vali Loss: 0.349 Vali Acc: 0.908 Test Loss: 0.349 Test Acc: 0.908
Validation loss decreased (inf --> -0.908075).  Saving model ...
Epoch: 2 cost time: 5.930819511413574
Epoch: 2, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.315 Vali Acc: 0.927 Test Loss: 0.315 Test Acc: 0.927
Validation loss decreased (-0.908075 --> -0.926877).  Saving model ...
Epoch: 3 cost time: 5.908111810684204
Epoch: 3, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.926877 --> -0.929663).  Saving model ...
Epoch: 4 cost time: 6.043437242507935
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.285950422286987
Epoch: 5, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.446 Vali Acc: 0.905 Test Loss: 0.446 Test Acc: 0.905
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 5.744459629058838
Epoch: 6, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.228 Vali Acc: 0.960 Test Loss: 0.228 Test Acc: 0.960
Validation loss decreased (-0.929663 --> -0.960304).  Saving model ...
Epoch: 7 cost time: 6.022205114364624
Epoch: 7, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.256 Vali Acc: 0.956 Test Loss: 0.256 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.686987638473511
Epoch: 8, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.253 Vali Acc: 0.965 Test Loss: 0.253 Test Acc: 0.965
Validation loss decreased (-0.960304 --> -0.965179).  Saving model ...
Epoch: 9 cost time: 5.997346639633179
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.320 Vali Acc: 0.954 Test Loss: 0.320 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.105185270309448
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
Validation loss decreased (-0.965179 --> -0.966571).  Saving model ...
Epoch: 11 cost time: 6.222366809844971
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.265 Vali Acc: 0.962 Test Loss: 0.265 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.627350330352783
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.249 Vali Acc: 0.966 Test Loss: 0.249 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 6.234141111373901
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.420 Vali Acc: 0.940 Test Loss: 0.420 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.1030895709991455
Epoch: 14, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.515 Vali Acc: 0.932 Test Loss: 0.515 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 6.591155052185059
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.299 Vali Acc: 0.968 Test Loss: 0.299 Test Acc: 0.968
Validation loss decreased (-0.966571 --> -0.967964).  Saving model ...
Epoch: 16 cost time: 6.4199700355529785
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.282 Vali Acc: 0.971 Test Loss: 0.282 Test Acc: 0.971
Validation loss decreased (-0.967964 --> -0.971446).  Saving model ...
Epoch: 17 cost time: 6.469385385513306
Epoch: 17, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.268 Vali Acc: 0.976 Test Loss: 0.268 Test Acc: 0.976
Validation loss decreased (-0.971446 --> -0.976320).  Saving model ...
Epoch: 18 cost time: 6.4241461753845215
Epoch: 18, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.329 Vali Acc: 0.961 Test Loss: 0.329 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 6.303366661071777
Epoch: 19, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.450 Vali Acc: 0.962 Test Loss: 0.450 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 7.186262845993042
Epoch: 20, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.388 Vali Acc: 0.962 Test Loss: 0.388 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 6.573186874389648
Epoch: 21, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.454 Vali Acc: 0.961 Test Loss: 0.454 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 7.016005754470825
Epoch: 22, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.425 Vali Acc: 0.962 Test Loss: 0.425 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 6.976807117462158
Epoch: 23, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.484 Vali Acc: 0.962 Test Loss: 0.484 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 7.565403938293457
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.369 Vali Acc: 0.969 Test Loss: 0.369 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 7.1712939739227295
Epoch: 25, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.349 Vali Acc: 0.973 Test Loss: 0.349 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 6.016680002212524
Epoch: 26, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.351 Vali Acc: 0.974 Test Loss: 0.351 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.484102487564087
Epoch: 27, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.974 Test Loss: 0.342 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 602316
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.099925756454468
Epoch: 1, Steps: 89 | Train Loss: 1.027 Vali Loss: 0.335 Vali Acc: 0.912 Test Loss: 0.335 Test Acc: 0.912
Validation loss decreased (inf --> -0.911557).  Saving model ...
Epoch: 2 cost time: 6.269761085510254
Epoch: 2, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.311 Vali Acc: 0.928 Test Loss: 0.311 Test Acc: 0.928
Validation loss decreased (-0.911557 --> -0.927573).  Saving model ...
Epoch: 3 cost time: 6.022688388824463
Epoch: 3, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.235 Vali Acc: 0.945 Test Loss: 0.235 Test Acc: 0.945
Validation loss decreased (-0.927573 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 7.112094402313232
Epoch: 4, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.312 Vali Acc: 0.928 Test Loss: 0.312 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 6.901342391967773
Epoch: 5, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.270 Vali Acc: 0.949 Test Loss: 0.270 Test Acc: 0.949
Validation loss decreased (-0.944984 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 6.46979284286499
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.243 Vali Acc: 0.959 Test Loss: 0.243 Test Acc: 0.959
Validation loss decreased (-0.949162 --> -0.958911).  Saving model ...
Epoch: 7 cost time: 6.422269821166992
Epoch: 7, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.309 Vali Acc: 0.946 Test Loss: 0.309 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.9638707637786865
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.216 Vali Acc: 0.970 Test Loss: 0.216 Test Acc: 0.970
Validation loss decreased (-0.958911 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 6.377795219421387
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.264 Vali Acc: 0.967 Test Loss: 0.264 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.033796072006226
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.332 Vali Acc: 0.955 Test Loss: 0.332 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.561142683029175
Epoch: 11, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.255 Vali Acc: 0.959 Test Loss: 0.255 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 6.798199892044067
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.290 Vali Acc: 0.972 Test Loss: 0.290 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972142).  Saving model ...
Epoch: 13 cost time: 6.25623083114624
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.324 Vali Acc: 0.968 Test Loss: 0.324 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.907353639602661
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.246 Vali Acc: 0.974 Test Loss: 0.246 Test Acc: 0.974
Validation loss decreased (-0.972142 --> -0.974232).  Saving model ...
Epoch: 15 cost time: 6.8360114097595215
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.976 Test Loss: 0.279 Test Acc: 0.976
Validation loss decreased (-0.974232 --> -0.976320).  Saving model ...
Epoch: 16 cost time: 6.722125768661499
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.973 Test Loss: 0.269 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 7.014742612838745
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.373 Vali Acc: 0.966 Test Loss: 0.373 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 6.721546649932861
Epoch: 18, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.442 Vali Acc: 0.953 Test Loss: 0.442 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 6.536128759384155
Epoch: 19, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.380 Vali Acc: 0.954 Test Loss: 0.380 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 6.430467128753662
Epoch: 20, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.393 Vali Acc: 0.964 Test Loss: 0.393 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 6.453246116638184
Epoch: 21, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.266 Vali Acc: 0.974 Test Loss: 0.266 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.458104610443115
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.317 Vali Acc: 0.968 Test Loss: 0.317 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 6.0991175174713135
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.392 Vali Acc: 0.967 Test Loss: 0.392 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 6.84056544303894
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.266 Vali Acc: 0.978 Test Loss: 0.266 Test Acc: 0.978
Validation loss decreased (-0.976320 --> -0.978410).  Saving model ...
Epoch: 25 cost time: 6.583353281021118
Epoch: 25, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.320 Vali Acc: 0.974 Test Loss: 0.320 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.998926401138306
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.335 Vali Acc: 0.973 Test Loss: 0.335 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 6.6481945514678955
Epoch: 27, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.489 Vali Acc: 0.961 Test Loss: 0.489 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.467890977859497
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.372 Vali Acc: 0.972 Test Loss: 0.372 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.9209277629852295
Epoch: 29, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.412 Vali Acc: 0.969 Test Loss: 0.412 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 6.305221319198608
Epoch: 30, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.409 Vali Acc: 0.971 Test Loss: 0.409 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 6.196978330612183
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.345 Vali Acc: 0.976 Test Loss: 0.345 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.746582746505737
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.420 Vali Acc: 0.962 Test Loss: 0.420 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 6.456053733825684
Epoch: 33, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.448 Vali Acc: 0.970 Test Loss: 0.448 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.715458631515503
Epoch: 34, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.441 Vali Acc: 0.966 Test Loss: 0.441 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 602316
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.288798332214355
Epoch: 1, Steps: 89 | Train Loss: 1.022 Vali Loss: 0.335 Vali Acc: 0.914 Test Loss: 0.335 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 6.488604784011841
Epoch: 2, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.262 Vali Acc: 0.931 Test Loss: 0.262 Test Acc: 0.931
Validation loss decreased (-0.914342 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 5.7829673290252686
Epoch: 3, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.931056 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 6.153158187866211
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.230 Vali Acc: 0.951 Test Loss: 0.230 Test Acc: 0.951
Validation loss decreased (-0.943591 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 5.64767050743103
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.459155082702637
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.270 Vali Acc: 0.955 Test Loss: 0.270 Test Acc: 0.955
Validation loss decreased (-0.951251 --> -0.955429).  Saving model ...
Epoch: 7 cost time: 5.841564655303955
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.174 Vali Acc: 0.970 Test Loss: 0.174 Test Acc: 0.970
Validation loss decreased (-0.955429 --> -0.970054).  Saving model ...
Epoch: 8 cost time: 5.7923057079315186
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.248 Vali Acc: 0.968 Test Loss: 0.248 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.494936227798462
Epoch: 9, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.972 Test Loss: 0.184 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 10 cost time: 5.50052547454834
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.292 Vali Acc: 0.965 Test Loss: 0.292 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.70012354850769
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.290 Vali Acc: 0.955 Test Loss: 0.290 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.511580228805542
Epoch: 12, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.241 Vali Acc: 0.970 Test Loss: 0.241 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.210961818695068
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.269 Vali Acc: 0.965 Test Loss: 0.269 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.557965040206909
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.972 Test Loss: 0.246 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.63067626953125
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.327 Vali Acc: 0.966 Test Loss: 0.327 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.489186763763428
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.303 Vali Acc: 0.972 Test Loss: 0.303 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.3285768032073975
Epoch: 17, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.412 Vali Acc: 0.954 Test Loss: 0.412 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.986681699752808
Epoch: 18, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.311 Vali Acc: 0.962 Test Loss: 0.311 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.591279745101929
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.372 Vali Acc: 0.964 Test Loss: 0.372 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 602316
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.530652284622192
Epoch: 1, Steps: 89 | Train Loss: 1.067 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
Validation loss decreased (inf --> -0.918521).  Saving model ...
Epoch: 2 cost time: 5.300995588302612
Epoch: 2, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.918521 --> -0.950555).  Saving model ...
Epoch: 3 cost time: 5.997816801071167
Epoch: 3, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.215 Vali Acc: 0.947 Test Loss: 0.215 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.6879541873931885
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.171 Vali Acc: 0.963 Test Loss: 0.171 Test Acc: 0.963
Validation loss decreased (-0.950555 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.481744766235352
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
Validation loss decreased (-0.963090 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 5.893605470657349
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.4750730991363525
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.916714191436768
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.975 Test Loss: 0.133 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.632897138595581
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.958 Test Loss: 0.230 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.41122841835022
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.155 Vali Acc: 0.975 Test Loss: 0.155 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.381700754165649
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 5.403489351272583
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.977 Test Loss: 0.154 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 13 cost time: 4.865979194641113
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.318 Vali Acc: 0.950 Test Loss: 0.318 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.5302183628082275
Epoch: 14, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.229 Vali Acc: 0.971 Test Loss: 0.229 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.247782230377197
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.265 Vali Acc: 0.973 Test Loss: 0.265 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.982940196990967
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.281 Vali Acc: 0.967 Test Loss: 0.281 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.0463621616363525
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.968 Test Loss: 0.254 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 5.493973016738892
Epoch: 18, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.391 Vali Acc: 0.955 Test Loss: 0.391 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.512221574783325
Epoch: 19, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.406 Vali Acc: 0.963 Test Loss: 0.406 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.163078784942627
Epoch: 20, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.261 Vali Acc: 0.971 Test Loss: 0.261 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.908339500427246
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.272 Vali Acc: 0.972 Test Loss: 0.272 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.020568370819092
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.976 Test Loss: 0.243 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 602316
model size : 4.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.980294704437256
Epoch: 1, Steps: 89 | Train Loss: 1.049 Vali Loss: 0.318 Vali Acc: 0.912 Test Loss: 0.318 Test Acc: 0.912
Validation loss decreased (inf --> -0.911557).  Saving model ...
Epoch: 2 cost time: 5.284202337265015
Epoch: 2, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.254 Vali Acc: 0.940 Test Loss: 0.254 Test Acc: 0.940
Validation loss decreased (-0.911557 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 5.946103572845459
Epoch: 3, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.288 Vali Acc: 0.938 Test Loss: 0.288 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.648286819458008
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.197 Vali Acc: 0.963 Test Loss: 0.197 Test Acc: 0.963
Validation loss decreased (-0.940109 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 6.364894866943359
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.225 Vali Acc: 0.960 Test Loss: 0.225 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.396021842956543
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.275 Vali Acc: 0.949 Test Loss: 0.275 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.720397233963013
Epoch: 7, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.259 Vali Acc: 0.950 Test Loss: 0.259 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.6529700756073
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.321 Vali Acc: 0.946 Test Loss: 0.321 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.797718524932861
Epoch: 9, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.269 Vali Acc: 0.958 Test Loss: 0.269 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.691518545150757
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.303 Vali Acc: 0.958 Test Loss: 0.303 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.8299877643585205
Epoch: 11, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.328 Vali Acc: 0.957 Test Loss: 0.328 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 5.9099204540252686
Epoch: 12, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.426 Vali Acc: 0.944 Test Loss: 0.426 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 6.141829013824463
Epoch: 13, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.416 Vali Acc: 0.951 Test Loss: 0.416 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 5.30397629737854
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.337 Vali Acc: 0.971 Test Loss: 0.337 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.970749).  Saving model ...
Epoch: 15 cost time: 6.281370639801025
Epoch: 15, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.417 Vali Acc: 0.957 Test Loss: 0.417 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.013072729110718
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.342 Vali Acc: 0.966 Test Loss: 0.342 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.668104410171509
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.370 Vali Acc: 0.964 Test Loss: 0.370 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.870195627212524
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.300 Vali Acc: 0.972 Test Loss: 0.300 Test Acc: 0.972
Validation loss decreased (-0.970749 --> -0.972142).  Saving model ...
Epoch: 19 cost time: 5.347090005874634
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.398 Vali Acc: 0.969 Test Loss: 0.398 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.163059234619141
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.345 Vali Acc: 0.970 Test Loss: 0.345 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.28679347038269
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.333 Vali Acc: 0.971 Test Loss: 0.333 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.38384485244751
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.334 Vali Acc: 0.969 Test Loss: 0.334 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.7837607860565186
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.346 Vali Acc: 0.970 Test Loss: 0.346 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.90148663520813
Epoch: 24, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.384 Vali Acc: 0.967 Test Loss: 0.384 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.668927192687988
Epoch: 25, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.321 Vali Acc: 0.973 Test Loss: 0.321 Test Acc: 0.973
Validation loss decreased (-0.972142 --> -0.972838).  Saving model ...
Epoch: 26 cost time: 5.361078262329102
Epoch: 26, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.353 Vali Acc: 0.971 Test Loss: 0.353 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 5.547200679779053
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.356 Vali Acc: 0.968 Test Loss: 0.356 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 5.899123430252075
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.495 Vali Acc: 0.958 Test Loss: 0.495 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 5.283864974975586
Epoch: 29, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.377 Vali Acc: 0.968 Test Loss: 0.377 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 5.161741495132446
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.348 Vali Acc: 0.972 Test Loss: 0.348 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 5.951977252960205
Epoch: 31, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.406 Vali Acc: 0.967 Test Loss: 0.406 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 4.778299331665039
Epoch: 32, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.923 Vali Acc: 0.937 Test Loss: 0.923 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 5.448915958404541
Epoch: 33, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.515 Vali Acc: 0.971 Test Loss: 0.515 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 5.388665676116943
Epoch: 34, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.463 Vali Acc: 0.974 Test Loss: 0.463 Test Acc: 0.974
Validation loss decreased (-0.972838 --> -0.974229).  Saving model ...
Epoch: 35 cost time: 5.091086149215698
Epoch: 35, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.506 Vali Acc: 0.972 Test Loss: 0.506 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 5.5564470291137695
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.518 Vali Acc: 0.967 Test Loss: 0.518 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 5.5233070850372314
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.471 Vali Acc: 0.974 Test Loss: 0.471 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 5.766642808914185
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.469 Vali Acc: 0.974 Test Loss: 0.469 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 5.58177924156189
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.974 Test Loss: 0.435 Test Acc: 0.974
Validation loss decreased (-0.974229 --> -0.974230).  Saving model ...
Epoch: 40 cost time: 5.101519584655762
Epoch: 40, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.423 Vali Acc: 0.976 Test Loss: 0.423 Test Acc: 0.976
Validation loss decreased (-0.974230 --> -0.975623).  Saving model ...
Epoch: 41 cost time: 4.852632761001587
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.432 Vali Acc: 0.973 Test Loss: 0.432 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 5.134981632232666
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.430 Vali Acc: 0.972 Test Loss: 0.430 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 5.509300947189331
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.435 Vali Acc: 0.976 Test Loss: 0.435 Test Acc: 0.976
Validation loss decreased (-0.975623 --> -0.976319).  Saving model ...
Epoch: 44 cost time: 4.853888988494873
Epoch: 44, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.524 Vali Acc: 0.965 Test Loss: 0.524 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 5.124165773391724
Epoch: 45, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.529 Vali Acc: 0.969 Test Loss: 0.529 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 5.793551445007324
Epoch: 46, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.494 Vali Acc: 0.969 Test Loss: 0.494 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 5.661101818084717
Epoch: 47, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.501 Vali Acc: 0.969 Test Loss: 0.501 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 4.952324390411377
Epoch: 48, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.934 Vali Acc: 0.941 Test Loss: 0.934 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 5.4878175258636475
Epoch: 49, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.618 Vali Acc: 0.970 Test Loss: 0.618 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 5.4973320960998535
Epoch: 50, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.541 Vali Acc: 0.974 Test Loss: 0.541 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 5.4493489265441895
Epoch: 51, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.487 Vali Acc: 0.971 Test Loss: 0.487 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 5.212374687194824
Epoch: 52, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.544 Vali Acc: 0.967 Test Loss: 0.544 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 5.136257886886597
Epoch: 53, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.424 Vali Acc: 0.973 Test Loss: 0.424 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 569548
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.021531581878662
Epoch: 1, Steps: 89 | Train Loss: 1.039 Vali Loss: 0.313 Vali Acc: 0.922 Test Loss: 0.313 Test Acc: 0.922
Validation loss decreased (inf --> -0.922002).  Saving model ...
Epoch: 2 cost time: 4.806284427642822
Epoch: 2, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.233 Vali Acc: 0.945 Test Loss: 0.233 Test Acc: 0.945
Validation loss decreased (-0.922002 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 5.591963768005371
Epoch: 3, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.242 Vali Acc: 0.953 Test Loss: 0.242 Test Acc: 0.953
Validation loss decreased (-0.944984 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 5.980865240097046
Epoch: 4, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.190 Vali Acc: 0.963 Test Loss: 0.190 Test Acc: 0.963
Validation loss decreased (-0.952644 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.609923601150513
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.31550145149231
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.264 Vali Acc: 0.948 Test Loss: 0.264 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.396864414215088
Epoch: 7, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.256 Vali Acc: 0.958 Test Loss: 0.256 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.180764198303223
Epoch: 8, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.279 Vali Acc: 0.958 Test Loss: 0.279 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.625505685806274
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.300 Vali Acc: 0.960 Test Loss: 0.300 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.000528335571289
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
Validation loss decreased (-0.963090 --> -0.970053).  Saving model ...
Epoch: 11 cost time: 4.872838973999023
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.345 Vali Acc: 0.961 Test Loss: 0.345 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.6025848388671875
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.244 Vali Acc: 0.966 Test Loss: 0.244 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.270559072494507
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.255 Vali Acc: 0.970 Test Loss: 0.255 Test Acc: 0.970
Validation loss decreased (-0.970053 --> -0.970053).  Saving model ...
Epoch: 14 cost time: 5.472128391265869
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.972 Test Loss: 0.251 Test Acc: 0.972
Validation loss decreased (-0.970053 --> -0.972142).  Saving model ...
Epoch: 15 cost time: 5.410554885864258
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.295 Vali Acc: 0.970 Test Loss: 0.295 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.4668498039245605
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.340 Vali Acc: 0.965 Test Loss: 0.340 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.800382852554321
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.250 Vali Acc: 0.975 Test Loss: 0.250 Test Acc: 0.975
Validation loss decreased (-0.972142 --> -0.974928).  Saving model ...
Epoch: 18 cost time: 5.059316873550415
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.403 Vali Acc: 0.959 Test Loss: 0.403 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.459462881088257
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.364 Vali Acc: 0.963 Test Loss: 0.364 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.946274280548096
Epoch: 20, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.347 Vali Acc: 0.970 Test Loss: 0.347 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.120429039001465
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.340 Vali Acc: 0.973 Test Loss: 0.340 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.149032354354858
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.412 Vali Acc: 0.969 Test Loss: 0.412 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.192018508911133
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.379 Vali Acc: 0.967 Test Loss: 0.379 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.407712697982788
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.498 Vali Acc: 0.958 Test Loss: 0.498 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.131318807601929
Epoch: 25, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.392 Vali Acc: 0.967 Test Loss: 0.392 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.3126842975616455
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.438 Vali Acc: 0.963 Test Loss: 0.438 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.219395399093628
Epoch: 27, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.445 Vali Acc: 0.975 Test Loss: 0.445 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 569548
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.13192081451416
Epoch: 1, Steps: 89 | Train Loss: 1.033 Vali Loss: 0.307 Vali Acc: 0.925 Test Loss: 0.307 Test Acc: 0.925
Validation loss decreased (inf --> -0.925484).  Saving model ...
Epoch: 2 cost time: 4.509863615036011
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
Validation loss decreased (-0.925484 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 4.941176176071167
Epoch: 3, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.257 Vali Acc: 0.936 Test Loss: 0.257 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.460054159164429
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.946377 --> -0.951948).  Saving model ...
Epoch: 5 cost time: 5.0827436447143555
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.961697).  Saving model ...
Epoch: 6 cost time: 5.09113073348999
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.224 Vali Acc: 0.959 Test Loss: 0.224 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.6566162109375
Epoch: 7, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.287 Vali Acc: 0.951 Test Loss: 0.287 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.971798419952393
Epoch: 8, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.252 Vali Acc: 0.968 Test Loss: 0.252 Test Acc: 0.968
Validation loss decreased (-0.961697 --> -0.967964).  Saving model ...
Epoch: 9 cost time: 5.182582378387451
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.237 Vali Acc: 0.967 Test Loss: 0.237 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.780216693878174
Epoch: 10, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.312 Vali Acc: 0.951 Test Loss: 0.312 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.812015056610107
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
Validation loss decreased (-0.967964 --> -0.976321).  Saving model ...
Epoch: 12 cost time: 5.387502193450928
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.278 Vali Acc: 0.969 Test Loss: 0.278 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.384775161743164
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.365 Vali Acc: 0.949 Test Loss: 0.365 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.762256622314453
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.299 Vali Acc: 0.964 Test Loss: 0.299 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.12401008605957
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.367 Vali Acc: 0.957 Test Loss: 0.367 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.68127965927124
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.309 Vali Acc: 0.970 Test Loss: 0.309 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.499241828918457
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.287 Vali Acc: 0.975 Test Loss: 0.287 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.370846271514893
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.283 Vali Acc: 0.976 Test Loss: 0.283 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.105083703994751
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.345 Vali Acc: 0.975 Test Loss: 0.345 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.382699012756348
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.418 Vali Acc: 0.964 Test Loss: 0.418 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.441859245300293
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.277 Vali Acc: 0.972 Test Loss: 0.277 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 569548
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.179044246673584
Epoch: 1, Steps: 89 | Train Loss: 1.055 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
Validation loss decreased (inf --> -0.932448).  Saving model ...
Epoch: 2 cost time: 5.759529113769531
Epoch: 2, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.932448 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 5.5177998542785645
Epoch: 3, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963090).  Saving model ...
Epoch: 4 cost time: 5.173690557479858
Epoch: 4, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.136 Vali Acc: 0.973 Test Loss: 0.136 Test Acc: 0.973
Validation loss decreased (-0.963090 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 4.592331886291504
Epoch: 5, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.406419038772583
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.945775747299194
Epoch: 7, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.981131315231323
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.585846424102783
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.962 Test Loss: 0.221 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 4.670346021652222
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.197 Vali Acc: 0.967 Test Loss: 0.197 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 5.563268423080444
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.976 Test Loss: 0.190 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976321).  Saving model ...
Epoch: 12 cost time: 5.291651010513306
Epoch: 12, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.979 Test Loss: 0.186 Test Acc: 0.979
Validation loss decreased (-0.976321 --> -0.979107).  Saving model ...
Epoch: 13 cost time: 5.011025428771973
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.976 Test Loss: 0.207 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.371340274810791
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.282 Vali Acc: 0.957 Test Loss: 0.282 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.081225156784058
Epoch: 15, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.035877704620361
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.781366586685181
Epoch: 17, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.208 Vali Acc: 0.970 Test Loss: 0.208 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.808428525924683
Epoch: 18, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.265 Vali Acc: 0.970 Test Loss: 0.265 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 5.286663293838501
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.189 Vali Acc: 0.977 Test Loss: 0.189 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 5.452224016189575
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.972 Test Loss: 0.235 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.308342695236206
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.974 Test Loss: 0.251 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.838530540466309
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.226 Vali Acc: 0.976 Test Loss: 0.226 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 569548
model size : 4.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.612554550170898
Epoch: 1, Steps: 89 | Train Loss: 1.245 Vali Loss: 0.413 Vali Acc: 0.891 Test Loss: 0.413 Test Acc: 0.891
Validation loss decreased (inf --> -0.891361).  Saving model ...
Epoch: 2 cost time: 5.2838051319122314
Epoch: 2, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.891361 --> -0.957519).  Saving model ...
Epoch: 3 cost time: 5.975106477737427
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.967269).  Saving model ...
Epoch: 4 cost time: 5.123152256011963
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.133 Vali Acc: 0.963 Test Loss: 0.133 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.508579969406128
Epoch: 5, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 4.991315126419067
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.161970615386963
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.967 Test Loss: 0.151 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.586203098297119
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 4.987010478973389
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 4.8195483684539795
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.804047107696533
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.348 Vali Acc: 0.947 Test Loss: 0.348 Test Acc: 0.947
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.707832098007202
Epoch: 12, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.986439228057861
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.245 Vali Acc: 0.961 Test Loss: 0.245 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.574559450149536
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.215 Vali Acc: 0.967 Test Loss: 0.215 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.447130441665649
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.966 Test Loss: 0.211 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.265349388122559
Epoch: 16, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.243 Vali Acc: 0.968 Test Loss: 0.243 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.227470636367798
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.291 Vali Acc: 0.964 Test Loss: 0.291 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.968697547912598
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.324 Vali Acc: 0.958 Test Loss: 0.324 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.600771427154541
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.228 Vali Acc: 0.975 Test Loss: 0.228 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 776332
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.635300874710083
Epoch: 1, Steps: 89 | Train Loss: 1.229 Vali Loss: 0.379 Vali Acc: 0.905 Test Loss: 0.379 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 5.169914484024048
Epoch: 2, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
Validation loss decreased (-0.905289 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 5.418759107589722
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.953341 --> -0.966573).  Saving model ...
Epoch: 4 cost time: 5.436376571655273
Epoch: 4, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.152 Vali Acc: 0.959 Test Loss: 0.152 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.873968839645386
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.124 Vali Acc: 0.970 Test Loss: 0.124 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 5.3573102951049805
Epoch: 6, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.179 Vali Acc: 0.958 Test Loss: 0.179 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.278368949890137
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 4.970551490783691
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.1572184562683105
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.23447585105896
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.923956394195557
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.176 Vali Acc: 0.972 Test Loss: 0.176 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 6.0489821434021
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.241 Vali Acc: 0.968 Test Loss: 0.241 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.449659585952759
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.242 Vali Acc: 0.971 Test Loss: 0.242 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 6.010298013687134
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.974 Test Loss: 0.195 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 5.821904420852661
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.977 Test Loss: 0.183 Test Acc: 0.977
Validation loss decreased (-0.973536 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 4.820919990539551
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.169 Vali Acc: 0.980 Test Loss: 0.169 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979803).  Saving model ...
Epoch: 17 cost time: 4.594113826751709
Epoch: 17, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.976 Test Loss: 0.175 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.69746208190918
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.187 Vali Acc: 0.970 Test Loss: 0.187 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.210067272186279
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.180 Vali Acc: 0.976 Test Loss: 0.180 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.064215660095215
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.977 Test Loss: 0.195 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.207091808319092
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.242 Vali Acc: 0.968 Test Loss: 0.242 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.65657901763916
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.978 Test Loss: 0.222 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.51358699798584
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.974 Test Loss: 0.220 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.72604775428772
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.253 Vali Acc: 0.969 Test Loss: 0.253 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.009417772293091
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.343 Vali Acc: 0.948 Test Loss: 0.343 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.050702810287476
Epoch: 26, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.270 Vali Acc: 0.970 Test Loss: 0.270 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 776332
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.028496026992798
Epoch: 1, Steps: 89 | Train Loss: 1.212 Vali Loss: 0.347 Vali Acc: 0.914 Test Loss: 0.347 Test Acc: 0.914
Validation loss decreased (inf --> -0.913646).  Saving model ...
Epoch: 2 cost time: 4.643134593963623
Epoch: 2, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.913646 --> -0.965180).  Saving model ...
Epoch: 3 cost time: 4.795958757400513
Epoch: 3, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 4.97421407699585
Epoch: 4, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 4.451731443405151
Epoch: 5, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.968662 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 4.480872631072998
Epoch: 6, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 5.20680046081543
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.597639322280884
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.187 Vali Acc: 0.953 Test Loss: 0.187 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.3265533447265625
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 5.594155788421631
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.966 Test Loss: 0.180 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.705797433853149
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.191997528076172
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.199 Vali Acc: 0.964 Test Loss: 0.199 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.707775115966797
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.224 Vali Acc: 0.966 Test Loss: 0.224 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.254290342330933
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.250 Vali Acc: 0.962 Test Loss: 0.250 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.5210442543029785
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.214 Vali Acc: 0.970 Test Loss: 0.214 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.843797206878662
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 4.7116615772247314
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.969 Test Loss: 0.194 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.462125778198242
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.314 Vali Acc: 0.968 Test Loss: 0.314 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.770700693130493
Epoch: 19, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.309 Vali Acc: 0.967 Test Loss: 0.309 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.069998025894165
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.834753036499023
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.281 Vali Acc: 0.955 Test Loss: 0.281 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.049489259719849
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.976 Test Loss: 0.202 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.495934247970581
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.220 Vali Acc: 0.976 Test Loss: 0.220 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 4.766574144363403
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.251 Vali Acc: 0.969 Test Loss: 0.251 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.401824951171875
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.229 Vali Acc: 0.975 Test Loss: 0.229 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.377521753311157
Epoch: 26, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.236 Vali Acc: 0.976 Test Loss: 0.236 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 776332
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.016998529434204
Epoch: 1, Steps: 89 | Train Loss: 1.288 Vali Loss: 0.369 Vali Acc: 0.893 Test Loss: 0.369 Test Acc: 0.893
Validation loss decreased (inf --> -0.892754).  Saving model ...
Epoch: 2 cost time: 4.957720756530762
Epoch: 2, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
Validation loss decreased (-0.892754 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 5.31930136680603
Epoch: 3, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.168 Vali Acc: 0.953 Test Loss: 0.168 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.785316705703735
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.127 Vali Acc: 0.965 Test Loss: 0.127 Test Acc: 0.965
Validation loss decreased (-0.955430 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 4.853753328323364
Epoch: 5, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.965180 --> -0.976322).  Saving model ...
Epoch: 6 cost time: 5.129603862762451
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.916205406188965
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.163 Vali Acc: 0.963 Test Loss: 0.163 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.683005094528198
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.338463068008423
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.118 Vali Acc: 0.970 Test Loss: 0.118 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.7915332317352295
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.231 Vali Acc: 0.955 Test Loss: 0.231 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.80268669128418
Epoch: 11, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.9356653690338135
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.956 Test Loss: 0.198 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.240243673324585
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.967 Test Loss: 0.180 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.602186679840088
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 5.3543174266815186
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.961 Test Loss: 0.219 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 776332
model size : 4.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.698845863342285
Epoch: 1, Steps: 89 | Train Loss: 1.289 Vali Loss: 0.425 Vali Acc: 0.886 Test Loss: 0.425 Test Acc: 0.886
Validation loss decreased (inf --> -0.886486).  Saving model ...
Epoch: 2 cost time: 5.900288820266724
Epoch: 2, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.219 Vali Acc: 0.942 Test Loss: 0.219 Test Acc: 0.942
Validation loss decreased (-0.886486 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 5.284654855728149
Epoch: 3, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.193 Vali Acc: 0.954 Test Loss: 0.193 Test Acc: 0.954
Validation loss decreased (-0.942198 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 4.998338222503662
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.954037 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 4.895650625228882
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 5.6180315017700195
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 5.47857928276062
Epoch: 7, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.969248533248901
Epoch: 8, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.850337505340576
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.937293529510498
Epoch: 10, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.964 Test Loss: 0.195 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.523882627487183
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.969 Test Loss: 0.188 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.437525272369385
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.205 Vali Acc: 0.966 Test Loss: 0.205 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.043543338775635
Epoch: 13, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.966 Test Loss: 0.205 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 5.289827108383179
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 5.282381057739258
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.272 Vali Acc: 0.958 Test Loss: 0.272 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.901343822479248
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.968 Test Loss: 0.181 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 514188
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.790738344192505
Epoch: 1, Steps: 89 | Train Loss: 1.283 Vali Loss: 0.406 Vali Acc: 0.885 Test Loss: 0.406 Test Acc: 0.885
Validation loss decreased (inf --> -0.885093).  Saving model ...
Epoch: 2 cost time: 4.789273023605347
Epoch: 2, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
Validation loss decreased (-0.885093 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 5.143333911895752
Epoch: 3, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.947073 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 5.447538137435913
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.147 Vali Acc: 0.965 Test Loss: 0.147 Test Acc: 0.965
Validation loss decreased (-0.956126 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 5.591864347457886
Epoch: 5, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.170 Vali Acc: 0.966 Test Loss: 0.170 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 5.384506940841675
Epoch: 6, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 5.091062784194946
Epoch: 7, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.273116827011108
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.255407810211182
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.578873157501221
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.105884313583374
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.266591787338257
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.160 Vali Acc: 0.971 Test Loss: 0.160 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.153675079345703
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 4.981043815612793
Epoch: 14, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977714).  Saving model ...
Epoch: 15 cost time: 5.047091245651245
Epoch: 15, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 6.247102737426758
Epoch: 16, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.207935094833374
Epoch: 17, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.136 Vali Acc: 0.979 Test Loss: 0.136 Test Acc: 0.979
Validation loss decreased (-0.977714 --> -0.979107).  Saving model ...
Epoch: 18 cost time: 4.63601541519165
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.979 Test Loss: 0.151 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.119381904602051
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.951 Test Loss: 0.297 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.941895961761475
Epoch: 20, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.219 Vali Acc: 0.971 Test Loss: 0.219 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.109409332275391
Epoch: 21, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.319 Vali Acc: 0.958 Test Loss: 0.319 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.576270341873169
Epoch: 22, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.967 Test Loss: 0.289 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.839273452758789
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.252 Vali Acc: 0.976 Test Loss: 0.252 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.21558141708374
Epoch: 24, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.286 Vali Acc: 0.973 Test Loss: 0.286 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.127773761749268
Epoch: 25, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.426 Vali Acc: 0.952 Test Loss: 0.426 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.190618991851807
Epoch: 26, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.442560434341431
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.978 Test Loss: 0.219 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 514188
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.512553453445435
Epoch: 1, Steps: 89 | Train Loss: 1.279 Vali Loss: 0.375 Vali Acc: 0.906 Test Loss: 0.375 Test Acc: 0.906
Validation loss decreased (inf --> -0.905985).  Saving model ...
Epoch: 2 cost time: 4.846933841705322
Epoch: 2, Steps: 89 | Train Loss: 0.238 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
Validation loss decreased (-0.905985 --> -0.956823).  Saving model ...
Epoch: 3 cost time: 4.830143690109253
Epoch: 3, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.963787).  Saving model ...
Epoch: 4 cost time: 5.615928888320923
Epoch: 4, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 5.068852663040161
Epoch: 5, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 5.051111698150635
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 4.979725360870361
Epoch: 7, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.142102479934692
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.976322).  Saving model ...
Epoch: 9 cost time: 5.908283472061157
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.480164051055908
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.105330228805542
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.196 Vali Acc: 0.962 Test Loss: 0.196 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.96602988243103
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.237 Vali Acc: 0.954 Test Loss: 0.237 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.262442350387573
Epoch: 13, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.961 Test Loss: 0.242 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.437268018722534
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.969 Test Loss: 0.198 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.497199535369873
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.897783041000366
Epoch: 16, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.217 Vali Acc: 0.971 Test Loss: 0.217 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.093123435974121
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.236 Vali Acc: 0.970 Test Loss: 0.236 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.100191831588745
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.978 Test Loss: 0.187 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978410).  Saving model ...
Epoch: 19 cost time: 5.045042276382446
Epoch: 19, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.981 Test Loss: 0.184 Test Acc: 0.981
Validation loss decreased (-0.978410 --> -0.981196).  Saving model ...
Epoch: 20 cost time: 5.444862365722656
Epoch: 20, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.978 Test Loss: 0.193 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.367441415786743
Epoch: 21, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.978 Test Loss: 0.196 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.427725315093994
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.979 Test Loss: 0.192 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.699581623077393
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.230 Vali Acc: 0.976 Test Loss: 0.230 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.9054787158966064
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.288 Vali Acc: 0.971 Test Loss: 0.288 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.318353176116943
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.254 Vali Acc: 0.970 Test Loss: 0.254 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.245504856109619
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.212 Vali Acc: 0.973 Test Loss: 0.212 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.9401257038116455
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.223 Vali Acc: 0.970 Test Loss: 0.223 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.991217136383057
Epoch: 28, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.967 Test Loss: 0.291 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.760461330413818
Epoch: 29, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.349 Vali Acc: 0.958 Test Loss: 0.349 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 514188
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.956596612930298
Epoch: 1, Steps: 89 | Train Loss: 1.329 Vali Loss: 0.366 Vali Acc: 0.905 Test Loss: 0.366 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 5.468024969100952
Epoch: 2, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.905289 --> -0.963787).  Saving model ...
Epoch: 3 cost time: 5.668690204620361
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.150 Vali Acc: 0.961 Test Loss: 0.150 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.8794474601745605
Epoch: 4, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 4.593615293502808
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.100668430328369
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.427539825439453
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.679003715515137
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.131 Vali Acc: 0.972 Test Loss: 0.131 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 4.8597729206085205
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.342492580413818
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.180 Vali Acc: 0.960 Test Loss: 0.180 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.954107046127319
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.181 Vali Acc: 0.957 Test Loss: 0.181 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.057373285293579
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.332676410675049
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.439344644546509
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 5.567941665649414
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.966 Test Loss: 0.201 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.561022996902466
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.173 Vali Acc: 0.970 Test Loss: 0.173 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.082113981246948
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.964 Test Loss: 0.219 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.182646036148071
Epoch: 18, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.262 Vali Acc: 0.959 Test Loss: 0.262 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.436638593673706
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.234 Vali Acc: 0.968 Test Loss: 0.234 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.638609409332275
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.334 Vali Acc: 0.958 Test Loss: 0.334 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.4196648597717285
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.969 Test Loss: 0.204 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.28908634185791
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.4528968334198
Epoch: 23, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
Validation loss decreased (-0.973536 --> -0.977018).  Saving model ...
Epoch: 24 cost time: 4.825262069702148
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.977 Test Loss: 0.175 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 25 cost time: 5.616676330566406
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.185 Vali Acc: 0.976 Test Loss: 0.185 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.291520357131958
Epoch: 26, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.969 Test Loss: 0.230 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.094496250152588
Epoch: 27, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.245 Vali Acc: 0.968 Test Loss: 0.245 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.077065467834473
Epoch: 28, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.299 Vali Acc: 0.962 Test Loss: 0.299 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.936535358428955
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.973 Test Loss: 0.209 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.0665647983551025
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.968 Test Loss: 0.278 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.483177661895752
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.977 Test Loss: 0.209 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.054285764694214
Epoch: 32, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 4.958955526351929
Epoch: 33, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.894743919372559
Epoch: 34, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.248 Vali Acc: 0.968 Test Loss: 0.248 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 514188
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.9218456745147705
Epoch: 1, Steps: 89 | Train Loss: 1.305 Vali Loss: 0.430 Vali Acc: 0.892 Test Loss: 0.430 Test Acc: 0.892
Validation loss decreased (inf --> -0.892057).  Saving model ...
Epoch: 2 cost time: 5.73423957824707
Epoch: 2, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.892057 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 5.5091164112091064
Epoch: 3, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.936627 --> -0.940806).  Saving model ...
Epoch: 4 cost time: 5.090225458145142
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.940806 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.5704851150512695
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.963090 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 5.016725540161133
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.169 Vali Acc: 0.965 Test Loss: 0.169 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.1674487590789795
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
Validation loss decreased (-0.966572 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 4.695627689361572
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.995812892913818
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.490383625030518
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.976 Test Loss: 0.137 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975625).  Saving model ...
Epoch: 11 cost time: 5.047485113143921
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.534074544906616
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.127783536911011
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.157 Vali Acc: 0.974 Test Loss: 0.157 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.310845851898193
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.964 Test Loss: 0.193 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.374301433563232
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.247 Vali Acc: 0.956 Test Loss: 0.247 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.156170129776001
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.272 Vali Acc: 0.953 Test Loss: 0.272 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.567681789398193
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.960 Test Loss: 0.241 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.012360572814941
Epoch: 18, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.907742500305176
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.196 Vali Acc: 0.969 Test Loss: 0.196 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.809568166732788
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.171 Vali Acc: 0.975 Test Loss: 0.171 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 383116
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.81870436668396
Epoch: 1, Steps: 89 | Train Loss: 1.294 Vali Loss: 0.421 Vali Acc: 0.895 Test Loss: 0.421 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 5.74419903755188
Epoch: 2, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.228 Vali Acc: 0.936 Test Loss: 0.228 Test Acc: 0.936
Validation loss decreased (-0.894843 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 5.144790887832642
Epoch: 3, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.202 Vali Acc: 0.935 Test Loss: 0.202 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.087467908859253
Epoch: 4, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
Validation loss decreased (-0.935931 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 5.705915689468384
Epoch: 5, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 5.6413304805755615
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 5.368700742721558
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.527007818222046
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.763275146484375
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.964 Test Loss: 0.205 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.991781711578369
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.960 Test Loss: 0.217 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.903570175170898
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.226 Vali Acc: 0.960 Test Loss: 0.226 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 4.651256561279297
Epoch: 12, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.209 Vali Acc: 0.962 Test Loss: 0.209 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.938944339752197
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.305 Vali Acc: 0.950 Test Loss: 0.305 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.873341798782349
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.967 Test Loss: 0.206 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.968591928482056
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 5.067659616470337
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.971 Test Loss: 0.193 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.909034490585327
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.977 Test Loss: 0.171 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 18 cost time: 5.21295690536499
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.109881162643433
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.266 Vali Acc: 0.958 Test Loss: 0.266 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.644116401672363
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.261 Vali Acc: 0.964 Test Loss: 0.261 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.696107625961304
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.972 Test Loss: 0.222 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.14363431930542
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.974 Test Loss: 0.195 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.899856090545654
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.971 Test Loss: 0.238 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.050235748291016
Epoch: 24, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.261 Vali Acc: 0.969 Test Loss: 0.261 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.369065046310425
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.261 Vali Acc: 0.964 Test Loss: 0.261 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.315026521682739
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.258 Vali Acc: 0.963 Test Loss: 0.258 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.105426549911499
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.973 Test Loss: 0.211 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 383116
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.84096622467041
Epoch: 1, Steps: 89 | Train Loss: 1.280 Vali Loss: 0.390 Vali Acc: 0.907 Test Loss: 0.390 Test Acc: 0.907
Validation loss decreased (inf --> -0.906681).  Saving model ...
Epoch: 2 cost time: 4.835638046264648
Epoch: 2, Steps: 89 | Train Loss: 0.247 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.906681 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 4.953773260116577
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.182 Vali Acc: 0.945 Test Loss: 0.182 Test Acc: 0.945
Validation loss decreased (-0.943591 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 4.785580635070801
Epoch: 4, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.944984 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 4.31438136100769
Epoch: 5, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.110 Vali Acc: 0.971 Test Loss: 0.110 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 6 cost time: 4.70749831199646
Epoch: 6, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975625).  Saving model ...
Epoch: 7 cost time: 4.897587776184082
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.128 Vali Acc: 0.978 Test Loss: 0.128 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 5.2252326011657715
Epoch: 8, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.942185878753662
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.387645959854126
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.176 Vali Acc: 0.966 Test Loss: 0.176 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.198518991470337
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.194 Vali Acc: 0.961 Test Loss: 0.194 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.758952617645264
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.246 Vali Acc: 0.959 Test Loss: 0.246 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.44053840637207
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.793422222137451
Epoch: 14, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.278 Vali Acc: 0.971 Test Loss: 0.278 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.509307146072388
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.183693885803223
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.969 Test Loss: 0.221 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.598944425582886
Epoch: 17, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.975 Test Loss: 0.204 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 383116
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.546545743942261
Epoch: 1, Steps: 89 | Train Loss: 1.357 Vali Loss: 0.383 Vali Acc: 0.903 Test Loss: 0.383 Test Acc: 0.903
Validation loss decreased (inf --> -0.902503).  Saving model ...
Epoch: 2 cost time: 4.7325286865234375
Epoch: 2, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.902503 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 4.837228775024414
Epoch: 3, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.171 Vali Acc: 0.951 Test Loss: 0.171 Test Acc: 0.951
Validation loss decreased (-0.948466 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 5.125999212265015
Epoch: 4, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.142 Vali Acc: 0.965 Test Loss: 0.142 Test Acc: 0.965
Validation loss decreased (-0.951252 --> -0.965180).  Saving model ...
Epoch: 5 cost time: 5.093969345092773
Epoch: 5, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.060410022735596
Epoch: 6, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.147 Vali Acc: 0.967 Test Loss: 0.147 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966572).  Saving model ...
Epoch: 7 cost time: 4.268203496932983
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.166 Vali Acc: 0.964 Test Loss: 0.166 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.846263885498047
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.966 Test Loss: 0.139 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.031965970993042
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
Validation loss decreased (-0.966572 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 4.781026363372803
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.5598931312561035
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.778931379318237
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.191 Vali Acc: 0.964 Test Loss: 0.191 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.231466770172119
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.370724201202393
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.963 Test Loss: 0.200 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.265538454055786
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.168 Vali Acc: 0.969 Test Loss: 0.168 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.337140083312988
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.972 Test Loss: 0.177 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.17625617980957
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.222 Vali Acc: 0.967 Test Loss: 0.222 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.256182670593262
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.289 Vali Acc: 0.959 Test Loss: 0.289 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.77311635017395
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.977 Test Loss: 0.184 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 20 cost time: 4.49804425239563
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.321 Vali Acc: 0.960 Test Loss: 0.321 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.245626211166382
Epoch: 21, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.253 Vali Acc: 0.967 Test Loss: 0.253 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.198441505432129
Epoch: 22, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.629 Vali Acc: 0.931 Test Loss: 0.629 Test Acc: 0.931
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.077519178390503
Epoch: 23, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.218 Vali Acc: 0.973 Test Loss: 0.218 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.280125379562378
Epoch: 24, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.226 Vali Acc: 0.976 Test Loss: 0.226 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.608975410461426
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.245 Vali Acc: 0.974 Test Loss: 0.245 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.006412982940674
Epoch: 26, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.973 Test Loss: 0.235 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.110710859298706
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.218 Vali Acc: 0.979 Test Loss: 0.218 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979106).  Saving model ...
Epoch: 28 cost time: 4.202150821685791
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.217 Vali Acc: 0.975 Test Loss: 0.217 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.1220245361328125
Epoch: 29, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.238 Vali Acc: 0.969 Test Loss: 0.238 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.833973169326782
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.217 Vali Acc: 0.974 Test Loss: 0.217 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.6890552043914795
Epoch: 31, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.232 Vali Acc: 0.970 Test Loss: 0.232 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 4.090011835098267
Epoch: 32, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.974 Test Loss: 0.226 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.152257442474365
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.977 Test Loss: 0.211 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.368924379348755
Epoch: 34, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.970 Test Loss: 0.225 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.615332126617432
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.971 Test Loss: 0.216 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 5.3117265701293945
Epoch: 36, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.979 Test Loss: 0.207 Test Acc: 0.979
Validation loss decreased (-0.979106 --> -0.979107).  Saving model ...
Epoch: 37 cost time: 5.144436836242676
Epoch: 37, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.205 Vali Acc: 0.978 Test Loss: 0.205 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.949724912643433
Epoch: 38, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.977 Test Loss: 0.206 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.841735363006592
Epoch: 39, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.255 Vali Acc: 0.970 Test Loss: 0.255 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 4.808135271072388
Epoch: 40, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.245 Vali Acc: 0.964 Test Loss: 0.245 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.168814420700073
Epoch: 41, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.230 Vali Acc: 0.977 Test Loss: 0.230 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.337620735168457
Epoch: 42, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.301 Vali Acc: 0.958 Test Loss: 0.301 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 5.829532861709595
Epoch: 43, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.290 Vali Acc: 0.971 Test Loss: 0.290 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 4.66798996925354
Epoch: 44, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.240 Vali Acc: 0.976 Test Loss: 0.240 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 5.375482559204102
Epoch: 45, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.247 Vali Acc: 0.976 Test Loss: 0.247 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 5.527645826339722
Epoch: 46, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.252 Vali Acc: 0.974 Test Loss: 0.252 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 383116
model size : 2.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.802135705947876
Epoch: 1, Steps: 89 | Train Loss: 1.258 Vali Loss: 0.421 Vali Acc: 0.883 Test Loss: 0.421 Test Acc: 0.883
Validation loss decreased (inf --> -0.883004).  Saving model ...
Epoch: 2 cost time: 5.44029974937439
Epoch: 2, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
Validation loss decreased (-0.883004 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 5.157634735107422
Epoch: 3, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.183 Vali Acc: 0.951 Test Loss: 0.183 Test Acc: 0.951
Validation loss decreased (-0.933145 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 4.5958685874938965
Epoch: 4, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.950555 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 4.7994914054870605
Epoch: 5, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.200 Vali Acc: 0.946 Test Loss: 0.200 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.3137805461883545
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.175 Vali Acc: 0.960 Test Loss: 0.175 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.017022132873535
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.962394 --> -0.965179).  Saving model ...
Epoch: 8 cost time: 4.827259063720703
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.997885465621948
Epoch: 9, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.6535804271698
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
Validation loss decreased (-0.965179 --> -0.968661).  Saving model ...
Epoch: 11 cost time: 5.677264213562012
Epoch: 11, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.980768203735352
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.963 Test Loss: 0.208 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.8477537631988525
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
Validation loss decreased (-0.968661 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 5.231334686279297
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972839).  Saving model ...
Epoch: 15 cost time: 5.154205322265625
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.230 Vali Acc: 0.966 Test Loss: 0.230 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.680818319320679
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.306 Vali Acc: 0.943 Test Loss: 0.306 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.76791787147522
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.231 Vali Acc: 0.969 Test Loss: 0.231 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.286675691604614
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.245 Vali Acc: 0.969 Test Loss: 0.245 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.122580289840698
Epoch: 19, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.389 Vali Acc: 0.958 Test Loss: 0.389 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.647879362106323
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.250 Vali Acc: 0.964 Test Loss: 0.250 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.1794023513793945
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.215 Vali Acc: 0.973 Test Loss: 0.215 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.37488865852356
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.210 Vali Acc: 0.972 Test Loss: 0.210 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.274074554443359
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.384 Vali Acc: 0.944 Test Loss: 0.384 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.856204271316528
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.971 Test Loss: 0.234 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 317580
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.147425174713135
Epoch: 1, Steps: 89 | Train Loss: 1.254 Vali Loss: 0.405 Vali Acc: 0.887 Test Loss: 0.405 Test Acc: 0.887
Validation loss decreased (inf --> -0.887183).  Saving model ...
Epoch: 2 cost time: 5.064950704574585
Epoch: 2, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.246 Vali Acc: 0.935 Test Loss: 0.246 Test Acc: 0.935
Validation loss decreased (-0.887183 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 4.59821891784668
Epoch: 3, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.935234 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 4.511906862258911
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
Validation loss decreased (-0.950555 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 5.412728548049927
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.807301759719849
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
Validation loss decreased (-0.965876 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 4.477937459945679
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.172 Vali Acc: 0.959 Test Loss: 0.172 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.180357456207275
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.2627410888671875
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 5.8226611614227295
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 11 cost time: 5.380770683288574
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.969 Test Loss: 0.172 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.6946187019348145
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.973 Test Loss: 0.180 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.454657793045044
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.154 Vali Acc: 0.966 Test Loss: 0.154 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.065404653549194
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 5.3973259925842285
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.156 Vali Acc: 0.976 Test Loss: 0.156 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975625).  Saving model ...
Epoch: 16 cost time: 4.449993848800659
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.9587767124176025
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.978 Test Loss: 0.172 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.978411).  Saving model ...
Epoch: 18 cost time: 5.562610149383545
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.571910858154297
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.265 Vali Acc: 0.963 Test Loss: 0.265 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.112583160400391
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.188 Vali Acc: 0.974 Test Loss: 0.188 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.462240219116211
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.270 Vali Acc: 0.959 Test Loss: 0.270 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.612473249435425
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.973 Test Loss: 0.219 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.678748846054077
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.299 Vali Acc: 0.966 Test Loss: 0.299 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.383515357971191
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.962 Test Loss: 0.251 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.136229991912842
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.303 Vali Acc: 0.963 Test Loss: 0.303 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.3134400844573975
Epoch: 26, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.392 Vali Acc: 0.957 Test Loss: 0.392 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.735572099685669
Epoch: 27, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.329 Vali Acc: 0.965 Test Loss: 0.329 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 317580
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.0616466999053955
Epoch: 1, Steps: 89 | Train Loss: 1.254 Vali Loss: 0.395 Vali Acc: 0.892 Test Loss: 0.395 Test Acc: 0.892
Validation loss decreased (inf --> -0.892057).  Saving model ...
Epoch: 2 cost time: 5.0714945793151855
Epoch: 2, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.892057 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 5.0969016551971436
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.141 Vali Acc: 0.963 Test Loss: 0.141 Test Acc: 0.963
Validation loss decreased (-0.943591 --> -0.963091).  Saving model ...
Epoch: 4 cost time: 5.410398244857788
Epoch: 4, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
Validation loss decreased (-0.963091 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 5.800578832626343
Epoch: 5, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966573).  Saving model ...
Epoch: 6 cost time: 4.53181791305542
Epoch: 6, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.966573 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 4.727009296417236
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.231 Vali Acc: 0.942 Test Loss: 0.231 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.797374725341797
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 5.217278718948364
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.135 Vali Acc: 0.971 Test Loss: 0.135 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.466084003448486
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.232 Vali Acc: 0.968 Test Loss: 0.232 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.7033820152282715
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.972 Test Loss: 0.139 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 4.89840841293335
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.975 Test Loss: 0.173 Test Acc: 0.975
Validation loss decreased (-0.972143 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 5.346074104309082
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.726643323898315
Epoch: 14, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.978 Test Loss: 0.134 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 4.9777138233184814
Epoch: 15, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.978 Test Loss: 0.157 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.252309799194336
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.459415912628174
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.6427175998687744
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.964 Test Loss: 0.228 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.360565185546875
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.803965330123901
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.969 Test Loss: 0.197 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.522113084793091
Epoch: 21, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.971 Test Loss: 0.208 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.688164472579956
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.338 Vali Acc: 0.951 Test Loss: 0.338 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.308197021484375
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.224 Vali Acc: 0.972 Test Loss: 0.224 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.3570966720581055
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.298 Vali Acc: 0.971 Test Loss: 0.298 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 317580
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.269161701202393
Epoch: 1, Steps: 89 | Train Loss: 1.363 Vali Loss: 0.427 Vali Acc: 0.873 Test Loss: 0.427 Test Acc: 0.873
Validation loss decreased (inf --> -0.872558).  Saving model ...
Epoch: 2 cost time: 5.800502061843872
Epoch: 2, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.872558 --> -0.947770).  Saving model ...
Epoch: 3 cost time: 5.407251358032227
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.947770 --> -0.970054).  Saving model ...
Epoch: 4 cost time: 4.712887763977051
Epoch: 4, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.125 Vali Acc: 0.965 Test Loss: 0.125 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.915474891662598
Epoch: 5, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.966 Test Loss: 0.120 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.883414030075073
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 4.349535226821899
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.174 Vali Acc: 0.957 Test Loss: 0.174 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 4.302467584609985
Epoch: 8, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 5.033718109130859
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.151 Vali Acc: 0.964 Test Loss: 0.151 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 4.923762559890747
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
Validation loss decreased (-0.970054 --> -0.975626).  Saving model ...
Epoch: 11 cost time: 4.937882661819458
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.962 Test Loss: 0.183 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.753970384597778
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.566537380218506
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.150 Vali Acc: 0.975 Test Loss: 0.150 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.215846300125122
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.798342704772949
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.45823073387146
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.978 Test Loss: 0.155 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 5.35535454750061
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.974 Test Loss: 0.173 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.108654737472534
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.529095888137817
Epoch: 19, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.976 Test Loss: 0.155 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.927927255630493
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.976 Test Loss: 0.160 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.638058185577393
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.515575885772705
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.980 Test Loss: 0.170 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979803).  Saving model ...
Epoch: 23 cost time: 4.393920183181763
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.981 Test Loss: 0.153 Test Acc: 0.981
Validation loss decreased (-0.979803 --> -0.981196).  Saving model ...
Epoch: 24 cost time: 5.457473993301392
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.983 Test Loss: 0.144 Test Acc: 0.983
Validation loss decreased (-0.981196 --> -0.982589).  Saving model ...
Epoch: 25 cost time: 5.52074670791626
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.154 Vali Acc: 0.981 Test Loss: 0.154 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 6.077869176864624
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.151 Vali Acc: 0.981 Test Loss: 0.151 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.442232608795166
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.775691032409668
Epoch: 28, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.265 Vali Acc: 0.967 Test Loss: 0.265 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 5.149275064468384
Epoch: 29, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.313 Vali Acc: 0.960 Test Loss: 0.313 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.15886116027832
Epoch: 30, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.281 Vali Acc: 0.964 Test Loss: 0.281 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.486428499221802
Epoch: 31, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.292 Vali Acc: 0.965 Test Loss: 0.292 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.880000114440918
Epoch: 32, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.302 Vali Acc: 0.968 Test Loss: 0.302 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.241257190704346
Epoch: 33, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.281 Vali Acc: 0.967 Test Loss: 0.281 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.705121040344238
Epoch: 34, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.241 Vali Acc: 0.971 Test Loss: 0.241 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 317580
model size : 2.45MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.238194227218628
Epoch: 1, Steps: 89 | Train Loss: 1.277 Vali Loss: 0.370 Vali Acc: 0.916 Test Loss: 0.370 Test Acc: 0.916
Validation loss decreased (inf --> -0.915734).  Saving model ...
Epoch: 2 cost time: 5.288009405136108
Epoch: 2, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.915734 --> -0.937324).  Saving model ...
Epoch: 3 cost time: 4.3265299797058105
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.194 Vali Acc: 0.958 Test Loss: 0.194 Test Acc: 0.958
Validation loss decreased (-0.937324 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 4.909585952758789
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.168 Vali Acc: 0.963 Test Loss: 0.168 Test Acc: 0.963
Validation loss decreased (-0.957519 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.207074165344238
Epoch: 5, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.346598863601685
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 5.150351524353027
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.194682359695435
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.973 Test Loss: 0.144 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 9 cost time: 5.40003776550293
Epoch: 9, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 6.063659429550171
Epoch: 10, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.211 Vali Acc: 0.962 Test Loss: 0.211 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.738994598388672
Epoch: 11, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.254 Vali Acc: 0.949 Test Loss: 0.254 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.7375688552856445
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.057012557983398
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.177 Vali Acc: 0.973 Test Loss: 0.177 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.019362926483154
Epoch: 14, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.236 Vali Acc: 0.969 Test Loss: 0.236 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.652669668197632
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.974 Test Loss: 0.222 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973535).  Saving model ...
Epoch: 16 cost time: 5.488805294036865
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.178 Vali Acc: 0.974 Test Loss: 0.178 Test Acc: 0.974
Validation loss decreased (-0.973535 --> -0.973536).  Saving model ...
Epoch: 17 cost time: 5.098667621612549
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.280 Vali Acc: 0.956 Test Loss: 0.280 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.977773666381836
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.257 Vali Acc: 0.967 Test Loss: 0.257 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.862663507461548
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.252 Vali Acc: 0.971 Test Loss: 0.252 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.963411808013916
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.969 Test Loss: 0.289 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.305638313293457
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.222 Vali Acc: 0.978 Test Loss: 0.222 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978410).  Saving model ...
Epoch: 22 cost time: 5.807864189147949
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.297 Vali Acc: 0.966 Test Loss: 0.297 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.967124700546265
Epoch: 23, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.974 Test Loss: 0.251 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.123689651489258
Epoch: 24, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.256 Vali Acc: 0.974 Test Loss: 0.256 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.812794923782349
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.330 Vali Acc: 0.963 Test Loss: 0.330 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.489298343658447
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.261 Vali Acc: 0.976 Test Loss: 0.261 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.7960638999938965
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.272 Vali Acc: 0.974 Test Loss: 0.272 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 4.6874165534973145
Epoch: 28, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.351 Vali Acc: 0.964 Test Loss: 0.351 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.034819841384888
Epoch: 29, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.260 Vali Acc: 0.971 Test Loss: 0.260 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.197370529174805
Epoch: 30, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.250 Vali Acc: 0.971 Test Loss: 0.250 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.877972602844238
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.261 Vali Acc: 0.976 Test Loss: 0.261 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 284812
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.823437690734863
Epoch: 1, Steps: 89 | Train Loss: 1.269 Vali Loss: 0.364 Vali Acc: 0.914 Test Loss: 0.364 Test Acc: 0.914
Validation loss decreased (inf --> -0.913645).  Saving model ...
Epoch: 2 cost time: 5.043383598327637
Epoch: 2, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.235 Vali Acc: 0.939 Test Loss: 0.235 Test Acc: 0.939
Validation loss decreased (-0.913645 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 4.858248472213745
Epoch: 3, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.186 Vali Acc: 0.955 Test Loss: 0.186 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 4.72650408744812
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.163 Vali Acc: 0.960 Test Loss: 0.163 Test Acc: 0.960
Validation loss decreased (-0.954734 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 4.269293546676636
Epoch: 5, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.202 Vali Acc: 0.939 Test Loss: 0.202 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.713615655899048
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
Validation loss decreased (-0.959608 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 4.7796502113342285
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.160 Vali Acc: 0.957 Test Loss: 0.160 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.649591445922852
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.881806373596191
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.422216892242432
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.599759578704834
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 4.82633376121521
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.310 Vali Acc: 0.946 Test Loss: 0.310 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.98602819442749
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.189 Vali Acc: 0.969 Test Loss: 0.189 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.71283221244812
Epoch: 14, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.181 Vali Acc: 0.975 Test Loss: 0.181 Test Acc: 0.975
Validation loss decreased (-0.972143 --> -0.974929).  Saving model ...
Epoch: 15 cost time: 5.108600616455078
Epoch: 15, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 5.062448024749756
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 17 cost time: 5.24645471572876
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.287059783935547
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.970 Test Loss: 0.192 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.847684860229492
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.159 Vali Acc: 0.977 Test Loss: 0.159 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.079304456710815
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.134 Vali Acc: 0.981 Test Loss: 0.134 Test Acc: 0.981
Validation loss decreased (-0.977018 --> -0.980500).  Saving model ...
Epoch: 21 cost time: 5.0778868198394775
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.978 Test Loss: 0.138 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.385038137435913
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.158 Vali Acc: 0.971 Test Loss: 0.158 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.012622833251953
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.971 Test Loss: 0.175 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.533662796020508
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.970 Test Loss: 0.183 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.626476287841797
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.161 Vali Acc: 0.979 Test Loss: 0.161 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.176325798034668
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.137 Vali Acc: 0.983 Test Loss: 0.137 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.983286).  Saving model ...
Epoch: 27 cost time: 4.9330668449401855
Epoch: 27, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.133 Vali Acc: 0.983 Test Loss: 0.133 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.136569499969482
Epoch: 28, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 29 cost time: 4.998988389968872
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.128 Vali Acc: 0.983 Test Loss: 0.128 Test Acc: 0.983
Validation loss decreased (-0.983286 --> -0.983286).  Saving model ...
Epoch: 30 cost time: 4.641064167022705
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 4.64121413230896
Epoch: 31, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.135 Vali Acc: 0.983 Test Loss: 0.135 Test Acc: 0.983
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 5.264081716537476
Epoch: 32, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.980 Test Loss: 0.175 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.302204370498657
Epoch: 33, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.351 Vali Acc: 0.955 Test Loss: 0.351 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.137228488922119
Epoch: 34, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.369 Vali Acc: 0.969 Test Loss: 0.369 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.314307689666748
Epoch: 35, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.444 Vali Acc: 0.960 Test Loss: 0.444 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.988989353179932
Epoch: 36, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.342 Vali Acc: 0.974 Test Loss: 0.342 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.6067423820495605
Epoch: 37, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 4.899560928344727
Epoch: 38, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.276 Vali Acc: 0.972 Test Loss: 0.276 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.395007371902466
Epoch: 39, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.323 Vali Acc: 0.971 Test Loss: 0.323 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 284812
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.207094430923462
Epoch: 1, Steps: 89 | Train Loss: 1.276 Vali Loss: 0.363 Vali Acc: 0.914 Test Loss: 0.363 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 4.649441480636597
Epoch: 2, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.209 Vali Acc: 0.951 Test Loss: 0.209 Test Acc: 0.951
Validation loss decreased (-0.914342 --> -0.951251).  Saving model ...
Epoch: 3 cost time: 4.922400236129761
Epoch: 3, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
Validation loss decreased (-0.951251 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 5.142076730728149
Epoch: 4, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 5.359989404678345
Epoch: 5, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.149143934249878
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.105 Vali Acc: 0.974 Test Loss: 0.105 Test Acc: 0.974
Validation loss decreased (-0.964483 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 5.398346662521362
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.964 Test Loss: 0.142 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.173072576522827
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.946 Test Loss: 0.214 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.863227844238281
Epoch: 9, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.165219068527222
Epoch: 10, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.39328670501709
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.977 Test Loss: 0.137 Test Acc: 0.977
Validation loss decreased (-0.974233 --> -0.977018).  Saving model ...
Epoch: 12 cost time: 5.025324583053589
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.8163206577301025
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.549653053283691
Epoch: 14, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.971 Test Loss: 0.226 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.771485328674316
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.307089328765869
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.976 Test Loss: 0.217 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.092546463012695
Epoch: 17, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.293 Vali Acc: 0.948 Test Loss: 0.293 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.893129825592041
Epoch: 18, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.331 Vali Acc: 0.946 Test Loss: 0.331 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.712940216064453
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.318 Vali Acc: 0.956 Test Loss: 0.318 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 4.582984447479248
Epoch: 20, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.263 Vali Acc: 0.964 Test Loss: 0.263 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 4.549128770828247
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.243 Vali Acc: 0.969 Test Loss: 0.243 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 284812
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.923919200897217
Epoch: 1, Steps: 89 | Train Loss: 1.345 Vali Loss: 0.377 Vali Acc: 0.917 Test Loss: 0.377 Test Acc: 0.917
Validation loss decreased (inf --> -0.917127).  Saving model ...
Epoch: 2 cost time: 4.6680614948272705
Epoch: 2, Steps: 89 | Train Loss: 0.255 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.917127 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 4.904468297958374
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
Validation loss decreased (-0.954037 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 4.971678972244263
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.831458330154419
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.126 Vali Acc: 0.964 Test Loss: 0.126 Test Acc: 0.964
Validation loss decreased (-0.964483 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 5.407418489456177
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.1585094928741455
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.184 Vali Acc: 0.957 Test Loss: 0.184 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.869147062301636
Epoch: 8, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.947 Test Loss: 0.213 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.49199914932251
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 5.0509421825408936
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.355503797531128
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 4.206912040710449
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
Validation loss decreased (-0.972143 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 4.479008913040161
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.0349860191345215
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.181 Vali Acc: 0.966 Test Loss: 0.181 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.415998697280884
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.149 Vali Acc: 0.974 Test Loss: 0.149 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974232).  Saving model ...
Epoch: 16 cost time: 4.640924692153931
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.968 Test Loss: 0.192 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.777013778686523
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.951 Test Loss: 0.292 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.282467365264893
Epoch: 18, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.967 Test Loss: 0.216 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.6006245613098145
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.252 Vali Acc: 0.965 Test Loss: 0.252 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.012636423110962
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.028674840927124
Epoch: 21, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 6.049346446990967
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.41115140914917
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.295 Vali Acc: 0.955 Test Loss: 0.295 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.367768049240112
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.208 Vali Acc: 0.964 Test Loss: 0.208 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.463084936141968
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 284812
model size : 2.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.746740341186523
Epoch: 1, Steps: 89 | Train Loss: 1.286 Vali Loss: 0.423 Vali Acc: 0.886 Test Loss: 0.423 Test Acc: 0.886
Validation loss decreased (inf --> -0.886486).  Saving model ...
Epoch: 2 cost time: 4.4804723262786865
Epoch: 2, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.257 Vali Acc: 0.924 Test Loss: 0.257 Test Acc: 0.924
Validation loss decreased (-0.886486 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 5.05361008644104
Epoch: 3, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.205 Vali Acc: 0.942 Test Loss: 0.205 Test Acc: 0.942
Validation loss decreased (-0.924092 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 5.412317514419556
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
Validation loss decreased (-0.942199 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 5.424000978469849
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.177 Vali Acc: 0.953 Test Loss: 0.177 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.169869661331177
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
Validation loss decreased (-0.955430 --> -0.959608).  Saving model ...
Epoch: 7 cost time: 5.31313681602478
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.962394).  Saving model ...
Epoch: 8 cost time: 5.460175037384033
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 5.305310249328613
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.731452703475952
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.964 Test Loss: 0.217 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.427909851074219
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.971 Test Loss: 0.183 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970750).  Saving model ...
Epoch: 12 cost time: 5.187593221664429
Epoch: 12, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.201 Vali Acc: 0.966 Test Loss: 0.201 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.30875039100647
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.271 Vali Acc: 0.949 Test Loss: 0.271 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.950849771499634
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.158 Vali Acc: 0.974 Test Loss: 0.158 Test Acc: 0.974
Validation loss decreased (-0.970750 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 5.096897125244141
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.257732152938843
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.245 Vali Acc: 0.954 Test Loss: 0.245 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.864187240600586
Epoch: 17, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.270 Vali Acc: 0.960 Test Loss: 0.270 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.083043336868286
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 6.075645685195923
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.251 Vali Acc: 0.958 Test Loss: 0.251 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.897582292556763
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.201 Vali Acc: 0.972 Test Loss: 0.201 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.989257097244263
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974232).  Saving model ...
Epoch: 22 cost time: 4.6882164478302
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.192 Vali Acc: 0.976 Test Loss: 0.192 Test Acc: 0.976
Validation loss decreased (-0.974232 --> -0.975625).  Saving model ...
Epoch: 23 cost time: 4.870531797409058
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.974 Test Loss: 0.192 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.292070627212524
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.203 Vali Acc: 0.972 Test Loss: 0.203 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.862754821777344
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.974 Test Loss: 0.208 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 4.437283277511597
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.969 Test Loss: 0.230 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.774774789810181
Epoch: 27, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.379 Vali Acc: 0.957 Test Loss: 0.379 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 5.539376735687256
Epoch: 28, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.296 Vali Acc: 0.967 Test Loss: 0.296 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 5.4752068519592285
Epoch: 29, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.306 Vali Acc: 0.964 Test Loss: 0.306 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 5.217497110366821
Epoch: 30, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.330 Vali Acc: 0.960 Test Loss: 0.330 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 5.454345703125
Epoch: 31, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.398 Vali Acc: 0.954 Test Loss: 0.398 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 5.439137697219849
Epoch: 32, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.336 Vali Acc: 0.959 Test Loss: 0.336 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 268428
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.064882040023804
Epoch: 1, Steps: 89 | Train Loss: 1.280 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (inf --> -0.889272).  Saving model ...
Epoch: 2 cost time: 4.890880107879639
Epoch: 2, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.251 Vali Acc: 0.928 Test Loss: 0.251 Test Acc: 0.928
Validation loss decreased (-0.889272 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 4.750370264053345
Epoch: 3, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.927574 --> -0.940806).  Saving model ...
Epoch: 4 cost time: 5.61599063873291
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.940806 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 5.282192230224609
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.421274662017822
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.956823 --> -0.965876).  Saving model ...
Epoch: 7 cost time: 4.8937599658966064
Epoch: 7, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.455049991607666
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.965876 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 4.8663201332092285
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.789551258087158
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.962 Test Loss: 0.191 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.369481325149536
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.763106822967529
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.422657012939453
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.149 Vali Acc: 0.973 Test Loss: 0.149 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.00835919380188
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.182 Vali Acc: 0.972 Test Loss: 0.182 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.432161331176758
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.269939661026001
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.286 Vali Acc: 0.953 Test Loss: 0.286 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.63117241859436
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.902403354644775
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.968 Test Loss: 0.224 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 268428
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.74113130569458
Epoch: 1, Steps: 89 | Train Loss: 1.283 Vali Loss: 0.401 Vali Acc: 0.895 Test Loss: 0.401 Test Acc: 0.895
Validation loss decreased (inf --> -0.894843).  Saving model ...
Epoch: 2 cost time: 5.17403769493103
Epoch: 2, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.241 Vali Acc: 0.928 Test Loss: 0.241 Test Acc: 0.928
Validation loss decreased (-0.894843 --> -0.927574).  Saving model ...
Epoch: 3 cost time: 5.038903474807739
Epoch: 3, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.927574 --> -0.944287).  Saving model ...
Epoch: 4 cost time: 4.691713333129883
Epoch: 4, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
Validation loss decreased (-0.944287 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 4.649415969848633
Epoch: 5, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.179 Vali Acc: 0.950 Test Loss: 0.179 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.201352834701538
Epoch: 6, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.113 Vali Acc: 0.974 Test Loss: 0.113 Test Acc: 0.974
Validation loss decreased (-0.961698 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 4.8860533237457275
Epoch: 7, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.124 Vali Acc: 0.969 Test Loss: 0.124 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.874565601348877
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.123 Vali Acc: 0.974 Test Loss: 0.123 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.95224142074585
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.229520797729492
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.259891748428345
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.976 Test Loss: 0.222 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975625).  Saving model ...
Epoch: 12 cost time: 4.888116836547852
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.160 Vali Acc: 0.978 Test Loss: 0.160 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977714).  Saving model ...
Epoch: 13 cost time: 3.9987213611602783
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.963 Test Loss: 0.224 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.1477203369140625
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.161 Vali Acc: 0.978 Test Loss: 0.161 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978411).  Saving model ...
Epoch: 15 cost time: 5.2652223110198975
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.160 Vali Acc: 0.977 Test Loss: 0.160 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.994341611862183
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.155 Vali Acc: 0.980 Test Loss: 0.155 Test Acc: 0.980
Validation loss decreased (-0.978411 --> -0.979803).  Saving model ...
Epoch: 17 cost time: 4.512678146362305
Epoch: 17, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.579498767852783
Epoch: 18, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.709072113037109
Epoch: 19, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.274 Vali Acc: 0.959 Test Loss: 0.274 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.878046751022339
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.230 Vali Acc: 0.962 Test Loss: 0.230 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 4.5895936489105225
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.974 Test Loss: 0.240 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 6.05080771446228
Epoch: 22, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.247 Vali Acc: 0.972 Test Loss: 0.247 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.816331386566162
Epoch: 23, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.204 Vali Acc: 0.976 Test Loss: 0.204 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.584583759307861
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.185 Vali Acc: 0.978 Test Loss: 0.185 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 5.021574258804321
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 5.758381128311157
Epoch: 26, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.981 Test Loss: 0.177 Test Acc: 0.981
Validation loss decreased (-0.979803 --> -0.981196).  Saving model ...
Epoch: 27 cost time: 5.478461265563965
Epoch: 27, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.979 Test Loss: 0.183 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.496351480484009
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.982 Test Loss: 0.182 Test Acc: 0.982
Validation loss decreased (-0.981196 --> -0.981892).  Saving model ...
Epoch: 29 cost time: 4.614456415176392
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.979 Test Loss: 0.184 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 5.814734935760498
Epoch: 30, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.978 Test Loss: 0.200 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 5.809033393859863
Epoch: 31, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.275 Vali Acc: 0.967 Test Loss: 0.275 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 5.891706943511963
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.393 Vali Acc: 0.946 Test Loss: 0.393 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.530590772628784
Epoch: 33, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.299 Vali Acc: 0.972 Test Loss: 0.299 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.641931056976318
Epoch: 34, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.353 Vali Acc: 0.973 Test Loss: 0.353 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.658357620239258
Epoch: 35, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.322 Vali Acc: 0.972 Test Loss: 0.322 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 5.432223320007324
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.299 Vali Acc: 0.978 Test Loss: 0.299 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.955536127090454
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.296 Vali Acc: 0.977 Test Loss: 0.296 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 5.047932863235474
Epoch: 38, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.979 Test Loss: 0.280 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 268428
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.409406900405884
Epoch: 1, Steps: 89 | Train Loss: 1.367 Vali Loss: 0.412 Vali Acc: 0.905 Test Loss: 0.412 Test Acc: 0.905
Validation loss decreased (inf --> -0.904592).  Saving model ...
Epoch: 2 cost time: 5.425017833709717
Epoch: 2, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.215 Vali Acc: 0.948 Test Loss: 0.215 Test Acc: 0.948
Validation loss decreased (-0.904592 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 5.037791728973389
Epoch: 3, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.948466 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 5.260695695877075
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.971447).  Saving model ...
Epoch: 5 cost time: 5.065047264099121
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.0665178298950195
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.960080146789551
Epoch: 7, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.761625528335571
Epoch: 8, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.970 Test Loss: 0.119 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.248021125793457
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 5.319241285324097
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.189 Vali Acc: 0.960 Test Loss: 0.189 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.19204568862915
Epoch: 11, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975625).  Saving model ...
Epoch: 12 cost time: 5.230763912200928
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.589432001113892
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.671128988265991
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.961 Test Loss: 0.200 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.243869304656982
Epoch: 15, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.309 Vali Acc: 0.955 Test Loss: 0.309 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.813539743423462
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.207 Vali Acc: 0.978 Test Loss: 0.207 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977714).  Saving model ...
Epoch: 17 cost time: 5.052903175354004
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.252 Vali Acc: 0.967 Test Loss: 0.252 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.940112352371216
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.220279693603516
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.280 Vali Acc: 0.957 Test Loss: 0.280 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 4.5833258628845215
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.236847639083862
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.3433685302734375
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.977 Test Loss: 0.176 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.113890886306763
Epoch: 23, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.981 Test Loss: 0.163 Test Acc: 0.981
Validation loss decreased (-0.977714 --> -0.981196).  Saving model ...
Epoch: 24 cost time: 5.2091264724731445
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.978 Test Loss: 0.167 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.613216400146484
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.972 Test Loss: 0.183 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.405227184295654
Epoch: 26, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.975 Test Loss: 0.180 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.3338093757629395
Epoch: 27, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.979 Test Loss: 0.194 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.177039384841919
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.980 Test Loss: 0.164 Test Acc: 0.980
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.92989182472229
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.293 Vali Acc: 0.953 Test Loss: 0.293 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.125965118408203
Epoch: 30, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.302 Vali Acc: 0.958 Test Loss: 0.302 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.443505048751831
Epoch: 31, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.333 Vali Acc: 0.954 Test Loss: 0.333 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.698473215103149
Epoch: 32, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.354 Vali Acc: 0.952 Test Loss: 0.354 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.321020603179932
Epoch: 33, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 268428
model size : 2.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.018942356109619
Epoch: 1, Steps: 89 | Train Loss: 1.593 Vali Loss: 0.580 Vali Acc: 0.868 Test Loss: 0.580 Test Acc: 0.868
Validation loss decreased (inf --> -0.867682).  Saving model ...
Epoch: 2 cost time: 4.809300661087036
Epoch: 2, Steps: 89 | Train Loss: 0.396 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
Validation loss decreased (-0.867682 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 5.47393274307251
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.175 Vali Acc: 0.955 Test Loss: 0.175 Test Acc: 0.955
Validation loss decreased (-0.939413 --> -0.954734).  Saving model ...
Epoch: 4 cost time: 4.953306436538696
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.144 Vali Acc: 0.961 Test Loss: 0.144 Test Acc: 0.961
Validation loss decreased (-0.954734 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 5.410731554031372
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
Validation loss decreased (-0.961001 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 4.559282541275024
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 7 cost time: 4.938687086105347
Epoch: 7, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 5.503283262252808
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 5.1856091022491455
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.629092454910278
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.450570344924927
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.064234733581543
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.03330659866333
Epoch: 13, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.119 Vali Acc: 0.977 Test Loss: 0.119 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 14 cost time: 5.693192005157471
Epoch: 14, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.125 Vali Acc: 0.974 Test Loss: 0.125 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.6410071849823
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.148 Vali Acc: 0.974 Test Loss: 0.148 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.055007457733154
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.955 Test Loss: 0.202 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.296839714050293
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.15222430229187
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.202 Vali Acc: 0.966 Test Loss: 0.202 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.924760103225708
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.096370697021484
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.974 Test Loss: 0.159 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.832106590270996
Epoch: 21, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.492558002471924
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.206 Vali Acc: 0.968 Test Loss: 0.206 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.263422966003418
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.971 Test Loss: 0.185 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 384108
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.7627480030059814
Epoch: 1, Steps: 89 | Train Loss: 1.582 Vali Loss: 0.555 Vali Acc: 0.868 Test Loss: 0.555 Test Acc: 0.868
Validation loss decreased (inf --> -0.867682).  Saving model ...
Epoch: 2 cost time: 5.072034597396851
Epoch: 2, Steps: 89 | Train Loss: 0.376 Vali Loss: 0.239 Vali Acc: 0.943 Test Loss: 0.239 Test Acc: 0.943
Validation loss decreased (-0.867682 --> -0.942895).  Saving model ...
Epoch: 3 cost time: 4.38528847694397
Epoch: 3, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.942895 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 4.44318962097168
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 5.01595401763916
Epoch: 5, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.127 Vali Acc: 0.962 Test Loss: 0.127 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.6339099407196045
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.107 Vali Acc: 0.969 Test Loss: 0.107 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 4.206964731216431
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973536).  Saving model ...
Epoch: 8 cost time: 4.766889572143555
Epoch: 8, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.282308101654053
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 10 cost time: 4.998552560806274
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.975 Test Loss: 0.119 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 5.3251283168792725
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.970 Test Loss: 0.137 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.868916988372803
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.99505877494812
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.951 Test Loss: 0.200 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.757606506347656
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 4.154289245605469
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.1036577224731445
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.968 Test Loss: 0.151 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.856005430221558
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.974 Test Loss: 0.143 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.053044557571411
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.944208860397339
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.999578475952148
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.976 Test Loss: 0.178 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.244064807891846
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.9769275188446045
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.977 Test Loss: 0.174 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 23 cost time: 5.338374853134155
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.968 Test Loss: 0.204 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 4.671162128448486
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.969 Test Loss: 0.204 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.941824674606323
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.976 Test Loss: 0.182 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.210262775421143
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.979 Test Loss: 0.165 Test Acc: 0.979
Validation loss decreased (-0.977018 --> -0.979107).  Saving model ...
Epoch: 27 cost time: 5.2648046016693115
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.955 Test Loss: 0.250 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 5.000013113021851
Epoch: 28, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.254 Vali Acc: 0.953 Test Loss: 0.254 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.941293239593506
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.327 Vali Acc: 0.935 Test Loss: 0.327 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 5.530372619628906
Epoch: 30, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.219 Vali Acc: 0.968 Test Loss: 0.219 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 4.839500427246094
Epoch: 31, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.966 Test Loss: 0.222 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 5.221224308013916
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.970 Test Loss: 0.194 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.752551317214966
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.974 Test Loss: 0.202 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 5.238626480102539
Epoch: 34, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.962 Test Loss: 0.228 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 5.285464286804199
Epoch: 35, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.977 Test Loss: 0.186 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 4.642871379852295
Epoch: 36, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.250 Vali Acc: 0.962 Test Loss: 0.250 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 384108
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.173405408859253
Epoch: 1, Steps: 89 | Train Loss: 1.586 Vali Loss: 0.529 Vali Acc: 0.871 Test Loss: 0.529 Test Acc: 0.871
Validation loss decreased (inf --> -0.871165).  Saving model ...
Epoch: 2 cost time: 4.61474347114563
Epoch: 2, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.222 Vali Acc: 0.945 Test Loss: 0.222 Test Acc: 0.945
Validation loss decreased (-0.871165 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 5.21255087852478
Epoch: 3, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.146 Vali Acc: 0.965 Test Loss: 0.146 Test Acc: 0.965
Validation loss decreased (-0.944984 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 5.136384725570679
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.135 Vali Acc: 0.966 Test Loss: 0.135 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 4.869135856628418
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.824502229690552
Epoch: 6, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.115 Vali Acc: 0.973 Test Loss: 0.115 Test Acc: 0.973
Validation loss decreased (-0.965876 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 5.595093250274658
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.2365241050720215
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.986778736114502
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.108 Vali Acc: 0.977 Test Loss: 0.108 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 4.558729410171509
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.846505641937256
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.972 Test Loss: 0.132 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.9119873046875
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.975233316421509
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.125 Vali Acc: 0.975 Test Loss: 0.125 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.904310703277588
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.965 Test Loss: 0.158 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.15643048286438
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.160 Vali Acc: 0.975 Test Loss: 0.160 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.3639562129974365
Epoch: 16, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.147 Vali Acc: 0.977 Test Loss: 0.147 Test Acc: 0.977
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.206859350204468
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.080009460449219
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 19 cost time: 4.6196348667144775
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.839129209518433
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979107).  Saving model ...
Epoch: 21 cost time: 5.005554676055908
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.139 Vali Acc: 0.976 Test Loss: 0.139 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.707538604736328
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 4.904699802398682
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.176451206207275
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.160328388214111
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.962 Test Loss: 0.182 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 4.572366714477539
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.242780685424805
Epoch: 27, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.953 Test Loss: 0.293 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.567843914031982
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.361599445343018
Epoch: 29, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.921283483505249
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 384108
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.613810777664185
Epoch: 1, Steps: 89 | Train Loss: 1.703 Vali Loss: 0.578 Vali Acc: 0.878 Test Loss: 0.578 Test Acc: 0.878
Validation loss decreased (inf --> -0.878128).  Saving model ...
Epoch: 2 cost time: 4.741936445236206
Epoch: 2, Steps: 89 | Train Loss: 0.356 Vali Loss: 0.240 Vali Acc: 0.942 Test Loss: 0.240 Test Acc: 0.942
Validation loss decreased (-0.878128 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 4.56947922706604
Epoch: 3, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
Validation loss decreased (-0.941502 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 4.046681642532349
Epoch: 4, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 5.008506536483765
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.017256498336792
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 5.0032548904418945
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 8 cost time: 4.929139852523804
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 5.554685592651367
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 4.35921573638916
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.045952796936035
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.786433935165405
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.171 Vali Acc: 0.957 Test Loss: 0.171 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.635823726654053
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.162 Vali Acc: 0.960 Test Loss: 0.162 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.795091867446899
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.174 Vali Acc: 0.964 Test Loss: 0.174 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.0730884075164795
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.7176995277404785
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.073081970214844
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.954 Test Loss: 0.207 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.0606842041015625
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.327207565307617
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 384108
model size : 2.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.042112112045288
Epoch: 1, Steps: 89 | Train Loss: 1.640 Vali Loss: 0.584 Vali Acc: 0.865 Test Loss: 0.584 Test Acc: 0.865
Validation loss decreased (inf --> -0.864897).  Saving model ...
Epoch: 2 cost time: 4.50358510017395
Epoch: 2, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.271 Vali Acc: 0.936 Test Loss: 0.271 Test Acc: 0.936
Validation loss decreased (-0.864897 --> -0.935930).  Saving model ...
Epoch: 3 cost time: 5.023261785507202
Epoch: 3, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.188 Vali Acc: 0.946 Test Loss: 0.188 Test Acc: 0.946
Validation loss decreased (-0.935930 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 4.813154220581055
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
Validation loss decreased (-0.946377 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 4.735365629196167
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 4.844635963439941
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.416179180145264
Epoch: 7, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.110 Vali Acc: 0.970 Test Loss: 0.110 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 5.19068169593811
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.878915071487427
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.90232515335083
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.938969373703003
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.689457893371582
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973536).  Saving model ...
Epoch: 13 cost time: 4.700638771057129
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.173 Vali Acc: 0.963 Test Loss: 0.173 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.561650991439819
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.139 Vali Acc: 0.973 Test Loss: 0.139 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.88837194442749
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.707803249359131
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.978411).  Saving model ...
Epoch: 17 cost time: 5.076134920120239
Epoch: 17, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.558710813522339
Epoch: 18, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.3258514404296875
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.959 Test Loss: 0.197 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.78993034362793
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.498931169509888
Epoch: 21, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.230 Vali Acc: 0.966 Test Loss: 0.230 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.878917455673218
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.232 Vali Acc: 0.961 Test Loss: 0.232 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 4.70539665222168
Epoch: 23, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.971 Test Loss: 0.206 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.290223836898804
Epoch: 24, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.211 Vali Acc: 0.972 Test Loss: 0.211 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 4.8500425815582275
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.353 Vali Acc: 0.940 Test Loss: 0.353 Test Acc: 0.940
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 4.67870306968689
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 253036
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.7080769538879395
Epoch: 1, Steps: 89 | Train Loss: 1.624 Vali Loss: 0.558 Vali Acc: 0.867 Test Loss: 0.558 Test Acc: 0.867
Validation loss decreased (inf --> -0.866986).  Saving model ...
Epoch: 2 cost time: 5.104037046432495
Epoch: 2, Steps: 89 | Train Loss: 0.370 Vali Loss: 0.243 Vali Acc: 0.940 Test Loss: 0.243 Test Acc: 0.940
Validation loss decreased (-0.866986 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 4.863007307052612
Epoch: 3, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.940109 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 5.329317092895508
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.153 Vali Acc: 0.953 Test Loss: 0.153 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.495722532272339
Epoch: 5, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
Validation loss decreased (-0.956126 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 4.7587831020355225
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.131 Vali Acc: 0.967 Test Loss: 0.131 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 4.357507944107056
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 4.267963886260986
Epoch: 8, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.549129247665405
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.113 Vali Acc: 0.975 Test Loss: 0.113 Test Acc: 0.975
Validation loss decreased (-0.969358 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 4.743862867355347
Epoch: 10, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.102 Vali Acc: 0.978 Test Loss: 0.102 Test Acc: 0.978
Validation loss decreased (-0.974929 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 4.594580888748169
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.469460964202881
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.122 Vali Acc: 0.973 Test Loss: 0.122 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.2784013748168945
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.114 Vali Acc: 0.977 Test Loss: 0.114 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.241962194442749
Epoch: 14, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.057881832122803
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.7022175788879395
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.969 Test Loss: 0.176 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.79840612411499
Epoch: 17, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.169 Vali Acc: 0.960 Test Loss: 0.169 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 4.547317981719971
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 4.306184768676758
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.221 Vali Acc: 0.957 Test Loss: 0.221 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 4.529863357543945
Epoch: 20, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 253036
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.242332220077515
Epoch: 1, Steps: 89 | Train Loss: 1.633 Vali Loss: 0.570 Vali Acc: 0.864 Test Loss: 0.570 Test Acc: 0.864
Validation loss decreased (inf --> -0.863504).  Saving model ...
Epoch: 2 cost time: 4.985440015792847
Epoch: 2, Steps: 89 | Train Loss: 0.355 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.863504 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 4.714656114578247
Epoch: 3, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
Validation loss decreased (-0.946377 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 5.001448631286621
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.128 Vali Acc: 0.970 Test Loss: 0.128 Test Acc: 0.970
Validation loss decreased (-0.956823 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 4.775240421295166
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.895634889602661
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.6893696784973145
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.970054 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 4.170707702636719
Epoch: 8, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.099 Vali Acc: 0.975 Test Loss: 0.099 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 4.394582271575928
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.088 Vali Acc: 0.976 Test Loss: 0.088 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.976322).  Saving model ...
Epoch: 10 cost time: 4.819024562835693
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.2596070766448975
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.215276479721069
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.731244087219238
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.64798378944397
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.976 Test Loss: 0.119 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.193339109420776
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.111 Vali Acc: 0.974 Test Loss: 0.111 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.364358425140381
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.351472616195679
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 5.572387933731079
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 5.208442211151123
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.971 Test Loss: 0.151 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 253036
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.227660179138184
Epoch: 1, Steps: 89 | Train Loss: 1.739 Vali Loss: 0.599 Vali Acc: 0.872 Test Loss: 0.599 Test Acc: 0.872
Validation loss decreased (inf --> -0.871860).  Saving model ...
Epoch: 2 cost time: 4.833130598068237
Epoch: 2, Steps: 89 | Train Loss: 0.379 Vali Loss: 0.253 Vali Acc: 0.935 Test Loss: 0.253 Test Acc: 0.935
Validation loss decreased (-0.871860 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 4.336152076721191
Epoch: 3, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.934538 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 4.87364935874939
Epoch: 4, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.152 Vali Acc: 0.958 Test Loss: 0.152 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 4.09598183631897
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.558426380157471
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 4.8334760665893555
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
Validation loss decreased (-0.961698 --> -0.961698).  Saving model ...
Epoch: 8 cost time: 5.38210916519165
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.135 Vali Acc: 0.965 Test Loss: 0.135 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 4.994063854217529
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.102195978164673
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
Validation loss decreased (-0.965180 --> -0.968662).  Saving model ...
Epoch: 11 cost time: 5.678385496139526
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.189 Vali Acc: 0.950 Test Loss: 0.189 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.5288169384002686
Epoch: 12, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.8464741706848145
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.153 Vali Acc: 0.965 Test Loss: 0.153 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.305164813995361
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.146 Vali Acc: 0.969 Test Loss: 0.146 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 4.5785017013549805
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 16 cost time: 4.366346836090088
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.148 Vali Acc: 0.968 Test Loss: 0.148 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.8318750858306885
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.292 Vali Acc: 0.943 Test Loss: 0.292 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.539819955825806
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.221 Vali Acc: 0.955 Test Loss: 0.221 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.8211669921875
Epoch: 19, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 20 cost time: 5.169782638549805
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.964 Test Loss: 0.188 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.300097942352295
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 22 cost time: 4.853986501693726
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.147 Vali Acc: 0.969 Test Loss: 0.147 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.746139287948608
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.852450132369995
Epoch: 24, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.158 Vali Acc: 0.970 Test Loss: 0.158 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.926058769226074
Epoch: 25, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.554564952850342
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.860554456710815
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.148932933807373
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.218 Vali Acc: 0.967 Test Loss: 0.218 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.946277379989624
Epoch: 29, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.755556583404541
Epoch: 30, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.190 Vali Acc: 0.967 Test Loss: 0.190 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.949368953704834
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.203 Vali Acc: 0.968 Test Loss: 0.203 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 253036
model size : 1.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.685163259506226
Epoch: 1, Steps: 89 | Train Loss: 1.637 Vali Loss: 0.598 Vali Acc: 0.863 Test Loss: 0.598 Test Acc: 0.863
Validation loss decreased (inf --> -0.862807).  Saving model ...
Epoch: 2 cost time: 4.685779809951782
Epoch: 2, Steps: 89 | Train Loss: 0.417 Vali Loss: 0.297 Vali Acc: 0.921 Test Loss: 0.297 Test Acc: 0.921
Validation loss decreased (-0.862807 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 4.1094794273376465
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.920610 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 4.561103820800781
Epoch: 4, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.459123134613037
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.133 Vali Acc: 0.970 Test Loss: 0.133 Test Acc: 0.970
Validation loss decreased (-0.956126 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 4.374037265777588
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.970054 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 4.039461612701416
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.471244812011719
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 4.436181545257568
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.176 Vali Acc: 0.961 Test Loss: 0.176 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.603303670883179
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.152 Vali Acc: 0.971 Test Loss: 0.152 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 4.66951060295105
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.163731575012207
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 13 cost time: 5.052211761474609
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.495429992675781
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.958 Test Loss: 0.231 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.808806896209717
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.977 Test Loss: 0.134 Test Acc: 0.977
Validation loss decreased (-0.972143 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 4.562486410140991
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.138 Vali Acc: 0.975 Test Loss: 0.138 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.5879082679748535
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.962 Test Loss: 0.204 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.006335735321045
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.149 Vali Acc: 0.978 Test Loss: 0.149 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977714).  Saving model ...
Epoch: 19 cost time: 4.393660068511963
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.636211633682251
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.4759910106658936
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.963 Test Loss: 0.194 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.4944398403167725
Epoch: 22, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.963 Test Loss: 0.185 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.751110553741455
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.971 Test Loss: 0.166 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.2866034507751465
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.365654230117798
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.2532594203948975
Epoch: 26, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.265 Vali Acc: 0.951 Test Loss: 0.265 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.776090860366821
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.232 Vali Acc: 0.969 Test Loss: 0.232 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.861037731170654
Epoch: 28, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.280 Vali Acc: 0.953 Test Loss: 0.280 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 187500
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.193519353866577
Epoch: 1, Steps: 89 | Train Loss: 1.631 Vali Loss: 0.581 Vali Acc: 0.864 Test Loss: 0.581 Test Acc: 0.864
Validation loss decreased (inf --> -0.863504).  Saving model ...
Epoch: 2 cost time: 4.162860155105591
Epoch: 2, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.278 Vali Acc: 0.922 Test Loss: 0.278 Test Acc: 0.922
Validation loss decreased (-0.863504 --> -0.922003).  Saving model ...
Epoch: 3 cost time: 4.525566816329956
Epoch: 3, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.922003 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 4.7955920696258545
Epoch: 4, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.158 Vali Acc: 0.956 Test Loss: 0.158 Test Acc: 0.956
Validation loss decreased (-0.956126 --> -0.956127).  Saving model ...
Epoch: 5 cost time: 4.749654293060303
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.122 Vali Acc: 0.965 Test Loss: 0.122 Test Acc: 0.965
Validation loss decreased (-0.956127 --> -0.965180).  Saving model ...
Epoch: 6 cost time: 4.908591270446777
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.965180 --> -0.976322).  Saving model ...
Epoch: 7 cost time: 5.396151304244995
Epoch: 7, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.618915557861328
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.818756341934204
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.42064356803894
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.880483150482178
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.025627613067627
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.159 Vali Acc: 0.965 Test Loss: 0.159 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 5.020320177078247
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.522386074066162
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.670439004898071
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 16 cost time: 4.685735702514648
Epoch: 16, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.475488185882568
Epoch: 17, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.843428134918213
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.821971654891968
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.969 Test Loss: 0.205 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.356195449829102
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.248 Vali Acc: 0.955 Test Loss: 0.248 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.451942443847656
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.142 Vali Acc: 0.975 Test Loss: 0.142 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.305830717086792
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.967 Test Loss: 0.200 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.309344291687012
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.962 Test Loss: 0.224 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.7505505084991455
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.591209888458252
Epoch: 25, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.976 Test Loss: 0.141 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 187500
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.165895223617554
Epoch: 1, Steps: 89 | Train Loss: 1.649 Vali Loss: 0.592 Vali Acc: 0.860 Test Loss: 0.592 Test Acc: 0.860
Validation loss decreased (inf --> -0.860022).  Saving model ...
Epoch: 2 cost time: 5.315719127655029
Epoch: 2, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
Validation loss decreased (-0.860022 --> -0.915039).  Saving model ...
Epoch: 3 cost time: 5.182831764221191
Epoch: 3, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.168 Vali Acc: 0.958 Test Loss: 0.168 Test Acc: 0.958
Validation loss decreased (-0.915039 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 4.851555109024048
Epoch: 4, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.957519 --> -0.967269).  Saving model ...
Epoch: 5 cost time: 4.544279098510742
Epoch: 5, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.123 Vali Acc: 0.965 Test Loss: 0.123 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.550341367721558
Epoch: 6, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.111 Vali Acc: 0.970 Test Loss: 0.111 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 4.743689060211182
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 4.437542915344238
Epoch: 8, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.418807744979858
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.764983177185059
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.117 Vali Acc: 0.978 Test Loss: 0.117 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 4.622205972671509
Epoch: 11, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.966 Test Loss: 0.159 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.476215362548828
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.122 Vali Acc: 0.978 Test Loss: 0.122 Test Acc: 0.978
Validation loss decreased (-0.977715 --> -0.978411).  Saving model ...
Epoch: 13 cost time: 4.261580467224121
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.976 Test Loss: 0.128 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.141112327575684
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.194046258926392
Epoch: 15, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.332051038742065
Epoch: 16, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.933222055435181
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.981 Test Loss: 0.140 Test Acc: 0.981
Validation loss decreased (-0.978411 --> -0.980500).  Saving model ...
Epoch: 18 cost time: 5.383089065551758
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.983 Test Loss: 0.130 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982589).  Saving model ...
Epoch: 19 cost time: 4.940489768981934
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.165955543518066
Epoch: 20, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.281854629516602
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.900727033615112
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.94232964515686
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.32512092590332
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 4.731306076049805
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.1923346519470215
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.159 Vali Acc: 0.973 Test Loss: 0.159 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.088273048400879
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.186 Vali Acc: 0.973 Test Loss: 0.186 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.729576587677002
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.978 Test Loss: 0.170 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 187500
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.523025035858154
Epoch: 1, Steps: 89 | Train Loss: 1.770 Vali Loss: 0.628 Vali Acc: 0.875 Test Loss: 0.628 Test Acc: 0.875
Validation loss decreased (inf --> -0.875342).  Saving model ...
Epoch: 2 cost time: 4.549700975418091
Epoch: 2, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.283 Vali Acc: 0.916 Test Loss: 0.283 Test Acc: 0.916
Validation loss decreased (-0.875342 --> -0.916432).  Saving model ...
Epoch: 3 cost time: 4.31971001625061
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
Validation loss decreased (-0.916432 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 4.834637403488159
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.153 Vali Acc: 0.961 Test Loss: 0.153 Test Acc: 0.961
Validation loss decreased (-0.955430 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 4.673802375793457
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 4.415609121322632
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 7 cost time: 4.458133697509766
Epoch: 7, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.870194673538208
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.5602707862854
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.778351306915283
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.658826112747192
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 5.4862847328186035
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 4.621889352798462
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 4.516043663024902
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 4.144737243652344
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.142 Vali Acc: 0.969 Test Loss: 0.142 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 4.522985458374023
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.130 Vali Acc: 0.972 Test Loss: 0.130 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972144).  Saving model ...
Epoch: 17 cost time: 4.782584190368652
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.138 Vali Acc: 0.967 Test Loss: 0.138 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.9529857635498047
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.144921779632568
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.335841178894043
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.254 Vali Acc: 0.953 Test Loss: 0.254 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.022547245025635
Epoch: 21, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.181 Vali Acc: 0.965 Test Loss: 0.181 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.578993082046509
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.974232).  Saving model ...
Epoch: 23 cost time: 4.760345935821533
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.044321060180664
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.151 Vali Acc: 0.974 Test Loss: 0.151 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 4.507892847061157
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.141 Vali Acc: 0.977 Test Loss: 0.141 Test Acc: 0.977
Validation loss decreased (-0.974232 --> -0.977018).  Saving model ...
Epoch: 26 cost time: 4.482802629470825
Epoch: 26, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.978411).  Saving model ...
Epoch: 27 cost time: 4.10521936416626
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 4.6121134757995605
Epoch: 28, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 4.442741632461548
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.130 Vali Acc: 0.978 Test Loss: 0.130 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 4.203314304351807
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 3.8006412982940674
Epoch: 31, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.962 Test Loss: 0.207 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 4.316858768463135
Epoch: 32, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.141 Vali Acc: 0.969 Test Loss: 0.141 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 4.4952232837677
Epoch: 33, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.976 Test Loss: 0.145 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 4.569426774978638
Epoch: 34, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.145 Vali Acc: 0.979 Test Loss: 0.145 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979107).  Saving model ...
Epoch: 35 cost time: 4.725837230682373
Epoch: 35, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.144 Vali Acc: 0.976 Test Loss: 0.144 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.8700103759765625
Epoch: 36, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.171 Vali Acc: 0.976 Test Loss: 0.171 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.38789439201355
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.189 Vali Acc: 0.967 Test Loss: 0.189 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.215666770935059
Epoch: 38, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.970 Test Loss: 0.177 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.5337233543396
Epoch: 39, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.258 Vali Acc: 0.956 Test Loss: 0.258 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 5.020970106124878
Epoch: 40, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.180 Vali Acc: 0.969 Test Loss: 0.180 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.220234632492065
Epoch: 41, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.971 Test Loss: 0.169 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.4584221839904785
Epoch: 42, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.847952842712402
Epoch: 43, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.769220590591431
Epoch: 44, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.136 Vali Acc: 0.978 Test Loss: 0.136 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 187500
model size : 1.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.384656190872192
Epoch: 1, Steps: 89 | Train Loss: 1.626 Vali Loss: 0.605 Vali Acc: 0.851 Test Loss: 0.605 Test Acc: 0.851
Validation loss decreased (inf --> -0.850969).  Saving model ...
Epoch: 2 cost time: 5.052071809768677
Epoch: 2, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.279 Vali Acc: 0.928 Test Loss: 0.279 Test Acc: 0.928
Validation loss decreased (-0.850969 --> -0.928270).  Saving model ...
Epoch: 3 cost time: 4.82290244102478
Epoch: 3, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.199 Vali Acc: 0.946 Test Loss: 0.199 Test Acc: 0.946
Validation loss decreased (-0.928270 --> -0.945680).  Saving model ...
Epoch: 4 cost time: 4.210989236831665
Epoch: 4, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.162 Vali Acc: 0.962 Test Loss: 0.162 Test Acc: 0.962
Validation loss decreased (-0.945680 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 4.136706352233887
Epoch: 5, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.969358).  Saving model ...
Epoch: 6 cost time: 4.275511741638184
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 4.415574312210083
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 8 cost time: 4.038038730621338
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 4.276331663131714
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.968 Test Loss: 0.135 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.5843164920806885
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.133 Vali Acc: 0.974 Test Loss: 0.133 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 5.3523828983306885
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 4.650136470794678
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.119 Vali Acc: 0.978 Test Loss: 0.119 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 4.705716609954834
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.969 Test Loss: 0.162 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.942760944366455
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.126 Vali Acc: 0.975 Test Loss: 0.126 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.941634893417358
Epoch: 15, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.4792444705963135
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.249 Vali Acc: 0.958 Test Loss: 0.249 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.939692497253418
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.125231742858887
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.967 Test Loss: 0.185 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.680740833282471
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.553148984909058
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.183 Vali Acc: 0.974 Test Loss: 0.183 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.027889013290405
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.971 Test Loss: 0.174 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.250048637390137
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.973 Test Loss: 0.201 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 154732
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.634461402893066
Epoch: 1, Steps: 89 | Train Loss: 1.622 Vali Loss: 0.593 Vali Acc: 0.852 Test Loss: 0.593 Test Acc: 0.852
Validation loss decreased (inf --> -0.852362).  Saving model ...
Epoch: 2 cost time: 4.7054219245910645
Epoch: 2, Steps: 89 | Train Loss: 0.401 Vali Loss: 0.275 Vali Acc: 0.924 Test Loss: 0.275 Test Acc: 0.924
Validation loss decreased (-0.852362 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 4.76938796043396
Epoch: 3, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.197 Vali Acc: 0.946 Test Loss: 0.197 Test Acc: 0.946
Validation loss decreased (-0.924092 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 4.6508893966674805
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.156 Vali Acc: 0.966 Test Loss: 0.156 Test Acc: 0.966
Validation loss decreased (-0.946377 --> -0.965876).  Saving model ...
Epoch: 5 cost time: 4.741142511367798
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.965876 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 4.535244941711426
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.967965 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 4.29927659034729
Epoch: 7, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.114 Vali Acc: 0.967 Test Loss: 0.114 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.674111604690552
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.107 Vali Acc: 0.972 Test Loss: 0.107 Test Acc: 0.972
Validation loss decreased (-0.970055 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 4.722280502319336
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973537).  Saving model ...
Epoch: 10 cost time: 4.608642816543579
Epoch: 10, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.976 Test Loss: 0.107 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 4.621971368789673
Epoch: 11, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.898027420043945
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 13 cost time: 4.838803768157959
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.056914806365967
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.154754161834717
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.133 Vali Acc: 0.976 Test Loss: 0.133 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.999127149581909
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.674226760864258
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.9287989139556885
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.384152173995972
Epoch: 19, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.331918478012085
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.162 Vali Acc: 0.975 Test Loss: 0.162 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.570347547531128
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.967 Test Loss: 0.175 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 5.435976028442383
Epoch: 22, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.972 Test Loss: 0.154 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 154732
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.144832611083984
Epoch: 1, Steps: 89 | Train Loss: 1.644 Vali Loss: 0.604 Vali Acc: 0.847 Test Loss: 0.604 Test Acc: 0.847
Validation loss decreased (inf --> -0.846791).  Saving model ...
Epoch: 2 cost time: 4.291807174682617
Epoch: 2, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.275 Vali Acc: 0.925 Test Loss: 0.275 Test Acc: 0.925
Validation loss decreased (-0.846791 --> -0.925485).  Saving model ...
Epoch: 3 cost time: 4.897417068481445
Epoch: 3, Steps: 89 | Train Loss: 0.182 Vali Loss: 0.182 Vali Acc: 0.953 Test Loss: 0.182 Test Acc: 0.953
Validation loss decreased (-0.925485 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 4.001370906829834
Epoch: 4, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.961698).  Saving model ...
Epoch: 5 cost time: 4.392230033874512
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.961698 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 4.608721971511841
Epoch: 6, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.143 Vali Acc: 0.961 Test Loss: 0.143 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.742526054382324
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.2829225063323975
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.968662).  Saving model ...
Epoch: 9 cost time: 4.3448755741119385
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.115 Vali Acc: 0.976 Test Loss: 0.115 Test Acc: 0.976
Validation loss decreased (-0.968662 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 4.676645755767822
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.207367181777954
Epoch: 11, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.344243288040161
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.8143532276153564
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 14 cost time: 5.197529554367065
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.935305833816528
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.363139867782593
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.205321550369263
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.169 Vali Acc: 0.970 Test Loss: 0.169 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.627547979354858
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.143 Vali Acc: 0.979 Test Loss: 0.143 Test Acc: 0.979
Validation loss decreased (-0.976322 --> -0.979107).  Saving model ...
Epoch: 19 cost time: 4.57362174987793
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.338817358016968
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.239 Vali Acc: 0.957 Test Loss: 0.239 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.844862699508667
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.184 Vali Acc: 0.973 Test Loss: 0.184 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.772141695022583
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.971 Test Loss: 0.193 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.115686893463135
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.965 Test Loss: 0.213 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.622849464416504
Epoch: 24, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.978 Test Loss: 0.163 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.007471561431885
Epoch: 25, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.177 Vali Acc: 0.975 Test Loss: 0.177 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.223015308380127
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.964 Test Loss: 0.219 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 4.436984300613403
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 4.406337022781372
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 154732
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.499161005020142
Epoch: 1, Steps: 89 | Train Loss: 1.786 Vali Loss: 0.667 Vali Acc: 0.853 Test Loss: 0.667 Test Acc: 0.853
Validation loss decreased (inf --> -0.853057).  Saving model ...
Epoch: 2 cost time: 3.851895570755005
Epoch: 2, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.853057 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 4.125807523727417
Epoch: 3, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.189 Vali Acc: 0.954 Test Loss: 0.189 Test Acc: 0.954
Validation loss decreased (-0.933145 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 4.724934816360474
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
Validation loss decreased (-0.954037 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 4.386236906051636
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
Validation loss decreased (-0.956823 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 4.521824598312378
Epoch: 6, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.179 Vali Acc: 0.954 Test Loss: 0.179 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.984724760055542
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.134 Vali Acc: 0.966 Test Loss: 0.134 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.829858064651489
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.139 Vali Acc: 0.958 Test Loss: 0.139 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.127320051193237
Epoch: 9, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 4.458524465560913
Epoch: 10, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.027348756790161
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.383307456970215
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.171 Vali Acc: 0.962 Test Loss: 0.171 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.423274517059326
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.745830774307251
Epoch: 14, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.162374496459961
Epoch: 15, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
Validation loss decreased (-0.967965 --> -0.977715).  Saving model ...
Epoch: 16 cost time: 4.797155380249023
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.963 Test Loss: 0.162 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.7897679805755615
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.229 Vali Acc: 0.942 Test Loss: 0.229 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.24376654624939
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.8492431640625
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.137 Vali Acc: 0.972 Test Loss: 0.137 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.120884895324707
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.863385438919067
Epoch: 21, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.494765996932983
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.30221962928772
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.6538355350494385
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.172 Vali Acc: 0.974 Test Loss: 0.172 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 4.474022388458252
Epoch: 25, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.167 Vali Acc: 0.974 Test Loss: 0.167 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 154732
model size : 1.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.5491955280303955
Epoch: 1, Steps: 89 | Train Loss: 1.646 Vali Loss: 0.636 Vali Acc: 0.825 Test Loss: 0.636 Test Acc: 0.825
Validation loss decreased (inf --> -0.825203).  Saving model ...
Epoch: 2 cost time: 5.053972482681274
Epoch: 2, Steps: 89 | Train Loss: 0.432 Vali Loss: 0.277 Vali Acc: 0.931 Test Loss: 0.277 Test Acc: 0.931
Validation loss decreased (-0.825203 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 4.884766340255737
Epoch: 3, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.207 Vali Acc: 0.951 Test Loss: 0.207 Test Acc: 0.951
Validation loss decreased (-0.931056 --> -0.951251).  Saving model ...
Epoch: 4 cost time: 4.313723802566528
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.951251 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 4.823769569396973
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.130 Vali Acc: 0.970 Test Loss: 0.130 Test Acc: 0.970
Validation loss decreased (-0.956126 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 4.5863752365112305
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.143 Vali Acc: 0.963 Test Loss: 0.143 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.099734783172607
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.957 Test Loss: 0.153 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.249361038208008
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.615649461746216
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 4.954901695251465
Epoch: 10, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.939755916595459
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.164 Vali Acc: 0.967 Test Loss: 0.164 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.663033723831177
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 13 cost time: 4.840489864349365
Epoch: 13, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.7745585441589355
Epoch: 14, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.461108684539795
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.973536 --> -0.977018).  Saving model ...
Epoch: 16 cost time: 4.452485084533691
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.445937156677246
Epoch: 17, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.958893775939941
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.963 Test Loss: 0.199 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.359997749328613
Epoch: 19, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.153 Vali Acc: 0.974 Test Loss: 0.153 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.9870035648345947
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.178 Vali Acc: 0.972 Test Loss: 0.178 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.452392339706421
Epoch: 21, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.972 Test Loss: 0.198 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 4.87923526763916
Epoch: 22, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.230 Vali Acc: 0.963 Test Loss: 0.230 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 4.663881540298462
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.971 Test Loss: 0.177 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 4.192822456359863
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.967 Test Loss: 0.198 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.020228862762451
Epoch: 25, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.968 Test Loss: 0.193 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 138348
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.146679162979126
Epoch: 1, Steps: 89 | Train Loss: 1.642 Vali Loss: 0.629 Vali Acc: 0.825 Test Loss: 0.629 Test Acc: 0.825
Validation loss decreased (inf --> -0.824506).  Saving model ...
Epoch: 2 cost time: 4.670679569244385
Epoch: 2, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.267 Vali Acc: 0.935 Test Loss: 0.267 Test Acc: 0.935
Validation loss decreased (-0.824506 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 4.857143878936768
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.934538 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 4.14506196975708
Epoch: 4, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.173 Vali Acc: 0.958 Test Loss: 0.173 Test Acc: 0.958
Validation loss decreased (-0.951948 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 4.4316864013671875
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.958216 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 4.262051343917847
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.153 Vali Acc: 0.956 Test Loss: 0.153 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.034765005111694
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.965 Test Loss: 0.132 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.398508071899414
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.891118288040161
Epoch: 9, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 10 cost time: 3.9767496585845947
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.508795976638794
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.116525650024414
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.115 Vali Acc: 0.978 Test Loss: 0.115 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.977715).  Saving model ...
Epoch: 13 cost time: 3.772578001022339
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.018155813217163
Epoch: 14, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.968 Test Loss: 0.162 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.751802444458008
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.973779916763306
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.743590831756592
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.298 Vali Acc: 0.931 Test Loss: 0.298 Test Acc: 0.931
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.377707481384277
Epoch: 18, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.660709857940674
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.855382442474365
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.39505672454834
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.966 Test Loss: 0.169 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.781977653503418
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.144 Vali Acc: 0.975 Test Loss: 0.144 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 138348
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.836148500442505
Epoch: 1, Steps: 89 | Train Loss: 1.661 Vali Loss: 0.649 Vali Acc: 0.822 Test Loss: 0.649 Test Acc: 0.822
Validation loss decreased (inf --> -0.821721).  Saving model ...
Epoch: 2 cost time: 4.23499321937561
Epoch: 2, Steps: 89 | Train Loss: 0.424 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
Validation loss decreased (-0.821721 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 3.804643392562866
Epoch: 3, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.933145 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 3.882258415222168
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.170 Vali Acc: 0.950 Test Loss: 0.170 Test Acc: 0.950
Validation loss decreased (-0.947770 --> -0.949859).  Saving model ...
Epoch: 5 cost time: 4.34480881690979
Epoch: 5, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.949859 --> -0.966573).  Saving model ...
Epoch: 6 cost time: 4.82019829750061
Epoch: 6, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.156 Vali Acc: 0.951 Test Loss: 0.156 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.079136610031128
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970055).  Saving model ...
Epoch: 8 cost time: 3.929380178451538
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.968 Test Loss: 0.129 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.8902764320373535
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.116 Vali Acc: 0.970 Test Loss: 0.116 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.8222410678863525
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.970055 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 4.534809350967407
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 3.9170310497283936
Epoch: 12, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.115 Vali Acc: 0.979 Test Loss: 0.115 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979107).  Saving model ...
Epoch: 13 cost time: 4.60422420501709
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.491740703582764
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.959 Test Loss: 0.205 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.687731981277466
Epoch: 15, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.152 Vali Acc: 0.969 Test Loss: 0.152 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.09419846534729
Epoch: 16, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.150 Vali Acc: 0.972 Test Loss: 0.150 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.752472639083862
Epoch: 17, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.7052788734436035
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.900298357009888
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.66465163230896
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.271 Vali Acc: 0.953 Test Loss: 0.271 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 4.74642276763916
Epoch: 21, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.243 Vali Acc: 0.958 Test Loss: 0.243 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.517524003982544
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.960 Test Loss: 0.232 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 138348
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.201973915100098
Epoch: 1, Steps: 89 | Train Loss: 1.781 Vali Loss: 0.682 Vali Acc: 0.831 Test Loss: 0.682 Test Acc: 0.831
Validation loss decreased (inf --> -0.830773).  Saving model ...
Epoch: 2 cost time: 4.447052955627441
Epoch: 2, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.304 Vali Acc: 0.916 Test Loss: 0.304 Test Acc: 0.916
Validation loss decreased (-0.830773 --> -0.915735).  Saving model ...
Epoch: 3 cost time: 4.570749759674072
Epoch: 3, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.915735 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 4.14910101890564
Epoch: 4, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.212600469589233
Epoch: 5, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
Validation loss decreased (-0.950555 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 4.68690824508667
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.158 Vali Acc: 0.960 Test Loss: 0.158 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.038466215133667
Epoch: 7, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.143 Vali Acc: 0.965 Test Loss: 0.143 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.565587520599365
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.120 Vali Acc: 0.972 Test Loss: 0.120 Test Acc: 0.972
Validation loss decreased (-0.966572 --> -0.972144).  Saving model ...
Epoch: 9 cost time: 4.321864128112793
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.131 Vali Acc: 0.969 Test Loss: 0.131 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.969377279281616
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 11 cost time: 4.476886034011841
Epoch: 11, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.296921730041504
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975625).  Saving model ...
Epoch: 13 cost time: 3.9483540058135986
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.645994424819946
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.116 Vali Acc: 0.977 Test Loss: 0.116 Test Acc: 0.977
Validation loss decreased (-0.975625 --> -0.977018).  Saving model ...
Epoch: 15 cost time: 4.345641136169434
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.969 Test Loss: 0.138 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.173104286193848
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.27200174331665
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.145 Vali Acc: 0.972 Test Loss: 0.145 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.600337028503418
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.955897808074951
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.160 Vali Acc: 0.969 Test Loss: 0.160 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.5295209884643555
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.147 Vali Acc: 0.974 Test Loss: 0.147 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.252596616744995
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.112322092056274
Epoch: 22, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.202 Vali Acc: 0.963 Test Loss: 0.202 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.664513349533081
Epoch: 23, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.174 Vali Acc: 0.968 Test Loss: 0.174 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.552156209945679
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 138348
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.96337890625
Epoch: 1, Steps: 89 | Train Loss: 1.705 Vali Loss: 0.584 Vali Acc: 0.859 Test Loss: 0.584 Test Acc: 0.859
Validation loss decreased (inf --> -0.858629).  Saving model ...
Epoch: 2 cost time: 3.8502089977264404
Epoch: 2, Steps: 89 | Train Loss: 0.406 Vali Loss: 0.278 Vali Acc: 0.934 Test Loss: 0.278 Test Acc: 0.934
Validation loss decreased (-0.858629 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 3.9980993270874023
Epoch: 3, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.933841 --> -0.948466).  Saving model ...
Epoch: 4 cost time: 3.887305736541748
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.157 Vali Acc: 0.961 Test Loss: 0.157 Test Acc: 0.961
Validation loss decreased (-0.948466 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 4.385486841201782
Epoch: 5, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.961001 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 4.207130193710327
Epoch: 6, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.604704856872559
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.968662 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 4.982280492782593
Epoch: 8, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.793949127197266
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.138 Vali Acc: 0.964 Test Loss: 0.138 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.5755205154418945
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.887832164764404
Epoch: 11, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.157 Vali Acc: 0.963 Test Loss: 0.157 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.5986855030059814
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.129 Vali Acc: 0.977 Test Loss: 0.129 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 13 cost time: 4.765429258346558
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.517486095428467
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.977018 --> -0.977018).  Saving model ...
Epoch: 15 cost time: 4.5147576332092285
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.155 Vali Acc: 0.971 Test Loss: 0.155 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.038311243057251
Epoch: 16, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.3195436000823975
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.132 Vali Acc: 0.975 Test Loss: 0.132 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.19415020942688
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.048492193222046
Epoch: 19, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.171 Vali Acc: 0.969 Test Loss: 0.171 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.984868764877319
Epoch: 20, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.456370830535889
Epoch: 21, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.180 Vali Acc: 0.968 Test Loss: 0.180 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.721324682235718
Epoch: 22, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.972 Test Loss: 0.173 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.258293628692627
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.973 Test Loss: 0.179 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.75715184211731
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 130156
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.3906450271606445
Epoch: 1, Steps: 89 | Train Loss: 1.702 Vali Loss: 0.578 Vali Acc: 0.857 Test Loss: 0.578 Test Acc: 0.857
Validation loss decreased (inf --> -0.857237).  Saving model ...
Epoch: 2 cost time: 5.101975202560425
Epoch: 2, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.274 Vali Acc: 0.932 Test Loss: 0.274 Test Acc: 0.932
Validation loss decreased (-0.857237 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 4.093964338302612
Epoch: 3, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
Validation loss decreased (-0.931752 --> -0.955430).  Saving model ...
Epoch: 4 cost time: 4.125118255615234
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.152 Vali Acc: 0.962 Test Loss: 0.152 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 4.722133636474609
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
Validation loss decreased (-0.962394 --> -0.968662).  Saving model ...
Epoch: 6 cost time: 4.9054834842681885
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.3386640548706055
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.123 Vali Acc: 0.971 Test Loss: 0.123 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 4.943126916885376
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.712126016616821
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.156 Vali Acc: 0.958 Test Loss: 0.156 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.748231410980225
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.403448581695557
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.957 Test Loss: 0.145 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.697448968887329
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 5.006924867630005
Epoch: 13, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.129 Vali Acc: 0.976 Test Loss: 0.129 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975625).  Saving model ...
Epoch: 14 cost time: 4.4730494022369385
Epoch: 14, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.2686545848846436
Epoch: 15, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.864072322845459
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.357759237289429
Epoch: 17, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.0485546588897705
Epoch: 18, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.139 Vali Acc: 0.974 Test Loss: 0.139 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.9963772296905518
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.912955045700073
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.055684804916382
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.813239574432373
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.185111999511719
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.211 Vali Acc: 0.967 Test Loss: 0.211 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 130156
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.981130361557007
Epoch: 1, Steps: 89 | Train Loss: 1.723 Vali Loss: 0.594 Vali Acc: 0.859 Test Loss: 0.594 Test Acc: 0.859
Validation loss decreased (inf --> -0.858629).  Saving model ...
Epoch: 2 cost time: 3.9409470558166504
Epoch: 2, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.274 Vali Acc: 0.931 Test Loss: 0.274 Test Acc: 0.931
Validation loss decreased (-0.858629 --> -0.931056).  Saving model ...
Epoch: 3 cost time: 3.7698888778686523
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.182 Vali Acc: 0.958 Test Loss: 0.182 Test Acc: 0.958
Validation loss decreased (-0.931056 --> -0.958215).  Saving model ...
Epoch: 4 cost time: 4.562850713729858
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.154 Vali Acc: 0.961 Test Loss: 0.154 Test Acc: 0.961
Validation loss decreased (-0.958215 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 4.062034368515015
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
Validation loss decreased (-0.961001 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 3.983905553817749
Epoch: 6, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.146 Vali Acc: 0.959 Test Loss: 0.146 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.46949028968811
Epoch: 7, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.5198655128479
Epoch: 8, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.113 Vali Acc: 0.971 Test Loss: 0.113 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 5.084430456161499
Epoch: 9, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.402040004730225
Epoch: 10, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.113 Vali Acc: 0.973 Test Loss: 0.113 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 4.525815963745117
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.114 Vali Acc: 0.976 Test Loss: 0.114 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 4.229234218597412
Epoch: 12, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.908701658248901
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.113 Vali Acc: 0.978 Test Loss: 0.113 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 4.088872671127319
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.122 Vali Acc: 0.975 Test Loss: 0.122 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8908257484436035
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.138 Vali Acc: 0.976 Test Loss: 0.138 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.4721715450286865
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.678740739822388
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.316962003707886
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.695075750350952
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.024089574813843
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.0119733810424805
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.156 Vali Acc: 0.973 Test Loss: 0.156 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.110455513000488
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.22996187210083
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981196).  Saving model ...
Epoch: 24 cost time: 4.8082804679870605
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.150 Vali Acc: 0.977 Test Loss: 0.150 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 4.400705814361572
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.138 Vali Acc: 0.981 Test Loss: 0.138 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 4.658656120300293
Epoch: 26, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.186 Vali Acc: 0.967 Test Loss: 0.186 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 4.529755115509033
Epoch: 27, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.968 Test Loss: 0.184 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 4.4416728019714355
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.072444438934326
Epoch: 29, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.166 Vali Acc: 0.969 Test Loss: 0.166 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.463904857635498
Epoch: 30, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.969 Test Loss: 0.179 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.224642992019653
Epoch: 31, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 4.709079742431641
Epoch: 32, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.146 Vali Acc: 0.978 Test Loss: 0.146 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 4.7533485889434814
Epoch: 33, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.238 Vali Acc: 0.964 Test Loss: 0.238 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 130156
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.94351863861084
Epoch: 1, Steps: 89 | Train Loss: 1.850 Vali Loss: 0.682 Vali Acc: 0.854 Test Loss: 0.682 Test Acc: 0.854
Validation loss decreased (inf --> -0.853754).  Saving model ...
Epoch: 2 cost time: 3.9414291381835938
Epoch: 2, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.290 Vali Acc: 0.926 Test Loss: 0.290 Test Acc: 0.926
Validation loss decreased (-0.853754 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 4.758675575256348
Epoch: 3, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.926181 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 4.374395847320557
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
Validation loss decreased (-0.951252 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 3.9939334392547607
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.135 Vali Acc: 0.964 Test Loss: 0.135 Test Acc: 0.964
Validation loss decreased (-0.963787 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 4.032568454742432
Epoch: 6, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.4145166873931885
Epoch: 7, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.134 Vali Acc: 0.963 Test Loss: 0.134 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.4752516746521
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.965 Test Loss: 0.144 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 3.9724862575531006
Epoch: 9, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.966572).  Saving model ...
Epoch: 10 cost time: 5.030866861343384
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.788214206695557
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.124 Vali Acc: 0.968 Test Loss: 0.124 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 12 cost time: 5.468487977981567
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.42322301864624
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 5.108746767044067
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.967 Test Loss: 0.157 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.511310338973999
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.157 Vali Acc: 0.972 Test Loss: 0.157 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 16 cost time: 3.92292857170105
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.160 Vali Acc: 0.967 Test Loss: 0.160 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.9178972244262695
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.972143 --> -0.972143).  Saving model ...
Epoch: 18 cost time: 4.3072733879089355
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.536667346954346
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.171 Vali Acc: 0.961 Test Loss: 0.171 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.048475742340088
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.17279314994812
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.951 Test Loss: 0.222 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.749150276184082
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.989654541015625
Epoch: 23, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.925739765167236
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
Validation loss decreased (-0.972143 --> -0.974929).  Saving model ...
Epoch: 25 cost time: 4.563971281051636
Epoch: 25, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 4.762051343917847
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 4.317626714706421
Epoch: 27, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.285 Vali Acc: 0.945 Test Loss: 0.285 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 4.478668689727783
Epoch: 28, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.160 Vali Acc: 0.973 Test Loss: 0.160 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 3.896773338317871
Epoch: 29, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.962 Test Loss: 0.197 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 4.3187994956970215
Epoch: 30, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.178 Vali Acc: 0.966 Test Loss: 0.178 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 4.469162464141846
Epoch: 31, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.955 Test Loss: 0.235 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 4.504298686981201
Epoch: 32, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 3.872692584991455
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 4.516249418258667
Epoch: 34, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.199 Vali Acc: 0.967 Test Loss: 0.199 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 130156
model size : 1.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.142261743545532
Epoch: 1, Steps: 89 | Train Loss: 0.921 Vali Loss: 0.595 Vali Acc: 0.875 Test Loss: 0.595 Test Acc: 0.875
Validation loss decreased (inf --> -0.874646).  Saving model ...
Epoch: 2 cost time: 4.436869144439697
Epoch: 2, Steps: 89 | Train Loss: 0.563 Vali Loss: 0.676 Vali Acc: 0.888 Test Loss: 0.676 Test Acc: 0.888
Validation loss decreased (-0.874646 --> -0.887876).  Saving model ...
Epoch: 3 cost time: 4.360069274902344
Epoch: 3, Steps: 89 | Train Loss: 0.549 Vali Loss: 0.503 Vali Acc: 0.941 Test Loss: 0.503 Test Acc: 0.941
Validation loss decreased (-0.887876 --> -0.940803).  Saving model ...
Epoch: 4 cost time: 4.217824697494507
Epoch: 4, Steps: 89 | Train Loss: 0.634 Vali Loss: 0.595 Vali Acc: 0.934 Test Loss: 0.595 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.9683773517608643
Epoch: 5, Steps: 89 | Train Loss: 0.436 Vali Loss: 0.621 Vali Acc: 0.950 Test Loss: 0.621 Test Acc: 0.950
Validation loss decreased (-0.940803 --> -0.949855).  Saving model ...
Epoch: 6 cost time: 3.942312479019165
Epoch: 6, Steps: 89 | Train Loss: 0.606 Vali Loss: 0.990 Vali Acc: 0.933 Test Loss: 0.990 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.17787504196167
Epoch: 7, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.991 Vali Acc: 0.922 Test Loss: 0.991 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.294873952865601
Epoch: 8, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.920 Vali Acc: 0.934 Test Loss: 0.920 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.181043863296509
Epoch: 9, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.783 Vali Acc: 0.957 Test Loss: 0.783 Test Acc: 0.957
Validation loss decreased (-0.949855 --> -0.956817).  Saving model ...
Epoch: 10 cost time: 4.246992111206055
Epoch: 10, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.910 Vali Acc: 0.951 Test Loss: 0.910 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.104365825653076
Epoch: 11, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.920 Vali Acc: 0.955 Test Loss: 0.920 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.554064512252808
Epoch: 12, Steps: 89 | Train Loss: 0.293 Vali Loss: 1.470 Vali Acc: 0.945 Test Loss: 1.470 Test Acc: 0.945
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.557617902755737
Epoch: 13, Steps: 89 | Train Loss: 0.250 Vali Loss: 1.632 Vali Acc: 0.933 Test Loss: 1.632 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.632624864578247
Epoch: 14, Steps: 89 | Train Loss: 0.413 Vali Loss: 1.290 Vali Acc: 0.939 Test Loss: 1.290 Test Acc: 0.939
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.5542051792144775
Epoch: 15, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.154 Vali Acc: 0.948 Test Loss: 1.154 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 4.529648542404175
Epoch: 16, Steps: 89 | Train Loss: 0.128 Vali Loss: 1.026 Vali Acc: 0.970 Test Loss: 1.026 Test Acc: 0.970
Validation loss decreased (-0.956817 --> -0.970045).  Saving model ...
Epoch: 17 cost time: 4.355759382247925
Epoch: 17, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.964 Vali Acc: 0.958 Test Loss: 0.964 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.1477673053741455
Epoch: 18, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.955 Vali Acc: 0.967 Test Loss: 0.955 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 4.187069892883301
Epoch: 19, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.818 Vali Acc: 0.972 Test Loss: 0.818 Test Acc: 0.972
Validation loss decreased (-0.970045 --> -0.972137).  Saving model ...
Epoch: 20 cost time: 4.385570049285889
Epoch: 20, Steps: 89 | Train Loss: 0.165 Vali Loss: 1.029 Vali Acc: 0.967 Test Loss: 1.029 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.265609264373779
Epoch: 21, Steps: 89 | Train Loss: 0.151 Vali Loss: 1.881 Vali Acc: 0.936 Test Loss: 1.881 Test Acc: 0.936
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.13394570350647
Epoch: 22, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.088 Vali Acc: 0.969 Test Loss: 1.088 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.257409334182739
Epoch: 23, Steps: 89 | Train Loss: 0.078 Vali Loss: 1.472 Vali Acc: 0.950 Test Loss: 1.472 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.5079686641693115
Epoch: 24, Steps: 89 | Train Loss: 0.145 Vali Loss: 1.331 Vali Acc: 0.956 Test Loss: 1.331 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.316763639450073
Epoch: 25, Steps: 89 | Train Loss: 0.042 Vali Loss: 1.494 Vali Acc: 0.946 Test Loss: 1.494 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.233035326004028
Epoch: 26, Steps: 89 | Train Loss: 0.294 Vali Loss: 2.194 Vali Acc: 0.934 Test Loss: 2.194 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.706416368484497
Epoch: 27, Steps: 89 | Train Loss: 0.233 Vali Loss: 1.438 Vali Acc: 0.958 Test Loss: 1.438 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.376305818557739
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 2.113 Vali Acc: 0.939 Test Loss: 2.113 Test Acc: 0.939
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.538937330245972
Epoch: 29, Steps: 89 | Train Loss: 0.232 Vali Loss: 2.046 Vali Acc: 0.947 Test Loss: 2.046 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 4498992
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.9630725383758545
Epoch: 1, Steps: 89 | Train Loss: 0.869 Vali Loss: 0.495 Vali Acc: 0.895 Test Loss: 0.495 Test Acc: 0.895
Validation loss decreased (inf --> -0.894842).  Saving model ...
Epoch: 2 cost time: 4.000596523284912
Epoch: 2, Steps: 89 | Train Loss: 0.554 Vali Loss: 0.580 Vali Acc: 0.922 Test Loss: 0.580 Test Acc: 0.922
Validation loss decreased (-0.894842 --> -0.922000).  Saving model ...
Epoch: 3 cost time: 3.9758312702178955
Epoch: 3, Steps: 89 | Train Loss: 0.503 Vali Loss: 0.695 Vali Acc: 0.912 Test Loss: 0.695 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.054436445236206
Epoch: 4, Steps: 89 | Train Loss: 0.381 Vali Loss: 0.454 Vali Acc: 0.956 Test Loss: 0.454 Test Acc: 0.956
Validation loss decreased (-0.922000 --> -0.956124).  Saving model ...
Epoch: 5 cost time: 4.259469032287598
Epoch: 5, Steps: 89 | Train Loss: 0.361 Vali Loss: 0.394 Vali Acc: 0.963 Test Loss: 0.394 Test Acc: 0.963
Validation loss decreased (-0.956124 --> -0.963088).  Saving model ...
Epoch: 6 cost time: 4.045864582061768
Epoch: 6, Steps: 89 | Train Loss: 0.505 Vali Loss: 0.856 Vali Acc: 0.928 Test Loss: 0.856 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.066357374191284
Epoch: 7, Steps: 89 | Train Loss: 0.388 Vali Loss: 0.720 Vali Acc: 0.954 Test Loss: 0.720 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9194936752319336
Epoch: 8, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.794 Vali Acc: 0.943 Test Loss: 0.794 Test Acc: 0.943
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.228657484054565
Epoch: 9, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.832 Vali Acc: 0.951 Test Loss: 0.832 Test Acc: 0.951
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.922973155975342
Epoch: 10, Steps: 89 | Train Loss: 0.289 Vali Loss: 1.158 Vali Acc: 0.944 Test Loss: 1.158 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.089697360992432
Epoch: 11, Steps: 89 | Train Loss: 0.315 Vali Loss: 1.163 Vali Acc: 0.936 Test Loss: 1.163 Test Acc: 0.936
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.10288143157959
Epoch: 12, Steps: 89 | Train Loss: 0.204 Vali Loss: 1.492 Vali Acc: 0.936 Test Loss: 1.492 Test Acc: 0.936
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.270586729049683
Epoch: 13, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.681 Vali Acc: 0.963 Test Loss: 0.681 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.524245500564575
Epoch: 14, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.886 Vali Acc: 0.946 Test Loss: 0.886 Test Acc: 0.946
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.113542318344116
Epoch: 15, Steps: 89 | Train Loss: 0.204 Vali Loss: 1.009 Vali Acc: 0.955 Test Loss: 1.009 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.963091922005571
model parameter : 4498992
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.354311466217041
Epoch: 1, Steps: 89 | Train Loss: 0.866 Vali Loss: 0.451 Vali Acc: 0.896 Test Loss: 0.451 Test Acc: 0.896
Validation loss decreased (inf --> -0.895539).  Saving model ...
Epoch: 2 cost time: 3.8129587173461914
Epoch: 2, Steps: 89 | Train Loss: 0.510 Vali Loss: 0.572 Vali Acc: 0.917 Test Loss: 0.572 Test Acc: 0.917
Validation loss decreased (-0.895539 --> -0.917125).  Saving model ...
Epoch: 3 cost time: 3.749528169631958
Epoch: 3, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.448 Vali Acc: 0.951 Test Loss: 0.448 Test Acc: 0.951
Validation loss decreased (-0.917125 --> -0.951249).  Saving model ...
Epoch: 4 cost time: 4.037770509719849
Epoch: 4, Steps: 89 | Train Loss: 0.469 Vali Loss: 0.661 Vali Acc: 0.925 Test Loss: 0.661 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.847447156906128
Epoch: 5, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.539 Vali Acc: 0.955 Test Loss: 0.539 Test Acc: 0.955
Validation loss decreased (-0.951249 --> -0.954730).  Saving model ...
Epoch: 6 cost time: 3.9736223220825195
Epoch: 6, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.790 Vali Acc: 0.936 Test Loss: 0.790 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.8994414806365967
Epoch: 7, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.517 Vali Acc: 0.964 Test Loss: 0.517 Test Acc: 0.964
Validation loss decreased (-0.954730 --> -0.964480).  Saving model ...
Epoch: 8 cost time: 3.771510362625122
Epoch: 8, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.398 Vali Acc: 0.970 Test Loss: 0.398 Test Acc: 0.970
Validation loss decreased (-0.964480 --> -0.970052).  Saving model ...
Epoch: 9 cost time: 4.085612058639526
Epoch: 9, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.656 Vali Acc: 0.961 Test Loss: 0.656 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.9790685176849365
Epoch: 10, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.906 Vali Acc: 0.944 Test Loss: 0.906 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.6194047927856445
Epoch: 11, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.719 Vali Acc: 0.964 Test Loss: 0.719 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9385275840759277
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.911 Vali Acc: 0.959 Test Loss: 0.911 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.87068772315979
Epoch: 13, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.901 Vali Acc: 0.965 Test Loss: 0.901 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.499735116958618
Epoch: 14, Steps: 89 | Train Loss: 0.228 Vali Loss: 1.054 Vali Acc: 0.950 Test Loss: 1.054 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.746426820755005
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 1.072 Vali Acc: 0.962 Test Loss: 1.072 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.959789276123047
Epoch: 16, Steps: 89 | Train Loss: 0.181 Vali Loss: 1.038 Vali Acc: 0.949 Test Loss: 1.038 Test Acc: 0.949
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.9417269229888916
Epoch: 17, Steps: 89 | Train Loss: 0.426 Vali Loss: 1.226 Vali Acc: 0.959 Test Loss: 1.226 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.860719680786133
Epoch: 18, Steps: 89 | Train Loss: 0.148 Vali Loss: 1.434 Vali Acc: 0.949 Test Loss: 1.434 Test Acc: 0.949
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 4498992
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.169651031494141
Epoch: 1, Steps: 89 | Train Loss: 0.826 Vali Loss: 0.559 Vali Acc: 0.877 Test Loss: 0.559 Test Acc: 0.877
Validation loss decreased (inf --> -0.877432).  Saving model ...
Epoch: 2 cost time: 3.514540910720825
Epoch: 2, Steps: 89 | Train Loss: 0.373 Vali Loss: 0.376 Vali Acc: 0.925 Test Loss: 0.376 Test Acc: 0.925
Validation loss decreased (-0.877432 --> -0.925484).  Saving model ...
Epoch: 3 cost time: 3.5595498085021973
Epoch: 3, Steps: 89 | Train Loss: 0.295 Vali Loss: 0.510 Vali Acc: 0.928 Test Loss: 0.510 Test Acc: 0.928
Validation loss decreased (-0.925484 --> -0.928268).  Saving model ...
Epoch: 4 cost time: 4.0034191608428955
Epoch: 4, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.436 Vali Acc: 0.939 Test Loss: 0.436 Test Acc: 0.939
Validation loss decreased (-0.928268 --> -0.938714).  Saving model ...
Epoch: 5 cost time: 3.904675006866455
Epoch: 5, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.384 Vali Acc: 0.959 Test Loss: 0.384 Test Acc: 0.959
Validation loss decreased (-0.938714 --> -0.958910).  Saving model ...
Epoch: 6 cost time: 3.7456183433532715
Epoch: 6, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.626 Vali Acc: 0.932 Test Loss: 0.626 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6827476024627686
Epoch: 7, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.446 Vali Acc: 0.956 Test Loss: 0.446 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7752363681793213
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.446 Vali Acc: 0.963 Test Loss: 0.446 Test Acc: 0.963
Validation loss decreased (-0.958910 --> -0.963087).  Saving model ...
Epoch: 9 cost time: 4.108360052108765
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.690 Vali Acc: 0.948 Test Loss: 0.690 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.6141765117645264
Epoch: 10, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.474 Vali Acc: 0.966 Test Loss: 0.474 Test Acc: 0.966
Validation loss decreased (-0.963087 --> -0.965873).  Saving model ...
Epoch: 11 cost time: 3.7132248878479004
Epoch: 11, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.593 Vali Acc: 0.953 Test Loss: 0.593 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7099318504333496
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.570 Vali Acc: 0.964 Test Loss: 0.570 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.633681297302246
Epoch: 13, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.833 Vali Acc: 0.955 Test Loss: 0.833 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.4887495040893555
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.424 Vali Acc: 0.974 Test Loss: 0.424 Test Acc: 0.974
Validation loss decreased (-0.965873 --> -0.973533).  Saving model ...
Epoch: 15 cost time: 3.367709159851074
Epoch: 15, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.915 Vali Acc: 0.950 Test Loss: 0.915 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.392789602279663
Epoch: 16, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.780 Vali Acc: 0.964 Test Loss: 0.780 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.743574857711792
Epoch: 17, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.702 Vali Acc: 0.966 Test Loss: 0.702 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.714982509613037
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.783 Vali Acc: 0.960 Test Loss: 0.783 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.564332962036133
Epoch: 19, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.655 Vali Acc: 0.965 Test Loss: 0.655 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9664933681488037
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.691 Vali Acc: 0.968 Test Loss: 0.691 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.9382050037384033
Epoch: 21, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.833 Vali Acc: 0.960 Test Loss: 0.833 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.7934141159057617
Epoch: 22, Steps: 89 | Train Loss: 0.082 Vali Loss: 1.137 Vali Acc: 0.964 Test Loss: 1.137 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.834735631942749
Epoch: 23, Steps: 89 | Train Loss: 0.091 Vali Loss: 1.794 Vali Acc: 0.935 Test Loss: 1.794 Test Acc: 0.935
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.903820037841797
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 1.148 Vali Acc: 0.962 Test Loss: 1.148 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 4498992
model size : 26.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.326553583145142
Epoch: 1, Steps: 89 | Train Loss: 0.961 Vali Loss: 0.820 Vali Acc: 0.835 Test Loss: 0.820 Test Acc: 0.835
Validation loss decreased (inf --> -0.834950).  Saving model ...
Epoch: 2 cost time: 3.861455202102661
Epoch: 2, Steps: 89 | Train Loss: 0.588 Vali Loss: 0.548 Vali Acc: 0.911 Test Loss: 0.548 Test Acc: 0.911
Validation loss decreased (-0.834950 --> -0.910858).  Saving model ...
Epoch: 3 cost time: 3.921057939529419
Epoch: 3, Steps: 89 | Train Loss: 0.506 Vali Loss: 1.013 Vali Acc: 0.861 Test Loss: 1.013 Test Acc: 0.861
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.075981855392456
Epoch: 4, Steps: 89 | Train Loss: 0.661 Vali Loss: 0.594 Vali Acc: 0.946 Test Loss: 0.594 Test Acc: 0.946
Validation loss decreased (-0.910858 --> -0.945677).  Saving model ...
Epoch: 5 cost time: 4.146803855895996
Epoch: 5, Steps: 89 | Train Loss: 0.543 Vali Loss: 1.073 Vali Acc: 0.915 Test Loss: 1.073 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.9472296237945557
Epoch: 6, Steps: 89 | Train Loss: 0.507 Vali Loss: 0.868 Vali Acc: 0.932 Test Loss: 0.868 Test Acc: 0.932
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.056217670440674
Epoch: 7, Steps: 89 | Train Loss: 0.312 Vali Loss: 0.598 Vali Acc: 0.958 Test Loss: 0.598 Test Acc: 0.958
Validation loss decreased (-0.945677 --> -0.958211).  Saving model ...
Epoch: 8 cost time: 3.9886839389801025
Epoch: 8, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.737 Vali Acc: 0.953 Test Loss: 0.737 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.480611324310303
Epoch: 9, Steps: 89 | Train Loss: 0.288 Vali Loss: 1.036 Vali Acc: 0.946 Test Loss: 1.036 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.361480474472046
Epoch: 10, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.871 Vali Acc: 0.958 Test Loss: 0.871 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.061360120773315
Epoch: 11, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.323 Vali Acc: 0.942 Test Loss: 1.323 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.3915088176727295
Epoch: 12, Steps: 89 | Train Loss: 0.188 Vali Loss: 1.127 Vali Acc: 0.943 Test Loss: 1.127 Test Acc: 0.943
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.351747751235962
Epoch: 13, Steps: 89 | Train Loss: 0.145 Vali Loss: 1.028 Vali Acc: 0.951 Test Loss: 1.028 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.6124753952026367
Epoch: 14, Steps: 89 | Train Loss: 0.227 Vali Loss: 1.168 Vali Acc: 0.957 Test Loss: 1.168 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 5.010748386383057
Epoch: 15, Steps: 89 | Train Loss: 0.185 Vali Loss: 1.004 Vali Acc: 0.959 Test Loss: 1.004 Test Acc: 0.959
Validation loss decreased (-0.958211 --> -0.958904).  Saving model ...
Epoch: 16 cost time: 4.799912929534912
Epoch: 16, Steps: 89 | Train Loss: 0.239 Vali Loss: 1.344 Vali Acc: 0.955 Test Loss: 1.344 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.144270181655884
Epoch: 17, Steps: 89 | Train Loss: 0.258 Vali Loss: 1.111 Vali Acc: 0.962 Test Loss: 1.111 Test Acc: 0.962
Validation loss decreased (-0.958904 --> -0.962384).  Saving model ...
Epoch: 18 cost time: 3.1470534801483154
Epoch: 18, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.924 Vali Acc: 0.972 Test Loss: 0.924 Test Acc: 0.972
Validation loss decreased (-0.962384 --> -0.972136).  Saving model ...
Epoch: 19 cost time: 3.9623756408691406
Epoch: 19, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.932 Vali Acc: 0.973 Test Loss: 0.932 Test Acc: 0.973
Validation loss decreased (-0.972136 --> -0.972832).  Saving model ...
Epoch: 20 cost time: 4.119644641876221
Epoch: 20, Steps: 89 | Train Loss: 0.386 Vali Loss: 1.303 Vali Acc: 0.949 Test Loss: 1.303 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.183666229248047
Epoch: 21, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.060 Vali Acc: 0.964 Test Loss: 1.060 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.095987796783447
Epoch: 22, Steps: 89 | Train Loss: 0.259 Vali Loss: 1.794 Vali Acc: 0.947 Test Loss: 1.794 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.192886829376221
Epoch: 23, Steps: 89 | Train Loss: 0.304 Vali Loss: 1.444 Vali Acc: 0.959 Test Loss: 1.444 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.080042362213135
Epoch: 24, Steps: 89 | Train Loss: 0.137 Vali Loss: 2.661 Vali Acc: 0.916 Test Loss: 2.661 Test Acc: 0.916
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.211047410964966
Epoch: 25, Steps: 89 | Train Loss: 0.122 Vali Loss: 1.308 Vali Acc: 0.962 Test Loss: 1.308 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.005589962005615
Epoch: 26, Steps: 89 | Train Loss: 0.155 Vali Loss: 2.192 Vali Acc: 0.939 Test Loss: 2.192 Test Acc: 0.939
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.450145721435547
Epoch: 27, Steps: 89 | Train Loss: 0.154 Vali Loss: 1.284 Vali Acc: 0.970 Test Loss: 1.284 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.501190423965454
Epoch: 28, Steps: 89 | Train Loss: 0.292 Vali Loss: 1.552 Vali Acc: 0.966 Test Loss: 1.552 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.662332534790039
Epoch: 29, Steps: 89 | Train Loss: 0.061 Vali Loss: 1.428 Vali Acc: 0.964 Test Loss: 1.428 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 3450416
model size : 22.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.708223342895508
Epoch: 1, Steps: 89 | Train Loss: 0.905 Vali Loss: 0.557 Vali Acc: 0.871 Test Loss: 0.557 Test Acc: 0.871
Validation loss decreased (inf --> -0.871164).  Saving model ...
Epoch: 2 cost time: 3.8909811973571777
Epoch: 2, Steps: 89 | Train Loss: 0.572 Vali Loss: 0.622 Vali Acc: 0.900 Test Loss: 0.622 Test Acc: 0.900
Validation loss decreased (-0.871164 --> -0.900412).  Saving model ...
Epoch: 3 cost time: 3.809410572052002
Epoch: 3, Steps: 89 | Train Loss: 0.475 Vali Loss: 0.786 Vali Acc: 0.909 Test Loss: 0.786 Test Acc: 0.909
Validation loss decreased (-0.900412 --> -0.908767).  Saving model ...
Epoch: 4 cost time: 3.873182535171509
Epoch: 4, Steps: 89 | Train Loss: 0.514 Vali Loss: 0.600 Vali Acc: 0.933 Test Loss: 0.600 Test Acc: 0.933
Validation loss decreased (-0.908767 --> -0.933142).  Saving model ...
Epoch: 5 cost time: 4.079266786575317
Epoch: 5, Steps: 89 | Train Loss: 0.398 Vali Loss: 1.020 Vali Acc: 0.919 Test Loss: 1.020 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.03826117515564
Epoch: 6, Steps: 89 | Train Loss: 0.471 Vali Loss: 0.720 Vali Acc: 0.943 Test Loss: 0.720 Test Acc: 0.943
Validation loss decreased (-0.933142 --> -0.942890).  Saving model ...
Epoch: 7 cost time: 3.9860827922821045
Epoch: 7, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.651 Vali Acc: 0.955 Test Loss: 0.651 Test Acc: 0.955
Validation loss decreased (-0.942890 --> -0.954729).  Saving model ...
Epoch: 8 cost time: 3.999114513397217
Epoch: 8, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.906 Vali Acc: 0.948 Test Loss: 0.906 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9156341552734375
Epoch: 9, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.903 Vali Acc: 0.945 Test Loss: 0.903 Test Acc: 0.945
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.8648006916046143
Epoch: 10, Steps: 89 | Train Loss: 0.304 Vali Loss: 1.011 Vali Acc: 0.955 Test Loss: 1.011 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.3274314403533936
Epoch: 11, Steps: 89 | Train Loss: 0.237 Vali Loss: 1.195 Vali Acc: 0.945 Test Loss: 1.195 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.255737543106079
Epoch: 12, Steps: 89 | Train Loss: 0.319 Vali Loss: 1.040 Vali Acc: 0.953 Test Loss: 1.040 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9041924476623535
Epoch: 13, Steps: 89 | Train Loss: 0.106 Vali Loss: 1.238 Vali Acc: 0.946 Test Loss: 1.238 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.034113883972168
Epoch: 14, Steps: 89 | Train Loss: 0.132 Vali Loss: 1.149 Vali Acc: 0.947 Test Loss: 1.149 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.394876956939697
Epoch: 15, Steps: 89 | Train Loss: 0.205 Vali Loss: 1.165 Vali Acc: 0.956 Test Loss: 1.165 Test Acc: 0.956
Validation loss decreased (-0.954729 --> -0.956116).  Saving model ...
Epoch: 16 cost time: 3.8585078716278076
Epoch: 16, Steps: 89 | Train Loss: 0.335 Vali Loss: 1.029 Vali Acc: 0.964 Test Loss: 1.029 Test Acc: 0.964
Validation loss decreased (-0.956116 --> -0.963778).  Saving model ...
Epoch: 17 cost time: 4.0662682056427
Epoch: 17, Steps: 89 | Train Loss: 0.221 Vali Loss: 0.917 Vali Acc: 0.971 Test Loss: 0.917 Test Acc: 0.971
Validation loss decreased (-0.963778 --> -0.971439).  Saving model ...
Epoch: 18 cost time: 3.880216598510742
Epoch: 18, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.891 Vali Acc: 0.972 Test Loss: 0.891 Test Acc: 0.972
Validation loss decreased (-0.971439 --> -0.972136).  Saving model ...
Epoch: 19 cost time: 3.8655200004577637
Epoch: 19, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.894 Vali Acc: 0.969 Test Loss: 0.894 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.9880247116088867
Epoch: 20, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.896 Vali Acc: 0.974 Test Loss: 0.896 Test Acc: 0.974
Validation loss decreased (-0.972136 --> -0.974225).  Saving model ...
Epoch: 21 cost time: 3.887481689453125
Epoch: 21, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.839 Vali Acc: 0.981 Test Loss: 0.839 Test Acc: 0.981
Validation loss decreased (-0.974225 --> -0.980493).  Saving model ...
Epoch: 22 cost time: 3.965517044067383
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 1.144 Vali Acc: 0.965 Test Loss: 1.144 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.958433151245117
Epoch: 23, Steps: 89 | Train Loss: 0.107 Vali Loss: 1.056 Vali Acc: 0.970 Test Loss: 1.056 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.913710355758667
Epoch: 24, Steps: 89 | Train Loss: 0.074 Vali Loss: 1.038 Vali Acc: 0.973 Test Loss: 1.038 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.120700120925903
Epoch: 25, Steps: 89 | Train Loss: 0.152 Vali Loss: 1.234 Vali Acc: 0.956 Test Loss: 1.234 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.327740669250488
Epoch: 26, Steps: 89 | Train Loss: 0.082 Vali Loss: 1.193 Vali Acc: 0.960 Test Loss: 1.193 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.76246976852417
Epoch: 27, Steps: 89 | Train Loss: 0.287 Vali Loss: 1.686 Vali Acc: 0.949 Test Loss: 1.686 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.9564778804779053
Epoch: 28, Steps: 89 | Train Loss: 0.301 Vali Loss: 1.436 Vali Acc: 0.955 Test Loss: 1.436 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.9512901306152344
Epoch: 29, Steps: 89 | Train Loss: 0.217 Vali Loss: 1.312 Vali Acc: 0.958 Test Loss: 1.312 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.6888439655303955
Epoch: 30, Steps: 89 | Train Loss: 0.209 Vali Loss: 1.970 Vali Acc: 0.949 Test Loss: 1.970 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.8354620933532715
Epoch: 31, Steps: 89 | Train Loss: 0.201 Vali Loss: 1.603 Vali Acc: 0.953 Test Loss: 1.603 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 3450416
model size : 22.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.109797477722168
Epoch: 1, Steps: 89 | Train Loss: 0.850 Vali Loss: 0.812 Vali Acc: 0.799 Test Loss: 0.812 Test Acc: 0.799
Validation loss decreased (inf --> -0.798738).  Saving model ...
Epoch: 2 cost time: 3.7574551105499268
Epoch: 2, Steps: 89 | Train Loss: 0.461 Vali Loss: 0.401 Vali Acc: 0.923 Test Loss: 0.401 Test Acc: 0.923
Validation loss decreased (-0.798738 --> -0.923394).  Saving model ...
Epoch: 3 cost time: 3.666172981262207
Epoch: 3, Steps: 89 | Train Loss: 0.350 Vali Loss: 0.764 Vali Acc: 0.903 Test Loss: 0.764 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.769055128097534
Epoch: 4, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.562 Vali Acc: 0.933 Test Loss: 0.562 Test Acc: 0.933
Validation loss decreased (-0.923394 --> -0.933142).  Saving model ...
Epoch: 5 cost time: 3.674718141555786
Epoch: 5, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.878 Vali Acc: 0.938 Test Loss: 0.878 Test Acc: 0.938
Validation loss decreased (-0.933142 --> -0.938014).  Saving model ...
Epoch: 6 cost time: 3.7899575233459473
Epoch: 6, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.693 Vali Acc: 0.939 Test Loss: 0.693 Test Acc: 0.939
Validation loss decreased (-0.938014 --> -0.938712).  Saving model ...
Epoch: 7 cost time: 4.060232877731323
Epoch: 7, Steps: 89 | Train Loss: 0.398 Vali Loss: 0.577 Vali Acc: 0.951 Test Loss: 0.577 Test Acc: 0.951
Validation loss decreased (-0.938712 --> -0.950551).  Saving model ...
Epoch: 8 cost time: 3.9069316387176514
Epoch: 8, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.618 Vali Acc: 0.962 Test Loss: 0.618 Test Acc: 0.962
Validation loss decreased (-0.950551 --> -0.962389).  Saving model ...
Epoch: 9 cost time: 3.994901418685913
Epoch: 9, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.751 Vali Acc: 0.965 Test Loss: 0.751 Test Acc: 0.965
Validation loss decreased (-0.962389 --> -0.965174).  Saving model ...
Epoch: 10 cost time: 4.273493766784668
Epoch: 10, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.001 Vali Acc: 0.947 Test Loss: 1.001 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.0942089557647705
Epoch: 11, Steps: 89 | Train Loss: 0.342 Vali Loss: 0.977 Vali Acc: 0.948 Test Loss: 0.977 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.005311965942383
Epoch: 12, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.824 Vali Acc: 0.956 Test Loss: 0.824 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.8798558712005615
Epoch: 13, Steps: 89 | Train Loss: 0.116 Vali Loss: 1.004 Vali Acc: 0.955 Test Loss: 1.004 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.8808741569519043
Epoch: 14, Steps: 89 | Train Loss: 0.120 Vali Loss: 1.775 Vali Acc: 0.910 Test Loss: 1.775 Test Acc: 0.910
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.8314216136932373
Epoch: 15, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.047 Vali Acc: 0.942 Test Loss: 1.047 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.744349718093872
Epoch: 16, Steps: 89 | Train Loss: 0.119 Vali Loss: 1.406 Vali Acc: 0.944 Test Loss: 1.406 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.7789220809936523
Epoch: 17, Steps: 89 | Train Loss: 0.261 Vali Loss: 1.098 Vali Acc: 0.951 Test Loss: 1.098 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.67431378364563
Epoch: 18, Steps: 89 | Train Loss: 0.102 Vali Loss: 1.140 Vali Acc: 0.960 Test Loss: 1.140 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.8598456382751465
Epoch: 19, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.890 Vali Acc: 0.965 Test Loss: 0.890 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9651810584958217
model parameter : 3450416
model size : 22.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.5169761180877686
Epoch: 1, Steps: 89 | Train Loss: 0.820 Vali Loss: 0.662 Vali Acc: 0.845 Test Loss: 0.662 Test Acc: 0.845
Validation loss decreased (inf --> -0.844701).  Saving model ...
Epoch: 2 cost time: 3.8340630531311035
Epoch: 2, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.474 Vali Acc: 0.890 Test Loss: 0.474 Test Acc: 0.890
Validation loss decreased (-0.844701 --> -0.889967).  Saving model ...
Epoch: 3 cost time: 3.4397847652435303
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.364 Vali Acc: 0.948 Test Loss: 0.364 Test Acc: 0.948
Validation loss decreased (-0.889967 --> -0.947768).  Saving model ...
Epoch: 4 cost time: 3.811335325241089
Epoch: 4, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.354 Vali Acc: 0.955 Test Loss: 0.354 Test Acc: 0.955
Validation loss decreased (-0.947768 --> -0.954732).  Saving model ...
Epoch: 5 cost time: 4.013052225112915
Epoch: 5, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.279 Vali Acc: 0.965 Test Loss: 0.279 Test Acc: 0.965
Validation loss decreased (-0.954732 --> -0.965178).  Saving model ...
Epoch: 6 cost time: 3.322021961212158
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.442 Vali Acc: 0.951 Test Loss: 0.442 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3977198600769043
Epoch: 7, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.421 Vali Acc: 0.954 Test Loss: 0.421 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.468925714492798
Epoch: 8, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.605 Vali Acc: 0.946 Test Loss: 0.605 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4535515308380127
Epoch: 9, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.786 Vali Acc: 0.948 Test Loss: 0.786 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.398606777191162
Epoch: 10, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.531 Vali Acc: 0.960 Test Loss: 0.531 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.4788100719451904
Epoch: 11, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.499 Vali Acc: 0.969 Test Loss: 0.499 Test Acc: 0.969
Validation loss decreased (-0.965178 --> -0.969354).  Saving model ...
Epoch: 12 cost time: 3.3423712253570557
Epoch: 12, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.686 Vali Acc: 0.958 Test Loss: 0.686 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.307985544204712
Epoch: 13, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.629 Vali Acc: 0.962 Test Loss: 0.629 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.488006353378296
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.544 Vali Acc: 0.964 Test Loss: 0.544 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.656716823577881
Epoch: 15, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.626 Vali Acc: 0.968 Test Loss: 0.626 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.828317642211914
Epoch: 16, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.702 Vali Acc: 0.953 Test Loss: 0.702 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.7960546016693115
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.707 Vali Acc: 0.962 Test Loss: 0.707 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.750100612640381
Epoch: 18, Steps: 89 | Train Loss: 0.159 Vali Loss: 1.034 Vali Acc: 0.950 Test Loss: 1.034 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.794471025466919
Epoch: 19, Steps: 89 | Train Loss: 0.146 Vali Loss: 1.060 Vali Acc: 0.955 Test Loss: 1.060 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.7460412979125977
Epoch: 20, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.656 Vali Acc: 0.961 Test Loss: 0.656 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.662782669067383
Epoch: 21, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.563 Vali Acc: 0.974 Test Loss: 0.563 Test Acc: 0.974
Validation loss decreased (-0.969354 --> -0.974228).  Saving model ...
Epoch: 22 cost time: 3.47076416015625
Epoch: 22, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.851 Vali Acc: 0.962 Test Loss: 0.851 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.5525875091552734
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.693 Vali Acc: 0.977 Test Loss: 0.693 Test Acc: 0.977
Validation loss decreased (-0.974228 --> -0.977013).  Saving model ...
Epoch: 24 cost time: 3.48636794090271
Epoch: 24, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.959 Vali Acc: 0.953 Test Loss: 0.959 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4905569553375244
Epoch: 25, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.956 Vali Acc: 0.964 Test Loss: 0.956 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.54313588142395
Epoch: 26, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.800 Vali Acc: 0.971 Test Loss: 0.800 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.436671495437622
Epoch: 27, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.823 Vali Acc: 0.971 Test Loss: 0.823 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.3377859592437744
Epoch: 28, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.975 Vali Acc: 0.967 Test Loss: 0.975 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 3.5693297386169434
Epoch: 29, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.876 Vali Acc: 0.967 Test Loss: 0.876 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 3.6042065620422363
Epoch: 30, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.953 Vali Acc: 0.966 Test Loss: 0.953 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 3.753751754760742
Epoch: 31, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.998 Vali Acc: 0.958 Test Loss: 0.998 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.6593198776245117
Epoch: 32, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.806 Vali Acc: 0.976 Test Loss: 0.806 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.485475540161133
Epoch: 33, Steps: 89 | Train Loss: 0.048 Vali Loss: 1.176 Vali Acc: 0.961 Test Loss: 1.176 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 3450416
model size : 22.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.086642742156982
Epoch: 1, Steps: 89 | Train Loss: 0.848 Vali Loss: 0.442 Vali Acc: 0.890 Test Loss: 0.442 Test Acc: 0.890
Validation loss decreased (inf --> -0.889968).  Saving model ...
Epoch: 2 cost time: 4.112209320068359
Epoch: 2, Steps: 89 | Train Loss: 0.698 Vali Loss: 0.572 Vali Acc: 0.923 Test Loss: 0.572 Test Acc: 0.923
Validation loss decreased (-0.889968 --> -0.922696).  Saving model ...
Epoch: 3 cost time: 4.1132330894470215
Epoch: 3, Steps: 89 | Train Loss: 0.444 Vali Loss: 0.688 Vali Acc: 0.912 Test Loss: 0.688 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.209898233413696
Epoch: 4, Steps: 89 | Train Loss: 0.559 Vali Loss: 0.761 Vali Acc: 0.927 Test Loss: 0.761 Test Acc: 0.927
Validation loss decreased (-0.922696 --> -0.926873).  Saving model ...
Epoch: 5 cost time: 4.0139665603637695
Epoch: 5, Steps: 89 | Train Loss: 0.552 Vali Loss: 0.570 Vali Acc: 0.939 Test Loss: 0.570 Test Acc: 0.939
Validation loss decreased (-0.926873 --> -0.939409).  Saving model ...
Epoch: 6 cost time: 4.164384841918945
Epoch: 6, Steps: 89 | Train Loss: 0.460 Vali Loss: 1.378 Vali Acc: 0.916 Test Loss: 1.378 Test Acc: 0.916
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.240239143371582
Epoch: 7, Steps: 89 | Train Loss: 0.487 Vali Loss: 1.330 Vali Acc: 0.902 Test Loss: 1.330 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.078853368759155
Epoch: 8, Steps: 89 | Train Loss: 0.408 Vali Loss: 0.742 Vali Acc: 0.958 Test Loss: 0.742 Test Acc: 0.958
Validation loss decreased (-0.939409 --> -0.958210).  Saving model ...
Epoch: 9 cost time: 4.25651216506958
Epoch: 9, Steps: 89 | Train Loss: 0.280 Vali Loss: 1.159 Vali Acc: 0.932 Test Loss: 1.159 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.102747678756714
Epoch: 10, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.772 Vali Acc: 0.958 Test Loss: 0.772 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.547506809234619
Epoch: 11, Steps: 89 | Train Loss: 0.272 Vali Loss: 1.724 Vali Acc: 0.927 Test Loss: 1.724 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.4979681968688965
Epoch: 12, Steps: 89 | Train Loss: 0.223 Vali Loss: 1.089 Vali Acc: 0.963 Test Loss: 1.089 Test Acc: 0.963
Validation loss decreased (-0.958210 --> -0.963081).  Saving model ...
Epoch: 13 cost time: 4.4004271030426025
Epoch: 13, Steps: 89 | Train Loss: 0.289 Vali Loss: 1.265 Vali Acc: 0.951 Test Loss: 1.265 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.279476881027222
Epoch: 14, Steps: 89 | Train Loss: 0.227 Vali Loss: 1.353 Vali Acc: 0.944 Test Loss: 1.353 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.6121485233306885
Epoch: 15, Steps: 89 | Train Loss: 0.132 Vali Loss: 1.252 Vali Acc: 0.951 Test Loss: 1.252 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.728000640869141
Epoch: 16, Steps: 89 | Train Loss: 0.163 Vali Loss: 1.409 Vali Acc: 0.945 Test Loss: 1.409 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.1241066455841064
Epoch: 17, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.177 Vali Acc: 0.958 Test Loss: 1.177 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 4.058601379394531
Epoch: 18, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.944 Vali Acc: 0.964 Test Loss: 0.944 Test Acc: 0.964
Validation loss decreased (-0.963081 --> -0.963779).  Saving model ...
Epoch: 19 cost time: 4.137248516082764
Epoch: 19, Steps: 89 | Train Loss: 0.149 Vali Loss: 1.116 Vali Acc: 0.946 Test Loss: 1.116 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.262365341186523
Epoch: 20, Steps: 89 | Train Loss: 0.150 Vali Loss: 1.265 Vali Acc: 0.964 Test Loss: 1.265 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 4.182980537414551
Epoch: 21, Steps: 89 | Train Loss: 0.340 Vali Loss: 2.168 Vali Acc: 0.927 Test Loss: 2.168 Test Acc: 0.927
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.146533489227295
Epoch: 22, Steps: 89 | Train Loss: 0.253 Vali Loss: 1.977 Vali Acc: 0.932 Test Loss: 1.977 Test Acc: 0.932
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 4.114985942840576
Epoch: 23, Steps: 89 | Train Loss: 0.286 Vali Loss: 2.669 Vali Acc: 0.930 Test Loss: 2.669 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 4.2011096477508545
Epoch: 24, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.574 Vali Acc: 0.952 Test Loss: 1.574 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.887282371520996
Epoch: 25, Steps: 89 | Train Loss: 0.154 Vali Loss: 1.143 Vali Acc: 0.964 Test Loss: 1.143 Test Acc: 0.964
Validation loss decreased (-0.963779 --> -0.964473).  Saving model ...
Epoch: 26 cost time: 4.517108201980591
Epoch: 26, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.994 Vali Acc: 0.973 Test Loss: 0.994 Test Acc: 0.973
Validation loss decreased (-0.964473 --> -0.972831).  Saving model ...
Epoch: 27 cost time: 4.5105226039886475
Epoch: 27, Steps: 89 | Train Loss: 0.090 Vali Loss: 1.040 Vali Acc: 0.976 Test Loss: 1.040 Test Acc: 0.976
Validation loss decreased (-0.972831 --> -0.975616).  Saving model ...
Epoch: 28 cost time: 4.235859394073486
Epoch: 28, Steps: 89 | Train Loss: 0.144 Vali Loss: 1.509 Vali Acc: 0.943 Test Loss: 1.509 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.308220148086548
Epoch: 29, Steps: 89 | Train Loss: 0.089 Vali Loss: 1.108 Vali Acc: 0.964 Test Loss: 1.108 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.475115537643433
Epoch: 30, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.892 Vali Acc: 0.976 Test Loss: 0.892 Test Acc: 0.976
Validation loss decreased (-0.975616 --> -0.976314).  Saving model ...
Epoch: 31 cost time: 4.04054594039917
Epoch: 31, Steps: 89 | Train Loss: 0.068 Vali Loss: 1.399 Vali Acc: 0.955 Test Loss: 1.399 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 4.210514307022095
Epoch: 32, Steps: 89 | Train Loss: 0.231 Vali Loss: 1.219 Vali Acc: 0.970 Test Loss: 1.219 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 4.219000577926636
Epoch: 33, Steps: 89 | Train Loss: 0.127 Vali Loss: 1.123 Vali Acc: 0.968 Test Loss: 1.123 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 4.1453776359558105
Epoch: 34, Steps: 89 | Train Loss: 0.040 Vali Loss: 1.229 Vali Acc: 0.971 Test Loss: 1.229 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 4.253966331481934
Epoch: 35, Steps: 89 | Train Loss: 0.033 Vali Loss: 1.057 Vali Acc: 0.967 Test Loss: 1.057 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 4.21816611289978
Epoch: 36, Steps: 89 | Train Loss: 0.091 Vali Loss: 1.381 Vali Acc: 0.958 Test Loss: 1.381 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 4.056105375289917
Epoch: 37, Steps: 89 | Train Loss: 0.062 Vali Loss: 1.194 Vali Acc: 0.974 Test Loss: 1.194 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 4.070114374160767
Epoch: 38, Steps: 89 | Train Loss: 0.112 Vali Loss: 1.546 Vali Acc: 0.961 Test Loss: 1.546 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 4.206410884857178
Epoch: 39, Steps: 89 | Train Loss: 0.106 Vali Loss: 1.418 Vali Acc: 0.958 Test Loss: 1.418 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 4.326319217681885
Epoch: 40, Steps: 89 | Train Loss: 0.094 Vali Loss: 1.799 Vali Acc: 0.962 Test Loss: 1.799 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 2926128
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.5509867668151855
Epoch: 1, Steps: 89 | Train Loss: 0.821 Vali Loss: 0.534 Vali Acc: 0.864 Test Loss: 0.534 Test Acc: 0.864
Validation loss decreased (inf --> -0.863504).  Saving model ...
Epoch: 2 cost time: 4.164551496505737
Epoch: 2, Steps: 89 | Train Loss: 0.655 Vali Loss: 0.633 Vali Acc: 0.890 Test Loss: 0.633 Test Acc: 0.890
Validation loss decreased (-0.863504 --> -0.889966).  Saving model ...
Epoch: 3 cost time: 4.055451154708862
Epoch: 3, Steps: 89 | Train Loss: 0.451 Vali Loss: 0.530 Vali Acc: 0.936 Test Loss: 0.530 Test Acc: 0.936
Validation loss decreased (-0.889966 --> -0.935928).  Saving model ...
Epoch: 4 cost time: 3.7518064975738525
Epoch: 4, Steps: 89 | Train Loss: 0.346 Vali Loss: 0.848 Vali Acc: 0.921 Test Loss: 0.848 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.606117010116577
Epoch: 5, Steps: 89 | Train Loss: 0.456 Vali Loss: 0.913 Vali Acc: 0.917 Test Loss: 0.913 Test Acc: 0.917
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.721376657485962
Epoch: 6, Steps: 89 | Train Loss: 0.343 Vali Loss: 0.773 Vali Acc: 0.945 Test Loss: 0.773 Test Acc: 0.945
Validation loss decreased (-0.935928 --> -0.944978).  Saving model ...
Epoch: 7 cost time: 3.717963933944702
Epoch: 7, Steps: 89 | Train Loss: 0.299 Vali Loss: 0.768 Vali Acc: 0.944 Test Loss: 0.768 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.650973320007324
Epoch: 8, Steps: 89 | Train Loss: 0.418 Vali Loss: 1.301 Vali Acc: 0.912 Test Loss: 1.301 Test Acc: 0.912
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9575068950653076
Epoch: 9, Steps: 89 | Train Loss: 0.334 Vali Loss: 0.728 Vali Acc: 0.958 Test Loss: 0.728 Test Acc: 0.958
Validation loss decreased (-0.944978 --> -0.957514).  Saving model ...
Epoch: 10 cost time: 3.849062442779541
Epoch: 10, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.983 Vali Acc: 0.948 Test Loss: 0.983 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.8167691230773926
Epoch: 11, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.960 Vali Acc: 0.958 Test Loss: 0.960 Test Acc: 0.958
Validation loss decreased (-0.957514 --> -0.958208).  Saving model ...
Epoch: 12 cost time: 3.9677953720092773
Epoch: 12, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.991 Vali Acc: 0.958 Test Loss: 0.991 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.9919564723968506
Epoch: 13, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.879 Vali Acc: 0.962 Test Loss: 0.879 Test Acc: 0.962
Validation loss decreased (-0.958208 --> -0.962387).  Saving model ...
Epoch: 14 cost time: 4.015060186386108
Epoch: 14, Steps: 89 | Train Loss: 0.204 Vali Loss: 1.612 Vali Acc: 0.929 Test Loss: 1.612 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.238670349121094
Epoch: 15, Steps: 89 | Train Loss: 0.365 Vali Loss: 1.202 Vali Acc: 0.953 Test Loss: 1.202 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.1677680015563965
Epoch: 16, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.851 Vali Acc: 0.965 Test Loss: 0.851 Test Acc: 0.965
Validation loss decreased (-0.962387 --> -0.965173).  Saving model ...
Epoch: 17 cost time: 4.33241605758667
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 1.260 Vali Acc: 0.952 Test Loss: 1.260 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.292297601699829
Epoch: 18, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.947 Vali Acc: 0.967 Test Loss: 0.947 Test Acc: 0.967
Validation loss decreased (-0.965173 --> -0.966564).  Saving model ...
Epoch: 19 cost time: 4.017090320587158
Epoch: 19, Steps: 89 | Train Loss: 0.203 Vali Loss: 1.086 Vali Acc: 0.961 Test Loss: 1.086 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.8312571048736572
Epoch: 20, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.873 Vali Acc: 0.969 Test Loss: 0.873 Test Acc: 0.969
Validation loss decreased (-0.966564 --> -0.968654).  Saving model ...
Epoch: 21 cost time: 3.7653582096099854
Epoch: 21, Steps: 89 | Train Loss: 0.233 Vali Loss: 1.254 Vali Acc: 0.958 Test Loss: 1.254 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.973501205444336
Epoch: 22, Steps: 89 | Train Loss: 0.222 Vali Loss: 1.378 Vali Acc: 0.956 Test Loss: 1.378 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.8580517768859863
Epoch: 23, Steps: 89 | Train Loss: 0.230 Vali Loss: 1.246 Vali Acc: 0.959 Test Loss: 1.246 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.9342474937438965
Epoch: 24, Steps: 89 | Train Loss: 0.134 Vali Loss: 1.160 Vali Acc: 0.962 Test Loss: 1.160 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.934616804122925
Epoch: 25, Steps: 89 | Train Loss: 0.033 Vali Loss: 1.338 Vali Acc: 0.962 Test Loss: 1.338 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.8937175273895264
Epoch: 26, Steps: 89 | Train Loss: 0.156 Vali Loss: 1.436 Vali Acc: 0.960 Test Loss: 1.436 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.583940029144287
Epoch: 27, Steps: 89 | Train Loss: 0.041 Vali Loss: 1.622 Vali Acc: 0.957 Test Loss: 1.622 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.826381206512451
Epoch: 28, Steps: 89 | Train Loss: 0.229 Vali Loss: 3.661 Vali Acc: 0.913 Test Loss: 3.661 Test Acc: 0.913
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.384801149368286
Epoch: 29, Steps: 89 | Train Loss: 0.132 Vali Loss: 1.402 Vali Acc: 0.962 Test Loss: 1.402 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.163601398468018
Epoch: 30, Steps: 89 | Train Loss: 0.175 Vali Loss: 1.383 Vali Acc: 0.971 Test Loss: 1.383 Test Acc: 0.971
Validation loss decreased (-0.968654 --> -0.970738).  Saving model ...
Epoch: 31 cost time: 4.244546890258789
Epoch: 31, Steps: 89 | Train Loss: 0.242 Vali Loss: 1.109 Vali Acc: 0.973 Test Loss: 1.109 Test Acc: 0.973
Validation loss decreased (-0.970738 --> -0.972830).  Saving model ...
Epoch: 32 cost time: 4.1518895626068115
Epoch: 32, Steps: 89 | Train Loss: 0.090 Vali Loss: 1.496 Vali Acc: 0.963 Test Loss: 1.496 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 4.408872127532959
Epoch: 33, Steps: 89 | Train Loss: 0.143 Vali Loss: 1.536 Vali Acc: 0.964 Test Loss: 1.536 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 4.306581974029541
Epoch: 34, Steps: 89 | Train Loss: 0.112 Vali Loss: 2.296 Vali Acc: 0.944 Test Loss: 2.296 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 3.7833847999572754
Epoch: 35, Steps: 89 | Train Loss: 0.163 Vali Loss: 1.719 Vali Acc: 0.958 Test Loss: 1.719 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 3.823408603668213
Epoch: 36, Steps: 89 | Train Loss: 0.059 Vali Loss: 1.502 Vali Acc: 0.960 Test Loss: 1.502 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 3.940908193588257
Epoch: 37, Steps: 89 | Train Loss: 0.140 Vali Loss: 1.491 Vali Acc: 0.967 Test Loss: 1.491 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 3.7313802242279053
Epoch: 38, Steps: 89 | Train Loss: 0.243 Vali Loss: 1.790 Vali Acc: 0.955 Test Loss: 1.790 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 3.855408191680908
Epoch: 39, Steps: 89 | Train Loss: 0.056 Vali Loss: 2.064 Vali Acc: 0.951 Test Loss: 2.064 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 3.8116793632507324
Epoch: 40, Steps: 89 | Train Loss: 0.020 Vali Loss: 1.572 Vali Acc: 0.965 Test Loss: 1.572 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 4.035084247589111
Epoch: 41, Steps: 89 | Train Loss: 0.043 Vali Loss: 1.722 Vali Acc: 0.960 Test Loss: 1.722 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 2926128
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.446877717971802
Epoch: 1, Steps: 89 | Train Loss: 0.776 Vali Loss: 0.444 Vali Acc: 0.886 Test Loss: 0.444 Test Acc: 0.886
Validation loss decreased (inf --> -0.886486).  Saving model ...
Epoch: 2 cost time: 4.1849164962768555
Epoch: 2, Steps: 89 | Train Loss: 0.448 Vali Loss: 0.337 Vali Acc: 0.941 Test Loss: 0.337 Test Acc: 0.941
Validation loss decreased (-0.886486 --> -0.940804).  Saving model ...
Epoch: 3 cost time: 3.889202833175659
Epoch: 3, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.418 Vali Acc: 0.946 Test Loss: 0.418 Test Acc: 0.946
Validation loss decreased (-0.940804 --> -0.945678).  Saving model ...
Epoch: 4 cost time: 3.856398582458496
Epoch: 4, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.387 Vali Acc: 0.956 Test Loss: 0.387 Test Acc: 0.956
Validation loss decreased (-0.945678 --> -0.956124).  Saving model ...
Epoch: 5 cost time: 3.8448128700256348
Epoch: 5, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.795 Vali Acc: 0.936 Test Loss: 0.795 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.209176778793335
Epoch: 6, Steps: 89 | Train Loss: 0.372 Vali Loss: 0.570 Vali Acc: 0.949 Test Loss: 0.570 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4369008541107178
Epoch: 7, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.671 Vali Acc: 0.951 Test Loss: 0.671 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.573871374130249
Epoch: 8, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.654 Vali Acc: 0.955 Test Loss: 0.654 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.649040699005127
Epoch: 9, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.890 Vali Acc: 0.954 Test Loss: 0.890 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.693225383758545
Epoch: 10, Steps: 89 | Train Loss: 0.339 Vali Loss: 1.581 Vali Acc: 0.923 Test Loss: 1.581 Test Acc: 0.923
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.699570655822754
Epoch: 11, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.670 Vali Acc: 0.966 Test Loss: 0.670 Test Acc: 0.966
Validation loss decreased (-0.956124 --> -0.965871).  Saving model ...
Epoch: 12 cost time: 3.5662083625793457
Epoch: 12, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.112 Vali Acc: 0.933 Test Loss: 1.112 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.5858633518218994
Epoch: 13, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.624 Vali Acc: 0.973 Test Loss: 0.624 Test Acc: 0.973
Validation loss decreased (-0.965871 --> -0.972835).  Saving model ...
Epoch: 14 cost time: 3.710280656814575
Epoch: 14, Steps: 89 | Train Loss: 0.144 Vali Loss: 1.019 Vali Acc: 0.953 Test Loss: 1.019 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7184855937957764
Epoch: 15, Steps: 89 | Train Loss: 0.257 Vali Loss: 0.759 Vali Acc: 0.967 Test Loss: 0.759 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.6924333572387695
Epoch: 16, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.980 Vali Acc: 0.951 Test Loss: 0.980 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.981724977493286
Epoch: 17, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.968 Vali Acc: 0.959 Test Loss: 0.968 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.175583600997925
Epoch: 18, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.857 Vali Acc: 0.974 Test Loss: 0.857 Test Acc: 0.974
Validation loss decreased (-0.972835 --> -0.973529).  Saving model ...
Epoch: 19 cost time: 3.540949821472168
Epoch: 19, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.765 Vali Acc: 0.974 Test Loss: 0.765 Test Acc: 0.974
Validation loss decreased (-0.973529 --> -0.973530).  Saving model ...
Epoch: 20 cost time: 3.607909679412842
Epoch: 20, Steps: 89 | Train Loss: 0.108 Vali Loss: 1.228 Vali Acc: 0.950 Test Loss: 1.228 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.080162048339844
Epoch: 21, Steps: 89 | Train Loss: 0.099 Vali Loss: 1.125 Vali Acc: 0.959 Test Loss: 1.125 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 4.106080055236816
Epoch: 22, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.852 Vali Acc: 0.976 Test Loss: 0.852 Test Acc: 0.976
Validation loss decreased (-0.973530 --> -0.976315).  Saving model ...
Epoch: 23 cost time: 3.6172373294830322
Epoch: 23, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.817 Vali Acc: 0.976 Test Loss: 0.817 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.7089755535125732
Epoch: 24, Steps: 89 | Train Loss: 0.069 Vali Loss: 1.209 Vali Acc: 0.964 Test Loss: 1.209 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.6797189712524414
Epoch: 25, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.913 Vali Acc: 0.976 Test Loss: 0.913 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.811724901199341
Epoch: 26, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.999 Vali Acc: 0.970 Test Loss: 0.999 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.6833255290985107
Epoch: 27, Steps: 89 | Train Loss: 0.084 Vali Loss: 1.174 Vali Acc: 0.969 Test Loss: 1.174 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.781778573989868
Epoch: 28, Steps: 89 | Train Loss: 0.082 Vali Loss: 1.203 Vali Acc: 0.967 Test Loss: 1.203 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.5382931232452393
Epoch: 29, Steps: 89 | Train Loss: 0.289 Vali Loss: 1.174 Vali Acc: 0.964 Test Loss: 1.174 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.636087656021118
Epoch: 30, Steps: 89 | Train Loss: 0.211 Vali Loss: 1.383 Vali Acc: 0.954 Test Loss: 1.383 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.770784378051758
Epoch: 31, Steps: 89 | Train Loss: 0.104 Vali Loss: 1.420 Vali Acc: 0.955 Test Loss: 1.420 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 4.08375883102417
Epoch: 32, Steps: 89 | Train Loss: 0.100 Vali Loss: 1.022 Vali Acc: 0.974 Test Loss: 1.022 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 2926128
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.889345169067383
Epoch: 1, Steps: 89 | Train Loss: 0.792 Vali Loss: 0.371 Vali Acc: 0.907 Test Loss: 0.371 Test Acc: 0.907
Validation loss decreased (inf --> -0.907378).  Saving model ...
Epoch: 2 cost time: 3.674136161804199
Epoch: 2, Steps: 89 | Train Loss: 0.313 Vali Loss: 0.429 Vali Acc: 0.907 Test Loss: 0.429 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.7337355613708496
Epoch: 3, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.354 Vali Acc: 0.929 Test Loss: 0.354 Test Acc: 0.929
Validation loss decreased (-0.907378 --> -0.928966).  Saving model ...
Epoch: 4 cost time: 3.7457258701324463
Epoch: 4, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.329 Vali Acc: 0.961 Test Loss: 0.329 Test Acc: 0.961
Validation loss decreased (-0.928966 --> -0.961000).  Saving model ...
Epoch: 5 cost time: 3.2587966918945312
Epoch: 5, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.695 Vali Acc: 0.938 Test Loss: 0.695 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.445971965789795
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.570 Vali Acc: 0.944 Test Loss: 0.570 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.42336368560791
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.671 Vali Acc: 0.935 Test Loss: 0.671 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.2637181282043457
Epoch: 8, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.476 Vali Acc: 0.967 Test Loss: 0.476 Test Acc: 0.967
Validation loss decreased (-0.961000 --> -0.966569).  Saving model ...
Epoch: 9 cost time: 3.4205944538116455
Epoch: 9, Steps: 89 | Train Loss: 0.179 Vali Loss: 0.500 Vali Acc: 0.964 Test Loss: 0.500 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.228634834289551
Epoch: 10, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.434 Vali Acc: 0.964 Test Loss: 0.434 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3356592655181885
Epoch: 11, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.453 Vali Acc: 0.969 Test Loss: 0.453 Test Acc: 0.969
Validation loss decreased (-0.966569 --> -0.969355).  Saving model ...
Epoch: 12 cost time: 3.2387044429779053
Epoch: 12, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.507 Vali Acc: 0.967 Test Loss: 0.507 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3242740631103516
Epoch: 13, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.472 Vali Acc: 0.969 Test Loss: 0.472 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0460925102233887
Epoch: 14, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.437 Vali Acc: 0.971 Test Loss: 0.437 Test Acc: 0.971
Validation loss decreased (-0.969355 --> -0.970748).  Saving model ...
Epoch: 15 cost time: 3.562408685684204
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.735 Vali Acc: 0.942 Test Loss: 0.735 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.630171298980713
Epoch: 16, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.719 Vali Acc: 0.961 Test Loss: 0.719 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.7206554412841797
Epoch: 17, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.971 Vali Acc: 0.964 Test Loss: 0.971 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.780333995819092
Epoch: 18, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.614 Vali Acc: 0.963 Test Loss: 0.614 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.6381235122680664
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.685 Vali Acc: 0.957 Test Loss: 0.685 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.6620075702667236
Epoch: 20, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.708 Vali Acc: 0.967 Test Loss: 0.708 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.316157341003418
Epoch: 21, Steps: 89 | Train Loss: 0.129 Vali Loss: 1.151 Vali Acc: 0.942 Test Loss: 1.151 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.446887731552124
Epoch: 22, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.840 Vali Acc: 0.963 Test Loss: 0.840 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.5314323902130127
Epoch: 23, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.982 Vali Acc: 0.958 Test Loss: 0.982 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.369067430496216
Epoch: 24, Steps: 89 | Train Loss: 0.114 Vali Loss: 1.068 Vali Acc: 0.955 Test Loss: 1.068 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 2926128
model size : 20.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.399343490600586
Epoch: 1, Steps: 89 | Train Loss: 0.957 Vali Loss: 0.502 Vali Acc: 0.862 Test Loss: 0.502 Test Acc: 0.862
Validation loss decreased (inf --> -0.862112).  Saving model ...
Epoch: 2 cost time: 3.85498046875
Epoch: 2, Steps: 89 | Train Loss: 0.521 Vali Loss: 1.306 Vali Acc: 0.866 Test Loss: 1.306 Test Acc: 0.866
Validation loss decreased (-0.862112 --> -0.866282).  Saving model ...
Epoch: 3 cost time: 3.843737840652466
Epoch: 3, Steps: 89 | Train Loss: 0.573 Vali Loss: 0.549 Vali Acc: 0.930 Test Loss: 0.549 Test Acc: 0.930
Validation loss decreased (-0.866282 --> -0.930357).  Saving model ...
Epoch: 4 cost time: 3.7936596870422363
Epoch: 4, Steps: 89 | Train Loss: 0.553 Vali Loss: 1.156 Vali Acc: 0.882 Test Loss: 1.156 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.233865022659302
Epoch: 5, Steps: 89 | Train Loss: 0.315 Vali Loss: 1.129 Vali Acc: 0.902 Test Loss: 1.129 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.3825767040252686
Epoch: 6, Steps: 89 | Train Loss: 0.509 Vali Loss: 0.969 Vali Acc: 0.938 Test Loss: 0.969 Test Acc: 0.938
Validation loss decreased (-0.930357 --> -0.938013).  Saving model ...
Epoch: 7 cost time: 4.173299312591553
Epoch: 7, Steps: 89 | Train Loss: 0.425 Vali Loss: 0.867 Vali Acc: 0.946 Test Loss: 0.867 Test Acc: 0.946
Validation loss decreased (-0.938013 --> -0.945674).  Saving model ...
Epoch: 8 cost time: 3.96925950050354
Epoch: 8, Steps: 89 | Train Loss: 0.170 Vali Loss: 1.105 Vali Acc: 0.922 Test Loss: 1.105 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.224728345870972
Epoch: 9, Steps: 89 | Train Loss: 0.407 Vali Loss: 0.595 Vali Acc: 0.958 Test Loss: 0.595 Test Acc: 0.958
Validation loss decreased (-0.945674 --> -0.958211).  Saving model ...
Epoch: 10 cost time: 4.265974998474121
Epoch: 10, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.759 Vali Acc: 0.959 Test Loss: 0.759 Test Acc: 0.959
Validation loss decreased (-0.958211 --> -0.958906).  Saving model ...
Epoch: 11 cost time: 4.012917995452881
Epoch: 11, Steps: 89 | Train Loss: 0.259 Vali Loss: 1.013 Vali Acc: 0.939 Test Loss: 1.013 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.7352054119110107
Epoch: 12, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.776 Vali Acc: 0.960 Test Loss: 0.776 Test Acc: 0.960
Validation loss decreased (-0.958906 --> -0.959602).  Saving model ...
Epoch: 13 cost time: 3.9709348678588867
Epoch: 13, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.400 Vali Acc: 0.944 Test Loss: 1.400 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.734677314758301
Epoch: 14, Steps: 89 | Train Loss: 0.292 Vali Loss: 1.381 Vali Acc: 0.939 Test Loss: 1.381 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9126415252685547
Epoch: 15, Steps: 89 | Train Loss: 0.217 Vali Loss: 1.665 Vali Acc: 0.932 Test Loss: 1.665 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.951979637145996
Epoch: 16, Steps: 89 | Train Loss: 0.256 Vali Loss: 1.163 Vali Acc: 0.965 Test Loss: 1.163 Test Acc: 0.965
Validation loss decreased (-0.959602 --> -0.965169).  Saving model ...
Epoch: 17 cost time: 4.108843088150024
Epoch: 17, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.891 Vali Acc: 0.972 Test Loss: 0.891 Test Acc: 0.972
Validation loss decreased (-0.965169 --> -0.972136).  Saving model ...
Epoch: 18 cost time: 3.9494287967681885
Epoch: 18, Steps: 89 | Train Loss: 0.170 Vali Loss: 1.630 Vali Acc: 0.950 Test Loss: 1.630 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.067043781280518
Epoch: 19, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.526 Vali Acc: 0.939 Test Loss: 1.526 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.446152687072754
Epoch: 20, Steps: 89 | Train Loss: 0.127 Vali Loss: 1.460 Vali Acc: 0.960 Test Loss: 1.460 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.432781219482422
Epoch: 21, Steps: 89 | Train Loss: 0.286 Vali Loss: 1.806 Vali Acc: 0.927 Test Loss: 1.806 Test Acc: 0.927
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.416341304779053
Epoch: 22, Steps: 89 | Train Loss: 0.181 Vali Loss: 2.175 Vali Acc: 0.937 Test Loss: 2.175 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.623037338256836
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 1.253 Vali Acc: 0.969 Test Loss: 1.253 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.359198331832886
Epoch: 24, Steps: 89 | Train Loss: 0.126 Vali Loss: 1.467 Vali Acc: 0.960 Test Loss: 1.467 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.120222330093384
Epoch: 25, Steps: 89 | Train Loss: 0.304 Vali Loss: 1.506 Vali Acc: 0.962 Test Loss: 1.506 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.1279261112213135
Epoch: 26, Steps: 89 | Train Loss: 0.187 Vali Loss: 1.582 Vali Acc: 0.962 Test Loss: 1.582 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 4.211425542831421
Epoch: 27, Steps: 89 | Train Loss: 0.042 Vali Loss: 1.105 Vali Acc: 0.973 Test Loss: 1.105 Test Acc: 0.973
Validation loss decreased (-0.972136 --> -0.972830).  Saving model ...
Epoch: 28 cost time: 4.176842927932739
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 1.263 Vali Acc: 0.975 Test Loss: 1.263 Test Acc: 0.975
Validation loss decreased (-0.972830 --> -0.974918).  Saving model ...
Epoch: 29 cost time: 4.144667625427246
Epoch: 29, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.744 Vali Acc: 0.955 Test Loss: 1.744 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.18183159828186
Epoch: 30, Steps: 89 | Train Loss: 0.218 Vali Loss: 1.537 Vali Acc: 0.964 Test Loss: 1.537 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.219373464584351
Epoch: 31, Steps: 89 | Train Loss: 0.190 Vali Loss: 2.644 Vali Acc: 0.935 Test Loss: 2.644 Test Acc: 0.935
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.11380672454834
Epoch: 32, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.595 Vali Acc: 0.971 Test Loss: 1.595 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 4.176172494888306
Epoch: 33, Steps: 89 | Train Loss: 0.032 Vali Loss: 1.776 Vali Acc: 0.967 Test Loss: 1.776 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 4.502110242843628
Epoch: 34, Steps: 89 | Train Loss: 0.117 Vali Loss: 1.758 Vali Acc: 0.962 Test Loss: 1.758 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 4.649365425109863
Epoch: 35, Steps: 89 | Train Loss: 0.272 Vali Loss: 2.662 Vali Acc: 0.942 Test Loss: 2.662 Test Acc: 0.942
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 4.432741165161133
Epoch: 36, Steps: 89 | Train Loss: 0.234 Vali Loss: 2.122 Vali Acc: 0.948 Test Loss: 2.122 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 4.346887111663818
Epoch: 37, Steps: 89 | Train Loss: 0.047 Vali Loss: 1.702 Vali Acc: 0.958 Test Loss: 1.702 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 4.621771812438965
Epoch: 38, Steps: 89 | Train Loss: 0.144 Vali Loss: 1.394 Vali Acc: 0.969 Test Loss: 1.394 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 2663984
model size : 19.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.438455104827881
Epoch: 1, Steps: 89 | Train Loss: 0.937 Vali Loss: 0.688 Vali Acc: 0.829 Test Loss: 0.688 Test Acc: 0.829
Validation loss decreased (inf --> -0.829380).  Saving model ...
Epoch: 2 cost time: 3.5009758472442627
Epoch: 2, Steps: 89 | Train Loss: 0.452 Vali Loss: 0.705 Vali Acc: 0.898 Test Loss: 0.705 Test Acc: 0.898
Validation loss decreased (-0.829380 --> -0.898322).  Saving model ...
Epoch: 3 cost time: 3.671487331390381
Epoch: 3, Steps: 89 | Train Loss: 0.548 Vali Loss: 0.514 Vali Acc: 0.928 Test Loss: 0.514 Test Acc: 0.928
Validation loss decreased (-0.898322 --> -0.928268).  Saving model ...
Epoch: 4 cost time: 3.7282209396362305
Epoch: 4, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.839 Vali Acc: 0.902 Test Loss: 0.839 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.831378698348999
Epoch: 5, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.963 Vali Acc: 0.928 Test Loss: 0.963 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 4.001221418380737
Epoch: 6, Steps: 89 | Train Loss: 0.497 Vali Loss: 0.838 Vali Acc: 0.939 Test Loss: 0.838 Test Acc: 0.939
Validation loss decreased (-0.928268 --> -0.939407).  Saving model ...
Epoch: 7 cost time: 3.8926146030426025
Epoch: 7, Steps: 89 | Train Loss: 0.362 Vali Loss: 0.546 Vali Acc: 0.960 Test Loss: 0.546 Test Acc: 0.960
Validation loss decreased (-0.939407 --> -0.960301).  Saving model ...
Epoch: 8 cost time: 3.891385316848755
Epoch: 8, Steps: 89 | Train Loss: 0.186 Vali Loss: 1.102 Vali Acc: 0.930 Test Loss: 1.102 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.419353723526001
Epoch: 9, Steps: 89 | Train Loss: 0.343 Vali Loss: 1.146 Vali Acc: 0.942 Test Loss: 1.146 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.35702919960022
Epoch: 10, Steps: 89 | Train Loss: 0.228 Vali Loss: 0.731 Vali Acc: 0.963 Test Loss: 0.731 Test Acc: 0.963
Validation loss decreased (-0.960301 --> -0.963085).  Saving model ...
Epoch: 11 cost time: 4.09559440612793
Epoch: 11, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.823 Vali Acc: 0.966 Test Loss: 0.823 Test Acc: 0.966
Validation loss decreased (-0.963085 --> -0.965869).  Saving model ...
Epoch: 12 cost time: 4.096299648284912
Epoch: 12, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.580 Vali Acc: 0.970 Test Loss: 0.580 Test Acc: 0.970
Validation loss decreased (-0.965869 --> -0.970050).  Saving model ...
Epoch: 13 cost time: 4.225066900253296
Epoch: 13, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.738 Vali Acc: 0.963 Test Loss: 0.738 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.275025844573975
Epoch: 14, Steps: 89 | Train Loss: 0.337 Vali Loss: 1.132 Vali Acc: 0.956 Test Loss: 1.132 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.569178342819214
Epoch: 15, Steps: 89 | Train Loss: 0.251 Vali Loss: 1.164 Vali Acc: 0.944 Test Loss: 1.164 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.765868663787842
Epoch: 16, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.912 Vali Acc: 0.953 Test Loss: 0.912 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.699871778488159
Epoch: 17, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.813 Vali Acc: 0.959 Test Loss: 0.813 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8366012573242188
Epoch: 18, Steps: 89 | Train Loss: 0.133 Vali Loss: 1.216 Vali Acc: 0.961 Test Loss: 1.216 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8135247230529785
Epoch: 19, Steps: 89 | Train Loss: 0.137 Vali Loss: 1.347 Vali Acc: 0.953 Test Loss: 1.347 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.717318534851074
Epoch: 20, Steps: 89 | Train Loss: 0.268 Vali Loss: 1.485 Vali Acc: 0.954 Test Loss: 1.485 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.8716869354248047
Epoch: 21, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.960 Vali Acc: 0.964 Test Loss: 0.960 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.8635318279266357
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 1.022 Vali Acc: 0.961 Test Loss: 1.022 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 2663984
model size : 19.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.654372692108154
Epoch: 1, Steps: 89 | Train Loss: 0.873 Vali Loss: 0.431 Vali Acc: 0.888 Test Loss: 0.431 Test Acc: 0.888
Validation loss decreased (inf --> -0.887879).  Saving model ...
Epoch: 2 cost time: 3.774085521697998
Epoch: 2, Steps: 89 | Train Loss: 0.394 Vali Loss: 0.729 Vali Acc: 0.877 Test Loss: 0.729 Test Acc: 0.877
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.50529408454895
Epoch: 3, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.547 Vali Acc: 0.942 Test Loss: 0.547 Test Acc: 0.942
Validation loss decreased (-0.887879 --> -0.942195).  Saving model ...
Epoch: 4 cost time: 4.012499570846558
Epoch: 4, Steps: 89 | Train Loss: 0.523 Vali Loss: 0.796 Vali Acc: 0.919 Test Loss: 0.796 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.071751356124878
Epoch: 5, Steps: 89 | Train Loss: 0.331 Vali Loss: 0.478 Vali Acc: 0.962 Test Loss: 0.478 Test Acc: 0.962
Validation loss decreased (-0.942195 --> -0.961694).  Saving model ...
Epoch: 6 cost time: 3.508554458618164
Epoch: 6, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.490 Vali Acc: 0.962 Test Loss: 0.490 Test Acc: 0.962
Validation loss decreased (-0.961694 --> -0.962391).  Saving model ...
Epoch: 7 cost time: 4.527653932571411
Epoch: 7, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.433 Vali Acc: 0.959 Test Loss: 0.433 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.566838264465332
Epoch: 8, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.829 Vali Acc: 0.944 Test Loss: 0.829 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1151514053344727
Epoch: 9, Steps: 89 | Train Loss: 0.206 Vali Loss: 1.117 Vali Acc: 0.925 Test Loss: 1.117 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.803684949874878
Epoch: 10, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.714 Vali Acc: 0.958 Test Loss: 0.714 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3360424041748047
Epoch: 11, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.801 Vali Acc: 0.960 Test Loss: 0.801 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4449729919433594
Epoch: 12, Steps: 89 | Train Loss: 0.190 Vali Loss: 1.072 Vali Acc: 0.952 Test Loss: 1.072 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.7360501289367676
Epoch: 13, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.597 Vali Acc: 0.979 Test Loss: 0.597 Test Acc: 0.979
Validation loss decreased (-0.962391 --> -0.979103).  Saving model ...
Epoch: 14 cost time: 3.7349953651428223
Epoch: 14, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.763 Vali Acc: 0.967 Test Loss: 0.763 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.64117693901062
Epoch: 15, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.709 Vali Acc: 0.975 Test Loss: 0.709 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.786320209503174
Epoch: 16, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.787 Vali Acc: 0.969 Test Loss: 0.787 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.8265140056610107
Epoch: 17, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.885 Vali Acc: 0.966 Test Loss: 0.885 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.8358519077301025
Epoch: 18, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.803 Vali Acc: 0.971 Test Loss: 0.803 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.5216681957244873
Epoch: 19, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.819 Vali Acc: 0.964 Test Loss: 0.819 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.034741640090942
Epoch: 20, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.860 Vali Acc: 0.967 Test Loss: 0.860 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.182793140411377
Epoch: 21, Steps: 89 | Train Loss: 0.088 Vali Loss: 2.060 Vali Acc: 0.935 Test Loss: 2.060 Test Acc: 0.935
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.911658525466919
Epoch: 22, Steps: 89 | Train Loss: 0.788 Vali Loss: 1.813 Vali Acc: 0.937 Test Loss: 1.813 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 4.016400337219238
Epoch: 23, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.331 Vali Acc: 0.953 Test Loss: 1.331 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 2663984
model size : 19.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.755959987640381
Epoch: 1, Steps: 89 | Train Loss: 0.814 Vali Loss: 0.412 Vali Acc: 0.894 Test Loss: 0.412 Test Acc: 0.894
Validation loss decreased (inf --> -0.894146).  Saving model ...
Epoch: 2 cost time: 3.272627830505371
Epoch: 2, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.338 Vali Acc: 0.930 Test Loss: 0.338 Test Acc: 0.930
Validation loss decreased (-0.894146 --> -0.930359).  Saving model ...
Epoch: 3 cost time: 3.275693416595459
Epoch: 3, Steps: 89 | Train Loss: 0.203 Vali Loss: 0.263 Vali Acc: 0.958 Test Loss: 0.263 Test Acc: 0.958
Validation loss decreased (-0.930359 --> -0.957518).  Saving model ...
Epoch: 4 cost time: 3.406764030456543
Epoch: 4, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.509 Vali Acc: 0.928 Test Loss: 0.509 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.5370543003082275
Epoch: 5, Steps: 89 | Train Loss: 0.264 Vali Loss: 0.356 Vali Acc: 0.957 Test Loss: 0.356 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3783044815063477
Epoch: 6, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.262 Vali Acc: 0.968 Test Loss: 0.262 Test Acc: 0.968
Validation loss decreased (-0.957518 --> -0.967964).  Saving model ...
Epoch: 7 cost time: 3.282442808151245
Epoch: 7, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.418 Vali Acc: 0.963 Test Loss: 0.418 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.330779790878296
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.661 Vali Acc: 0.924 Test Loss: 0.661 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.4053456783294678
Epoch: 9, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.559 Vali Acc: 0.966 Test Loss: 0.559 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.305656909942627
Epoch: 10, Steps: 89 | Train Loss: 0.176 Vali Loss: 0.501 Vali Acc: 0.962 Test Loss: 0.501 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.508645534515381
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.444 Vali Acc: 0.965 Test Loss: 0.444 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.504711627960205
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.477 Vali Acc: 0.972 Test Loss: 0.477 Test Acc: 0.972
Validation loss decreased (-0.967964 --> -0.972140).  Saving model ...
Epoch: 13 cost time: 3.6555426120758057
Epoch: 13, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.643 Vali Acc: 0.958 Test Loss: 0.643 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.6108899116516113
Epoch: 14, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.498 Vali Acc: 0.967 Test Loss: 0.498 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.5132899284362793
Epoch: 15, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.446 Vali Acc: 0.974 Test Loss: 0.446 Test Acc: 0.974
Validation loss decreased (-0.972140 --> -0.973533).  Saving model ...
Epoch: 16 cost time: 3.3010776042938232
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.622 Vali Acc: 0.965 Test Loss: 0.622 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.343937397003174
Epoch: 17, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.548 Vali Acc: 0.976 Test Loss: 0.548 Test Acc: 0.976
Validation loss decreased (-0.973533 --> -0.976318).  Saving model ...
Epoch: 18 cost time: 3.3064608573913574
Epoch: 18, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.743 Vali Acc: 0.957 Test Loss: 0.743 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.3497121334075928
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.891 Vali Acc: 0.953 Test Loss: 0.891 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3090314865112305
Epoch: 20, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.595 Vali Acc: 0.963 Test Loss: 0.595 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2934679985046387
Epoch: 21, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.718 Vali Acc: 0.971 Test Loss: 0.718 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.5549745559692383
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.656 Vali Acc: 0.971 Test Loss: 0.656 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.467918872833252
Epoch: 23, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.759 Vali Acc: 0.967 Test Loss: 0.759 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.3080413341522217
Epoch: 24, Steps: 89 | Train Loss: 0.160 Vali Loss: 1.015 Vali Acc: 0.962 Test Loss: 1.015 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.3977744579315186
Epoch: 25, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.951 Vali Acc: 0.966 Test Loss: 0.951 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.6081488132476807
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 1.069 Vali Acc: 0.953 Test Loss: 1.069 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 3.324582576751709
Epoch: 27, Steps: 89 | Train Loss: 0.072 Vali Loss: 1.167 Vali Acc: 0.953 Test Loss: 1.167 Test Acc: 0.953
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 2663984
model size : 19.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.878822565078735
Epoch: 1, Steps: 89 | Train Loss: 0.929 Vali Loss: 0.790 Vali Acc: 0.819 Test Loss: 0.790 Test Acc: 0.819
Validation loss decreased (inf --> -0.818934).  Saving model ...
Epoch: 2 cost time: 4.198304891586304
Epoch: 2, Steps: 89 | Train Loss: 0.512 Vali Loss: 1.335 Vali Acc: 0.843 Test Loss: 1.335 Test Acc: 0.843
Validation loss decreased (-0.818934 --> -0.843301).  Saving model ...
Epoch: 3 cost time: 3.6633498668670654
Epoch: 3, Steps: 89 | Train Loss: 0.750 Vali Loss: 0.553 Vali Acc: 0.925 Test Loss: 0.553 Test Acc: 0.925
Validation loss decreased (-0.843301 --> -0.924786).  Saving model ...
Epoch: 4 cost time: 3.91007661819458
Epoch: 4, Steps: 89 | Train Loss: 0.610 Vali Loss: 0.637 Vali Acc: 0.938 Test Loss: 0.637 Test Acc: 0.938
Validation loss decreased (-0.924786 --> -0.938016).  Saving model ...
Epoch: 5 cost time: 3.915468454360962
Epoch: 5, Steps: 89 | Train Loss: 0.450 Vali Loss: 0.827 Vali Acc: 0.944 Test Loss: 0.827 Test Acc: 0.944
Validation loss decreased (-0.938016 --> -0.943585).  Saving model ...
Epoch: 6 cost time: 3.979464054107666
Epoch: 6, Steps: 89 | Train Loss: 0.419 Vali Loss: 0.855 Vali Acc: 0.925 Test Loss: 0.855 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.883009433746338
Epoch: 7, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.850 Vali Acc: 0.940 Test Loss: 0.850 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.927433729171753
Epoch: 8, Steps: 89 | Train Loss: 0.330 Vali Loss: 1.014 Vali Acc: 0.939 Test Loss: 1.014 Test Acc: 0.939
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.971377372741699
Epoch: 9, Steps: 89 | Train Loss: 0.353 Vali Loss: 0.862 Vali Acc: 0.961 Test Loss: 0.862 Test Acc: 0.961
Validation loss decreased (-0.943585 --> -0.960994).  Saving model ...
Epoch: 10 cost time: 4.139221668243408
Epoch: 10, Steps: 89 | Train Loss: 0.245 Vali Loss: 1.212 Vali Acc: 0.952 Test Loss: 1.212 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.894240379333496
Epoch: 11, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.738 Vali Acc: 0.970 Test Loss: 0.738 Test Acc: 0.970
Validation loss decreased (-0.960994 --> -0.970048).  Saving model ...
Epoch: 12 cost time: 4.167417049407959
Epoch: 12, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.187 Vali Acc: 0.948 Test Loss: 1.187 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.217474937438965
Epoch: 13, Steps: 89 | Train Loss: 0.400 Vali Loss: 1.400 Vali Acc: 0.937 Test Loss: 1.400 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.327616453170776
Epoch: 14, Steps: 89 | Train Loss: 0.213 Vali Loss: 1.013 Vali Acc: 0.963 Test Loss: 1.013 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.139430522918701
Epoch: 15, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.381 Vali Acc: 0.953 Test Loss: 1.381 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.022284269332886
Epoch: 16, Steps: 89 | Train Loss: 0.167 Vali Loss: 1.133 Vali Acc: 0.960 Test Loss: 1.133 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.261806011199951
Epoch: 17, Steps: 89 | Train Loss: 0.245 Vali Loss: 1.236 Vali Acc: 0.956 Test Loss: 1.236 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.957350969314575
Epoch: 18, Steps: 89 | Train Loss: 0.203 Vali Loss: 1.206 Vali Acc: 0.960 Test Loss: 1.206 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.036543607711792
Epoch: 19, Steps: 89 | Train Loss: 0.231 Vali Loss: 1.207 Vali Acc: 0.964 Test Loss: 1.207 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.8362338542938232
Epoch: 20, Steps: 89 | Train Loss: 0.076 Vali Loss: 1.126 Vali Acc: 0.971 Test Loss: 1.126 Test Acc: 0.971
Validation loss decreased (-0.970048 --> -0.971437).  Saving model ...
Epoch: 21 cost time: 3.8547165393829346
Epoch: 21, Steps: 89 | Train Loss: 0.164 Vali Loss: 1.655 Vali Acc: 0.942 Test Loss: 1.655 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.9997150897979736
Epoch: 22, Steps: 89 | Train Loss: 0.127 Vali Loss: 1.603 Vali Acc: 0.949 Test Loss: 1.603 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.9343442916870117
Epoch: 23, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.212 Vali Acc: 0.968 Test Loss: 1.212 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.873779296875
Epoch: 24, Steps: 89 | Train Loss: 0.028 Vali Loss: 1.262 Vali Acc: 0.963 Test Loss: 1.262 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.9554035663604736
Epoch: 25, Steps: 89 | Train Loss: 0.193 Vali Loss: 1.370 Vali Acc: 0.960 Test Loss: 1.370 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.9239883422851562
Epoch: 26, Steps: 89 | Train Loss: 0.160 Vali Loss: 1.457 Vali Acc: 0.957 Test Loss: 1.457 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.879056215286255
Epoch: 27, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.078 Vali Acc: 0.976 Test Loss: 1.078 Test Acc: 0.976
Validation loss decreased (-0.971437 --> -0.975616).  Saving model ...
Epoch: 28 cost time: 4.065375328063965
Epoch: 28, Steps: 89 | Train Loss: 0.238 Vali Loss: 2.190 Vali Acc: 0.942 Test Loss: 2.190 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.495964765548706
Epoch: 29, Steps: 89 | Train Loss: 0.297 Vali Loss: 1.720 Vali Acc: 0.962 Test Loss: 1.720 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 4.27620005607605
Epoch: 30, Steps: 89 | Train Loss: 0.145 Vali Loss: 2.059 Vali Acc: 0.947 Test Loss: 2.059 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 4.041721820831299
Epoch: 31, Steps: 89 | Train Loss: 0.171 Vali Loss: 1.951 Vali Acc: 0.960 Test Loss: 1.951 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.8719353675842285
Epoch: 32, Steps: 89 | Train Loss: 0.267 Vali Loss: 1.575 Vali Acc: 0.966 Test Loss: 1.575 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 4.027885437011719
Epoch: 33, Steps: 89 | Train Loss: 0.076 Vali Loss: 1.225 Vali Acc: 0.971 Test Loss: 1.225 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 4.087640047073364
Epoch: 34, Steps: 89 | Train Loss: 0.060 Vali Loss: 1.443 Vali Acc: 0.964 Test Loss: 1.443 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.9109761714935303
Epoch: 35, Steps: 89 | Train Loss: 0.078 Vali Loss: 1.420 Vali Acc: 0.963 Test Loss: 1.420 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.985485076904297
Epoch: 36, Steps: 89 | Train Loss: 0.044 Vali Loss: 1.863 Vali Acc: 0.951 Test Loss: 1.863 Test Acc: 0.951
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 4.121817588806152
Epoch: 37, Steps: 89 | Train Loss: 0.169 Vali Loss: 1.645 Vali Acc: 0.958 Test Loss: 1.645 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2532912
model size : 19.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.407154321670532
Epoch: 1, Steps: 89 | Train Loss: 0.943 Vali Loss: 0.661 Vali Acc: 0.852 Test Loss: 0.661 Test Acc: 0.852
Validation loss decreased (inf --> -0.851665).  Saving model ...
Epoch: 2 cost time: 3.7799086570739746
Epoch: 2, Steps: 89 | Train Loss: 0.535 Vali Loss: 0.466 Vali Acc: 0.927 Test Loss: 0.466 Test Acc: 0.927
Validation loss decreased (-0.851665 --> -0.926876).  Saving model ...
Epoch: 3 cost time: 4.005801439285278
Epoch: 3, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.674 Vali Acc: 0.914 Test Loss: 0.674 Test Acc: 0.914
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.9235846996307373
Epoch: 4, Steps: 89 | Train Loss: 0.551 Vali Loss: 0.379 Vali Acc: 0.964 Test Loss: 0.379 Test Acc: 0.964
Validation loss decreased (-0.926876 --> -0.963785).  Saving model ...
Epoch: 5 cost time: 3.8075215816497803
Epoch: 5, Steps: 89 | Train Loss: 0.440 Vali Loss: 0.869 Vali Acc: 0.921 Test Loss: 0.869 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.07258415222168
Epoch: 6, Steps: 89 | Train Loss: 0.528 Vali Loss: 0.778 Vali Acc: 0.942 Test Loss: 0.778 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.980043411254883
Epoch: 7, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.480 Vali Acc: 0.968 Test Loss: 0.480 Test Acc: 0.968
Validation loss decreased (-0.963785 --> -0.967962).  Saving model ...
Epoch: 8 cost time: 3.6836626529693604
Epoch: 8, Steps: 89 | Train Loss: 0.305 Vali Loss: 0.789 Vali Acc: 0.957 Test Loss: 0.789 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.806347131729126
Epoch: 9, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.762 Vali Acc: 0.954 Test Loss: 0.762 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.912005662918091
Epoch: 10, Steps: 89 | Train Loss: 0.329 Vali Loss: 1.049 Vali Acc: 0.942 Test Loss: 1.049 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.8210697174072266
Epoch: 11, Steps: 89 | Train Loss: 0.383 Vali Loss: 1.157 Vali Acc: 0.944 Test Loss: 1.157 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8281426429748535
Epoch: 12, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.688 Vali Acc: 0.964 Test Loss: 0.688 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7416605949401855
Epoch: 13, Steps: 89 | Train Loss: 0.155 Vali Loss: 1.068 Vali Acc: 0.965 Test Loss: 1.068 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.693291187286377
Epoch: 14, Steps: 89 | Train Loss: 0.251 Vali Loss: 1.023 Vali Acc: 0.948 Test Loss: 1.023 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.862539052963257
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.913 Vali Acc: 0.964 Test Loss: 0.913 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7358598709106445
Epoch: 16, Steps: 89 | Train Loss: 0.122 Vali Loss: 1.063 Vali Acc: 0.955 Test Loss: 1.063 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.732414484024048
Epoch: 17, Steps: 89 | Train Loss: 0.113 Vali Loss: 1.321 Vali Acc: 0.946 Test Loss: 1.321 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 2532912
model size : 19.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.452535152435303
Epoch: 1, Steps: 89 | Train Loss: 0.884 Vali Loss: 0.505 Vali Acc: 0.862 Test Loss: 0.505 Test Acc: 0.862
Validation loss decreased (inf --> -0.862112).  Saving model ...
Epoch: 2 cost time: 3.6801719665527344
Epoch: 2, Steps: 89 | Train Loss: 0.431 Vali Loss: 0.648 Vali Acc: 0.886 Test Loss: 0.648 Test Acc: 0.886
Validation loss decreased (-0.862112 --> -0.885787).  Saving model ...
Epoch: 3 cost time: 3.8131611347198486
Epoch: 3, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.431 Vali Acc: 0.935 Test Loss: 0.431 Test Acc: 0.935
Validation loss decreased (-0.885787 --> -0.935232).  Saving model ...
Epoch: 4 cost time: 3.756307601928711
Epoch: 4, Steps: 89 | Train Loss: 0.323 Vali Loss: 0.454 Vali Acc: 0.951 Test Loss: 0.454 Test Acc: 0.951
Validation loss decreased (-0.935232 --> -0.950553).  Saving model ...
Epoch: 5 cost time: 3.6267597675323486
Epoch: 5, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.927 Vali Acc: 0.913 Test Loss: 0.927 Test Acc: 0.913
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.464695930480957
Epoch: 6, Steps: 89 | Train Loss: 0.335 Vali Loss: 0.662 Vali Acc: 0.933 Test Loss: 0.662 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.435075521469116
Epoch: 7, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.454 Vali Acc: 0.967 Test Loss: 0.454 Test Acc: 0.967
Validation loss decreased (-0.950553 --> -0.966569).  Saving model ...
Epoch: 8 cost time: 3.6799087524414062
Epoch: 8, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.713 Vali Acc: 0.948 Test Loss: 0.713 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.5407979488372803
Epoch: 9, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.631 Vali Acc: 0.962 Test Loss: 0.631 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.5502254962921143
Epoch: 10, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.840 Vali Acc: 0.954 Test Loss: 0.840 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.479308605194092
Epoch: 11, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.690 Vali Acc: 0.958 Test Loss: 0.690 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.6088180541992188
Epoch: 12, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.741 Vali Acc: 0.962 Test Loss: 0.741 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.7549736499786377
Epoch: 13, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.849 Vali Acc: 0.960 Test Loss: 0.849 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.3748364448547363
Epoch: 14, Steps: 89 | Train Loss: 0.162 Vali Loss: 1.022 Vali Acc: 0.955 Test Loss: 1.022 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.6435036659240723
Epoch: 15, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.766 Vali Acc: 0.962 Test Loss: 0.766 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7573795318603516
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 1.288 Vali Acc: 0.948 Test Loss: 1.288 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.756136417388916
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.848 Vali Acc: 0.963 Test Loss: 0.848 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9665738161559888
model parameter : 2532912
model size : 19.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.049211502075195
Epoch: 1, Steps: 89 | Train Loss: 0.847 Vali Loss: 0.483 Vali Acc: 0.860 Test Loss: 0.483 Test Acc: 0.860
Validation loss decreased (inf --> -0.860023).  Saving model ...
Epoch: 2 cost time: 3.185213327407837
Epoch: 2, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.289 Vali Acc: 0.947 Test Loss: 0.289 Test Acc: 0.947
Validation loss decreased (-0.860023 --> -0.947072).  Saving model ...
Epoch: 3 cost time: 3.1454272270202637
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.409 Vali Acc: 0.921 Test Loss: 0.409 Test Acc: 0.921
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.0264952182769775
Epoch: 4, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.422 Vali Acc: 0.941 Test Loss: 0.422 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.231820821762085
Epoch: 5, Steps: 89 | Train Loss: 0.237 Vali Loss: 0.497 Vali Acc: 0.950 Test Loss: 0.497 Test Acc: 0.950
Validation loss decreased (-0.947072 --> -0.949856).  Saving model ...
Epoch: 6 cost time: 3.3516457080841064
Epoch: 6, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.670 Vali Acc: 0.939 Test Loss: 0.670 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.410438299179077
Epoch: 7, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.563 Vali Acc: 0.951 Test Loss: 0.563 Test Acc: 0.951
Validation loss decreased (-0.949856 --> -0.950551).  Saving model ...
Epoch: 8 cost time: 3.364072322845459
Epoch: 8, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.475 Vali Acc: 0.965 Test Loss: 0.475 Test Acc: 0.965
Validation loss decreased (-0.950551 --> -0.965176).  Saving model ...
Epoch: 9 cost time: 3.4498634338378906
Epoch: 9, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.562 Vali Acc: 0.958 Test Loss: 0.562 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.590829372406006
Epoch: 10, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.467 Vali Acc: 0.972 Test Loss: 0.467 Test Acc: 0.972
Validation loss decreased (-0.965176 --> -0.972140).  Saving model ...
Epoch: 11 cost time: 3.2984976768493652
Epoch: 11, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.609 Vali Acc: 0.962 Test Loss: 0.609 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.630408763885498
Epoch: 12, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.532 Vali Acc: 0.961 Test Loss: 0.532 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.635500431060791
Epoch: 13, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.715 Vali Acc: 0.953 Test Loss: 0.715 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.5958893299102783
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.686 Vali Acc: 0.964 Test Loss: 0.686 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.472749710083008
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.602 Vali Acc: 0.968 Test Loss: 0.602 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5844414234161377
Epoch: 16, Steps: 89 | Train Loss: 0.252 Vali Loss: 0.844 Vali Acc: 0.957 Test Loss: 0.844 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.648512125015259
Epoch: 17, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.955 Vali Acc: 0.946 Test Loss: 0.955 Test Acc: 0.946
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3922102451324463
Epoch: 18, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.781 Vali Acc: 0.960 Test Loss: 0.781 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.480668067932129
Epoch: 19, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.748 Vali Acc: 0.958 Test Loss: 0.748 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4323055744171143
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 1.340 Vali Acc: 0.946 Test Loss: 1.340 Test Acc: 0.946
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 2532912
model size : 19.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.076185703277588
Epoch: 1, Steps: 89 | Train Loss: 0.867 Vali Loss: 0.468 Vali Acc: 0.884 Test Loss: 0.468 Test Acc: 0.884
Validation loss decreased (inf --> -0.884396).  Saving model ...
Epoch: 2 cost time: 3.739823818206787
Epoch: 2, Steps: 89 | Train Loss: 0.491 Vali Loss: 0.741 Vali Acc: 0.883 Test Loss: 0.741 Test Acc: 0.883
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 4.006009101867676
Epoch: 3, Steps: 89 | Train Loss: 0.467 Vali Loss: 0.978 Vali Acc: 0.878 Test Loss: 0.978 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 3.9794979095458984
Epoch: 4, Steps: 89 | Train Loss: 0.540 Vali Loss: 0.686 Vali Acc: 0.937 Test Loss: 0.686 Test Acc: 0.937
Validation loss decreased (-0.884396 --> -0.937319).  Saving model ...
Epoch: 5 cost time: 4.120886564254761
Epoch: 5, Steps: 89 | Train Loss: 0.653 Vali Loss: 0.771 Vali Acc: 0.933 Test Loss: 0.771 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.999695062637329
Epoch: 6, Steps: 89 | Train Loss: 0.454 Vali Loss: 0.696 Vali Acc: 0.948 Test Loss: 0.696 Test Acc: 0.948
Validation loss decreased (-0.937319 --> -0.948461).  Saving model ...
Epoch: 7 cost time: 4.064137935638428
Epoch: 7, Steps: 89 | Train Loss: 0.391 Vali Loss: 0.793 Vali Acc: 0.940 Test Loss: 0.793 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.102643013000488
Epoch: 8, Steps: 89 | Train Loss: 0.219 Vali Loss: 1.123 Vali Acc: 0.940 Test Loss: 1.123 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.150798082351685
Epoch: 9, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.849 Vali Acc: 0.962 Test Loss: 0.849 Test Acc: 0.962
Validation loss decreased (-0.948461 --> -0.961691).  Saving model ...
Epoch: 10 cost time: 4.1825950145721436
Epoch: 10, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.675 Vali Acc: 0.968 Test Loss: 0.675 Test Acc: 0.968
Validation loss decreased (-0.961691 --> -0.967960).  Saving model ...
Epoch: 11 cost time: 3.8092308044433594
Epoch: 11, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.907 Vali Acc: 0.959 Test Loss: 0.907 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.028347969055176
Epoch: 12, Steps: 89 | Train Loss: 0.391 Vali Loss: 1.020 Vali Acc: 0.964 Test Loss: 1.020 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.058176755905151
Epoch: 13, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.998 Vali Acc: 0.963 Test Loss: 0.998 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 4.198883533477783
Epoch: 14, Steps: 89 | Train Loss: 0.279 Vali Loss: 0.784 Vali Acc: 0.976 Test Loss: 0.784 Test Acc: 0.976
Validation loss decreased (-0.967960 --> -0.975619).  Saving model ...
Epoch: 15 cost time: 4.0640528202056885
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 1.031 Vali Acc: 0.963 Test Loss: 1.031 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.8728880882263184
Epoch: 16, Steps: 89 | Train Loss: 0.117 Vali Loss: 1.183 Vali Acc: 0.958 Test Loss: 1.183 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.049707412719727
Epoch: 17, Steps: 89 | Train Loss: 0.306 Vali Loss: 1.796 Vali Acc: 0.948 Test Loss: 1.796 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.9730849266052246
Epoch: 18, Steps: 89 | Train Loss: 0.286 Vali Loss: 1.241 Vali Acc: 0.958 Test Loss: 1.241 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 4.011291027069092
Epoch: 19, Steps: 89 | Train Loss: 0.196 Vali Loss: 1.153 Vali Acc: 0.967 Test Loss: 1.153 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.045194625854492
Epoch: 20, Steps: 89 | Train Loss: 0.209 Vali Loss: 1.205 Vali Acc: 0.974 Test Loss: 1.205 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.331760883331299
Epoch: 21, Steps: 89 | Train Loss: 0.192 Vali Loss: 1.644 Vali Acc: 0.948 Test Loss: 1.644 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.233117580413818
Epoch: 22, Steps: 89 | Train Loss: 0.216 Vali Loss: 1.374 Vali Acc: 0.966 Test Loss: 1.374 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.135020971298218
Epoch: 23, Steps: 89 | Train Loss: 0.106 Vali Loss: 1.311 Vali Acc: 0.965 Test Loss: 1.311 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.381428480148315
Epoch: 24, Steps: 89 | Train Loss: 0.052 Vali Loss: 1.398 Vali Acc: 0.961 Test Loss: 1.398 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2467376
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.28922438621521
Epoch: 1, Steps: 89 | Train Loss: 0.843 Vali Loss: 0.403 Vali Acc: 0.898 Test Loss: 0.403 Test Acc: 0.898
Validation loss decreased (inf --> -0.897628).  Saving model ...
Epoch: 2 cost time: 3.6545774936676025
Epoch: 2, Steps: 89 | Train Loss: 0.483 Vali Loss: 0.748 Vali Acc: 0.880 Test Loss: 0.748 Test Acc: 0.880
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.685596227645874
Epoch: 3, Steps: 89 | Train Loss: 0.459 Vali Loss: 0.742 Vali Acc: 0.922 Test Loss: 0.742 Test Acc: 0.922
Validation loss decreased (-0.897628 --> -0.921998).  Saving model ...
Epoch: 4 cost time: 3.75211763381958
Epoch: 4, Steps: 89 | Train Loss: 0.555 Vali Loss: 1.227 Vali Acc: 0.882 Test Loss: 1.227 Test Acc: 0.882
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.7001547813415527
Epoch: 5, Steps: 89 | Train Loss: 0.574 Vali Loss: 0.831 Vali Acc: 0.930 Test Loss: 0.831 Test Acc: 0.930
Validation loss decreased (-0.921998 --> -0.929657).  Saving model ...
Epoch: 6 cost time: 3.7577881813049316
Epoch: 6, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.936 Vali Acc: 0.929 Test Loss: 0.936 Test Acc: 0.929
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.7521002292633057
Epoch: 7, Steps: 89 | Train Loss: 0.437 Vali Loss: 1.077 Vali Acc: 0.927 Test Loss: 1.077 Test Acc: 0.927
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.922037124633789
Epoch: 8, Steps: 89 | Train Loss: 0.319 Vali Loss: 0.830 Vali Acc: 0.954 Test Loss: 0.830 Test Acc: 0.954
Validation loss decreased (-0.929657 --> -0.954031).  Saving model ...
Epoch: 9 cost time: 3.513016939163208
Epoch: 9, Steps: 89 | Train Loss: 0.463 Vali Loss: 0.753 Vali Acc: 0.951 Test Loss: 0.753 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.7763619422912598
Epoch: 10, Steps: 89 | Train Loss: 0.476 Vali Loss: 0.978 Vali Acc: 0.961 Test Loss: 0.978 Test Acc: 0.961
Validation loss decreased (-0.954031 --> -0.960993).  Saving model ...
Epoch: 11 cost time: 4.011902809143066
Epoch: 11, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.622 Vali Acc: 0.968 Test Loss: 0.622 Test Acc: 0.968
Validation loss decreased (-0.960993 --> -0.967960).  Saving model ...
Epoch: 12 cost time: 3.998969316482544
Epoch: 12, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.764 Vali Acc: 0.962 Test Loss: 0.764 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6173770427703857
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.636 Vali Acc: 0.971 Test Loss: 0.636 Test Acc: 0.971
Validation loss decreased (-0.967960 --> -0.970746).  Saving model ...
Epoch: 14 cost time: 3.9777441024780273
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.797 Vali Acc: 0.961 Test Loss: 0.797 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.8590145111083984
Epoch: 15, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.622 Vali Acc: 0.974 Test Loss: 0.622 Test Acc: 0.974
Validation loss decreased (-0.970746 --> -0.973531).  Saving model ...
Epoch: 16 cost time: 3.866434097290039
Epoch: 16, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.702 Vali Acc: 0.974 Test Loss: 0.702 Test Acc: 0.974
Validation loss decreased (-0.973531 --> -0.974227).  Saving model ...
Epoch: 17 cost time: 3.673048257827759
Epoch: 17, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.652 Vali Acc: 0.971 Test Loss: 0.652 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7126858234405518
Epoch: 18, Steps: 89 | Train Loss: 0.320 Vali Loss: 0.978 Vali Acc: 0.966 Test Loss: 0.978 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.823458671569824
Epoch: 19, Steps: 89 | Train Loss: 0.336 Vali Loss: 0.950 Vali Acc: 0.969 Test Loss: 0.950 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.5881052017211914
Epoch: 20, Steps: 89 | Train Loss: 0.179 Vali Loss: 1.466 Vali Acc: 0.952 Test Loss: 1.466 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.7262213230133057
Epoch: 21, Steps: 89 | Train Loss: 0.144 Vali Loss: 1.031 Vali Acc: 0.962 Test Loss: 1.031 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.531388282775879
Epoch: 22, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.988 Vali Acc: 0.978 Test Loss: 0.988 Test Acc: 0.978
Validation loss decreased (-0.974227 --> -0.977706).  Saving model ...
Epoch: 23 cost time: 3.6852073669433594
Epoch: 23, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.944 Vali Acc: 0.974 Test Loss: 0.944 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.775088310241699
Epoch: 24, Steps: 89 | Train Loss: 0.304 Vali Loss: 1.055 Vali Acc: 0.969 Test Loss: 1.055 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.7001442909240723
Epoch: 25, Steps: 89 | Train Loss: 0.236 Vali Loss: 1.623 Vali Acc: 0.955 Test Loss: 1.623 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.6904234886169434
Epoch: 26, Steps: 89 | Train Loss: 0.098 Vali Loss: 1.335 Vali Acc: 0.965 Test Loss: 1.335 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 4.038970947265625
Epoch: 27, Steps: 89 | Train Loss: 0.115 Vali Loss: 1.567 Vali Acc: 0.969 Test Loss: 1.567 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 4.096172094345093
Epoch: 28, Steps: 89 | Train Loss: 0.144 Vali Loss: 1.023 Vali Acc: 0.974 Test Loss: 1.023 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.531942367553711
Epoch: 29, Steps: 89 | Train Loss: 0.072 Vali Loss: 1.168 Vali Acc: 0.965 Test Loss: 1.168 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.7442822456359863
Epoch: 30, Steps: 89 | Train Loss: 0.250 Vali Loss: 1.059 Vali Acc: 0.966 Test Loss: 1.059 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.850562572479248
Epoch: 31, Steps: 89 | Train Loss: 0.020 Vali Loss: 1.108 Vali Acc: 0.965 Test Loss: 1.108 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.9625966548919678
Epoch: 32, Steps: 89 | Train Loss: 0.000 Vali Loss: 1.090 Vali Acc: 0.966 Test Loss: 1.090 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 2467376
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.139964818954468
Epoch: 1, Steps: 89 | Train Loss: 0.796 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (inf --> -0.926181).  Saving model ...
Epoch: 2 cost time: 3.596647024154663
Epoch: 2, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.309 Vali Acc: 0.939 Test Loss: 0.309 Test Acc: 0.939
Validation loss decreased (-0.926181 --> -0.939412).  Saving model ...
Epoch: 3 cost time: 3.5299336910247803
Epoch: 3, Steps: 89 | Train Loss: 0.340 Vali Loss: 0.564 Vali Acc: 0.925 Test Loss: 0.564 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.4464011192321777
Epoch: 4, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.394 Vali Acc: 0.953 Test Loss: 0.394 Test Acc: 0.953
Validation loss decreased (-0.939412 --> -0.952642).  Saving model ...
Epoch: 5 cost time: 3.3052682876586914
Epoch: 5, Steps: 89 | Train Loss: 0.357 Vali Loss: 0.605 Vali Acc: 0.943 Test Loss: 0.605 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.5299630165100098
Epoch: 6, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.606 Vali Acc: 0.956 Test Loss: 0.606 Test Acc: 0.956
Validation loss decreased (-0.952642 --> -0.956122).  Saving model ...
Epoch: 7 cost time: 3.335637092590332
Epoch: 7, Steps: 89 | Train Loss: 0.235 Vali Loss: 0.879 Vali Acc: 0.944 Test Loss: 0.879 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.310512065887451
Epoch: 8, Steps: 89 | Train Loss: 0.233 Vali Loss: 1.249 Vali Acc: 0.921 Test Loss: 1.249 Test Acc: 0.921
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.9065020084381104
Epoch: 9, Steps: 89 | Train Loss: 0.380 Vali Loss: 0.590 Vali Acc: 0.973 Test Loss: 0.590 Test Acc: 0.973
Validation loss decreased (-0.956122 --> -0.972835).  Saving model ...
Epoch: 10 cost time: 3.883084297180176
Epoch: 10, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.928 Vali Acc: 0.945 Test Loss: 0.928 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.5141303539276123
Epoch: 11, Steps: 89 | Train Loss: 0.230 Vali Loss: 1.038 Vali Acc: 0.941 Test Loss: 1.038 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.712055206298828
Epoch: 12, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.614 Vali Acc: 0.967 Test Loss: 0.614 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.765860080718994
Epoch: 13, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.742 Vali Acc: 0.955 Test Loss: 0.742 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.743654489517212
Epoch: 14, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.724 Vali Acc: 0.967 Test Loss: 0.724 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.3212032318115234
Epoch: 15, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.666 Vali Acc: 0.976 Test Loss: 0.666 Test Acc: 0.976
Validation loss decreased (-0.972835 --> -0.975620).  Saving model ...
Epoch: 16 cost time: 3.4637374877929688
Epoch: 16, Steps: 89 | Train Loss: 0.119 Vali Loss: 1.188 Vali Acc: 0.950 Test Loss: 1.188 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.614854097366333
Epoch: 17, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.995 Vali Acc: 0.954 Test Loss: 0.995 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.5585155487060547
Epoch: 18, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.764 Vali Acc: 0.974 Test Loss: 0.764 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.5542232990264893
Epoch: 19, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.733 Vali Acc: 0.972 Test Loss: 0.733 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.553304672241211
Epoch: 20, Steps: 89 | Train Loss: 0.246 Vali Loss: 1.142 Vali Acc: 0.952 Test Loss: 1.142 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.579843044281006
Epoch: 21, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.761 Vali Acc: 0.971 Test Loss: 0.761 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6074063777923584
Epoch: 22, Steps: 89 | Train Loss: 0.177 Vali Loss: 1.059 Vali Acc: 0.964 Test Loss: 1.059 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.6258180141448975
Epoch: 23, Steps: 89 | Train Loss: 0.033 Vali Loss: 1.078 Vali Acc: 0.969 Test Loss: 1.078 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.577796220779419
Epoch: 24, Steps: 89 | Train Loss: 0.100 Vali Loss: 1.030 Vali Acc: 0.974 Test Loss: 1.030 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.7734463214874268
Epoch: 25, Steps: 89 | Train Loss: 0.191 Vali Loss: 1.244 Vali Acc: 0.958 Test Loss: 1.244 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2467376
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.963947057723999
Epoch: 1, Steps: 89 | Train Loss: 0.815 Vali Loss: 0.252 Vali Acc: 0.936 Test Loss: 0.252 Test Acc: 0.936
Validation loss decreased (inf --> -0.935931).  Saving model ...
Epoch: 2 cost time: 3.347280263900757
Epoch: 2, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.312 Vali Acc: 0.932 Test Loss: 0.312 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.253274917602539
Epoch: 3, Steps: 89 | Train Loss: 0.261 Vali Loss: 0.319 Vali Acc: 0.955 Test Loss: 0.319 Test Acc: 0.955
Validation loss decreased (-0.935931 --> -0.955429).  Saving model ...
Epoch: 4 cost time: 3.5705790519714355
Epoch: 4, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.392 Vali Acc: 0.954 Test Loss: 0.392 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1937265396118164
Epoch: 5, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.373 Vali Acc: 0.948 Test Loss: 0.373 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.0525104999542236
Epoch: 6, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.385 Vali Acc: 0.964 Test Loss: 0.385 Test Acc: 0.964
Validation loss decreased (-0.955429 --> -0.963784).  Saving model ...
Epoch: 7 cost time: 3.0971782207489014
Epoch: 7, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.492 Vali Acc: 0.953 Test Loss: 0.492 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.225667715072632
Epoch: 8, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.697 Vali Acc: 0.951 Test Loss: 0.697 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.292104959487915
Epoch: 9, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.492 Vali Acc: 0.968 Test Loss: 0.492 Test Acc: 0.968
Validation loss decreased (-0.963784 --> -0.967962).  Saving model ...
Epoch: 10 cost time: 3.215456485748291
Epoch: 10, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.667 Vali Acc: 0.961 Test Loss: 0.667 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1768839359283447
Epoch: 11, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.721 Vali Acc: 0.953 Test Loss: 0.721 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.299078941345215
Epoch: 12, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.412 Vali Acc: 0.976 Test Loss: 0.412 Test Acc: 0.976
Validation loss decreased (-0.967962 --> -0.975623).  Saving model ...
Epoch: 13 cost time: 3.476985454559326
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.413 Vali Acc: 0.974 Test Loss: 0.413 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.381422996520996
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.566 Vali Acc: 0.954 Test Loss: 0.566 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.484363555908203
Epoch: 15, Steps: 89 | Train Loss: 0.447 Vali Loss: 0.682 Vali Acc: 0.955 Test Loss: 0.682 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.6399269104003906
Epoch: 16, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.751 Vali Acc: 0.952 Test Loss: 0.751 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.517380714416504
Epoch: 17, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.682 Vali Acc: 0.958 Test Loss: 0.682 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.50260066986084
Epoch: 18, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.663 Vali Acc: 0.968 Test Loss: 0.663 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.618227958679199
Epoch: 19, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.860 Vali Acc: 0.964 Test Loss: 0.860 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.5931246280670166
Epoch: 20, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.738 Vali Acc: 0.958 Test Loss: 0.738 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.345423698425293
Epoch: 21, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.548 Vali Acc: 0.973 Test Loss: 0.548 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.3704893589019775
Epoch: 22, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.759 Vali Acc: 0.960 Test Loss: 0.759 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 2467376
model size : 19.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.782425403594971
Epoch: 1, Steps: 89 | Train Loss: 0.870 Vali Loss: 0.380 Vali Acc: 0.905 Test Loss: 0.380 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 3.0272789001464844
Epoch: 2, Steps: 89 | Train Loss: 0.337 Vali Loss: 0.603 Vali Acc: 0.884 Test Loss: 0.603 Test Acc: 0.884
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.8119568824768066
Epoch: 3, Steps: 89 | Train Loss: 0.348 Vali Loss: 0.328 Vali Acc: 0.938 Test Loss: 0.328 Test Acc: 0.938
Validation loss decreased (-0.905289 --> -0.938019).  Saving model ...
Epoch: 4 cost time: 2.804351568222046
Epoch: 4, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.385 Vali Acc: 0.928 Test Loss: 0.385 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7821826934814453
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.384 Vali Acc: 0.939 Test Loss: 0.384 Test Acc: 0.939
Validation loss decreased (-0.938019 --> -0.938715).  Saving model ...
Epoch: 6 cost time: 3.1449153423309326
Epoch: 6, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.582 Vali Acc: 0.927 Test Loss: 0.582 Test Acc: 0.927
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.082969903945923
Epoch: 7, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.335 Vali Acc: 0.963 Test Loss: 0.335 Test Acc: 0.963
Validation loss decreased (-0.938715 --> -0.963089).  Saving model ...
Epoch: 8 cost time: 3.3139872550964355
Epoch: 8, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.820 Vali Acc: 0.907 Test Loss: 0.820 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.2999513149261475
Epoch: 9, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.427 Vali Acc: 0.961 Test Loss: 0.427 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.283345937728882
Epoch: 10, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.414 Vali Acc: 0.965 Test Loss: 0.414 Test Acc: 0.965
Validation loss decreased (-0.963089 --> -0.965177).  Saving model ...
Epoch: 11 cost time: 3.0964395999908447
Epoch: 11, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.373 Vali Acc: 0.971 Test Loss: 0.373 Test Acc: 0.971
Validation loss decreased (-0.965177 --> -0.970748).  Saving model ...
Epoch: 12 cost time: 3.1139109134674072
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.570 Vali Acc: 0.944 Test Loss: 0.570 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.2474234104156494
Epoch: 13, Steps: 89 | Train Loss: 0.194 Vali Loss: 0.555 Vali Acc: 0.960 Test Loss: 0.555 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.1132142543792725
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.455 Vali Acc: 0.955 Test Loss: 0.455 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9839394092559814
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.493 Vali Acc: 0.969 Test Loss: 0.493 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8856115341186523
Epoch: 16, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.732 Vali Acc: 0.953 Test Loss: 0.732 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.813887119293213
Epoch: 17, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.677 Vali Acc: 0.963 Test Loss: 0.677 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9810903072357178
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.757 Vali Acc: 0.959 Test Loss: 0.757 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9958324432373047
Epoch: 19, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.950 Vali Acc: 0.947 Test Loss: 0.950 Test Acc: 0.947
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.0692760944366455
Epoch: 20, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.649 Vali Acc: 0.971 Test Loss: 0.649 Test Acc: 0.971
Validation loss decreased (-0.970748 --> -0.971442).  Saving model ...
Epoch: 21 cost time: 2.8021085262298584
Epoch: 21, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.750 Vali Acc: 0.958 Test Loss: 0.750 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.878526449203491
Epoch: 22, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.671 Vali Acc: 0.971 Test Loss: 0.671 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9832749366760254
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 1.197 Vali Acc: 0.944 Test Loss: 1.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.1194605827331543
Epoch: 24, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.798 Vali Acc: 0.956 Test Loss: 0.798 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.180417776107788
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.670 Vali Acc: 0.968 Test Loss: 0.670 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.276132822036743
Epoch: 26, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.730 Vali Acc: 0.964 Test Loss: 0.730 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.0492489337921143
Epoch: 27, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.622 Vali Acc: 0.971 Test Loss: 0.622 Test Acc: 0.971
Validation loss decreased (-0.971442 --> -0.971442).  Saving model ...
Epoch: 28 cost time: 3.1489510536193848
Epoch: 28, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.623 Vali Acc: 0.971 Test Loss: 0.623 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.9891486167907715
Epoch: 29, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.967 Test Loss: 0.742 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.1924407482147217
Epoch: 30, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.627 Vali Acc: 0.972 Test Loss: 0.627 Test Acc: 0.972
Validation loss decreased (-0.971442 --> -0.972139).  Saving model ...
Epoch: 31 cost time: 2.964116334915161
Epoch: 31, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.719 Vali Acc: 0.970 Test Loss: 0.719 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.983778953552246
Epoch: 32, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.985 Vali Acc: 0.961 Test Loss: 0.985 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.8644587993621826
Epoch: 33, Steps: 89 | Train Loss: 0.112 Vali Loss: 1.072 Vali Acc: 0.952 Test Loss: 1.072 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 3.007643699645996
Epoch: 34, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.780 Vali Acc: 0.967 Test Loss: 0.780 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 3.0106725692749023
Epoch: 35, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.713 Vali Acc: 0.968 Test Loss: 0.713 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.0238606929779053
Epoch: 36, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.655 Vali Acc: 0.977 Test Loss: 0.655 Test Acc: 0.977
Validation loss decreased (-0.972139 --> -0.977013).  Saving model ...
Epoch: 37 cost time: 3.1097805500030518
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.706 Vali Acc: 0.969 Test Loss: 0.706 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 3.1566693782806396
Epoch: 38, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.939 Vali Acc: 0.953 Test Loss: 0.939 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 3.1819121837615967
Epoch: 39, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.813 Vali Acc: 0.963 Test Loss: 0.813 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 2.8902180194854736
Epoch: 40, Steps: 89 | Train Loss: 0.062 Vali Loss: 1.014 Vali Acc: 0.953 Test Loss: 1.014 Test Acc: 0.953
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 2.8581717014312744
Epoch: 41, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.899 Vali Acc: 0.960 Test Loss: 0.899 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 3.2153759002685547
Epoch: 42, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.797 Vali Acc: 0.967 Test Loss: 0.797 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 3.357339859008789
Epoch: 43, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.786 Vali Acc: 0.971 Test Loss: 0.786 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 3.4452714920043945
Epoch: 44, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.723 Vali Acc: 0.974 Test Loss: 0.723 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 3.2664995193481445
Epoch: 45, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.855 Vali Acc: 0.962 Test Loss: 0.855 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 3.1658124923706055
Epoch: 46, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.902 Vali Acc: 0.964 Test Loss: 0.902 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 2118448
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.714877605438232
Epoch: 1, Steps: 89 | Train Loss: 0.861 Vali Loss: 0.357 Vali Acc: 0.899 Test Loss: 0.357 Test Acc: 0.899
Validation loss decreased (inf --> -0.899022).  Saving model ...
Epoch: 2 cost time: 3.1734459400177
Epoch: 2, Steps: 89 | Train Loss: 0.309 Vali Loss: 0.569 Vali Acc: 0.873 Test Loss: 0.569 Test Acc: 0.873
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.9795424938201904
Epoch: 3, Steps: 89 | Train Loss: 0.347 Vali Loss: 0.332 Vali Acc: 0.927 Test Loss: 0.332 Test Acc: 0.927
Validation loss decreased (-0.899022 --> -0.926877).  Saving model ...
Epoch: 4 cost time: 2.767293930053711
Epoch: 4, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.346 Vali Acc: 0.948 Test Loss: 0.346 Test Acc: 0.948
Validation loss decreased (-0.926877 --> -0.947768).  Saving model ...
Epoch: 5 cost time: 2.8576269149780273
Epoch: 5, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.469 Vali Acc: 0.932 Test Loss: 0.469 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8599371910095215
Epoch: 6, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.341 Vali Acc: 0.951 Test Loss: 0.341 Test Acc: 0.951
Validation loss decreased (-0.947768 --> -0.951250).  Saving model ...
Epoch: 7 cost time: 2.8695414066314697
Epoch: 7, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.417 Vali Acc: 0.947 Test Loss: 0.417 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.903538227081299
Epoch: 8, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.407 Vali Acc: 0.962 Test Loss: 0.407 Test Acc: 0.962
Validation loss decreased (-0.951250 --> -0.962391).  Saving model ...
Epoch: 9 cost time: 2.9753429889678955
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.505 Vali Acc: 0.951 Test Loss: 0.505 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6310644149780273
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.411 Vali Acc: 0.953 Test Loss: 0.411 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.057354211807251
Epoch: 11, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.652 Vali Acc: 0.938 Test Loss: 0.652 Test Acc: 0.938
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.9408013820648193
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.410 Vali Acc: 0.962 Test Loss: 0.410 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9799609184265137
Epoch: 13, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.421 Vali Acc: 0.960 Test Loss: 0.421 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1522326469421387
Epoch: 14, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.390 Vali Acc: 0.967 Test Loss: 0.390 Test Acc: 0.967
Validation loss decreased (-0.962391 --> -0.967266).  Saving model ...
Epoch: 15 cost time: 3.177617311477661
Epoch: 15, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.442 Vali Acc: 0.966 Test Loss: 0.442 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.387608051300049
Epoch: 16, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.415 Vali Acc: 0.971 Test Loss: 0.415 Test Acc: 0.971
Validation loss decreased (-0.967266 --> -0.970748).  Saving model ...
Epoch: 17 cost time: 2.8682706356048584
Epoch: 17, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.413 Vali Acc: 0.971 Test Loss: 0.413 Test Acc: 0.971
Validation loss decreased (-0.970748 --> -0.970748).  Saving model ...
Epoch: 18 cost time: 3.419391632080078
Epoch: 18, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.514 Vali Acc: 0.971 Test Loss: 0.514 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4376978874206543
Epoch: 19, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.728 Vali Acc: 0.956 Test Loss: 0.728 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4404211044311523
Epoch: 20, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.704 Vali Acc: 0.962 Test Loss: 0.704 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4620847702026367
Epoch: 21, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.500 Vali Acc: 0.975 Test Loss: 0.500 Test Acc: 0.975
Validation loss decreased (-0.970748 --> -0.974925).  Saving model ...
Epoch: 22 cost time: 2.8104047775268555
Epoch: 22, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.507 Vali Acc: 0.970 Test Loss: 0.507 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.8766748905181885
Epoch: 23, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.547 Vali Acc: 0.966 Test Loss: 0.547 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 3.055988073348999
Epoch: 24, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.460 Vali Acc: 0.971 Test Loss: 0.460 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.98138165473938
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.505 Vali Acc: 0.968 Test Loss: 0.505 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.947970151901245
Epoch: 26, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.612 Vali Acc: 0.960 Test Loss: 0.612 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.883052110671997
Epoch: 27, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.541 Vali Acc: 0.970 Test Loss: 0.541 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9684648513793945
Epoch: 28, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.552 Vali Acc: 0.974 Test Loss: 0.552 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.976775884628296
Epoch: 29, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.812 Vali Acc: 0.959 Test Loss: 0.812 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.001271963119507
Epoch: 30, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.760 Vali Acc: 0.960 Test Loss: 0.760 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.9888179302215576
Epoch: 31, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.635 Vali Acc: 0.969 Test Loss: 0.635 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 2118448
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.93416166305542
Epoch: 1, Steps: 89 | Train Loss: 0.855 Vali Loss: 0.315 Vali Acc: 0.906 Test Loss: 0.315 Test Acc: 0.906
Validation loss decreased (inf --> -0.905986).  Saving model ...
Epoch: 2 cost time: 3.2961554527282715
Epoch: 2, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.332 Vali Acc: 0.921 Test Loss: 0.332 Test Acc: 0.921
Validation loss decreased (-0.905986 --> -0.920609).  Saving model ...
Epoch: 3 cost time: 3.136108636856079
Epoch: 3, Steps: 89 | Train Loss: 0.212 Vali Loss: 0.277 Vali Acc: 0.939 Test Loss: 0.277 Test Acc: 0.939
Validation loss decreased (-0.920609 --> -0.938716).  Saving model ...
Epoch: 4 cost time: 3.293592691421509
Epoch: 4, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.271 Vali Acc: 0.953 Test Loss: 0.271 Test Acc: 0.953
Validation loss decreased (-0.938716 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 3.055422782897949
Epoch: 5, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.411 Vali Acc: 0.934 Test Loss: 0.411 Test Acc: 0.934
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7916364669799805
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.445 Vali Acc: 0.930 Test Loss: 0.445 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.786529779434204
Epoch: 7, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.459 Vali Acc: 0.948 Test Loss: 0.459 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0156357288360596
Epoch: 8, Steps: 89 | Train Loss: 0.153 Vali Loss: 0.449 Vali Acc: 0.949 Test Loss: 0.449 Test Acc: 0.949
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.740485191345215
Epoch: 9, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.292 Vali Acc: 0.978 Test Loss: 0.292 Test Acc: 0.978
Validation loss decreased (-0.952644 --> -0.977713).  Saving model ...
Epoch: 10 cost time: 2.8193001747131348
Epoch: 10, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.372 Vali Acc: 0.973 Test Loss: 0.372 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7634215354919434
Epoch: 11, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.351 Vali Acc: 0.974 Test Loss: 0.351 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7695977687835693
Epoch: 12, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.838 Vali Acc: 0.925 Test Loss: 0.838 Test Acc: 0.925
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.799788236618042
Epoch: 13, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.548 Vali Acc: 0.959 Test Loss: 0.548 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.0791003704071045
Epoch: 14, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.395 Vali Acc: 0.965 Test Loss: 0.395 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.9668352603912354
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.453 Vali Acc: 0.964 Test Loss: 0.453 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.8825478553771973
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.358 Vali Acc: 0.973 Test Loss: 0.358 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.1824629306793213
Epoch: 17, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.385 Vali Acc: 0.969 Test Loss: 0.385 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.1440210342407227
Epoch: 18, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.329 Vali Acc: 0.969 Test Loss: 0.329 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.055206298828125
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.529 Vali Acc: 0.962 Test Loss: 0.529 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 2118448
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.462984561920166
Epoch: 1, Steps: 89 | Train Loss: 0.903 Vali Loss: 0.294 Vali Acc: 0.913 Test Loss: 0.294 Test Acc: 0.913
Validation loss decreased (inf --> -0.912950).  Saving model ...
Epoch: 2 cost time: 2.927840232849121
Epoch: 2, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.912950 --> -0.944288).  Saving model ...
Epoch: 3 cost time: 2.668168544769287
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.217 Vali Acc: 0.939 Test Loss: 0.217 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5847740173339844
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.270 Vali Acc: 0.946 Test Loss: 0.270 Test Acc: 0.946
Validation loss decreased (-0.944288 --> -0.945680).  Saving model ...
Epoch: 5 cost time: 2.602118730545044
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.266 Vali Acc: 0.946 Test Loss: 0.266 Test Acc: 0.946
Validation loss decreased (-0.945680 --> -0.946376).  Saving model ...
Epoch: 6 cost time: 2.7998404502868652
Epoch: 6, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.285 Vali Acc: 0.952 Test Loss: 0.285 Test Acc: 0.952
Validation loss decreased (-0.946376 --> -0.951947).  Saving model ...
Epoch: 7 cost time: 2.697810173034668
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.404 Vali Acc: 0.941 Test Loss: 0.404 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6959164142608643
Epoch: 8, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.281 Vali Acc: 0.961 Test Loss: 0.281 Test Acc: 0.961
Validation loss decreased (-0.951947 --> -0.961000).  Saving model ...
Epoch: 9 cost time: 2.4936840534210205
Epoch: 9, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.283 Vali Acc: 0.965 Test Loss: 0.283 Test Acc: 0.965
Validation loss decreased (-0.961000 --> -0.965178).  Saving model ...
Epoch: 10 cost time: 2.540494680404663
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.340 Vali Acc: 0.960 Test Loss: 0.340 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.745164632797241
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.237 Vali Acc: 0.974 Test Loss: 0.237 Test Acc: 0.974
Validation loss decreased (-0.965178 --> -0.974232).  Saving model ...
Epoch: 12 cost time: 3.0522897243499756
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.300 Vali Acc: 0.969 Test Loss: 0.300 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.861731767654419
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.294 Vali Acc: 0.974 Test Loss: 0.294 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.3424606323242188
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.253 Vali Acc: 0.974 Test Loss: 0.253 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.344736099243164
Epoch: 15, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.265 Vali Acc: 0.980 Test Loss: 0.265 Test Acc: 0.980
Validation loss decreased (-0.974232 --> -0.979802).  Saving model ...
Epoch: 16 cost time: 3.107774496078491
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.315 Vali Acc: 0.969 Test Loss: 0.315 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9393808841705322
Epoch: 17, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.639 Vali Acc: 0.938 Test Loss: 0.639 Test Acc: 0.938
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.31152081489563
Epoch: 18, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.538 Vali Acc: 0.953 Test Loss: 0.538 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.209811210632324
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.445 Vali Acc: 0.969 Test Loss: 0.445 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.266484498977661
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.408 Vali Acc: 0.970 Test Loss: 0.408 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.0823967456817627
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.350 Vali Acc: 0.975 Test Loss: 0.350 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.018975257873535
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.515 Vali Acc: 0.955 Test Loss: 0.515 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.89255428314209
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.418 Vali Acc: 0.964 Test Loss: 0.418 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.8965725898742676
Epoch: 24, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.422 Vali Acc: 0.960 Test Loss: 0.422 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.051281690597534
Epoch: 25, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.459 Vali Acc: 0.968 Test Loss: 0.459 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 2118448
model size : 12.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.6073079109191895
Epoch: 1, Steps: 89 | Train Loss: 0.888 Vali Loss: 0.518 Vali Acc: 0.883 Test Loss: 0.518 Test Acc: 0.883
Validation loss decreased (inf --> -0.883003).  Saving model ...
Epoch: 2 cost time: 2.751692533493042
Epoch: 2, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.377 Vali Acc: 0.907 Test Loss: 0.377 Test Acc: 0.907
Validation loss decreased (-0.883003 --> -0.906681).  Saving model ...
Epoch: 3 cost time: 2.671640634536743
Epoch: 3, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.333 Vali Acc: 0.926 Test Loss: 0.333 Test Acc: 0.926
Validation loss decreased (-0.906681 --> -0.926181).  Saving model ...
Epoch: 4 cost time: 3.1349189281463623
Epoch: 4, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.935 Vali Acc: 0.908 Test Loss: 0.935 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.1954362392425537
Epoch: 5, Steps: 89 | Train Loss: 0.308 Vali Loss: 0.333 Vali Acc: 0.962 Test Loss: 0.333 Test Acc: 0.962
Validation loss decreased (-0.926181 --> -0.962392).  Saving model ...
Epoch: 6 cost time: 3.336578845977783
Epoch: 6, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.356 Vali Acc: 0.955 Test Loss: 0.356 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.152255058288574
Epoch: 7, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.399 Vali Acc: 0.952 Test Loss: 0.399 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2039854526519775
Epoch: 8, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.328 Vali Acc: 0.964 Test Loss: 0.328 Test Acc: 0.964
Validation loss decreased (-0.962392 --> -0.964481).  Saving model ...
Epoch: 9 cost time: 3.2493202686309814
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.334 Vali Acc: 0.967 Test Loss: 0.334 Test Acc: 0.967
Validation loss decreased (-0.964481 --> -0.966570).  Saving model ...
Epoch: 10 cost time: 3.22047758102417
Epoch: 10, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.475 Vali Acc: 0.957 Test Loss: 0.475 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0876657962799072
Epoch: 11, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.486 Vali Acc: 0.953 Test Loss: 0.486 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9684503078460693
Epoch: 12, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.542 Vali Acc: 0.965 Test Loss: 0.542 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.976780652999878
Epoch: 13, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.454 Vali Acc: 0.967 Test Loss: 0.454 Test Acc: 0.967
Validation loss decreased (-0.966570 --> -0.967266).  Saving model ...
Epoch: 14 cost time: 3.053640842437744
Epoch: 14, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.675 Vali Acc: 0.960 Test Loss: 0.675 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0137314796447754
Epoch: 15, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.752 Vali Acc: 0.959 Test Loss: 0.752 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.969987154006958
Epoch: 16, Steps: 89 | Train Loss: 0.072 Vali Loss: 1.034 Vali Acc: 0.944 Test Loss: 1.034 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.88274884223938
Epoch: 17, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.664 Vali Acc: 0.962 Test Loss: 0.664 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.1721413135528564
Epoch: 18, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.673 Vali Acc: 0.969 Test Loss: 0.673 Test Acc: 0.969
Validation loss decreased (-0.967266 --> -0.968656).  Saving model ...
Epoch: 19 cost time: 3.0146095752716064
Epoch: 19, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.678 Vali Acc: 0.960 Test Loss: 0.678 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.9932093620300293
Epoch: 20, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.716 Vali Acc: 0.961 Test Loss: 0.716 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.1064109802246094
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.681 Vali Acc: 0.959 Test Loss: 0.681 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.500962257385254
Epoch: 22, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.664 Vali Acc: 0.966 Test Loss: 0.664 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.4525914192199707
Epoch: 23, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.664 Vali Acc: 0.971 Test Loss: 0.664 Test Acc: 0.971
Validation loss decreased (-0.968656 --> -0.971442).  Saving model ...
Epoch: 24 cost time: 3.405808448791504
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.713 Vali Acc: 0.969 Test Loss: 0.713 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.4660303592681885
Epoch: 25, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.603 Vali Acc: 0.976 Test Loss: 0.603 Test Acc: 0.976
Validation loss decreased (-0.971442 --> -0.976317).  Saving model ...
Epoch: 26 cost time: 3.292755365371704
Epoch: 26, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.662 Vali Acc: 0.969 Test Loss: 0.662 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.19875431060791
Epoch: 27, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.826 Vali Acc: 0.960 Test Loss: 0.826 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.3288235664367676
Epoch: 28, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.988 Vali Acc: 0.951 Test Loss: 0.988 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.492931604385376
Epoch: 29, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.921 Vali Acc: 0.955 Test Loss: 0.921 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.8812668323516846
Epoch: 30, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.842 Vali Acc: 0.969 Test Loss: 0.842 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.8117451667785645
Epoch: 31, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.942 Vali Acc: 0.967 Test Loss: 0.942 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 3.2771761417388916
Epoch: 32, Steps: 89 | Train Loss: 0.096 Vali Loss: 1.044 Vali Acc: 0.955 Test Loss: 1.044 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 3.335338592529297
Epoch: 33, Steps: 89 | Train Loss: 0.176 Vali Loss: 2.134 Vali Acc: 0.925 Test Loss: 2.134 Test Acc: 0.925
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 3.2367992401123047
Epoch: 34, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.824 Vali Acc: 0.960 Test Loss: 0.824 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.6408157348632812
Epoch: 35, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.600 Vali Acc: 0.976 Test Loss: 0.600 Test Acc: 0.976
Validation loss decreased (-0.976317 --> -0.976317).  Saving model ...
Epoch: 36 cost time: 3.664027452468872
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.615 Vali Acc: 0.976 Test Loss: 0.615 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 3.9392881393432617
Epoch: 37, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.623 Vali Acc: 0.979 Test Loss: 0.623 Test Acc: 0.979
Validation loss decreased (-0.976317 --> -0.979102).  Saving model ...
Epoch: 38 cost time: 3.5227103233337402
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.623 Vali Acc: 0.979 Test Loss: 0.623 Test Acc: 0.979
Validation loss decreased (-0.979102 --> -0.979102).  Saving model ...
Epoch: 39 cost time: 3.180527448654175
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.620 Vali Acc: 0.978 Test Loss: 0.620 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 3.465766429901123
Epoch: 40, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.579 Vali Acc: 0.979 Test Loss: 0.579 Test Acc: 0.979
Validation loss decreased (-0.979102 --> -0.979103).  Saving model ...
Epoch: 41 cost time: 3.9013261795043945
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 1.075 Vali Acc: 0.955 Test Loss: 1.075 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 3.849506139755249
Epoch: 42, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.735 Vali Acc: 0.967 Test Loss: 0.735 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 3.271578788757324
Epoch: 43, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.721 Vali Acc: 0.975 Test Loss: 0.721 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 3.2108347415924072
Epoch: 44, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.714 Vali Acc: 0.974 Test Loss: 0.714 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 3.252768039703369
Epoch: 45, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.723 Vali Acc: 0.972 Test Loss: 0.723 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 3.5816259384155273
Epoch: 46, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.999 Vali Acc: 0.958 Test Loss: 0.999 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 3.425173282623291
Epoch: 47, Steps: 89 | Train Loss: 0.075 Vali Loss: 1.212 Vali Acc: 0.959 Test Loss: 1.212 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 3.733358144760132
Epoch: 48, Steps: 89 | Train Loss: 0.107 Vali Loss: 1.065 Vali Acc: 0.964 Test Loss: 1.065 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 3.236609697341919
Epoch: 49, Steps: 89 | Train Loss: 0.205 Vali Loss: 0.916 Vali Acc: 0.958 Test Loss: 0.916 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 3.116201877593994
Epoch: 50, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.910 Vali Acc: 0.967 Test Loss: 0.910 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 1594160
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.530665159225464
Epoch: 1, Steps: 89 | Train Loss: 0.881 Vali Loss: 0.445 Vali Acc: 0.894 Test Loss: 0.445 Test Acc: 0.894
Validation loss decreased (inf --> -0.894146).  Saving model ...
Epoch: 2 cost time: 3.4407858848571777
Epoch: 2, Steps: 89 | Train Loss: 0.294 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.894146 --> -0.926181).  Saving model ...
Epoch: 3 cost time: 3.235111713409424
Epoch: 3, Steps: 89 | Train Loss: 0.231 Vali Loss: 0.455 Vali Acc: 0.902 Test Loss: 0.455 Test Acc: 0.902
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9068992137908936
Epoch: 4, Steps: 89 | Train Loss: 0.255 Vali Loss: 1.307 Vali Acc: 0.904 Test Loss: 1.307 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.226231813430786
Epoch: 5, Steps: 89 | Train Loss: 0.278 Vali Loss: 0.267 Vali Acc: 0.955 Test Loss: 0.267 Test Acc: 0.955
Validation loss decreased (-0.926181 --> -0.955429).  Saving model ...
Epoch: 6 cost time: 3.2491066455841064
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.326 Vali Acc: 0.960 Test Loss: 0.326 Test Acc: 0.960
Validation loss decreased (-0.955429 --> -0.960303).  Saving model ...
Epoch: 7 cost time: 3.6678884029388428
Epoch: 7, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.417 Vali Acc: 0.949 Test Loss: 0.417 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.886690139770508
Epoch: 8, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.334 Vali Acc: 0.957 Test Loss: 0.334 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.8290326595306396
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.322 Vali Acc: 0.962 Test Loss: 0.322 Test Acc: 0.962
Validation loss decreased (-0.960303 --> -0.961696).  Saving model ...
Epoch: 10 cost time: 3.1383559703826904
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
Validation loss decreased (-0.961696 --> -0.970053).  Saving model ...
Epoch: 11 cost time: 3.382140636444092
Epoch: 11, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.754 Vali Acc: 0.935 Test Loss: 0.754 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2952916622161865
Epoch: 12, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.447 Vali Acc: 0.959 Test Loss: 0.447 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.3250391483306885
Epoch: 13, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.454 Vali Acc: 0.964 Test Loss: 0.454 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.279266119003296
Epoch: 14, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.552 Vali Acc: 0.962 Test Loss: 0.552 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.267648935317993
Epoch: 15, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.625 Vali Acc: 0.959 Test Loss: 0.625 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.5948197841644287
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.751 Vali Acc: 0.938 Test Loss: 0.751 Test Acc: 0.938
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.262766122817993
Epoch: 17, Steps: 89 | Train Loss: 0.242 Vali Loss: 0.612 Vali Acc: 0.968 Test Loss: 0.612 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.3837368488311768
Epoch: 18, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.633 Vali Acc: 0.958 Test Loss: 0.633 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.89998722076416
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.818 Vali Acc: 0.949 Test Loss: 0.818 Test Acc: 0.949
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.4963881969451904
Epoch: 20, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.693 Vali Acc: 0.958 Test Loss: 0.693 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 1594160
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.0357420444488525
Epoch: 1, Steps: 89 | Train Loss: 0.882 Vali Loss: 0.464 Vali Acc: 0.896 Test Loss: 0.464 Test Acc: 0.896
Validation loss decreased (inf --> -0.896235).  Saving model ...
Epoch: 2 cost time: 3.4545676708221436
Epoch: 2, Steps: 89 | Train Loss: 0.263 Vali Loss: 0.253 Vali Acc: 0.933 Test Loss: 0.253 Test Acc: 0.933
Validation loss decreased (-0.896235 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 2.9010133743286133
Epoch: 3, Steps: 89 | Train Loss: 0.185 Vali Loss: 0.224 Vali Acc: 0.947 Test Loss: 0.224 Test Acc: 0.947
Validation loss decreased (-0.933145 --> -0.947073).  Saving model ...
Epoch: 4 cost time: 2.8801398277282715
Epoch: 4, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.212 Vali Acc: 0.951 Test Loss: 0.212 Test Acc: 0.951
Validation loss decreased (-0.947073 --> -0.951251).  Saving model ...
Epoch: 5 cost time: 3.0988223552703857
Epoch: 5, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.331 Vali Acc: 0.944 Test Loss: 0.331 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3965513706207275
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.348 Vali Acc: 0.953 Test Loss: 0.348 Test Acc: 0.953
Validation loss decreased (-0.951251 --> -0.952643).  Saving model ...
Epoch: 7 cost time: 3.012836456298828
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.340 Vali Acc: 0.950 Test Loss: 0.340 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0887598991394043
Epoch: 8, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.392 Vali Acc: 0.960 Test Loss: 0.392 Test Acc: 0.960
Validation loss decreased (-0.952643 --> -0.959606).  Saving model ...
Epoch: 9 cost time: 2.903170347213745
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.298 Vali Acc: 0.967 Test Loss: 0.298 Test Acc: 0.967
Validation loss decreased (-0.959606 --> -0.966571).  Saving model ...
Epoch: 10 cost time: 3.182908773422241
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.682 Vali Acc: 0.925 Test Loss: 0.682 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.368586778640747
Epoch: 11, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.407 Vali Acc: 0.967 Test Loss: 0.407 Test Acc: 0.967
Validation loss decreased (-0.966571 --> -0.967266).  Saving model ...
Epoch: 12 cost time: 3.8223488330841064
Epoch: 12, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.624 Vali Acc: 0.949 Test Loss: 0.624 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.6987862586975098
Epoch: 13, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.752 Vali Acc: 0.952 Test Loss: 0.752 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.2623672485351562
Epoch: 14, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.458 Vali Acc: 0.953 Test Loss: 0.458 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3510351181030273
Epoch: 15, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.352 Vali Acc: 0.969 Test Loss: 0.352 Test Acc: 0.969
Validation loss decreased (-0.967266 --> -0.968659).  Saving model ...
Epoch: 16 cost time: 3.5814907550811768
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.329 Vali Acc: 0.976 Test Loss: 0.329 Test Acc: 0.976
Validation loss decreased (-0.968659 --> -0.976320).  Saving model ...
Epoch: 17 cost time: 4.0784690380096436
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.430 Vali Acc: 0.966 Test Loss: 0.430 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.7540764808654785
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.420 Vali Acc: 0.976 Test Loss: 0.420 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.0596861839294434
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.354 Vali Acc: 0.973 Test Loss: 0.354 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.022073268890381
Epoch: 20, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.511 Vali Acc: 0.962 Test Loss: 0.511 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.344965696334839
Epoch: 21, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.609 Vali Acc: 0.964 Test Loss: 0.609 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 3.8797459602355957
Epoch: 22, Steps: 89 | Train Loss: 0.173 Vali Loss: 0.714 Vali Acc: 0.963 Test Loss: 0.714 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.7668209075927734
Epoch: 23, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.608 Vali Acc: 0.964 Test Loss: 0.608 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.4202871322631836
Epoch: 24, Steps: 89 | Train Loss: 0.248 Vali Loss: 0.633 Vali Acc: 0.967 Test Loss: 0.633 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.1096229553222656
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.737 Vali Acc: 0.962 Test Loss: 0.737 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9576199054718018
Epoch: 26, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.571 Vali Acc: 0.973 Test Loss: 0.571 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1594160
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.427640914916992
Epoch: 1, Steps: 89 | Train Loss: 0.931 Vali Loss: 0.301 Vali Acc: 0.921 Test Loss: 0.301 Test Acc: 0.921
Validation loss decreased (inf --> -0.920610).  Saving model ...
Epoch: 2 cost time: 3.103949785232544
Epoch: 2, Steps: 89 | Train Loss: 0.183 Vali Loss: 0.240 Vali Acc: 0.938 Test Loss: 0.240 Test Acc: 0.938
Validation loss decreased (-0.920610 --> -0.938020).  Saving model ...
Epoch: 3 cost time: 2.74747371673584
Epoch: 3, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.148 Vali Acc: 0.964 Test Loss: 0.148 Test Acc: 0.964
Validation loss decreased (-0.938020 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 2.9886956214904785
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.253 Vali Acc: 0.939 Test Loss: 0.253 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.527489423751831
Epoch: 5, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.211 Vali Acc: 0.958 Test Loss: 0.211 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.540508985519409
Epoch: 6, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 3.0660958290100098
Epoch: 7, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.248 Vali Acc: 0.961 Test Loss: 0.248 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9161672592163086
Epoch: 8, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.196 Vali Acc: 0.970 Test Loss: 0.196 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7069129943847656
Epoch: 9, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.448 Vali Acc: 0.934 Test Loss: 0.448 Test Acc: 0.934
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.8377811908721924
Epoch: 10, Steps: 89 | Train Loss: 0.184 Vali Loss: 0.336 Vali Acc: 0.961 Test Loss: 0.336 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.027252197265625
Epoch: 11, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.311 Vali Acc: 0.970 Test Loss: 0.311 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.1921324729919434
Epoch: 12, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.368 Vali Acc: 0.955 Test Loss: 0.368 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.9766008853912354
Epoch: 13, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.261 Vali Acc: 0.969 Test Loss: 0.261 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.797058582305908
Epoch: 14, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.277 Vali Acc: 0.974 Test Loss: 0.277 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973535).  Saving model ...
Epoch: 15 cost time: 2.7486202716827393
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.255 Vali Acc: 0.977 Test Loss: 0.255 Test Acc: 0.977
Validation loss decreased (-0.973535 --> -0.977017).  Saving model ...
Epoch: 16 cost time: 2.903585195541382
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.370 Vali Acc: 0.960 Test Loss: 0.370 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.207108736038208
Epoch: 17, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.378 Vali Acc: 0.964 Test Loss: 0.378 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.2451229095458984
Epoch: 18, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.466 Vali Acc: 0.953 Test Loss: 0.466 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.2166590690612793
Epoch: 19, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.350 Vali Acc: 0.973 Test Loss: 0.350 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.0519042015075684
Epoch: 20, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.360 Vali Acc: 0.976 Test Loss: 0.360 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9022204875946045
Epoch: 21, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.331 Vali Acc: 0.976 Test Loss: 0.331 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.239178419113159
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.331 Vali Acc: 0.979 Test Loss: 0.331 Test Acc: 0.979
Validation loss decreased (-0.977017 --> -0.979105).  Saving model ...
Epoch: 23 cost time: 3.307838201522827
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.363 Vali Acc: 0.976 Test Loss: 0.363 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.14005970954895
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.472 Vali Acc: 0.967 Test Loss: 0.472 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.809783458709717
Epoch: 25, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.334 Vali Acc: 0.981 Test Loss: 0.334 Test Acc: 0.981
Validation loss decreased (-0.979105 --> -0.980498).  Saving model ...
Epoch: 26 cost time: 2.4924614429473877
Epoch: 26, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.370 Vali Acc: 0.969 Test Loss: 0.370 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.545342206954956
Epoch: 27, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.494 Vali Acc: 0.956 Test Loss: 0.494 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.8141942024230957
Epoch: 28, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.376 Vali Acc: 0.971 Test Loss: 0.376 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.1326959133148193
Epoch: 29, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.521 Vali Acc: 0.964 Test Loss: 0.521 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.0187461376190186
Epoch: 30, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.424 Vali Acc: 0.970 Test Loss: 0.424 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.8852577209472656
Epoch: 31, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.447 Vali Acc: 0.967 Test Loss: 0.447 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.792469024658203
Epoch: 32, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.464 Vali Acc: 0.971 Test Loss: 0.464 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.803084373474121
Epoch: 33, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.535 Vali Acc: 0.973 Test Loss: 0.535 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.8635919094085693
Epoch: 34, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.534 Vali Acc: 0.971 Test Loss: 0.534 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 3.4666903018951416
Epoch: 35, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.555 Vali Acc: 0.967 Test Loss: 0.555 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 1594160
model size : 10.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.940566301345825
Epoch: 1, Steps: 89 | Train Loss: 0.919 Vali Loss: 0.410 Vali Acc: 0.888 Test Loss: 0.410 Test Acc: 0.888
Validation loss decreased (inf --> -0.887879).  Saving model ...
Epoch: 2 cost time: 2.8960299491882324
Epoch: 2, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.274 Vali Acc: 0.942 Test Loss: 0.274 Test Acc: 0.942
Validation loss decreased (-0.887879 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 3.2766482830047607
Epoch: 3, Steps: 89 | Train Loss: 0.241 Vali Loss: 0.541 Vali Acc: 0.885 Test Loss: 0.541 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5355865955352783
Epoch: 4, Steps: 89 | Train Loss: 0.315 Vali Loss: 0.379 Vali Acc: 0.945 Test Loss: 0.379 Test Acc: 0.945
Validation loss decreased (-0.942198 --> -0.944982).  Saving model ...
Epoch: 5 cost time: 3.3530166149139404
Epoch: 5, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.419 Vali Acc: 0.950 Test Loss: 0.419 Test Acc: 0.950
Validation loss decreased (-0.944982 --> -0.949857).  Saving model ...
Epoch: 6 cost time: 3.133394718170166
Epoch: 6, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.409 Vali Acc: 0.946 Test Loss: 0.409 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.162400245666504
Epoch: 7, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.643 Vali Acc: 0.937 Test Loss: 0.643 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.034121513366699
Epoch: 8, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.385 Vali Acc: 0.957 Test Loss: 0.385 Test Acc: 0.957
Validation loss decreased (-0.949857 --> -0.956821).  Saving model ...
Epoch: 9 cost time: 3.083228349685669
Epoch: 9, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.468 Vali Acc: 0.955 Test Loss: 0.468 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.205871343612671
Epoch: 10, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.579 Vali Acc: 0.950 Test Loss: 0.579 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.004643678665161
Epoch: 11, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.556 Vali Acc: 0.946 Test Loss: 0.556 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.0624444484710693
Epoch: 12, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.546 Vali Acc: 0.962 Test Loss: 0.546 Test Acc: 0.962
Validation loss decreased (-0.956821 --> -0.962390).  Saving model ...
Epoch: 13 cost time: 3.271059989929199
Epoch: 13, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.575 Vali Acc: 0.967 Test Loss: 0.575 Test Acc: 0.967
Validation loss decreased (-0.962390 --> -0.967264).  Saving model ...
Epoch: 14 cost time: 2.925962209701538
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.458 Vali Acc: 0.974 Test Loss: 0.458 Test Acc: 0.974
Validation loss decreased (-0.967264 --> -0.974229).  Saving model ...
Epoch: 15 cost time: 3.120028257369995
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.422 Vali Acc: 0.974 Test Loss: 0.422 Test Acc: 0.974
Validation loss decreased (-0.974229 --> -0.974230).  Saving model ...
Epoch: 16 cost time: 3.3142812252044678
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.488 Vali Acc: 0.967 Test Loss: 0.488 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.1590280532836914
Epoch: 17, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.571 Vali Acc: 0.958 Test Loss: 0.571 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.363067626953125
Epoch: 18, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.486 Vali Acc: 0.971 Test Loss: 0.486 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.3598737716674805
Epoch: 19, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.708 Vali Acc: 0.965 Test Loss: 0.708 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.2476494312286377
Epoch: 20, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.593 Vali Acc: 0.964 Test Loss: 0.593 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.081190347671509
Epoch: 21, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.853 Vali Acc: 0.948 Test Loss: 0.853 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.26724910736084
Epoch: 22, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.725 Vali Acc: 0.959 Test Loss: 0.725 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.8674941062927246
Epoch: 23, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.851 Vali Acc: 0.956 Test Loss: 0.851 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.157313108444214
Epoch: 24, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.676 Vali Acc: 0.971 Test Loss: 0.676 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0155880451202393
Epoch: 25, Steps: 89 | Train Loss: 0.063 Vali Loss: 1.000 Vali Acc: 0.951 Test Loss: 1.000 Test Acc: 0.951
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 1332016
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.690537452697754
Epoch: 1, Steps: 89 | Train Loss: 0.903 Vali Loss: 0.422 Vali Acc: 0.882 Test Loss: 0.422 Test Acc: 0.882
Validation loss decreased (inf --> -0.882308).  Saving model ...
Epoch: 2 cost time: 2.876396417617798
Epoch: 2, Steps: 89 | Train Loss: 0.288 Vali Loss: 0.258 Vali Acc: 0.944 Test Loss: 0.258 Test Acc: 0.944
Validation loss decreased (-0.882308 --> -0.944287).  Saving model ...
Epoch: 3 cost time: 3.277280807495117
Epoch: 3, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.785 Vali Acc: 0.869 Test Loss: 0.785 Test Acc: 0.869
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.037705898284912
Epoch: 4, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.360 Vali Acc: 0.940 Test Loss: 0.360 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.801586627960205
Epoch: 5, Steps: 89 | Train Loss: 0.190 Vali Loss: 0.289 Vali Acc: 0.965 Test Loss: 0.289 Test Acc: 0.965
Validation loss decreased (-0.944287 --> -0.965178).  Saving model ...
Epoch: 6 cost time: 2.799152135848999
Epoch: 6, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.346 Vali Acc: 0.958 Test Loss: 0.346 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1839675903320312
Epoch: 7, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.561 Vali Acc: 0.946 Test Loss: 0.561 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.6234312057495117
Epoch: 8, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
Validation loss decreased (-0.965178 --> -0.970749).  Saving model ...
Epoch: 9 cost time: 3.6964657306671143
Epoch: 9, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.478 Vali Acc: 0.953 Test Loss: 0.478 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0961248874664307
Epoch: 10, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.457 Vali Acc: 0.964 Test Loss: 0.457 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9963011741638184
Epoch: 11, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.514 Vali Acc: 0.964 Test Loss: 0.514 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.073089122772217
Epoch: 12, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.392 Vali Acc: 0.971 Test Loss: 0.392 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1752402782440186
Epoch: 13, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.514 Vali Acc: 0.960 Test Loss: 0.514 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.913245439529419
Epoch: 14, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.424 Vali Acc: 0.964 Test Loss: 0.424 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.10733699798584
Epoch: 15, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.727 Vali Acc: 0.953 Test Loss: 0.727 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.213071346282959
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.418 Vali Acc: 0.970 Test Loss: 0.418 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1689157485961914
Epoch: 17, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.424 Vali Acc: 0.969 Test Loss: 0.424 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.307668685913086
Epoch: 18, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.478 Vali Acc: 0.974 Test Loss: 0.478 Test Acc: 0.974
Validation loss decreased (-0.970749 --> -0.973533).  Saving model ...
Epoch: 19 cost time: 3.271544933319092
Epoch: 19, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.508 Vali Acc: 0.969 Test Loss: 0.508 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.91569447517395
Epoch: 20, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.593 Vali Acc: 0.970 Test Loss: 0.593 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.725358009338379
Epoch: 21, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.739 Vali Acc: 0.955 Test Loss: 0.739 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.188262462615967
Epoch: 22, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.658 Vali Acc: 0.963 Test Loss: 0.658 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.1314961910247803
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.637 Vali Acc: 0.966 Test Loss: 0.637 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.1536617279052734
Epoch: 24, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.727 Vali Acc: 0.965 Test Loss: 0.727 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.5648558139801025
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.751 Vali Acc: 0.964 Test Loss: 0.751 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.409024715423584
Epoch: 26, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.777 Vali Acc: 0.967 Test Loss: 0.777 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.233153820037842
Epoch: 27, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.906 Vali Acc: 0.954 Test Loss: 0.906 Test Acc: 0.954
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.9931654930114746
Epoch: 28, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.906 Vali Acc: 0.965 Test Loss: 0.906 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 1332016
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.26924467086792
Epoch: 1, Steps: 89 | Train Loss: 0.895 Vali Loss: 0.376 Vali Acc: 0.893 Test Loss: 0.376 Test Acc: 0.893
Validation loss decreased (inf --> -0.892754).  Saving model ...
Epoch: 2 cost time: 3.902268648147583
Epoch: 2, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.228 Vali Acc: 0.946 Test Loss: 0.228 Test Acc: 0.946
Validation loss decreased (-0.892754 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 3.4979546070098877
Epoch: 3, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.478 Vali Acc: 0.897 Test Loss: 0.478 Test Acc: 0.897
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6304848194122314
Epoch: 4, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.502 Vali Acc: 0.924 Test Loss: 0.502 Test Acc: 0.924
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.8135275840759277
Epoch: 5, Steps: 89 | Train Loss: 0.202 Vali Loss: 0.321 Vali Acc: 0.958 Test Loss: 0.321 Test Acc: 0.958
Validation loss decreased (-0.946377 --> -0.957518).  Saving model ...
Epoch: 6 cost time: 2.6114749908447266
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.306 Vali Acc: 0.952 Test Loss: 0.306 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.388955593109131
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.561 Vali Acc: 0.931 Test Loss: 0.561 Test Acc: 0.931
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.8357198238372803
Epoch: 8, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.417 Vali Acc: 0.953 Test Loss: 0.417 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9056642055511475
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.362 Vali Acc: 0.957 Test Loss: 0.362 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.9091646671295166
Epoch: 10, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.337 Vali Acc: 0.965 Test Loss: 0.337 Test Acc: 0.965
Validation loss decreased (-0.957518 --> -0.965178).  Saving model ...
Epoch: 11 cost time: 3.0464131832122803
Epoch: 11, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.373 Vali Acc: 0.967 Test Loss: 0.373 Test Acc: 0.967
Validation loss decreased (-0.965178 --> -0.967266).  Saving model ...
Epoch: 12 cost time: 2.943704843521118
Epoch: 12, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.479 Vali Acc: 0.951 Test Loss: 0.479 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6468873023986816
Epoch: 13, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.562 Vali Acc: 0.942 Test Loss: 0.562 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7722549438476562
Epoch: 14, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.480 Vali Acc: 0.962 Test Loss: 0.480 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.9589850902557373
Epoch: 15, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.580 Vali Acc: 0.955 Test Loss: 0.580 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.069302797317505
Epoch: 16, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.753 Vali Acc: 0.949 Test Loss: 0.753 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9828855991363525
Epoch: 17, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.379 Vali Acc: 0.971 Test Loss: 0.379 Test Acc: 0.971
Validation loss decreased (-0.967266 --> -0.971445).  Saving model ...
Epoch: 18 cost time: 3.119208812713623
Epoch: 18, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.433 Vali Acc: 0.971 Test Loss: 0.433 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.098961114883423
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.376 Vali Acc: 0.969 Test Loss: 0.376 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9061641693115234
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.342 Vali Acc: 0.974 Test Loss: 0.342 Test Acc: 0.974
Validation loss decreased (-0.971445 --> -0.973534).  Saving model ...
Epoch: 21 cost time: 2.3090600967407227
Epoch: 21, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.471 Vali Acc: 0.955 Test Loss: 0.471 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5350797176361084
Epoch: 22, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.460 Vali Acc: 0.965 Test Loss: 0.460 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.72589111328125
Epoch: 23, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.450 Vali Acc: 0.967 Test Loss: 0.450 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.9006288051605225
Epoch: 24, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.415 Vali Acc: 0.965 Test Loss: 0.415 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.0350282192230225
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.413 Vali Acc: 0.974 Test Loss: 0.413 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7569949626922607
Epoch: 26, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.428 Vali Acc: 0.972 Test Loss: 0.428 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.940070867538452
Epoch: 27, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.377 Vali Acc: 0.978 Test Loss: 0.377 Test Acc: 0.978
Validation loss decreased (-0.973534 --> -0.978408).  Saving model ...
Epoch: 28 cost time: 3.2927231788635254
Epoch: 28, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.520 Vali Acc: 0.969 Test Loss: 0.520 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.2947938442230225
Epoch: 29, Steps: 89 | Train Loss: 0.101 Vali Loss: 1.130 Vali Acc: 0.941 Test Loss: 1.130 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 3.5198655128479004
Epoch: 30, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.470 Vali Acc: 0.977 Test Loss: 0.470 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 3.283745288848877
Epoch: 31, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.553 Vali Acc: 0.970 Test Loss: 0.553 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 3.8457658290863037
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.491 Vali Acc: 0.974 Test Loss: 0.491 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 3.544816017150879
Epoch: 33, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.974 Test Loss: 0.467 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 3.6308493614196777
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.974 Test Loss: 0.467 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 3.633949041366577
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.467 Vali Acc: 0.974 Test Loss: 0.467 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 3.60792875289917
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.974 Test Loss: 0.466 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 3.5933477878570557
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.466 Vali Acc: 0.974 Test Loss: 0.466 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1332016
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.567055702209473
Epoch: 1, Steps: 89 | Train Loss: 0.929 Vali Loss: 0.379 Vali Acc: 0.900 Test Loss: 0.379 Test Acc: 0.900
Validation loss decreased (inf --> -0.900414).  Saving model ...
Epoch: 2 cost time: 3.2172882556915283
Epoch: 2, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.900414 --> -0.922002).  Saving model ...
Epoch: 3 cost time: 2.573436975479126
Epoch: 3, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.922002 --> -0.944287).  Saving model ...
Epoch: 4 cost time: 2.767232894897461
Epoch: 4, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.257 Vali Acc: 0.953 Test Loss: 0.257 Test Acc: 0.953
Validation loss decreased (-0.944287 --> -0.952644).  Saving model ...
Epoch: 5 cost time: 3.166539430618286
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.199 Vali Acc: 0.959 Test Loss: 0.199 Test Acc: 0.959
Validation loss decreased (-0.952644 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 3.316664218902588
Epoch: 6, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.288 Vali Acc: 0.946 Test Loss: 0.288 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5615234375
Epoch: 7, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.307 Vali Acc: 0.955 Test Loss: 0.307 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2971386909484863
Epoch: 8, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.261 Vali Acc: 0.961 Test Loss: 0.261 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961000).  Saving model ...
Epoch: 9 cost time: 3.4183082580566406
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.262 Vali Acc: 0.964 Test Loss: 0.262 Test Acc: 0.964
Validation loss decreased (-0.961000 --> -0.963786).  Saving model ...
Epoch: 10 cost time: 3.5433297157287598
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.224 Vali Acc: 0.971 Test Loss: 0.224 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.971446).  Saving model ...
Epoch: 11 cost time: 3.85465669631958
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.366 Vali Acc: 0.958 Test Loss: 0.366 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.6951003074645996
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.345 Vali Acc: 0.964 Test Loss: 0.345 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.582569122314453
Epoch: 13, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.253 Vali Acc: 0.974 Test Loss: 0.253 Test Acc: 0.974
Validation loss decreased (-0.971446 --> -0.973535).  Saving model ...
Epoch: 14 cost time: 3.486966848373413
Epoch: 14, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.282 Vali Acc: 0.974 Test Loss: 0.282 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.693828821182251
Epoch: 15, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.292 Vali Acc: 0.976 Test Loss: 0.292 Test Acc: 0.976
Validation loss decreased (-0.973535 --> -0.976320).  Saving model ...
Epoch: 16 cost time: 3.5831053256988525
Epoch: 16, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.277 Vali Acc: 0.974 Test Loss: 0.277 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.651533603668213
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.371 Vali Acc: 0.965 Test Loss: 0.371 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.54012393951416
Epoch: 18, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.395 Vali Acc: 0.967 Test Loss: 0.395 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.7282514572143555
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.340 Vali Acc: 0.974 Test Loss: 0.340 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.072197914123535
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.590 Vali Acc: 0.955 Test Loss: 0.590 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.4237420558929443
Epoch: 21, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.478 Vali Acc: 0.959 Test Loss: 0.478 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.5152220726013184
Epoch: 22, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.556 Vali Acc: 0.951 Test Loss: 0.556 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.4022932052612305
Epoch: 23, Steps: 89 | Train Loss: 0.088 Vali Loss: 0.434 Vali Acc: 0.967 Test Loss: 0.434 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.438164234161377
Epoch: 24, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.573 Vali Acc: 0.964 Test Loss: 0.573 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.4586105346679688
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.486 Vali Acc: 0.964 Test Loss: 0.486 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1332016
model size : 9.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.562509059906006
Epoch: 1, Steps: 89 | Train Loss: 0.856 Vali Loss: 0.288 Vali Acc: 0.932 Test Loss: 0.288 Test Acc: 0.932
Validation loss decreased (inf --> -0.931752).  Saving model ...
Epoch: 2 cost time: 3.9060428142547607
Epoch: 2, Steps: 89 | Train Loss: 0.290 Vali Loss: 0.471 Vali Acc: 0.893 Test Loss: 0.471 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.6937758922576904
Epoch: 3, Steps: 89 | Train Loss: 0.249 Vali Loss: 0.223 Vali Acc: 0.961 Test Loss: 0.223 Test Acc: 0.961
Validation loss decreased (-0.931752 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 3.6790950298309326
Epoch: 4, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.334 Vali Acc: 0.938 Test Loss: 0.334 Test Acc: 0.938
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.069742202758789
Epoch: 5, Steps: 89 | Train Loss: 0.180 Vali Loss: 0.338 Vali Acc: 0.943 Test Loss: 0.338 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.9298622608184814
Epoch: 6, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.314 Vali Acc: 0.958 Test Loss: 0.314 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.1831696033477783
Epoch: 7, Steps: 89 | Train Loss: 0.162 Vali Loss: 0.458 Vali Acc: 0.937 Test Loss: 0.458 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8292529582977295
Epoch: 8, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.883 Vali Acc: 0.914 Test Loss: 0.883 Test Acc: 0.914
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.822397470474243
Epoch: 9, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.653 Vali Acc: 0.935 Test Loss: 0.653 Test Acc: 0.935
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.8677172660827637
Epoch: 10, Steps: 89 | Train Loss: 0.178 Vali Loss: 0.519 Vali Acc: 0.956 Test Loss: 0.519 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 2.7644901275634766
Epoch: 11, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.578 Vali Acc: 0.944 Test Loss: 0.578 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 2.8529038429260254
Epoch: 12, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.552 Vali Acc: 0.952 Test Loss: 0.552 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 2.805414915084839
Epoch: 13, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.554 Vali Acc: 0.961 Test Loss: 0.554 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9610027855153204
model parameter : 1200944
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.956880569458008
Epoch: 1, Steps: 89 | Train Loss: 0.837 Vali Loss: 0.264 Vali Acc: 0.934 Test Loss: 0.264 Test Acc: 0.934
Validation loss decreased (inf --> -0.933841).  Saving model ...
Epoch: 2 cost time: 2.556255340576172
Epoch: 2, Steps: 89 | Train Loss: 0.276 Vali Loss: 0.257 Vali Acc: 0.943 Test Loss: 0.257 Test Acc: 0.943
Validation loss decreased (-0.933841 --> -0.942894).  Saving model ...
Epoch: 3 cost time: 2.803663969039917
Epoch: 3, Steps: 89 | Train Loss: 0.246 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
Validation loss decreased (-0.942894 --> -0.963786).  Saving model ...
Epoch: 4 cost time: 2.5361104011535645
Epoch: 4, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.353 Vali Acc: 0.931 Test Loss: 0.353 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.522027015686035
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.682 Vali Acc: 0.902 Test Loss: 0.682 Test Acc: 0.902
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.403386116027832
Epoch: 6, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.352 Vali Acc: 0.953 Test Loss: 0.352 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.546788454055786
Epoch: 7, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.398 Vali Acc: 0.954 Test Loss: 0.398 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.750325918197632
Epoch: 8, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.332 Vali Acc: 0.963 Test Loss: 0.332 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.8291449546813965
Epoch: 9, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.401 Vali Acc: 0.964 Test Loss: 0.401 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 2.74198842048645
Epoch: 10, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.377 Vali Acc: 0.965 Test Loss: 0.377 Test Acc: 0.965
Validation loss decreased (-0.963786 --> -0.965177).  Saving model ...
Epoch: 11 cost time: 2.6799209117889404
Epoch: 11, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.582 Vali Acc: 0.953 Test Loss: 0.582 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5261735916137695
Epoch: 12, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.687 Vali Acc: 0.942 Test Loss: 0.687 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.535918712615967
Epoch: 13, Steps: 89 | Train Loss: 0.198 Vali Loss: 0.551 Vali Acc: 0.951 Test Loss: 0.551 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.734560012817383
Epoch: 14, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.635 Vali Acc: 0.958 Test Loss: 0.635 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.523914098739624
Epoch: 15, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.522 Vali Acc: 0.969 Test Loss: 0.522 Test Acc: 0.969
Validation loss decreased (-0.965177 --> -0.968658).  Saving model ...
Epoch: 16 cost time: 2.870089054107666
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.414 Vali Acc: 0.972 Test Loss: 0.414 Test Acc: 0.972
Validation loss decreased (-0.968658 --> -0.972141).  Saving model ...
Epoch: 17 cost time: 2.575923204421997
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.468 Vali Acc: 0.972 Test Loss: 0.468 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.606851577758789
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.494 Vali Acc: 0.969 Test Loss: 0.494 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5856590270996094
Epoch: 19, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.504 Vali Acc: 0.969 Test Loss: 0.504 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.514444351196289
Epoch: 20, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.542 Vali Acc: 0.966 Test Loss: 0.542 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.55326771736145
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.522 Vali Acc: 0.965 Test Loss: 0.522 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.935605049133301
Epoch: 22, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.510 Vali Acc: 0.964 Test Loss: 0.510 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.98675274848938
Epoch: 23, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.687 Vali Acc: 0.960 Test Loss: 0.687 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.937234401702881
Epoch: 24, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.773 Vali Acc: 0.958 Test Loss: 0.773 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.755779981613159
Epoch: 25, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.655 Vali Acc: 0.969 Test Loss: 0.655 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9502391815185547
Epoch: 26, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.765 Vali Acc: 0.966 Test Loss: 0.765 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 1200944
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.342970132827759
Epoch: 1, Steps: 89 | Train Loss: 0.821 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (inf --> -0.936627).  Saving model ...
Epoch: 2 cost time: 2.5902345180511475
Epoch: 2, Steps: 89 | Train Loss: 0.253 Vali Loss: 0.351 Vali Acc: 0.923 Test Loss: 0.351 Test Acc: 0.923
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.613781690597534
Epoch: 3, Steps: 89 | Train Loss: 0.195 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
Validation loss decreased (-0.936627 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.6023221015930176
Epoch: 4, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.252 Vali Acc: 0.945 Test Loss: 0.252 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5315463542938232
Epoch: 5, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.257 Vali Acc: 0.964 Test Loss: 0.257 Test Acc: 0.964
Validation loss decreased (-0.962394 --> -0.963786).  Saving model ...
Epoch: 6 cost time: 2.5549397468566895
Epoch: 6, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.320 Vali Acc: 0.953 Test Loss: 0.320 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.576896905899048
Epoch: 7, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.273 Vali Acc: 0.971 Test Loss: 0.273 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.971446).  Saving model ...
Epoch: 8 cost time: 2.4953150749206543
Epoch: 8, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.471 Vali Acc: 0.943 Test Loss: 0.471 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5647144317626953
Epoch: 9, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.458 Vali Acc: 0.952 Test Loss: 0.458 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.451446533203125
Epoch: 10, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.532 Vali Acc: 0.947 Test Loss: 0.532 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.653934955596924
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.382 Vali Acc: 0.954 Test Loss: 0.382 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.4402236938476562
Epoch: 12, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.358 Vali Acc: 0.970 Test Loss: 0.358 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6913747787475586
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.540 Vali Acc: 0.950 Test Loss: 0.540 Test Acc: 0.950
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.838042974472046
Epoch: 14, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.437 Vali Acc: 0.969 Test Loss: 0.437 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.701138973236084
Epoch: 15, Steps: 89 | Train Loss: 0.119 Vali Loss: 0.572 Vali Acc: 0.948 Test Loss: 0.572 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7065389156341553
Epoch: 16, Steps: 89 | Train Loss: 0.142 Vali Loss: 0.636 Vali Acc: 0.960 Test Loss: 0.636 Test Acc: 0.960
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.8344578742980957
Epoch: 17, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.514 Vali Acc: 0.963 Test Loss: 0.514 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 1200944
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.184874057769775
Epoch: 1, Steps: 89 | Train Loss: 0.894 Vali Loss: 0.345 Vali Acc: 0.909 Test Loss: 0.345 Test Acc: 0.909
Validation loss decreased (inf --> -0.908771).  Saving model ...
Epoch: 2 cost time: 2.551297426223755
Epoch: 2, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.252 Vali Acc: 0.936 Test Loss: 0.252 Test Acc: 0.936
Validation loss decreased (-0.908771 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 2.5722742080688477
Epoch: 3, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.213 Vali Acc: 0.957 Test Loss: 0.213 Test Acc: 0.957
Validation loss decreased (-0.935931 --> -0.956822).  Saving model ...
Epoch: 4 cost time: 2.5912578105926514
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.310 Vali Acc: 0.944 Test Loss: 0.310 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.658256769180298
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.315 Vali Acc: 0.948 Test Loss: 0.315 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.5929789543151855
Epoch: 6, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.265 Vali Acc: 0.954 Test Loss: 0.265 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.532517671585083
Epoch: 7, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.231 Vali Acc: 0.967 Test Loss: 0.231 Test Acc: 0.967
Validation loss decreased (-0.956822 --> -0.967268).  Saving model ...
Epoch: 8 cost time: 2.5862388610839844
Epoch: 8, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.330 Vali Acc: 0.952 Test Loss: 0.330 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6906299591064453
Epoch: 9, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.294 Vali Acc: 0.953 Test Loss: 0.294 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5063204765319824
Epoch: 10, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.206 Vali Acc: 0.978 Test Loss: 0.206 Test Acc: 0.978
Validation loss decreased (-0.967268 --> -0.977714).  Saving model ...
Epoch: 11 cost time: 2.8365402221679688
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.252 Vali Acc: 0.971 Test Loss: 0.252 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7087323665618896
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.246 Vali Acc: 0.973 Test Loss: 0.246 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3945207595825195
Epoch: 13, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.979 Test Loss: 0.212 Test Acc: 0.979
Validation loss decreased (-0.977714 --> -0.979107).  Saving model ...
Epoch: 14 cost time: 2.709968090057373
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.967 Test Loss: 0.291 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8320345878601074
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.979 Test Loss: 0.226 Test Acc: 0.979
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8494873046875
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.244 Vali Acc: 0.979 Test Loss: 0.244 Test Acc: 0.979
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.908474922180176
Epoch: 17, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.562 Vali Acc: 0.937 Test Loss: 0.562 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.594601631164551
Epoch: 18, Steps: 89 | Train Loss: 0.157 Vali Loss: 0.523 Vali Acc: 0.955 Test Loss: 0.523 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5839951038360596
Epoch: 19, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.494 Vali Acc: 0.961 Test Loss: 0.494 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5513715744018555
Epoch: 20, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.622 Vali Acc: 0.955 Test Loss: 0.622 Test Acc: 0.955
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.449467897415161
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.562 Vali Acc: 0.963 Test Loss: 0.562 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6144919395446777
Epoch: 22, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.425 Vali Acc: 0.971 Test Loss: 0.425 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.802191972732544
Epoch: 23, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.398 Vali Acc: 0.975 Test Loss: 0.398 Test Acc: 0.975
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 1200944
model size : 9.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.190716028213501
Epoch: 1, Steps: 89 | Train Loss: 0.835 Vali Loss: 0.324 Vali Acc: 0.907 Test Loss: 0.324 Test Acc: 0.907
Validation loss decreased (inf --> -0.907378).  Saving model ...
Epoch: 2 cost time: 2.8512520790100098
Epoch: 2, Steps: 89 | Train Loss: 0.289 Vali Loss: 0.435 Vali Acc: 0.903 Test Loss: 0.435 Test Acc: 0.903
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.822277069091797
Epoch: 3, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.366 Vali Acc: 0.932 Test Loss: 0.366 Test Acc: 0.932
Validation loss decreased (-0.907378 --> -0.932448).  Saving model ...
Epoch: 4 cost time: 2.7382445335388184
Epoch: 4, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.523 Vali Acc: 0.925 Test Loss: 0.523 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6671347618103027
Epoch: 5, Steps: 89 | Train Loss: 0.287 Vali Loss: 0.543 Vali Acc: 0.929 Test Loss: 0.543 Test Acc: 0.929
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.794198751449585
Epoch: 6, Steps: 89 | Train Loss: 0.191 Vali Loss: 0.531 Vali Acc: 0.935 Test Loss: 0.531 Test Acc: 0.935
Validation loss decreased (-0.932448 --> -0.935231).  Saving model ...
Epoch: 7 cost time: 2.8406832218170166
Epoch: 7, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.366 Vali Acc: 0.964 Test Loss: 0.366 Test Acc: 0.964
Validation loss decreased (-0.935231 --> -0.963785).  Saving model ...
Epoch: 8 cost time: 3.1236705780029297
Epoch: 8, Steps: 89 | Train Loss: 0.175 Vali Loss: 0.741 Vali Acc: 0.925 Test Loss: 0.741 Test Acc: 0.925
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.0241219997406006
Epoch: 9, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.474 Vali Acc: 0.944 Test Loss: 0.474 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9971249103546143
Epoch: 10, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.542 Vali Acc: 0.946 Test Loss: 0.542 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.8484175205230713
Epoch: 11, Steps: 89 | Train Loss: 0.128 Vali Loss: 0.548 Vali Acc: 0.958 Test Loss: 0.548 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.99041485786438
Epoch: 12, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.518 Vali Acc: 0.967 Test Loss: 0.518 Test Acc: 0.967
Validation loss decreased (-0.963785 --> -0.967265).  Saving model ...
Epoch: 13 cost time: 3.0970816612243652
Epoch: 13, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.576 Vali Acc: 0.954 Test Loss: 0.576 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.050980806350708
Epoch: 14, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.520 Vali Acc: 0.962 Test Loss: 0.520 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.8617892265319824
Epoch: 15, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.487 Vali Acc: 0.964 Test Loss: 0.487 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.7523105144500732
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.411 Vali Acc: 0.972 Test Loss: 0.411 Test Acc: 0.972
Validation loss decreased (-0.967265 --> -0.972141).  Saving model ...
Epoch: 17 cost time: 2.71758770942688
Epoch: 17, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.818 Vali Acc: 0.948 Test Loss: 0.818 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.666869640350342
Epoch: 18, Steps: 89 | Train Loss: 0.187 Vali Loss: 0.687 Vali Acc: 0.961 Test Loss: 0.687 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8183231353759766
Epoch: 19, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.926 Vali Acc: 0.948 Test Loss: 0.926 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.823714256286621
Epoch: 20, Steps: 89 | Train Loss: 0.171 Vali Loss: 0.672 Vali Acc: 0.967 Test Loss: 0.672 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.884369134902954
Epoch: 21, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.738 Vali Acc: 0.967 Test Loss: 0.738 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.830763339996338
Epoch: 22, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.802 Vali Acc: 0.964 Test Loss: 0.802 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.7883026599884033
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.626 Vali Acc: 0.972 Test Loss: 0.626 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.812636613845825
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.639 Vali Acc: 0.969 Test Loss: 0.639 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9175567626953125
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.915 Vali Acc: 0.966 Test Loss: 0.915 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.9715538024902344
Epoch: 26, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.878 Vali Acc: 0.957 Test Loss: 0.878 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 1135408
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.3575475215911865
Epoch: 1, Steps: 89 | Train Loss: 0.825 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
Validation loss decreased (inf --> -0.918521).  Saving model ...
Epoch: 2 cost time: 3.1269772052764893
Epoch: 2, Steps: 89 | Train Loss: 0.251 Vali Loss: 0.239 Vali Acc: 0.947 Test Loss: 0.239 Test Acc: 0.947
Validation loss decreased (-0.918521 --> -0.947073).  Saving model ...
Epoch: 3 cost time: 2.912170886993408
Epoch: 3, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.221 Vali Acc: 0.956 Test Loss: 0.221 Test Acc: 0.956
Validation loss decreased (-0.947073 --> -0.956126).  Saving model ...
Epoch: 4 cost time: 3.0391921997070312
Epoch: 4, Steps: 89 | Train Loss: 0.150 Vali Loss: 0.336 Vali Acc: 0.948 Test Loss: 0.336 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5181827545166016
Epoch: 5, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.675 Vali Acc: 0.884 Test Loss: 0.675 Test Acc: 0.884
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.12581467628479
Epoch: 6, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.337 Vali Acc: 0.953 Test Loss: 0.337 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.0675880908966064
Epoch: 7, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.408 Vali Acc: 0.946 Test Loss: 0.408 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.691880941390991
Epoch: 8, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.686 Vali Acc: 0.937 Test Loss: 0.686 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.578003168106079
Epoch: 9, Steps: 89 | Train Loss: 0.123 Vali Loss: 0.415 Vali Acc: 0.957 Test Loss: 0.415 Test Acc: 0.957
Validation loss decreased (-0.956126 --> -0.956820).  Saving model ...
Epoch: 10 cost time: 2.5440492630004883
Epoch: 10, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.505 Vali Acc: 0.959 Test Loss: 0.505 Test Acc: 0.959
Validation loss decreased (-0.956820 --> -0.958909).  Saving model ...
Epoch: 11 cost time: 2.7142698764801025
Epoch: 11, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.563 Vali Acc: 0.948 Test Loss: 0.563 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6846773624420166
Epoch: 12, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.570 Vali Acc: 0.944 Test Loss: 0.570 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7081587314605713
Epoch: 13, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.462 Vali Acc: 0.953 Test Loss: 0.462 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7462236881256104
Epoch: 14, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.555 Vali Acc: 0.956 Test Loss: 0.555 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8460938930511475
Epoch: 15, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.779 Vali Acc: 0.948 Test Loss: 0.779 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6566646099090576
Epoch: 16, Steps: 89 | Train Loss: 0.338 Vali Loss: 0.672 Vali Acc: 0.960 Test Loss: 0.672 Test Acc: 0.960
Validation loss decreased (-0.958909 --> -0.959603).  Saving model ...
Epoch: 17 cost time: 2.6462185382843018
Epoch: 17, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.590 Vali Acc: 0.967 Test Loss: 0.590 Test Acc: 0.967
Validation loss decreased (-0.959603 --> -0.967264).  Saving model ...
Epoch: 18 cost time: 2.565342426300049
Epoch: 18, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.603 Vali Acc: 0.971 Test Loss: 0.603 Test Acc: 0.971
Validation loss decreased (-0.967264 --> -0.970746).  Saving model ...
Epoch: 19 cost time: 2.552790403366089
Epoch: 19, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.667 Vali Acc: 0.955 Test Loss: 0.667 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7520344257354736
Epoch: 20, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.585 Vali Acc: 0.974 Test Loss: 0.585 Test Acc: 0.974
Validation loss decreased (-0.970746 --> -0.974228).  Saving model ...
Epoch: 21 cost time: 2.7026607990264893
Epoch: 21, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.805 Vali Acc: 0.958 Test Loss: 0.805 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8252501487731934
Epoch: 22, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.540 Vali Acc: 0.974 Test Loss: 0.540 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7493228912353516
Epoch: 23, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.698 Vali Acc: 0.962 Test Loss: 0.698 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.7476935386657715
Epoch: 24, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.730 Vali Acc: 0.973 Test Loss: 0.730 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5934624671936035
Epoch: 25, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.670 Vali Acc: 0.977 Test Loss: 0.670 Test Acc: 0.977
Validation loss decreased (-0.974228 --> -0.977013).  Saving model ...
Epoch: 26 cost time: 2.734630584716797
Epoch: 26, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.891 Vali Acc: 0.969 Test Loss: 0.891 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.9041998386383057
Epoch: 27, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.723 Vali Acc: 0.967 Test Loss: 0.723 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.9700136184692383
Epoch: 28, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.884 Vali Acc: 0.972 Test Loss: 0.884 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6408610343933105
Epoch: 29, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.685 Vali Acc: 0.967 Test Loss: 0.685 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.628730058670044
Epoch: 30, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.847 Vali Acc: 0.964 Test Loss: 0.847 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.37730073928833
Epoch: 31, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.746 Vali Acc: 0.965 Test Loss: 0.746 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.637932777404785
Epoch: 32, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.792 Vali Acc: 0.964 Test Loss: 0.792 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.604365348815918
Epoch: 33, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.600 Vali Acc: 0.975 Test Loss: 0.600 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.5829784870147705
Epoch: 34, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.617 Vali Acc: 0.972 Test Loss: 0.617 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.5618419647216797
Epoch: 35, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.656 Vali Acc: 0.972 Test Loss: 0.656 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1135408
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.257878541946411
Epoch: 1, Steps: 89 | Train Loss: 0.815 Vali Loss: 0.245 Vali Acc: 0.939 Test Loss: 0.245 Test Acc: 0.939
Validation loss decreased (inf --> -0.939413).  Saving model ...
Epoch: 2 cost time: 2.61987042427063
Epoch: 2, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
Validation loss decreased (-0.939413 --> -0.960305).  Saving model ...
Epoch: 3 cost time: 2.5949392318725586
Epoch: 3, Steps: 89 | Train Loss: 0.170 Vali Loss: 0.369 Vali Acc: 0.928 Test Loss: 0.369 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.697225570678711
Epoch: 4, Steps: 89 | Train Loss: 0.192 Vali Loss: 0.365 Vali Acc: 0.930 Test Loss: 0.365 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.623309373855591
Epoch: 5, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.386 Vali Acc: 0.940 Test Loss: 0.386 Test Acc: 0.940
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.7017858028411865
Epoch: 6, Steps: 89 | Train Loss: 0.196 Vali Loss: 0.465 Vali Acc: 0.945 Test Loss: 0.465 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.812915563583374
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.454 Vali Acc: 0.948 Test Loss: 0.454 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 3.025343418121338
Epoch: 8, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.464 Vali Acc: 0.949 Test Loss: 0.464 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 3.005286693572998
Epoch: 9, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.463 Vali Acc: 0.956 Test Loss: 0.463 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 2.8586106300354004
Epoch: 10, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.477 Vali Acc: 0.954 Test Loss: 0.477 Test Acc: 0.954
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 2.637428045272827
Epoch: 11, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.461 Vali Acc: 0.953 Test Loss: 0.461 Test Acc: 0.953
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 2.9227213859558105
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.509 Vali Acc: 0.961 Test Loss: 0.509 Test Acc: 0.961
Validation loss decreased (-0.960305 --> -0.960998).  Saving model ...
Epoch: 13 cost time: 2.9285335540771484
Epoch: 13, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.530 Vali Acc: 0.965 Test Loss: 0.530 Test Acc: 0.965
Validation loss decreased (-0.960998 --> -0.965176).  Saving model ...
Epoch: 14 cost time: 2.8526620864868164
Epoch: 14, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.480 Vali Acc: 0.970 Test Loss: 0.480 Test Acc: 0.970
Validation loss decreased (-0.965176 --> -0.970051).  Saving model ...
Epoch: 15 cost time: 2.77919340133667
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.410 Vali Acc: 0.972 Test Loss: 0.410 Test Acc: 0.972
Validation loss decreased (-0.970051 --> -0.972141).  Saving model ...
Epoch: 16 cost time: 2.7360658645629883
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.441 Vali Acc: 0.976 Test Loss: 0.441 Test Acc: 0.976
Validation loss decreased (-0.972141 --> -0.975622).  Saving model ...
Epoch: 17 cost time: 2.8772919178009033
Epoch: 17, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.555 Vali Acc: 0.967 Test Loss: 0.555 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.765958070755005
Epoch: 18, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.752 Vali Acc: 0.960 Test Loss: 0.752 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.8722126483917236
Epoch: 19, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.716 Vali Acc: 0.953 Test Loss: 0.716 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.7027335166931152
Epoch: 20, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.606 Vali Acc: 0.962 Test Loss: 0.606 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.7058098316192627
Epoch: 21, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.565 Vali Acc: 0.958 Test Loss: 0.565 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.801011085510254
Epoch: 22, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.677 Vali Acc: 0.969 Test Loss: 0.677 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.9454545974731445
Epoch: 23, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.721 Vali Acc: 0.951 Test Loss: 0.721 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9409713745117188
Epoch: 24, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.472 Vali Acc: 0.969 Test Loss: 0.472 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9208242893218994
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.562 Vali Acc: 0.967 Test Loss: 0.562 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.936558961868286
Epoch: 26, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.563 Vali Acc: 0.967 Test Loss: 0.563 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 1135408
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.076105833053589
Epoch: 1, Steps: 89 | Train Loss: 0.884 Vali Loss: 0.251 Vali Acc: 0.931 Test Loss: 0.251 Test Acc: 0.931
Validation loss decreased (inf --> -0.931056).  Saving model ...
Epoch: 2 cost time: 2.532808780670166
Epoch: 2, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.931056 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 2.381359100341797
Epoch: 3, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.183 Vali Acc: 0.959 Test Loss: 0.183 Test Acc: 0.959
Validation loss decreased (-0.951948 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 2.32710862159729
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.314 Vali Acc: 0.939 Test Loss: 0.314 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.449542999267578
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.367 Vali Acc: 0.925 Test Loss: 0.367 Test Acc: 0.925
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.581113576889038
Epoch: 6, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.342 Vali Acc: 0.953 Test Loss: 0.342 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.4608590602874756
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.277 Vali Acc: 0.964 Test Loss: 0.277 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963786).  Saving model ...
Epoch: 8 cost time: 2.5140905380249023
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.975 Test Loss: 0.201 Test Acc: 0.975
Validation loss decreased (-0.963786 --> -0.974928).  Saving model ...
Epoch: 9 cost time: 2.4365804195404053
Epoch: 9, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.972 Test Loss: 0.206 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.402085304260254
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.249 Vali Acc: 0.974 Test Loss: 0.249 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.496203660964966
Epoch: 11, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.283 Vali Acc: 0.967 Test Loss: 0.283 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.630376100540161
Epoch: 12, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.266 Vali Acc: 0.971 Test Loss: 0.266 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.7549240589141846
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.360 Vali Acc: 0.970 Test Loss: 0.360 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.733445882797241
Epoch: 14, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.765 Vali Acc: 0.942 Test Loss: 0.765 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.8278679847717285
Epoch: 15, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.395 Vali Acc: 0.968 Test Loss: 0.395 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.640852928161621
Epoch: 16, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.507 Vali Acc: 0.958 Test Loss: 0.507 Test Acc: 0.958
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.663914680480957
Epoch: 17, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.260 Vali Acc: 0.978 Test Loss: 0.260 Test Acc: 0.978
Validation loss decreased (-0.974928 --> -0.978410).  Saving model ...
Epoch: 18 cost time: 2.635084390640259
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.276 Vali Acc: 0.978 Test Loss: 0.276 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8768203258514404
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.301 Vali Acc: 0.972 Test Loss: 0.301 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5605051517486572
Epoch: 20, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.314 Vali Acc: 0.971 Test Loss: 0.314 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5878849029541016
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.338 Vali Acc: 0.967 Test Loss: 0.338 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.4886438846588135
Epoch: 22, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.403 Vali Acc: 0.969 Test Loss: 0.403 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.5223798751831055
Epoch: 23, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.292 Vali Acc: 0.974 Test Loss: 0.292 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4809861183166504
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.453 Vali Acc: 0.966 Test Loss: 0.453 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5094316005706787
Epoch: 25, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.368 Vali Acc: 0.973 Test Loss: 0.368 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.3783650398254395
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.333 Vali Acc: 0.976 Test Loss: 0.333 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.3471388816833496
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.403 Vali Acc: 0.967 Test Loss: 0.403 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1135408
model size : 9.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.058009386062622
Epoch: 1, Steps: 89 | Train Loss: 0.952 Vali Loss: 0.429 Vali Acc: 0.873 Test Loss: 0.429 Test Acc: 0.873
Validation loss decreased (inf --> -0.873255).  Saving model ...
Epoch: 2 cost time: 2.7641384601593018
Epoch: 2, Steps: 89 | Train Loss: 0.344 Vali Loss: 0.341 Vali Acc: 0.914 Test Loss: 0.341 Test Acc: 0.914
Validation loss decreased (-0.873255 --> -0.914342).  Saving model ...
Epoch: 3 cost time: 2.7997353076934814
Epoch: 3, Steps: 89 | Train Loss: 0.281 Vali Loss: 0.498 Vali Acc: 0.909 Test Loss: 0.498 Test Acc: 0.909
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9962120056152344
Epoch: 4, Steps: 89 | Train Loss: 0.271 Vali Loss: 0.320 Vali Acc: 0.959 Test Loss: 0.320 Test Acc: 0.959
Validation loss decreased (-0.914342 --> -0.958910).  Saving model ...
Epoch: 5 cost time: 2.7983267307281494
Epoch: 5, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.601 Vali Acc: 0.908 Test Loss: 0.601 Test Acc: 0.908
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.660231828689575
Epoch: 6, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.860 Vali Acc: 0.911 Test Loss: 0.860 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.801262378692627
Epoch: 7, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.419 Vali Acc: 0.946 Test Loss: 0.419 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.967733144760132
Epoch: 8, Steps: 89 | Train Loss: 0.129 Vali Loss: 0.521 Vali Acc: 0.940 Test Loss: 0.521 Test Acc: 0.940
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.8667569160461426
Epoch: 9, Steps: 89 | Train Loss: 0.197 Vali Loss: 0.420 Vali Acc: 0.962 Test Loss: 0.420 Test Acc: 0.962
Validation loss decreased (-0.958910 --> -0.961695).  Saving model ...
Epoch: 10 cost time: 2.662696361541748
Epoch: 10, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.512 Vali Acc: 0.954 Test Loss: 0.512 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6488125324249268
Epoch: 11, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.415 Vali Acc: 0.965 Test Loss: 0.415 Test Acc: 0.965
Validation loss decreased (-0.961695 --> -0.965177).  Saving model ...
Epoch: 12 cost time: 2.6871373653411865
Epoch: 12, Steps: 89 | Train Loss: 0.166 Vali Loss: 0.749 Vali Acc: 0.951 Test Loss: 0.749 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6698927879333496
Epoch: 13, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.684 Vali Acc: 0.954 Test Loss: 0.684 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7497243881225586
Epoch: 14, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.671 Vali Acc: 0.958 Test Loss: 0.671 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.72871994972229
Epoch: 15, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.685 Vali Acc: 0.959 Test Loss: 0.685 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.775996685028076
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.602 Vali Acc: 0.962 Test Loss: 0.602 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6569302082061768
Epoch: 17, Steps: 89 | Train Loss: 0.187 Vali Loss: 1.065 Vali Acc: 0.931 Test Loss: 1.065 Test Acc: 0.931
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6061747074127197
Epoch: 18, Steps: 89 | Train Loss: 0.176 Vali Loss: 1.052 Vali Acc: 0.947 Test Loss: 1.052 Test Acc: 0.947
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5581367015838623
Epoch: 19, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.718 Vali Acc: 0.957 Test Loss: 0.718 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.8444814682006836
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.695 Vali Acc: 0.970 Test Loss: 0.695 Test Acc: 0.970
Validation loss decreased (-0.965177 --> -0.970049).  Saving model ...
Epoch: 21 cost time: 2.7776174545288086
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.691 Vali Acc: 0.965 Test Loss: 0.691 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8463408946990967
Epoch: 22, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.823 Vali Acc: 0.953 Test Loss: 0.823 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7605276107788086
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.656 Vali Acc: 0.973 Test Loss: 0.656 Test Acc: 0.973
Validation loss decreased (-0.970049 --> -0.972835).  Saving model ...
Epoch: 24 cost time: 2.923793315887451
Epoch: 24, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.466 Vali Acc: 0.978 Test Loss: 0.466 Test Acc: 0.978
Validation loss decreased (-0.972835 --> -0.977711).  Saving model ...
Epoch: 25 cost time: 2.8698291778564453
Epoch: 25, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.785 Vali Acc: 0.957 Test Loss: 0.785 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.913916826248169
Epoch: 26, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.653 Vali Acc: 0.968 Test Loss: 0.653 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.973629951477051
Epoch: 27, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.559 Vali Acc: 0.977 Test Loss: 0.559 Test Acc: 0.977
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.863556385040283
Epoch: 28, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.537 Vali Acc: 0.978 Test Loss: 0.537 Test Acc: 0.978
Validation loss decreased (-0.977711 --> -0.978407).  Saving model ...
Epoch: 29 cost time: 2.6755383014678955
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.530 Vali Acc: 0.978 Test Loss: 0.530 Test Acc: 0.978
Validation loss decreased (-0.978407 --> -0.978407).  Saving model ...
Epoch: 30 cost time: 2.740565299987793
Epoch: 30, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.682 Vali Acc: 0.969 Test Loss: 0.682 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.797086000442505
Epoch: 31, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.638 Vali Acc: 0.976 Test Loss: 0.638 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.8109259605407715
Epoch: 32, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.680 Vali Acc: 0.969 Test Loss: 0.680 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.7619640827178955
Epoch: 33, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.628 Vali Acc: 0.969 Test Loss: 0.628 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.853590250015259
Epoch: 34, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.540 Vali Acc: 0.978 Test Loss: 0.540 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.782099962234497
Epoch: 35, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.705 Vali Acc: 0.967 Test Loss: 0.705 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.778998851776123
Epoch: 36, Steps: 89 | Train Loss: 0.095 Vali Loss: 1.521 Vali Acc: 0.921 Test Loss: 1.521 Test Acc: 0.921
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.702280282974243
Epoch: 37, Steps: 89 | Train Loss: 0.234 Vali Loss: 1.025 Vali Acc: 0.953 Test Loss: 1.025 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.915984869003296
Epoch: 38, Steps: 89 | Train Loss: 0.147 Vali Loss: 1.075 Vali Acc: 0.958 Test Loss: 1.075 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.8691611289978027
Epoch: 39, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.781 Vali Acc: 0.971 Test Loss: 0.781 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1102640
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.239966869354248
Epoch: 1, Steps: 89 | Train Loss: 0.934 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
Validation loss decreased (inf --> -0.884397).  Saving model ...
Epoch: 2 cost time: 2.7566282749176025
Epoch: 2, Steps: 89 | Train Loss: 0.282 Vali Loss: 0.352 Vali Acc: 0.922 Test Loss: 0.352 Test Acc: 0.922
Validation loss decreased (-0.884397 --> -0.922002).  Saving model ...
Epoch: 3 cost time: 2.8891613483428955
Epoch: 3, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.418 Vali Acc: 0.912 Test Loss: 0.418 Test Acc: 0.912
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.8203694820404053
Epoch: 4, Steps: 89 | Train Loss: 0.165 Vali Loss: 0.321 Vali Acc: 0.958 Test Loss: 0.321 Test Acc: 0.958
Validation loss decreased (-0.922002 --> -0.958214).  Saving model ...
Epoch: 5 cost time: 2.771843671798706
Epoch: 5, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.261 Vali Acc: 0.961 Test Loss: 0.261 Test Acc: 0.961
Validation loss decreased (-0.958214 --> -0.961000).  Saving model ...
Epoch: 6 cost time: 2.748964548110962
Epoch: 6, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.501 Vali Acc: 0.937 Test Loss: 0.501 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5156543254852295
Epoch: 7, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.463 Vali Acc: 0.944 Test Loss: 0.463 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6110341548919678
Epoch: 8, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.551 Vali Acc: 0.944 Test Loss: 0.551 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.603341817855835
Epoch: 9, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.419 Vali Acc: 0.958 Test Loss: 0.419 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.773482322692871
Epoch: 10, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.403 Vali Acc: 0.967 Test Loss: 0.403 Test Acc: 0.967
Validation loss decreased (-0.961000 --> -0.966570).  Saving model ...
Epoch: 11 cost time: 2.5007412433624268
Epoch: 11, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.437 Vali Acc: 0.967 Test Loss: 0.437 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.548962116241455
Epoch: 12, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.368 Vali Acc: 0.976 Test Loss: 0.368 Test Acc: 0.976
Validation loss decreased (-0.966570 --> -0.976319).  Saving model ...
Epoch: 13 cost time: 2.6425442695617676
Epoch: 13, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.362 Vali Acc: 0.976 Test Loss: 0.362 Test Acc: 0.976
Validation loss decreased (-0.976319 --> -0.976319).  Saving model ...
Epoch: 14 cost time: 2.6207640171051025
Epoch: 14, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.481 Vali Acc: 0.969 Test Loss: 0.481 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.586437225341797
Epoch: 15, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.636 Vali Acc: 0.960 Test Loss: 0.636 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6532278060913086
Epoch: 16, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.816 Vali Acc: 0.949 Test Loss: 0.816 Test Acc: 0.949
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.8277432918548584
Epoch: 17, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.748 Vali Acc: 0.954 Test Loss: 0.748 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.5349462032318115
Epoch: 18, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.519 Vali Acc: 0.969 Test Loss: 0.519 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8178069591522217
Epoch: 19, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.438 Vali Acc: 0.974 Test Loss: 0.438 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.693218946456909
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.682 Vali Acc: 0.950 Test Loss: 0.682 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.8729138374328613
Epoch: 21, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.808 Vali Acc: 0.951 Test Loss: 0.808 Test Acc: 0.951
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6907424926757812
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.582 Vali Acc: 0.964 Test Loss: 0.582 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.7261126041412354
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.516 Vali Acc: 0.966 Test Loss: 0.516 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 1102640
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9630208015441895
Epoch: 1, Steps: 89 | Train Loss: 0.916 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (inf --> -0.899718).  Saving model ...
Epoch: 2 cost time: 2.471170425415039
Epoch: 2, Steps: 89 | Train Loss: 0.254 Vali Loss: 0.229 Vali Acc: 0.948 Test Loss: 0.229 Test Acc: 0.948
Validation loss decreased (-0.899718 --> -0.947769).  Saving model ...
Epoch: 3 cost time: 2.6634411811828613
Epoch: 3, Steps: 89 | Train Loss: 0.181 Vali Loss: 0.278 Vali Acc: 0.939 Test Loss: 0.278 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5288286209106445
Epoch: 4, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.424 Vali Acc: 0.928 Test Loss: 0.424 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5093283653259277
Epoch: 5, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.323 Vali Acc: 0.949 Test Loss: 0.323 Test Acc: 0.949
Validation loss decreased (-0.947769 --> -0.949161).  Saving model ...
Epoch: 6 cost time: 2.5737197399139404
Epoch: 6, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.322 Vali Acc: 0.960 Test Loss: 0.322 Test Acc: 0.960
Validation loss decreased (-0.949161 --> -0.959607).  Saving model ...
Epoch: 7 cost time: 2.667994976043701
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.533 Vali Acc: 0.935 Test Loss: 0.533 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4011998176574707
Epoch: 8, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.874 Vali Acc: 0.928 Test Loss: 0.874 Test Acc: 0.928
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.60817551612854
Epoch: 9, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.332 Vali Acc: 0.955 Test Loss: 0.332 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.560185432434082
Epoch: 10, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.529 Vali Acc: 0.944 Test Loss: 0.529 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.584280490875244
Epoch: 11, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.406 Vali Acc: 0.963 Test Loss: 0.406 Test Acc: 0.963
Validation loss decreased (-0.959607 --> -0.963088).  Saving model ...
Epoch: 12 cost time: 2.447526693344116
Epoch: 12, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.385 Vali Acc: 0.967 Test Loss: 0.385 Test Acc: 0.967
Validation loss decreased (-0.963088 --> -0.966570).  Saving model ...
Epoch: 13 cost time: 2.7592265605926514
Epoch: 13, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.557 Vali Acc: 0.955 Test Loss: 0.557 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.8530004024505615
Epoch: 14, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.400 Vali Acc: 0.974 Test Loss: 0.400 Test Acc: 0.974
Validation loss decreased (-0.966570 --> -0.974230).  Saving model ...
Epoch: 15 cost time: 2.723900556564331
Epoch: 15, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.471 Vali Acc: 0.964 Test Loss: 0.471 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.543464422225952
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.584 Vali Acc: 0.969 Test Loss: 0.584 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.741666316986084
Epoch: 17, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.411 Vali Acc: 0.972 Test Loss: 0.411 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6248953342437744
Epoch: 18, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.389 Vali Acc: 0.979 Test Loss: 0.389 Test Acc: 0.979
Validation loss decreased (-0.974230 --> -0.979105).  Saving model ...
Epoch: 19 cost time: 2.7800772190093994
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.561 Vali Acc: 0.953 Test Loss: 0.561 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7989108562469482
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.508 Vali Acc: 0.976 Test Loss: 0.508 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.591719150543213
Epoch: 21, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.577 Vali Acc: 0.960 Test Loss: 0.577 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.5282766819000244
Epoch: 22, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.705 Vali Acc: 0.963 Test Loss: 0.705 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4402577877044678
Epoch: 23, Steps: 89 | Train Loss: 0.115 Vali Loss: 0.707 Vali Acc: 0.953 Test Loss: 0.707 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.591172218322754
Epoch: 24, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.535 Vali Acc: 0.969 Test Loss: 0.535 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.510686159133911
Epoch: 25, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.534 Vali Acc: 0.975 Test Loss: 0.534 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.5288078784942627
Epoch: 26, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.435 Vali Acc: 0.980 Test Loss: 0.435 Test Acc: 0.980
Validation loss decreased (-0.979105 --> -0.979801).  Saving model ...
Epoch: 27 cost time: 2.639160633087158
Epoch: 27, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.573 Vali Acc: 0.975 Test Loss: 0.573 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.5705363750457764
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.965 Test Loss: 0.568 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.513979911804199
Epoch: 29, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.374 Vali Acc: 0.983 Test Loss: 0.374 Test Acc: 0.983
Validation loss decreased (-0.979801 --> -0.983283).  Saving model ...
Epoch: 30 cost time: 2.6276636123657227
Epoch: 30, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.388 Vali Acc: 0.981 Test Loss: 0.388 Test Acc: 0.981
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6981568336486816
Epoch: 31, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.373 Vali Acc: 0.983 Test Loss: 0.373 Test Acc: 0.983
Validation loss decreased (-0.983283 --> -0.983283).  Saving model ...
Epoch: 32 cost time: 2.4715139865875244
Epoch: 32, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.546 Vali Acc: 0.967 Test Loss: 0.546 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.7066776752471924
Epoch: 33, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.505 Vali Acc: 0.978 Test Loss: 0.505 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.7208547592163086
Epoch: 34, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.508 Vali Acc: 0.976 Test Loss: 0.508 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.7290167808532715
Epoch: 35, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.468 Vali Acc: 0.978 Test Loss: 0.468 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.6563851833343506
Epoch: 36, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.600 Vali Acc: 0.969 Test Loss: 0.600 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.585421562194824
Epoch: 37, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.536 Vali Acc: 0.978 Test Loss: 0.536 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.72310209274292
Epoch: 38, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.805 Vali Acc: 0.960 Test Loss: 0.805 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.723667860031128
Epoch: 39, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.700 Vali Acc: 0.970 Test Loss: 0.700 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.3843045234680176
Epoch: 40, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.623 Vali Acc: 0.967 Test Loss: 0.623 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.4824612140655518
Epoch: 41, Steps: 89 | Train Loss: 0.094 Vali Loss: 1.286 Vali Acc: 0.943 Test Loss: 1.286 Test Acc: 0.943
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 1102640
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7039527893066406
Epoch: 1, Steps: 89 | Train Loss: 0.977 Vali Loss: 0.294 Vali Acc: 0.916 Test Loss: 0.294 Test Acc: 0.916
Validation loss decreased (inf --> -0.916432).  Saving model ...
Epoch: 2 cost time: 2.5450356006622314
Epoch: 2, Steps: 89 | Train Loss: 0.211 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.916432 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 2.356931209564209
Epoch: 3, Steps: 89 | Train Loss: 0.164 Vali Loss: 0.237 Vali Acc: 0.936 Test Loss: 0.237 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.398956298828125
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.176 Vali Acc: 0.964 Test Loss: 0.176 Test Acc: 0.964
Validation loss decreased (-0.951948 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 2.418180227279663
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.263 Vali Acc: 0.948 Test Loss: 0.263 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5128087997436523
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.189 Vali Acc: 0.971 Test Loss: 0.189 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 2.369478702545166
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.417 Vali Acc: 0.950 Test Loss: 0.417 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.493345022201538
Epoch: 8, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.344 Vali Acc: 0.939 Test Loss: 0.344 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.668989658355713
Epoch: 9, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.323 Vali Acc: 0.948 Test Loss: 0.323 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.5849711894989014
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.254 Vali Acc: 0.975 Test Loss: 0.254 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974928).  Saving model ...
Epoch: 11 cost time: 2.6354565620422363
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.282 Vali Acc: 0.961 Test Loss: 0.282 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6936593055725098
Epoch: 12, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.404 Vali Acc: 0.962 Test Loss: 0.404 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.713837146759033
Epoch: 13, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.305 Vali Acc: 0.969 Test Loss: 0.305 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5613996982574463
Epoch: 14, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.377 Vali Acc: 0.957 Test Loss: 0.377 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.604048728942871
Epoch: 15, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.388 Vali Acc: 0.963 Test Loss: 0.388 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5746681690216064
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.304 Vali Acc: 0.971 Test Loss: 0.304 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.581031322479248
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.303 Vali Acc: 0.964 Test Loss: 0.303 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.5092520713806152
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.277 Vali Acc: 0.973 Test Loss: 0.277 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.461609363555908
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.381 Vali Acc: 0.964 Test Loss: 0.381 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.661855459213257
Epoch: 20, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.432 Vali Acc: 0.964 Test Loss: 0.432 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 1102640
model size : 9.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.7253315448760986
Epoch: 1, Steps: 89 | Train Loss: 1.031 Vali Loss: 0.372 Vali Acc: 0.901 Test Loss: 0.372 Test Acc: 0.901
Validation loss decreased (inf --> -0.901110).  Saving model ...
Epoch: 2 cost time: 2.4920389652252197
Epoch: 2, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.238 Vali Acc: 0.942 Test Loss: 0.238 Test Acc: 0.942
Validation loss decreased (-0.901110 --> -0.941502).  Saving model ...
Epoch: 3 cost time: 2.4635252952575684
Epoch: 3, Steps: 89 | Train Loss: 0.188 Vali Loss: 0.373 Vali Acc: 0.924 Test Loss: 0.373 Test Acc: 0.924
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4844565391540527
Epoch: 4, Steps: 89 | Train Loss: 0.131 Vali Loss: 0.174 Vali Acc: 0.954 Test Loss: 0.174 Test Acc: 0.954
Validation loss decreased (-0.941502 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 2.464515447616577
Epoch: 5, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.308 Vali Acc: 0.936 Test Loss: 0.308 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.346118211746216
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.197 Vali Acc: 0.958 Test Loss: 0.197 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958215).  Saving model ...
Epoch: 7 cost time: 2.6814768314361572
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.962 Test Loss: 0.222 Test Acc: 0.962
Validation loss decreased (-0.958215 --> -0.962393).  Saving model ...
Epoch: 8 cost time: 2.741215467453003
Epoch: 8, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
Validation loss decreased (-0.962393 --> -0.963786).  Saving model ...
Epoch: 9 cost time: 2.5263075828552246
Epoch: 9, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.205 Vali Acc: 0.971 Test Loss: 0.205 Test Acc: 0.971
Validation loss decreased (-0.963786 --> -0.970750).  Saving model ...
Epoch: 10 cost time: 2.7287073135375977
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.295 Vali Acc: 0.958 Test Loss: 0.295 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.700286865234375
Epoch: 11, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.187 Vali Acc: 0.976 Test Loss: 0.187 Test Acc: 0.976
Validation loss decreased (-0.970750 --> -0.976321).  Saving model ...
Epoch: 12 cost time: 2.6228437423706055
Epoch: 12, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.212 Vali Acc: 0.979 Test Loss: 0.212 Test Acc: 0.979
Validation loss decreased (-0.976321 --> -0.979107).  Saving model ...
Epoch: 13 cost time: 2.6199333667755127
Epoch: 13, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.412 Vali Acc: 0.942 Test Loss: 0.412 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.399555206298828
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.286 Vali Acc: 0.967 Test Loss: 0.286 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4401051998138428
Epoch: 15, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.334 Vali Acc: 0.951 Test Loss: 0.334 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.54083514213562
Epoch: 16, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.509 Vali Acc: 0.947 Test Loss: 0.509 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.3351714611053467
Epoch: 17, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.334 Vali Acc: 0.962 Test Loss: 0.334 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.460858106613159
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.290 Vali Acc: 0.966 Test Loss: 0.290 Test Acc: 0.966
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3127830028533936
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.242 Vali Acc: 0.975 Test Loss: 0.242 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.4895403385162354
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.266 Vali Acc: 0.971 Test Loss: 0.266 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.578089475631714
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.291 Vali Acc: 0.975 Test Loss: 0.291 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.584373712539673
Epoch: 22, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 1026480
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.5141663551330566
Epoch: 1, Steps: 89 | Train Loss: 1.030 Vali Loss: 0.346 Vali Acc: 0.907 Test Loss: 0.346 Test Acc: 0.907
Validation loss decreased (inf --> -0.906682).  Saving model ...
Epoch: 2 cost time: 2.6366612911224365
Epoch: 2, Steps: 89 | Train Loss: 0.250 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.906682 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 2.5526134967803955
Epoch: 3, Steps: 89 | Train Loss: 0.159 Vali Loss: 0.336 Vali Acc: 0.931 Test Loss: 0.336 Test Acc: 0.931
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.813610792160034
Epoch: 4, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.56400203704834
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
Validation loss decreased (-0.951948 --> -0.953340).  Saving model ...
Epoch: 6 cost time: 2.420790672302246
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.266 Vali Acc: 0.940 Test Loss: 0.266 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.631338596343994
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.318 Vali Acc: 0.940 Test Loss: 0.318 Test Acc: 0.940
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5277206897735596
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.191 Vali Acc: 0.968 Test Loss: 0.191 Test Acc: 0.968
Validation loss decreased (-0.953340 --> -0.967965).  Saving model ...
Epoch: 9 cost time: 2.815037727355957
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3904194831848145
Epoch: 10, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.180 Vali Acc: 0.977 Test Loss: 0.180 Test Acc: 0.977
Validation loss decreased (-0.967965 --> -0.977018).  Saving model ...
Epoch: 11 cost time: 2.4493019580841064
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.964 Test Loss: 0.193 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3298075199127197
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.254 Vali Acc: 0.963 Test Loss: 0.254 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.441373825073242
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.509 Vali Acc: 0.932 Test Loss: 0.509 Test Acc: 0.932
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4161977767944336
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.177 Vali Acc: 0.976 Test Loss: 0.177 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4707412719726562
Epoch: 15, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.977 Test Loss: 0.223 Test Acc: 0.977
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5373764038085938
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.960 Test Loss: 0.244 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6973540782928467
Epoch: 17, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.368 Vali Acc: 0.948 Test Loss: 0.368 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.4811885356903076
Epoch: 18, Steps: 89 | Train Loss: 0.208 Vali Loss: 0.629 Vali Acc: 0.906 Test Loss: 0.629 Test Acc: 0.906
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3697452545166016
Epoch: 19, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.544 Vali Acc: 0.927 Test Loss: 0.544 Test Acc: 0.927
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.366137981414795
Epoch: 20, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.214 Vali Acc: 0.974 Test Loss: 0.214 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 1026480
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.158499479293823
Epoch: 1, Steps: 89 | Train Loss: 1.044 Vali Loss: 0.308 Vali Acc: 0.930 Test Loss: 0.308 Test Acc: 0.930
Validation loss decreased (inf --> -0.930359).  Saving model ...
Epoch: 2 cost time: 2.5353128910064697
Epoch: 2, Steps: 89 | Train Loss: 0.229 Vali Loss: 0.172 Vali Acc: 0.953 Test Loss: 0.172 Test Acc: 0.953
Validation loss decreased (-0.930359 --> -0.952645).  Saving model ...
Epoch: 3 cost time: 2.5399911403656006
Epoch: 3, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.266 Vali Acc: 0.935 Test Loss: 0.266 Test Acc: 0.935
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.5757720470428467
Epoch: 4, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.205 Vali Acc: 0.954 Test Loss: 0.205 Test Acc: 0.954
Validation loss decreased (-0.952645 --> -0.954037).  Saving model ...
Epoch: 5 cost time: 2.7562062740325928
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.184 Vali Acc: 0.958 Test Loss: 0.184 Test Acc: 0.958
Validation loss decreased (-0.954037 --> -0.958215).  Saving model ...
Epoch: 6 cost time: 2.7125918865203857
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3201723098754883
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.959 Test Loss: 0.209 Test Acc: 0.959
Validation loss decreased (-0.958215 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 2.315052032470703
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.237 Vali Acc: 0.958 Test Loss: 0.237 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.444185733795166
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.290 Vali Acc: 0.957 Test Loss: 0.290 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5614774227142334
Epoch: 10, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.396 Vali Acc: 0.948 Test Loss: 0.396 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4179275035858154
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.249 Vali Acc: 0.971 Test Loss: 0.249 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.970750).  Saving model ...
Epoch: 12 cost time: 2.445256233215332
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.331 Vali Acc: 0.953 Test Loss: 0.331 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2402987480163574
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.265 Vali Acc: 0.968 Test Loss: 0.265 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.482086420059204
Epoch: 14, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.334 Vali Acc: 0.958 Test Loss: 0.334 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.444394826889038
Epoch: 15, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.349 Vali Acc: 0.963 Test Loss: 0.349 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4807164669036865
Epoch: 16, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.293 Vali Acc: 0.971 Test Loss: 0.293 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3957009315490723
Epoch: 17, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.301 Vali Acc: 0.970 Test Loss: 0.301 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.6336097717285156
Epoch: 18, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.321 Vali Acc: 0.963 Test Loss: 0.321 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5108625888824463
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.306 Vali Acc: 0.971 Test Loss: 0.306 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5192677974700928
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.363 Vali Acc: 0.970 Test Loss: 0.363 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4788153171539307
Epoch: 21, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.396 Vali Acc: 0.966 Test Loss: 0.396 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 1026480
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.790309429168701
Epoch: 1, Steps: 89 | Train Loss: 1.185 Vali Loss: 0.341 Vali Acc: 0.914 Test Loss: 0.341 Test Acc: 0.914
Validation loss decreased (inf --> -0.914342).  Saving model ...
Epoch: 2 cost time: 2.276526689529419
Epoch: 2, Steps: 89 | Train Loss: 0.239 Vali Loss: 0.206 Vali Acc: 0.946 Test Loss: 0.206 Test Acc: 0.946
Validation loss decreased (-0.914342 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 2.5124592781066895
Epoch: 3, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.175 Vali Acc: 0.951 Test Loss: 0.175 Test Acc: 0.951
Validation loss decreased (-0.946377 --> -0.950555).  Saving model ...
Epoch: 4 cost time: 2.4177966117858887
Epoch: 4, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.950555 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 2.3665337562561035
Epoch: 5, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.958216).  Saving model ...
Epoch: 6 cost time: 2.291492462158203
Epoch: 6, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959608).  Saving model ...
Epoch: 7 cost time: 2.4026522636413574
Epoch: 7, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.959608 --> -0.975626).  Saving model ...
Epoch: 8 cost time: 2.4812631607055664
Epoch: 8, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.607758045196533
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.231 Vali Acc: 0.949 Test Loss: 0.231 Test Acc: 0.949
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.740018367767334
Epoch: 10, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.523911952972412
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.972 Test Loss: 0.148 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.667276382446289
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6714913845062256
Epoch: 13, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.147 Vali Acc: 0.978 Test Loss: 0.147 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 2.588707685470581
Epoch: 14, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.237 Vali Acc: 0.971 Test Loss: 0.237 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5341103076934814
Epoch: 15, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.247 Vali Acc: 0.958 Test Loss: 0.247 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.491909980773926
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.6827149391174316
Epoch: 17, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.973 Test Loss: 0.197 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.921772003173828
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.345 Vali Acc: 0.951 Test Loss: 0.345 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.659221649169922
Epoch: 19, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.354 Vali Acc: 0.951 Test Loss: 0.354 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.592893362045288
Epoch: 20, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.298 Vali Acc: 0.966 Test Loss: 0.298 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.609697103500366
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.204 Vali Acc: 0.969 Test Loss: 0.204 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6799466609954834
Epoch: 22, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.259 Vali Acc: 0.966 Test Loss: 0.259 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.670576810836792
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.291 Vali Acc: 0.966 Test Loss: 0.291 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 1026480
model size : 6.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8969337940216064
Epoch: 1, Steps: 89 | Train Loss: 0.997 Vali Loss: 0.323 Vali Acc: 0.914 Test Loss: 0.323 Test Acc: 0.914
Validation loss decreased (inf --> -0.913646).  Saving model ...
Epoch: 2 cost time: 2.288681983947754
Epoch: 2, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.266 Vali Acc: 0.923 Test Loss: 0.266 Test Acc: 0.923
Validation loss decreased (-0.913646 --> -0.923396).  Saving model ...
Epoch: 3 cost time: 2.4446048736572266
Epoch: 3, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.276 Vali Acc: 0.941 Test Loss: 0.276 Test Acc: 0.941
Validation loss decreased (-0.923396 --> -0.940805).  Saving model ...
Epoch: 4 cost time: 2.444762945175171
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.311 Vali Acc: 0.946 Test Loss: 0.311 Test Acc: 0.946
Validation loss decreased (-0.940805 --> -0.946376).  Saving model ...
Epoch: 5 cost time: 2.4808409214019775
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.274 Vali Acc: 0.949 Test Loss: 0.274 Test Acc: 0.949
Validation loss decreased (-0.946376 --> -0.949162).  Saving model ...
Epoch: 6 cost time: 2.403667688369751
Epoch: 6, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.252 Vali Acc: 0.959 Test Loss: 0.252 Test Acc: 0.959
Validation loss decreased (-0.949162 --> -0.958911).  Saving model ...
Epoch: 7 cost time: 2.5634586811065674
Epoch: 7, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.236 Vali Acc: 0.953 Test Loss: 0.236 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4311084747314453
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.239 Vali Acc: 0.959 Test Loss: 0.239 Test Acc: 0.959
Validation loss decreased (-0.958911 --> -0.958911).  Saving model ...
Epoch: 9 cost time: 2.5258963108062744
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.964 Test Loss: 0.206 Test Acc: 0.964
Validation loss decreased (-0.958911 --> -0.963786).  Saving model ...
Epoch: 10 cost time: 2.448406457901001
Epoch: 10, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.230 Vali Acc: 0.962 Test Loss: 0.230 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4969441890716553
Epoch: 11, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.207 Vali Acc: 0.966 Test Loss: 0.207 Test Acc: 0.966
Validation loss decreased (-0.963786 --> -0.965875).  Saving model ...
Epoch: 12 cost time: 2.7456181049346924
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.296 Vali Acc: 0.958 Test Loss: 0.296 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.581005334854126
Epoch: 13, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.237 Vali Acc: 0.974 Test Loss: 0.237 Test Acc: 0.974
Validation loss decreased (-0.965875 --> -0.974232).  Saving model ...
Epoch: 14 cost time: 2.755535364151001
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.267 Vali Acc: 0.967 Test Loss: 0.267 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5882227420806885
Epoch: 15, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.327 Vali Acc: 0.958 Test Loss: 0.327 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8427188396453857
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.312 Vali Acc: 0.962 Test Loss: 0.312 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.557914972305298
Epoch: 17, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.265 Vali Acc: 0.974 Test Loss: 0.265 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.518789052963257
Epoch: 18, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.282 Vali Acc: 0.968 Test Loss: 0.282 Test Acc: 0.968
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.416196584701538
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.337 Vali Acc: 0.955 Test Loss: 0.337 Test Acc: 0.955
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.532146692276001
Epoch: 20, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.280 Vali Acc: 0.972 Test Loss: 0.280 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.403216600418091
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.296 Vali Acc: 0.973 Test Loss: 0.296 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.7542765140533447
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.364 Vali Acc: 0.959 Test Loss: 0.364 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.470747709274292
Epoch: 23, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.338 Vali Acc: 0.970 Test Loss: 0.338 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 764336
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9868929386138916
Epoch: 1, Steps: 89 | Train Loss: 1.003 Vali Loss: 0.317 Vali Acc: 0.917 Test Loss: 0.317 Test Acc: 0.917
Validation loss decreased (inf --> -0.917128).  Saving model ...
Epoch: 2 cost time: 2.2331759929656982
Epoch: 2, Steps: 89 | Train Loss: 0.244 Vali Loss: 0.254 Vali Acc: 0.924 Test Loss: 0.254 Test Acc: 0.924
Validation loss decreased (-0.917128 --> -0.924092).  Saving model ...
Epoch: 3 cost time: 2.345649003982544
Epoch: 3, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.200 Vali Acc: 0.950 Test Loss: 0.200 Test Acc: 0.950
Validation loss decreased (-0.924092 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 2.234445095062256
Epoch: 4, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.180 Vali Acc: 0.957 Test Loss: 0.180 Test Acc: 0.957
Validation loss decreased (-0.949859 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 2.1379408836364746
Epoch: 5, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.236 Vali Acc: 0.955 Test Loss: 0.236 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2236056327819824
Epoch: 6, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.168 Vali Acc: 0.964 Test Loss: 0.168 Test Acc: 0.964
Validation loss decreased (-0.956823 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 2.3146352767944336
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.181 Vali Acc: 0.964 Test Loss: 0.181 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4589684009552
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.962 Test Loss: 0.217 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5635013580322266
Epoch: 9, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.953 Test Loss: 0.296 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3826067447662354
Epoch: 10, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.341 Vali Acc: 0.938 Test Loss: 0.341 Test Acc: 0.938
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.383211374282837
Epoch: 11, Steps: 89 | Train Loss: 0.099 Vali Loss: 0.303 Vali Acc: 0.956 Test Loss: 0.303 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4253616333007812
Epoch: 12, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.266 Vali Acc: 0.959 Test Loss: 0.266 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.7193398475646973
Epoch: 13, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.254 Vali Acc: 0.969 Test Loss: 0.254 Test Acc: 0.969
Validation loss decreased (-0.964483 --> -0.969357).  Saving model ...
Epoch: 14 cost time: 2.743528127670288
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.279 Vali Acc: 0.967 Test Loss: 0.279 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8588523864746094
Epoch: 15, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.316 Vali Acc: 0.969 Test Loss: 0.316 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.4934210777282715
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.337 Vali Acc: 0.971 Test Loss: 0.337 Test Acc: 0.971
Validation loss decreased (-0.969357 --> -0.971445).  Saving model ...
Epoch: 17 cost time: 2.5267062187194824
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.248 Vali Acc: 0.975 Test Loss: 0.248 Test Acc: 0.975
Validation loss decreased (-0.971445 --> -0.974928).  Saving model ...
Epoch: 18 cost time: 2.636514186859131
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.374 Vali Acc: 0.959 Test Loss: 0.374 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6155498027801514
Epoch: 19, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.337 Vali Acc: 0.966 Test Loss: 0.337 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.502254009246826
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.361 Vali Acc: 0.965 Test Loss: 0.361 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.712749481201172
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.381 Vali Acc: 0.958 Test Loss: 0.381 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.576040029525757
Epoch: 22, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.402 Vali Acc: 0.955 Test Loss: 0.402 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6485846042633057
Epoch: 23, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.389 Vali Acc: 0.967 Test Loss: 0.389 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.4169933795928955
Epoch: 24, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.346 Vali Acc: 0.962 Test Loss: 0.346 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.5315043926239014
Epoch: 25, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.288 Vali Acc: 0.973 Test Loss: 0.288 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6501033306121826
Epoch: 26, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.371 Vali Acc: 0.968 Test Loss: 0.371 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.57362699508667
Epoch: 27, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.383 Vali Acc: 0.974 Test Loss: 0.383 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 764336
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.4908106327056885
Epoch: 1, Steps: 89 | Train Loss: 1.026 Vali Loss: 0.326 Vali Acc: 0.906 Test Loss: 0.326 Test Acc: 0.906
Validation loss decreased (inf --> -0.905986).  Saving model ...
Epoch: 2 cost time: 2.7641654014587402
Epoch: 2, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.272 Vali Acc: 0.913 Test Loss: 0.272 Test Acc: 0.913
Validation loss decreased (-0.905986 --> -0.912950).  Saving model ...
Epoch: 3 cost time: 2.4320993423461914
Epoch: 3, Steps: 89 | Train Loss: 0.138 Vali Loss: 0.218 Vali Acc: 0.951 Test Loss: 0.218 Test Acc: 0.951
Validation loss decreased (-0.912950 --> -0.951251).  Saving model ...
Epoch: 4 cost time: 2.5022168159484863
Epoch: 4, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.128 Vali Acc: 0.971 Test Loss: 0.128 Test Acc: 0.971
Validation loss decreased (-0.951251 --> -0.970751).  Saving model ...
Epoch: 5 cost time: 2.5195794105529785
Epoch: 5, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.163 Vali Acc: 0.970 Test Loss: 0.163 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.778381586074829
Epoch: 6, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.174 Vali Acc: 0.972 Test Loss: 0.174 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972143).  Saving model ...
Epoch: 7 cost time: 2.410167694091797
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.576838493347168
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.315 Vali Acc: 0.943 Test Loss: 0.315 Test Acc: 0.943
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3471031188964844
Epoch: 9, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.288 Vali Acc: 0.948 Test Loss: 0.288 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.369296073913574
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.481 Vali Acc: 0.935 Test Loss: 0.481 Test Acc: 0.935
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.2544541358947754
Epoch: 11, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.277 Vali Acc: 0.962 Test Loss: 0.277 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4128808975219727
Epoch: 12, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.268 Vali Acc: 0.960 Test Loss: 0.268 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.4717981815338135
Epoch: 13, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.264 Vali Acc: 0.962 Test Loss: 0.264 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.3931403160095215
Epoch: 14, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.267 Vali Acc: 0.962 Test Loss: 0.267 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.2646889686584473
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973535).  Saving model ...
Epoch: 16 cost time: 2.375500440597534
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.358 Vali Acc: 0.945 Test Loss: 0.358 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.349586248397827
Epoch: 17, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.242 Vali Acc: 0.970 Test Loss: 0.242 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.324660062789917
Epoch: 18, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.976 Test Loss: 0.218 Test Acc: 0.976
Validation loss decreased (-0.973535 --> -0.976321).  Saving model ...
Epoch: 19 cost time: 2.35205340385437
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.228 Vali Acc: 0.978 Test Loss: 0.228 Test Acc: 0.978
Validation loss decreased (-0.976321 --> -0.978410).  Saving model ...
Epoch: 20 cost time: 2.581073760986328
Epoch: 20, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.224 Vali Acc: 0.980 Test Loss: 0.224 Test Acc: 0.980
Validation loss decreased (-0.978410 --> -0.979803).  Saving model ...
Epoch: 21 cost time: 2.5663001537323
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.290 Vali Acc: 0.969 Test Loss: 0.290 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.5247690677642822
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.239 Vali Acc: 0.980 Test Loss: 0.239 Test Acc: 0.980
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6028270721435547
Epoch: 23, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.399 Vali Acc: 0.964 Test Loss: 0.399 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4818410873413086
Epoch: 24, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.833 Vali Acc: 0.941 Test Loss: 0.833 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.5406312942504883
Epoch: 25, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.583 Vali Acc: 0.954 Test Loss: 0.583 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.4560930728912354
Epoch: 26, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.377 Vali Acc: 0.969 Test Loss: 0.377 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.253365993499756
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.438 Vali Acc: 0.966 Test Loss: 0.438 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.3712668418884277
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.341 Vali Acc: 0.974 Test Loss: 0.341 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4341657161712646
Epoch: 29, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.355 Vali Acc: 0.971 Test Loss: 0.355 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.406909227371216
Epoch: 30, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.336 Vali Acc: 0.976 Test Loss: 0.336 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 764336
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.3789122104644775
Epoch: 1, Steps: 89 | Train Loss: 1.160 Vali Loss: 0.371 Vali Acc: 0.884 Test Loss: 0.371 Test Acc: 0.884
Validation loss decreased (inf --> -0.883701).  Saving model ...
Epoch: 2 cost time: 2.3888096809387207
Epoch: 2, Steps: 89 | Train Loss: 0.236 Vali Loss: 0.288 Vali Acc: 0.908 Test Loss: 0.288 Test Acc: 0.908
Validation loss decreased (-0.883701 --> -0.908075).  Saving model ...
Epoch: 3 cost time: 2.402425527572632
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.178 Vali Acc: 0.954 Test Loss: 0.178 Test Acc: 0.954
Validation loss decreased (-0.908075 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 2.3319501876831055
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.160 Vali Acc: 0.951 Test Loss: 0.160 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3577451705932617
Epoch: 5, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3221757411956787
Epoch: 6, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.168 Vali Acc: 0.960 Test Loss: 0.168 Test Acc: 0.960
Validation loss decreased (-0.954037 --> -0.960305).  Saving model ...
Epoch: 7 cost time: 2.3502066135406494
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.272 Vali Acc: 0.948 Test Loss: 0.272 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.704137086868286
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.143 Vali Acc: 0.971 Test Loss: 0.143 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 2.5496201515197754
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.143 Vali Acc: 0.970 Test Loss: 0.143 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.538386106491089
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.961 Test Loss: 0.189 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4259226322174072
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.134 Vali Acc: 0.976 Test Loss: 0.134 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 2.390411853790283
Epoch: 12, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.126 Vali Acc: 0.977 Test Loss: 0.126 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 13 cost time: 2.5745983123779297
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.310 Vali Acc: 0.949 Test Loss: 0.310 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.5664913654327393
Epoch: 14, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.306 Vali Acc: 0.951 Test Loss: 0.306 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5615925788879395
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.254 Vali Acc: 0.958 Test Loss: 0.254 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3815503120422363
Epoch: 16, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.302 Vali Acc: 0.958 Test Loss: 0.302 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.499091148376465
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.279 Vali Acc: 0.963 Test Loss: 0.279 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2637250423431396
Epoch: 18, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.352 Vali Acc: 0.953 Test Loss: 0.352 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.450082778930664
Epoch: 19, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.232 Vali Acc: 0.969 Test Loss: 0.232 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.43157958984375
Epoch: 20, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.970 Test Loss: 0.199 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2009968757629395
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.292 Vali Acc: 0.962 Test Loss: 0.292 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.374236822128296
Epoch: 22, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.197 Vali Acc: 0.964 Test Loss: 0.197 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 764336
model size : 5.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8794050216674805
Epoch: 1, Steps: 89 | Train Loss: 1.054 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
Validation loss decreased (inf --> -0.899718).  Saving model ...
Epoch: 2 cost time: 2.2693934440612793
Epoch: 2, Steps: 89 | Train Loss: 0.258 Vali Loss: 0.212 Vali Acc: 0.945 Test Loss: 0.212 Test Acc: 0.945
Validation loss decreased (-0.899718 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 2.3918683528900146
Epoch: 3, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.177 Vali Acc: 0.962 Test Loss: 0.177 Test Acc: 0.962
Validation loss decreased (-0.944984 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.4363880157470703
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
Validation loss decreased (-0.962394 --> -0.965179).  Saving model ...
Epoch: 5 cost time: 2.7485527992248535
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.173 Vali Acc: 0.957 Test Loss: 0.173 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5398192405700684
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.240 Vali Acc: 0.964 Test Loss: 0.240 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6895995140075684
Epoch: 7, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.216 Vali Acc: 0.962 Test Loss: 0.216 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.442856788635254
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.235 Vali Acc: 0.956 Test Loss: 0.235 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.48100209236145
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.236 Vali Acc: 0.967 Test Loss: 0.236 Test Acc: 0.967
Validation loss decreased (-0.965179 --> -0.966571).  Saving model ...
Epoch: 10 cost time: 2.538360118865967
Epoch: 10, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.305 Vali Acc: 0.953 Test Loss: 0.305 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.616278886795044
Epoch: 11, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.245 Vali Acc: 0.969 Test Loss: 0.245 Test Acc: 0.969
Validation loss decreased (-0.966571 --> -0.968661).  Saving model ...
Epoch: 12 cost time: 2.5235934257507324
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.211 Vali Acc: 0.974 Test Loss: 0.211 Test Acc: 0.974
Validation loss decreased (-0.968661 --> -0.974232).  Saving model ...
Epoch: 13 cost time: 2.2430033683776855
Epoch: 13, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.977 Test Loss: 0.207 Test Acc: 0.977
Validation loss decreased (-0.974232 --> -0.977017).  Saving model ...
Epoch: 14 cost time: 2.3411147594451904
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.256 Vali Acc: 0.971 Test Loss: 0.256 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4322738647460938
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.618 Vali Acc: 0.939 Test Loss: 0.618 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.464665651321411
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.235 Vali Acc: 0.973 Test Loss: 0.235 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.377350330352783
Epoch: 17, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.971 Test Loss: 0.267 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.4706079959869385
Epoch: 18, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.408 Vali Acc: 0.953 Test Loss: 0.408 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.5104458332061768
Epoch: 19, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.263 Vali Acc: 0.972 Test Loss: 0.263 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.4335014820098877
Epoch: 20, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.391 Vali Acc: 0.961 Test Loss: 0.391 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5090653896331787
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.397 Vali Acc: 0.963 Test Loss: 0.397 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.5549821853637695
Epoch: 22, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.355 Vali Acc: 0.969 Test Loss: 0.355 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.4489240646362305
Epoch: 23, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.420 Vali Acc: 0.971 Test Loss: 0.420 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 633264
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.12944221496582
Epoch: 1, Steps: 89 | Train Loss: 1.052 Vali Loss: 0.330 Vali Acc: 0.901 Test Loss: 0.330 Test Acc: 0.901
Validation loss decreased (inf --> -0.901111).  Saving model ...
Epoch: 2 cost time: 2.6567862033843994
Epoch: 2, Steps: 89 | Train Loss: 0.245 Vali Loss: 0.213 Vali Acc: 0.946 Test Loss: 0.213 Test Acc: 0.946
Validation loss decreased (-0.901111 --> -0.946377).  Saving model ...
Epoch: 3 cost time: 2.5012528896331787
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.176 Vali Acc: 0.962 Test Loss: 0.176 Test Acc: 0.962
Validation loss decreased (-0.946377 --> -0.961697).  Saving model ...
Epoch: 4 cost time: 2.7236571311950684
Epoch: 4, Steps: 89 | Train Loss: 0.108 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5482075214385986
Epoch: 5, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
Validation loss decreased (-0.961697 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 2.707986831665039
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.977 Test Loss: 0.142 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977018).  Saving model ...
Epoch: 7 cost time: 2.4550821781158447
Epoch: 7, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.330 Vali Acc: 0.943 Test Loss: 0.330 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4930708408355713
Epoch: 8, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.229 Vali Acc: 0.966 Test Loss: 0.229 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.3987748622894287
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.278 Vali Acc: 0.958 Test Loss: 0.278 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.402320623397827
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.270 Vali Acc: 0.967 Test Loss: 0.270 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.4507176876068115
Epoch: 11, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.341 Vali Acc: 0.953 Test Loss: 0.341 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.442899703979492
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.194 Vali Acc: 0.976 Test Loss: 0.194 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.558969736099243
Epoch: 13, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.216 Vali Acc: 0.971 Test Loss: 0.216 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.4016921520233154
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.324 Vali Acc: 0.960 Test Loss: 0.324 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.5073413848876953
Epoch: 15, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.309 Vali Acc: 0.964 Test Loss: 0.309 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.3483786582946777
Epoch: 16, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.303 Vali Acc: 0.965 Test Loss: 0.303 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 633264
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.156756401062012
Epoch: 1, Steps: 89 | Train Loss: 1.071 Vali Loss: 0.329 Vali Acc: 0.909 Test Loss: 0.329 Test Acc: 0.909
Validation loss decreased (inf --> -0.909467).  Saving model ...
Epoch: 2 cost time: 2.677966833114624
Epoch: 2, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.188 Vali Acc: 0.949 Test Loss: 0.188 Test Acc: 0.949
Validation loss decreased (-0.909467 --> -0.949162).  Saving model ...
Epoch: 3 cost time: 2.529003143310547
Epoch: 3, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.949162 --> -0.966572).  Saving model ...
Epoch: 4 cost time: 2.6861824989318848
Epoch: 4, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 2.3256149291992188
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.220 Vali Acc: 0.940 Test Loss: 0.220 Test Acc: 0.940
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.958521604537964
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.955 Test Loss: 0.222 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4935193061828613
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.5701346397399902
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.963 Test Loss: 0.222 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.3496663570404053
Epoch: 9, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.237 Vali Acc: 0.964 Test Loss: 0.237 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3768200874328613
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.256 Vali Acc: 0.967 Test Loss: 0.256 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.388174533843994
Epoch: 11, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.964 Test Loss: 0.259 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.6391661167144775
Epoch: 12, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.304 Vali Acc: 0.960 Test Loss: 0.304 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.460902690887451
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.258 Vali Acc: 0.964 Test Loss: 0.258 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.4265761375427246
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.236 Vali Acc: 0.971 Test Loss: 0.236 Test Acc: 0.971
Validation loss decreased (-0.968662 --> -0.970750).  Saving model ...
Epoch: 15 cost time: 2.360790491104126
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.966 Test Loss: 0.279 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3666937351226807
Epoch: 16, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.278 Vali Acc: 0.968 Test Loss: 0.278 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.4173104763031006
Epoch: 17, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.333 Vali Acc: 0.964 Test Loss: 0.333 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.544588804244995
Epoch: 18, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.323 Vali Acc: 0.964 Test Loss: 0.323 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7072598934173584
Epoch: 19, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.388 Vali Acc: 0.953 Test Loss: 0.388 Test Acc: 0.953
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.50327467918396
Epoch: 20, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.371 Vali Acc: 0.967 Test Loss: 0.371 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.3030591011047363
Epoch: 21, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.389 Vali Acc: 0.963 Test Loss: 0.389 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.528480291366577
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.361 Vali Acc: 0.969 Test Loss: 0.361 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.93715500831604
Epoch: 23, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.401 Vali Acc: 0.961 Test Loss: 0.401 Test Acc: 0.961
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.551927328109741
Epoch: 24, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.474 Vali Acc: 0.959 Test Loss: 0.474 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 633264
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8185038566589355
Epoch: 1, Steps: 89 | Train Loss: 1.188 Vali Loss: 0.351 Vali Acc: 0.906 Test Loss: 0.351 Test Acc: 0.906
Validation loss decreased (inf --> -0.905985).  Saving model ...
Epoch: 2 cost time: 2.431291103363037
Epoch: 2, Steps: 89 | Train Loss: 0.222 Vali Loss: 0.180 Vali Acc: 0.950 Test Loss: 0.180 Test Acc: 0.950
Validation loss decreased (-0.905985 --> -0.949859).  Saving model ...
Epoch: 3 cost time: 2.2573680877685547
Epoch: 3, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.949859 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.4685816764831543
Epoch: 4, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.153 Vali Acc: 0.963 Test Loss: 0.153 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 2.4980807304382324
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4747064113616943
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 2.5996272563934326
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.953 Test Loss: 0.213 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.486862897872925
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.151 Vali Acc: 0.966 Test Loss: 0.151 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5246517658233643
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6303398609161377
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.184 Vali Acc: 0.963 Test Loss: 0.184 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.3782262802124023
Epoch: 11, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.4087393283843994
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.213 Vali Acc: 0.960 Test Loss: 0.213 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.3497657775878906
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.450066566467285
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.193 Vali Acc: 0.960 Test Loss: 0.193 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.4443225860595703
Epoch: 15, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.263 Vali Acc: 0.964 Test Loss: 0.263 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.6836788654327393
Epoch: 16, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.206 Vali Acc: 0.960 Test Loss: 0.206 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 633264
model size : 4.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.0964038372039795
Epoch: 1, Steps: 89 | Train Loss: 1.037 Vali Loss: 0.322 Vali Acc: 0.923 Test Loss: 0.322 Test Acc: 0.923
Validation loss decreased (inf --> -0.922699).  Saving model ...
Epoch: 2 cost time: 2.661207675933838
Epoch: 2, Steps: 89 | Train Loss: 0.234 Vali Loss: 0.190 Vali Acc: 0.954 Test Loss: 0.190 Test Acc: 0.954
Validation loss decreased (-0.922699 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 2.621163845062256
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.245 Vali Acc: 0.932 Test Loss: 0.245 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4617486000061035
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
Validation loss decreased (-0.954037 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 2.3646960258483887
Epoch: 5, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.246 Vali Acc: 0.951 Test Loss: 0.246 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.591981887817383
Epoch: 6, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.182 Vali Acc: 0.964 Test Loss: 0.182 Test Acc: 0.964
Validation loss decreased (-0.954734 --> -0.964483).  Saving model ...
Epoch: 7 cost time: 2.672945499420166
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.223 Vali Acc: 0.951 Test Loss: 0.223 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.264779806137085
Epoch: 8, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.968 Test Loss: 0.226 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967964).  Saving model ...
Epoch: 9 cost time: 2.2341420650482178
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.295 Vali Acc: 0.958 Test Loss: 0.295 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9929959774017334
Epoch: 10, Steps: 89 | Train Loss: 0.100 Vali Loss: 0.308 Vali Acc: 0.955 Test Loss: 0.308 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4647858142852783
Epoch: 11, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.310 Vali Acc: 0.962 Test Loss: 0.310 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.241832733154297
Epoch: 12, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.259 Vali Acc: 0.976 Test Loss: 0.259 Test Acc: 0.976
Validation loss decreased (-0.967964 --> -0.976321).  Saving model ...
Epoch: 13 cost time: 2.4690020084381104
Epoch: 13, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.272 Vali Acc: 0.975 Test Loss: 0.272 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.541443347930908
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.313 Vali Acc: 0.972 Test Loss: 0.313 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6806323528289795
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.285 Vali Acc: 0.967 Test Loss: 0.285 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4018492698669434
Epoch: 16, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.977 Test Loss: 0.208 Test Acc: 0.977
Validation loss decreased (-0.976321 --> -0.977017).  Saving model ...
Epoch: 17 cost time: 2.5086371898651123
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.250 Vali Acc: 0.976 Test Loss: 0.250 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5499653816223145
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.231 Vali Acc: 0.972 Test Loss: 0.231 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4938409328460693
Epoch: 19, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.378 Vali Acc: 0.952 Test Loss: 0.378 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6941401958465576
Epoch: 20, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.371 Vali Acc: 0.962 Test Loss: 0.371 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.422048568725586
Epoch: 21, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.464 Vali Acc: 0.955 Test Loss: 0.464 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3930916786193848
Epoch: 22, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.975 Test Loss: 0.298 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.671102523803711
Epoch: 23, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.595 Vali Acc: 0.945 Test Loss: 0.595 Test Acc: 0.945
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.7189903259277344
Epoch: 24, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.358 Vali Acc: 0.966 Test Loss: 0.358 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7102067470550537
Epoch: 25, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.460 Vali Acc: 0.956 Test Loss: 0.460 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5827763080596924
Epoch: 26, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.490 Vali Acc: 0.958 Test Loss: 0.490 Test Acc: 0.958
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 567728
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.916440963745117
Epoch: 1, Steps: 89 | Train Loss: 1.027 Vali Loss: 0.318 Vali Acc: 0.921 Test Loss: 0.318 Test Acc: 0.921
Validation loss decreased (inf --> -0.921306).  Saving model ...
Epoch: 2 cost time: 2.539552927017212
Epoch: 2, Steps: 89 | Train Loss: 0.213 Vali Loss: 0.216 Vali Acc: 0.936 Test Loss: 0.216 Test Acc: 0.936
Validation loss decreased (-0.921306 --> -0.935931).  Saving model ...
Epoch: 3 cost time: 2.469966411590576
Epoch: 3, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.935931 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 2.41786527633667
Epoch: 4, Steps: 89 | Train Loss: 0.126 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
Validation loss decreased (-0.943591 --> -0.954734).  Saving model ...
Epoch: 5 cost time: 2.4721620082855225
Epoch: 5, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.951 Test Loss: 0.225 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4267101287841797
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4654147624969482
Epoch: 7, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.255 Vali Acc: 0.950 Test Loss: 0.255 Test Acc: 0.950
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.446854591369629
Epoch: 8, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.307 Vali Acc: 0.957 Test Loss: 0.307 Test Acc: 0.957
Validation loss decreased (-0.954734 --> -0.956821).  Saving model ...
Epoch: 9 cost time: 2.428861379623413
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.255 Vali Acc: 0.963 Test Loss: 0.255 Test Acc: 0.963
Validation loss decreased (-0.956821 --> -0.963089).  Saving model ...
Epoch: 10 cost time: 2.260410785675049
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.288 Vali Acc: 0.955 Test Loss: 0.288 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.405083179473877
Epoch: 11, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.224 Vali Acc: 0.962 Test Loss: 0.224 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.390707015991211
Epoch: 12, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.223 Vali Acc: 0.964 Test Loss: 0.223 Test Acc: 0.964
Validation loss decreased (-0.963089 --> -0.964482).  Saving model ...
Epoch: 13 cost time: 2.6912379264831543
Epoch: 13, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.382 Vali Acc: 0.937 Test Loss: 0.382 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7394721508026123
Epoch: 14, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.219 Vali Acc: 0.972 Test Loss: 0.219 Test Acc: 0.972
Validation loss decreased (-0.964482 --> -0.972143).  Saving model ...
Epoch: 15 cost time: 2.763503074645996
Epoch: 15, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.554 Vali Acc: 0.946 Test Loss: 0.554 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.624312162399292
Epoch: 16, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.328 Vali Acc: 0.967 Test Loss: 0.328 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.522998094558716
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.334 Vali Acc: 0.963 Test Loss: 0.334 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.676961660385132
Epoch: 18, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.307 Vali Acc: 0.974 Test Loss: 0.307 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973535).  Saving model ...
Epoch: 19 cost time: 2.6395812034606934
Epoch: 19, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.273 Vali Acc: 0.974 Test Loss: 0.273 Test Acc: 0.974
Validation loss decreased (-0.973535 --> -0.973535).  Saving model ...
Epoch: 20 cost time: 2.8877081871032715
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.378 Vali Acc: 0.967 Test Loss: 0.378 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.353137254714966
Epoch: 21, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.396 Vali Acc: 0.966 Test Loss: 0.396 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.47910737991333
Epoch: 22, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.305 Vali Acc: 0.976 Test Loss: 0.305 Test Acc: 0.976
Validation loss decreased (-0.973535 --> -0.975624).  Saving model ...
Epoch: 23 cost time: 2.302070379257202
Epoch: 23, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.320 Vali Acc: 0.972 Test Loss: 0.320 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.538281202316284
Epoch: 24, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.338 Vali Acc: 0.974 Test Loss: 0.338 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.6289193630218506
Epoch: 25, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.339 Vali Acc: 0.968 Test Loss: 0.339 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.5725204944610596
Epoch: 26, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.367 Vali Acc: 0.961 Test Loss: 0.367 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.5008277893066406
Epoch: 27, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.440 Vali Acc: 0.962 Test Loss: 0.440 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.4608089923858643
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.333 Vali Acc: 0.977 Test Loss: 0.333 Test Acc: 0.977
Validation loss decreased (-0.975624 --> -0.977016).  Saving model ...
Epoch: 29 cost time: 2.441840171813965
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.348 Vali Acc: 0.975 Test Loss: 0.348 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.4686479568481445
Epoch: 30, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.319 Vali Acc: 0.973 Test Loss: 0.319 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.404240608215332
Epoch: 31, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.493 Vali Acc: 0.957 Test Loss: 0.493 Test Acc: 0.957
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 2.602487802505493
Epoch: 32, Steps: 89 | Train Loss: 0.155 Vali Loss: 0.481 Vali Acc: 0.967 Test Loss: 0.481 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 2.533067464828491
Epoch: 33, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.393 Vali Acc: 0.973 Test Loss: 0.393 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 2.723583221435547
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.519 Vali Acc: 0.956 Test Loss: 0.519 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 2.6901302337646484
Epoch: 35, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.304 Vali Acc: 0.979 Test Loss: 0.304 Test Acc: 0.979
Validation loss decreased (-0.977016 --> -0.979106).  Saving model ...
Epoch: 36 cost time: 2.5377094745635986
Epoch: 36, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.313 Vali Acc: 0.978 Test Loss: 0.313 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 2.6688406467437744
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.315 Vali Acc: 0.981 Test Loss: 0.315 Test Acc: 0.981
Validation loss decreased (-0.979106 --> -0.981195).  Saving model ...
Epoch: 38 cost time: 2.5153210163116455
Epoch: 38, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.341 Vali Acc: 0.974 Test Loss: 0.341 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.285004138946533
Epoch: 39, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.369 Vali Acc: 0.975 Test Loss: 0.369 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.3859732151031494
Epoch: 40, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.312 Vali Acc: 0.978 Test Loss: 0.312 Test Acc: 0.978
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.3867762088775635
Epoch: 41, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.341 Vali Acc: 0.978 Test Loss: 0.341 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.4450504779815674
Epoch: 42, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.378 Vali Acc: 0.978 Test Loss: 0.378 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.5996625423431396
Epoch: 43, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.382 Vali Acc: 0.979 Test Loss: 0.382 Test Acc: 0.979
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.3196825981140137
Epoch: 44, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.376 Vali Acc: 0.971 Test Loss: 0.376 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.4468631744384766
Epoch: 45, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.384 Vali Acc: 0.969 Test Loss: 0.384 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.405698537826538
Epoch: 46, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.350 Vali Acc: 0.978 Test Loss: 0.350 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.373687505722046
Epoch: 47, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.437 Vali Acc: 0.978 Test Loss: 0.437 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 567728
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9866538047790527
Epoch: 1, Steps: 89 | Train Loss: 1.046 Vali Loss: 0.302 Vali Acc: 0.925 Test Loss: 0.302 Test Acc: 0.925
Validation loss decreased (inf --> -0.925484).  Saving model ...
Epoch: 2 cost time: 2.7219834327697754
Epoch: 2, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.229 Vali Acc: 0.927 Test Loss: 0.229 Test Acc: 0.927
Validation loss decreased (-0.925484 --> -0.926878).  Saving model ...
Epoch: 3 cost time: 2.8379640579223633
Epoch: 3, Steps: 89 | Train Loss: 0.117 Vali Loss: 0.161 Vali Acc: 0.957 Test Loss: 0.161 Test Acc: 0.957
Validation loss decreased (-0.926878 --> -0.956823).  Saving model ...
Epoch: 4 cost time: 2.694120407104492
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
Validation loss decreased (-0.956823 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 2.7134311199188232
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.262 Vali Acc: 0.942 Test Loss: 0.262 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.637989044189453
Epoch: 6, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.65012526512146
Epoch: 7, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.247 Vali Acc: 0.953 Test Loss: 0.247 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.4379360675811768
Epoch: 8, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.170 Vali Acc: 0.970 Test Loss: 0.170 Test Acc: 0.970
Validation loss decreased (-0.968662 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 2.476870059967041
Epoch: 9, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.970054 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 2.4582998752593994
Epoch: 10, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.563 Vali Acc: 0.904 Test Loss: 0.563 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4781246185302734
Epoch: 11, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.207 Vali Acc: 0.971 Test Loss: 0.207 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.436068058013916
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.292 Vali Acc: 0.958 Test Loss: 0.292 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.479640007019043
Epoch: 13, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.329 Vali Acc: 0.963 Test Loss: 0.329 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.5399436950683594
Epoch: 14, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.252 Vali Acc: 0.973 Test Loss: 0.252 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.5202746391296387
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.275 Vali Acc: 0.960 Test Loss: 0.275 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.453155994415283
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.361 Vali Acc: 0.958 Test Loss: 0.361 Test Acc: 0.958
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6840450763702393
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.318 Vali Acc: 0.960 Test Loss: 0.318 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.4944374561309814
Epoch: 18, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.232 Vali Acc: 0.972 Test Loss: 0.232 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.5224685668945312
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.973 Test Loss: 0.230 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 567728
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.963932991027832
Epoch: 1, Steps: 89 | Train Loss: 1.170 Vali Loss: 0.351 Vali Acc: 0.921 Test Loss: 0.351 Test Acc: 0.921
Validation loss decreased (inf --> -0.920609).  Saving model ...
Epoch: 2 cost time: 2.493605375289917
Epoch: 2, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.191 Vali Acc: 0.953 Test Loss: 0.191 Test Acc: 0.953
Validation loss decreased (-0.920609 --> -0.952644).  Saving model ...
Epoch: 3 cost time: 2.325639486312866
Epoch: 3, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
Validation loss decreased (-0.952644 --> -0.960305).  Saving model ...
Epoch: 4 cost time: 2.374610185623169
Epoch: 4, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.173 Vali Acc: 0.947 Test Loss: 0.173 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.18913197517395
Epoch: 5, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.960305 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 2.527676820755005
Epoch: 6, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
Validation loss decreased (-0.964483 --> -0.972840).  Saving model ...
Epoch: 7 cost time: 2.2216780185699463
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.206 Vali Acc: 0.954 Test Loss: 0.206 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3137807846069336
Epoch: 8, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.108 Vali Acc: 0.974 Test Loss: 0.108 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 2.249502182006836
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.953 Test Loss: 0.222 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3262112140655518
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.297 Vali Acc: 0.939 Test Loss: 0.297 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4366579055786133
Epoch: 11, Steps: 89 | Train Loss: 0.113 Vali Loss: 0.252 Vali Acc: 0.961 Test Loss: 0.252 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6438868045806885
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.201 Vali Acc: 0.965 Test Loss: 0.201 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.214979410171509
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.229 Vali Acc: 0.961 Test Loss: 0.229 Test Acc: 0.961
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4856252670288086
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.643754482269287
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.195 Vali Acc: 0.968 Test Loss: 0.195 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.4780774116516113
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.967 Test Loss: 0.193 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.505483627319336
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.7609055042266846
Epoch: 18, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.967 Test Loss: 0.217 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 567728
model size : 4.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.979335308074951
Epoch: 1, Steps: 89 | Train Loss: 1.017 Vali Loss: 0.366 Vali Acc: 0.908 Test Loss: 0.366 Test Acc: 0.908
Validation loss decreased (inf --> -0.908074).  Saving model ...
Epoch: 2 cost time: 2.661320447921753
Epoch: 2, Steps: 89 | Train Loss: 0.223 Vali Loss: 0.209 Vali Acc: 0.935 Test Loss: 0.209 Test Acc: 0.935
Validation loss decreased (-0.908074 --> -0.935235).  Saving model ...
Epoch: 3 cost time: 2.8985583782196045
Epoch: 3, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.412 Vali Acc: 0.901 Test Loss: 0.412 Test Acc: 0.901
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.4974002838134766
Epoch: 4, Steps: 89 | Train Loss: 0.121 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.935235 --> -0.937324).  Saving model ...
Epoch: 5 cost time: 2.46089768409729
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.224 Vali Acc: 0.953 Test Loss: 0.224 Test Acc: 0.953
Validation loss decreased (-0.937324 --> -0.952644).  Saving model ...
Epoch: 6 cost time: 2.5658226013183594
Epoch: 6, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
Validation loss decreased (-0.952644 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 2.692931652069092
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.269 Vali Acc: 0.946 Test Loss: 0.269 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4753408432006836
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.189 Vali Acc: 0.973 Test Loss: 0.189 Test Acc: 0.973
Validation loss decreased (-0.956126 --> -0.972839).  Saving model ...
Epoch: 9 cost time: 2.720041275024414
Epoch: 9, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5646843910217285
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.314 Vali Acc: 0.944 Test Loss: 0.314 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.542628526687622
Epoch: 11, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.964 Test Loss: 0.218 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.498922348022461
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.575523614883423
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.971 Test Loss: 0.202 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6015756130218506
Epoch: 14, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.301 Vali Acc: 0.952 Test Loss: 0.301 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5814497470855713
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.323 Vali Acc: 0.961 Test Loss: 0.323 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9342362880706787
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.283 Vali Acc: 0.970 Test Loss: 0.283 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7264950275421143
Epoch: 17, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.329 Vali Acc: 0.973 Test Loss: 0.329 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.696506977081299
Epoch: 18, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.301 Vali Acc: 0.969 Test Loss: 0.301 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 534960
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.122493743896484
Epoch: 1, Steps: 89 | Train Loss: 1.018 Vali Loss: 0.346 Vali Acc: 0.910 Test Loss: 0.346 Test Acc: 0.910
Validation loss decreased (inf --> -0.910164).  Saving model ...
Epoch: 2 cost time: 2.3168094158172607
Epoch: 2, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.222 Vali Acc: 0.929 Test Loss: 0.222 Test Acc: 0.929
Validation loss decreased (-0.910164 --> -0.928967).  Saving model ...
Epoch: 3 cost time: 2.305995225906372
Epoch: 3, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.213 Vali Acc: 0.938 Test Loss: 0.213 Test Acc: 0.938
Validation loss decreased (-0.928967 --> -0.938020).  Saving model ...
Epoch: 4 cost time: 2.4040050506591797
Epoch: 4, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.938020 --> -0.943591).  Saving model ...
Epoch: 5 cost time: 2.3528873920440674
Epoch: 5, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.943591 --> -0.944287).  Saving model ...
Epoch: 6 cost time: 2.380432605743408
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
Validation loss decreased (-0.944287 --> -0.961697).  Saving model ...
Epoch: 7 cost time: 2.279711961746216
Epoch: 7, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3295159339904785
Epoch: 8, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.192 Vali Acc: 0.975 Test Loss: 0.192 Test Acc: 0.975
Validation loss decreased (-0.961697 --> -0.974928).  Saving model ...
Epoch: 9 cost time: 2.3778762817382812
Epoch: 9, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3668265342712402
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.270 Vali Acc: 0.953 Test Loss: 0.270 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.257277011871338
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.203 Vali Acc: 0.969 Test Loss: 0.203 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.328728199005127
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.234 Vali Acc: 0.964 Test Loss: 0.234 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.3401150703430176
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.619771957397461
Epoch: 14, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.255 Vali Acc: 0.964 Test Loss: 0.255 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6098315715789795
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.345 Vali Acc: 0.962 Test Loss: 0.345 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.8853161334991455
Epoch: 16, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.302 Vali Acc: 0.955 Test Loss: 0.302 Test Acc: 0.955
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.808110237121582
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.203 Vali Acc: 0.974 Test Loss: 0.203 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.700660228729248
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.273 Vali Acc: 0.961 Test Loss: 0.273 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 534960
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.8712081909179688
Epoch: 1, Steps: 89 | Train Loss: 1.032 Vali Loss: 0.341 Vali Acc: 0.907 Test Loss: 0.341 Test Acc: 0.907
Validation loss decreased (inf --> -0.906682).  Saving model ...
Epoch: 2 cost time: 2.533513069152832
Epoch: 2, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.202 Vali Acc: 0.942 Test Loss: 0.202 Test Acc: 0.942
Validation loss decreased (-0.906682 --> -0.942199).  Saving model ...
Epoch: 3 cost time: 2.5938467979431152
Epoch: 3, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.942199 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 2.3861117362976074
Epoch: 4, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.234 Vali Acc: 0.945 Test Loss: 0.234 Test Acc: 0.945
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.2787392139434814
Epoch: 5, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.234 Vali Acc: 0.941 Test Loss: 0.234 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.4476757049560547
Epoch: 6, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.241 Vali Acc: 0.944 Test Loss: 0.241 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.546617031097412
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.196 Vali Acc: 0.955 Test Loss: 0.196 Test Acc: 0.955
Validation loss decreased (-0.951948 --> -0.955430).  Saving model ...
Epoch: 8 cost time: 2.5743885040283203
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.178 Vali Acc: 0.971 Test Loss: 0.178 Test Acc: 0.971
Validation loss decreased (-0.955430 --> -0.970750).  Saving model ...
Epoch: 9 cost time: 2.7226741313934326
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.209 Vali Acc: 0.964 Test Loss: 0.209 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3521568775177
Epoch: 10, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.333 Vali Acc: 0.942 Test Loss: 0.333 Test Acc: 0.942
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.41054368019104
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.961 Test Loss: 0.254 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.54488468170166
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.246 Vali Acc: 0.971 Test Loss: 0.246 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.830733060836792
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.248 Vali Acc: 0.964 Test Loss: 0.248 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.7280497550964355
Epoch: 14, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.233 Vali Acc: 0.969 Test Loss: 0.233 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5509305000305176
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.373 Vali Acc: 0.950 Test Loss: 0.373 Test Acc: 0.950
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.588134527206421
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.315 Vali Acc: 0.962 Test Loss: 0.315 Test Acc: 0.962
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.6112630367279053
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.969 Test Loss: 0.296 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6986188888549805
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.342 Vali Acc: 0.964 Test Loss: 0.342 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 534960
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.746425151824951
Epoch: 1, Steps: 89 | Train Loss: 1.160 Vali Loss: 0.380 Vali Acc: 0.896 Test Loss: 0.380 Test Acc: 0.896
Validation loss decreased (inf --> -0.896236).  Saving model ...
Epoch: 2 cost time: 2.3784282207489014
Epoch: 2, Steps: 89 | Train Loss: 0.226 Vali Loss: 0.198 Vali Acc: 0.945 Test Loss: 0.198 Test Acc: 0.945
Validation loss decreased (-0.896236 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 2.4093165397644043
Epoch: 3, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.944984 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 2.466111421585083
Epoch: 4, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.161 Vali Acc: 0.961 Test Loss: 0.161 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 2.558773994445801
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.184 Vali Acc: 0.955 Test Loss: 0.184 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.456533908843994
Epoch: 6, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.142 Vali Acc: 0.967 Test Loss: 0.142 Test Acc: 0.967
Validation loss decreased (-0.961001 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 2.421764373779297
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.146 Vali Acc: 0.966 Test Loss: 0.146 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.472654342651367
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.503009557723999
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.129 Vali Acc: 0.970 Test Loss: 0.129 Test Acc: 0.970
Validation loss decreased (-0.967269 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 2.71881365776062
Epoch: 10, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.961 Test Loss: 0.217 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6530649662017822
Epoch: 11, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.595296859741211
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.252 Vali Acc: 0.955 Test Loss: 0.252 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.817511558532715
Epoch: 13, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.275 Vali Acc: 0.957 Test Loss: 0.275 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6805737018585205
Epoch: 14, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.222 Vali Acc: 0.955 Test Loss: 0.222 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.761482000350952
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.029844284057617
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.965 Test Loss: 0.206 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.5685811042785645
Epoch: 17, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.251 Vali Acc: 0.966 Test Loss: 0.251 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.5640318393707275
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.301 Vali Acc: 0.957 Test Loss: 0.301 Test Acc: 0.957
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.569657802581787
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.968 Test Loss: 0.218 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9700557103064067
model parameter : 534960
model size : 4.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.172082424163818
Epoch: 1, Steps: 89 | Train Loss: 1.039 Vali Loss: 0.338 Vali Acc: 0.909 Test Loss: 0.338 Test Acc: 0.909
Validation loss decreased (inf --> -0.909467).  Saving model ...
Epoch: 2 cost time: 2.561048984527588
Epoch: 2, Steps: 89 | Train Loss: 0.283 Vali Loss: 0.253 Vali Acc: 0.923 Test Loss: 0.253 Test Acc: 0.923
Validation loss decreased (-0.909467 --> -0.923396).  Saving model ...
Epoch: 3 cost time: 2.5536892414093018
Epoch: 3, Steps: 89 | Train Loss: 0.199 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.923396 --> -0.943591).  Saving model ...
Epoch: 4 cost time: 2.637683629989624
Epoch: 4, Steps: 89 | Train Loss: 0.163 Vali Loss: 0.270 Vali Acc: 0.939 Test Loss: 0.270 Test Acc: 0.939
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5635910034179688
Epoch: 5, Steps: 89 | Train Loss: 0.174 Vali Loss: 0.239 Vali Acc: 0.951 Test Loss: 0.239 Test Acc: 0.951
Validation loss decreased (-0.943591 --> -0.951251).  Saving model ...
Epoch: 6 cost time: 2.578486442565918
Epoch: 6, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.243 Vali Acc: 0.953 Test Loss: 0.243 Test Acc: 0.953
Validation loss decreased (-0.951251 --> -0.952644).  Saving model ...
Epoch: 7 cost time: 2.6351680755615234
Epoch: 7, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.186 Vali Acc: 0.975 Test Loss: 0.186 Test Acc: 0.975
Validation loss decreased (-0.952644 --> -0.974928).  Saving model ...
Epoch: 8 cost time: 2.732595682144165
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.283 Vali Acc: 0.948 Test Loss: 0.283 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.724011182785034
Epoch: 9, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.239 Vali Acc: 0.967 Test Loss: 0.239 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.65742826461792
Epoch: 10, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.348 Vali Acc: 0.942 Test Loss: 0.348 Test Acc: 0.942
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.643737316131592
Epoch: 11, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.376 Vali Acc: 0.945 Test Loss: 0.376 Test Acc: 0.945
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.6871626377105713
Epoch: 12, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.285 Vali Acc: 0.967 Test Loss: 0.285 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.6209123134613037
Epoch: 13, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.374 Vali Acc: 0.947 Test Loss: 0.374 Test Acc: 0.947
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.497049570083618
Epoch: 14, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.407 Vali Acc: 0.948 Test Loss: 0.407 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.652177095413208
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.273 Vali Acc: 0.969 Test Loss: 0.273 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.5229148864746094
Epoch: 16, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.338 Vali Acc: 0.962 Test Loss: 0.338 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.634068250656128
Epoch: 17, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.329 Vali Acc: 0.971 Test Loss: 0.329 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 518576
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.6964077949523926
Epoch: 1, Steps: 89 | Train Loss: 1.034 Vali Loss: 0.326 Vali Acc: 0.905 Test Loss: 0.326 Test Acc: 0.905
Validation loss decreased (inf --> -0.905289).  Saving model ...
Epoch: 2 cost time: 2.4544272422790527
Epoch: 2, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.250 Vali Acc: 0.923 Test Loss: 0.250 Test Acc: 0.923
Validation loss decreased (-0.905289 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 2.6410255432128906
Epoch: 3, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.922699 --> -0.966572).  Saving model ...
Epoch: 4 cost time: 2.4313807487487793
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.266 Vali Acc: 0.932 Test Loss: 0.266 Test Acc: 0.932
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.270214557647705
Epoch: 5, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.187 Vali Acc: 0.961 Test Loss: 0.187 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.3499791622161865
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.168 Vali Acc: 0.967 Test Loss: 0.168 Test Acc: 0.967
Validation loss decreased (-0.966572 --> -0.967269).  Saving model ...
Epoch: 7 cost time: 2.6175060272216797
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.252 Vali Acc: 0.947 Test Loss: 0.252 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7524213790893555
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.239 Vali Acc: 0.955 Test Loss: 0.239 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.708009719848633
Epoch: 9, Steps: 89 | Train Loss: 0.122 Vali Loss: 0.312 Vali Acc: 0.947 Test Loss: 0.312 Test Acc: 0.947
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.6501729488372803
Epoch: 10, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.404 Vali Acc: 0.943 Test Loss: 0.404 Test Acc: 0.943
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.7308948040008545
Epoch: 11, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.244 Vali Acc: 0.973 Test Loss: 0.244 Test Acc: 0.973
Validation loss decreased (-0.967269 --> -0.972839).  Saving model ...
Epoch: 12 cost time: 2.5590169429779053
Epoch: 12, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.232 Vali Acc: 0.974 Test Loss: 0.232 Test Acc: 0.974
Validation loss decreased (-0.972839 --> -0.973535).  Saving model ...
Epoch: 13 cost time: 2.9194846153259277
Epoch: 13, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.300 Vali Acc: 0.959 Test Loss: 0.300 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.505466938018799
Epoch: 14, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.339 Vali Acc: 0.950 Test Loss: 0.339 Test Acc: 0.950
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.417163133621216
Epoch: 15, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.323 Vali Acc: 0.963 Test Loss: 0.323 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.387369394302368
Epoch: 16, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.374 Vali Acc: 0.950 Test Loss: 0.374 Test Acc: 0.950
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.356907606124878
Epoch: 17, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.318 Vali Acc: 0.971 Test Loss: 0.318 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.335272789001465
Epoch: 18, Steps: 89 | Train Loss: 0.064 Vali Loss: 0.209 Vali Acc: 0.976 Test Loss: 0.209 Test Acc: 0.976
Validation loss decreased (-0.973535 --> -0.975625).  Saving model ...
Epoch: 19 cost time: 2.4880027770996094
Epoch: 19, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.243 Vali Acc: 0.971 Test Loss: 0.243 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.4559621810913086
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.320 Vali Acc: 0.964 Test Loss: 0.320 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.652013063430786
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.974 Test Loss: 0.259 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.316053628921509
Epoch: 22, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.270 Vali Acc: 0.970 Test Loss: 0.270 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.4513561725616455
Epoch: 23, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.352 Vali Acc: 0.967 Test Loss: 0.352 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.474573850631714
Epoch: 24, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.321 Vali Acc: 0.974 Test Loss: 0.321 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.721831798553467
Epoch: 25, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.437 Vali Acc: 0.971 Test Loss: 0.437 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.8185031414031982
Epoch: 26, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.471 Vali Acc: 0.960 Test Loss: 0.471 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7211384773254395
Epoch: 27, Steps: 89 | Train Loss: 0.078 Vali Loss: 0.304 Vali Acc: 0.974 Test Loss: 0.304 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.322631359100342
Epoch: 28, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.289 Vali Acc: 0.978 Test Loss: 0.289 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977713).  Saving model ...
Epoch: 29 cost time: 2.546626091003418
Epoch: 29, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.326 Vali Acc: 0.976 Test Loss: 0.326 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.7382543087005615
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.405 Vali Acc: 0.965 Test Loss: 0.405 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 2.5874738693237305
Epoch: 31, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.317 Vali Acc: 0.979 Test Loss: 0.317 Test Acc: 0.979
Validation loss decreased (-0.977713 --> -0.979105).  Saving model ...
Epoch: 32 cost time: 2.4396538734436035
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.441 Vali Acc: 0.974 Test Loss: 0.441 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.4890146255493164
Epoch: 33, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.394 Vali Acc: 0.974 Test Loss: 0.394 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.205629825592041
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.327 Vali Acc: 0.980 Test Loss: 0.327 Test Acc: 0.980
Validation loss decreased (-0.979105 --> -0.979802).  Saving model ...
Epoch: 35 cost time: 2.4399681091308594
Epoch: 35, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.337 Vali Acc: 0.976 Test Loss: 0.337 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.4389753341674805
Epoch: 36, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.356 Vali Acc: 0.976 Test Loss: 0.356 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.3805904388427734
Epoch: 37, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.376 Vali Acc: 0.976 Test Loss: 0.376 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.402674436569214
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.344 Vali Acc: 0.976 Test Loss: 0.344 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.2917730808258057
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.337 Vali Acc: 0.978 Test Loss: 0.337 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.5051798820495605
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.341 Vali Acc: 0.978 Test Loss: 0.341 Test Acc: 0.978
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.563103199005127
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.342 Vali Acc: 0.976 Test Loss: 0.342 Test Acc: 0.976
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.4327425956726074
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.347 Vali Acc: 0.976 Test Loss: 0.347 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.831043243408203
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.348 Vali Acc: 0.976 Test Loss: 0.348 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.6575448513031006
Epoch: 44, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.599 Vali Acc: 0.961 Test Loss: 0.599 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 518576
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.292021751403809
Epoch: 1, Steps: 89 | Train Loss: 1.053 Vali Loss: 0.300 Vali Acc: 0.920 Test Loss: 0.300 Test Acc: 0.920
Validation loss decreased (inf --> -0.919913).  Saving model ...
Epoch: 2 cost time: 2.8515217304229736
Epoch: 2, Steps: 89 | Train Loss: 0.232 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
Validation loss decreased (-0.919913 --> -0.951948).  Saving model ...
Epoch: 3 cost time: 2.661749839782715
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.165 Vali Acc: 0.962 Test Loss: 0.165 Test Acc: 0.962
Validation loss decreased (-0.951948 --> -0.961698).  Saving model ...
Epoch: 4 cost time: 2.351181745529175
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.419725179672241
Epoch: 5, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.480475902557373
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.198 Vali Acc: 0.955 Test Loss: 0.198 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.5475709438323975
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 8 cost time: 2.4743916988372803
Epoch: 8, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.204 Vali Acc: 0.957 Test Loss: 0.204 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.463857889175415
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.265 Vali Acc: 0.953 Test Loss: 0.265 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.396009683609009
Epoch: 10, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.318 Vali Acc: 0.951 Test Loss: 0.318 Test Acc: 0.951
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4189884662628174
Epoch: 11, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.966 Test Loss: 0.264 Test Acc: 0.966
Validation loss decreased (-0.964483 --> -0.965875).  Saving model ...
Epoch: 12 cost time: 2.725287437438965
Epoch: 12, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.317 Vali Acc: 0.955 Test Loss: 0.317 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.5636720657348633
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.245 Vali Acc: 0.967 Test Loss: 0.245 Test Acc: 0.967
Validation loss decreased (-0.965875 --> -0.966571).  Saving model ...
Epoch: 14 cost time: 2.3983800411224365
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.245 Vali Acc: 0.975 Test Loss: 0.245 Test Acc: 0.975
Validation loss decreased (-0.966571 --> -0.974928).  Saving model ...
Epoch: 15 cost time: 2.4213852882385254
Epoch: 15, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.268 Vali Acc: 0.971 Test Loss: 0.268 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.6295862197875977
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.294 Vali Acc: 0.971 Test Loss: 0.294 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.8684659004211426
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.256 Vali Acc: 0.971 Test Loss: 0.256 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.6302459239959717
Epoch: 18, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.315 Vali Acc: 0.963 Test Loss: 0.315 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.7706823348999023
Epoch: 19, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.356 Vali Acc: 0.965 Test Loss: 0.356 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.6777546405792236
Epoch: 20, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.426 Vali Acc: 0.949 Test Loss: 0.426 Test Acc: 0.949
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.5682053565979004
Epoch: 21, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.569 Vali Acc: 0.934 Test Loss: 0.569 Test Acc: 0.934
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.3802099227905273
Epoch: 22, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.419 Vali Acc: 0.961 Test Loss: 0.419 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.5125014781951904
Epoch: 23, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.364 Vali Acc: 0.974 Test Loss: 0.364 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.5845699310302734
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.599 Vali Acc: 0.944 Test Loss: 0.599 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9749303621169917
model parameter : 518576
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.708914279937744
Epoch: 1, Steps: 89 | Train Loss: 1.181 Vali Loss: 0.355 Vali Acc: 0.903 Test Loss: 0.355 Test Acc: 0.903
Validation loss decreased (inf --> -0.902503).  Saving model ...
Epoch: 2 cost time: 2.1813440322875977
Epoch: 2, Steps: 89 | Train Loss: 0.243 Vali Loss: 0.211 Vali Acc: 0.939 Test Loss: 0.211 Test Acc: 0.939
Validation loss decreased (-0.902503 --> -0.938717).  Saving model ...
Epoch: 3 cost time: 2.4248242378234863
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.146 Vali Acc: 0.958 Test Loss: 0.146 Test Acc: 0.958
Validation loss decreased (-0.938717 --> -0.958216).  Saving model ...
Epoch: 4 cost time: 2.431525707244873
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.198 Vali Acc: 0.943 Test Loss: 0.198 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3807244300842285
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
Validation loss decreased (-0.958216 --> -0.959608).  Saving model ...
Epoch: 6 cost time: 2.4146387577056885
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.155 Vali Acc: 0.962 Test Loss: 0.155 Test Acc: 0.962
Validation loss decreased (-0.959608 --> -0.961698).  Saving model ...
Epoch: 7 cost time: 2.2646217346191406
Epoch: 7, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7309365272521973
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.140 Vali Acc: 0.971 Test Loss: 0.140 Test Acc: 0.971
Validation loss decreased (-0.961698 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 2.652723789215088
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6570072174072266
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.279 Vali Acc: 0.939 Test Loss: 0.279 Test Acc: 0.939
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4884626865386963
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972143).  Saving model ...
Epoch: 12 cost time: 2.6963961124420166
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.169 Vali Acc: 0.967 Test Loss: 0.169 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.590925455093384
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.316 Vali Acc: 0.946 Test Loss: 0.316 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7383463382720947
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.403 Vali Acc: 0.941 Test Loss: 0.403 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.750920295715332
Epoch: 15, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.332 Vali Acc: 0.942 Test Loss: 0.332 Test Acc: 0.942
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.520599842071533
Epoch: 16, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.225 Vali Acc: 0.969 Test Loss: 0.225 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3692290782928467
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.974 Test Loss: 0.198 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973536).  Saving model ...
Epoch: 18 cost time: 2.3752050399780273
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.971 Test Loss: 0.214 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2913103103637695
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.973 Test Loss: 0.200 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3750267028808594
Epoch: 20, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.196 Vali Acc: 0.974 Test Loss: 0.196 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974232).  Saving model ...
Epoch: 21 cost time: 2.5048129558563232
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.329 Vali Acc: 0.960 Test Loss: 0.329 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.568349838256836
Epoch: 22, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.199 Vali Acc: 0.973 Test Loss: 0.199 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3141560554504395
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.247 Vali Acc: 0.964 Test Loss: 0.247 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4718916416168213
Epoch: 24, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.974 Test Loss: 0.237 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.296297311782837
Epoch: 25, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.976 Test Loss: 0.213 Test Acc: 0.976
Validation loss decreased (-0.974232 --> -0.975625).  Saving model ...
Epoch: 26 cost time: 2.561466693878174
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.971 Test Loss: 0.229 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7353415489196777
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.6483235359191895
Epoch: 28, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.239 Vali Acc: 0.971 Test Loss: 0.239 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.5594851970672607
Epoch: 29, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.325 Vali Acc: 0.962 Test Loss: 0.325 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.4846906661987305
Epoch: 30, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.285 Vali Acc: 0.966 Test Loss: 0.285 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.6147429943084717
Epoch: 31, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.358 Vali Acc: 0.963 Test Loss: 0.358 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.663024663925171
Epoch: 32, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.358 Vali Acc: 0.961 Test Loss: 0.358 Test Acc: 0.961
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.6128933429718018
Epoch: 33, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.309 Vali Acc: 0.968 Test Loss: 0.309 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.50779390335083
Epoch: 34, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.242 Vali Acc: 0.972 Test Loss: 0.242 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.3147530555725098
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.285 Vali Acc: 0.967 Test Loss: 0.285 Test Acc: 0.967
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 518576
model size : 4.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 3.9883458614349365
Epoch: 1, Steps: 89 | Train Loss: 1.275 Vali Loss: 0.410 Vali Acc: 0.912 Test Loss: 0.410 Test Acc: 0.912
Validation loss decreased (inf --> -0.911556).  Saving model ...
Epoch: 2 cost time: 2.4448931217193604
Epoch: 2, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.241 Vali Acc: 0.939 Test Loss: 0.241 Test Acc: 0.939
Validation loss decreased (-0.911556 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 2.3334667682647705
Epoch: 3, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.939413 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 2.464860439300537
Epoch: 4, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
Validation loss decreased (-0.951948 --> -0.972144).  Saving model ...
Epoch: 5 cost time: 2.3672914505004883
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5791642665863037
Epoch: 6, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.174 Vali Acc: 0.960 Test Loss: 0.174 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4480719566345215
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.166 Vali Acc: 0.962 Test Loss: 0.166 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.33998966217041
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.531503677368164
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.5678744316101074
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
Validation loss decreased (-0.972144 --> -0.972840).  Saving model ...
Epoch: 11 cost time: 2.723832130432129
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 12 cost time: 3.0417394638061523
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.115 Vali Acc: 0.981 Test Loss: 0.115 Test Acc: 0.981
Validation loss decreased (-0.974233 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 3.91127347946167
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.214538097381592
Epoch: 14, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.220 Vali Acc: 0.959 Test Loss: 0.220 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.1886701583862305
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.309 Vali Acc: 0.946 Test Loss: 0.309 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.8582425117492676
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.770972728729248
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.190 Vali Acc: 0.973 Test Loss: 0.190 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.518828868865967
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.194 Vali Acc: 0.967 Test Loss: 0.194 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.432062864303589
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.283 Vali Acc: 0.953 Test Loss: 0.283 Test Acc: 0.953
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.546005964279175
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.206 Vali Acc: 0.971 Test Loss: 0.206 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.831132173538208
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.977 Test Loss: 0.168 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.250192403793335
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.969 Test Loss: 0.210 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 505072
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.981288909912109
Epoch: 1, Steps: 89 | Train Loss: 1.283 Vali Loss: 0.397 Vali Acc: 0.914 Test Loss: 0.397 Test Acc: 0.914
Validation loss decreased (inf --> -0.914341).  Saving model ...
Epoch: 2 cost time: 3.969397783279419
Epoch: 2, Steps: 89 | Train Loss: 0.262 Vali Loss: 0.218 Vali Acc: 0.943 Test Loss: 0.218 Test Acc: 0.943
Validation loss decreased (-0.914341 --> -0.942895).  Saving model ...
Epoch: 3 cost time: 4.048453330993652
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.179 Vali Acc: 0.953 Test Loss: 0.179 Test Acc: 0.953
Validation loss decreased (-0.942895 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 4.723509073257446
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.952644 --> -0.972840).  Saving model ...
Epoch: 5 cost time: 2.973893404006958
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.960 Test Loss: 0.146 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.9397964477539062
Epoch: 6, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.164 Vali Acc: 0.960 Test Loss: 0.164 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 4.226571083068848
Epoch: 7, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 4.074154615402222
Epoch: 8, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.128 Vali Acc: 0.968 Test Loss: 0.128 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 4.217216491699219
Epoch: 9, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 3.7977285385131836
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.977715).  Saving model ...
Epoch: 11 cost time: 4.144365072250366
Epoch: 11, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.847522020339966
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.542851448059082
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8877949714660645
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.222 Vali Acc: 0.954 Test Loss: 0.222 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.6290130615234375
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.189 Vali Acc: 0.963 Test Loss: 0.189 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.8124756813049316
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.247 Vali Acc: 0.946 Test Loss: 0.247 Test Acc: 0.946
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.7909107208251953
Epoch: 17, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.424 Vali Acc: 0.938 Test Loss: 0.424 Test Acc: 0.938
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.7409887313842773
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.179 Vali Acc: 0.972 Test Loss: 0.179 Test Acc: 0.972
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.9818949699401855
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.244 Vali Acc: 0.969 Test Loss: 0.244 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.8946352005004883
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.974 Test Loss: 0.182 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 505072
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.565156698226929
Epoch: 1, Steps: 89 | Train Loss: 1.314 Vali Loss: 0.401 Vali Acc: 0.908 Test Loss: 0.401 Test Acc: 0.908
Validation loss decreased (inf --> -0.908074).  Saving model ...
Epoch: 2 cost time: 4.072256565093994
Epoch: 2, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.908074 --> -0.943591).  Saving model ...
Epoch: 3 cost time: 3.819993257522583
Epoch: 3, Steps: 89 | Train Loss: 0.143 Vali Loss: 0.178 Vali Acc: 0.951 Test Loss: 0.178 Test Acc: 0.951
Validation loss decreased (-0.943591 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 3.611182928085327
Epoch: 4, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.140 Vali Acc: 0.969 Test Loss: 0.140 Test Acc: 0.969
Validation loss decreased (-0.951252 --> -0.968662).  Saving model ...
Epoch: 5 cost time: 3.4848711490631104
Epoch: 5, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 6 cost time: 3.6937825679779053
Epoch: 6, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.127 Vali Acc: 0.966 Test Loss: 0.127 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5921900272369385
Epoch: 7, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.159 Vali Acc: 0.958 Test Loss: 0.159 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.9614500999450684
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.718724489212036
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.5318896770477295
Epoch: 10, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.1622142791748047
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.4972503185272217
Epoch: 12, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.463449716567993
Epoch: 13, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.2365565299987793
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.962 Test Loss: 0.201 Test Acc: 0.962
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.4543089866638184
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.268 Vali Acc: 0.955 Test Loss: 0.268 Test Acc: 0.955
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 505072
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.407709360122681
Epoch: 1, Steps: 89 | Train Loss: 1.472 Vali Loss: 0.495 Vali Acc: 0.875 Test Loss: 0.495 Test Acc: 0.875
Validation loss decreased (inf --> -0.875343).  Saving model ...
Epoch: 2 cost time: 2.8563320636749268
Epoch: 2, Steps: 89 | Train Loss: 0.317 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.875343 --> -0.930360).  Saving model ...
Epoch: 3 cost time: 3.5646512508392334
Epoch: 3, Steps: 89 | Train Loss: 0.177 Vali Loss: 0.218 Vali Acc: 0.940 Test Loss: 0.218 Test Acc: 0.940
Validation loss decreased (-0.930360 --> -0.940109).  Saving model ...
Epoch: 4 cost time: 3.688314914703369
Epoch: 4, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.940109 --> -0.958912).  Saving model ...
Epoch: 5 cost time: 3.7807180881500244
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.3597755432128906
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.149 Vali Acc: 0.958 Test Loss: 0.149 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.6217470169067383
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
Validation loss decreased (-0.958912 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 3.694039821624756
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.141 Vali Acc: 0.967 Test Loss: 0.141 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.315708637237549
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.79732608795166
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.195 Vali Acc: 0.955 Test Loss: 0.195 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.348235845565796
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.52778959274292
Epoch: 12, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.164 Vali Acc: 0.965 Test Loss: 0.164 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.5251576900482178
Epoch: 13, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.2632486820220947
Epoch: 14, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.962 Test Loss: 0.192 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3271327018737793
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.196 Vali Acc: 0.960 Test Loss: 0.196 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.6796064376831055
Epoch: 16, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 3.481800079345703
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.968 Test Loss: 0.165 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 505072
model size : 3.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.604435682296753
Epoch: 1, Steps: 89 | Train Loss: 1.298 Vali Loss: 0.420 Vali Acc: 0.886 Test Loss: 0.420 Test Acc: 0.886
Validation loss decreased (inf --> -0.886486).  Saving model ...
Epoch: 2 cost time: 3.0859789848327637
Epoch: 2, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.886486 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 3.3681771755218506
Epoch: 3, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
Validation loss decreased (-0.936627 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 3.8487331867218018
Epoch: 4, Steps: 89 | Train Loss: 0.112 Vali Loss: 0.160 Vali Acc: 0.964 Test Loss: 0.160 Test Acc: 0.964
Validation loss decreased (-0.958912 --> -0.963787).  Saving model ...
Epoch: 5 cost time: 3.6912717819213867
Epoch: 5, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.107 Vali Acc: 0.970 Test Loss: 0.107 Test Acc: 0.970
Validation loss decreased (-0.963787 --> -0.970055).  Saving model ...
Epoch: 6 cost time: 3.855073928833008
Epoch: 6, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.233541250228882
Epoch: 7, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973536).  Saving model ...
Epoch: 8 cost time: 3.4938228130340576
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.9331610202789307
Epoch: 9, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.9287188053131104
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.9607460498809814
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.136 Vali Acc: 0.972 Test Loss: 0.136 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.9422709941864014
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.4316351413726807
Epoch: 13, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.292 Vali Acc: 0.940 Test Loss: 0.292 Test Acc: 0.940
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.83424973487854
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.207 Vali Acc: 0.968 Test Loss: 0.207 Test Acc: 0.968
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.168917179107666
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.157 Vali Acc: 0.975 Test Loss: 0.157 Test Acc: 0.975
Validation loss decreased (-0.973536 --> -0.974929).  Saving model ...
Epoch: 16 cost time: 3.9959137439727783
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.958 Test Loss: 0.207 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.300902366638184
Epoch: 17, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.974 Test Loss: 0.166 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.396167278289795
Epoch: 18, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.969 Test Loss: 0.191 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.294917106628418
Epoch: 19, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.969 Test Loss: 0.226 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.326797008514404
Epoch: 20, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.239 Vali Acc: 0.957 Test Loss: 0.239 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.964428424835205
Epoch: 21, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.220 Vali Acc: 0.968 Test Loss: 0.220 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.4698808193206787
Epoch: 22, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.370 Vali Acc: 0.951 Test Loss: 0.370 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.945282220840454
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.974 Test Loss: 0.223 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.6125752925872803
Epoch: 24, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.228 Vali Acc: 0.977 Test Loss: 0.228 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977017).  Saving model ...
Epoch: 25 cost time: 3.4343621730804443
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.978 Test Loss: 0.199 Test Acc: 0.978
Validation loss decreased (-0.977017 --> -0.977714).  Saving model ...
Epoch: 26 cost time: 3.6077609062194824
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.255 Vali Acc: 0.977 Test Loss: 0.255 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 3.7736504077911377
Epoch: 27, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.262 Vali Acc: 0.973 Test Loss: 0.262 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 3.6781342029571533
Epoch: 28, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.451 Vali Acc: 0.946 Test Loss: 0.451 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 3.5340993404388428
Epoch: 29, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.314 Vali Acc: 0.968 Test Loss: 0.314 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 3.6499593257904053
Epoch: 30, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.978 Test Loss: 0.278 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 3.533475637435913
Epoch: 31, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.265 Vali Acc: 0.977 Test Loss: 0.265 Test Acc: 0.977
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.9719741344451904
Epoch: 32, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.266 Vali Acc: 0.978 Test Loss: 0.266 Test Acc: 0.978
Validation loss decreased (-0.977714 --> -0.978410).  Saving model ...
Epoch: 33 cost time: 3.9154882431030273
Epoch: 33, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.265 Vali Acc: 0.977 Test Loss: 0.265 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 3.989938497543335
Epoch: 34, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.259 Vali Acc: 0.977 Test Loss: 0.259 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 3.8479175567626953
Epoch: 35, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.980 Test Loss: 0.256 Test Acc: 0.980
Validation loss decreased (-0.978410 --> -0.979802).  Saving model ...
Epoch: 36 cost time: 3.812446355819702
Epoch: 36, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.980 Test Loss: 0.254 Test Acc: 0.980
Validation loss decreased (-0.979802 --> -0.979802).  Saving model ...
Epoch: 37 cost time: 3.8612961769104004
Epoch: 37, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.980 Test Loss: 0.254 Test Acc: 0.980
Validation loss decreased (-0.979802 --> -0.979802).  Saving model ...
Epoch: 38 cost time: 3.867154359817505
Epoch: 38, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.255 Vali Acc: 0.980 Test Loss: 0.255 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 3.162344217300415
Epoch: 39, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.981 Test Loss: 0.251 Test Acc: 0.981
Validation loss decreased (-0.979802 --> -0.980499).  Saving model ...
Epoch: 40 cost time: 3.090505838394165
Epoch: 40, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.981 Test Loss: 0.251 Test Acc: 0.981
Validation loss decreased (-0.980499 --> -0.981195).  Saving model ...
Epoch: 41 cost time: 3.5030078887939453
Epoch: 41, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.982 Test Loss: 0.250 Test Acc: 0.982
Validation loss decreased (-0.981195 --> -0.981892).  Saving model ...
Epoch: 42 cost time: 3.716362476348877
Epoch: 42, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.256 Vali Acc: 0.980 Test Loss: 0.256 Test Acc: 0.980
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 3.8752901554107666
Epoch: 43, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.254 Vali Acc: 0.981 Test Loss: 0.254 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 4.0231146812438965
Epoch: 44, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.253 Vali Acc: 0.981 Test Loss: 0.253 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 4.034319162368774
Epoch: 45, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.983 Test Loss: 0.252 Test Acc: 0.983
Validation loss decreased (-0.981892 --> -0.982588).  Saving model ...
Epoch: 46 cost time: 4.049640893936157
Epoch: 46, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.983 Test Loss: 0.251 Test Acc: 0.983
Validation loss decreased (-0.982588 --> -0.982588).  Saving model ...
Epoch: 47 cost time: 3.111473798751831
Epoch: 47, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.427 Vali Acc: 0.955 Test Loss: 0.427 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 3.1334803104400635
Epoch: 48, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.296 Vali Acc: 0.971 Test Loss: 0.296 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 3.738637924194336
Epoch: 49, Steps: 89 | Train Loss: 0.169 Vali Loss: 0.488 Vali Acc: 0.944 Test Loss: 0.488 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 3.7732744216918945
Epoch: 50, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.415 Vali Acc: 0.971 Test Loss: 0.415 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 4.048992156982422
Epoch: 51, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.443 Vali Acc: 0.956 Test Loss: 0.443 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 4.105388641357422
Epoch: 52, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.351 Vali Acc: 0.971 Test Loss: 0.351 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 4.1909801959991455
Epoch: 53, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.336 Vali Acc: 0.971 Test Loss: 0.336 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 4.429872512817383
Epoch: 54, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.387 Vali Acc: 0.971 Test Loss: 0.387 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 3.1102101802825928
Epoch: 55, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.330 Vali Acc: 0.974 Test Loss: 0.330 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 2.5533440113067627
Epoch: 56, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.292 Vali Acc: 0.978 Test Loss: 0.292 Test Acc: 0.978
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 374000
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.320285081863403
Epoch: 1, Steps: 89 | Train Loss: 1.303 Vali Loss: 0.425 Vali Acc: 0.886 Test Loss: 0.425 Test Acc: 0.886
Validation loss decreased (inf --> -0.885790).  Saving model ...
Epoch: 2 cost time: 3.7525508403778076
Epoch: 2, Steps: 89 | Train Loss: 0.274 Vali Loss: 0.208 Vali Acc: 0.945 Test Loss: 0.208 Test Acc: 0.945
Validation loss decreased (-0.885790 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 3.767764091491699
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.154 Vali Acc: 0.965 Test Loss: 0.154 Test Acc: 0.965
Validation loss decreased (-0.944984 --> -0.965180).  Saving model ...
Epoch: 4 cost time: 3.731475830078125
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.179 Vali Acc: 0.955 Test Loss: 0.179 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8808798789978027
Epoch: 5, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
Validation loss decreased (-0.965180 --> -0.970054).  Saving model ...
Epoch: 6 cost time: 3.691117286682129
Epoch: 6, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.2014272212982178
Epoch: 7, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.975 Test Loss: 0.111 Test Acc: 0.975
Validation loss decreased (-0.970054 --> -0.974929).  Saving model ...
Epoch: 8 cost time: 3.0973503589630127
Epoch: 8, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.155 Vali Acc: 0.966 Test Loss: 0.155 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.820288896560669
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.184 Vali Acc: 0.954 Test Loss: 0.184 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.6489145755767822
Epoch: 10, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.2554941177368164
Epoch: 11, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.146 Vali Acc: 0.971 Test Loss: 0.146 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.8506243228912354
Epoch: 12, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.156 Vali Acc: 0.969 Test Loss: 0.156 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.9549055099487305
Epoch: 13, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.195 Vali Acc: 0.958 Test Loss: 0.195 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.205033779144287
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.163 Vali Acc: 0.972 Test Loss: 0.163 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.196859121322632
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.969 Test Loss: 0.183 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 3.7435317039489746
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975625).  Saving model ...
Epoch: 17 cost time: 3.9793498516082764
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.145 Vali Acc: 0.978 Test Loss: 0.145 Test Acc: 0.978
Validation loss decreased (-0.975625 --> -0.977714).  Saving model ...
Epoch: 18 cost time: 3.901427745819092
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.152 Vali Acc: 0.976 Test Loss: 0.152 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.978741407394409
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
Validation loss decreased (-0.977714 --> -0.980500).  Saving model ...
Epoch: 20 cost time: 4.036055326461792
Epoch: 20, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.9007046222686768
Epoch: 21, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.1770265102386475
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.134 Vali Acc: 0.980 Test Loss: 0.134 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6289615631103516
Epoch: 23, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.139 Vali Acc: 0.978 Test Loss: 0.139 Test Acc: 0.978
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4514174461364746
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.134 Vali Acc: 0.979 Test Loss: 0.134 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.7412796020507812
Epoch: 25, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.308 Vali Acc: 0.957 Test Loss: 0.308 Test Acc: 0.957
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.878394842147827
Epoch: 26, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.392 Vali Acc: 0.948 Test Loss: 0.392 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.995630979537964
Epoch: 27, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.377 Vali Acc: 0.948 Test Loss: 0.377 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.024280548095703
Epoch: 28, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.289 Vali Acc: 0.967 Test Loss: 0.289 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.385699272155762
Epoch: 29, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.960 Test Loss: 0.310 Test Acc: 0.960
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 374000
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.251556873321533
Epoch: 1, Steps: 89 | Train Loss: 1.330 Vali Loss: 0.414 Vali Acc: 0.885 Test Loss: 0.414 Test Acc: 0.885
Validation loss decreased (inf --> -0.885093).  Saving model ...
Epoch: 2 cost time: 3.5352859497070312
Epoch: 2, Steps: 89 | Train Loss: 0.266 Vali Loss: 0.211 Vali Acc: 0.942 Test Loss: 0.211 Test Acc: 0.942
Validation loss decreased (-0.885093 --> -0.942198).  Saving model ...
Epoch: 3 cost time: 3.561127185821533
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
Validation loss decreased (-0.942198 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 3.7114484310150146
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.164 Vali Acc: 0.955 Test Loss: 0.164 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.926578998565674
Epoch: 5, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
Validation loss decreased (-0.964483 --> -0.974929).  Saving model ...
Epoch: 6 cost time: 3.232571601867676
Epoch: 6, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.125 Vali Acc: 0.973 Test Loss: 0.125 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.6307036876678467
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5739548206329346
Epoch: 8, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.977 Test Loss: 0.120 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 3.343456506729126
Epoch: 9, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.958 Test Loss: 0.185 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4847893714904785
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.4494612216949463
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.6754279136657715
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.9759247303009033
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.1926441192626953
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.3868191242218018
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.7984118461608887
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.167 Vali Acc: 0.971 Test Loss: 0.167 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.4666244983673096
Epoch: 17, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.168 Vali Acc: 0.972 Test Loss: 0.168 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.935572624206543
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.966 Test Loss: 0.186 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 374000
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 4.446087837219238
Epoch: 1, Steps: 89 | Train Loss: 1.496 Vali Loss: 0.495 Vali Acc: 0.884 Test Loss: 0.495 Test Acc: 0.884
Validation loss decreased (inf --> -0.884396).  Saving model ...
Epoch: 2 cost time: 3.076382875442505
Epoch: 2, Steps: 89 | Train Loss: 0.316 Vali Loss: 0.240 Vali Acc: 0.935 Test Loss: 0.240 Test Acc: 0.935
Validation loss decreased (-0.884396 --> -0.934538).  Saving model ...
Epoch: 3 cost time: 3.3138065338134766
Epoch: 3, Steps: 89 | Train Loss: 0.168 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
Validation loss decreased (-0.934538 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 3.5059263706207275
Epoch: 4, Steps: 89 | Train Loss: 0.127 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.946377 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 3.799152135848999
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.148 Vali Acc: 0.963 Test Loss: 0.148 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 3.4774508476257324
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.203 Vali Acc: 0.947 Test Loss: 0.203 Test Acc: 0.947
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.5918712615966797
Epoch: 7, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1431689262390137
Epoch: 8, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
Validation loss decreased (-0.963090 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 3.072770357131958
Epoch: 9, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.958 Test Loss: 0.203 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.04875111579895
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9914309978485107
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.135 Vali Acc: 0.969 Test Loss: 0.135 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.968662).  Saving model ...
Epoch: 12 cost time: 3.0799243450164795
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.64701771736145
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.450770854949951
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
Validation loss decreased (-0.968662 --> -0.969358).  Saving model ...
Epoch: 15 cost time: 3.7575619220733643
Epoch: 15, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.241 Vali Acc: 0.953 Test Loss: 0.241 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.675095796585083
Epoch: 16, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.957 Test Loss: 0.209 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6612708568573
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.153 Vali Acc: 0.971 Test Loss: 0.153 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 18 cost time: 3.387119770050049
Epoch: 18, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.969 Test Loss: 0.165 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.4608099460601807
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.966 Test Loss: 0.192 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 3.3890528678894043
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.167 Vali Acc: 0.967 Test Loss: 0.167 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.9653983116149902
Epoch: 21, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.971 Test Loss: 0.165 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0756075382232666
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 23 cost time: 3.293691635131836
Epoch: 23, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.722595691680908
Epoch: 24, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.964 Test Loss: 0.203 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.036853551864624
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.960 Test Loss: 0.221 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.211190938949585
Epoch: 26, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.1458590030670166
Epoch: 27, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.267 Vali Acc: 0.958 Test Loss: 0.267 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.235352039337158
Epoch: 28, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.281 Vali Acc: 0.961 Test Loss: 0.281 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.0769035816192627
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.962 Test Loss: 0.227 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.233527183532715
Epoch: 30, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.215 Vali Acc: 0.968 Test Loss: 0.215 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.1527817249298096
Epoch: 31, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.964 Test Loss: 0.236 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.1923329830169678
Epoch: 32, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.261 Vali Acc: 0.965 Test Loss: 0.261 Test Acc: 0.965
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9714484679665738
model parameter : 374000
model size : 2.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.352460622787476
Epoch: 1, Steps: 89 | Train Loss: 1.282 Vali Loss: 0.394 Vali Acc: 0.905 Test Loss: 0.394 Test Acc: 0.905
Validation loss decreased (inf --> -0.904592).  Saving model ...
Epoch: 2 cost time: 3.604588747024536
Epoch: 2, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.904592 --> -0.947769).  Saving model ...
Epoch: 3 cost time: 3.7664058208465576
Epoch: 3, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
Validation loss decreased (-0.947769 --> -0.961001).  Saving model ...
Epoch: 4 cost time: 3.86037540435791
Epoch: 4, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.188 Vali Acc: 0.955 Test Loss: 0.188 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.424839496612549
Epoch: 5, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.145 Vali Acc: 0.962 Test Loss: 0.145 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 3.1978678703308105
Epoch: 6, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.104 Vali Acc: 0.970 Test Loss: 0.104 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970055).  Saving model ...
Epoch: 7 cost time: 2.820328950881958
Epoch: 7, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.970055 --> -0.973537).  Saving model ...
Epoch: 8 cost time: 3.286069393157959
Epoch: 8, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.110 Vali Acc: 0.974 Test Loss: 0.110 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.4247472286224365
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.544405698776245
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.969 Test Loss: 0.155 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 3.6778616905212402
Epoch: 11, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.289 Vali Acc: 0.941 Test Loss: 0.289 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.374361753463745
Epoch: 12, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.224 Vali Acc: 0.962 Test Loss: 0.224 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 3.669727087020874
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 3.63783860206604
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.170 Vali Acc: 0.976 Test Loss: 0.170 Test Acc: 0.976
Validation loss decreased (-0.973537 --> -0.976321).  Saving model ...
Epoch: 15 cost time: 3.373274564743042
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.163 Vali Acc: 0.982 Test Loss: 0.163 Test Acc: 0.982
Validation loss decreased (-0.976321 --> -0.981893).  Saving model ...
Epoch: 16 cost time: 2.9753425121307373
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.331 Vali Acc: 0.953 Test Loss: 0.331 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.6008658409118652
Epoch: 17, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.249 Vali Acc: 0.960 Test Loss: 0.249 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.774714231491089
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.881322145462036
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.963 Test Loss: 0.213 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.7372846603393555
Epoch: 20, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.257 Vali Acc: 0.960 Test Loss: 0.257 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.9525673389434814
Epoch: 21, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.976 Test Loss: 0.174 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.657400608062744
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.279 Vali Acc: 0.962 Test Loss: 0.279 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.725548028945923
Epoch: 23, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.973 Test Loss: 0.198 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.7432169914245605
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.980 Test Loss: 0.176 Test Acc: 0.980
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.0623531341552734
Epoch: 25, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.220 Vali Acc: 0.976 Test Loss: 0.220 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 308464
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.030550956726074
Epoch: 1, Steps: 89 | Train Loss: 1.293 Vali Loss: 0.393 Vali Acc: 0.911 Test Loss: 0.393 Test Acc: 0.911
Validation loss decreased (inf --> -0.910860).  Saving model ...
Epoch: 2 cost time: 3.3023428916931152
Epoch: 2, Steps: 89 | Train Loss: 0.275 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
Validation loss decreased (-0.910860 --> -0.953341).  Saving model ...
Epoch: 3 cost time: 3.3318190574645996
Epoch: 3, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
Validation loss decreased (-0.953341 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 2.5629425048828125
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.181 Vali Acc: 0.951 Test Loss: 0.181 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6234281063079834
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.124 Vali Acc: 0.967 Test Loss: 0.124 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 6 cost time: 3.7392146587371826
Epoch: 6, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.969 Test Loss: 0.121 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 7 cost time: 4.345592737197876
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.969358 --> -0.973536).  Saving model ...
Epoch: 8 cost time: 4.392232894897461
Epoch: 8, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.105 Vali Acc: 0.978 Test Loss: 0.105 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.977715).  Saving model ...
Epoch: 9 cost time: 4.3163840770721436
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.166 Vali Acc: 0.958 Test Loss: 0.166 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.459967136383057
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.117 Vali Acc: 0.973 Test Loss: 0.117 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.204457759857178
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.308 Vali Acc: 0.936 Test Loss: 0.308 Test Acc: 0.936
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.0225183963775635
Epoch: 12, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.168 Vali Acc: 0.965 Test Loss: 0.168 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 4.534899950027466
Epoch: 13, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 4.527787446975708
Epoch: 14, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.375 Vali Acc: 0.924 Test Loss: 0.375 Test Acc: 0.924
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 4.262401342391968
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 4.098022699356079
Epoch: 16, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.316 Vali Acc: 0.940 Test Loss: 0.316 Test Acc: 0.940
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 4.335911750793457
Epoch: 17, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 4.8842246532440186
Epoch: 18, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.166 Vali Acc: 0.973 Test Loss: 0.166 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 308464
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.585425853729248
Epoch: 1, Steps: 89 | Train Loss: 1.327 Vali Loss: 0.400 Vali Acc: 0.912 Test Loss: 0.400 Test Acc: 0.912
Validation loss decreased (inf --> -0.912252).  Saving model ...
Epoch: 2 cost time: 4.005951166152954
Epoch: 2, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.186 Vali Acc: 0.958 Test Loss: 0.186 Test Acc: 0.958
Validation loss decreased (-0.912252 --> -0.957519).  Saving model ...
Epoch: 3 cost time: 3.9426205158233643
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.160 Vali Acc: 0.950 Test Loss: 0.160 Test Acc: 0.950
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 4.296350717544556
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.958216).  Saving model ...
Epoch: 5 cost time: 4.687104940414429
Epoch: 5, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.962 Test Loss: 0.147 Test Acc: 0.962
Validation loss decreased (-0.958216 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 4.251465797424316
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.962394 --> -0.973536).  Saving model ...
Epoch: 7 cost time: 4.779107093811035
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.112 Vali Acc: 0.978 Test Loss: 0.112 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.977715).  Saving model ...
Epoch: 8 cost time: 4.8146209716796875
Epoch: 8, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.123 Vali Acc: 0.972 Test Loss: 0.123 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.7789833545684814
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.098 Vali Acc: 0.976 Test Loss: 0.098 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.660551071166992
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.976 Test Loss: 0.118 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.616942405700684
Epoch: 11, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 4.0458667278289795
Epoch: 12, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.124 Vali Acc: 0.972 Test Loss: 0.124 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.301243782043457
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.964 Test Loss: 0.158 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 4.4941017627716064
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.856459379196167
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.192 Vali Acc: 0.967 Test Loss: 0.192 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 4.098265171051025
Epoch: 16, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.296403646469116
Epoch: 17, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.277 Vali Acc: 0.954 Test Loss: 0.277 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 308464
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 5.531092405319214
Epoch: 1, Steps: 89 | Train Loss: 1.483 Vali Loss: 0.500 Vali Acc: 0.875 Test Loss: 0.500 Test Acc: 0.875
Validation loss decreased (inf --> -0.874647).  Saving model ...
Epoch: 2 cost time: 4.040079116821289
Epoch: 2, Steps: 89 | Train Loss: 0.325 Vali Loss: 0.231 Vali Acc: 0.935 Test Loss: 0.231 Test Acc: 0.935
Validation loss decreased (-0.874647 --> -0.935234).  Saving model ...
Epoch: 3 cost time: 4.38179087638855
Epoch: 3, Steps: 89 | Train Loss: 0.160 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
Validation loss decreased (-0.935234 --> -0.942199).  Saving model ...
Epoch: 4 cost time: 4.1572606563568115
Epoch: 4, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.171 Vali Acc: 0.953 Test Loss: 0.171 Test Acc: 0.953
Validation loss decreased (-0.942199 --> -0.952645).  Saving model ...
Epoch: 5 cost time: 4.398291826248169
Epoch: 5, Steps: 89 | Train Loss: 0.083 Vali Loss: 0.163 Vali Acc: 0.957 Test Loss: 0.163 Test Acc: 0.957
Validation loss decreased (-0.952645 --> -0.956823).  Saving model ...
Epoch: 6 cost time: 4.738331079483032
Epoch: 6, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.156 Vali Acc: 0.957 Test Loss: 0.156 Test Acc: 0.957
Validation loss decreased (-0.956823 --> -0.956823).  Saving model ...
Epoch: 7 cost time: 4.064521074295044
Epoch: 7, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
Validation loss decreased (-0.956823 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 4.630326747894287
Epoch: 8, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.144 Vali Acc: 0.966 Test Loss: 0.144 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.6036276817321777
Epoch: 9, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.899665594100952
Epoch: 10, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.122 Vali Acc: 0.972 Test Loss: 0.122 Test Acc: 0.972
Validation loss decreased (-0.970751 --> -0.972144).  Saving model ...
Epoch: 11 cost time: 4.3311333656311035
Epoch: 11, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.224 Vali Acc: 0.949 Test Loss: 0.224 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 4.644920110702515
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.208 Vali Acc: 0.954 Test Loss: 0.208 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.735949277877808
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.202 Vali Acc: 0.953 Test Loss: 0.202 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.54236364364624
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.2648913860321045
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.201 Vali Acc: 0.960 Test Loss: 0.201 Test Acc: 0.960
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 4.227591037750244
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.951 Test Loss: 0.274 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 4.364362001419067
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.965 Test Loss: 0.212 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 5.452823162078857
Epoch: 18, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.168 Vali Acc: 0.970 Test Loss: 0.168 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 5.187468528747559
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.966 Test Loss: 0.177 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 5.030523300170898
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9721448467966574
model parameter : 308464
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.660984516143799
Epoch: 1, Steps: 89 | Train Loss: 1.266 Vali Loss: 0.450 Vali Acc: 0.886 Test Loss: 0.450 Test Acc: 0.886
Validation loss decreased (inf --> -0.885789).  Saving model ...
Epoch: 2 cost time: 5.2381908893585205
Epoch: 2, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.204 Vali Acc: 0.955 Test Loss: 0.204 Test Acc: 0.955
Validation loss decreased (-0.885789 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 5.07016396522522
Epoch: 3, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.149 Vali Acc: 0.962 Test Loss: 0.149 Test Acc: 0.962
Validation loss decreased (-0.955430 --> -0.962394).  Saving model ...
Epoch: 4 cost time: 5.155394554138184
Epoch: 4, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.143 Vali Acc: 0.962 Test Loss: 0.143 Test Acc: 0.962
Validation loss decreased (-0.962394 --> -0.962394).  Saving model ...
Epoch: 5 cost time: 5.0429368019104
Epoch: 5, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.881007432937622
Epoch: 6, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
Validation loss decreased (-0.962394 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 4.207870960235596
Epoch: 7, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.119 Vali Acc: 0.968 Test Loss: 0.119 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5899977684020996
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.142 Vali Acc: 0.971 Test Loss: 0.142 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 9 cost time: 4.824395418167114
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.173 Vali Acc: 0.954 Test Loss: 0.173 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.170413255691528
Epoch: 10, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.985842704772949
Epoch: 11, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.166 Vali Acc: 0.970 Test Loss: 0.166 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 5.204890251159668
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.967 Test Loss: 0.179 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.2586259841918945
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 6.277996778488159
Epoch: 14, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.209 Vali Acc: 0.970 Test Loss: 0.209 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.214321851730347
Epoch: 15, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.283 Vali Acc: 0.951 Test Loss: 0.283 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 5.16243839263916
Epoch: 16, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 5.8738133907318115
Epoch: 17, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.148 Vali Acc: 0.977 Test Loss: 0.148 Test Acc: 0.977
Validation loss decreased (-0.971447 --> -0.977018).  Saving model ...
Epoch: 18 cost time: 5.316920280456543
Epoch: 18, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.137 Vali Acc: 0.980 Test Loss: 0.137 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 19 cost time: 5.787858724594116
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.140 Vali Acc: 0.978 Test Loss: 0.140 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 4.512747049331665
Epoch: 20, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.981 Test Loss: 0.130 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 21 cost time: 6.090359210968018
Epoch: 21, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.129 Vali Acc: 0.981 Test Loss: 0.129 Test Acc: 0.981
Validation loss decreased (-0.980500 --> -0.981196).  Saving model ...
Epoch: 22 cost time: 5.689830303192139
Epoch: 22, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.126 Vali Acc: 0.981 Test Loss: 0.126 Test Acc: 0.981
Validation loss decreased (-0.981196 --> -0.981197).  Saving model ...
Epoch: 23 cost time: 5.260683059692383
Epoch: 23, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.121 Vali Acc: 0.983 Test Loss: 0.121 Test Acc: 0.983
Validation loss decreased (-0.981197 --> -0.983286).  Saving model ...
Epoch: 24 cost time: 4.665570497512817
Epoch: 24, Steps: 89 | Train Loss: 0.000 Vali Loss: 0.124 Vali Acc: 0.983 Test Loss: 0.124 Test Acc: 0.983
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 5.665717363357544
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.144 Vali Acc: 0.974 Test Loss: 0.144 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.835665464401245
Epoch: 26, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.146 Vali Acc: 0.980 Test Loss: 0.146 Test Acc: 0.980
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 5.29512882232666
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.162 Vali Acc: 0.979 Test Loss: 0.162 Test Acc: 0.979
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.328473329544067
Epoch: 28, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.206 Vali Acc: 0.973 Test Loss: 0.206 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.885341644287109
Epoch: 29, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.365 Vali Acc: 0.953 Test Loss: 0.365 Test Acc: 0.953
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.746316432952881
Epoch: 30, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.340 Vali Acc: 0.963 Test Loss: 0.340 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.426551580429077
Epoch: 31, Steps: 89 | Train Loss: 0.148 Vali Loss: 0.396 Vali Acc: 0.953 Test Loss: 0.396 Test Acc: 0.953
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.747289180755615
Epoch: 32, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.320 Vali Acc: 0.973 Test Loss: 0.320 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.37629246711731
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.387 Vali Acc: 0.942 Test Loss: 0.387 Test Acc: 0.942
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9832869080779945
model parameter : 275696
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.840403318405151
Epoch: 1, Steps: 89 | Train Loss: 1.280 Vali Loss: 0.444 Vali Acc: 0.886 Test Loss: 0.444 Test Acc: 0.886
Validation loss decreased (inf --> -0.886486).  Saving model ...
Epoch: 2 cost time: 5.588053226470947
Epoch: 2, Steps: 89 | Train Loss: 0.260 Vali Loss: 0.192 Vali Acc: 0.960 Test Loss: 0.192 Test Acc: 0.960
Validation loss decreased (-0.886486 --> -0.959608).  Saving model ...
Epoch: 3 cost time: 5.1893510818481445
Epoch: 3, Steps: 89 | Train Loss: 0.125 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.959608 --> -0.964483).  Saving model ...
Epoch: 4 cost time: 4.781574726104736
Epoch: 4, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.125 Vali Acc: 0.968 Test Loss: 0.125 Test Acc: 0.968
Validation loss decreased (-0.964483 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 5.2856361865997314
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.596883773803711
Epoch: 6, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.639107942581177
Epoch: 7, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.129 Vali Acc: 0.972 Test Loss: 0.129 Test Acc: 0.972
Validation loss decreased (-0.967965 --> -0.972144).  Saving model ...
Epoch: 8 cost time: 5.880203485488892
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.955 Test Loss: 0.181 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.406944036483765
Epoch: 9, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.112 Vali Acc: 0.972 Test Loss: 0.112 Test Acc: 0.972
Validation loss decreased (-0.972144 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 5.278752565383911
Epoch: 10, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.156 Vali Acc: 0.965 Test Loss: 0.156 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.436010122299194
Epoch: 11, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.697471618652344
Epoch: 12, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.28150486946106
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.125 Vali Acc: 0.978 Test Loss: 0.125 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.978411).  Saving model ...
Epoch: 14 cost time: 4.853127956390381
Epoch: 14, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.189 Vali Acc: 0.966 Test Loss: 0.189 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.14671516418457
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.440096855163574
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.249 Vali Acc: 0.948 Test Loss: 0.249 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.148669719696045
Epoch: 17, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.215 Vali Acc: 0.965 Test Loss: 0.215 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 5.741146087646484
Epoch: 18, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.217 Vali Acc: 0.969 Test Loss: 0.217 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.139340162277222
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.189 Vali Acc: 0.974 Test Loss: 0.189 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.428332090377808
Epoch: 20, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.240 Vali Acc: 0.967 Test Loss: 0.240 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.182117462158203
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.267 Vali Acc: 0.974 Test Loss: 0.267 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 4.706132173538208
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.257 Vali Acc: 0.971 Test Loss: 0.257 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.51345682144165
Epoch: 23, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.316 Vali Acc: 0.961 Test Loss: 0.316 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 275696
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.733511209487915
Epoch: 1, Steps: 89 | Train Loss: 1.319 Vali Loss: 0.437 Vali Acc: 0.893 Test Loss: 0.437 Test Acc: 0.893
Validation loss decreased (inf --> -0.892753).  Saving model ...
Epoch: 2 cost time: 4.874211072921753
Epoch: 2, Steps: 89 | Train Loss: 0.265 Vali Loss: 0.197 Vali Acc: 0.955 Test Loss: 0.197 Test Acc: 0.955
Validation loss decreased (-0.892753 --> -0.955430).  Saving model ...
Epoch: 3 cost time: 4.455171585083008
Epoch: 3, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.955430 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 5.06580376625061
Epoch: 4, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.131 Vali Acc: 0.968 Test Loss: 0.131 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 4.767627716064453
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 4.890997648239136
Epoch: 6, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.131 Vali Acc: 0.964 Test Loss: 0.131 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.7502429485321045
Epoch: 7, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.096 Vali Acc: 0.974 Test Loss: 0.096 Test Acc: 0.974
Validation loss decreased (-0.967965 --> -0.974233).  Saving model ...
Epoch: 8 cost time: 5.022767782211304
Epoch: 8, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.440110206604004
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.151017904281616
Epoch: 10, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 4.756559133529663
Epoch: 11, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.102 Vali Acc: 0.976 Test Loss: 0.102 Test Acc: 0.976
Validation loss decreased (-0.976322 --> -0.976322).  Saving model ...
Epoch: 12 cost time: 5.441343784332275
Epoch: 12, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.106 Vali Acc: 0.978 Test Loss: 0.106 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.978411).  Saving model ...
Epoch: 13 cost time: 5.482542514801025
Epoch: 13, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.199 Vali Acc: 0.954 Test Loss: 0.199 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.567772150039673
Epoch: 14, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.188 Vali Acc: 0.960 Test Loss: 0.188 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.456735134124756
Epoch: 15, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 4.657970905303955
Epoch: 16, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.138 Vali Acc: 0.979 Test Loss: 0.138 Test Acc: 0.979
Validation loss decreased (-0.978411 --> -0.979107).  Saving model ...
Epoch: 17 cost time: 5.276285409927368
Epoch: 17, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.143 Vali Acc: 0.975 Test Loss: 0.143 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.3378777503967285
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 5.9560840129852295
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 5.632706880569458
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.974 Test Loss: 0.160 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 5.795428514480591
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.173 Vali Acc: 0.979 Test Loss: 0.173 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 5.80558443069458
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.255 Vali Acc: 0.965 Test Loss: 0.255 Test Acc: 0.965
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 5.493545770645142
Epoch: 23, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.964 Test Loss: 0.228 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 5.383890151977539
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.212 Vali Acc: 0.967 Test Loss: 0.212 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 6.459935903549194
Epoch: 25, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.268 Vali Acc: 0.963 Test Loss: 0.268 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 6.4807679653167725
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.976 Test Loss: 0.201 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 275696
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.479358196258545
Epoch: 1, Steps: 89 | Train Loss: 1.468 Vali Loss: 0.501 Vali Acc: 0.874 Test Loss: 0.501 Test Acc: 0.874
Validation loss decreased (inf --> -0.873950).  Saving model ...
Epoch: 2 cost time: 6.265954494476318
Epoch: 2, Steps: 89 | Train Loss: 0.300 Vali Loss: 0.244 Vali Acc: 0.943 Test Loss: 0.244 Test Acc: 0.943
Validation loss decreased (-0.873950 --> -0.942894).  Saving model ...
Epoch: 3 cost time: 5.745154619216919
Epoch: 3, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.192 Vali Acc: 0.946 Test Loss: 0.192 Test Acc: 0.946
Validation loss decreased (-0.942894 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 5.826406002044678
Epoch: 4, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.946377 --> -0.956126).  Saving model ...
Epoch: 5 cost time: 6.408641576766968
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.956126 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 5.541890859603882
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.183 Vali Acc: 0.954 Test Loss: 0.183 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 6.268018960952759
Epoch: 7, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.164 Vali Acc: 0.953 Test Loss: 0.164 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 6.78662633895874
Epoch: 8, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.147171258926392
Epoch: 9, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.175 Vali Acc: 0.957 Test Loss: 0.175 Test Acc: 0.957
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.2462944984436035
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.253054618835449
Epoch: 11, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.964 Test Loss: 0.156 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 6.735650300979614
Epoch: 12, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.963787 --> -0.971447).  Saving model ...
Epoch: 13 cost time: 6.458557367324829
Epoch: 13, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.165 Vali Acc: 0.960 Test Loss: 0.165 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.150164604187012
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.138 Vali Acc: 0.968 Test Loss: 0.138 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.15198826789856
Epoch: 15, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.163 Vali Acc: 0.967 Test Loss: 0.163 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.068360805511475
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 6.4713616371154785
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.269 Vali Acc: 0.958 Test Loss: 0.269 Test Acc: 0.958
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 6.0227930545806885
Epoch: 18, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.140 Vali Acc: 0.975 Test Loss: 0.140 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 19 cost time: 6.072932004928589
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.189 Vali Acc: 0.965 Test Loss: 0.189 Test Acc: 0.965
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 6.520082712173462
Epoch: 20, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.185 Vali Acc: 0.970 Test Loss: 0.185 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 6.41964864730835
Epoch: 21, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.964 Test Loss: 0.229 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.994645595550537
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.159 Vali Acc: 0.975 Test Loss: 0.159 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 6.755163908004761
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.969 Test Loss: 0.182 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.069350719451904
Epoch: 24, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.973 Test Loss: 0.169 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 6.108900785446167
Epoch: 25, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.627073764801025
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.976 Test Loss: 0.162 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975625).  Saving model ...
Epoch: 27 cost time: 6.049007177352905
Epoch: 27, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.182 Vali Acc: 0.971 Test Loss: 0.182 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 6.886053085327148
Epoch: 28, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.973 Test Loss: 0.181 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 5.477375030517578
Epoch: 29, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.972 Test Loss: 0.181 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 6.431631565093994
Epoch: 30, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.283 Vali Acc: 0.967 Test Loss: 0.283 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 6.499273061752319
Epoch: 31, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.313 Vali Acc: 0.949 Test Loss: 0.313 Test Acc: 0.949
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 6.598036766052246
Epoch: 32, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.303 Vali Acc: 0.963 Test Loss: 0.303 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 6.312566518783569
Epoch: 33, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.244 Vali Acc: 0.965 Test Loss: 0.244 Test Acc: 0.965
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 6.457221031188965
Epoch: 34, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.299 Vali Acc: 0.960 Test Loss: 0.299 Test Acc: 0.960
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 6.009728908538818
Epoch: 35, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.269 Vali Acc: 0.970 Test Loss: 0.269 Test Acc: 0.970
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 6.202350616455078
Epoch: 36, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.318 Vali Acc: 0.957 Test Loss: 0.318 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 275696
model size : 2.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.424377679824829
Epoch: 1, Steps: 89 | Train Loss: 1.256 Vali Loss: 0.405 Vali Acc: 0.896 Test Loss: 0.405 Test Acc: 0.896
Validation loss decreased (inf --> -0.896236).  Saving model ...
Epoch: 2 cost time: 6.615432977676392
Epoch: 2, Steps: 89 | Train Loss: 0.291 Vali Loss: 0.208 Vali Acc: 0.946 Test Loss: 0.208 Test Acc: 0.946
Validation loss decreased (-0.896236 --> -0.945680).  Saving model ...
Epoch: 3 cost time: 7.677314043045044
Epoch: 3, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.945680 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 6.9739415645599365
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.141 Vali Acc: 0.960 Test Loss: 0.141 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.960305).  Saving model ...
Epoch: 5 cost time: 6.780979633331299
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.132 Vali Acc: 0.971 Test Loss: 0.132 Test Acc: 0.971
Validation loss decreased (-0.960305 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 6.717616319656372
Epoch: 6, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.154 Vali Acc: 0.969 Test Loss: 0.154 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 7.170207500457764
Epoch: 7, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.139 Vali Acc: 0.970 Test Loss: 0.139 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 7.537814140319824
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.969 Test Loss: 0.153 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 6.914829969406128
Epoch: 9, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.156 Vali Acc: 0.970 Test Loss: 0.156 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 6.874489784240723
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.187 Vali Acc: 0.967 Test Loss: 0.187 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 6.497981548309326
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 12 cost time: 6.944138288497925
Epoch: 12, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.128 Vali Acc: 0.981 Test Loss: 0.128 Test Acc: 0.981
Validation loss decreased (-0.971447 --> -0.980500).  Saving model ...
Epoch: 13 cost time: 7.137881278991699
Epoch: 13, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.230317115783691
Epoch: 14, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.149 Vali Acc: 0.976 Test Loss: 0.149 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 6.4623823165893555
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.172 Vali Acc: 0.971 Test Loss: 0.172 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.912455320358276
Epoch: 16, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.216 Vali Acc: 0.964 Test Loss: 0.216 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 7.638274908065796
Epoch: 17, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.201 Vali Acc: 0.971 Test Loss: 0.201 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 8.43540096282959
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.165 Vali Acc: 0.976 Test Loss: 0.165 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 8.147131443023682
Epoch: 19, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.214 Vali Acc: 0.967 Test Loss: 0.214 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 6.9387688636779785
Epoch: 20, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.963 Test Loss: 0.196 Test Acc: 0.963
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 7.858373641967773
Epoch: 21, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.963 Test Loss: 0.256 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 8.306771039962769
Epoch: 22, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.302 Vali Acc: 0.966 Test Loss: 0.302 Test Acc: 0.966
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 259312
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.662013292312622
Epoch: 1, Steps: 89 | Train Loss: 1.267 Vali Loss: 0.403 Vali Acc: 0.896 Test Loss: 0.403 Test Acc: 0.896
Validation loss decreased (inf --> -0.895539).  Saving model ...
Epoch: 2 cost time: 5.550478219985962
Epoch: 2, Steps: 89 | Train Loss: 0.277 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.895539 --> -0.948466).  Saving model ...
Epoch: 3 cost time: 6.630615234375
Epoch: 3, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.181 Vali Acc: 0.949 Test Loss: 0.181 Test Acc: 0.949
Validation loss decreased (-0.948466 --> -0.949163).  Saving model ...
Epoch: 4 cost time: 7.785173416137695
Epoch: 4, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.167 Vali Acc: 0.955 Test Loss: 0.167 Test Acc: 0.955
Validation loss decreased (-0.949163 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 6.304195404052734
Epoch: 5, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
Validation loss decreased (-0.955430 --> -0.956127).  Saving model ...
Epoch: 6 cost time: 5.903807640075684
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.153 Vali Acc: 0.964 Test Loss: 0.153 Test Acc: 0.964
Validation loss decreased (-0.956127 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 7.348918199539185
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
Validation loss decreased (-0.963787 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 7.093921899795532
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
Validation loss decreased (-0.966573 --> -0.970054).  Saving model ...
Epoch: 9 cost time: 7.302247762680054
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.141 Vali Acc: 0.964 Test Loss: 0.141 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 7.367544651031494
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.123 Vali Acc: 0.982 Test Loss: 0.123 Test Acc: 0.982
Validation loss decreased (-0.970054 --> -0.981893).  Saving model ...
Epoch: 11 cost time: 7.198591709136963
Epoch: 11, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 7.47763991355896
Epoch: 12, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.9001383781433105
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.128 Vali Acc: 0.973 Test Loss: 0.128 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 7.53965425491333
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 8.107511758804321
Epoch: 15, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.250 Vali Acc: 0.951 Test Loss: 0.250 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 7.308913946151733
Epoch: 16, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.962 Test Loss: 0.159 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 7.81882119178772
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.151 Vali Acc: 0.973 Test Loss: 0.151 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 6.950082063674927
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.327 Vali Acc: 0.941 Test Loss: 0.327 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 7.504050254821777
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.173 Vali Acc: 0.965 Test Loss: 0.173 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 6.600831985473633
Epoch: 20, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.264 Vali Acc: 0.957 Test Loss: 0.264 Test Acc: 0.957
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 259312
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.234108924865723
Epoch: 1, Steps: 89 | Train Loss: 1.291 Vali Loss: 0.403 Vali Acc: 0.896 Test Loss: 0.403 Test Acc: 0.896
Validation loss decreased (inf --> -0.896236).  Saving model ...
Epoch: 2 cost time: 6.417591333389282
Epoch: 2, Steps: 89 | Train Loss: 0.273 Vali Loss: 0.216 Vali Acc: 0.945 Test Loss: 0.216 Test Acc: 0.945
Validation loss decreased (-0.896236 --> -0.944984).  Saving model ...
Epoch: 3 cost time: 6.569282054901123
Epoch: 3, Steps: 89 | Train Loss: 0.135 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
Validation loss decreased (-0.944984 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 6.371729850769043
Epoch: 4, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
Validation loss decreased (-0.957519 --> -0.967965).  Saving model ...
Epoch: 5 cost time: 5.001538038253784
Epoch: 5, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.118 Vali Acc: 0.967 Test Loss: 0.118 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.4275548458099365
Epoch: 6, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.971447).  Saving model ...
Epoch: 7 cost time: 6.301815748214722
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.109 Vali Acc: 0.971 Test Loss: 0.109 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 6.511068344116211
Epoch: 8, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.776221036911011
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.136 Vali Acc: 0.967 Test Loss: 0.136 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 6.4360902309417725
Epoch: 10, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.142 Vali Acc: 0.968 Test Loss: 0.142 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 6.3675148487091064
Epoch: 11, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.318 Vali Acc: 0.935 Test Loss: 0.318 Test Acc: 0.935
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 6.448174715042114
Epoch: 12, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.117 Vali Acc: 0.975 Test Loss: 0.117 Test Acc: 0.975
Validation loss decreased (-0.971447 --> -0.974929).  Saving model ...
Epoch: 13 cost time: 5.9762091636657715
Epoch: 13, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.980 Test Loss: 0.116 Test Acc: 0.980
Validation loss decreased (-0.974929 --> -0.979804).  Saving model ...
Epoch: 14 cost time: 6.617567777633667
Epoch: 14, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.977 Test Loss: 0.121 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 6.352688789367676
Epoch: 15, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 6.292374849319458
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.164 Vali Acc: 0.974 Test Loss: 0.164 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.99042272567749
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 6.3439154624938965
Epoch: 18, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.346 Vali Acc: 0.945 Test Loss: 0.346 Test Acc: 0.945
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 6.601430177688599
Epoch: 19, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.969 Test Loss: 0.228 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 6.015633821487427
Epoch: 20, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.230 Vali Acc: 0.964 Test Loss: 0.230 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.468322038650513
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.275 Vali Acc: 0.965 Test Loss: 0.275 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 6.0941994190216064
Epoch: 22, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.251 Vali Acc: 0.967 Test Loss: 0.251 Test Acc: 0.967
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 6.304232597351074
Epoch: 23, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.303 Vali Acc: 0.964 Test Loss: 0.303 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 259312
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.475665092468262
Epoch: 1, Steps: 89 | Train Loss: 1.464 Vali Loss: 0.488 Vali Acc: 0.873 Test Loss: 0.488 Test Acc: 0.873
Validation loss decreased (inf --> -0.873254).  Saving model ...
Epoch: 2 cost time: 6.841493844985962
Epoch: 2, Steps: 89 | Train Loss: 0.318 Vali Loss: 0.269 Vali Acc: 0.925 Test Loss: 0.269 Test Acc: 0.925
Validation loss decreased (-0.873254 --> -0.924788).  Saving model ...
Epoch: 3 cost time: 6.6941611766815186
Epoch: 3, Steps: 89 | Train Loss: 0.172 Vali Loss: 0.212 Vali Acc: 0.942 Test Loss: 0.212 Test Acc: 0.942
Validation loss decreased (-0.924788 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 6.991228103637695
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.154 Vali Acc: 0.963 Test Loss: 0.154 Test Acc: 0.963
Validation loss decreased (-0.941502 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 6.706913948059082
Epoch: 5, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.934529781341553
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.162 Vali Acc: 0.955 Test Loss: 0.162 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 6.0304365158081055
Epoch: 7, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.153 Vali Acc: 0.960 Test Loss: 0.153 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 6.467606544494629
Epoch: 8, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.162 Vali Acc: 0.958 Test Loss: 0.162 Test Acc: 0.958
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 6.136051177978516
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.963090 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 5.869818449020386
Epoch: 10, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.145 Vali Acc: 0.967 Test Loss: 0.145 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.75536036491394
Epoch: 11, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.173 Vali Acc: 0.960 Test Loss: 0.173 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.075275421142578
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.886969089508057
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.194 Vali Acc: 0.960 Test Loss: 0.194 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.019765615463257
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.162 Vali Acc: 0.965 Test Loss: 0.162 Test Acc: 0.965
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.067702054977417
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.190 Vali Acc: 0.961 Test Loss: 0.190 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 6.532600164413452
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.148 Vali Acc: 0.971 Test Loss: 0.148 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 6.595364570617676
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.185 Vali Acc: 0.961 Test Loss: 0.185 Test Acc: 0.961
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.442505598068237
Epoch: 18, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.363691568374634
Epoch: 19, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.131 Vali Acc: 0.976 Test Loss: 0.131 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975625).  Saving model ...
Epoch: 20 cost time: 6.26701545715332
Epoch: 20, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.970 Test Loss: 0.151 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 6.871243715286255
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.170 Vali Acc: 0.968 Test Loss: 0.170 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 6.419209718704224
Epoch: 22, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.964 Test Loss: 0.202 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.895532608032227
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 5.492815732955933
Epoch: 24, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.238 Vali Acc: 0.962 Test Loss: 0.238 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 6.250147819519043
Epoch: 25, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.972 Test Loss: 0.207 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.88317084312439
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.903974294662476
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.971 Test Loss: 0.190 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.916244029998779
Epoch: 28, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.751259088516235
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.964 Test Loss: 0.220 Test Acc: 0.964
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 259312
model size : 2.22MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 9.534719705581665
Epoch: 1, Steps: 89 | Train Loss: 1.289 Vali Loss: 0.438 Vali Acc: 0.879 Test Loss: 0.438 Test Acc: 0.879
Validation loss decreased (inf --> -0.878826).  Saving model ...
Epoch: 2 cost time: 6.478561878204346
Epoch: 2, Steps: 89 | Train Loss: 0.267 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
Validation loss decreased (-0.878826 --> -0.957519).  Saving model ...
Epoch: 3 cost time: 6.450601100921631
Epoch: 3, Steps: 89 | Train Loss: 0.151 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.957519 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 6.326172590255737
Epoch: 4, Steps: 89 | Train Loss: 0.109 Vali Loss: 0.155 Vali Acc: 0.963 Test Loss: 0.155 Test Acc: 0.963
Validation loss decreased (-0.958912 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 6.93376088142395
Epoch: 5, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.278398036956787
Epoch: 6, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.146 Vali Acc: 0.970 Test Loss: 0.146 Test Acc: 0.970
Validation loss decreased (-0.963090 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 6.56582498550415
Epoch: 7, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 5.784453630447388
Epoch: 8, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.115 Vali Acc: 0.974 Test Loss: 0.115 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 6.129777431488037
Epoch: 9, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.108 Vali Acc: 0.979 Test Loss: 0.108 Test Acc: 0.979
Validation loss decreased (-0.974233 --> -0.979108).  Saving model ...
Epoch: 10 cost time: 6.6498682498931885
Epoch: 10, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.132 Vali Acc: 0.973 Test Loss: 0.132 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.889538288116455
Epoch: 11, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.552616596221924
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.962 Test Loss: 0.187 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 6.064672470092773
Epoch: 13, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.186 Vali Acc: 0.969 Test Loss: 0.186 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.4282519817352295
Epoch: 14, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.393 Vali Acc: 0.928 Test Loss: 0.393 Test Acc: 0.928
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 6.404027223587036
Epoch: 15, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.600900888442993
Epoch: 16, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.972 Test Loss: 0.190 Test Acc: 0.972
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.975087404251099
Epoch: 17, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.191 Vali Acc: 0.971 Test Loss: 0.191 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 6.685827732086182
Epoch: 18, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.978 Test Loss: 0.156 Test Acc: 0.978
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 6.932770013809204
Epoch: 19, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.979 Test Loss: 0.156 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 251120
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.890675067901611
Epoch: 1, Steps: 89 | Train Loss: 1.289 Vali Loss: 0.421 Vali Acc: 0.886 Test Loss: 0.421 Test Acc: 0.886
Validation loss decreased (inf --> -0.885790).  Saving model ...
Epoch: 2 cost time: 6.091288805007935
Epoch: 2, Steps: 89 | Train Loss: 0.259 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
Validation loss decreased (-0.885790 --> -0.952644).  Saving model ...
Epoch: 3 cost time: 5.645171403884888
Epoch: 3, Steps: 89 | Train Loss: 0.141 Vali Loss: 0.139 Vali Acc: 0.968 Test Loss: 0.139 Test Acc: 0.968
Validation loss decreased (-0.952644 --> -0.967965).  Saving model ...
Epoch: 4 cost time: 6.670124292373657
Epoch: 4, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.133 Vali Acc: 0.969 Test Loss: 0.133 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.969358).  Saving model ...
Epoch: 5 cost time: 6.666317701339722
Epoch: 5, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.158 Vali Acc: 0.958 Test Loss: 0.158 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 6.8661534786224365
Epoch: 6, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.135 Vali Acc: 0.970 Test Loss: 0.135 Test Acc: 0.970
Validation loss decreased (-0.969358 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 6.863588809967041
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.119 Vali Acc: 0.973 Test Loss: 0.119 Test Acc: 0.973
Validation loss decreased (-0.970054 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 6.299214124679565
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.133 Vali Acc: 0.978 Test Loss: 0.133 Test Acc: 0.978
Validation loss decreased (-0.972840 --> -0.978411).  Saving model ...
Epoch: 9 cost time: 5.7266600131988525
Epoch: 9, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.944957733154297
Epoch: 10, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 6.64846658706665
Epoch: 11, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.948 Test Loss: 0.254 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 7.288285732269287
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 6.181673765182495
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.173 Vali Acc: 0.971 Test Loss: 0.173 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 5.600188255310059
Epoch: 14, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.151 Vali Acc: 0.972 Test Loss: 0.151 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 6.100013494491577
Epoch: 15, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 6.9872887134552
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 6.355057954788208
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 5.958340644836426
Epoch: 18, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.711 Vali Acc: 0.896 Test Loss: 0.711 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 251120
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.023311614990234
Epoch: 1, Steps: 89 | Train Loss: 1.314 Vali Loss: 0.408 Vali Acc: 0.896 Test Loss: 0.408 Test Acc: 0.896
Validation loss decreased (inf --> -0.895539).  Saving model ...
Epoch: 2 cost time: 5.761273145675659
Epoch: 2, Steps: 89 | Train Loss: 0.256 Vali Loss: 0.200 Vali Acc: 0.954 Test Loss: 0.200 Test Acc: 0.954
Validation loss decreased (-0.895539 --> -0.954037).  Saving model ...
Epoch: 3 cost time: 5.292874097824097
Epoch: 3, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
Validation loss decreased (-0.954037 --> -0.958912).  Saving model ...
Epoch: 4 cost time: 5.591753244400024
Epoch: 4, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.150 Vali Acc: 0.957 Test Loss: 0.150 Test Acc: 0.957
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.213365793228149
Epoch: 5, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
Validation loss decreased (-0.958912 --> -0.960305).  Saving model ...
Epoch: 6 cost time: 5.633663892745972
Epoch: 6, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.129 Vali Acc: 0.974 Test Loss: 0.129 Test Acc: 0.974
Validation loss decreased (-0.960305 --> -0.974233).  Saving model ...
Epoch: 7 cost time: 4.981642961502075
Epoch: 7, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.0057902336120605
Epoch: 8, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.121 Vali Acc: 0.974 Test Loss: 0.121 Test Acc: 0.974
Validation loss decreased (-0.974233 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 5.282577991485596
Epoch: 9, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
Validation loss decreased (-0.974233 --> -0.974929).  Saving model ...
Epoch: 10 cost time: 6.516639232635498
Epoch: 10, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 6.506482124328613
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.966 Test Loss: 0.164 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.858757972717285
Epoch: 12, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.167 Vali Acc: 0.964 Test Loss: 0.167 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.982387542724609
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.928479433059692
Epoch: 14, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.370 Vali Acc: 0.926 Test Loss: 0.370 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.699451446533203
Epoch: 15, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.188 Vali Acc: 0.969 Test Loss: 0.188 Test Acc: 0.969
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.862767219543457
Epoch: 16, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.967 Test Loss: 0.196 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.788531064987183
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.165 Vali Acc: 0.979 Test Loss: 0.165 Test Acc: 0.979
Validation loss decreased (-0.974929 --> -0.979107).  Saving model ...
Epoch: 18 cost time: 5.957078695297241
Epoch: 18, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.980 Test Loss: 0.160 Test Acc: 0.980
Validation loss decreased (-0.979107 --> -0.979803).  Saving model ...
Epoch: 19 cost time: 6.178076982498169
Epoch: 19, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.970 Test Loss: 0.201 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.855730772018433
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.967 Test Loss: 0.209 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.245861530303955
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.958 Test Loss: 0.274 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 4.91472053527832
Epoch: 22, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.164 Vali Acc: 0.971 Test Loss: 0.164 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.161803960800171
Epoch: 23, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.372 Vali Acc: 0.947 Test Loss: 0.372 Test Acc: 0.947
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 6.056444883346558
Epoch: 24, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.195 Vali Acc: 0.971 Test Loss: 0.195 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.839274168014526
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.974 Test Loss: 0.199 Test Acc: 0.974
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.138477087020874
Epoch: 26, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.970 Test Loss: 0.226 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.572834014892578
Epoch: 27, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.972 Test Loss: 0.228 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 6.047686338424683
Epoch: 28, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.193 Vali Acc: 0.976 Test Loss: 0.193 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9798050139275766
model parameter : 251120
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.066326141357422
Epoch: 1, Steps: 89 | Train Loss: 1.473 Vali Loss: 0.495 Vali Acc: 0.879 Test Loss: 0.495 Test Acc: 0.879
Validation loss decreased (inf --> -0.878825).  Saving model ...
Epoch: 2 cost time: 5.782013416290283
Epoch: 2, Steps: 89 | Train Loss: 0.307 Vali Loss: 0.238 Vali Acc: 0.939 Test Loss: 0.238 Test Acc: 0.939
Validation loss decreased (-0.878825 --> -0.939413).  Saving model ...
Epoch: 3 cost time: 5.580213785171509
Epoch: 3, Steps: 89 | Train Loss: 0.167 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.939413 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 5.681683778762817
Epoch: 4, Steps: 89 | Train Loss: 0.118 Vali Loss: 0.224 Vali Acc: 0.936 Test Loss: 0.224 Test Acc: 0.936
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.732951402664185
Epoch: 5, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
Validation loss decreased (-0.947770 --> -0.951948).  Saving model ...
Epoch: 6 cost time: 4.936712026596069
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.148 Vali Acc: 0.970 Test Loss: 0.148 Test Acc: 0.970
Validation loss decreased (-0.951948 --> -0.970054).  Saving model ...
Epoch: 7 cost time: 5.586434841156006
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 5.26116943359375
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 5.6147472858428955
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.969 Test Loss: 0.134 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 5.436483144760132
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 5.310580730438232
Epoch: 11, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
Validation loss decreased (-0.970054 --> -0.970054).  Saving model ...
Epoch: 12 cost time: 5.486953973770142
Epoch: 12, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.101383209228516
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.970054 --> -0.972143).  Saving model ...
Epoch: 14 cost time: 5.41996693611145
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 5.906818151473999
Epoch: 15, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.152 Vali Acc: 0.968 Test Loss: 0.152 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.211095333099365
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.965 Test Loss: 0.182 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.111600637435913
Epoch: 17, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.222 Vali Acc: 0.959 Test Loss: 0.222 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.529466867446899
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.170 Vali Acc: 0.972 Test Loss: 0.170 Test Acc: 0.972
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.740596055984497
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.157 Vali Acc: 0.969 Test Loss: 0.157 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.179846286773682
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.258 Vali Acc: 0.958 Test Loss: 0.258 Test Acc: 0.958
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.399799346923828
Epoch: 21, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.256 Vali Acc: 0.960 Test Loss: 0.256 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.529430866241455
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.965 Test Loss: 0.217 Test Acc: 0.965
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.819507360458374
Epoch: 23, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.84952187538147
Epoch: 24, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.972 Test Loss: 0.192 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 251120
model size : 2.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.010992288589478
Epoch: 1, Steps: 89 | Train Loss: 1.656 Vali Loss: 0.623 Vali Acc: 0.873 Test Loss: 0.623 Test Acc: 0.873
Validation loss decreased (inf --> -0.872556).  Saving model ...
Epoch: 2 cost time: 5.955822229385376
Epoch: 2, Steps: 89 | Train Loss: 0.414 Vali Loss: 0.278 Vali Acc: 0.934 Test Loss: 0.278 Test Acc: 0.934
Validation loss decreased (-0.872556 --> -0.933841).  Saving model ...
Epoch: 3 cost time: 6.225537538528442
Epoch: 3, Steps: 89 | Train Loss: 0.201 Vali Loss: 0.206 Vali Acc: 0.939 Test Loss: 0.206 Test Acc: 0.939
Validation loss decreased (-0.933841 --> -0.938717).  Saving model ...
Epoch: 4 cost time: 5.657513380050659
Epoch: 4, Steps: 89 | Train Loss: 0.137 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.938717 --> -0.944288).  Saving model ...
Epoch: 5 cost time: 5.8836236000061035
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.944288 --> -0.966572).  Saving model ...
Epoch: 6 cost time: 6.119458913803101
Epoch: 6, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.121 Vali Acc: 0.962 Test Loss: 0.121 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.816446304321289
Epoch: 7, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
Validation loss decreased (-0.966572 --> -0.970751).  Saving model ...
Epoch: 8 cost time: 5.5723302364349365
Epoch: 8, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 5.9252917766571045
Epoch: 9, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.5233447551727295
Epoch: 10, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.107 Vali Acc: 0.975 Test Loss: 0.107 Test Acc: 0.975
Validation loss decreased (-0.970751 --> -0.974929).  Saving model ...
Epoch: 11 cost time: 5.58280348777771
Epoch: 11, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.105 Vali Acc: 0.976 Test Loss: 0.105 Test Acc: 0.976
Validation loss decreased (-0.974929 --> -0.975626).  Saving model ...
Epoch: 12 cost time: 5.48358154296875
Epoch: 12, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.207976579666138
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.123 Vali Acc: 0.970 Test Loss: 0.123 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.566354990005493
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.107 Vali Acc: 0.977 Test Loss: 0.107 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 15 cost time: 5.541118860244751
Epoch: 15, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.101 Vali Acc: 0.976 Test Loss: 0.101 Test Acc: 0.976
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.812057733535767
Epoch: 16, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 6.068012952804565
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.111 Vali Acc: 0.976 Test Loss: 0.111 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 6.094463348388672
Epoch: 18, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.868118047714233
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 6.0169878005981445
Epoch: 20, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.131 Vali Acc: 0.974 Test Loss: 0.131 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.492981910705566
Epoch: 21, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 22 cost time: 6.018060207366943
Epoch: 22, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 5.697023868560791
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.114 Vali Acc: 0.979 Test Loss: 0.114 Test Acc: 0.979
Validation loss decreased (-0.977715 --> -0.979107).  Saving model ...
Epoch: 24 cost time: 5.487873077392578
Epoch: 24, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.979 Test Loss: 0.123 Test Acc: 0.979
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 6.027343273162842
Epoch: 25, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.124 Vali Acc: 0.978 Test Loss: 0.124 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 5.397891998291016
Epoch: 26, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 6.155030727386475
Epoch: 27, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 5.398340702056885
Epoch: 28, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.326 Vali Acc: 0.951 Test Loss: 0.326 Test Acc: 0.951
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 5.89165186882019
Epoch: 29, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.291 Vali Acc: 0.951 Test Loss: 0.291 Test Acc: 0.951
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 5.6704137325286865
Epoch: 30, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.187 Vali Acc: 0.975 Test Loss: 0.187 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 5.950836658477783
Epoch: 31, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 5.938288688659668
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.977 Test Loss: 0.172 Test Acc: 0.977
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 5.821070194244385
Epoch: 33, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.981 Test Loss: 0.161 Test Acc: 0.981
Validation loss decreased (-0.979107 --> -0.980500).  Saving model ...
Epoch: 34 cost time: 5.887358903884888
Epoch: 34, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 6.182646751403809
Epoch: 35, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.981 Test Loss: 0.167 Test Acc: 0.981
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 5.769052267074585
Epoch: 36, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.983 Test Loss: 0.164 Test Acc: 0.983
Validation loss decreased (-0.980500 --> -0.982589).  Saving model ...
Epoch: 37 cost time: 5.044754505157471
Epoch: 37, Steps: 89 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.975 Test Loss: 0.184 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 5.787164211273193
Epoch: 38, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.973 Test Loss: 0.222 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 5.387164354324341
Epoch: 39, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.183 Vali Acc: 0.981 Test Loss: 0.183 Test Acc: 0.981
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 5.735158443450928
Epoch: 40, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.237 Vali Acc: 0.971 Test Loss: 0.237 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 5.6248204708099365
Epoch: 41, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.979 Test Loss: 0.192 Test Acc: 0.979
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 5.265449523925781
Epoch: 42, Steps: 89 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.981 Test Loss: 0.170 Test Acc: 0.981
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 5.603426933288574
Epoch: 43, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.975 Test Loss: 0.209 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 5.983374834060669
Epoch: 44, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.978 Test Loss: 0.175 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 6.034574031829834
Epoch: 45, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.979 Test Loss: 0.172 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 6.0685954093933105
Epoch: 46, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.234 Vali Acc: 0.974 Test Loss: 0.234 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9825905292479109
model parameter : 250512
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 8.709888935089111
Epoch: 1, Steps: 89 | Train Loss: 1.675 Vali Loss: 0.634 Vali Acc: 0.865 Test Loss: 0.634 Test Acc: 0.865
Validation loss decreased (inf --> -0.864896).  Saving model ...
Epoch: 2 cost time: 5.743483066558838
Epoch: 2, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.283 Vali Acc: 0.940 Test Loss: 0.283 Test Acc: 0.940
Validation loss decreased (-0.864896 --> -0.940109).  Saving model ...
Epoch: 3 cost time: 5.079577922821045
Epoch: 3, Steps: 89 | Train Loss: 0.207 Vali Loss: 0.204 Vali Acc: 0.942 Test Loss: 0.204 Test Acc: 0.942
Validation loss decreased (-0.940109 --> -0.941502).  Saving model ...
Epoch: 4 cost time: 5.405026912689209
Epoch: 4, Steps: 89 | Train Loss: 0.147 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.941502 --> -0.947770).  Saving model ...
Epoch: 5 cost time: 4.93701171875
Epoch: 5, Steps: 89 | Train Loss: 0.103 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
Validation loss decreased (-0.947770 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 5.091638088226318
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.128 Vali Acc: 0.963 Test Loss: 0.128 Test Acc: 0.963
Validation loss decreased (-0.961698 --> -0.963091).  Saving model ...
Epoch: 7 cost time: 5.236560344696045
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.125 Vali Acc: 0.964 Test Loss: 0.125 Test Acc: 0.964
Validation loss decreased (-0.963091 --> -0.963787).  Saving model ...
Epoch: 8 cost time: 5.394226312637329
Epoch: 8, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.135 Vali Acc: 0.963 Test Loss: 0.135 Test Acc: 0.963
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.628856897354126
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
Validation loss decreased (-0.963787 --> -0.969358).  Saving model ...
Epoch: 10 cost time: 5.395399332046509
Epoch: 10, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.151 Vali Acc: 0.959 Test Loss: 0.151 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.012017011642456
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 6.137962818145752
Epoch: 12, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.969358 --> -0.972840).  Saving model ...
Epoch: 13 cost time: 5.96339225769043
Epoch: 13, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 6.083161115646362
Epoch: 14, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.150 Vali Acc: 0.969 Test Loss: 0.150 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.750214576721191
Epoch: 15, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.121 Vali Acc: 0.970 Test Loss: 0.121 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 6.106548547744751
Epoch: 16, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 5.243926286697388
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 18 cost time: 6.087651968002319
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.153 Vali Acc: 0.970 Test Loss: 0.153 Test Acc: 0.970
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.498453378677368
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.144 Vali Acc: 0.970 Test Loss: 0.144 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.588867425918579
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.969 Test Loss: 0.136 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.029235363006592
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.136 Vali Acc: 0.971 Test Loss: 0.136 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.603940963745117
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.4007298946380615
Epoch: 23, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.210509777069092
Epoch: 24, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.141 Vali Acc: 0.974 Test Loss: 0.141 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 25 cost time: 5.562700033187866
Epoch: 25, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.158 Vali Acc: 0.967 Test Loss: 0.158 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.139973878860474
Epoch: 26, Steps: 89 | Train Loss: 0.077 Vali Loss: 0.171 Vali Acc: 0.970 Test Loss: 0.171 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 5.761585712432861
Epoch: 27, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 6.044422388076782
Epoch: 28, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.961 Test Loss: 0.200 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 6.002657175064087
Epoch: 29, Steps: 89 | Train Loss: 0.079 Vali Loss: 0.186 Vali Acc: 0.971 Test Loss: 0.186 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 5.372406244277954
Epoch: 30, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.166 Vali Acc: 0.972 Test Loss: 0.166 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 5.776480197906494
Epoch: 31, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.966 Test Loss: 0.196 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 5.692055702209473
Epoch: 32, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.974 Test Loss: 0.176 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 5.720135688781738
Epoch: 33, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 5.142251968383789
Epoch: 34, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.978 Test Loss: 0.153 Test Acc: 0.978
Validation loss decreased (-0.974233 --> -0.977714).  Saving model ...
Epoch: 35 cost time: 4.866670370101929
Epoch: 35, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.150 Vali Acc: 0.979 Test Loss: 0.150 Test Acc: 0.979
Validation loss decreased (-0.977714 --> -0.979107).  Saving model ...
Epoch: 36 cost time: 4.704888343811035
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.153 Vali Acc: 0.977 Test Loss: 0.153 Test Acc: 0.977
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.495010614395142
Epoch: 37, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.977 Test Loss: 0.156 Test Acc: 0.977
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.492733001708984
Epoch: 38, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.971 Test Loss: 0.179 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.160584449768066
Epoch: 39, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.975 Test Loss: 0.212 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 5.179778337478638
Epoch: 40, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.973 Test Loss: 0.217 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 5.396402835845947
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.234 Vali Acc: 0.964 Test Loss: 0.234 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 6.006479501724243
Epoch: 42, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.969 Test Loss: 0.237 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 5.838220596313477
Epoch: 43, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.970 Test Loss: 0.195 Test Acc: 0.970
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.769751071929932
Epoch: 44, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.229 Vali Acc: 0.974 Test Loss: 0.229 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 5.879699230194092
Epoch: 45, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.308 Vali Acc: 0.963 Test Loss: 0.308 Test Acc: 0.963
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.979108635097493
model parameter : 250512
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.829263210296631
Epoch: 1, Steps: 89 | Train Loss: 1.729 Vali Loss: 0.675 Vali Acc: 0.857 Test Loss: 0.675 Test Acc: 0.857
Validation loss decreased (inf --> -0.856539).  Saving model ...
Epoch: 2 cost time: 4.944864988327026
Epoch: 2, Steps: 89 | Train Loss: 0.439 Vali Loss: 0.301 Vali Acc: 0.937 Test Loss: 0.301 Test Acc: 0.937
Validation loss decreased (-0.856539 --> -0.936627).  Saving model ...
Epoch: 3 cost time: 5.3222129344940186
Epoch: 3, Steps: 89 | Train Loss: 0.225 Vali Loss: 0.211 Vali Acc: 0.950 Test Loss: 0.211 Test Acc: 0.950
Validation loss decreased (-0.936627 --> -0.949859).  Saving model ...
Epoch: 4 cost time: 4.96661114692688
Epoch: 4, Steps: 89 | Train Loss: 0.161 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.658008337020874
Epoch: 5, Steps: 89 | Train Loss: 0.106 Vali Loss: 0.160 Vali Acc: 0.962 Test Loss: 0.160 Test Acc: 0.962
Validation loss decreased (-0.949859 --> -0.962394).  Saving model ...
Epoch: 6 cost time: 5.727428913116455
Epoch: 6, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.157 Vali Acc: 0.953 Test Loss: 0.157 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.607611656188965
Epoch: 7, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.133 Vali Acc: 0.967 Test Loss: 0.133 Test Acc: 0.967
Validation loss decreased (-0.962394 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 5.716991424560547
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.126 Vali Acc: 0.966 Test Loss: 0.126 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.59473180770874
Epoch: 9, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.134 Vali Acc: 0.964 Test Loss: 0.134 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.748663663864136
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.194 Vali Acc: 0.946 Test Loss: 0.194 Test Acc: 0.946
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 5.9749579429626465
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 5.633657217025757
Epoch: 12, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.122 Vali Acc: 0.969 Test Loss: 0.122 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 6.2341132164001465
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.964 Test Loss: 0.133 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.780733823776245
Epoch: 14, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 5.980643272399902
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.724476099014282
Epoch: 16, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.181 Vali Acc: 0.960 Test Loss: 0.181 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.492230653762817
Epoch: 17, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.133 Vali Acc: 0.973 Test Loss: 0.133 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.285569906234741
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.122 Vali Acc: 0.974 Test Loss: 0.122 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973536).  Saving model ...
Epoch: 19 cost time: 5.39523720741272
Epoch: 19, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.145 Vali Acc: 0.968 Test Loss: 0.145 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.551394701004028
Epoch: 20, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.365881443023682
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.164 Vali Acc: 0.961 Test Loss: 0.164 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.346932411193848
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.190 Vali Acc: 0.960 Test Loss: 0.190 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.933948040008545
Epoch: 23, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.145 Vali Acc: 0.969 Test Loss: 0.145 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.579615116119385
Epoch: 24, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.150 Vali Acc: 0.970 Test Loss: 0.150 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.7725396156311035
Epoch: 25, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.960 Test Loss: 0.184 Test Acc: 0.960
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.764991760253906
Epoch: 26, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.154 Vali Acc: 0.971 Test Loss: 0.154 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.912854194641113
Epoch: 27, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.958 Test Loss: 0.183 Test Acc: 0.958
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.813491344451904
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.969 Test Loss: 0.151 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 250512
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.543259382247925
Epoch: 1, Steps: 89 | Train Loss: 1.951 Vali Loss: 0.883 Vali Acc: 0.836 Test Loss: 0.883 Test Acc: 0.836
Validation loss decreased (inf --> -0.836342).  Saving model ...
Epoch: 2 cost time: 5.486554145812988
Epoch: 2, Steps: 89 | Train Loss: 0.546 Vali Loss: 0.389 Vali Acc: 0.903 Test Loss: 0.389 Test Acc: 0.903
Validation loss decreased (-0.836342 --> -0.903199).  Saving model ...
Epoch: 3 cost time: 5.60737943649292
Epoch: 3, Steps: 89 | Train Loss: 0.285 Vali Loss: 0.292 Vali Acc: 0.932 Test Loss: 0.292 Test Acc: 0.932
Validation loss decreased (-0.903199 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 5.179959535598755
Epoch: 4, Steps: 89 | Train Loss: 0.206 Vali Loss: 0.240 Vali Acc: 0.932 Test Loss: 0.240 Test Acc: 0.932
Validation loss decreased (-0.931752 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 5.810307264328003
Epoch: 5, Steps: 89 | Train Loss: 0.144 Vali Loss: 0.199 Vali Acc: 0.945 Test Loss: 0.199 Test Acc: 0.945
Validation loss decreased (-0.931752 --> -0.944984).  Saving model ...
Epoch: 6 cost time: 5.47763466835022
Epoch: 6, Steps: 89 | Train Loss: 0.104 Vali Loss: 0.196 Vali Acc: 0.942 Test Loss: 0.196 Test Acc: 0.942
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.293854475021362
Epoch: 7, Steps: 89 | Train Loss: 0.092 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.944984 --> -0.948466).  Saving model ...
Epoch: 8 cost time: 5.332993268966675
Epoch: 8, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.166 Vali Acc: 0.955 Test Loss: 0.166 Test Acc: 0.955
Validation loss decreased (-0.948466 --> -0.955430).  Saving model ...
Epoch: 9 cost time: 4.961921691894531
Epoch: 9, Steps: 89 | Train Loss: 0.082 Vali Loss: 0.190 Vali Acc: 0.943 Test Loss: 0.190 Test Acc: 0.943
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 5.849771976470947
Epoch: 10, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.157 Vali Acc: 0.955 Test Loss: 0.157 Test Acc: 0.955
Validation loss decreased (-0.955430 --> -0.955430).  Saving model ...
Epoch: 11 cost time: 4.893316268920898
Epoch: 11, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.147 Vali Acc: 0.958 Test Loss: 0.147 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 12 cost time: 5.2816102504730225
Epoch: 12, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.959609).  Saving model ...
Epoch: 13 cost time: 5.763387203216553
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 5.603583335876465
Epoch: 14, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.165 Vali Acc: 0.953 Test Loss: 0.165 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 5.352341413497925
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.181 Vali Acc: 0.958 Test Loss: 0.181 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 5.880978584289551
Epoch: 16, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
Validation loss decreased (-0.959609 --> -0.964483).  Saving model ...
Epoch: 17 cost time: 5.83551549911499
Epoch: 17, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.970751).  Saving model ...
Epoch: 18 cost time: 5.555820941925049
Epoch: 18, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 19 cost time: 5.135392189025879
Epoch: 19, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.125 Vali Acc: 0.971 Test Loss: 0.125 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.2850847244262695
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.014004230499268
Epoch: 21, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.146 Vali Acc: 0.962 Test Loss: 0.146 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.270372152328491
Epoch: 22, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.161 Vali Acc: 0.967 Test Loss: 0.161 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.351407051086426
Epoch: 23, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.0037431716918945
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.448819637298584
Epoch: 25, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.145 Vali Acc: 0.970 Test Loss: 0.145 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 6.124508857727051
Epoch: 26, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.959910869598389
Epoch: 27, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.180 Vali Acc: 0.964 Test Loss: 0.180 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.878277540206909
Epoch: 28, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.160 Vali Acc: 0.970 Test Loss: 0.160 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 250512
model size : 1.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.939013242721558
Epoch: 1, Steps: 89 | Train Loss: 1.635 Vali Loss: 0.597 Vali Acc: 0.864 Test Loss: 0.597 Test Acc: 0.864
Validation loss decreased (inf --> -0.864200).  Saving model ...
Epoch: 2 cost time: 5.14010214805603
Epoch: 2, Steps: 89 | Train Loss: 0.405 Vali Loss: 0.285 Vali Acc: 0.933 Test Loss: 0.285 Test Acc: 0.933
Validation loss decreased (-0.864200 --> -0.933145).  Saving model ...
Epoch: 3 cost time: 5.140448331832886
Epoch: 3, Steps: 89 | Train Loss: 0.200 Vali Loss: 0.181 Vali Acc: 0.954 Test Loss: 0.181 Test Acc: 0.954
Validation loss decreased (-0.933145 --> -0.954037).  Saving model ...
Epoch: 4 cost time: 5.5717244148254395
Epoch: 4, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
Validation loss decreased (-0.954037 --> -0.970054).  Saving model ...
Epoch: 5 cost time: 4.999398469924927
Epoch: 5, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.126 Vali Acc: 0.967 Test Loss: 0.126 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.2926411628723145
Epoch: 6, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.23298716545105
Epoch: 7, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.128 Vali Acc: 0.969 Test Loss: 0.128 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 5.036906719207764
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 5.298273324966431
Epoch: 9, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.155 Vali Acc: 0.955 Test Loss: 0.155 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 5.198566198348999
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 5.095641613006592
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.109 Vali Acc: 0.978 Test Loss: 0.109 Test Acc: 0.978
Validation loss decreased (-0.971447 --> -0.977715).  Saving model ...
Epoch: 12 cost time: 4.814132452011108
Epoch: 12, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.123 Vali Acc: 0.973 Test Loss: 0.123 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.029128313064575
Epoch: 13, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.107 Vali Acc: 0.974 Test Loss: 0.107 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.062074422836304
Epoch: 14, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.964 Test Loss: 0.136 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.420621871948242
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.906784772872925
Epoch: 16, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.60964298248291
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.118 Vali Acc: 0.975 Test Loss: 0.118 Test Acc: 0.975
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 5.214859247207642
Epoch: 18, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.150 Vali Acc: 0.973 Test Loss: 0.150 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 5.195096015930176
Epoch: 19, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.142 Vali Acc: 0.974 Test Loss: 0.142 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.835188150405884
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.130 Vali Acc: 0.975 Test Loss: 0.130 Test Acc: 0.975
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.245290517807007
Epoch: 21, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.971 Test Loss: 0.170 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 184976
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.980510950088501
Epoch: 1, Steps: 89 | Train Loss: 1.656 Vali Loss: 0.609 Vali Acc: 0.863 Test Loss: 0.609 Test Acc: 0.863
Validation loss decreased (inf --> -0.862807).  Saving model ...
Epoch: 2 cost time: 4.991358995437622
Epoch: 2, Steps: 89 | Train Loss: 0.415 Vali Loss: 0.296 Vali Acc: 0.932 Test Loss: 0.296 Test Acc: 0.932
Validation loss decreased (-0.862807 --> -0.932448).  Saving model ...
Epoch: 3 cost time: 4.876420974731445
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
Validation loss decreased (-0.932448 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 4.976272821426392
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.146 Vali Acc: 0.967 Test Loss: 0.146 Test Acc: 0.967
Validation loss decreased (-0.952644 --> -0.966572).  Saving model ...
Epoch: 5 cost time: 4.607068777084351
Epoch: 5, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
Validation loss decreased (-0.966572 --> -0.967965).  Saving model ...
Epoch: 6 cost time: 4.8820273876190186
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.132 Vali Acc: 0.964 Test Loss: 0.132 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.793439149856567
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.343382358551025
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.121 Vali Acc: 0.967 Test Loss: 0.121 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.725946664810181
Epoch: 9, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.180 Vali Acc: 0.946 Test Loss: 0.180 Test Acc: 0.946
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 5.515818357467651
Epoch: 10, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.142 Vali Acc: 0.966 Test Loss: 0.142 Test Acc: 0.966
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 5.19618034362793
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 12 cost time: 5.28548264503479
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.740355014801025
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.116 Vali Acc: 0.968 Test Loss: 0.116 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 5.249298810958862
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.260331630706787
Epoch: 15, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 5.331938028335571
Epoch: 16, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.152 Vali Acc: 0.967 Test Loss: 0.152 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 4.646461725234985
Epoch: 17, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.139 Vali Acc: 0.971 Test Loss: 0.139 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.971447).  Saving model ...
Epoch: 18 cost time: 4.730800151824951
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.969 Test Loss: 0.184 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.634183645248413
Epoch: 19, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.706230401992798
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
Validation loss decreased (-0.971447 --> -0.972840).  Saving model ...
Epoch: 21 cost time: 5.1122050285339355
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.144 Vali Acc: 0.977 Test Loss: 0.144 Test Acc: 0.977
Validation loss decreased (-0.972840 --> -0.977018).  Saving model ...
Epoch: 22 cost time: 4.751355409622192
Epoch: 22, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.962 Test Loss: 0.212 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.8837504386901855
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.171 Vali Acc: 0.967 Test Loss: 0.171 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.864527940750122
Epoch: 24, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.146 Vali Acc: 0.975 Test Loss: 0.146 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.467727899551392
Epoch: 25, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.565345287322998
Epoch: 26, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.969 Test Loss: 0.167 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 5.3713438510894775
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.166 Vali Acc: 0.976 Test Loss: 0.166 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.081796646118164
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.181 Vali Acc: 0.967 Test Loss: 0.181 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 5.189106464385986
Epoch: 29, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.964 Test Loss: 0.226 Test Acc: 0.964
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 5.0549726486206055
Epoch: 30, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.963 Test Loss: 0.221 Test Acc: 0.963
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 4.5090272426605225
Epoch: 31, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.235 Vali Acc: 0.962 Test Loss: 0.235 Test Acc: 0.962
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9770194986072424
model parameter : 184976
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.426638126373291
Epoch: 1, Steps: 89 | Train Loss: 1.716 Vali Loss: 0.645 Vali Acc: 0.869 Test Loss: 0.645 Test Acc: 0.869
Validation loss decreased (inf --> -0.869074).  Saving model ...
Epoch: 2 cost time: 5.167556524276733
Epoch: 2, Steps: 89 | Train Loss: 0.434 Vali Loss: 0.316 Vali Acc: 0.920 Test Loss: 0.316 Test Acc: 0.920
Validation loss decreased (-0.869074 --> -0.919913).  Saving model ...
Epoch: 3 cost time: 5.037902116775513
Epoch: 3, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.919913 --> -0.947770).  Saving model ...
Epoch: 4 cost time: 4.901468276977539
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.160 Vali Acc: 0.963 Test Loss: 0.160 Test Acc: 0.963
Validation loss decreased (-0.947770 --> -0.963090).  Saving model ...
Epoch: 5 cost time: 5.081047058105469
Epoch: 5, Steps: 89 | Train Loss: 0.107 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.410433769226074
Epoch: 6, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 5.228778123855591
Epoch: 7, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
Validation loss decreased (-0.963090 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 4.892076730728149
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.28243088722229
Epoch: 9, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.145 Vali Acc: 0.958 Test Loss: 0.145 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 4.704004764556885
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.137 Vali Acc: 0.963 Test Loss: 0.137 Test Acc: 0.963
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 4.769858360290527
Epoch: 11, Steps: 89 | Train Loss: 0.052 Vali Loss: 0.155 Vali Acc: 0.960 Test Loss: 0.155 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 5.796288967132568
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.121 Vali Acc: 0.972 Test Loss: 0.121 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 4.950855731964111
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.126 Vali Acc: 0.972 Test Loss: 0.126 Test Acc: 0.972
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 5.043476819992065
Epoch: 14, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.132 Vali Acc: 0.969 Test Loss: 0.132 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 4.959880352020264
Epoch: 15, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.172 Vali Acc: 0.957 Test Loss: 0.172 Test Acc: 0.957
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 5.104126453399658
Epoch: 16, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.147 Vali Acc: 0.968 Test Loss: 0.147 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 4.976566314697266
Epoch: 17, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.135 Vali Acc: 0.974 Test Loss: 0.135 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.973536).  Saving model ...
Epoch: 18 cost time: 5.188136100769043
Epoch: 18, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.192 Vali Acc: 0.958 Test Loss: 0.192 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.079020261764526
Epoch: 19, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.163 Vali Acc: 0.968 Test Loss: 0.163 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.093701362609863
Epoch: 20, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.835386276245117
Epoch: 21, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.127 Vali Acc: 0.973 Test Loss: 0.127 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.6434595584869385
Epoch: 22, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.971 Test Loss: 0.147 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.680893659591675
Epoch: 23, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.130 Vali Acc: 0.973 Test Loss: 0.130 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.084001541137695
Epoch: 24, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.954 Test Loss: 0.177 Test Acc: 0.954
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 5.441092252731323
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.971 Test Loss: 0.130 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 5.563580274581909
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.971 Test Loss: 0.156 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.20069694519043
Epoch: 27, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.176 Vali Acc: 0.971 Test Loss: 0.176 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 184976
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.557418346405029
Epoch: 1, Steps: 89 | Train Loss: 1.917 Vali Loss: 0.846 Vali Acc: 0.839 Test Loss: 0.846 Test Acc: 0.839
Validation loss decreased (inf --> -0.839128).  Saving model ...
Epoch: 2 cost time: 5.195662260055542
Epoch: 2, Steps: 89 | Train Loss: 0.527 Vali Loss: 0.390 Vali Acc: 0.910 Test Loss: 0.390 Test Acc: 0.910
Validation loss decreased (-0.839128 --> -0.910163).  Saving model ...
Epoch: 3 cost time: 4.58282732963562
Epoch: 3, Steps: 89 | Train Loss: 0.270 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
Validation loss decreased (-0.910163 --> -0.918521).  Saving model ...
Epoch: 4 cost time: 4.699621915817261
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.231 Vali Acc: 0.938 Test Loss: 0.231 Test Acc: 0.938
Validation loss decreased (-0.918521 --> -0.938020).  Saving model ...
Epoch: 5 cost time: 4.907368421554565
Epoch: 5, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.938020 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 4.969285249710083
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.948466 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 5.0706400871276855
Epoch: 7, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 4.8907530307769775
Epoch: 8, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.152 Vali Acc: 0.961 Test Loss: 0.152 Test Acc: 0.961
Validation loss decreased (-0.957519 --> -0.961001).  Saving model ...
Epoch: 9 cost time: 4.484468936920166
Epoch: 9, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.158 Vali Acc: 0.951 Test Loss: 0.158 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.824795484542847
Epoch: 10, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 11 cost time: 5.4423582553863525
Epoch: 11, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.151 Vali Acc: 0.955 Test Loss: 0.151 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.3926239013671875
Epoch: 12, Steps: 89 | Train Loss: 0.072 Vali Loss: 0.157 Vali Acc: 0.958 Test Loss: 0.157 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.091514825820923
Epoch: 13, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.154 Vali Acc: 0.955 Test Loss: 0.154 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 5.175687313079834
Epoch: 14, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.003373861312866
Epoch: 15, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.139 Vali Acc: 0.965 Test Loss: 0.139 Test Acc: 0.965
Validation loss decreased (-0.961698 --> -0.965180).  Saving model ...
Epoch: 16 cost time: 5.139596223831177
Epoch: 16, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.170 Vali Acc: 0.960 Test Loss: 0.170 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.210537433624268
Epoch: 17, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.133 Vali Acc: 0.966 Test Loss: 0.133 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 18 cost time: 4.651572942733765
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.929368019104004
Epoch: 19, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.161 Vali Acc: 0.964 Test Loss: 0.161 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.992945671081543
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.136 Vali Acc: 0.966 Test Loss: 0.136 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 4.345298528671265
Epoch: 21, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 4.720839262008667
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.143 Vali Acc: 0.964 Test Loss: 0.143 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.64030909538269
Epoch: 23, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.967269).  Saving model ...
Epoch: 24 cost time: 4.725615978240967
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.144 Vali Acc: 0.969 Test Loss: 0.144 Test Acc: 0.969
Validation loss decreased (-0.967269 --> -0.969358).  Saving model ...
Epoch: 25 cost time: 4.935305118560791
Epoch: 25, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.148 Vali Acc: 0.966 Test Loss: 0.148 Test Acc: 0.966
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 5.221860885620117
Epoch: 26, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.138 Vali Acc: 0.971 Test Loss: 0.138 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.970751).  Saving model ...
Epoch: 27 cost time: 5.367976903915405
Epoch: 27, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.137 Vali Acc: 0.971 Test Loss: 0.137 Test Acc: 0.971
Validation loss decreased (-0.970751 --> -0.970751).  Saving model ...
Epoch: 28 cost time: 5.597108602523804
Epoch: 28, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 5.564293384552002
Epoch: 29, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.966 Test Loss: 0.167 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 5.1900482177734375
Epoch: 30, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 5.751529216766357
Epoch: 31, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.250 Vali Acc: 0.947 Test Loss: 0.250 Test Acc: 0.947
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 5.1583497524261475
Epoch: 32, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 5.478677034378052
Epoch: 33, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.171 Vali Acc: 0.968 Test Loss: 0.171 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 5.1114654541015625
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.231 Vali Acc: 0.951 Test Loss: 0.231 Test Acc: 0.951
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 5.280426502227783
Epoch: 35, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.153 Vali Acc: 0.973 Test Loss: 0.153 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 36 cost time: 5.954065799713135
Epoch: 36, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.164 Vali Acc: 0.969 Test Loss: 0.164 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 5.3847174644470215
Epoch: 37, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.173 Vali Acc: 0.969 Test Loss: 0.173 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 5.368489980697632
Epoch: 38, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.969 Test Loss: 0.175 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 5.1078290939331055
Epoch: 39, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.170 Vali Acc: 0.967 Test Loss: 0.170 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 6.114744186401367
Epoch: 40, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.971 Test Loss: 0.161 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 6.5718674659729
Epoch: 41, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.336 Vali Acc: 0.942 Test Loss: 0.336 Test Acc: 0.942
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 5.8953516483306885
Epoch: 42, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.179 Vali Acc: 0.964 Test Loss: 0.179 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 6.444425582885742
Epoch: 43, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.966 Test Loss: 0.179 Test Acc: 0.966
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 5.972627878189087
Epoch: 44, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.965 Test Loss: 0.204 Test Acc: 0.965
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 5.394961595535278
Epoch: 45, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.969 Test Loss: 0.193 Test Acc: 0.969
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9728412256267409
model parameter : 184976
model size : 1.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.8541834354400635
Epoch: 1, Steps: 89 | Train Loss: 1.603 Vali Loss: 0.626 Vali Acc: 0.861 Test Loss: 0.626 Test Acc: 0.861
Validation loss decreased (inf --> -0.861414).  Saving model ...
Epoch: 2 cost time: 5.713292598724365
Epoch: 2, Steps: 89 | Train Loss: 0.402 Vali Loss: 0.343 Vali Acc: 0.905 Test Loss: 0.343 Test Acc: 0.905
Validation loss decreased (-0.861414 --> -0.904593).  Saving model ...
Epoch: 3 cost time: 5.5950164794921875
Epoch: 3, Steps: 89 | Train Loss: 0.215 Vali Loss: 0.191 Vali Acc: 0.951 Test Loss: 0.191 Test Acc: 0.951
Validation loss decreased (-0.904593 --> -0.951252).  Saving model ...
Epoch: 4 cost time: 4.679651975631714
Epoch: 4, Steps: 89 | Train Loss: 0.124 Vali Loss: 0.161 Vali Acc: 0.958 Test Loss: 0.161 Test Acc: 0.958
Validation loss decreased (-0.951252 --> -0.957519).  Saving model ...
Epoch: 5 cost time: 4.99257230758667
Epoch: 5, Steps: 89 | Train Loss: 0.096 Vali Loss: 0.144 Vali Acc: 0.962 Test Loss: 0.144 Test Acc: 0.962
Validation loss decreased (-0.957519 --> -0.961698).  Saving model ...
Epoch: 6 cost time: 5.073155403137207
Epoch: 6, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.123 Vali Acc: 0.964 Test Loss: 0.123 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.963787).  Saving model ...
Epoch: 7 cost time: 5.474531173706055
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.114 Vali Acc: 0.973 Test Loss: 0.114 Test Acc: 0.973
Validation loss decreased (-0.963787 --> -0.972840).  Saving model ...
Epoch: 8 cost time: 5.315556049346924
Epoch: 8, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.972840 --> -0.974233).  Saving model ...
Epoch: 9 cost time: 5.944192886352539
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.975626).  Saving model ...
Epoch: 10 cost time: 5.131707668304443
Epoch: 10, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.102 Vali Acc: 0.973 Test Loss: 0.102 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.95648980140686
Epoch: 11, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.119 Vali Acc: 0.974 Test Loss: 0.119 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.9133219718933105
Epoch: 12, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.145 Vali Acc: 0.965 Test Loss: 0.145 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.931742429733276
Epoch: 13, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 6.292263507843018
Epoch: 14, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.110 Vali Acc: 0.976 Test Loss: 0.110 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.2763378620147705
Epoch: 15, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.549607753753662
Epoch: 16, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.127 Vali Acc: 0.975 Test Loss: 0.127 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 5.175431728363037
Epoch: 17, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
Validation loss decreased (-0.975626 --> -0.976322).  Saving model ...
Epoch: 18 cost time: 5.62246036529541
Epoch: 18, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.117 Vali Acc: 0.977 Test Loss: 0.117 Test Acc: 0.977
Validation loss decreased (-0.976322 --> -0.977018).  Saving model ...
Epoch: 19 cost time: 5.6234705448150635
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.137 Vali Acc: 0.974 Test Loss: 0.137 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.419869899749756
Epoch: 20, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.128 Vali Acc: 0.982 Test Loss: 0.128 Test Acc: 0.982
Validation loss decreased (-0.977018 --> -0.981893).  Saving model ...
Epoch: 21 cost time: 5.102816581726074
Epoch: 21, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.130 Vali Acc: 0.974 Test Loss: 0.130 Test Acc: 0.974
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 6.020593881607056
Epoch: 22, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.143 Vali Acc: 0.976 Test Loss: 0.143 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 6.115952253341675
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.156 Vali Acc: 0.974 Test Loss: 0.156 Test Acc: 0.974
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.777628421783447
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.163 Vali Acc: 0.976 Test Loss: 0.163 Test Acc: 0.976
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 6.093165397644043
Epoch: 25, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.240 Vali Acc: 0.962 Test Loss: 0.240 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.713038682937622
Epoch: 26, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.971 Test Loss: 0.206 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 6.038495779037476
Epoch: 27, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.978 Test Loss: 0.173 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.555255651473999
Epoch: 28, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.188 Vali Acc: 0.971 Test Loss: 0.188 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.853022575378418
Epoch: 29, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.971 Test Loss: 0.197 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 5.583897590637207
Epoch: 30, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.972 Test Loss: 0.202 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 152208
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.2643351554870605
Epoch: 1, Steps: 89 | Train Loss: 1.633 Vali Loss: 0.640 Vali Acc: 0.862 Test Loss: 0.640 Test Acc: 0.862
Validation loss decreased (inf --> -0.862111).  Saving model ...
Epoch: 2 cost time: 5.451444387435913
Epoch: 2, Steps: 89 | Train Loss: 0.412 Vali Loss: 0.342 Vali Acc: 0.905 Test Loss: 0.342 Test Acc: 0.905
Validation loss decreased (-0.862111 --> -0.905289).  Saving model ...
Epoch: 3 cost time: 5.23426079750061
Epoch: 3, Steps: 89 | Train Loss: 0.219 Vali Loss: 0.204 Vali Acc: 0.953 Test Loss: 0.204 Test Acc: 0.953
Validation loss decreased (-0.905289 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 5.7508461475372314
Epoch: 4, Steps: 89 | Train Loss: 0.132 Vali Loss: 0.162 Vali Acc: 0.957 Test Loss: 0.162 Test Acc: 0.957
Validation loss decreased (-0.952644 --> -0.956823).  Saving model ...
Epoch: 5 cost time: 5.6102306842803955
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.956823 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 4.950449705123901
Epoch: 6, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.131 Vali Acc: 0.960 Test Loss: 0.131 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.2595555782318115
Epoch: 7, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.112 Vali Acc: 0.967 Test Loss: 0.112 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 5.683273553848267
Epoch: 8, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.119 Vali Acc: 0.969 Test Loss: 0.119 Test Acc: 0.969
Validation loss decreased (-0.966573 --> -0.969358).  Saving model ...
Epoch: 9 cost time: 5.570580720901489
Epoch: 9, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.111 Vali Acc: 0.971 Test Loss: 0.111 Test Acc: 0.971
Validation loss decreased (-0.969358 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 5.817804336547852
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.108 Vali Acc: 0.969 Test Loss: 0.108 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.005908966064453
Epoch: 11, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.712821960449219
Epoch: 12, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.117 Vali Acc: 0.971 Test Loss: 0.117 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.8526930809021
Epoch: 13, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.132 Vali Acc: 0.970 Test Loss: 0.132 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.734834909439087
Epoch: 14, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.957 Test Loss: 0.157 Test Acc: 0.957
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.892764091491699
Epoch: 15, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.116 Vali Acc: 0.972 Test Loss: 0.116 Test Acc: 0.972
Validation loss decreased (-0.971447 --> -0.972144).  Saving model ...
Epoch: 16 cost time: 5.358423233032227
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.906730651855469
Epoch: 17, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
Validation loss decreased (-0.972144 --> -0.977715).  Saving model ...
Epoch: 18 cost time: 4.970077753067017
Epoch: 18, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.156 Vali Acc: 0.967 Test Loss: 0.156 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.2526257038116455
Epoch: 19, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.160 Vali Acc: 0.972 Test Loss: 0.160 Test Acc: 0.972
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 5.229449987411499
Epoch: 20, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.147 Vali Acc: 0.973 Test Loss: 0.147 Test Acc: 0.973
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.725068092346191
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.140 Vali Acc: 0.974 Test Loss: 0.140 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.556382179260254
Epoch: 22, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 5.933565855026245
Epoch: 23, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.150 Vali Acc: 0.974 Test Loss: 0.150 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 5.76435399055481
Epoch: 24, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.136 Vali Acc: 0.975 Test Loss: 0.136 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 6.054542779922485
Epoch: 25, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.140 Vali Acc: 0.977 Test Loss: 0.140 Test Acc: 0.977
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.996228456497192
Epoch: 26, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.127 Vali Acc: 0.976 Test Loss: 0.127 Test Acc: 0.976
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.839692115783691
Epoch: 27, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.974 Test Loss: 0.162 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 152208
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.337501764297485
Epoch: 1, Steps: 89 | Train Loss: 1.711 Vali Loss: 0.673 Vali Acc: 0.868 Test Loss: 0.673 Test Acc: 0.868
Validation loss decreased (inf --> -0.867681).  Saving model ...
Epoch: 2 cost time: 5.128952980041504
Epoch: 2, Steps: 89 | Train Loss: 0.435 Vali Loss: 0.352 Vali Acc: 0.906 Test Loss: 0.352 Test Acc: 0.906
Validation loss decreased (-0.867681 --> -0.905985).  Saving model ...
Epoch: 3 cost time: 4.455171346664429
Epoch: 3, Steps: 89 | Train Loss: 0.227 Vali Loss: 0.207 Vali Acc: 0.953 Test Loss: 0.207 Test Acc: 0.953
Validation loss decreased (-0.905985 --> -0.953341).  Saving model ...
Epoch: 4 cost time: 4.831562280654907
Epoch: 4, Steps: 89 | Train Loss: 0.146 Vali Loss: 0.184 Vali Acc: 0.953 Test Loss: 0.184 Test Acc: 0.953
Validation loss decreased (-0.953341 --> -0.953341).  Saving model ...
Epoch: 5 cost time: 5.070493221282959
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.153 Vali Acc: 0.959 Test Loss: 0.153 Test Acc: 0.959
Validation loss decreased (-0.953341 --> -0.958912).  Saving model ...
Epoch: 6 cost time: 5.549602031707764
Epoch: 6, Steps: 89 | Train Loss: 0.087 Vali Loss: 0.134 Vali Acc: 0.962 Test Loss: 0.134 Test Acc: 0.962
Validation loss decreased (-0.958912 --> -0.962394).  Saving model ...
Epoch: 7 cost time: 5.184077739715576
Epoch: 7, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.132 Vali Acc: 0.966 Test Loss: 0.132 Test Acc: 0.966
Validation loss decreased (-0.962394 --> -0.965876).  Saving model ...
Epoch: 8 cost time: 4.818236589431763
Epoch: 8, Steps: 89 | Train Loss: 0.067 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.965876 --> -0.966572).  Saving model ...
Epoch: 9 cost time: 4.751539945602417
Epoch: 9, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.117 Vali Acc: 0.972 Test Loss: 0.117 Test Acc: 0.972
Validation loss decreased (-0.966572 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 5.765389680862427
Epoch: 10, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.116 Vali Acc: 0.971 Test Loss: 0.116 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.517496585845947
Epoch: 11, Steps: 89 | Train Loss: 0.047 Vali Loss: 0.125 Vali Acc: 0.969 Test Loss: 0.125 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.344617605209351
Epoch: 12, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.142 Vali Acc: 0.962 Test Loss: 0.142 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.143139600753784
Epoch: 13, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.131 Vali Acc: 0.970 Test Loss: 0.131 Test Acc: 0.970
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.582212448120117
Epoch: 14, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 5.6058337688446045
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.972144 --> -0.973536).  Saving model ...
Epoch: 16 cost time: 5.2110631465911865
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.130 Vali Acc: 0.969 Test Loss: 0.130 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 4.862545967102051
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.969 Test Loss: 0.137 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.583353519439697
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.656360626220703
Epoch: 19, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.175 Vali Acc: 0.962 Test Loss: 0.175 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.600860357284546
Epoch: 20, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.136 Vali Acc: 0.974 Test Loss: 0.136 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.974233).  Saving model ...
Epoch: 21 cost time: 5.282679319381714
Epoch: 21, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.241 Vali Acc: 0.949 Test Loss: 0.241 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 5.4411468505859375
Epoch: 22, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.178 Vali Acc: 0.967 Test Loss: 0.178 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.229448080062866
Epoch: 23, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.158 Vali Acc: 0.968 Test Loss: 0.158 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.341693162918091
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.968 Test Loss: 0.167 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 5.697165012359619
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.155 Vali Acc: 0.972 Test Loss: 0.155 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 6.200589179992676
Epoch: 26, Steps: 89 | Train Loss: 0.028 Vali Loss: 0.204 Vali Acc: 0.961 Test Loss: 0.204 Test Acc: 0.961
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 5.454646825790405
Epoch: 27, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.969 Test Loss: 0.185 Test Acc: 0.969
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 5.049565315246582
Epoch: 28, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.168 Vali Acc: 0.968 Test Loss: 0.168 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 4.948235988616943
Epoch: 29, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.955 Test Loss: 0.221 Test Acc: 0.955
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.737783908843994
Epoch: 30, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.181 Vali Acc: 0.970 Test Loss: 0.181 Test Acc: 0.970
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.974233983286908
model parameter : 152208
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.908018112182617
Epoch: 1, Steps: 89 | Train Loss: 1.946 Vali Loss: 0.876 Vali Acc: 0.845 Test Loss: 0.876 Test Acc: 0.845
Validation loss decreased (inf --> -0.844699).  Saving model ...
Epoch: 2 cost time: 5.446800231933594
Epoch: 2, Steps: 89 | Train Loss: 0.527 Vali Loss: 0.407 Vali Acc: 0.891 Test Loss: 0.407 Test Acc: 0.891
Validation loss decreased (-0.844699 --> -0.890664).  Saving model ...
Epoch: 3 cost time: 4.9715635776519775
Epoch: 3, Steps: 89 | Train Loss: 0.286 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.890664 --> -0.933145).  Saving model ...
Epoch: 4 cost time: 5.3519508838653564
Epoch: 4, Steps: 89 | Train Loss: 0.186 Vali Loss: 0.243 Vali Acc: 0.928 Test Loss: 0.243 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.513688087463379
Epoch: 5, Steps: 89 | Train Loss: 0.156 Vali Loss: 0.186 Vali Acc: 0.943 Test Loss: 0.186 Test Acc: 0.943
Validation loss decreased (-0.933145 --> -0.942895).  Saving model ...
Epoch: 6 cost time: 5.087845802307129
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.942895 --> -0.956126).  Saving model ...
Epoch: 7 cost time: 5.291939735412598
Epoch: 7, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.165 Vali Acc: 0.958 Test Loss: 0.165 Test Acc: 0.958
Validation loss decreased (-0.956126 --> -0.957519).  Saving model ...
Epoch: 8 cost time: 5.116215705871582
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.156 Vali Acc: 0.953 Test Loss: 0.156 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 4.819449186325073
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.159 Vali Acc: 0.951 Test Loss: 0.159 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.236315011978149
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.148 Vali Acc: 0.958 Test Loss: 0.148 Test Acc: 0.958
Validation loss decreased (-0.957519 --> -0.957519).  Saving model ...
Epoch: 11 cost time: 5.648835897445679
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.163 Vali Acc: 0.958 Test Loss: 0.163 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.790712118148804
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.164 Vali Acc: 0.951 Test Loss: 0.164 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.900386333465576
Epoch: 13, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.147 Vali Acc: 0.963 Test Loss: 0.147 Test Acc: 0.963
Validation loss decreased (-0.957519 --> -0.963090).  Saving model ...
Epoch: 14 cost time: 5.47420597076416
Epoch: 14, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.160 Vali Acc: 0.953 Test Loss: 0.160 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.694441795349121
Epoch: 15, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.141 Vali Acc: 0.961 Test Loss: 0.141 Test Acc: 0.961
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.944996118545532
Epoch: 16, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.147 Vali Acc: 0.964 Test Loss: 0.147 Test Acc: 0.964
Validation loss decreased (-0.963090 --> -0.964483).  Saving model ...
Epoch: 17 cost time: 5.599209785461426
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.169 Vali Acc: 0.962 Test Loss: 0.169 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.352931261062622
Epoch: 18, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.124 Vali Acc: 0.971 Test Loss: 0.124 Test Acc: 0.971
Validation loss decreased (-0.964483 --> -0.970751).  Saving model ...
Epoch: 19 cost time: 5.392022371292114
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.126 Vali Acc: 0.968 Test Loss: 0.126 Test Acc: 0.968
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.9337828159332275
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.149 Vali Acc: 0.969 Test Loss: 0.149 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.204270601272583
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.303832292556763
Epoch: 22, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.157 Vali Acc: 0.965 Test Loss: 0.157 Test Acc: 0.965
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 5.433820724487305
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.185 Vali Acc: 0.959 Test Loss: 0.185 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 5.566093683242798
Epoch: 24, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.142 Vali Acc: 0.970 Test Loss: 0.142 Test Acc: 0.970
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 5.435842514038086
Epoch: 25, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.187 Vali Acc: 0.957 Test Loss: 0.187 Test Acc: 0.957
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 5.799969434738159
Epoch: 26, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.157 Vali Acc: 0.968 Test Loss: 0.157 Test Acc: 0.968
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 5.546445369720459
Epoch: 27, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.143 Vali Acc: 0.968 Test Loss: 0.143 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 5.61551308631897
Epoch: 28, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.961 Test Loss: 0.201 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9707520891364902
model parameter : 152208
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.876979351043701
Epoch: 1, Steps: 89 | Train Loss: 1.610 Vali Loss: 0.607 Vali Acc: 0.876 Test Loss: 0.607 Test Acc: 0.876
Validation loss decreased (inf --> -0.876038).  Saving model ...
Epoch: 2 cost time: 4.589303493499756
Epoch: 2, Steps: 89 | Train Loss: 0.410 Vali Loss: 0.287 Vali Acc: 0.938 Test Loss: 0.287 Test Acc: 0.938
Validation loss decreased (-0.876038 --> -0.938019).  Saving model ...
Epoch: 3 cost time: 5.189466238021851
Epoch: 3, Steps: 89 | Train Loss: 0.204 Vali Loss: 0.211 Vali Acc: 0.946 Test Loss: 0.211 Test Acc: 0.946
Validation loss decreased (-0.938019 --> -0.946377).  Saving model ...
Epoch: 4 cost time: 4.728321075439453
Epoch: 4, Steps: 89 | Train Loss: 0.136 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 5.436105489730835
Epoch: 5, Steps: 89 | Train Loss: 0.090 Vali Loss: 0.137 Vali Acc: 0.964 Test Loss: 0.137 Test Acc: 0.964
Validation loss decreased (-0.946377 --> -0.964483).  Saving model ...
Epoch: 6 cost time: 5.228310823440552
Epoch: 6, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.134 Vali Acc: 0.965 Test Loss: 0.134 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 7 cost time: 5.23664927482605
Epoch: 7, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.123 Vali Acc: 0.967 Test Loss: 0.123 Test Acc: 0.967
Validation loss decreased (-0.965180 --> -0.967269).  Saving model ...
Epoch: 8 cost time: 5.094886302947998
Epoch: 8, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.112 Vali Acc: 0.971 Test Loss: 0.112 Test Acc: 0.971
Validation loss decreased (-0.967269 --> -0.970751).  Saving model ...
Epoch: 9 cost time: 5.222872018814087
Epoch: 9, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.111 Vali Acc: 0.973 Test Loss: 0.111 Test Acc: 0.973
Validation loss decreased (-0.970751 --> -0.972840).  Saving model ...
Epoch: 10 cost time: 5.3498899936676025
Epoch: 10, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.106 Vali Acc: 0.976 Test Loss: 0.106 Test Acc: 0.976
Validation loss decreased (-0.972840 --> -0.976322).  Saving model ...
Epoch: 11 cost time: 5.08516001701355
Epoch: 11, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 6.033294200897217
Epoch: 12, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.116 Vali Acc: 0.976 Test Loss: 0.116 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 5.6659095287323
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.124 Vali Acc: 0.975 Test Loss: 0.124 Test Acc: 0.975
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 6.077341794967651
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.132 Vali Acc: 0.974 Test Loss: 0.132 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 5.61506199836731
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.120 Vali Acc: 0.975 Test Loss: 0.120 Test Acc: 0.975
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 5.453125476837158
Epoch: 16, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
Validation loss decreased (-0.976322 --> -0.977715).  Saving model ...
Epoch: 17 cost time: 5.463502883911133
Epoch: 17, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.104 Vali Acc: 0.982 Test Loss: 0.104 Test Acc: 0.982
Validation loss decreased (-0.977715 --> -0.981893).  Saving model ...
Epoch: 18 cost time: 5.11429500579834
Epoch: 18, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.663381814956665
Epoch: 19, Steps: 89 | Train Loss: 0.014 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 4.740439176559448
Epoch: 20, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.134 Vali Acc: 0.970 Test Loss: 0.134 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 5.203387975692749
Epoch: 21, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 5.095337867736816
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 4.877547979354858
Epoch: 23, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.968 Test Loss: 0.212 Test Acc: 0.968
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 4.512579917907715
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.179 Vali Acc: 0.963 Test Loss: 0.179 Test Acc: 0.963
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 4.802673816680908
Epoch: 25, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.974 Test Loss: 0.169 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 4.985050439834595
Epoch: 26, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.133 Vali Acc: 0.981 Test Loss: 0.133 Test Acc: 0.981
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 5.4265031814575195
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.154 Vali Acc: 0.979 Test Loss: 0.154 Test Acc: 0.979
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9818941504178273
model parameter : 135824
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.898181915283203
Epoch: 1, Steps: 89 | Train Loss: 1.641 Vali Loss: 0.621 Vali Acc: 0.877 Test Loss: 0.621 Test Acc: 0.877
Validation loss decreased (inf --> -0.877431).  Saving model ...
Epoch: 2 cost time: 5.023751974105835
Epoch: 2, Steps: 89 | Train Loss: 0.420 Vali Loss: 0.295 Vali Acc: 0.937 Test Loss: 0.295 Test Acc: 0.937
Validation loss decreased (-0.877431 --> -0.937323).  Saving model ...
Epoch: 3 cost time: 5.783891201019287
Epoch: 3, Steps: 89 | Train Loss: 0.210 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937323 --> -0.937324).  Saving model ...
Epoch: 4 cost time: 5.637737512588501
Epoch: 4, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.230 Vali Acc: 0.939 Test Loss: 0.230 Test Acc: 0.939
Validation loss decreased (-0.937324 --> -0.939413).  Saving model ...
Epoch: 5 cost time: 5.0885560512542725
Epoch: 5, Steps: 89 | Train Loss: 0.098 Vali Loss: 0.148 Vali Acc: 0.965 Test Loss: 0.148 Test Acc: 0.965
Validation loss decreased (-0.939413 --> -0.965180).  Saving model ...
Epoch: 6 cost time: 5.262891530990601
Epoch: 6, Steps: 89 | Train Loss: 0.086 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.504977226257324
Epoch: 7, Steps: 89 | Train Loss: 0.061 Vali Loss: 0.144 Vali Acc: 0.964 Test Loss: 0.144 Test Acc: 0.964
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.333548069000244
Epoch: 8, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.130 Vali Acc: 0.965 Test Loss: 0.130 Test Acc: 0.965
Validation loss decreased (-0.965180 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 5.299011945724487
Epoch: 9, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.114 Vali Acc: 0.971 Test Loss: 0.114 Test Acc: 0.971
Validation loss decreased (-0.965180 --> -0.971447).  Saving model ...
Epoch: 10 cost time: 4.867584943771362
Epoch: 10, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.140 Vali Acc: 0.964 Test Loss: 0.140 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.73894476890564
Epoch: 11, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.144 Vali Acc: 0.960 Test Loss: 0.144 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.5810606479644775
Epoch: 12, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.199 Vali Acc: 0.953 Test Loss: 0.199 Test Acc: 0.953
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.117239713668823
Epoch: 13, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.807273864746094
Epoch: 14, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.120 Vali Acc: 0.974 Test Loss: 0.120 Test Acc: 0.974
Validation loss decreased (-0.971447 --> -0.973536).  Saving model ...
Epoch: 15 cost time: 5.899597406387329
Epoch: 15, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.176 Vali Acc: 0.951 Test Loss: 0.176 Test Acc: 0.951
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.603041410446167
Epoch: 16, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.127 Vali Acc: 0.970 Test Loss: 0.127 Test Acc: 0.970
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.758225917816162
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.104 Vali Acc: 0.976 Test Loss: 0.104 Test Acc: 0.976
Validation loss decreased (-0.973536 --> -0.975626).  Saving model ...
Epoch: 18 cost time: 5.450116157531738
Epoch: 18, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.116 Vali Acc: 0.973 Test Loss: 0.116 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.780068635940552
Epoch: 19, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.104 Vali Acc: 0.978 Test Loss: 0.104 Test Acc: 0.978
Validation loss decreased (-0.975626 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 5.543690204620361
Epoch: 20, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.115 Vali Acc: 0.971 Test Loss: 0.115 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.207176923751831
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.116 Vali Acc: 0.974 Test Loss: 0.116 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.394522666931152
Epoch: 22, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.147 Vali Acc: 0.970 Test Loss: 0.147 Test Acc: 0.970
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 5.624711751937866
Epoch: 23, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.159 Vali Acc: 0.968 Test Loss: 0.159 Test Acc: 0.968
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.477545261383057
Epoch: 24, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.114 Vali Acc: 0.978 Test Loss: 0.114 Test Acc: 0.978
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 5.000259876251221
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.150 Vali Acc: 0.967 Test Loss: 0.150 Test Acc: 0.967
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 5.105069160461426
Epoch: 26, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.140 Vali Acc: 0.973 Test Loss: 0.140 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.4773008823394775
Epoch: 27, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.129 Vali Acc: 0.975 Test Loss: 0.129 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 5.318819284439087
Epoch: 28, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.971 Test Loss: 0.211 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 5.200218677520752
Epoch: 29, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.252 Vali Acc: 0.954 Test Loss: 0.252 Test Acc: 0.954
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 135824
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.852787256240845
Epoch: 1, Steps: 89 | Train Loss: 1.717 Vali Loss: 0.664 Vali Acc: 0.870 Test Loss: 0.664 Test Acc: 0.870
Validation loss decreased (inf --> -0.869771).  Saving model ...
Epoch: 2 cost time: 5.561772346496582
Epoch: 2, Steps: 89 | Train Loss: 0.442 Vali Loss: 0.317 Vali Acc: 0.932 Test Loss: 0.317 Test Acc: 0.932
Validation loss decreased (-0.869771 --> -0.931752).  Saving model ...
Epoch: 3 cost time: 5.620778322219849
Epoch: 3, Steps: 89 | Train Loss: 0.230 Vali Loss: 0.258 Vali Acc: 0.928 Test Loss: 0.258 Test Acc: 0.928
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 5.408155202865601
Epoch: 4, Steps: 89 | Train Loss: 0.154 Vali Loss: 0.228 Vali Acc: 0.932 Test Loss: 0.228 Test Acc: 0.932
Validation loss decreased (-0.931752 --> -0.932449).  Saving model ...
Epoch: 5 cost time: 5.44724440574646
Epoch: 5, Steps: 89 | Train Loss: 0.116 Vali Loss: 0.158 Vali Acc: 0.963 Test Loss: 0.158 Test Acc: 0.963
Validation loss decreased (-0.932449 --> -0.963090).  Saving model ...
Epoch: 6 cost time: 5.454632520675659
Epoch: 6, Steps: 89 | Train Loss: 0.095 Vali Loss: 0.163 Vali Acc: 0.954 Test Loss: 0.163 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.207347393035889
Epoch: 7, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.152 Vali Acc: 0.960 Test Loss: 0.152 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.027264356613159
Epoch: 8, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.136 Vali Acc: 0.965 Test Loss: 0.136 Test Acc: 0.965
Validation loss decreased (-0.963090 --> -0.965180).  Saving model ...
Epoch: 9 cost time: 4.649231195449829
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
Validation loss decreased (-0.965180 --> -0.967965).  Saving model ...
Epoch: 10 cost time: 4.97226357460022
Epoch: 10, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.168 Vali Acc: 0.955 Test Loss: 0.168 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.462229490280151
Epoch: 11, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.137 Vali Acc: 0.962 Test Loss: 0.137 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.2317469120025635
Epoch: 12, Steps: 89 | Train Loss: 0.050 Vali Loss: 0.155 Vali Acc: 0.959 Test Loss: 0.155 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.187774181365967
Epoch: 13, Steps: 89 | Train Loss: 0.042 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.967965 --> -0.967965).  Saving model ...
Epoch: 14 cost time: 4.872101545333862
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.139 Vali Acc: 0.967 Test Loss: 0.139 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.3562915325164795
Epoch: 15, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.177 Vali Acc: 0.951 Test Loss: 0.177 Test Acc: 0.951
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.424222230911255
Epoch: 16, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.155 Vali Acc: 0.958 Test Loss: 0.155 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 5.534613609313965
Epoch: 17, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
Validation loss decreased (-0.967965 --> -0.968662).  Saving model ...
Epoch: 18 cost time: 4.899886131286621
Epoch: 18, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 5.51258397102356
Epoch: 19, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.968662 --> -0.974233).  Saving model ...
Epoch: 20 cost time: 5.458966970443726
Epoch: 20, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 5.22832989692688
Epoch: 21, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.974233 --> -0.976322).  Saving model ...
Epoch: 22 cost time: 5.022592306137085
Epoch: 22, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.149 Vali Acc: 0.971 Test Loss: 0.149 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.633116960525513
Epoch: 23, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.168 Vali Acc: 0.971 Test Loss: 0.168 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 5.2925989627838135
Epoch: 24, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.152 Vali Acc: 0.964 Test Loss: 0.152 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 5.054084300994873
Epoch: 25, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.177 Vali Acc: 0.964 Test Loss: 0.177 Test Acc: 0.964
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 5.173930406570435
Epoch: 26, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.970 Test Loss: 0.159 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.923328399658203
Epoch: 27, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.959 Test Loss: 0.210 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 5.137296676635742
Epoch: 28, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.152 Vali Acc: 0.973 Test Loss: 0.152 Test Acc: 0.973
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 4.6583170890808105
Epoch: 29, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.171 Vali Acc: 0.971 Test Loss: 0.171 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 4.9074413776397705
Epoch: 30, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.972 Test Loss: 0.159 Test Acc: 0.972
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 5.523693561553955
Epoch: 31, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.270 Vali Acc: 0.947 Test Loss: 0.270 Test Acc: 0.947
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 135824
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.098589897155762
Epoch: 1, Steps: 89 | Train Loss: 1.921 Vali Loss: 0.866 Vali Acc: 0.852 Test Loss: 0.866 Test Acc: 0.852
Validation loss decreased (inf --> -0.851663).  Saving model ...
Epoch: 2 cost time: 5.370525121688843
Epoch: 2, Steps: 89 | Train Loss: 0.537 Vali Loss: 0.402 Vali Acc: 0.903 Test Loss: 0.402 Test Acc: 0.903
Validation loss decreased (-0.851663 --> -0.903199).  Saving model ...
Epoch: 3 cost time: 5.628760099411011
Epoch: 3, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.309 Vali Acc: 0.912 Test Loss: 0.309 Test Acc: 0.912
Validation loss decreased (-0.903199 --> -0.911557).  Saving model ...
Epoch: 4 cost time: 4.891367435455322
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.249 Vali Acc: 0.928 Test Loss: 0.249 Test Acc: 0.928
Validation loss decreased (-0.911557 --> -0.928270).  Saving model ...
Epoch: 5 cost time: 4.991231203079224
Epoch: 5, Steps: 89 | Train Loss: 0.140 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.928270 --> -0.948466).  Saving model ...
Epoch: 6 cost time: 5.337092399597168
Epoch: 6, Steps: 89 | Train Loss: 0.120 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.492711544036865
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.170 Vali Acc: 0.951 Test Loss: 0.170 Test Acc: 0.951
Validation loss decreased (-0.948466 --> -0.950555).  Saving model ...
Epoch: 8 cost time: 4.892298698425293
Epoch: 8, Steps: 89 | Train Loss: 0.094 Vali Loss: 0.160 Vali Acc: 0.949 Test Loss: 0.160 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.039130926132202
Epoch: 9, Steps: 89 | Train Loss: 0.066 Vali Loss: 0.147 Vali Acc: 0.961 Test Loss: 0.147 Test Acc: 0.961
Validation loss decreased (-0.950555 --> -0.961001).  Saving model ...
Epoch: 10 cost time: 4.375121355056763
Epoch: 10, Steps: 89 | Train Loss: 0.070 Vali Loss: 0.179 Vali Acc: 0.949 Test Loss: 0.179 Test Acc: 0.949
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.75950026512146
Epoch: 11, Steps: 89 | Train Loss: 0.065 Vali Loss: 0.139 Vali Acc: 0.964 Test Loss: 0.139 Test Acc: 0.964
Validation loss decreased (-0.961001 --> -0.963787).  Saving model ...
Epoch: 12 cost time: 5.0001678466796875
Epoch: 12, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.148 Vali Acc: 0.960 Test Loss: 0.148 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.685257434844971
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.189 Vali Acc: 0.953 Test Loss: 0.189 Test Acc: 0.953
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.726714372634888
Epoch: 14, Steps: 89 | Train Loss: 0.062 Vali Loss: 0.127 Vali Acc: 0.968 Test Loss: 0.127 Test Acc: 0.968
Validation loss decreased (-0.963787 --> -0.967965).  Saving model ...
Epoch: 15 cost time: 5.075752258300781
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 4.284016370773315
Epoch: 16, Steps: 89 | Train Loss: 0.044 Vali Loss: 0.148 Vali Acc: 0.962 Test Loss: 0.148 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 4.7915544509887695
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.132 Vali Acc: 0.968 Test Loss: 0.132 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.947541952133179
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.153 Vali Acc: 0.962 Test Loss: 0.153 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.33363938331604
Epoch: 19, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 4.875264406204224
Epoch: 20, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.151 Vali Acc: 0.962 Test Loss: 0.151 Test Acc: 0.962
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 4.298238754272461
Epoch: 21, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.3498618602752686
Epoch: 22, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.159 Vali Acc: 0.967 Test Loss: 0.159 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 4.536153316497803
Epoch: 23, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.150 Vali Acc: 0.964 Test Loss: 0.150 Test Acc: 0.964
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 5.2247161865234375
Epoch: 24, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.155 Vali Acc: 0.961 Test Loss: 0.155 Test Acc: 0.961
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.967966573816156
model parameter : 135824
model size : 1.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.089320182800293
Epoch: 1, Steps: 89 | Train Loss: 1.620 Vali Loss: 0.620 Vali Acc: 0.866 Test Loss: 0.620 Test Acc: 0.866
Validation loss decreased (inf --> -0.865593).  Saving model ...
Epoch: 2 cost time: 5.184149503707886
Epoch: 2, Steps: 89 | Train Loss: 0.411 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.865593 --> -0.918521).  Saving model ...
Epoch: 3 cost time: 5.182730197906494
Epoch: 3, Steps: 89 | Train Loss: 0.209 Vali Loss: 0.195 Vali Acc: 0.953 Test Loss: 0.195 Test Acc: 0.953
Validation loss decreased (-0.918521 --> -0.952644).  Saving model ...
Epoch: 4 cost time: 5.467369556427002
Epoch: 4, Steps: 89 | Train Loss: 0.133 Vali Loss: 0.160 Vali Acc: 0.955 Test Loss: 0.160 Test Acc: 0.955
Validation loss decreased (-0.952644 --> -0.955430).  Saving model ...
Epoch: 5 cost time: 5.323657035827637
Epoch: 5, Steps: 89 | Train Loss: 0.085 Vali Loss: 0.123 Vali Acc: 0.976 Test Loss: 0.123 Test Acc: 0.976
Validation loss decreased (-0.955430 --> -0.975626).  Saving model ...
Epoch: 6 cost time: 5.487690210342407
Epoch: 6, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.121 Vali Acc: 0.973 Test Loss: 0.121 Test Acc: 0.973
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.111268043518066
Epoch: 7, Steps: 89 | Train Loss: 0.054 Vali Loss: 0.120 Vali Acc: 0.965 Test Loss: 0.120 Test Acc: 0.965
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.34434962272644
Epoch: 8, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.111 Vali Acc: 0.977 Test Loss: 0.111 Test Acc: 0.977
Validation loss decreased (-0.975626 --> -0.977018).  Saving model ...
Epoch: 9 cost time: 5.14141845703125
Epoch: 9, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.108 Vali Acc: 0.975 Test Loss: 0.108 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.840071678161621
Epoch: 10, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.113 Vali Acc: 0.976 Test Loss: 0.113 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 5.147874593734741
Epoch: 11, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.962 Test Loss: 0.167 Test Acc: 0.962
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 4.989346981048584
Epoch: 12, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.168 Vali Acc: 0.961 Test Loss: 0.168 Test Acc: 0.961
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 5.071890354156494
Epoch: 13, Steps: 89 | Train Loss: 0.026 Vali Loss: 0.118 Vali Acc: 0.978 Test Loss: 0.118 Test Acc: 0.978
Validation loss decreased (-0.977018 --> -0.977715).  Saving model ...
Epoch: 14 cost time: 5.162520408630371
Epoch: 14, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.975 Test Loss: 0.112 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.99146294593811
Epoch: 15, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.034706115722656
Epoch: 16, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.134 Vali Acc: 0.967 Test Loss: 0.134 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.1059229373931885
Epoch: 17, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.126 Vali Acc: 0.974 Test Loss: 0.126 Test Acc: 0.974
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.724858283996582
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.141 Vali Acc: 0.970 Test Loss: 0.141 Test Acc: 0.970
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.452263116836548
Epoch: 19, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.136 Vali Acc: 0.976 Test Loss: 0.136 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.082979440689087
Epoch: 20, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.116 Vali Acc: 0.981 Test Loss: 0.116 Test Acc: 0.981
Validation loss decreased (-0.977715 --> -0.981197).  Saving model ...
Epoch: 21 cost time: 5.220043420791626
Epoch: 21, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.111 Vali Acc: 0.978 Test Loss: 0.111 Test Acc: 0.978
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 4.643012285232544
Epoch: 22, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.123 Vali Acc: 0.978 Test Loss: 0.123 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 5.237438201904297
Epoch: 23, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.124 Vali Acc: 0.976 Test Loss: 0.124 Test Acc: 0.976
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 5.175591230392456
Epoch: 24, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.121 Vali Acc: 0.981 Test Loss: 0.121 Test Acc: 0.981
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 4.88033390045166
Epoch: 25, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.117 Vali Acc: 0.976 Test Loss: 0.117 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 5.034625053405762
Epoch: 26, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.138 Vali Acc: 0.974 Test Loss: 0.138 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 4.625687122344971
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.117 Vali Acc: 0.980 Test Loss: 0.117 Test Acc: 0.980
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 4.827920436859131
Epoch: 28, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.172 Vali Acc: 0.975 Test Loss: 0.172 Test Acc: 0.975
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 5.075824022293091
Epoch: 29, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.126 Vali Acc: 0.979 Test Loss: 0.126 Test Acc: 0.979
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 4.882774591445923
Epoch: 30, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.120 Vali Acc: 0.976 Test Loss: 0.120 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9811977715877437
model parameter : 127632
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.854875564575195
Epoch: 1, Steps: 89 | Train Loss: 1.638 Vali Loss: 0.628 Vali Acc: 0.864 Test Loss: 0.628 Test Acc: 0.864
Validation loss decreased (inf --> -0.864200).  Saving model ...
Epoch: 2 cost time: 4.883763551712036
Epoch: 2, Steps: 89 | Train Loss: 0.413 Vali Loss: 0.301 Vali Acc: 0.921 Test Loss: 0.301 Test Acc: 0.921
Validation loss decreased (-0.864200 --> -0.920610).  Saving model ...
Epoch: 3 cost time: 4.9398839473724365
Epoch: 3, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.200 Vali Acc: 0.958 Test Loss: 0.200 Test Acc: 0.958
Validation loss decreased (-0.920610 --> -0.957519).  Saving model ...
Epoch: 4 cost time: 5.475611209869385
Epoch: 4, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.167 Vali Acc: 0.954 Test Loss: 0.167 Test Acc: 0.954
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 4.611420631408691
Epoch: 5, Steps: 89 | Train Loss: 0.093 Vali Loss: 0.138 Vali Acc: 0.966 Test Loss: 0.138 Test Acc: 0.966
Validation loss decreased (-0.957519 --> -0.965876).  Saving model ...
Epoch: 6 cost time: 5.712996959686279
Epoch: 6, Steps: 89 | Train Loss: 0.075 Vali Loss: 0.144 Vali Acc: 0.958 Test Loss: 0.144 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.574582815170288
Epoch: 7, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.118 Vali Acc: 0.969 Test Loss: 0.118 Test Acc: 0.969
Validation loss decreased (-0.965876 --> -0.969358).  Saving model ...
Epoch: 8 cost time: 5.122169494628906
Epoch: 8, Steps: 89 | Train Loss: 0.055 Vali Loss: 0.127 Vali Acc: 0.969 Test Loss: 0.127 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.330166578292847
Epoch: 9, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.115 Vali Acc: 0.972 Test Loss: 0.115 Test Acc: 0.972
Validation loss decreased (-0.969358 --> -0.972144).  Saving model ...
Epoch: 10 cost time: 4.951399803161621
Epoch: 10, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.121 Vali Acc: 0.971 Test Loss: 0.121 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.495958566665649
Epoch: 11, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.134 Vali Acc: 0.968 Test Loss: 0.134 Test Acc: 0.968
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.185959339141846
Epoch: 12, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.190 Vali Acc: 0.955 Test Loss: 0.190 Test Acc: 0.955
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 5.1771299839019775
Epoch: 13, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.125 Vali Acc: 0.967 Test Loss: 0.125 Test Acc: 0.967
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 5.2454307079315186
Epoch: 14, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.112 Vali Acc: 0.976 Test Loss: 0.112 Test Acc: 0.976
Validation loss decreased (-0.972144 --> -0.976322).  Saving model ...
Epoch: 15 cost time: 5.058887720108032
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.106 Vali Acc: 0.975 Test Loss: 0.106 Test Acc: 0.975
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 5.208031892776489
Epoch: 16, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.114 Vali Acc: 0.974 Test Loss: 0.114 Test Acc: 0.974
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 5.2700111865997314
Epoch: 17, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.156 Vali Acc: 0.961 Test Loss: 0.156 Test Acc: 0.961
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 5.607693433761597
Epoch: 18, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.114 Vali Acc: 0.975 Test Loss: 0.114 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 5.5852556228637695
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.120 Vali Acc: 0.973 Test Loss: 0.120 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 5.060544967651367
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.134 Vali Acc: 0.971 Test Loss: 0.134 Test Acc: 0.971
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 5.436405420303345
Epoch: 21, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.116 Vali Acc: 0.975 Test Loss: 0.116 Test Acc: 0.975
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 5.2608373165130615
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.133 Vali Acc: 0.971 Test Loss: 0.133 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 5.276051998138428
Epoch: 23, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 4.9502246379852295
Epoch: 24, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.219 Vali Acc: 0.956 Test Loss: 0.219 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9763231197771588
model parameter : 127632
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.944532871246338
Epoch: 1, Steps: 89 | Train Loss: 1.707 Vali Loss: 0.669 Vali Acc: 0.873 Test Loss: 0.669 Test Acc: 0.873
Validation loss decreased (inf --> -0.873252).  Saving model ...
Epoch: 2 cost time: 4.844442367553711
Epoch: 2, Steps: 89 | Train Loss: 0.430 Vali Loss: 0.313 Vali Acc: 0.923 Test Loss: 0.313 Test Acc: 0.923
Validation loss decreased (-0.873252 --> -0.922699).  Saving model ...
Epoch: 3 cost time: 4.293125629425049
Epoch: 3, Steps: 89 | Train Loss: 0.218 Vali Loss: 0.213 Vali Acc: 0.945 Test Loss: 0.213 Test Acc: 0.945
Validation loss decreased (-0.922699 --> -0.944984).  Saving model ...
Epoch: 4 cost time: 4.675063848495483
Epoch: 4, Steps: 89 | Train Loss: 0.149 Vali Loss: 0.161 Vali Acc: 0.960 Test Loss: 0.161 Test Acc: 0.960
Validation loss decreased (-0.944984 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 4.597587823867798
Epoch: 5, Steps: 89 | Train Loss: 0.105 Vali Loss: 0.154 Vali Acc: 0.959 Test Loss: 0.154 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 5.398235082626343
Epoch: 6, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.130 Vali Acc: 0.967 Test Loss: 0.130 Test Acc: 0.967
Validation loss decreased (-0.959608 --> -0.966573).  Saving model ...
Epoch: 7 cost time: 5.428607940673828
Epoch: 7, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.128 Vali Acc: 0.967 Test Loss: 0.128 Test Acc: 0.967
Validation loss decreased (-0.966573 --> -0.966573).  Saving model ...
Epoch: 8 cost time: 5.184148550033569
Epoch: 8, Steps: 89 | Train Loss: 0.060 Vali Loss: 0.151 Vali Acc: 0.961 Test Loss: 0.151 Test Acc: 0.961
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.330807209014893
Epoch: 9, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 5.1886937618255615
Epoch: 10, Steps: 89 | Train Loss: 0.049 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
Validation loss decreased (-0.966573 --> -0.971447).  Saving model ...
Epoch: 11 cost time: 5.1774373054504395
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.166 Vali Acc: 0.960 Test Loss: 0.166 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.305434226989746
Epoch: 12, Steps: 89 | Train Loss: 0.051 Vali Loss: 0.178 Vali Acc: 0.958 Test Loss: 0.178 Test Acc: 0.958
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 4.699085474014282
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.118 Vali Acc: 0.971 Test Loss: 0.118 Test Acc: 0.971
Validation loss decreased (-0.971447 --> -0.971447).  Saving model ...
Epoch: 14 cost time: 5.0483784675598145
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.365557670593262
Epoch: 15, Steps: 89 | Train Loss: 0.036 Vali Loss: 0.121 Vali Acc: 0.976 Test Loss: 0.121 Test Acc: 0.976
Validation loss decreased (-0.971447 --> -0.975626).  Saving model ...
Epoch: 16 cost time: 4.852864027023315
Epoch: 16, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.135 Vali Acc: 0.972 Test Loss: 0.135 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 5.218513250350952
Epoch: 17, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.139 Vali Acc: 0.969 Test Loss: 0.139 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 5.066632509231567
Epoch: 18, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 5.18560528755188
Epoch: 19, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.146 Vali Acc: 0.973 Test Loss: 0.146 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 5.3747711181640625
Epoch: 20, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.130 Vali Acc: 0.976 Test Loss: 0.130 Test Acc: 0.976
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 5.484536170959473
Epoch: 21, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.138 Vali Acc: 0.973 Test Loss: 0.138 Test Acc: 0.973
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 5.728499174118042
Epoch: 22, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.162 Vali Acc: 0.966 Test Loss: 0.162 Test Acc: 0.966
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 5.385578870773315
Epoch: 23, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.150 Vali Acc: 0.971 Test Loss: 0.150 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 5.822655439376831
Epoch: 24, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.141 Vali Acc: 0.966 Test Loss: 0.141 Test Acc: 0.966
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 5.0625410079956055
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.130 Vali Acc: 0.968 Test Loss: 0.130 Test Acc: 0.968
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 127632
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.856633186340332
Epoch: 1, Steps: 89 | Train Loss: 1.907 Vali Loss: 0.876 Vali Acc: 0.848 Test Loss: 0.876 Test Acc: 0.848
Validation loss decreased (inf --> -0.848181).  Saving model ...
Epoch: 2 cost time: 5.395149230957031
Epoch: 2, Steps: 89 | Train Loss: 0.531 Vali Loss: 0.381 Vali Acc: 0.908 Test Loss: 0.381 Test Acc: 0.908
Validation loss decreased (-0.848181 --> -0.908074).  Saving model ...
Epoch: 3 cost time: 5.304450750350952
Epoch: 3, Steps: 89 | Train Loss: 0.272 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
Validation loss decreased (-0.908074 --> -0.922003).  Saving model ...
Epoch: 4 cost time: 5.489611387252808
Epoch: 4, Steps: 89 | Train Loss: 0.189 Vali Loss: 0.238 Vali Acc: 0.932 Test Loss: 0.238 Test Acc: 0.932
Validation loss decreased (-0.922003 --> -0.931752).  Saving model ...
Epoch: 5 cost time: 5.045647621154785
Epoch: 5, Steps: 89 | Train Loss: 0.145 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.931752 --> -0.937324).  Saving model ...
Epoch: 6 cost time: 5.340719223022461
Epoch: 6, Steps: 89 | Train Loss: 0.114 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.937324 --> -0.947770).  Saving model ...
Epoch: 7 cost time: 5.254351854324341
Epoch: 7, Steps: 89 | Train Loss: 0.101 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
Validation loss decreased (-0.947770 --> -0.958912).  Saving model ...
Epoch: 8 cost time: 5.353257894515991
Epoch: 8, Steps: 89 | Train Loss: 0.089 Vali Loss: 0.174 Vali Acc: 0.953 Test Loss: 0.174 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 5.204941272735596
Epoch: 9, Steps: 89 | Train Loss: 0.080 Vali Loss: 0.150 Vali Acc: 0.955 Test Loss: 0.150 Test Acc: 0.955
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 6.0278003215789795
Epoch: 10, Steps: 89 | Train Loss: 0.069 Vali Loss: 0.137 Vali Acc: 0.961 Test Loss: 0.137 Test Acc: 0.961
Validation loss decreased (-0.958912 --> -0.961001).  Saving model ...
Epoch: 11 cost time: 5.727407455444336
Epoch: 11, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.170 Vali Acc: 0.953 Test Loss: 0.170 Test Acc: 0.953
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 5.600764751434326
Epoch: 12, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.141 Vali Acc: 0.962 Test Loss: 0.141 Test Acc: 0.962
Validation loss decreased (-0.961001 --> -0.961698).  Saving model ...
Epoch: 13 cost time: 5.131699562072754
Epoch: 13, Steps: 89 | Train Loss: 0.048 Vali Loss: 0.149 Vali Acc: 0.964 Test Loss: 0.149 Test Acc: 0.964
Validation loss decreased (-0.961698 --> -0.964483).  Saving model ...
Epoch: 14 cost time: 5.609227180480957
Epoch: 14, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.169 Vali Acc: 0.955 Test Loss: 0.169 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.256739616394043
Epoch: 15, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.166715621948242
Epoch: 16, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.137 Vali Acc: 0.967 Test Loss: 0.137 Test Acc: 0.967
Validation loss decreased (-0.964483 --> -0.966572).  Saving model ...
Epoch: 17 cost time: 4.575135231018066
Epoch: 17, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.159 Vali Acc: 0.960 Test Loss: 0.159 Test Acc: 0.960
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 5.461955547332764
Epoch: 18, Steps: 89 | Train Loss: 0.033 Vali Loss: 0.153 Vali Acc: 0.967 Test Loss: 0.153 Test Acc: 0.967
Validation loss decreased (-0.966572 --> -0.967269).  Saving model ...
Epoch: 19 cost time: 5.353613376617432
Epoch: 19, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.158 Vali Acc: 0.962 Test Loss: 0.158 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 5.373289346694946
Epoch: 20, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.203 Vali Acc: 0.946 Test Loss: 0.203 Test Acc: 0.946
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 5.235715866088867
Epoch: 21, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.151 Vali Acc: 0.965 Test Loss: 0.151 Test Acc: 0.965
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 5.890068054199219
Epoch: 22, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.144 Vali Acc: 0.968 Test Loss: 0.144 Test Acc: 0.968
Validation loss decreased (-0.967269 --> -0.967965).  Saving model ...
Epoch: 23 cost time: 5.440048933029175
Epoch: 23, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.162 Vali Acc: 0.964 Test Loss: 0.162 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 5.309343338012695
Epoch: 24, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.960 Test Loss: 0.203 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 6.003037452697754
Epoch: 25, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.155 Vali Acc: 0.968 Test Loss: 0.155 Test Acc: 0.968
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 5.319135665893555
Epoch: 26, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.178 Vali Acc: 0.962 Test Loss: 0.178 Test Acc: 0.962
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 5.413859128952026
Epoch: 27, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
Validation loss decreased (-0.967965 --> -0.970751).  Saving model ...
Epoch: 28 cost time: 4.8697240352630615
Epoch: 28, Steps: 89 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.969 Test Loss: 0.159 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 4.500770092010498
Epoch: 29, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.146 Vali Acc: 0.976 Test Loss: 0.146 Test Acc: 0.976
Validation loss decreased (-0.970751 --> -0.975625).  Saving model ...
Epoch: 30 cost time: 4.65107274055481
Epoch: 30, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.206 Vali Acc: 0.958 Test Loss: 0.206 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 5.266603231430054
Epoch: 31, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.148 Vali Acc: 0.973 Test Loss: 0.148 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 4.83050012588501
Epoch: 32, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.954 Test Loss: 0.204 Test Acc: 0.954
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 5.071380853652954
Epoch: 33, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.246 Vali Acc: 0.952 Test Loss: 0.246 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 5.242937088012695
Epoch: 34, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.181 Vali Acc: 0.969 Test Loss: 0.181 Test Acc: 0.969
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 5.134816408157349
Epoch: 35, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.963 Test Loss: 0.209 Test Acc: 0.963
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 5.32165265083313
Epoch: 36, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.184 Vali Acc: 0.967 Test Loss: 0.184 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 5.615894317626953
Epoch: 37, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.967 Test Loss: 0.204 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 5.361121416091919
Epoch: 38, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.974 Test Loss: 0.168 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 5.243257761001587
Epoch: 39, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.973 Test Loss: 0.183 Test Acc: 0.973
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9756267409470752
model parameter : 127632
model size : 1.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.239009380340576
Epoch: 1, Steps: 89 | Train Loss: 1.615 Vali Loss: 0.615 Vali Acc: 0.858 Test Loss: 0.615 Test Acc: 0.858
Validation loss decreased (inf --> -0.857933).  Saving model ...
Epoch: 2 cost time: 5.025944948196411
Epoch: 2, Steps: 89 | Train Loss: 0.418 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.857933 --> -0.922003).  Saving model ...
Epoch: 3 cost time: 5.032882452011108
Epoch: 3, Steps: 89 | Train Loss: 0.214 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.922003 --> -0.951948).  Saving model ...
Epoch: 4 cost time: 4.574006795883179
Epoch: 4, Steps: 89 | Train Loss: 0.130 Vali Loss: 0.160 Vali Acc: 0.960 Test Loss: 0.160 Test Acc: 0.960
Validation loss decreased (-0.951948 --> -0.959608).  Saving model ...
Epoch: 5 cost time: 4.5215370655059814
Epoch: 5, Steps: 89 | Train Loss: 0.091 Vali Loss: 0.124 Vali Acc: 0.973 Test Loss: 0.124 Test Acc: 0.973
Validation loss decreased (-0.959608 --> -0.972840).  Saving model ...
Epoch: 6 cost time: 5.2526140213012695
Epoch: 6, Steps: 89 | Train Loss: 0.071 Vali Loss: 0.139 Vali Acc: 0.962 Test Loss: 0.139 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 5.296316862106323
Epoch: 7, Steps: 89 | Train Loss: 0.057 Vali Loss: 0.127 Vali Acc: 0.967 Test Loss: 0.127 Test Acc: 0.967
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.128947973251343
Epoch: 8, Steps: 89 | Train Loss: 0.053 Vali Loss: 0.123 Vali Acc: 0.975 Test Loss: 0.123 Test Acc: 0.975
Validation loss decreased (-0.972840 --> -0.974929).  Saving model ...
Epoch: 9 cost time: 4.766525745391846
Epoch: 9, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.103 Vali Acc: 0.977 Test Loss: 0.103 Test Acc: 0.977
Validation loss decreased (-0.974929 --> -0.977018).  Saving model ...
Epoch: 10 cost time: 4.989702463150024
Epoch: 10, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.129 Vali Acc: 0.967 Test Loss: 0.129 Test Acc: 0.967
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 5.483219146728516
Epoch: 11, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.104 Vali Acc: 0.975 Test Loss: 0.104 Test Acc: 0.975
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 5.55069637298584
Epoch: 12, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.102 Vali Acc: 0.980 Test Loss: 0.102 Test Acc: 0.980
Validation loss decreased (-0.977018 --> -0.979804).  Saving model ...
Epoch: 13 cost time: 5.404282093048096
Epoch: 13, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.099 Vali Acc: 0.981 Test Loss: 0.099 Test Acc: 0.981
Validation loss decreased (-0.979804 --> -0.980500).  Saving model ...
Epoch: 14 cost time: 4.59152364730835
Epoch: 14, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 5.186343193054199
Epoch: 15, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.110 Vali Acc: 0.978 Test Loss: 0.110 Test Acc: 0.978
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 5.224363088607788
Epoch: 16, Steps: 89 | Train Loss: 0.012 Vali Loss: 0.129 Vali Acc: 0.971 Test Loss: 0.129 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.303386211395264
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.121 Vali Acc: 0.975 Test Loss: 0.121 Test Acc: 0.975
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.779790639877319
Epoch: 18, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.131 Vali Acc: 0.973 Test Loss: 0.131 Test Acc: 0.973
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 5.0456602573394775
Epoch: 19, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.132 Vali Acc: 0.976 Test Loss: 0.132 Test Acc: 0.976
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 5.015366077423096
Epoch: 20, Steps: 89 | Train Loss: 0.010 Vali Loss: 0.121 Vali Acc: 0.978 Test Loss: 0.121 Test Acc: 0.978
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 5.312988758087158
Epoch: 21, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.126 Vali Acc: 0.978 Test Loss: 0.126 Test Acc: 0.978
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 5.097169637680054
Epoch: 22, Steps: 89 | Train Loss: 0.008 Vali Loss: 0.146 Vali Acc: 0.974 Test Loss: 0.146 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 5.024118900299072
Epoch: 23, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.150 Vali Acc: 0.976 Test Loss: 0.150 Test Acc: 0.976
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9805013927576601
model parameter : 123536
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.783843517303467
Epoch: 1, Steps: 89 | Train Loss: 1.644 Vali Loss: 0.631 Vali Acc: 0.860 Test Loss: 0.631 Test Acc: 0.860
Validation loss decreased (inf --> -0.860022).  Saving model ...
Epoch: 2 cost time: 5.0658299922943115
Epoch: 2, Steps: 89 | Train Loss: 0.423 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.860022 --> -0.918521).  Saving model ...
Epoch: 3 cost time: 5.418478488922119
Epoch: 3, Steps: 89 | Train Loss: 0.216 Vali Loss: 0.198 Vali Acc: 0.951 Test Loss: 0.198 Test Acc: 0.951
Validation loss decreased (-0.918521 --> -0.951251).  Saving model ...
Epoch: 4 cost time: 4.644699811935425
Epoch: 4, Steps: 89 | Train Loss: 0.139 Vali Loss: 0.163 Vali Acc: 0.961 Test Loss: 0.163 Test Acc: 0.961
Validation loss decreased (-0.951251 --> -0.961001).  Saving model ...
Epoch: 5 cost time: 5.022009611129761
Epoch: 5, Steps: 89 | Train Loss: 0.097 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
Validation loss decreased (-0.961001 --> -0.970751).  Saving model ...
Epoch: 6 cost time: 4.642178297042847
Epoch: 6, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.136 Vali Acc: 0.962 Test Loss: 0.136 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.698439359664917
Epoch: 7, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.143 Vali Acc: 0.960 Test Loss: 0.143 Test Acc: 0.960
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.937319278717041
Epoch: 8, Steps: 89 | Train Loss: 0.059 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.527738332748413
Epoch: 9, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.109 Vali Acc: 0.974 Test Loss: 0.109 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973537).  Saving model ...
Epoch: 10 cost time: 4.62153172492981
Epoch: 10, Steps: 89 | Train Loss: 0.043 Vali Loss: 0.129 Vali Acc: 0.969 Test Loss: 0.129 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 4.3796916007995605
Epoch: 11, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.106 Vali Acc: 0.973 Test Loss: 0.106 Test Acc: 0.973
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 4.75147008895874
Epoch: 12, Steps: 89 | Train Loss: 0.031 Vali Loss: 0.127 Vali Acc: 0.972 Test Loss: 0.127 Test Acc: 0.972
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 4.618404150009155
Epoch: 13, Steps: 89 | Train Loss: 0.025 Vali Loss: 0.120 Vali Acc: 0.969 Test Loss: 0.120 Test Acc: 0.969
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 4.445230960845947
Epoch: 14, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.119 Vali Acc: 0.971 Test Loss: 0.119 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 4.6255693435668945
Epoch: 15, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.118 Vali Acc: 0.974 Test Loss: 0.118 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 5.075074911117554
Epoch: 16, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.143 Vali Acc: 0.967 Test Loss: 0.143 Test Acc: 0.967
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 4.714423179626465
Epoch: 17, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.155 Vali Acc: 0.967 Test Loss: 0.155 Test Acc: 0.967
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 4.51120138168335
Epoch: 18, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.145 Vali Acc: 0.971 Test Loss: 0.145 Test Acc: 0.971
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 4.566761493682861
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.120 Vali Acc: 0.978 Test Loss: 0.120 Test Acc: 0.978
Validation loss decreased (-0.973537 --> -0.978411).  Saving model ...
Epoch: 20 cost time: 4.413753032684326
Epoch: 20, Steps: 89 | Train Loss: 0.020 Vali Loss: 0.173 Vali Acc: 0.964 Test Loss: 0.173 Test Acc: 0.964
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.871706485748291
Epoch: 21, Steps: 89 | Train Loss: 0.013 Vali Loss: 0.148 Vali Acc: 0.969 Test Loss: 0.148 Test Acc: 0.969
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 5.1207594871521
Epoch: 22, Steps: 89 | Train Loss: 0.018 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.437931299209595
Epoch: 23, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.118 Vali Acc: 0.977 Test Loss: 0.118 Test Acc: 0.977
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.925045490264893
Epoch: 24, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.972 Test Loss: 0.172 Test Acc: 0.972
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 4.741089820861816
Epoch: 25, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.974 Test Loss: 0.177 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 4.725031137466431
Epoch: 26, Steps: 89 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.971 Test Loss: 0.180 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 5.141977548599243
Epoch: 27, Steps: 89 | Train Loss: 0.029 Vali Loss: 0.158 Vali Acc: 0.976 Test Loss: 0.158 Test Acc: 0.976
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.384225606918335
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.158 Vali Acc: 0.973 Test Loss: 0.158 Test Acc: 0.973
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.8358073234558105
Epoch: 29, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.152 Vali Acc: 0.972 Test Loss: 0.152 Test Acc: 0.972
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9784122562674095
model parameter : 123536
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 7.106834173202515
Epoch: 1, Steps: 89 | Train Loss: 1.708 Vali Loss: 0.669 Vali Acc: 0.866 Test Loss: 0.669 Test Acc: 0.866
Validation loss decreased (inf --> -0.865592).  Saving model ...
Epoch: 2 cost time: 5.239034414291382
Epoch: 2, Steps: 89 | Train Loss: 0.442 Vali Loss: 0.322 Vali Acc: 0.919 Test Loss: 0.322 Test Acc: 0.919
Validation loss decreased (-0.865592 --> -0.918520).  Saving model ...
Epoch: 3 cost time: 4.848386526107788
Epoch: 3, Steps: 89 | Train Loss: 0.224 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.918520 --> -0.944288).  Saving model ...
Epoch: 4 cost time: 5.082095623016357
Epoch: 4, Steps: 89 | Train Loss: 0.152 Vali Loss: 0.163 Vali Acc: 0.964 Test Loss: 0.163 Test Acc: 0.964
Validation loss decreased (-0.944288 --> -0.964483).  Saving model ...
Epoch: 5 cost time: 5.299212217330933
Epoch: 5, Steps: 89 | Train Loss: 0.102 Vali Loss: 0.129 Vali Acc: 0.965 Test Loss: 0.129 Test Acc: 0.965
Validation loss decreased (-0.964483 --> -0.965180).  Saving model ...
Epoch: 6 cost time: 4.783495664596558
Epoch: 6, Steps: 89 | Train Loss: 0.081 Vali Loss: 0.150 Vali Acc: 0.958 Test Loss: 0.150 Test Acc: 0.958
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.952736139297485
Epoch: 7, Steps: 89 | Train Loss: 0.076 Vali Loss: 0.161 Vali Acc: 0.954 Test Loss: 0.161 Test Acc: 0.954
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 5.429994344711304
Epoch: 8, Steps: 89 | Train Loss: 0.073 Vali Loss: 0.140 Vali Acc: 0.966 Test Loss: 0.140 Test Acc: 0.966
Validation loss decreased (-0.965180 --> -0.965876).  Saving model ...
Epoch: 9 cost time: 4.7185423374176025
Epoch: 9, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.122 Vali Acc: 0.970 Test Loss: 0.122 Test Acc: 0.970
Validation loss decreased (-0.965876 --> -0.970054).  Saving model ...
Epoch: 10 cost time: 4.690369129180908
Epoch: 10, Steps: 89 | Train Loss: 0.045 Vali Loss: 0.120 Vali Acc: 0.971 Test Loss: 0.120 Test Acc: 0.971
Validation loss decreased (-0.970054 --> -0.970751).  Saving model ...
Epoch: 11 cost time: 4.964380741119385
Epoch: 11, Steps: 89 | Train Loss: 0.039 Vali Loss: 0.101 Vali Acc: 0.974 Test Loss: 0.101 Test Acc: 0.974
Validation loss decreased (-0.970751 --> -0.973537).  Saving model ...
Epoch: 12 cost time: 4.849499225616455
Epoch: 12, Steps: 89 | Train Loss: 0.058 Vali Loss: 0.140 Vali Acc: 0.962 Test Loss: 0.140 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 5.180574893951416
Epoch: 13, Steps: 89 | Train Loss: 0.041 Vali Loss: 0.122 Vali Acc: 0.971 Test Loss: 0.122 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 4.960156202316284
Epoch: 14, Steps: 89 | Train Loss: 0.038 Vali Loss: 0.148 Vali Acc: 0.967 Test Loss: 0.148 Test Acc: 0.967
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 5.184221267700195
Epoch: 15, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.134 Vali Acc: 0.973 Test Loss: 0.134 Test Acc: 0.973
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 4.890751123428345
Epoch: 16, Steps: 89 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.955 Test Loss: 0.185 Test Acc: 0.955
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 5.373059988021851
Epoch: 17, Steps: 89 | Train Loss: 0.030 Vali Loss: 0.155 Vali Acc: 0.964 Test Loss: 0.155 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.866683483123779
Epoch: 18, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.144 Vali Acc: 0.971 Test Loss: 0.144 Test Acc: 0.971
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.670474529266357
Epoch: 19, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.126 Vali Acc: 0.971 Test Loss: 0.126 Test Acc: 0.971
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 5.117945194244385
Epoch: 20, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.133 Vali Acc: 0.968 Test Loss: 0.133 Test Acc: 0.968
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 5.086608409881592
Epoch: 21, Steps: 89 | Train Loss: 0.016 Vali Loss: 0.141 Vali Acc: 0.971 Test Loss: 0.141 Test Acc: 0.971
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9735376044568245
model parameter : 123536
model size : 1.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_CharacterTrajectoriesModel:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/CharacterTrajectories
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

1422
1436
>>>>>>>start training : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
1422
1436
1436
Epoch: 1 cost time: 6.548484563827515
Epoch: 1, Steps: 89 | Train Loss: 1.928 Vali Loss: 0.871 Vali Acc: 0.836 Test Loss: 0.871 Test Acc: 0.836
Validation loss decreased (inf --> -0.835646).  Saving model ...
Epoch: 2 cost time: 5.22663688659668
Epoch: 2, Steps: 89 | Train Loss: 0.533 Vali Loss: 0.391 Vali Acc: 0.899 Test Loss: 0.391 Test Acc: 0.899
Validation loss decreased (-0.835646 --> -0.899021).  Saving model ...
Epoch: 3 cost time: 4.994833946228027
Epoch: 3, Steps: 89 | Train Loss: 0.280 Vali Loss: 0.279 Vali Acc: 0.932 Test Loss: 0.279 Test Acc: 0.932
Validation loss decreased (-0.899021 --> -0.931752).  Saving model ...
Epoch: 4 cost time: 4.557984113693237
Epoch: 4, Steps: 89 | Train Loss: 0.193 Vali Loss: 0.221 Vali Acc: 0.943 Test Loss: 0.221 Test Acc: 0.943
Validation loss decreased (-0.931752 --> -0.942895).  Saving model ...
Epoch: 5 cost time: 4.514732599258423
Epoch: 5, Steps: 89 | Train Loss: 0.134 Vali Loss: 0.174 Vali Acc: 0.955 Test Loss: 0.174 Test Acc: 0.955
Validation loss decreased (-0.942895 --> -0.955430).  Saving model ...
Epoch: 6 cost time: 4.587050676345825
Epoch: 6, Steps: 89 | Train Loss: 0.111 Vali Loss: 0.195 Vali Acc: 0.946 Test Loss: 0.195 Test Acc: 0.946
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.801254987716675
Epoch: 7, Steps: 89 | Train Loss: 0.110 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.8849196434021
Epoch: 8, Steps: 89 | Train Loss: 0.084 Vali Loss: 0.153 Vali Acc: 0.958 Test Loss: 0.153 Test Acc: 0.958
Validation loss decreased (-0.955430 --> -0.957519).  Saving model ...
Epoch: 9 cost time: 4.430044651031494
Epoch: 9, Steps: 89 | Train Loss: 0.074 Vali Loss: 0.158 Vali Acc: 0.955 Test Loss: 0.158 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.620260953903198
Epoch: 10, Steps: 89 | Train Loss: 0.063 Vali Loss: 0.152 Vali Acc: 0.957 Test Loss: 0.152 Test Acc: 0.957
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 4.58445930480957
Epoch: 11, Steps: 89 | Train Loss: 0.068 Vali Loss: 0.149 Vali Acc: 0.960 Test Loss: 0.149 Test Acc: 0.960
Validation loss decreased (-0.957519 --> -0.959609).  Saving model ...
Epoch: 12 cost time: 4.774229288101196
Epoch: 12, Steps: 89 | Train Loss: 0.056 Vali Loss: 0.165 Vali Acc: 0.955 Test Loss: 0.165 Test Acc: 0.955
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 4.7009735107421875
Epoch: 13, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.132 Vali Acc: 0.967 Test Loss: 0.132 Test Acc: 0.967
Validation loss decreased (-0.959609 --> -0.966572).  Saving model ...
Epoch: 14 cost time: 4.653021335601807
Epoch: 14, Steps: 89 | Train Loss: 0.037 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 4.82221245765686
Epoch: 15, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.149 Vali Acc: 0.966 Test Loss: 0.149 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.53191351890564
Epoch: 16, Steps: 89 | Train Loss: 0.032 Vali Loss: 0.157 Vali Acc: 0.960 Test Loss: 0.157 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 4.340936183929443
Epoch: 17, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.151 Vali Acc: 0.960 Test Loss: 0.151 Test Acc: 0.960
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 4.419970273971558
Epoch: 18, Steps: 89 | Train Loss: 0.040 Vali Loss: 0.146 Vali Acc: 0.964 Test Loss: 0.146 Test Acc: 0.964
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 4.891876697540283
Epoch: 19, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.145 Vali Acc: 0.964 Test Loss: 0.145 Test Acc: 0.964
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 4.784475803375244
Epoch: 20, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.157 Vali Acc: 0.962 Test Loss: 0.157 Test Acc: 0.962
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 4.611434698104858
Epoch: 21, Steps: 89 | Train Loss: 0.024 Vali Loss: 0.143 Vali Acc: 0.969 Test Loss: 0.143 Test Acc: 0.969
Validation loss decreased (-0.966572 --> -0.968662).  Saving model ...
Epoch: 22 cost time: 4.741174221038818
Epoch: 22, Steps: 89 | Train Loss: 0.017 Vali Loss: 0.156 Vali Acc: 0.962 Test Loss: 0.156 Test Acc: 0.962
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.849182367324829
Epoch: 23, Steps: 89 | Train Loss: 0.023 Vali Loss: 0.172 Vali Acc: 0.963 Test Loss: 0.172 Test Acc: 0.963
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.954179048538208
Epoch: 24, Steps: 89 | Train Loss: 0.034 Vali Loss: 0.183 Vali Acc: 0.960 Test Loss: 0.183 Test Acc: 0.960
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.572736024856567
Epoch: 25, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.159 Vali Acc: 0.963 Test Loss: 0.159 Test Acc: 0.963
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.651695728302002
Epoch: 26, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.168 Vali Acc: 0.962 Test Loss: 0.168 Test Acc: 0.962
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 4.823229074478149
Epoch: 27, Steps: 89 | Train Loss: 0.021 Vali Loss: 0.141 Vali Acc: 0.972 Test Loss: 0.141 Test Acc: 0.972
Validation loss decreased (-0.968662 --> -0.972143).  Saving model ...
Epoch: 28 cost time: 4.985264778137207
Epoch: 28, Steps: 89 | Train Loss: 0.027 Vali Loss: 0.127 Vali Acc: 0.974 Test Loss: 0.127 Test Acc: 0.974
Validation loss decreased (-0.972143 --> -0.973536).  Saving model ...
Epoch: 29 cost time: 4.6826324462890625
Epoch: 29, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.131 Vali Acc: 0.971 Test Loss: 0.131 Test Acc: 0.971
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 4.4610443115234375
Epoch: 30, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.127 Vali Acc: 0.971 Test Loss: 0.127 Test Acc: 0.971
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 4.931282997131348
Epoch: 31, Steps: 89 | Train Loss: 0.009 Vali Loss: 0.154 Vali Acc: 0.964 Test Loss: 0.154 Test Acc: 0.964
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 4.945497035980225
Epoch: 32, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.124 Vali Acc: 0.974 Test Loss: 0.124 Test Acc: 0.974
Validation loss decreased (-0.973536 --> -0.973536).  Saving model ...
Epoch: 33 cost time: 4.757996320724487
Epoch: 33, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.119 Vali Acc: 0.972 Test Loss: 0.119 Test Acc: 0.972
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 5.001480579376221
Epoch: 34, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.132 Vali Acc: 0.978 Test Loss: 0.132 Test Acc: 0.978
Validation loss decreased (-0.973536 --> -0.977715).  Saving model ...
Epoch: 35 cost time: 4.524545192718506
Epoch: 35, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.187 Vali Acc: 0.969 Test Loss: 0.187 Test Acc: 0.969
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 4.724296808242798
Epoch: 36, Steps: 89 | Train Loss: 0.035 Vali Loss: 0.213 Vali Acc: 0.966 Test Loss: 0.213 Test Acc: 0.966
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 4.371937274932861
Epoch: 37, Steps: 89 | Train Loss: 0.046 Vali Loss: 0.213 Vali Acc: 0.958 Test Loss: 0.213 Test Acc: 0.958
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 4.737188339233398
Epoch: 38, Steps: 89 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.966 Test Loss: 0.214 Test Acc: 0.966
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 4.603260278701782
Epoch: 39, Steps: 89 | Train Loss: 0.004 Vali Loss: 0.191 Vali Acc: 0.971 Test Loss: 0.191 Test Acc: 0.971
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 4.91709566116333
Epoch: 40, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.974 Test Loss: 0.174 Test Acc: 0.974
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 4.7297821044921875
Epoch: 41, Steps: 89 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.970 Test Loss: 0.190 Test Acc: 0.970
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 4.350643634796143
Epoch: 42, Steps: 89 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 4.401687145233154
Epoch: 43, Steps: 89 | Train Loss: 0.007 Vali Loss: 0.179 Vali Acc: 0.974 Test Loss: 0.179 Test Acc: 0.974
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 4.501604795455933
Epoch: 44, Steps: 89 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.974 Test Loss: 0.181 Test Acc: 0.974
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_CharacterTrajectories_ETSformer_UEA_ftM_sl182_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
1436
test shape: torch.Size([1436, 20]) torch.Size([1436, 1])
accuracy:0.9777158774373259
model parameter : 123536
model size : 1.09MB
