Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.237698316574097
Epoch: 1, Steps: 10 | Train Loss: 3.446 Vali Loss: 3.483 Vali Acc: 0.109 Test Loss: 3.483 Test Acc: 0.109
Validation loss decreased (inf --> -0.109377).  Saving model ...
Epoch: 2 cost time: 2.093801498413086
Epoch: 2, Steps: 10 | Train Loss: 2.130 Vali Loss: 3.568 Vali Acc: 0.209 Test Loss: 3.568 Test Acc: 0.209
Validation loss decreased (-0.109377 --> -0.209376).  Saving model ...
Epoch: 3 cost time: 2.0387353897094727
Epoch: 3, Steps: 10 | Train Loss: 0.908 Vali Loss: 4.033 Vali Acc: 0.260 Test Loss: 4.033 Test Acc: 0.260
Validation loss decreased (-0.209376 --> -0.259960).  Saving model ...
Epoch: 4 cost time: 2.1901986598968506
Epoch: 4, Steps: 10 | Train Loss: 0.379 Vali Loss: 4.723 Vali Acc: 0.268 Test Loss: 4.723 Test Acc: 0.268
Validation loss decreased (-0.259960 --> -0.268188).  Saving model ...
Epoch: 5 cost time: 2.0041275024414062
Epoch: 5, Steps: 10 | Train Loss: 0.150 Vali Loss: 4.964 Vali Acc: 0.291 Test Loss: 4.964 Test Acc: 0.291
Validation loss decreased (-0.268188 --> -0.290539).  Saving model ...
Epoch: 6 cost time: 2.3305954933166504
Epoch: 6, Steps: 10 | Train Loss: 0.148 Vali Loss: 5.402 Vali Acc: 0.295 Test Loss: 5.402 Test Acc: 0.295
Validation loss decreased (-0.290539 --> -0.295240).  Saving model ...
Epoch: 7 cost time: 2.3343164920806885
Epoch: 7, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.879 Vali Acc: 0.266 Test Loss: 5.879 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4107346534729004
Epoch: 8, Steps: 10 | Train Loss: 0.180 Vali Loss: 6.841 Vali Acc: 0.248 Test Loss: 6.841 Test Acc: 0.248
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.145570755004883
Epoch: 9, Steps: 10 | Train Loss: 0.140 Vali Loss: 6.690 Vali Acc: 0.292 Test Loss: 6.690 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9405314922332764
Epoch: 10, Steps: 10 | Train Loss: 0.071 Vali Loss: 7.074 Vali Acc: 0.301 Test Loss: 7.074 Test Acc: 0.301
Validation loss decreased (-0.295240 --> -0.301106).  Saving model ...
Epoch: 11 cost time: 2.3556652069091797
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 7.166 Vali Acc: 0.282 Test Loss: 7.166 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6861283779144287
Epoch: 12, Steps: 10 | Train Loss: 0.054 Vali Loss: 8.630 Vali Acc: 0.251 Test Loss: 8.630 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.097857713699341
Epoch: 13, Steps: 10 | Train Loss: 0.154 Vali Loss: 8.614 Vali Acc: 0.258 Test Loss: 8.614 Test Acc: 0.258
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.715303421020508
Epoch: 14, Steps: 10 | Train Loss: 0.112 Vali Loss: 8.792 Vali Acc: 0.259 Test Loss: 8.792 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.4889981746673584
Epoch: 15, Steps: 10 | Train Loss: 0.073 Vali Loss: 10.377 Vali Acc: 0.260 Test Loss: 10.377 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.420691728591919
Epoch: 16, Steps: 10 | Train Loss: 0.085 Vali Loss: 10.798 Vali Acc: 0.280 Test Loss: 10.798 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8975012302398682
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 11.184 Vali Acc: 0.265 Test Loss: 11.184 Test Acc: 0.265
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6594619750976562
Epoch: 18, Steps: 10 | Train Loss: 0.009 Vali Loss: 12.205 Vali Acc: 0.266 Test Loss: 12.205 Test Acc: 0.266
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.7682480812072754
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 13.047 Vali Acc: 0.247 Test Loss: 13.047 Test Acc: 0.247
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.681743621826172
Epoch: 20, Steps: 10 | Train Loss: 0.048 Vali Loss: 12.462 Vali Acc: 0.260 Test Loss: 12.462 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 7287378
model size : 37.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.326502799987793
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.458 Vali Acc: 0.106 Test Loss: 3.458 Test Acc: 0.106
Validation loss decreased (inf --> -0.105848).  Saving model ...
Epoch: 2 cost time: 2.572160005569458
Epoch: 2, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.512 Vali Acc: 0.218 Test Loss: 3.512 Test Acc: 0.218
Validation loss decreased (-0.105848 --> -0.217612).  Saving model ...
Epoch: 3 cost time: 2.778583526611328
Epoch: 3, Steps: 10 | Train Loss: 0.926 Vali Loss: 3.919 Vali Acc: 0.269 Test Loss: 3.919 Test Acc: 0.269
Validation loss decreased (-0.217612 --> -0.269373).  Saving model ...
Epoch: 4 cost time: 2.1065752506256104
Epoch: 4, Steps: 10 | Train Loss: 0.385 Vali Loss: 4.563 Vali Acc: 0.282 Test Loss: 4.563 Test Acc: 0.282
Validation loss decreased (-0.269373 --> -0.282307).  Saving model ...
Epoch: 5 cost time: 2.311835289001465
Epoch: 5, Steps: 10 | Train Loss: 0.154 Vali Loss: 4.756 Vali Acc: 0.292 Test Loss: 4.756 Test Acc: 0.292
Validation loss decreased (-0.282307 --> -0.291717).  Saving model ...
Epoch: 6 cost time: 2.7339816093444824
Epoch: 6, Steps: 10 | Train Loss: 0.137 Vali Loss: 5.223 Vali Acc: 0.299 Test Loss: 5.223 Test Acc: 0.299
Validation loss decreased (-0.291717 --> -0.298771).  Saving model ...
Epoch: 7 cost time: 2.2460062503814697
Epoch: 7, Steps: 10 | Train Loss: 0.090 Vali Loss: 5.655 Vali Acc: 0.273 Test Loss: 5.655 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.093024492263794
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 6.029 Vali Acc: 0.274 Test Loss: 6.029 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.702552080154419
Epoch: 9, Steps: 10 | Train Loss: 0.080 Vali Loss: 6.485 Vali Acc: 0.305 Test Loss: 6.485 Test Acc: 0.305
Validation loss decreased (-0.298771 --> -0.304641).  Saving model ...
Epoch: 10 cost time: 2.687617063522339
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 6.506 Vali Acc: 0.312 Test Loss: 6.506 Test Acc: 0.312
Validation loss decreased (-0.304641 --> -0.311700).  Saving model ...
Epoch: 11 cost time: 2.345243453979492
Epoch: 11, Steps: 10 | Train Loss: 0.127 Vali Loss: 7.110 Vali Acc: 0.292 Test Loss: 7.110 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3305530548095703
Epoch: 12, Steps: 10 | Train Loss: 0.226 Vali Loss: 7.434 Vali Acc: 0.269 Test Loss: 7.434 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1420037746429443
Epoch: 13, Steps: 10 | Train Loss: 0.076 Vali Loss: 7.692 Vali Acc: 0.291 Test Loss: 7.692 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4795289039611816
Epoch: 14, Steps: 10 | Train Loss: 0.079 Vali Loss: 8.476 Vali Acc: 0.284 Test Loss: 8.476 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.2571568489074707
Epoch: 15, Steps: 10 | Train Loss: 0.072 Vali Loss: 8.623 Vali Acc: 0.285 Test Loss: 8.623 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.6287004947662354
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 8.877 Vali Acc: 0.273 Test Loss: 8.877 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7094173431396484
Epoch: 17, Steps: 10 | Train Loss: 0.058 Vali Loss: 9.056 Vali Acc: 0.268 Test Loss: 9.056 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.53337025642395
Epoch: 18, Steps: 10 | Train Loss: 0.013 Vali Loss: 9.750 Vali Acc: 0.289 Test Loss: 9.750 Test Acc: 0.289
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.442871332168579
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 9.906 Vali Acc: 0.275 Test Loss: 9.906 Test Acc: 0.275
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.517042636871338
Epoch: 20, Steps: 10 | Train Loss: 0.146 Vali Loss: 11.102 Vali Acc: 0.271 Test Loss: 11.102 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 7287378
model size : 37.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.768010377883911
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.407 Vali Acc: 0.106 Test Loss: 3.407 Test Acc: 0.106
Validation loss decreased (inf --> -0.105848).  Saving model ...
Epoch: 2 cost time: 2.892383098602295
Epoch: 2, Steps: 10 | Train Loss: 2.178 Vali Loss: 3.384 Vali Acc: 0.222 Test Loss: 3.384 Test Acc: 0.222
Validation loss decreased (-0.105848 --> -0.222319).  Saving model ...
Epoch: 3 cost time: 2.461674451828003
Epoch: 3, Steps: 10 | Train Loss: 0.920 Vali Loss: 3.693 Vali Acc: 0.273 Test Loss: 3.693 Test Acc: 0.273
Validation loss decreased (-0.222319 --> -0.272904).  Saving model ...
Epoch: 4 cost time: 2.316493034362793
Epoch: 4, Steps: 10 | Train Loss: 0.333 Vali Loss: 4.254 Vali Acc: 0.299 Test Loss: 4.254 Test Acc: 0.299
Validation loss decreased (-0.272904 --> -0.298781).  Saving model ...
Epoch: 5 cost time: 2.3718857765197754
Epoch: 5, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.423 Vali Acc: 0.299 Test Loss: 4.423 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1849653720855713
Epoch: 6, Steps: 10 | Train Loss: 0.137 Vali Loss: 4.866 Vali Acc: 0.306 Test Loss: 4.866 Test Acc: 0.306
Validation loss decreased (-0.298781 --> -0.305834).  Saving model ...
Epoch: 7 cost time: 2.185004472732544
Epoch: 7, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.887 Vali Acc: 0.324 Test Loss: 4.887 Test Acc: 0.324
Validation loss decreased (-0.305834 --> -0.323481).  Saving model ...
Epoch: 8 cost time: 2.4402778148651123
Epoch: 8, Steps: 10 | Train Loss: 0.077 Vali Loss: 5.396 Vali Acc: 0.322 Test Loss: 5.396 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4340264797210693
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.780 Vali Acc: 0.300 Test Loss: 5.780 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5279741287231445
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.607 Vali Acc: 0.311 Test Loss: 5.607 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.2905619144439697
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.470 Vali Acc: 0.321 Test Loss: 5.470 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.5167760848999023
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 6.016 Vali Acc: 0.309 Test Loss: 6.016 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.578627824783325
Epoch: 13, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.520 Vali Acc: 0.300 Test Loss: 6.520 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.3569083213806152
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.344 Vali Acc: 0.318 Test Loss: 6.344 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.384331226348877
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.173 Vali Acc: 0.321 Test Loss: 6.173 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.4407947063446045
Epoch: 16, Steps: 10 | Train Loss: 0.021 Vali Loss: 6.268 Vali Acc: 0.304 Test Loss: 6.268 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.8949759006500244
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.734 Vali Acc: 0.276 Test Loss: 6.734 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 7287378
model size : 37.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.492493629455566
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.326 Vali Acc: 0.109 Test Loss: 3.326 Test Acc: 0.109
Validation loss decreased (inf --> -0.109379).  Saving model ...
Epoch: 2 cost time: 2.491816759109497
Epoch: 2, Steps: 10 | Train Loss: 2.323 Vali Loss: 3.129 Vali Acc: 0.229 Test Loss: 3.129 Test Acc: 0.229
Validation loss decreased (-0.109379 --> -0.229380).  Saving model ...
Epoch: 3 cost time: 2.207362174987793
Epoch: 3, Steps: 10 | Train Loss: 1.045 Vali Loss: 3.126 Vali Acc: 0.282 Test Loss: 3.126 Test Acc: 0.282
Validation loss decreased (-0.229380 --> -0.282322).  Saving model ...
Epoch: 4 cost time: 2.1295485496520996
Epoch: 4, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.589 Vali Acc: 0.286 Test Loss: 3.589 Test Acc: 0.286
Validation loss decreased (-0.282322 --> -0.285846).  Saving model ...
Epoch: 5 cost time: 1.5089821815490723
Epoch: 5, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.698 Vali Acc: 0.304 Test Loss: 3.698 Test Acc: 0.304
Validation loss decreased (-0.285846 --> -0.303492).  Saving model ...
Epoch: 6 cost time: 1.9621825218200684
Epoch: 6, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.217 Vali Acc: 0.304 Test Loss: 4.217 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.991647481918335
Epoch: 7, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.382 Vali Acc: 0.288 Test Loss: 4.382 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.390855073928833
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.506 Vali Acc: 0.288 Test Loss: 4.506 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.902033805847168
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.358 Vali Acc: 0.315 Test Loss: 4.358 Test Acc: 0.315
Validation loss decreased (-0.303492 --> -0.315251).  Saving model ...
Epoch: 10 cost time: 2.694260597229004
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.471 Vali Acc: 0.324 Test Loss: 4.471 Test Acc: 0.324
Validation loss decreased (-0.315251 --> -0.323485).  Saving model ...
Epoch: 11 cost time: 1.9857747554779053
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.351 Vali Acc: 0.335 Test Loss: 4.351 Test Acc: 0.335
Validation loss decreased (-0.323485 --> -0.335251).  Saving model ...
Epoch: 12 cost time: 2.0877113342285156
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.326 Vali Acc: 0.333 Test Loss: 4.326 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9027519226074219
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.339 Vali Acc: 0.332 Test Loss: 4.339 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8745536804199219
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.355 Vali Acc: 0.328 Test Loss: 4.355 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.044308662414551
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.360 Vali Acc: 0.331 Test Loss: 4.360 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.3900744915008545
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.363 Vali Acc: 0.332 Test Loss: 4.363 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.4752249717712402
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.364 Vali Acc: 0.333 Test Loss: 4.364 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4166266918182373
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.372 Vali Acc: 0.332 Test Loss: 4.372 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.3311078548431396
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.371 Vali Acc: 0.331 Test Loss: 4.371 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.169766664505005
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.376 Vali Acc: 0.332 Test Loss: 4.376 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.250548839569092
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.379 Vali Acc: 0.332 Test Loss: 4.379 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 7287378
model size : 37.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.041126012802124
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.428 Vali Acc: 0.104 Test Loss: 3.428 Test Acc: 0.104
Validation loss decreased (inf --> -0.103495).  Saving model ...
Epoch: 2 cost time: 2.3986105918884277
Epoch: 2, Steps: 10 | Train Loss: 2.109 Vali Loss: 3.480 Vali Acc: 0.214 Test Loss: 3.480 Test Acc: 0.214
Validation loss decreased (-0.103495 --> -0.214083).  Saving model ...
Epoch: 3 cost time: 2.09147047996521
Epoch: 3, Steps: 10 | Train Loss: 0.915 Vali Loss: 4.249 Vali Acc: 0.236 Test Loss: 4.249 Test Acc: 0.236
Validation loss decreased (-0.214083 --> -0.236428).  Saving model ...
Epoch: 4 cost time: 2.2902190685272217
Epoch: 4, Steps: 10 | Train Loss: 0.400 Vali Loss: 4.479 Vali Acc: 0.301 Test Loss: 4.479 Test Acc: 0.301
Validation loss decreased (-0.236428 --> -0.301132).  Saving model ...
Epoch: 5 cost time: 2.324666738510132
Epoch: 5, Steps: 10 | Train Loss: 0.152 Vali Loss: 5.048 Vali Acc: 0.284 Test Loss: 5.048 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9781599044799805
Epoch: 6, Steps: 10 | Train Loss: 0.218 Vali Loss: 5.471 Vali Acc: 0.295 Test Loss: 5.471 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.4468636512756348
Epoch: 7, Steps: 10 | Train Loss: 0.114 Vali Loss: 5.931 Vali Acc: 0.278 Test Loss: 5.931 Test Acc: 0.278
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7689857482910156
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 6.466 Vali Acc: 0.289 Test Loss: 6.466 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5653321743011475
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 6.760 Vali Acc: 0.293 Test Loss: 6.760 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.6260287761688232
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 7.467 Vali Acc: 0.296 Test Loss: 7.467 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.6868298053741455
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 8.177 Vali Acc: 0.302 Test Loss: 8.177 Test Acc: 0.302
Validation loss decreased (-0.301132 --> -0.302271).  Saving model ...
Epoch: 12 cost time: 1.909172773361206
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 8.030 Vali Acc: 0.301 Test Loss: 8.030 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.281989812850952
Epoch: 13, Steps: 10 | Train Loss: 0.030 Vali Loss: 8.390 Vali Acc: 0.286 Test Loss: 8.390 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.368191719055176
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 8.663 Vali Acc: 0.294 Test Loss: 8.663 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8461790084838867
Epoch: 15, Steps: 10 | Train Loss: 0.245 Vali Loss: 9.944 Vali Acc: 0.271 Test Loss: 9.944 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.583035945892334
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 9.575 Vali Acc: 0.292 Test Loss: 9.575 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7030465602874756
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 10.356 Vali Acc: 0.247 Test Loss: 10.356 Test Acc: 0.247
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.556084632873535
Epoch: 18, Steps: 10 | Train Loss: 0.081 Vali Loss: 11.828 Vali Acc: 0.244 Test Loss: 11.828 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.6911542415618896
Epoch: 19, Steps: 10 | Train Loss: 0.270 Vali Loss: 12.282 Vali Acc: 0.241 Test Loss: 12.282 Test Acc: 0.241
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.3558592796325684
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 12.068 Vali Acc: 0.274 Test Loss: 12.068 Test Acc: 0.274
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5117130279541016
Epoch: 21, Steps: 10 | Train Loss: 0.178 Vali Loss: 13.315 Vali Acc: 0.252 Test Loss: 13.315 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 5190226
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.758295297622681
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.418 Vali Acc: 0.105 Test Loss: 3.418 Test Acc: 0.105
Validation loss decreased (inf --> -0.104672).  Saving model ...
Epoch: 2 cost time: 1.8796803951263428
Epoch: 2, Steps: 10 | Train Loss: 2.136 Vali Loss: 3.443 Vali Acc: 0.216 Test Loss: 3.443 Test Acc: 0.216
Validation loss decreased (-0.104672 --> -0.216436).  Saving model ...
Epoch: 3 cost time: 1.982330560684204
Epoch: 3, Steps: 10 | Train Loss: 0.937 Vali Loss: 4.135 Vali Acc: 0.249 Test Loss: 4.135 Test Acc: 0.249
Validation loss decreased (-0.216436 --> -0.249370).  Saving model ...
Epoch: 4 cost time: 2.560408592224121
Epoch: 4, Steps: 10 | Train Loss: 0.422 Vali Loss: 4.309 Vali Acc: 0.291 Test Loss: 4.309 Test Acc: 0.291
Validation loss decreased (-0.249370 --> -0.290545).  Saving model ...
Epoch: 5 cost time: 2.0767786502838135
Epoch: 5, Steps: 10 | Train Loss: 0.159 Vali Loss: 4.825 Vali Acc: 0.299 Test Loss: 4.825 Test Acc: 0.299
Validation loss decreased (-0.290545 --> -0.298775).  Saving model ...
Epoch: 6 cost time: 2.528677463531494
Epoch: 6, Steps: 10 | Train Loss: 0.258 Vali Loss: 5.336 Vali Acc: 0.307 Test Loss: 5.336 Test Acc: 0.307
Validation loss decreased (-0.298775 --> -0.307005).  Saving model ...
Epoch: 7 cost time: 2.349989652633667
Epoch: 7, Steps: 10 | Train Loss: 0.091 Vali Loss: 5.654 Vali Acc: 0.281 Test Loss: 5.654 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4058732986450195
Epoch: 8, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.048 Vali Acc: 0.296 Test Loss: 6.048 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.5900321006774902
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 6.079 Vali Acc: 0.301 Test Loss: 6.079 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.416220188140869
Epoch: 10, Steps: 10 | Train Loss: 0.072 Vali Loss: 6.181 Vali Acc: 0.302 Test Loss: 6.181 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.837320327758789
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 7.099 Vali Acc: 0.281 Test Loss: 7.099 Test Acc: 0.281
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.7257773876190186
Epoch: 12, Steps: 10 | Train Loss: 0.075 Vali Loss: 7.122 Vali Acc: 0.274 Test Loss: 7.122 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.464240550994873
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.381 Vali Acc: 0.287 Test Loss: 7.381 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.532421350479126
Epoch: 14, Steps: 10 | Train Loss: 0.056 Vali Loss: 8.224 Vali Acc: 0.271 Test Loss: 8.224 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.418962001800537
Epoch: 15, Steps: 10 | Train Loss: 0.117 Vali Loss: 8.086 Vali Acc: 0.272 Test Loss: 8.086 Test Acc: 0.272
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.411771059036255
Epoch: 16, Steps: 10 | Train Loss: 0.088 Vali Loss: 8.829 Vali Acc: 0.264 Test Loss: 8.829 Test Acc: 0.264
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 5190226
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.9600653648376465
Epoch: 1, Steps: 10 | Train Loss: 3.282 Vali Loss: 3.377 Vali Acc: 0.112 Test Loss: 3.377 Test Acc: 0.112
Validation loss decreased (inf --> -0.111731).  Saving model ...
Epoch: 2 cost time: 2.874788761138916
Epoch: 2, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.335 Vali Acc: 0.221 Test Loss: 3.335 Test Acc: 0.221
Validation loss decreased (-0.111731 --> -0.221143).  Saving model ...
Epoch: 3 cost time: 2.6965789794921875
Epoch: 3, Steps: 10 | Train Loss: 0.930 Vali Loss: 3.862 Vali Acc: 0.253 Test Loss: 3.862 Test Acc: 0.253
Validation loss decreased (-0.221143 --> -0.252903).  Saving model ...
Epoch: 4 cost time: 2.4216508865356445
Epoch: 4, Steps: 10 | Train Loss: 0.382 Vali Loss: 4.055 Vali Acc: 0.300 Test Loss: 4.055 Test Acc: 0.300
Validation loss decreased (-0.252903 --> -0.299959).  Saving model ...
Epoch: 5 cost time: 2.94952130317688
Epoch: 5, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.469 Vali Acc: 0.313 Test Loss: 4.469 Test Acc: 0.313
Validation loss decreased (-0.299959 --> -0.312896).  Saving model ...
Epoch: 6 cost time: 2.139944553375244
Epoch: 6, Steps: 10 | Train Loss: 0.166 Vali Loss: 5.058 Vali Acc: 0.301 Test Loss: 5.058 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.617999792098999
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 5.321 Vali Acc: 0.295 Test Loss: 5.321 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7024316787719727
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 5.564 Vali Acc: 0.288 Test Loss: 5.564 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.3380424976348877
Epoch: 9, Steps: 10 | Train Loss: 0.033 Vali Loss: 5.788 Vali Acc: 0.315 Test Loss: 5.788 Test Acc: 0.315
Validation loss decreased (-0.312896 --> -0.315236).  Saving model ...
Epoch: 10 cost time: 1.826040506362915
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 5.682 Vali Acc: 0.308 Test Loss: 5.682 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.075556516647339
Epoch: 11, Steps: 10 | Train Loss: 0.053 Vali Loss: 6.066 Vali Acc: 0.285 Test Loss: 6.066 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.752870559692383
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.144 Vali Acc: 0.318 Test Loss: 6.144 Test Acc: 0.318
Validation loss decreased (-0.315236 --> -0.317586).  Saving model ...
Epoch: 13 cost time: 2.246192455291748
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.268 Vali Acc: 0.326 Test Loss: 6.268 Test Acc: 0.326
Validation loss decreased (-0.317586 --> -0.325820).  Saving model ...
Epoch: 14 cost time: 2.002448320388794
Epoch: 14, Steps: 10 | Train Loss: 0.016 Vali Loss: 6.265 Vali Acc: 0.325 Test Loss: 6.265 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8600826263427734
Epoch: 15, Steps: 10 | Train Loss: 0.003 Vali Loss: 6.921 Vali Acc: 0.286 Test Loss: 6.921 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.86008882522583
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 7.447 Vali Acc: 0.279 Test Loss: 7.447 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.193671941757202
Epoch: 17, Steps: 10 | Train Loss: 0.125 Vali Loss: 8.802 Vali Acc: 0.216 Test Loss: 8.802 Test Acc: 0.216
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6325759887695312
Epoch: 18, Steps: 10 | Train Loss: 0.255 Vali Loss: 9.096 Vali Acc: 0.241 Test Loss: 9.096 Test Acc: 0.241
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3651134967803955
Epoch: 19, Steps: 10 | Train Loss: 0.541 Vali Loss: 10.896 Vali Acc: 0.254 Test Loss: 10.896 Test Acc: 0.254
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.6131186485290527
Epoch: 20, Steps: 10 | Train Loss: 0.184 Vali Loss: 11.197 Vali Acc: 0.245 Test Loss: 11.197 Test Acc: 0.245
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.0851364135742188
Epoch: 21, Steps: 10 | Train Loss: 0.129 Vali Loss: 11.264 Vali Acc: 0.246 Test Loss: 11.264 Test Acc: 0.246
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.504392385482788
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 11.081 Vali Acc: 0.256 Test Loss: 11.081 Test Acc: 0.256
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.469236135482788
Epoch: 23, Steps: 10 | Train Loss: 0.119 Vali Loss: 13.087 Vali Acc: 0.241 Test Loss: 13.087 Test Acc: 0.241
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 5190226
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.553248882293701
Epoch: 1, Steps: 10 | Train Loss: 3.248 Vali Loss: 3.301 Vali Acc: 0.121 Test Loss: 3.301 Test Acc: 0.121
Validation loss decreased (inf --> -0.121143).  Saving model ...
Epoch: 2 cost time: 0.9444456100463867
Epoch: 2, Steps: 10 | Train Loss: 2.339 Vali Loss: 3.118 Vali Acc: 0.242 Test Loss: 3.118 Test Acc: 0.242
Validation loss decreased (-0.121143 --> -0.242322).  Saving model ...
Epoch: 3 cost time: 0.9300153255462646
Epoch: 3, Steps: 10 | Train Loss: 1.059 Vali Loss: 3.288 Vali Acc: 0.261 Test Loss: 3.288 Test Acc: 0.261
Validation loss decreased (-0.242322 --> -0.261144).  Saving model ...
Epoch: 4 cost time: 0.9872822761535645
Epoch: 4, Steps: 10 | Train Loss: 0.389 Vali Loss: 3.427 Vali Acc: 0.302 Test Loss: 3.427 Test Acc: 0.302
Validation loss decreased (-0.261144 --> -0.302319).  Saving model ...
Epoch: 5 cost time: 1.1207270622253418
Epoch: 5, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.746 Vali Acc: 0.300 Test Loss: 3.746 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0611884593963623
Epoch: 6, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.176 Vali Acc: 0.318 Test Loss: 4.176 Test Acc: 0.318
Validation loss decreased (-0.302319 --> -0.317605).  Saving model ...
Epoch: 7 cost time: 1.037902593612671
Epoch: 7, Steps: 10 | Train Loss: 0.069 Vali Loss: 4.490 Vali Acc: 0.309 Test Loss: 4.490 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1240289211273193
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.319 Vali Acc: 0.308 Test Loss: 4.319 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0849494934082031
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.283 Vali Acc: 0.325 Test Loss: 4.283 Test Acc: 0.325
Validation loss decreased (-0.317605 --> -0.324663).  Saving model ...
Epoch: 10 cost time: 1.1147408485412598
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.288 Vali Acc: 0.332 Test Loss: 4.288 Test Acc: 0.332
Validation loss decreased (-0.324663 --> -0.331722).  Saving model ...
Epoch: 11 cost time: 1.1187455654144287
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.295 Vali Acc: 0.338 Test Loss: 4.295 Test Acc: 0.338
Validation loss decreased (-0.331722 --> -0.337604).  Saving model ...
Epoch: 12 cost time: 1.0710527896881104
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.310 Vali Acc: 0.332 Test Loss: 4.310 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1274607181549072
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.337 Vali Acc: 0.335 Test Loss: 4.337 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.066007375717163
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.339 Vali Acc: 0.333 Test Loss: 4.339 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1545019149780273
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.334 Vali Acc: 0.335 Test Loss: 4.334 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1228728294372559
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.335 Vali Acc: 0.332 Test Loss: 4.335 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0809326171875
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.337 Vali Acc: 0.331 Test Loss: 4.337 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.023277759552002
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.345 Vali Acc: 0.335 Test Loss: 4.345 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.9157435894012451
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.348 Vali Acc: 0.335 Test Loss: 4.348 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9528155326843262
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.355 Vali Acc: 0.336 Test Loss: 4.355 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9625670909881592
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.367 Vali Acc: 0.335 Test Loss: 4.367 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 5190226
model size : 29.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.782179355621338
Epoch: 1, Steps: 10 | Train Loss: 3.461 Vali Loss: 3.511 Vali Acc: 0.074 Test Loss: 3.511 Test Acc: 0.074
Validation loss decreased (inf --> -0.074083).  Saving model ...
Epoch: 2 cost time: 1.0991826057434082
Epoch: 2, Steps: 10 | Train Loss: 2.145 Vali Loss: 3.431 Vali Acc: 0.228 Test Loss: 3.431 Test Acc: 0.228
Validation loss decreased (-0.074083 --> -0.228201).  Saving model ...
Epoch: 3 cost time: 1.0953497886657715
Epoch: 3, Steps: 10 | Train Loss: 0.928 Vali Loss: 4.138 Vali Acc: 0.252 Test Loss: 4.138 Test Acc: 0.252
Validation loss decreased (-0.228201 --> -0.251723).  Saving model ...
Epoch: 4 cost time: 1.1079647541046143
Epoch: 4, Steps: 10 | Train Loss: 0.338 Vali Loss: 4.854 Vali Acc: 0.246 Test Loss: 4.854 Test Acc: 0.246
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0375077724456787
Epoch: 5, Steps: 10 | Train Loss: 0.230 Vali Loss: 4.949 Vali Acc: 0.294 Test Loss: 4.949 Test Acc: 0.294
Validation loss decreased (-0.251723 --> -0.294068).  Saving model ...
Epoch: 6 cost time: 1.1487627029418945
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 5.623 Vali Acc: 0.282 Test Loss: 5.623 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1332364082336426
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.309 Vali Acc: 0.289 Test Loss: 6.309 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1095294952392578
Epoch: 8, Steps: 10 | Train Loss: 0.220 Vali Loss: 6.747 Vali Acc: 0.294 Test Loss: 6.747 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.217867374420166
Epoch: 9, Steps: 10 | Train Loss: 0.099 Vali Loss: 6.019 Vali Acc: 0.315 Test Loss: 6.019 Test Acc: 0.315
Validation loss decreased (-0.294068 --> -0.315234).  Saving model ...
Epoch: 10 cost time: 1.2040305137634277
Epoch: 10, Steps: 10 | Train Loss: 0.143 Vali Loss: 6.824 Vali Acc: 0.324 Test Loss: 6.824 Test Acc: 0.324
Validation loss decreased (-0.315234 --> -0.323461).  Saving model ...
Epoch: 11 cost time: 1.171919822692871
Epoch: 11, Steps: 10 | Train Loss: 0.089 Vali Loss: 7.401 Vali Acc: 0.311 Test Loss: 7.401 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2103989124298096
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.502 Vali Acc: 0.318 Test Loss: 7.502 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1799306869506836
Epoch: 13, Steps: 10 | Train Loss: 0.174 Vali Loss: 9.107 Vali Acc: 0.239 Test Loss: 9.107 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1393492221832275
Epoch: 14, Steps: 10 | Train Loss: 0.136 Vali Loss: 9.075 Vali Acc: 0.280 Test Loss: 9.075 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2452983856201172
Epoch: 15, Steps: 10 | Train Loss: 0.156 Vali Loss: 9.857 Vali Acc: 0.275 Test Loss: 9.857 Test Acc: 0.275
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1763265132904053
Epoch: 16, Steps: 10 | Train Loss: 0.269 Vali Loss: 9.987 Vali Acc: 0.273 Test Loss: 9.987 Test Acc: 0.273
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1630167961120605
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 10.306 Vali Acc: 0.268 Test Loss: 10.306 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.148390293121338
Epoch: 18, Steps: 10 | Train Loss: 0.106 Vali Loss: 11.323 Vali Acc: 0.272 Test Loss: 11.323 Test Acc: 0.272
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0930638313293457
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 11.130 Vali Acc: 0.285 Test Loss: 11.130 Test Acc: 0.285
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1186442375183105
Epoch: 20, Steps: 10 | Train Loss: 0.026 Vali Loss: 11.770 Vali Acc: 0.271 Test Loss: 11.770 Test Acc: 0.271
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 4141650
model size : 25.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5672318935394287
Epoch: 1, Steps: 10 | Train Loss: 3.432 Vali Loss: 3.491 Vali Acc: 0.078 Test Loss: 3.491 Test Acc: 0.078
Validation loss decreased (inf --> -0.077612).  Saving model ...
Epoch: 2 cost time: 1.0045907497406006
Epoch: 2, Steps: 10 | Train Loss: 2.161 Vali Loss: 3.392 Vali Acc: 0.228 Test Loss: 3.392 Test Acc: 0.228
Validation loss decreased (-0.077612 --> -0.228201).  Saving model ...
Epoch: 3 cost time: 1.0112025737762451
Epoch: 3, Steps: 10 | Train Loss: 0.967 Vali Loss: 4.035 Vali Acc: 0.255 Test Loss: 4.035 Test Acc: 0.255
Validation loss decreased (-0.228201 --> -0.255254).  Saving model ...
Epoch: 4 cost time: 1.0771758556365967
Epoch: 4, Steps: 10 | Train Loss: 0.359 Vali Loss: 4.638 Vali Acc: 0.251 Test Loss: 4.638 Test Acc: 0.251
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0090034008026123
Epoch: 5, Steps: 10 | Train Loss: 0.234 Vali Loss: 4.823 Vali Acc: 0.299 Test Loss: 4.823 Test Acc: 0.299
Validation loss decreased (-0.255254 --> -0.298775).  Saving model ...
Epoch: 6 cost time: 1.0494248867034912
Epoch: 6, Steps: 10 | Train Loss: 0.096 Vali Loss: 5.377 Vali Acc: 0.276 Test Loss: 5.377 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0480616092681885
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 5.886 Vali Acc: 0.285 Test Loss: 5.886 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.067467212677002
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 6.341 Vali Acc: 0.280 Test Loss: 6.341 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9947807788848877
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 6.061 Vali Acc: 0.299 Test Loss: 6.061 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9724643230438232
Epoch: 10, Steps: 10 | Train Loss: 0.038 Vali Loss: 6.336 Vali Acc: 0.315 Test Loss: 6.336 Test Acc: 0.315
Validation loss decreased (-0.298775 --> -0.315231).  Saving model ...
Epoch: 11 cost time: 1.0228421688079834
Epoch: 11, Steps: 10 | Train Loss: 0.052 Vali Loss: 6.700 Vali Acc: 0.308 Test Loss: 6.700 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0652658939361572
Epoch: 12, Steps: 10 | Train Loss: 0.109 Vali Loss: 6.614 Vali Acc: 0.302 Test Loss: 6.614 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1294283866882324
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 7.340 Vali Acc: 0.280 Test Loss: 7.340 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2077417373657227
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 7.470 Vali Acc: 0.279 Test Loss: 7.470 Test Acc: 0.279
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.095017671585083
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 8.251 Vali Acc: 0.276 Test Loss: 8.251 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1637096405029297
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 7.853 Vali Acc: 0.287 Test Loss: 7.853 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2481958866119385
Epoch: 17, Steps: 10 | Train Loss: 0.057 Vali Loss: 9.710 Vali Acc: 0.271 Test Loss: 9.710 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.155545949935913
Epoch: 18, Steps: 10 | Train Loss: 0.135 Vali Loss: 11.609 Vali Acc: 0.219 Test Loss: 11.609 Test Acc: 0.219
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1901607513427734
Epoch: 19, Steps: 10 | Train Loss: 0.234 Vali Loss: 13.042 Vali Acc: 0.214 Test Loss: 13.042 Test Acc: 0.214
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2019689083099365
Epoch: 20, Steps: 10 | Train Loss: 0.393 Vali Loss: 11.245 Vali Acc: 0.249 Test Loss: 11.245 Test Acc: 0.249
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31529411764705884
model parameter : 4141650
model size : 25.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.276335000991821
Epoch: 1, Steps: 10 | Train Loss: 3.409 Vali Loss: 3.437 Vali Acc: 0.080 Test Loss: 3.437 Test Acc: 0.080
Validation loss decreased (inf --> -0.079966).  Saving model ...
Epoch: 2 cost time: 1.970066785812378
Epoch: 2, Steps: 10 | Train Loss: 2.181 Vali Loss: 3.294 Vali Acc: 0.225 Test Loss: 3.294 Test Acc: 0.225
Validation loss decreased (-0.079966 --> -0.224673).  Saving model ...
Epoch: 3 cost time: 1.5970566272735596
Epoch: 3, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.830 Vali Acc: 0.251 Test Loss: 3.830 Test Acc: 0.251
Validation loss decreased (-0.224673 --> -0.250550).  Saving model ...
Epoch: 4 cost time: 1.9262266159057617
Epoch: 4, Steps: 10 | Train Loss: 0.342 Vali Loss: 4.205 Vali Acc: 0.274 Test Loss: 4.205 Test Acc: 0.274
Validation loss decreased (-0.250550 --> -0.274076).  Saving model ...
Epoch: 5 cost time: 2.5410382747650146
Epoch: 5, Steps: 10 | Train Loss: 0.167 Vali Loss: 4.496 Vali Acc: 0.296 Test Loss: 4.496 Test Acc: 0.296
Validation loss decreased (-0.274076 --> -0.296426).  Saving model ...
Epoch: 6 cost time: 2.381551742553711
Epoch: 6, Steps: 10 | Train Loss: 0.070 Vali Loss: 5.039 Vali Acc: 0.295 Test Loss: 5.039 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3292465209960938
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.325 Vali Acc: 0.296 Test Loss: 5.325 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1171281337738037
Epoch: 8, Steps: 10 | Train Loss: 0.042 Vali Loss: 5.540 Vali Acc: 0.305 Test Loss: 5.540 Test Acc: 0.305
Validation loss decreased (-0.296426 --> -0.304650).  Saving model ...
Epoch: 9 cost time: 2.1737961769104004
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.472 Vali Acc: 0.294 Test Loss: 5.472 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2414801120758057
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 5.741 Vali Acc: 0.313 Test Loss: 5.741 Test Acc: 0.313
Validation loss decreased (-0.304650 --> -0.312884).  Saving model ...
Epoch: 11 cost time: 2.2888424396514893
Epoch: 11, Steps: 10 | Train Loss: 0.063 Vali Loss: 6.423 Vali Acc: 0.300 Test Loss: 6.423 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.754019021987915
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.299 Vali Acc: 0.294 Test Loss: 6.299 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.1827895641326904
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 5.957 Vali Acc: 0.318 Test Loss: 5.957 Test Acc: 0.318
Validation loss decreased (-0.312884 --> -0.317587).  Saving model ...
Epoch: 14 cost time: 2.769895553588867
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 6.360 Vali Acc: 0.305 Test Loss: 6.360 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1325395107269287
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.668 Vali Acc: 0.306 Test Loss: 6.668 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1361000537872314
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.316 Vali Acc: 0.302 Test Loss: 6.316 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.343020439147949
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 7.120 Vali Acc: 0.282 Test Loss: 7.120 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.402522325515747
Epoch: 18, Steps: 10 | Train Loss: 0.068 Vali Loss: 8.249 Vali Acc: 0.273 Test Loss: 8.249 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.588416814804077
Epoch: 19, Steps: 10 | Train Loss: 0.187 Vali Loss: 7.528 Vali Acc: 0.268 Test Loss: 7.528 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.8886682987213135
Epoch: 20, Steps: 10 | Train Loss: 0.113 Vali Loss: 9.146 Vali Acc: 0.249 Test Loss: 9.146 Test Acc: 0.249
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2739040851593018
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 9.590 Vali Acc: 0.252 Test Loss: 9.590 Test Acc: 0.252
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.3376309871673584
Epoch: 22, Steps: 10 | Train Loss: 0.127 Vali Loss: 10.013 Vali Acc: 0.248 Test Loss: 10.013 Test Acc: 0.248
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.6175520420074463
Epoch: 23, Steps: 10 | Train Loss: 0.164 Vali Loss: 11.805 Vali Acc: 0.254 Test Loss: 11.805 Test Acc: 0.254
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 4141650
model size : 25.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.926983594894409
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.337 Vali Acc: 0.078 Test Loss: 3.337 Test Acc: 0.078
Validation loss decreased (inf --> -0.077614).  Saving model ...
Epoch: 2 cost time: 2.611356496810913
Epoch: 2, Steps: 10 | Train Loss: 2.366 Vali Loss: 3.093 Vali Acc: 0.232 Test Loss: 3.093 Test Acc: 0.232
Validation loss decreased (-0.077614 --> -0.231734).  Saving model ...
Epoch: 3 cost time: 1.9332644939422607
Epoch: 3, Steps: 10 | Train Loss: 1.114 Vali Loss: 3.259 Vali Acc: 0.253 Test Loss: 3.259 Test Acc: 0.253
Validation loss decreased (-0.231734 --> -0.252909).  Saving model ...
Epoch: 4 cost time: 2.108757972717285
Epoch: 4, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.395 Vali Acc: 0.305 Test Loss: 3.395 Test Acc: 0.305
Validation loss decreased (-0.252909 --> -0.304672).  Saving model ...
Epoch: 5 cost time: 1.6334922313690186
Epoch: 5, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.903 Vali Acc: 0.294 Test Loss: 3.903 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.203223705291748
Epoch: 6, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.392 Vali Acc: 0.271 Test Loss: 4.392 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.009922742843628
Epoch: 7, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.498 Vali Acc: 0.289 Test Loss: 4.498 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9100844860076904
Epoch: 8, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.606 Vali Acc: 0.291 Test Loss: 4.606 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1898014545440674
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.763 Vali Acc: 0.296 Test Loss: 4.763 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.3938305377960205
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.885 Vali Acc: 0.280 Test Loss: 4.885 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.0805745124816895
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.112 Vali Acc: 0.287 Test Loss: 5.112 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.8622405529022217
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.237 Vali Acc: 0.301 Test Loss: 5.237 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.3756511211395264
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.924 Vali Acc: 0.251 Test Loss: 5.924 Test Acc: 0.251
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.5361716747283936
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.664 Vali Acc: 0.299 Test Loss: 5.664 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 4141650
model size : 25.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.723203897476196
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.400 Vali Acc: 0.119 Test Loss: 3.400 Test Acc: 0.119
Validation loss decreased (inf --> -0.118790).  Saving model ...
Epoch: 2 cost time: 2.033050298690796
Epoch: 2, Steps: 10 | Train Loss: 2.164 Vali Loss: 3.523 Vali Acc: 0.207 Test Loss: 3.523 Test Acc: 0.207
Validation loss decreased (-0.118790 --> -0.207024).  Saving model ...
Epoch: 3 cost time: 1.8685519695281982
Epoch: 3, Steps: 10 | Train Loss: 0.871 Vali Loss: 4.215 Vali Acc: 0.256 Test Loss: 4.215 Test Acc: 0.256
Validation loss decreased (-0.207024 --> -0.256428).  Saving model ...
Epoch: 4 cost time: 2.7513344287872314
Epoch: 4, Steps: 10 | Train Loss: 0.409 Vali Loss: 4.601 Vali Acc: 0.271 Test Loss: 4.601 Test Acc: 0.271
Validation loss decreased (-0.256428 --> -0.270542).  Saving model ...
Epoch: 5 cost time: 2.2688076496124268
Epoch: 5, Steps: 10 | Train Loss: 0.157 Vali Loss: 5.110 Vali Acc: 0.292 Test Loss: 5.110 Test Acc: 0.292
Validation loss decreased (-0.270542 --> -0.291714).  Saving model ...
Epoch: 6 cost time: 2.4465315341949463
Epoch: 6, Steps: 10 | Train Loss: 0.167 Vali Loss: 5.469 Vali Acc: 0.281 Test Loss: 5.469 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5615463256835938
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 5.844 Vali Acc: 0.294 Test Loss: 5.844 Test Acc: 0.294
Validation loss decreased (-0.291714 --> -0.294059).  Saving model ...
Epoch: 8 cost time: 1.9484217166900635
Epoch: 8, Steps: 10 | Train Loss: 0.095 Vali Loss: 6.799 Vali Acc: 0.273 Test Loss: 6.799 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.310622215270996
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 6.753 Vali Acc: 0.278 Test Loss: 6.753 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.1388919353485107
Epoch: 10, Steps: 10 | Train Loss: 0.074 Vali Loss: 7.177 Vali Acc: 0.293 Test Loss: 7.177 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.059885263442993
Epoch: 11, Steps: 10 | Train Loss: 0.062 Vali Loss: 7.933 Vali Acc: 0.252 Test Loss: 7.933 Test Acc: 0.252
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.7680869102478027
Epoch: 12, Steps: 10 | Train Loss: 0.056 Vali Loss: 8.220 Vali Acc: 0.293 Test Loss: 8.220 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0089919567108154
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 8.634 Vali Acc: 0.287 Test Loss: 8.634 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.111600160598755
Epoch: 14, Steps: 10 | Train Loss: 0.129 Vali Loss: 9.203 Vali Acc: 0.260 Test Loss: 9.203 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.141411542892456
Epoch: 15, Steps: 10 | Train Loss: 0.082 Vali Loss: 9.189 Vali Acc: 0.273 Test Loss: 9.189 Test Acc: 0.273
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.327148914337158
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 9.672 Vali Acc: 0.281 Test Loss: 9.672 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.6238362789154053
Epoch: 17, Steps: 10 | Train Loss: 0.015 Vali Loss: 9.891 Vali Acc: 0.274 Test Loss: 9.891 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 3617362
model size : 23.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.145761489868164
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.377 Vali Acc: 0.113 Test Loss: 3.377 Test Acc: 0.113
Validation loss decreased (inf --> -0.112907).  Saving model ...
Epoch: 2 cost time: 1.8214318752288818
Epoch: 2, Steps: 10 | Train Loss: 2.197 Vali Loss: 3.460 Vali Acc: 0.214 Test Loss: 3.460 Test Acc: 0.214
Validation loss decreased (-0.112907 --> -0.214083).  Saving model ...
Epoch: 3 cost time: 1.8924407958984375
Epoch: 3, Steps: 10 | Train Loss: 0.900 Vali Loss: 4.085 Vali Acc: 0.266 Test Loss: 4.085 Test Acc: 0.266
Validation loss decreased (-0.214083 --> -0.265842).  Saving model ...
Epoch: 4 cost time: 1.9100708961486816
Epoch: 4, Steps: 10 | Train Loss: 0.405 Vali Loss: 4.420 Vali Acc: 0.275 Test Loss: 4.420 Test Acc: 0.275
Validation loss decreased (-0.265842 --> -0.275250).  Saving model ...
Epoch: 5 cost time: 2.4455792903900146
Epoch: 5, Steps: 10 | Train Loss: 0.164 Vali Loss: 4.935 Vali Acc: 0.286 Test Loss: 4.935 Test Acc: 0.286
Validation loss decreased (-0.275250 --> -0.285833).  Saving model ...
Epoch: 6 cost time: 2.4343624114990234
Epoch: 6, Steps: 10 | Train Loss: 0.160 Vali Loss: 5.310 Vali Acc: 0.286 Test Loss: 5.310 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8985788822174072
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 5.563 Vali Acc: 0.307 Test Loss: 5.563 Test Acc: 0.307
Validation loss decreased (-0.285833 --> -0.307003).  Saving model ...
Epoch: 8 cost time: 2.7903008460998535
Epoch: 8, Steps: 10 | Train Loss: 0.094 Vali Loss: 6.081 Vali Acc: 0.293 Test Loss: 6.081 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6358344554901123
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 6.452 Vali Acc: 0.287 Test Loss: 6.452 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.7391338348388672
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.311 Vali Acc: 0.299 Test Loss: 6.311 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.420125722885132
Epoch: 11, Steps: 10 | Train Loss: 0.064 Vali Loss: 7.609 Vali Acc: 0.273 Test Loss: 7.609 Test Acc: 0.273
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.205209493637085
Epoch: 12, Steps: 10 | Train Loss: 0.084 Vali Loss: 7.059 Vali Acc: 0.279 Test Loss: 7.059 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.561488389968872
Epoch: 13, Steps: 10 | Train Loss: 0.042 Vali Loss: 8.079 Vali Acc: 0.272 Test Loss: 8.079 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.0371599197387695
Epoch: 14, Steps: 10 | Train Loss: 0.029 Vali Loss: 7.823 Vali Acc: 0.289 Test Loss: 7.823 Test Acc: 0.289
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.8683271408081055
Epoch: 15, Steps: 10 | Train Loss: 0.011 Vali Loss: 9.052 Vali Acc: 0.256 Test Loss: 9.052 Test Acc: 0.256
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.0426008701324463
Epoch: 16, Steps: 10 | Train Loss: 0.097 Vali Loss: 8.214 Vali Acc: 0.296 Test Loss: 8.214 Test Acc: 0.296
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.0473520755767822
Epoch: 17, Steps: 10 | Train Loss: 0.078 Vali Loss: 9.063 Vali Acc: 0.293 Test Loss: 9.063 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 3617362
model size : 23.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.783606290817261
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.341 Vali Acc: 0.104 Test Loss: 3.341 Test Acc: 0.104
Validation loss decreased (inf --> -0.103496).  Saving model ...
Epoch: 2 cost time: 2.1351943016052246
Epoch: 2, Steps: 10 | Train Loss: 2.263 Vali Loss: 3.352 Vali Acc: 0.222 Test Loss: 3.352 Test Acc: 0.222
Validation loss decreased (-0.103496 --> -0.222319).  Saving model ...
Epoch: 3 cost time: 2.1418046951293945
Epoch: 3, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.834 Vali Acc: 0.269 Test Loss: 3.834 Test Acc: 0.269
Validation loss decreased (-0.222319 --> -0.269373).  Saving model ...
Epoch: 4 cost time: 2.5172858238220215
Epoch: 4, Steps: 10 | Train Loss: 0.373 Vali Loss: 4.174 Vali Acc: 0.291 Test Loss: 4.174 Test Acc: 0.291
Validation loss decreased (-0.269373 --> -0.290546).  Saving model ...
Epoch: 5 cost time: 2.1965279579162598
Epoch: 5, Steps: 10 | Train Loss: 0.142 Vali Loss: 4.728 Vali Acc: 0.279 Test Loss: 4.728 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7547099590301514
Epoch: 6, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.976 Vali Acc: 0.288 Test Loss: 4.976 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.146336793899536
Epoch: 7, Steps: 10 | Train Loss: 0.050 Vali Loss: 5.114 Vali Acc: 0.311 Test Loss: 5.114 Test Acc: 0.311
Validation loss decreased (-0.290546 --> -0.310537).  Saving model ...
Epoch: 8 cost time: 2.2406702041625977
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.327 Vali Acc: 0.315 Test Loss: 5.327 Test Acc: 0.315
Validation loss decreased (-0.310537 --> -0.315241).  Saving model ...
Epoch: 9 cost time: 2.1272075176239014
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 5.897 Vali Acc: 0.302 Test Loss: 5.897 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9953374862670898
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 5.584 Vali Acc: 0.314 Test Loss: 5.584 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9996230602264404
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 6.315 Vali Acc: 0.281 Test Loss: 6.315 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2871854305267334
Epoch: 12, Steps: 10 | Train Loss: 0.039 Vali Loss: 6.660 Vali Acc: 0.305 Test Loss: 6.660 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.128021478652954
Epoch: 13, Steps: 10 | Train Loss: 0.228 Vali Loss: 7.684 Vali Acc: 0.285 Test Loss: 7.684 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.4293570518493652
Epoch: 14, Steps: 10 | Train Loss: 0.040 Vali Loss: 7.243 Vali Acc: 0.278 Test Loss: 7.243 Test Acc: 0.278
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7097113132476807
Epoch: 15, Steps: 10 | Train Loss: 0.048 Vali Loss: 8.221 Vali Acc: 0.244 Test Loss: 8.221 Test Acc: 0.244
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.1946792602539062
Epoch: 16, Steps: 10 | Train Loss: 0.328 Vali Loss: 8.530 Vali Acc: 0.275 Test Loss: 8.530 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8980402946472168
Epoch: 17, Steps: 10 | Train Loss: 0.070 Vali Loss: 8.632 Vali Acc: 0.267 Test Loss: 8.632 Test Acc: 0.267
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.6931838989257812
Epoch: 18, Steps: 10 | Train Loss: 0.065 Vali Loss: 9.006 Vali Acc: 0.274 Test Loss: 9.006 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31529411764705884
model parameter : 3617362
model size : 23.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.183468580245972
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.302 Vali Acc: 0.093 Test Loss: 3.302 Test Acc: 0.093
Validation loss decreased (inf --> -0.092908).  Saving model ...
Epoch: 2 cost time: 2.2751500606536865
Epoch: 2, Steps: 10 | Train Loss: 2.400 Vali Loss: 3.152 Vali Acc: 0.215 Test Loss: 3.152 Test Acc: 0.215
Validation loss decreased (-0.092908 --> -0.215263).  Saving model ...
Epoch: 3 cost time: 2.1312074661254883
Epoch: 3, Steps: 10 | Train Loss: 1.048 Vali Loss: 3.274 Vali Acc: 0.262 Test Loss: 3.274 Test Acc: 0.262
Validation loss decreased (-0.215263 --> -0.262320).  Saving model ...
Epoch: 4 cost time: 1.8607697486877441
Epoch: 4, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.447 Vali Acc: 0.284 Test Loss: 3.447 Test Acc: 0.284
Validation loss decreased (-0.262320 --> -0.283495).  Saving model ...
Epoch: 5 cost time: 1.8736622333526611
Epoch: 5, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.836 Vali Acc: 0.284 Test Loss: 3.836 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3883585929870605
Epoch: 6, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.001 Vali Acc: 0.312 Test Loss: 4.001 Test Acc: 0.312
Validation loss decreased (-0.283495 --> -0.311725).  Saving model ...
Epoch: 7 cost time: 1.9866211414337158
Epoch: 7, Steps: 10 | Train Loss: 0.043 Vali Loss: 4.498 Vali Acc: 0.305 Test Loss: 4.498 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.796778678894043
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.664 Vali Acc: 0.314 Test Loss: 4.664 Test Acc: 0.314
Validation loss decreased (-0.311725 --> -0.314071).  Saving model ...
Epoch: 9 cost time: 2.45703387260437
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.732 Vali Acc: 0.313 Test Loss: 4.732 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9214580059051514
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.585 Vali Acc: 0.331 Test Loss: 4.585 Test Acc: 0.331
Validation loss decreased (-0.314071 --> -0.330542).  Saving model ...
Epoch: 11 cost time: 1.6979179382324219
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.593 Vali Acc: 0.339 Test Loss: 4.593 Test Acc: 0.339
Validation loss decreased (-0.330542 --> -0.338778).  Saving model ...
Epoch: 12 cost time: 1.7396008968353271
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.588 Vali Acc: 0.331 Test Loss: 4.588 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.698925256729126
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.573 Vali Acc: 0.332 Test Loss: 4.573 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.280489206314087
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.596 Vali Acc: 0.324 Test Loss: 4.596 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.006998300552368
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.598 Vali Acc: 0.320 Test Loss: 4.598 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.302976369857788
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.594 Vali Acc: 0.322 Test Loss: 4.594 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.3239212036132812
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.590 Vali Acc: 0.321 Test Loss: 4.590 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.4881951808929443
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.594 Vali Acc: 0.325 Test Loss: 4.594 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2024402618408203
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.595 Vali Acc: 0.328 Test Loss: 4.595 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.002213954925537
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.599 Vali Acc: 0.328 Test Loss: 4.599 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.9964702129364014
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.605 Vali Acc: 0.328 Test Loss: 4.605 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 3617362
model size : 23.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 5.135403871536255
Epoch: 1, Steps: 10 | Train Loss: 3.384 Vali Loss: 3.401 Vali Acc: 0.096 Test Loss: 3.401 Test Acc: 0.096
Validation loss decreased (inf --> -0.096437).  Saving model ...
Epoch: 2 cost time: 2.048336982727051
Epoch: 2, Steps: 10 | Train Loss: 2.118 Vali Loss: 3.554 Vali Acc: 0.209 Test Loss: 3.554 Test Acc: 0.209
Validation loss decreased (-0.096437 --> -0.209376).  Saving model ...
Epoch: 3 cost time: 2.1075804233551025
Epoch: 3, Steps: 10 | Train Loss: 0.887 Vali Loss: 4.166 Vali Acc: 0.256 Test Loss: 4.166 Test Acc: 0.256
Validation loss decreased (-0.209376 --> -0.256429).  Saving model ...
Epoch: 4 cost time: 1.8624787330627441
Epoch: 4, Steps: 10 | Train Loss: 0.371 Vali Loss: 4.607 Vali Acc: 0.280 Test Loss: 4.607 Test Acc: 0.280
Validation loss decreased (-0.256429 --> -0.279954).  Saving model ...
Epoch: 5 cost time: 2.30374813079834
Epoch: 5, Steps: 10 | Train Loss: 0.219 Vali Loss: 5.202 Vali Acc: 0.269 Test Loss: 5.202 Test Acc: 0.269
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1105093955993652
Epoch: 6, Steps: 10 | Train Loss: 0.170 Vali Loss: 5.990 Vali Acc: 0.266 Test Loss: 5.990 Test Acc: 0.266
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0214250087738037
Epoch: 7, Steps: 10 | Train Loss: 0.252 Vali Loss: 6.417 Vali Acc: 0.269 Test Loss: 6.417 Test Acc: 0.269
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.164107084274292
Epoch: 8, Steps: 10 | Train Loss: 0.080 Vali Loss: 6.630 Vali Acc: 0.262 Test Loss: 6.630 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.5327389240264893
Epoch: 9, Steps: 10 | Train Loss: 0.078 Vali Loss: 7.042 Vali Acc: 0.273 Test Loss: 7.042 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.7918150424957275
Epoch: 10, Steps: 10 | Train Loss: 0.068 Vali Loss: 7.770 Vali Acc: 0.289 Test Loss: 7.770 Test Acc: 0.289
Validation loss decreased (-0.279954 --> -0.289334).  Saving model ...
Epoch: 11 cost time: 2.1770212650299072
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.361 Vali Acc: 0.280 Test Loss: 7.361 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2401435375213623
Epoch: 12, Steps: 10 | Train Loss: 0.060 Vali Loss: 7.552 Vali Acc: 0.302 Test Loss: 7.552 Test Acc: 0.302
Validation loss decreased (-0.289334 --> -0.302277).  Saving model ...
Epoch: 13 cost time: 2.743208646774292
Epoch: 13, Steps: 10 | Train Loss: 0.020 Vali Loss: 7.933 Vali Acc: 0.287 Test Loss: 7.933 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2382547855377197
Epoch: 14, Steps: 10 | Train Loss: 0.193 Vali Loss: 8.328 Vali Acc: 0.272 Test Loss: 8.328 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8260478973388672
Epoch: 15, Steps: 10 | Train Loss: 0.071 Vali Loss: 8.626 Vali Acc: 0.275 Test Loss: 8.626 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.251563549041748
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 8.809 Vali Acc: 0.280 Test Loss: 8.809 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5625698566436768
Epoch: 17, Steps: 10 | Train Loss: 0.041 Vali Loss: 10.249 Vali Acc: 0.268 Test Loss: 10.249 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.465820789337158
Epoch: 18, Steps: 10 | Train Loss: 0.098 Vali Loss: 10.461 Vali Acc: 0.272 Test Loss: 10.461 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3722498416900635
Epoch: 19, Steps: 10 | Train Loss: 0.026 Vali Loss: 11.225 Vali Acc: 0.275 Test Loss: 11.225 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.999250888824463
Epoch: 20, Steps: 10 | Train Loss: 0.075 Vali Loss: 10.908 Vali Acc: 0.260 Test Loss: 10.908 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5193533897399902
Epoch: 21, Steps: 10 | Train Loss: 0.042 Vali Loss: 11.845 Vali Acc: 0.244 Test Loss: 11.845 Test Acc: 0.244
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.5282812118530273
Epoch: 22, Steps: 10 | Train Loss: 0.037 Vali Loss: 12.211 Vali Acc: 0.255 Test Loss: 12.211 Test Acc: 0.255
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3023529411764706
model parameter : 3355218
model size : 22.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.791533470153809
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.383 Vali Acc: 0.107 Test Loss: 3.383 Test Acc: 0.107
Validation loss decreased (inf --> -0.107025).  Saving model ...
Epoch: 2 cost time: 2.337087869644165
Epoch: 2, Steps: 10 | Train Loss: 2.130 Vali Loss: 3.499 Vali Acc: 0.215 Test Loss: 3.499 Test Acc: 0.215
Validation loss decreased (-0.107025 --> -0.215259).  Saving model ...
Epoch: 3 cost time: 2.172623872756958
Epoch: 3, Steps: 10 | Train Loss: 0.917 Vali Loss: 4.020 Vali Acc: 0.259 Test Loss: 4.020 Test Acc: 0.259
Validation loss decreased (-0.215259 --> -0.258783).  Saving model ...
Epoch: 4 cost time: 1.9975686073303223
Epoch: 4, Steps: 10 | Train Loss: 0.366 Vali Loss: 4.499 Vali Acc: 0.280 Test Loss: 4.499 Test Acc: 0.280
Validation loss decreased (-0.258783 --> -0.279955).  Saving model ...
Epoch: 5 cost time: 2.071077585220337
Epoch: 5, Steps: 10 | Train Loss: 0.221 Vali Loss: 5.072 Vali Acc: 0.276 Test Loss: 5.072 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.0848240852355957
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 5.679 Vali Acc: 0.251 Test Loss: 5.679 Test Acc: 0.251
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.7785913944244385
Epoch: 7, Steps: 10 | Train Loss: 0.192 Vali Loss: 6.064 Vali Acc: 0.286 Test Loss: 6.064 Test Acc: 0.286
Validation loss decreased (-0.279955 --> -0.285822).  Saving model ...
Epoch: 8 cost time: 1.7980976104736328
Epoch: 8, Steps: 10 | Train Loss: 0.068 Vali Loss: 6.247 Vali Acc: 0.293 Test Loss: 6.247 Test Acc: 0.293
Validation loss decreased (-0.285822 --> -0.292879).  Saving model ...
Epoch: 9 cost time: 1.7614977359771729
Epoch: 9, Steps: 10 | Train Loss: 0.029 Vali Loss: 6.059 Vali Acc: 0.292 Test Loss: 6.059 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3248164653778076
Epoch: 10, Steps: 10 | Train Loss: 0.069 Vali Loss: 6.543 Vali Acc: 0.295 Test Loss: 6.543 Test Acc: 0.295
Validation loss decreased (-0.292879 --> -0.295229).  Saving model ...
Epoch: 11 cost time: 1.8732903003692627
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.589 Vali Acc: 0.301 Test Loss: 6.589 Test Acc: 0.301
Validation loss decreased (-0.295229 --> -0.301111).  Saving model ...
Epoch: 12 cost time: 2.3993966579437256
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 6.968 Vali Acc: 0.312 Test Loss: 6.968 Test Acc: 0.312
Validation loss decreased (-0.301111 --> -0.311695).  Saving model ...
Epoch: 13 cost time: 1.9638187885284424
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.211 Vali Acc: 0.308 Test Loss: 7.211 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9708828926086426
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 7.093 Vali Acc: 0.307 Test Loss: 7.093 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2132456302642822
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.943 Vali Acc: 0.322 Test Loss: 6.943 Test Acc: 0.322
Validation loss decreased (-0.311695 --> -0.322284).  Saving model ...
Epoch: 16 cost time: 2.109064817428589
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.851 Vali Acc: 0.325 Test Loss: 6.851 Test Acc: 0.325
Validation loss decreased (-0.322284 --> -0.324637).  Saving model ...
Epoch: 17 cost time: 2.005284547805786
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.770 Vali Acc: 0.331 Test Loss: 6.770 Test Acc: 0.331
Validation loss decreased (-0.324637 --> -0.330521).  Saving model ...
Epoch: 18 cost time: 1.8641796112060547
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.738 Vali Acc: 0.333 Test Loss: 6.738 Test Acc: 0.333
Validation loss decreased (-0.330521 --> -0.332874).  Saving model ...
Epoch: 19 cost time: 2.163278341293335
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.727 Vali Acc: 0.336 Test Loss: 6.727 Test Acc: 0.336
Validation loss decreased (-0.332874 --> -0.336403).  Saving model ...
Epoch: 20 cost time: 2.0450048446655273
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.723 Vali Acc: 0.338 Test Loss: 6.723 Test Acc: 0.338
Validation loss decreased (-0.336403 --> -0.337580).  Saving model ...
Epoch: 21 cost time: 2.264357328414917
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.719 Vali Acc: 0.336 Test Loss: 6.719 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9043986797332764
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.718 Vali Acc: 0.339 Test Loss: 6.718 Test Acc: 0.339
Validation loss decreased (-0.337580 --> -0.338756).  Saving model ...
Epoch: 23 cost time: 2.0426502227783203
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.717 Vali Acc: 0.338 Test Loss: 6.717 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.2405591011047363
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.715 Vali Acc: 0.336 Test Loss: 6.715 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.283965587615967
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.710 Vali Acc: 0.338 Test Loss: 6.710 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.428711175918579
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.704 Vali Acc: 0.336 Test Loss: 6.704 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.393404960632324
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.698 Vali Acc: 0.336 Test Loss: 6.698 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0590662956237793
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.696 Vali Acc: 0.334 Test Loss: 6.696 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.6035664081573486
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.693 Vali Acc: 0.334 Test Loss: 6.693 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.4368386268615723
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.690 Vali Acc: 0.335 Test Loss: 6.690 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.2141945362091064
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.686 Vali Acc: 0.336 Test Loss: 6.686 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.010924816131592
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.684 Vali Acc: 0.338 Test Loss: 6.684 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 3355218
model size : 22.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.656402826309204
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.363 Vali Acc: 0.105 Test Loss: 3.363 Test Acc: 0.105
Validation loss decreased (inf --> -0.104672).  Saving model ...
Epoch: 2 cost time: 2.181246280670166
Epoch: 2, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.394 Vali Acc: 0.220 Test Loss: 3.394 Test Acc: 0.220
Validation loss decreased (-0.104672 --> -0.219966).  Saving model ...
Epoch: 3 cost time: 1.7209575176239014
Epoch: 3, Steps: 10 | Train Loss: 0.932 Vali Loss: 3.802 Vali Acc: 0.264 Test Loss: 3.802 Test Acc: 0.264
Validation loss decreased (-0.219966 --> -0.263491).  Saving model ...
Epoch: 4 cost time: 1.6894221305847168
Epoch: 4, Steps: 10 | Train Loss: 0.343 Vali Loss: 4.202 Vali Acc: 0.279 Test Loss: 4.202 Test Acc: 0.279
Validation loss decreased (-0.263491 --> -0.278782).  Saving model ...
Epoch: 5 cost time: 2.2792093753814697
Epoch: 5, Steps: 10 | Train Loss: 0.199 Vali Loss: 4.723 Vali Acc: 0.278 Test Loss: 4.723 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.534576177597046
Epoch: 6, Steps: 10 | Train Loss: 0.147 Vali Loss: 5.060 Vali Acc: 0.302 Test Loss: 5.060 Test Acc: 0.302
Validation loss decreased (-0.278782 --> -0.302302).  Saving model ...
Epoch: 7 cost time: 1.7680439949035645
Epoch: 7, Steps: 10 | Train Loss: 0.207 Vali Loss: 5.747 Vali Acc: 0.292 Test Loss: 5.747 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9550855159759521
Epoch: 8, Steps: 10 | Train Loss: 0.072 Vali Loss: 5.453 Vali Acc: 0.307 Test Loss: 5.453 Test Acc: 0.307
Validation loss decreased (-0.302302 --> -0.307004).  Saving model ...
Epoch: 9 cost time: 2.045023202896118
Epoch: 9, Steps: 10 | Train Loss: 0.089 Vali Loss: 6.183 Vali Acc: 0.301 Test Loss: 6.183 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1016409397125244
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.502 Vali Acc: 0.300 Test Loss: 6.502 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0806965827941895
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 6.247 Vali Acc: 0.309 Test Loss: 6.247 Test Acc: 0.309
Validation loss decreased (-0.307004 --> -0.309349).  Saving model ...
Epoch: 12 cost time: 1.7560646533966064
Epoch: 12, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.035 Vali Acc: 0.313 Test Loss: 6.035 Test Acc: 0.313
Validation loss decreased (-0.309349 --> -0.312881).  Saving model ...
Epoch: 13 cost time: 1.704059362411499
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.199 Vali Acc: 0.331 Test Loss: 6.199 Test Acc: 0.331
Validation loss decreased (-0.312881 --> -0.330526).  Saving model ...
Epoch: 14 cost time: 1.9856464862823486
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.891 Vali Acc: 0.293 Test Loss: 6.891 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9227254390716553
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 6.676 Vali Acc: 0.299 Test Loss: 6.676 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1730153560638428
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.829 Vali Acc: 0.307 Test Loss: 6.829 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.026125907897949
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.839 Vali Acc: 0.315 Test Loss: 6.839 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8374168872833252
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.885 Vali Acc: 0.318 Test Loss: 6.885 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.0760748386383057
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.784 Vali Acc: 0.324 Test Loss: 6.784 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0938479900360107
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.725 Vali Acc: 0.328 Test Loss: 6.725 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5591018199920654
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.686 Vali Acc: 0.326 Test Loss: 6.686 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2691640853881836
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.662 Vali Acc: 0.325 Test Loss: 6.662 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.507547378540039
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.646 Vali Acc: 0.326 Test Loss: 6.646 Test Acc: 0.326
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 3355218
model size : 22.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.1888182163238525
Epoch: 1, Steps: 10 | Train Loss: 3.314 Vali Loss: 3.312 Vali Acc: 0.095 Test Loss: 3.312 Test Acc: 0.095
Validation loss decreased (inf --> -0.095261).  Saving model ...
Epoch: 2 cost time: 2.001258134841919
Epoch: 2, Steps: 10 | Train Loss: 2.306 Vali Loss: 3.175 Vali Acc: 0.215 Test Loss: 3.175 Test Acc: 0.215
Validation loss decreased (-0.095261 --> -0.215262).  Saving model ...
Epoch: 3 cost time: 1.9915831089019775
Epoch: 3, Steps: 10 | Train Loss: 1.063 Vali Loss: 3.233 Vali Acc: 0.252 Test Loss: 3.233 Test Acc: 0.252
Validation loss decreased (-0.215262 --> -0.251732).  Saving model ...
Epoch: 4 cost time: 1.8766593933105469
Epoch: 4, Steps: 10 | Train Loss: 0.359 Vali Loss: 3.480 Vali Acc: 0.280 Test Loss: 3.480 Test Acc: 0.280
Validation loss decreased (-0.251732 --> -0.279965).  Saving model ...
Epoch: 5 cost time: 1.975393295288086
Epoch: 5, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.010 Vali Acc: 0.260 Test Loss: 4.010 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.622161626815796
Epoch: 6, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.156 Vali Acc: 0.292 Test Loss: 4.156 Test Acc: 0.292
Validation loss decreased (-0.279965 --> -0.291723).  Saving model ...
Epoch: 7 cost time: 1.795506477355957
Epoch: 7, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.295 Vali Acc: 0.314 Test Loss: 4.295 Test Acc: 0.314
Validation loss decreased (-0.291723 --> -0.314075).  Saving model ...
Epoch: 8 cost time: 1.721384048461914
Epoch: 8, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.459 Vali Acc: 0.316 Test Loss: 4.459 Test Acc: 0.316
Validation loss decreased (-0.314075 --> -0.316426).  Saving model ...
Epoch: 9 cost time: 1.6730375289916992
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.607 Vali Acc: 0.308 Test Loss: 4.607 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.041208505630493
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.569 Vali Acc: 0.325 Test Loss: 4.569 Test Acc: 0.325
Validation loss decreased (-0.316426 --> -0.324660).  Saving model ...
Epoch: 11 cost time: 1.5288453102111816
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.572 Vali Acc: 0.315 Test Loss: 4.572 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0349531173706055
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.576 Vali Acc: 0.322 Test Loss: 4.576 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.8152992725372314
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.535 Vali Acc: 0.326 Test Loss: 4.535 Test Acc: 0.326
Validation loss decreased (-0.324660 --> -0.325837).  Saving model ...
Epoch: 14 cost time: 1.7634978294372559
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.531 Vali Acc: 0.331 Test Loss: 4.531 Test Acc: 0.331
Validation loss decreased (-0.325837 --> -0.330543).  Saving model ...
Epoch: 15 cost time: 1.6809215545654297
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.539 Vali Acc: 0.332 Test Loss: 4.539 Test Acc: 0.332
Validation loss decreased (-0.330543 --> -0.331719).  Saving model ...
Epoch: 16 cost time: 2.0776798725128174
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.545 Vali Acc: 0.333 Test Loss: 4.545 Test Acc: 0.333
Validation loss decreased (-0.331719 --> -0.332896).  Saving model ...
Epoch: 17 cost time: 1.8682544231414795
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.547 Vali Acc: 0.334 Test Loss: 4.547 Test Acc: 0.334
Validation loss decreased (-0.332896 --> -0.334072).  Saving model ...
Epoch: 18 cost time: 1.8677992820739746
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.547 Vali Acc: 0.333 Test Loss: 4.547 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6035685539245605
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.548 Vali Acc: 0.334 Test Loss: 4.548 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6013293266296387
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.552 Vali Acc: 0.332 Test Loss: 4.552 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.001763343811035
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.558 Vali Acc: 0.333 Test Loss: 4.558 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.968693494796753
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.568 Vali Acc: 0.334 Test Loss: 4.568 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9109416007995605
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.575 Vali Acc: 0.334 Test Loss: 4.575 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.8559870719909668
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.577 Vali Acc: 0.333 Test Loss: 4.577 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7432878017425537
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.583 Vali Acc: 0.332 Test Loss: 4.583 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.6460988521575928
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.587 Vali Acc: 0.334 Test Loss: 4.587 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.7148451805114746
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.594 Vali Acc: 0.333 Test Loss: 4.594 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 3355218
model size : 22.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.218222618103027
Epoch: 1, Steps: 10 | Train Loss: 3.425 Vali Loss: 3.473 Vali Acc: 0.113 Test Loss: 3.473 Test Acc: 0.113
Validation loss decreased (inf --> -0.112906).  Saving model ...
Epoch: 2 cost time: 2.277045726776123
Epoch: 2, Steps: 10 | Train Loss: 2.117 Vali Loss: 3.525 Vali Acc: 0.235 Test Loss: 3.525 Test Acc: 0.235
Validation loss decreased (-0.112906 --> -0.235259).  Saving model ...
Epoch: 3 cost time: 1.981940746307373
Epoch: 3, Steps: 10 | Train Loss: 0.932 Vali Loss: 4.284 Vali Acc: 0.246 Test Loss: 4.284 Test Acc: 0.246
Validation loss decreased (-0.235259 --> -0.245840).  Saving model ...
Epoch: 4 cost time: 1.929518461227417
Epoch: 4, Steps: 10 | Train Loss: 0.403 Vali Loss: 4.503 Vali Acc: 0.287 Test Loss: 4.503 Test Acc: 0.287
Validation loss decreased (-0.245840 --> -0.287014).  Saving model ...
Epoch: 5 cost time: 1.9410576820373535
Epoch: 5, Steps: 10 | Train Loss: 0.297 Vali Loss: 5.243 Vali Acc: 0.271 Test Loss: 5.243 Test Acc: 0.271
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7062275409698486
Epoch: 6, Steps: 10 | Train Loss: 0.226 Vali Loss: 5.339 Vali Acc: 0.308 Test Loss: 5.339 Test Acc: 0.308
Validation loss decreased (-0.287014 --> -0.308182).  Saving model ...
Epoch: 7 cost time: 2.0347707271575928
Epoch: 7, Steps: 10 | Train Loss: 0.228 Vali Loss: 6.220 Vali Acc: 0.287 Test Loss: 6.220 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0449161529541016
Epoch: 8, Steps: 10 | Train Loss: 0.085 Vali Loss: 6.272 Vali Acc: 0.299 Test Loss: 6.272 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9328603744506836
Epoch: 9, Steps: 10 | Train Loss: 0.076 Vali Loss: 6.477 Vali Acc: 0.311 Test Loss: 6.477 Test Acc: 0.311
Validation loss decreased (-0.308182 --> -0.310523).  Saving model ...
Epoch: 10 cost time: 1.703493595123291
Epoch: 10, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.967 Vali Acc: 0.292 Test Loss: 6.967 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9889109134674072
Epoch: 11, Steps: 10 | Train Loss: 0.061 Vali Loss: 7.626 Vali Acc: 0.300 Test Loss: 7.626 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9956245422363281
Epoch: 12, Steps: 10 | Train Loss: 0.063 Vali Loss: 7.620 Vali Acc: 0.302 Test Loss: 7.620 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.931227684020996
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 7.462 Vali Acc: 0.314 Test Loss: 7.462 Test Acc: 0.314
Validation loss decreased (-0.310523 --> -0.314043).  Saving model ...
Epoch: 14 cost time: 2.031397819519043
Epoch: 14, Steps: 10 | Train Loss: 0.041 Vali Loss: 8.059 Vali Acc: 0.285 Test Loss: 8.059 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7873015403747559
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 8.372 Vali Acc: 0.295 Test Loss: 8.372 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.031630039215088
Epoch: 16, Steps: 10 | Train Loss: 0.082 Vali Loss: 10.053 Vali Acc: 0.239 Test Loss: 10.053 Test Acc: 0.239
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8095073699951172
Epoch: 17, Steps: 10 | Train Loss: 0.229 Vali Loss: 9.920 Vali Acc: 0.246 Test Loss: 9.920 Test Acc: 0.246
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.227257013320923
Epoch: 18, Steps: 10 | Train Loss: 0.061 Vali Loss: 10.423 Vali Acc: 0.249 Test Loss: 10.423 Test Acc: 0.249
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8420088291168213
Epoch: 19, Steps: 10 | Train Loss: 0.140 Vali Loss: 11.983 Vali Acc: 0.238 Test Loss: 11.983 Test Acc: 0.238
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.9584474563598633
Epoch: 20, Steps: 10 | Train Loss: 0.264 Vali Loss: 10.826 Vali Acc: 0.286 Test Loss: 10.826 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1624035835266113
Epoch: 21, Steps: 10 | Train Loss: 0.112 Vali Loss: 11.846 Vali Acc: 0.261 Test Loss: 11.846 Test Acc: 0.261
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5979418754577637
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 12.323 Vali Acc: 0.255 Test Loss: 12.323 Test Acc: 0.255
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.835752248764038
Epoch: 23, Steps: 10 | Train Loss: 0.201 Vali Loss: 13.607 Vali Acc: 0.220 Test Loss: 13.607 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 3224146
model size : 22.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.643632411956787
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.446 Vali Acc: 0.114 Test Loss: 3.446 Test Acc: 0.114
Validation loss decreased (inf --> -0.114083).  Saving model ...
Epoch: 2 cost time: 2.090278148651123
Epoch: 2, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.474 Vali Acc: 0.231 Test Loss: 3.474 Test Acc: 0.231
Validation loss decreased (-0.114083 --> -0.230553).  Saving model ...
Epoch: 3 cost time: 1.8681094646453857
Epoch: 3, Steps: 10 | Train Loss: 0.972 Vali Loss: 4.168 Vali Acc: 0.245 Test Loss: 4.168 Test Acc: 0.245
Validation loss decreased (-0.230553 --> -0.244664).  Saving model ...
Epoch: 4 cost time: 1.9362478256225586
Epoch: 4, Steps: 10 | Train Loss: 0.411 Vali Loss: 4.317 Vali Acc: 0.306 Test Loss: 4.317 Test Acc: 0.306
Validation loss decreased (-0.244664 --> -0.305839).  Saving model ...
Epoch: 5 cost time: 2.205073118209839
Epoch: 5, Steps: 10 | Train Loss: 0.305 Vali Loss: 5.171 Vali Acc: 0.254 Test Loss: 5.171 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.371718645095825
Epoch: 6, Steps: 10 | Train Loss: 0.287 Vali Loss: 5.138 Vali Acc: 0.301 Test Loss: 5.138 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.268298625946045
Epoch: 7, Steps: 10 | Train Loss: 0.192 Vali Loss: 5.785 Vali Acc: 0.293 Test Loss: 5.785 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.21110200881958
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 6.038 Vali Acc: 0.276 Test Loss: 6.038 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.1001477241516113
Epoch: 9, Steps: 10 | Train Loss: 0.026 Vali Loss: 6.391 Vali Acc: 0.293 Test Loss: 6.391 Test Acc: 0.293
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.0904932022094727
Epoch: 10, Steps: 10 | Train Loss: 0.116 Vali Loss: 7.161 Vali Acc: 0.255 Test Loss: 7.161 Test Acc: 0.255
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.283301591873169
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 7.059 Vali Acc: 0.336 Test Loss: 7.059 Test Acc: 0.336
Validation loss decreased (-0.305839 --> -0.336400).  Saving model ...
Epoch: 12 cost time: 1.9252138137817383
Epoch: 12, Steps: 10 | Train Loss: 0.048 Vali Loss: 7.372 Vali Acc: 0.307 Test Loss: 7.372 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.317664861679077
Epoch: 13, Steps: 10 | Train Loss: 0.032 Vali Loss: 7.963 Vali Acc: 0.272 Test Loss: 7.963 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3575479984283447
Epoch: 14, Steps: 10 | Train Loss: 0.132 Vali Loss: 8.435 Vali Acc: 0.291 Test Loss: 8.435 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.9987692832946777
Epoch: 15, Steps: 10 | Train Loss: 0.101 Vali Loss: 9.026 Vali Acc: 0.286 Test Loss: 9.026 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.161954164505005
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 9.477 Vali Acc: 0.295 Test Loss: 9.477 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.803086996078491
Epoch: 17, Steps: 10 | Train Loss: 0.050 Vali Loss: 10.553 Vali Acc: 0.240 Test Loss: 10.553 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.0425853729248047
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 9.275 Vali Acc: 0.305 Test Loss: 9.275 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2124688625335693
Epoch: 19, Steps: 10 | Train Loss: 0.008 Vali Loss: 10.618 Vali Acc: 0.286 Test Loss: 10.618 Test Acc: 0.286
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0207138061523438
Epoch: 20, Steps: 10 | Train Loss: 0.034 Vali Loss: 10.428 Vali Acc: 0.292 Test Loss: 10.428 Test Acc: 0.292
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.2811334133148193
Epoch: 21, Steps: 10 | Train Loss: 0.021 Vali Loss: 11.403 Vali Acc: 0.274 Test Loss: 11.403 Test Acc: 0.274
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 3224146
model size : 22.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.0896477699279785
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.411 Vali Acc: 0.115 Test Loss: 3.411 Test Acc: 0.115
Validation loss decreased (inf --> -0.115260).  Saving model ...
Epoch: 2 cost time: 1.9890727996826172
Epoch: 2, Steps: 10 | Train Loss: 2.151 Vali Loss: 3.357 Vali Acc: 0.247 Test Loss: 3.357 Test Acc: 0.247
Validation loss decreased (-0.115260 --> -0.247025).  Saving model ...
Epoch: 3 cost time: 1.968635082244873
Epoch: 3, Steps: 10 | Train Loss: 0.970 Vali Loss: 3.924 Vali Acc: 0.234 Test Loss: 3.924 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.966015338897705
Epoch: 4, Steps: 10 | Train Loss: 0.363 Vali Loss: 4.028 Vali Acc: 0.320 Test Loss: 4.028 Test Acc: 0.320
Validation loss decreased (-0.247025 --> -0.319960).  Saving model ...
Epoch: 5 cost time: 1.9762461185455322
Epoch: 5, Steps: 10 | Train Loss: 0.218 Vali Loss: 4.675 Vali Acc: 0.288 Test Loss: 4.675 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.9035313129425049
Epoch: 6, Steps: 10 | Train Loss: 0.175 Vali Loss: 4.640 Vali Acc: 0.327 Test Loss: 4.640 Test Acc: 0.327
Validation loss decreased (-0.319960 --> -0.327012).  Saving model ...
Epoch: 7 cost time: 1.7193360328674316
Epoch: 7, Steps: 10 | Train Loss: 0.131 Vali Loss: 5.105 Vali Acc: 0.305 Test Loss: 5.105 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.856924057006836
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.295 Vali Acc: 0.315 Test Loss: 5.295 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.067605972290039
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.490 Vali Acc: 0.312 Test Loss: 5.490 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.7628462314605713
Epoch: 10, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.893 Vali Acc: 0.308 Test Loss: 5.893 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.8713929653167725
Epoch: 11, Steps: 10 | Train Loss: 0.051 Vali Loss: 6.136 Vali Acc: 0.319 Test Loss: 6.136 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.956411361694336
Epoch: 12, Steps: 10 | Train Loss: 0.067 Vali Loss: 6.215 Vali Acc: 0.314 Test Loss: 6.215 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7412965297698975
Epoch: 13, Steps: 10 | Train Loss: 0.121 Vali Loss: 6.378 Vali Acc: 0.336 Test Loss: 6.378 Test Acc: 0.336
Validation loss decreased (-0.327012 --> -0.336407).  Saving model ...
Epoch: 14 cost time: 1.9868288040161133
Epoch: 14, Steps: 10 | Train Loss: 0.025 Vali Loss: 7.430 Vali Acc: 0.289 Test Loss: 7.430 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.167285203933716
Epoch: 15, Steps: 10 | Train Loss: 0.021 Vali Loss: 7.622 Vali Acc: 0.284 Test Loss: 7.622 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7153291702270508
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 7.478 Vali Acc: 0.279 Test Loss: 7.478 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.943410873413086
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 8.584 Vali Acc: 0.268 Test Loss: 8.584 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0721278190612793
Epoch: 18, Steps: 10 | Train Loss: 0.134 Vali Loss: 8.919 Vali Acc: 0.276 Test Loss: 8.919 Test Acc: 0.276
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.9472591876983643
Epoch: 19, Steps: 10 | Train Loss: 0.112 Vali Loss: 10.098 Vali Acc: 0.260 Test Loss: 10.098 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5915780067443848
Epoch: 20, Steps: 10 | Train Loss: 0.167 Vali Loss: 9.742 Vali Acc: 0.271 Test Loss: 9.742 Test Acc: 0.271
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8680174350738525
Epoch: 21, Steps: 10 | Train Loss: 0.207 Vali Loss: 11.355 Vali Acc: 0.242 Test Loss: 11.355 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.191889524459839
Epoch: 22, Steps: 10 | Train Loss: 0.104 Vali Loss: 11.116 Vali Acc: 0.268 Test Loss: 11.116 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.6561830043792725
Epoch: 23, Steps: 10 | Train Loss: 0.117 Vali Loss: 11.739 Vali Acc: 0.269 Test Loss: 11.739 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 3224146
model size : 22.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.273077726364136
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.330 Vali Acc: 0.101 Test Loss: 3.330 Test Acc: 0.101
Validation loss decreased (inf --> -0.101143).  Saving model ...
Epoch: 2 cost time: 1.8297655582427979
Epoch: 2, Steps: 10 | Train Loss: 2.304 Vali Loss: 3.136 Vali Acc: 0.246 Test Loss: 3.136 Test Acc: 0.246
Validation loss decreased (-0.101143 --> -0.245851).  Saving model ...
Epoch: 3 cost time: 1.6552097797393799
Epoch: 3, Steps: 10 | Train Loss: 1.058 Vali Loss: 3.384 Vali Acc: 0.241 Test Loss: 3.384 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.8114550113677979
Epoch: 4, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.411 Vali Acc: 0.304 Test Loss: 3.411 Test Acc: 0.304
Validation loss decreased (-0.245851 --> -0.303495).  Saving model ...
Epoch: 5 cost time: 1.8452372550964355
Epoch: 5, Steps: 10 | Train Loss: 0.143 Vali Loss: 4.026 Vali Acc: 0.281 Test Loss: 4.026 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8727400302886963
Epoch: 6, Steps: 10 | Train Loss: 0.054 Vali Loss: 4.107 Vali Acc: 0.306 Test Loss: 4.107 Test Acc: 0.306
Validation loss decreased (-0.303495 --> -0.305841).  Saving model ...
Epoch: 7 cost time: 1.684849500656128
Epoch: 7, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.328 Vali Acc: 0.293 Test Loss: 4.328 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.842362403869629
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.427 Vali Acc: 0.306 Test Loss: 4.427 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.817317247390747
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.539 Vali Acc: 0.308 Test Loss: 4.539 Test Acc: 0.308
Validation loss decreased (-0.305841 --> -0.308190).  Saving model ...
Epoch: 10 cost time: 2.3473668098449707
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.496 Vali Acc: 0.309 Test Loss: 4.496 Test Acc: 0.309
Validation loss decreased (-0.308190 --> -0.309367).  Saving model ...
Epoch: 11 cost time: 1.9135408401489258
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.454 Vali Acc: 0.321 Test Loss: 4.454 Test Acc: 0.321
Validation loss decreased (-0.309367 --> -0.321132).  Saving model ...
Epoch: 12 cost time: 1.8868730068206787
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.414 Vali Acc: 0.326 Test Loss: 4.414 Test Acc: 0.326
Validation loss decreased (-0.321132 --> -0.325838).  Saving model ...
Epoch: 13 cost time: 1.717599630355835
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.393 Vali Acc: 0.331 Test Loss: 4.393 Test Acc: 0.331
Validation loss decreased (-0.325838 --> -0.330544).  Saving model ...
Epoch: 14 cost time: 2.1337547302246094
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.385 Vali Acc: 0.334 Test Loss: 4.385 Test Acc: 0.334
Validation loss decreased (-0.330544 --> -0.334074).  Saving model ...
Epoch: 15 cost time: 2.1142706871032715
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.387 Vali Acc: 0.332 Test Loss: 4.387 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.962740182876587
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.392 Vali Acc: 0.329 Test Loss: 4.392 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.8690502643585205
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.393 Vali Acc: 0.328 Test Loss: 4.393 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.0247128009796143
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.400 Vali Acc: 0.327 Test Loss: 4.400 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.0530004501342773
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.403 Vali Acc: 0.328 Test Loss: 4.403 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0003411769866943
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.411 Vali Acc: 0.329 Test Loss: 4.411 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.0891010761260986
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.417 Vali Acc: 0.329 Test Loss: 4.417 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.1199724674224854
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.424 Vali Acc: 0.331 Test Loss: 4.424 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9148931503295898
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.433 Vali Acc: 0.331 Test Loss: 4.433 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.912451982498169
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.438 Vali Acc: 0.329 Test Loss: 4.438 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 3224146
model size : 22.08MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.148695945739746
Epoch: 1, Steps: 10 | Train Loss: 3.439 Vali Loss: 3.317 Vali Acc: 0.079 Test Loss: 3.317 Test Acc: 0.079
Validation loss decreased (inf --> -0.078790).  Saving model ...
Epoch: 2 cost time: 1.4248762130737305
Epoch: 2, Steps: 10 | Train Loss: 2.520 Vali Loss: 3.373 Vali Acc: 0.191 Test Loss: 3.373 Test Acc: 0.191
Validation loss decreased (-0.078790 --> -0.190555).  Saving model ...
Epoch: 3 cost time: 1.4054265022277832
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.334 Vali Acc: 0.252 Test Loss: 3.334 Test Acc: 0.252
Validation loss decreased (-0.190555 --> -0.251731).  Saving model ...
Epoch: 4 cost time: 1.433725357055664
Epoch: 4, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.657 Vali Acc: 0.265 Test Loss: 3.657 Test Acc: 0.265
Validation loss decreased (-0.251731 --> -0.264669).  Saving model ...
Epoch: 5 cost time: 1.3530640602111816
Epoch: 5, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.883 Vali Acc: 0.301 Test Loss: 3.883 Test Acc: 0.301
Validation loss decreased (-0.264669 --> -0.301138).  Saving model ...
Epoch: 6 cost time: 1.577054500579834
Epoch: 6, Steps: 10 | Train Loss: 0.154 Vali Loss: 4.140 Vali Acc: 0.321 Test Loss: 4.140 Test Acc: 0.321
Validation loss decreased (-0.301138 --> -0.321135).  Saving model ...
Epoch: 7 cost time: 1.9392762184143066
Epoch: 7, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.541 Vali Acc: 0.289 Test Loss: 4.541 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6596946716308594
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.596 Vali Acc: 0.301 Test Loss: 4.596 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0208685398101807
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.712 Vali Acc: 0.320 Test Loss: 4.712 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.6780879497528076
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.861 Vali Acc: 0.318 Test Loss: 4.861 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.6922779083251953
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.000 Vali Acc: 0.325 Test Loss: 5.000 Test Acc: 0.325
Validation loss decreased (-0.321135 --> -0.324656).  Saving model ...
Epoch: 12 cost time: 1.793874740600586
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.071 Vali Acc: 0.308 Test Loss: 5.071 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.790884256362915
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.042 Vali Acc: 0.315 Test Loss: 5.042 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9136157035827637
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.022 Vali Acc: 0.327 Test Loss: 5.022 Test Acc: 0.327
Validation loss decreased (-0.324656 --> -0.327009).  Saving model ...
Epoch: 15 cost time: 1.8087966442108154
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.015 Vali Acc: 0.329 Test Loss: 5.015 Test Acc: 0.329
Validation loss decreased (-0.327009 --> -0.329362).  Saving model ...
Epoch: 16 cost time: 1.5101110935211182
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.012 Vali Acc: 0.332 Test Loss: 5.012 Test Acc: 0.332
Validation loss decreased (-0.329362 --> -0.331715).  Saving model ...
Epoch: 17 cost time: 1.6305444240570068
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.012 Vali Acc: 0.334 Test Loss: 5.012 Test Acc: 0.334
Validation loss decreased (-0.331715 --> -0.334068).  Saving model ...
Epoch: 18 cost time: 1.9268836975097656
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.004 Vali Acc: 0.342 Test Loss: 5.004 Test Acc: 0.342
Validation loss decreased (-0.334068 --> -0.342303).  Saving model ...
Epoch: 19 cost time: 2.009787082672119
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.999 Vali Acc: 0.341 Test Loss: 4.999 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7393226623535156
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.012 Vali Acc: 0.341 Test Loss: 5.012 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.777590274810791
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.019 Vali Acc: 0.336 Test Loss: 5.019 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9249515533447266
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.025 Vali Acc: 0.339 Test Loss: 5.025 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.52357816696167
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.032 Vali Acc: 0.339 Test Loss: 5.032 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5954411029815674
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.042 Vali Acc: 0.338 Test Loss: 5.042 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9119720458984375
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.048 Vali Acc: 0.339 Test Loss: 5.048 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.9807095527648926
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.055 Vali Acc: 0.340 Test Loss: 5.055 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.8614685535430908
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.066 Vali Acc: 0.339 Test Loss: 5.066 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8961830139160156
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.077 Vali Acc: 0.340 Test Loss: 5.077 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 3381586
model size : 17.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.1271843910217285
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.301 Vali Acc: 0.079 Test Loss: 3.301 Test Acc: 0.079
Validation loss decreased (inf --> -0.078791).  Saving model ...
Epoch: 2 cost time: 1.7576203346252441
Epoch: 2, Steps: 10 | Train Loss: 2.534 Vali Loss: 3.350 Vali Acc: 0.195 Test Loss: 3.350 Test Acc: 0.195
Validation loss decreased (-0.078791 --> -0.195261).  Saving model ...
Epoch: 3 cost time: 1.7413020133972168
Epoch: 3, Steps: 10 | Train Loss: 1.456 Vali Loss: 3.284 Vali Acc: 0.265 Test Loss: 3.284 Test Acc: 0.265
Validation loss decreased (-0.195261 --> -0.264673).  Saving model ...
Epoch: 4 cost time: 1.9209206104278564
Epoch: 4, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.591 Vali Acc: 0.271 Test Loss: 3.591 Test Acc: 0.271
Validation loss decreased (-0.264673 --> -0.270552).  Saving model ...
Epoch: 5 cost time: 1.7514266967773438
Epoch: 5, Steps: 10 | Train Loss: 0.354 Vali Loss: 3.817 Vali Acc: 0.293 Test Loss: 3.817 Test Acc: 0.293
Validation loss decreased (-0.270552 --> -0.292903).  Saving model ...
Epoch: 6 cost time: 1.801605224609375
Epoch: 6, Steps: 10 | Train Loss: 0.161 Vali Loss: 4.093 Vali Acc: 0.328 Test Loss: 4.093 Test Acc: 0.328
Validation loss decreased (-0.292903 --> -0.328194).  Saving model ...
Epoch: 7 cost time: 1.707120656967163
Epoch: 7, Steps: 10 | Train Loss: 0.106 Vali Loss: 4.356 Vali Acc: 0.304 Test Loss: 4.356 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7461566925048828
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.394 Vali Acc: 0.301 Test Loss: 4.394 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9910306930541992
Epoch: 9, Steps: 10 | Train Loss: 0.077 Vali Loss: 4.691 Vali Acc: 0.308 Test Loss: 4.691 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8646137714385986
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.730 Vali Acc: 0.321 Test Loss: 4.730 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.771477222442627
Epoch: 11, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.784 Vali Acc: 0.318 Test Loss: 4.784 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.8141465187072754
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.915 Vali Acc: 0.326 Test Loss: 4.915 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.7440428733825684
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.862 Vali Acc: 0.332 Test Loss: 4.862 Test Acc: 0.332
Validation loss decreased (-0.328194 --> -0.331716).  Saving model ...
Epoch: 14 cost time: 1.8815598487854004
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.836 Vali Acc: 0.339 Test Loss: 4.836 Test Acc: 0.339
Validation loss decreased (-0.331716 --> -0.338775).  Saving model ...
Epoch: 15 cost time: 1.7648987770080566
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.828 Vali Acc: 0.339 Test Loss: 4.828 Test Acc: 0.339
Validation loss decreased (-0.338775 --> -0.338775).  Saving model ...
Epoch: 16 cost time: 1.7983245849609375
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.839 Vali Acc: 0.340 Test Loss: 4.839 Test Acc: 0.340
Validation loss decreased (-0.338775 --> -0.339952).  Saving model ...
Epoch: 17 cost time: 1.8232665061950684
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.857 Vali Acc: 0.338 Test Loss: 4.857 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7627124786376953
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.866 Vali Acc: 0.340 Test Loss: 4.866 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5698130130767822
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.872 Vali Acc: 0.340 Test Loss: 4.872 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6623268127441406
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.887 Vali Acc: 0.340 Test Loss: 4.887 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6634752750396729
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.899 Vali Acc: 0.339 Test Loss: 4.899 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6259360313415527
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.907 Vali Acc: 0.340 Test Loss: 4.907 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6612379550933838
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.918 Vali Acc: 0.339 Test Loss: 4.918 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.8526053428649902
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.928 Vali Acc: 0.340 Test Loss: 4.928 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.923126220703125
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.935 Vali Acc: 0.341 Test Loss: 4.935 Test Acc: 0.341
Validation loss decreased (-0.339952 --> -0.341127).  Saving model ...
Epoch: 26 cost time: 1.6490612030029297
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.938 Vali Acc: 0.341 Test Loss: 4.938 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.783808708190918
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.941 Vali Acc: 0.340 Test Loss: 4.941 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.796823263168335
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.955 Vali Acc: 0.340 Test Loss: 4.955 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.668823480606079
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.963 Vali Acc: 0.342 Test Loss: 4.963 Test Acc: 0.342
Validation loss decreased (-0.341127 --> -0.342303).  Saving model ...
Epoch: 30 cost time: 1.7816362380981445
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.973 Vali Acc: 0.341 Test Loss: 4.973 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.844991683959961
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.982 Vali Acc: 0.341 Test Loss: 4.982 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.935067892074585
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.989 Vali Acc: 0.341 Test Loss: 4.989 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.3120110034942627
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.995 Vali Acc: 0.342 Test Loss: 4.995 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.015531063079834
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.006 Vali Acc: 0.341 Test Loss: 5.006 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8922841548919678
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.015 Vali Acc: 0.341 Test Loss: 5.015 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.0326974391937256
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.025 Vali Acc: 0.345 Test Loss: 5.025 Test Acc: 0.345
Validation loss decreased (-0.342303 --> -0.344656).  Saving model ...
Epoch: 37 cost time: 1.8503847122192383
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.025 Vali Acc: 0.344 Test Loss: 5.025 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.6864933967590332
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.031 Vali Acc: 0.342 Test Loss: 5.031 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.8043599128723145
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.035 Vali Acc: 0.342 Test Loss: 5.035 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.8337898254394531
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.047 Vali Acc: 0.341 Test Loss: 5.047 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.85337495803833
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.053 Vali Acc: 0.344 Test Loss: 5.053 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.8620994091033936
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.062 Vali Acc: 0.344 Test Loss: 5.062 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7063138484954834
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.068 Vali Acc: 0.345 Test Loss: 5.068 Test Acc: 0.345
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.8641228675842285
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.075 Vali Acc: 0.344 Test Loss: 5.075 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.9311740398406982
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.077 Vali Acc: 0.344 Test Loss: 5.077 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.9013662338256836
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.085 Vali Acc: 0.344 Test Loss: 5.085 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 3381586
model size : 17.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9414281845092773
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.284 Vali Acc: 0.075 Test Loss: 3.284 Test Acc: 0.075
Validation loss decreased (inf --> -0.075261).  Saving model ...
Epoch: 2 cost time: 1.4752764701843262
Epoch: 2, Steps: 10 | Train Loss: 2.578 Vali Loss: 3.320 Vali Acc: 0.198 Test Loss: 3.320 Test Acc: 0.198
Validation loss decreased (-0.075261 --> -0.197614).  Saving model ...
Epoch: 3 cost time: 1.8092930316925049
Epoch: 3, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.195 Vali Acc: 0.265 Test Loss: 3.195 Test Acc: 0.265
Validation loss decreased (-0.197614 --> -0.264674).  Saving model ...
Epoch: 4 cost time: 1.5903847217559814
Epoch: 4, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.455 Vali Acc: 0.278 Test Loss: 3.455 Test Acc: 0.278
Validation loss decreased (-0.264674 --> -0.277613).  Saving model ...
Epoch: 5 cost time: 1.958552360534668
Epoch: 5, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.634 Vali Acc: 0.292 Test Loss: 3.634 Test Acc: 0.292
Validation loss decreased (-0.277613 --> -0.291728).  Saving model ...
Epoch: 6 cost time: 1.8402602672576904
Epoch: 6, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.867 Vali Acc: 0.328 Test Loss: 3.867 Test Acc: 0.328
Validation loss decreased (-0.291728 --> -0.328197).  Saving model ...
Epoch: 7 cost time: 1.8935234546661377
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.081 Vali Acc: 0.306 Test Loss: 4.081 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6784768104553223
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.087 Vali Acc: 0.314 Test Loss: 4.087 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8697385787963867
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.336 Vali Acc: 0.335 Test Loss: 4.336 Test Acc: 0.335
Validation loss decreased (-0.328197 --> -0.335251).  Saving model ...
Epoch: 10 cost time: 1.703428030014038
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.427 Vali Acc: 0.321 Test Loss: 4.427 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.635859489440918
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.428 Vali Acc: 0.332 Test Loss: 4.428 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8710706233978271
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.457 Vali Acc: 0.334 Test Loss: 4.457 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.012256622314453
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.480 Vali Acc: 0.335 Test Loss: 4.480 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.652850866317749
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.476 Vali Acc: 0.340 Test Loss: 4.476 Test Acc: 0.340
Validation loss decreased (-0.335251 --> -0.339955).  Saving model ...
Epoch: 15 cost time: 1.5030136108398438
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.474 Vali Acc: 0.340 Test Loss: 4.474 Test Acc: 0.340
Validation loss decreased (-0.339955 --> -0.339955).  Saving model ...
Epoch: 16 cost time: 1.6100447177886963
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.487 Vali Acc: 0.340 Test Loss: 4.487 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.401113510131836
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.503 Vali Acc: 0.344 Test Loss: 4.503 Test Acc: 0.344
Validation loss decreased (-0.339955 --> -0.343484).  Saving model ...
Epoch: 18 cost time: 1.886589765548706
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.508 Vali Acc: 0.345 Test Loss: 4.508 Test Acc: 0.345
Validation loss decreased (-0.343484 --> -0.344661).  Saving model ...
Epoch: 19 cost time: 1.5474417209625244
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.513 Vali Acc: 0.345 Test Loss: 4.513 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.700955867767334
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.527 Vali Acc: 0.342 Test Loss: 4.527 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.890582799911499
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.538 Vali Acc: 0.341 Test Loss: 4.538 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.9740936756134033
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.550 Vali Acc: 0.340 Test Loss: 4.550 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.1012749671936035
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.560 Vali Acc: 0.344 Test Loss: 4.560 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.7462880611419678
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.570 Vali Acc: 0.345 Test Loss: 4.570 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.6433048248291016
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.573 Vali Acc: 0.347 Test Loss: 4.573 Test Acc: 0.347
Validation loss decreased (-0.344661 --> -0.347013).  Saving model ...
Epoch: 26 cost time: 1.7677645683288574
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.578 Vali Acc: 0.348 Test Loss: 4.578 Test Acc: 0.348
Validation loss decreased (-0.347013 --> -0.348190).  Saving model ...
Epoch: 27 cost time: 1.6975665092468262
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.588 Vali Acc: 0.349 Test Loss: 4.588 Test Acc: 0.349
Validation loss decreased (-0.348190 --> -0.349366).  Saving model ...
Epoch: 28 cost time: 1.7408788204193115
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.603 Vali Acc: 0.351 Test Loss: 4.603 Test Acc: 0.351
Validation loss decreased (-0.349366 --> -0.350542).  Saving model ...
Epoch: 29 cost time: 1.8164160251617432
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.615 Vali Acc: 0.351 Test Loss: 4.615 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8564116954803467
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.624 Vali Acc: 0.352 Test Loss: 4.624 Test Acc: 0.352
Validation loss decreased (-0.350542 --> -0.351718).  Saving model ...
Epoch: 31 cost time: 1.7915453910827637
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.632 Vali Acc: 0.352 Test Loss: 4.632 Test Acc: 0.352
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7876977920532227
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.639 Vali Acc: 0.351 Test Loss: 4.639 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.0191028118133545
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.647 Vali Acc: 0.349 Test Loss: 4.647 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7336924076080322
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.654 Vali Acc: 0.352 Test Loss: 4.654 Test Acc: 0.352
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.88956880569458
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.662 Vali Acc: 0.352 Test Loss: 4.662 Test Acc: 0.352
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7485787868499756
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.673 Vali Acc: 0.351 Test Loss: 4.673 Test Acc: 0.351
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.5468871593475342
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.680 Vali Acc: 0.353 Test Loss: 4.680 Test Acc: 0.353
Validation loss decreased (-0.351718 --> -0.352894).  Saving model ...
Epoch: 38 cost time: 1.699481725692749
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.688 Vali Acc: 0.349 Test Loss: 4.688 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 1.8633232116699219
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.695 Vali Acc: 0.348 Test Loss: 4.695 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 1.9557416439056396
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.707 Vali Acc: 0.348 Test Loss: 4.707 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.8610799312591553
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.714 Vali Acc: 0.348 Test Loss: 4.714 Test Acc: 0.348
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 1.8233544826507568
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.723 Vali Acc: 0.351 Test Loss: 4.723 Test Acc: 0.351
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 1.7268061637878418
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.727 Vali Acc: 0.349 Test Loss: 4.727 Test Acc: 0.349
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.1050243377685547
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.731 Vali Acc: 0.349 Test Loss: 4.731 Test Acc: 0.349
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.0188794136047363
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.735 Vali Acc: 0.349 Test Loss: 4.735 Test Acc: 0.349
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.7949731349945068
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.742 Vali Acc: 0.352 Test Loss: 4.742 Test Acc: 0.352
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.6710317134857178
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.749 Vali Acc: 0.351 Test Loss: 4.749 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35294117647058826
model parameter : 3381586
model size : 17.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.082062244415283
Epoch: 1, Steps: 10 | Train Loss: 3.323 Vali Loss: 3.248 Vali Acc: 0.078 Test Loss: 3.248 Test Acc: 0.078
Validation loss decreased (inf --> -0.077615).  Saving model ...
Epoch: 2 cost time: 1.840827226638794
Epoch: 2, Steps: 10 | Train Loss: 2.739 Vali Loss: 3.252 Vali Acc: 0.193 Test Loss: 3.252 Test Acc: 0.193
Validation loss decreased (-0.077615 --> -0.192909).  Saving model ...
Epoch: 3 cost time: 1.494577169418335
Epoch: 3, Steps: 10 | Train Loss: 1.725 Vali Loss: 3.013 Vali Acc: 0.246 Test Loss: 3.013 Test Acc: 0.246
Validation loss decreased (-0.192909 --> -0.245852).  Saving model ...
Epoch: 4 cost time: 1.684845209121704
Epoch: 4, Steps: 10 | Train Loss: 0.959 Vali Loss: 3.103 Vali Acc: 0.267 Test Loss: 3.103 Test Acc: 0.267
Validation loss decreased (-0.245852 --> -0.267028).  Saving model ...
Epoch: 5 cost time: 1.7596855163574219
Epoch: 5, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.155 Vali Acc: 0.300 Test Loss: 3.155 Test Acc: 0.300
Validation loss decreased (-0.267028 --> -0.299968).  Saving model ...
Epoch: 6 cost time: 1.6427791118621826
Epoch: 6, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.291 Vali Acc: 0.320 Test Loss: 3.291 Test Acc: 0.320
Validation loss decreased (-0.299968 --> -0.319967).  Saving model ...
Epoch: 7 cost time: 1.6942510604858398
Epoch: 7, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.527 Vali Acc: 0.307 Test Loss: 3.527 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9427292346954346
Epoch: 8, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.561 Vali Acc: 0.316 Test Loss: 3.561 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9693245887756348
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.604 Vali Acc: 0.327 Test Loss: 3.604 Test Acc: 0.327
Validation loss decreased (-0.319967 --> -0.327023).  Saving model ...
Epoch: 10 cost time: 2.1776440143585205
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.669 Vali Acc: 0.342 Test Loss: 3.669 Test Acc: 0.342
Validation loss decreased (-0.327023 --> -0.342316).  Saving model ...
Epoch: 11 cost time: 1.7327384948730469
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.776 Vali Acc: 0.331 Test Loss: 3.776 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9383840560913086
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.784 Vali Acc: 0.336 Test Loss: 3.784 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9953045845031738
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.778 Vali Acc: 0.335 Test Loss: 3.778 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8344197273254395
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.788 Vali Acc: 0.342 Test Loss: 3.788 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.8100237846374512
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.796 Vali Acc: 0.345 Test Loss: 3.796 Test Acc: 0.345
Validation loss decreased (-0.342316 --> -0.344668).  Saving model ...
Epoch: 16 cost time: 1.8133375644683838
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.810 Vali Acc: 0.344 Test Loss: 3.810 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9356601238250732
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.825 Vali Acc: 0.345 Test Loss: 3.825 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.101592540740967
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.833 Vali Acc: 0.340 Test Loss: 3.833 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9588489532470703
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.837 Vali Acc: 0.344 Test Loss: 3.837 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0504109859466553
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.853 Vali Acc: 0.341 Test Loss: 3.853 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1361827850341797
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.864 Vali Acc: 0.342 Test Loss: 3.864 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7760531902313232
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.881 Vali Acc: 0.340 Test Loss: 3.881 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.041759729385376
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.898 Vali Acc: 0.344 Test Loss: 3.898 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.8448119163513184
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.913 Vali Acc: 0.340 Test Loss: 3.913 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.942260980606079
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.926 Vali Acc: 0.338 Test Loss: 3.926 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 3381586
model size : 17.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.709473133087158
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.305 Vali Acc: 0.079 Test Loss: 3.305 Test Acc: 0.079
Validation loss decreased (inf --> -0.078790).  Saving model ...
Epoch: 2 cost time: 1.794668436050415
Epoch: 2, Steps: 10 | Train Loss: 2.619 Vali Loss: 3.373 Vali Acc: 0.174 Test Loss: 3.373 Test Acc: 0.174
Validation loss decreased (-0.078790 --> -0.174084).  Saving model ...
Epoch: 3 cost time: 1.6623780727386475
Epoch: 3, Steps: 10 | Train Loss: 1.425 Vali Loss: 3.299 Vali Acc: 0.249 Test Loss: 3.299 Test Acc: 0.249
Validation loss decreased (-0.174084 --> -0.249379).  Saving model ...
Epoch: 4 cost time: 1.5262560844421387
Epoch: 4, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.693 Vali Acc: 0.286 Test Loss: 3.693 Test Acc: 0.286
Validation loss decreased (-0.249379 --> -0.285845).  Saving model ...
Epoch: 5 cost time: 1.594001054763794
Epoch: 5, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.803 Vali Acc: 0.298 Test Loss: 3.803 Test Acc: 0.298
Validation loss decreased (-0.285845 --> -0.297609).  Saving model ...
Epoch: 6 cost time: 1.6378746032714844
Epoch: 6, Steps: 10 | Train Loss: 0.135 Vali Loss: 4.158 Vali Acc: 0.312 Test Loss: 4.158 Test Acc: 0.312
Validation loss decreased (-0.297609 --> -0.311723).  Saving model ...
Epoch: 7 cost time: 1.585277795791626
Epoch: 7, Steps: 10 | Train Loss: 0.116 Vali Loss: 4.498 Vali Acc: 0.305 Test Loss: 4.498 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.768754243850708
Epoch: 8, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.457 Vali Acc: 0.320 Test Loss: 4.457 Test Acc: 0.320
Validation loss decreased (-0.311723 --> -0.319955).  Saving model ...
Epoch: 9 cost time: 1.5857832431793213
Epoch: 9, Steps: 10 | Train Loss: 0.055 Vali Loss: 4.901 Vali Acc: 0.321 Test Loss: 4.901 Test Acc: 0.321
Validation loss decreased (-0.319955 --> -0.321127).  Saving model ...
Epoch: 10 cost time: 1.8890557289123535
Epoch: 10, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.837 Vali Acc: 0.339 Test Loss: 4.837 Test Acc: 0.339
Validation loss decreased (-0.321127 --> -0.338775).  Saving model ...
Epoch: 11 cost time: 2.0013303756713867
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.840 Vali Acc: 0.333 Test Loss: 4.840 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8073313236236572
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.883 Vali Acc: 0.338 Test Loss: 4.883 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.0266189575195312
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.050 Vali Acc: 0.336 Test Loss: 5.050 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.790184736251831
Epoch: 14, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.043 Vali Acc: 0.336 Test Loss: 5.043 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7379686832427979
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.016 Vali Acc: 0.340 Test Loss: 5.016 Test Acc: 0.340
Validation loss decreased (-0.338775 --> -0.339950).  Saving model ...
Epoch: 16 cost time: 1.672044038772583
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.265 Vali Acc: 0.324 Test Loss: 5.265 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6842987537384033
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.186 Vali Acc: 0.336 Test Loss: 5.186 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.055513381958008
Epoch: 18, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.177 Vali Acc: 0.342 Test Loss: 5.177 Test Acc: 0.342
Validation loss decreased (-0.339950 --> -0.342301).  Saving model ...
Epoch: 19 cost time: 1.646897792816162
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.227 Vali Acc: 0.335 Test Loss: 5.227 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9231629371643066
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.152 Vali Acc: 0.335 Test Loss: 5.152 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.764859914779663
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.100 Vali Acc: 0.342 Test Loss: 5.100 Test Acc: 0.342
Validation loss decreased (-0.342301 --> -0.342302).  Saving model ...
Epoch: 22 cost time: 1.8137922286987305
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.074 Vali Acc: 0.344 Test Loss: 5.074 Test Acc: 0.344
Validation loss decreased (-0.342302 --> -0.343479).  Saving model ...
Epoch: 23 cost time: 1.6454739570617676
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.089 Vali Acc: 0.341 Test Loss: 5.089 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.6486577987670898
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.116 Vali Acc: 0.345 Test Loss: 5.116 Test Acc: 0.345
Validation loss decreased (-0.343479 --> -0.344655).  Saving model ...
Epoch: 25 cost time: 1.7333717346191406
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.127 Vali Acc: 0.345 Test Loss: 5.127 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.6337766647338867
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.148 Vali Acc: 0.344 Test Loss: 5.148 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.828406572341919
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.163 Vali Acc: 0.346 Test Loss: 5.163 Test Acc: 0.346
Validation loss decreased (-0.344655 --> -0.345831).  Saving model ...
Epoch: 28 cost time: 1.8653016090393066
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.173 Vali Acc: 0.348 Test Loss: 5.173 Test Acc: 0.348
Validation loss decreased (-0.345831 --> -0.348184).  Saving model ...
Epoch: 29 cost time: 1.9349250793457031
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.178 Vali Acc: 0.348 Test Loss: 5.178 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 2.031893253326416
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.188 Vali Acc: 0.349 Test Loss: 5.188 Test Acc: 0.349
Validation loss decreased (-0.348184 --> -0.349360).  Saving model ...
Epoch: 31 cost time: 1.8319690227508545
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.194 Vali Acc: 0.348 Test Loss: 5.194 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.7340419292449951
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.203 Vali Acc: 0.349 Test Loss: 5.203 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6767182350158691
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.214 Vali Acc: 0.349 Test Loss: 5.214 Test Acc: 0.349
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.7593252658843994
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.219 Vali Acc: 0.349 Test Loss: 5.219 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.8005938529968262
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.231 Vali Acc: 0.349 Test Loss: 5.231 Test Acc: 0.349
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.7010622024536133
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.243 Vali Acc: 0.351 Test Loss: 5.243 Test Acc: 0.351
Validation loss decreased (-0.349360 --> -0.350536).  Saving model ...
Epoch: 37 cost time: 1.9830307960510254
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.260 Vali Acc: 0.351 Test Loss: 5.260 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.8169631958007812
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.274 Vali Acc: 0.351 Test Loss: 5.274 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.7478992938995361
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.280 Vali Acc: 0.348 Test Loss: 5.280 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.6941421031951904
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.285 Vali Acc: 0.349 Test Loss: 5.285 Test Acc: 0.349
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.78117036819458
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.290 Vali Acc: 0.349 Test Loss: 5.290 Test Acc: 0.349
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.7440268993377686
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.296 Vali Acc: 0.347 Test Loss: 5.296 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.7435433864593506
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.303 Vali Acc: 0.346 Test Loss: 5.303 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.7456560134887695
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.312 Vali Acc: 0.349 Test Loss: 5.312 Test Acc: 0.349
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.6053383350372314
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.320 Vali Acc: 0.351 Test Loss: 5.320 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.933870553970337
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.328 Vali Acc: 0.351 Test Loss: 5.328 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 2333010
model size : 13.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.205869674682617
Epoch: 1, Steps: 10 | Train Loss: 3.340 Vali Loss: 3.298 Vali Acc: 0.076 Test Loss: 3.298 Test Acc: 0.076
Validation loss decreased (inf --> -0.076438).  Saving model ...
Epoch: 2 cost time: 1.7423415184020996
Epoch: 2, Steps: 10 | Train Loss: 2.615 Vali Loss: 3.357 Vali Acc: 0.182 Test Loss: 3.357 Test Acc: 0.182
Validation loss decreased (-0.076438 --> -0.182319).  Saving model ...
Epoch: 3 cost time: 1.7300801277160645
Epoch: 3, Steps: 10 | Train Loss: 1.480 Vali Loss: 3.259 Vali Acc: 0.269 Test Loss: 3.259 Test Acc: 0.269
Validation loss decreased (-0.182319 --> -0.269379).  Saving model ...
Epoch: 4 cost time: 1.513507604598999
Epoch: 4, Steps: 10 | Train Loss: 0.787 Vali Loss: 3.613 Vali Acc: 0.286 Test Loss: 3.613 Test Acc: 0.286
Validation loss decreased (-0.269379 --> -0.285846).  Saving model ...
Epoch: 5 cost time: 1.7017035484313965
Epoch: 5, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.709 Vali Acc: 0.304 Test Loss: 3.709 Test Acc: 0.304
Validation loss decreased (-0.285846 --> -0.303492).  Saving model ...
Epoch: 6 cost time: 1.7138597965240479
Epoch: 6, Steps: 10 | Train Loss: 0.140 Vali Loss: 4.016 Vali Acc: 0.319 Test Loss: 4.016 Test Acc: 0.319
Validation loss decreased (-0.303492 --> -0.318783).  Saving model ...
Epoch: 7 cost time: 1.8289382457733154
Epoch: 7, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.387 Vali Acc: 0.309 Test Loss: 4.387 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6512811183929443
Epoch: 8, Steps: 10 | Train Loss: 0.074 Vali Loss: 4.387 Vali Acc: 0.322 Test Loss: 4.387 Test Acc: 0.322
Validation loss decreased (-0.318783 --> -0.322309).  Saving model ...
Epoch: 9 cost time: 1.6946299076080322
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.862 Vali Acc: 0.319 Test Loss: 4.862 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7137722969055176
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.684 Vali Acc: 0.321 Test Loss: 4.684 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8680193424224854
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.719 Vali Acc: 0.332 Test Loss: 4.719 Test Acc: 0.332
Validation loss decreased (-0.322309 --> -0.331718).  Saving model ...
Epoch: 12 cost time: 1.5374534130096436
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.665 Vali Acc: 0.340 Test Loss: 4.665 Test Acc: 0.340
Validation loss decreased (-0.331718 --> -0.339953).  Saving model ...
Epoch: 13 cost time: 1.68001127243042
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.693 Vali Acc: 0.340 Test Loss: 4.693 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5972843170166016
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.733 Vali Acc: 0.339 Test Loss: 4.733 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7093849182128906
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.756 Vali Acc: 0.338 Test Loss: 4.756 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.625377893447876
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.780 Vali Acc: 0.340 Test Loss: 4.780 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.684680461883545
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.795 Vali Acc: 0.342 Test Loss: 4.795 Test Acc: 0.342
Validation loss decreased (-0.339953 --> -0.342305).  Saving model ...
Epoch: 18 cost time: 1.4828171730041504
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.812 Vali Acc: 0.342 Test Loss: 4.812 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.577043056488037
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.823 Vali Acc: 0.338 Test Loss: 4.823 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5851483345031738
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.824 Vali Acc: 0.339 Test Loss: 4.824 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5883026123046875
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.829 Vali Acc: 0.339 Test Loss: 4.829 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.4559879302978516
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.841 Vali Acc: 0.340 Test Loss: 4.841 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5992257595062256
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.858 Vali Acc: 0.346 Test Loss: 4.858 Test Acc: 0.346
Validation loss decreased (-0.342305 --> -0.345834).  Saving model ...
Epoch: 24 cost time: 1.6360645294189453
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.876 Vali Acc: 0.345 Test Loss: 4.876 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.7714807987213135
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.882 Vali Acc: 0.342 Test Loss: 4.882 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9162826538085938
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.905 Vali Acc: 0.345 Test Loss: 4.905 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.0748002529144287
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.923 Vali Acc: 0.346 Test Loss: 4.923 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.163233995437622
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.931 Vali Acc: 0.346 Test Loss: 4.931 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.7817559242248535
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.941 Vali Acc: 0.349 Test Loss: 4.941 Test Acc: 0.349
Validation loss decreased (-0.345834 --> -0.349362).  Saving model ...
Epoch: 30 cost time: 2.0103487968444824
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.944 Vali Acc: 0.340 Test Loss: 4.944 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.9092469215393066
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.950 Vali Acc: 0.339 Test Loss: 4.950 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.9802405834197998
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.964 Vali Acc: 0.346 Test Loss: 4.964 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.7394278049468994
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.977 Vali Acc: 0.347 Test Loss: 4.977 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.9954135417938232
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.984 Vali Acc: 0.348 Test Loss: 4.984 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.8088386058807373
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.993 Vali Acc: 0.347 Test Loss: 4.993 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.1090145111083984
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.005 Vali Acc: 0.348 Test Loss: 5.005 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.879716157913208
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.022 Vali Acc: 0.348 Test Loss: 5.022 Test Acc: 0.348
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.060328960418701
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.037 Vali Acc: 0.347 Test Loss: 5.037 Test Acc: 0.347
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.187520742416382
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.044 Vali Acc: 0.346 Test Loss: 5.044 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 2333010
model size : 13.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.036011219024658
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.283 Vali Acc: 0.087 Test Loss: 3.283 Test Acc: 0.087
Validation loss decreased (inf --> -0.087026).  Saving model ...
Epoch: 2 cost time: 1.569331407546997
Epoch: 2, Steps: 10 | Train Loss: 2.636 Vali Loss: 3.323 Vali Acc: 0.178 Test Loss: 3.323 Test Acc: 0.178
Validation loss decreased (-0.087026 --> -0.177614).  Saving model ...
Epoch: 3 cost time: 1.6571226119995117
Epoch: 3, Steps: 10 | Train Loss: 1.554 Vali Loss: 3.186 Vali Acc: 0.267 Test Loss: 3.186 Test Acc: 0.267
Validation loss decreased (-0.177614 --> -0.267027).  Saving model ...
Epoch: 4 cost time: 1.6850008964538574
Epoch: 4, Steps: 10 | Train Loss: 0.797 Vali Loss: 3.497 Vali Acc: 0.259 Test Loss: 3.497 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7846264839172363
Epoch: 5, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.539 Vali Acc: 0.313 Test Loss: 3.539 Test Acc: 0.313
Validation loss decreased (-0.267027 --> -0.312906).  Saving model ...
Epoch: 6 cost time: 1.612391710281372
Epoch: 6, Steps: 10 | Train Loss: 0.133 Vali Loss: 3.825 Vali Acc: 0.321 Test Loss: 3.825 Test Acc: 0.321
Validation loss decreased (-0.312906 --> -0.321138).  Saving model ...
Epoch: 7 cost time: 1.5957999229431152
Epoch: 7, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.187 Vali Acc: 0.316 Test Loss: 4.187 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.911106824874878
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.139 Vali Acc: 0.328 Test Loss: 4.139 Test Acc: 0.328
Validation loss decreased (-0.321138 --> -0.328194).  Saving model ...
Epoch: 9 cost time: 1.9294579029083252
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.580 Vali Acc: 0.313 Test Loss: 4.580 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6340315341949463
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.522 Vali Acc: 0.333 Test Loss: 4.522 Test Acc: 0.333
Validation loss decreased (-0.328194 --> -0.332896).  Saving model ...
Epoch: 11 cost time: 1.6514317989349365
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.457 Vali Acc: 0.326 Test Loss: 4.457 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5383484363555908
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.464 Vali Acc: 0.329 Test Loss: 4.464 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7432928085327148
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.470 Vali Acc: 0.332 Test Loss: 4.470 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.672051191329956
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.484 Vali Acc: 0.340 Test Loss: 4.484 Test Acc: 0.340
Validation loss decreased (-0.332896 --> -0.339955).  Saving model ...
Epoch: 15 cost time: 1.7921016216278076
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.497 Vali Acc: 0.341 Test Loss: 4.497 Test Acc: 0.341
Validation loss decreased (-0.339955 --> -0.341131).  Saving model ...
Epoch: 16 cost time: 1.8734750747680664
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.512 Vali Acc: 0.346 Test Loss: 4.512 Test Acc: 0.346
Validation loss decreased (-0.341131 --> -0.345837).  Saving model ...
Epoch: 17 cost time: 1.7399652004241943
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.522 Vali Acc: 0.341 Test Loss: 4.522 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5712549686431885
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.535 Vali Acc: 0.341 Test Loss: 4.535 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5150837898254395
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.548 Vali Acc: 0.339 Test Loss: 4.548 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.7457900047302246
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.552 Vali Acc: 0.339 Test Loss: 4.552 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8869547843933105
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.565 Vali Acc: 0.340 Test Loss: 4.565 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6182465553283691
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.579 Vali Acc: 0.338 Test Loss: 4.579 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.6924095153808594
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.594 Vali Acc: 0.338 Test Loss: 4.594 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.714000940322876
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.610 Vali Acc: 0.338 Test Loss: 4.610 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.751023769378662
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.617 Vali Acc: 0.338 Test Loss: 4.617 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.7271113395690918
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.338 Test Loss: 4.634 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 2333010
model size : 13.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.948261022567749
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.261 Vali Acc: 0.091 Test Loss: 3.261 Test Acc: 0.091
Validation loss decreased (inf --> -0.090556).  Saving model ...
Epoch: 2 cost time: 1.4204931259155273
Epoch: 2, Steps: 10 | Train Loss: 2.743 Vali Loss: 3.258 Vali Acc: 0.162 Test Loss: 3.258 Test Acc: 0.162
Validation loss decreased (-0.090556 --> -0.162320).  Saving model ...
Epoch: 3 cost time: 1.370652437210083
Epoch: 3, Steps: 10 | Train Loss: 1.773 Vali Loss: 3.021 Vali Acc: 0.264 Test Loss: 3.021 Test Acc: 0.264
Validation loss decreased (-0.162320 --> -0.263499).  Saving model ...
Epoch: 4 cost time: 1.3046560287475586
Epoch: 4, Steps: 10 | Train Loss: 0.974 Vali Loss: 3.146 Vali Acc: 0.264 Test Loss: 3.146 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.493178129196167
Epoch: 5, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.157 Vali Acc: 0.316 Test Loss: 3.157 Test Acc: 0.316
Validation loss decreased (-0.263499 --> -0.316439).  Saving model ...
Epoch: 6 cost time: 1.6037702560424805
Epoch: 6, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.279 Vali Acc: 0.322 Test Loss: 3.279 Test Acc: 0.322
Validation loss decreased (-0.316439 --> -0.322320).  Saving model ...
Epoch: 7 cost time: 1.5615386962890625
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.527 Vali Acc: 0.325 Test Loss: 3.527 Test Acc: 0.325
Validation loss decreased (-0.322320 --> -0.324671).  Saving model ...
Epoch: 8 cost time: 1.7091305255889893
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.648 Vali Acc: 0.312 Test Loss: 3.648 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.515171766281128
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.757 Vali Acc: 0.305 Test Loss: 3.757 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3614492416381836
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.866 Vali Acc: 0.309 Test Loss: 3.866 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2060823440551758
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.781 Vali Acc: 0.324 Test Loss: 3.781 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4851024150848389
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.779 Vali Acc: 0.331 Test Loss: 3.779 Test Acc: 0.331
Validation loss decreased (-0.324671 --> -0.330550).  Saving model ...
Epoch: 13 cost time: 1.7104575634002686
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.790 Vali Acc: 0.327 Test Loss: 3.790 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8850712776184082
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.810 Vali Acc: 0.322 Test Loss: 3.810 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5904483795166016
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.836 Vali Acc: 0.332 Test Loss: 3.836 Test Acc: 0.332
Validation loss decreased (-0.330550 --> -0.331726).  Saving model ...
Epoch: 16 cost time: 1.6330647468566895
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.858 Vali Acc: 0.331 Test Loss: 3.858 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8146727085113525
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.873 Vali Acc: 0.326 Test Loss: 3.873 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5619628429412842
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.884 Vali Acc: 0.331 Test Loss: 3.884 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5348408222198486
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.906 Vali Acc: 0.333 Test Loss: 3.906 Test Acc: 0.333
Validation loss decreased (-0.331726 --> -0.332902).  Saving model ...
Epoch: 20 cost time: 1.6910197734832764
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.914 Vali Acc: 0.333 Test Loss: 3.914 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5015122890472412
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.923 Vali Acc: 0.333 Test Loss: 3.923 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5583381652832031
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.931 Vali Acc: 0.329 Test Loss: 3.931 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.6842310428619385
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.945 Vali Acc: 0.333 Test Loss: 3.945 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4826934337615967
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.960 Vali Acc: 0.331 Test Loss: 3.960 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.505171775817871
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.972 Vali Acc: 0.332 Test Loss: 3.972 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.374190330505371
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 3.989 Vali Acc: 0.332 Test Loss: 3.989 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.336411476135254
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.009 Vali Acc: 0.334 Test Loss: 4.009 Test Acc: 0.334
Validation loss decreased (-0.332902 --> -0.334078).  Saving model ...
Epoch: 28 cost time: 1.5088040828704834
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.019 Vali Acc: 0.334 Test Loss: 4.019 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.6321916580200195
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.026 Vali Acc: 0.332 Test Loss: 4.026 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.6514091491699219
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.035 Vali Acc: 0.329 Test Loss: 4.035 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.8131964206695557
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.043 Vali Acc: 0.329 Test Loss: 4.043 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.709801197052002
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.054 Vali Acc: 0.334 Test Loss: 4.054 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.533515214920044
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.060 Vali Acc: 0.336 Test Loss: 4.060 Test Acc: 0.336
Validation loss decreased (-0.334078 --> -0.336430).  Saving model ...
Epoch: 34 cost time: 1.5974643230438232
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.068 Vali Acc: 0.340 Test Loss: 4.068 Test Acc: 0.340
Validation loss decreased (-0.336430 --> -0.339959).  Saving model ...
Epoch: 35 cost time: 1.5800490379333496
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.084 Vali Acc: 0.339 Test Loss: 4.084 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7321186065673828
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.096 Vali Acc: 0.338 Test Loss: 4.096 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.8991665840148926
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.110 Vali Acc: 0.335 Test Loss: 4.110 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6821398735046387
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.121 Vali Acc: 0.333 Test Loss: 4.121 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.8488433361053467
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.128 Vali Acc: 0.335 Test Loss: 4.128 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.777226209640503
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.142 Vali Acc: 0.334 Test Loss: 4.142 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4649574756622314
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.150 Vali Acc: 0.335 Test Loss: 4.150 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.6216576099395752
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.161 Vali Acc: 0.336 Test Loss: 4.161 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.6441924571990967
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.169 Vali Acc: 0.338 Test Loss: 4.169 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.3698875904083252
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.176 Vali Acc: 0.340 Test Loss: 4.176 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 2333010
model size : 13.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.8780877590179443
Epoch: 1, Steps: 10 | Train Loss: 3.383 Vali Loss: 3.312 Vali Acc: 0.080 Test Loss: 3.312 Test Acc: 0.080
Validation loss decreased (inf --> -0.079967).  Saving model ...
Epoch: 2 cost time: 1.5914270877838135
Epoch: 2, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.302 Vali Acc: 0.179 Test Loss: 3.302 Test Acc: 0.179
Validation loss decreased (-0.079967 --> -0.178791).  Saving model ...
Epoch: 3 cost time: 1.6438183784484863
Epoch: 3, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.330 Vali Acc: 0.252 Test Loss: 3.330 Test Acc: 0.252
Validation loss decreased (-0.178791 --> -0.251731).  Saving model ...
Epoch: 4 cost time: 1.3579368591308594
Epoch: 4, Steps: 10 | Train Loss: 0.732 Vali Loss: 3.626 Vali Acc: 0.280 Test Loss: 3.626 Test Acc: 0.280
Validation loss decreased (-0.251731 --> -0.279964).  Saving model ...
Epoch: 5 cost time: 1.5570032596588135
Epoch: 5, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.848 Vali Acc: 0.300 Test Loss: 3.848 Test Acc: 0.300
Validation loss decreased (-0.279964 --> -0.299962).  Saving model ...
Epoch: 6 cost time: 1.5220255851745605
Epoch: 6, Steps: 10 | Train Loss: 0.223 Vali Loss: 4.101 Vali Acc: 0.302 Test Loss: 4.101 Test Acc: 0.302
Validation loss decreased (-0.299962 --> -0.302312).  Saving model ...
Epoch: 7 cost time: 1.6791319847106934
Epoch: 7, Steps: 10 | Train Loss: 0.105 Vali Loss: 4.221 Vali Acc: 0.316 Test Loss: 4.221 Test Acc: 0.316
Validation loss decreased (-0.302312 --> -0.316428).  Saving model ...
Epoch: 8 cost time: 1.4822204113006592
Epoch: 8, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.672 Vali Acc: 0.302 Test Loss: 4.672 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5661184787750244
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.603 Vali Acc: 0.314 Test Loss: 4.603 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6037957668304443
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.604 Vali Acc: 0.322 Test Loss: 4.604 Test Acc: 0.322
Validation loss decreased (-0.316428 --> -0.322307).  Saving model ...
Epoch: 11 cost time: 1.602231502532959
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.812 Vali Acc: 0.344 Test Loss: 4.812 Test Acc: 0.344
Validation loss decreased (-0.322307 --> -0.343481).  Saving model ...
Epoch: 12 cost time: 1.5799314975738525
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.966 Vali Acc: 0.338 Test Loss: 4.966 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5520813465118408
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.982 Vali Acc: 0.331 Test Loss: 4.982 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4783623218536377
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.993 Vali Acc: 0.334 Test Loss: 4.993 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5456674098968506
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.005 Vali Acc: 0.338 Test Loss: 5.005 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.5510010719299316
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.010 Vali Acc: 0.340 Test Loss: 5.010 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5494651794433594
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.030 Vali Acc: 0.344 Test Loss: 5.030 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4805083274841309
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.045 Vali Acc: 0.347 Test Loss: 5.045 Test Acc: 0.347
Validation loss decreased (-0.343481 --> -0.347008).  Saving model ...
Epoch: 19 cost time: 1.4179441928863525
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.070 Vali Acc: 0.340 Test Loss: 5.070 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4623727798461914
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.078 Vali Acc: 0.341 Test Loss: 5.078 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5663847923278809
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.085 Vali Acc: 0.340 Test Loss: 5.085 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.525115728378296
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.099 Vali Acc: 0.341 Test Loss: 5.099 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6065373420715332
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.118 Vali Acc: 0.342 Test Loss: 5.118 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3932220935821533
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.124 Vali Acc: 0.348 Test Loss: 5.124 Test Acc: 0.348
Validation loss decreased (-0.347008 --> -0.348184).  Saving model ...
Epoch: 25 cost time: 1.7629575729370117
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.137 Vali Acc: 0.346 Test Loss: 5.137 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7634313106536865
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.153 Vali Acc: 0.346 Test Loss: 5.153 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7500343322753906
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.163 Vali Acc: 0.341 Test Loss: 5.163 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6572773456573486
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.176 Vali Acc: 0.341 Test Loss: 5.176 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7767760753631592
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.200 Vali Acc: 0.344 Test Loss: 5.200 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.8765206336975098
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.204 Vali Acc: 0.342 Test Loss: 5.204 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7382268905639648
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.213 Vali Acc: 0.347 Test Loss: 5.213 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5177078247070312
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.226 Vali Acc: 0.344 Test Loss: 5.226 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6250789165496826
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.239 Vali Acc: 0.346 Test Loss: 5.239 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5912137031555176
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.253 Vali Acc: 0.349 Test Loss: 5.253 Test Acc: 0.349
Validation loss decreased (-0.348184 --> -0.349359).  Saving model ...
Epoch: 35 cost time: 1.4402282238006592
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.267 Vali Acc: 0.347 Test Loss: 5.267 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.4266209602355957
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.278 Vali Acc: 0.347 Test Loss: 5.278 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5840167999267578
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.287 Vali Acc: 0.348 Test Loss: 5.287 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.6535038948059082
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.294 Vali Acc: 0.346 Test Loss: 5.294 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6463451385498047
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.302 Vali Acc: 0.348 Test Loss: 5.302 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.4619390964508057
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.318 Vali Acc: 0.344 Test Loss: 5.318 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4844639301300049
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.327 Vali Acc: 0.344 Test Loss: 5.327 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.572408676147461
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.330 Vali Acc: 0.344 Test Loss: 5.330 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.3346352577209473
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.343 Vali Acc: 0.346 Test Loss: 5.343 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.5614550113677979
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.357 Vali Acc: 0.346 Test Loss: 5.357 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 1808722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.160403728485107
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.303 Vali Acc: 0.064 Test Loss: 3.303 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 1.4905455112457275
Epoch: 2, Steps: 10 | Train Loss: 2.521 Vali Loss: 3.292 Vali Acc: 0.173 Test Loss: 3.292 Test Acc: 0.173
Validation loss decreased (-0.063496 --> -0.172908).  Saving model ...
Epoch: 3 cost time: 1.6562883853912354
Epoch: 3, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.286 Vali Acc: 0.255 Test Loss: 3.286 Test Acc: 0.255
Validation loss decreased (-0.172908 --> -0.255261).  Saving model ...
Epoch: 4 cost time: 1.385899543762207
Epoch: 4, Steps: 10 | Train Loss: 0.776 Vali Loss: 3.563 Vali Acc: 0.276 Test Loss: 3.563 Test Acc: 0.276
Validation loss decreased (-0.255261 --> -0.276435).  Saving model ...
Epoch: 5 cost time: 1.4971833229064941
Epoch: 5, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.750 Vali Acc: 0.306 Test Loss: 3.750 Test Acc: 0.306
Validation loss decreased (-0.276435 --> -0.305845).  Saving model ...
Epoch: 6 cost time: 1.5148613452911377
Epoch: 6, Steps: 10 | Train Loss: 0.241 Vali Loss: 4.033 Vali Acc: 0.295 Test Loss: 4.033 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7340812683105469
Epoch: 7, Steps: 10 | Train Loss: 0.118 Vali Loss: 4.100 Vali Acc: 0.319 Test Loss: 4.100 Test Acc: 0.319
Validation loss decreased (-0.305845 --> -0.318783).  Saving model ...
Epoch: 8 cost time: 1.5372343063354492
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 4.586 Vali Acc: 0.316 Test Loss: 4.586 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6853113174438477
Epoch: 9, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.463 Vali Acc: 0.329 Test Loss: 4.463 Test Acc: 0.329
Validation loss decreased (-0.318783 --> -0.329367).  Saving model ...
Epoch: 10 cost time: 1.5899903774261475
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.543 Vali Acc: 0.333 Test Loss: 4.543 Test Acc: 0.333
Validation loss decreased (-0.329367 --> -0.332896).  Saving model ...
Epoch: 11 cost time: 1.8200218677520752
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.714 Vali Acc: 0.328 Test Loss: 4.714 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.791407823562622
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.745 Vali Acc: 0.349 Test Loss: 4.745 Test Acc: 0.349
Validation loss decreased (-0.332896 --> -0.349364).  Saving model ...
Epoch: 13 cost time: 1.7151238918304443
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.795 Vali Acc: 0.342 Test Loss: 4.795 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.902482032775879
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.811 Vali Acc: 0.334 Test Loss: 4.811 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7957446575164795
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.813 Vali Acc: 0.333 Test Loss: 4.813 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8436768054962158
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.830 Vali Acc: 0.333 Test Loss: 4.830 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8297719955444336
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.848 Vali Acc: 0.338 Test Loss: 4.848 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6936726570129395
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.866 Vali Acc: 0.342 Test Loss: 4.866 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.179335832595825
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.895 Vali Acc: 0.342 Test Loss: 4.895 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.7961094379425049
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.902 Vali Acc: 0.344 Test Loss: 4.902 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.044847249984741
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.910 Vali Acc: 0.345 Test Loss: 4.910 Test Acc: 0.345
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.0639402866363525
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.923 Vali Acc: 0.344 Test Loss: 4.923 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 1808722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 4.219615459442139
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.280 Vali Acc: 0.064 Test Loss: 3.280 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 1.568129301071167
Epoch: 2, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.273 Vali Acc: 0.185 Test Loss: 3.273 Test Acc: 0.185
Validation loss decreased (-0.063497 --> -0.184673).  Saving model ...
Epoch: 3 cost time: 1.5477535724639893
Epoch: 3, Steps: 10 | Train Loss: 1.611 Vali Loss: 3.201 Vali Acc: 0.254 Test Loss: 3.201 Test Acc: 0.254
Validation loss decreased (-0.184673 --> -0.254086).  Saving model ...
Epoch: 4 cost time: 1.8427956104278564
Epoch: 4, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.408 Vali Acc: 0.274 Test Loss: 3.408 Test Acc: 0.274
Validation loss decreased (-0.254086 --> -0.274084).  Saving model ...
Epoch: 5 cost time: 1.652123212814331
Epoch: 5, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.563 Vali Acc: 0.306 Test Loss: 3.563 Test Acc: 0.306
Validation loss decreased (-0.274084 --> -0.305847).  Saving model ...
Epoch: 6 cost time: 1.7779698371887207
Epoch: 6, Steps: 10 | Train Loss: 0.219 Vali Loss: 3.928 Vali Acc: 0.301 Test Loss: 3.928 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7674314975738525
Epoch: 7, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.911 Vali Acc: 0.324 Test Loss: 3.911 Test Acc: 0.324
Validation loss decreased (-0.305847 --> -0.323490).  Saving model ...
Epoch: 8 cost time: 1.6251640319824219
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.318 Vali Acc: 0.314 Test Loss: 4.318 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6352660655975342
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.350 Vali Acc: 0.322 Test Loss: 4.350 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.645308256149292
Epoch: 10, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.261 Vali Acc: 0.326 Test Loss: 4.261 Test Acc: 0.326
Validation loss decreased (-0.323490 --> -0.325840).  Saving model ...
Epoch: 11 cost time: 1.5989892482757568
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.347 Vali Acc: 0.342 Test Loss: 4.347 Test Acc: 0.342
Validation loss decreased (-0.325840 --> -0.342309).  Saving model ...
Epoch: 12 cost time: 1.6707584857940674
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.443 Vali Acc: 0.340 Test Loss: 4.443 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6711900234222412
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.489 Vali Acc: 0.327 Test Loss: 4.489 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3639061450958252
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.503 Vali Acc: 0.324 Test Loss: 4.503 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.5329229831695557
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.514 Vali Acc: 0.332 Test Loss: 4.514 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4012084007263184
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.527 Vali Acc: 0.340 Test Loss: 4.527 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5727298259735107
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.541 Vali Acc: 0.340 Test Loss: 4.541 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.597917079925537
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.561 Vali Acc: 0.341 Test Loss: 4.561 Test Acc: 0.341
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.503892421722412
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.586 Vali Acc: 0.341 Test Loss: 4.586 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7366423606872559
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.590 Vali Acc: 0.342 Test Loss: 4.590 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.583953857421875
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.590 Vali Acc: 0.342 Test Loss: 4.590 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 1808722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5517029762268066
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.244 Vali Acc: 0.078 Test Loss: 3.244 Test Acc: 0.078
Validation loss decreased (inf --> -0.077615).  Saving model ...
Epoch: 2 cost time: 1.7520010471343994
Epoch: 2, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.231 Vali Acc: 0.167 Test Loss: 3.231 Test Acc: 0.167
Validation loss decreased (-0.077615 --> -0.167027).  Saving model ...
Epoch: 3 cost time: 1.4978091716766357
Epoch: 3, Steps: 10 | Train Loss: 1.836 Vali Loss: 2.995 Vali Acc: 0.251 Test Loss: 2.995 Test Acc: 0.251
Validation loss decreased (-0.167027 --> -0.250558).  Saving model ...
Epoch: 4 cost time: 1.757274866104126
Epoch: 4, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.071 Vali Acc: 0.275 Test Loss: 3.071 Test Acc: 0.275
Validation loss decreased (-0.250558 --> -0.275263).  Saving model ...
Epoch: 5 cost time: 1.646179437637329
Epoch: 5, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.119 Vali Acc: 0.311 Test Loss: 3.119 Test Acc: 0.311
Validation loss decreased (-0.275263 --> -0.310557).  Saving model ...
Epoch: 6 cost time: 1.4088134765625
Epoch: 6, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.380 Vali Acc: 0.320 Test Loss: 3.380 Test Acc: 0.320
Validation loss decreased (-0.310557 --> -0.319966).  Saving model ...
Epoch: 7 cost time: 1.4575259685516357
Epoch: 7, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.377 Vali Acc: 0.314 Test Loss: 3.377 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5983824729919434
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.682 Vali Acc: 0.320 Test Loss: 3.682 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5738041400909424
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.760 Vali Acc: 0.329 Test Loss: 3.760 Test Acc: 0.329
Validation loss decreased (-0.319966 --> -0.329374).  Saving model ...
Epoch: 10 cost time: 1.583812952041626
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.732 Vali Acc: 0.322 Test Loss: 3.732 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.4842240810394287
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.733 Vali Acc: 0.331 Test Loss: 3.733 Test Acc: 0.331
Validation loss decreased (-0.329374 --> -0.330551).  Saving model ...
Epoch: 12 cost time: 1.4939460754394531
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.782 Vali Acc: 0.334 Test Loss: 3.782 Test Acc: 0.334
Validation loss decreased (-0.330551 --> -0.334080).  Saving model ...
Epoch: 13 cost time: 1.5234918594360352
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.835 Vali Acc: 0.338 Test Loss: 3.835 Test Acc: 0.338
Validation loss decreased (-0.334080 --> -0.337609).  Saving model ...
Epoch: 14 cost time: 1.5757670402526855
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.856 Vali Acc: 0.334 Test Loss: 3.856 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5238714218139648
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.861 Vali Acc: 0.334 Test Loss: 3.861 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.693274736404419
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.868 Vali Acc: 0.338 Test Loss: 3.868 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3539047241210938
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.882 Vali Acc: 0.335 Test Loss: 3.882 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5029454231262207
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.906 Vali Acc: 0.334 Test Loss: 3.906 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4279658794403076
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.930 Vali Acc: 0.333 Test Loss: 3.930 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3974342346191406
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.940 Vali Acc: 0.328 Test Loss: 3.940 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.451239824295044
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.944 Vali Acc: 0.329 Test Loss: 3.944 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5088016986846924
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.952 Vali Acc: 0.332 Test Loss: 3.952 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4321956634521484
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.976 Vali Acc: 0.331 Test Loss: 3.976 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 1808722
model size : 11.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9103591442108154
Epoch: 1, Steps: 10 | Train Loss: 3.350 Vali Loss: 3.324 Vali Acc: 0.096 Test Loss: 3.324 Test Acc: 0.096
Validation loss decreased (inf --> -0.096437).  Saving model ...
Epoch: 2 cost time: 1.586310863494873
Epoch: 2, Steps: 10 | Train Loss: 2.563 Vali Loss: 3.312 Vali Acc: 0.176 Test Loss: 3.312 Test Acc: 0.176
Validation loss decreased (-0.096437 --> -0.176437).  Saving model ...
Epoch: 3 cost time: 1.5530459880828857
Epoch: 3, Steps: 10 | Train Loss: 1.479 Vali Loss: 3.365 Vali Acc: 0.249 Test Loss: 3.365 Test Acc: 0.249
Validation loss decreased (-0.176437 --> -0.249378).  Saving model ...
Epoch: 4 cost time: 1.641709566116333
Epoch: 4, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.693 Vali Acc: 0.274 Test Loss: 3.693 Test Acc: 0.274
Validation loss decreased (-0.249378 --> -0.274081).  Saving model ...
Epoch: 5 cost time: 1.594069242477417
Epoch: 5, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.893 Vali Acc: 0.309 Test Loss: 3.893 Test Acc: 0.309
Validation loss decreased (-0.274081 --> -0.309373).  Saving model ...
Epoch: 6 cost time: 1.6195802688598633
Epoch: 6, Steps: 10 | Train Loss: 0.156 Vali Loss: 4.377 Vali Acc: 0.291 Test Loss: 4.377 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4766044616699219
Epoch: 7, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.409 Vali Acc: 0.312 Test Loss: 4.409 Test Acc: 0.312
Validation loss decreased (-0.309373 --> -0.311721).  Saving model ...
Epoch: 8 cost time: 1.552623987197876
Epoch: 8, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.605 Vali Acc: 0.320 Test Loss: 4.605 Test Acc: 0.320
Validation loss decreased (-0.311721 --> -0.319954).  Saving model ...
Epoch: 9 cost time: 1.5122697353363037
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.815 Vali Acc: 0.312 Test Loss: 4.815 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.850865125656128
Epoch: 10, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.110 Vali Acc: 0.305 Test Loss: 5.110 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8052122592926025
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.915 Vali Acc: 0.321 Test Loss: 4.915 Test Acc: 0.321
Validation loss decreased (-0.319954 --> -0.321127).  Saving model ...
Epoch: 12 cost time: 1.674889326095581
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.893 Vali Acc: 0.336 Test Loss: 4.893 Test Acc: 0.336
Validation loss decreased (-0.321127 --> -0.336422).  Saving model ...
Epoch: 13 cost time: 1.8770427703857422
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.128 Vali Acc: 0.328 Test Loss: 5.128 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8577992916107178
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.140 Vali Acc: 0.332 Test Loss: 5.140 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6712665557861328
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.181 Vali Acc: 0.329 Test Loss: 5.181 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.0658483505249023
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.219 Vali Acc: 0.327 Test Loss: 5.219 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7388074398040771
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.264 Vali Acc: 0.326 Test Loss: 5.264 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.677414894104004
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.228 Vali Acc: 0.332 Test Loss: 5.228 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8361475467681885
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.231 Vali Acc: 0.339 Test Loss: 5.231 Test Acc: 0.339
Validation loss decreased (-0.336422 --> -0.338771).  Saving model ...
Epoch: 20 cost time: 1.8671891689300537
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.258 Vali Acc: 0.339 Test Loss: 5.258 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.9709763526916504
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.279 Vali Acc: 0.339 Test Loss: 5.279 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.7707593441009521
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.289 Vali Acc: 0.338 Test Loss: 5.289 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7264950275421143
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.291 Vali Acc: 0.339 Test Loss: 5.291 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4394323825836182
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.289 Vali Acc: 0.340 Test Loss: 5.289 Test Acc: 0.340
Validation loss decreased (-0.338771 --> -0.339947).  Saving model ...
Epoch: 25 cost time: 1.2660841941833496
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.292 Vali Acc: 0.340 Test Loss: 5.292 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.4150950908660889
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.304 Vali Acc: 0.340 Test Loss: 5.304 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8573784828186035
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.319 Vali Acc: 0.341 Test Loss: 5.319 Test Acc: 0.341
Validation loss decreased (-0.339947 --> -0.341123).  Saving model ...
Epoch: 28 cost time: 1.748579502105713
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.327 Vali Acc: 0.340 Test Loss: 5.327 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.5966169834136963
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.330 Vali Acc: 0.338 Test Loss: 5.330 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3844947814941406
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.337 Vali Acc: 0.335 Test Loss: 5.337 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4685497283935547
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.342 Vali Acc: 0.338 Test Loss: 5.342 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.5763497352600098
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.346 Vali Acc: 0.338 Test Loss: 5.346 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5844299793243408
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.353 Vali Acc: 0.340 Test Loss: 5.353 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.5420377254486084
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.362 Vali Acc: 0.344 Test Loss: 5.362 Test Acc: 0.344
Validation loss decreased (-0.341123 --> -0.343476).  Saving model ...
Epoch: 35 cost time: 1.5704286098480225
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.374 Vali Acc: 0.340 Test Loss: 5.374 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.7359471321105957
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.381 Vali Acc: 0.340 Test Loss: 5.381 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.7503955364227295
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.391 Vali Acc: 0.339 Test Loss: 5.391 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.7120022773742676
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.398 Vali Acc: 0.342 Test Loss: 5.398 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.838524341583252
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.402 Vali Acc: 0.342 Test Loss: 5.402 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.770047664642334
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.413 Vali Acc: 0.341 Test Loss: 5.413 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.6256706714630127
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.428 Vali Acc: 0.339 Test Loss: 5.428 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.9056789875030518
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.442 Vali Acc: 0.340 Test Loss: 5.442 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.9636969566345215
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.454 Vali Acc: 0.347 Test Loss: 5.454 Test Acc: 0.347
Validation loss decreased (-0.343476 --> -0.347004).  Saving model ...
Epoch: 44 cost time: 1.8070485591888428
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.464 Vali Acc: 0.349 Test Loss: 5.464 Test Acc: 0.349
Validation loss decreased (-0.347004 --> -0.349357).  Saving model ...
Epoch: 45 cost time: 1.6433131694793701
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.467 Vali Acc: 0.349 Test Loss: 5.467 Test Acc: 0.349
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.8994646072387695
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.469 Vali Acc: 0.347 Test Loss: 5.469 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 1.7421977519989014
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.475 Vali Acc: 0.345 Test Loss: 5.475 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.7305116653442383
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.480 Vali Acc: 0.347 Test Loss: 5.480 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 2.0332887172698975
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.489 Vali Acc: 0.348 Test Loss: 5.489 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.59901762008667
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.499 Vali Acc: 0.348 Test Loss: 5.499 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 2.2832906246185303
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.505 Vali Acc: 0.347 Test Loss: 5.505 Test Acc: 0.347
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.973060131072998
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.515 Vali Acc: 0.351 Test Loss: 5.515 Test Acc: 0.351
Validation loss decreased (-0.349357 --> -0.350533).  Saving model ...
Epoch: 53 cost time: 1.830655813217163
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.520 Vali Acc: 0.348 Test Loss: 5.520 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 1.949730634689331
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.521 Vali Acc: 0.348 Test Loss: 5.521 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 1.717735767364502
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.525 Vali Acc: 0.345 Test Loss: 5.525 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 1.677772045135498
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.532 Vali Acc: 0.345 Test Loss: 5.532 Test Acc: 0.345
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 1.7455525398254395
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.542 Vali Acc: 0.344 Test Loss: 5.542 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 1.8796827793121338
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.546 Vali Acc: 0.347 Test Loss: 5.546 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 1.8163371086120605
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.556 Vali Acc: 0.345 Test Loss: 5.556 Test Acc: 0.345
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 1.9908692836761475
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.565 Vali Acc: 0.345 Test Loss: 5.565 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
Epoch: 61 cost time: 1.8353543281555176
Epoch: 61, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.569 Vali Acc: 0.345 Test Loss: 5.569 Test Acc: 0.345
EarlyStopping counter: 9 out of 10
Epoch: 62 cost time: 1.8683271408081055
Epoch: 62, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.576 Vali Acc: 0.346 Test Loss: 5.576 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35058823529411764
model parameter : 1546578
model size : 10.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.526155948638916
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.317 Vali Acc: 0.094 Test Loss: 3.317 Test Acc: 0.094
Validation loss decreased (inf --> -0.094084).  Saving model ...
Epoch: 2 cost time: 1.39206862449646
Epoch: 2, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.308 Vali Acc: 0.168 Test Loss: 3.308 Test Acc: 0.168
Validation loss decreased (-0.094084 --> -0.168202).  Saving model ...
Epoch: 3 cost time: 1.2265076637268066
Epoch: 3, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.335 Vali Acc: 0.244 Test Loss: 3.335 Test Acc: 0.244
Validation loss decreased (-0.168202 --> -0.243496).  Saving model ...
Epoch: 4 cost time: 1.7654805183410645
Epoch: 4, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.629 Vali Acc: 0.265 Test Loss: 3.629 Test Acc: 0.265
Validation loss decreased (-0.243496 --> -0.264670).  Saving model ...
Epoch: 5 cost time: 1.700394868850708
Epoch: 5, Steps: 10 | Train Loss: 0.375 Vali Loss: 3.830 Vali Acc: 0.298 Test Loss: 3.830 Test Acc: 0.298
Validation loss decreased (-0.264670 --> -0.297609).  Saving model ...
Epoch: 6 cost time: 1.7609727382659912
Epoch: 6, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.256 Vali Acc: 0.294 Test Loss: 4.256 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6852712631225586
Epoch: 7, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.380 Vali Acc: 0.294 Test Loss: 4.380 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5550868511199951
Epoch: 8, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.474 Vali Acc: 0.333 Test Loss: 4.474 Test Acc: 0.333
Validation loss decreased (-0.297609 --> -0.332896).  Saving model ...
Epoch: 9 cost time: 1.715939998626709
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 4.680 Vali Acc: 0.322 Test Loss: 4.680 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4838931560516357
Epoch: 10, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.914 Vali Acc: 0.312 Test Loss: 4.914 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4546482563018799
Epoch: 11, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.792 Vali Acc: 0.329 Test Loss: 4.792 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7576706409454346
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.784 Vali Acc: 0.338 Test Loss: 4.784 Test Acc: 0.338
Validation loss decreased (-0.332896 --> -0.337599).  Saving model ...
Epoch: 13 cost time: 1.7622382640838623
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.050 Vali Acc: 0.331 Test Loss: 5.050 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7972190380096436
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.946 Vali Acc: 0.336 Test Loss: 4.946 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5751605033874512
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.951 Vali Acc: 0.331 Test Loss: 4.951 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6472833156585693
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.955 Vali Acc: 0.333 Test Loss: 4.955 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5086114406585693
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.961 Vali Acc: 0.333 Test Loss: 4.961 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.633474588394165
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.968 Vali Acc: 0.333 Test Loss: 4.968 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4357411861419678
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.973 Vali Acc: 0.336 Test Loss: 4.973 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4848501682281494
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.991 Vali Acc: 0.338 Test Loss: 4.991 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6085295677185059
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.001 Vali Acc: 0.336 Test Loss: 5.001 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5902519226074219
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.014 Vali Acc: 0.338 Test Loss: 5.014 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 1546578
model size : 10.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.9619598388671875
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.302 Vali Acc: 0.085 Test Loss: 3.302 Test Acc: 0.085
Validation loss decreased (inf --> -0.084673).  Saving model ...
Epoch: 2 cost time: 1.4935534000396729
Epoch: 2, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.292 Vali Acc: 0.165 Test Loss: 3.292 Test Acc: 0.165
Validation loss decreased (-0.084673 --> -0.164673).  Saving model ...
Epoch: 3 cost time: 1.3526148796081543
Epoch: 3, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.249 Vali Acc: 0.238 Test Loss: 3.249 Test Acc: 0.238
Validation loss decreased (-0.164673 --> -0.237615).  Saving model ...
Epoch: 4 cost time: 1.4292969703674316
Epoch: 4, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.477 Vali Acc: 0.276 Test Loss: 3.477 Test Acc: 0.276
Validation loss decreased (-0.237615 --> -0.276436).  Saving model ...
Epoch: 5 cost time: 1.7624104022979736
Epoch: 5, Steps: 10 | Train Loss: 0.382 Vali Loss: 3.625 Vali Acc: 0.301 Test Loss: 3.625 Test Acc: 0.301
Validation loss decreased (-0.276436 --> -0.301140).  Saving model ...
Epoch: 6 cost time: 1.5258817672729492
Epoch: 6, Steps: 10 | Train Loss: 0.160 Vali Loss: 4.000 Vali Acc: 0.309 Test Loss: 4.000 Test Acc: 0.309
Validation loss decreased (-0.301140 --> -0.309372).  Saving model ...
Epoch: 7 cost time: 1.7360153198242188
Epoch: 7, Steps: 10 | Train Loss: 0.110 Vali Loss: 4.061 Vali Acc: 0.286 Test Loss: 4.061 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5757904052734375
Epoch: 8, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.203 Vali Acc: 0.327 Test Loss: 4.203 Test Acc: 0.327
Validation loss decreased (-0.309372 --> -0.327017).  Saving model ...
Epoch: 9 cost time: 1.5398001670837402
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.342 Vali Acc: 0.334 Test Loss: 4.342 Test Acc: 0.334
Validation loss decreased (-0.327017 --> -0.334074).  Saving model ...
Epoch: 10 cost time: 1.4211485385894775
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.525 Vali Acc: 0.326 Test Loss: 4.525 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.785553216934204
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.541 Vali Acc: 0.316 Test Loss: 4.541 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.475271224975586
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.650 Vali Acc: 0.315 Test Loss: 4.650 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5188605785369873
Epoch: 13, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.732 Vali Acc: 0.320 Test Loss: 4.732 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.6331477165222168
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.769 Vali Acc: 0.329 Test Loss: 4.769 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3829748630523682
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.660 Vali Acc: 0.332 Test Loss: 4.660 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.5232627391815186
Epoch: 16, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.863 Vali Acc: 0.321 Test Loss: 4.863 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.5041654109954834
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.952 Vali Acc: 0.321 Test Loss: 4.952 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.4301445484161377
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.862 Vali Acc: 0.328 Test Loss: 4.862 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2964611053466797
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.865 Vali Acc: 0.327 Test Loss: 4.865 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 1546578
model size : 10.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4935946464538574
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.268 Vali Acc: 0.089 Test Loss: 3.268 Test Acc: 0.089
Validation loss decreased (inf --> -0.089379).  Saving model ...
Epoch: 2 cost time: 1.539914608001709
Epoch: 2, Steps: 10 | Train Loss: 2.748 Vali Loss: 3.232 Vali Acc: 0.149 Test Loss: 3.232 Test Acc: 0.149
Validation loss decreased (-0.089379 --> -0.149379).  Saving model ...
Epoch: 3 cost time: 1.338832139968872
Epoch: 3, Steps: 10 | Train Loss: 1.860 Vali Loss: 3.052 Vali Acc: 0.232 Test Loss: 3.052 Test Acc: 0.232
Validation loss decreased (-0.149379 --> -0.231734).  Saving model ...
Epoch: 4 cost time: 1.3517093658447266
Epoch: 4, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.097 Vali Acc: 0.259 Test Loss: 3.097 Test Acc: 0.259
Validation loss decreased (-0.231734 --> -0.258793).  Saving model ...
Epoch: 5 cost time: 1.591479778289795
Epoch: 5, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.232 Vali Acc: 0.286 Test Loss: 3.232 Test Acc: 0.286
Validation loss decreased (-0.258793 --> -0.285850).  Saving model ...
Epoch: 6 cost time: 1.5911142826080322
Epoch: 6, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.380 Vali Acc: 0.316 Test Loss: 3.380 Test Acc: 0.316
Validation loss decreased (-0.285850 --> -0.316437).  Saving model ...
Epoch: 7 cost time: 1.316087007522583
Epoch: 7, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.509 Vali Acc: 0.306 Test Loss: 3.509 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.329871654510498
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.625 Vali Acc: 0.307 Test Loss: 3.625 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4301955699920654
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.719 Vali Acc: 0.316 Test Loss: 3.719 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4288055896759033
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.751 Vali Acc: 0.326 Test Loss: 3.751 Test Acc: 0.326
Validation loss decreased (-0.316437 --> -0.325845).  Saving model ...
Epoch: 11 cost time: 1.6037774085998535
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.806 Vali Acc: 0.331 Test Loss: 3.806 Test Acc: 0.331
Validation loss decreased (-0.325845 --> -0.330550).  Saving model ...
Epoch: 12 cost time: 1.4183461666107178
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.869 Vali Acc: 0.325 Test Loss: 3.869 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.4612982273101807
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.893 Vali Acc: 0.324 Test Loss: 3.893 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3539719581604004
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.896 Vali Acc: 0.328 Test Loss: 3.896 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.289609670639038
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.897 Vali Acc: 0.331 Test Loss: 3.897 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4038379192352295
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.912 Vali Acc: 0.327 Test Loss: 3.912 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5960988998413086
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.923 Vali Acc: 0.331 Test Loss: 3.923 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.659147024154663
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.936 Vali Acc: 0.332 Test Loss: 3.936 Test Acc: 0.332
Validation loss decreased (-0.330550 --> -0.331725).  Saving model ...
Epoch: 19 cost time: 1.5149955749511719
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.952 Vali Acc: 0.332 Test Loss: 3.952 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.734156608581543
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.969 Vali Acc: 0.331 Test Loss: 3.969 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.834615707397461
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.985 Vali Acc: 0.331 Test Loss: 3.985 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.55051589012146
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.002 Vali Acc: 0.328 Test Loss: 4.002 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4785640239715576
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.018 Vali Acc: 0.331 Test Loss: 4.018 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.3734157085418701
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.027 Vali Acc: 0.331 Test Loss: 4.027 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1769323348999023
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.036 Vali Acc: 0.333 Test Loss: 4.036 Test Acc: 0.333
Validation loss decreased (-0.331725 --> -0.332901).  Saving model ...
Epoch: 26 cost time: 1.5819838047027588
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.048 Vali Acc: 0.331 Test Loss: 4.048 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.366346836090088
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.061 Vali Acc: 0.332 Test Loss: 4.061 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.5477430820465088
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.067 Vali Acc: 0.333 Test Loss: 4.067 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.5752160549163818
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.076 Vali Acc: 0.333 Test Loss: 4.076 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.508098840713501
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.087 Vali Acc: 0.331 Test Loss: 4.087 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.7326247692108154
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.093 Vali Acc: 0.328 Test Loss: 4.093 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.8226721286773682
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.106 Vali Acc: 0.328 Test Loss: 4.106 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.651590347290039
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.121 Vali Acc: 0.333 Test Loss: 4.121 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.5762567520141602
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.136 Vali Acc: 0.333 Test Loss: 4.136 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.5889313220977783
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.153 Vali Acc: 0.332 Test Loss: 4.153 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 1546578
model size : 10.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.7400293350219727
Epoch: 1, Steps: 10 | Train Loss: 3.436 Vali Loss: 3.323 Vali Acc: 0.081 Test Loss: 3.323 Test Acc: 0.081
Validation loss decreased (inf --> -0.081143).  Saving model ...
Epoch: 2 cost time: 1.4120612144470215
Epoch: 2, Steps: 10 | Train Loss: 2.533 Vali Loss: 3.295 Vali Acc: 0.180 Test Loss: 3.295 Test Acc: 0.180
Validation loss decreased (-0.081143 --> -0.179967).  Saving model ...
Epoch: 3 cost time: 1.5397493839263916
Epoch: 3, Steps: 10 | Train Loss: 1.514 Vali Loss: 3.340 Vali Acc: 0.252 Test Loss: 3.340 Test Acc: 0.252
Validation loss decreased (-0.179967 --> -0.251731).  Saving model ...
Epoch: 4 cost time: 1.4137942790985107
Epoch: 4, Steps: 10 | Train Loss: 0.753 Vali Loss: 3.665 Vali Acc: 0.268 Test Loss: 3.665 Test Acc: 0.268
Validation loss decreased (-0.251731 --> -0.268199).  Saving model ...
Epoch: 5 cost time: 1.4829027652740479
Epoch: 5, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.921 Vali Acc: 0.301 Test Loss: 3.921 Test Acc: 0.301
Validation loss decreased (-0.268199 --> -0.301137).  Saving model ...
Epoch: 6 cost time: 1.7107439041137695
Epoch: 6, Steps: 10 | Train Loss: 0.144 Vali Loss: 4.257 Vali Acc: 0.287 Test Loss: 4.257 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4990479946136475
Epoch: 7, Steps: 10 | Train Loss: 0.081 Vali Loss: 4.435 Vali Acc: 0.321 Test Loss: 4.435 Test Acc: 0.321
Validation loss decreased (-0.301137 --> -0.321132).  Saving model ...
Epoch: 8 cost time: 1.6560146808624268
Epoch: 8, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.602 Vali Acc: 0.321 Test Loss: 4.602 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4957592487335205
Epoch: 9, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.718 Vali Acc: 0.328 Test Loss: 4.718 Test Acc: 0.328
Validation loss decreased (-0.321132 --> -0.328188).  Saving model ...
Epoch: 10 cost time: 1.6780641078948975
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.891 Vali Acc: 0.331 Test Loss: 4.891 Test Acc: 0.331
Validation loss decreased (-0.328188 --> -0.330539).  Saving model ...
Epoch: 11 cost time: 1.548558235168457
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.118 Vali Acc: 0.328 Test Loss: 5.118 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6534428596496582
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.033 Vali Acc: 0.324 Test Loss: 5.033 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4859318733215332
Epoch: 13, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.062 Vali Acc: 0.333 Test Loss: 5.062 Test Acc: 0.333
Validation loss decreased (-0.330539 --> -0.332891).  Saving model ...
Epoch: 14 cost time: 1.5564448833465576
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.126 Vali Acc: 0.329 Test Loss: 5.126 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4959418773651123
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.106 Vali Acc: 0.333 Test Loss: 5.106 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.5894362926483154
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.088 Vali Acc: 0.332 Test Loss: 5.088 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.700087308883667
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.088 Vali Acc: 0.333 Test Loss: 5.088 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.635981559753418
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.101 Vali Acc: 0.332 Test Loss: 5.101 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3952810764312744
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.107 Vali Acc: 0.331 Test Loss: 5.107 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6096489429473877
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.115 Vali Acc: 0.328 Test Loss: 5.115 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.6646857261657715
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.121 Vali Acc: 0.328 Test Loss: 5.121 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5591816902160645
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.125 Vali Acc: 0.332 Test Loss: 5.125 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4754977226257324
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.144 Vali Acc: 0.327 Test Loss: 5.144 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 1415506
model size : 10.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.6214637756347656
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.315 Vali Acc: 0.076 Test Loss: 3.315 Test Acc: 0.076
Validation loss decreased (inf --> -0.076437).  Saving model ...
Epoch: 2 cost time: 1.4192588329315186
Epoch: 2, Steps: 10 | Train Loss: 2.544 Vali Loss: 3.287 Vali Acc: 0.186 Test Loss: 3.287 Test Acc: 0.186
Validation loss decreased (-0.076437 --> -0.185849).  Saving model ...
Epoch: 3 cost time: 1.445448637008667
Epoch: 3, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.310 Vali Acc: 0.253 Test Loss: 3.310 Test Acc: 0.253
Validation loss decreased (-0.185849 --> -0.252908).  Saving model ...
Epoch: 4 cost time: 1.269017219543457
Epoch: 4, Steps: 10 | Train Loss: 0.793 Vali Loss: 3.610 Vali Acc: 0.268 Test Loss: 3.610 Test Acc: 0.268
Validation loss decreased (-0.252908 --> -0.268199).  Saving model ...
Epoch: 5 cost time: 1.454197645187378
Epoch: 5, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.839 Vali Acc: 0.304 Test Loss: 3.839 Test Acc: 0.304
Validation loss decreased (-0.268199 --> -0.303491).  Saving model ...
Epoch: 6 cost time: 1.703134298324585
Epoch: 6, Steps: 10 | Train Loss: 0.153 Vali Loss: 4.163 Vali Acc: 0.280 Test Loss: 4.163 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5560965538024902
Epoch: 7, Steps: 10 | Train Loss: 0.101 Vali Loss: 4.352 Vali Acc: 0.314 Test Loss: 4.352 Test Acc: 0.314
Validation loss decreased (-0.303491 --> -0.314074).  Saving model ...
Epoch: 8 cost time: 1.2655529975891113
Epoch: 8, Steps: 10 | Train Loss: 0.047 Vali Loss: 4.412 Vali Acc: 0.332 Test Loss: 4.412 Test Acc: 0.332
Validation loss decreased (-0.314074 --> -0.331721).  Saving model ...
Epoch: 9 cost time: 1.28743314743042
Epoch: 9, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.666 Vali Acc: 0.324 Test Loss: 4.666 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3192360401153564
Epoch: 10, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.002 Vali Acc: 0.308 Test Loss: 5.002 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4429371356964111
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.015 Vali Acc: 0.322 Test Loss: 5.015 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4875786304473877
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.917 Vali Acc: 0.334 Test Loss: 4.917 Test Acc: 0.334
Validation loss decreased (-0.331721 --> -0.334068).  Saving model ...
Epoch: 13 cost time: 1.4416732788085938
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.827 Vali Acc: 0.327 Test Loss: 4.827 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4342164993286133
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.882 Vali Acc: 0.329 Test Loss: 4.882 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.486952781677246
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.909 Vali Acc: 0.332 Test Loss: 4.909 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.450636386871338
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.933 Vali Acc: 0.332 Test Loss: 4.933 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4388542175292969
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.945 Vali Acc: 0.333 Test Loss: 4.945 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.280745029449463
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.951 Vali Acc: 0.335 Test Loss: 4.951 Test Acc: 0.335
Validation loss decreased (-0.334068 --> -0.335245).  Saving model ...
Epoch: 19 cost time: 1.5994446277618408
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.948 Vali Acc: 0.334 Test Loss: 4.948 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.403182029724121
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.953 Vali Acc: 0.333 Test Loss: 4.953 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.372767448425293
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.956 Vali Acc: 0.332 Test Loss: 4.956 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3010931015014648
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.960 Vali Acc: 0.332 Test Loss: 4.960 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2683360576629639
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.976 Vali Acc: 0.333 Test Loss: 4.976 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4806313514709473
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.996 Vali Acc: 0.334 Test Loss: 4.996 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4530329704284668
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.014 Vali Acc: 0.335 Test Loss: 5.014 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5493946075439453
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.025 Vali Acc: 0.336 Test Loss: 5.025 Test Acc: 0.336
Validation loss decreased (-0.335245 --> -0.336420).  Saving model ...
Epoch: 27 cost time: 1.3859500885009766
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.036 Vali Acc: 0.335 Test Loss: 5.036 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2994358539581299
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.044 Vali Acc: 0.336 Test Loss: 5.044 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3152861595153809
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.055 Vali Acc: 0.336 Test Loss: 5.055 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.2883110046386719
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.064 Vali Acc: 0.334 Test Loss: 5.064 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.380497694015503
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.080 Vali Acc: 0.339 Test Loss: 5.080 Test Acc: 0.339
Validation loss decreased (-0.336420 --> -0.338773).  Saving model ...
Epoch: 32 cost time: 1.3491501808166504
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.092 Vali Acc: 0.336 Test Loss: 5.092 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.3290209770202637
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.105 Vali Acc: 0.334 Test Loss: 5.105 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5494787693023682
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.120 Vali Acc: 0.338 Test Loss: 5.120 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.3716111183166504
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.125 Vali Acc: 0.335 Test Loss: 5.125 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.544365644454956
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.131 Vali Acc: 0.335 Test Loss: 5.131 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.2555832862854004
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.133 Vali Acc: 0.336 Test Loss: 5.133 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.3560099601745605
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.142 Vali Acc: 0.339 Test Loss: 5.142 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.4102754592895508
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.147 Vali Acc: 0.340 Test Loss: 5.147 Test Acc: 0.340
Validation loss decreased (-0.338773 --> -0.339949).  Saving model ...
Epoch: 40 cost time: 1.3635337352752686
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.162 Vali Acc: 0.340 Test Loss: 5.162 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 1.5144758224487305
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.176 Vali Acc: 0.338 Test Loss: 5.176 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 1.1788625717163086
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.189 Vali Acc: 0.338 Test Loss: 5.189 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 1.3748257160186768
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.200 Vali Acc: 0.339 Test Loss: 5.200 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 1.2026267051696777
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.214 Vali Acc: 0.335 Test Loss: 5.214 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.2773382663726807
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.224 Vali Acc: 0.338 Test Loss: 5.224 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.3636598587036133
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.237 Vali Acc: 0.336 Test Loss: 5.237 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 1.3519279956817627
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.247 Vali Acc: 0.339 Test Loss: 5.247 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 1.2797858715057373
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.254 Vali Acc: 0.341 Test Loss: 5.254 Test Acc: 0.341
Validation loss decreased (-0.339949 --> -0.341124).  Saving model ...
Epoch: 49 cost time: 1.392132043838501
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.263 Vali Acc: 0.341 Test Loss: 5.263 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.2154924869537354
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.270 Vali Acc: 0.342 Test Loss: 5.270 Test Acc: 0.342
Validation loss decreased (-0.341124 --> -0.342300).  Saving model ...
Epoch: 51 cost time: 1.4652495384216309
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.280 Vali Acc: 0.339 Test Loss: 5.280 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 1.445624589920044
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.284 Vali Acc: 0.339 Test Loss: 5.284 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 1.2408900260925293
Epoch: 53, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.285 Vali Acc: 0.336 Test Loss: 5.285 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 1.2986464500427246
Epoch: 54, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.290 Vali Acc: 0.340 Test Loss: 5.290 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 1.4032411575317383
Epoch: 55, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.296 Vali Acc: 0.340 Test Loss: 5.296 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 1.5449349880218506
Epoch: 56, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.302 Vali Acc: 0.338 Test Loss: 5.302 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 1.3130810260772705
Epoch: 57, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.312 Vali Acc: 0.336 Test Loss: 5.312 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 1.2993552684783936
Epoch: 58, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.321 Vali Acc: 0.338 Test Loss: 5.321 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 1.3342785835266113
Epoch: 59, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.334 Vali Acc: 0.338 Test Loss: 5.334 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 1.3934707641601562
Epoch: 60, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.344 Vali Acc: 0.340 Test Loss: 5.344 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 1415506
model size : 10.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4110569953918457
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.295 Vali Acc: 0.080 Test Loss: 3.295 Test Acc: 0.080
Validation loss decreased (inf --> -0.079967).  Saving model ...
Epoch: 2 cost time: 1.3338823318481445
Epoch: 2, Steps: 10 | Train Loss: 2.589 Vali Loss: 3.253 Vali Acc: 0.172 Test Loss: 3.253 Test Acc: 0.172
Validation loss decreased (-0.079967 --> -0.171732).  Saving model ...
Epoch: 3 cost time: 1.4066410064697266
Epoch: 3, Steps: 10 | Train Loss: 1.619 Vali Loss: 3.212 Vali Acc: 0.244 Test Loss: 3.212 Test Acc: 0.244
Validation loss decreased (-0.171732 --> -0.243497).  Saving model ...
Epoch: 4 cost time: 1.501448392868042
Epoch: 4, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.449 Vali Acc: 0.271 Test Loss: 3.449 Test Acc: 0.271
Validation loss decreased (-0.243497 --> -0.270554).  Saving model ...
Epoch: 5 cost time: 1.5123286247253418
Epoch: 5, Steps: 10 | Train Loss: 0.373 Vali Loss: 3.646 Vali Acc: 0.301 Test Loss: 3.646 Test Acc: 0.301
Validation loss decreased (-0.270554 --> -0.301140).  Saving model ...
Epoch: 6 cost time: 1.3896501064300537
Epoch: 6, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.845 Vali Acc: 0.292 Test Loss: 3.845 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1949658393859863
Epoch: 7, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.087 Vali Acc: 0.311 Test Loss: 4.087 Test Acc: 0.311
Validation loss decreased (-0.301140 --> -0.310547).  Saving model ...
Epoch: 8 cost time: 1.1471853256225586
Epoch: 8, Steps: 10 | Train Loss: 0.039 Vali Loss: 4.188 Vali Acc: 0.329 Test Loss: 4.188 Test Acc: 0.329
Validation loss decreased (-0.310547 --> -0.329370).  Saving model ...
Epoch: 9 cost time: 1.2342455387115479
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.385 Vali Acc: 0.325 Test Loss: 4.385 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.484750747680664
Epoch: 10, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.759 Vali Acc: 0.307 Test Loss: 4.759 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3577864170074463
Epoch: 11, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.651 Vali Acc: 0.314 Test Loss: 4.651 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4440491199493408
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.577 Vali Acc: 0.336 Test Loss: 4.577 Test Acc: 0.336
Validation loss decreased (-0.329370 --> -0.336425).  Saving model ...
Epoch: 13 cost time: 1.3067209720611572
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.536 Vali Acc: 0.332 Test Loss: 4.536 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.327141523361206
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.564 Vali Acc: 0.331 Test Loss: 4.564 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1705107688903809
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.578 Vali Acc: 0.331 Test Loss: 4.578 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2491331100463867
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.589 Vali Acc: 0.334 Test Loss: 4.589 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5825812816619873
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.600 Vali Acc: 0.332 Test Loss: 4.600 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.445155382156372
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.610 Vali Acc: 0.329 Test Loss: 4.610 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.357541799545288
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.611 Vali Acc: 0.329 Test Loss: 4.611 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4684414863586426
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.619 Vali Acc: 0.329 Test Loss: 4.619 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4580836296081543
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.627 Vali Acc: 0.329 Test Loss: 4.627 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6677751541137695
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.631 Vali Acc: 0.332 Test Loss: 4.631 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 1415506
model size : 10.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.018519163131714
Epoch: 1, Steps: 10 | Train Loss: 3.301 Vali Loss: 3.267 Vali Acc: 0.066 Test Loss: 3.267 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 1.3013732433319092
Epoch: 2, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.206 Vali Acc: 0.175 Test Loss: 3.206 Test Acc: 0.175
Validation loss decreased (-0.065850 --> -0.175262).  Saving model ...
Epoch: 3 cost time: 1.3169713020324707
Epoch: 3, Steps: 10 | Train Loss: 1.824 Vali Loss: 3.037 Vali Acc: 0.247 Test Loss: 3.037 Test Acc: 0.247
Validation loss decreased (-0.175262 --> -0.247028).  Saving model ...
Epoch: 4 cost time: 1.5229063034057617
Epoch: 4, Steps: 10 | Train Loss: 1.020 Vali Loss: 3.061 Vali Acc: 0.255 Test Loss: 3.061 Test Acc: 0.255
Validation loss decreased (-0.247028 --> -0.255264).  Saving model ...
Epoch: 5 cost time: 1.3226368427276611
Epoch: 5, Steps: 10 | Train Loss: 0.473 Vali Loss: 3.203 Vali Acc: 0.302 Test Loss: 3.203 Test Acc: 0.302
Validation loss decreased (-0.255264 --> -0.302321).  Saving model ...
Epoch: 6 cost time: 1.5471806526184082
Epoch: 6, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.307 Vali Acc: 0.308 Test Loss: 3.307 Test Acc: 0.308
Validation loss decreased (-0.302321 --> -0.308202).  Saving model ...
Epoch: 7 cost time: 1.7028117179870605
Epoch: 7, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.509 Vali Acc: 0.300 Test Loss: 3.509 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.523531198501587
Epoch: 8, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.604 Vali Acc: 0.314 Test Loss: 3.604 Test Acc: 0.314
Validation loss decreased (-0.308202 --> -0.314082).  Saving model ...
Epoch: 9 cost time: 1.3529999256134033
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.740 Vali Acc: 0.322 Test Loss: 3.740 Test Acc: 0.322
Validation loss decreased (-0.314082 --> -0.322316).  Saving model ...
Epoch: 10 cost time: 1.458338737487793
Epoch: 10, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.825 Vali Acc: 0.326 Test Loss: 3.825 Test Acc: 0.326
Validation loss decreased (-0.322316 --> -0.325844).  Saving model ...
Epoch: 11 cost time: 1.3915507793426514
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.881 Vali Acc: 0.324 Test Loss: 3.881 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5644469261169434
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.889 Vali Acc: 0.327 Test Loss: 3.889 Test Acc: 0.327
Validation loss decreased (-0.325844 --> -0.327020).  Saving model ...
Epoch: 13 cost time: 1.6841990947723389
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.874 Vali Acc: 0.324 Test Loss: 3.874 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6748442649841309
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.880 Vali Acc: 0.328 Test Loss: 3.880 Test Acc: 0.328
Validation loss decreased (-0.327020 --> -0.328196).  Saving model ...
Epoch: 15 cost time: 1.6109673976898193
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.897 Vali Acc: 0.326 Test Loss: 3.897 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6181302070617676
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.908 Vali Acc: 0.326 Test Loss: 3.908 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.406266450881958
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.923 Vali Acc: 0.325 Test Loss: 3.923 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6094720363616943
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.939 Vali Acc: 0.327 Test Loss: 3.939 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6493191719055176
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.950 Vali Acc: 0.328 Test Loss: 3.950 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5837359428405762
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.956 Vali Acc: 0.329 Test Loss: 3.956 Test Acc: 0.329
Validation loss decreased (-0.328196 --> -0.329372).  Saving model ...
Epoch: 21 cost time: 1.4946725368499756
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.964 Vali Acc: 0.331 Test Loss: 3.964 Test Acc: 0.331
Validation loss decreased (-0.329372 --> -0.330549).  Saving model ...
Epoch: 22 cost time: 1.4807765483856201
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.976 Vali Acc: 0.332 Test Loss: 3.976 Test Acc: 0.332
Validation loss decreased (-0.330549 --> -0.331725).  Saving model ...
Epoch: 23 cost time: 1.5773406028747559
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.986 Vali Acc: 0.333 Test Loss: 3.986 Test Acc: 0.333
Validation loss decreased (-0.331725 --> -0.332901).  Saving model ...
Epoch: 24 cost time: 1.7075698375701904
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.000 Vali Acc: 0.331 Test Loss: 4.000 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4251196384429932
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.013 Vali Acc: 0.332 Test Loss: 4.013 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3027191162109375
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.029 Vali Acc: 0.331 Test Loss: 4.029 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.3292016983032227
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.049 Vali Acc: 0.329 Test Loss: 4.049 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5004632472991943
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.068 Vali Acc: 0.332 Test Loss: 4.068 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.554901123046875
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.077 Vali Acc: 0.331 Test Loss: 4.077 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.700648546218872
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.085 Vali Acc: 0.331 Test Loss: 4.085 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.4365198612213135
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.097 Vali Acc: 0.334 Test Loss: 4.097 Test Acc: 0.334
Validation loss decreased (-0.332901 --> -0.334077).  Saving model ...
Epoch: 32 cost time: 1.4496004581451416
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.110 Vali Acc: 0.335 Test Loss: 4.110 Test Acc: 0.335
Validation loss decreased (-0.334077 --> -0.335253).  Saving model ...
Epoch: 33 cost time: 1.5202696323394775
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.119 Vali Acc: 0.333 Test Loss: 4.119 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4881329536437988
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.137 Vali Acc: 0.333 Test Loss: 4.137 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.5658166408538818
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.145 Vali Acc: 0.332 Test Loss: 4.145 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4886574745178223
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.153 Vali Acc: 0.333 Test Loss: 4.153 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.4056148529052734
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.156 Vali Acc: 0.333 Test Loss: 4.156 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.6300344467163086
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.168 Vali Acc: 0.331 Test Loss: 4.168 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.5861573219299316
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.175 Vali Acc: 0.332 Test Loss: 4.175 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.6127488613128662
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.186 Vali Acc: 0.329 Test Loss: 4.186 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.940464973449707
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.196 Vali Acc: 0.328 Test Loss: 4.196 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.6808595657348633
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.205 Vali Acc: 0.328 Test Loss: 4.205 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 1415506
model size : 10.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2411417961120605
Epoch: 1, Steps: 10 | Train Loss: 3.398 Vali Loss: 3.321 Vali Acc: 0.089 Test Loss: 3.321 Test Acc: 0.089
Validation loss decreased (inf --> -0.089379).  Saving model ...
Epoch: 2 cost time: 1.302546739578247
Epoch: 2, Steps: 10 | Train Loss: 2.492 Vali Loss: 3.322 Vali Acc: 0.188 Test Loss: 3.322 Test Acc: 0.188
Validation loss decreased (-0.089379 --> -0.188202).  Saving model ...
Epoch: 3 cost time: 1.2805655002593994
Epoch: 3, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.377 Vali Acc: 0.248 Test Loss: 3.377 Test Acc: 0.248
Validation loss decreased (-0.188202 --> -0.248202).  Saving model ...
Epoch: 4 cost time: 1.4714844226837158
Epoch: 4, Steps: 10 | Train Loss: 0.752 Vali Loss: 3.677 Vali Acc: 0.278 Test Loss: 3.677 Test Acc: 0.278
Validation loss decreased (-0.248202 --> -0.277610).  Saving model ...
Epoch: 5 cost time: 1.3191003799438477
Epoch: 5, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.841 Vali Acc: 0.289 Test Loss: 3.841 Test Acc: 0.289
Validation loss decreased (-0.277610 --> -0.289373).  Saving model ...
Epoch: 6 cost time: 1.668630599975586
Epoch: 6, Steps: 10 | Train Loss: 0.155 Vali Loss: 4.238 Vali Acc: 0.288 Test Loss: 4.238 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5160565376281738
Epoch: 7, Steps: 10 | Train Loss: 0.085 Vali Loss: 4.463 Vali Acc: 0.295 Test Loss: 4.463 Test Acc: 0.295
Validation loss decreased (-0.289373 --> -0.295249).  Saving model ...
Epoch: 8 cost time: 1.599179983139038
Epoch: 8, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.841 Vali Acc: 0.293 Test Loss: 4.841 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4446113109588623
Epoch: 9, Steps: 10 | Train Loss: 0.082 Vali Loss: 4.752 Vali Acc: 0.311 Test Loss: 4.752 Test Acc: 0.311
Validation loss decreased (-0.295249 --> -0.310541).  Saving model ...
Epoch: 10 cost time: 1.5684146881103516
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.017 Vali Acc: 0.318 Test Loss: 5.017 Test Acc: 0.318
Validation loss decreased (-0.310541 --> -0.317597).  Saving model ...
Epoch: 11 cost time: 1.594862461090088
Epoch: 11, Steps: 10 | Train Loss: 0.014 Vali Loss: 5.009 Vali Acc: 0.321 Test Loss: 5.009 Test Acc: 0.321
Validation loss decreased (-0.317597 --> -0.321126).  Saving model ...
Epoch: 12 cost time: 1.5075149536132812
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 5.364 Vali Acc: 0.308 Test Loss: 5.364 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.734506368637085
Epoch: 13, Steps: 10 | Train Loss: 0.018 Vali Loss: 5.372 Vali Acc: 0.307 Test Loss: 5.372 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7167069911956787
Epoch: 14, Steps: 10 | Train Loss: 0.027 Vali Loss: 5.190 Vali Acc: 0.305 Test Loss: 5.190 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.735407829284668
Epoch: 15, Steps: 10 | Train Loss: 0.023 Vali Loss: 5.357 Vali Acc: 0.308 Test Loss: 5.357 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6549973487854004
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.666 Vali Acc: 0.299 Test Loss: 5.666 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7128353118896484
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.614 Vali Acc: 0.302 Test Loss: 5.614 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6631534099578857
Epoch: 18, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.635 Vali Acc: 0.311 Test Loss: 5.635 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7558376789093018
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.639 Vali Acc: 0.309 Test Loss: 5.639 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.8943088054656982
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.630 Vali Acc: 0.307 Test Loss: 5.630 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7891223430633545
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.647 Vali Acc: 0.314 Test Loss: 5.647 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 1349970
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3869051933288574
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.308 Vali Acc: 0.086 Test Loss: 3.308 Test Acc: 0.086
Validation loss decreased (inf --> -0.085849).  Saving model ...
Epoch: 2 cost time: 1.3603332042694092
Epoch: 2, Steps: 10 | Train Loss: 2.519 Vali Loss: 3.310 Vali Acc: 0.192 Test Loss: 3.310 Test Acc: 0.192
Validation loss decreased (-0.085849 --> -0.191732).  Saving model ...
Epoch: 3 cost time: 1.273488998413086
Epoch: 3, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.348 Vali Acc: 0.252 Test Loss: 3.348 Test Acc: 0.252
Validation loss decreased (-0.191732 --> -0.251731).  Saving model ...
Epoch: 4 cost time: 1.2518856525421143
Epoch: 4, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.601 Vali Acc: 0.279 Test Loss: 3.601 Test Acc: 0.279
Validation loss decreased (-0.251731 --> -0.278788).  Saving model ...
Epoch: 5 cost time: 1.4476597309112549
Epoch: 5, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.737 Vali Acc: 0.299 Test Loss: 3.737 Test Acc: 0.299
Validation loss decreased (-0.278788 --> -0.298786).  Saving model ...
Epoch: 6 cost time: 1.271090030670166
Epoch: 6, Steps: 10 | Train Loss: 0.163 Vali Loss: 4.111 Vali Acc: 0.295 Test Loss: 4.111 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1715633869171143
Epoch: 7, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.320 Vali Acc: 0.296 Test Loss: 4.320 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3053555488586426
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 4.546 Vali Acc: 0.296 Test Loss: 4.546 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.443840742111206
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 4.511 Vali Acc: 0.307 Test Loss: 4.511 Test Acc: 0.307
Validation loss decreased (-0.298786 --> -0.307014).  Saving model ...
Epoch: 10 cost time: 1.1914832592010498
Epoch: 10, Steps: 10 | Train Loss: 0.090 Vali Loss: 4.908 Vali Acc: 0.311 Test Loss: 4.908 Test Acc: 0.311
Validation loss decreased (-0.307014 --> -0.310539).  Saving model ...
Epoch: 11 cost time: 1.4020066261291504
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.934 Vali Acc: 0.327 Test Loss: 4.934 Test Acc: 0.327
Validation loss decreased (-0.310539 --> -0.327009).  Saving model ...
Epoch: 12 cost time: 1.5229363441467285
Epoch: 12, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.326 Vali Acc: 0.306 Test Loss: 5.326 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5961024761199951
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 5.147 Vali Acc: 0.320 Test Loss: 5.147 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4923086166381836
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.048 Vali Acc: 0.321 Test Loss: 5.048 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7691221237182617
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.056 Vali Acc: 0.322 Test Loss: 5.056 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.695561408996582
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.079 Vali Acc: 0.324 Test Loss: 5.079 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5998001098632812
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.097 Vali Acc: 0.329 Test Loss: 5.097 Test Acc: 0.329
Validation loss decreased (-0.327009 --> -0.329361).  Saving model ...
Epoch: 18 cost time: 1.851287603378296
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.115 Vali Acc: 0.325 Test Loss: 5.115 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8344345092773438
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.131 Vali Acc: 0.326 Test Loss: 5.131 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6575124263763428
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.145 Vali Acc: 0.326 Test Loss: 5.145 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5985443592071533
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.155 Vali Acc: 0.324 Test Loss: 5.155 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5553324222564697
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.158 Vali Acc: 0.326 Test Loss: 5.158 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3887567520141602
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.165 Vali Acc: 0.327 Test Loss: 5.165 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4625675678253174
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.175 Vali Acc: 0.329 Test Loss: 5.175 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.414102554321289
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.189 Vali Acc: 0.331 Test Loss: 5.189 Test Acc: 0.331
Validation loss decreased (-0.329361 --> -0.330536).  Saving model ...
Epoch: 26 cost time: 1.3748464584350586
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.197 Vali Acc: 0.331 Test Loss: 5.197 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3380086421966553
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.207 Vali Acc: 0.329 Test Loss: 5.207 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.403005838394165
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.212 Vali Acc: 0.325 Test Loss: 5.212 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3365254402160645
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.220 Vali Acc: 0.326 Test Loss: 5.220 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1646769046783447
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.227 Vali Acc: 0.326 Test Loss: 5.227 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.1002168655395508
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.231 Vali Acc: 0.331 Test Loss: 5.231 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.393205165863037
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.241 Vali Acc: 0.331 Test Loss: 5.241 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.5398411750793457
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.254 Vali Acc: 0.332 Test Loss: 5.254 Test Acc: 0.332
Validation loss decreased (-0.330536 --> -0.331712).  Saving model ...
Epoch: 34 cost time: 1.4307243824005127
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.264 Vali Acc: 0.331 Test Loss: 5.264 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.4593849182128906
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.280 Vali Acc: 0.331 Test Loss: 5.280 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.2771947383880615
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.290 Vali Acc: 0.332 Test Loss: 5.290 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.3126287460327148
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.295 Vali Acc: 0.331 Test Loss: 5.295 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.455984354019165
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.305 Vali Acc: 0.333 Test Loss: 5.305 Test Acc: 0.333
Validation loss decreased (-0.331712 --> -0.332888).  Saving model ...
Epoch: 39 cost time: 1.3751540184020996
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.311 Vali Acc: 0.332 Test Loss: 5.311 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.4607033729553223
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.319 Vali Acc: 0.335 Test Loss: 5.319 Test Acc: 0.335
Validation loss decreased (-0.332888 --> -0.335241).  Saving model ...
Epoch: 41 cost time: 1.3178365230560303
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.322 Vali Acc: 0.335 Test Loss: 5.322 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.2591910362243652
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.328 Vali Acc: 0.332 Test Loss: 5.328 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.360713005065918
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.335 Vali Acc: 0.329 Test Loss: 5.335 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.3431828022003174
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.348 Vali Acc: 0.329 Test Loss: 5.348 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.3197665214538574
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.356 Vali Acc: 0.331 Test Loss: 5.356 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.3520097732543945
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.359 Vali Acc: 0.333 Test Loss: 5.359 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.3195836544036865
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.362 Vali Acc: 0.331 Test Loss: 5.362 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.3398571014404297
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.368 Vali Acc: 0.331 Test Loss: 5.368 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.4424397945404053
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.375 Vali Acc: 0.332 Test Loss: 5.375 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.5012576580047607
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.382 Vali Acc: 0.332 Test Loss: 5.382 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 1349970
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.179807662963867
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.295 Vali Acc: 0.081 Test Loss: 3.295 Test Acc: 0.081
Validation loss decreased (inf --> -0.081144).  Saving model ...
Epoch: 2 cost time: 1.3537967205047607
Epoch: 2, Steps: 10 | Train Loss: 2.553 Vali Loss: 3.278 Vali Acc: 0.181 Test Loss: 3.278 Test Acc: 0.181
Validation loss decreased (-0.081144 --> -0.181144).  Saving model ...
Epoch: 3 cost time: 1.436009168624878
Epoch: 3, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.271 Vali Acc: 0.244 Test Loss: 3.271 Test Acc: 0.244
Validation loss decreased (-0.181144 --> -0.243497).  Saving model ...
Epoch: 4 cost time: 1.32179594039917
Epoch: 4, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.451 Vali Acc: 0.274 Test Loss: 3.451 Test Acc: 0.274
Validation loss decreased (-0.243497 --> -0.274083).  Saving model ...
Epoch: 5 cost time: 1.367232322692871
Epoch: 5, Steps: 10 | Train Loss: 0.402 Vali Loss: 3.546 Vali Acc: 0.306 Test Loss: 3.546 Test Acc: 0.306
Validation loss decreased (-0.274083 --> -0.305847).  Saving model ...
Epoch: 6 cost time: 1.430741310119629
Epoch: 6, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.881 Vali Acc: 0.299 Test Loss: 3.881 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4668233394622803
Epoch: 7, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.983 Vali Acc: 0.313 Test Loss: 3.983 Test Acc: 0.313
Validation loss decreased (-0.305847 --> -0.312901).  Saving model ...
Epoch: 8 cost time: 1.279426097869873
Epoch: 8, Steps: 10 | Train Loss: 0.084 Vali Loss: 4.354 Vali Acc: 0.300 Test Loss: 4.354 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.286496639251709
Epoch: 9, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.372 Vali Acc: 0.307 Test Loss: 4.372 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.537057876586914
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.560 Vali Acc: 0.322 Test Loss: 4.560 Test Acc: 0.322
Validation loss decreased (-0.312901 --> -0.322307).  Saving model ...
Epoch: 11 cost time: 1.5707800388336182
Epoch: 11, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.566 Vali Acc: 0.320 Test Loss: 4.566 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5801184177398682
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.833 Vali Acc: 0.314 Test Loss: 4.833 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.5878760814666748
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.651 Vali Acc: 0.322 Test Loss: 4.651 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4414641857147217
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.637 Vali Acc: 0.334 Test Loss: 4.637 Test Acc: 0.334
Validation loss decreased (-0.322307 --> -0.334071).  Saving model ...
Epoch: 15 cost time: 1.435753583908081
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.640 Vali Acc: 0.338 Test Loss: 4.640 Test Acc: 0.338
Validation loss decreased (-0.334071 --> -0.337601).  Saving model ...
Epoch: 16 cost time: 1.390918254852295
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.678 Vali Acc: 0.331 Test Loss: 4.678 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.336500644683838
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.676 Vali Acc: 0.332 Test Loss: 4.676 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5100417137145996
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.676 Vali Acc: 0.332 Test Loss: 4.676 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3966925144195557
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.683 Vali Acc: 0.332 Test Loss: 4.683 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.4541316032409668
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.687 Vali Acc: 0.334 Test Loss: 4.687 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.391340732574463
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.699 Vali Acc: 0.333 Test Loss: 4.699 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.440220832824707
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.701 Vali Acc: 0.331 Test Loss: 4.701 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3271839618682861
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.706 Vali Acc: 0.329 Test Loss: 4.706 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.363581895828247
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.713 Vali Acc: 0.331 Test Loss: 4.713 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5017004013061523
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.728 Vali Acc: 0.333 Test Loss: 4.728 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 1349970
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.160799264907837
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.256 Vali Acc: 0.068 Test Loss: 3.256 Test Acc: 0.068
Validation loss decreased (inf --> -0.068203).  Saving model ...
Epoch: 2 cost time: 1.2179186344146729
Epoch: 2, Steps: 10 | Train Loss: 2.710 Vali Loss: 3.208 Vali Acc: 0.173 Test Loss: 3.208 Test Acc: 0.173
Validation loss decreased (-0.068203 --> -0.172909).  Saving model ...
Epoch: 3 cost time: 1.0922400951385498
Epoch: 3, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.088 Vali Acc: 0.224 Test Loss: 3.088 Test Acc: 0.224
Validation loss decreased (-0.172909 --> -0.223499).  Saving model ...
Epoch: 4 cost time: 1.3771600723266602
Epoch: 4, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.066 Vali Acc: 0.298 Test Loss: 3.066 Test Acc: 0.298
Validation loss decreased (-0.223499 --> -0.297616).  Saving model ...
Epoch: 5 cost time: 1.3126096725463867
Epoch: 5, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.134 Vali Acc: 0.305 Test Loss: 3.134 Test Acc: 0.305
Validation loss decreased (-0.297616 --> -0.304675).  Saving model ...
Epoch: 6 cost time: 1.2128407955169678
Epoch: 6, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.355 Vali Acc: 0.292 Test Loss: 3.355 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2866899967193604
Epoch: 7, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.448 Vali Acc: 0.311 Test Loss: 3.448 Test Acc: 0.311
Validation loss decreased (-0.304675 --> -0.310554).  Saving model ...
Epoch: 8 cost time: 1.3253135681152344
Epoch: 8, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.786 Vali Acc: 0.301 Test Loss: 3.786 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4524776935577393
Epoch: 9, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.788 Vali Acc: 0.322 Test Loss: 3.788 Test Acc: 0.322
Validation loss decreased (-0.310554 --> -0.322315).  Saving model ...
Epoch: 10 cost time: 1.3094074726104736
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.758 Vali Acc: 0.324 Test Loss: 3.758 Test Acc: 0.324
Validation loss decreased (-0.322315 --> -0.323492).  Saving model ...
Epoch: 11 cost time: 1.446185827255249
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.821 Vali Acc: 0.322 Test Loss: 3.821 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3760976791381836
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.900 Vali Acc: 0.319 Test Loss: 3.900 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2105882167816162
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.915 Vali Acc: 0.327 Test Loss: 3.915 Test Acc: 0.327
Validation loss decreased (-0.323492 --> -0.327020).  Saving model ...
Epoch: 14 cost time: 1.2170610427856445
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.929 Vali Acc: 0.327 Test Loss: 3.929 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.574235439300537
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.945 Vali Acc: 0.320 Test Loss: 3.945 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3939144611358643
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.954 Vali Acc: 0.321 Test Loss: 3.954 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5273032188415527
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.954 Vali Acc: 0.322 Test Loss: 3.954 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4545202255249023
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.969 Vali Acc: 0.320 Test Loss: 3.969 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1303770542144775
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.990 Vali Acc: 0.322 Test Loss: 3.990 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2447714805603027
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.016 Vali Acc: 0.322 Test Loss: 4.016 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1050925254821777
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.034 Vali Acc: 0.320 Test Loss: 4.034 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3094346523284912
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.036 Vali Acc: 0.319 Test Loss: 4.036 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4454429149627686
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.038 Vali Acc: 0.321 Test Loss: 4.038 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 1349970
model size : 10.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2859954833984375
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.294 Vali Acc: 0.084 Test Loss: 3.294 Test Acc: 0.084
Validation loss decreased (inf --> -0.083496).  Saving model ...
Epoch: 2 cost time: 1.2668306827545166
Epoch: 2, Steps: 10 | Train Loss: 2.781 Vali Loss: 3.277 Vali Acc: 0.120 Test Loss: 3.277 Test Acc: 0.120
Validation loss decreased (-0.083496 --> -0.119967).  Saving model ...
Epoch: 3 cost time: 1.3382601737976074
Epoch: 3, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.162 Vali Acc: 0.186 Test Loss: 3.162 Test Acc: 0.186
Validation loss decreased (-0.119967 --> -0.185851).  Saving model ...
Epoch: 4 cost time: 1.3493013381958008
Epoch: 4, Steps: 10 | Train Loss: 1.383 Vali Loss: 3.170 Vali Acc: 0.245 Test Loss: 3.170 Test Acc: 0.245
Validation loss decreased (-0.185851 --> -0.244674).  Saving model ...
Epoch: 5 cost time: 1.3299734592437744
Epoch: 5, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.279 Vali Acc: 0.265 Test Loss: 3.279 Test Acc: 0.265
Validation loss decreased (-0.244674 --> -0.264673).  Saving model ...
Epoch: 6 cost time: 1.2263071537017822
Epoch: 6, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.406 Vali Acc: 0.288 Test Loss: 3.406 Test Acc: 0.288
Validation loss decreased (-0.264673 --> -0.288201).  Saving model ...
Epoch: 7 cost time: 1.3927028179168701
Epoch: 7, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.545 Vali Acc: 0.309 Test Loss: 3.545 Test Acc: 0.309
Validation loss decreased (-0.288201 --> -0.309376).  Saving model ...
Epoch: 8 cost time: 1.50844407081604
Epoch: 8, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.674 Vali Acc: 0.319 Test Loss: 3.674 Test Acc: 0.319
Validation loss decreased (-0.309376 --> -0.318787).  Saving model ...
Epoch: 9 cost time: 1.48982572555542
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.870 Vali Acc: 0.325 Test Loss: 3.870 Test Acc: 0.325
Validation loss decreased (-0.318787 --> -0.324667).  Saving model ...
Epoch: 10 cost time: 1.4803521633148193
Epoch: 10, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.931 Vali Acc: 0.326 Test Loss: 3.931 Test Acc: 0.326
Validation loss decreased (-0.324667 --> -0.325843).  Saving model ...
Epoch: 11 cost time: 1.4481115341186523
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.009 Vali Acc: 0.331 Test Loss: 4.009 Test Acc: 0.331
Validation loss decreased (-0.325843 --> -0.330548).  Saving model ...
Epoch: 12 cost time: 1.6072635650634766
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.053 Vali Acc: 0.339 Test Loss: 4.053 Test Acc: 0.339
Validation loss decreased (-0.330548 --> -0.338783).  Saving model ...
Epoch: 13 cost time: 1.5360982418060303
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.101 Vali Acc: 0.340 Test Loss: 4.101 Test Acc: 0.340
Validation loss decreased (-0.338783 --> -0.339959).  Saving model ...
Epoch: 14 cost time: 1.4811558723449707
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.124 Vali Acc: 0.344 Test Loss: 4.124 Test Acc: 0.344
Validation loss decreased (-0.339959 --> -0.343488).  Saving model ...
Epoch: 15 cost time: 1.4908733367919922
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.130 Vali Acc: 0.340 Test Loss: 4.130 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.261528491973877
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.138 Vali Acc: 0.341 Test Loss: 4.138 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4642810821533203
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.168 Vali Acc: 0.342 Test Loss: 4.168 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5391128063201904
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.191 Vali Acc: 0.336 Test Loss: 4.191 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5469515323638916
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.207 Vali Acc: 0.339 Test Loss: 4.207 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.7083203792572021
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.227 Vali Acc: 0.336 Test Loss: 4.227 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5887525081634521
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.250 Vali Acc: 0.336 Test Loss: 4.250 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5284698009490967
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.271 Vali Acc: 0.339 Test Loss: 4.271 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.5789344310760498
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.277 Vali Acc: 0.342 Test Loss: 4.277 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.6040542125701904
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.280 Vali Acc: 0.339 Test Loss: 4.280 Test Acc: 0.339
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 1625298
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2919704914093018
Epoch: 1, Steps: 10 | Train Loss: 3.321 Vali Loss: 3.288 Vali Acc: 0.078 Test Loss: 3.288 Test Acc: 0.078
Validation loss decreased (inf --> -0.077614).  Saving model ...
Epoch: 2 cost time: 1.30397367477417
Epoch: 2, Steps: 10 | Train Loss: 2.808 Vali Loss: 3.271 Vali Acc: 0.119 Test Loss: 3.271 Test Acc: 0.119
Validation loss decreased (-0.077614 --> -0.118791).  Saving model ...
Epoch: 3 cost time: 1.3286919593811035
Epoch: 3, Steps: 10 | Train Loss: 2.116 Vali Loss: 3.159 Vali Acc: 0.188 Test Loss: 3.159 Test Acc: 0.188
Validation loss decreased (-0.118791 --> -0.188204).  Saving model ...
Epoch: 4 cost time: 1.470346212387085
Epoch: 4, Steps: 10 | Train Loss: 1.429 Vali Loss: 3.156 Vali Acc: 0.253 Test Loss: 3.156 Test Acc: 0.253
Validation loss decreased (-0.188204 --> -0.252910).  Saving model ...
Epoch: 5 cost time: 1.2527103424072266
Epoch: 5, Steps: 10 | Train Loss: 0.929 Vali Loss: 3.262 Vali Acc: 0.258 Test Loss: 3.262 Test Acc: 0.258
Validation loss decreased (-0.252910 --> -0.257614).  Saving model ...
Epoch: 6 cost time: 1.321629524230957
Epoch: 6, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.356 Vali Acc: 0.291 Test Loss: 3.356 Test Acc: 0.291
Validation loss decreased (-0.257614 --> -0.290555).  Saving model ...
Epoch: 7 cost time: 1.3523597717285156
Epoch: 7, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.495 Vali Acc: 0.301 Test Loss: 3.495 Test Acc: 0.301
Validation loss decreased (-0.290555 --> -0.301142).  Saving model ...
Epoch: 8 cost time: 1.3779850006103516
Epoch: 8, Steps: 10 | Train Loss: 0.148 Vali Loss: 3.602 Vali Acc: 0.315 Test Loss: 3.602 Test Acc: 0.315
Validation loss decreased (-0.301142 --> -0.315258).  Saving model ...
Epoch: 9 cost time: 1.3766717910766602
Epoch: 9, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.773 Vali Acc: 0.316 Test Loss: 3.773 Test Acc: 0.316
Validation loss decreased (-0.315258 --> -0.316433).  Saving model ...
Epoch: 10 cost time: 1.228734016418457
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.849 Vali Acc: 0.332 Test Loss: 3.849 Test Acc: 0.332
Validation loss decreased (-0.316433 --> -0.331726).  Saving model ...
Epoch: 11 cost time: 1.424009084701538
Epoch: 11, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.942 Vali Acc: 0.327 Test Loss: 3.942 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2195584774017334
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.027 Vali Acc: 0.318 Test Loss: 4.027 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3028085231781006
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.046 Vali Acc: 0.340 Test Loss: 4.046 Test Acc: 0.340
Validation loss decreased (-0.331726 --> -0.339960).  Saving model ...
Epoch: 14 cost time: 1.3994240760803223
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.075 Vali Acc: 0.345 Test Loss: 4.075 Test Acc: 0.345
Validation loss decreased (-0.339960 --> -0.344665).  Saving model ...
Epoch: 15 cost time: 1.448821783065796
Epoch: 15, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.099 Vali Acc: 0.347 Test Loss: 4.099 Test Acc: 0.347
Validation loss decreased (-0.344665 --> -0.347018).  Saving model ...
Epoch: 16 cost time: 1.329141616821289
Epoch: 16, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.110 Vali Acc: 0.347 Test Loss: 4.110 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3521630764007568
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.125 Vali Acc: 0.348 Test Loss: 4.125 Test Acc: 0.348
Validation loss decreased (-0.347018 --> -0.348194).  Saving model ...
Epoch: 18 cost time: 1.2717840671539307
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.135 Vali Acc: 0.344 Test Loss: 4.135 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2669193744659424
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.153 Vali Acc: 0.346 Test Loss: 4.153 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5109097957611084
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.172 Vali Acc: 0.347 Test Loss: 4.172 Test Acc: 0.347
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.544792890548706
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.189 Vali Acc: 0.347 Test Loss: 4.189 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5532455444335938
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.201 Vali Acc: 0.347 Test Loss: 4.201 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.490901231765747
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.212 Vali Acc: 0.345 Test Loss: 4.212 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4541552066802979
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.224 Vali Acc: 0.351 Test Loss: 4.224 Test Acc: 0.351
Validation loss decreased (-0.348194 --> -0.350546).  Saving model ...
Epoch: 25 cost time: 1.5372049808502197
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.230 Vali Acc: 0.352 Test Loss: 4.230 Test Acc: 0.352
Validation loss decreased (-0.350546 --> -0.351722).  Saving model ...
Epoch: 26 cost time: 1.6231298446655273
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.241 Vali Acc: 0.353 Test Loss: 4.241 Test Acc: 0.353
Validation loss decreased (-0.351722 --> -0.352899).  Saving model ...
Epoch: 27 cost time: 1.4282381534576416
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.259 Vali Acc: 0.348 Test Loss: 4.259 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1693754196166992
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.282 Vali Acc: 0.349 Test Loss: 4.282 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.3003301620483398
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.304 Vali Acc: 0.352 Test Loss: 4.304 Test Acc: 0.352
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.4842705726623535
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.311 Vali Acc: 0.353 Test Loss: 4.311 Test Acc: 0.353
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.5353195667266846
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.321 Vali Acc: 0.353 Test Loss: 4.321 Test Acc: 0.353
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5528717041015625
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.338 Vali Acc: 0.348 Test Loss: 4.338 Test Acc: 0.348
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6350128650665283
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.348 Vali Acc: 0.352 Test Loss: 4.348 Test Acc: 0.352
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5536630153656006
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.356 Vali Acc: 0.351 Test Loss: 4.356 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.6230754852294922
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.362 Vali Acc: 0.349 Test Loss: 4.362 Test Acc: 0.349
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.445404052734375
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.371 Vali Acc: 0.347 Test Loss: 4.371 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.35294117647058826
model parameter : 1625298
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2676472663879395
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.282 Vali Acc: 0.066 Test Loss: 3.282 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 1.501692533493042
Epoch: 2, Steps: 10 | Train Loss: 2.823 Vali Loss: 3.262 Vali Acc: 0.111 Test Loss: 3.262 Test Acc: 0.111
Validation loss decreased (-0.065850 --> -0.110556).  Saving model ...
Epoch: 3 cost time: 1.4574940204620361
Epoch: 3, Steps: 10 | Train Loss: 2.212 Vali Loss: 3.151 Vali Acc: 0.185 Test Loss: 3.151 Test Acc: 0.185
Validation loss decreased (-0.110556 --> -0.184674).  Saving model ...
Epoch: 4 cost time: 1.4763166904449463
Epoch: 4, Steps: 10 | Train Loss: 1.508 Vali Loss: 3.110 Vali Acc: 0.249 Test Loss: 3.110 Test Acc: 0.249
Validation loss decreased (-0.184674 --> -0.249381).  Saving model ...
Epoch: 5 cost time: 1.3704140186309814
Epoch: 5, Steps: 10 | Train Loss: 0.986 Vali Loss: 3.177 Vali Acc: 0.261 Test Loss: 3.177 Test Acc: 0.261
Validation loss decreased (-0.249381 --> -0.261145).  Saving model ...
Epoch: 6 cost time: 1.5597851276397705
Epoch: 6, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.245 Vali Acc: 0.279 Test Loss: 3.245 Test Acc: 0.279
Validation loss decreased (-0.261145 --> -0.278791).  Saving model ...
Epoch: 7 cost time: 1.5382540225982666
Epoch: 7, Steps: 10 | Train Loss: 0.320 Vali Loss: 3.338 Vali Acc: 0.325 Test Loss: 3.338 Test Acc: 0.325
Validation loss decreased (-0.278791 --> -0.324673).  Saving model ...
Epoch: 8 cost time: 1.5046947002410889
Epoch: 8, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.439 Vali Acc: 0.319 Test Loss: 3.439 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.323383092880249
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.552 Vali Acc: 0.327 Test Loss: 3.552 Test Acc: 0.327
Validation loss decreased (-0.324673 --> -0.327023).  Saving model ...
Epoch: 10 cost time: 1.4422681331634521
Epoch: 10, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.630 Vali Acc: 0.326 Test Loss: 3.630 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.531796932220459
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.736 Vali Acc: 0.329 Test Loss: 3.736 Test Acc: 0.329
Validation loss decreased (-0.327023 --> -0.329374).  Saving model ...
Epoch: 12 cost time: 1.5148241519927979
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.728 Vali Acc: 0.340 Test Loss: 3.728 Test Acc: 0.340
Validation loss decreased (-0.329374 --> -0.339963).  Saving model ...
Epoch: 13 cost time: 1.437305212020874
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.780 Vali Acc: 0.333 Test Loss: 3.780 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4956350326538086
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.804 Vali Acc: 0.347 Test Loss: 3.804 Test Acc: 0.347
Validation loss decreased (-0.339963 --> -0.347021).  Saving model ...
Epoch: 15 cost time: 1.3405663967132568
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.833 Vali Acc: 0.345 Test Loss: 3.833 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2593951225280762
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.856 Vali Acc: 0.346 Test Loss: 3.856 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.456653118133545
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.866 Vali Acc: 0.349 Test Loss: 3.866 Test Acc: 0.349
Validation loss decreased (-0.347021 --> -0.349373).  Saving model ...
Epoch: 18 cost time: 1.3870701789855957
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.882 Vali Acc: 0.345 Test Loss: 3.882 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5281963348388672
Epoch: 19, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.898 Vali Acc: 0.341 Test Loss: 3.898 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5992083549499512
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.917 Vali Acc: 0.344 Test Loss: 3.917 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.362715244293213
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.941 Vali Acc: 0.344 Test Loss: 3.941 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5469651222229004
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.950 Vali Acc: 0.345 Test Loss: 3.950 Test Acc: 0.345
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5103497505187988
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.954 Vali Acc: 0.341 Test Loss: 3.954 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3312702178955078
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.958 Vali Acc: 0.348 Test Loss: 3.958 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.319559097290039
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.962 Vali Acc: 0.351 Test Loss: 3.962 Test Acc: 0.351
Validation loss decreased (-0.349373 --> -0.350549).  Saving model ...
Epoch: 26 cost time: 1.3317217826843262
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.976 Vali Acc: 0.352 Test Loss: 3.976 Test Acc: 0.352
Validation loss decreased (-0.350549 --> -0.351725).  Saving model ...
Epoch: 27 cost time: 1.65451979637146
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.997 Vali Acc: 0.346 Test Loss: 3.997 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2690882682800293
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.016 Vali Acc: 0.348 Test Loss: 4.016 Test Acc: 0.348
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.509101152420044
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.033 Vali Acc: 0.348 Test Loss: 4.033 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.381054162979126
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.037 Vali Acc: 0.346 Test Loss: 4.037 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.513106107711792
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.048 Vali Acc: 0.347 Test Loss: 4.048 Test Acc: 0.347
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.3126051425933838
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.061 Vali Acc: 0.347 Test Loss: 4.061 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.3422508239746094
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.068 Vali Acc: 0.346 Test Loss: 4.068 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.4286391735076904
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.085 Vali Acc: 0.349 Test Loss: 4.085 Test Acc: 0.349
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2050747871398926
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.095 Vali Acc: 0.346 Test Loss: 4.095 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.3040506839752197
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.104 Vali Acc: 0.344 Test Loss: 4.104 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 1625298
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.227627754211426
Epoch: 1, Steps: 10 | Train Loss: 3.285 Vali Loss: 3.267 Vali Acc: 0.073 Test Loss: 3.267 Test Acc: 0.073
Validation loss decreased (inf --> -0.072909).  Saving model ...
Epoch: 2 cost time: 1.2378804683685303
Epoch: 2, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.248 Vali Acc: 0.101 Test Loss: 3.248 Test Acc: 0.101
Validation loss decreased (-0.072909 --> -0.101144).  Saving model ...
Epoch: 3 cost time: 1.2786061763763428
Epoch: 3, Steps: 10 | Train Loss: 2.371 Vali Loss: 3.152 Vali Acc: 0.165 Test Loss: 3.152 Test Acc: 0.165
Validation loss decreased (-0.101144 --> -0.164674).  Saving model ...
Epoch: 4 cost time: 1.1619958877563477
Epoch: 4, Steps: 10 | Train Loss: 1.776 Vali Loss: 3.039 Vali Acc: 0.242 Test Loss: 3.039 Test Acc: 0.242
Validation loss decreased (-0.164674 --> -0.242323).  Saving model ...
Epoch: 5 cost time: 1.2517850399017334
Epoch: 5, Steps: 10 | Train Loss: 1.209 Vali Loss: 3.028 Vali Acc: 0.244 Test Loss: 3.028 Test Acc: 0.244
Validation loss decreased (-0.242323 --> -0.243499).  Saving model ...
Epoch: 6 cost time: 1.2522940635681152
Epoch: 6, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.037 Vali Acc: 0.269 Test Loss: 3.037 Test Acc: 0.269
Validation loss decreased (-0.243499 --> -0.269381).  Saving model ...
Epoch: 7 cost time: 1.2793340682983398
Epoch: 7, Steps: 10 | Train Loss: 0.418 Vali Loss: 3.050 Vali Acc: 0.309 Test Loss: 3.050 Test Acc: 0.309
Validation loss decreased (-0.269381 --> -0.309381).  Saving model ...
Epoch: 8 cost time: 1.2093491554260254
Epoch: 8, Steps: 10 | Train Loss: 0.205 Vali Loss: 3.218 Vali Acc: 0.280 Test Loss: 3.218 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3308219909667969
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.268 Vali Acc: 0.306 Test Loss: 3.268 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3695077896118164
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.343 Vali Acc: 0.305 Test Loss: 3.343 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.490088939666748
Epoch: 11, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.493 Vali Acc: 0.284 Test Loss: 3.493 Test Acc: 0.284
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6526710987091064
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.461 Vali Acc: 0.312 Test Loss: 3.461 Test Acc: 0.312
Validation loss decreased (-0.309381 --> -0.311730).  Saving model ...
Epoch: 13 cost time: 1.3725552558898926
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.486 Vali Acc: 0.315 Test Loss: 3.486 Test Acc: 0.315
Validation loss decreased (-0.311730 --> -0.315259).  Saving model ...
Epoch: 14 cost time: 1.302905559539795
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.507 Vali Acc: 0.316 Test Loss: 3.507 Test Acc: 0.316
Validation loss decreased (-0.315259 --> -0.316436).  Saving model ...
Epoch: 15 cost time: 1.3483643531799316
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.538 Vali Acc: 0.312 Test Loss: 3.538 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2696890830993652
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.554 Vali Acc: 0.311 Test Loss: 3.554 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4314260482788086
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.571 Vali Acc: 0.307 Test Loss: 3.571 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3338885307312012
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.584 Vali Acc: 0.311 Test Loss: 3.584 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2521588802337646
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.596 Vali Acc: 0.309 Test Loss: 3.596 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.266474962234497
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.608 Vali Acc: 0.308 Test Loss: 3.608 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1914315223693848
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.624 Vali Acc: 0.313 Test Loss: 3.624 Test Acc: 0.313
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1896135807037354
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.642 Vali Acc: 0.311 Test Loss: 3.642 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.286165714263916
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.655 Vali Acc: 0.311 Test Loss: 3.655 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2595841884613037
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.670 Vali Acc: 0.308 Test Loss: 3.670 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3164705882352941
model parameter : 1625298
model size : 8.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3816497325897217
Epoch: 1, Steps: 10 | Train Loss: 3.391 Vali Loss: 3.314 Vali Acc: 0.047 Test Loss: 3.314 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.2883718013763428
Epoch: 2, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.330 Vali Acc: 0.099 Test Loss: 3.330 Test Acc: 0.099
Validation loss decreased (-0.047026 --> -0.098790).  Saving model ...
Epoch: 3 cost time: 1.3136467933654785
Epoch: 3, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.176 Vali Acc: 0.187 Test Loss: 3.176 Test Acc: 0.187
Validation loss decreased (-0.098790 --> -0.187027).  Saving model ...
Epoch: 4 cost time: 1.4772133827209473
Epoch: 4, Steps: 10 | Train Loss: 1.426 Vali Loss: 3.225 Vali Acc: 0.226 Test Loss: 3.225 Test Acc: 0.226
Validation loss decreased (-0.187027 --> -0.225850).  Saving model ...
Epoch: 5 cost time: 1.3905432224273682
Epoch: 5, Steps: 10 | Train Loss: 0.850 Vali Loss: 3.329 Vali Acc: 0.273 Test Loss: 3.329 Test Acc: 0.273
Validation loss decreased (-0.225850 --> -0.272908).  Saving model ...
Epoch: 6 cost time: 1.5582480430603027
Epoch: 6, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.402 Vali Acc: 0.287 Test Loss: 3.402 Test Acc: 0.287
Validation loss decreased (-0.272908 --> -0.287025).  Saving model ...
Epoch: 7 cost time: 1.4467008113861084
Epoch: 7, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.595 Vali Acc: 0.300 Test Loss: 3.595 Test Acc: 0.300
Validation loss decreased (-0.287025 --> -0.299964).  Saving model ...
Epoch: 8 cost time: 1.3849310874938965
Epoch: 8, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.696 Vali Acc: 0.307 Test Loss: 3.696 Test Acc: 0.307
Validation loss decreased (-0.299964 --> -0.307022).  Saving model ...
Epoch: 9 cost time: 1.2130181789398193
Epoch: 9, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.879 Vali Acc: 0.312 Test Loss: 3.879 Test Acc: 0.312
Validation loss decreased (-0.307022 --> -0.311726).  Saving model ...
Epoch: 10 cost time: 1.203526258468628
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 4.002 Vali Acc: 0.318 Test Loss: 4.002 Test Acc: 0.318
Validation loss decreased (-0.311726 --> -0.317607).  Saving model ...
Epoch: 11 cost time: 1.2463490962982178
Epoch: 11, Steps: 10 | Train Loss: 0.041 Vali Loss: 4.211 Vali Acc: 0.312 Test Loss: 4.211 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1680090427398682
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.164 Vali Acc: 0.327 Test Loss: 4.164 Test Acc: 0.327
Validation loss decreased (-0.317607 --> -0.327017).  Saving model ...
Epoch: 13 cost time: 1.4141597747802734
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.178 Vali Acc: 0.324 Test Loss: 4.178 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2875087261199951
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.238 Vali Acc: 0.326 Test Loss: 4.238 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.428194522857666
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.260 Vali Acc: 0.327 Test Loss: 4.260 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3897011280059814
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.295 Vali Acc: 0.334 Test Loss: 4.295 Test Acc: 0.334
Validation loss decreased (-0.327017 --> -0.334075).  Saving model ...
Epoch: 17 cost time: 1.43924880027771
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.301 Vali Acc: 0.328 Test Loss: 4.301 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.461843729019165
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.331 Vali Acc: 0.331 Test Loss: 4.331 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3405296802520752
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.363 Vali Acc: 0.334 Test Loss: 4.363 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2994203567504883
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.390 Vali Acc: 0.338 Test Loss: 4.390 Test Acc: 0.338
Validation loss decreased (-0.334075 --> -0.337603).  Saving model ...
Epoch: 21 cost time: 1.324233055114746
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.408 Vali Acc: 0.334 Test Loss: 4.408 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.4152252674102783
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.418 Vali Acc: 0.332 Test Loss: 4.418 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4230880737304688
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.437 Vali Acc: 0.333 Test Loss: 4.437 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4637877941131592
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.461 Vali Acc: 0.338 Test Loss: 4.461 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3598129749298096
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.476 Vali Acc: 0.336 Test Loss: 4.476 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.53216552734375
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.480 Vali Acc: 0.340 Test Loss: 4.480 Test Acc: 0.340
Validation loss decreased (-0.337603 --> -0.339955).  Saving model ...
Epoch: 27 cost time: 1.3552591800689697
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.500 Vali Acc: 0.341 Test Loss: 4.500 Test Acc: 0.341
Validation loss decreased (-0.339955 --> -0.341131).  Saving model ...
Epoch: 28 cost time: 1.322511911392212
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.540 Vali Acc: 0.339 Test Loss: 4.540 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2765569686889648
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.549 Vali Acc: 0.336 Test Loss: 4.549 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.4437975883483887
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.562 Vali Acc: 0.338 Test Loss: 4.562 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.3069329261779785
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.563 Vali Acc: 0.335 Test Loss: 4.563 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3059577941894531
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.562 Vali Acc: 0.340 Test Loss: 4.562 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.5089366436004639
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.575 Vali Acc: 0.339 Test Loss: 4.575 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3711130619049072
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.591 Vali Acc: 0.339 Test Loss: 4.591 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.3804490566253662
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.606 Vali Acc: 0.341 Test Loss: 4.606 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.37943434715271
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.618 Vali Acc: 0.345 Test Loss: 4.618 Test Acc: 0.345
Validation loss decreased (-0.341131 --> -0.344660).  Saving model ...
Epoch: 37 cost time: 1.3806819915771484
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.631 Vali Acc: 0.345 Test Loss: 4.631 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.3370699882507324
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.647 Vali Acc: 0.342 Test Loss: 4.647 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.30318021774292
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.663 Vali Acc: 0.342 Test Loss: 4.663 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.4776151180267334
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.667 Vali Acc: 0.342 Test Loss: 4.667 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.3560869693756104
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.674 Vali Acc: 0.341 Test Loss: 4.674 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.439765214920044
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.680 Vali Acc: 0.336 Test Loss: 4.680 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4225454330444336
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.694 Vali Acc: 0.335 Test Loss: 4.694 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.3475463390350342
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.706 Vali Acc: 0.338 Test Loss: 4.706 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.4026830196380615
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.718 Vali Acc: 0.335 Test Loss: 4.718 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.381610631942749
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.726 Vali Acc: 0.335 Test Loss: 4.726 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 1101010
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.3648529052734375
Epoch: 1, Steps: 10 | Train Loss: 3.393 Vali Loss: 3.300 Vali Acc: 0.044 Test Loss: 3.300 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 1.2461864948272705
Epoch: 2, Steps: 10 | Train Loss: 2.864 Vali Loss: 3.321 Vali Acc: 0.095 Test Loss: 3.321 Test Acc: 0.095
Validation loss decreased (-0.043496 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 1.3803694248199463
Epoch: 3, Steps: 10 | Train Loss: 2.123 Vali Loss: 3.166 Vali Acc: 0.192 Test Loss: 3.166 Test Acc: 0.192
Validation loss decreased (-0.095261 --> -0.191733).  Saving model ...
Epoch: 4 cost time: 1.6176795959472656
Epoch: 4, Steps: 10 | Train Loss: 1.487 Vali Loss: 3.196 Vali Acc: 0.225 Test Loss: 3.196 Test Acc: 0.225
Validation loss decreased (-0.191733 --> -0.224674).  Saving model ...
Epoch: 5 cost time: 1.3531990051269531
Epoch: 5, Steps: 10 | Train Loss: 0.899 Vali Loss: 3.280 Vali Acc: 0.274 Test Loss: 3.280 Test Acc: 0.274
Validation loss decreased (-0.224674 --> -0.274085).  Saving model ...
Epoch: 6 cost time: 1.1797904968261719
Epoch: 6, Steps: 10 | Train Loss: 0.543 Vali Loss: 3.328 Vali Acc: 0.292 Test Loss: 3.328 Test Acc: 0.292
Validation loss decreased (-0.274085 --> -0.291731).  Saving model ...
Epoch: 7 cost time: 1.3175513744354248
Epoch: 7, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.512 Vali Acc: 0.316 Test Loss: 3.512 Test Acc: 0.316
Validation loss decreased (-0.291731 --> -0.316435).  Saving model ...
Epoch: 8 cost time: 1.6098363399505615
Epoch: 8, Steps: 10 | Train Loss: 0.173 Vali Loss: 3.586 Vali Acc: 0.314 Test Loss: 3.586 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.4249846935272217
Epoch: 9, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.732 Vali Acc: 0.327 Test Loss: 3.732 Test Acc: 0.327
Validation loss decreased (-0.316435 --> -0.327022).  Saving model ...
Epoch: 10 cost time: 1.3418383598327637
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.886 Vali Acc: 0.324 Test Loss: 3.886 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5820400714874268
Epoch: 11, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.102 Vali Acc: 0.316 Test Loss: 4.102 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.5613462924957275
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.023 Vali Acc: 0.336 Test Loss: 4.023 Test Acc: 0.336
Validation loss decreased (-0.327022 --> -0.336430).  Saving model ...
Epoch: 13 cost time: 1.5688185691833496
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.014 Vali Acc: 0.327 Test Loss: 4.014 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5222187042236328
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.091 Vali Acc: 0.332 Test Loss: 4.091 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4063184261322021
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.122 Vali Acc: 0.338 Test Loss: 4.122 Test Acc: 0.338
Validation loss decreased (-0.336430 --> -0.337606).  Saving model ...
Epoch: 16 cost time: 1.4449002742767334
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.160 Vali Acc: 0.333 Test Loss: 4.160 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3234047889709473
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.175 Vali Acc: 0.336 Test Loss: 4.175 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3428301811218262
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.200 Vali Acc: 0.333 Test Loss: 4.200 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3846850395202637
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.224 Vali Acc: 0.335 Test Loss: 4.224 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.520787000656128
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.238 Vali Acc: 0.339 Test Loss: 4.238 Test Acc: 0.339
Validation loss decreased (-0.337606 --> -0.338781).  Saving model ...
Epoch: 21 cost time: 1.581214189529419
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.256 Vali Acc: 0.336 Test Loss: 4.256 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.3389432430267334
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.264 Vali Acc: 0.338 Test Loss: 4.264 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.4541206359863281
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.279 Vali Acc: 0.339 Test Loss: 4.279 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4805800914764404
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.296 Vali Acc: 0.338 Test Loss: 4.296 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.3648817539215088
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.309 Vali Acc: 0.338 Test Loss: 4.309 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.562657356262207
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.317 Vali Acc: 0.338 Test Loss: 4.317 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.45721435546875
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.336 Vali Acc: 0.336 Test Loss: 4.336 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.582970142364502
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.365 Vali Acc: 0.336 Test Loss: 4.365 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5487370491027832
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.377 Vali Acc: 0.336 Test Loss: 4.377 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.422307014465332
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.394 Vali Acc: 0.338 Test Loss: 4.394 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 1101010
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.5147593021392822
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.279 Vali Acc: 0.052 Test Loss: 3.279 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 1.6417555809020996
Epoch: 2, Steps: 10 | Train Loss: 2.866 Vali Loss: 3.300 Vali Acc: 0.092 Test Loss: 3.300 Test Acc: 0.092
Validation loss decreased (-0.051732 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 1.4318807125091553
Epoch: 3, Steps: 10 | Train Loss: 2.182 Vali Loss: 3.150 Vali Acc: 0.171 Test Loss: 3.150 Test Acc: 0.171
Validation loss decreased (-0.091732 --> -0.170557).  Saving model ...
Epoch: 4 cost time: 1.141420602798462
Epoch: 4, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.126 Vali Acc: 0.219 Test Loss: 3.126 Test Acc: 0.219
Validation loss decreased (-0.170557 --> -0.218792).  Saving model ...
Epoch: 5 cost time: 1.3608272075653076
Epoch: 5, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.185 Vali Acc: 0.256 Test Loss: 3.185 Test Acc: 0.256
Validation loss decreased (-0.218792 --> -0.256439).  Saving model ...
Epoch: 6 cost time: 1.3487858772277832
Epoch: 6, Steps: 10 | Train Loss: 0.577 Vali Loss: 3.214 Vali Acc: 0.288 Test Loss: 3.214 Test Acc: 0.288
Validation loss decreased (-0.256439 --> -0.288203).  Saving model ...
Epoch: 7 cost time: 1.4746766090393066
Epoch: 7, Steps: 10 | Train Loss: 0.327 Vali Loss: 3.372 Vali Acc: 0.309 Test Loss: 3.372 Test Acc: 0.309
Validation loss decreased (-0.288203 --> -0.309378).  Saving model ...
Epoch: 8 cost time: 1.1921377182006836
Epoch: 8, Steps: 10 | Train Loss: 0.177 Vali Loss: 3.421 Vali Acc: 0.318 Test Loss: 3.421 Test Acc: 0.318
Validation loss decreased (-0.309378 --> -0.317613).  Saving model ...
Epoch: 9 cost time: 1.232201099395752
Epoch: 9, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.582 Vali Acc: 0.319 Test Loss: 3.582 Test Acc: 0.319
Validation loss decreased (-0.317613 --> -0.318788).  Saving model ...
Epoch: 10 cost time: 1.3376312255859375
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.708 Vali Acc: 0.314 Test Loss: 3.708 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2369747161865234
Epoch: 11, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.788 Vali Acc: 0.311 Test Loss: 3.788 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2831134796142578
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.802 Vali Acc: 0.327 Test Loss: 3.802 Test Acc: 0.327
Validation loss decreased (-0.318788 --> -0.327021).  Saving model ...
Epoch: 13 cost time: 1.3000860214233398
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.827 Vali Acc: 0.325 Test Loss: 3.827 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5148308277130127
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.853 Vali Acc: 0.329 Test Loss: 3.853 Test Acc: 0.329
Validation loss decreased (-0.327021 --> -0.329373).  Saving model ...
Epoch: 15 cost time: 1.227423906326294
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.908 Vali Acc: 0.328 Test Loss: 3.908 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.289710283279419
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.926 Vali Acc: 0.329 Test Loss: 3.926 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2730557918548584
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.934 Vali Acc: 0.325 Test Loss: 3.934 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.452021837234497
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.942 Vali Acc: 0.334 Test Loss: 3.942 Test Acc: 0.334
Validation loss decreased (-0.329373 --> -0.334078).  Saving model ...
Epoch: 19 cost time: 1.2048101425170898
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.956 Vali Acc: 0.332 Test Loss: 3.956 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4556543827056885
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.969 Vali Acc: 0.331 Test Loss: 3.969 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3674824237823486
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.985 Vali Acc: 0.333 Test Loss: 3.985 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.3337090015411377
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.995 Vali Acc: 0.338 Test Loss: 3.995 Test Acc: 0.338
Validation loss decreased (-0.334078 --> -0.337607).  Saving model ...
Epoch: 23 cost time: 1.5232300758361816
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.011 Vali Acc: 0.335 Test Loss: 4.011 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1864023208618164
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.031 Vali Acc: 0.338 Test Loss: 4.031 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.366093397140503
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.042 Vali Acc: 0.344 Test Loss: 4.042 Test Acc: 0.344
Validation loss decreased (-0.337607 --> -0.343489).  Saving model ...
Epoch: 26 cost time: 1.3402678966522217
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.052 Vali Acc: 0.340 Test Loss: 4.052 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.3594770431518555
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.070 Vali Acc: 0.341 Test Loss: 4.070 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3908405303955078
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.097 Vali Acc: 0.340 Test Loss: 4.097 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.3661587238311768
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.106 Vali Acc: 0.345 Test Loss: 4.106 Test Acc: 0.345
Validation loss decreased (-0.343489 --> -0.344665).  Saving model ...
Epoch: 30 cost time: 1.241067886352539
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.122 Vali Acc: 0.341 Test Loss: 4.122 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.3655390739440918
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.127 Vali Acc: 0.342 Test Loss: 4.127 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.2255597114562988
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.133 Vali Acc: 0.346 Test Loss: 4.133 Test Acc: 0.346
Validation loss decreased (-0.344665 --> -0.345841).  Saving model ...
Epoch: 33 cost time: 1.3014585971832275
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.139 Vali Acc: 0.345 Test Loss: 4.139 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.4085886478424072
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.154 Vali Acc: 0.345 Test Loss: 4.154 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.230950117111206
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.173 Vali Acc: 0.341 Test Loss: 4.173 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.4134252071380615
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.187 Vali Acc: 0.344 Test Loss: 4.187 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.274498462677002
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.195 Vali Acc: 0.342 Test Loss: 4.195 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.326688528060913
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.208 Vali Acc: 0.345 Test Loss: 4.208 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.3856172561645508
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.220 Vali Acc: 0.342 Test Loss: 4.220 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.2281315326690674
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.227 Vali Acc: 0.340 Test Loss: 4.227 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.2469708919525146
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.234 Vali Acc: 0.340 Test Loss: 4.234 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.4707541465759277
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.248 Vali Acc: 0.338 Test Loss: 4.248 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 1101010
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.071094036102295
Epoch: 1, Steps: 10 | Train Loss: 3.320 Vali Loss: 3.248 Vali Acc: 0.051 Test Loss: 3.248 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 1.2986767292022705
Epoch: 2, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.269 Vali Acc: 0.085 Test Loss: 3.269 Test Acc: 0.085
Validation loss decreased (-0.050556 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 1.3852496147155762
Epoch: 3, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.147 Vali Acc: 0.164 Test Loss: 3.147 Test Acc: 0.164
Validation loss decreased (-0.084673 --> -0.163498).  Saving model ...
Epoch: 4 cost time: 1.2021865844726562
Epoch: 4, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.045 Vali Acc: 0.231 Test Loss: 3.045 Test Acc: 0.231
Validation loss decreased (-0.163498 --> -0.230558).  Saving model ...
Epoch: 5 cost time: 1.2364189624786377
Epoch: 5, Steps: 10 | Train Loss: 1.208 Vali Loss: 3.010 Vali Acc: 0.264 Test Loss: 3.010 Test Acc: 0.264
Validation loss decreased (-0.230558 --> -0.263499).  Saving model ...
Epoch: 6 cost time: 1.2967288494110107
Epoch: 6, Steps: 10 | Train Loss: 0.789 Vali Loss: 3.012 Vali Acc: 0.279 Test Loss: 3.012 Test Acc: 0.279
Validation loss decreased (-0.263499 --> -0.278793).  Saving model ...
Epoch: 7 cost time: 1.2860877513885498
Epoch: 7, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.088 Vali Acc: 0.293 Test Loss: 3.088 Test Acc: 0.293
Validation loss decreased (-0.278793 --> -0.292910).  Saving model ...
Epoch: 8 cost time: 1.1612496376037598
Epoch: 8, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.142 Vali Acc: 0.314 Test Loss: 3.142 Test Acc: 0.314
Validation loss decreased (-0.292910 --> -0.314086).  Saving model ...
Epoch: 9 cost time: 1.2518548965454102
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.225 Vali Acc: 0.314 Test Loss: 3.225 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3303327560424805
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.380 Vali Acc: 0.312 Test Loss: 3.380 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.404141902923584
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.406 Vali Acc: 0.309 Test Loss: 3.406 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4377474784851074
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.440 Vali Acc: 0.306 Test Loss: 3.440 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.4250493049621582
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.479 Vali Acc: 0.311 Test Loss: 3.479 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.402092456817627
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.514 Vali Acc: 0.314 Test Loss: 3.514 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4589958190917969
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.524 Vali Acc: 0.318 Test Loss: 3.524 Test Acc: 0.318
Validation loss decreased (-0.314086 --> -0.317612).  Saving model ...
Epoch: 16 cost time: 1.5541605949401855
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.537 Vali Acc: 0.318 Test Loss: 3.537 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4139683246612549
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.572 Vali Acc: 0.316 Test Loss: 3.572 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2210619449615479
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.598 Vali Acc: 0.318 Test Loss: 3.598 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.387326717376709
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.619 Vali Acc: 0.322 Test Loss: 3.619 Test Acc: 0.322
Validation loss decreased (-0.317612 --> -0.322317).  Saving model ...
Epoch: 20 cost time: 1.3813047409057617
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.636 Vali Acc: 0.322 Test Loss: 3.636 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2961232662200928
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.652 Vali Acc: 0.319 Test Loss: 3.652 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4165189266204834
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.665 Vali Acc: 0.319 Test Loss: 3.665 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3992090225219727
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.679 Vali Acc: 0.318 Test Loss: 3.679 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3797252178192139
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.697 Vali Acc: 0.321 Test Loss: 3.697 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5811216831207275
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.708 Vali Acc: 0.315 Test Loss: 3.708 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4783201217651367
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.726 Vali Acc: 0.312 Test Loss: 3.726 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3509492874145508
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.743 Vali Acc: 0.314 Test Loss: 3.743 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4085958003997803
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.762 Vali Acc: 0.314 Test Loss: 3.762 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3667726516723633
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.768 Vali Acc: 0.314 Test Loss: 3.768 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 1101010
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.4318511486053467
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.315 Vali Acc: 0.067 Test Loss: 3.315 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 1.2482171058654785
Epoch: 2, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.358 Vali Acc: 0.109 Test Loss: 3.358 Test Acc: 0.109
Validation loss decreased (-0.067026 --> -0.109378).  Saving model ...
Epoch: 3 cost time: 1.264801263809204
Epoch: 3, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.206 Vali Acc: 0.192 Test Loss: 3.206 Test Acc: 0.192
Validation loss decreased (-0.109378 --> -0.191733).  Saving model ...
Epoch: 4 cost time: 1.2965881824493408
Epoch: 4, Steps: 10 | Train Loss: 1.405 Vali Loss: 3.192 Vali Acc: 0.234 Test Loss: 3.192 Test Acc: 0.234
Validation loss decreased (-0.191733 --> -0.234086).  Saving model ...
Epoch: 5 cost time: 1.0824639797210693
Epoch: 5, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.362 Vali Acc: 0.258 Test Loss: 3.362 Test Acc: 0.258
Validation loss decreased (-0.234086 --> -0.257613).  Saving model ...
Epoch: 6 cost time: 1.2439961433410645
Epoch: 6, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.437 Vali Acc: 0.287 Test Loss: 3.437 Test Acc: 0.287
Validation loss decreased (-0.257613 --> -0.287024).  Saving model ...
Epoch: 7 cost time: 1.1885030269622803
Epoch: 7, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.560 Vali Acc: 0.302 Test Loss: 3.560 Test Acc: 0.302
Validation loss decreased (-0.287024 --> -0.302317).  Saving model ...
Epoch: 8 cost time: 1.127336025238037
Epoch: 8, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.651 Vali Acc: 0.324 Test Loss: 3.651 Test Acc: 0.324
Validation loss decreased (-0.302317 --> -0.323493).  Saving model ...
Epoch: 9 cost time: 1.176805019378662
Epoch: 9, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.837 Vali Acc: 0.314 Test Loss: 3.837 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1687901020050049
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 4.023 Vali Acc: 0.328 Test Loss: 4.023 Test Acc: 0.328
Validation loss decreased (-0.323493 --> -0.328195).  Saving model ...
Epoch: 11 cost time: 1.1688103675842285
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.100 Vali Acc: 0.316 Test Loss: 4.100 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0801160335540771
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.169 Vali Acc: 0.318 Test Loss: 4.169 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3284595012664795
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.211 Vali Acc: 0.326 Test Loss: 4.211 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.157782793045044
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.255 Vali Acc: 0.329 Test Loss: 4.255 Test Acc: 0.329
Validation loss decreased (-0.328195 --> -0.329369).  Saving model ...
Epoch: 15 cost time: 1.256941318511963
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.299 Vali Acc: 0.336 Test Loss: 4.299 Test Acc: 0.336
Validation loss decreased (-0.329369 --> -0.336428).  Saving model ...
Epoch: 16 cost time: 1.345729112625122
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.348 Vali Acc: 0.339 Test Loss: 4.348 Test Acc: 0.339
Validation loss decreased (-0.336428 --> -0.338780).  Saving model ...
Epoch: 17 cost time: 1.2214469909667969
Epoch: 17, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.367 Vali Acc: 0.336 Test Loss: 4.367 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3079533576965332
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.375 Vali Acc: 0.331 Test Loss: 4.375 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.090484857559204
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.392 Vali Acc: 0.332 Test Loss: 4.392 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1577887535095215
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.412 Vali Acc: 0.334 Test Loss: 4.412 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1732490062713623
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.445 Vali Acc: 0.332 Test Loss: 4.445 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3047945499420166
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.456 Vali Acc: 0.335 Test Loss: 4.456 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1739256381988525
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.465 Vali Acc: 0.334 Test Loss: 4.465 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.3023085594177246
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.477 Vali Acc: 0.336 Test Loss: 4.477 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3275039196014404
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.487 Vali Acc: 0.339 Test Loss: 4.487 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2081942558288574
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.505 Vali Acc: 0.333 Test Loss: 4.505 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 838866
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0422112941741943
Epoch: 1, Steps: 10 | Train Loss: 3.332 Vali Loss: 3.301 Vali Acc: 0.064 Test Loss: 3.301 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 1.2009809017181396
Epoch: 2, Steps: 10 | Train Loss: 2.917 Vali Loss: 3.348 Vali Acc: 0.109 Test Loss: 3.348 Test Acc: 0.109
Validation loss decreased (-0.063496 --> -0.109378).  Saving model ...
Epoch: 3 cost time: 1.2673027515411377
Epoch: 3, Steps: 10 | Train Loss: 2.174 Vali Loss: 3.194 Vali Acc: 0.193 Test Loss: 3.194 Test Acc: 0.193
Validation loss decreased (-0.109378 --> -0.192909).  Saving model ...
Epoch: 4 cost time: 1.3708157539367676
Epoch: 4, Steps: 10 | Train Loss: 1.476 Vali Loss: 3.163 Vali Acc: 0.236 Test Loss: 3.163 Test Acc: 0.236
Validation loss decreased (-0.192909 --> -0.236439).  Saving model ...
Epoch: 5 cost time: 1.098799705505371
Epoch: 5, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.314 Vali Acc: 0.258 Test Loss: 3.314 Test Acc: 0.258
Validation loss decreased (-0.236439 --> -0.257614).  Saving model ...
Epoch: 6 cost time: 1.0958073139190674
Epoch: 6, Steps: 10 | Train Loss: 0.593 Vali Loss: 3.367 Vali Acc: 0.307 Test Loss: 3.367 Test Acc: 0.307
Validation loss decreased (-0.257614 --> -0.307025).  Saving model ...
Epoch: 7 cost time: 1.157372236251831
Epoch: 7, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.490 Vali Acc: 0.304 Test Loss: 3.490 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1850521564483643
Epoch: 8, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.566 Vali Acc: 0.321 Test Loss: 3.566 Test Acc: 0.321
Validation loss decreased (-0.307025 --> -0.321141).  Saving model ...
Epoch: 9 cost time: 1.1895592212677002
Epoch: 9, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.774 Vali Acc: 0.324 Test Loss: 3.774 Test Acc: 0.324
Validation loss decreased (-0.321141 --> -0.323492).  Saving model ...
Epoch: 10 cost time: 1.2197990417480469
Epoch: 10, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.967 Vali Acc: 0.326 Test Loss: 3.967 Test Acc: 0.326
Validation loss decreased (-0.323492 --> -0.325843).  Saving model ...
Epoch: 11 cost time: 1.2043640613555908
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.991 Vali Acc: 0.327 Test Loss: 3.991 Test Acc: 0.327
Validation loss decreased (-0.325843 --> -0.327019).  Saving model ...
Epoch: 12 cost time: 1.1464598178863525
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.111 Vali Acc: 0.318 Test Loss: 4.111 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2211189270019531
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.092 Vali Acc: 0.332 Test Loss: 4.092 Test Acc: 0.332
Validation loss decreased (-0.327019 --> -0.331724).  Saving model ...
Epoch: 14 cost time: 1.1968579292297363
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.137 Vali Acc: 0.333 Test Loss: 4.137 Test Acc: 0.333
Validation loss decreased (-0.331724 --> -0.332900).  Saving model ...
Epoch: 15 cost time: 1.2186017036437988
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.166 Vali Acc: 0.339 Test Loss: 4.166 Test Acc: 0.339
Validation loss decreased (-0.332900 --> -0.338782).  Saving model ...
Epoch: 16 cost time: 1.2717652320861816
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.218 Vali Acc: 0.338 Test Loss: 4.218 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2590749263763428
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.237 Vali Acc: 0.338 Test Loss: 4.237 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2536523342132568
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.243 Vali Acc: 0.338 Test Loss: 4.243 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1579911708831787
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.254 Vali Acc: 0.336 Test Loss: 4.254 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0806283950805664
Epoch: 20, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.268 Vali Acc: 0.341 Test Loss: 4.268 Test Acc: 0.341
Validation loss decreased (-0.338782 --> -0.341134).  Saving model ...
Epoch: 21 cost time: 1.2105541229248047
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.291 Vali Acc: 0.338 Test Loss: 4.291 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1115260124206543
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.311 Vali Acc: 0.340 Test Loss: 4.311 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.250586748123169
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.325 Vali Acc: 0.336 Test Loss: 4.325 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.1794853210449219
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.338 Vali Acc: 0.335 Test Loss: 4.338 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2669734954833984
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.349 Vali Acc: 0.336 Test Loss: 4.349 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2895376682281494
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.372 Vali Acc: 0.342 Test Loss: 4.372 Test Acc: 0.342
Validation loss decreased (-0.341134 --> -0.342309).  Saving model ...
Epoch: 27 cost time: 1.1032493114471436
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.406 Vali Acc: 0.340 Test Loss: 4.406 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1527633666992188
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.415 Vali Acc: 0.341 Test Loss: 4.415 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1545665264129639
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.426 Vali Acc: 0.341 Test Loss: 4.426 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.1240570545196533
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.446 Vali Acc: 0.338 Test Loss: 4.446 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.22727370262146
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.469 Vali Acc: 0.339 Test Loss: 4.469 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.0599126815795898
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.476 Vali Acc: 0.339 Test Loss: 4.476 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2378549575805664
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.493 Vali Acc: 0.340 Test Loss: 4.493 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.2228906154632568
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.503 Vali Acc: 0.341 Test Loss: 4.503 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.385317087173462
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.507 Vali Acc: 0.342 Test Loss: 4.507 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1394777297973633
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.518 Vali Acc: 0.341 Test Loss: 4.518 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 838866
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0543458461761475
Epoch: 1, Steps: 10 | Train Loss: 3.298 Vali Loss: 3.285 Vali Acc: 0.062 Test Loss: 3.285 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 1.2555174827575684
Epoch: 2, Steps: 10 | Train Loss: 2.889 Vali Loss: 3.328 Vali Acc: 0.096 Test Loss: 3.328 Test Acc: 0.096
Validation loss decreased (-0.062320 --> -0.096437).  Saving model ...
Epoch: 3 cost time: 1.2036290168762207
Epoch: 3, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.175 Vali Acc: 0.189 Test Loss: 3.175 Test Acc: 0.189
Validation loss decreased (-0.096437 --> -0.189380).  Saving model ...
Epoch: 4 cost time: 1.162447452545166
Epoch: 4, Steps: 10 | Train Loss: 1.536 Vali Loss: 3.106 Vali Acc: 0.238 Test Loss: 3.106 Test Acc: 0.238
Validation loss decreased (-0.189380 --> -0.237616).  Saving model ...
Epoch: 5 cost time: 1.2296912670135498
Epoch: 5, Steps: 10 | Train Loss: 1.017 Vali Loss: 3.219 Vali Acc: 0.265 Test Loss: 3.219 Test Acc: 0.265
Validation loss decreased (-0.237616 --> -0.264674).  Saving model ...
Epoch: 6 cost time: 1.243781328201294
Epoch: 6, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.269 Vali Acc: 0.295 Test Loss: 3.269 Test Acc: 0.295
Validation loss decreased (-0.264674 --> -0.295261).  Saving model ...
Epoch: 7 cost time: 1.1710789203643799
Epoch: 7, Steps: 10 | Train Loss: 0.351 Vali Loss: 3.344 Vali Acc: 0.311 Test Loss: 3.344 Test Acc: 0.311
Validation loss decreased (-0.295261 --> -0.310555).  Saving model ...
Epoch: 8 cost time: 1.317701816558838
Epoch: 8, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.434 Vali Acc: 0.328 Test Loss: 3.434 Test Acc: 0.328
Validation loss decreased (-0.310555 --> -0.328201).  Saving model ...
Epoch: 9 cost time: 1.081071376800537
Epoch: 9, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.595 Vali Acc: 0.324 Test Loss: 3.595 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1485466957092285
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.746 Vali Acc: 0.324 Test Loss: 3.746 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1515088081359863
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.803 Vali Acc: 0.331 Test Loss: 3.803 Test Acc: 0.331
Validation loss decreased (-0.328201 --> -0.330550).  Saving model ...
Epoch: 12 cost time: 1.1128795146942139
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.872 Vali Acc: 0.326 Test Loss: 3.872 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1733283996582031
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.912 Vali Acc: 0.321 Test Loss: 3.912 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2796287536621094
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.963 Vali Acc: 0.326 Test Loss: 3.963 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2244923114776611
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.952 Vali Acc: 0.331 Test Loss: 3.952 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1017646789550781
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.985 Vali Acc: 0.333 Test Loss: 3.985 Test Acc: 0.333
Validation loss decreased (-0.330550 --> -0.332901).  Saving model ...
Epoch: 17 cost time: 1.3008031845092773
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.992 Vali Acc: 0.331 Test Loss: 3.992 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2616052627563477
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.002 Vali Acc: 0.329 Test Loss: 4.002 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2158355712890625
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.022 Vali Acc: 0.331 Test Loss: 4.022 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.212045669555664
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.033 Vali Acc: 0.326 Test Loss: 4.033 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0885674953460693
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.055 Vali Acc: 0.327 Test Loss: 4.055 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3364484310150146
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.074 Vali Acc: 0.328 Test Loss: 4.074 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.3210573196411133
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.086 Vali Acc: 0.333 Test Loss: 4.086 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.443450689315796
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.092 Vali Acc: 0.332 Test Loss: 4.092 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.3679797649383545
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.103 Vali Acc: 0.335 Test Loss: 4.103 Test Acc: 0.335
Validation loss decreased (-0.332901 --> -0.335253).  Saving model ...
Epoch: 26 cost time: 1.512481927871704
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.128 Vali Acc: 0.334 Test Loss: 4.128 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.5557470321655273
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.161 Vali Acc: 0.336 Test Loss: 4.161 Test Acc: 0.336
Validation loss decreased (-0.335253 --> -0.336429).  Saving model ...
Epoch: 28 cost time: 1.5023257732391357
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.161 Vali Acc: 0.334 Test Loss: 4.161 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.4141323566436768
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.167 Vali Acc: 0.331 Test Loss: 4.167 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.362663984298706
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.182 Vali Acc: 0.329 Test Loss: 4.182 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.4467976093292236
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.204 Vali Acc: 0.328 Test Loss: 4.204 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3498849868774414
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.212 Vali Acc: 0.328 Test Loss: 4.212 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.3249025344848633
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.229 Vali Acc: 0.331 Test Loss: 4.229 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4450125694274902
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.237 Vali Acc: 0.331 Test Loss: 4.237 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.25423002243042
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.242 Vali Acc: 0.329 Test Loss: 4.242 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.4434523582458496
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.250 Vali Acc: 0.331 Test Loss: 4.250 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.2682993412017822
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.258 Vali Acc: 0.329 Test Loss: 4.258 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 838866
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9759607315063477
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.278 Vali Acc: 0.051 Test Loss: 3.278 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.1973814964294434
Epoch: 2, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.314 Vali Acc: 0.088 Test Loss: 3.314 Test Acc: 0.088
Validation loss decreased (-0.050555 --> -0.088202).  Saving model ...
Epoch: 3 cost time: 1.309053659439087
Epoch: 3, Steps: 10 | Train Loss: 2.438 Vali Loss: 3.191 Vali Acc: 0.154 Test Loss: 3.191 Test Acc: 0.154
Validation loss decreased (-0.088202 --> -0.154086).  Saving model ...
Epoch: 4 cost time: 1.0755500793457031
Epoch: 4, Steps: 10 | Train Loss: 1.821 Vali Loss: 3.043 Vali Acc: 0.226 Test Loss: 3.043 Test Acc: 0.226
Validation loss decreased (-0.154086 --> -0.225852).  Saving model ...
Epoch: 5 cost time: 1.468989610671997
Epoch: 5, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.061 Vali Acc: 0.241 Test Loss: 3.061 Test Acc: 0.241
Validation loss decreased (-0.225852 --> -0.241146).  Saving model ...
Epoch: 6 cost time: 1.1753976345062256
Epoch: 6, Steps: 10 | Train Loss: 0.799 Vali Loss: 3.081 Vali Acc: 0.251 Test Loss: 3.081 Test Acc: 0.251
Validation loss decreased (-0.241146 --> -0.250557).  Saving model ...
Epoch: 7 cost time: 1.2610774040222168
Epoch: 7, Steps: 10 | Train Loss: 0.472 Vali Loss: 3.057 Vali Acc: 0.301 Test Loss: 3.057 Test Acc: 0.301
Validation loss decreased (-0.250557 --> -0.301146).  Saving model ...
Epoch: 8 cost time: 1.329465627670288
Epoch: 8, Steps: 10 | Train Loss: 0.230 Vali Loss: 3.196 Vali Acc: 0.306 Test Loss: 3.196 Test Acc: 0.306
Validation loss decreased (-0.301146 --> -0.305850).  Saving model ...
Epoch: 9 cost time: 1.4132561683654785
Epoch: 9, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.288 Vali Acc: 0.299 Test Loss: 3.288 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1231598854064941
Epoch: 10, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.377 Vali Acc: 0.308 Test Loss: 3.377 Test Acc: 0.308
Validation loss decreased (-0.305850 --> -0.308202).  Saving model ...
Epoch: 11 cost time: 1.1842079162597656
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.478 Vali Acc: 0.307 Test Loss: 3.478 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1078341007232666
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.500 Vali Acc: 0.316 Test Loss: 3.500 Test Acc: 0.316
Validation loss decreased (-0.308202 --> -0.316436).  Saving model ...
Epoch: 13 cost time: 1.4581654071807861
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.505 Vali Acc: 0.306 Test Loss: 3.505 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1278491020202637
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.530 Vali Acc: 0.313 Test Loss: 3.530 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2914361953735352
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.555 Vali Acc: 0.322 Test Loss: 3.555 Test Acc: 0.322
Validation loss decreased (-0.316436 --> -0.322317).  Saving model ...
Epoch: 16 cost time: 1.1978514194488525
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.589 Vali Acc: 0.321 Test Loss: 3.589 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1778676509857178
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.624 Vali Acc: 0.315 Test Loss: 3.624 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1303272247314453
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.651 Vali Acc: 0.313 Test Loss: 3.651 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.145031452178955
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.660 Vali Acc: 0.313 Test Loss: 3.660 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.054248571395874
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.668 Vali Acc: 0.321 Test Loss: 3.668 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0638296604156494
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.678 Vali Acc: 0.318 Test Loss: 3.678 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2069268226623535
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.694 Vali Acc: 0.320 Test Loss: 3.694 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.1556694507598877
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.705 Vali Acc: 0.321 Test Loss: 3.705 Test Acc: 0.321
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2011806964874268
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.719 Vali Acc: 0.319 Test Loss: 3.719 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1470038890838623
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.730 Vali Acc: 0.321 Test Loss: 3.730 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 838866
model size : 5.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9259493350982666
Epoch: 1, Steps: 10 | Train Loss: 3.508 Vali Loss: 3.266 Vali Acc: 0.078 Test Loss: 3.266 Test Acc: 0.078
Validation loss decreased (inf --> -0.077614).  Saving model ...
Epoch: 2 cost time: 1.2178316116333008
Epoch: 2, Steps: 10 | Train Loss: 2.867 Vali Loss: 3.278 Vali Acc: 0.138 Test Loss: 3.278 Test Acc: 0.138
Validation loss decreased (-0.077614 --> -0.137614).  Saving model ...
Epoch: 3 cost time: 1.0672881603240967
Epoch: 3, Steps: 10 | Train Loss: 2.037 Vali Loss: 3.162 Vali Acc: 0.199 Test Loss: 3.162 Test Acc: 0.199
Validation loss decreased (-0.137614 --> -0.198792).  Saving model ...
Epoch: 4 cost time: 1.2031466960906982
Epoch: 4, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.192 Vali Acc: 0.233 Test Loss: 3.192 Test Acc: 0.233
Validation loss decreased (-0.198792 --> -0.232909).  Saving model ...
Epoch: 5 cost time: 1.343980312347412
Epoch: 5, Steps: 10 | Train Loss: 0.878 Vali Loss: 3.290 Vali Acc: 0.252 Test Loss: 3.290 Test Acc: 0.252
Validation loss decreased (-0.232909 --> -0.251732).  Saving model ...
Epoch: 6 cost time: 1.2022285461425781
Epoch: 6, Steps: 10 | Train Loss: 0.547 Vali Loss: 3.477 Vali Acc: 0.299 Test Loss: 3.477 Test Acc: 0.299
Validation loss decreased (-0.251732 --> -0.298789).  Saving model ...
Epoch: 7 cost time: 1.1014466285705566
Epoch: 7, Steps: 10 | Train Loss: 0.343 Vali Loss: 3.596 Vali Acc: 0.306 Test Loss: 3.596 Test Acc: 0.306
Validation loss decreased (-0.298789 --> -0.305846).  Saving model ...
Epoch: 8 cost time: 1.3095769882202148
Epoch: 8, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.709 Vali Acc: 0.314 Test Loss: 3.709 Test Acc: 0.314
Validation loss decreased (-0.305846 --> -0.314081).  Saving model ...
Epoch: 9 cost time: 1.321761131286621
Epoch: 9, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.903 Vali Acc: 0.325 Test Loss: 3.903 Test Acc: 0.325
Validation loss decreased (-0.314081 --> -0.324667).  Saving model ...
Epoch: 10 cost time: 1.1923565864562988
Epoch: 10, Steps: 10 | Train Loss: 0.059 Vali Loss: 4.068 Vali Acc: 0.305 Test Loss: 4.068 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1778078079223633
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.121 Vali Acc: 0.334 Test Loss: 4.121 Test Acc: 0.334
Validation loss decreased (-0.324667 --> -0.334076).  Saving model ...
Epoch: 12 cost time: 1.221909999847412
Epoch: 12, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.223 Vali Acc: 0.331 Test Loss: 4.223 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.170879602432251
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.342 Vali Acc: 0.327 Test Loss: 4.342 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1719303131103516
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.324 Vali Acc: 0.332 Test Loss: 4.324 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2133615016937256
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.355 Vali Acc: 0.334 Test Loss: 4.355 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.236495018005371
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.377 Vali Acc: 0.336 Test Loss: 4.377 Test Acc: 0.336
Validation loss decreased (-0.334076 --> -0.336427).  Saving model ...
Epoch: 17 cost time: 1.265498161315918
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.434 Vali Acc: 0.338 Test Loss: 4.434 Test Acc: 0.338
Validation loss decreased (-0.336427 --> -0.337603).  Saving model ...
Epoch: 18 cost time: 1.1113476753234863
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.487 Vali Acc: 0.336 Test Loss: 4.487 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.223341703414917
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.493 Vali Acc: 0.336 Test Loss: 4.493 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.2583799362182617
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.502 Vali Acc: 0.335 Test Loss: 4.502 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.2339591979980469
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.516 Vali Acc: 0.340 Test Loss: 4.516 Test Acc: 0.340
Validation loss decreased (-0.337603 --> -0.339955).  Saving model ...
Epoch: 22 cost time: 1.171696424484253
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.524 Vali Acc: 0.338 Test Loss: 4.524 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1450774669647217
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.546 Vali Acc: 0.338 Test Loss: 4.546 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4301033020019531
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.569 Vali Acc: 0.338 Test Loss: 4.569 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2130370140075684
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.585 Vali Acc: 0.335 Test Loss: 4.585 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2662522792816162
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.604 Vali Acc: 0.333 Test Loss: 4.604 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.1924004554748535
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.619 Vali Acc: 0.338 Test Loss: 4.619 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.122544527053833
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.635 Vali Acc: 0.335 Test Loss: 4.635 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2233831882476807
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.648 Vali Acc: 0.336 Test Loss: 4.648 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2798151969909668
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.663 Vali Acc: 0.335 Test Loss: 4.663 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2947885990142822
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.685 Vali Acc: 0.336 Test Loss: 4.685 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 707794
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.94596266746521
Epoch: 1, Steps: 10 | Train Loss: 3.484 Vali Loss: 3.255 Vali Acc: 0.079 Test Loss: 3.255 Test Acc: 0.079
Validation loss decreased (inf --> -0.078791).  Saving model ...
Epoch: 2 cost time: 1.0499436855316162
Epoch: 2, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.266 Vali Acc: 0.136 Test Loss: 3.266 Test Acc: 0.136
Validation loss decreased (-0.078791 --> -0.136438).  Saving model ...
Epoch: 3 cost time: 1.1631808280944824
Epoch: 3, Steps: 10 | Train Loss: 2.062 Vali Loss: 3.156 Vali Acc: 0.206 Test Loss: 3.156 Test Acc: 0.206
Validation loss decreased (-0.136438 --> -0.205851).  Saving model ...
Epoch: 4 cost time: 1.1977357864379883
Epoch: 4, Steps: 10 | Train Loss: 1.472 Vali Loss: 3.162 Vali Acc: 0.245 Test Loss: 3.162 Test Acc: 0.245
Validation loss decreased (-0.205851 --> -0.244674).  Saving model ...
Epoch: 5 cost time: 1.294144630432129
Epoch: 5, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.246 Vali Acc: 0.266 Test Loss: 3.246 Test Acc: 0.266
Validation loss decreased (-0.244674 --> -0.265850).  Saving model ...
Epoch: 6 cost time: 1.1638681888580322
Epoch: 6, Steps: 10 | Train Loss: 0.565 Vali Loss: 3.420 Vali Acc: 0.306 Test Loss: 3.420 Test Acc: 0.306
Validation loss decreased (-0.265850 --> -0.305848).  Saving model ...
Epoch: 7 cost time: 1.1478195190429688
Epoch: 7, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.538 Vali Acc: 0.300 Test Loss: 3.538 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3072443008422852
Epoch: 8, Steps: 10 | Train Loss: 0.175 Vali Loss: 3.632 Vali Acc: 0.318 Test Loss: 3.632 Test Acc: 0.318
Validation loss decreased (-0.305848 --> -0.317611).  Saving model ...
Epoch: 9 cost time: 1.1992673873901367
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.783 Vali Acc: 0.324 Test Loss: 3.783 Test Acc: 0.324
Validation loss decreased (-0.317611 --> -0.323492).  Saving model ...
Epoch: 10 cost time: 1.333130121231079
Epoch: 10, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.924 Vali Acc: 0.309 Test Loss: 3.924 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2322087287902832
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.969 Vali Acc: 0.327 Test Loss: 3.969 Test Acc: 0.327
Validation loss decreased (-0.323492 --> -0.327019).  Saving model ...
Epoch: 12 cost time: 1.1383700370788574
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.157 Vali Acc: 0.321 Test Loss: 4.157 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2447407245635986
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.219 Vali Acc: 0.322 Test Loss: 4.219 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2522845268249512
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.201 Vali Acc: 0.344 Test Loss: 4.201 Test Acc: 0.344
Validation loss decreased (-0.327019 --> -0.343487).  Saving model ...
Epoch: 15 cost time: 1.155608892440796
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.219 Vali Acc: 0.336 Test Loss: 4.219 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2682673931121826
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.216 Vali Acc: 0.345 Test Loss: 4.216 Test Acc: 0.345
Validation loss decreased (-0.343487 --> -0.344664).  Saving model ...
Epoch: 17 cost time: 1.2230970859527588
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.263 Vali Acc: 0.335 Test Loss: 4.263 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1193432807922363
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.322 Vali Acc: 0.334 Test Loss: 4.322 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2707176208496094
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.339 Vali Acc: 0.332 Test Loss: 4.339 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.26070237159729
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.354 Vali Acc: 0.329 Test Loss: 4.354 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.373840093612671
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.360 Vali Acc: 0.335 Test Loss: 4.360 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.3475708961486816
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.364 Vali Acc: 0.333 Test Loss: 4.364 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.1313276290893555
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.385 Vali Acc: 0.338 Test Loss: 4.385 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1599783897399902
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.409 Vali Acc: 0.336 Test Loss: 4.409 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.167600154876709
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.417 Vali Acc: 0.340 Test Loss: 4.417 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.332965612411499
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.436 Vali Acc: 0.336 Test Loss: 4.436 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 707794
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9347116947174072
Epoch: 1, Steps: 10 | Train Loss: 3.452 Vali Loss: 3.259 Vali Acc: 0.076 Test Loss: 3.259 Test Acc: 0.076
Validation loss decreased (inf --> -0.076438).  Saving model ...
Epoch: 2 cost time: 1.097658395767212
Epoch: 2, Steps: 10 | Train Loss: 2.900 Vali Loss: 3.265 Vali Acc: 0.134 Test Loss: 3.265 Test Acc: 0.134
Validation loss decreased (-0.076438 --> -0.134085).  Saving model ...
Epoch: 3 cost time: 1.0659222602844238
Epoch: 3, Steps: 10 | Train Loss: 2.133 Vali Loss: 3.149 Vali Acc: 0.204 Test Loss: 3.149 Test Acc: 0.204
Validation loss decreased (-0.134085 --> -0.203498).  Saving model ...
Epoch: 4 cost time: 1.1521358489990234
Epoch: 4, Steps: 10 | Train Loss: 1.547 Vali Loss: 3.116 Vali Acc: 0.238 Test Loss: 3.116 Test Acc: 0.238
Validation loss decreased (-0.203498 --> -0.237616).  Saving model ...
Epoch: 5 cost time: 1.132394790649414
Epoch: 5, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.159 Vali Acc: 0.271 Test Loss: 3.159 Test Acc: 0.271
Validation loss decreased (-0.237616 --> -0.270557).  Saving model ...
Epoch: 6 cost time: 1.048872947692871
Epoch: 6, Steps: 10 | Train Loss: 0.604 Vali Loss: 3.302 Vali Acc: 0.301 Test Loss: 3.302 Test Acc: 0.301
Validation loss decreased (-0.270557 --> -0.301143).  Saving model ...
Epoch: 7 cost time: 1.0908608436584473
Epoch: 7, Steps: 10 | Train Loss: 0.357 Vali Loss: 3.414 Vali Acc: 0.309 Test Loss: 3.414 Test Acc: 0.309
Validation loss decreased (-0.301143 --> -0.309378).  Saving model ...
Epoch: 8 cost time: 1.1800792217254639
Epoch: 8, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.443 Vali Acc: 0.331 Test Loss: 3.443 Test Acc: 0.331
Validation loss decreased (-0.309378 --> -0.330554).  Saving model ...
Epoch: 9 cost time: 1.2049484252929688
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.581 Vali Acc: 0.328 Test Loss: 3.581 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3493165969848633
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.686 Vali Acc: 0.312 Test Loss: 3.686 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.11788010597229
Epoch: 11, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.757 Vali Acc: 0.334 Test Loss: 3.757 Test Acc: 0.334
Validation loss decreased (-0.330554 --> -0.334080).  Saving model ...
Epoch: 12 cost time: 1.2486746311187744
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.879 Vali Acc: 0.332 Test Loss: 3.879 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.105194330215454
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.944 Vali Acc: 0.345 Test Loss: 3.944 Test Acc: 0.345
Validation loss decreased (-0.334080 --> -0.344666).  Saving model ...
Epoch: 14 cost time: 1.1971735954284668
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.927 Vali Acc: 0.352 Test Loss: 3.927 Test Acc: 0.352
Validation loss decreased (-0.344666 --> -0.351725).  Saving model ...
Epoch: 15 cost time: 1.2463269233703613
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.931 Vali Acc: 0.348 Test Loss: 3.931 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2002429962158203
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.961 Vali Acc: 0.345 Test Loss: 3.961 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2604496479034424
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.999 Vali Acc: 0.345 Test Loss: 3.999 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1481742858886719
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.042 Vali Acc: 0.346 Test Loss: 4.042 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1789820194244385
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.053 Vali Acc: 0.348 Test Loss: 4.053 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2386789321899414
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.072 Vali Acc: 0.346 Test Loss: 4.072 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.122328519821167
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.089 Vali Acc: 0.345 Test Loss: 4.089 Test Acc: 0.345
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0194451808929443
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.095 Vali Acc: 0.351 Test Loss: 4.095 Test Acc: 0.351
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0980620384216309
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.116 Vali Acc: 0.349 Test Loss: 4.116 Test Acc: 0.349
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.242630958557129
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.135 Vali Acc: 0.344 Test Loss: 4.135 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 707794
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.861018419265747
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.259 Vali Acc: 0.059 Test Loss: 3.259 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.993194580078125
Epoch: 2, Steps: 10 | Train Loss: 2.969 Vali Loss: 3.261 Vali Acc: 0.111 Test Loss: 3.261 Test Acc: 0.111
Validation loss decreased (-0.058791 --> -0.110556).  Saving model ...
Epoch: 3 cost time: 1.099482536315918
Epoch: 3, Steps: 10 | Train Loss: 2.335 Vali Loss: 3.154 Vali Acc: 0.179 Test Loss: 3.154 Test Acc: 0.179
Validation loss decreased (-0.110556 --> -0.178792).  Saving model ...
Epoch: 4 cost time: 1.1470506191253662
Epoch: 4, Steps: 10 | Train Loss: 1.801 Vali Loss: 3.051 Vali Acc: 0.225 Test Loss: 3.051 Test Acc: 0.225
Validation loss decreased (-0.178792 --> -0.224675).  Saving model ...
Epoch: 5 cost time: 0.9215450286865234
Epoch: 5, Steps: 10 | Train Loss: 1.239 Vali Loss: 2.998 Vali Acc: 0.242 Test Loss: 2.998 Test Acc: 0.242
Validation loss decreased (-0.224675 --> -0.242323).  Saving model ...
Epoch: 6 cost time: 1.0814251899719238
Epoch: 6, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.078 Vali Acc: 0.279 Test Loss: 3.078 Test Acc: 0.279
Validation loss decreased (-0.242323 --> -0.278793).  Saving model ...
Epoch: 7 cost time: 1.0810444355010986
Epoch: 7, Steps: 10 | Train Loss: 0.470 Vali Loss: 3.149 Vali Acc: 0.287 Test Loss: 3.149 Test Acc: 0.287
Validation loss decreased (-0.278793 --> -0.287027).  Saving model ...
Epoch: 8 cost time: 1.2165772914886475
Epoch: 8, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.159 Vali Acc: 0.301 Test Loss: 3.159 Test Acc: 0.301
Validation loss decreased (-0.287027 --> -0.301145).  Saving model ...
Epoch: 9 cost time: 1.1725974082946777
Epoch: 9, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.265 Vali Acc: 0.314 Test Loss: 3.265 Test Acc: 0.314
Validation loss decreased (-0.301145 --> -0.314085).  Saving model ...
Epoch: 10 cost time: 1.2210643291473389
Epoch: 10, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.350 Vali Acc: 0.314 Test Loss: 3.350 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.157576322555542
Epoch: 11, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.445 Vali Acc: 0.301 Test Loss: 3.445 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2260003089904785
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.485 Vali Acc: 0.311 Test Loss: 3.485 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2475523948669434
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.527 Vali Acc: 0.321 Test Loss: 3.527 Test Acc: 0.321
Validation loss decreased (-0.314085 --> -0.321141).  Saving model ...
Epoch: 14 cost time: 1.1177763938903809
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.561 Vali Acc: 0.320 Test Loss: 3.561 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1090795993804932
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.585 Vali Acc: 0.315 Test Loss: 3.585 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0839788913726807
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.593 Vali Acc: 0.315 Test Loss: 3.593 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3502681255340576
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.622 Vali Acc: 0.313 Test Loss: 3.622 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.337723731994629
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.663 Vali Acc: 0.311 Test Loss: 3.663 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.279134750366211
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.677 Vali Acc: 0.313 Test Loss: 3.677 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2847716808319092
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.697 Vali Acc: 0.315 Test Loss: 3.697 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.417712688446045
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.714 Vali Acc: 0.312 Test Loss: 3.714 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2473344802856445
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.721 Vali Acc: 0.311 Test Loss: 3.721 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2633533477783203
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.737 Vali Acc: 0.313 Test Loss: 3.737 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 707794
model size : 5.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.9230003356933594
Epoch: 1, Steps: 10 | Train Loss: 3.441 Vali Loss: 3.322 Vali Acc: 0.076 Test Loss: 3.322 Test Acc: 0.076
Validation loss decreased (inf --> -0.076437).  Saving model ...
Epoch: 2 cost time: 1.3463141918182373
Epoch: 2, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.302 Vali Acc: 0.129 Test Loss: 3.302 Test Acc: 0.129
Validation loss decreased (-0.076437 --> -0.129379).  Saving model ...
Epoch: 3 cost time: 1.1326961517333984
Epoch: 3, Steps: 10 | Train Loss: 2.035 Vali Loss: 3.213 Vali Acc: 0.193 Test Loss: 3.213 Test Acc: 0.193
Validation loss decreased (-0.129379 --> -0.192909).  Saving model ...
Epoch: 4 cost time: 1.1155545711517334
Epoch: 4, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.213 Vali Acc: 0.240 Test Loss: 3.213 Test Acc: 0.240
Validation loss decreased (-0.192909 --> -0.239968).  Saving model ...
Epoch: 5 cost time: 1.156557559967041
Epoch: 5, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.338 Vali Acc: 0.266 Test Loss: 3.338 Test Acc: 0.266
Validation loss decreased (-0.239968 --> -0.265849).  Saving model ...
Epoch: 6 cost time: 1.2324247360229492
Epoch: 6, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.432 Vali Acc: 0.285 Test Loss: 3.432 Test Acc: 0.285
Validation loss decreased (-0.265849 --> -0.284672).  Saving model ...
Epoch: 7 cost time: 1.0442581176757812
Epoch: 7, Steps: 10 | Train Loss: 0.342 Vali Loss: 3.597 Vali Acc: 0.305 Test Loss: 3.597 Test Acc: 0.305
Validation loss decreased (-0.284672 --> -0.304670).  Saving model ...
Epoch: 8 cost time: 1.0429494380950928
Epoch: 8, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.708 Vali Acc: 0.322 Test Loss: 3.708 Test Acc: 0.322
Validation loss decreased (-0.304670 --> -0.322316).  Saving model ...
Epoch: 9 cost time: 1.099323034286499
Epoch: 9, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.867 Vali Acc: 0.318 Test Loss: 3.867 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2002465724945068
Epoch: 10, Steps: 10 | Train Loss: 0.093 Vali Loss: 4.002 Vali Acc: 0.314 Test Loss: 4.002 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1474175453186035
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 4.056 Vali Acc: 0.331 Test Loss: 4.056 Test Acc: 0.331
Validation loss decreased (-0.322316 --> -0.330548).  Saving model ...
Epoch: 12 cost time: 1.262094497680664
Epoch: 12, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.218 Vali Acc: 0.324 Test Loss: 4.218 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1873719692230225
Epoch: 13, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.273 Vali Acc: 0.329 Test Loss: 4.273 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2435498237609863
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.275 Vali Acc: 0.331 Test Loss: 4.275 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0412921905517578
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.249 Vali Acc: 0.333 Test Loss: 4.249 Test Acc: 0.333
Validation loss decreased (-0.330548 --> -0.332899).  Saving model ...
Epoch: 16 cost time: 0.9343521595001221
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.308 Vali Acc: 0.332 Test Loss: 4.308 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.054997444152832
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.357 Vali Acc: 0.327 Test Loss: 4.357 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1620407104492188
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.394 Vali Acc: 0.326 Test Loss: 4.394 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.231353759765625
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.397 Vali Acc: 0.332 Test Loss: 4.397 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.187626838684082
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.423 Vali Acc: 0.331 Test Loss: 4.423 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1643805503845215
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.442 Vali Acc: 0.332 Test Loss: 4.442 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1976535320281982
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.466 Vali Acc: 0.326 Test Loss: 4.466 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.116936445236206
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.480 Vali Acc: 0.332 Test Loss: 4.480 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.048978328704834
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.500 Vali Acc: 0.334 Test Loss: 4.500 Test Acc: 0.334
Validation loss decreased (-0.332899 --> -0.334073).  Saving model ...
Epoch: 25 cost time: 1.067143440246582
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.513 Vali Acc: 0.331 Test Loss: 4.513 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1113998889923096
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.538 Vali Acc: 0.333 Test Loss: 4.538 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.30586576461792
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.564 Vali Acc: 0.339 Test Loss: 4.564 Test Acc: 0.339
Validation loss decreased (-0.334073 --> -0.338778).  Saving model ...
Epoch: 28 cost time: 1.196077823638916
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.572 Vali Acc: 0.336 Test Loss: 4.572 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.2497401237487793
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.590 Vali Acc: 0.335 Test Loss: 4.590 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.3043904304504395
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.614 Vali Acc: 0.338 Test Loss: 4.614 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0973842144012451
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.643 Vali Acc: 0.338 Test Loss: 4.643 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.1456942558288574
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.658 Vali Acc: 0.340 Test Loss: 4.658 Test Acc: 0.340
Validation loss decreased (-0.338778 --> -0.339953).  Saving model ...
Epoch: 33 cost time: 1.2185966968536377
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.669 Vali Acc: 0.340 Test Loss: 4.669 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.1847343444824219
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.677 Vali Acc: 0.341 Test Loss: 4.677 Test Acc: 0.341
Validation loss decreased (-0.339953 --> -0.341130).  Saving model ...
Epoch: 35 cost time: 1.1246263980865479
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.684 Vali Acc: 0.339 Test Loss: 4.684 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.123547077178955
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.696 Vali Acc: 0.340 Test Loss: 4.696 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0132644176483154
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.716 Vali Acc: 0.335 Test Loss: 4.716 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.1417171955108643
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.734 Vali Acc: 0.342 Test Loss: 4.734 Test Acc: 0.342
Validation loss decreased (-0.341130 --> -0.342306).  Saving model ...
Epoch: 39 cost time: 1.181567668914795
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.746 Vali Acc: 0.339 Test Loss: 4.746 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.1442162990570068
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.761 Vali Acc: 0.341 Test Loss: 4.761 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0013253688812256
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.781 Vali Acc: 0.342 Test Loss: 4.781 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.14908766746521
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.791 Vali Acc: 0.345 Test Loss: 4.791 Test Acc: 0.345
Validation loss decreased (-0.342306 --> -0.344658).  Saving model ...
Epoch: 43 cost time: 1.0533266067504883
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.808 Vali Acc: 0.344 Test Loss: 4.808 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.1396019458770752
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.820 Vali Acc: 0.342 Test Loss: 4.820 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 1.185654640197754
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.826 Vali Acc: 0.342 Test Loss: 4.826 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 1.1459879875183105
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.841 Vali Acc: 0.340 Test Loss: 4.841 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 1.1449851989746094
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.848 Vali Acc: 0.341 Test Loss: 4.848 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.1253955364227295
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.859 Vali Acc: 0.339 Test Loss: 4.859 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 1.2232391834259033
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.873 Vali Acc: 0.339 Test Loss: 4.873 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 1.35770845413208
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.340 Test Loss: 4.880 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0654799938201904
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.895 Vali Acc: 0.340 Test Loss: 4.895 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.049346685409546
Epoch: 52, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.904 Vali Acc: 0.340 Test Loss: 4.904 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 642258
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.15531849861145
Epoch: 1, Steps: 10 | Train Loss: 3.406 Vali Loss: 3.316 Vali Acc: 0.067 Test Loss: 3.316 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 1.1675710678100586
Epoch: 2, Steps: 10 | Train Loss: 2.856 Vali Loss: 3.299 Vali Acc: 0.119 Test Loss: 3.299 Test Acc: 0.119
Validation loss decreased (-0.067026 --> -0.118791).  Saving model ...
Epoch: 3 cost time: 1.2212083339691162
Epoch: 3, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.205 Vali Acc: 0.189 Test Loss: 3.205 Test Acc: 0.189
Validation loss decreased (-0.118791 --> -0.189380).  Saving model ...
Epoch: 4 cost time: 1.1074860095977783
Epoch: 4, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.188 Vali Acc: 0.227 Test Loss: 3.188 Test Acc: 0.227
Validation loss decreased (-0.189380 --> -0.227027).  Saving model ...
Epoch: 5 cost time: 1.251807689666748
Epoch: 5, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.290 Vali Acc: 0.273 Test Loss: 3.290 Test Acc: 0.273
Validation loss decreased (-0.227027 --> -0.272908).  Saving model ...
Epoch: 6 cost time: 0.8780627250671387
Epoch: 6, Steps: 10 | Train Loss: 0.585 Vali Loss: 3.378 Vali Acc: 0.279 Test Loss: 3.378 Test Acc: 0.279
Validation loss decreased (-0.272908 --> -0.278790).  Saving model ...
Epoch: 7 cost time: 0.9568393230438232
Epoch: 7, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.510 Vali Acc: 0.306 Test Loss: 3.510 Test Acc: 0.306
Validation loss decreased (-0.278790 --> -0.305847).  Saving model ...
Epoch: 8 cost time: 1.204575777053833
Epoch: 8, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.620 Vali Acc: 0.324 Test Loss: 3.620 Test Acc: 0.324
Validation loss decreased (-0.305847 --> -0.323493).  Saving model ...
Epoch: 9 cost time: 1.0293564796447754
Epoch: 9, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.759 Vali Acc: 0.322 Test Loss: 3.759 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.096409559249878
Epoch: 10, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.878 Vali Acc: 0.313 Test Loss: 3.878 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0631144046783447
Epoch: 11, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.932 Vali Acc: 0.325 Test Loss: 3.932 Test Acc: 0.325
Validation loss decreased (-0.323493 --> -0.324667).  Saving model ...
Epoch: 12 cost time: 1.0520493984222412
Epoch: 12, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.106 Vali Acc: 0.324 Test Loss: 4.106 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1647799015045166
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.168 Vali Acc: 0.324 Test Loss: 4.168 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0066707134246826
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.167 Vali Acc: 0.321 Test Loss: 4.167 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0909786224365234
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.154 Vali Acc: 0.334 Test Loss: 4.154 Test Acc: 0.334
Validation loss decreased (-0.324667 --> -0.334076).  Saving model ...
Epoch: 16 cost time: 1.1616532802581787
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.218 Vali Acc: 0.334 Test Loss: 4.218 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1961162090301514
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.244 Vali Acc: 0.339 Test Loss: 4.244 Test Acc: 0.339
Validation loss decreased (-0.334076 --> -0.338781).  Saving model ...
Epoch: 18 cost time: 1.0997314453125
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.281 Vali Acc: 0.335 Test Loss: 4.281 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.3418686389923096
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.279 Vali Acc: 0.336 Test Loss: 4.279 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.396941900253296
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.298 Vali Acc: 0.339 Test Loss: 4.298 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.242041826248169
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.318 Vali Acc: 0.336 Test Loss: 4.318 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2729823589324951
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.341 Vali Acc: 0.335 Test Loss: 4.341 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2898094654083252
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.356 Vali Acc: 0.336 Test Loss: 4.356 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.437976598739624
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.370 Vali Acc: 0.333 Test Loss: 4.370 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2233834266662598
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.379 Vali Acc: 0.340 Test Loss: 4.379 Test Acc: 0.340
Validation loss decreased (-0.338781 --> -0.339956).  Saving model ...
Epoch: 26 cost time: 1.229245662689209
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.409 Vali Acc: 0.339 Test Loss: 4.409 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.2039577960968018
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.434 Vali Acc: 0.340 Test Loss: 4.434 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.3994898796081543
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.435 Vali Acc: 0.335 Test Loss: 4.435 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.2509839534759521
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.447 Vali Acc: 0.336 Test Loss: 4.447 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.2742958068847656
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.463 Vali Acc: 0.338 Test Loss: 4.463 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.165132999420166
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.487 Vali Acc: 0.336 Test Loss: 4.487 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.3335442543029785
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.507 Vali Acc: 0.336 Test Loss: 4.507 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1630406379699707
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.525 Vali Acc: 0.339 Test Loss: 4.525 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1683156490325928
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.535 Vali Acc: 0.341 Test Loss: 4.535 Test Acc: 0.341
Validation loss decreased (-0.339956 --> -0.341131).  Saving model ...
Epoch: 35 cost time: 1.2646234035491943
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.547 Vali Acc: 0.339 Test Loss: 4.547 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.2475190162658691
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.563 Vali Acc: 0.338 Test Loss: 4.563 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.1932828426361084
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.581 Vali Acc: 0.339 Test Loss: 4.581 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.3003385066986084
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.593 Vali Acc: 0.338 Test Loss: 4.593 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4455132484436035
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.603 Vali Acc: 0.336 Test Loss: 4.603 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.1246113777160645
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.613 Vali Acc: 0.335 Test Loss: 4.613 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.4105427265167236
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.632 Vali Acc: 0.338 Test Loss: 4.632 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3166494369506836
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.643 Vali Acc: 0.338 Test Loss: 4.643 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2548856735229492
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.660 Vali Acc: 0.339 Test Loss: 4.660 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2466652393341064
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.673 Vali Acc: 0.339 Test Loss: 4.673 Test Acc: 0.339
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 642258
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.2320618629455566
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.297 Vali Acc: 0.066 Test Loss: 3.297 Test Acc: 0.066
Validation loss decreased (inf --> -0.065849).  Saving model ...
Epoch: 2 cost time: 1.1421799659729004
Epoch: 2, Steps: 10 | Train Loss: 2.853 Vali Loss: 3.284 Vali Acc: 0.126 Test Loss: 3.284 Test Acc: 0.126
Validation loss decreased (-0.065849 --> -0.125850).  Saving model ...
Epoch: 3 cost time: 1.1695551872253418
Epoch: 3, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.189 Vali Acc: 0.186 Test Loss: 3.189 Test Acc: 0.186
Validation loss decreased (-0.125850 --> -0.185850).  Saving model ...
Epoch: 4 cost time: 1.1802055835723877
Epoch: 4, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.136 Vali Acc: 0.224 Test Loss: 3.136 Test Acc: 0.224
Validation loss decreased (-0.185850 --> -0.223498).  Saving model ...
Epoch: 5 cost time: 1.0452690124511719
Epoch: 5, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.188 Vali Acc: 0.271 Test Loss: 3.188 Test Acc: 0.271
Validation loss decreased (-0.223498 --> -0.270556).  Saving model ...
Epoch: 6 cost time: 1.1672403812408447
Epoch: 6, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.261 Vali Acc: 0.276 Test Loss: 3.261 Test Acc: 0.276
Validation loss decreased (-0.270556 --> -0.276438).  Saving model ...
Epoch: 7 cost time: 1.3650689125061035
Epoch: 7, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.348 Vali Acc: 0.312 Test Loss: 3.348 Test Acc: 0.312
Validation loss decreased (-0.276438 --> -0.311731).  Saving model ...
Epoch: 8 cost time: 1.1968269348144531
Epoch: 8, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.442 Vali Acc: 0.318 Test Loss: 3.442 Test Acc: 0.318
Validation loss decreased (-0.311731 --> -0.317613).  Saving model ...
Epoch: 9 cost time: 1.1333184242248535
Epoch: 9, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.558 Vali Acc: 0.340 Test Loss: 3.558 Test Acc: 0.340
Validation loss decreased (-0.317613 --> -0.339964).  Saving model ...
Epoch: 10 cost time: 1.2982912063598633
Epoch: 10, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.677 Vali Acc: 0.324 Test Loss: 3.677 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1812052726745605
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.773 Vali Acc: 0.313 Test Loss: 3.773 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3779170513153076
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.843 Vali Acc: 0.320 Test Loss: 3.843 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.183654546737671
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.856 Vali Acc: 0.329 Test Loss: 3.856 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1351094245910645
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.904 Vali Acc: 0.325 Test Loss: 3.904 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0992679595947266
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.913 Vali Acc: 0.333 Test Loss: 3.913 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.259953260421753
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.949 Vali Acc: 0.333 Test Loss: 3.949 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.26216721534729
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.981 Vali Acc: 0.332 Test Loss: 3.981 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.1532394886016846
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.018 Vali Acc: 0.332 Test Loss: 4.018 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2980210781097412
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.018 Vali Acc: 0.329 Test Loss: 4.018 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 642258
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.718419313430786
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.276 Vali Acc: 0.048 Test Loss: 3.276 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 1.0493948459625244
Epoch: 2, Steps: 10 | Train Loss: 2.934 Vali Loss: 3.266 Vali Acc: 0.120 Test Loss: 3.266 Test Acc: 0.120
Validation loss decreased (-0.048203 --> -0.119967).  Saving model ...
Epoch: 3 cost time: 1.1417028903961182
Epoch: 3, Steps: 10 | Train Loss: 2.367 Vali Loss: 3.176 Vali Acc: 0.175 Test Loss: 3.176 Test Acc: 0.175
Validation loss decreased (-0.119967 --> -0.175262).  Saving model ...
Epoch: 4 cost time: 1.092925786972046
Epoch: 4, Steps: 10 | Train Loss: 1.790 Vali Loss: 3.068 Vali Acc: 0.219 Test Loss: 3.068 Test Acc: 0.219
Validation loss decreased (-0.175262 --> -0.218793).  Saving model ...
Epoch: 5 cost time: 1.0801281929016113
Epoch: 5, Steps: 10 | Train Loss: 1.256 Vali Loss: 3.021 Vali Acc: 0.264 Test Loss: 3.021 Test Acc: 0.264
Validation loss decreased (-0.218793 --> -0.263499).  Saving model ...
Epoch: 6 cost time: 1.0179941654205322
Epoch: 6, Steps: 10 | Train Loss: 0.829 Vali Loss: 3.053 Vali Acc: 0.275 Test Loss: 3.053 Test Acc: 0.275
Validation loss decreased (-0.263499 --> -0.275264).  Saving model ...
Epoch: 7 cost time: 1.054680347442627
Epoch: 7, Steps: 10 | Train Loss: 0.500 Vali Loss: 3.107 Vali Acc: 0.286 Test Loss: 3.107 Test Acc: 0.286
Validation loss decreased (-0.275264 --> -0.285851).  Saving model ...
Epoch: 8 cost time: 1.483001708984375
Epoch: 8, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.138 Vali Acc: 0.314 Test Loss: 3.138 Test Acc: 0.314
Validation loss decreased (-0.285851 --> -0.314086).  Saving model ...
Epoch: 9 cost time: 1.1309809684753418
Epoch: 9, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.248 Vali Acc: 0.319 Test Loss: 3.248 Test Acc: 0.319
Validation loss decreased (-0.314086 --> -0.318791).  Saving model ...
Epoch: 10 cost time: 1.0952489376068115
Epoch: 10, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.444 Vali Acc: 0.301 Test Loss: 3.444 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1500134468078613
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.475 Vali Acc: 0.311 Test Loss: 3.475 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2479774951934814
Epoch: 12, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.510 Vali Acc: 0.299 Test Loss: 3.510 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.369396686553955
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.527 Vali Acc: 0.306 Test Loss: 3.527 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2647969722747803
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.567 Vali Acc: 0.318 Test Loss: 3.567 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2075347900390625
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.585 Vali Acc: 0.324 Test Loss: 3.585 Test Acc: 0.324
Validation loss decreased (-0.318791 --> -0.323494).  Saving model ...
Epoch: 16 cost time: 1.2322907447814941
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.613 Vali Acc: 0.321 Test Loss: 3.613 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1774544715881348
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.634 Vali Acc: 0.314 Test Loss: 3.634 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0216584205627441
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.647 Vali Acc: 0.312 Test Loss: 3.647 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1761713027954102
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.650 Vali Acc: 0.313 Test Loss: 3.650 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3637471199035645
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.667 Vali Acc: 0.318 Test Loss: 3.667 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.283968210220337
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.682 Vali Acc: 0.318 Test Loss: 3.682 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2105686664581299
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.703 Vali Acc: 0.318 Test Loss: 3.703 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.249007225036621
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.715 Vali Acc: 0.312 Test Loss: 3.715 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1821949481964111
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.729 Vali Acc: 0.315 Test Loss: 3.729 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3453116416931152
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.738 Vali Acc: 0.314 Test Loss: 3.738 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 642258
model size : 4.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.213435411453247
Epoch: 1, Steps: 10 | Train Loss: 3.442 Vali Loss: 3.291 Vali Acc: 0.061 Test Loss: 3.291 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 1.1640009880065918
Epoch: 2, Steps: 10 | Train Loss: 2.880 Vali Loss: 3.311 Vali Acc: 0.136 Test Loss: 3.311 Test Acc: 0.136
Validation loss decreased (-0.061144 --> -0.136437).  Saving model ...
Epoch: 3 cost time: 1.1444766521453857
Epoch: 3, Steps: 10 | Train Loss: 2.131 Vali Loss: 3.192 Vali Acc: 0.182 Test Loss: 3.192 Test Acc: 0.182
Validation loss decreased (-0.136437 --> -0.182321).  Saving model ...
Epoch: 4 cost time: 1.0351471900939941
Epoch: 4, Steps: 10 | Train Loss: 1.443 Vali Loss: 3.165 Vali Acc: 0.245 Test Loss: 3.165 Test Acc: 0.245
Validation loss decreased (-0.182321 --> -0.244674).  Saving model ...
Epoch: 5 cost time: 1.2325756549835205
Epoch: 5, Steps: 10 | Train Loss: 0.922 Vali Loss: 3.363 Vali Acc: 0.259 Test Loss: 3.363 Test Acc: 0.259
Validation loss decreased (-0.244674 --> -0.258790).  Saving model ...
Epoch: 6 cost time: 1.2608287334442139
Epoch: 6, Steps: 10 | Train Loss: 0.580 Vali Loss: 3.415 Vali Acc: 0.296 Test Loss: 3.415 Test Acc: 0.296
Validation loss decreased (-0.258790 --> -0.296436).  Saving model ...
Epoch: 7 cost time: 1.113607406616211
Epoch: 7, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.575 Vali Acc: 0.305 Test Loss: 3.575 Test Acc: 0.305
Validation loss decreased (-0.296436 --> -0.304670).  Saving model ...
Epoch: 8 cost time: 1.2072663307189941
Epoch: 8, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.748 Vali Acc: 0.322 Test Loss: 3.748 Test Acc: 0.322
Validation loss decreased (-0.304670 --> -0.322315).  Saving model ...
Epoch: 9 cost time: 1.036910057067871
Epoch: 9, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.977 Vali Acc: 0.314 Test Loss: 3.977 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1237249374389648
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 4.001 Vali Acc: 0.320 Test Loss: 4.001 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.23746657371521
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.062 Vali Acc: 0.334 Test Loss: 4.062 Test Acc: 0.334
Validation loss decreased (-0.322315 --> -0.334077).  Saving model ...
Epoch: 12 cost time: 1.214292049407959
Epoch: 12, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.219 Vali Acc: 0.329 Test Loss: 4.219 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1170971393585205
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.219 Vali Acc: 0.334 Test Loss: 4.219 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1762096881866455
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.253 Vali Acc: 0.335 Test Loss: 4.253 Test Acc: 0.335
Validation loss decreased (-0.334077 --> -0.335252).  Saving model ...
Epoch: 15 cost time: 1.1602864265441895
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.305 Vali Acc: 0.338 Test Loss: 4.305 Test Acc: 0.338
Validation loss decreased (-0.335252 --> -0.337604).  Saving model ...
Epoch: 16 cost time: 0.9794812202453613
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.355 Vali Acc: 0.340 Test Loss: 4.355 Test Acc: 0.340
Validation loss decreased (-0.337604 --> -0.339956).  Saving model ...
Epoch: 17 cost time: 1.0808250904083252
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.398 Vali Acc: 0.335 Test Loss: 4.398 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.160794973373413
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.427 Vali Acc: 0.331 Test Loss: 4.427 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1297192573547363
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.436 Vali Acc: 0.332 Test Loss: 4.436 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1466107368469238
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.476 Vali Acc: 0.338 Test Loss: 4.476 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9716873168945312
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.496 Vali Acc: 0.338 Test Loss: 4.496 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1661734580993652
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.518 Vali Acc: 0.334 Test Loss: 4.518 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2687187194824219
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.533 Vali Acc: 0.338 Test Loss: 4.533 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1466989517211914
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.565 Vali Acc: 0.334 Test Loss: 4.565 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1266062259674072
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.608 Vali Acc: 0.333 Test Loss: 4.608 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.0877354145050049
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.606 Vali Acc: 0.332 Test Loss: 4.606 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 609490
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.051518201828003
Epoch: 1, Steps: 10 | Train Loss: 3.417 Vali Loss: 3.280 Vali Acc: 0.064 Test Loss: 3.280 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 1.111943006515503
Epoch: 2, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.305 Vali Acc: 0.136 Test Loss: 3.305 Test Acc: 0.136
Validation loss decreased (-0.063497 --> -0.136438).  Saving model ...
Epoch: 3 cost time: 1.2829220294952393
Epoch: 3, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.188 Vali Acc: 0.181 Test Loss: 3.188 Test Acc: 0.181
Validation loss decreased (-0.136438 --> -0.181145).  Saving model ...
Epoch: 4 cost time: 1.1051828861236572
Epoch: 4, Steps: 10 | Train Loss: 1.495 Vali Loss: 3.140 Vali Acc: 0.235 Test Loss: 3.140 Test Acc: 0.235
Validation loss decreased (-0.181145 --> -0.235263).  Saving model ...
Epoch: 5 cost time: 1.1090896129608154
Epoch: 5, Steps: 10 | Train Loss: 0.990 Vali Loss: 3.307 Vali Acc: 0.260 Test Loss: 3.307 Test Acc: 0.260
Validation loss decreased (-0.235263 --> -0.259967).  Saving model ...
Epoch: 6 cost time: 1.0344161987304688
Epoch: 6, Steps: 10 | Train Loss: 0.603 Vali Loss: 3.351 Vali Acc: 0.299 Test Loss: 3.351 Test Acc: 0.299
Validation loss decreased (-0.259967 --> -0.298790).  Saving model ...
Epoch: 7 cost time: 1.0391383171081543
Epoch: 7, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.515 Vali Acc: 0.302 Test Loss: 3.515 Test Acc: 0.302
Validation loss decreased (-0.298790 --> -0.302318).  Saving model ...
Epoch: 8 cost time: 1.1364572048187256
Epoch: 8, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.636 Vali Acc: 0.324 Test Loss: 3.636 Test Acc: 0.324
Validation loss decreased (-0.302318 --> -0.323493).  Saving model ...
Epoch: 9 cost time: 1.0687763690948486
Epoch: 9, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.829 Vali Acc: 0.312 Test Loss: 3.829 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2362287044525146
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.859 Vali Acc: 0.329 Test Loss: 3.859 Test Acc: 0.329
Validation loss decreased (-0.323493 --> -0.329373).  Saving model ...
Epoch: 11 cost time: 1.2984375953674316
Epoch: 11, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.922 Vali Acc: 0.334 Test Loss: 3.922 Test Acc: 0.334
Validation loss decreased (-0.329373 --> -0.334078).  Saving model ...
Epoch: 12 cost time: 1.2232346534729004
Epoch: 12, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.045 Vali Acc: 0.333 Test Loss: 4.045 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.389437198638916
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.092 Vali Acc: 0.328 Test Loss: 4.092 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1459259986877441
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.106 Vali Acc: 0.341 Test Loss: 4.106 Test Acc: 0.341
Validation loss decreased (-0.334078 --> -0.341135).  Saving model ...
Epoch: 15 cost time: 1.2844939231872559
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.168 Vali Acc: 0.356 Test Loss: 4.168 Test Acc: 0.356
Validation loss decreased (-0.341135 --> -0.356429).  Saving model ...
Epoch: 16 cost time: 1.2534375190734863
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.218 Vali Acc: 0.345 Test Loss: 4.218 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3881771564483643
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.262 Vali Acc: 0.336 Test Loss: 4.262 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.3602077960968018
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.285 Vali Acc: 0.336 Test Loss: 4.285 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.4844372272491455
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.295 Vali Acc: 0.341 Test Loss: 4.295 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.486814022064209
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.328 Vali Acc: 0.339 Test Loss: 4.328 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5619697570800781
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.346 Vali Acc: 0.338 Test Loss: 4.346 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2554497718811035
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.372 Vali Acc: 0.338 Test Loss: 4.372 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2792115211486816
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.375 Vali Acc: 0.341 Test Loss: 4.375 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2966303825378418
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.400 Vali Acc: 0.342 Test Loss: 4.400 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.4812302589416504
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.431 Vali Acc: 0.340 Test Loss: 4.431 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3564705882352941
model parameter : 609490
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.995594024658203
Epoch: 1, Steps: 10 | Train Loss: 3.398 Vali Loss: 3.266 Vali Acc: 0.065 Test Loss: 3.266 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 1.1019744873046875
Epoch: 2, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.285 Vali Acc: 0.134 Test Loss: 3.285 Test Acc: 0.134
Validation loss decreased (-0.064673 --> -0.134085).  Saving model ...
Epoch: 3 cost time: 1.0562305450439453
Epoch: 3, Steps: 10 | Train Loss: 2.243 Vali Loss: 3.174 Vali Acc: 0.184 Test Loss: 3.174 Test Acc: 0.184
Validation loss decreased (-0.134085 --> -0.183498).  Saving model ...
Epoch: 4 cost time: 1.2000577449798584
Epoch: 4, Steps: 10 | Train Loss: 1.577 Vali Loss: 3.080 Vali Acc: 0.235 Test Loss: 3.080 Test Acc: 0.235
Validation loss decreased (-0.183498 --> -0.235263).  Saving model ...
Epoch: 5 cost time: 1.1377451419830322
Epoch: 5, Steps: 10 | Train Loss: 1.026 Vali Loss: 3.210 Vali Acc: 0.252 Test Loss: 3.210 Test Acc: 0.252
Validation loss decreased (-0.235263 --> -0.251733).  Saving model ...
Epoch: 6 cost time: 1.1870684623718262
Epoch: 6, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.237 Vali Acc: 0.294 Test Loss: 3.237 Test Acc: 0.294
Validation loss decreased (-0.251733 --> -0.294085).  Saving model ...
Epoch: 7 cost time: 1.1564850807189941
Epoch: 7, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.369 Vali Acc: 0.307 Test Loss: 3.369 Test Acc: 0.307
Validation loss decreased (-0.294085 --> -0.307025).  Saving model ...
Epoch: 8 cost time: 1.0101637840270996
Epoch: 8, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.457 Vali Acc: 0.326 Test Loss: 3.457 Test Acc: 0.326
Validation loss decreased (-0.307025 --> -0.325848).  Saving model ...
Epoch: 9 cost time: 1.1033782958984375
Epoch: 9, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.630 Vali Acc: 0.320 Test Loss: 3.630 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1306860446929932
Epoch: 10, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.673 Vali Acc: 0.316 Test Loss: 3.673 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1287927627563477
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.742 Vali Acc: 0.314 Test Loss: 3.742 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.104259729385376
Epoch: 12, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.790 Vali Acc: 0.325 Test Loss: 3.790 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1653921604156494
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.833 Vali Acc: 0.325 Test Loss: 3.833 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1172444820404053
Epoch: 14, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.876 Vali Acc: 0.335 Test Loss: 3.876 Test Acc: 0.335
Validation loss decreased (-0.325848 --> -0.335255).  Saving model ...
Epoch: 15 cost time: 1.0795722007751465
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.950 Vali Acc: 0.336 Test Loss: 3.950 Test Acc: 0.336
Validation loss decreased (-0.335255 --> -0.336431).  Saving model ...
Epoch: 16 cost time: 1.2233116626739502
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.981 Vali Acc: 0.339 Test Loss: 3.981 Test Acc: 0.339
Validation loss decreased (-0.336431 --> -0.338784).  Saving model ...
Epoch: 17 cost time: 1.1066007614135742
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.003 Vali Acc: 0.327 Test Loss: 4.003 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3877201080322266
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.014 Vali Acc: 0.325 Test Loss: 4.014 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1612489223480225
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.019 Vali Acc: 0.328 Test Loss: 4.019 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1859395503997803
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.041 Vali Acc: 0.329 Test Loss: 4.041 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1145601272583008
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.054 Vali Acc: 0.335 Test Loss: 4.054 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1461951732635498
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.077 Vali Acc: 0.335 Test Loss: 4.077 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.2000603675842285
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.095 Vali Acc: 0.334 Test Loss: 4.095 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1746065616607666
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.122 Vali Acc: 0.332 Test Loss: 4.122 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0579309463500977
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.139 Vali Acc: 0.334 Test Loss: 4.139 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2196004390716553
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.154 Vali Acc: 0.334 Test Loss: 4.154 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 609490
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.792680501937866
Epoch: 1, Steps: 10 | Train Loss: 3.366 Vali Loss: 3.266 Vali Acc: 0.065 Test Loss: 3.266 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 1.0759248733520508
Epoch: 2, Steps: 10 | Train Loss: 2.992 Vali Loss: 3.270 Vali Acc: 0.120 Test Loss: 3.270 Test Acc: 0.120
Validation loss decreased (-0.064673 --> -0.119967).  Saving model ...
Epoch: 3 cost time: 1.094684362411499
Epoch: 3, Steps: 10 | Train Loss: 2.432 Vali Loss: 3.181 Vali Acc: 0.167 Test Loss: 3.181 Test Acc: 0.167
Validation loss decreased (-0.119967 --> -0.167027).  Saving model ...
Epoch: 4 cost time: 1.1104352474212646
Epoch: 4, Steps: 10 | Train Loss: 1.848 Vali Loss: 3.025 Vali Acc: 0.225 Test Loss: 3.025 Test Acc: 0.225
Validation loss decreased (-0.167027 --> -0.224676).  Saving model ...
Epoch: 5 cost time: 0.9693968296051025
Epoch: 5, Steps: 10 | Train Loss: 1.270 Vali Loss: 3.033 Vali Acc: 0.240 Test Loss: 3.033 Test Acc: 0.240
Validation loss decreased (-0.224676 --> -0.239970).  Saving model ...
Epoch: 6 cost time: 1.089176893234253
Epoch: 6, Steps: 10 | Train Loss: 0.819 Vali Loss: 3.034 Vali Acc: 0.282 Test Loss: 3.034 Test Acc: 0.282
Validation loss decreased (-0.239970 --> -0.282323).  Saving model ...
Epoch: 7 cost time: 1.1574876308441162
Epoch: 7, Steps: 10 | Train Loss: 0.477 Vali Loss: 3.123 Vali Acc: 0.294 Test Loss: 3.123 Test Acc: 0.294
Validation loss decreased (-0.282323 --> -0.294086).  Saving model ...
Epoch: 8 cost time: 1.2803099155426025
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.163 Vali Acc: 0.295 Test Loss: 3.163 Test Acc: 0.295
Validation loss decreased (-0.294086 --> -0.295262).  Saving model ...
Epoch: 9 cost time: 1.1770453453063965
Epoch: 9, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.318 Vali Acc: 0.312 Test Loss: 3.318 Test Acc: 0.312
Validation loss decreased (-0.295262 --> -0.311732).  Saving model ...
Epoch: 10 cost time: 1.3913400173187256
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.403 Vali Acc: 0.287 Test Loss: 3.403 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2307946681976318
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.432 Vali Acc: 0.306 Test Loss: 3.432 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2338252067565918
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.528 Vali Acc: 0.309 Test Loss: 3.528 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2214586734771729
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.488 Vali Acc: 0.315 Test Loss: 3.488 Test Acc: 0.315
Validation loss decreased (-0.311732 --> -0.315259).  Saving model ...
Epoch: 14 cost time: 1.078645944595337
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.521 Vali Acc: 0.320 Test Loss: 3.521 Test Acc: 0.320
Validation loss decreased (-0.315259 --> -0.319965).  Saving model ...
Epoch: 15 cost time: 1.0905494689941406
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.565 Vali Acc: 0.314 Test Loss: 3.565 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1737279891967773
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.602 Vali Acc: 0.315 Test Loss: 3.602 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2045989036560059
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.610 Vali Acc: 0.311 Test Loss: 3.610 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3266074657440186
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.627 Vali Acc: 0.312 Test Loss: 3.627 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.235239028930664
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.645 Vali Acc: 0.316 Test Loss: 3.645 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0887479782104492
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.679 Vali Acc: 0.318 Test Loss: 3.679 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.00620436668396
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.697 Vali Acc: 0.315 Test Loss: 3.697 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.049950122833252
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.713 Vali Acc: 0.313 Test Loss: 3.713 Test Acc: 0.313
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0518922805786133
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.740 Vali Acc: 0.315 Test Loss: 3.740 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1002368927001953
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.758 Vali Acc: 0.318 Test Loss: 3.758 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 609490
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 3.0959744453430176
Epoch: 1, Steps: 10 | Train Loss: 3.446 Vali Loss: 3.361 Vali Acc: 0.051 Test Loss: 3.361 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 1.1072516441345215
Epoch: 2, Steps: 10 | Train Loss: 3.064 Vali Loss: 3.284 Vali Acc: 0.084 Test Loss: 3.284 Test Acc: 0.084
Validation loss decreased (-0.050555 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 1.2309560775756836
Epoch: 3, Steps: 10 | Train Loss: 2.630 Vali Loss: 3.247 Vali Acc: 0.122 Test Loss: 3.247 Test Acc: 0.122
Validation loss decreased (-0.083497 --> -0.122320).  Saving model ...
Epoch: 4 cost time: 1.2173943519592285
Epoch: 4, Steps: 10 | Train Loss: 2.151 Vali Loss: 3.188 Vali Acc: 0.166 Test Loss: 3.188 Test Acc: 0.166
Validation loss decreased (-0.122320 --> -0.165850).  Saving model ...
Epoch: 5 cost time: 1.151794195175171
Epoch: 5, Steps: 10 | Train Loss: 1.670 Vali Loss: 3.158 Vali Acc: 0.206 Test Loss: 3.158 Test Acc: 0.206
Validation loss decreased (-0.165850 --> -0.205851).  Saving model ...
Epoch: 6 cost time: 1.1018321514129639
Epoch: 6, Steps: 10 | Train Loss: 1.291 Vali Loss: 3.186 Vali Acc: 0.245 Test Loss: 3.186 Test Acc: 0.245
Validation loss decreased (-0.205851 --> -0.244674).  Saving model ...
Epoch: 7 cost time: 1.0246071815490723
Epoch: 7, Steps: 10 | Train Loss: 0.941 Vali Loss: 3.237 Vali Acc: 0.280 Test Loss: 3.237 Test Acc: 0.280
Validation loss decreased (-0.244674 --> -0.279968).  Saving model ...
Epoch: 8 cost time: 1.1220276355743408
Epoch: 8, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.303 Vali Acc: 0.294 Test Loss: 3.303 Test Acc: 0.294
Validation loss decreased (-0.279968 --> -0.294085).  Saving model ...
Epoch: 9 cost time: 1.1101140975952148
Epoch: 9, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.404 Vali Acc: 0.299 Test Loss: 3.404 Test Acc: 0.299
Validation loss decreased (-0.294085 --> -0.298789).  Saving model ...
Epoch: 10 cost time: 1.3699243068695068
Epoch: 10, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.473 Vali Acc: 0.318 Test Loss: 3.473 Test Acc: 0.318
Validation loss decreased (-0.298789 --> -0.317612).  Saving model ...
Epoch: 11 cost time: 1.1598608493804932
Epoch: 11, Steps: 10 | Train Loss: 0.181 Vali Loss: 3.571 Vali Acc: 0.314 Test Loss: 3.571 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3097267150878906
Epoch: 12, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.672 Vali Acc: 0.333 Test Loss: 3.672 Test Acc: 0.333
Validation loss decreased (-0.317612 --> -0.332904).  Saving model ...
Epoch: 13 cost time: 1.1317048072814941
Epoch: 13, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.710 Vali Acc: 0.339 Test Loss: 3.710 Test Acc: 0.339
Validation loss decreased (-0.332904 --> -0.338786).  Saving model ...
Epoch: 14 cost time: 1.007103681564331
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.789 Vali Acc: 0.336 Test Loss: 3.789 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0819592475891113
Epoch: 15, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.899 Vali Acc: 0.335 Test Loss: 3.899 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.164811372756958
Epoch: 16, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.865 Vali Acc: 0.335 Test Loss: 3.865 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2093744277954102
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.932 Vali Acc: 0.329 Test Loss: 3.932 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2449097633361816
Epoch: 18, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.952 Vali Acc: 0.334 Test Loss: 3.952 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3350396156311035
Epoch: 19, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.979 Vali Acc: 0.345 Test Loss: 3.979 Test Acc: 0.345
Validation loss decreased (-0.338786 --> -0.344666).  Saving model ...
Epoch: 20 cost time: 1.1250081062316895
Epoch: 20, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.989 Vali Acc: 0.341 Test Loss: 3.989 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2203171253204346
Epoch: 21, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.034 Vali Acc: 0.339 Test Loss: 4.034 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9337801933288574
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.059 Vali Acc: 0.335 Test Loss: 4.059 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1134490966796875
Epoch: 23, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.069 Vali Acc: 0.338 Test Loss: 4.069 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.1155204772949219
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.091 Vali Acc: 0.339 Test Loss: 4.091 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.1464381217956543
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.114 Vali Acc: 0.338 Test Loss: 4.114 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.2623555660247803
Epoch: 26, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.140 Vali Acc: 0.339 Test Loss: 4.140 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2068371772766113
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.160 Vali Acc: 0.344 Test Loss: 4.160 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3270461559295654
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.182 Vali Acc: 0.338 Test Loss: 4.182 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2758569717407227
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.201 Vali Acc: 0.338 Test Loss: 4.201 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 796306
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8732590675354004
Epoch: 1, Steps: 10 | Train Loss: 3.420 Vali Loss: 3.343 Vali Acc: 0.052 Test Loss: 3.343 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 1.3521897792816162
Epoch: 2, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.272 Vali Acc: 0.092 Test Loss: 3.272 Test Acc: 0.092
Validation loss decreased (-0.051731 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 1.3220269680023193
Epoch: 3, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.242 Vali Acc: 0.119 Test Loss: 3.242 Test Acc: 0.119
Validation loss decreased (-0.091732 --> -0.118791).  Saving model ...
Epoch: 4 cost time: 1.3737049102783203
Epoch: 4, Steps: 10 | Train Loss: 2.213 Vali Loss: 3.179 Vali Acc: 0.169 Test Loss: 3.179 Test Acc: 0.169
Validation loss decreased (-0.118791 --> -0.169380).  Saving model ...
Epoch: 5 cost time: 1.280707597732544
Epoch: 5, Steps: 10 | Train Loss: 1.745 Vali Loss: 3.142 Vali Acc: 0.221 Test Loss: 3.142 Test Acc: 0.221
Validation loss decreased (-0.169380 --> -0.221145).  Saving model ...
Epoch: 6 cost time: 1.246999979019165
Epoch: 6, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.168 Vali Acc: 0.249 Test Loss: 3.168 Test Acc: 0.249
Validation loss decreased (-0.221145 --> -0.249380).  Saving model ...
Epoch: 7 cost time: 1.1967971324920654
Epoch: 7, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.214 Vali Acc: 0.260 Test Loss: 3.214 Test Acc: 0.260
Validation loss decreased (-0.249380 --> -0.259968).  Saving model ...
Epoch: 8 cost time: 1.2069416046142578
Epoch: 8, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.270 Vali Acc: 0.284 Test Loss: 3.270 Test Acc: 0.284
Validation loss decreased (-0.259968 --> -0.283497).  Saving model ...
Epoch: 9 cost time: 1.2116198539733887
Epoch: 9, Steps: 10 | Train Loss: 0.482 Vali Loss: 3.373 Vali Acc: 0.298 Test Loss: 3.373 Test Acc: 0.298
Validation loss decreased (-0.283497 --> -0.297613).  Saving model ...
Epoch: 10 cost time: 1.1625256538391113
Epoch: 10, Steps: 10 | Train Loss: 0.318 Vali Loss: 3.442 Vali Acc: 0.313 Test Loss: 3.442 Test Acc: 0.313
Validation loss decreased (-0.297613 --> -0.312907).  Saving model ...
Epoch: 11 cost time: 1.2158958911895752
Epoch: 11, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.504 Vali Acc: 0.311 Test Loss: 3.504 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2749440670013428
Epoch: 12, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.586 Vali Acc: 0.325 Test Loss: 3.586 Test Acc: 0.325
Validation loss decreased (-0.312907 --> -0.324670).  Saving model ...
Epoch: 13 cost time: 1.2534308433532715
Epoch: 13, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.663 Vali Acc: 0.320 Test Loss: 3.663 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2791292667388916
Epoch: 14, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.726 Vali Acc: 0.327 Test Loss: 3.726 Test Acc: 0.327
Validation loss decreased (-0.324670 --> -0.327022).  Saving model ...
Epoch: 15 cost time: 1.1999201774597168
Epoch: 15, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.822 Vali Acc: 0.329 Test Loss: 3.822 Test Acc: 0.329
Validation loss decreased (-0.327022 --> -0.329374).  Saving model ...
Epoch: 16 cost time: 1.1220545768737793
Epoch: 16, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.790 Vali Acc: 0.334 Test Loss: 3.790 Test Acc: 0.334
Validation loss decreased (-0.329374 --> -0.334080).  Saving model ...
Epoch: 17 cost time: 1.000896692276001
Epoch: 17, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.846 Vali Acc: 0.327 Test Loss: 3.846 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2524969577789307
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.868 Vali Acc: 0.328 Test Loss: 3.868 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2921512126922607
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.884 Vali Acc: 0.331 Test Loss: 3.884 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2300643920898438
Epoch: 20, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.889 Vali Acc: 0.338 Test Loss: 3.889 Test Acc: 0.338
Validation loss decreased (-0.334080 --> -0.337608).  Saving model ...
Epoch: 21 cost time: 1.1663789749145508
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.935 Vali Acc: 0.333 Test Loss: 3.935 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.2798492908477783
Epoch: 22, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.966 Vali Acc: 0.331 Test Loss: 3.966 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.2711052894592285
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.984 Vali Acc: 0.331 Test Loss: 3.984 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.098252296447754
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.997 Vali Acc: 0.338 Test Loss: 3.997 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.2471592426300049
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.007 Vali Acc: 0.335 Test Loss: 4.007 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.2002363204956055
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.031 Vali Acc: 0.338 Test Loss: 4.031 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.240922212600708
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.050 Vali Acc: 0.335 Test Loss: 4.050 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.16981840133667
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.070 Vali Acc: 0.335 Test Loss: 4.070 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0901005268096924
Epoch: 29, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.087 Vali Acc: 0.338 Test Loss: 4.087 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.187976360321045
Epoch: 30, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.106 Vali Acc: 0.336 Test Loss: 4.106 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 796306
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.859947919845581
Epoch: 1, Steps: 10 | Train Loss: 3.363 Vali Loss: 3.321 Vali Acc: 0.052 Test Loss: 3.321 Test Acc: 0.052
Validation loss decreased (inf --> -0.051731).  Saving model ...
Epoch: 2 cost time: 1.027214765548706
Epoch: 2, Steps: 10 | Train Loss: 3.093 Vali Loss: 3.260 Vali Acc: 0.096 Test Loss: 3.260 Test Acc: 0.096
Validation loss decreased (-0.051731 --> -0.096438).  Saving model ...
Epoch: 3 cost time: 1.055417776107788
Epoch: 3, Steps: 10 | Train Loss: 2.659 Vali Loss: 3.233 Vali Acc: 0.124 Test Loss: 3.233 Test Acc: 0.124
Validation loss decreased (-0.096438 --> -0.123497).  Saving model ...
Epoch: 4 cost time: 1.2277939319610596
Epoch: 4, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.166 Vali Acc: 0.160 Test Loss: 3.166 Test Acc: 0.160
Validation loss decreased (-0.123497 --> -0.159968).  Saving model ...
Epoch: 5 cost time: 1.1936886310577393
Epoch: 5, Steps: 10 | Train Loss: 1.799 Vali Loss: 3.113 Vali Acc: 0.213 Test Loss: 3.113 Test Acc: 0.213
Validation loss decreased (-0.159968 --> -0.212910).  Saving model ...
Epoch: 6 cost time: 1.113312005996704
Epoch: 6, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.113 Vali Acc: 0.251 Test Loss: 3.113 Test Acc: 0.251
Validation loss decreased (-0.212910 --> -0.250557).  Saving model ...
Epoch: 7 cost time: 1.1368751525878906
Epoch: 7, Steps: 10 | Train Loss: 1.051 Vali Loss: 3.137 Vali Acc: 0.259 Test Loss: 3.137 Test Acc: 0.259
Validation loss decreased (-0.250557 --> -0.258792).  Saving model ...
Epoch: 8 cost time: 1.2983064651489258
Epoch: 8, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.181 Vali Acc: 0.278 Test Loss: 3.181 Test Acc: 0.278
Validation loss decreased (-0.258792 --> -0.277615).  Saving model ...
Epoch: 9 cost time: 1.1450762748718262
Epoch: 9, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.237 Vali Acc: 0.291 Test Loss: 3.237 Test Acc: 0.291
Validation loss decreased (-0.277615 --> -0.290556).  Saving model ...
Epoch: 10 cost time: 1.2655787467956543
Epoch: 10, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.299 Vali Acc: 0.314 Test Loss: 3.299 Test Acc: 0.314
Validation loss decreased (-0.290556 --> -0.314085).  Saving model ...
Epoch: 11 cost time: 1.2501389980316162
Epoch: 11, Steps: 10 | Train Loss: 0.204 Vali Loss: 3.386 Vali Acc: 0.319 Test Loss: 3.386 Test Acc: 0.319
Validation loss decreased (-0.314085 --> -0.318790).  Saving model ...
Epoch: 12 cost time: 1.4317712783813477
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.457 Vali Acc: 0.324 Test Loss: 3.457 Test Acc: 0.324
Validation loss decreased (-0.318790 --> -0.323495).  Saving model ...
Epoch: 13 cost time: 1.2524967193603516
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.501 Vali Acc: 0.320 Test Loss: 3.501 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4145262241363525
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.582 Vali Acc: 0.318 Test Loss: 3.582 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2195448875427246
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.658 Vali Acc: 0.325 Test Loss: 3.658 Test Acc: 0.325
Validation loss decreased (-0.323495 --> -0.324669).  Saving model ...
Epoch: 16 cost time: 1.3138787746429443
Epoch: 16, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.633 Vali Acc: 0.331 Test Loss: 3.633 Test Acc: 0.331
Validation loss decreased (-0.324669 --> -0.330552).  Saving model ...
Epoch: 17 cost time: 0.9967501163482666
Epoch: 17, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.663 Vali Acc: 0.334 Test Loss: 3.663 Test Acc: 0.334
Validation loss decreased (-0.330552 --> -0.334081).  Saving model ...
Epoch: 18 cost time: 1.0699462890625
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.686 Vali Acc: 0.329 Test Loss: 3.686 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0822851657867432
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.710 Vali Acc: 0.338 Test Loss: 3.710 Test Acc: 0.338
Validation loss decreased (-0.334081 --> -0.337610).  Saving model ...
Epoch: 20 cost time: 1.0014324188232422
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.713 Vali Acc: 0.336 Test Loss: 3.713 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.100247859954834
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.746 Vali Acc: 0.338 Test Loss: 3.746 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2449538707733154
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.785 Vali Acc: 0.329 Test Loss: 3.785 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.1171936988830566
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.806 Vali Acc: 0.335 Test Loss: 3.806 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.261052131652832
Epoch: 24, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.818 Vali Acc: 0.329 Test Loss: 3.818 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.2869153022766113
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.824 Vali Acc: 0.333 Test Loss: 3.824 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1250178813934326
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.839 Vali Acc: 0.332 Test Loss: 3.839 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2118370532989502
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.854 Vali Acc: 0.339 Test Loss: 3.854 Test Acc: 0.339
Validation loss decreased (-0.337610 --> -0.338785).  Saving model ...
Epoch: 28 cost time: 1.212792158126831
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.868 Vali Acc: 0.336 Test Loss: 3.868 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.212203025817871
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.891 Vali Acc: 0.336 Test Loss: 3.891 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.273587703704834
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.909 Vali Acc: 0.339 Test Loss: 3.909 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.2939364910125732
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.918 Vali Acc: 0.338 Test Loss: 3.918 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.3109381198883057
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.931 Vali Acc: 0.336 Test Loss: 3.931 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.2671113014221191
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.942 Vali Acc: 0.334 Test Loss: 3.942 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.3625926971435547
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.953 Vali Acc: 0.336 Test Loss: 3.953 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.1625776290893555
Epoch: 35, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.955 Vali Acc: 0.336 Test Loss: 3.955 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.2751226425170898
Epoch: 36, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.970 Vali Acc: 0.336 Test Loss: 3.970 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0887291431427002
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.980 Vali Acc: 0.336 Test Loss: 3.980 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 796306
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7749578952789307
Epoch: 1, Steps: 10 | Train Loss: 3.326 Vali Loss: 3.285 Vali Acc: 0.059 Test Loss: 3.285 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 1.0065860748291016
Epoch: 2, Steps: 10 | Train Loss: 3.102 Vali Loss: 3.238 Vali Acc: 0.095 Test Loss: 3.238 Test Acc: 0.095
Validation loss decreased (-0.058791 --> -0.095262).  Saving model ...
Epoch: 3 cost time: 1.021693229675293
Epoch: 3, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.215 Vali Acc: 0.128 Test Loss: 3.215 Test Acc: 0.128
Validation loss decreased (-0.095262 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 1.009990930557251
Epoch: 4, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.144 Vali Acc: 0.166 Test Loss: 3.144 Test Acc: 0.166
Validation loss decreased (-0.128203 --> -0.165851).  Saving model ...
Epoch: 5 cost time: 0.9744746685028076
Epoch: 5, Steps: 10 | Train Loss: 2.033 Vali Loss: 3.058 Vali Acc: 0.208 Test Loss: 3.058 Test Acc: 0.208
Validation loss decreased (-0.165851 --> -0.208205).  Saving model ...
Epoch: 6 cost time: 0.963787317276001
Epoch: 6, Steps: 10 | Train Loss: 1.678 Vali Loss: 3.006 Vali Acc: 0.233 Test Loss: 3.006 Test Acc: 0.233
Validation loss decreased (-0.208205 --> -0.232911).  Saving model ...
Epoch: 7 cost time: 0.9737541675567627
Epoch: 7, Steps: 10 | Train Loss: 1.323 Vali Loss: 2.972 Vali Acc: 0.260 Test Loss: 2.972 Test Acc: 0.260
Validation loss decreased (-0.232911 --> -0.259970).  Saving model ...
Epoch: 8 cost time: 1.1223464012145996
Epoch: 8, Steps: 10 | Train Loss: 1.005 Vali Loss: 2.955 Vali Acc: 0.276 Test Loss: 2.955 Test Acc: 0.276
Validation loss decreased (-0.259970 --> -0.276441).  Saving model ...
Epoch: 9 cost time: 1.0468814373016357
Epoch: 9, Steps: 10 | Train Loss: 0.695 Vali Loss: 2.965 Vali Acc: 0.306 Test Loss: 2.965 Test Acc: 0.306
Validation loss decreased (-0.276441 --> -0.305853).  Saving model ...
Epoch: 10 cost time: 1.029118537902832
Epoch: 10, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.014 Vali Acc: 0.304 Test Loss: 3.014 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.0329740047454834
Epoch: 11, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.049 Vali Acc: 0.324 Test Loss: 3.049 Test Acc: 0.324
Validation loss decreased (-0.305853 --> -0.323499).  Saving model ...
Epoch: 12 cost time: 0.9870789051055908
Epoch: 12, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.090 Vali Acc: 0.331 Test Loss: 3.090 Test Acc: 0.331
Validation loss decreased (-0.323499 --> -0.330557).  Saving model ...
Epoch: 13 cost time: 1.1929600238800049
Epoch: 13, Steps: 10 | Train Loss: 0.093 Vali Loss: 3.166 Vali Acc: 0.320 Test Loss: 3.166 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0563981533050537
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.206 Vali Acc: 0.324 Test Loss: 3.206 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1055479049682617
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.267 Vali Acc: 0.326 Test Loss: 3.267 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0234715938568115
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.271 Vali Acc: 0.331 Test Loss: 3.271 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0791618824005127
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.304 Vali Acc: 0.327 Test Loss: 3.304 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.247612714767456
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.316 Vali Acc: 0.333 Test Loss: 3.316 Test Acc: 0.333
Validation loss decreased (-0.330557 --> -0.332908).  Saving model ...
Epoch: 19 cost time: 1.034127950668335
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.339 Vali Acc: 0.336 Test Loss: 3.339 Test Acc: 0.336
Validation loss decreased (-0.332908 --> -0.336437).  Saving model ...
Epoch: 20 cost time: 1.0881681442260742
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.360 Vali Acc: 0.341 Test Loss: 3.360 Test Acc: 0.341
Validation loss decreased (-0.336437 --> -0.341143).  Saving model ...
Epoch: 21 cost time: 1.0977606773376465
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.396 Vali Acc: 0.332 Test Loss: 3.396 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1673204898834229
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.417 Vali Acc: 0.334 Test Loss: 3.417 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1649582386016846
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.440 Vali Acc: 0.338 Test Loss: 3.440 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.147843360900879
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.467 Vali Acc: 0.332 Test Loss: 3.467 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.154186725616455
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.484 Vali Acc: 0.329 Test Loss: 3.484 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.106377363204956
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.510 Vali Acc: 0.335 Test Loss: 3.510 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.140150547027588
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.521 Vali Acc: 0.336 Test Loss: 3.521 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2840769290924072
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.532 Vali Acc: 0.340 Test Loss: 3.532 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.105717420578003
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.548 Vali Acc: 0.339 Test Loss: 3.548 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.112051010131836
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.575 Vali Acc: 0.335 Test Loss: 3.575 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 796306
model size : 4.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.78090763092041
Epoch: 1, Steps: 10 | Train Loss: 3.325 Vali Loss: 3.306 Vali Acc: 0.056 Test Loss: 3.306 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 1.086029291152954
Epoch: 2, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.286 Vali Acc: 0.100 Test Loss: 3.286 Test Acc: 0.100
Validation loss decreased (-0.056438 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 1.0786068439483643
Epoch: 3, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.259 Vali Acc: 0.144 Test Loss: 3.259 Test Acc: 0.144
Validation loss decreased (-0.099967 --> -0.143497).  Saving model ...
Epoch: 4 cost time: 1.1495966911315918
Epoch: 4, Steps: 10 | Train Loss: 2.143 Vali Loss: 3.192 Vali Acc: 0.172 Test Loss: 3.192 Test Acc: 0.172
Validation loss decreased (-0.143497 --> -0.171733).  Saving model ...
Epoch: 5 cost time: 1.2455873489379883
Epoch: 5, Steps: 10 | Train Loss: 1.684 Vali Loss: 3.148 Vali Acc: 0.240 Test Loss: 3.148 Test Acc: 0.240
Validation loss decreased (-0.171733 --> -0.239969).  Saving model ...
Epoch: 6 cost time: 1.330078125
Epoch: 6, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.215 Vali Acc: 0.236 Test Loss: 3.215 Test Acc: 0.236
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.196962594985962
Epoch: 7, Steps: 10 | Train Loss: 0.960 Vali Loss: 3.297 Vali Acc: 0.249 Test Loss: 3.297 Test Acc: 0.249
Validation loss decreased (-0.239969 --> -0.249379).  Saving model ...
Epoch: 8 cost time: 1.2117030620574951
Epoch: 8, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.346 Vali Acc: 0.287 Test Loss: 3.346 Test Acc: 0.287
Validation loss decreased (-0.249379 --> -0.287025).  Saving model ...
Epoch: 9 cost time: 1.1456449031829834
Epoch: 9, Steps: 10 | Train Loss: 0.493 Vali Loss: 3.424 Vali Acc: 0.304 Test Loss: 3.424 Test Acc: 0.304
Validation loss decreased (-0.287025 --> -0.303495).  Saving model ...
Epoch: 10 cost time: 1.0476772785186768
Epoch: 10, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.546 Vali Acc: 0.302 Test Loss: 3.546 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1328270435333252
Epoch: 11, Steps: 10 | Train Loss: 0.206 Vali Loss: 3.639 Vali Acc: 0.308 Test Loss: 3.639 Test Acc: 0.308
Validation loss decreased (-0.303495 --> -0.308199).  Saving model ...
Epoch: 12 cost time: 1.1559736728668213
Epoch: 12, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.656 Vali Acc: 0.322 Test Loss: 3.656 Test Acc: 0.322
Validation loss decreased (-0.308199 --> -0.322316).  Saving model ...
Epoch: 13 cost time: 1.2448616027832031
Epoch: 13, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.806 Vali Acc: 0.324 Test Loss: 3.806 Test Acc: 0.324
Validation loss decreased (-0.322316 --> -0.323491).  Saving model ...
Epoch: 14 cost time: 1.1498043537139893
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.830 Vali Acc: 0.329 Test Loss: 3.830 Test Acc: 0.329
Validation loss decreased (-0.323491 --> -0.329373).  Saving model ...
Epoch: 15 cost time: 1.3537142276763916
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.887 Vali Acc: 0.331 Test Loss: 3.887 Test Acc: 0.331
Validation loss decreased (-0.329373 --> -0.330549).  Saving model ...
Epoch: 16 cost time: 1.120229959487915
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.951 Vali Acc: 0.333 Test Loss: 3.951 Test Acc: 0.333
Validation loss decreased (-0.330549 --> -0.332902).  Saving model ...
Epoch: 17 cost time: 1.0277087688446045
Epoch: 17, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.979 Vali Acc: 0.341 Test Loss: 3.979 Test Acc: 0.341
Validation loss decreased (-0.332902 --> -0.341137).  Saving model ...
Epoch: 18 cost time: 1.2057452201843262
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.013 Vali Acc: 0.339 Test Loss: 4.013 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1462104320526123
Epoch: 19, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.066 Vali Acc: 0.334 Test Loss: 4.066 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.177562952041626
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.091 Vali Acc: 0.329 Test Loss: 4.091 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.082514762878418
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.103 Vali Acc: 0.332 Test Loss: 4.103 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1176910400390625
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.129 Vali Acc: 0.338 Test Loss: 4.129 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2163751125335693
Epoch: 23, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.164 Vali Acc: 0.340 Test Loss: 4.164 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2613844871520996
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.175 Vali Acc: 0.335 Test Loss: 4.175 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.1742298603057861
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.190 Vali Acc: 0.332 Test Loss: 4.190 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9659254550933838
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.206 Vali Acc: 0.334 Test Loss: 4.206 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1330790519714355
Epoch: 27, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.219 Vali Acc: 0.325 Test Loss: 4.219 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 534162
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.86672043800354
Epoch: 1, Steps: 10 | Train Loss: 3.292 Vali Loss: 3.303 Vali Acc: 0.064 Test Loss: 3.303 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 1.186485767364502
Epoch: 2, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.283 Vali Acc: 0.100 Test Loss: 3.283 Test Acc: 0.100
Validation loss decreased (-0.063496 --> -0.099967).  Saving model ...
Epoch: 3 cost time: 1.1929495334625244
Epoch: 3, Steps: 10 | Train Loss: 2.623 Vali Loss: 3.258 Vali Acc: 0.141 Test Loss: 3.258 Test Acc: 0.141
Validation loss decreased (-0.099967 --> -0.141144).  Saving model ...
Epoch: 4 cost time: 1.151472806930542
Epoch: 4, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.192 Vali Acc: 0.176 Test Loss: 3.192 Test Acc: 0.176
Validation loss decreased (-0.141144 --> -0.176439).  Saving model ...
Epoch: 5 cost time: 1.0717501640319824
Epoch: 5, Steps: 10 | Train Loss: 1.734 Vali Loss: 3.137 Vali Acc: 0.236 Test Loss: 3.137 Test Acc: 0.236
Validation loss decreased (-0.176439 --> -0.236439).  Saving model ...
Epoch: 6 cost time: 1.0566678047180176
Epoch: 6, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.187 Vali Acc: 0.239 Test Loss: 3.187 Test Acc: 0.239
Validation loss decreased (-0.236439 --> -0.238792).  Saving model ...
Epoch: 7 cost time: 1.132115125656128
Epoch: 7, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.259 Vali Acc: 0.266 Test Loss: 3.259 Test Acc: 0.266
Validation loss decreased (-0.238792 --> -0.265850).  Saving model ...
Epoch: 8 cost time: 1.1363914012908936
Epoch: 8, Steps: 10 | Train Loss: 0.730 Vali Loss: 3.306 Vali Acc: 0.287 Test Loss: 3.306 Test Acc: 0.287
Validation loss decreased (-0.265850 --> -0.287026).  Saving model ...
Epoch: 9 cost time: 1.2368383407592773
Epoch: 9, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.378 Vali Acc: 0.302 Test Loss: 3.378 Test Acc: 0.302
Validation loss decreased (-0.287026 --> -0.302319).  Saving model ...
Epoch: 10 cost time: 1.1639001369476318
Epoch: 10, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.472 Vali Acc: 0.301 Test Loss: 3.472 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2127182483673096
Epoch: 11, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.547 Vali Acc: 0.305 Test Loss: 3.547 Test Acc: 0.305
Validation loss decreased (-0.302319 --> -0.304670).  Saving model ...
Epoch: 12 cost time: 0.9488427639007568
Epoch: 12, Steps: 10 | Train Loss: 0.170 Vali Loss: 3.557 Vali Acc: 0.324 Test Loss: 3.557 Test Acc: 0.324
Validation loss decreased (-0.304670 --> -0.323494).  Saving model ...
Epoch: 13 cost time: 1.126636266708374
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.724 Vali Acc: 0.321 Test Loss: 3.724 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0402379035949707
Epoch: 14, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.724 Vali Acc: 0.326 Test Loss: 3.724 Test Acc: 0.326
Validation loss decreased (-0.323494 --> -0.325845).  Saving model ...
Epoch: 15 cost time: 1.0100481510162354
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.787 Vali Acc: 0.325 Test Loss: 3.787 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1181068420410156
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.833 Vali Acc: 0.328 Test Loss: 3.833 Test Acc: 0.328
Validation loss decreased (-0.325845 --> -0.328197).  Saving model ...
Epoch: 17 cost time: 1.030099868774414
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.878 Vali Acc: 0.334 Test Loss: 3.878 Test Acc: 0.334
Validation loss decreased (-0.328197 --> -0.334079).  Saving model ...
Epoch: 18 cost time: 0.9654421806335449
Epoch: 18, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.908 Vali Acc: 0.328 Test Loss: 3.908 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0216355323791504
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.946 Vali Acc: 0.326 Test Loss: 3.946 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0869131088256836
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.977 Vali Acc: 0.322 Test Loss: 3.977 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.068657398223877
Epoch: 21, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.996 Vali Acc: 0.325 Test Loss: 3.996 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.054652452468872
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.012 Vali Acc: 0.327 Test Loss: 4.012 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1268301010131836
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.038 Vali Acc: 0.331 Test Loss: 4.038 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1574029922485352
Epoch: 24, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.050 Vali Acc: 0.335 Test Loss: 4.050 Test Acc: 0.335
Validation loss decreased (-0.334079 --> -0.335254).  Saving model ...
Epoch: 25 cost time: 1.0630061626434326
Epoch: 25, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.074 Vali Acc: 0.332 Test Loss: 4.074 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9999635219573975
Epoch: 26, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.097 Vali Acc: 0.328 Test Loss: 4.097 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.1478245258331299
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.111 Vali Acc: 0.329 Test Loss: 4.111 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1304123401641846
Epoch: 28, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.129 Vali Acc: 0.331 Test Loss: 4.129 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.2237401008605957
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.137 Vali Acc: 0.331 Test Loss: 4.137 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.2000718116760254
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.143 Vali Acc: 0.334 Test Loss: 4.143 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2098309993743896
Epoch: 31, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.158 Vali Acc: 0.335 Test Loss: 4.158 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.2596032619476318
Epoch: 32, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.173 Vali Acc: 0.332 Test Loss: 4.173 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.1968209743499756
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.197 Vali Acc: 0.333 Test Loss: 4.197 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.1513876914978027
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.220 Vali Acc: 0.328 Test Loss: 4.220 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 534162
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8740930557250977
Epoch: 1, Steps: 10 | Train Loss: 3.260 Vali Loss: 3.293 Vali Acc: 0.052 Test Loss: 3.293 Test Acc: 0.052
Validation loss decreased (inf --> -0.051732).  Saving model ...
Epoch: 2 cost time: 0.9459779262542725
Epoch: 2, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.274 Vali Acc: 0.106 Test Loss: 3.274 Test Acc: 0.106
Validation loss decreased (-0.051732 --> -0.105850).  Saving model ...
Epoch: 3 cost time: 1.033212423324585
Epoch: 3, Steps: 10 | Train Loss: 2.650 Vali Loss: 3.253 Vali Acc: 0.139 Test Loss: 3.253 Test Acc: 0.139
Validation loss decreased (-0.105850 --> -0.138791).  Saving model ...
Epoch: 4 cost time: 0.9358084201812744
Epoch: 4, Steps: 10 | Train Loss: 2.232 Vali Loss: 3.187 Vali Acc: 0.172 Test Loss: 3.187 Test Acc: 0.172
Validation loss decreased (-0.138791 --> -0.171733).  Saving model ...
Epoch: 5 cost time: 0.9025375843048096
Epoch: 5, Steps: 10 | Train Loss: 1.812 Vali Loss: 3.116 Vali Acc: 0.220 Test Loss: 3.116 Test Acc: 0.220
Validation loss decreased (-0.171733 --> -0.219969).  Saving model ...
Epoch: 6 cost time: 0.854811429977417
Epoch: 6, Steps: 10 | Train Loss: 1.413 Vali Loss: 3.135 Vali Acc: 0.245 Test Loss: 3.135 Test Acc: 0.245
Validation loss decreased (-0.219969 --> -0.244675).  Saving model ...
Epoch: 7 cost time: 0.9681053161621094
Epoch: 7, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.180 Vali Acc: 0.245 Test Loss: 3.180 Test Acc: 0.245
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9504010677337646
Epoch: 8, Steps: 10 | Train Loss: 0.751 Vali Loss: 3.213 Vali Acc: 0.278 Test Loss: 3.213 Test Acc: 0.278
Validation loss decreased (-0.244675 --> -0.277615).  Saving model ...
Epoch: 9 cost time: 1.0245559215545654
Epoch: 9, Steps: 10 | Train Loss: 0.545 Vali Loss: 3.271 Vali Acc: 0.301 Test Loss: 3.271 Test Acc: 0.301
Validation loss decreased (-0.277615 --> -0.301144).  Saving model ...
Epoch: 10 cost time: 0.9865894317626953
Epoch: 10, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.342 Vali Acc: 0.296 Test Loss: 3.342 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.138767957687378
Epoch: 11, Steps: 10 | Train Loss: 0.225 Vali Loss: 3.402 Vali Acc: 0.302 Test Loss: 3.402 Test Acc: 0.302
Validation loss decreased (-0.301144 --> -0.302319).  Saving model ...
Epoch: 12 cost time: 1.0130841732025146
Epoch: 12, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.453 Vali Acc: 0.334 Test Loss: 3.453 Test Acc: 0.334
Validation loss decreased (-0.302319 --> -0.334083).  Saving model ...
Epoch: 13 cost time: 1.092564582824707
Epoch: 13, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.593 Vali Acc: 0.314 Test Loss: 3.593 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0289971828460693
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.570 Vali Acc: 0.331 Test Loss: 3.570 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0198216438293457
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.618 Vali Acc: 0.331 Test Loss: 3.618 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0313513278961182
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.666 Vali Acc: 0.328 Test Loss: 3.666 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9629392623901367
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.727 Vali Acc: 0.321 Test Loss: 3.727 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0321924686431885
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.731 Vali Acc: 0.326 Test Loss: 3.731 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.062887191772461
Epoch: 19, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.747 Vali Acc: 0.325 Test Loss: 3.747 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0453624725341797
Epoch: 20, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.775 Vali Acc: 0.324 Test Loss: 3.775 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.037388563156128
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.784 Vali Acc: 0.322 Test Loss: 3.784 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.120251178741455
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.799 Vali Acc: 0.329 Test Loss: 3.799 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 534162
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4539058208465576
Epoch: 1, Steps: 10 | Train Loss: 3.246 Vali Loss: 3.256 Vali Acc: 0.060 Test Loss: 3.256 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.9271628856658936
Epoch: 2, Steps: 10 | Train Loss: 3.095 Vali Loss: 3.232 Vali Acc: 0.081 Test Loss: 3.232 Test Acc: 0.081
Validation loss decreased (-0.059967 --> -0.081144).  Saving model ...
Epoch: 3 cost time: 1.0160021781921387
Epoch: 3, Steps: 10 | Train Loss: 2.769 Vali Loss: 3.219 Vali Acc: 0.132 Test Loss: 3.219 Test Acc: 0.132
Validation loss decreased (-0.081144 --> -0.131733).  Saving model ...
Epoch: 4 cost time: 0.9425671100616455
Epoch: 4, Steps: 10 | Train Loss: 2.409 Vali Loss: 3.163 Vali Acc: 0.151 Test Loss: 3.163 Test Acc: 0.151
Validation loss decreased (-0.131733 --> -0.150557).  Saving model ...
Epoch: 5 cost time: 1.0914711952209473
Epoch: 5, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.056 Vali Acc: 0.211 Test Loss: 3.056 Test Acc: 0.211
Validation loss decreased (-0.150557 --> -0.210558).  Saving model ...
Epoch: 6 cost time: 1.0133335590362549
Epoch: 6, Steps: 10 | Train Loss: 1.658 Vali Loss: 3.015 Vali Acc: 0.224 Test Loss: 3.015 Test Acc: 0.224
Validation loss decreased (-0.210558 --> -0.223499).  Saving model ...
Epoch: 7 cost time: 1.0804705619812012
Epoch: 7, Steps: 10 | Train Loss: 1.320 Vali Loss: 3.009 Vali Acc: 0.246 Test Loss: 3.009 Test Acc: 0.246
Validation loss decreased (-0.223499 --> -0.245852).  Saving model ...
Epoch: 8 cost time: 0.9956254959106445
Epoch: 8, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.008 Vali Acc: 0.262 Test Loss: 3.008 Test Acc: 0.262
Validation loss decreased (-0.245852 --> -0.262323).  Saving model ...
Epoch: 9 cost time: 0.9161512851715088
Epoch: 9, Steps: 10 | Train Loss: 0.713 Vali Loss: 3.024 Vali Acc: 0.274 Test Loss: 3.024 Test Acc: 0.274
Validation loss decreased (-0.262323 --> -0.274087).  Saving model ...
Epoch: 10 cost time: 1.0135598182678223
Epoch: 10, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.040 Vali Acc: 0.299 Test Loss: 3.040 Test Acc: 0.299
Validation loss decreased (-0.274087 --> -0.298793).  Saving model ...
Epoch: 11 cost time: 1.1568710803985596
Epoch: 11, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.081 Vali Acc: 0.309 Test Loss: 3.081 Test Acc: 0.309
Validation loss decreased (-0.298793 --> -0.309381).  Saving model ...
Epoch: 12 cost time: 1.2373285293579102
Epoch: 12, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.130 Vali Acc: 0.325 Test Loss: 3.130 Test Acc: 0.325
Validation loss decreased (-0.309381 --> -0.324675).  Saving model ...
Epoch: 13 cost time: 1.2738795280456543
Epoch: 13, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.253 Vali Acc: 0.302 Test Loss: 3.253 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1964695453643799
Epoch: 14, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.250 Vali Acc: 0.312 Test Loss: 3.250 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2752070426940918
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.281 Vali Acc: 0.325 Test Loss: 3.281 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.151759386062622
Epoch: 16, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.294 Vali Acc: 0.318 Test Loss: 3.294 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9898264408111572
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.347 Vali Acc: 0.320 Test Loss: 3.347 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1574304103851318
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.364 Vali Acc: 0.326 Test Loss: 3.364 Test Acc: 0.326
Validation loss decreased (-0.324675 --> -0.325849).  Saving model ...
Epoch: 19 cost time: 1.1593215465545654
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.394 Vali Acc: 0.329 Test Loss: 3.394 Test Acc: 0.329
Validation loss decreased (-0.325849 --> -0.329378).  Saving model ...
Epoch: 20 cost time: 1.190434217453003
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.408 Vali Acc: 0.334 Test Loss: 3.408 Test Acc: 0.334
Validation loss decreased (-0.329378 --> -0.334084).  Saving model ...
Epoch: 21 cost time: 1.097977876663208
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.422 Vali Acc: 0.328 Test Loss: 3.422 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.171844482421875
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.443 Vali Acc: 0.327 Test Loss: 3.443 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1812331676483154
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.467 Vali Acc: 0.328 Test Loss: 3.467 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.166609764099121
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.479 Vali Acc: 0.331 Test Loss: 3.479 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.061922550201416
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.494 Vali Acc: 0.327 Test Loss: 3.494 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0862419605255127
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.515 Vali Acc: 0.327 Test Loss: 3.515 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.0807266235351562
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.530 Vali Acc: 0.331 Test Loss: 3.530 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.1845166683197021
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.549 Vali Acc: 0.328 Test Loss: 3.549 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0992705821990967
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.572 Vali Acc: 0.325 Test Loss: 3.572 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.050199031829834
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.592 Vali Acc: 0.328 Test Loss: 3.592 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 534162
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.682825803756714
Epoch: 1, Steps: 10 | Train Loss: 3.407 Vali Loss: 3.323 Vali Acc: 0.054 Test Loss: 3.323 Test Acc: 0.054
Validation loss decreased (inf --> -0.054084).  Saving model ...
Epoch: 2 cost time: 1.1161096096038818
Epoch: 2, Steps: 10 | Train Loss: 3.061 Vali Loss: 3.307 Vali Acc: 0.075 Test Loss: 3.307 Test Acc: 0.075
Validation loss decreased (-0.054084 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 1.0711653232574463
Epoch: 3, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.263 Vali Acc: 0.134 Test Loss: 3.263 Test Acc: 0.134
Validation loss decreased (-0.075261 --> -0.134085).  Saving model ...
Epoch: 4 cost time: 1.1944985389709473
Epoch: 4, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.183 Vali Acc: 0.188 Test Loss: 3.183 Test Acc: 0.188
Validation loss decreased (-0.134085 --> -0.188203).  Saving model ...
Epoch: 5 cost time: 0.9699456691741943
Epoch: 5, Steps: 10 | Train Loss: 1.680 Vali Loss: 3.144 Vali Acc: 0.220 Test Loss: 3.144 Test Acc: 0.220
Validation loss decreased (-0.188203 --> -0.219969).  Saving model ...
Epoch: 6 cost time: 1.1581380367279053
Epoch: 6, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.227 Vali Acc: 0.235 Test Loss: 3.227 Test Acc: 0.235
Validation loss decreased (-0.219969 --> -0.235262).  Saving model ...
Epoch: 7 cost time: 1.250370740890503
Epoch: 7, Steps: 10 | Train Loss: 0.963 Vali Loss: 3.247 Vali Acc: 0.255 Test Loss: 3.247 Test Acc: 0.255
Validation loss decreased (-0.235262 --> -0.255262).  Saving model ...
Epoch: 8 cost time: 1.0570027828216553
Epoch: 8, Steps: 10 | Train Loss: 0.722 Vali Loss: 3.346 Vali Acc: 0.282 Test Loss: 3.346 Test Acc: 0.282
Validation loss decreased (-0.255262 --> -0.282319).  Saving model ...
Epoch: 9 cost time: 0.9242386817932129
Epoch: 9, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.419 Vali Acc: 0.288 Test Loss: 3.419 Test Acc: 0.288
Validation loss decreased (-0.282319 --> -0.288201).  Saving model ...
Epoch: 10 cost time: 1.0074973106384277
Epoch: 10, Steps: 10 | Train Loss: 0.333 Vali Loss: 3.499 Vali Acc: 0.300 Test Loss: 3.499 Test Acc: 0.300
Validation loss decreased (-0.288201 --> -0.299965).  Saving model ...
Epoch: 11 cost time: 1.0984015464782715
Epoch: 11, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.532 Vali Acc: 0.309 Test Loss: 3.532 Test Acc: 0.309
Validation loss decreased (-0.299965 --> -0.309376).  Saving model ...
Epoch: 12 cost time: 1.0988032817840576
Epoch: 12, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.746 Vali Acc: 0.316 Test Loss: 3.746 Test Acc: 0.316
Validation loss decreased (-0.309376 --> -0.316433).  Saving model ...
Epoch: 13 cost time: 1.044055461883545
Epoch: 13, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.836 Vali Acc: 0.321 Test Loss: 3.836 Test Acc: 0.321
Validation loss decreased (-0.316433 --> -0.321138).  Saving model ...
Epoch: 14 cost time: 1.1702418327331543
Epoch: 14, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.837 Vali Acc: 0.338 Test Loss: 3.837 Test Acc: 0.338
Validation loss decreased (-0.321138 --> -0.337609).  Saving model ...
Epoch: 15 cost time: 1.0611217021942139
Epoch: 15, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.905 Vali Acc: 0.333 Test Loss: 3.905 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9765136241912842
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.995 Vali Acc: 0.328 Test Loss: 3.995 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0130646228790283
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.083 Vali Acc: 0.322 Test Loss: 4.083 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9832048416137695
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.105 Vali Acc: 0.327 Test Loss: 4.105 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0924227237701416
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.145 Vali Acc: 0.333 Test Loss: 4.145 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1943492889404297
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.174 Vali Acc: 0.331 Test Loss: 4.174 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0236666202545166
Epoch: 21, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.206 Vali Acc: 0.328 Test Loss: 4.206 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0372998714447021
Epoch: 22, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.224 Vali Acc: 0.333 Test Loss: 4.224 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9921784400939941
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.241 Vali Acc: 0.328 Test Loss: 4.241 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1110422611236572
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.246 Vali Acc: 0.338 Test Loss: 4.246 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 403090
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7997450828552246
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.297 Vali Acc: 0.048 Test Loss: 3.297 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 1.076073408126831
Epoch: 2, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.284 Vali Acc: 0.080 Test Loss: 3.284 Test Acc: 0.080
Validation loss decreased (-0.048202 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 1.0670828819274902
Epoch: 3, Steps: 10 | Train Loss: 2.583 Vali Loss: 3.243 Vali Acc: 0.135 Test Loss: 3.243 Test Acc: 0.135
Validation loss decreased (-0.079967 --> -0.135262).  Saving model ...
Epoch: 4 cost time: 1.0763404369354248
Epoch: 4, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.167 Vali Acc: 0.194 Test Loss: 3.167 Test Acc: 0.194
Validation loss decreased (-0.135262 --> -0.194086).  Saving model ...
Epoch: 5 cost time: 1.087944746017456
Epoch: 5, Steps: 10 | Train Loss: 1.722 Vali Loss: 3.120 Vali Acc: 0.229 Test Loss: 3.120 Test Acc: 0.229
Validation loss decreased (-0.194086 --> -0.229381).  Saving model ...
Epoch: 6 cost time: 1.0959858894348145
Epoch: 6, Steps: 10 | Train Loss: 1.337 Vali Loss: 3.191 Vali Acc: 0.240 Test Loss: 3.191 Test Acc: 0.240
Validation loss decreased (-0.229381 --> -0.239968).  Saving model ...
Epoch: 7 cost time: 0.9246900081634521
Epoch: 7, Steps: 10 | Train Loss: 1.012 Vali Loss: 3.204 Vali Acc: 0.260 Test Loss: 3.204 Test Acc: 0.260
Validation loss decreased (-0.239968 --> -0.259968).  Saving model ...
Epoch: 8 cost time: 0.9530389308929443
Epoch: 8, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.292 Vali Acc: 0.289 Test Loss: 3.292 Test Acc: 0.289
Validation loss decreased (-0.259968 --> -0.289379).  Saving model ...
Epoch: 9 cost time: 0.938317060470581
Epoch: 9, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.364 Vali Acc: 0.295 Test Loss: 3.364 Test Acc: 0.295
Validation loss decreased (-0.289379 --> -0.295260).  Saving model ...
Epoch: 10 cost time: 1.0091049671173096
Epoch: 10, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.436 Vali Acc: 0.301 Test Loss: 3.436 Test Acc: 0.301
Validation loss decreased (-0.295260 --> -0.301142).  Saving model ...
Epoch: 11 cost time: 0.9921865463256836
Epoch: 11, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.472 Vali Acc: 0.314 Test Loss: 3.472 Test Acc: 0.314
Validation loss decreased (-0.301142 --> -0.314083).  Saving model ...
Epoch: 12 cost time: 0.9449214935302734
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.650 Vali Acc: 0.309 Test Loss: 3.650 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0274062156677246
Epoch: 13, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.725 Vali Acc: 0.321 Test Loss: 3.725 Test Acc: 0.321
Validation loss decreased (-0.314083 --> -0.321139).  Saving model ...
Epoch: 14 cost time: 1.025439977645874
Epoch: 14, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.747 Vali Acc: 0.320 Test Loss: 3.747 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1031882762908936
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.807 Vali Acc: 0.321 Test Loss: 3.807 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9848160743713379
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.917 Vali Acc: 0.321 Test Loss: 3.917 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9404349327087402
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.989 Vali Acc: 0.316 Test Loss: 3.989 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.905991792678833
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.007 Vali Acc: 0.315 Test Loss: 4.007 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0371019840240479
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.040 Vali Acc: 0.320 Test Loss: 4.040 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.0282304286956787
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.079 Vali Acc: 0.318 Test Loss: 4.079 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1006300449371338
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.103 Vali Acc: 0.324 Test Loss: 4.103 Test Acc: 0.324
Validation loss decreased (-0.321139 --> -0.323488).  Saving model ...
Epoch: 22 cost time: 1.093628168106079
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.132 Vali Acc: 0.322 Test Loss: 4.132 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0445094108581543
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.134 Vali Acc: 0.325 Test Loss: 4.134 Test Acc: 0.325
Validation loss decreased (-0.323488 --> -0.324665).  Saving model ...
Epoch: 24 cost time: 1.019563913345337
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.142 Vali Acc: 0.328 Test Loss: 4.142 Test Acc: 0.328
Validation loss decreased (-0.324665 --> -0.328194).  Saving model ...
Epoch: 25 cost time: 1.0525569915771484
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.159 Vali Acc: 0.333 Test Loss: 4.159 Test Acc: 0.333
Validation loss decreased (-0.328194 --> -0.332900).  Saving model ...
Epoch: 26 cost time: 1.063133955001831
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.183 Vali Acc: 0.331 Test Loss: 4.183 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.122852087020874
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.208 Vali Acc: 0.331 Test Loss: 4.208 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.0980849266052246
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.224 Vali Acc: 0.326 Test Loss: 4.224 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0431759357452393
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.236 Vali Acc: 0.327 Test Loss: 4.236 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1495287418365479
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.246 Vali Acc: 0.326 Test Loss: 4.246 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0043129920959473
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.269 Vali Acc: 0.326 Test Loss: 4.269 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9859871864318848
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.297 Vali Acc: 0.329 Test Loss: 4.297 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9068875312805176
Epoch: 33, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.315 Vali Acc: 0.331 Test Loss: 4.315 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9782452583312988
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.332 Vali Acc: 0.328 Test Loss: 4.332 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9802970886230469
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.349 Vali Acc: 0.331 Test Loss: 4.349 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 403090
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.745271682739258
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.282 Vali Acc: 0.053 Test Loss: 3.282 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.9241223335266113
Epoch: 2, Steps: 10 | Train Loss: 3.067 Vali Loss: 3.265 Vali Acc: 0.076 Test Loss: 3.265 Test Acc: 0.076
Validation loss decreased (-0.052908 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 1.0587642192840576
Epoch: 3, Steps: 10 | Train Loss: 2.638 Vali Loss: 3.233 Vali Acc: 0.132 Test Loss: 3.233 Test Acc: 0.132
Validation loss decreased (-0.076438 --> -0.131732).  Saving model ...
Epoch: 4 cost time: 0.9406118392944336
Epoch: 4, Steps: 10 | Train Loss: 2.221 Vali Loss: 3.157 Vali Acc: 0.180 Test Loss: 3.157 Test Acc: 0.180
Validation loss decreased (-0.131732 --> -0.179968).  Saving model ...
Epoch: 5 cost time: 0.878718376159668
Epoch: 5, Steps: 10 | Train Loss: 1.814 Vali Loss: 3.085 Vali Acc: 0.234 Test Loss: 3.085 Test Acc: 0.234
Validation loss decreased (-0.179968 --> -0.234087).  Saving model ...
Epoch: 6 cost time: 0.94862961769104
Epoch: 6, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.129 Vali Acc: 0.246 Test Loss: 3.129 Test Acc: 0.246
Validation loss decreased (-0.234087 --> -0.245851).  Saving model ...
Epoch: 7 cost time: 0.9255437850952148
Epoch: 7, Steps: 10 | Train Loss: 1.092 Vali Loss: 3.135 Vali Acc: 0.254 Test Loss: 3.135 Test Acc: 0.254
Validation loss decreased (-0.245851 --> -0.254086).  Saving model ...
Epoch: 8 cost time: 1.0416924953460693
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.205 Vali Acc: 0.279 Test Loss: 3.205 Test Acc: 0.279
Validation loss decreased (-0.254086 --> -0.278791).  Saving model ...
Epoch: 9 cost time: 1.214421033859253
Epoch: 9, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.253 Vali Acc: 0.293 Test Loss: 3.253 Test Acc: 0.293
Validation loss decreased (-0.278791 --> -0.292909).  Saving model ...
Epoch: 10 cost time: 1.0660908222198486
Epoch: 10, Steps: 10 | Train Loss: 0.365 Vali Loss: 3.313 Vali Acc: 0.309 Test Loss: 3.313 Test Acc: 0.309
Validation loss decreased (-0.292909 --> -0.309379).  Saving model ...
Epoch: 11 cost time: 1.1185989379882812
Epoch: 11, Steps: 10 | Train Loss: 0.252 Vali Loss: 3.348 Vali Acc: 0.316 Test Loss: 3.348 Test Acc: 0.316
Validation loss decreased (-0.309379 --> -0.316437).  Saving model ...
Epoch: 12 cost time: 1.13433837890625
Epoch: 12, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.480 Vali Acc: 0.314 Test Loss: 3.480 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.097546100616455
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.579 Vali Acc: 0.321 Test Loss: 3.579 Test Acc: 0.321
Validation loss decreased (-0.316437 --> -0.321141).  Saving model ...
Epoch: 14 cost time: 1.2019109725952148
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.584 Vali Acc: 0.335 Test Loss: 3.584 Test Acc: 0.335
Validation loss decreased (-0.321141 --> -0.335258).  Saving model ...
Epoch: 15 cost time: 1.060487985610962
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.610 Vali Acc: 0.333 Test Loss: 3.610 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1331212520599365
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.682 Vali Acc: 0.331 Test Loss: 3.682 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9962329864501953
Epoch: 17, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.754 Vali Acc: 0.329 Test Loss: 3.754 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.077756404876709
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.796 Vali Acc: 0.326 Test Loss: 3.796 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.041079044342041
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.825 Vali Acc: 0.332 Test Loss: 3.825 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0600249767303467
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.837 Vali Acc: 0.331 Test Loss: 3.837 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1039204597473145
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.856 Vali Acc: 0.333 Test Loss: 3.856 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1086575984954834
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.878 Vali Acc: 0.339 Test Loss: 3.878 Test Acc: 0.339
Validation loss decreased (-0.335258 --> -0.338785).  Saving model ...
Epoch: 23 cost time: 0.9935665130615234
Epoch: 23, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.897 Vali Acc: 0.336 Test Loss: 3.897 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9499614238739014
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.917 Vali Acc: 0.336 Test Loss: 3.917 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0116400718688965
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.928 Vali Acc: 0.331 Test Loss: 3.928 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.885474681854248
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.943 Vali Acc: 0.332 Test Loss: 3.943 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8968446254730225
Epoch: 27, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.962 Vali Acc: 0.332 Test Loss: 3.962 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9714620113372803
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.985 Vali Acc: 0.335 Test Loss: 3.985 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0041272640228271
Epoch: 29, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.000 Vali Acc: 0.333 Test Loss: 4.000 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1045048236846924
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.011 Vali Acc: 0.332 Test Loss: 4.011 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0047495365142822
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.030 Vali Acc: 0.334 Test Loss: 4.030 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.0238838195800781
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.054 Vali Acc: 0.331 Test Loss: 4.054 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 403090
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.635005474090576
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.264 Vali Acc: 0.044 Test Loss: 3.264 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.91634202003479
Epoch: 2, Steps: 10 | Train Loss: 3.097 Vali Loss: 3.242 Vali Acc: 0.080 Test Loss: 3.242 Test Acc: 0.080
Validation loss decreased (-0.043497 --> -0.079968).  Saving model ...
Epoch: 3 cost time: 0.914872407913208
Epoch: 3, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.217 Vali Acc: 0.128 Test Loss: 3.217 Test Acc: 0.128
Validation loss decreased (-0.079968 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 1.0545878410339355
Epoch: 4, Steps: 10 | Train Loss: 2.419 Vali Loss: 3.154 Vali Acc: 0.165 Test Loss: 3.154 Test Acc: 0.165
Validation loss decreased (-0.128203 --> -0.164674).  Saving model ...
Epoch: 5 cost time: 0.9727883338928223
Epoch: 5, Steps: 10 | Train Loss: 2.043 Vali Loss: 3.047 Vali Acc: 0.209 Test Loss: 3.047 Test Acc: 0.209
Validation loss decreased (-0.164674 --> -0.209381).  Saving model ...
Epoch: 6 cost time: 0.9780583381652832
Epoch: 6, Steps: 10 | Train Loss: 1.655 Vali Loss: 3.025 Vali Acc: 0.233 Test Loss: 3.025 Test Acc: 0.233
Validation loss decreased (-0.209381 --> -0.232911).  Saving model ...
Epoch: 7 cost time: 0.9349634647369385
Epoch: 7, Steps: 10 | Train Loss: 1.325 Vali Loss: 2.995 Vali Acc: 0.241 Test Loss: 2.995 Test Acc: 0.241
Validation loss decreased (-0.232911 --> -0.241147).  Saving model ...
Epoch: 8 cost time: 0.9073319435119629
Epoch: 8, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.006 Vali Acc: 0.268 Test Loss: 3.006 Test Acc: 0.268
Validation loss decreased (-0.241147 --> -0.268205).  Saving model ...
Epoch: 9 cost time: 0.9357442855834961
Epoch: 9, Steps: 10 | Train Loss: 0.731 Vali Loss: 3.005 Vali Acc: 0.288 Test Loss: 3.005 Test Acc: 0.288
Validation loss decreased (-0.268205 --> -0.288205).  Saving model ...
Epoch: 10 cost time: 0.9404458999633789
Epoch: 10, Steps: 10 | Train Loss: 0.487 Vali Loss: 3.034 Vali Acc: 0.298 Test Loss: 3.034 Test Acc: 0.298
Validation loss decreased (-0.288205 --> -0.297617).  Saving model ...
Epoch: 11 cost time: 0.9870264530181885
Epoch: 11, Steps: 10 | Train Loss: 0.334 Vali Loss: 3.071 Vali Acc: 0.312 Test Loss: 3.071 Test Acc: 0.312
Validation loss decreased (-0.297617 --> -0.311734).  Saving model ...
Epoch: 12 cost time: 1.0276641845703125
Epoch: 12, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.142 Vali Acc: 0.306 Test Loss: 3.142 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1005268096923828
Epoch: 13, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.221 Vali Acc: 0.319 Test Loss: 3.221 Test Acc: 0.319
Validation loss decreased (-0.311734 --> -0.318791).  Saving model ...
Epoch: 14 cost time: 1.0302910804748535
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.258 Vali Acc: 0.325 Test Loss: 3.258 Test Acc: 0.325
Validation loss decreased (-0.318791 --> -0.324673).  Saving model ...
Epoch: 15 cost time: 0.8931593894958496
Epoch: 15, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.293 Vali Acc: 0.329 Test Loss: 3.293 Test Acc: 0.329
Validation loss decreased (-0.324673 --> -0.329379).  Saving model ...
Epoch: 16 cost time: 1.0684163570404053
Epoch: 16, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.357 Vali Acc: 0.318 Test Loss: 3.357 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.956451416015625
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.392 Vali Acc: 0.325 Test Loss: 3.392 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8542611598968506
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.395 Vali Acc: 0.324 Test Loss: 3.395 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8248639106750488
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.412 Vali Acc: 0.313 Test Loss: 3.412 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8848042488098145
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.430 Vali Acc: 0.329 Test Loss: 3.430 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9900460243225098
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.469 Vali Acc: 0.324 Test Loss: 3.469 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.0153803825378418
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.497 Vali Acc: 0.328 Test Loss: 3.497 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9975097179412842
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.516 Vali Acc: 0.327 Test Loss: 3.516 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0843429565429688
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.520 Vali Acc: 0.327 Test Loss: 3.520 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.0742177963256836
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.517 Vali Acc: 0.322 Test Loss: 3.517 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 403090
model size : 2.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7704718112945557
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.372 Vali Acc: 0.035 Test Loss: 3.372 Test Acc: 0.035
Validation loss decreased (inf --> -0.035260).  Saving model ...
Epoch: 2 cost time: 0.9376645088195801
Epoch: 2, Steps: 10 | Train Loss: 3.096 Vali Loss: 3.311 Vali Acc: 0.085 Test Loss: 3.311 Test Acc: 0.085
Validation loss decreased (-0.035260 --> -0.084673).  Saving model ...
Epoch: 3 cost time: 0.8830995559692383
Epoch: 3, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.279 Vali Acc: 0.122 Test Loss: 3.279 Test Acc: 0.122
Validation loss decreased (-0.084673 --> -0.122320).  Saving model ...
Epoch: 4 cost time: 0.8965590000152588
Epoch: 4, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.198 Vali Acc: 0.161 Test Loss: 3.198 Test Acc: 0.161
Validation loss decreased (-0.122320 --> -0.161144).  Saving model ...
Epoch: 5 cost time: 0.8406131267547607
Epoch: 5, Steps: 10 | Train Loss: 1.701 Vali Loss: 3.180 Vali Acc: 0.202 Test Loss: 3.180 Test Acc: 0.202
Validation loss decreased (-0.161144 --> -0.202321).  Saving model ...
Epoch: 6 cost time: 0.9553864002227783
Epoch: 6, Steps: 10 | Train Loss: 1.359 Vali Loss: 3.199 Vali Acc: 0.236 Test Loss: 3.199 Test Acc: 0.236
Validation loss decreased (-0.202321 --> -0.236439).  Saving model ...
Epoch: 7 cost time: 1.0705232620239258
Epoch: 7, Steps: 10 | Train Loss: 1.003 Vali Loss: 3.275 Vali Acc: 0.246 Test Loss: 3.275 Test Acc: 0.246
Validation loss decreased (-0.236439 --> -0.245850).  Saving model ...
Epoch: 8 cost time: 0.8860964775085449
Epoch: 8, Steps: 10 | Train Loss: 0.734 Vali Loss: 3.371 Vali Acc: 0.267 Test Loss: 3.371 Test Acc: 0.267
Validation loss decreased (-0.245850 --> -0.267025).  Saving model ...
Epoch: 9 cost time: 0.8932065963745117
Epoch: 9, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.447 Vali Acc: 0.286 Test Loss: 3.447 Test Acc: 0.286
Validation loss decreased (-0.267025 --> -0.285848).  Saving model ...
Epoch: 10 cost time: 0.9935104846954346
Epoch: 10, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.482 Vali Acc: 0.299 Test Loss: 3.482 Test Acc: 0.299
Validation loss decreased (-0.285848 --> -0.298789).  Saving model ...
Epoch: 11 cost time: 1.0039937496185303
Epoch: 11, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.632 Vali Acc: 0.302 Test Loss: 3.632 Test Acc: 0.302
Validation loss decreased (-0.298789 --> -0.302317).  Saving model ...
Epoch: 12 cost time: 0.8854365348815918
Epoch: 12, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.632 Vali Acc: 0.320 Test Loss: 3.632 Test Acc: 0.320
Validation loss decreased (-0.302317 --> -0.319964).  Saving model ...
Epoch: 13 cost time: 1.0394372940063477
Epoch: 13, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.742 Vali Acc: 0.326 Test Loss: 3.742 Test Acc: 0.326
Validation loss decreased (-0.319964 --> -0.325845).  Saving model ...
Epoch: 14 cost time: 1.106490135192871
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.973 Vali Acc: 0.318 Test Loss: 3.973 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.864417552947998
Epoch: 15, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.976 Vali Acc: 0.328 Test Loss: 3.976 Test Acc: 0.328
Validation loss decreased (-0.325845 --> -0.328196).  Saving model ...
Epoch: 16 cost time: 1.1140704154968262
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.029 Vali Acc: 0.324 Test Loss: 4.029 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.123222827911377
Epoch: 17, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.073 Vali Acc: 0.325 Test Loss: 4.073 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0851225852966309
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.107 Vali Acc: 0.332 Test Loss: 4.107 Test Acc: 0.332
Validation loss decreased (-0.328196 --> -0.331724).  Saving model ...
Epoch: 19 cost time: 1.1365911960601807
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.186 Vali Acc: 0.321 Test Loss: 4.186 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1387791633605957
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.212 Vali Acc: 0.320 Test Loss: 4.212 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.132235050201416
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.221 Vali Acc: 0.336 Test Loss: 4.221 Test Acc: 0.336
Validation loss decreased (-0.331724 --> -0.336428).  Saving model ...
Epoch: 22 cost time: 1.1584205627441406
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.242 Vali Acc: 0.335 Test Loss: 4.242 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1850755214691162
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.267 Vali Acc: 0.328 Test Loss: 4.267 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1226470470428467
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.309 Vali Acc: 0.328 Test Loss: 4.309 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.100841999053955
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.328 Vali Acc: 0.339 Test Loss: 4.328 Test Acc: 0.339
Validation loss decreased (-0.336428 --> -0.338780).  Saving model ...
Epoch: 26 cost time: 1.090571403503418
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.360 Vali Acc: 0.335 Test Loss: 4.360 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.024972677230835
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.380 Vali Acc: 0.341 Test Loss: 4.380 Test Acc: 0.341
Validation loss decreased (-0.338780 --> -0.341133).  Saving model ...
Epoch: 28 cost time: 1.1788954734802246
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.397 Vali Acc: 0.348 Test Loss: 4.397 Test Acc: 0.348
Validation loss decreased (-0.341133 --> -0.348191).  Saving model ...
Epoch: 29 cost time: 1.1235451698303223
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.386 Vali Acc: 0.344 Test Loss: 4.386 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0418829917907715
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.394 Vali Acc: 0.346 Test Loss: 4.394 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.0877552032470703
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.418 Vali Acc: 0.336 Test Loss: 4.418 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.1221528053283691
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.438 Vali Acc: 0.341 Test Loss: 4.438 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0939760208129883
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.455 Vali Acc: 0.341 Test Loss: 4.455 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.174018383026123
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.482 Vali Acc: 0.342 Test Loss: 4.482 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1334357261657715
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.505 Vali Acc: 0.346 Test Loss: 4.505 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0727081298828125
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.527 Vali Acc: 0.336 Test Loss: 4.527 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0524873733520508
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.549 Vali Acc: 0.339 Test Loss: 4.549 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1296072006225586
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.550 Vali Acc: 0.341 Test Loss: 4.550 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34823529411764703
model parameter : 337554
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.597529411315918
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.347 Vali Acc: 0.034 Test Loss: 3.347 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 1.016474723815918
Epoch: 2, Steps: 10 | Train Loss: 3.084 Vali Loss: 3.292 Vali Acc: 0.081 Test Loss: 3.292 Test Acc: 0.081
Validation loss decreased (-0.034084 --> -0.081144).  Saving model ...
Epoch: 3 cost time: 0.8944704532623291
Epoch: 3, Steps: 10 | Train Loss: 2.698 Vali Loss: 3.261 Vali Acc: 0.128 Test Loss: 3.261 Test Acc: 0.128
Validation loss decreased (-0.081144 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 0.9443850517272949
Epoch: 4, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.184 Vali Acc: 0.153 Test Loss: 3.184 Test Acc: 0.153
Validation loss decreased (-0.128203 --> -0.152909).  Saving model ...
Epoch: 5 cost time: 0.9436795711517334
Epoch: 5, Steps: 10 | Train Loss: 1.729 Vali Loss: 3.156 Vali Acc: 0.198 Test Loss: 3.156 Test Acc: 0.198
Validation loss decreased (-0.152909 --> -0.197616).  Saving model ...
Epoch: 6 cost time: 0.9276828765869141
Epoch: 6, Steps: 10 | Train Loss: 1.395 Vali Loss: 3.163 Vali Acc: 0.240 Test Loss: 3.163 Test Acc: 0.240
Validation loss decreased (-0.197616 --> -0.239968).  Saving model ...
Epoch: 7 cost time: 1.0555708408355713
Epoch: 7, Steps: 10 | Train Loss: 1.056 Vali Loss: 3.226 Vali Acc: 0.251 Test Loss: 3.226 Test Acc: 0.251
Validation loss decreased (-0.239968 --> -0.250556).  Saving model ...
Epoch: 8 cost time: 0.895275354385376
Epoch: 8, Steps: 10 | Train Loss: 0.791 Vali Loss: 3.313 Vali Acc: 0.273 Test Loss: 3.313 Test Acc: 0.273
Validation loss decreased (-0.250556 --> -0.272908).  Saving model ...
Epoch: 9 cost time: 0.9972941875457764
Epoch: 9, Steps: 10 | Train Loss: 0.537 Vali Loss: 3.388 Vali Acc: 0.276 Test Loss: 3.388 Test Acc: 0.276
Validation loss decreased (-0.272908 --> -0.276437).  Saving model ...
Epoch: 10 cost time: 0.9698936939239502
Epoch: 10, Steps: 10 | Train Loss: 0.371 Vali Loss: 3.412 Vali Acc: 0.302 Test Loss: 3.412 Test Acc: 0.302
Validation loss decreased (-0.276437 --> -0.302319).  Saving model ...
Epoch: 11 cost time: 0.9710221290588379
Epoch: 11, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.564 Vali Acc: 0.300 Test Loss: 3.564 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.9257125854492188
Epoch: 12, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.564 Vali Acc: 0.326 Test Loss: 3.564 Test Acc: 0.326
Validation loss decreased (-0.302319 --> -0.325847).  Saving model ...
Epoch: 13 cost time: 0.924034595489502
Epoch: 13, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.657 Vali Acc: 0.325 Test Loss: 3.657 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0222527980804443
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.876 Vali Acc: 0.316 Test Loss: 3.876 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2246880531311035
Epoch: 15, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.904 Vali Acc: 0.315 Test Loss: 3.904 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.255779504776001
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.942 Vali Acc: 0.329 Test Loss: 3.942 Test Acc: 0.329
Validation loss decreased (-0.325847 --> -0.329372).  Saving model ...
Epoch: 17 cost time: 1.0875437259674072
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.990 Vali Acc: 0.318 Test Loss: 3.990 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.104142665863037
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.986 Vali Acc: 0.328 Test Loss: 3.986 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.1342144012451172
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.061 Vali Acc: 0.331 Test Loss: 4.061 Test Acc: 0.331
Validation loss decreased (-0.329372 --> -0.330548).  Saving model ...
Epoch: 20 cost time: 1.0010619163513184
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.107 Vali Acc: 0.328 Test Loss: 4.107 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.117389440536499
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.133 Vali Acc: 0.333 Test Loss: 4.133 Test Acc: 0.333
Validation loss decreased (-0.330548 --> -0.332900).  Saving model ...
Epoch: 22 cost time: 1.0311057567596436
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.134 Vali Acc: 0.338 Test Loss: 4.134 Test Acc: 0.338
Validation loss decreased (-0.332900 --> -0.337606).  Saving model ...
Epoch: 23 cost time: 1.1180555820465088
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.152 Vali Acc: 0.334 Test Loss: 4.152 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1150381565093994
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.183 Vali Acc: 0.339 Test Loss: 4.183 Test Acc: 0.339
Validation loss decreased (-0.337606 --> -0.338782).  Saving model ...
Epoch: 25 cost time: 1.0729303359985352
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.196 Vali Acc: 0.339 Test Loss: 4.196 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0405607223510742
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.224 Vali Acc: 0.338 Test Loss: 4.224 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0809142589569092
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.248 Vali Acc: 0.334 Test Loss: 4.248 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.0288870334625244
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.274 Vali Acc: 0.336 Test Loss: 4.274 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.0511770248413086
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.271 Vali Acc: 0.334 Test Loss: 4.271 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.0807430744171143
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.273 Vali Acc: 0.338 Test Loss: 4.273 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.2191369533538818
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.288 Vali Acc: 0.340 Test Loss: 4.288 Test Acc: 0.340
Validation loss decreased (-0.338782 --> -0.339957).  Saving model ...
Epoch: 32 cost time: 1.2151117324829102
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.307 Vali Acc: 0.344 Test Loss: 4.307 Test Acc: 0.344
Validation loss decreased (-0.339957 --> -0.343486).  Saving model ...
Epoch: 33 cost time: 1.1643519401550293
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.329 Vali Acc: 0.341 Test Loss: 4.329 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.2108452320098877
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.348 Vali Acc: 0.344 Test Loss: 4.348 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.1998322010040283
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.367 Vali Acc: 0.341 Test Loss: 4.367 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.0268442630767822
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.387 Vali Acc: 0.339 Test Loss: 4.387 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.1166188716888428
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.420 Vali Acc: 0.336 Test Loss: 4.420 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.0582301616668701
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.423 Vali Acc: 0.338 Test Loss: 4.423 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.038414478302002
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.427 Vali Acc: 0.344 Test Loss: 4.427 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.1759850978851318
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.438 Vali Acc: 0.342 Test Loss: 4.438 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.1927943229675293
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.452 Vali Acc: 0.340 Test Loss: 4.452 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.1548376083374023
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.461 Vali Acc: 0.336 Test Loss: 4.461 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 337554
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2846176624298096
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.338 Vali Acc: 0.047 Test Loss: 3.338 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 1.0753364562988281
Epoch: 2, Steps: 10 | Train Loss: 3.094 Vali Loss: 3.289 Vali Acc: 0.073 Test Loss: 3.289 Test Acc: 0.073
Validation loss decreased (-0.047025 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 1.0754387378692627
Epoch: 3, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.257 Vali Acc: 0.122 Test Loss: 3.257 Test Acc: 0.122
Validation loss decreased (-0.072908 --> -0.122320).  Saving model ...
Epoch: 4 cost time: 0.9279241561889648
Epoch: 4, Steps: 10 | Train Loss: 2.324 Vali Loss: 3.181 Vali Acc: 0.152 Test Loss: 3.181 Test Acc: 0.152
Validation loss decreased (-0.122320 --> -0.151733).  Saving model ...
Epoch: 5 cost time: 0.973116397857666
Epoch: 5, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.138 Vali Acc: 0.192 Test Loss: 3.138 Test Acc: 0.192
Validation loss decreased (-0.151733 --> -0.191733).  Saving model ...
Epoch: 6 cost time: 1.0235226154327393
Epoch: 6, Steps: 10 | Train Loss: 1.471 Vali Loss: 3.123 Vali Acc: 0.240 Test Loss: 3.123 Test Acc: 0.240
Validation loss decreased (-0.191733 --> -0.239969).  Saving model ...
Epoch: 7 cost time: 0.9228079319000244
Epoch: 7, Steps: 10 | Train Loss: 1.120 Vali Loss: 3.157 Vali Acc: 0.245 Test Loss: 3.157 Test Acc: 0.245
Validation loss decreased (-0.239969 --> -0.244674).  Saving model ...
Epoch: 8 cost time: 1.00636887550354
Epoch: 8, Steps: 10 | Train Loss: 0.864 Vali Loss: 3.235 Vali Acc: 0.266 Test Loss: 3.235 Test Acc: 0.266
Validation loss decreased (-0.244674 --> -0.265850).  Saving model ...
Epoch: 9 cost time: 0.8450500965118408
Epoch: 9, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.302 Vali Acc: 0.281 Test Loss: 3.302 Test Acc: 0.281
Validation loss decreased (-0.265850 --> -0.281143).  Saving model ...
Epoch: 10 cost time: 0.9142837524414062
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.304 Vali Acc: 0.299 Test Loss: 3.304 Test Acc: 0.299
Validation loss decreased (-0.281143 --> -0.298790).  Saving model ...
Epoch: 11 cost time: 1.0021247863769531
Epoch: 11, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.424 Vali Acc: 0.306 Test Loss: 3.424 Test Acc: 0.306
Validation loss decreased (-0.298790 --> -0.305848).  Saving model ...
Epoch: 12 cost time: 0.9233882427215576
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.474 Vali Acc: 0.319 Test Loss: 3.474 Test Acc: 0.319
Validation loss decreased (-0.305848 --> -0.318789).  Saving model ...
Epoch: 13 cost time: 1.0306651592254639
Epoch: 13, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.551 Vali Acc: 0.322 Test Loss: 3.551 Test Acc: 0.322
Validation loss decreased (-0.318789 --> -0.322317).  Saving model ...
Epoch: 14 cost time: 1.023331642150879
Epoch: 14, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.688 Vali Acc: 0.308 Test Loss: 3.688 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9583337306976318
Epoch: 15, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.735 Vali Acc: 0.321 Test Loss: 3.735 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9763021469116211
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.761 Vali Acc: 0.329 Test Loss: 3.761 Test Acc: 0.329
Validation loss decreased (-0.322317 --> -0.329374).  Saving model ...
Epoch: 17 cost time: 0.9970808029174805
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.793 Vali Acc: 0.326 Test Loss: 3.793 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0264899730682373
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.811 Vali Acc: 0.329 Test Loss: 3.811 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8624670505523682
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.842 Vali Acc: 0.333 Test Loss: 3.842 Test Acc: 0.333
Validation loss decreased (-0.329374 --> -0.332903).  Saving model ...
Epoch: 20 cost time: 0.8198165893554688
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.871 Vali Acc: 0.325 Test Loss: 3.871 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8448789119720459
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.898 Vali Acc: 0.322 Test Loss: 3.898 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.999004602432251
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.914 Vali Acc: 0.326 Test Loss: 3.914 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9407937526702881
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.934 Vali Acc: 0.322 Test Loss: 3.934 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9616055488586426
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.965 Vali Acc: 0.325 Test Loss: 3.965 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9427475929260254
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.972 Vali Acc: 0.331 Test Loss: 3.972 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.970005989074707
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.995 Vali Acc: 0.328 Test Loss: 3.995 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9142336845397949
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.018 Vali Acc: 0.326 Test Loss: 4.018 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.8292598724365234
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.033 Vali Acc: 0.329 Test Loss: 4.033 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.886573076248169
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.035 Vali Acc: 0.328 Test Loss: 4.035 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 337554
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.603832721710205
Epoch: 1, Steps: 10 | Train Loss: 3.345 Vali Loss: 3.305 Vali Acc: 0.040 Test Loss: 3.305 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 1.051276683807373
Epoch: 2, Steps: 10 | Train Loss: 3.129 Vali Loss: 3.270 Vali Acc: 0.078 Test Loss: 3.270 Test Acc: 0.078
Validation loss decreased (-0.039967 --> -0.077614).  Saving model ...
Epoch: 3 cost time: 0.8990340232849121
Epoch: 3, Steps: 10 | Train Loss: 2.843 Vali Loss: 3.243 Vali Acc: 0.101 Test Loss: 3.243 Test Acc: 0.101
Validation loss decreased (-0.077614 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 0.9765448570251465
Epoch: 4, Steps: 10 | Train Loss: 2.494 Vali Loss: 3.176 Vali Acc: 0.149 Test Loss: 3.176 Test Acc: 0.149
Validation loss decreased (-0.101144 --> -0.149380).  Saving model ...
Epoch: 5 cost time: 0.7982456684112549
Epoch: 5, Steps: 10 | Train Loss: 2.088 Vali Loss: 3.101 Vali Acc: 0.180 Test Loss: 3.101 Test Acc: 0.180
Validation loss decreased (-0.149380 --> -0.179969).  Saving model ...
Epoch: 6 cost time: 0.9962294101715088
Epoch: 6, Steps: 10 | Train Loss: 1.746 Vali Loss: 3.031 Vali Acc: 0.225 Test Loss: 3.031 Test Acc: 0.225
Validation loss decreased (-0.179969 --> -0.224676).  Saving model ...
Epoch: 7 cost time: 0.847724199295044
Epoch: 7, Steps: 10 | Train Loss: 1.407 Vali Loss: 3.002 Vali Acc: 0.248 Test Loss: 3.002 Test Acc: 0.248
Validation loss decreased (-0.224676 --> -0.248205).  Saving model ...
Epoch: 8 cost time: 1.2020623683929443
Epoch: 8, Steps: 10 | Train Loss: 1.071 Vali Loss: 3.030 Vali Acc: 0.262 Test Loss: 3.030 Test Acc: 0.262
Validation loss decreased (-0.248205 --> -0.262323).  Saving model ...
Epoch: 9 cost time: 1.033193588256836
Epoch: 9, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.055 Vali Acc: 0.267 Test Loss: 3.055 Test Acc: 0.267
Validation loss decreased (-0.262323 --> -0.267028).  Saving model ...
Epoch: 10 cost time: 1.1266241073608398
Epoch: 10, Steps: 10 | Train Loss: 0.544 Vali Loss: 3.034 Vali Acc: 0.298 Test Loss: 3.034 Test Acc: 0.298
Validation loss decreased (-0.267028 --> -0.297617).  Saving model ...
Epoch: 11 cost time: 1.0193591117858887
Epoch: 11, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.134 Vali Acc: 0.299 Test Loss: 3.134 Test Acc: 0.299
Validation loss decreased (-0.297617 --> -0.298792).  Saving model ...
Epoch: 12 cost time: 0.9791584014892578
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.136 Vali Acc: 0.314 Test Loss: 3.136 Test Acc: 0.314
Validation loss decreased (-0.298792 --> -0.314086).  Saving model ...
Epoch: 13 cost time: 0.9953160285949707
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.188 Vali Acc: 0.326 Test Loss: 3.188 Test Acc: 0.326
Validation loss decreased (-0.314086 --> -0.325850).  Saving model ...
Epoch: 14 cost time: 0.910973072052002
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.306 Vali Acc: 0.302 Test Loss: 3.306 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9603769779205322
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.378 Vali Acc: 0.312 Test Loss: 3.378 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8806490898132324
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.369 Vali Acc: 0.320 Test Loss: 3.369 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.030973196029663
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.363 Vali Acc: 0.327 Test Loss: 3.363 Test Acc: 0.327
Validation loss decreased (-0.325850 --> -0.327025).  Saving model ...
Epoch: 18 cost time: 1.0084240436553955
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.394 Vali Acc: 0.325 Test Loss: 3.394 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9677658081054688
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.432 Vali Acc: 0.325 Test Loss: 3.432 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.9968287944793701
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.460 Vali Acc: 0.319 Test Loss: 3.460 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0042710304260254
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.497 Vali Acc: 0.321 Test Loss: 3.497 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9216725826263428
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.515 Vali Acc: 0.322 Test Loss: 3.515 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8043367862701416
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.529 Vali Acc: 0.325 Test Loss: 3.529 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8226990699768066
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.561 Vali Acc: 0.322 Test Loss: 3.561 Test Acc: 0.322
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.9491572380065918
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.581 Vali Acc: 0.329 Test Loss: 3.581 Test Acc: 0.329
Validation loss decreased (-0.327025 --> -0.329376).  Saving model ...
Epoch: 26 cost time: 1.1191074848175049
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.597 Vali Acc: 0.328 Test Loss: 3.597 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0848190784454346
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.618 Vali Acc: 0.329 Test Loss: 3.618 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9675137996673584
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.641 Vali Acc: 0.325 Test Loss: 3.641 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9909007549285889
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.638 Vali Acc: 0.326 Test Loss: 3.638 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0851843357086182
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.641 Vali Acc: 0.329 Test Loss: 3.641 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.982006311416626
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.651 Vali Acc: 0.324 Test Loss: 3.651 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9907710552215576
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.667 Vali Acc: 0.321 Test Loss: 3.667 Test Acc: 0.321
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.1605052947998047
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.678 Vali Acc: 0.326 Test Loss: 3.678 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.0747900009155273
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.692 Vali Acc: 0.324 Test Loss: 3.692 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.0553069114685059
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.703 Vali Acc: 0.329 Test Loss: 3.703 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 337554
model size : 2.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4408810138702393
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.328 Vali Acc: 0.036 Test Loss: 3.328 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.8703527450561523
Epoch: 2, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.306 Vali Acc: 0.067 Test Loss: 3.306 Test Acc: 0.067
Validation loss decreased (-0.036437 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.8965244293212891
Epoch: 3, Steps: 10 | Train Loss: 2.592 Vali Loss: 3.292 Vali Acc: 0.121 Test Loss: 3.292 Test Acc: 0.121
Validation loss decreased (-0.067026 --> -0.121144).  Saving model ...
Epoch: 4 cost time: 1.0073816776275635
Epoch: 4, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.202 Vali Acc: 0.174 Test Loss: 3.202 Test Acc: 0.174
Validation loss decreased (-0.121144 --> -0.174086).  Saving model ...
Epoch: 5 cost time: 0.9348440170288086
Epoch: 5, Steps: 10 | Train Loss: 1.673 Vali Loss: 3.198 Vali Acc: 0.207 Test Loss: 3.198 Test Acc: 0.207
Validation loss decreased (-0.174086 --> -0.207027).  Saving model ...
Epoch: 6 cost time: 0.9701187610626221
Epoch: 6, Steps: 10 | Train Loss: 1.265 Vali Loss: 3.234 Vali Acc: 0.246 Test Loss: 3.234 Test Acc: 0.246
Validation loss decreased (-0.207027 --> -0.245850).  Saving model ...
Epoch: 7 cost time: 0.9235751628875732
Epoch: 7, Steps: 10 | Train Loss: 0.953 Vali Loss: 3.258 Vali Acc: 0.267 Test Loss: 3.258 Test Acc: 0.267
Validation loss decreased (-0.245850 --> -0.267026).  Saving model ...
Epoch: 8 cost time: 0.9988369941711426
Epoch: 8, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.349 Vali Acc: 0.284 Test Loss: 3.349 Test Acc: 0.284
Validation loss decreased (-0.267026 --> -0.283496).  Saving model ...
Epoch: 9 cost time: 0.9560551643371582
Epoch: 9, Steps: 10 | Train Loss: 0.513 Vali Loss: 3.408 Vali Acc: 0.295 Test Loss: 3.408 Test Acc: 0.295
Validation loss decreased (-0.283496 --> -0.295260).  Saving model ...
Epoch: 10 cost time: 0.870661735534668
Epoch: 10, Steps: 10 | Train Loss: 0.387 Vali Loss: 3.519 Vali Acc: 0.306 Test Loss: 3.519 Test Acc: 0.306
Validation loss decreased (-0.295260 --> -0.305847).  Saving model ...
Epoch: 11 cost time: 0.9225471019744873
Epoch: 11, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.591 Vali Acc: 0.318 Test Loss: 3.591 Test Acc: 0.318
Validation loss decreased (-0.305847 --> -0.317611).  Saving model ...
Epoch: 12 cost time: 0.8888988494873047
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.716 Vali Acc: 0.321 Test Loss: 3.716 Test Acc: 0.321
Validation loss decreased (-0.317611 --> -0.321139).  Saving model ...
Epoch: 13 cost time: 1.063652753829956
Epoch: 13, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.864 Vali Acc: 0.309 Test Loss: 3.864 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0012948513031006
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.920 Vali Acc: 0.318 Test Loss: 3.920 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0774080753326416
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.980 Vali Acc: 0.324 Test Loss: 3.980 Test Acc: 0.324
Validation loss decreased (-0.321139 --> -0.323490).  Saving model ...
Epoch: 16 cost time: 1.0466992855072021
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 4.022 Vali Acc: 0.327 Test Loss: 4.022 Test Acc: 0.327
Validation loss decreased (-0.323490 --> -0.327019).  Saving model ...
Epoch: 17 cost time: 0.9585375785827637
Epoch: 17, Steps: 10 | Train Loss: 0.027 Vali Loss: 4.119 Vali Acc: 0.334 Test Loss: 4.119 Test Acc: 0.334
Validation loss decreased (-0.327019 --> -0.334076).  Saving model ...
Epoch: 18 cost time: 1.000303030014038
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.147 Vali Acc: 0.338 Test Loss: 4.147 Test Acc: 0.338
Validation loss decreased (-0.334076 --> -0.337606).  Saving model ...
Epoch: 19 cost time: 0.9846959114074707
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.135 Vali Acc: 0.342 Test Loss: 4.135 Test Acc: 0.342
Validation loss decreased (-0.337606 --> -0.342312).  Saving model ...
Epoch: 20 cost time: 0.8758604526519775
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.185 Vali Acc: 0.333 Test Loss: 4.185 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0226993560791016
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.231 Vali Acc: 0.338 Test Loss: 4.231 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9029355049133301
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.283 Vali Acc: 0.339 Test Loss: 4.283 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9369754791259766
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.304 Vali Acc: 0.342 Test Loss: 4.304 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9721498489379883
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.326 Vali Acc: 0.344 Test Loss: 4.326 Test Acc: 0.344
Validation loss decreased (-0.342312 --> -0.343486).  Saving model ...
Epoch: 25 cost time: 1.0503935813903809
Epoch: 25, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.348 Vali Acc: 0.340 Test Loss: 4.348 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.9889187812805176
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.382 Vali Acc: 0.338 Test Loss: 4.382 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.9264636039733887
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.394 Vali Acc: 0.341 Test Loss: 4.394 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.9501144886016846
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.405 Vali Acc: 0.336 Test Loss: 4.405 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9027302265167236
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.435 Vali Acc: 0.338 Test Loss: 4.435 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9607398509979248
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.445 Vali Acc: 0.345 Test Loss: 4.445 Test Acc: 0.345
Validation loss decreased (-0.343486 --> -0.344661).  Saving model ...
Epoch: 31 cost time: 1.0519993305206299
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.457 Vali Acc: 0.346 Test Loss: 4.457 Test Acc: 0.346
Validation loss decreased (-0.344661 --> -0.345838).  Saving model ...
Epoch: 32 cost time: 0.9860789775848389
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.486 Vali Acc: 0.344 Test Loss: 4.486 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0116548538208008
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.508 Vali Acc: 0.344 Test Loss: 4.508 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9092142581939697
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.533 Vali Acc: 0.344 Test Loss: 4.533 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8248021602630615
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.543 Vali Acc: 0.344 Test Loss: 4.543 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8936991691589355
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.556 Vali Acc: 0.344 Test Loss: 4.556 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.9161880016326904
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.580 Vali Acc: 0.344 Test Loss: 4.580 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.077683448791504
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.594 Vali Acc: 0.342 Test Loss: 4.594 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0539655685424805
Epoch: 39, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.607 Vali Acc: 0.345 Test Loss: 4.607 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0639305114746094
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.625 Vali Acc: 0.346 Test Loss: 4.625 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.0699028968811035
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.646 Vali Acc: 0.344 Test Loss: 4.646 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 304786
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5935168266296387
Epoch: 1, Steps: 10 | Train Loss: 3.405 Vali Loss: 3.310 Vali Acc: 0.036 Test Loss: 3.310 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.9430272579193115
Epoch: 2, Steps: 10 | Train Loss: 3.062 Vali Loss: 3.287 Vali Acc: 0.073 Test Loss: 3.287 Test Acc: 0.073
Validation loss decreased (-0.036437 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 1.0097882747650146
Epoch: 3, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.277 Vali Acc: 0.133 Test Loss: 3.277 Test Acc: 0.133
Validation loss decreased (-0.072908 --> -0.132908).  Saving model ...
Epoch: 4 cost time: 1.0628376007080078
Epoch: 4, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.189 Vali Acc: 0.178 Test Loss: 3.189 Test Acc: 0.178
Validation loss decreased (-0.132908 --> -0.177615).  Saving model ...
Epoch: 5 cost time: 0.9063766002655029
Epoch: 5, Steps: 10 | Train Loss: 1.726 Vali Loss: 3.181 Vali Acc: 0.208 Test Loss: 3.181 Test Acc: 0.208
Validation loss decreased (-0.177615 --> -0.208203).  Saving model ...
Epoch: 6 cost time: 1.104055404663086
Epoch: 6, Steps: 10 | Train Loss: 1.324 Vali Loss: 3.211 Vali Acc: 0.244 Test Loss: 3.211 Test Acc: 0.244
Validation loss decreased (-0.208203 --> -0.243497).  Saving model ...
Epoch: 7 cost time: 0.9430041313171387
Epoch: 7, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.232 Vali Acc: 0.265 Test Loss: 3.232 Test Acc: 0.265
Validation loss decreased (-0.243497 --> -0.264674).  Saving model ...
Epoch: 8 cost time: 0.9477019309997559
Epoch: 8, Steps: 10 | Train Loss: 0.771 Vali Loss: 3.309 Vali Acc: 0.267 Test Loss: 3.309 Test Acc: 0.267
Validation loss decreased (-0.264674 --> -0.267026).  Saving model ...
Epoch: 9 cost time: 0.9262735843658447
Epoch: 9, Steps: 10 | Train Loss: 0.552 Vali Loss: 3.365 Vali Acc: 0.288 Test Loss: 3.365 Test Acc: 0.288
Validation loss decreased (-0.267026 --> -0.288202).  Saving model ...
Epoch: 10 cost time: 0.9510228633880615
Epoch: 10, Steps: 10 | Train Loss: 0.403 Vali Loss: 3.457 Vali Acc: 0.307 Test Loss: 3.457 Test Acc: 0.307
Validation loss decreased (-0.288202 --> -0.307024).  Saving model ...
Epoch: 11 cost time: 0.941352128982544
Epoch: 11, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.536 Vali Acc: 0.305 Test Loss: 3.536 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.009925365447998
Epoch: 12, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.655 Vali Acc: 0.320 Test Loss: 3.655 Test Acc: 0.320
Validation loss decreased (-0.307024 --> -0.319963).  Saving model ...
Epoch: 13 cost time: 1.139282464981079
Epoch: 13, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.776 Vali Acc: 0.316 Test Loss: 3.776 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0708584785461426
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.837 Vali Acc: 0.319 Test Loss: 3.837 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.098926305770874
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.890 Vali Acc: 0.319 Test Loss: 3.890 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0355699062347412
Epoch: 16, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.929 Vali Acc: 0.331 Test Loss: 3.929 Test Acc: 0.331
Validation loss decreased (-0.319963 --> -0.330549).  Saving model ...
Epoch: 17 cost time: 1.0443649291992188
Epoch: 17, Steps: 10 | Train Loss: 0.030 Vali Loss: 4.006 Vali Acc: 0.333 Test Loss: 4.006 Test Acc: 0.333
Validation loss decreased (-0.330549 --> -0.332901).  Saving model ...
Epoch: 18 cost time: 0.9707479476928711
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.041 Vali Acc: 0.338 Test Loss: 4.041 Test Acc: 0.338
Validation loss decreased (-0.332901 --> -0.337607).  Saving model ...
Epoch: 19 cost time: 1.1240754127502441
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.031 Vali Acc: 0.342 Test Loss: 4.031 Test Acc: 0.342
Validation loss decreased (-0.337607 --> -0.342313).  Saving model ...
Epoch: 20 cost time: 1.0662784576416016
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.089 Vali Acc: 0.336 Test Loss: 4.089 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.1927881240844727
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.138 Vali Acc: 0.334 Test Loss: 4.138 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.1751232147216797
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.192 Vali Acc: 0.334 Test Loss: 4.192 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.112903118133545
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.205 Vali Acc: 0.336 Test Loss: 4.205 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.0490012168884277
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.213 Vali Acc: 0.340 Test Loss: 4.213 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9502851963043213
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.225 Vali Acc: 0.335 Test Loss: 4.225 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9806931018829346
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.250 Vali Acc: 0.335 Test Loss: 4.250 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.9585421085357666
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.268 Vali Acc: 0.336 Test Loss: 4.268 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0443203449249268
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.280 Vali Acc: 0.338 Test Loss: 4.280 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0195610523223877
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.315 Vali Acc: 0.333 Test Loss: 4.315 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 304786
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.63332200050354
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.292 Vali Acc: 0.035 Test Loss: 3.292 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.844332218170166
Epoch: 2, Steps: 10 | Train Loss: 3.059 Vali Loss: 3.267 Vali Acc: 0.073 Test Loss: 3.267 Test Acc: 0.073
Validation loss decreased (-0.035261 --> -0.072909).  Saving model ...
Epoch: 3 cost time: 0.788532018661499
Epoch: 3, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.261 Vali Acc: 0.133 Test Loss: 3.261 Test Acc: 0.133
Validation loss decreased (-0.072909 --> -0.132909).  Saving model ...
Epoch: 4 cost time: 0.8342931270599365
Epoch: 4, Steps: 10 | Train Loss: 2.259 Vali Loss: 3.175 Vali Acc: 0.179 Test Loss: 3.175 Test Acc: 0.179
Validation loss decreased (-0.132909 --> -0.178792).  Saving model ...
Epoch: 5 cost time: 0.9996333122253418
Epoch: 5, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.148 Vali Acc: 0.214 Test Loss: 3.148 Test Acc: 0.214
Validation loss decreased (-0.178792 --> -0.214086).  Saving model ...
Epoch: 6 cost time: 0.8412659168243408
Epoch: 6, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.152 Vali Acc: 0.245 Test Loss: 3.152 Test Acc: 0.245
Validation loss decreased (-0.214086 --> -0.244674).  Saving model ...
Epoch: 7 cost time: 0.9538459777832031
Epoch: 7, Steps: 10 | Train Loss: 1.064 Vali Loss: 3.161 Vali Acc: 0.264 Test Loss: 3.161 Test Acc: 0.264
Validation loss decreased (-0.244674 --> -0.263498).  Saving model ...
Epoch: 8 cost time: 0.9564309120178223
Epoch: 8, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.230 Vali Acc: 0.273 Test Loss: 3.230 Test Acc: 0.273
Validation loss decreased (-0.263498 --> -0.272909).  Saving model ...
Epoch: 9 cost time: 0.9491429328918457
Epoch: 9, Steps: 10 | Train Loss: 0.572 Vali Loss: 3.270 Vali Acc: 0.292 Test Loss: 3.270 Test Acc: 0.292
Validation loss decreased (-0.272909 --> -0.291732).  Saving model ...
Epoch: 10 cost time: 0.9627602100372314
Epoch: 10, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.342 Vali Acc: 0.312 Test Loss: 3.342 Test Acc: 0.312
Validation loss decreased (-0.291732 --> -0.311731).  Saving model ...
Epoch: 11 cost time: 0.967137336730957
Epoch: 11, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.420 Vali Acc: 0.315 Test Loss: 3.420 Test Acc: 0.315
Validation loss decreased (-0.311731 --> -0.315260).  Saving model ...
Epoch: 12 cost time: 0.920274019241333
Epoch: 12, Steps: 10 | Train Loss: 0.171 Vali Loss: 3.516 Vali Acc: 0.331 Test Loss: 3.516 Test Acc: 0.331
Validation loss decreased (-0.315260 --> -0.330553).  Saving model ...
Epoch: 13 cost time: 0.9851722717285156
Epoch: 13, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.623 Vali Acc: 0.325 Test Loss: 3.623 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0403563976287842
Epoch: 14, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.691 Vali Acc: 0.321 Test Loss: 3.691 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.033501148223877
Epoch: 15, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.718 Vali Acc: 0.326 Test Loss: 3.718 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.091346025466919
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.751 Vali Acc: 0.334 Test Loss: 3.751 Test Acc: 0.334
Validation loss decreased (-0.330553 --> -0.334080).  Saving model ...
Epoch: 17 cost time: 1.056321620941162
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.786 Vali Acc: 0.335 Test Loss: 3.786 Test Acc: 0.335
Validation loss decreased (-0.334080 --> -0.335256).  Saving model ...
Epoch: 18 cost time: 0.9259917736053467
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.797 Vali Acc: 0.340 Test Loss: 3.797 Test Acc: 0.340
Validation loss decreased (-0.335256 --> -0.339962).  Saving model ...
Epoch: 19 cost time: 0.8470814228057861
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.829 Vali Acc: 0.332 Test Loss: 3.829 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8566324710845947
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.878 Vali Acc: 0.333 Test Loss: 3.878 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.879387378692627
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.910 Vali Acc: 0.339 Test Loss: 3.910 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9360663890838623
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.942 Vali Acc: 0.333 Test Loss: 3.942 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.0269231796264648
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.963 Vali Acc: 0.332 Test Loss: 3.963 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0401535034179688
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.980 Vali Acc: 0.329 Test Loss: 3.980 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.0147886276245117
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.002 Vali Acc: 0.332 Test Loss: 4.002 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.9570016860961914
Epoch: 26, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.016 Vali Acc: 0.333 Test Loss: 4.016 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8682518005371094
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.038 Vali Acc: 0.333 Test Loss: 4.038 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8571057319641113
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.052 Vali Acc: 0.332 Test Loss: 4.052 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 304786
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7230310440063477
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.268 Vali Acc: 0.047 Test Loss: 3.268 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.0958526134490967
Epoch: 2, Steps: 10 | Train Loss: 3.075 Vali Loss: 3.241 Vali Acc: 0.076 Test Loss: 3.241 Test Acc: 0.076
Validation loss decreased (-0.047026 --> -0.076438).  Saving model ...
Epoch: 3 cost time: 1.092843770980835
Epoch: 3, Steps: 10 | Train Loss: 2.790 Vali Loss: 3.231 Vali Acc: 0.122 Test Loss: 3.231 Test Acc: 0.122
Validation loss decreased (-0.076438 --> -0.122321).  Saving model ...
Epoch: 4 cost time: 0.9120097160339355
Epoch: 4, Steps: 10 | Train Loss: 2.440 Vali Loss: 3.157 Vali Acc: 0.171 Test Loss: 3.157 Test Acc: 0.171
Validation loss decreased (-0.122321 --> -0.170557).  Saving model ...
Epoch: 5 cost time: 0.8836073875427246
Epoch: 5, Steps: 10 | Train Loss: 2.050 Vali Loss: 3.092 Vali Acc: 0.208 Test Loss: 3.092 Test Acc: 0.208
Validation loss decreased (-0.170557 --> -0.208204).  Saving model ...
Epoch: 6 cost time: 0.9624569416046143
Epoch: 6, Steps: 10 | Train Loss: 1.647 Vali Loss: 3.042 Vali Acc: 0.235 Test Loss: 3.042 Test Acc: 0.235
Validation loss decreased (-0.208204 --> -0.235264).  Saving model ...
Epoch: 7 cost time: 0.9918279647827148
Epoch: 7, Steps: 10 | Train Loss: 1.323 Vali Loss: 2.995 Vali Acc: 0.261 Test Loss: 2.995 Test Acc: 0.261
Validation loss decreased (-0.235264 --> -0.261147).  Saving model ...
Epoch: 8 cost time: 0.9906280040740967
Epoch: 8, Steps: 10 | Train Loss: 1.055 Vali Loss: 3.019 Vali Acc: 0.271 Test Loss: 3.019 Test Acc: 0.271
Validation loss decreased (-0.261147 --> -0.270558).  Saving model ...
Epoch: 9 cost time: 1.0081837177276611
Epoch: 9, Steps: 10 | Train Loss: 0.761 Vali Loss: 3.036 Vali Acc: 0.294 Test Loss: 3.036 Test Acc: 0.294
Validation loss decreased (-0.270558 --> -0.294087).  Saving model ...
Epoch: 10 cost time: 0.9944214820861816
Epoch: 10, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.073 Vali Acc: 0.296 Test Loss: 3.073 Test Acc: 0.296
Validation loss decreased (-0.294087 --> -0.296440).  Saving model ...
Epoch: 11 cost time: 1.0194957256317139
Epoch: 11, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.114 Vali Acc: 0.313 Test Loss: 3.114 Test Acc: 0.313
Validation loss decreased (-0.296440 --> -0.312910).  Saving model ...
Epoch: 12 cost time: 0.969158411026001
Epoch: 12, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.154 Vali Acc: 0.309 Test Loss: 3.154 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8662679195404053
Epoch: 13, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.270 Vali Acc: 0.327 Test Loss: 3.270 Test Acc: 0.327
Validation loss decreased (-0.312910 --> -0.327026).  Saving model ...
Epoch: 14 cost time: 0.9216859340667725
Epoch: 14, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.337 Vali Acc: 0.322 Test Loss: 3.337 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7993149757385254
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.345 Vali Acc: 0.324 Test Loss: 3.345 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9313232898712158
Epoch: 16, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.393 Vali Acc: 0.328 Test Loss: 3.393 Test Acc: 0.328
Validation loss decreased (-0.327026 --> -0.328201).  Saving model ...
Epoch: 17 cost time: 0.9438426494598389
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.413 Vali Acc: 0.333 Test Loss: 3.413 Test Acc: 0.333
Validation loss decreased (-0.328201 --> -0.332907).  Saving model ...
Epoch: 18 cost time: 0.9395411014556885
Epoch: 18, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.419 Vali Acc: 0.342 Test Loss: 3.419 Test Acc: 0.342
Validation loss decreased (-0.332907 --> -0.342319).  Saving model ...
Epoch: 19 cost time: 0.9663224220275879
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.452 Vali Acc: 0.339 Test Loss: 3.452 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9743239879608154
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.489 Vali Acc: 0.334 Test Loss: 3.489 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.8790853023529053
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.520 Vali Acc: 0.332 Test Loss: 3.520 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8193647861480713
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.553 Vali Acc: 0.329 Test Loss: 3.553 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8355998992919922
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.580 Vali Acc: 0.329 Test Loss: 3.580 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9309413433074951
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.595 Vali Acc: 0.328 Test Loss: 3.595 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8913369178771973
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.612 Vali Acc: 0.328 Test Loss: 3.612 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0220801830291748
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.632 Vali Acc: 0.332 Test Loss: 3.632 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0976805686950684
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.646 Vali Acc: 0.333 Test Loss: 3.646 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0898840427398682
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.663 Vali Acc: 0.332 Test Loss: 3.663 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 304786
model size : 2.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5524606704711914
Epoch: 1, Steps: 10 | Train Loss: 3.408 Vali Loss: 3.372 Vali Acc: 0.053 Test Loss: 3.372 Test Acc: 0.053
Validation loss decreased (inf --> -0.052907).  Saving model ...
Epoch: 2 cost time: 0.9892175197601318
Epoch: 2, Steps: 10 | Train Loss: 3.108 Vali Loss: 3.334 Vali Acc: 0.079 Test Loss: 3.334 Test Acc: 0.079
Validation loss decreased (-0.052907 --> -0.078790).  Saving model ...
Epoch: 3 cost time: 0.994420051574707
Epoch: 3, Steps: 10 | Train Loss: 2.623 Vali Loss: 3.275 Vali Acc: 0.127 Test Loss: 3.275 Test Acc: 0.127
Validation loss decreased (-0.078790 --> -0.127026).  Saving model ...
Epoch: 4 cost time: 0.885817289352417
Epoch: 4, Steps: 10 | Train Loss: 2.154 Vali Loss: 3.187 Vali Acc: 0.159 Test Loss: 3.187 Test Acc: 0.159
Validation loss decreased (-0.127026 --> -0.158792).  Saving model ...
Epoch: 5 cost time: 0.9976110458374023
Epoch: 5, Steps: 10 | Train Loss: 1.667 Vali Loss: 3.200 Vali Acc: 0.194 Test Loss: 3.200 Test Acc: 0.194
Validation loss decreased (-0.158792 --> -0.194086).  Saving model ...
Epoch: 6 cost time: 0.9661457538604736
Epoch: 6, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.234 Vali Acc: 0.232 Test Loss: 3.234 Test Acc: 0.232
Validation loss decreased (-0.194086 --> -0.231732).  Saving model ...
Epoch: 7 cost time: 0.95355224609375
Epoch: 7, Steps: 10 | Train Loss: 0.956 Vali Loss: 3.288 Vali Acc: 0.249 Test Loss: 3.288 Test Acc: 0.249
Validation loss decreased (-0.231732 --> -0.249379).  Saving model ...
Epoch: 8 cost time: 1.0406484603881836
Epoch: 8, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.356 Vali Acc: 0.268 Test Loss: 3.356 Test Acc: 0.268
Validation loss decreased (-0.249379 --> -0.268202).  Saving model ...
Epoch: 9 cost time: 0.949901819229126
Epoch: 9, Steps: 10 | Train Loss: 0.514 Vali Loss: 3.443 Vali Acc: 0.276 Test Loss: 3.443 Test Acc: 0.276
Validation loss decreased (-0.268202 --> -0.276436).  Saving model ...
Epoch: 10 cost time: 1.055016040802002
Epoch: 10, Steps: 10 | Train Loss: 0.392 Vali Loss: 3.489 Vali Acc: 0.306 Test Loss: 3.489 Test Acc: 0.306
Validation loss decreased (-0.276436 --> -0.305847).  Saving model ...
Epoch: 11 cost time: 1.0687601566314697
Epoch: 11, Steps: 10 | Train Loss: 0.236 Vali Loss: 3.572 Vali Acc: 0.314 Test Loss: 3.572 Test Acc: 0.314
Validation loss decreased (-0.305847 --> -0.314082).  Saving model ...
Epoch: 12 cost time: 1.057927131652832
Epoch: 12, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.683 Vali Acc: 0.321 Test Loss: 3.683 Test Acc: 0.321
Validation loss decreased (-0.314082 --> -0.321140).  Saving model ...
Epoch: 13 cost time: 1.0490119457244873
Epoch: 13, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.772 Vali Acc: 0.321 Test Loss: 3.772 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.055614948272705
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.834 Vali Acc: 0.315 Test Loss: 3.834 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1061091423034668
Epoch: 15, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.928 Vali Acc: 0.327 Test Loss: 3.928 Test Acc: 0.327
Validation loss decreased (-0.321140 --> -0.327020).  Saving model ...
Epoch: 16 cost time: 0.9197242259979248
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.050 Vali Acc: 0.326 Test Loss: 4.050 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9330298900604248
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.080 Vali Acc: 0.333 Test Loss: 4.080 Test Acc: 0.333
Validation loss decreased (-0.327020 --> -0.332900).  Saving model ...
Epoch: 18 cost time: 0.9778988361358643
Epoch: 18, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.130 Vali Acc: 0.334 Test Loss: 4.130 Test Acc: 0.334
Validation loss decreased (-0.332900 --> -0.334076).  Saving model ...
Epoch: 19 cost time: 1.045935869216919
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.185 Vali Acc: 0.331 Test Loss: 4.185 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9845800399780273
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.188 Vali Acc: 0.335 Test Loss: 4.188 Test Acc: 0.335
Validation loss decreased (-0.334076 --> -0.335252).  Saving model ...
Epoch: 21 cost time: 1.0915462970733643
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.233 Vali Acc: 0.333 Test Loss: 4.233 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.1321122646331787
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.262 Vali Acc: 0.335 Test Loss: 4.262 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.024742841720581
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.303 Vali Acc: 0.339 Test Loss: 4.303 Test Acc: 0.339
Validation loss decreased (-0.335252 --> -0.338780).  Saving model ...
Epoch: 24 cost time: 1.007293939590454
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.323 Vali Acc: 0.336 Test Loss: 4.323 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0054736137390137
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.345 Vali Acc: 0.334 Test Loss: 4.345 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.983644962310791
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.354 Vali Acc: 0.333 Test Loss: 4.354 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9928147792816162
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.376 Vali Acc: 0.339 Test Loss: 4.376 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.1033313274383545
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.432 Vali Acc: 0.339 Test Loss: 4.432 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.1347997188568115
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.448 Vali Acc: 0.335 Test Loss: 4.448 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0171895027160645
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.457 Vali Acc: 0.338 Test Loss: 4.457 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0401215553283691
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.464 Vali Acc: 0.332 Test Loss: 4.464 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0044338703155518
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.479 Vali Acc: 0.339 Test Loss: 4.479 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9469308853149414
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.502 Vali Acc: 0.341 Test Loss: 4.502 Test Acc: 0.341
Validation loss decreased (-0.338780 --> -0.341131).  Saving model ...
Epoch: 34 cost time: 0.9614946842193604
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.531 Vali Acc: 0.342 Test Loss: 4.531 Test Acc: 0.342
Validation loss decreased (-0.341131 --> -0.342308).  Saving model ...
Epoch: 35 cost time: 0.9711112976074219
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.555 Vali Acc: 0.344 Test Loss: 4.555 Test Acc: 0.344
Validation loss decreased (-0.342308 --> -0.343484).  Saving model ...
Epoch: 36 cost time: 1.05018949508667
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.572 Vali Acc: 0.339 Test Loss: 4.572 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.128462314605713
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.591 Vali Acc: 0.340 Test Loss: 4.591 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0520355701446533
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.618 Vali Acc: 0.338 Test Loss: 4.618 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.039491891860962
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.630 Vali Acc: 0.340 Test Loss: 4.630 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9855852127075195
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.637 Vali Acc: 0.340 Test Loss: 4.637 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8794536590576172
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.645 Vali Acc: 0.336 Test Loss: 4.645 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.9193134307861328
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.654 Vali Acc: 0.338 Test Loss: 4.654 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.9792289733886719
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.673 Vali Acc: 0.335 Test Loss: 4.673 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.8628170490264893
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.681 Vali Acc: 0.335 Test Loss: 4.681 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.0974888801574707
Epoch: 45, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.688 Vali Acc: 0.334 Test Loss: 4.688 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 288402
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.769864082336426
Epoch: 1, Steps: 10 | Train Loss: 3.397 Vali Loss: 3.355 Vali Acc: 0.039 Test Loss: 3.355 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.9636375904083252
Epoch: 2, Steps: 10 | Train Loss: 3.137 Vali Loss: 3.320 Vali Acc: 0.078 Test Loss: 3.320 Test Acc: 0.078
Validation loss decreased (-0.038790 --> -0.077614).  Saving model ...
Epoch: 3 cost time: 0.9174184799194336
Epoch: 3, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.267 Vali Acc: 0.128 Test Loss: 3.267 Test Acc: 0.128
Validation loss decreased (-0.077614 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 0.920325756072998
Epoch: 4, Steps: 10 | Train Loss: 2.189 Vali Loss: 3.176 Vali Acc: 0.164 Test Loss: 3.176 Test Acc: 0.164
Validation loss decreased (-0.128203 --> -0.163498).  Saving model ...
Epoch: 5 cost time: 0.9824025630950928
Epoch: 5, Steps: 10 | Train Loss: 1.720 Vali Loss: 3.175 Vali Acc: 0.209 Test Loss: 3.175 Test Acc: 0.209
Validation loss decreased (-0.163498 --> -0.209380).  Saving model ...
Epoch: 6 cost time: 1.188948392868042
Epoch: 6, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.206 Vali Acc: 0.240 Test Loss: 3.206 Test Acc: 0.240
Validation loss decreased (-0.209380 --> -0.239968).  Saving model ...
Epoch: 7 cost time: 1.1141397953033447
Epoch: 7, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.245 Vali Acc: 0.262 Test Loss: 3.245 Test Acc: 0.262
Validation loss decreased (-0.239968 --> -0.262320).  Saving model ...
Epoch: 8 cost time: 0.9692058563232422
Epoch: 8, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.302 Vali Acc: 0.281 Test Loss: 3.302 Test Acc: 0.281
Validation loss decreased (-0.262320 --> -0.281143).  Saving model ...
Epoch: 9 cost time: 0.9254820346832275
Epoch: 9, Steps: 10 | Train Loss: 0.536 Vali Loss: 3.380 Vali Acc: 0.299 Test Loss: 3.380 Test Acc: 0.299
Validation loss decreased (-0.281143 --> -0.298790).  Saving model ...
Epoch: 10 cost time: 1.0161616802215576
Epoch: 10, Steps: 10 | Train Loss: 0.401 Vali Loss: 3.425 Vali Acc: 0.312 Test Loss: 3.425 Test Acc: 0.312
Validation loss decreased (-0.298790 --> -0.311730).  Saving model ...
Epoch: 11 cost time: 0.9060540199279785
Epoch: 11, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.508 Vali Acc: 0.319 Test Loss: 3.508 Test Acc: 0.319
Validation loss decreased (-0.311730 --> -0.318788).  Saving model ...
Epoch: 12 cost time: 0.9709367752075195
Epoch: 12, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.594 Vali Acc: 0.320 Test Loss: 3.594 Test Acc: 0.320
Validation loss decreased (-0.318788 --> -0.319964).  Saving model ...
Epoch: 13 cost time: 0.8555514812469482
Epoch: 13, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.680 Vali Acc: 0.320 Test Loss: 3.680 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0559308528900146
Epoch: 14, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.728 Vali Acc: 0.315 Test Loss: 3.728 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0468838214874268
Epoch: 15, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.830 Vali Acc: 0.333 Test Loss: 3.830 Test Acc: 0.333
Validation loss decreased (-0.319964 --> -0.332903).  Saving model ...
Epoch: 16 cost time: 0.8806641101837158
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.933 Vali Acc: 0.329 Test Loss: 3.933 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0523784160614014
Epoch: 17, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.961 Vali Acc: 0.325 Test Loss: 3.961 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9726181030273438
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 4.001 Vali Acc: 0.326 Test Loss: 4.001 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9142405986785889
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.032 Vali Acc: 0.334 Test Loss: 4.032 Test Acc: 0.334
Validation loss decreased (-0.332903 --> -0.334077).  Saving model ...
Epoch: 20 cost time: 1.0218219757080078
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.052 Vali Acc: 0.335 Test Loss: 4.052 Test Acc: 0.335
Validation loss decreased (-0.334077 --> -0.335254).  Saving model ...
Epoch: 21 cost time: 0.9606955051422119
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.111 Vali Acc: 0.331 Test Loss: 4.111 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0213661193847656
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.128 Vali Acc: 0.334 Test Loss: 4.128 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.1465387344360352
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.165 Vali Acc: 0.332 Test Loss: 4.165 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.0032696723937988
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.182 Vali Acc: 0.335 Test Loss: 4.182 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0477635860443115
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.211 Vali Acc: 0.331 Test Loss: 4.211 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.1164882183074951
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.217 Vali Acc: 0.333 Test Loss: 4.217 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9656763076782227
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.229 Vali Acc: 0.339 Test Loss: 4.229 Test Acc: 0.339
Validation loss decreased (-0.335254 --> -0.338781).  Saving model ...
Epoch: 28 cost time: 0.9936974048614502
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.268 Vali Acc: 0.333 Test Loss: 4.268 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8823633193969727
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.279 Vali Acc: 0.332 Test Loss: 4.279 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8341710567474365
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.294 Vali Acc: 0.332 Test Loss: 4.294 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.071035385131836
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.307 Vali Acc: 0.333 Test Loss: 4.307 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9574177265167236
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.332 Vali Acc: 0.334 Test Loss: 4.332 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.202491044998169
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.355 Vali Acc: 0.338 Test Loss: 4.355 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.9620935916900635
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.383 Vali Acc: 0.336 Test Loss: 4.383 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.0134456157684326
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.408 Vali Acc: 0.334 Test Loss: 4.408 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0175693035125732
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.425 Vali Acc: 0.333 Test Loss: 4.425 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9343945980072021
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.438 Vali Acc: 0.338 Test Loss: 4.438 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 288402
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6038880348205566
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.334 Vali Acc: 0.038 Test Loss: 3.334 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.9324719905853271
Epoch: 2, Steps: 10 | Train Loss: 3.128 Vali Loss: 3.305 Vali Acc: 0.086 Test Loss: 3.305 Test Acc: 0.086
Validation loss decreased (-0.037614 --> -0.085849).  Saving model ...
Epoch: 3 cost time: 0.8830010890960693
Epoch: 3, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.255 Vali Acc: 0.125 Test Loss: 3.255 Test Acc: 0.125
Validation loss decreased (-0.085849 --> -0.124673).  Saving model ...
Epoch: 4 cost time: 0.8015613555908203
Epoch: 4, Steps: 10 | Train Loss: 2.267 Vali Loss: 3.161 Vali Acc: 0.158 Test Loss: 3.161 Test Acc: 0.158
Validation loss decreased (-0.124673 --> -0.157615).  Saving model ...
Epoch: 5 cost time: 0.8713185787200928
Epoch: 5, Steps: 10 | Train Loss: 1.792 Vali Loss: 3.143 Vali Acc: 0.201 Test Loss: 3.143 Test Acc: 0.201
Validation loss decreased (-0.157615 --> -0.201145).  Saving model ...
Epoch: 6 cost time: 0.9791922569274902
Epoch: 6, Steps: 10 | Train Loss: 1.431 Vali Loss: 3.147 Vali Acc: 0.238 Test Loss: 3.147 Test Acc: 0.238
Validation loss decreased (-0.201145 --> -0.237616).  Saving model ...
Epoch: 7 cost time: 0.9178400039672852
Epoch: 7, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.172 Vali Acc: 0.260 Test Loss: 3.172 Test Acc: 0.260
Validation loss decreased (-0.237616 --> -0.259968).  Saving model ...
Epoch: 8 cost time: 0.9806180000305176
Epoch: 8, Steps: 10 | Train Loss: 0.816 Vali Loss: 3.211 Vali Acc: 0.280 Test Loss: 3.211 Test Acc: 0.280
Validation loss decreased (-0.259968 --> -0.279968).  Saving model ...
Epoch: 9 cost time: 0.9990854263305664
Epoch: 9, Steps: 10 | Train Loss: 0.563 Vali Loss: 3.275 Vali Acc: 0.285 Test Loss: 3.275 Test Acc: 0.285
Validation loss decreased (-0.279968 --> -0.284673).  Saving model ...
Epoch: 10 cost time: 0.9594604969024658
Epoch: 10, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.324 Vali Acc: 0.302 Test Loss: 3.324 Test Acc: 0.302
Validation loss decreased (-0.284673 --> -0.302320).  Saving model ...
Epoch: 11 cost time: 1.1182665824890137
Epoch: 11, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.387 Vali Acc: 0.316 Test Loss: 3.387 Test Acc: 0.316
Validation loss decreased (-0.302320 --> -0.316437).  Saving model ...
Epoch: 12 cost time: 1.129640817642212
Epoch: 12, Steps: 10 | Train Loss: 0.157 Vali Loss: 3.480 Vali Acc: 0.322 Test Loss: 3.480 Test Acc: 0.322
Validation loss decreased (-0.316437 --> -0.322318).  Saving model ...
Epoch: 13 cost time: 0.9427876472473145
Epoch: 13, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.534 Vali Acc: 0.318 Test Loss: 3.534 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8873627185821533
Epoch: 14, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.597 Vali Acc: 0.333 Test Loss: 3.597 Test Acc: 0.333
Validation loss decreased (-0.322318 --> -0.332905).  Saving model ...
Epoch: 15 cost time: 0.8825216293334961
Epoch: 15, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.666 Vali Acc: 0.333 Test Loss: 3.666 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9629249572753906
Epoch: 16, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.736 Vali Acc: 0.329 Test Loss: 3.736 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0284247398376465
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.773 Vali Acc: 0.324 Test Loss: 3.773 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9373800754547119
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.806 Vali Acc: 0.329 Test Loss: 3.806 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9680352210998535
Epoch: 19, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.825 Vali Acc: 0.326 Test Loss: 3.825 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.931403398513794
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.848 Vali Acc: 0.334 Test Loss: 3.848 Test Acc: 0.334
Validation loss decreased (-0.332905 --> -0.334079).  Saving model ...
Epoch: 21 cost time: 0.929567813873291
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.889 Vali Acc: 0.325 Test Loss: 3.889 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8568549156188965
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.906 Vali Acc: 0.333 Test Loss: 3.906 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9373171329498291
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.943 Vali Acc: 0.332 Test Loss: 3.943 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8976840972900391
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.959 Vali Acc: 0.333 Test Loss: 3.959 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9977860450744629
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.987 Vali Acc: 0.331 Test Loss: 3.987 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.035524845123291
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.005 Vali Acc: 0.333 Test Loss: 4.005 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.1410996913909912
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.017 Vali Acc: 0.335 Test Loss: 4.017 Test Acc: 0.335
Validation loss decreased (-0.334079 --> -0.335254).  Saving model ...
Epoch: 28 cost time: 1.0520429611206055
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.050 Vali Acc: 0.334 Test Loss: 4.050 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.0659377574920654
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.053 Vali Acc: 0.332 Test Loss: 4.053 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.0273706912994385
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.066 Vali Acc: 0.333 Test Loss: 4.066 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.0774791240692139
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.076 Vali Acc: 0.334 Test Loss: 4.076 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9827663898468018
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.100 Vali Acc: 0.334 Test Loss: 4.100 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.1872429847717285
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.112 Vali Acc: 0.334 Test Loss: 4.112 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 1.4118778705596924
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.140 Vali Acc: 0.339 Test Loss: 4.140 Test Acc: 0.339
Validation loss decreased (-0.335254 --> -0.338782).  Saving model ...
Epoch: 35 cost time: 1.1444520950317383
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.163 Vali Acc: 0.338 Test Loss: 4.163 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.0349185466766357
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.180 Vali Acc: 0.335 Test Loss: 4.180 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.142030954360962
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.186 Vali Acc: 0.335 Test Loss: 4.186 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.0235042572021484
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.203 Vali Acc: 0.336 Test Loss: 4.203 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.0780820846557617
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.209 Vali Acc: 0.336 Test Loss: 4.209 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0799832344055176
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.221 Vali Acc: 0.335 Test Loss: 4.221 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.095773696899414
Epoch: 41, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.234 Vali Acc: 0.333 Test Loss: 4.234 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.0831620693206787
Epoch: 42, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.237 Vali Acc: 0.332 Test Loss: 4.237 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.1201319694519043
Epoch: 43, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.246 Vali Acc: 0.335 Test Loss: 4.246 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.258007526397705
Epoch: 44, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.258 Vali Acc: 0.335 Test Loss: 4.258 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 288402
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4679880142211914
Epoch: 1, Steps: 10 | Train Loss: 3.317 Vali Loss: 3.309 Vali Acc: 0.029 Test Loss: 3.309 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.9211962223052979
Epoch: 2, Steps: 10 | Train Loss: 3.120 Vali Loss: 3.283 Vali Acc: 0.067 Test Loss: 3.283 Test Acc: 0.067
Validation loss decreased (-0.029379 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 1.0399525165557861
Epoch: 3, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.246 Vali Acc: 0.099 Test Loss: 3.246 Test Acc: 0.099
Validation loss decreased (-0.067026 --> -0.098791).  Saving model ...
Epoch: 4 cost time: 0.9325704574584961
Epoch: 4, Steps: 10 | Train Loss: 2.410 Vali Loss: 3.161 Vali Acc: 0.159 Test Loss: 3.161 Test Acc: 0.159
Validation loss decreased (-0.098791 --> -0.158792).  Saving model ...
Epoch: 5 cost time: 1.0097198486328125
Epoch: 5, Steps: 10 | Train Loss: 2.018 Vali Loss: 3.102 Vali Acc: 0.188 Test Loss: 3.102 Test Acc: 0.188
Validation loss decreased (-0.158792 --> -0.188204).  Saving model ...
Epoch: 6 cost time: 0.9775137901306152
Epoch: 6, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.058 Vali Acc: 0.212 Test Loss: 3.058 Test Acc: 0.212
Validation loss decreased (-0.188204 --> -0.211734).  Saving model ...
Epoch: 7 cost time: 0.9258837699890137
Epoch: 7, Steps: 10 | Train Loss: 1.340 Vali Loss: 3.043 Vali Acc: 0.252 Test Loss: 3.043 Test Acc: 0.252
Validation loss decreased (-0.211734 --> -0.251734).  Saving model ...
Epoch: 8 cost time: 0.9917075634002686
Epoch: 8, Steps: 10 | Train Loss: 1.033 Vali Loss: 3.022 Vali Acc: 0.279 Test Loss: 3.022 Test Acc: 0.279
Validation loss decreased (-0.251734 --> -0.278793).  Saving model ...
Epoch: 9 cost time: 1.052696943283081
Epoch: 9, Steps: 10 | Train Loss: 0.741 Vali Loss: 3.052 Vali Acc: 0.276 Test Loss: 3.052 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0034992694854736
Epoch: 10, Steps: 10 | Train Loss: 0.550 Vali Loss: 3.070 Vali Acc: 0.289 Test Loss: 3.070 Test Acc: 0.289
Validation loss decreased (-0.278793 --> -0.289381).  Saving model ...
Epoch: 11 cost time: 0.9514288902282715
Epoch: 11, Steps: 10 | Train Loss: 0.341 Vali Loss: 3.079 Vali Acc: 0.308 Test Loss: 3.079 Test Acc: 0.308
Validation loss decreased (-0.289381 --> -0.308205).  Saving model ...
Epoch: 12 cost time: 1.0243375301361084
Epoch: 12, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.175 Vali Acc: 0.314 Test Loss: 3.175 Test Acc: 0.314
Validation loss decreased (-0.308205 --> -0.314086).  Saving model ...
Epoch: 13 cost time: 1.0257782936096191
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.193 Vali Acc: 0.314 Test Loss: 3.193 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9447593688964844
Epoch: 14, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.264 Vali Acc: 0.313 Test Loss: 3.264 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.015587329864502
Epoch: 15, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.303 Vali Acc: 0.326 Test Loss: 3.303 Test Acc: 0.326
Validation loss decreased (-0.314086 --> -0.325849).  Saving model ...
Epoch: 16 cost time: 1.0071654319763184
Epoch: 16, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.347 Vali Acc: 0.328 Test Loss: 3.347 Test Acc: 0.328
Validation loss decreased (-0.325849 --> -0.328202).  Saving model ...
Epoch: 17 cost time: 0.8841688632965088
Epoch: 17, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.399 Vali Acc: 0.325 Test Loss: 3.399 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9547615051269531
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.434 Vali Acc: 0.325 Test Loss: 3.434 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8308792114257812
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.472 Vali Acc: 0.329 Test Loss: 3.472 Test Acc: 0.329
Validation loss decreased (-0.328202 --> -0.329377).  Saving model ...
Epoch: 20 cost time: 0.903374195098877
Epoch: 20, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.516 Vali Acc: 0.326 Test Loss: 3.516 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9955775737762451
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.561 Vali Acc: 0.325 Test Loss: 3.561 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9671103954315186
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.560 Vali Acc: 0.325 Test Loss: 3.560 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.0251522064208984
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.584 Vali Acc: 0.328 Test Loss: 3.584 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9542310237884521
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.596 Vali Acc: 0.328 Test Loss: 3.596 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9849038124084473
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.609 Vali Acc: 0.327 Test Loss: 3.609 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9138147830963135
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.626 Vali Acc: 0.327 Test Loss: 3.626 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.0034663677215576
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.640 Vali Acc: 0.328 Test Loss: 3.640 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9331870079040527
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.674 Vali Acc: 0.325 Test Loss: 3.674 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9145944118499756
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.686 Vali Acc: 0.325 Test Loss: 3.686 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 288402
model size : 2.34MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.739003896713257
Epoch: 1, Steps: 10 | Train Loss: 3.387 Vali Loss: 3.334 Vali Acc: 0.056 Test Loss: 3.334 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 1.0492479801177979
Epoch: 2, Steps: 10 | Train Loss: 3.198 Vali Loss: 3.294 Vali Acc: 0.080 Test Loss: 3.294 Test Acc: 0.080
Validation loss decreased (-0.056437 --> -0.079967).  Saving model ...
Epoch: 3 cost time: 1.0405168533325195
Epoch: 3, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.277 Vali Acc: 0.081 Test Loss: 3.277 Test Acc: 0.081
Validation loss decreased (-0.079967 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.982356071472168
Epoch: 4, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.230 Vali Acc: 0.114 Test Loss: 3.230 Test Acc: 0.114
Validation loss decreased (-0.081144 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.964946985244751
Epoch: 5, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.174 Vali Acc: 0.147 Test Loss: 3.174 Test Acc: 0.147
Validation loss decreased (-0.114085 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 0.9905686378479004
Epoch: 6, Steps: 10 | Train Loss: 2.072 Vali Loss: 3.137 Vali Acc: 0.162 Test Loss: 3.137 Test Acc: 0.162
Validation loss decreased (-0.147027 --> -0.162322).  Saving model ...
Epoch: 7 cost time: 1.062917709350586
Epoch: 7, Steps: 10 | Train Loss: 1.809 Vali Loss: 3.129 Vali Acc: 0.189 Test Loss: 3.129 Test Acc: 0.189
Validation loss decreased (-0.162322 --> -0.189380).  Saving model ...
Epoch: 8 cost time: 1.156912088394165
Epoch: 8, Steps: 10 | Train Loss: 1.496 Vali Loss: 3.123 Vali Acc: 0.208 Test Loss: 3.123 Test Acc: 0.208
Validation loss decreased (-0.189380 --> -0.208204).  Saving model ...
Epoch: 9 cost time: 1.0693941116333008
Epoch: 9, Steps: 10 | Train Loss: 1.238 Vali Loss: 3.140 Vali Acc: 0.227 Test Loss: 3.140 Test Acc: 0.227
Validation loss decreased (-0.208204 --> -0.227027).  Saving model ...
Epoch: 10 cost time: 0.9975113868713379
Epoch: 10, Steps: 10 | Train Loss: 1.054 Vali Loss: 3.137 Vali Acc: 0.264 Test Loss: 3.137 Test Acc: 0.264
Validation loss decreased (-0.227027 --> -0.263498).  Saving model ...
Epoch: 11 cost time: 0.9929475784301758
Epoch: 11, Steps: 10 | Train Loss: 0.868 Vali Loss: 3.189 Vali Acc: 0.269 Test Loss: 3.189 Test Acc: 0.269
Validation loss decreased (-0.263498 --> -0.269380).  Saving model ...
Epoch: 12 cost time: 1.0424654483795166
Epoch: 12, Steps: 10 | Train Loss: 0.707 Vali Loss: 3.205 Vali Acc: 0.300 Test Loss: 3.205 Test Acc: 0.300
Validation loss decreased (-0.269380 --> -0.299968).  Saving model ...
Epoch: 13 cost time: 1.0049188137054443
Epoch: 13, Steps: 10 | Train Loss: 0.519 Vali Loss: 3.259 Vali Acc: 0.292 Test Loss: 3.259 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9349513053894043
Epoch: 14, Steps: 10 | Train Loss: 0.379 Vali Loss: 3.306 Vali Acc: 0.315 Test Loss: 3.306 Test Acc: 0.315
Validation loss decreased (-0.299968 --> -0.315261).  Saving model ...
Epoch: 15 cost time: 0.9224703311920166
Epoch: 15, Steps: 10 | Train Loss: 0.310 Vali Loss: 3.348 Vali Acc: 0.307 Test Loss: 3.348 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8751194477081299
Epoch: 16, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.403 Vali Acc: 0.315 Test Loss: 3.403 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0569067001342773
Epoch: 17, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.434 Vali Acc: 0.319 Test Loss: 3.434 Test Acc: 0.319
Validation loss decreased (-0.315261 --> -0.318789).  Saving model ...
Epoch: 18 cost time: 1.0936062335968018
Epoch: 18, Steps: 10 | Train Loss: 0.103 Vali Loss: 3.528 Vali Acc: 0.320 Test Loss: 3.528 Test Acc: 0.320
Validation loss decreased (-0.318789 --> -0.319965).  Saving model ...
Epoch: 19 cost time: 1.1072492599487305
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.585 Vali Acc: 0.321 Test Loss: 3.585 Test Acc: 0.321
Validation loss decreased (-0.319965 --> -0.321141).  Saving model ...
Epoch: 20 cost time: 1.0685620307922363
Epoch: 20, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.622 Vali Acc: 0.321 Test Loss: 3.622 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.082118034362793
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.624 Vali Acc: 0.331 Test Loss: 3.624 Test Acc: 0.331
Validation loss decreased (-0.321141 --> -0.330552).  Saving model ...
Epoch: 22 cost time: 0.9761571884155273
Epoch: 22, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.673 Vali Acc: 0.332 Test Loss: 3.673 Test Acc: 0.332
Validation loss decreased (-0.330552 --> -0.331728).  Saving model ...
Epoch: 23 cost time: 1.0627593994140625
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.708 Vali Acc: 0.329 Test Loss: 3.708 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.146897792816162
Epoch: 24, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.721 Vali Acc: 0.333 Test Loss: 3.721 Test Acc: 0.333
Validation loss decreased (-0.331728 --> -0.332904).  Saving model ...
Epoch: 25 cost time: 1.1559429168701172
Epoch: 25, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.746 Vali Acc: 0.326 Test Loss: 3.746 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.1661906242370605
Epoch: 26, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.775 Vali Acc: 0.328 Test Loss: 3.775 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0936484336853027
Epoch: 27, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.807 Vali Acc: 0.332 Test Loss: 3.807 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.1900830268859863
Epoch: 28, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.821 Vali Acc: 0.334 Test Loss: 3.821 Test Acc: 0.334
Validation loss decreased (-0.332904 --> -0.334079).  Saving model ...
Epoch: 29 cost time: 1.077573299407959
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.837 Vali Acc: 0.334 Test Loss: 3.837 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.020533800125122
Epoch: 30, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.853 Vali Acc: 0.329 Test Loss: 3.853 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1255552768707275
Epoch: 31, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.877 Vali Acc: 0.332 Test Loss: 3.877 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9349110126495361
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.894 Vali Acc: 0.333 Test Loss: 3.894 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.0075135231018066
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.922 Vali Acc: 0.328 Test Loss: 3.922 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0643272399902344
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.930 Vali Acc: 0.333 Test Loss: 3.930 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0464930534362793
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.935 Vali Acc: 0.333 Test Loss: 3.935 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.102599859237671
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.952 Vali Acc: 0.336 Test Loss: 3.952 Test Acc: 0.336
Validation loss decreased (-0.334079 --> -0.336431).  Saving model ...
Epoch: 37 cost time: 1.0729904174804688
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.972 Vali Acc: 0.333 Test Loss: 3.972 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.0828466415405273
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.977 Vali Acc: 0.336 Test Loss: 3.977 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.9572618007659912
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.997 Vali Acc: 0.334 Test Loss: 3.997 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.03853440284729
Epoch: 40, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.005 Vali Acc: 0.340 Test Loss: 4.005 Test Acc: 0.340
Validation loss decreased (-0.336431 --> -0.339960).  Saving model ...
Epoch: 41 cost time: 0.9696354866027832
Epoch: 41, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.008 Vali Acc: 0.333 Test Loss: 4.008 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.1502234935760498
Epoch: 42, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.006 Vali Acc: 0.332 Test Loss: 4.006 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 1.0863146781921387
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.014 Vali Acc: 0.334 Test Loss: 4.014 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.12996506690979
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.027 Vali Acc: 0.339 Test Loss: 4.027 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.2813661098480225
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.043 Vali Acc: 0.339 Test Loss: 4.043 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1972084045410156
Epoch: 46, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.065 Vali Acc: 0.336 Test Loss: 4.065 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.9347813129425049
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.083 Vali Acc: 0.333 Test Loss: 4.083 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.0277774333953857
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.078 Vali Acc: 0.333 Test Loss: 4.078 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.043229103088379
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.076 Vali Acc: 0.331 Test Loss: 4.076 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0823564529418945
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.085 Vali Acc: 0.339 Test Loss: 4.085 Test Acc: 0.339
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 394098
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7666049003601074
Epoch: 1, Steps: 10 | Train Loss: 3.370 Vali Loss: 3.333 Vali Acc: 0.049 Test Loss: 3.333 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.8500118255615234
Epoch: 2, Steps: 10 | Train Loss: 3.191 Vali Loss: 3.294 Vali Acc: 0.072 Test Loss: 3.294 Test Acc: 0.072
Validation loss decreased (-0.049378 --> -0.071732).  Saving model ...
Epoch: 3 cost time: 0.8473217487335205
Epoch: 3, Steps: 10 | Train Loss: 2.947 Vali Loss: 3.276 Vali Acc: 0.087 Test Loss: 3.276 Test Acc: 0.087
Validation loss decreased (-0.071732 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 0.8615388870239258
Epoch: 4, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.231 Vali Acc: 0.116 Test Loss: 3.231 Test Acc: 0.116
Validation loss decreased (-0.087026 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.906442403793335
Epoch: 5, Steps: 10 | Train Loss: 2.379 Vali Loss: 3.178 Vali Acc: 0.148 Test Loss: 3.178 Test Acc: 0.148
Validation loss decreased (-0.116438 --> -0.148204).  Saving model ...
Epoch: 6 cost time: 0.8781304359436035
Epoch: 6, Steps: 10 | Train Loss: 2.122 Vali Loss: 3.141 Vali Acc: 0.179 Test Loss: 3.141 Test Acc: 0.179
Validation loss decreased (-0.148204 --> -0.178792).  Saving model ...
Epoch: 7 cost time: 0.9589650630950928
Epoch: 7, Steps: 10 | Train Loss: 1.859 Vali Loss: 3.125 Vali Acc: 0.180 Test Loss: 3.125 Test Acc: 0.180
Validation loss decreased (-0.178792 --> -0.179969).  Saving model ...
Epoch: 8 cost time: 0.9363832473754883
Epoch: 8, Steps: 10 | Train Loss: 1.548 Vali Loss: 3.118 Vali Acc: 0.211 Test Loss: 3.118 Test Acc: 0.211
Validation loss decreased (-0.179969 --> -0.210557).  Saving model ...
Epoch: 9 cost time: 1.0045440196990967
Epoch: 9, Steps: 10 | Train Loss: 1.280 Vali Loss: 3.136 Vali Acc: 0.226 Test Loss: 3.136 Test Acc: 0.226
Validation loss decreased (-0.210557 --> -0.225851).  Saving model ...
Epoch: 10 cost time: 0.9522309303283691
Epoch: 10, Steps: 10 | Train Loss: 1.097 Vali Loss: 3.141 Vali Acc: 0.247 Test Loss: 3.141 Test Acc: 0.247
Validation loss decreased (-0.225851 --> -0.247027).  Saving model ...
Epoch: 11 cost time: 0.8422861099243164
Epoch: 11, Steps: 10 | Train Loss: 0.903 Vali Loss: 3.173 Vali Acc: 0.256 Test Loss: 3.173 Test Acc: 0.256
Validation loss decreased (-0.247027 --> -0.256439).  Saving model ...
Epoch: 12 cost time: 0.9050352573394775
Epoch: 12, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.165 Vali Acc: 0.282 Test Loss: 3.165 Test Acc: 0.282
Validation loss decreased (-0.256439 --> -0.282321).  Saving model ...
Epoch: 13 cost time: 0.8733632564544678
Epoch: 13, Steps: 10 | Train Loss: 0.532 Vali Loss: 3.217 Vali Acc: 0.281 Test Loss: 3.217 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.969653844833374
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.268 Vali Acc: 0.299 Test Loss: 3.268 Test Acc: 0.299
Validation loss decreased (-0.282321 --> -0.298791).  Saving model ...
Epoch: 15 cost time: 0.9966566562652588
Epoch: 15, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.299 Vali Acc: 0.305 Test Loss: 3.299 Test Acc: 0.305
Validation loss decreased (-0.298791 --> -0.304673).  Saving model ...
Epoch: 16 cost time: 1.066504955291748
Epoch: 16, Steps: 10 | Train Loss: 0.212 Vali Loss: 3.356 Vali Acc: 0.307 Test Loss: 3.356 Test Acc: 0.307
Validation loss decreased (-0.304673 --> -0.307025).  Saving model ...
Epoch: 17 cost time: 1.0126335620880127
Epoch: 17, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.390 Vali Acc: 0.318 Test Loss: 3.390 Test Acc: 0.318
Validation loss decreased (-0.307025 --> -0.317613).  Saving model ...
Epoch: 18 cost time: 0.9891724586486816
Epoch: 18, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.488 Vali Acc: 0.313 Test Loss: 3.488 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0195364952087402
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.545 Vali Acc: 0.313 Test Loss: 3.545 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.887249231338501
Epoch: 20, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.567 Vali Acc: 0.307 Test Loss: 3.567 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9335207939147949
Epoch: 21, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.571 Vali Acc: 0.316 Test Loss: 3.571 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9982061386108398
Epoch: 22, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.608 Vali Acc: 0.325 Test Loss: 3.608 Test Acc: 0.325
Validation loss decreased (-0.317613 --> -0.324670).  Saving model ...
Epoch: 23 cost time: 0.9137299060821533
Epoch: 23, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.648 Vali Acc: 0.326 Test Loss: 3.648 Test Acc: 0.326
Validation loss decreased (-0.324670 --> -0.325846).  Saving model ...
Epoch: 24 cost time: 0.9528486728668213
Epoch: 24, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.674 Vali Acc: 0.325 Test Loss: 3.674 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0484304428100586
Epoch: 25, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.705 Vali Acc: 0.321 Test Loss: 3.705 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0180168151855469
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.723 Vali Acc: 0.324 Test Loss: 3.723 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.05108642578125
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.724 Vali Acc: 0.328 Test Loss: 3.724 Test Acc: 0.328
Validation loss decreased (-0.325846 --> -0.328198).  Saving model ...
Epoch: 28 cost time: 0.8118581771850586
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.741 Vali Acc: 0.336 Test Loss: 3.741 Test Acc: 0.336
Validation loss decreased (-0.328198 --> -0.336433).  Saving model ...
Epoch: 29 cost time: 0.934715747833252
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.783 Vali Acc: 0.327 Test Loss: 3.783 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9823949337005615
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.823 Vali Acc: 0.331 Test Loss: 3.823 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.87795090675354
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.854 Vali Acc: 0.331 Test Loss: 3.854 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9686849117279053
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.847 Vali Acc: 0.327 Test Loss: 3.847 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9209139347076416
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.856 Vali Acc: 0.333 Test Loss: 3.856 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.9712388515472412
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.853 Vali Acc: 0.329 Test Loss: 3.853 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0518286228179932
Epoch: 35, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.861 Vali Acc: 0.331 Test Loss: 3.861 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8124849796295166
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.880 Vali Acc: 0.326 Test Loss: 3.880 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9237010478973389
Epoch: 37, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.904 Vali Acc: 0.326 Test Loss: 3.904 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.0488848686218262
Epoch: 38, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.918 Vali Acc: 0.329 Test Loss: 3.918 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 394098
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.8355135917663574
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.313 Vali Acc: 0.045 Test Loss: 3.313 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 1.0157647132873535
Epoch: 2, Steps: 10 | Train Loss: 3.164 Vali Loss: 3.277 Vali Acc: 0.064 Test Loss: 3.277 Test Acc: 0.064
Validation loss decreased (-0.044673 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 1.1497957706451416
Epoch: 3, Steps: 10 | Train Loss: 2.952 Vali Loss: 3.262 Vali Acc: 0.088 Test Loss: 3.262 Test Acc: 0.088
Validation loss decreased (-0.063497 --> -0.088203).  Saving model ...
Epoch: 4 cost time: 1.0165648460388184
Epoch: 4, Steps: 10 | Train Loss: 2.745 Vali Loss: 3.227 Vali Acc: 0.127 Test Loss: 3.227 Test Acc: 0.127
Validation loss decreased (-0.088203 --> -0.127027).  Saving model ...
Epoch: 5 cost time: 0.9450087547302246
Epoch: 5, Steps: 10 | Train Loss: 2.388 Vali Loss: 3.180 Vali Acc: 0.149 Test Loss: 3.180 Test Acc: 0.149
Validation loss decreased (-0.127027 --> -0.149380).  Saving model ...
Epoch: 6 cost time: 1.0441482067108154
Epoch: 6, Steps: 10 | Train Loss: 2.159 Vali Loss: 3.139 Vali Acc: 0.178 Test Loss: 3.139 Test Acc: 0.178
Validation loss decreased (-0.149380 --> -0.177616).  Saving model ...
Epoch: 7 cost time: 1.0166053771972656
Epoch: 7, Steps: 10 | Train Loss: 1.907 Vali Loss: 3.117 Vali Acc: 0.196 Test Loss: 3.117 Test Acc: 0.196
Validation loss decreased (-0.177616 --> -0.196439).  Saving model ...
Epoch: 8 cost time: 1.0778698921203613
Epoch: 8, Steps: 10 | Train Loss: 1.610 Vali Loss: 3.102 Vali Acc: 0.219 Test Loss: 3.102 Test Acc: 0.219
Validation loss decreased (-0.196439 --> -0.218793).  Saving model ...
Epoch: 9 cost time: 1.0289092063903809
Epoch: 9, Steps: 10 | Train Loss: 1.350 Vali Loss: 3.107 Vali Acc: 0.228 Test Loss: 3.107 Test Acc: 0.228
Validation loss decreased (-0.218793 --> -0.228204).  Saving model ...
Epoch: 10 cost time: 1.0076801776885986
Epoch: 10, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.099 Vali Acc: 0.251 Test Loss: 3.099 Test Acc: 0.251
Validation loss decreased (-0.228204 --> -0.250557).  Saving model ...
Epoch: 11 cost time: 1.001450777053833
Epoch: 11, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.132 Vali Acc: 0.254 Test Loss: 3.132 Test Acc: 0.254
Validation loss decreased (-0.250557 --> -0.254086).  Saving model ...
Epoch: 12 cost time: 0.9474296569824219
Epoch: 12, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.132 Vali Acc: 0.266 Test Loss: 3.132 Test Acc: 0.266
Validation loss decreased (-0.254086 --> -0.265851).  Saving model ...
Epoch: 13 cost time: 0.7697224617004395
Epoch: 13, Steps: 10 | Train Loss: 0.596 Vali Loss: 3.180 Vali Acc: 0.276 Test Loss: 3.180 Test Acc: 0.276
Validation loss decreased (-0.265851 --> -0.276439).  Saving model ...
Epoch: 14 cost time: 0.7986042499542236
Epoch: 14, Steps: 10 | Train Loss: 0.439 Vali Loss: 3.215 Vali Acc: 0.293 Test Loss: 3.215 Test Acc: 0.293
Validation loss decreased (-0.276439 --> -0.292909).  Saving model ...
Epoch: 15 cost time: 0.768949031829834
Epoch: 15, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.246 Vali Acc: 0.299 Test Loss: 3.246 Test Acc: 0.299
Validation loss decreased (-0.292909 --> -0.298791).  Saving model ...
Epoch: 16 cost time: 0.9348223209381104
Epoch: 16, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.313 Vali Acc: 0.293 Test Loss: 3.313 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.853177547454834
Epoch: 17, Steps: 10 | Train Loss: 0.169 Vali Loss: 3.334 Vali Acc: 0.302 Test Loss: 3.334 Test Acc: 0.302
Validation loss decreased (-0.298791 --> -0.302320).  Saving model ...
Epoch: 18 cost time: 0.8419430255889893
Epoch: 18, Steps: 10 | Train Loss: 0.125 Vali Loss: 3.445 Vali Acc: 0.295 Test Loss: 3.445 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8789911270141602
Epoch: 19, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.503 Vali Acc: 0.294 Test Loss: 3.503 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8939261436462402
Epoch: 20, Steps: 10 | Train Loss: 0.078 Vali Loss: 3.528 Vali Acc: 0.304 Test Loss: 3.528 Test Acc: 0.304
Validation loss decreased (-0.302320 --> -0.303494).  Saving model ...
Epoch: 21 cost time: 1.13413667678833
Epoch: 21, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.528 Vali Acc: 0.314 Test Loss: 3.528 Test Acc: 0.314
Validation loss decreased (-0.303494 --> -0.314082).  Saving model ...
Epoch: 22 cost time: 1.061920166015625
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.565 Vali Acc: 0.313 Test Loss: 3.565 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0372214317321777
Epoch: 23, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.621 Vali Acc: 0.316 Test Loss: 3.621 Test Acc: 0.316
Validation loss decreased (-0.314082 --> -0.316434).  Saving model ...
Epoch: 24 cost time: 0.9954516887664795
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.647 Vali Acc: 0.314 Test Loss: 3.647 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0728917121887207
Epoch: 25, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.664 Vali Acc: 0.305 Test Loss: 3.664 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9821197986602783
Epoch: 26, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.680 Vali Acc: 0.308 Test Loss: 3.680 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.043433427810669
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.683 Vali Acc: 0.315 Test Loss: 3.683 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8421869277954102
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.703 Vali Acc: 0.320 Test Loss: 3.703 Test Acc: 0.320
Validation loss decreased (-0.316434 --> -0.319963).  Saving model ...
Epoch: 29 cost time: 0.9211263656616211
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.726 Vali Acc: 0.315 Test Loss: 3.726 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0916223526000977
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.740 Vali Acc: 0.320 Test Loss: 3.740 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.1569678783416748
Epoch: 31, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.764 Vali Acc: 0.319 Test Loss: 3.764 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0744848251342773
Epoch: 32, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.777 Vali Acc: 0.318 Test Loss: 3.777 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.09092378616333
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.791 Vali Acc: 0.319 Test Loss: 3.791 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.1285009384155273
Epoch: 34, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.798 Vali Acc: 0.320 Test Loss: 3.798 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9922595024108887
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.816 Vali Acc: 0.314 Test Loss: 3.816 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9752752780914307
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.819 Vali Acc: 0.314 Test Loss: 3.819 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0273809432983398
Epoch: 37, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.835 Vali Acc: 0.320 Test Loss: 3.835 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.1309235095977783
Epoch: 38, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.839 Vali Acc: 0.319 Test Loss: 3.839 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32
model parameter : 394098
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.524799108505249
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.291 Vali Acc: 0.046 Test Loss: 3.291 Test Acc: 0.046
Validation loss decreased (inf --> -0.045849).  Saving model ...
Epoch: 2 cost time: 0.9539530277252197
Epoch: 2, Steps: 10 | Train Loss: 3.181 Vali Loss: 3.271 Vali Acc: 0.069 Test Loss: 3.271 Test Acc: 0.069
Validation loss decreased (-0.045849 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.8846867084503174
Epoch: 3, Steps: 10 | Train Loss: 3.003 Vali Loss: 3.264 Vali Acc: 0.096 Test Loss: 3.264 Test Acc: 0.096
Validation loss decreased (-0.069379 --> -0.096438).  Saving model ...
Epoch: 4 cost time: 0.9209256172180176
Epoch: 4, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.241 Vali Acc: 0.113 Test Loss: 3.241 Test Acc: 0.113
Validation loss decreased (-0.096438 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 0.8374502658843994
Epoch: 5, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.206 Vali Acc: 0.134 Test Loss: 3.206 Test Acc: 0.134
Validation loss decreased (-0.112909 --> -0.134086).  Saving model ...
Epoch: 6 cost time: 1.0072293281555176
Epoch: 6, Steps: 10 | Train Loss: 2.393 Vali Loss: 3.166 Vali Acc: 0.160 Test Loss: 3.166 Test Acc: 0.160
Validation loss decreased (-0.134086 --> -0.159968).  Saving model ...
Epoch: 7 cost time: 1.1273634433746338
Epoch: 7, Steps: 10 | Train Loss: 2.155 Vali Loss: 3.131 Vali Acc: 0.172 Test Loss: 3.131 Test Acc: 0.172
Validation loss decreased (-0.159968 --> -0.171733).  Saving model ...
Epoch: 8 cost time: 1.043586254119873
Epoch: 8, Steps: 10 | Train Loss: 1.875 Vali Loss: 3.103 Vali Acc: 0.187 Test Loss: 3.103 Test Acc: 0.187
Validation loss decreased (-0.171733 --> -0.187028).  Saving model ...
Epoch: 9 cost time: 1.0178253650665283
Epoch: 9, Steps: 10 | Train Loss: 1.634 Vali Loss: 3.089 Vali Acc: 0.201 Test Loss: 3.089 Test Acc: 0.201
Validation loss decreased (-0.187028 --> -0.201146).  Saving model ...
Epoch: 10 cost time: 1.0129859447479248
Epoch: 10, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.060 Vali Acc: 0.224 Test Loss: 3.060 Test Acc: 0.224
Validation loss decreased (-0.201146 --> -0.223499).  Saving model ...
Epoch: 11 cost time: 1.0335609912872314
Epoch: 11, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.052 Vali Acc: 0.239 Test Loss: 3.052 Test Acc: 0.239
Validation loss decreased (-0.223499 --> -0.238793).  Saving model ...
Epoch: 12 cost time: 1.0350182056427002
Epoch: 12, Steps: 10 | Train Loss: 1.067 Vali Loss: 3.036 Vali Acc: 0.252 Test Loss: 3.036 Test Acc: 0.252
Validation loss decreased (-0.238793 --> -0.251734).  Saving model ...
Epoch: 13 cost time: 0.9216008186340332
Epoch: 13, Steps: 10 | Train Loss: 0.831 Vali Loss: 3.043 Vali Acc: 0.241 Test Loss: 3.043 Test Acc: 0.241
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0215191841125488
Epoch: 14, Steps: 10 | Train Loss: 0.652 Vali Loss: 3.077 Vali Acc: 0.262 Test Loss: 3.077 Test Acc: 0.262
Validation loss decreased (-0.251734 --> -0.262322).  Saving model ...
Epoch: 15 cost time: 1.158308744430542
Epoch: 15, Steps: 10 | Train Loss: 0.524 Vali Loss: 3.101 Vali Acc: 0.278 Test Loss: 3.101 Test Acc: 0.278
Validation loss decreased (-0.262322 --> -0.277616).  Saving model ...
Epoch: 16 cost time: 1.1067352294921875
Epoch: 16, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.150 Vali Acc: 0.258 Test Loss: 3.150 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.048774242401123
Epoch: 17, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.153 Vali Acc: 0.269 Test Loss: 3.153 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2412073612213135
Epoch: 18, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.217 Vali Acc: 0.275 Test Loss: 3.217 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.129253625869751
Epoch: 19, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.306 Vali Acc: 0.268 Test Loss: 3.306 Test Acc: 0.268
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1002519130706787
Epoch: 20, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.344 Vali Acc: 0.262 Test Loss: 3.344 Test Acc: 0.262
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.0987462997436523
Epoch: 21, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.353 Vali Acc: 0.274 Test Loss: 3.353 Test Acc: 0.274
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9953281879425049
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.413 Vali Acc: 0.276 Test Loss: 3.413 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9571864604949951
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.470 Vali Acc: 0.268 Test Loss: 3.470 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0899238586425781
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.504 Vali Acc: 0.273 Test Loss: 3.504 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.029029369354248
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.506 Vali Acc: 0.276 Test Loss: 3.506 Test Acc: 0.276
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2776470588235294
model parameter : 394098
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.574676752090454
Epoch: 1, Steps: 10 | Train Loss: 3.455 Vali Loss: 3.329 Vali Acc: 0.042 Test Loss: 3.329 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.9413187503814697
Epoch: 2, Steps: 10 | Train Loss: 3.272 Vali Loss: 3.265 Vali Acc: 0.064 Test Loss: 3.265 Test Acc: 0.064
Validation loss decreased (-0.042320 --> -0.063497).  Saving model ...
Epoch: 3 cost time: 0.8976874351501465
Epoch: 3, Steps: 10 | Train Loss: 2.948 Vali Loss: 3.237 Vali Acc: 0.091 Test Loss: 3.237 Test Acc: 0.091
Validation loss decreased (-0.063497 --> -0.090556).  Saving model ...
Epoch: 4 cost time: 0.8084120750427246
Epoch: 4, Steps: 10 | Train Loss: 2.711 Vali Loss: 3.213 Vali Acc: 0.124 Test Loss: 3.213 Test Acc: 0.124
Validation loss decreased (-0.090556 --> -0.123497).  Saving model ...
Epoch: 5 cost time: 0.9173891544342041
Epoch: 5, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.171 Vali Acc: 0.148 Test Loss: 3.171 Test Acc: 0.148
Validation loss decreased (-0.123497 --> -0.148204).  Saving model ...
Epoch: 6 cost time: 0.8703482151031494
Epoch: 6, Steps: 10 | Train Loss: 2.116 Vali Loss: 3.111 Vali Acc: 0.167 Test Loss: 3.111 Test Acc: 0.167
Validation loss decreased (-0.148204 --> -0.167028).  Saving model ...
Epoch: 7 cost time: 0.9648213386535645
Epoch: 7, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.085 Vali Acc: 0.195 Test Loss: 3.085 Test Acc: 0.195
Validation loss decreased (-0.167028 --> -0.195263).  Saving model ...
Epoch: 8 cost time: 0.9672300815582275
Epoch: 8, Steps: 10 | Train Loss: 1.562 Vali Loss: 3.072 Vali Acc: 0.215 Test Loss: 3.072 Test Acc: 0.215
Validation loss decreased (-0.195263 --> -0.215263).  Saving model ...
Epoch: 9 cost time: 1.0375597476959229
Epoch: 9, Steps: 10 | Train Loss: 1.325 Vali Loss: 3.086 Vali Acc: 0.221 Test Loss: 3.086 Test Acc: 0.221
Validation loss decreased (-0.215263 --> -0.221146).  Saving model ...
Epoch: 10 cost time: 0.9841053485870361
Epoch: 10, Steps: 10 | Train Loss: 1.014 Vali Loss: 3.101 Vali Acc: 0.231 Test Loss: 3.101 Test Acc: 0.231
Validation loss decreased (-0.221146 --> -0.230557).  Saving model ...
Epoch: 11 cost time: 1.021831750869751
Epoch: 11, Steps: 10 | Train Loss: 0.843 Vali Loss: 3.122 Vali Acc: 0.254 Test Loss: 3.122 Test Acc: 0.254
Validation loss decreased (-0.230557 --> -0.254086).  Saving model ...
Epoch: 12 cost time: 0.9222908020019531
Epoch: 12, Steps: 10 | Train Loss: 0.669 Vali Loss: 3.161 Vali Acc: 0.266 Test Loss: 3.161 Test Acc: 0.266
Validation loss decreased (-0.254086 --> -0.265851).  Saving model ...
Epoch: 13 cost time: 0.9381508827209473
Epoch: 13, Steps: 10 | Train Loss: 0.541 Vali Loss: 3.224 Vali Acc: 0.262 Test Loss: 3.224 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1709330081939697
Epoch: 14, Steps: 10 | Train Loss: 0.395 Vali Loss: 3.251 Vali Acc: 0.292 Test Loss: 3.251 Test Acc: 0.292
Validation loss decreased (-0.265851 --> -0.291732).  Saving model ...
Epoch: 15 cost time: 1.0385398864746094
Epoch: 15, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.317 Vali Acc: 0.302 Test Loss: 3.317 Test Acc: 0.302
Validation loss decreased (-0.291732 --> -0.302320).  Saving model ...
Epoch: 16 cost time: 1.0637264251708984
Epoch: 16, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.347 Vali Acc: 0.312 Test Loss: 3.347 Test Acc: 0.312
Validation loss decreased (-0.302320 --> -0.311731).  Saving model ...
Epoch: 17 cost time: 1.1118824481964111
Epoch: 17, Steps: 10 | Train Loss: 0.161 Vali Loss: 3.384 Vali Acc: 0.312 Test Loss: 3.384 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9930651187896729
Epoch: 18, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.473 Vali Acc: 0.314 Test Loss: 3.473 Test Acc: 0.314
Validation loss decreased (-0.311731 --> -0.314083).  Saving model ...
Epoch: 19 cost time: 0.9767048358917236
Epoch: 19, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.523 Vali Acc: 0.325 Test Loss: 3.523 Test Acc: 0.325
Validation loss decreased (-0.314083 --> -0.324671).  Saving model ...
Epoch: 20 cost time: 0.8303759098052979
Epoch: 20, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.562 Vali Acc: 0.325 Test Loss: 3.562 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9217958450317383
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.589 Vali Acc: 0.332 Test Loss: 3.589 Test Acc: 0.332
Validation loss decreased (-0.324671 --> -0.331729).  Saving model ...
Epoch: 22 cost time: 0.9626867771148682
Epoch: 22, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.608 Vali Acc: 0.340 Test Loss: 3.608 Test Acc: 0.340
Validation loss decreased (-0.331729 --> -0.339964).  Saving model ...
Epoch: 23 cost time: 0.833899736404419
Epoch: 23, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.617 Vali Acc: 0.335 Test Loss: 3.617 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0434489250183105
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.663 Vali Acc: 0.336 Test Loss: 3.663 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9716148376464844
Epoch: 25, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.685 Vali Acc: 0.334 Test Loss: 3.685 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.923555850982666
Epoch: 26, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.716 Vali Acc: 0.332 Test Loss: 3.716 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9810600280761719
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.716 Vali Acc: 0.333 Test Loss: 3.716 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.9509928226470947
Epoch: 28, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.731 Vali Acc: 0.339 Test Loss: 3.731 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8811147212982178
Epoch: 29, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.759 Vali Acc: 0.340 Test Loss: 3.759 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8264827728271484
Epoch: 30, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.775 Vali Acc: 0.333 Test Loss: 3.775 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.926990270614624
Epoch: 31, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.799 Vali Acc: 0.339 Test Loss: 3.799 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.8930783271789551
Epoch: 32, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.826 Vali Acc: 0.340 Test Loss: 3.826 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 263026
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6450259685516357
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.311 Vali Acc: 0.047 Test Loss: 3.311 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.9506838321685791
Epoch: 2, Steps: 10 | Train Loss: 3.269 Vali Loss: 3.254 Vali Acc: 0.069 Test Loss: 3.254 Test Acc: 0.069
Validation loss decreased (-0.047026 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 1.037548303604126
Epoch: 3, Steps: 10 | Train Loss: 2.982 Vali Loss: 3.232 Vali Acc: 0.084 Test Loss: 3.232 Test Acc: 0.084
Validation loss decreased (-0.069379 --> -0.083497).  Saving model ...
Epoch: 4 cost time: 0.9343268871307373
Epoch: 4, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.213 Vali Acc: 0.105 Test Loss: 3.213 Test Acc: 0.105
Validation loss decreased (-0.083497 --> -0.104674).  Saving model ...
Epoch: 5 cost time: 0.9738364219665527
Epoch: 5, Steps: 10 | Train Loss: 2.478 Vali Loss: 3.175 Vali Acc: 0.133 Test Loss: 3.175 Test Acc: 0.133
Validation loss decreased (-0.104674 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 0.8656735420227051
Epoch: 6, Steps: 10 | Train Loss: 2.150 Vali Loss: 3.119 Vali Acc: 0.155 Test Loss: 3.119 Test Acc: 0.155
Validation loss decreased (-0.132909 --> -0.155263).  Saving model ...
Epoch: 7 cost time: 1.0116732120513916
Epoch: 7, Steps: 10 | Train Loss: 1.887 Vali Loss: 3.090 Vali Acc: 0.186 Test Loss: 3.090 Test Acc: 0.186
Validation loss decreased (-0.155263 --> -0.185851).  Saving model ...
Epoch: 8 cost time: 0.9797618389129639
Epoch: 8, Steps: 10 | Train Loss: 1.609 Vali Loss: 3.070 Vali Acc: 0.207 Test Loss: 3.070 Test Acc: 0.207
Validation loss decreased (-0.185851 --> -0.207028).  Saving model ...
Epoch: 9 cost time: 0.9182729721069336
Epoch: 9, Steps: 10 | Train Loss: 1.360 Vali Loss: 3.083 Vali Acc: 0.224 Test Loss: 3.083 Test Acc: 0.224
Validation loss decreased (-0.207028 --> -0.223499).  Saving model ...
Epoch: 10 cost time: 0.9861681461334229
Epoch: 10, Steps: 10 | Train Loss: 1.088 Vali Loss: 3.097 Vali Acc: 0.242 Test Loss: 3.097 Test Acc: 0.242
Validation loss decreased (-0.223499 --> -0.242322).  Saving model ...
Epoch: 11 cost time: 1.0032219886779785
Epoch: 11, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.115 Vali Acc: 0.248 Test Loss: 3.115 Test Acc: 0.248
Validation loss decreased (-0.242322 --> -0.248204).  Saving model ...
Epoch: 12 cost time: 0.8675205707550049
Epoch: 12, Steps: 10 | Train Loss: 0.706 Vali Loss: 3.148 Vali Acc: 0.262 Test Loss: 3.148 Test Acc: 0.262
Validation loss decreased (-0.248204 --> -0.262321).  Saving model ...
Epoch: 13 cost time: 0.8764734268188477
Epoch: 13, Steps: 10 | Train Loss: 0.583 Vali Loss: 3.210 Vali Acc: 0.262 Test Loss: 3.210 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8513216972351074
Epoch: 14, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.222 Vali Acc: 0.276 Test Loss: 3.222 Test Acc: 0.276
Validation loss decreased (-0.262321 --> -0.276438).  Saving model ...
Epoch: 15 cost time: 0.9477620124816895
Epoch: 15, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.277 Vali Acc: 0.279 Test Loss: 3.277 Test Acc: 0.279
Validation loss decreased (-0.276438 --> -0.278791).  Saving model ...
Epoch: 16 cost time: 0.9669184684753418
Epoch: 16, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.321 Vali Acc: 0.307 Test Loss: 3.321 Test Acc: 0.307
Validation loss decreased (-0.278791 --> -0.307026).  Saving model ...
Epoch: 17 cost time: 1.0802481174468994
Epoch: 17, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.357 Vali Acc: 0.308 Test Loss: 3.357 Test Acc: 0.308
Validation loss decreased (-0.307026 --> -0.308202).  Saving model ...
Epoch: 18 cost time: 1.0010132789611816
Epoch: 18, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.434 Vali Acc: 0.313 Test Loss: 3.434 Test Acc: 0.313
Validation loss decreased (-0.308202 --> -0.312907).  Saving model ...
Epoch: 19 cost time: 0.9295840263366699
Epoch: 19, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.490 Vali Acc: 0.313 Test Loss: 3.490 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9710118770599365
Epoch: 20, Steps: 10 | Train Loss: 0.082 Vali Loss: 3.564 Vali Acc: 0.322 Test Loss: 3.564 Test Acc: 0.322
Validation loss decreased (-0.312907 --> -0.322317).  Saving model ...
Epoch: 21 cost time: 0.9455115795135498
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.591 Vali Acc: 0.318 Test Loss: 3.591 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9017131328582764
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.587 Vali Acc: 0.324 Test Loss: 3.587 Test Acc: 0.324
Validation loss decreased (-0.322317 --> -0.323494).  Saving model ...
Epoch: 23 cost time: 0.9789562225341797
Epoch: 23, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.588 Vali Acc: 0.327 Test Loss: 3.588 Test Acc: 0.327
Validation loss decreased (-0.323494 --> -0.327023).  Saving model ...
Epoch: 24 cost time: 1.0272998809814453
Epoch: 24, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.652 Vali Acc: 0.328 Test Loss: 3.652 Test Acc: 0.328
Validation loss decreased (-0.327023 --> -0.328199).  Saving model ...
Epoch: 25 cost time: 1.0262551307678223
Epoch: 25, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.667 Vali Acc: 0.325 Test Loss: 3.667 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.0219006538391113
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.696 Vali Acc: 0.329 Test Loss: 3.696 Test Acc: 0.329
Validation loss decreased (-0.328199 --> -0.329375).  Saving model ...
Epoch: 27 cost time: 0.9711062908172607
Epoch: 27, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.701 Vali Acc: 0.325 Test Loss: 3.701 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.0355074405670166
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.706 Vali Acc: 0.326 Test Loss: 3.706 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0831799507141113
Epoch: 29, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.735 Vali Acc: 0.320 Test Loss: 3.735 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0244791507720947
Epoch: 30, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.743 Vali Acc: 0.328 Test Loss: 3.743 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.842923641204834
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.776 Vali Acc: 0.325 Test Loss: 3.776 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8068175315856934
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.797 Vali Acc: 0.329 Test Loss: 3.797 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9081118106842041
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.803 Vali Acc: 0.331 Test Loss: 3.803 Test Acc: 0.331
Validation loss decreased (-0.329375 --> -0.330550).  Saving model ...
Epoch: 34 cost time: 0.9674460887908936
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.818 Vali Acc: 0.333 Test Loss: 3.818 Test Acc: 0.333
Validation loss decreased (-0.330550 --> -0.332903).  Saving model ...
Epoch: 35 cost time: 0.979750394821167
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.831 Vali Acc: 0.332 Test Loss: 3.831 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.952023983001709
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.853 Vali Acc: 0.335 Test Loss: 3.853 Test Acc: 0.335
Validation loss decreased (-0.332903 --> -0.335256).  Saving model ...
Epoch: 37 cost time: 1.0533177852630615
Epoch: 37, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.871 Vali Acc: 0.332 Test Loss: 3.871 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.9578025341033936
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.882 Vali Acc: 0.334 Test Loss: 3.882 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.0022790431976318
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.896 Vali Acc: 0.329 Test Loss: 3.896 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7954838275909424
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.914 Vali Acc: 0.322 Test Loss: 3.914 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.9149060249328613
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.917 Vali Acc: 0.328 Test Loss: 3.917 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.9323258399963379
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.934 Vali Acc: 0.333 Test Loss: 3.934 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.9516730308532715
Epoch: 43, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.955 Vali Acc: 0.333 Test Loss: 3.955 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.9782421588897705
Epoch: 44, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.969 Vali Acc: 0.331 Test Loss: 3.969 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.9135904312133789
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.989 Vali Acc: 0.339 Test Loss: 3.989 Test Acc: 0.339
Validation loss decreased (-0.335256 --> -0.338784).  Saving model ...
Epoch: 46 cost time: 0.9520447254180908
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.006 Vali Acc: 0.335 Test Loss: 4.006 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.9513089656829834
Epoch: 47, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.017 Vali Acc: 0.333 Test Loss: 4.017 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.9986615180969238
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.015 Vali Acc: 0.332 Test Loss: 4.015 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 1.0186741352081299
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.020 Vali Acc: 0.332 Test Loss: 4.020 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.9704709053039551
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.025 Vali Acc: 0.331 Test Loss: 4.025 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.743715763092041
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.036 Vali Acc: 0.335 Test Loss: 4.036 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 1.0553293228149414
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.048 Vali Acc: 0.338 Test Loss: 4.048 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 1.0319714546203613
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.062 Vali Acc: 0.333 Test Loss: 4.062 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 1.035079002380371
Epoch: 54, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.072 Vali Acc: 0.334 Test Loss: 4.072 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 1.110050916671753
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.082 Vali Acc: 0.334 Test Loss: 4.082 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 263026
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.365222692489624
Epoch: 1, Steps: 10 | Train Loss: 3.376 Vali Loss: 3.300 Vali Acc: 0.038 Test Loss: 3.300 Test Acc: 0.038
Validation loss decreased (inf --> -0.037614).  Saving model ...
Epoch: 2 cost time: 0.8383922576904297
Epoch: 2, Steps: 10 | Train Loss: 3.231 Vali Loss: 3.253 Vali Acc: 0.068 Test Loss: 3.253 Test Acc: 0.068
Validation loss decreased (-0.037614 --> -0.068203).  Saving model ...
Epoch: 3 cost time: 0.9770920276641846
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.233 Vali Acc: 0.080 Test Loss: 3.233 Test Acc: 0.080
Validation loss decreased (-0.068203 --> -0.079968).  Saving model ...
Epoch: 4 cost time: 1.0109455585479736
Epoch: 4, Steps: 10 | Train Loss: 2.723 Vali Loss: 3.215 Vali Acc: 0.109 Test Loss: 3.215 Test Acc: 0.109
Validation loss decreased (-0.079968 --> -0.109380).  Saving model ...
Epoch: 5 cost time: 1.0514731407165527
Epoch: 5, Steps: 10 | Train Loss: 2.517 Vali Loss: 3.181 Vali Acc: 0.136 Test Loss: 3.181 Test Acc: 0.136
Validation loss decreased (-0.109380 --> -0.136439).  Saving model ...
Epoch: 6 cost time: 1.0083928108215332
Epoch: 6, Steps: 10 | Train Loss: 2.186 Vali Loss: 3.125 Vali Acc: 0.160 Test Loss: 3.125 Test Acc: 0.160
Validation loss decreased (-0.136439 --> -0.159969).  Saving model ...
Epoch: 7 cost time: 0.9786646366119385
Epoch: 7, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.094 Vali Acc: 0.181 Test Loss: 3.094 Test Acc: 0.181
Validation loss decreased (-0.159969 --> -0.181146).  Saving model ...
Epoch: 8 cost time: 0.8531548976898193
Epoch: 8, Steps: 10 | Train Loss: 1.704 Vali Loss: 3.068 Vali Acc: 0.202 Test Loss: 3.068 Test Acc: 0.202
Validation loss decreased (-0.181146 --> -0.202322).  Saving model ...
Epoch: 9 cost time: 0.7987251281738281
Epoch: 9, Steps: 10 | Train Loss: 1.419 Vali Loss: 3.070 Vali Acc: 0.215 Test Loss: 3.070 Test Acc: 0.215
Validation loss decreased (-0.202322 --> -0.215263).  Saving model ...
Epoch: 10 cost time: 0.9204652309417725
Epoch: 10, Steps: 10 | Train Loss: 1.177 Vali Loss: 3.078 Vali Acc: 0.231 Test Loss: 3.078 Test Acc: 0.231
Validation loss decreased (-0.215263 --> -0.230557).  Saving model ...
Epoch: 11 cost time: 0.9162719249725342
Epoch: 11, Steps: 10 | Train Loss: 0.965 Vali Loss: 3.088 Vali Acc: 0.249 Test Loss: 3.088 Test Acc: 0.249
Validation loss decreased (-0.230557 --> -0.249381).  Saving model ...
Epoch: 12 cost time: 0.9408235549926758
Epoch: 12, Steps: 10 | Train Loss: 0.775 Vali Loss: 3.113 Vali Acc: 0.256 Test Loss: 3.113 Test Acc: 0.256
Validation loss decreased (-0.249381 --> -0.256439).  Saving model ...
Epoch: 13 cost time: 0.8608827590942383
Epoch: 13, Steps: 10 | Train Loss: 0.632 Vali Loss: 3.167 Vali Acc: 0.266 Test Loss: 3.167 Test Acc: 0.266
Validation loss decreased (-0.256439 --> -0.265851).  Saving model ...
Epoch: 14 cost time: 1.0029387474060059
Epoch: 14, Steps: 10 | Train Loss: 0.476 Vali Loss: 3.192 Vali Acc: 0.262 Test Loss: 3.192 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0111908912658691
Epoch: 15, Steps: 10 | Train Loss: 0.369 Vali Loss: 3.233 Vali Acc: 0.273 Test Loss: 3.233 Test Acc: 0.273
Validation loss decreased (-0.265851 --> -0.272909).  Saving model ...
Epoch: 16 cost time: 0.9206359386444092
Epoch: 16, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.289 Vali Acc: 0.293 Test Loss: 3.289 Test Acc: 0.293
Validation loss decreased (-0.272909 --> -0.292908).  Saving model ...
Epoch: 17 cost time: 1.0404284000396729
Epoch: 17, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.336 Vali Acc: 0.299 Test Loss: 3.336 Test Acc: 0.299
Validation loss decreased (-0.292908 --> -0.298790).  Saving model ...
Epoch: 18 cost time: 1.0405151844024658
Epoch: 18, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.377 Vali Acc: 0.300 Test Loss: 3.377 Test Acc: 0.300
Validation loss decreased (-0.298790 --> -0.299966).  Saving model ...
Epoch: 19 cost time: 1.0554327964782715
Epoch: 19, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.425 Vali Acc: 0.293 Test Loss: 3.425 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.076181411743164
Epoch: 20, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.486 Vali Acc: 0.306 Test Loss: 3.486 Test Acc: 0.306
Validation loss decreased (-0.299966 --> -0.305847).  Saving model ...
Epoch: 21 cost time: 1.0398621559143066
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.533 Vali Acc: 0.307 Test Loss: 3.533 Test Acc: 0.307
Validation loss decreased (-0.305847 --> -0.307023).  Saving model ...
Epoch: 22 cost time: 0.9641199111938477
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.537 Vali Acc: 0.302 Test Loss: 3.537 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9992337226867676
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.541 Vali Acc: 0.302 Test Loss: 3.541 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.038801670074463
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.590 Vali Acc: 0.302 Test Loss: 3.590 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8984975814819336
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.602 Vali Acc: 0.309 Test Loss: 3.602 Test Acc: 0.309
Validation loss decreased (-0.307023 --> -0.309376).  Saving model ...
Epoch: 26 cost time: 0.8720731735229492
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.647 Vali Acc: 0.313 Test Loss: 3.647 Test Acc: 0.313
Validation loss decreased (-0.309376 --> -0.312905).  Saving model ...
Epoch: 27 cost time: 0.862210750579834
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.675 Vali Acc: 0.313 Test Loss: 3.675 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9218337535858154
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.690 Vali Acc: 0.313 Test Loss: 3.690 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9916486740112305
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.705 Vali Acc: 0.308 Test Loss: 3.705 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0520715713500977
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.705 Vali Acc: 0.306 Test Loss: 3.705 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.016303539276123
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.718 Vali Acc: 0.307 Test Loss: 3.718 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.9746975898742676
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.747 Vali Acc: 0.312 Test Loss: 3.747 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9840662479400635
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.764 Vali Acc: 0.312 Test Loss: 3.764 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8787775039672852
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.773 Vali Acc: 0.307 Test Loss: 3.773 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8253912925720215
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.786 Vali Acc: 0.307 Test Loss: 3.786 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9274551868438721
Epoch: 36, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.809 Vali Acc: 0.305 Test Loss: 3.809 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 263026
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.49027419090271
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.282 Vali Acc: 0.047 Test Loss: 3.282 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 1.0179970264434814
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.252 Vali Acc: 0.061 Test Loss: 3.252 Test Acc: 0.061
Validation loss decreased (-0.047026 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.9240646362304688
Epoch: 3, Steps: 10 | Train Loss: 3.019 Vali Loss: 3.243 Vali Acc: 0.086 Test Loss: 3.243 Test Acc: 0.086
Validation loss decreased (-0.061144 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.8379726409912109
Epoch: 4, Steps: 10 | Train Loss: 2.819 Vali Loss: 3.235 Vali Acc: 0.115 Test Loss: 3.235 Test Acc: 0.115
Validation loss decreased (-0.085850 --> -0.115262).  Saving model ...
Epoch: 5 cost time: 0.8704526424407959
Epoch: 5, Steps: 10 | Train Loss: 2.663 Vali Loss: 3.211 Vali Acc: 0.140 Test Loss: 3.211 Test Acc: 0.140
Validation loss decreased (-0.115262 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 0.95670485496521
Epoch: 6, Steps: 10 | Train Loss: 2.411 Vali Loss: 3.163 Vali Acc: 0.147 Test Loss: 3.163 Test Acc: 0.147
Validation loss decreased (-0.139968 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 1.027073860168457
Epoch: 7, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.122 Vali Acc: 0.149 Test Loss: 3.122 Test Acc: 0.149
Validation loss decreased (-0.147027 --> -0.149381).  Saving model ...
Epoch: 8 cost time: 1.036679983139038
Epoch: 8, Steps: 10 | Train Loss: 1.981 Vali Loss: 3.083 Vali Acc: 0.168 Test Loss: 3.083 Test Acc: 0.168
Validation loss decreased (-0.149381 --> -0.168204).  Saving model ...
Epoch: 9 cost time: 1.0411863327026367
Epoch: 9, Steps: 10 | Train Loss: 1.743 Vali Loss: 3.067 Vali Acc: 0.192 Test Loss: 3.067 Test Acc: 0.192
Validation loss decreased (-0.168204 --> -0.191734).  Saving model ...
Epoch: 10 cost time: 1.0354597568511963
Epoch: 10, Steps: 10 | Train Loss: 1.485 Vali Loss: 3.053 Vali Acc: 0.209 Test Loss: 3.053 Test Acc: 0.209
Validation loss decreased (-0.191734 --> -0.209381).  Saving model ...
Epoch: 11 cost time: 0.9911367893218994
Epoch: 11, Steps: 10 | Train Loss: 1.281 Vali Loss: 3.036 Vali Acc: 0.227 Test Loss: 3.036 Test Acc: 0.227
Validation loss decreased (-0.209381 --> -0.227028).  Saving model ...
Epoch: 12 cost time: 1.0595076084136963
Epoch: 12, Steps: 10 | Train Loss: 1.041 Vali Loss: 3.039 Vali Acc: 0.226 Test Loss: 3.039 Test Acc: 0.226
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0155596733093262
Epoch: 13, Steps: 10 | Train Loss: 0.888 Vali Loss: 3.075 Vali Acc: 0.234 Test Loss: 3.075 Test Acc: 0.234
Validation loss decreased (-0.227028 --> -0.234087).  Saving model ...
Epoch: 14 cost time: 0.9256141185760498
Epoch: 14, Steps: 10 | Train Loss: 0.701 Vali Loss: 3.075 Vali Acc: 0.248 Test Loss: 3.075 Test Acc: 0.248
Validation loss decreased (-0.234087 --> -0.248205).  Saving model ...
Epoch: 15 cost time: 0.9885923862457275
Epoch: 15, Steps: 10 | Train Loss: 0.535 Vali Loss: 3.094 Vali Acc: 0.254 Test Loss: 3.094 Test Acc: 0.254
Validation loss decreased (-0.248205 --> -0.254087).  Saving model ...
Epoch: 16 cost time: 0.8864579200744629
Epoch: 16, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.118 Vali Acc: 0.262 Test Loss: 3.118 Test Acc: 0.262
Validation loss decreased (-0.254087 --> -0.262322).  Saving model ...
Epoch: 17 cost time: 0.9704349040985107
Epoch: 17, Steps: 10 | Train Loss: 0.301 Vali Loss: 3.135 Vali Acc: 0.272 Test Loss: 3.135 Test Acc: 0.272
Validation loss decreased (-0.262322 --> -0.271733).  Saving model ...
Epoch: 18 cost time: 0.9985940456390381
Epoch: 18, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.191 Vali Acc: 0.281 Test Loss: 3.191 Test Acc: 0.281
Validation loss decreased (-0.271733 --> -0.281145).  Saving model ...
Epoch: 19 cost time: 1.0579097270965576
Epoch: 19, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.221 Vali Acc: 0.284 Test Loss: 3.221 Test Acc: 0.284
Validation loss decreased (-0.281145 --> -0.283497).  Saving model ...
Epoch: 20 cost time: 1.125425100326538
Epoch: 20, Steps: 10 | Train Loss: 0.135 Vali Loss: 3.245 Vali Acc: 0.281 Test Loss: 3.245 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9016125202178955
Epoch: 21, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.278 Vali Acc: 0.285 Test Loss: 3.278 Test Acc: 0.285
Validation loss decreased (-0.283497 --> -0.284673).  Saving model ...
Epoch: 22 cost time: 1.0033009052276611
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.295 Vali Acc: 0.287 Test Loss: 3.295 Test Acc: 0.287
Validation loss decreased (-0.284673 --> -0.287026).  Saving model ...
Epoch: 23 cost time: 0.9364204406738281
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.325 Vali Acc: 0.291 Test Loss: 3.325 Test Acc: 0.291
Validation loss decreased (-0.287026 --> -0.290555).  Saving model ...
Epoch: 24 cost time: 1.0037741661071777
Epoch: 24, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.361 Vali Acc: 0.284 Test Loss: 3.361 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0714309215545654
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.373 Vali Acc: 0.291 Test Loss: 3.373 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9805142879486084
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.409 Vali Acc: 0.291 Test Loss: 3.409 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0795984268188477
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.416 Vali Acc: 0.289 Test Loss: 3.416 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0119662284851074
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.420 Vali Acc: 0.288 Test Loss: 3.420 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9857277870178223
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.453 Vali Acc: 0.298 Test Loss: 3.453 Test Acc: 0.298
Validation loss decreased (-0.290555 --> -0.297613).  Saving model ...
Epoch: 30 cost time: 1.059854507446289
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.465 Vali Acc: 0.296 Test Loss: 3.465 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0651655197143555
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.477 Vali Acc: 0.292 Test Loss: 3.477 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1719706058502197
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.508 Vali Acc: 0.289 Test Loss: 3.508 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.9183225631713867
Epoch: 33, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.530 Vali Acc: 0.292 Test Loss: 3.530 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.9037158489227295
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.545 Vali Acc: 0.295 Test Loss: 3.545 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.8576595783233643
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.556 Vali Acc: 0.296 Test Loss: 3.556 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0103240013122559
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.584 Vali Acc: 0.294 Test Loss: 3.584 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9755363464355469
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.599 Vali Acc: 0.298 Test Loss: 3.599 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.041818618774414
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.603 Vali Acc: 0.298 Test Loss: 3.603 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.9881067276000977
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.612 Vali Acc: 0.300 Test Loss: 3.612 Test Acc: 0.300
Validation loss decreased (-0.297613 --> -0.299964).  Saving model ...
Epoch: 40 cost time: 0.9624803066253662
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.622 Vali Acc: 0.299 Test Loss: 3.622 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.999323844909668
Epoch: 41, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.628 Vali Acc: 0.295 Test Loss: 3.628 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9724721908569336
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.644 Vali Acc: 0.300 Test Loss: 3.644 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.8261208534240723
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.658 Vali Acc: 0.296 Test Loss: 3.658 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.9004576206207275
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.673 Vali Acc: 0.299 Test Loss: 3.673 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 1.0640840530395508
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.691 Vali Acc: 0.298 Test Loss: 3.691 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 1.0127017498016357
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.698 Vali Acc: 0.301 Test Loss: 3.698 Test Acc: 0.301
Validation loss decreased (-0.299964 --> -0.301139).  Saving model ...
Epoch: 47 cost time: 1.0817654132843018
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.701 Vali Acc: 0.301 Test Loss: 3.701 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 1.0505812168121338
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.718 Vali Acc: 0.296 Test Loss: 3.718 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 1.2258822917938232
Epoch: 49, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.739 Vali Acc: 0.291 Test Loss: 3.739 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 1.0129320621490479
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.754 Vali Acc: 0.292 Test Loss: 3.754 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 1.0461838245391846
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.758 Vali Acc: 0.292 Test Loss: 3.758 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.9829506874084473
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.766 Vali Acc: 0.293 Test Loss: 3.766 Test Acc: 0.293
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 1.020653247833252
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.771 Vali Acc: 0.294 Test Loss: 3.771 Test Acc: 0.294
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 1.0254464149475098
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.777 Vali Acc: 0.293 Test Loss: 3.777 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 1.1771578788757324
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.783 Vali Acc: 0.294 Test Loss: 3.783 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 1.0819590091705322
Epoch: 56, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.798 Vali Acc: 0.296 Test Loss: 3.798 Test Acc: 0.296
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 263026
model size : 1.63MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5171139240264893
Epoch: 1, Steps: 10 | Train Loss: 3.440 Vali Loss: 3.361 Vali Acc: 0.035 Test Loss: 3.361 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.8994569778442383
Epoch: 2, Steps: 10 | Train Loss: 3.244 Vali Loss: 3.292 Vali Acc: 0.051 Test Loss: 3.292 Test Acc: 0.051
Validation loss decreased (-0.035261 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.9208939075469971
Epoch: 3, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.273 Vali Acc: 0.081 Test Loss: 3.273 Test Acc: 0.081
Validation loss decreased (-0.050555 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.8872535228729248
Epoch: 4, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.235 Vali Acc: 0.105 Test Loss: 3.235 Test Acc: 0.105
Validation loss decreased (-0.081144 --> -0.104674).  Saving model ...
Epoch: 5 cost time: 0.9959197044372559
Epoch: 5, Steps: 10 | Train Loss: 2.433 Vali Loss: 3.188 Vali Acc: 0.146 Test Loss: 3.188 Test Acc: 0.146
Validation loss decreased (-0.104674 --> -0.145850).  Saving model ...
Epoch: 6 cost time: 0.9904284477233887
Epoch: 6, Steps: 10 | Train Loss: 2.057 Vali Loss: 3.152 Vali Acc: 0.174 Test Loss: 3.152 Test Acc: 0.174
Validation loss decreased (-0.145850 --> -0.174086).  Saving model ...
Epoch: 7 cost time: 0.9559755325317383
Epoch: 7, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.120 Vali Acc: 0.196 Test Loss: 3.120 Test Acc: 0.196
Validation loss decreased (-0.174086 --> -0.196439).  Saving model ...
Epoch: 8 cost time: 0.8180408477783203
Epoch: 8, Steps: 10 | Train Loss: 1.525 Vali Loss: 3.109 Vali Acc: 0.224 Test Loss: 3.109 Test Acc: 0.224
Validation loss decreased (-0.196439 --> -0.223498).  Saving model ...
Epoch: 9 cost time: 0.8175969123840332
Epoch: 9, Steps: 10 | Train Loss: 1.317 Vali Loss: 3.138 Vali Acc: 0.229 Test Loss: 3.138 Test Acc: 0.229
Validation loss decreased (-0.223498 --> -0.229380).  Saving model ...
Epoch: 10 cost time: 0.8092212677001953
Epoch: 10, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.158 Vali Acc: 0.262 Test Loss: 3.158 Test Acc: 0.262
Validation loss decreased (-0.229380 --> -0.262321).  Saving model ...
Epoch: 11 cost time: 0.8827798366546631
Epoch: 11, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.161 Vali Acc: 0.273 Test Loss: 3.161 Test Acc: 0.273
Validation loss decreased (-0.262321 --> -0.272910).  Saving model ...
Epoch: 12 cost time: 1.0055603981018066
Epoch: 12, Steps: 10 | Train Loss: 0.699 Vali Loss: 3.203 Vali Acc: 0.278 Test Loss: 3.203 Test Acc: 0.278
Validation loss decreased (-0.272910 --> -0.277615).  Saving model ...
Epoch: 13 cost time: 0.9988656044006348
Epoch: 13, Steps: 10 | Train Loss: 0.562 Vali Loss: 3.233 Vali Acc: 0.292 Test Loss: 3.233 Test Acc: 0.292
Validation loss decreased (-0.277615 --> -0.291732).  Saving model ...
Epoch: 14 cost time: 1.0127127170562744
Epoch: 14, Steps: 10 | Train Loss: 0.488 Vali Loss: 3.296 Vali Acc: 0.299 Test Loss: 3.296 Test Acc: 0.299
Validation loss decreased (-0.291732 --> -0.298791).  Saving model ...
Epoch: 15 cost time: 0.906761884689331
Epoch: 15, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.337 Vali Acc: 0.301 Test Loss: 3.337 Test Acc: 0.301
Validation loss decreased (-0.298791 --> -0.301143).  Saving model ...
Epoch: 16 cost time: 0.8078458309173584
Epoch: 16, Steps: 10 | Train Loss: 0.245 Vali Loss: 3.405 Vali Acc: 0.314 Test Loss: 3.405 Test Acc: 0.314
Validation loss decreased (-0.301143 --> -0.314084).  Saving model ...
Epoch: 17 cost time: 0.836146354675293
Epoch: 17, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.443 Vali Acc: 0.321 Test Loss: 3.443 Test Acc: 0.321
Validation loss decreased (-0.314084 --> -0.321142).  Saving model ...
Epoch: 18 cost time: 0.9508194923400879
Epoch: 18, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.520 Vali Acc: 0.309 Test Loss: 3.520 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9690701961517334
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.592 Vali Acc: 0.325 Test Loss: 3.592 Test Acc: 0.325
Validation loss decreased (-0.321142 --> -0.324670).  Saving model ...
Epoch: 20 cost time: 0.9834601879119873
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.621 Vali Acc: 0.321 Test Loss: 3.621 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9781005382537842
Epoch: 21, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.659 Vali Acc: 0.316 Test Loss: 3.659 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.036226749420166
Epoch: 22, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.679 Vali Acc: 0.329 Test Loss: 3.679 Test Acc: 0.329
Validation loss decreased (-0.324670 --> -0.329375).  Saving model ...
Epoch: 23 cost time: 1.0266261100769043
Epoch: 23, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.721 Vali Acc: 0.332 Test Loss: 3.721 Test Acc: 0.332
Validation loss decreased (-0.329375 --> -0.331727).  Saving model ...
Epoch: 24 cost time: 0.9599263668060303
Epoch: 24, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.761 Vali Acc: 0.331 Test Loss: 3.761 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7099933624267578
Epoch: 25, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.798 Vali Acc: 0.339 Test Loss: 3.798 Test Acc: 0.339
Validation loss decreased (-0.331727 --> -0.338786).  Saving model ...
Epoch: 26 cost time: 0.8814899921417236
Epoch: 26, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.806 Vali Acc: 0.340 Test Loss: 3.806 Test Acc: 0.340
Validation loss decreased (-0.338786 --> -0.339962).  Saving model ...
Epoch: 27 cost time: 0.7903220653533936
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.821 Vali Acc: 0.342 Test Loss: 3.821 Test Acc: 0.342
Validation loss decreased (-0.339962 --> -0.342315).  Saving model ...
Epoch: 28 cost time: 0.8961243629455566
Epoch: 28, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.845 Vali Acc: 0.342 Test Loss: 3.845 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9788680076599121
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.866 Vali Acc: 0.340 Test Loss: 3.866 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8735885620117188
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.890 Vali Acc: 0.335 Test Loss: 3.890 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.9878475666046143
Epoch: 31, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.916 Vali Acc: 0.339 Test Loss: 3.916 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8670990467071533
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.931 Vali Acc: 0.341 Test Loss: 3.931 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8486673831939697
Epoch: 33, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.932 Vali Acc: 0.342 Test Loss: 3.932 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.950871467590332
Epoch: 34, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.939 Vali Acc: 0.347 Test Loss: 3.939 Test Acc: 0.347
Validation loss decreased (-0.342315 --> -0.347019).  Saving model ...
Epoch: 35 cost time: 0.8687741756439209
Epoch: 35, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.954 Vali Acc: 0.347 Test Loss: 3.954 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.890845537185669
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.975 Vali Acc: 0.340 Test Loss: 3.975 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.0225539207458496
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.997 Vali Acc: 0.342 Test Loss: 3.997 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.970177412033081
Epoch: 38, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.021 Vali Acc: 0.336 Test Loss: 4.021 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.107708215713501
Epoch: 39, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.036 Vali Acc: 0.344 Test Loss: 4.036 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.0437264442443848
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.040 Vali Acc: 0.342 Test Loss: 4.040 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.9082660675048828
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.044 Vali Acc: 0.348 Test Loss: 4.044 Test Acc: 0.348
Validation loss decreased (-0.347019 --> -0.348195).  Saving model ...
Epoch: 42 cost time: 0.9366302490234375
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.060 Vali Acc: 0.346 Test Loss: 4.060 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.9617445468902588
Epoch: 43, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.090 Vali Acc: 0.346 Test Loss: 4.090 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.9907674789428711
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.097 Vali Acc: 0.344 Test Loss: 4.097 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.0377848148345947
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.105 Vali Acc: 0.341 Test Loss: 4.105 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.9879801273345947
Epoch: 46, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.116 Vali Acc: 0.344 Test Loss: 4.116 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.9841907024383545
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.123 Vali Acc: 0.345 Test Loss: 4.123 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.9583947658538818
Epoch: 48, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.137 Vali Acc: 0.345 Test Loss: 4.137 Test Acc: 0.345
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.9628777503967285
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.156 Vali Acc: 0.340 Test Loss: 4.156 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.886594295501709
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.167 Vali Acc: 0.340 Test Loss: 4.167 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.8204836845397949
Epoch: 51, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.179 Vali Acc: 0.336 Test Loss: 4.179 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34823529411764703
model parameter : 197490
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5584146976470947
Epoch: 1, Steps: 10 | Train Loss: 3.416 Vali Loss: 3.354 Vali Acc: 0.033 Test Loss: 3.354 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.8341913223266602
Epoch: 2, Steps: 10 | Train Loss: 3.234 Vali Loss: 3.291 Vali Acc: 0.051 Test Loss: 3.291 Test Acc: 0.051
Validation loss decreased (-0.032908 --> -0.050555).  Saving model ...
Epoch: 3 cost time: 0.94120192527771
Epoch: 3, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.270 Vali Acc: 0.085 Test Loss: 3.270 Test Acc: 0.085
Validation loss decreased (-0.050555 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 0.9077010154724121
Epoch: 4, Steps: 10 | Train Loss: 2.712 Vali Loss: 3.237 Vali Acc: 0.113 Test Loss: 3.237 Test Acc: 0.113
Validation loss decreased (-0.084673 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 0.8111915588378906
Epoch: 5, Steps: 10 | Train Loss: 2.486 Vali Loss: 3.193 Vali Acc: 0.140 Test Loss: 3.193 Test Acc: 0.140
Validation loss decreased (-0.112909 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 0.8138322830200195
Epoch: 6, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.153 Vali Acc: 0.166 Test Loss: 3.153 Test Acc: 0.166
Validation loss decreased (-0.139968 --> -0.165851).  Saving model ...
Epoch: 7 cost time: 0.8092978000640869
Epoch: 7, Steps: 10 | Train Loss: 1.886 Vali Loss: 3.121 Vali Acc: 0.189 Test Loss: 3.121 Test Acc: 0.189
Validation loss decreased (-0.165851 --> -0.189381).  Saving model ...
Epoch: 8 cost time: 0.86802077293396
Epoch: 8, Steps: 10 | Train Loss: 1.596 Vali Loss: 3.104 Vali Acc: 0.222 Test Loss: 3.104 Test Acc: 0.222
Validation loss decreased (-0.189381 --> -0.222322).  Saving model ...
Epoch: 9 cost time: 0.9604299068450928
Epoch: 9, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.120 Vali Acc: 0.228 Test Loss: 3.120 Test Acc: 0.228
Validation loss decreased (-0.222322 --> -0.228204).  Saving model ...
Epoch: 10 cost time: 0.8925964832305908
Epoch: 10, Steps: 10 | Train Loss: 1.134 Vali Loss: 3.139 Vali Acc: 0.244 Test Loss: 3.139 Test Acc: 0.244
Validation loss decreased (-0.228204 --> -0.243498).  Saving model ...
Epoch: 11 cost time: 0.9201865196228027
Epoch: 11, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.139 Vali Acc: 0.266 Test Loss: 3.139 Test Acc: 0.266
Validation loss decreased (-0.243498 --> -0.265851).  Saving model ...
Epoch: 12 cost time: 0.8921260833740234
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.172 Vali Acc: 0.275 Test Loss: 3.172 Test Acc: 0.275
Validation loss decreased (-0.265851 --> -0.275262).  Saving model ...
Epoch: 13 cost time: 1.0116486549377441
Epoch: 13, Steps: 10 | Train Loss: 0.634 Vali Loss: 3.193 Vali Acc: 0.298 Test Loss: 3.193 Test Acc: 0.298
Validation loss decreased (-0.275262 --> -0.297615).  Saving model ...
Epoch: 14 cost time: 1.0470218658447266
Epoch: 14, Steps: 10 | Train Loss: 0.527 Vali Loss: 3.255 Vali Acc: 0.291 Test Loss: 3.255 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.912400484085083
Epoch: 15, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.300 Vali Acc: 0.309 Test Loss: 3.300 Test Acc: 0.309
Validation loss decreased (-0.297615 --> -0.309379).  Saving model ...
Epoch: 16 cost time: 0.9161694049835205
Epoch: 16, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.357 Vali Acc: 0.304 Test Loss: 3.357 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.993859052658081
Epoch: 17, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.397 Vali Acc: 0.306 Test Loss: 3.397 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0259017944335938
Epoch: 18, Steps: 10 | Train Loss: 0.155 Vali Loss: 3.479 Vali Acc: 0.312 Test Loss: 3.479 Test Acc: 0.312
Validation loss decreased (-0.309379 --> -0.311730).  Saving model ...
Epoch: 19 cost time: 1.0479822158813477
Epoch: 19, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.537 Vali Acc: 0.321 Test Loss: 3.537 Test Acc: 0.321
Validation loss decreased (-0.311730 --> -0.321141).  Saving model ...
Epoch: 20 cost time: 1.0880334377288818
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.567 Vali Acc: 0.309 Test Loss: 3.567 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9604208469390869
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.591 Vali Acc: 0.319 Test Loss: 3.591 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0653293132781982
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.645 Vali Acc: 0.325 Test Loss: 3.645 Test Acc: 0.325
Validation loss decreased (-0.321141 --> -0.324669).  Saving model ...
Epoch: 23 cost time: 1.0141243934631348
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.667 Vali Acc: 0.321 Test Loss: 3.667 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9724557399749756
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.697 Vali Acc: 0.327 Test Loss: 3.697 Test Acc: 0.327
Validation loss decreased (-0.324669 --> -0.327022).  Saving model ...
Epoch: 25 cost time: 0.8852698802947998
Epoch: 25, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.727 Vali Acc: 0.331 Test Loss: 3.727 Test Acc: 0.331
Validation loss decreased (-0.327022 --> -0.330551).  Saving model ...
Epoch: 26 cost time: 0.9619607925415039
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.749 Vali Acc: 0.331 Test Loss: 3.749 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.9535515308380127
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.771 Vali Acc: 0.331 Test Loss: 3.771 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.028583288192749
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.803 Vali Acc: 0.332 Test Loss: 3.803 Test Acc: 0.332
Validation loss decreased (-0.330551 --> -0.331727).  Saving model ...
Epoch: 29 cost time: 1.0732133388519287
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.818 Vali Acc: 0.326 Test Loss: 3.818 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9847548007965088
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.834 Vali Acc: 0.331 Test Loss: 3.834 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9807579517364502
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.863 Vali Acc: 0.327 Test Loss: 3.863 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.0188863277435303
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.886 Vali Acc: 0.328 Test Loss: 3.886 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.8975379467010498
Epoch: 33, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.893 Vali Acc: 0.328 Test Loss: 3.893 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.0494883060455322
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.897 Vali Acc: 0.331 Test Loss: 3.897 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.0088894367218018
Epoch: 35, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.910 Vali Acc: 0.327 Test Loss: 3.910 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9750621318817139
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.935 Vali Acc: 0.328 Test Loss: 3.935 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9951126575469971
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.955 Vali Acc: 0.329 Test Loss: 3.955 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 1.092237949371338
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.984 Vali Acc: 0.324 Test Loss: 3.984 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 197490
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.664869546890259
Epoch: 1, Steps: 10 | Train Loss: 3.396 Vali Loss: 3.337 Vali Acc: 0.041 Test Loss: 3.337 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8577051162719727
Epoch: 2, Steps: 10 | Train Loss: 3.247 Vali Loss: 3.282 Vali Acc: 0.046 Test Loss: 3.282 Test Acc: 0.046
Validation loss decreased (-0.041143 --> -0.045850).  Saving model ...
Epoch: 3 cost time: 0.8669226169586182
Epoch: 3, Steps: 10 | Train Loss: 2.994 Vali Loss: 3.266 Vali Acc: 0.084 Test Loss: 3.266 Test Acc: 0.084
Validation loss decreased (-0.045850 --> -0.083497).  Saving model ...
Epoch: 4 cost time: 0.9025468826293945
Epoch: 4, Steps: 10 | Train Loss: 2.750 Vali Loss: 3.237 Vali Acc: 0.101 Test Loss: 3.237 Test Acc: 0.101
Validation loss decreased (-0.083497 --> -0.101144).  Saving model ...
Epoch: 5 cost time: 1.009793996810913
Epoch: 5, Steps: 10 | Train Loss: 2.555 Vali Loss: 3.199 Vali Acc: 0.119 Test Loss: 3.199 Test Acc: 0.119
Validation loss decreased (-0.101144 --> -0.118792).  Saving model ...
Epoch: 6 cost time: 1.0319762229919434
Epoch: 6, Steps: 10 | Train Loss: 2.204 Vali Loss: 3.162 Vali Acc: 0.147 Test Loss: 3.162 Test Acc: 0.147
Validation loss decreased (-0.118792 --> -0.147027).  Saving model ...
Epoch: 7 cost time: 0.8863446712493896
Epoch: 7, Steps: 10 | Train Loss: 1.972 Vali Loss: 3.125 Vali Acc: 0.174 Test Loss: 3.125 Test Acc: 0.174
Validation loss decreased (-0.147027 --> -0.174086).  Saving model ...
Epoch: 8 cost time: 0.8979029655456543
Epoch: 8, Steps: 10 | Train Loss: 1.676 Vali Loss: 3.096 Vali Acc: 0.202 Test Loss: 3.096 Test Acc: 0.202
Validation loss decreased (-0.174086 --> -0.202322).  Saving model ...
Epoch: 9 cost time: 0.9390366077423096
Epoch: 9, Steps: 10 | Train Loss: 1.459 Vali Loss: 3.105 Vali Acc: 0.216 Test Loss: 3.105 Test Acc: 0.216
Validation loss decreased (-0.202322 --> -0.216440).  Saving model ...
Epoch: 10 cost time: 0.9433789253234863
Epoch: 10, Steps: 10 | Train Loss: 1.218 Vali Loss: 3.117 Vali Acc: 0.239 Test Loss: 3.117 Test Acc: 0.239
Validation loss decreased (-0.216440 --> -0.238792).  Saving model ...
Epoch: 11 cost time: 0.7995901107788086
Epoch: 11, Steps: 10 | Train Loss: 0.994 Vali Loss: 3.106 Vali Acc: 0.251 Test Loss: 3.106 Test Acc: 0.251
Validation loss decreased (-0.238792 --> -0.250557).  Saving model ...
Epoch: 12 cost time: 0.862727165222168
Epoch: 12, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.135 Vali Acc: 0.254 Test Loss: 3.135 Test Acc: 0.254
Validation loss decreased (-0.250557 --> -0.254086).  Saving model ...
Epoch: 13 cost time: 0.8040714263916016
Epoch: 13, Steps: 10 | Train Loss: 0.648 Vali Loss: 3.151 Vali Acc: 0.264 Test Loss: 3.151 Test Acc: 0.264
Validation loss decreased (-0.254086 --> -0.263498).  Saving model ...
Epoch: 14 cost time: 0.8240504264831543
Epoch: 14, Steps: 10 | Train Loss: 0.555 Vali Loss: 3.203 Vali Acc: 0.262 Test Loss: 3.203 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9732649326324463
Epoch: 15, Steps: 10 | Train Loss: 0.384 Vali Loss: 3.235 Vali Acc: 0.280 Test Loss: 3.235 Test Acc: 0.280
Validation loss decreased (-0.263498 --> -0.279968).  Saving model ...
Epoch: 16 cost time: 1.0089986324310303
Epoch: 16, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.286 Vali Acc: 0.276 Test Loss: 3.286 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1205816268920898
Epoch: 17, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.334 Vali Acc: 0.285 Test Loss: 3.334 Test Acc: 0.285
Validation loss decreased (-0.279968 --> -0.284673).  Saving model ...
Epoch: 18 cost time: 1.0242681503295898
Epoch: 18, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.394 Vali Acc: 0.293 Test Loss: 3.394 Test Acc: 0.293
Validation loss decreased (-0.284673 --> -0.292907).  Saving model ...
Epoch: 19 cost time: 0.949221134185791
Epoch: 19, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.462 Vali Acc: 0.299 Test Loss: 3.462 Test Acc: 0.299
Validation loss decreased (-0.292907 --> -0.298789).  Saving model ...
Epoch: 20 cost time: 0.9764201641082764
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.492 Vali Acc: 0.294 Test Loss: 3.492 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9226882457733154
Epoch: 21, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.514 Vali Acc: 0.296 Test Loss: 3.514 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0220019817352295
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.551 Vali Acc: 0.305 Test Loss: 3.551 Test Acc: 0.305
Validation loss decreased (-0.298789 --> -0.304670).  Saving model ...
Epoch: 23 cost time: 1.0121455192565918
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.590 Vali Acc: 0.294 Test Loss: 3.590 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1225695610046387
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.614 Vali Acc: 0.289 Test Loss: 3.614 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0576231479644775
Epoch: 25, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.642 Vali Acc: 0.298 Test Loss: 3.642 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0670838356018066
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.658 Vali Acc: 0.293 Test Loss: 3.658 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9316511154174805
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.681 Vali Acc: 0.300 Test Loss: 3.681 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8927130699157715
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.701 Vali Acc: 0.299 Test Loss: 3.701 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8326308727264404
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.727 Vali Acc: 0.296 Test Loss: 3.727 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.8266592025756836
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.734 Vali Acc: 0.300 Test Loss: 3.734 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9877870082855225
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.755 Vali Acc: 0.299 Test Loss: 3.755 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9817028045654297
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.772 Vali Acc: 0.299 Test Loss: 3.772 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30470588235294116
model parameter : 197490
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.330531358718872
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.310 Vali Acc: 0.034 Test Loss: 3.310 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.8102736473083496
Epoch: 2, Steps: 10 | Train Loss: 3.223 Vali Loss: 3.275 Vali Acc: 0.041 Test Loss: 3.275 Test Acc: 0.041
Validation loss decreased (-0.034085 --> -0.041144).  Saving model ...
Epoch: 3 cost time: 0.9288041591644287
Epoch: 3, Steps: 10 | Train Loss: 3.034 Vali Loss: 3.265 Vali Acc: 0.075 Test Loss: 3.265 Test Acc: 0.075
Validation loss decreased (-0.041144 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.9352760314941406
Epoch: 4, Steps: 10 | Train Loss: 2.852 Vali Loss: 3.248 Vali Acc: 0.093 Test Loss: 3.248 Test Acc: 0.093
Validation loss decreased (-0.075261 --> -0.092909).  Saving model ...
Epoch: 5 cost time: 0.9182784557342529
Epoch: 5, Steps: 10 | Train Loss: 2.684 Vali Loss: 3.220 Vali Acc: 0.108 Test Loss: 3.220 Test Acc: 0.108
Validation loss decreased (-0.092909 --> -0.108203).  Saving model ...
Epoch: 6 cost time: 0.9958767890930176
Epoch: 6, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.187 Vali Acc: 0.131 Test Loss: 3.187 Test Acc: 0.131
Validation loss decreased (-0.108203 --> -0.130556).  Saving model ...
Epoch: 7 cost time: 1.039750337600708
Epoch: 7, Steps: 10 | Train Loss: 2.200 Vali Loss: 3.148 Vali Acc: 0.154 Test Loss: 3.148 Test Acc: 0.154
Validation loss decreased (-0.130556 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 1.0242526531219482
Epoch: 8, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.108 Vali Acc: 0.169 Test Loss: 3.108 Test Acc: 0.169
Validation loss decreased (-0.154086 --> -0.169381).  Saving model ...
Epoch: 9 cost time: 0.932058572769165
Epoch: 9, Steps: 10 | Train Loss: 1.723 Vali Loss: 3.092 Vali Acc: 0.185 Test Loss: 3.092 Test Acc: 0.185
Validation loss decreased (-0.169381 --> -0.184675).  Saving model ...
Epoch: 10 cost time: 0.995391845703125
Epoch: 10, Steps: 10 | Train Loss: 1.488 Vali Loss: 3.084 Vali Acc: 0.196 Test Loss: 3.084 Test Acc: 0.196
Validation loss decreased (-0.184675 --> -0.196440).  Saving model ...
Epoch: 11 cost time: 0.9328243732452393
Epoch: 11, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.058 Vali Acc: 0.214 Test Loss: 3.058 Test Acc: 0.214
Validation loss decreased (-0.196440 --> -0.214087).  Saving model ...
Epoch: 12 cost time: 0.980391263961792
Epoch: 12, Steps: 10 | Train Loss: 1.077 Vali Loss: 3.057 Vali Acc: 0.224 Test Loss: 3.057 Test Acc: 0.224
Validation loss decreased (-0.214087 --> -0.223499).  Saving model ...
Epoch: 13 cost time: 1.025747299194336
Epoch: 13, Steps: 10 | Train Loss: 0.876 Vali Loss: 3.050 Vali Acc: 0.246 Test Loss: 3.050 Test Acc: 0.246
Validation loss decreased (-0.223499 --> -0.245852).  Saving model ...
Epoch: 14 cost time: 1.1273703575134277
Epoch: 14, Steps: 10 | Train Loss: 0.725 Vali Loss: 3.082 Vali Acc: 0.252 Test Loss: 3.082 Test Acc: 0.252
Validation loss decreased (-0.245852 --> -0.251734).  Saving model ...
Epoch: 15 cost time: 1.1543738842010498
Epoch: 15, Steps: 10 | Train Loss: 0.554 Vali Loss: 3.098 Vali Acc: 0.253 Test Loss: 3.098 Test Acc: 0.253
Validation loss decreased (-0.251734 --> -0.252910).  Saving model ...
Epoch: 16 cost time: 0.9907727241516113
Epoch: 16, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.126 Vali Acc: 0.258 Test Loss: 3.126 Test Acc: 0.258
Validation loss decreased (-0.252910 --> -0.257616).  Saving model ...
Epoch: 17 cost time: 0.8735575675964355
Epoch: 17, Steps: 10 | Train Loss: 0.304 Vali Loss: 3.122 Vali Acc: 0.273 Test Loss: 3.122 Test Acc: 0.273
Validation loss decreased (-0.257616 --> -0.272910).  Saving model ...
Epoch: 18 cost time: 0.953704833984375
Epoch: 18, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.213 Vali Acc: 0.275 Test Loss: 3.213 Test Acc: 0.275
Validation loss decreased (-0.272910 --> -0.275262).  Saving model ...
Epoch: 19 cost time: 0.9373857975006104
Epoch: 19, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.276 Vali Acc: 0.274 Test Loss: 3.276 Test Acc: 0.274
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9593427181243896
Epoch: 20, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.277 Vali Acc: 0.282 Test Loss: 3.277 Test Acc: 0.282
Validation loss decreased (-0.275262 --> -0.282320).  Saving model ...
Epoch: 21 cost time: 0.9165356159210205
Epoch: 21, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.307 Vali Acc: 0.285 Test Loss: 3.307 Test Acc: 0.285
Validation loss decreased (-0.282320 --> -0.284673).  Saving model ...
Epoch: 22 cost time: 1.0430195331573486
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.364 Vali Acc: 0.284 Test Loss: 3.364 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9843738079071045
Epoch: 23, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.396 Vali Acc: 0.285 Test Loss: 3.396 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9711556434631348
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.406 Vali Acc: 0.289 Test Loss: 3.406 Test Acc: 0.289
Validation loss decreased (-0.284673 --> -0.289378).  Saving model ...
Epoch: 25 cost time: 0.9004943370819092
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.420 Vali Acc: 0.292 Test Loss: 3.420 Test Acc: 0.292
Validation loss decreased (-0.289378 --> -0.291731).  Saving model ...
Epoch: 26 cost time: 0.8375952243804932
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.446 Vali Acc: 0.299 Test Loss: 3.446 Test Acc: 0.299
Validation loss decreased (-0.291731 --> -0.298789).  Saving model ...
Epoch: 27 cost time: 0.8909146785736084
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.473 Vali Acc: 0.298 Test Loss: 3.473 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8898534774780273
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.502 Vali Acc: 0.298 Test Loss: 3.502 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9414398670196533
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.512 Vali Acc: 0.295 Test Loss: 3.512 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9599823951721191
Epoch: 30, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.520 Vali Acc: 0.299 Test Loss: 3.520 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.0199012756347656
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.539 Vali Acc: 0.308 Test Loss: 3.539 Test Acc: 0.308
Validation loss decreased (-0.298789 --> -0.308200).  Saving model ...
Epoch: 32 cost time: 1.00862455368042
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.570 Vali Acc: 0.302 Test Loss: 3.570 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.0127949714660645
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.582 Vali Acc: 0.304 Test Loss: 3.582 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8870866298675537
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.590 Vali Acc: 0.304 Test Loss: 3.590 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.9899997711181641
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.602 Vali Acc: 0.305 Test Loss: 3.602 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0284161567687988
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.623 Vali Acc: 0.299 Test Loss: 3.623 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0231945514678955
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.648 Vali Acc: 0.302 Test Loss: 3.648 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.9885430335998535
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.673 Vali Acc: 0.305 Test Loss: 3.673 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0745043754577637
Epoch: 39, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.689 Vali Acc: 0.306 Test Loss: 3.689 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.1022236347198486
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.702 Vali Acc: 0.302 Test Loss: 3.702 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.8507089614868164
Epoch: 41, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.712 Vali Acc: 0.305 Test Loss: 3.712 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 197490
model size : 1.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.330815076828003
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.338 Vali Acc: 0.055 Test Loss: 3.338 Test Acc: 0.055
Validation loss decreased (inf --> -0.055261).  Saving model ...
Epoch: 2 cost time: 0.9418108463287354
Epoch: 2, Steps: 10 | Train Loss: 3.173 Vali Loss: 3.306 Vali Acc: 0.068 Test Loss: 3.306 Test Acc: 0.068
Validation loss decreased (-0.055261 --> -0.068202).  Saving model ...
Epoch: 3 cost time: 0.912330150604248
Epoch: 3, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.275 Vali Acc: 0.094 Test Loss: 3.275 Test Acc: 0.094
Validation loss decreased (-0.068202 --> -0.094085).  Saving model ...
Epoch: 4 cost time: 0.9118783473968506
Epoch: 4, Steps: 10 | Train Loss: 2.705 Vali Loss: 3.253 Vali Acc: 0.112 Test Loss: 3.253 Test Acc: 0.112
Validation loss decreased (-0.094085 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 0.941277265548706
Epoch: 5, Steps: 10 | Train Loss: 2.357 Vali Loss: 3.189 Vali Acc: 0.148 Test Loss: 3.189 Test Acc: 0.148
Validation loss decreased (-0.111732 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.97385573387146
Epoch: 6, Steps: 10 | Train Loss: 2.066 Vali Loss: 3.176 Vali Acc: 0.165 Test Loss: 3.176 Test Acc: 0.165
Validation loss decreased (-0.148203 --> -0.164674).  Saving model ...
Epoch: 7 cost time: 0.8874526023864746
Epoch: 7, Steps: 10 | Train Loss: 1.752 Vali Loss: 3.162 Vali Acc: 0.186 Test Loss: 3.162 Test Acc: 0.186
Validation loss decreased (-0.164674 --> -0.185851).  Saving model ...
Epoch: 8 cost time: 0.8306179046630859
Epoch: 8, Steps: 10 | Train Loss: 1.568 Vali Loss: 3.167 Vali Acc: 0.207 Test Loss: 3.167 Test Acc: 0.207
Validation loss decreased (-0.185851 --> -0.207027).  Saving model ...
Epoch: 9 cost time: 0.850520133972168
Epoch: 9, Steps: 10 | Train Loss: 1.352 Vali Loss: 3.156 Vali Acc: 0.226 Test Loss: 3.156 Test Acc: 0.226
Validation loss decreased (-0.207027 --> -0.225851).  Saving model ...
Epoch: 10 cost time: 0.9714770317077637
Epoch: 10, Steps: 10 | Train Loss: 1.072 Vali Loss: 3.199 Vali Acc: 0.248 Test Loss: 3.199 Test Acc: 0.248
Validation loss decreased (-0.225851 --> -0.248203).  Saving model ...
Epoch: 11 cost time: 0.9053769111633301
Epoch: 11, Steps: 10 | Train Loss: 0.865 Vali Loss: 3.227 Vali Acc: 0.265 Test Loss: 3.227 Test Acc: 0.265
Validation loss decreased (-0.248203 --> -0.264674).  Saving model ...
Epoch: 12 cost time: 0.8350434303283691
Epoch: 12, Steps: 10 | Train Loss: 0.735 Vali Loss: 3.269 Vali Acc: 0.267 Test Loss: 3.269 Test Acc: 0.267
Validation loss decreased (-0.264674 --> -0.267026).  Saving model ...
Epoch: 13 cost time: 0.9061233997344971
Epoch: 13, Steps: 10 | Train Loss: 0.566 Vali Loss: 3.312 Vali Acc: 0.288 Test Loss: 3.312 Test Acc: 0.288
Validation loss decreased (-0.267026 --> -0.288202).  Saving model ...
Epoch: 14 cost time: 0.9468445777893066
Epoch: 14, Steps: 10 | Train Loss: 0.425 Vali Loss: 3.377 Vali Acc: 0.278 Test Loss: 3.377 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8832294940948486
Epoch: 15, Steps: 10 | Train Loss: 0.332 Vali Loss: 3.430 Vali Acc: 0.300 Test Loss: 3.430 Test Acc: 0.300
Validation loss decreased (-0.288202 --> -0.299966).  Saving model ...
Epoch: 16 cost time: 0.992645263671875
Epoch: 16, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.476 Vali Acc: 0.299 Test Loss: 3.476 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9806118011474609
Epoch: 17, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.567 Vali Acc: 0.301 Test Loss: 3.567 Test Acc: 0.301
Validation loss decreased (-0.299966 --> -0.301141).  Saving model ...
Epoch: 18 cost time: 1.0684926509857178
Epoch: 18, Steps: 10 | Train Loss: 0.144 Vali Loss: 3.606 Vali Acc: 0.311 Test Loss: 3.606 Test Acc: 0.311
Validation loss decreased (-0.301141 --> -0.310552).  Saving model ...
Epoch: 19 cost time: 1.122910737991333
Epoch: 19, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.690 Vali Acc: 0.315 Test Loss: 3.690 Test Acc: 0.315
Validation loss decreased (-0.310552 --> -0.315257).  Saving model ...
Epoch: 20 cost time: 0.9643607139587402
Epoch: 20, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.720 Vali Acc: 0.313 Test Loss: 3.720 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8691649436950684
Epoch: 21, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.792 Vali Acc: 0.318 Test Loss: 3.792 Test Acc: 0.318
Validation loss decreased (-0.315257 --> -0.317609).  Saving model ...
Epoch: 22 cost time: 1.0119822025299072
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.848 Vali Acc: 0.312 Test Loss: 3.848 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8326618671417236
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.832 Vali Acc: 0.320 Test Loss: 3.832 Test Acc: 0.320
Validation loss decreased (-0.317609 --> -0.319962).  Saving model ...
Epoch: 24 cost time: 0.8767678737640381
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.897 Vali Acc: 0.321 Test Loss: 3.897 Test Acc: 0.321
Validation loss decreased (-0.319962 --> -0.321138).  Saving model ...
Epoch: 25 cost time: 0.9035048484802246
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.932 Vali Acc: 0.322 Test Loss: 3.932 Test Acc: 0.322
Validation loss decreased (-0.321138 --> -0.322314).  Saving model ...
Epoch: 26 cost time: 1.0173261165618896
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.942 Vali Acc: 0.325 Test Loss: 3.942 Test Acc: 0.325
Validation loss decreased (-0.322314 --> -0.324666).  Saving model ...
Epoch: 27 cost time: 0.8444254398345947
Epoch: 27, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.974 Vali Acc: 0.322 Test Loss: 3.974 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.9586710929870605
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.993 Vali Acc: 0.321 Test Loss: 3.993 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9048981666564941
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.015 Vali Acc: 0.326 Test Loss: 4.015 Test Acc: 0.326
Validation loss decreased (-0.324666 --> -0.325842).  Saving model ...
Epoch: 30 cost time: 0.9959392547607422
Epoch: 30, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.037 Vali Acc: 0.329 Test Loss: 4.037 Test Acc: 0.329
Validation loss decreased (-0.325842 --> -0.329371).  Saving model ...
Epoch: 31 cost time: 0.9269943237304688
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.093 Vali Acc: 0.331 Test Loss: 4.093 Test Acc: 0.331
Validation loss decreased (-0.329371 --> -0.330547).  Saving model ...
Epoch: 32 cost time: 0.7942192554473877
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.120 Vali Acc: 0.327 Test Loss: 4.120 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.940575361251831
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.106 Vali Acc: 0.324 Test Loss: 4.106 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8993844985961914
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.105 Vali Acc: 0.332 Test Loss: 4.105 Test Acc: 0.332
Validation loss decreased (-0.330547 --> -0.331724).  Saving model ...
Epoch: 35 cost time: 0.9402236938476562
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.131 Vali Acc: 0.327 Test Loss: 4.131 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.006824016571045
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.143 Vali Acc: 0.333 Test Loss: 4.143 Test Acc: 0.333
Validation loss decreased (-0.331724 --> -0.332900).  Saving model ...
Epoch: 37 cost time: 1.0352110862731934
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.161 Vali Acc: 0.334 Test Loss: 4.161 Test Acc: 0.334
Validation loss decreased (-0.332900 --> -0.334076).  Saving model ...
Epoch: 38 cost time: 0.8911576271057129
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.183 Vali Acc: 0.335 Test Loss: 4.183 Test Acc: 0.335
Validation loss decreased (-0.334076 --> -0.335252).  Saving model ...
Epoch: 39 cost time: 0.8500270843505859
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.201 Vali Acc: 0.333 Test Loss: 4.201 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8664815425872803
Epoch: 40, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.212 Vali Acc: 0.334 Test Loss: 4.212 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.0081429481506348
Epoch: 41, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.218 Vali Acc: 0.335 Test Loss: 4.218 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.9735071659088135
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.239 Vali Acc: 0.335 Test Loss: 4.239 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.0047883987426758
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.254 Vali Acc: 0.327 Test Loss: 4.254 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.9052026271820068
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.270 Vali Acc: 0.334 Test Loss: 4.270 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.960066556930542
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.285 Vali Acc: 0.335 Test Loss: 4.285 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.8673474788665771
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.304 Vali Acc: 0.334 Test Loss: 4.304 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.8619801998138428
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.320 Vali Acc: 0.335 Test Loss: 4.320 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.8441727161407471
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.348 Vali Acc: 0.336 Test Loss: 4.348 Test Acc: 0.336
Validation loss decreased (-0.335252 --> -0.336427).  Saving model ...
Epoch: 49 cost time: 0.9683597087860107
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.364 Vali Acc: 0.334 Test Loss: 4.364 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 1.001960039138794
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.361 Vali Acc: 0.335 Test Loss: 4.361 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 1.0150885581970215
Epoch: 51, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.363 Vali Acc: 0.338 Test Loss: 4.363 Test Acc: 0.338
Validation loss decreased (-0.336427 --> -0.337603).  Saving model ...
Epoch: 52 cost time: 0.9691832065582275
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.369 Vali Acc: 0.332 Test Loss: 4.369 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.9331099987030029
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.377 Vali Acc: 0.336 Test Loss: 4.377 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.8323962688446045
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.385 Vali Acc: 0.333 Test Loss: 4.385 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8457276821136475
Epoch: 55, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.398 Vali Acc: 0.334 Test Loss: 4.398 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.9909143447875977
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.412 Vali Acc: 0.333 Test Loss: 4.412 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.9789152145385742
Epoch: 57, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.424 Vali Acc: 0.333 Test Loss: 4.424 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 1.0678439140319824
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.441 Vali Acc: 0.334 Test Loss: 4.441 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.9801690578460693
Epoch: 59, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.457 Vali Acc: 0.334 Test Loss: 4.457 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 1.082967758178711
Epoch: 60, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.472 Vali Acc: 0.336 Test Loss: 4.472 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 1.0553431510925293
Epoch: 61, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.477 Vali Acc: 0.335 Test Loss: 4.477 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 164722
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7140893936157227
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.325 Vali Acc: 0.064 Test Loss: 3.325 Test Acc: 0.064
Validation loss decreased (inf --> -0.063496).  Saving model ...
Epoch: 2 cost time: 1.0519921779632568
Epoch: 2, Steps: 10 | Train Loss: 3.199 Vali Loss: 3.297 Vali Acc: 0.071 Test Loss: 3.297 Test Acc: 0.071
Validation loss decreased (-0.063496 --> -0.070555).  Saving model ...
Epoch: 3 cost time: 1.0364573001861572
Epoch: 3, Steps: 10 | Train Loss: 2.953 Vali Loss: 3.269 Vali Acc: 0.102 Test Loss: 3.269 Test Acc: 0.102
Validation loss decreased (-0.070555 --> -0.102320).  Saving model ...
Epoch: 4 cost time: 1.0285086631774902
Epoch: 4, Steps: 10 | Train Loss: 2.732 Vali Loss: 3.247 Vali Acc: 0.112 Test Loss: 3.247 Test Acc: 0.112
Validation loss decreased (-0.102320 --> -0.111732).  Saving model ...
Epoch: 5 cost time: 1.0070617198944092
Epoch: 5, Steps: 10 | Train Loss: 2.416 Vali Loss: 3.189 Vali Acc: 0.140 Test Loss: 3.189 Test Acc: 0.140
Validation loss decreased (-0.111732 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 1.06178879737854
Epoch: 6, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.175 Vali Acc: 0.167 Test Loss: 3.175 Test Acc: 0.167
Validation loss decreased (-0.139968 --> -0.167027).  Saving model ...
Epoch: 7 cost time: 1.0386033058166504
Epoch: 7, Steps: 10 | Train Loss: 1.830 Vali Loss: 3.158 Vali Acc: 0.187 Test Loss: 3.158 Test Acc: 0.187
Validation loss decreased (-0.167027 --> -0.187027).  Saving model ...
Epoch: 8 cost time: 0.7833859920501709
Epoch: 8, Steps: 10 | Train Loss: 1.627 Vali Loss: 3.156 Vali Acc: 0.219 Test Loss: 3.156 Test Acc: 0.219
Validation loss decreased (-0.187027 --> -0.218792).  Saving model ...
Epoch: 9 cost time: 0.8755145072937012
Epoch: 9, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.143 Vali Acc: 0.228 Test Loss: 3.143 Test Acc: 0.228
Validation loss decreased (-0.218792 --> -0.228204).  Saving model ...
Epoch: 10 cost time: 0.8693351745605469
Epoch: 10, Steps: 10 | Train Loss: 1.135 Vali Loss: 3.182 Vali Acc: 0.239 Test Loss: 3.182 Test Acc: 0.239
Validation loss decreased (-0.228204 --> -0.238792).  Saving model ...
Epoch: 11 cost time: 1.0472157001495361
Epoch: 11, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.210 Vali Acc: 0.261 Test Loss: 3.210 Test Acc: 0.261
Validation loss decreased (-0.238792 --> -0.261144).  Saving model ...
Epoch: 12 cost time: 1.0096983909606934
Epoch: 12, Steps: 10 | Train Loss: 0.800 Vali Loss: 3.244 Vali Acc: 0.267 Test Loss: 3.244 Test Acc: 0.267
Validation loss decreased (-0.261144 --> -0.267026).  Saving model ...
Epoch: 13 cost time: 0.9656658172607422
Epoch: 13, Steps: 10 | Train Loss: 0.608 Vali Loss: 3.277 Vali Acc: 0.278 Test Loss: 3.277 Test Acc: 0.278
Validation loss decreased (-0.267026 --> -0.277614).  Saving model ...
Epoch: 14 cost time: 1.0016584396362305
Epoch: 14, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.347 Vali Acc: 0.275 Test Loss: 3.347 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9095056056976318
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.382 Vali Acc: 0.282 Test Loss: 3.382 Test Acc: 0.282
Validation loss decreased (-0.277614 --> -0.282319).  Saving model ...
Epoch: 16 cost time: 0.905876636505127
Epoch: 16, Steps: 10 | Train Loss: 0.286 Vali Loss: 3.431 Vali Acc: 0.296 Test Loss: 3.431 Test Acc: 0.296
Validation loss decreased (-0.282319 --> -0.296436).  Saving model ...
Epoch: 17 cost time: 0.9011693000793457
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.519 Vali Acc: 0.298 Test Loss: 3.519 Test Acc: 0.298
Validation loss decreased (-0.296436 --> -0.297612).  Saving model ...
Epoch: 18 cost time: 0.9135384559631348
Epoch: 18, Steps: 10 | Train Loss: 0.167 Vali Loss: 3.546 Vali Acc: 0.311 Test Loss: 3.546 Test Acc: 0.311
Validation loss decreased (-0.297612 --> -0.310553).  Saving model ...
Epoch: 19 cost time: 0.9228894710540771
Epoch: 19, Steps: 10 | Train Loss: 0.137 Vali Loss: 3.626 Vali Acc: 0.313 Test Loss: 3.626 Test Acc: 0.313
Validation loss decreased (-0.310553 --> -0.312905).  Saving model ...
Epoch: 20 cost time: 0.9315066337585449
Epoch: 20, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.673 Vali Acc: 0.306 Test Loss: 3.673 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9797935485839844
Epoch: 21, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.732 Vali Acc: 0.313 Test Loss: 3.732 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0331637859344482
Epoch: 22, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.764 Vali Acc: 0.311 Test Loss: 3.764 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.040555477142334
Epoch: 23, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.767 Vali Acc: 0.314 Test Loss: 3.767 Test Acc: 0.314
Validation loss decreased (-0.312905 --> -0.314080).  Saving model ...
Epoch: 24 cost time: 0.8964250087738037
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.842 Vali Acc: 0.313 Test Loss: 3.842 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9335660934448242
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.877 Vali Acc: 0.315 Test Loss: 3.877 Test Acc: 0.315
Validation loss decreased (-0.314080 --> -0.315255).  Saving model ...
Epoch: 26 cost time: 0.8834435939788818
Epoch: 26, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.884 Vali Acc: 0.321 Test Loss: 3.884 Test Acc: 0.321
Validation loss decreased (-0.315255 --> -0.321138).  Saving model ...
Epoch: 27 cost time: 0.9393713474273682
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.917 Vali Acc: 0.319 Test Loss: 3.917 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.160860300064087
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.932 Vali Acc: 0.318 Test Loss: 3.932 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.070894479751587
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.956 Vali Acc: 0.324 Test Loss: 3.956 Test Acc: 0.324
Validation loss decreased (-0.321138 --> -0.323490).  Saving model ...
Epoch: 30 cost time: 0.9469537734985352
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.971 Vali Acc: 0.321 Test Loss: 3.971 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.0390403270721436
Epoch: 31, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.026 Vali Acc: 0.319 Test Loss: 4.026 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.814300537109375
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.028 Vali Acc: 0.320 Test Loss: 4.028 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8202898502349854
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.026 Vali Acc: 0.320 Test Loss: 4.026 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8408463001251221
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.051 Vali Acc: 0.320 Test Loss: 4.051 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.9328169822692871
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.081 Vali Acc: 0.324 Test Loss: 4.081 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0004706382751465
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.093 Vali Acc: 0.329 Test Loss: 4.093 Test Acc: 0.329
Validation loss decreased (-0.323490 --> -0.329371).  Saving model ...
Epoch: 37 cost time: 0.9280307292938232
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.107 Vali Acc: 0.332 Test Loss: 4.107 Test Acc: 0.332
Validation loss decreased (-0.329371 --> -0.331724).  Saving model ...
Epoch: 38 cost time: 1.0943734645843506
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.122 Vali Acc: 0.324 Test Loss: 4.122 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.9282350540161133
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.149 Vali Acc: 0.318 Test Loss: 4.149 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.8968250751495361
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.163 Vali Acc: 0.322 Test Loss: 4.163 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 1.0256240367889404
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.176 Vali Acc: 0.326 Test Loss: 4.176 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.9147887229919434
Epoch: 42, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.208 Vali Acc: 0.319 Test Loss: 4.208 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.8377189636230469
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.221 Vali Acc: 0.320 Test Loss: 4.221 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 1.1267998218536377
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.225 Vali Acc: 0.325 Test Loss: 4.225 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 1.0726048946380615
Epoch: 45, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.231 Vali Acc: 0.328 Test Loss: 4.231 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.9266927242279053
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.243 Vali Acc: 0.326 Test Loss: 4.243 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 1.1245214939117432
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.327 Test Loss: 4.261 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 164722
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5308120250701904
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.298 Vali Acc: 0.058 Test Loss: 3.298 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.9689640998840332
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.274 Vali Acc: 0.066 Test Loss: 3.274 Test Acc: 0.066
Validation loss decreased (-0.057614 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.919003963470459
Epoch: 3, Steps: 10 | Train Loss: 2.970 Vali Loss: 3.252 Vali Acc: 0.095 Test Loss: 3.252 Test Acc: 0.095
Validation loss decreased (-0.065850 --> -0.095262).  Saving model ...
Epoch: 4 cost time: 0.9222855567932129
Epoch: 4, Steps: 10 | Train Loss: 2.772 Vali Loss: 3.234 Vali Acc: 0.106 Test Loss: 3.234 Test Acc: 0.106
Validation loss decreased (-0.095262 --> -0.105850).  Saving model ...
Epoch: 5 cost time: 0.9590301513671875
Epoch: 5, Steps: 10 | Train Loss: 2.487 Vali Loss: 3.179 Vali Acc: 0.141 Test Loss: 3.179 Test Acc: 0.141
Validation loss decreased (-0.105850 --> -0.141145).  Saving model ...
Epoch: 6 cost time: 1.003422498703003
Epoch: 6, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.160 Vali Acc: 0.155 Test Loss: 3.160 Test Acc: 0.155
Validation loss decreased (-0.141145 --> -0.155263).  Saving model ...
Epoch: 7 cost time: 0.9159383773803711
Epoch: 7, Steps: 10 | Train Loss: 1.902 Vali Loss: 3.136 Vali Acc: 0.189 Test Loss: 3.136 Test Acc: 0.189
Validation loss decreased (-0.155263 --> -0.189380).  Saving model ...
Epoch: 8 cost time: 1.0027785301208496
Epoch: 8, Steps: 10 | Train Loss: 1.702 Vali Loss: 3.124 Vali Acc: 0.207 Test Loss: 3.124 Test Acc: 0.207
Validation loss decreased (-0.189380 --> -0.207028).  Saving model ...
Epoch: 9 cost time: 0.7963848114013672
Epoch: 9, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.104 Vali Acc: 0.222 Test Loss: 3.104 Test Acc: 0.222
Validation loss decreased (-0.207028 --> -0.222322).  Saving model ...
Epoch: 10 cost time: 0.8054013252258301
Epoch: 10, Steps: 10 | Train Loss: 1.204 Vali Loss: 3.131 Vali Acc: 0.235 Test Loss: 3.131 Test Acc: 0.235
Validation loss decreased (-0.222322 --> -0.235263).  Saving model ...
Epoch: 11 cost time: 0.852074146270752
Epoch: 11, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.154 Vali Acc: 0.253 Test Loss: 3.154 Test Acc: 0.253
Validation loss decreased (-0.235263 --> -0.252910).  Saving model ...
Epoch: 12 cost time: 0.8738341331481934
Epoch: 12, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.181 Vali Acc: 0.260 Test Loss: 3.181 Test Acc: 0.260
Validation loss decreased (-0.252910 --> -0.259968).  Saving model ...
Epoch: 13 cost time: 0.9044528007507324
Epoch: 13, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.212 Vali Acc: 0.276 Test Loss: 3.212 Test Acc: 0.276
Validation loss decreased (-0.259968 --> -0.276438).  Saving model ...
Epoch: 14 cost time: 0.845797061920166
Epoch: 14, Steps: 10 | Train Loss: 0.509 Vali Loss: 3.262 Vali Acc: 0.284 Test Loss: 3.262 Test Acc: 0.284
Validation loss decreased (-0.276438 --> -0.283497).  Saving model ...
Epoch: 15 cost time: 1.0233569145202637
Epoch: 15, Steps: 10 | Train Loss: 0.386 Vali Loss: 3.297 Vali Acc: 0.295 Test Loss: 3.297 Test Acc: 0.295
Validation loss decreased (-0.283497 --> -0.295261).  Saving model ...
Epoch: 16 cost time: 0.8908665180206299
Epoch: 16, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.356 Vali Acc: 0.304 Test Loss: 3.356 Test Acc: 0.304
Validation loss decreased (-0.295261 --> -0.303496).  Saving model ...
Epoch: 17 cost time: 0.8387351036071777
Epoch: 17, Steps: 10 | Train Loss: 0.228 Vali Loss: 3.432 Vali Acc: 0.289 Test Loss: 3.432 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7559268474578857
Epoch: 18, Steps: 10 | Train Loss: 0.156 Vali Loss: 3.465 Vali Acc: 0.302 Test Loss: 3.465 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8895411491394043
Epoch: 19, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.549 Vali Acc: 0.308 Test Loss: 3.549 Test Acc: 0.308
Validation loss decreased (-0.303496 --> -0.308200).  Saving model ...
Epoch: 20 cost time: 0.7983381748199463
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.560 Vali Acc: 0.312 Test Loss: 3.560 Test Acc: 0.312
Validation loss decreased (-0.308200 --> -0.311729).  Saving model ...
Epoch: 21 cost time: 0.78999924659729
Epoch: 21, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.599 Vali Acc: 0.300 Test Loss: 3.599 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9079704284667969
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.636 Vali Acc: 0.308 Test Loss: 3.636 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.9398758411407471
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.643 Vali Acc: 0.308 Test Loss: 3.643 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8944005966186523
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.706 Vali Acc: 0.302 Test Loss: 3.706 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.08168625831604
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.747 Vali Acc: 0.299 Test Loss: 3.747 Test Acc: 0.299
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.9493699073791504
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.757 Vali Acc: 0.302 Test Loss: 3.757 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8754446506500244
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.784 Vali Acc: 0.304 Test Loss: 3.784 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8166670799255371
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.806 Vali Acc: 0.305 Test Loss: 3.806 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.0198564529418945
Epoch: 29, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.822 Vali Acc: 0.304 Test Loss: 3.822 Test Acc: 0.304
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8825743198394775
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.829 Vali Acc: 0.314 Test Loss: 3.829 Test Acc: 0.314
Validation loss decreased (-0.311729 --> -0.314079).  Saving model ...
Epoch: 31 cost time: 0.9982502460479736
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.889 Vali Acc: 0.312 Test Loss: 3.889 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.9836435317993164
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.887 Vali Acc: 0.307 Test Loss: 3.887 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.949462890625
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.892 Vali Acc: 0.304 Test Loss: 3.892 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8111176490783691
Epoch: 34, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.903 Vali Acc: 0.305 Test Loss: 3.903 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.9207644462585449
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.917 Vali Acc: 0.309 Test Loss: 3.917 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9057314395904541
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.922 Vali Acc: 0.307 Test Loss: 3.922 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.825753927230835
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.943 Vali Acc: 0.309 Test Loss: 3.943 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.9238560199737549
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.957 Vali Acc: 0.307 Test Loss: 3.957 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8479917049407959
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.977 Vali Acc: 0.309 Test Loss: 3.977 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7840819358825684
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.991 Vali Acc: 0.307 Test Loss: 3.991 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 164722
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.583994150161743
Epoch: 1, Steps: 10 | Train Loss: 3.261 Vali Loss: 3.280 Vali Acc: 0.053 Test Loss: 3.280 Test Acc: 0.053
Validation loss decreased (inf --> -0.052908).  Saving model ...
Epoch: 2 cost time: 0.9363927841186523
Epoch: 2, Steps: 10 | Train Loss: 3.183 Vali Loss: 3.266 Vali Acc: 0.066 Test Loss: 3.266 Test Acc: 0.066
Validation loss decreased (-0.052908 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.9808709621429443
Epoch: 3, Steps: 10 | Train Loss: 3.024 Vali Loss: 3.249 Vali Acc: 0.086 Test Loss: 3.249 Test Acc: 0.086
Validation loss decreased (-0.065850 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.9017441272735596
Epoch: 4, Steps: 10 | Train Loss: 2.849 Vali Loss: 3.235 Vali Acc: 0.109 Test Loss: 3.235 Test Acc: 0.109
Validation loss decreased (-0.085850 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.9203579425811768
Epoch: 5, Steps: 10 | Train Loss: 2.601 Vali Loss: 3.189 Vali Acc: 0.140 Test Loss: 3.189 Test Acc: 0.140
Validation loss decreased (-0.109379 --> -0.139968).  Saving model ...
Epoch: 6 cost time: 0.8757288455963135
Epoch: 6, Steps: 10 | Train Loss: 2.415 Vali Loss: 3.160 Vali Acc: 0.156 Test Loss: 3.160 Test Acc: 0.156
Validation loss decreased (-0.139968 --> -0.156439).  Saving model ...
Epoch: 7 cost time: 0.750070333480835
Epoch: 7, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.116 Vali Acc: 0.175 Test Loss: 3.116 Test Acc: 0.175
Validation loss decreased (-0.156439 --> -0.175263).  Saving model ...
Epoch: 8 cost time: 0.9904744625091553
Epoch: 8, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.089 Vali Acc: 0.192 Test Loss: 3.089 Test Acc: 0.192
Validation loss decreased (-0.175263 --> -0.191734).  Saving model ...
Epoch: 9 cost time: 0.987175703048706
Epoch: 9, Steps: 10 | Train Loss: 1.728 Vali Loss: 3.052 Vali Acc: 0.200 Test Loss: 3.052 Test Acc: 0.200
Validation loss decreased (-0.191734 --> -0.199969).  Saving model ...
Epoch: 10 cost time: 1.034008502960205
Epoch: 10, Steps: 10 | Train Loss: 1.467 Vali Loss: 3.053 Vali Acc: 0.213 Test Loss: 3.053 Test Acc: 0.213
Validation loss decreased (-0.199969 --> -0.212911).  Saving model ...
Epoch: 11 cost time: 1.0281784534454346
Epoch: 11, Steps: 10 | Train Loss: 1.240 Vali Loss: 3.042 Vali Acc: 0.232 Test Loss: 3.042 Test Acc: 0.232
Validation loss decreased (-0.212911 --> -0.231734).  Saving model ...
Epoch: 12 cost time: 1.0198841094970703
Epoch: 12, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.044 Vali Acc: 0.234 Test Loss: 3.044 Test Acc: 0.234
Validation loss decreased (-0.231734 --> -0.234087).  Saving model ...
Epoch: 13 cost time: 0.9515125751495361
Epoch: 13, Steps: 10 | Train Loss: 0.855 Vali Loss: 3.062 Vali Acc: 0.251 Test Loss: 3.062 Test Acc: 0.251
Validation loss decreased (-0.234087 --> -0.250558).  Saving model ...
Epoch: 14 cost time: 1.0621986389160156
Epoch: 14, Steps: 10 | Train Loss: 0.686 Vali Loss: 3.084 Vali Acc: 0.249 Test Loss: 3.084 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0752410888671875
Epoch: 15, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.076 Vali Acc: 0.269 Test Loss: 3.076 Test Acc: 0.269
Validation loss decreased (-0.250558 --> -0.269381).  Saving model ...
Epoch: 16 cost time: 0.997312068939209
Epoch: 16, Steps: 10 | Train Loss: 0.391 Vali Loss: 3.135 Vali Acc: 0.267 Test Loss: 3.135 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9996621608734131
Epoch: 17, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.187 Vali Acc: 0.261 Test Loss: 3.187 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.088043212890625
Epoch: 18, Steps: 10 | Train Loss: 0.201 Vali Loss: 3.213 Vali Acc: 0.285 Test Loss: 3.213 Test Acc: 0.285
Validation loss decreased (-0.269381 --> -0.284674).  Saving model ...
Epoch: 19 cost time: 1.0364093780517578
Epoch: 19, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.269 Vali Acc: 0.278 Test Loss: 3.269 Test Acc: 0.278
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.119708776473999
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.299 Vali Acc: 0.279 Test Loss: 3.299 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0568852424621582
Epoch: 21, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.333 Vali Acc: 0.281 Test Loss: 3.333 Test Acc: 0.281
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9583332538604736
Epoch: 22, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.380 Vali Acc: 0.280 Test Loss: 3.380 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.9545390605926514
Epoch: 23, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.381 Vali Acc: 0.285 Test Loss: 3.381 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.9523329734802246
Epoch: 24, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.443 Vali Acc: 0.281 Test Loss: 3.443 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.9611392021179199
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.487 Vali Acc: 0.278 Test Loss: 3.487 Test Acc: 0.278
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.0193192958831787
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.491 Vali Acc: 0.282 Test Loss: 3.491 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0887274742126465
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.503 Vali Acc: 0.281 Test Loss: 3.503 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.086580753326416
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.519 Vali Acc: 0.278 Test Loss: 3.519 Test Acc: 0.278
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2847058823529412
model parameter : 164722
model size : 1.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5263185501098633
Epoch: 1, Steps: 10 | Train Loss: 3.415 Vali Loss: 3.357 Vali Acc: 0.035 Test Loss: 3.357 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.9808413982391357
Epoch: 2, Steps: 10 | Train Loss: 3.157 Vali Loss: 3.306 Vali Acc: 0.060 Test Loss: 3.306 Test Acc: 0.060
Validation loss decreased (-0.035261 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 1.0320050716400146
Epoch: 3, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.279 Vali Acc: 0.092 Test Loss: 3.279 Test Acc: 0.092
Validation loss decreased (-0.059967 --> -0.091732).  Saving model ...
Epoch: 4 cost time: 1.08909273147583
Epoch: 4, Steps: 10 | Train Loss: 2.677 Vali Loss: 3.261 Vali Acc: 0.107 Test Loss: 3.261 Test Acc: 0.107
Validation loss decreased (-0.091732 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 1.0402748584747314
Epoch: 5, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.218 Vali Acc: 0.144 Test Loss: 3.218 Test Acc: 0.144
Validation loss decreased (-0.107026 --> -0.143497).  Saving model ...
Epoch: 6 cost time: 0.9768276214599609
Epoch: 6, Steps: 10 | Train Loss: 2.081 Vali Loss: 3.160 Vali Acc: 0.165 Test Loss: 3.160 Test Acc: 0.165
Validation loss decreased (-0.143497 --> -0.164674).  Saving model ...
Epoch: 7 cost time: 0.9060678482055664
Epoch: 7, Steps: 10 | Train Loss: 1.768 Vali Loss: 3.140 Vali Acc: 0.192 Test Loss: 3.140 Test Acc: 0.192
Validation loss decreased (-0.164674 --> -0.191733).  Saving model ...
Epoch: 8 cost time: 0.8515491485595703
Epoch: 8, Steps: 10 | Train Loss: 1.535 Vali Loss: 3.130 Vali Acc: 0.211 Test Loss: 3.130 Test Acc: 0.211
Validation loss decreased (-0.191733 --> -0.210557).  Saving model ...
Epoch: 9 cost time: 0.9623374938964844
Epoch: 9, Steps: 10 | Train Loss: 1.269 Vali Loss: 3.139 Vali Acc: 0.224 Test Loss: 3.139 Test Acc: 0.224
Validation loss decreased (-0.210557 --> -0.223498).  Saving model ...
Epoch: 10 cost time: 0.8726241588592529
Epoch: 10, Steps: 10 | Train Loss: 1.031 Vali Loss: 3.173 Vali Acc: 0.244 Test Loss: 3.173 Test Acc: 0.244
Validation loss decreased (-0.223498 --> -0.243498).  Saving model ...
Epoch: 11 cost time: 0.9207782745361328
Epoch: 11, Steps: 10 | Train Loss: 0.877 Vali Loss: 3.194 Vali Acc: 0.260 Test Loss: 3.194 Test Acc: 0.260
Validation loss decreased (-0.243498 --> -0.259968).  Saving model ...
Epoch: 12 cost time: 0.9515256881713867
Epoch: 12, Steps: 10 | Train Loss: 0.716 Vali Loss: 3.210 Vali Acc: 0.267 Test Loss: 3.210 Test Acc: 0.267
Validation loss decreased (-0.259968 --> -0.267027).  Saving model ...
Epoch: 13 cost time: 0.9844465255737305
Epoch: 13, Steps: 10 | Train Loss: 0.573 Vali Loss: 3.276 Vali Acc: 0.272 Test Loss: 3.276 Test Acc: 0.272
Validation loss decreased (-0.267027 --> -0.271732).  Saving model ...
Epoch: 14 cost time: 0.9186511039733887
Epoch: 14, Steps: 10 | Train Loss: 0.461 Vali Loss: 3.309 Vali Acc: 0.287 Test Loss: 3.309 Test Acc: 0.287
Validation loss decreased (-0.271732 --> -0.287026).  Saving model ...
Epoch: 15 cost time: 1.0172624588012695
Epoch: 15, Steps: 10 | Train Loss: 0.344 Vali Loss: 3.384 Vali Acc: 0.299 Test Loss: 3.384 Test Acc: 0.299
Validation loss decreased (-0.287026 --> -0.298790).  Saving model ...
Epoch: 16 cost time: 0.8910243511199951
Epoch: 16, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.431 Vali Acc: 0.294 Test Loss: 3.431 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8184564113616943
Epoch: 17, Steps: 10 | Train Loss: 0.207 Vali Loss: 3.515 Vali Acc: 0.300 Test Loss: 3.515 Test Acc: 0.300
Validation loss decreased (-0.298790 --> -0.299965).  Saving model ...
Epoch: 18 cost time: 0.8781251907348633
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.579 Vali Acc: 0.313 Test Loss: 3.579 Test Acc: 0.313
Validation loss decreased (-0.299965 --> -0.312905).  Saving model ...
Epoch: 19 cost time: 0.9290456771850586
Epoch: 19, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.598 Vali Acc: 0.311 Test Loss: 3.598 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9312901496887207
Epoch: 20, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.645 Vali Acc: 0.315 Test Loss: 3.645 Test Acc: 0.315
Validation loss decreased (-0.312905 --> -0.315258).  Saving model ...
Epoch: 21 cost time: 0.8508510589599609
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.716 Vali Acc: 0.315 Test Loss: 3.716 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.0620918273925781
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.752 Vali Acc: 0.315 Test Loss: 3.752 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.0174145698547363
Epoch: 23, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.781 Vali Acc: 0.318 Test Loss: 3.781 Test Acc: 0.318
Validation loss decreased (-0.315258 --> -0.317609).  Saving model ...
Epoch: 24 cost time: 0.8846383094787598
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.830 Vali Acc: 0.314 Test Loss: 3.830 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8593883514404297
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.879 Vali Acc: 0.316 Test Loss: 3.879 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.859429121017456
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.903 Vali Acc: 0.315 Test Loss: 3.903 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8836703300476074
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.914 Vali Acc: 0.322 Test Loss: 3.914 Test Acc: 0.322
Validation loss decreased (-0.317609 --> -0.322314).  Saving model ...
Epoch: 28 cost time: 0.9584193229675293
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.925 Vali Acc: 0.325 Test Loss: 3.925 Test Acc: 0.325
Validation loss decreased (-0.322314 --> -0.324667).  Saving model ...
Epoch: 29 cost time: 0.9974374771118164
Epoch: 29, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.977 Vali Acc: 0.319 Test Loss: 3.977 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.0024795532226562
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.005 Vali Acc: 0.320 Test Loss: 4.005 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9500794410705566
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.015 Vali Acc: 0.321 Test Loss: 4.015 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9810996055603027
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.038 Vali Acc: 0.318 Test Loss: 4.038 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9536244869232178
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.059 Vali Acc: 0.325 Test Loss: 4.059 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8136224746704102
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.078 Vali Acc: 0.321 Test Loss: 4.078 Test Acc: 0.321
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.818068265914917
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.121 Vali Acc: 0.316 Test Loss: 4.121 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 1.0183589458465576
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.140 Vali Acc: 0.316 Test Loss: 4.140 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.942018985748291
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.138 Vali Acc: 0.314 Test Loss: 4.138 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9219682216644287
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.146 Vali Acc: 0.319 Test Loss: 4.146 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 148338
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5120697021484375
Epoch: 1, Steps: 10 | Train Loss: 3.382 Vali Loss: 3.349 Vali Acc: 0.034 Test Loss: 3.349 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.9239282608032227
Epoch: 2, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.299 Vali Acc: 0.064 Test Loss: 3.299 Test Acc: 0.064
Validation loss decreased (-0.034084 --> -0.063496).  Saving model ...
Epoch: 3 cost time: 0.829352855682373
Epoch: 3, Steps: 10 | Train Loss: 2.915 Vali Loss: 3.273 Vali Acc: 0.098 Test Loss: 3.273 Test Acc: 0.098
Validation loss decreased (-0.063496 --> -0.097614).  Saving model ...
Epoch: 4 cost time: 0.9258596897125244
Epoch: 4, Steps: 10 | Train Loss: 2.702 Vali Loss: 3.258 Vali Acc: 0.111 Test Loss: 3.258 Test Acc: 0.111
Validation loss decreased (-0.097614 --> -0.110556).  Saving model ...
Epoch: 5 cost time: 0.9333040714263916
Epoch: 5, Steps: 10 | Train Loss: 2.413 Vali Loss: 3.218 Vali Acc: 0.141 Test Loss: 3.218 Test Acc: 0.141
Validation loss decreased (-0.110556 --> -0.141144).  Saving model ...
Epoch: 6 cost time: 0.9365451335906982
Epoch: 6, Steps: 10 | Train Loss: 2.152 Vali Loss: 3.163 Vali Acc: 0.167 Test Loss: 3.163 Test Acc: 0.167
Validation loss decreased (-0.141144 --> -0.167027).  Saving model ...
Epoch: 7 cost time: 0.935908317565918
Epoch: 7, Steps: 10 | Train Loss: 1.811 Vali Loss: 3.140 Vali Acc: 0.194 Test Loss: 3.140 Test Acc: 0.194
Validation loss decreased (-0.167027 --> -0.194086).  Saving model ...
Epoch: 8 cost time: 1.0008246898651123
Epoch: 8, Steps: 10 | Train Loss: 1.588 Vali Loss: 3.122 Vali Acc: 0.215 Test Loss: 3.122 Test Acc: 0.215
Validation loss decreased (-0.194086 --> -0.215263).  Saving model ...
Epoch: 9 cost time: 0.9170975685119629
Epoch: 9, Steps: 10 | Train Loss: 1.332 Vali Loss: 3.127 Vali Acc: 0.220 Test Loss: 3.127 Test Acc: 0.220
Validation loss decreased (-0.215263 --> -0.219969).  Saving model ...
Epoch: 10 cost time: 0.993018627166748
Epoch: 10, Steps: 10 | Train Loss: 1.074 Vali Loss: 3.155 Vali Acc: 0.236 Test Loss: 3.155 Test Acc: 0.236
Validation loss decreased (-0.219969 --> -0.236439).  Saving model ...
Epoch: 11 cost time: 0.9786622524261475
Epoch: 11, Steps: 10 | Train Loss: 0.914 Vali Loss: 3.169 Vali Acc: 0.264 Test Loss: 3.169 Test Acc: 0.264
Validation loss decreased (-0.236439 --> -0.263498).  Saving model ...
Epoch: 12 cost time: 1.0034763813018799
Epoch: 12, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.184 Vali Acc: 0.255 Test Loss: 3.184 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1342964172363281
Epoch: 13, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.244 Vali Acc: 0.272 Test Loss: 3.244 Test Acc: 0.272
Validation loss decreased (-0.263498 --> -0.271732).  Saving model ...
Epoch: 14 cost time: 1.0513436794281006
Epoch: 14, Steps: 10 | Train Loss: 0.507 Vali Loss: 3.267 Vali Acc: 0.282 Test Loss: 3.267 Test Acc: 0.282
Validation loss decreased (-0.271732 --> -0.282320).  Saving model ...
Epoch: 15 cost time: 1.0607781410217285
Epoch: 15, Steps: 10 | Train Loss: 0.378 Vali Loss: 3.339 Vali Acc: 0.295 Test Loss: 3.339 Test Acc: 0.295
Validation loss decreased (-0.282320 --> -0.295261).  Saving model ...
Epoch: 16 cost time: 0.9987742900848389
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.378 Vali Acc: 0.295 Test Loss: 3.378 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0249383449554443
Epoch: 17, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.458 Vali Acc: 0.298 Test Loss: 3.458 Test Acc: 0.298
Validation loss decreased (-0.295261 --> -0.297612).  Saving model ...
Epoch: 18 cost time: 0.943295955657959
Epoch: 18, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.517 Vali Acc: 0.302 Test Loss: 3.517 Test Acc: 0.302
Validation loss decreased (-0.297612 --> -0.302318).  Saving model ...
Epoch: 19 cost time: 0.8467776775360107
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.551 Vali Acc: 0.311 Test Loss: 3.551 Test Acc: 0.311
Validation loss decreased (-0.302318 --> -0.310553).  Saving model ...
Epoch: 20 cost time: 0.9358875751495361
Epoch: 20, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.584 Vali Acc: 0.308 Test Loss: 3.584 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0402634143829346
Epoch: 21, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.646 Vali Acc: 0.314 Test Loss: 3.646 Test Acc: 0.314
Validation loss decreased (-0.310553 --> -0.314081).  Saving model ...
Epoch: 22 cost time: 0.934790849685669
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.687 Vali Acc: 0.309 Test Loss: 3.687 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8477036952972412
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.733 Vali Acc: 0.305 Test Loss: 3.733 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9823300838470459
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.776 Vali Acc: 0.308 Test Loss: 3.776 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8709518909454346
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.823 Vali Acc: 0.324 Test Loss: 3.823 Test Acc: 0.324
Validation loss decreased (-0.314081 --> -0.323491).  Saving model ...
Epoch: 26 cost time: 0.9054839611053467
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.849 Vali Acc: 0.314 Test Loss: 3.849 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.916938066482544
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.859 Vali Acc: 0.313 Test Loss: 3.859 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.9071645736694336
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.866 Vali Acc: 0.313 Test Loss: 3.866 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9629371166229248
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.905 Vali Acc: 0.313 Test Loss: 3.905 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9785411357879639
Epoch: 30, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.948 Vali Acc: 0.312 Test Loss: 3.948 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.9629297256469727
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.963 Vali Acc: 0.312 Test Loss: 3.963 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9923129081726074
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.978 Vali Acc: 0.308 Test Loss: 3.978 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.9841952323913574
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.999 Vali Acc: 0.308 Test Loss: 3.999 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.958806037902832
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.017 Vali Acc: 0.313 Test Loss: 4.017 Test Acc: 0.313
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9887950420379639
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.055 Vali Acc: 0.315 Test Loss: 4.055 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 148338
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5992422103881836
Epoch: 1, Steps: 10 | Train Loss: 3.376 Vali Loss: 3.327 Vali Acc: 0.029 Test Loss: 3.327 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 1.0303473472595215
Epoch: 2, Steps: 10 | Train Loss: 3.152 Vali Loss: 3.283 Vali Acc: 0.054 Test Loss: 3.283 Test Acc: 0.054
Validation loss decreased (-0.029378 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 1.0359244346618652
Epoch: 3, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.261 Vali Acc: 0.087 Test Loss: 3.261 Test Acc: 0.087
Validation loss decreased (-0.054085 --> -0.087026).  Saving model ...
Epoch: 4 cost time: 0.8983578681945801
Epoch: 4, Steps: 10 | Train Loss: 2.758 Vali Loss: 3.249 Vali Acc: 0.106 Test Loss: 3.249 Test Acc: 0.106
Validation loss decreased (-0.087026 --> -0.105850).  Saving model ...
Epoch: 5 cost time: 0.9524734020233154
Epoch: 5, Steps: 10 | Train Loss: 2.450 Vali Loss: 3.213 Vali Acc: 0.134 Test Loss: 3.213 Test Acc: 0.134
Validation loss decreased (-0.105850 --> -0.134086).  Saving model ...
Epoch: 6 cost time: 0.8373537063598633
Epoch: 6, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.156 Vali Acc: 0.168 Test Loss: 3.156 Test Acc: 0.168
Validation loss decreased (-0.134086 --> -0.168204).  Saving model ...
Epoch: 7 cost time: 0.8683209419250488
Epoch: 7, Steps: 10 | Train Loss: 1.899 Vali Loss: 3.128 Vali Acc: 0.195 Test Loss: 3.128 Test Acc: 0.195
Validation loss decreased (-0.168204 --> -0.195263).  Saving model ...
Epoch: 8 cost time: 0.9271321296691895
Epoch: 8, Steps: 10 | Train Loss: 1.693 Vali Loss: 3.107 Vali Acc: 0.218 Test Loss: 3.107 Test Acc: 0.218
Validation loss decreased (-0.195263 --> -0.217616).  Saving model ...
Epoch: 9 cost time: 0.9481208324432373
Epoch: 9, Steps: 10 | Train Loss: 1.434 Vali Loss: 3.101 Vali Acc: 0.225 Test Loss: 3.101 Test Acc: 0.225
Validation loss decreased (-0.217616 --> -0.224675).  Saving model ...
Epoch: 10 cost time: 0.9487898349761963
Epoch: 10, Steps: 10 | Train Loss: 1.161 Vali Loss: 3.121 Vali Acc: 0.239 Test Loss: 3.121 Test Acc: 0.239
Validation loss decreased (-0.224675 --> -0.238792).  Saving model ...
Epoch: 11 cost time: 0.963648796081543
Epoch: 11, Steps: 10 | Train Loss: 0.999 Vali Loss: 3.132 Vali Acc: 0.258 Test Loss: 3.132 Test Acc: 0.258
Validation loss decreased (-0.238792 --> -0.257616).  Saving model ...
Epoch: 12 cost time: 1.0109059810638428
Epoch: 12, Steps: 10 | Train Loss: 0.836 Vali Loss: 3.134 Vali Acc: 0.258 Test Loss: 3.134 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9307072162628174
Epoch: 13, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.188 Vali Acc: 0.272 Test Loss: 3.188 Test Acc: 0.272
Validation loss decreased (-0.257616 --> -0.271733).  Saving model ...
Epoch: 14 cost time: 0.8566524982452393
Epoch: 14, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.223 Vali Acc: 0.284 Test Loss: 3.223 Test Acc: 0.284
Validation loss decreased (-0.271733 --> -0.283497).  Saving model ...
Epoch: 15 cost time: 0.9934854507446289
Epoch: 15, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.283 Vali Acc: 0.293 Test Loss: 3.283 Test Acc: 0.293
Validation loss decreased (-0.283497 --> -0.292908).  Saving model ...
Epoch: 16 cost time: 1.0785846710205078
Epoch: 16, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.322 Vali Acc: 0.294 Test Loss: 3.322 Test Acc: 0.294
Validation loss decreased (-0.292908 --> -0.294084).  Saving model ...
Epoch: 17 cost time: 1.1166956424713135
Epoch: 17, Steps: 10 | Train Loss: 0.227 Vali Loss: 3.380 Vali Acc: 0.295 Test Loss: 3.380 Test Acc: 0.295
Validation loss decreased (-0.294084 --> -0.295260).  Saving model ...
Epoch: 18 cost time: 1.1056759357452393
Epoch: 18, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.444 Vali Acc: 0.302 Test Loss: 3.444 Test Acc: 0.302
Validation loss decreased (-0.295260 --> -0.302319).  Saving model ...
Epoch: 19 cost time: 1.0875766277313232
Epoch: 19, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.473 Vali Acc: 0.306 Test Loss: 3.473 Test Acc: 0.306
Validation loss decreased (-0.302319 --> -0.305848).  Saving model ...
Epoch: 20 cost time: 1.1127703189849854
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.509 Vali Acc: 0.306 Test Loss: 3.509 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.0198919773101807
Epoch: 21, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.577 Vali Acc: 0.304 Test Loss: 3.577 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0387036800384521
Epoch: 22, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.625 Vali Acc: 0.308 Test Loss: 3.625 Test Acc: 0.308
Validation loss decreased (-0.305848 --> -0.308199).  Saving model ...
Epoch: 23 cost time: 1.0685145854949951
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.663 Vali Acc: 0.302 Test Loss: 3.663 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1243047714233398
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.710 Vali Acc: 0.304 Test Loss: 3.710 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.1652603149414062
Epoch: 25, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.743 Vali Acc: 0.313 Test Loss: 3.743 Test Acc: 0.313
Validation loss decreased (-0.308199 --> -0.312904).  Saving model ...
Epoch: 26 cost time: 1.1077382564544678
Epoch: 26, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.774 Vali Acc: 0.313 Test Loss: 3.774 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1895666122436523
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.788 Vali Acc: 0.306 Test Loss: 3.788 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.122330904006958
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.790 Vali Acc: 0.306 Test Loss: 3.790 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.9523365497589111
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.816 Vali Acc: 0.304 Test Loss: 3.816 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.9232375621795654
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.856 Vali Acc: 0.314 Test Loss: 3.856 Test Acc: 0.314
Validation loss decreased (-0.312904 --> -0.314079).  Saving model ...
Epoch: 31 cost time: 0.8907976150512695
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.875 Vali Acc: 0.314 Test Loss: 3.875 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.1514484882354736
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.884 Vali Acc: 0.314 Test Loss: 3.884 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.191357135772705
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.910 Vali Acc: 0.316 Test Loss: 3.910 Test Acc: 0.316
Validation loss decreased (-0.314079 --> -0.316431).  Saving model ...
Epoch: 34 cost time: 1.0477254390716553
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.931 Vali Acc: 0.314 Test Loss: 3.931 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.9877777099609375
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.968 Vali Acc: 0.313 Test Loss: 3.968 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.89864182472229
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.990 Vali Acc: 0.312 Test Loss: 3.990 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0057995319366455
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.997 Vali Acc: 0.307 Test Loss: 3.997 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.9817690849304199
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.007 Vali Acc: 0.312 Test Loss: 4.007 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.212874412536621
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.008 Vali Acc: 0.313 Test Loss: 4.008 Test Acc: 0.313
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9716751575469971
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.017 Vali Acc: 0.318 Test Loss: 4.017 Test Acc: 0.318
Validation loss decreased (-0.316431 --> -0.317607).  Saving model ...
Epoch: 41 cost time: 1.1778810024261475
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.031 Vali Acc: 0.315 Test Loss: 4.031 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.0438685417175293
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.049 Vali Acc: 0.312 Test Loss: 4.049 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.9871103763580322
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.054 Vali Acc: 0.314 Test Loss: 4.054 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 1.0082402229309082
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.071 Vali Acc: 0.314 Test Loss: 4.071 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 1.111039161682129
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.089 Vali Acc: 0.314 Test Loss: 4.089 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 1.1206798553466797
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.099 Vali Acc: 0.318 Test Loss: 4.099 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 1.202699899673462
Epoch: 47, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.106 Vali Acc: 0.316 Test Loss: 4.106 Test Acc: 0.316
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 1.112076759338379
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.118 Vali Acc: 0.315 Test Loss: 4.118 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 1.1922757625579834
Epoch: 49, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.135 Vali Acc: 0.316 Test Loss: 4.135 Test Acc: 0.316
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 1.0735058784484863
Epoch: 50, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.147 Vali Acc: 0.316 Test Loss: 4.147 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 148338
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5820257663726807
Epoch: 1, Steps: 10 | Train Loss: 3.346 Vali Loss: 3.305 Vali Acc: 0.036 Test Loss: 3.305 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 1.0159697532653809
Epoch: 2, Steps: 10 | Train Loss: 3.160 Vali Loss: 3.277 Vali Acc: 0.056 Test Loss: 3.277 Test Acc: 0.056
Validation loss decreased (-0.036438 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.9008045196533203
Epoch: 3, Steps: 10 | Train Loss: 3.004 Vali Loss: 3.261 Vali Acc: 0.078 Test Loss: 3.261 Test Acc: 0.078
Validation loss decreased (-0.056438 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.937004566192627
Epoch: 4, Steps: 10 | Train Loss: 2.867 Vali Loss: 3.255 Vali Acc: 0.102 Test Loss: 3.255 Test Acc: 0.102
Validation loss decreased (-0.077614 --> -0.102320).  Saving model ...
Epoch: 5 cost time: 1.1467180252075195
Epoch: 5, Steps: 10 | Train Loss: 2.622 Vali Loss: 3.230 Vali Acc: 0.115 Test Loss: 3.230 Test Acc: 0.115
Validation loss decreased (-0.102320 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 0.7825009822845459
Epoch: 6, Steps: 10 | Train Loss: 2.419 Vali Loss: 3.179 Vali Acc: 0.155 Test Loss: 3.179 Test Acc: 0.155
Validation loss decreased (-0.115262 --> -0.155262).  Saving model ...
Epoch: 7 cost time: 0.7913429737091064
Epoch: 7, Steps: 10 | Train Loss: 2.149 Vali Loss: 3.141 Vali Acc: 0.169 Test Loss: 3.141 Test Acc: 0.169
Validation loss decreased (-0.155262 --> -0.169380).  Saving model ...
Epoch: 8 cost time: 0.834646463394165
Epoch: 8, Steps: 10 | Train Loss: 1.967 Vali Loss: 3.108 Vali Acc: 0.184 Test Loss: 3.108 Test Acc: 0.184
Validation loss decreased (-0.169380 --> -0.183498).  Saving model ...
Epoch: 9 cost time: 0.8841226100921631
Epoch: 9, Steps: 10 | Train Loss: 1.714 Vali Loss: 3.083 Vali Acc: 0.199 Test Loss: 3.083 Test Acc: 0.199
Validation loss decreased (-0.183498 --> -0.198793).  Saving model ...
Epoch: 10 cost time: 0.9644327163696289
Epoch: 10, Steps: 10 | Train Loss: 1.478 Vali Loss: 3.074 Vali Acc: 0.219 Test Loss: 3.074 Test Acc: 0.219
Validation loss decreased (-0.198793 --> -0.218793).  Saving model ...
Epoch: 11 cost time: 1.0388453006744385
Epoch: 11, Steps: 10 | Train Loss: 1.257 Vali Loss: 3.074 Vali Acc: 0.225 Test Loss: 3.074 Test Acc: 0.225
Validation loss decreased (-0.218793 --> -0.224675).  Saving model ...
Epoch: 12 cost time: 1.0290307998657227
Epoch: 12, Steps: 10 | Train Loss: 1.082 Vali Loss: 3.061 Vali Acc: 0.244 Test Loss: 3.061 Test Acc: 0.244
Validation loss decreased (-0.224675 --> -0.243499).  Saving model ...
Epoch: 13 cost time: 1.0561704635620117
Epoch: 13, Steps: 10 | Train Loss: 0.915 Vali Loss: 3.083 Vali Acc: 0.245 Test Loss: 3.083 Test Acc: 0.245
Validation loss decreased (-0.243499 --> -0.244675).  Saving model ...
Epoch: 14 cost time: 0.8598177433013916
Epoch: 14, Steps: 10 | Train Loss: 0.755 Vali Loss: 3.090 Vali Acc: 0.260 Test Loss: 3.090 Test Acc: 0.260
Validation loss decreased (-0.244675 --> -0.259969).  Saving model ...
Epoch: 15 cost time: 0.8704378604888916
Epoch: 15, Steps: 10 | Train Loss: 0.558 Vali Loss: 3.135 Vali Acc: 0.255 Test Loss: 3.135 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8616812229156494
Epoch: 16, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.156 Vali Acc: 0.255 Test Loss: 3.156 Test Acc: 0.255
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8916213512420654
Epoch: 17, Steps: 10 | Train Loss: 0.303 Vali Loss: 3.204 Vali Acc: 0.268 Test Loss: 3.204 Test Acc: 0.268
Validation loss decreased (-0.259969 --> -0.268203).  Saving model ...
Epoch: 18 cost time: 0.97676682472229
Epoch: 18, Steps: 10 | Train Loss: 0.214 Vali Loss: 3.261 Vali Acc: 0.274 Test Loss: 3.261 Test Acc: 0.274
Validation loss decreased (-0.268203 --> -0.274085).  Saving model ...
Epoch: 19 cost time: 0.9775364398956299
Epoch: 19, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.277 Vali Acc: 0.288 Test Loss: 3.277 Test Acc: 0.288
Validation loss decreased (-0.274085 --> -0.288203).  Saving model ...
Epoch: 20 cost time: 1.0387506484985352
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.312 Vali Acc: 0.280 Test Loss: 3.312 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9915060997009277
Epoch: 21, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.366 Vali Acc: 0.285 Test Loss: 3.366 Test Acc: 0.285
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.0543599128723145
Epoch: 22, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.388 Vali Acc: 0.280 Test Loss: 3.388 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9743626117706299
Epoch: 23, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.433 Vali Acc: 0.281 Test Loss: 3.433 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.9510211944580078
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.475 Vali Acc: 0.284 Test Loss: 3.475 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9049978256225586
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.516 Vali Acc: 0.282 Test Loss: 3.516 Test Acc: 0.282
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.1641666889190674
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.553 Vali Acc: 0.284 Test Loss: 3.553 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.1286296844482422
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.556 Vali Acc: 0.275 Test Loss: 3.556 Test Acc: 0.275
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0240650177001953
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.573 Vali Acc: 0.281 Test Loss: 3.573 Test Acc: 0.281
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.0252904891967773
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.600 Vali Acc: 0.279 Test Loss: 3.600 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28823529411764703
model parameter : 148338
model size : 1.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5226314067840576
Epoch: 1, Steps: 10 | Train Loss: 3.355 Vali Loss: 3.393 Vali Acc: 0.028 Test Loss: 3.393 Test Acc: 0.028
Validation loss decreased (inf --> -0.028201).  Saving model ...
Epoch: 2 cost time: 1.0235631465911865
Epoch: 2, Steps: 10 | Train Loss: 3.182 Vali Loss: 3.337 Vali Acc: 0.042 Test Loss: 3.337 Test Acc: 0.042
Validation loss decreased (-0.028201 --> -0.042320).  Saving model ...
Epoch: 3 cost time: 0.8552050590515137
Epoch: 3, Steps: 10 | Train Loss: 2.961 Vali Loss: 3.303 Vali Acc: 0.079 Test Loss: 3.303 Test Acc: 0.079
Validation loss decreased (-0.042320 --> -0.078790).  Saving model ...
Epoch: 4 cost time: 0.8007488250732422
Epoch: 4, Steps: 10 | Train Loss: 2.695 Vali Loss: 3.256 Vali Acc: 0.109 Test Loss: 3.256 Test Acc: 0.109
Validation loss decreased (-0.078790 --> -0.109379).  Saving model ...
Epoch: 5 cost time: 0.8585391044616699
Epoch: 5, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.218 Vali Acc: 0.135 Test Loss: 3.218 Test Acc: 0.135
Validation loss decreased (-0.109379 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 1.083528995513916
Epoch: 6, Steps: 10 | Train Loss: 2.098 Vali Loss: 3.175 Vali Acc: 0.166 Test Loss: 3.175 Test Acc: 0.166
Validation loss decreased (-0.135262 --> -0.165851).  Saving model ...
Epoch: 7 cost time: 0.8576059341430664
Epoch: 7, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.150 Vali Acc: 0.194 Test Loss: 3.150 Test Acc: 0.194
Validation loss decreased (-0.165851 --> -0.194086).  Saving model ...
Epoch: 8 cost time: 0.9132299423217773
Epoch: 8, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.169 Vali Acc: 0.205 Test Loss: 3.169 Test Acc: 0.205
Validation loss decreased (-0.194086 --> -0.204674).  Saving model ...
Epoch: 9 cost time: 0.992523193359375
Epoch: 9, Steps: 10 | Train Loss: 1.304 Vali Loss: 3.162 Vali Acc: 0.220 Test Loss: 3.162 Test Acc: 0.220
Validation loss decreased (-0.204674 --> -0.219968).  Saving model ...
Epoch: 10 cost time: 0.9728467464447021
Epoch: 10, Steps: 10 | Train Loss: 1.022 Vali Loss: 3.196 Vali Acc: 0.233 Test Loss: 3.196 Test Acc: 0.233
Validation loss decreased (-0.219968 --> -0.232909).  Saving model ...
Epoch: 11 cost time: 1.040860652923584
Epoch: 11, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.207 Vali Acc: 0.241 Test Loss: 3.207 Test Acc: 0.241
Validation loss decreased (-0.232909 --> -0.241144).  Saving model ...
Epoch: 12 cost time: 1.114896535873413
Epoch: 12, Steps: 10 | Train Loss: 0.673 Vali Loss: 3.215 Vali Acc: 0.266 Test Loss: 3.215 Test Acc: 0.266
Validation loss decreased (-0.241144 --> -0.265850).  Saving model ...
Epoch: 13 cost time: 1.109107255935669
Epoch: 13, Steps: 10 | Train Loss: 0.557 Vali Loss: 3.269 Vali Acc: 0.279 Test Loss: 3.269 Test Acc: 0.279
Validation loss decreased (-0.265850 --> -0.278791).  Saving model ...
Epoch: 14 cost time: 1.1235332489013672
Epoch: 14, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.325 Vali Acc: 0.280 Test Loss: 3.325 Test Acc: 0.280
Validation loss decreased (-0.278791 --> -0.279967).  Saving model ...
Epoch: 15 cost time: 1.0807743072509766
Epoch: 15, Steps: 10 | Train Loss: 0.352 Vali Loss: 3.363 Vali Acc: 0.293 Test Loss: 3.363 Test Acc: 0.293
Validation loss decreased (-0.279967 --> -0.292908).  Saving model ...
Epoch: 16 cost time: 0.9610936641693115
Epoch: 16, Steps: 10 | Train Loss: 0.251 Vali Loss: 3.438 Vali Acc: 0.299 Test Loss: 3.438 Test Acc: 0.299
Validation loss decreased (-0.292908 --> -0.298789).  Saving model ...
Epoch: 17 cost time: 1.0487418174743652
Epoch: 17, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.498 Vali Acc: 0.295 Test Loss: 3.498 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.0149116516113281
Epoch: 18, Steps: 10 | Train Loss: 0.152 Vali Loss: 3.551 Vali Acc: 0.293 Test Loss: 3.551 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.176302194595337
Epoch: 19, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.629 Vali Acc: 0.295 Test Loss: 3.629 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1327977180480957
Epoch: 20, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.715 Vali Acc: 0.294 Test Loss: 3.715 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.0853168964385986
Epoch: 21, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.720 Vali Acc: 0.308 Test Loss: 3.720 Test Acc: 0.308
Validation loss decreased (-0.298789 --> -0.308198).  Saving model ...
Epoch: 22 cost time: 1.205345869064331
Epoch: 22, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.770 Vali Acc: 0.308 Test Loss: 3.770 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0588538646697998
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.813 Vali Acc: 0.300 Test Loss: 3.813 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9499232769012451
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.833 Vali Acc: 0.315 Test Loss: 3.833 Test Acc: 0.315
Validation loss decreased (-0.308198 --> -0.315256).  Saving model ...
Epoch: 25 cost time: 0.9716567993164062
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.873 Vali Acc: 0.318 Test Loss: 3.873 Test Acc: 0.318
Validation loss decreased (-0.315256 --> -0.317608).  Saving model ...
Epoch: 26 cost time: 0.9291162490844727
Epoch: 26, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.873 Vali Acc: 0.316 Test Loss: 3.873 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1767759323120117
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.893 Vali Acc: 0.315 Test Loss: 3.893 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.1117222309112549
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.939 Vali Acc: 0.312 Test Loss: 3.939 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0244824886322021
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.973 Vali Acc: 0.314 Test Loss: 3.973 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.0144398212432861
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.017 Vali Acc: 0.316 Test Loss: 4.017 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.0954172611236572
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.024 Vali Acc: 0.314 Test Loss: 4.024 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.9510867595672607
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.044 Vali Acc: 0.315 Test Loss: 4.044 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.0584604740142822
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.085 Vali Acc: 0.318 Test Loss: 4.085 Test Acc: 0.318
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.9709181785583496
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.100 Vali Acc: 0.315 Test Loss: 4.100 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 1.098381519317627
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.122 Vali Acc: 0.309 Test Loss: 4.122 Test Acc: 0.309
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3176470588235294
model parameter : 140146
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.826237916946411
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.372 Vali Acc: 0.029 Test Loss: 3.372 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 1.000248908996582
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.320 Vali Acc: 0.054 Test Loss: 3.320 Test Acc: 0.054
Validation loss decreased (-0.029378 --> -0.054084).  Saving model ...
Epoch: 3 cost time: 0.8465597629547119
Epoch: 3, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.287 Vali Acc: 0.079 Test Loss: 3.287 Test Acc: 0.079
Validation loss decreased (-0.054084 --> -0.078791).  Saving model ...
Epoch: 4 cost time: 0.8921632766723633
Epoch: 4, Steps: 10 | Train Loss: 2.722 Vali Loss: 3.242 Vali Acc: 0.111 Test Loss: 3.242 Test Acc: 0.111
Validation loss decreased (-0.078791 --> -0.110556).  Saving model ...
Epoch: 5 cost time: 0.8943850994110107
Epoch: 5, Steps: 10 | Train Loss: 2.412 Vali Loss: 3.207 Vali Acc: 0.139 Test Loss: 3.207 Test Acc: 0.139
Validation loss decreased (-0.110556 --> -0.138791).  Saving model ...
Epoch: 6 cost time: 1.0049734115600586
Epoch: 6, Steps: 10 | Train Loss: 2.142 Vali Loss: 3.164 Vali Acc: 0.172 Test Loss: 3.164 Test Acc: 0.172
Validation loss decreased (-0.138791 --> -0.171733).  Saving model ...
Epoch: 7 cost time: 1.037473201751709
Epoch: 7, Steps: 10 | Train Loss: 1.890 Vali Loss: 3.135 Vali Acc: 0.205 Test Loss: 3.135 Test Acc: 0.205
Validation loss decreased (-0.171733 --> -0.204675).  Saving model ...
Epoch: 8 cost time: 0.9989829063415527
Epoch: 8, Steps: 10 | Train Loss: 1.602 Vali Loss: 3.147 Vali Acc: 0.200 Test Loss: 3.147 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9642424583435059
Epoch: 9, Steps: 10 | Train Loss: 1.365 Vali Loss: 3.140 Vali Acc: 0.238 Test Loss: 3.140 Test Acc: 0.238
Validation loss decreased (-0.204675 --> -0.237616).  Saving model ...
Epoch: 10 cost time: 0.9749019145965576
Epoch: 10, Steps: 10 | Train Loss: 1.089 Vali Loss: 3.168 Vali Acc: 0.235 Test Loss: 3.168 Test Acc: 0.235
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9670908451080322
Epoch: 11, Steps: 10 | Train Loss: 0.950 Vali Loss: 3.169 Vali Acc: 0.245 Test Loss: 3.169 Test Acc: 0.245
Validation loss decreased (-0.237616 --> -0.244674).  Saving model ...
Epoch: 12 cost time: 0.9474954605102539
Epoch: 12, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.174 Vali Acc: 0.266 Test Loss: 3.174 Test Acc: 0.266
Validation loss decreased (-0.244674 --> -0.265851).  Saving model ...
Epoch: 13 cost time: 0.8712601661682129
Epoch: 13, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.227 Vali Acc: 0.272 Test Loss: 3.227 Test Acc: 0.272
Validation loss decreased (-0.265851 --> -0.271732).  Saving model ...
Epoch: 14 cost time: 0.8759171962738037
Epoch: 14, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.271 Vali Acc: 0.272 Test Loss: 3.271 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9956128597259521
Epoch: 15, Steps: 10 | Train Loss: 0.380 Vali Loss: 3.314 Vali Acc: 0.294 Test Loss: 3.314 Test Acc: 0.294
Validation loss decreased (-0.271732 --> -0.294085).  Saving model ...
Epoch: 16 cost time: 1.0332856178283691
Epoch: 16, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.386 Vali Acc: 0.292 Test Loss: 3.386 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0321664810180664
Epoch: 17, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.425 Vali Acc: 0.291 Test Loss: 3.425 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1305720806121826
Epoch: 18, Steps: 10 | Train Loss: 0.163 Vali Loss: 3.499 Vali Acc: 0.292 Test Loss: 3.499 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1006333827972412
Epoch: 19, Steps: 10 | Train Loss: 0.127 Vali Loss: 3.570 Vali Acc: 0.305 Test Loss: 3.570 Test Acc: 0.305
Validation loss decreased (-0.294085 --> -0.304670).  Saving model ...
Epoch: 20 cost time: 0.9315516948699951
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 3.633 Vali Acc: 0.305 Test Loss: 3.633 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9431567192077637
Epoch: 21, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.651 Vali Acc: 0.312 Test Loss: 3.651 Test Acc: 0.312
Validation loss decreased (-0.304670 --> -0.311728).  Saving model ...
Epoch: 22 cost time: 1.016869068145752
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.704 Vali Acc: 0.306 Test Loss: 3.704 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.153533697128296
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.735 Vali Acc: 0.315 Test Loss: 3.735 Test Acc: 0.315
Validation loss decreased (-0.311728 --> -0.315257).  Saving model ...
Epoch: 24 cost time: 1.1460437774658203
Epoch: 24, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.779 Vali Acc: 0.318 Test Loss: 3.779 Test Acc: 0.318
Validation loss decreased (-0.315257 --> -0.317609).  Saving model ...
Epoch: 25 cost time: 1.1084651947021484
Epoch: 25, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.814 Vali Acc: 0.322 Test Loss: 3.814 Test Acc: 0.322
Validation loss decreased (-0.317609 --> -0.322315).  Saving model ...
Epoch: 26 cost time: 1.1401212215423584
Epoch: 26, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.805 Vali Acc: 0.311 Test Loss: 3.805 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.109567403793335
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.830 Vali Acc: 0.316 Test Loss: 3.830 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.141951560974121
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.857 Vali Acc: 0.311 Test Loss: 3.857 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.0496671199798584
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.895 Vali Acc: 0.311 Test Loss: 3.895 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.1187450885772705
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.941 Vali Acc: 0.308 Test Loss: 3.941 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.2997310161590576
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.948 Vali Acc: 0.316 Test Loss: 3.948 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 1.1514170169830322
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.969 Vali Acc: 0.315 Test Loss: 3.969 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 1.2512233257293701
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 4.013 Vali Acc: 0.312 Test Loss: 4.013 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 1.1437485218048096
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 4.029 Vali Acc: 0.312 Test Loss: 4.029 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.957902193069458
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.052 Vali Acc: 0.312 Test Loss: 4.052 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 140146
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6562001705169678
Epoch: 1, Steps: 10 | Train Loss: 3.334 Vali Loss: 3.345 Vali Acc: 0.029 Test Loss: 3.345 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.8354237079620361
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.302 Vali Acc: 0.045 Test Loss: 3.302 Test Acc: 0.045
Validation loss decreased (-0.029378 --> -0.044673).  Saving model ...
Epoch: 3 cost time: 0.8335323333740234
Epoch: 3, Steps: 10 | Train Loss: 2.997 Vali Loss: 3.272 Vali Acc: 0.076 Test Loss: 3.272 Test Acc: 0.076
Validation loss decreased (-0.044673 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.8279902935028076
Epoch: 4, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.231 Vali Acc: 0.104 Test Loss: 3.231 Test Acc: 0.104
Validation loss decreased (-0.076438 --> -0.103497).  Saving model ...
Epoch: 5 cost time: 0.8685445785522461
Epoch: 5, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.198 Vali Acc: 0.141 Test Loss: 3.198 Test Acc: 0.141
Validation loss decreased (-0.103497 --> -0.141144).  Saving model ...
Epoch: 6 cost time: 0.8821151256561279
Epoch: 6, Steps: 10 | Train Loss: 2.227 Vali Loss: 3.157 Vali Acc: 0.160 Test Loss: 3.157 Test Acc: 0.160
Validation loss decreased (-0.141144 --> -0.159968).  Saving model ...
Epoch: 7 cost time: 0.9474573135375977
Epoch: 7, Steps: 10 | Train Loss: 1.961 Vali Loss: 3.125 Vali Acc: 0.189 Test Loss: 3.125 Test Acc: 0.189
Validation loss decreased (-0.159968 --> -0.189381).  Saving model ...
Epoch: 8 cost time: 0.998816967010498
Epoch: 8, Steps: 10 | Train Loss: 1.697 Vali Loss: 3.126 Vali Acc: 0.192 Test Loss: 3.126 Test Acc: 0.192
Validation loss decreased (-0.189381 --> -0.191733).  Saving model ...
Epoch: 9 cost time: 0.914527177810669
Epoch: 9, Steps: 10 | Train Loss: 1.453 Vali Loss: 3.114 Vali Acc: 0.213 Test Loss: 3.114 Test Acc: 0.213
Validation loss decreased (-0.191733 --> -0.212910).  Saving model ...
Epoch: 10 cost time: 0.945246696472168
Epoch: 10, Steps: 10 | Train Loss: 1.158 Vali Loss: 3.132 Vali Acc: 0.229 Test Loss: 3.132 Test Acc: 0.229
Validation loss decreased (-0.212910 --> -0.229380).  Saving model ...
Epoch: 11 cost time: 0.9646191596984863
Epoch: 11, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.139 Vali Acc: 0.234 Test Loss: 3.139 Test Acc: 0.234
Validation loss decreased (-0.229380 --> -0.234086).  Saving model ...
Epoch: 12 cost time: 0.8819248676300049
Epoch: 12, Steps: 10 | Train Loss: 0.778 Vali Loss: 3.143 Vali Acc: 0.254 Test Loss: 3.143 Test Acc: 0.254
Validation loss decreased (-0.234086 --> -0.254086).  Saving model ...
Epoch: 13 cost time: 0.9086194038391113
Epoch: 13, Steps: 10 | Train Loss: 0.647 Vali Loss: 3.190 Vali Acc: 0.259 Test Loss: 3.190 Test Acc: 0.259
Validation loss decreased (-0.254086 --> -0.258792).  Saving model ...
Epoch: 14 cost time: 0.8853759765625
Epoch: 14, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.225 Vali Acc: 0.274 Test Loss: 3.225 Test Acc: 0.274
Validation loss decreased (-0.258792 --> -0.274085).  Saving model ...
Epoch: 15 cost time: 0.8950235843658447
Epoch: 15, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.265 Vali Acc: 0.278 Test Loss: 3.265 Test Acc: 0.278
Validation loss decreased (-0.274085 --> -0.277614).  Saving model ...
Epoch: 16 cost time: 0.9825639724731445
Epoch: 16, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.334 Vali Acc: 0.286 Test Loss: 3.334 Test Acc: 0.286
Validation loss decreased (-0.277614 --> -0.285849).  Saving model ...
Epoch: 17 cost time: 1.03721022605896
Epoch: 17, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.373 Vali Acc: 0.289 Test Loss: 3.373 Test Acc: 0.289
Validation loss decreased (-0.285849 --> -0.289378).  Saving model ...
Epoch: 18 cost time: 0.7610452175140381
Epoch: 18, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.442 Vali Acc: 0.288 Test Loss: 3.442 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9879374504089355
Epoch: 19, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.500 Vali Acc: 0.299 Test Loss: 3.500 Test Acc: 0.299
Validation loss decreased (-0.289378 --> -0.298789).  Saving model ...
Epoch: 20 cost time: 0.9124884605407715
Epoch: 20, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.558 Vali Acc: 0.291 Test Loss: 3.558 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8693292140960693
Epoch: 21, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.578 Vali Acc: 0.287 Test Loss: 3.578 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8319380283355713
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.616 Vali Acc: 0.288 Test Loss: 3.616 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9205837249755859
Epoch: 23, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.661 Vali Acc: 0.293 Test Loss: 3.661 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7692506313323975
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.690 Vali Acc: 0.294 Test Loss: 3.690 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8866324424743652
Epoch: 25, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.711 Vali Acc: 0.294 Test Loss: 3.711 Test Acc: 0.294
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8722424507141113
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.701 Vali Acc: 0.291 Test Loss: 3.701 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8605544567108154
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.739 Vali Acc: 0.296 Test Loss: 3.739 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.9307065010070801
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.796 Vali Acc: 0.294 Test Loss: 3.796 Test Acc: 0.294
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8984706401824951
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.821 Vali Acc: 0.292 Test Loss: 3.821 Test Acc: 0.292
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 140146
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4499564170837402
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.286 Vali Acc: 0.034 Test Loss: 3.286 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 1.0095746517181396
Epoch: 2, Steps: 10 | Train Loss: 3.175 Vali Loss: 3.262 Vali Acc: 0.051 Test Loss: 3.262 Test Acc: 0.051
Validation loss decreased (-0.034085 --> -0.050556).  Saving model ...
Epoch: 3 cost time: 1.104351282119751
Epoch: 3, Steps: 10 | Train Loss: 3.040 Vali Loss: 3.243 Vali Acc: 0.081 Test Loss: 3.243 Test Acc: 0.081
Validation loss decreased (-0.050556 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 1.088728427886963
Epoch: 4, Steps: 10 | Train Loss: 2.859 Vali Loss: 3.215 Vali Acc: 0.113 Test Loss: 3.215 Test Acc: 0.113
Validation loss decreased (-0.081144 --> -0.112909).  Saving model ...
Epoch: 5 cost time: 1.014305591583252
Epoch: 5, Steps: 10 | Train Loss: 2.651 Vali Loss: 3.187 Vali Acc: 0.135 Test Loss: 3.187 Test Acc: 0.135
Validation loss decreased (-0.112909 --> -0.135262).  Saving model ...
Epoch: 6 cost time: 0.9742145538330078
Epoch: 6, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.146 Vali Acc: 0.153 Test Loss: 3.146 Test Acc: 0.153
Validation loss decreased (-0.135262 --> -0.152910).  Saving model ...
Epoch: 7 cost time: 0.917177677154541
Epoch: 7, Steps: 10 | Train Loss: 2.208 Vali Loss: 3.105 Vali Acc: 0.180 Test Loss: 3.105 Test Acc: 0.180
Validation loss decreased (-0.152910 --> -0.179969).  Saving model ...
Epoch: 8 cost time: 0.9415791034698486
Epoch: 8, Steps: 10 | Train Loss: 1.952 Vali Loss: 3.083 Vali Acc: 0.192 Test Loss: 3.083 Test Acc: 0.192
Validation loss decreased (-0.179969 --> -0.191734).  Saving model ...
Epoch: 9 cost time: 1.0401766300201416
Epoch: 9, Steps: 10 | Train Loss: 1.736 Vali Loss: 3.059 Vali Acc: 0.209 Test Loss: 3.059 Test Acc: 0.209
Validation loss decreased (-0.191734 --> -0.209381).  Saving model ...
Epoch: 10 cost time: 0.9729743003845215
Epoch: 10, Steps: 10 | Train Loss: 1.461 Vali Loss: 3.049 Vali Acc: 0.224 Test Loss: 3.049 Test Acc: 0.224
Validation loss decreased (-0.209381 --> -0.223499).  Saving model ...
Epoch: 11 cost time: 1.0717413425445557
Epoch: 11, Steps: 10 | Train Loss: 1.293 Vali Loss: 3.033 Vali Acc: 0.227 Test Loss: 3.033 Test Acc: 0.227
Validation loss decreased (-0.223499 --> -0.227028).  Saving model ...
Epoch: 12 cost time: 1.054009199142456
Epoch: 12, Steps: 10 | Train Loss: 1.061 Vali Loss: 3.025 Vali Acc: 0.240 Test Loss: 3.025 Test Acc: 0.240
Validation loss decreased (-0.227028 --> -0.239970).  Saving model ...
Epoch: 13 cost time: 1.0924267768859863
Epoch: 13, Steps: 10 | Train Loss: 0.887 Vali Loss: 3.049 Vali Acc: 0.246 Test Loss: 3.049 Test Acc: 0.246
Validation loss decreased (-0.239970 --> -0.245852).  Saving model ...
Epoch: 14 cost time: 1.1110012531280518
Epoch: 14, Steps: 10 | Train Loss: 0.754 Vali Loss: 3.078 Vali Acc: 0.249 Test Loss: 3.078 Test Acc: 0.249
Validation loss decreased (-0.245852 --> -0.249381).  Saving model ...
Epoch: 15 cost time: 1.0766828060150146
Epoch: 15, Steps: 10 | Train Loss: 0.584 Vali Loss: 3.097 Vali Acc: 0.261 Test Loss: 3.097 Test Acc: 0.261
Validation loss decreased (-0.249381 --> -0.261145).  Saving model ...
Epoch: 16 cost time: 1.005852460861206
Epoch: 16, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.124 Vali Acc: 0.261 Test Loss: 3.124 Test Acc: 0.261
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0477714538574219
Epoch: 17, Steps: 10 | Train Loss: 0.321 Vali Loss: 3.146 Vali Acc: 0.273 Test Loss: 3.146 Test Acc: 0.273
Validation loss decreased (-0.261145 --> -0.272910).  Saving model ...
Epoch: 18 cost time: 1.0143561363220215
Epoch: 18, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.204 Vali Acc: 0.267 Test Loss: 3.204 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1122381687164307
Epoch: 19, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.268 Vali Acc: 0.272 Test Loss: 3.268 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0517528057098389
Epoch: 20, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.337 Vali Acc: 0.268 Test Loss: 3.337 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1260502338409424
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.351 Vali Acc: 0.274 Test Loss: 3.351 Test Acc: 0.274
Validation loss decreased (-0.272910 --> -0.274084).  Saving model ...
Epoch: 22 cost time: 1.1351449489593506
Epoch: 22, Steps: 10 | Train Loss: 0.083 Vali Loss: 3.375 Vali Acc: 0.286 Test Loss: 3.375 Test Acc: 0.286
Validation loss decreased (-0.274084 --> -0.285849).  Saving model ...
Epoch: 23 cost time: 1.042090654373169
Epoch: 23, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.401 Vali Acc: 0.282 Test Loss: 3.401 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.0061004161834717
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.426 Vali Acc: 0.278 Test Loss: 3.426 Test Acc: 0.278
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.053812026977539
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.482 Vali Acc: 0.276 Test Loss: 3.482 Test Acc: 0.276
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.0990126132965088
Epoch: 26, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.477 Vali Acc: 0.281 Test Loss: 3.477 Test Acc: 0.281
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9998495578765869
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.502 Vali Acc: 0.284 Test Loss: 3.502 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0907607078552246
Epoch: 28, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.521 Vali Acc: 0.280 Test Loss: 3.521 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.1368215084075928
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.543 Vali Acc: 0.282 Test Loss: 3.543 Test Acc: 0.282
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.1799371242523193
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.558 Vali Acc: 0.282 Test Loss: 3.558 Test Acc: 0.282
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.1330926418304443
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.583 Vali Acc: 0.284 Test Loss: 3.583 Test Acc: 0.284
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.2166309356689453
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.602 Vali Acc: 0.281 Test Loss: 3.602 Test Acc: 0.281
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2858823529411765
model parameter : 140146
model size : 1.16MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.313089609146118
Epoch: 1, Steps: 10 | Train Loss: 3.401 Vali Loss: 3.365 Vali Acc: 0.114 Test Loss: 3.365 Test Acc: 0.114
Validation loss decreased (inf --> -0.114084).  Saving model ...
Epoch: 2 cost time: 0.8310611248016357
Epoch: 2, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.428 Vali Acc: 0.238 Test Loss: 3.428 Test Acc: 0.238
Validation loss decreased (-0.114084 --> -0.237613).  Saving model ...
Epoch: 3 cost time: 0.9035570621490479
Epoch: 3, Steps: 10 | Train Loss: 0.781 Vali Loss: 3.830 Vali Acc: 0.286 Test Loss: 3.830 Test Acc: 0.286
Validation loss decreased (-0.237613 --> -0.285844).  Saving model ...
Epoch: 4 cost time: 0.9196221828460693
Epoch: 4, Steps: 10 | Train Loss: 0.226 Vali Loss: 4.336 Vali Acc: 0.301 Test Loss: 4.336 Test Acc: 0.301
Validation loss decreased (-0.285844 --> -0.301133).  Saving model ...
Epoch: 5 cost time: 0.9233007431030273
Epoch: 5, Steps: 10 | Train Loss: 0.087 Vali Loss: 4.467 Vali Acc: 0.315 Test Loss: 4.467 Test Acc: 0.315
Validation loss decreased (-0.301133 --> -0.315249).  Saving model ...
Epoch: 6 cost time: 1.0114223957061768
Epoch: 6, Steps: 10 | Train Loss: 0.039 Vali Loss: 5.260 Vali Acc: 0.282 Test Loss: 5.260 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9768800735473633
Epoch: 7, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.174 Vali Acc: 0.314 Test Loss: 5.174 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9641804695129395
Epoch: 8, Steps: 10 | Train Loss: 0.067 Vali Loss: 5.235 Vali Acc: 0.322 Test Loss: 5.235 Test Acc: 0.322
Validation loss decreased (-0.315249 --> -0.322301).  Saving model ...
Epoch: 9 cost time: 0.9583983421325684
Epoch: 9, Steps: 10 | Train Loss: 0.041 Vali Loss: 5.685 Vali Acc: 0.305 Test Loss: 5.685 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8638856410980225
Epoch: 10, Steps: 10 | Train Loss: 0.019 Vali Loss: 6.212 Vali Acc: 0.299 Test Loss: 6.212 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8839530944824219
Epoch: 11, Steps: 10 | Train Loss: 0.115 Vali Loss: 6.501 Vali Acc: 0.272 Test Loss: 6.501 Test Acc: 0.272
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0380926132202148
Epoch: 12, Steps: 10 | Train Loss: 0.093 Vali Loss: 6.324 Vali Acc: 0.276 Test Loss: 6.324 Test Acc: 0.276
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0031969547271729
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 6.576 Vali Acc: 0.295 Test Loss: 6.576 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.024132490158081
Epoch: 14, Steps: 10 | Train Loss: 0.057 Vali Loss: 6.779 Vali Acc: 0.287 Test Loss: 6.779 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.9035811424255371
Epoch: 15, Steps: 10 | Train Loss: 0.017 Vali Loss: 7.203 Vali Acc: 0.286 Test Loss: 7.203 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0022430419921875
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 7.239 Vali Acc: 0.292 Test Loss: 7.239 Test Acc: 0.292
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0665135383605957
Epoch: 17, Steps: 10 | Train Loss: 0.127 Vali Loss: 7.600 Vali Acc: 0.278 Test Loss: 7.600 Test Acc: 0.278
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.0700368881225586
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 8.690 Vali Acc: 0.269 Test Loss: 8.690 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 4658742
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.444020986557007
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.338 Vali Acc: 0.105 Test Loss: 3.338 Test Acc: 0.105
Validation loss decreased (inf --> -0.104673).  Saving model ...
Epoch: 2 cost time: 0.8928003311157227
Epoch: 2, Steps: 10 | Train Loss: 2.055 Vali Loss: 3.347 Vali Acc: 0.235 Test Loss: 3.347 Test Acc: 0.235
Validation loss decreased (-0.104673 --> -0.235261).  Saving model ...
Epoch: 3 cost time: 0.8678717613220215
Epoch: 3, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.676 Vali Acc: 0.265 Test Loss: 3.676 Test Acc: 0.265
Validation loss decreased (-0.235261 --> -0.264669).  Saving model ...
Epoch: 4 cost time: 0.9592635631561279
Epoch: 4, Steps: 10 | Train Loss: 0.228 Vali Loss: 4.146 Vali Acc: 0.292 Test Loss: 4.146 Test Acc: 0.292
Validation loss decreased (-0.264669 --> -0.291723).  Saving model ...
Epoch: 5 cost time: 0.8650963306427002
Epoch: 5, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.214 Vali Acc: 0.321 Test Loss: 4.214 Test Acc: 0.321
Validation loss decreased (-0.291723 --> -0.321134).  Saving model ...
Epoch: 6 cost time: 0.9018166065216064
Epoch: 6, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.765 Vali Acc: 0.304 Test Loss: 4.765 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8702969551086426
Epoch: 7, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.768 Vali Acc: 0.319 Test Loss: 4.768 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9273557662963867
Epoch: 8, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.849 Vali Acc: 0.321 Test Loss: 4.849 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8725242614746094
Epoch: 9, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.963 Vali Acc: 0.306 Test Loss: 4.963 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8309569358825684
Epoch: 10, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.203 Vali Acc: 0.313 Test Loss: 5.203 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.809281587600708
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.140 Vali Acc: 0.320 Test Loss: 5.140 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.798790454864502
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.155 Vali Acc: 0.322 Test Loss: 5.155 Test Acc: 0.322
Validation loss decreased (-0.321134 --> -0.322301).  Saving model ...
Epoch: 13 cost time: 0.8747260570526123
Epoch: 13, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.164 Vali Acc: 0.321 Test Loss: 5.164 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9053168296813965
Epoch: 14, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.457 Vali Acc: 0.311 Test Loss: 5.457 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8194527626037598
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.628 Vali Acc: 0.309 Test Loss: 5.628 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8621468544006348
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.472 Vali Acc: 0.319 Test Loss: 5.472 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8458836078643799
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.362 Vali Acc: 0.326 Test Loss: 5.362 Test Acc: 0.326
Validation loss decreased (-0.322301 --> -0.325829).  Saving model ...
Epoch: 18 cost time: 0.8902416229248047
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.352 Vali Acc: 0.339 Test Loss: 5.352 Test Acc: 0.339
Validation loss decreased (-0.325829 --> -0.338770).  Saving model ...
Epoch: 19 cost time: 0.8861236572265625
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.360 Vali Acc: 0.340 Test Loss: 5.360 Test Acc: 0.340
Validation loss decreased (-0.338770 --> -0.339946).  Saving model ...
Epoch: 20 cost time: 0.8438332080841064
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.348 Vali Acc: 0.340 Test Loss: 5.348 Test Acc: 0.340
Validation loss decreased (-0.339946 --> -0.339947).  Saving model ...
Epoch: 21 cost time: 0.7821698188781738
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.341 Vali Acc: 0.335 Test Loss: 5.341 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.798311710357666
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.333 Vali Acc: 0.334 Test Loss: 5.333 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8636295795440674
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.329 Vali Acc: 0.331 Test Loss: 5.329 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.9021780490875244
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.329 Vali Acc: 0.333 Test Loss: 5.329 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9364733695983887
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.331 Vali Acc: 0.333 Test Loss: 5.331 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8639969825744629
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.333 Vali Acc: 0.334 Test Loss: 5.333 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9066197872161865
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.334 Vali Acc: 0.333 Test Loss: 5.334 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8959403038024902
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.336 Vali Acc: 0.334 Test Loss: 5.336 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.8867745399475098
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.337 Vali Acc: 0.334 Test Loss: 5.337 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8749408721923828
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.339 Vali Acc: 0.335 Test Loss: 5.339 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 4658742
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.468872308731079
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.311 Vali Acc: 0.095 Test Loss: 3.311 Test Acc: 0.095
Validation loss decreased (inf --> -0.095261).  Saving model ...
Epoch: 2 cost time: 0.7648749351501465
Epoch: 2, Steps: 10 | Train Loss: 2.121 Vali Loss: 3.224 Vali Acc: 0.238 Test Loss: 3.224 Test Acc: 0.238
Validation loss decreased (-0.095261 --> -0.237615).  Saving model ...
Epoch: 3 cost time: 0.784386396408081
Epoch: 3, Steps: 10 | Train Loss: 0.773 Vali Loss: 3.397 Vali Acc: 0.264 Test Loss: 3.397 Test Acc: 0.264
Validation loss decreased (-0.237615 --> -0.263495).  Saving model ...
Epoch: 4 cost time: 0.8101668357849121
Epoch: 4, Steps: 10 | Train Loss: 0.193 Vali Loss: 3.803 Vali Acc: 0.299 Test Loss: 3.803 Test Acc: 0.299
Validation loss decreased (-0.263495 --> -0.298786).  Saving model ...
Epoch: 5 cost time: 0.8036644458770752
Epoch: 5, Steps: 10 | Train Loss: 0.080 Vali Loss: 4.008 Vali Acc: 0.322 Test Loss: 4.008 Test Acc: 0.322
Validation loss decreased (-0.298786 --> -0.322313).  Saving model ...
Epoch: 6 cost time: 0.7289581298828125
Epoch: 6, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.325 Vali Acc: 0.309 Test Loss: 4.325 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8656589984893799
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.361 Vali Acc: 0.322 Test Loss: 4.361 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8370881080627441
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.616 Vali Acc: 0.309 Test Loss: 4.616 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8022429943084717
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.551 Vali Acc: 0.319 Test Loss: 4.551 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.858814001083374
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.780 Vali Acc: 0.312 Test Loss: 4.780 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7532050609588623
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.556 Vali Acc: 0.326 Test Loss: 4.556 Test Acc: 0.326
Validation loss decreased (-0.322313 --> -0.325837).  Saving model ...
Epoch: 12 cost time: 0.8146533966064453
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.556 Vali Acc: 0.321 Test Loss: 4.556 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.92879319190979
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.550 Vali Acc: 0.322 Test Loss: 4.550 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8692145347595215
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.543 Vali Acc: 0.322 Test Loss: 4.543 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9275636672973633
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.542 Vali Acc: 0.324 Test Loss: 4.542 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9536848068237305
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.556 Vali Acc: 0.322 Test Loss: 4.556 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8793103694915771
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.565 Vali Acc: 0.324 Test Loss: 4.565 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9167728424072266
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.574 Vali Acc: 0.328 Test Loss: 4.574 Test Acc: 0.328
Validation loss decreased (-0.325837 --> -0.328190).  Saving model ...
Epoch: 19 cost time: 0.9958157539367676
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.586 Vali Acc: 0.327 Test Loss: 4.586 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.9943528175354004
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.594 Vali Acc: 0.325 Test Loss: 4.594 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.9459543228149414
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.599 Vali Acc: 0.325 Test Loss: 4.599 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.9254415035247803
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.605 Vali Acc: 0.325 Test Loss: 4.605 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8643271923065186
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.610 Vali Acc: 0.326 Test Loss: 4.610 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.8738796710968018
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.616 Vali Acc: 0.325 Test Loss: 4.616 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8843960762023926
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.624 Vali Acc: 0.325 Test Loss: 4.624 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.89357590675354
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.629 Vali Acc: 0.326 Test Loss: 4.629 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.892035961151123
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.632 Vali Acc: 0.325 Test Loss: 4.632 Test Acc: 0.325
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.9319627285003662
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.640 Vali Acc: 0.324 Test Loss: 4.640 Test Acc: 0.324
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32823529411764707
model parameter : 4658742
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4430816173553467
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.279 Vali Acc: 0.089 Test Loss: 3.279 Test Acc: 0.089
Validation loss decreased (inf --> -0.089379).  Saving model ...
Epoch: 2 cost time: 0.7146391868591309
Epoch: 2, Steps: 10 | Train Loss: 2.356 Vali Loss: 3.164 Vali Acc: 0.222 Test Loss: 3.164 Test Acc: 0.222
Validation loss decreased (-0.089379 --> -0.222321).  Saving model ...
Epoch: 3 cost time: 0.7789914608001709
Epoch: 3, Steps: 10 | Train Loss: 0.997 Vali Loss: 3.062 Vali Acc: 0.271 Test Loss: 3.062 Test Acc: 0.271
Validation loss decreased (-0.222321 --> -0.270558).  Saving model ...
Epoch: 4 cost time: 0.7962832450866699
Epoch: 4, Steps: 10 | Train Loss: 0.305 Vali Loss: 3.362 Vali Acc: 0.282 Test Loss: 3.362 Test Acc: 0.282
Validation loss decreased (-0.270558 --> -0.282319).  Saving model ...
Epoch: 5 cost time: 0.7168231010437012
Epoch: 5, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.636 Vali Acc: 0.304 Test Loss: 3.636 Test Acc: 0.304
Validation loss decreased (-0.282319 --> -0.303493).  Saving model ...
Epoch: 6 cost time: 0.7381362915039062
Epoch: 6, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.826 Vali Acc: 0.311 Test Loss: 3.826 Test Acc: 0.311
Validation loss decreased (-0.303493 --> -0.310550).  Saving model ...
Epoch: 7 cost time: 0.7965638637542725
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.089 Vali Acc: 0.298 Test Loss: 4.089 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8052637577056885
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.227 Vali Acc: 0.302 Test Loss: 4.227 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7714371681213379
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.250 Vali Acc: 0.300 Test Loss: 4.250 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7809934616088867
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.237 Vali Acc: 0.304 Test Loss: 4.237 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.7739827632904053
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.221 Vali Acc: 0.306 Test Loss: 4.221 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.7577614784240723
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.213 Vali Acc: 0.306 Test Loss: 4.213 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.7419350147247314
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.214 Vali Acc: 0.306 Test Loss: 4.214 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.7591235637664795
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.222 Vali Acc: 0.304 Test Loss: 4.222 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.749239444732666
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.228 Vali Acc: 0.306 Test Loss: 4.228 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7896087169647217
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.239 Vali Acc: 0.307 Test Loss: 4.239 Test Acc: 0.307
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 4658742
model size : 27.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6577651500701904
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.393 Vali Acc: 0.134 Test Loss: 3.393 Test Acc: 0.134
Validation loss decreased (inf --> -0.134084).  Saving model ...
Epoch: 2 cost time: 1.0171947479248047
Epoch: 2, Steps: 10 | Train Loss: 2.077 Vali Loss: 3.431 Vali Acc: 0.235 Test Loss: 3.431 Test Acc: 0.235
Validation loss decreased (-0.134084 --> -0.235260).  Saving model ...
Epoch: 3 cost time: 0.9273970127105713
Epoch: 3, Steps: 10 | Train Loss: 0.750 Vali Loss: 3.700 Vali Acc: 0.275 Test Loss: 3.700 Test Acc: 0.275
Validation loss decreased (-0.235260 --> -0.275257).  Saving model ...
Epoch: 4 cost time: 0.9651153087615967
Epoch: 4, Steps: 10 | Train Loss: 0.208 Vali Loss: 4.250 Vali Acc: 0.298 Test Loss: 4.250 Test Acc: 0.298
Validation loss decreased (-0.275257 --> -0.297605).  Saving model ...
Epoch: 5 cost time: 0.960014820098877
Epoch: 5, Steps: 10 | Train Loss: 0.079 Vali Loss: 4.662 Vali Acc: 0.287 Test Loss: 4.662 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9643797874450684
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.859 Vali Acc: 0.301 Test Loss: 4.859 Test Acc: 0.301
Validation loss decreased (-0.297605 --> -0.301128).  Saving model ...
Epoch: 7 cost time: 0.9550478458404541
Epoch: 7, Steps: 10 | Train Loss: 0.086 Vali Loss: 4.927 Vali Acc: 0.307 Test Loss: 4.927 Test Acc: 0.307
Validation loss decreased (-0.301128 --> -0.307010).  Saving model ...
Epoch: 8 cost time: 0.9221482276916504
Epoch: 8, Steps: 10 | Train Loss: 0.131 Vali Loss: 5.589 Vali Acc: 0.287 Test Loss: 5.589 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8673009872436523
Epoch: 9, Steps: 10 | Train Loss: 0.022 Vali Loss: 5.593 Vali Acc: 0.300 Test Loss: 5.593 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8725185394287109
Epoch: 10, Steps: 10 | Train Loss: 0.052 Vali Loss: 5.636 Vali Acc: 0.305 Test Loss: 5.636 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8198494911193848
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 6.219 Vali Acc: 0.293 Test Loss: 6.219 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.949091911315918
Epoch: 12, Steps: 10 | Train Loss: 0.142 Vali Loss: 6.652 Vali Acc: 0.279 Test Loss: 6.652 Test Acc: 0.279
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8547353744506836
Epoch: 13, Steps: 10 | Train Loss: 0.281 Vali Loss: 7.384 Vali Acc: 0.286 Test Loss: 7.384 Test Acc: 0.286
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.913820743560791
Epoch: 14, Steps: 10 | Train Loss: 0.117 Vali Loss: 7.436 Vali Acc: 0.288 Test Loss: 7.436 Test Acc: 0.288
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.8786466121673584
Epoch: 15, Steps: 10 | Train Loss: 0.035 Vali Loss: 8.638 Vali Acc: 0.245 Test Loss: 8.638 Test Acc: 0.245
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.9504468441009521
Epoch: 16, Steps: 10 | Train Loss: 0.055 Vali Loss: 9.973 Vali Acc: 0.201 Test Loss: 9.973 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9025113582611084
Epoch: 17, Steps: 10 | Train Loss: 0.161 Vali Loss: 9.098 Vali Acc: 0.282 Test Loss: 9.098 Test Acc: 0.282
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3070588235294118
model parameter : 3610166
model size : 23.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4788122177124023
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.373 Vali Acc: 0.125 Test Loss: 3.373 Test Acc: 0.125
Validation loss decreased (inf --> -0.124672).  Saving model ...
Epoch: 2 cost time: 0.8160309791564941
Epoch: 2, Steps: 10 | Train Loss: 2.107 Vali Loss: 3.363 Vali Acc: 0.234 Test Loss: 3.363 Test Acc: 0.234
Validation loss decreased (-0.124672 --> -0.234084).  Saving model ...
Epoch: 3 cost time: 0.8826329708099365
Epoch: 3, Steps: 10 | Train Loss: 0.777 Vali Loss: 3.582 Vali Acc: 0.275 Test Loss: 3.582 Test Acc: 0.275
Validation loss decreased (-0.234084 --> -0.275258).  Saving model ...
Epoch: 4 cost time: 0.8653695583343506
Epoch: 4, Steps: 10 | Train Loss: 0.225 Vali Loss: 4.068 Vali Acc: 0.285 Test Loss: 4.068 Test Acc: 0.285
Validation loss decreased (-0.275258 --> -0.284665).  Saving model ...
Epoch: 5 cost time: 0.9101536273956299
Epoch: 5, Steps: 10 | Train Loss: 0.070 Vali Loss: 4.332 Vali Acc: 0.300 Test Loss: 4.332 Test Acc: 0.300
Validation loss decreased (-0.284665 --> -0.299957).  Saving model ...
Epoch: 6 cost time: 0.8800177574157715
Epoch: 6, Steps: 10 | Train Loss: 0.075 Vali Loss: 4.599 Vali Acc: 0.308 Test Loss: 4.599 Test Acc: 0.308
Validation loss decreased (-0.299957 --> -0.308189).  Saving model ...
Epoch: 7 cost time: 1.018326759338379
Epoch: 7, Steps: 10 | Train Loss: 0.073 Vali Loss: 4.740 Vali Acc: 0.300 Test Loss: 4.740 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9665484428405762
Epoch: 8, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.370 Vali Acc: 0.288 Test Loss: 5.370 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8528170585632324
Epoch: 9, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.214 Vali Acc: 0.311 Test Loss: 5.214 Test Acc: 0.311
Validation loss decreased (-0.308189 --> -0.310536).  Saving model ...
Epoch: 10 cost time: 0.9559884071350098
Epoch: 10, Steps: 10 | Train Loss: 0.043 Vali Loss: 5.324 Vali Acc: 0.341 Test Loss: 5.324 Test Acc: 0.341
Validation loss decreased (-0.310536 --> -0.341123).  Saving model ...
Epoch: 11 cost time: 0.8106729984283447
Epoch: 11, Steps: 10 | Train Loss: 0.038 Vali Loss: 6.411 Vali Acc: 0.292 Test Loss: 6.411 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8471899032592773
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.107 Vali Acc: 0.288 Test Loss: 6.107 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9052846431732178
Epoch: 13, Steps: 10 | Train Loss: 0.050 Vali Loss: 6.142 Vali Acc: 0.291 Test Loss: 6.142 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.9795989990234375
Epoch: 14, Steps: 10 | Train Loss: 0.014 Vali Loss: 7.051 Vali Acc: 0.280 Test Loss: 7.051 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.9024298191070557
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 6.433 Vali Acc: 0.301 Test Loss: 6.433 Test Acc: 0.301
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9028995037078857
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.716 Vali Acc: 0.305 Test Loss: 6.716 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9380362033843994
Epoch: 17, Steps: 10 | Train Loss: 0.011 Vali Loss: 8.374 Vali Acc: 0.276 Test Loss: 8.374 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9050228595733643
Epoch: 18, Steps: 10 | Train Loss: 0.183 Vali Loss: 8.473 Vali Acc: 0.242 Test Loss: 8.473 Test Acc: 0.242
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.8747437000274658
Epoch: 19, Steps: 10 | Train Loss: 0.134 Vali Loss: 8.662 Vali Acc: 0.273 Test Loss: 8.662 Test Acc: 0.273
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8439676761627197
Epoch: 20, Steps: 10 | Train Loss: 0.171 Vali Loss: 9.157 Vali Acc: 0.273 Test Loss: 9.157 Test Acc: 0.273
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 3610166
model size : 23.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2245359420776367
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.338 Vali Acc: 0.109 Test Loss: 3.338 Test Acc: 0.109
Validation loss decreased (inf --> -0.109378).  Saving model ...
Epoch: 2 cost time: 0.8275303840637207
Epoch: 2, Steps: 10 | Train Loss: 2.160 Vali Loss: 3.238 Vali Acc: 0.233 Test Loss: 3.238 Test Acc: 0.233
Validation loss decreased (-0.109378 --> -0.232909).  Saving model ...
Epoch: 3 cost time: 0.9540188312530518
Epoch: 3, Steps: 10 | Train Loss: 0.782 Vali Loss: 3.345 Vali Acc: 0.289 Test Loss: 3.345 Test Acc: 0.289
Validation loss decreased (-0.232909 --> -0.289378).  Saving model ...
Epoch: 4 cost time: 0.7861628532409668
Epoch: 4, Steps: 10 | Train Loss: 0.195 Vali Loss: 3.750 Vali Acc: 0.292 Test Loss: 3.750 Test Acc: 0.292
Validation loss decreased (-0.289378 --> -0.291727).  Saving model ...
Epoch: 5 cost time: 0.7992072105407715
Epoch: 5, Steps: 10 | Train Loss: 0.067 Vali Loss: 4.013 Vali Acc: 0.299 Test Loss: 4.013 Test Acc: 0.299
Validation loss decreased (-0.291727 --> -0.298783).  Saving model ...
Epoch: 6 cost time: 0.82499098777771
Epoch: 6, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.142 Vali Acc: 0.307 Test Loss: 4.142 Test Acc: 0.307
Validation loss decreased (-0.298783 --> -0.307017).  Saving model ...
Epoch: 7 cost time: 0.7554142475128174
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 4.459 Vali Acc: 0.306 Test Loss: 4.459 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8182811737060547
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.516 Vali Acc: 0.322 Test Loss: 4.516 Test Acc: 0.322
Validation loss decreased (-0.307017 --> -0.322308).  Saving model ...
Epoch: 9 cost time: 0.7368431091308594
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.559 Vali Acc: 0.327 Test Loss: 4.559 Test Acc: 0.327
Validation loss decreased (-0.322308 --> -0.327013).  Saving model ...
Epoch: 10 cost time: 0.7777891159057617
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.615 Vali Acc: 0.316 Test Loss: 4.615 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7784583568572998
Epoch: 11, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.647 Vali Acc: 0.315 Test Loss: 4.647 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8347055912017822
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.654 Vali Acc: 0.319 Test Loss: 4.654 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8620822429656982
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.665 Vali Acc: 0.320 Test Loss: 4.665 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8668713569641113
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.664 Vali Acc: 0.324 Test Loss: 4.664 Test Acc: 0.324
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8581027984619141
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.651 Vali Acc: 0.322 Test Loss: 4.651 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.824866771697998
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.651 Vali Acc: 0.325 Test Loss: 4.651 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8830997943878174
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.657 Vali Acc: 0.325 Test Loss: 4.657 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.8665156364440918
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.663 Vali Acc: 0.322 Test Loss: 4.663 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.8713006973266602
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.664 Vali Acc: 0.325 Test Loss: 4.664 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 3610166
model size : 23.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.545818328857422
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.284 Vali Acc: 0.109 Test Loss: 3.284 Test Acc: 0.109
Validation loss decreased (inf --> -0.109379).  Saving model ...
Epoch: 2 cost time: 0.7987878322601318
Epoch: 2, Steps: 10 | Train Loss: 2.351 Vali Loss: 3.165 Vali Acc: 0.216 Test Loss: 3.165 Test Acc: 0.216
Validation loss decreased (-0.109379 --> -0.216439).  Saving model ...
Epoch: 3 cost time: 0.8548319339752197
Epoch: 3, Steps: 10 | Train Loss: 1.040 Vali Loss: 3.107 Vali Acc: 0.269 Test Loss: 3.107 Test Acc: 0.269
Validation loss decreased (-0.216439 --> -0.269381).  Saving model ...
Epoch: 4 cost time: 0.7728021144866943
Epoch: 4, Steps: 10 | Train Loss: 0.316 Vali Loss: 3.255 Vali Acc: 0.280 Test Loss: 3.255 Test Acc: 0.280
Validation loss decreased (-0.269381 --> -0.279967).  Saving model ...
Epoch: 5 cost time: 0.8306429386138916
Epoch: 5, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.566 Vali Acc: 0.295 Test Loss: 3.566 Test Acc: 0.295
Validation loss decreased (-0.279967 --> -0.295258).  Saving model ...
Epoch: 6 cost time: 0.7677903175354004
Epoch: 6, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.848 Vali Acc: 0.302 Test Loss: 3.848 Test Acc: 0.302
Validation loss decreased (-0.295258 --> -0.302314).  Saving model ...
Epoch: 7 cost time: 0.9040508270263672
Epoch: 7, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.947 Vali Acc: 0.288 Test Loss: 3.947 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7655816078186035
Epoch: 8, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.993 Vali Acc: 0.299 Test Loss: 3.993 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7862248420715332
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.142 Vali Acc: 0.304 Test Loss: 4.142 Test Acc: 0.304
Validation loss decreased (-0.302314 --> -0.303488).  Saving model ...
Epoch: 10 cost time: 0.7768888473510742
Epoch: 10, Steps: 10 | Train Loss: 0.013 Vali Loss: 4.310 Vali Acc: 0.293 Test Loss: 4.310 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7576024532318115
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.178 Vali Acc: 0.302 Test Loss: 4.178 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7518703937530518
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.202 Vali Acc: 0.307 Test Loss: 4.202 Test Acc: 0.307
Validation loss decreased (-0.303488 --> -0.307017).  Saving model ...
Epoch: 13 cost time: 0.8479015827178955
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.194 Vali Acc: 0.307 Test Loss: 4.194 Test Acc: 0.307
Validation loss decreased (-0.307017 --> -0.307017).  Saving model ...
Epoch: 14 cost time: 0.8139786720275879
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.230 Vali Acc: 0.309 Test Loss: 4.230 Test Acc: 0.309
Validation loss decreased (-0.307017 --> -0.309369).  Saving model ...
Epoch: 15 cost time: 0.7920851707458496
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.265 Vali Acc: 0.308 Test Loss: 4.265 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8462119102478027
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.283 Vali Acc: 0.302 Test Loss: 4.283 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8287160396575928
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.298 Vali Acc: 0.304 Test Loss: 4.298 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8232715129852295
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.304 Vali Acc: 0.302 Test Loss: 4.304 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8233869075775146
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.307 Vali Acc: 0.304 Test Loss: 4.307 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7520925998687744
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.318 Vali Acc: 0.306 Test Loss: 4.318 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.6718912124633789
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.325 Vali Acc: 0.306 Test Loss: 4.325 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8242495059967041
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.328 Vali Acc: 0.306 Test Loss: 4.328 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8149752616882324
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.333 Vali Acc: 0.305 Test Loss: 4.333 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8344705104827881
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.341 Vali Acc: 0.306 Test Loss: 4.341 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 3610166
model size : 23.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6743154525756836
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.380 Vali Acc: 0.115 Test Loss: 3.380 Test Acc: 0.115
Validation loss decreased (inf --> -0.115260).  Saving model ...
Epoch: 2 cost time: 0.8790769577026367
Epoch: 2, Steps: 10 | Train Loss: 1.972 Vali Loss: 3.385 Vali Acc: 0.255 Test Loss: 3.385 Test Acc: 0.255
Validation loss decreased (-0.115260 --> -0.255260).  Saving model ...
Epoch: 3 cost time: 0.8589184284210205
Epoch: 3, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.892 Vali Acc: 0.259 Test Loss: 3.892 Test Acc: 0.259
Validation loss decreased (-0.255260 --> -0.258785).  Saving model ...
Epoch: 4 cost time: 0.8239879608154297
Epoch: 4, Steps: 10 | Train Loss: 0.215 Vali Loss: 4.373 Vali Acc: 0.289 Test Loss: 4.373 Test Acc: 0.289
Validation loss decreased (-0.258785 --> -0.289368).  Saving model ...
Epoch: 5 cost time: 0.8479330539703369
Epoch: 5, Steps: 10 | Train Loss: 0.094 Vali Loss: 4.917 Vali Acc: 0.289 Test Loss: 4.917 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8196394443511963
Epoch: 6, Steps: 10 | Train Loss: 0.124 Vali Loss: 4.973 Vali Acc: 0.313 Test Loss: 4.973 Test Acc: 0.313
Validation loss decreased (-0.289368 --> -0.312891).  Saving model ...
Epoch: 7 cost time: 0.8435361385345459
Epoch: 7, Steps: 10 | Train Loss: 0.037 Vali Loss: 5.489 Vali Acc: 0.305 Test Loss: 5.489 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7308704853057861
Epoch: 8, Steps: 10 | Train Loss: 0.034 Vali Loss: 5.300 Vali Acc: 0.327 Test Loss: 5.300 Test Acc: 0.327
Validation loss decreased (-0.312891 --> -0.327006).  Saving model ...
Epoch: 9 cost time: 0.7209460735321045
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 5.539 Vali Acc: 0.335 Test Loss: 5.539 Test Acc: 0.335
Validation loss decreased (-0.327006 --> -0.335239).  Saving model ...
Epoch: 10 cost time: 0.815997838973999
Epoch: 10, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.764 Vali Acc: 0.320 Test Loss: 5.764 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8604052066802979
Epoch: 11, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.901 Vali Acc: 0.307 Test Loss: 5.901 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9753148555755615
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 5.789 Vali Acc: 0.334 Test Loss: 5.789 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9568047523498535
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.089 Vali Acc: 0.311 Test Loss: 6.089 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.8891401290893555
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.918 Vali Acc: 0.322 Test Loss: 5.918 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9110507965087891
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.934 Vali Acc: 0.322 Test Loss: 5.934 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.870091438293457
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.896 Vali Acc: 0.331 Test Loss: 5.896 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0400121212005615
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.880 Vali Acc: 0.334 Test Loss: 5.880 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9360592365264893
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.874 Vali Acc: 0.334 Test Loss: 5.874 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0762672424316406
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.874 Vali Acc: 0.334 Test Loss: 5.874 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 3085878
model size : 21.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.486938238143921
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.346 Vali Acc: 0.109 Test Loss: 3.346 Test Acc: 0.109
Validation loss decreased (inf --> -0.109378).  Saving model ...
Epoch: 2 cost time: 0.913313627243042
Epoch: 2, Steps: 10 | Train Loss: 2.013 Vali Loss: 3.295 Vali Acc: 0.246 Test Loss: 3.295 Test Acc: 0.246
Validation loss decreased (-0.109378 --> -0.245849).  Saving model ...
Epoch: 3 cost time: 0.904707670211792
Epoch: 3, Steps: 10 | Train Loss: 0.693 Vali Loss: 3.725 Vali Acc: 0.249 Test Loss: 3.725 Test Acc: 0.249
Validation loss decreased (-0.245849 --> -0.249375).  Saving model ...
Epoch: 4 cost time: 0.8360652923583984
Epoch: 4, Steps: 10 | Train Loss: 0.200 Vali Loss: 4.158 Vali Acc: 0.295 Test Loss: 4.158 Test Acc: 0.295
Validation loss decreased (-0.249375 --> -0.295253).  Saving model ...
Epoch: 5 cost time: 0.8315525054931641
Epoch: 5, Steps: 10 | Train Loss: 0.100 Vali Loss: 4.513 Vali Acc: 0.305 Test Loss: 4.513 Test Acc: 0.305
Validation loss decreased (-0.295253 --> -0.304661).  Saving model ...
Epoch: 6 cost time: 0.8555517196655273
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 4.639 Vali Acc: 0.312 Test Loss: 4.639 Test Acc: 0.312
Validation loss decreased (-0.304661 --> -0.311718).  Saving model ...
Epoch: 7 cost time: 0.8552331924438477
Epoch: 7, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.091 Vali Acc: 0.299 Test Loss: 5.091 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9256374835968018
Epoch: 8, Steps: 10 | Train Loss: 0.188 Vali Loss: 5.206 Vali Acc: 0.304 Test Loss: 5.206 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.921879768371582
Epoch: 9, Steps: 10 | Train Loss: 0.021 Vali Loss: 5.149 Vali Acc: 0.322 Test Loss: 5.149 Test Acc: 0.322
Validation loss decreased (-0.311718 --> -0.322301).  Saving model ...
Epoch: 10 cost time: 0.9848072528839111
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.476 Vali Acc: 0.316 Test Loss: 5.476 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.944922924041748
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.627 Vali Acc: 0.312 Test Loss: 5.627 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9818587303161621
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 5.472 Vali Acc: 0.315 Test Loss: 5.472 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0229499340057373
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.488 Vali Acc: 0.334 Test Loss: 5.488 Test Acc: 0.334
Validation loss decreased (-0.322301 --> -0.334063).  Saving model ...
Epoch: 14 cost time: 0.9625773429870605
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.683 Vali Acc: 0.322 Test Loss: 5.683 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9517183303833008
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.670 Vali Acc: 0.324 Test Loss: 5.670 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9143590927124023
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.803 Vali Acc: 0.318 Test Loss: 5.803 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.9104318618774414
Epoch: 17, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.132 Vali Acc: 0.314 Test Loss: 6.132 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8803138732910156
Epoch: 18, Steps: 10 | Train Loss: 0.008 Vali Loss: 6.017 Vali Acc: 0.313 Test Loss: 6.017 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8852636814117432
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.321 Vali Acc: 0.299 Test Loss: 6.321 Test Acc: 0.299
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.9592788219451904
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.201 Vali Acc: 0.315 Test Loss: 6.201 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.975435733795166
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.227 Vali Acc: 0.312 Test Loss: 6.227 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9943854808807373
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.270 Vali Acc: 0.309 Test Loss: 6.270 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8991434574127197
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 6.267 Vali Acc: 0.313 Test Loss: 6.267 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 3085878
model size : 21.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.261955738067627
Epoch: 1, Steps: 10 | Train Loss: 3.278 Vali Loss: 3.299 Vali Acc: 0.118 Test Loss: 3.299 Test Acc: 0.118
Validation loss decreased (inf --> -0.117614).  Saving model ...
Epoch: 2 cost time: 0.784461259841919
Epoch: 2, Steps: 10 | Train Loss: 2.060 Vali Loss: 3.167 Vali Acc: 0.251 Test Loss: 3.167 Test Acc: 0.251
Validation loss decreased (-0.117614 --> -0.250557).  Saving model ...
Epoch: 3 cost time: 0.8795909881591797
Epoch: 3, Steps: 10 | Train Loss: 0.738 Vali Loss: 3.419 Vali Acc: 0.264 Test Loss: 3.419 Test Acc: 0.264
Validation loss decreased (-0.250557 --> -0.263495).  Saving model ...
Epoch: 4 cost time: 0.781580924987793
Epoch: 4, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.845 Vali Acc: 0.307 Test Loss: 3.845 Test Acc: 0.307
Validation loss decreased (-0.263495 --> -0.307020).  Saving model ...
Epoch: 5 cost time: 0.8952004909515381
Epoch: 5, Steps: 10 | Train Loss: 0.099 Vali Loss: 4.134 Vali Acc: 0.298 Test Loss: 4.134 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8783998489379883
Epoch: 6, Steps: 10 | Train Loss: 0.037 Vali Loss: 4.379 Vali Acc: 0.305 Test Loss: 4.379 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9002232551574707
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.751 Vali Acc: 0.302 Test Loss: 4.751 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9410116672515869
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.752 Vali Acc: 0.319 Test Loss: 4.752 Test Acc: 0.319
Validation loss decreased (-0.307020 --> -0.318776).  Saving model ...
Epoch: 9 cost time: 0.9823107719421387
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.814 Vali Acc: 0.331 Test Loss: 4.814 Test Acc: 0.331
Validation loss decreased (-0.318776 --> -0.330540).  Saving model ...
Epoch: 10 cost time: 0.8843941688537598
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.978 Vali Acc: 0.327 Test Loss: 4.978 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9616260528564453
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.147 Vali Acc: 0.314 Test Loss: 5.147 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9610965251922607
Epoch: 12, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.116 Vali Acc: 0.321 Test Loss: 5.116 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9037282466888428
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.072 Vali Acc: 0.326 Test Loss: 5.072 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9140241146087646
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.043 Vali Acc: 0.326 Test Loss: 5.043 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.9968187808990479
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.027 Vali Acc: 0.325 Test Loss: 5.027 Test Acc: 0.325
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.9225928783416748
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.010 Vali Acc: 0.324 Test Loss: 5.010 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.9481320381164551
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.003 Vali Acc: 0.324 Test Loss: 5.003 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.9459400177001953
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.995 Vali Acc: 0.327 Test Loss: 4.995 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.9627623558044434
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.992 Vali Acc: 0.325 Test Loss: 4.992 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 3085878
model size : 21.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.091336965560913
Epoch: 1, Steps: 10 | Train Loss: 3.221 Vali Loss: 3.255 Vali Acc: 0.113 Test Loss: 3.255 Test Acc: 0.113
Validation loss decreased (inf --> -0.112909).  Saving model ...
Epoch: 2 cost time: 0.7223305702209473
Epoch: 2, Steps: 10 | Train Loss: 2.249 Vali Loss: 3.114 Vali Acc: 0.216 Test Loss: 3.114 Test Acc: 0.216
Validation loss decreased (-0.112909 --> -0.216439).  Saving model ...
Epoch: 3 cost time: 0.7386610507965088
Epoch: 3, Steps: 10 | Train Loss: 1.000 Vali Loss: 3.064 Vali Acc: 0.267 Test Loss: 3.064 Test Acc: 0.267
Validation loss decreased (-0.216439 --> -0.267028).  Saving model ...
Epoch: 4 cost time: 0.7765846252441406
Epoch: 4, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.327 Vali Acc: 0.292 Test Loss: 3.327 Test Acc: 0.292
Validation loss decreased (-0.267028 --> -0.291731).  Saving model ...
Epoch: 5 cost time: 0.7814466953277588
Epoch: 5, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.656 Vali Acc: 0.284 Test Loss: 3.656 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7826199531555176
Epoch: 6, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.883 Vali Acc: 0.308 Test Loss: 3.883 Test Acc: 0.308
Validation loss decreased (-0.291731 --> -0.308196).  Saving model ...
Epoch: 7 cost time: 0.8075387477874756
Epoch: 7, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.914 Vali Acc: 0.327 Test Loss: 3.914 Test Acc: 0.327
Validation loss decreased (-0.308196 --> -0.327020).  Saving model ...
Epoch: 8 cost time: 0.7904577255249023
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.055 Vali Acc: 0.305 Test Loss: 4.055 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8222439289093018
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.173 Vali Acc: 0.291 Test Loss: 4.173 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7800338268280029
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.201 Vali Acc: 0.296 Test Loss: 4.201 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.8060986995697021
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.184 Vali Acc: 0.305 Test Loss: 4.184 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.7468993663787842
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.154 Vali Acc: 0.307 Test Loss: 4.154 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.8345084190368652
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.149 Vali Acc: 0.312 Test Loss: 4.149 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.7948181629180908
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.143 Vali Acc: 0.308 Test Loss: 4.143 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.784414529800415
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.146 Vali Acc: 0.312 Test Loss: 4.146 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.7503364086151123
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.147 Vali Acc: 0.312 Test Loss: 4.147 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.862398624420166
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.154 Vali Acc: 0.314 Test Loss: 4.154 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3270588235294118
model parameter : 3085878
model size : 21.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.420253276824951
Epoch: 1, Steps: 10 | Train Loss: 3.358 Vali Loss: 3.336 Vali Acc: 0.114 Test Loss: 3.336 Test Acc: 0.114
Validation loss decreased (inf --> -0.114084).  Saving model ...
Epoch: 2 cost time: 0.8556272983551025
Epoch: 2, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.387 Vali Acc: 0.248 Test Loss: 3.387 Test Acc: 0.248
Validation loss decreased (-0.114084 --> -0.248201).  Saving model ...
Epoch: 3 cost time: 0.870551586151123
Epoch: 3, Steps: 10 | Train Loss: 0.726 Vali Loss: 3.755 Vali Acc: 0.289 Test Loss: 3.755 Test Acc: 0.289
Validation loss decreased (-0.248201 --> -0.289374).  Saving model ...
Epoch: 4 cost time: 0.8446600437164307
Epoch: 4, Steps: 10 | Train Loss: 0.282 Vali Loss: 4.109 Vali Acc: 0.304 Test Loss: 4.109 Test Acc: 0.304
Validation loss decreased (-0.289374 --> -0.303488).  Saving model ...
Epoch: 5 cost time: 0.7310726642608643
Epoch: 5, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.877 Vali Acc: 0.304 Test Loss: 4.877 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8520705699920654
Epoch: 6, Steps: 10 | Train Loss: 0.040 Vali Loss: 5.073 Vali Acc: 0.293 Test Loss: 5.073 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7774343490600586
Epoch: 7, Steps: 10 | Train Loss: 0.062 Vali Loss: 5.420 Vali Acc: 0.291 Test Loss: 5.420 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.8305842876434326
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 5.647 Vali Acc: 0.286 Test Loss: 5.647 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8341045379638672
Epoch: 9, Steps: 10 | Train Loss: 0.017 Vali Loss: 6.161 Vali Acc: 0.296 Test Loss: 6.161 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.8515241146087646
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.134 Vali Acc: 0.311 Test Loss: 6.134 Test Acc: 0.311
Validation loss decreased (-0.303488 --> -0.310527).  Saving model ...
Epoch: 11 cost time: 0.80692458152771
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 6.076 Vali Acc: 0.306 Test Loss: 6.076 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8741562366485596
Epoch: 12, Steps: 10 | Train Loss: 0.023 Vali Loss: 6.362 Vali Acc: 0.311 Test Loss: 6.362 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8594138622283936
Epoch: 13, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.500 Vali Acc: 0.292 Test Loss: 6.500 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8381557464599609
Epoch: 14, Steps: 10 | Train Loss: 0.018 Vali Loss: 7.093 Vali Acc: 0.264 Test Loss: 7.093 Test Acc: 0.264
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8463928699493408
Epoch: 15, Steps: 10 | Train Loss: 0.070 Vali Loss: 7.142 Vali Acc: 0.289 Test Loss: 7.142 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.9149010181427002
Epoch: 16, Steps: 10 | Train Loss: 0.015 Vali Loss: 7.476 Vali Acc: 0.287 Test Loss: 7.476 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.9307928085327148
Epoch: 17, Steps: 10 | Train Loss: 0.123 Vali Loss: 7.803 Vali Acc: 0.293 Test Loss: 7.803 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.9005591869354248
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 8.919 Vali Acc: 0.258 Test Loss: 8.919 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.93438720703125
Epoch: 19, Steps: 10 | Train Loss: 0.076 Vali Loss: 9.102 Vali Acc: 0.289 Test Loss: 9.102 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0352098941802979
Epoch: 20, Steps: 10 | Train Loss: 0.349 Vali Loss: 11.349 Vali Acc: 0.196 Test Loss: 11.349 Test Acc: 0.196
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 2823734
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5751073360443115
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.316 Vali Acc: 0.113 Test Loss: 3.316 Test Acc: 0.113
Validation loss decreased (inf --> -0.112908).  Saving model ...
Epoch: 2 cost time: 0.9753222465515137
Epoch: 2, Steps: 10 | Train Loss: 2.153 Vali Loss: 3.299 Vali Acc: 0.245 Test Loss: 3.299 Test Acc: 0.245
Validation loss decreased (-0.112908 --> -0.244673).  Saving model ...
Epoch: 3 cost time: 0.7868175506591797
Epoch: 3, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.612 Vali Acc: 0.285 Test Loss: 3.612 Test Acc: 0.285
Validation loss decreased (-0.244673 --> -0.284670).  Saving model ...
Epoch: 4 cost time: 0.8538753986358643
Epoch: 4, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.952 Vali Acc: 0.319 Test Loss: 3.952 Test Acc: 0.319
Validation loss decreased (-0.284670 --> -0.318784).  Saving model ...
Epoch: 5 cost time: 0.754962682723999
Epoch: 5, Steps: 10 | Train Loss: 0.097 Vali Loss: 4.531 Vali Acc: 0.318 Test Loss: 4.531 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.7954893112182617
Epoch: 6, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.728 Vali Acc: 0.298 Test Loss: 4.728 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.7726099491119385
Epoch: 7, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.835 Vali Acc: 0.314 Test Loss: 4.835 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.7880086898803711
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.174 Vali Acc: 0.326 Test Loss: 5.174 Test Acc: 0.326
Validation loss decreased (-0.318784 --> -0.325831).  Saving model ...
Epoch: 9 cost time: 0.792365312576294
Epoch: 9, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.287 Vali Acc: 0.318 Test Loss: 5.287 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7308664321899414
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.267 Vali Acc: 0.320 Test Loss: 5.267 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7954151630401611
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.228 Vali Acc: 0.324 Test Loss: 5.228 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7897071838378906
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.253 Vali Acc: 0.321 Test Loss: 5.253 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7818377017974854
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.210 Vali Acc: 0.334 Test Loss: 5.210 Test Acc: 0.334
Validation loss decreased (-0.325831 --> -0.334066).  Saving model ...
Epoch: 14 cost time: 0.6807374954223633
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.211 Vali Acc: 0.334 Test Loss: 5.211 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7242069244384766
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.204 Vali Acc: 0.335 Test Loss: 5.204 Test Acc: 0.335
Validation loss decreased (-0.334066 --> -0.335242).  Saving model ...
Epoch: 16 cost time: 0.6724863052368164
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.192 Vali Acc: 0.338 Test Loss: 5.192 Test Acc: 0.338
Validation loss decreased (-0.335242 --> -0.337595).  Saving model ...
Epoch: 17 cost time: 0.7518916130065918
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.186 Vali Acc: 0.338 Test Loss: 5.186 Test Acc: 0.338
Validation loss decreased (-0.337595 --> -0.337595).  Saving model ...
Epoch: 18 cost time: 0.7015612125396729
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.185 Vali Acc: 0.338 Test Loss: 5.185 Test Acc: 0.338
Validation loss decreased (-0.337595 --> -0.337595).  Saving model ...
Epoch: 19 cost time: 0.6736752986907959
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.183 Vali Acc: 0.336 Test Loss: 5.183 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6663551330566406
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.174 Vali Acc: 0.336 Test Loss: 5.174 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7540614604949951
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.172 Vali Acc: 0.335 Test Loss: 5.172 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7861058712005615
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.169 Vali Acc: 0.335 Test Loss: 5.169 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7776341438293457
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.168 Vali Acc: 0.335 Test Loss: 5.168 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7876152992248535
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.170 Vali Acc: 0.334 Test Loss: 5.170 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8178229331970215
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.171 Vali Acc: 0.335 Test Loss: 5.171 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.815709114074707
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.180 Vali Acc: 0.336 Test Loss: 5.180 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7714180946350098
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.183 Vali Acc: 0.336 Test Loss: 5.183 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8223304748535156
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.182 Vali Acc: 0.336 Test Loss: 5.182 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 2823734
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3785054683685303
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.278 Vali Acc: 0.115 Test Loss: 3.278 Test Acc: 0.115
Validation loss decreased (inf --> -0.115261).  Saving model ...
Epoch: 2 cost time: 0.8009991645812988
Epoch: 2, Steps: 10 | Train Loss: 2.193 Vali Loss: 3.164 Vali Acc: 0.244 Test Loss: 3.164 Test Acc: 0.244
Validation loss decreased (-0.115261 --> -0.243498).  Saving model ...
Epoch: 3 cost time: 0.7897052764892578
Epoch: 3, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.378 Vali Acc: 0.294 Test Loss: 3.378 Test Acc: 0.294
Validation loss decreased (-0.243498 --> -0.294084).  Saving model ...
Epoch: 4 cost time: 0.7452332973480225
Epoch: 4, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.651 Vali Acc: 0.305 Test Loss: 3.651 Test Acc: 0.305
Validation loss decreased (-0.294084 --> -0.304669).  Saving model ...
Epoch: 5 cost time: 0.8530764579772949
Epoch: 5, Steps: 10 | Train Loss: 0.078 Vali Loss: 4.023 Vali Acc: 0.335 Test Loss: 4.023 Test Acc: 0.335
Validation loss decreased (-0.304669 --> -0.335254).  Saving model ...
Epoch: 6 cost time: 0.8750979900360107
Epoch: 6, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.307 Vali Acc: 0.311 Test Loss: 4.307 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.8876228332519531
Epoch: 7, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.631 Vali Acc: 0.293 Test Loss: 4.631 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7659122943878174
Epoch: 8, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.986 Vali Acc: 0.293 Test Loss: 4.986 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8417761325836182
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.957 Vali Acc: 0.305 Test Loss: 4.957 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7608146667480469
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.916 Vali Acc: 0.309 Test Loss: 4.916 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7388174533843994
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.793 Vali Acc: 0.315 Test Loss: 4.793 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8154842853546143
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 5.012 Vali Acc: 0.304 Test Loss: 5.012 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.7537715435028076
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.110 Vali Acc: 0.291 Test Loss: 5.110 Test Acc: 0.291
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.7782680988311768
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.133 Vali Acc: 0.301 Test Loss: 5.133 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8064761161804199
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.207 Vali Acc: 0.316 Test Loss: 5.207 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 2823734
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4465394020080566
Epoch: 1, Steps: 10 | Train Loss: 3.319 Vali Loss: 3.261 Vali Acc: 0.107 Test Loss: 3.261 Test Acc: 0.107
Validation loss decreased (inf --> -0.107026).  Saving model ...
Epoch: 2 cost time: 0.7639906406402588
Epoch: 2, Steps: 10 | Train Loss: 2.348 Vali Loss: 3.098 Vali Acc: 0.205 Test Loss: 3.098 Test Acc: 0.205
Validation loss decreased (-0.107026 --> -0.204675).  Saving model ...
Epoch: 3 cost time: 0.7178246974945068
Epoch: 3, Steps: 10 | Train Loss: 1.043 Vali Loss: 3.099 Vali Acc: 0.258 Test Loss: 3.099 Test Acc: 0.258
Validation loss decreased (-0.204675 --> -0.257616).  Saving model ...
Epoch: 4 cost time: 0.7397010326385498
Epoch: 4, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.275 Vali Acc: 0.286 Test Loss: 3.275 Test Acc: 0.286
Validation loss decreased (-0.257616 --> -0.285850).  Saving model ...
Epoch: 5 cost time: 0.7420551776885986
Epoch: 5, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.591 Vali Acc: 0.302 Test Loss: 3.591 Test Acc: 0.302
Validation loss decreased (-0.285850 --> -0.302317).  Saving model ...
Epoch: 6 cost time: 0.7273044586181641
Epoch: 6, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.877 Vali Acc: 0.282 Test Loss: 3.877 Test Acc: 0.282
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7592804431915283
Epoch: 7, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.115 Vali Acc: 0.271 Test Loss: 4.115 Test Acc: 0.271
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7835173606872559
Epoch: 8, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.297 Vali Acc: 0.301 Test Loss: 4.297 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7605321407318115
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.435 Vali Acc: 0.296 Test Loss: 4.435 Test Acc: 0.296
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7647161483764648
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.673 Vali Acc: 0.287 Test Loss: 4.673 Test Acc: 0.287
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.8245782852172852
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.698 Vali Acc: 0.298 Test Loss: 4.698 Test Acc: 0.298
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.7766506671905518
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.679 Vali Acc: 0.306 Test Loss: 4.679 Test Acc: 0.306
Validation loss decreased (-0.302317 --> -0.305836).  Saving model ...
Epoch: 13 cost time: 0.8520805835723877
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.641 Vali Acc: 0.307 Test Loss: 4.641 Test Acc: 0.307
Validation loss decreased (-0.305836 --> -0.307012).  Saving model ...
Epoch: 14 cost time: 0.8320834636688232
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.629 Vali Acc: 0.311 Test Loss: 4.629 Test Acc: 0.311
Validation loss decreased (-0.307012 --> -0.310542).  Saving model ...
Epoch: 15 cost time: 0.8132731914520264
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.625 Vali Acc: 0.309 Test Loss: 4.625 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.777961015701294
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.622 Vali Acc: 0.309 Test Loss: 4.622 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7831988334655762
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.622 Vali Acc: 0.312 Test Loss: 4.622 Test Acc: 0.312
Validation loss decreased (-0.310542 --> -0.311718).  Saving model ...
Epoch: 18 cost time: 0.7815322875976562
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.625 Vali Acc: 0.314 Test Loss: 4.625 Test Acc: 0.314
Validation loss decreased (-0.311718 --> -0.314071).  Saving model ...
Epoch: 19 cost time: 0.758852481842041
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.632 Vali Acc: 0.314 Test Loss: 4.632 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7547783851623535
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.635 Vali Acc: 0.315 Test Loss: 4.635 Test Acc: 0.315
Validation loss decreased (-0.314071 --> -0.315248).  Saving model ...
Epoch: 21 cost time: 0.7313759326934814
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.642 Vali Acc: 0.313 Test Loss: 4.642 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7106285095214844
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.646 Vali Acc: 0.313 Test Loss: 4.646 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7245681285858154
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.648 Vali Acc: 0.313 Test Loss: 4.648 Test Acc: 0.313
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7299745082855225
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.654 Vali Acc: 0.315 Test Loss: 4.654 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7213726043701172
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.660 Vali Acc: 0.315 Test Loss: 4.660 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7301445007324219
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.670 Vali Acc: 0.315 Test Loss: 4.670 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7866318225860596
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.674 Vali Acc: 0.316 Test Loss: 4.674 Test Acc: 0.316
Validation loss decreased (-0.315248 --> -0.316424).  Saving model ...
Epoch: 28 cost time: 0.8067567348480225
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.676 Vali Acc: 0.315 Test Loss: 4.676 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7257721424102783
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.679 Vali Acc: 0.318 Test Loss: 4.679 Test Acc: 0.318
Validation loss decreased (-0.316424 --> -0.317600).  Saving model ...
Epoch: 30 cost time: 0.7040450572967529
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.686 Vali Acc: 0.319 Test Loss: 4.686 Test Acc: 0.319
Validation loss decreased (-0.317600 --> -0.318777).  Saving model ...
Epoch: 31 cost time: 0.6966211795806885
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.691 Vali Acc: 0.316 Test Loss: 4.691 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7218403816223145
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.698 Vali Acc: 0.316 Test Loss: 4.698 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7118513584136963
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.705 Vali Acc: 0.315 Test Loss: 4.705 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7609024047851562
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.711 Vali Acc: 0.315 Test Loss: 4.711 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8153014183044434
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.713 Vali Acc: 0.318 Test Loss: 4.713 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7343361377716064
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.722 Vali Acc: 0.318 Test Loss: 4.722 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7576208114624023
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.728 Vali Acc: 0.315 Test Loss: 4.728 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7918272018432617
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.734 Vali Acc: 0.316 Test Loss: 4.734 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7591061592102051
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.739 Vali Acc: 0.318 Test Loss: 4.739 Test Acc: 0.318
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7533366680145264
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.746 Vali Acc: 0.318 Test Loss: 4.746 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 2823734
model size : 20.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.464552164077759
Epoch: 1, Steps: 10 | Train Loss: 3.392 Vali Loss: 3.366 Vali Acc: 0.125 Test Loss: 3.366 Test Acc: 0.125
Validation loss decreased (inf --> -0.124672).  Saving model ...
Epoch: 2 cost time: 0.8099300861358643
Epoch: 2, Steps: 10 | Train Loss: 2.163 Vali Loss: 3.368 Vali Acc: 0.234 Test Loss: 3.368 Test Acc: 0.234
Validation loss decreased (-0.124672 --> -0.234084).  Saving model ...
Epoch: 3 cost time: 0.7855343818664551
Epoch: 3, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.786 Vali Acc: 0.282 Test Loss: 3.786 Test Acc: 0.282
Validation loss decreased (-0.234084 --> -0.282315).  Saving model ...
Epoch: 4 cost time: 0.8696739673614502
Epoch: 4, Steps: 10 | Train Loss: 0.216 Vali Loss: 4.377 Vali Acc: 0.300 Test Loss: 4.377 Test Acc: 0.300
Validation loss decreased (-0.282315 --> -0.299956).  Saving model ...
Epoch: 5 cost time: 0.890296220779419
Epoch: 5, Steps: 10 | Train Loss: 0.076 Vali Loss: 4.928 Vali Acc: 0.286 Test Loss: 4.928 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8635447025299072
Epoch: 6, Steps: 10 | Train Loss: 0.068 Vali Loss: 5.295 Vali Acc: 0.305 Test Loss: 5.295 Test Acc: 0.305
Validation loss decreased (-0.299956 --> -0.304653).  Saving model ...
Epoch: 7 cost time: 0.8177235126495361
Epoch: 7, Steps: 10 | Train Loss: 0.130 Vali Loss: 5.469 Vali Acc: 0.295 Test Loss: 5.469 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8481688499450684
Epoch: 8, Steps: 10 | Train Loss: 0.115 Vali Loss: 6.087 Vali Acc: 0.275 Test Loss: 6.087 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8774204254150391
Epoch: 9, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.826 Vali Acc: 0.309 Test Loss: 5.826 Test Acc: 0.309
Validation loss decreased (-0.304653 --> -0.309354).  Saving model ...
Epoch: 10 cost time: 0.8117334842681885
Epoch: 10, Steps: 10 | Train Loss: 0.012 Vali Loss: 6.239 Vali Acc: 0.298 Test Loss: 6.239 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7863121032714844
Epoch: 11, Steps: 10 | Train Loss: 0.048 Vali Loss: 6.146 Vali Acc: 0.288 Test Loss: 6.146 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7454164028167725
Epoch: 12, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.385 Vali Acc: 0.302 Test Loss: 6.385 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7280802726745605
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 6.411 Vali Acc: 0.325 Test Loss: 6.411 Test Acc: 0.325
Validation loss decreased (-0.309354 --> -0.324642).  Saving model ...
Epoch: 14 cost time: 0.6961355209350586
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 6.805 Vali Acc: 0.304 Test Loss: 6.805 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7300357818603516
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 6.757 Vali Acc: 0.308 Test Loss: 6.757 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8281815052032471
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 7.130 Vali Acc: 0.289 Test Loss: 7.130 Test Acc: 0.289
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8160476684570312
Epoch: 17, Steps: 10 | Train Loss: 0.044 Vali Loss: 6.887 Vali Acc: 0.293 Test Loss: 6.887 Test Acc: 0.293
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.837315559387207
Epoch: 18, Steps: 10 | Train Loss: 0.093 Vali Loss: 7.768 Vali Acc: 0.266 Test Loss: 7.768 Test Acc: 0.266
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8049557209014893
Epoch: 19, Steps: 10 | Train Loss: 0.134 Vali Loss: 7.643 Vali Acc: 0.312 Test Loss: 7.643 Test Acc: 0.312
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8077914714813232
Epoch: 20, Steps: 10 | Train Loss: 0.044 Vali Loss: 7.990 Vali Acc: 0.293 Test Loss: 7.990 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8072984218597412
Epoch: 21, Steps: 10 | Train Loss: 0.046 Vali Loss: 9.372 Vali Acc: 0.253 Test Loss: 9.372 Test Acc: 0.253
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7718701362609863
Epoch: 22, Steps: 10 | Train Loss: 0.069 Vali Loss: 10.755 Vali Acc: 0.212 Test Loss: 10.755 Test Acc: 0.212
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7542190551757812
Epoch: 23, Steps: 10 | Train Loss: 0.544 Vali Loss: 12.448 Vali Acc: 0.219 Test Loss: 12.448 Test Acc: 0.219
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 2692662
model size : 20.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2893872261047363
Epoch: 1, Steps: 10 | Train Loss: 3.368 Vali Loss: 3.336 Vali Acc: 0.115 Test Loss: 3.336 Test Acc: 0.115
Validation loss decreased (inf --> -0.115261).  Saving model ...
Epoch: 2 cost time: 0.7935950756072998
Epoch: 2, Steps: 10 | Train Loss: 2.198 Vali Loss: 3.282 Vali Acc: 0.232 Test Loss: 3.282 Test Acc: 0.232
Validation loss decreased (-0.115261 --> -0.231732).  Saving model ...
Epoch: 3 cost time: 0.82486891746521
Epoch: 3, Steps: 10 | Train Loss: 0.702 Vali Loss: 3.627 Vali Acc: 0.278 Test Loss: 3.627 Test Acc: 0.278
Validation loss decreased (-0.231732 --> -0.277611).  Saving model ...
Epoch: 4 cost time: 0.8409714698791504
Epoch: 4, Steps: 10 | Train Loss: 0.213 Vali Loss: 4.103 Vali Acc: 0.302 Test Loss: 4.103 Test Acc: 0.302
Validation loss decreased (-0.277611 --> -0.302312).  Saving model ...
Epoch: 5 cost time: 0.9157578945159912
Epoch: 5, Steps: 10 | Train Loss: 0.068 Vali Loss: 4.574 Vali Acc: 0.307 Test Loss: 4.574 Test Acc: 0.307
Validation loss decreased (-0.302312 --> -0.307013).  Saving model ...
Epoch: 6 cost time: 0.8161880970001221
Epoch: 6, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.694 Vali Acc: 0.316 Test Loss: 4.694 Test Acc: 0.316
Validation loss decreased (-0.307013 --> -0.316424).  Saving model ...
Epoch: 7 cost time: 0.8325302600860596
Epoch: 7, Steps: 10 | Train Loss: 0.034 Vali Loss: 4.921 Vali Acc: 0.312 Test Loss: 4.921 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8115642070770264
Epoch: 8, Steps: 10 | Train Loss: 0.045 Vali Loss: 5.511 Vali Acc: 0.306 Test Loss: 5.511 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7902672290802002
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.169 Vali Acc: 0.320 Test Loss: 5.169 Test Acc: 0.320
Validation loss decreased (-0.316424 --> -0.319948).  Saving model ...
Epoch: 10 cost time: 0.8375864028930664
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.132 Vali Acc: 0.319 Test Loss: 5.132 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8063607215881348
Epoch: 11, Steps: 10 | Train Loss: 0.011 Vali Loss: 5.469 Vali Acc: 0.318 Test Loss: 5.469 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8561396598815918
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 5.583 Vali Acc: 0.327 Test Loss: 5.583 Test Acc: 0.327
Validation loss decreased (-0.319948 --> -0.327003).  Saving model ...
Epoch: 13 cost time: 0.8250303268432617
Epoch: 13, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.903 Vali Acc: 0.318 Test Loss: 5.903 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.779639720916748
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 5.858 Vali Acc: 0.328 Test Loss: 5.858 Test Acc: 0.328
Validation loss decreased (-0.327003 --> -0.328177).  Saving model ...
Epoch: 15 cost time: 0.7835965156555176
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.785 Vali Acc: 0.325 Test Loss: 5.785 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7822110652923584
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.781 Vali Acc: 0.326 Test Loss: 5.781 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.778264045715332
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.760 Vali Acc: 0.326 Test Loss: 5.760 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8184537887573242
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.742 Vali Acc: 0.325 Test Loss: 5.742 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8159372806549072
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.727 Vali Acc: 0.326 Test Loss: 5.727 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8103358745574951
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.718 Vali Acc: 0.327 Test Loss: 5.718 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7986838817596436
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.711 Vali Acc: 0.328 Test Loss: 5.711 Test Acc: 0.328
Validation loss decreased (-0.328177 --> -0.328178).  Saving model ...
Epoch: 22 cost time: 0.8398232460021973
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.705 Vali Acc: 0.328 Test Loss: 5.705 Test Acc: 0.328
Validation loss decreased (-0.328178 --> -0.328178).  Saving model ...
Epoch: 23 cost time: 0.7974882125854492
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.704 Vali Acc: 0.329 Test Loss: 5.704 Test Acc: 0.329
Validation loss decreased (-0.328178 --> -0.329355).  Saving model ...
Epoch: 24 cost time: 0.83077073097229
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.701 Vali Acc: 0.328 Test Loss: 5.701 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8322365283966064
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.701 Vali Acc: 0.328 Test Loss: 5.701 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8061764240264893
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.696 Vali Acc: 0.329 Test Loss: 5.696 Test Acc: 0.329
Validation loss decreased (-0.329355 --> -0.329355).  Saving model ...
Epoch: 27 cost time: 0.9030642509460449
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.690 Vali Acc: 0.331 Test Loss: 5.690 Test Acc: 0.331
Validation loss decreased (-0.329355 --> -0.330531).  Saving model ...
Epoch: 28 cost time: 0.8630235195159912
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.691 Vali Acc: 0.333 Test Loss: 5.691 Test Acc: 0.333
Validation loss decreased (-0.330531 --> -0.332884).  Saving model ...
Epoch: 29 cost time: 0.8725161552429199
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.691 Vali Acc: 0.332 Test Loss: 5.691 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8401658535003662
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.689 Vali Acc: 0.332 Test Loss: 5.689 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.852259635925293
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.691 Vali Acc: 0.333 Test Loss: 5.691 Test Acc: 0.333
Validation loss decreased (-0.332884 --> -0.332884).  Saving model ...
Epoch: 32 cost time: 0.8416445255279541
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.689 Vali Acc: 0.332 Test Loss: 5.689 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8540618419647217
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.689 Vali Acc: 0.332 Test Loss: 5.689 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8513672351837158
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.693 Vali Acc: 0.334 Test Loss: 5.693 Test Acc: 0.334
Validation loss decreased (-0.332884 --> -0.334061).  Saving model ...
Epoch: 35 cost time: 0.8655681610107422
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.696 Vali Acc: 0.334 Test Loss: 5.696 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8392791748046875
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.697 Vali Acc: 0.334 Test Loss: 5.697 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8695268630981445
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.698 Vali Acc: 0.334 Test Loss: 5.698 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8507170677185059
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.699 Vali Acc: 0.334 Test Loss: 5.699 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.9064817428588867
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.701 Vali Acc: 0.334 Test Loss: 5.701 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8535506725311279
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.698 Vali Acc: 0.334 Test Loss: 5.698 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8365998268127441
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.699 Vali Acc: 0.334 Test Loss: 5.699 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8403902053833008
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.701 Vali Acc: 0.332 Test Loss: 5.701 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7891294956207275
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.704 Vali Acc: 0.333 Test Loss: 5.704 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.7427380084991455
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 5.704 Vali Acc: 0.334 Test Loss: 5.704 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 2692662
model size : 20.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4660544395446777
Epoch: 1, Steps: 10 | Train Loss: 3.373 Vali Loss: 3.307 Vali Acc: 0.109 Test Loss: 3.307 Test Acc: 0.109
Validation loss decreased (inf --> -0.109379).  Saving model ...
Epoch: 2 cost time: 0.8721318244934082
Epoch: 2, Steps: 10 | Train Loss: 2.244 Vali Loss: 3.172 Vali Acc: 0.227 Test Loss: 3.172 Test Acc: 0.227
Validation loss decreased (-0.109379 --> -0.227027).  Saving model ...
Epoch: 3 cost time: 0.7228307723999023
Epoch: 3, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.377 Vali Acc: 0.288 Test Loss: 3.377 Test Acc: 0.288
Validation loss decreased (-0.227027 --> -0.288202).  Saving model ...
Epoch: 4 cost time: 0.8033673763275146
Epoch: 4, Steps: 10 | Train Loss: 0.237 Vali Loss: 3.798 Vali Acc: 0.292 Test Loss: 3.798 Test Acc: 0.292
Validation loss decreased (-0.288202 --> -0.291727).  Saving model ...
Epoch: 5 cost time: 0.7893285751342773
Epoch: 5, Steps: 10 | Train Loss: 0.061 Vali Loss: 4.237 Vali Acc: 0.312 Test Loss: 4.237 Test Acc: 0.312
Validation loss decreased (-0.291727 --> -0.311722).  Saving model ...
Epoch: 6 cost time: 0.8342220783233643
Epoch: 6, Steps: 10 | Train Loss: 0.058 Vali Loss: 4.371 Vali Acc: 0.304 Test Loss: 4.371 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6875956058502197
Epoch: 7, Steps: 10 | Train Loss: 0.028 Vali Loss: 4.776 Vali Acc: 0.302 Test Loss: 4.776 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8304042816162109
Epoch: 8, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.871 Vali Acc: 0.307 Test Loss: 4.871 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.7652063369750977
Epoch: 9, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.883 Vali Acc: 0.308 Test Loss: 4.883 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.7847411632537842
Epoch: 10, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.775 Vali Acc: 0.324 Test Loss: 4.775 Test Acc: 0.324
Validation loss decreased (-0.311722 --> -0.323482).  Saving model ...
Epoch: 11 cost time: 0.7696893215179443
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.768 Vali Acc: 0.329 Test Loss: 4.768 Test Acc: 0.329
Validation loss decreased (-0.323482 --> -0.329364).  Saving model ...
Epoch: 12 cost time: 0.8457331657409668
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.717 Vali Acc: 0.335 Test Loss: 4.717 Test Acc: 0.335
Validation loss decreased (-0.329364 --> -0.335247).  Saving model ...
Epoch: 13 cost time: 0.854820728302002
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.710 Vali Acc: 0.346 Test Loss: 4.710 Test Acc: 0.346
Validation loss decreased (-0.335247 --> -0.345835).  Saving model ...
Epoch: 14 cost time: 0.8750574588775635
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.715 Vali Acc: 0.345 Test Loss: 4.715 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8711581230163574
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.723 Vali Acc: 0.344 Test Loss: 4.723 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8921384811401367
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.735 Vali Acc: 0.341 Test Loss: 4.735 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8420810699462891
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.743 Vali Acc: 0.342 Test Loss: 4.743 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8796737194061279
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.753 Vali Acc: 0.338 Test Loss: 4.753 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7282273769378662
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.761 Vali Acc: 0.336 Test Loss: 4.761 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8540704250335693
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.769 Vali Acc: 0.336 Test Loss: 4.769 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7988560199737549
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.772 Vali Acc: 0.338 Test Loss: 4.772 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.8420352935791016
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.775 Vali Acc: 0.338 Test Loss: 4.775 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.868316650390625
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.781 Vali Acc: 0.339 Test Loss: 4.781 Test Acc: 0.339
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 2692662
model size : 20.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3204009532928467
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.282 Vali Acc: 0.082 Test Loss: 3.282 Test Acc: 0.082
Validation loss decreased (inf --> -0.082320).  Saving model ...
Epoch: 2 cost time: 0.7539424896240234
Epoch: 2, Steps: 10 | Train Loss: 2.436 Vali Loss: 3.118 Vali Acc: 0.220 Test Loss: 3.118 Test Acc: 0.220
Validation loss decreased (-0.082320 --> -0.219969).  Saving model ...
Epoch: 3 cost time: 0.780461311340332
Epoch: 3, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.089 Vali Acc: 0.276 Test Loss: 3.089 Test Acc: 0.276
Validation loss decreased (-0.219969 --> -0.276440).  Saving model ...
Epoch: 4 cost time: 0.6869301795959473
Epoch: 4, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.391 Vali Acc: 0.268 Test Loss: 3.391 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.6856694221496582
Epoch: 5, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.612 Vali Acc: 0.314 Test Loss: 3.612 Test Acc: 0.314
Validation loss decreased (-0.276440 --> -0.314082).  Saving model ...
Epoch: 6 cost time: 0.6548633575439453
Epoch: 6, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.919 Vali Acc: 0.296 Test Loss: 3.919 Test Acc: 0.296
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.735344648361206
Epoch: 7, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.327 Vali Acc: 0.288 Test Loss: 4.327 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7661192417144775
Epoch: 8, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.345 Vali Acc: 0.302 Test Loss: 4.345 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.74934983253479
Epoch: 9, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.219 Vali Acc: 0.302 Test Loss: 4.219 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.8085179328918457
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.209 Vali Acc: 0.306 Test Loss: 4.209 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.7193703651428223
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.219 Vali Acc: 0.307 Test Loss: 4.219 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.8183927536010742
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.216 Vali Acc: 0.306 Test Loss: 4.216 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.8036155700683594
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.217 Vali Acc: 0.309 Test Loss: 4.217 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.8555893898010254
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.224 Vali Acc: 0.312 Test Loss: 4.224 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.8507251739501953
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.236 Vali Acc: 0.314 Test Loss: 4.236 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 2692662
model size : 20.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5688743591308594
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.372 Vali Acc: 0.096 Test Loss: 3.372 Test Acc: 0.096
Validation loss decreased (inf --> -0.096437).  Saving model ...
Epoch: 2 cost time: 0.8572344779968262
Epoch: 2, Steps: 10 | Train Loss: 1.996 Vali Loss: 3.358 Vali Acc: 0.225 Test Loss: 3.358 Test Acc: 0.225
Validation loss decreased (-0.096437 --> -0.224672).  Saving model ...
Epoch: 3 cost time: 0.8779468536376953
Epoch: 3, Steps: 10 | Train Loss: 0.721 Vali Loss: 3.780 Vali Acc: 0.284 Test Loss: 3.780 Test Acc: 0.284
Validation loss decreased (-0.224672 --> -0.283492).  Saving model ...
Epoch: 4 cost time: 0.799846887588501
Epoch: 4, Steps: 10 | Train Loss: 0.292 Vali Loss: 4.150 Vali Acc: 0.295 Test Loss: 4.150 Test Acc: 0.295
Validation loss decreased (-0.283492 --> -0.295253).  Saving model ...
Epoch: 5 cost time: 0.837726354598999
Epoch: 5, Steps: 10 | Train Loss: 0.122 Vali Loss: 4.733 Vali Acc: 0.296 Test Loss: 4.733 Test Acc: 0.296
Validation loss decreased (-0.295253 --> -0.296423).  Saving model ...
Epoch: 6 cost time: 0.9319283962249756
Epoch: 6, Steps: 10 | Train Loss: 0.064 Vali Loss: 5.270 Vali Acc: 0.267 Test Loss: 5.270 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9283912181854248
Epoch: 7, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.644 Vali Acc: 0.274 Test Loss: 5.644 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8589620590209961
Epoch: 8, Steps: 10 | Train Loss: 0.082 Vali Loss: 5.732 Vali Acc: 0.284 Test Loss: 5.732 Test Acc: 0.284
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.8672363758087158
Epoch: 9, Steps: 10 | Train Loss: 0.013 Vali Loss: 5.998 Vali Acc: 0.301 Test Loss: 5.998 Test Acc: 0.301
Validation loss decreased (-0.296423 --> -0.301116).  Saving model ...
Epoch: 10 cost time: 0.8221805095672607
Epoch: 10, Steps: 10 | Train Loss: 0.048 Vali Loss: 5.903 Vali Acc: 0.308 Test Loss: 5.903 Test Acc: 0.308
Validation loss decreased (-0.301116 --> -0.308176).  Saving model ...
Epoch: 11 cost time: 0.7963240146636963
Epoch: 11, Steps: 10 | Train Loss: 0.032 Vali Loss: 6.626 Vali Acc: 0.291 Test Loss: 6.626 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8012464046478271
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 6.084 Vali Acc: 0.336 Test Loss: 6.084 Test Acc: 0.336
Validation loss decreased (-0.308176 --> -0.336410).  Saving model ...
Epoch: 13 cost time: 0.7412047386169434
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 6.366 Vali Acc: 0.311 Test Loss: 6.366 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8140168190002441
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 6.959 Vali Acc: 0.287 Test Loss: 6.959 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8529050350189209
Epoch: 15, Steps: 10 | Train Loss: 0.013 Vali Loss: 7.489 Vali Acc: 0.288 Test Loss: 7.489 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8004100322723389
Epoch: 16, Steps: 10 | Train Loss: 0.051 Vali Loss: 7.519 Vali Acc: 0.274 Test Loss: 7.519 Test Acc: 0.274
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8537139892578125
Epoch: 17, Steps: 10 | Train Loss: 0.074 Vali Loss: 9.184 Vali Acc: 0.271 Test Loss: 9.184 Test Acc: 0.271
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7812087535858154
Epoch: 18, Steps: 10 | Train Loss: 0.236 Vali Loss: 9.214 Vali Acc: 0.276 Test Loss: 9.214 Test Acc: 0.276
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8128700256347656
Epoch: 19, Steps: 10 | Train Loss: 0.121 Vali Loss: 9.346 Vali Acc: 0.253 Test Loss: 9.346 Test Acc: 0.253
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7802183628082275
Epoch: 20, Steps: 10 | Train Loss: 0.116 Vali Loss: 11.520 Vali Acc: 0.232 Test Loss: 11.520 Test Acc: 0.232
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.807405948638916
Epoch: 21, Steps: 10 | Train Loss: 0.173 Vali Loss: 11.944 Vali Acc: 0.201 Test Loss: 11.944 Test Acc: 0.201
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7980129718780518
Epoch: 22, Steps: 10 | Train Loss: 0.321 Vali Loss: 14.805 Vali Acc: 0.225 Test Loss: 14.805 Test Acc: 0.225
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 2627126
model size : 19.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.338200807571411
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.345 Vali Acc: 0.107 Test Loss: 3.345 Test Acc: 0.107
Validation loss decreased (inf --> -0.107025).  Saving model ...
Epoch: 2 cost time: 0.7654898166656494
Epoch: 2, Steps: 10 | Train Loss: 2.011 Vali Loss: 3.270 Vali Acc: 0.228 Test Loss: 3.270 Test Acc: 0.228
Validation loss decreased (-0.107025 --> -0.228203).  Saving model ...
Epoch: 3 cost time: 0.8776781558990479
Epoch: 3, Steps: 10 | Train Loss: 0.711 Vali Loss: 3.633 Vali Acc: 0.291 Test Loss: 3.633 Test Acc: 0.291
Validation loss decreased (-0.228203 --> -0.290552).  Saving model ...
Epoch: 4 cost time: 0.8738460540771484
Epoch: 4, Steps: 10 | Train Loss: 0.255 Vali Loss: 3.897 Vali Acc: 0.305 Test Loss: 3.897 Test Acc: 0.305
Validation loss decreased (-0.290552 --> -0.304667).  Saving model ...
Epoch: 5 cost time: 0.8550281524658203
Epoch: 5, Steps: 10 | Train Loss: 0.107 Vali Loss: 4.513 Vali Acc: 0.305 Test Loss: 4.513 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8566737174987793
Epoch: 6, Steps: 10 | Train Loss: 0.091 Vali Loss: 4.605 Vali Acc: 0.312 Test Loss: 4.605 Test Acc: 0.312
Validation loss decreased (-0.304667 --> -0.311719).  Saving model ...
Epoch: 7 cost time: 0.9131135940551758
Epoch: 7, Steps: 10 | Train Loss: 0.015 Vali Loss: 5.264 Vali Acc: 0.299 Test Loss: 5.264 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8498399257659912
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 5.285 Vali Acc: 0.309 Test Loss: 5.285 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.88364577293396
Epoch: 9, Steps: 10 | Train Loss: 0.024 Vali Loss: 5.557 Vali Acc: 0.307 Test Loss: 5.557 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.788926362991333
Epoch: 10, Steps: 10 | Train Loss: 0.049 Vali Loss: 5.732 Vali Acc: 0.291 Test Loss: 5.732 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8726632595062256
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 5.636 Vali Acc: 0.336 Test Loss: 5.636 Test Acc: 0.336
Validation loss decreased (-0.311719 --> -0.336414).  Saving model ...
Epoch: 12 cost time: 0.8614528179168701
Epoch: 12, Steps: 10 | Train Loss: 0.006 Vali Loss: 5.929 Vali Acc: 0.314 Test Loss: 5.929 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9318766593933105
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 5.891 Vali Acc: 0.320 Test Loss: 5.891 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8497540950775146
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 5.874 Vali Acc: 0.335 Test Loss: 5.874 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8505256175994873
Epoch: 15, Steps: 10 | Train Loss: 0.020 Vali Loss: 6.834 Vali Acc: 0.300 Test Loss: 6.834 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8825974464416504
Epoch: 16, Steps: 10 | Train Loss: 0.009 Vali Loss: 6.513 Vali Acc: 0.325 Test Loss: 6.513 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.8014101982116699
Epoch: 17, Steps: 10 | Train Loss: 0.056 Vali Loss: 6.542 Vali Acc: 0.326 Test Loss: 6.542 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8472898006439209
Epoch: 18, Steps: 10 | Train Loss: 0.016 Vali Loss: 7.552 Vali Acc: 0.275 Test Loss: 7.552 Test Acc: 0.275
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7532029151916504
Epoch: 19, Steps: 10 | Train Loss: 0.135 Vali Loss: 9.714 Vali Acc: 0.216 Test Loss: 9.714 Test Acc: 0.216
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8094360828399658
Epoch: 20, Steps: 10 | Train Loss: 0.104 Vali Loss: 10.163 Vali Acc: 0.241 Test Loss: 10.163 Test Acc: 0.241
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7040233612060547
Epoch: 21, Steps: 10 | Train Loss: 0.346 Vali Loss: 9.819 Vali Acc: 0.269 Test Loss: 9.819 Test Acc: 0.269
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 2627126
model size : 19.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4260659217834473
Epoch: 1, Steps: 10 | Train Loss: 3.338 Vali Loss: 3.317 Vali Acc: 0.109 Test Loss: 3.317 Test Acc: 0.109
Validation loss decreased (inf --> -0.109379).  Saving model ...
Epoch: 2 cost time: 0.810870885848999
Epoch: 2, Steps: 10 | Train Loss: 2.075 Vali Loss: 3.165 Vali Acc: 0.233 Test Loss: 3.165 Test Acc: 0.233
Validation loss decreased (-0.109379 --> -0.232910).  Saving model ...
Epoch: 3 cost time: 0.808164119720459
Epoch: 3, Steps: 10 | Train Loss: 0.745 Vali Loss: 3.411 Vali Acc: 0.281 Test Loss: 3.411 Test Acc: 0.281
Validation loss decreased (-0.232910 --> -0.281142).  Saving model ...
Epoch: 4 cost time: 0.8612391948699951
Epoch: 4, Steps: 10 | Train Loss: 0.220 Vali Loss: 3.685 Vali Acc: 0.289 Test Loss: 3.685 Test Acc: 0.289
Validation loss decreased (-0.281142 --> -0.289375).  Saving model ...
Epoch: 5 cost time: 0.7577164173126221
Epoch: 5, Steps: 10 | Train Loss: 0.108 Vali Loss: 4.190 Vali Acc: 0.311 Test Loss: 4.190 Test Acc: 0.311
Validation loss decreased (-0.289375 --> -0.310546).  Saving model ...
Epoch: 6 cost time: 0.7528836727142334
Epoch: 6, Steps: 10 | Train Loss: 0.062 Vali Loss: 4.302 Vali Acc: 0.316 Test Loss: 4.302 Test Acc: 0.316
Validation loss decreased (-0.310546 --> -0.316428).  Saving model ...
Epoch: 7 cost time: 0.6742086410522461
Epoch: 7, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.604 Vali Acc: 0.304 Test Loss: 4.604 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7461416721343994
Epoch: 8, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.656 Vali Acc: 0.324 Test Loss: 4.656 Test Acc: 0.324
Validation loss decreased (-0.316428 --> -0.323483).  Saving model ...
Epoch: 9 cost time: 0.8124089241027832
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.639 Vali Acc: 0.332 Test Loss: 4.639 Test Acc: 0.332
Validation loss decreased (-0.323483 --> -0.331718).  Saving model ...
Epoch: 10 cost time: 0.8683068752288818
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.634 Vali Acc: 0.325 Test Loss: 4.634 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8420674800872803
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.616 Vali Acc: 0.326 Test Loss: 4.616 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.8507804870605469
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.589 Vali Acc: 0.332 Test Loss: 4.589 Test Acc: 0.332
Validation loss decreased (-0.331718 --> -0.331719).  Saving model ...
Epoch: 13 cost time: 0.8503425121307373
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.582 Vali Acc: 0.333 Test Loss: 4.582 Test Acc: 0.333
Validation loss decreased (-0.331719 --> -0.332895).  Saving model ...
Epoch: 14 cost time: 0.8589298725128174
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.585 Vali Acc: 0.341 Test Loss: 4.585 Test Acc: 0.341
Validation loss decreased (-0.332895 --> -0.341131).  Saving model ...
Epoch: 15 cost time: 0.8942620754241943
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.587 Vali Acc: 0.340 Test Loss: 4.587 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8723368644714355
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.595 Vali Acc: 0.340 Test Loss: 4.595 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7997493743896484
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.594 Vali Acc: 0.339 Test Loss: 4.594 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8752977848052979
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.592 Vali Acc: 0.339 Test Loss: 4.592 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8352932929992676
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.595 Vali Acc: 0.339 Test Loss: 4.595 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7890622615814209
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.597 Vali Acc: 0.339 Test Loss: 4.597 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8583660125732422
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.606 Vali Acc: 0.339 Test Loss: 4.606 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8007307052612305
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.615 Vali Acc: 0.340 Test Loss: 4.615 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8215622901916504
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.626 Vali Acc: 0.339 Test Loss: 4.626 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7915165424346924
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.627 Vali Acc: 0.339 Test Loss: 4.627 Test Acc: 0.339
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 2627126
model size : 19.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2721245288848877
Epoch: 1, Steps: 10 | Train Loss: 3.307 Vali Loss: 3.279 Vali Acc: 0.101 Test Loss: 3.279 Test Acc: 0.101
Validation loss decreased (inf --> -0.101144).  Saving model ...
Epoch: 2 cost time: 0.7395317554473877
Epoch: 2, Steps: 10 | Train Loss: 2.299 Vali Loss: 3.110 Vali Acc: 0.213 Test Loss: 3.110 Test Acc: 0.213
Validation loss decreased (-0.101144 --> -0.212910).  Saving model ...
Epoch: 3 cost time: 0.6956188678741455
Epoch: 3, Steps: 10 | Train Loss: 1.004 Vali Loss: 3.087 Vali Acc: 0.274 Test Loss: 3.087 Test Acc: 0.274
Validation loss decreased (-0.212910 --> -0.274087).  Saving model ...
Epoch: 4 cost time: 0.7009718418121338
Epoch: 4, Steps: 10 | Train Loss: 0.311 Vali Loss: 3.384 Vali Acc: 0.260 Test Loss: 3.384 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.7650151252746582
Epoch: 5, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.822 Vali Acc: 0.285 Test Loss: 3.822 Test Acc: 0.285
Validation loss decreased (-0.274087 --> -0.284668).  Saving model ...
Epoch: 6 cost time: 0.8309993743896484
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.772 Vali Acc: 0.305 Test Loss: 3.772 Test Acc: 0.305
Validation loss decreased (-0.284668 --> -0.304668).  Saving model ...
Epoch: 7 cost time: 0.7721498012542725
Epoch: 7, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.883 Vali Acc: 0.301 Test Loss: 3.883 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7166197299957275
Epoch: 8, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.116 Vali Acc: 0.295 Test Loss: 4.116 Test Acc: 0.295
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7253496646881104
Epoch: 9, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.154 Vali Acc: 0.295 Test Loss: 4.154 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.8302109241485596
Epoch: 10, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.128 Vali Acc: 0.300 Test Loss: 4.128 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.8640961647033691
Epoch: 11, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.120 Vali Acc: 0.306 Test Loss: 4.120 Test Acc: 0.306
Validation loss decreased (-0.304668 --> -0.305841).  Saving model ...
Epoch: 12 cost time: 0.772688627243042
Epoch: 12, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.112 Vali Acc: 0.311 Test Loss: 4.112 Test Acc: 0.311
Validation loss decreased (-0.305841 --> -0.310547).  Saving model ...
Epoch: 13 cost time: 0.7504024505615234
Epoch: 13, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.106 Vali Acc: 0.308 Test Loss: 4.106 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7734701633453369
Epoch: 14, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.113 Vali Acc: 0.313 Test Loss: 4.113 Test Acc: 0.313
Validation loss decreased (-0.310547 --> -0.312900).  Saving model ...
Epoch: 15 cost time: 0.7456231117248535
Epoch: 15, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.119 Vali Acc: 0.309 Test Loss: 4.119 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7979729175567627
Epoch: 16, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.130 Vali Acc: 0.309 Test Loss: 4.130 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8392753601074219
Epoch: 17, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.139 Vali Acc: 0.311 Test Loss: 4.139 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8310081958770752
Epoch: 18, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.144 Vali Acc: 0.311 Test Loss: 4.144 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7919120788574219
Epoch: 19, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.153 Vali Acc: 0.311 Test Loss: 4.153 Test Acc: 0.311
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7779614925384521
Epoch: 20, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.162 Vali Acc: 0.311 Test Loss: 4.162 Test Acc: 0.311
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.807358980178833
Epoch: 21, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.175 Vali Acc: 0.308 Test Loss: 4.175 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7884116172790527
Epoch: 22, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.188 Vali Acc: 0.307 Test Loss: 4.188 Test Acc: 0.307
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7640619277954102
Epoch: 23, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.202 Vali Acc: 0.308 Test Loss: 4.202 Test Acc: 0.308
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7839183807373047
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.211 Vali Acc: 0.312 Test Loss: 4.211 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 2627126
model size : 19.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3787131309509277
Epoch: 1, Steps: 10 | Train Loss: 3.410 Vali Loss: 3.291 Vali Acc: 0.095 Test Loss: 3.291 Test Acc: 0.095
Validation loss decreased (inf --> -0.095261).  Saving model ...
Epoch: 2 cost time: 0.7175562381744385
Epoch: 2, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.268 Vali Acc: 0.172 Test Loss: 3.268 Test Acc: 0.172
Validation loss decreased (-0.095261 --> -0.171732).  Saving model ...
Epoch: 3 cost time: 0.6979095935821533
Epoch: 3, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.302 Vali Acc: 0.245 Test Loss: 3.302 Test Acc: 0.245
Validation loss decreased (-0.171732 --> -0.244673).  Saving model ...
Epoch: 4 cost time: 0.6393675804138184
Epoch: 4, Steps: 10 | Train Loss: 0.613 Vali Loss: 3.476 Vali Acc: 0.285 Test Loss: 3.476 Test Acc: 0.285
Validation loss decreased (-0.244673 --> -0.284671).  Saving model ...
Epoch: 5 cost time: 0.6239180564880371
Epoch: 5, Steps: 10 | Train Loss: 0.264 Vali Loss: 3.607 Vali Acc: 0.302 Test Loss: 3.607 Test Acc: 0.302
Validation loss decreased (-0.284671 --> -0.302317).  Saving model ...
Epoch: 6 cost time: 0.6652605533599854
Epoch: 6, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.948 Vali Acc: 0.299 Test Loss: 3.948 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.73240065574646
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.128 Vali Acc: 0.318 Test Loss: 4.128 Test Acc: 0.318
Validation loss decreased (-0.302317 --> -0.317606).  Saving model ...
Epoch: 8 cost time: 0.6893291473388672
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.286 Vali Acc: 0.307 Test Loss: 4.286 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6621918678283691
Epoch: 9, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.380 Vali Acc: 0.329 Test Loss: 4.380 Test Acc: 0.329
Validation loss decreased (-0.317606 --> -0.329368).  Saving model ...
Epoch: 10 cost time: 0.7155721187591553
Epoch: 10, Steps: 10 | Train Loss: 0.017 Vali Loss: 4.514 Vali Acc: 0.333 Test Loss: 4.514 Test Acc: 0.333
Validation loss decreased (-0.329368 --> -0.332896).  Saving model ...
Epoch: 11 cost time: 0.7268037796020508
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.449 Vali Acc: 0.311 Test Loss: 4.449 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7256507873535156
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.329 Vali Acc: 0.334 Test Loss: 4.329 Test Acc: 0.334
Validation loss decreased (-0.332896 --> -0.334074).  Saving model ...
Epoch: 13 cost time: 0.6881439685821533
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.377 Vali Acc: 0.335 Test Loss: 4.377 Test Acc: 0.335
Validation loss decreased (-0.334074 --> -0.335250).  Saving model ...
Epoch: 14 cost time: 0.6771962642669678
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.426 Vali Acc: 0.334 Test Loss: 4.426 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7267971038818359
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.443 Vali Acc: 0.342 Test Loss: 4.443 Test Acc: 0.342
Validation loss decreased (-0.335250 --> -0.342309).  Saving model ...
Epoch: 16 cost time: 0.800234317779541
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.465 Vali Acc: 0.341 Test Loss: 4.465 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.761199951171875
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.487 Vali Acc: 0.338 Test Loss: 4.487 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7430737018585205
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.494 Vali Acc: 0.338 Test Loss: 4.494 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7267489433288574
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.504 Vali Acc: 0.341 Test Loss: 4.504 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7860653400421143
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.523 Vali Acc: 0.338 Test Loss: 4.523 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7231881618499756
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.547 Vali Acc: 0.339 Test Loss: 4.547 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6581366062164307
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.555 Vali Acc: 0.340 Test Loss: 4.555 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6868758201599121
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.558 Vali Acc: 0.342 Test Loss: 4.558 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7690069675445557
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.571 Vali Acc: 0.344 Test Loss: 4.571 Test Acc: 0.344
Validation loss decreased (-0.342309 --> -0.343484).  Saving model ...
Epoch: 25 cost time: 0.7285928726196289
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.580 Vali Acc: 0.344 Test Loss: 4.580 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.745812177658081
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.593 Vali Acc: 0.347 Test Loss: 4.593 Test Acc: 0.347
Validation loss decreased (-0.343484 --> -0.347013).  Saving model ...
Epoch: 27 cost time: 0.7524740695953369
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.605 Vali Acc: 0.347 Test Loss: 4.605 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8780388832092285
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.613 Vali Acc: 0.347 Test Loss: 4.613 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.944594144821167
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.619 Vali Acc: 0.346 Test Loss: 4.619 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.769305944442749
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.627 Vali Acc: 0.345 Test Loss: 4.627 Test Acc: 0.345
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7161080837249756
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.634 Vali Acc: 0.346 Test Loss: 4.634 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8027138710021973
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.644 Vali Acc: 0.347 Test Loss: 4.644 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.9208476543426514
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.654 Vali Acc: 0.346 Test Loss: 4.654 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8057162761688232
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.668 Vali Acc: 0.346 Test Loss: 4.668 Test Acc: 0.346
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8020110130310059
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.680 Vali Acc: 0.349 Test Loss: 4.680 Test Acc: 0.349
Validation loss decreased (-0.347013 --> -0.349365).  Saving model ...
Epoch: 36 cost time: 0.6836044788360596
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.689 Vali Acc: 0.352 Test Loss: 4.689 Test Acc: 0.352
Validation loss decreased (-0.349365 --> -0.351718).  Saving model ...
Epoch: 37 cost time: 0.7052831649780273
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.695 Vali Acc: 0.351 Test Loss: 4.695 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7411189079284668
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.707 Vali Acc: 0.351 Test Loss: 4.707 Test Acc: 0.351
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7295980453491211
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.723 Vali Acc: 0.348 Test Loss: 4.723 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7002227306365967
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.735 Vali Acc: 0.345 Test Loss: 4.735 Test Acc: 0.345
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7635049819946289
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.743 Vali Acc: 0.344 Test Loss: 4.743 Test Acc: 0.344
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7201347351074219
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.749 Vali Acc: 0.345 Test Loss: 4.749 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7265651226043701
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.755 Vali Acc: 0.344 Test Loss: 4.755 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6943018436431885
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.767 Vali Acc: 0.344 Test Loss: 4.767 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.781134843826294
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.778 Vali Acc: 0.344 Test Loss: 4.778 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7324435710906982
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.789 Vali Acc: 0.344 Test Loss: 4.789 Test Acc: 0.344
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 2198326
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.192239999771118
Epoch: 1, Steps: 10 | Train Loss: 3.388 Vali Loss: 3.274 Vali Acc: 0.101 Test Loss: 3.274 Test Acc: 0.101
Validation loss decreased (inf --> -0.101144).  Saving model ...
Epoch: 2 cost time: 0.6316511631011963
Epoch: 2, Steps: 10 | Train Loss: 2.484 Vali Loss: 3.240 Vali Acc: 0.187 Test Loss: 3.240 Test Acc: 0.187
Validation loss decreased (-0.101144 --> -0.187026).  Saving model ...
Epoch: 3 cost time: 0.6250627040863037
Epoch: 3, Steps: 10 | Train Loss: 1.397 Vali Loss: 3.224 Vali Acc: 0.252 Test Loss: 3.224 Test Acc: 0.252
Validation loss decreased (-0.187026 --> -0.251732).  Saving model ...
Epoch: 4 cost time: 0.7170970439910889
Epoch: 4, Steps: 10 | Train Loss: 0.638 Vali Loss: 3.377 Vali Acc: 0.285 Test Loss: 3.377 Test Acc: 0.285
Validation loss decreased (-0.251732 --> -0.284672).  Saving model ...
Epoch: 5 cost time: 0.7168145179748535
Epoch: 5, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.501 Vali Acc: 0.312 Test Loss: 3.501 Test Acc: 0.312
Validation loss decreased (-0.284672 --> -0.311730).  Saving model ...
Epoch: 6 cost time: 0.7023811340332031
Epoch: 6, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.761 Vali Acc: 0.299 Test Loss: 3.761 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7522611618041992
Epoch: 7, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.925 Vali Acc: 0.319 Test Loss: 3.925 Test Acc: 0.319
Validation loss decreased (-0.311730 --> -0.318784).  Saving model ...
Epoch: 8 cost time: 0.7386884689331055
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 4.021 Vali Acc: 0.316 Test Loss: 4.021 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7048647403717041
Epoch: 9, Steps: 10 | Train Loss: 0.042 Vali Loss: 4.051 Vali Acc: 0.327 Test Loss: 4.051 Test Acc: 0.327
Validation loss decreased (-0.318784 --> -0.327018).  Saving model ...
Epoch: 10 cost time: 0.7275636196136475
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.223 Vali Acc: 0.322 Test Loss: 4.223 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7346000671386719
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.153 Vali Acc: 0.334 Test Loss: 4.153 Test Acc: 0.334
Validation loss decreased (-0.327018 --> -0.334076).  Saving model ...
Epoch: 12 cost time: 0.7974014282226562
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.171 Vali Acc: 0.333 Test Loss: 4.171 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8577778339385986
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.187 Vali Acc: 0.338 Test Loss: 4.187 Test Acc: 0.338
Validation loss decreased (-0.334076 --> -0.337605).  Saving model ...
Epoch: 14 cost time: 0.8658831119537354
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.191 Vali Acc: 0.336 Test Loss: 4.191 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8079044818878174
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.196 Vali Acc: 0.335 Test Loss: 4.196 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9015123844146729
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.211 Vali Acc: 0.334 Test Loss: 4.211 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8304634094238281
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.233 Vali Acc: 0.336 Test Loss: 4.233 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8946926593780518
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.249 Vali Acc: 0.338 Test Loss: 4.249 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8220889568328857
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.269 Vali Acc: 0.333 Test Loss: 4.269 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7978532314300537
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.293 Vali Acc: 0.329 Test Loss: 4.293 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9002895355224609
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.321 Vali Acc: 0.326 Test Loss: 4.321 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.9455325603485107
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.328 Vali Acc: 0.331 Test Loss: 4.328 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7827003002166748
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.332 Vali Acc: 0.333 Test Loss: 4.332 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 2198326
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.32670259475708
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.265 Vali Acc: 0.087 Test Loss: 3.265 Test Acc: 0.087
Validation loss decreased (inf --> -0.087026).  Saving model ...
Epoch: 2 cost time: 0.7011086940765381
Epoch: 2, Steps: 10 | Train Loss: 2.548 Vali Loss: 3.212 Vali Acc: 0.175 Test Loss: 3.212 Test Acc: 0.175
Validation loss decreased (-0.087026 --> -0.175262).  Saving model ...
Epoch: 3 cost time: 0.7573421001434326
Epoch: 3, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.119 Vali Acc: 0.254 Test Loss: 3.119 Test Acc: 0.254
Validation loss decreased (-0.175262 --> -0.254086).  Saving model ...
Epoch: 4 cost time: 0.7581396102905273
Epoch: 4, Steps: 10 | Train Loss: 0.684 Vali Loss: 3.210 Vali Acc: 0.289 Test Loss: 3.210 Test Acc: 0.289
Validation loss decreased (-0.254086 --> -0.289380).  Saving model ...
Epoch: 5 cost time: 0.7202508449554443
Epoch: 5, Steps: 10 | Train Loss: 0.262 Vali Loss: 3.322 Vali Acc: 0.306 Test Loss: 3.322 Test Acc: 0.306
Validation loss decreased (-0.289380 --> -0.305849).  Saving model ...
Epoch: 6 cost time: 0.7403559684753418
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.519 Vali Acc: 0.319 Test Loss: 3.519 Test Acc: 0.319
Validation loss decreased (-0.305849 --> -0.318788).  Saving model ...
Epoch: 7 cost time: 0.7342135906219482
Epoch: 7, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.729 Vali Acc: 0.318 Test Loss: 3.729 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7583286762237549
Epoch: 8, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.841 Vali Acc: 0.312 Test Loss: 3.841 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6749346256256104
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.847 Vali Acc: 0.320 Test Loss: 3.847 Test Acc: 0.320
Validation loss decreased (-0.318788 --> -0.319962).  Saving model ...
Epoch: 10 cost time: 0.7093639373779297
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.907 Vali Acc: 0.324 Test Loss: 3.907 Test Acc: 0.324
Validation loss decreased (-0.319962 --> -0.323490).  Saving model ...
Epoch: 11 cost time: 0.7045605182647705
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.941 Vali Acc: 0.321 Test Loss: 3.941 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7625434398651123
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.957 Vali Acc: 0.328 Test Loss: 3.957 Test Acc: 0.328
Validation loss decreased (-0.323490 --> -0.328196).  Saving model ...
Epoch: 13 cost time: 0.7133200168609619
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.963 Vali Acc: 0.332 Test Loss: 3.963 Test Acc: 0.332
Validation loss decreased (-0.328196 --> -0.331725).  Saving model ...
Epoch: 14 cost time: 0.7400686740875244
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.965 Vali Acc: 0.332 Test Loss: 3.965 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7313582897186279
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.967 Vali Acc: 0.332 Test Loss: 3.967 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7704811096191406
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.981 Vali Acc: 0.329 Test Loss: 3.981 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7803928852081299
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.999 Vali Acc: 0.331 Test Loss: 3.999 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7707455158233643
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.012 Vali Acc: 0.328 Test Loss: 4.012 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8010375499725342
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.027 Vali Acc: 0.328 Test Loss: 4.027 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7947573661804199
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.046 Vali Acc: 0.331 Test Loss: 4.046 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7801182270050049
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.071 Vali Acc: 0.329 Test Loss: 4.071 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.755622148513794
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.082 Vali Acc: 0.327 Test Loss: 4.082 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.7611231803894043
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.088 Vali Acc: 0.327 Test Loss: 4.088 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 2198326
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3248815536499023
Epoch: 1, Steps: 10 | Train Loss: 3.295 Vali Loss: 3.239 Vali Acc: 0.080 Test Loss: 3.239 Test Acc: 0.080
Validation loss decreased (inf --> -0.079968).  Saving model ...
Epoch: 2 cost time: 0.784517765045166
Epoch: 2, Steps: 10 | Train Loss: 2.683 Vali Loss: 3.198 Vali Acc: 0.160 Test Loss: 3.198 Test Acc: 0.160
Validation loss decreased (-0.079968 --> -0.159968).  Saving model ...
Epoch: 3 cost time: 0.7237381935119629
Epoch: 3, Steps: 10 | Train Loss: 1.778 Vali Loss: 3.033 Vali Acc: 0.226 Test Loss: 3.033 Test Acc: 0.226
Validation loss decreased (-0.159968 --> -0.225852).  Saving model ...
Epoch: 4 cost time: 0.7010862827301025
Epoch: 4, Steps: 10 | Train Loss: 0.988 Vali Loss: 2.993 Vali Acc: 0.262 Test Loss: 2.993 Test Acc: 0.262
Validation loss decreased (-0.225852 --> -0.262323).  Saving model ...
Epoch: 5 cost time: 0.6882548332214355
Epoch: 5, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.088 Vali Acc: 0.269 Test Loss: 3.088 Test Acc: 0.269
Validation loss decreased (-0.262323 --> -0.269381).  Saving model ...
Epoch: 6 cost time: 0.6932761669158936
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.213 Vali Acc: 0.294 Test Loss: 3.213 Test Acc: 0.294
Validation loss decreased (-0.269381 --> -0.294086).  Saving model ...
Epoch: 7 cost time: 0.6613011360168457
Epoch: 7, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.438 Vali Acc: 0.302 Test Loss: 3.438 Test Acc: 0.302
Validation loss decreased (-0.294086 --> -0.302319).  Saving model ...
Epoch: 8 cost time: 0.6089878082275391
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.523 Vali Acc: 0.298 Test Loss: 3.523 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6169967651367188
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.558 Vali Acc: 0.301 Test Loss: 3.558 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6982369422912598
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.605 Vali Acc: 0.300 Test Loss: 3.605 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.7479133605957031
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.650 Vali Acc: 0.299 Test Loss: 3.650 Test Acc: 0.299
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.6115872859954834
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.670 Vali Acc: 0.302 Test Loss: 3.670 Test Acc: 0.302
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.7303144931793213
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.693 Vali Acc: 0.309 Test Loss: 3.693 Test Acc: 0.309
Validation loss decreased (-0.302319 --> -0.309375).  Saving model ...
Epoch: 14 cost time: 0.6490893363952637
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.709 Vali Acc: 0.304 Test Loss: 3.709 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6911599636077881
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.718 Vali Acc: 0.305 Test Loss: 3.718 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7942054271697998
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.734 Vali Acc: 0.307 Test Loss: 3.734 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6744682788848877
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.759 Vali Acc: 0.306 Test Loss: 3.759 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6720788478851318
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.786 Vali Acc: 0.307 Test Loss: 3.786 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6972417831420898
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.809 Vali Acc: 0.309 Test Loss: 3.809 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7999227046966553
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.835 Vali Acc: 0.306 Test Loss: 3.835 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.5869243144989014
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.859 Vali Acc: 0.305 Test Loss: 3.859 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6588776111602783
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.872 Vali Acc: 0.301 Test Loss: 3.872 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6331021785736084
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.874 Vali Acc: 0.302 Test Loss: 3.874 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30941176470588233
model parameter : 2198326
model size : 13.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.401202440261841
Epoch: 1, Steps: 10 | Train Loss: 3.313 Vali Loss: 3.311 Vali Acc: 0.073 Test Loss: 3.311 Test Acc: 0.073
Validation loss decreased (inf --> -0.072908).  Saving model ...
Epoch: 2 cost time: 0.986046552658081
Epoch: 2, Steps: 10 | Train Loss: 2.567 Vali Loss: 3.296 Vali Acc: 0.178 Test Loss: 3.296 Test Acc: 0.178
Validation loss decreased (-0.072908 --> -0.177614).  Saving model ...
Epoch: 3 cost time: 0.7230162620544434
Epoch: 3, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.236 Vali Acc: 0.241 Test Loss: 3.236 Test Acc: 0.241
Validation loss decreased (-0.177614 --> -0.241144).  Saving model ...
Epoch: 4 cost time: 0.8330695629119873
Epoch: 4, Steps: 10 | Train Loss: 0.611 Vali Loss: 3.527 Vali Acc: 0.284 Test Loss: 3.527 Test Acc: 0.284
Validation loss decreased (-0.241144 --> -0.283494).  Saving model ...
Epoch: 5 cost time: 0.8137238025665283
Epoch: 5, Steps: 10 | Train Loss: 0.235 Vali Loss: 3.678 Vali Acc: 0.298 Test Loss: 3.678 Test Acc: 0.298
Validation loss decreased (-0.283494 --> -0.297610).  Saving model ...
Epoch: 6 cost time: 0.8541603088378906
Epoch: 6, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.960 Vali Acc: 0.311 Test Loss: 3.960 Test Acc: 0.311
Validation loss decreased (-0.297610 --> -0.310549).  Saving model ...
Epoch: 7 cost time: 0.8513975143432617
Epoch: 7, Steps: 10 | Train Loss: 0.063 Vali Loss: 4.126 Vali Acc: 0.316 Test Loss: 4.126 Test Acc: 0.316
Validation loss decreased (-0.310549 --> -0.316429).  Saving model ...
Epoch: 8 cost time: 0.7553496360778809
Epoch: 8, Steps: 10 | Train Loss: 0.029 Vali Loss: 4.331 Vali Acc: 0.319 Test Loss: 4.331 Test Acc: 0.319
Validation loss decreased (-0.316429 --> -0.318780).  Saving model ...
Epoch: 9 cost time: 0.7552297115325928
Epoch: 9, Steps: 10 | Train Loss: 0.019 Vali Loss: 4.362 Vali Acc: 0.315 Test Loss: 4.362 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8103806972503662
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.447 Vali Acc: 0.318 Test Loss: 4.447 Test Acc: 0.318
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7872333526611328
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.510 Vali Acc: 0.325 Test Loss: 4.510 Test Acc: 0.325
Validation loss decreased (-0.318780 --> -0.324661).  Saving model ...
Epoch: 12 cost time: 0.7685141563415527
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.483 Vali Acc: 0.328 Test Loss: 4.483 Test Acc: 0.328
Validation loss decreased (-0.324661 --> -0.328190).  Saving model ...
Epoch: 13 cost time: 0.8042807579040527
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.473 Vali Acc: 0.336 Test Loss: 4.473 Test Acc: 0.336
Validation loss decreased (-0.328190 --> -0.336426).  Saving model ...
Epoch: 14 cost time: 0.7732586860656738
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.518 Vali Acc: 0.335 Test Loss: 4.518 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7503776550292969
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.334 Test Loss: 4.543 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.770540714263916
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.543 Vali Acc: 0.335 Test Loss: 4.543 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7789921760559082
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.545 Vali Acc: 0.335 Test Loss: 4.545 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7837347984313965
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.549 Vali Acc: 0.332 Test Loss: 4.549 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.724611759185791
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.557 Vali Acc: 0.333 Test Loss: 4.557 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7013106346130371
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.571 Vali Acc: 0.333 Test Loss: 4.571 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6568605899810791
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.575 Vali Acc: 0.333 Test Loss: 4.575 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7942507266998291
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.579 Vali Acc: 0.335 Test Loss: 4.579 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.71860671043396
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.585 Vali Acc: 0.336 Test Loss: 4.585 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 1674038
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3002350330352783
Epoch: 1, Steps: 10 | Train Loss: 3.306 Vali Loss: 3.297 Vali Acc: 0.071 Test Loss: 3.297 Test Acc: 0.071
Validation loss decreased (inf --> -0.070555).  Saving model ...
Epoch: 2 cost time: 0.8307931423187256
Epoch: 2, Steps: 10 | Train Loss: 2.577 Vali Loss: 3.270 Vali Acc: 0.179 Test Loss: 3.270 Test Acc: 0.179
Validation loss decreased (-0.070555 --> -0.178791).  Saving model ...
Epoch: 3 cost time: 0.7909600734710693
Epoch: 3, Steps: 10 | Train Loss: 1.440 Vali Loss: 3.166 Vali Acc: 0.249 Test Loss: 3.166 Test Acc: 0.249
Validation loss decreased (-0.178791 --> -0.249380).  Saving model ...
Epoch: 4 cost time: 0.8274648189544678
Epoch: 4, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.424 Vali Acc: 0.284 Test Loss: 3.424 Test Acc: 0.284
Validation loss decreased (-0.249380 --> -0.283495).  Saving model ...
Epoch: 5 cost time: 0.786937952041626
Epoch: 5, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.552 Vali Acc: 0.304 Test Loss: 3.552 Test Acc: 0.304
Validation loss decreased (-0.283495 --> -0.303494).  Saving model ...
Epoch: 6 cost time: 0.7792623043060303
Epoch: 6, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.790 Vali Acc: 0.309 Test Loss: 3.790 Test Acc: 0.309
Validation loss decreased (-0.303494 --> -0.309374).  Saving model ...
Epoch: 7 cost time: 0.7492384910583496
Epoch: 7, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.977 Vali Acc: 0.313 Test Loss: 3.977 Test Acc: 0.313
Validation loss decreased (-0.309374 --> -0.312901).  Saving model ...
Epoch: 8 cost time: 0.756554126739502
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.034 Vali Acc: 0.331 Test Loss: 4.034 Test Acc: 0.331
Validation loss decreased (-0.312901 --> -0.330548).  Saving model ...
Epoch: 9 cost time: 0.8531267642974854
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.114 Vali Acc: 0.326 Test Loss: 4.114 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7696199417114258
Epoch: 10, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.193 Vali Acc: 0.334 Test Loss: 4.193 Test Acc: 0.334
Validation loss decreased (-0.330548 --> -0.334076).  Saving model ...
Epoch: 11 cost time: 0.8116204738616943
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.335 Test Loss: 4.261 Test Acc: 0.335
Validation loss decreased (-0.334076 --> -0.335252).  Saving model ...
Epoch: 12 cost time: 0.8128395080566406
Epoch: 12, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.264 Vali Acc: 0.332 Test Loss: 4.264 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8121035099029541
Epoch: 13, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.261 Vali Acc: 0.342 Test Loss: 4.261 Test Acc: 0.342
Validation loss decreased (-0.335252 --> -0.342310).  Saving model ...
Epoch: 14 cost time: 0.7495296001434326
Epoch: 14, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.334 Vali Acc: 0.336 Test Loss: 4.334 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8434841632843018
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.366 Vali Acc: 0.336 Test Loss: 4.366 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7415070533752441
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.372 Vali Acc: 0.335 Test Loss: 4.372 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.755028247833252
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.342 Vali Acc: 0.338 Test Loss: 4.342 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7306795120239258
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.345 Vali Acc: 0.339 Test Loss: 4.345 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.6768522262573242
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.354 Vali Acc: 0.338 Test Loss: 4.354 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6755819320678711
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.372 Vali Acc: 0.336 Test Loss: 4.372 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.669165849685669
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.377 Vali Acc: 0.342 Test Loss: 4.377 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7408421039581299
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.384 Vali Acc: 0.344 Test Loss: 4.384 Test Acc: 0.344
Validation loss decreased (-0.342310 --> -0.343486).  Saving model ...
Epoch: 23 cost time: 0.7086176872253418
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.396 Vali Acc: 0.341 Test Loss: 4.396 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7086279392242432
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.409 Vali Acc: 0.339 Test Loss: 4.409 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7689187526702881
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.426 Vali Acc: 0.339 Test Loss: 4.426 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7560317516326904
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.438 Vali Acc: 0.338 Test Loss: 4.438 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7516787052154541
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.450 Vali Acc: 0.338 Test Loss: 4.450 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7493100166320801
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.454 Vali Acc: 0.339 Test Loss: 4.454 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.706892728805542
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.463 Vali Acc: 0.339 Test Loss: 4.463 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7091035842895508
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.474 Vali Acc: 0.338 Test Loss: 4.474 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6923320293426514
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.487 Vali Acc: 0.338 Test Loss: 4.487 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7070255279541016
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.498 Vali Acc: 0.336 Test Loss: 4.498 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 1674038
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4518630504608154
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.277 Vali Acc: 0.067 Test Loss: 3.277 Test Acc: 0.067
Validation loss decreased (inf --> -0.067026).  Saving model ...
Epoch: 2 cost time: 0.7451887130737305
Epoch: 2, Steps: 10 | Train Loss: 2.634 Vali Loss: 3.235 Vali Acc: 0.179 Test Loss: 3.235 Test Acc: 0.179
Validation loss decreased (-0.067026 --> -0.178791).  Saving model ...
Epoch: 3 cost time: 0.7101736068725586
Epoch: 3, Steps: 10 | Train Loss: 1.542 Vali Loss: 3.063 Vali Acc: 0.253 Test Loss: 3.063 Test Acc: 0.253
Validation loss decreased (-0.178791 --> -0.252911).  Saving model ...
Epoch: 4 cost time: 0.7003898620605469
Epoch: 4, Steps: 10 | Train Loss: 0.689 Vali Loss: 3.245 Vali Acc: 0.278 Test Loss: 3.245 Test Acc: 0.278
Validation loss decreased (-0.252911 --> -0.277615).  Saving model ...
Epoch: 5 cost time: 0.7009701728820801
Epoch: 5, Steps: 10 | Train Loss: 0.246 Vali Loss: 3.344 Vali Acc: 0.295 Test Loss: 3.344 Test Acc: 0.295
Validation loss decreased (-0.277615 --> -0.295261).  Saving model ...
Epoch: 6 cost time: 0.6908628940582275
Epoch: 6, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.602 Vali Acc: 0.320 Test Loss: 3.602 Test Acc: 0.320
Validation loss decreased (-0.295261 --> -0.319964).  Saving model ...
Epoch: 7 cost time: 0.7270736694335938
Epoch: 7, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.764 Vali Acc: 0.319 Test Loss: 3.764 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7895228862762451
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.755 Vali Acc: 0.328 Test Loss: 3.755 Test Acc: 0.328
Validation loss decreased (-0.319964 --> -0.328198).  Saving model ...
Epoch: 9 cost time: 0.8003275394439697
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.848 Vali Acc: 0.325 Test Loss: 3.848 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7463514804840088
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.867 Vali Acc: 0.332 Test Loss: 3.867 Test Acc: 0.332
Validation loss decreased (-0.328198 --> -0.331726).  Saving model ...
Epoch: 11 cost time: 0.7530231475830078
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.901 Vali Acc: 0.336 Test Loss: 3.901 Test Acc: 0.336
Validation loss decreased (-0.331726 --> -0.336432).  Saving model ...
Epoch: 12 cost time: 0.8248312473297119
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.922 Vali Acc: 0.333 Test Loss: 3.922 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8047494888305664
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.947 Vali Acc: 0.329 Test Loss: 3.947 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8496968746185303
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.965 Vali Acc: 0.328 Test Loss: 3.965 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7387411594390869
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.987 Vali Acc: 0.327 Test Loss: 3.987 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.763831615447998
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.999 Vali Acc: 0.325 Test Loss: 3.999 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.740337610244751
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.008 Vali Acc: 0.328 Test Loss: 4.008 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6858212947845459
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.022 Vali Acc: 0.327 Test Loss: 4.022 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.7644026279449463
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.036 Vali Acc: 0.331 Test Loss: 4.036 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.7857129573822021
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.058 Vali Acc: 0.329 Test Loss: 4.058 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7229671478271484
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.066 Vali Acc: 0.328 Test Loss: 4.066 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 1674038
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3920445442199707
Epoch: 1, Steps: 10 | Train Loss: 3.249 Vali Loss: 3.263 Vali Acc: 0.058 Test Loss: 3.263 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.6643197536468506
Epoch: 2, Steps: 10 | Train Loss: 2.766 Vali Loss: 3.236 Vali Acc: 0.153 Test Loss: 3.236 Test Acc: 0.153
Validation loss decreased (-0.057614 --> -0.152909).  Saving model ...
Epoch: 3 cost time: 0.7139186859130859
Epoch: 3, Steps: 10 | Train Loss: 1.825 Vali Loss: 3.027 Vali Acc: 0.206 Test Loss: 3.027 Test Acc: 0.206
Validation loss decreased (-0.152909 --> -0.205852).  Saving model ...
Epoch: 4 cost time: 0.644622802734375
Epoch: 4, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.049 Vali Acc: 0.252 Test Loss: 3.049 Test Acc: 0.252
Validation loss decreased (-0.205852 --> -0.251734).  Saving model ...
Epoch: 5 cost time: 0.6469509601593018
Epoch: 5, Steps: 10 | Train Loss: 0.441 Vali Loss: 3.105 Vali Acc: 0.271 Test Loss: 3.105 Test Acc: 0.271
Validation loss decreased (-0.251734 --> -0.270557).  Saving model ...
Epoch: 6 cost time: 0.6677505970001221
Epoch: 6, Steps: 10 | Train Loss: 0.150 Vali Loss: 3.289 Vali Acc: 0.299 Test Loss: 3.289 Test Acc: 0.299
Validation loss decreased (-0.270557 --> -0.298791).  Saving model ...
Epoch: 7 cost time: 0.6701226234436035
Epoch: 7, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.518 Vali Acc: 0.292 Test Loss: 3.518 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7300069332122803
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.523 Vali Acc: 0.312 Test Loss: 3.523 Test Acc: 0.312
Validation loss decreased (-0.298791 --> -0.311729).  Saving model ...
Epoch: 9 cost time: 0.6474075317382812
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.578 Vali Acc: 0.305 Test Loss: 3.578 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7067811489105225
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.611 Vali Acc: 0.306 Test Loss: 3.611 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7133667469024658
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.659 Vali Acc: 0.308 Test Loss: 3.659 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7386617660522461
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.699 Vali Acc: 0.313 Test Loss: 3.699 Test Acc: 0.313
Validation loss decreased (-0.311729 --> -0.312904).  Saving model ...
Epoch: 13 cost time: 0.7483036518096924
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.724 Vali Acc: 0.313 Test Loss: 3.724 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7868189811706543
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.744 Vali Acc: 0.313 Test Loss: 3.744 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.728661060333252
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.768 Vali Acc: 0.308 Test Loss: 3.768 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.829808235168457
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.787 Vali Acc: 0.309 Test Loss: 3.787 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7448782920837402
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.803 Vali Acc: 0.307 Test Loss: 3.803 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.813910961151123
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.812 Vali Acc: 0.309 Test Loss: 3.812 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8076159954071045
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.824 Vali Acc: 0.309 Test Loss: 3.824 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7968521118164062
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.841 Vali Acc: 0.308 Test Loss: 3.841 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8174479007720947
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.852 Vali Acc: 0.311 Test Loss: 3.852 Test Acc: 0.311
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8031761646270752
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.866 Vali Acc: 0.309 Test Loss: 3.866 Test Acc: 0.309
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 1674038
model size : 11.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4890124797821045
Epoch: 1, Steps: 10 | Train Loss: 3.362 Vali Loss: 3.308 Vali Acc: 0.080 Test Loss: 3.308 Test Acc: 0.080
Validation loss decreased (inf --> -0.079967).  Saving model ...
Epoch: 2 cost time: 0.7011096477508545
Epoch: 2, Steps: 10 | Train Loss: 2.541 Vali Loss: 3.305 Vali Acc: 0.188 Test Loss: 3.305 Test Acc: 0.188
Validation loss decreased (-0.079967 --> -0.188202).  Saving model ...
Epoch: 3 cost time: 0.7085361480712891
Epoch: 3, Steps: 10 | Train Loss: 1.420 Vali Loss: 3.247 Vali Acc: 0.266 Test Loss: 3.247 Test Acc: 0.266
Validation loss decreased (-0.188202 --> -0.265850).  Saving model ...
Epoch: 4 cost time: 0.7226448059082031
Epoch: 4, Steps: 10 | Train Loss: 0.665 Vali Loss: 3.392 Vali Acc: 0.293 Test Loss: 3.392 Test Acc: 0.293
Validation loss decreased (-0.265850 --> -0.292907).  Saving model ...
Epoch: 5 cost time: 0.7430145740509033
Epoch: 5, Steps: 10 | Train Loss: 0.291 Vali Loss: 3.709 Vali Acc: 0.314 Test Loss: 3.709 Test Acc: 0.314
Validation loss decreased (-0.292907 --> -0.314081).  Saving model ...
Epoch: 6 cost time: 0.7379658222198486
Epoch: 6, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.994 Vali Acc: 0.319 Test Loss: 3.994 Test Acc: 0.319
Validation loss decreased (-0.314081 --> -0.318784).  Saving model ...
Epoch: 7 cost time: 0.7548868656158447
Epoch: 7, Steps: 10 | Train Loss: 0.051 Vali Loss: 4.154 Vali Acc: 0.319 Test Loss: 4.154 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7544436454772949
Epoch: 8, Steps: 10 | Train Loss: 0.032 Vali Loss: 4.412 Vali Acc: 0.316 Test Loss: 4.412 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.8838522434234619
Epoch: 9, Steps: 10 | Train Loss: 0.014 Vali Loss: 4.465 Vali Acc: 0.306 Test Loss: 4.465 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7683665752410889
Epoch: 10, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.534 Vali Acc: 0.320 Test Loss: 4.534 Test Acc: 0.320
Validation loss decreased (-0.318784 --> -0.319955).  Saving model ...
Epoch: 11 cost time: 0.7616536617279053
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.623 Vali Acc: 0.327 Test Loss: 4.623 Test Acc: 0.327
Validation loss decreased (-0.319955 --> -0.327013).  Saving model ...
Epoch: 12 cost time: 0.7906675338745117
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.598 Vali Acc: 0.321 Test Loss: 4.598 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.773505687713623
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.573 Vali Acc: 0.332 Test Loss: 4.573 Test Acc: 0.332
Validation loss decreased (-0.327013 --> -0.331719).  Saving model ...
Epoch: 14 cost time: 0.765286922454834
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.553 Vali Acc: 0.339 Test Loss: 4.553 Test Acc: 0.339
Validation loss decreased (-0.331719 --> -0.338778).  Saving model ...
Epoch: 15 cost time: 0.6824512481689453
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.533 Vali Acc: 0.341 Test Loss: 4.533 Test Acc: 0.341
Validation loss decreased (-0.338778 --> -0.341131).  Saving model ...
Epoch: 16 cost time: 0.6506576538085938
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.537 Vali Acc: 0.344 Test Loss: 4.537 Test Acc: 0.344
Validation loss decreased (-0.341131 --> -0.343484).  Saving model ...
Epoch: 17 cost time: 0.6794612407684326
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.546 Vali Acc: 0.342 Test Loss: 4.546 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7659468650817871
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.560 Vali Acc: 0.346 Test Loss: 4.560 Test Acc: 0.346
Validation loss decreased (-0.343484 --> -0.345837).  Saving model ...
Epoch: 19 cost time: 0.7148487567901611
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.579 Vali Acc: 0.345 Test Loss: 4.579 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8911664485931396
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.593 Vali Acc: 0.344 Test Loss: 4.593 Test Acc: 0.344
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7589781284332275
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.605 Vali Acc: 0.345 Test Loss: 4.605 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.865009069442749
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.613 Vali Acc: 0.346 Test Loss: 4.613 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.8417339324951172
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.629 Vali Acc: 0.347 Test Loss: 4.629 Test Acc: 0.347
Validation loss decreased (-0.345837 --> -0.347013).  Saving model ...
Epoch: 24 cost time: 0.8495492935180664
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.635 Vali Acc: 0.347 Test Loss: 4.635 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8188784122467041
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.643 Vali Acc: 0.346 Test Loss: 4.643 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8310446739196777
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.656 Vali Acc: 0.346 Test Loss: 4.656 Test Acc: 0.346
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7676057815551758
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.675 Vali Acc: 0.345 Test Loss: 4.675 Test Acc: 0.345
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8099877834320068
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.683 Vali Acc: 0.346 Test Loss: 4.683 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7893376350402832
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.693 Vali Acc: 0.346 Test Loss: 4.693 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7699267864227295
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.704 Vali Acc: 0.346 Test Loss: 4.704 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8074986934661865
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.702 Vali Acc: 0.344 Test Loss: 4.702 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8040754795074463
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.702 Vali Acc: 0.342 Test Loss: 4.702 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8209946155548096
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.711 Vali Acc: 0.345 Test Loss: 4.711 Test Acc: 0.345
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 1411894
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.250669002532959
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.296 Vali Acc: 0.074 Test Loss: 3.296 Test Acc: 0.074
Validation loss decreased (inf --> -0.074085).  Saving model ...
Epoch: 2 cost time: 0.6851670742034912
Epoch: 2, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.278 Vali Acc: 0.181 Test Loss: 3.278 Test Acc: 0.181
Validation loss decreased (-0.074085 --> -0.181144).  Saving model ...
Epoch: 3 cost time: 0.7175226211547852
Epoch: 3, Steps: 10 | Train Loss: 1.462 Vali Loss: 3.176 Vali Acc: 0.242 Test Loss: 3.176 Test Acc: 0.242
Validation loss decreased (-0.181144 --> -0.242321).  Saving model ...
Epoch: 4 cost time: 0.6386685371398926
Epoch: 4, Steps: 10 | Train Loss: 0.692 Vali Loss: 3.292 Vali Acc: 0.304 Test Loss: 3.292 Test Acc: 0.304
Validation loss decreased (-0.242321 --> -0.303496).  Saving model ...
Epoch: 5 cost time: 0.6413438320159912
Epoch: 5, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.547 Vali Acc: 0.309 Test Loss: 3.547 Test Acc: 0.309
Validation loss decreased (-0.303496 --> -0.309376).  Saving model ...
Epoch: 6 cost time: 0.722489595413208
Epoch: 6, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.837 Vali Acc: 0.301 Test Loss: 3.837 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.695472240447998
Epoch: 7, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.910 Vali Acc: 0.322 Test Loss: 3.910 Test Acc: 0.322
Validation loss decreased (-0.309376 --> -0.322314).  Saving model ...
Epoch: 8 cost time: 0.7188351154327393
Epoch: 8, Steps: 10 | Train Loss: 0.035 Vali Loss: 4.135 Vali Acc: 0.311 Test Loss: 4.135 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7096545696258545
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.171 Vali Acc: 0.314 Test Loss: 4.171 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6809186935424805
Epoch: 10, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.274 Vali Acc: 0.325 Test Loss: 4.274 Test Acc: 0.325
Validation loss decreased (-0.322314 --> -0.324663).  Saving model ...
Epoch: 11 cost time: 0.6790926456451416
Epoch: 11, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.202 Vali Acc: 0.332 Test Loss: 4.202 Test Acc: 0.332
Validation loss decreased (-0.324663 --> -0.331723).  Saving model ...
Epoch: 12 cost time: 0.7003467082977295
Epoch: 12, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.155 Vali Acc: 0.340 Test Loss: 4.155 Test Acc: 0.340
Validation loss decreased (-0.331723 --> -0.339958).  Saving model ...
Epoch: 13 cost time: 0.6801214218139648
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.310 Vali Acc: 0.331 Test Loss: 4.310 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6017999649047852
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.341 Vali Acc: 0.333 Test Loss: 4.341 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6392166614532471
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.281 Vali Acc: 0.340 Test Loss: 4.281 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5990443229675293
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.285 Vali Acc: 0.340 Test Loss: 4.285 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5995199680328369
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.299 Vali Acc: 0.344 Test Loss: 4.299 Test Acc: 0.344
Validation loss decreased (-0.339958 --> -0.343486).  Saving model ...
Epoch: 18 cost time: 0.664689302444458
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.310 Vali Acc: 0.339 Test Loss: 4.310 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7608840465545654
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.334 Vali Acc: 0.339 Test Loss: 4.334 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7192342281341553
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.356 Vali Acc: 0.340 Test Loss: 4.356 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7512075901031494
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.370 Vali Acc: 0.339 Test Loss: 4.370 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8873109817504883
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.377 Vali Acc: 0.339 Test Loss: 4.377 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.775282621383667
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.390 Vali Acc: 0.339 Test Loss: 4.390 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7968924045562744
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.403 Vali Acc: 0.336 Test Loss: 4.403 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8487906455993652
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.418 Vali Acc: 0.336 Test Loss: 4.418 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7473175525665283
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.432 Vali Acc: 0.336 Test Loss: 4.432 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7360811233520508
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.447 Vali Acc: 0.335 Test Loss: 4.447 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 1411894
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3632168769836426
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.259 Vali Acc: 0.089 Test Loss: 3.259 Test Acc: 0.089
Validation loss decreased (inf --> -0.089379).  Saving model ...
Epoch: 2 cost time: 0.829077959060669
Epoch: 2, Steps: 10 | Train Loss: 2.575 Vali Loss: 3.217 Vali Acc: 0.191 Test Loss: 3.217 Test Acc: 0.191
Validation loss decreased (-0.089379 --> -0.190556).  Saving model ...
Epoch: 3 cost time: 0.8023502826690674
Epoch: 3, Steps: 10 | Train Loss: 1.529 Vali Loss: 3.063 Vali Acc: 0.251 Test Loss: 3.063 Test Acc: 0.251
Validation loss decreased (-0.190556 --> -0.250558).  Saving model ...
Epoch: 4 cost time: 0.8187804222106934
Epoch: 4, Steps: 10 | Train Loss: 0.720 Vali Loss: 3.124 Vali Acc: 0.301 Test Loss: 3.124 Test Acc: 0.301
Validation loss decreased (-0.250558 --> -0.301145).  Saving model ...
Epoch: 5 cost time: 0.6986336708068848
Epoch: 5, Steps: 10 | Train Loss: 0.276 Vali Loss: 3.351 Vali Acc: 0.305 Test Loss: 3.351 Test Acc: 0.305
Validation loss decreased (-0.301145 --> -0.304672).  Saving model ...
Epoch: 6 cost time: 0.7184152603149414
Epoch: 6, Steps: 10 | Train Loss: 0.099 Vali Loss: 3.586 Vali Acc: 0.315 Test Loss: 3.586 Test Acc: 0.315
Validation loss decreased (-0.304672 --> -0.315258).  Saving model ...
Epoch: 7 cost time: 0.7066192626953125
Epoch: 7, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.729 Vali Acc: 0.314 Test Loss: 3.729 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7389712333679199
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.917 Vali Acc: 0.312 Test Loss: 3.917 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6814427375793457
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.939 Vali Acc: 0.316 Test Loss: 3.939 Test Acc: 0.316
Validation loss decreased (-0.315258 --> -0.316431).  Saving model ...
Epoch: 10 cost time: 0.6798515319824219
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.924 Vali Acc: 0.316 Test Loss: 3.924 Test Acc: 0.316
Validation loss decreased (-0.316431 --> -0.316431).  Saving model ...
Epoch: 11 cost time: 0.7205851078033447
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.934 Vali Acc: 0.326 Test Loss: 3.934 Test Acc: 0.326
Validation loss decreased (-0.316431 --> -0.325843).  Saving model ...
Epoch: 12 cost time: 0.7494492530822754
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.932 Vali Acc: 0.326 Test Loss: 3.932 Test Acc: 0.326
Validation loss decreased (-0.325843 --> -0.325843).  Saving model ...
Epoch: 13 cost time: 0.7494528293609619
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.947 Vali Acc: 0.316 Test Loss: 3.947 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7152290344238281
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.968 Vali Acc: 0.316 Test Loss: 3.968 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7385129928588867
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.975 Vali Acc: 0.319 Test Loss: 3.975 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6943883895874023
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.989 Vali Acc: 0.321 Test Loss: 3.989 Test Acc: 0.321
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7479052543640137
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.001 Vali Acc: 0.325 Test Loss: 4.001 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7526571750640869
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.008 Vali Acc: 0.329 Test Loss: 4.008 Test Acc: 0.329
Validation loss decreased (-0.325843 --> -0.329372).  Saving model ...
Epoch: 19 cost time: 0.7365844249725342
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.027 Vali Acc: 0.324 Test Loss: 4.027 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6983907222747803
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.050 Vali Acc: 0.324 Test Loss: 4.050 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7328226566314697
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.069 Vali Acc: 0.320 Test Loss: 4.069 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.753957986831665
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.073 Vali Acc: 0.322 Test Loss: 4.073 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6537277698516846
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.089 Vali Acc: 0.327 Test Loss: 4.089 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7449336051940918
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.099 Vali Acc: 0.327 Test Loss: 4.099 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.815187931060791
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.111 Vali Acc: 0.326 Test Loss: 4.111 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.8020486831665039
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.120 Vali Acc: 0.327 Test Loss: 4.120 Test Acc: 0.327
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.8439962863922119
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.133 Vali Acc: 0.324 Test Loss: 4.133 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.8015978336334229
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.142 Vali Acc: 0.322 Test Loss: 4.142 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 1411894
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2458858489990234
Epoch: 1, Steps: 10 | Train Loss: 3.233 Vali Loss: 3.239 Vali Acc: 0.091 Test Loss: 3.239 Test Acc: 0.091
Validation loss decreased (inf --> -0.090556).  Saving model ...
Epoch: 2 cost time: 0.7364926338195801
Epoch: 2, Steps: 10 | Train Loss: 2.706 Vali Loss: 3.200 Vali Acc: 0.168 Test Loss: 3.200 Test Acc: 0.168
Validation loss decreased (-0.090556 --> -0.168203).  Saving model ...
Epoch: 3 cost time: 0.7120962142944336
Epoch: 3, Steps: 10 | Train Loss: 1.845 Vali Loss: 3.023 Vali Acc: 0.219 Test Loss: 3.023 Test Acc: 0.219
Validation loss decreased (-0.168203 --> -0.218793).  Saving model ...
Epoch: 4 cost time: 0.7618834972381592
Epoch: 4, Steps: 10 | Train Loss: 1.028 Vali Loss: 2.970 Vali Acc: 0.268 Test Loss: 2.970 Test Acc: 0.268
Validation loss decreased (-0.218793 --> -0.268206).  Saving model ...
Epoch: 5 cost time: 0.7772936820983887
Epoch: 5, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.102 Vali Acc: 0.281 Test Loss: 3.102 Test Acc: 0.281
Validation loss decreased (-0.268206 --> -0.281145).  Saving model ...
Epoch: 6 cost time: 0.802680492401123
Epoch: 6, Steps: 10 | Train Loss: 0.160 Vali Loss: 3.281 Vali Acc: 0.304 Test Loss: 3.281 Test Acc: 0.304
Validation loss decreased (-0.281145 --> -0.303497).  Saving model ...
Epoch: 7 cost time: 0.827094316482544
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.380 Vali Acc: 0.289 Test Loss: 3.380 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9091246128082275
Epoch: 8, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.569 Vali Acc: 0.294 Test Loss: 3.569 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7428884506225586
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.645 Vali Acc: 0.291 Test Loss: 3.645 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.7377040386199951
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.679 Vali Acc: 0.295 Test Loss: 3.679 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.6122665405273438
Epoch: 11, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.689 Vali Acc: 0.295 Test Loss: 3.689 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.6528699398040771
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.700 Vali Acc: 0.300 Test Loss: 3.700 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.647925853729248
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.718 Vali Acc: 0.296 Test Loss: 3.718 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.6436586380004883
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.749 Vali Acc: 0.299 Test Loss: 3.749 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.6389317512512207
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.768 Vali Acc: 0.300 Test Loss: 3.768 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 0.7688374519348145
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.792 Vali Acc: 0.300 Test Loss: 3.792 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 1411894
model size : 10.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3451755046844482
Epoch: 1, Steps: 10 | Train Loss: 3.378 Vali Loss: 3.264 Vali Acc: 0.075 Test Loss: 3.264 Test Acc: 0.075
Validation loss decreased (inf --> -0.075261).  Saving model ...
Epoch: 2 cost time: 0.7510347366333008
Epoch: 2, Steps: 10 | Train Loss: 2.617 Vali Loss: 3.358 Vali Acc: 0.174 Test Loss: 3.358 Test Acc: 0.174
Validation loss decreased (-0.075261 --> -0.174084).  Saving model ...
Epoch: 3 cost time: 0.6942667961120605
Epoch: 3, Steps: 10 | Train Loss: 1.338 Vali Loss: 3.216 Vali Acc: 0.247 Test Loss: 3.216 Test Acc: 0.247
Validation loss decreased (-0.174084 --> -0.247027).  Saving model ...
Epoch: 4 cost time: 0.6982519626617432
Epoch: 4, Steps: 10 | Train Loss: 0.666 Vali Loss: 3.499 Vali Acc: 0.269 Test Loss: 3.499 Test Acc: 0.269
Validation loss decreased (-0.247027 --> -0.269377).  Saving model ...
Epoch: 5 cost time: 0.7156305313110352
Epoch: 5, Steps: 10 | Train Loss: 0.289 Vali Loss: 3.666 Vali Acc: 0.304 Test Loss: 3.666 Test Acc: 0.304
Validation loss decreased (-0.269377 --> -0.303493).  Saving model ...
Epoch: 6 cost time: 0.7056539058685303
Epoch: 6, Steps: 10 | Train Loss: 0.100 Vali Loss: 3.991 Vali Acc: 0.312 Test Loss: 3.991 Test Acc: 0.312
Validation loss decreased (-0.303493 --> -0.311725).  Saving model ...
Epoch: 7 cost time: 0.7050967216491699
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 4.026 Vali Acc: 0.322 Test Loss: 4.026 Test Acc: 0.322
Validation loss decreased (-0.311725 --> -0.322313).  Saving model ...
Epoch: 8 cost time: 0.7747781276702881
Epoch: 8, Steps: 10 | Train Loss: 0.036 Vali Loss: 4.291 Vali Acc: 0.325 Test Loss: 4.291 Test Acc: 0.325
Validation loss decreased (-0.322313 --> -0.324663).  Saving model ...
Epoch: 9 cost time: 0.8151760101318359
Epoch: 9, Steps: 10 | Train Loss: 0.012 Vali Loss: 4.362 Vali Acc: 0.334 Test Loss: 4.362 Test Acc: 0.334
Validation loss decreased (-0.324663 --> -0.334074).  Saving model ...
Epoch: 10 cost time: 0.7846741676330566
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.480 Vali Acc: 0.325 Test Loss: 4.480 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7341182231903076
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.633 Vali Acc: 0.324 Test Loss: 4.633 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7781450748443604
Epoch: 12, Steps: 10 | Train Loss: 0.007 Vali Loss: 4.464 Vali Acc: 0.326 Test Loss: 4.464 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7695884704589844
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.446 Vali Acc: 0.326 Test Loss: 4.446 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7434735298156738
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.472 Vali Acc: 0.328 Test Loss: 4.472 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7432923316955566
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.506 Vali Acc: 0.331 Test Loss: 4.506 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7556679248809814
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.535 Vali Acc: 0.333 Test Loss: 4.535 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.8031117916107178
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.551 Vali Acc: 0.334 Test Loss: 4.551 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7175276279449463
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.545 Vali Acc: 0.335 Test Loss: 4.545 Test Acc: 0.335
Validation loss decreased (-0.334074 --> -0.335249).  Saving model ...
Epoch: 19 cost time: 0.7210242748260498
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.571 Vali Acc: 0.333 Test Loss: 4.571 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7138862609863281
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.576 Vali Acc: 0.341 Test Loss: 4.576 Test Acc: 0.341
Validation loss decreased (-0.335249 --> -0.341131).  Saving model ...
Epoch: 21 cost time: 0.7590088844299316
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.597 Vali Acc: 0.341 Test Loss: 4.597 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7971312999725342
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.616 Vali Acc: 0.339 Test Loss: 4.616 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7444491386413574
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.625 Vali Acc: 0.338 Test Loss: 4.625 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7572999000549316
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.631 Vali Acc: 0.335 Test Loss: 4.631 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7278969287872314
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.633 Vali Acc: 0.334 Test Loss: 4.633 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7306759357452393
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.645 Vali Acc: 0.335 Test Loss: 4.645 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7371964454650879
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.651 Vali Acc: 0.335 Test Loss: 4.651 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7401490211486816
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.664 Vali Acc: 0.335 Test Loss: 4.664 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7734634876251221
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.674 Vali Acc: 0.333 Test Loss: 4.674 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8809201717376709
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.683 Vali Acc: 0.334 Test Loss: 4.683 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 1280822
model size : 9.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.402005195617676
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.251 Vali Acc: 0.080 Test Loss: 3.251 Test Acc: 0.080
Validation loss decreased (inf --> -0.079967).  Saving model ...
Epoch: 2 cost time: 0.72579026222229
Epoch: 2, Steps: 10 | Train Loss: 2.637 Vali Loss: 3.324 Vali Acc: 0.178 Test Loss: 3.324 Test Acc: 0.178
Validation loss decreased (-0.079967 --> -0.177614).  Saving model ...
Epoch: 3 cost time: 0.6647613048553467
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.144 Vali Acc: 0.253 Test Loss: 3.144 Test Acc: 0.253
Validation loss decreased (-0.177614 --> -0.252910).  Saving model ...
Epoch: 4 cost time: 0.6576752662658691
Epoch: 4, Steps: 10 | Train Loss: 0.680 Vali Loss: 3.370 Vali Acc: 0.276 Test Loss: 3.370 Test Acc: 0.276
Validation loss decreased (-0.252910 --> -0.276437).  Saving model ...
Epoch: 5 cost time: 0.8204104900360107
Epoch: 5, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.558 Vali Acc: 0.308 Test Loss: 3.558 Test Acc: 0.308
Validation loss decreased (-0.276437 --> -0.308200).  Saving model ...
Epoch: 6 cost time: 0.6597826480865479
Epoch: 6, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.831 Vali Acc: 0.304 Test Loss: 3.831 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7001228332519531
Epoch: 7, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.841 Vali Acc: 0.313 Test Loss: 3.841 Test Acc: 0.313
Validation loss decreased (-0.308200 --> -0.312903).  Saving model ...
Epoch: 8 cost time: 0.776820182800293
Epoch: 8, Steps: 10 | Train Loss: 0.024 Vali Loss: 4.043 Vali Acc: 0.328 Test Loss: 4.043 Test Acc: 0.328
Validation loss decreased (-0.312903 --> -0.328195).  Saving model ...
Epoch: 9 cost time: 0.7538104057312012
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 4.239 Vali Acc: 0.333 Test Loss: 4.239 Test Acc: 0.333
Validation loss decreased (-0.328195 --> -0.332899).  Saving model ...
Epoch: 10 cost time: 0.7915019989013672
Epoch: 10, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.329 Vali Acc: 0.326 Test Loss: 4.329 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7965939044952393
Epoch: 11, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.329 Vali Acc: 0.316 Test Loss: 4.329 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7893886566162109
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.257 Vali Acc: 0.329 Test Loss: 4.257 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8586759567260742
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.259 Vali Acc: 0.318 Test Loss: 4.259 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7313475608825684
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.282 Vali Acc: 0.321 Test Loss: 4.282 Test Acc: 0.321
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.6946308612823486
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.294 Vali Acc: 0.331 Test Loss: 4.294 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7596297264099121
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.305 Vali Acc: 0.333 Test Loss: 4.305 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7010316848754883
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.312 Vali Acc: 0.340 Test Loss: 4.312 Test Acc: 0.340
Validation loss decreased (-0.332899 --> -0.339957).  Saving model ...
Epoch: 18 cost time: 0.6932175159454346
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.316 Vali Acc: 0.339 Test Loss: 4.316 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7331862449645996
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.329 Vali Acc: 0.338 Test Loss: 4.329 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7691376209259033
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.338 Vali Acc: 0.336 Test Loss: 4.338 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7621493339538574
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.346 Vali Acc: 0.338 Test Loss: 4.346 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7263665199279785
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.365 Vali Acc: 0.336 Test Loss: 4.365 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7144827842712402
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.371 Vali Acc: 0.338 Test Loss: 4.371 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7096445560455322
Epoch: 24, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.379 Vali Acc: 0.340 Test Loss: 4.379 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7225511074066162
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.386 Vali Acc: 0.341 Test Loss: 4.386 Test Acc: 0.341
Validation loss decreased (-0.339957 --> -0.341133).  Saving model ...
Epoch: 26 cost time: 0.6933887004852295
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.403 Vali Acc: 0.341 Test Loss: 4.403 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6668951511383057
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.413 Vali Acc: 0.342 Test Loss: 4.413 Test Acc: 0.342
Validation loss decreased (-0.341133 --> -0.342309).  Saving model ...
Epoch: 28 cost time: 0.657132625579834
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.427 Vali Acc: 0.339 Test Loss: 4.427 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6509242057800293
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.437 Vali Acc: 0.339 Test Loss: 4.437 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6568028926849365
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.444 Vali Acc: 0.339 Test Loss: 4.444 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6255488395690918
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.456 Vali Acc: 0.334 Test Loss: 4.456 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6978054046630859
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.471 Vali Acc: 0.336 Test Loss: 4.471 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.6885895729064941
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.475 Vali Acc: 0.338 Test Loss: 4.475 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.7195181846618652
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.478 Vali Acc: 0.340 Test Loss: 4.478 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6793339252471924
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.481 Vali Acc: 0.340 Test Loss: 4.481 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.686121940612793
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.484 Vali Acc: 0.344 Test Loss: 4.484 Test Acc: 0.344
Validation loss decreased (-0.342309 --> -0.343485).  Saving model ...
Epoch: 37 cost time: 0.7786233425140381
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.491 Vali Acc: 0.342 Test Loss: 4.491 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6780481338500977
Epoch: 38, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.498 Vali Acc: 0.339 Test Loss: 4.498 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5973291397094727
Epoch: 39, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.503 Vali Acc: 0.341 Test Loss: 4.503 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6837308406829834
Epoch: 40, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.520 Vali Acc: 0.342 Test Loss: 4.520 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6511850357055664
Epoch: 41, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.532 Vali Acc: 0.341 Test Loss: 4.532 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6122350692749023
Epoch: 42, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.543 Vali Acc: 0.342 Test Loss: 4.543 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7585866451263428
Epoch: 43, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.546 Vali Acc: 0.342 Test Loss: 4.546 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7908599376678467
Epoch: 44, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.558 Vali Acc: 0.344 Test Loss: 4.558 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8167133331298828
Epoch: 45, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.571 Vali Acc: 0.342 Test Loss: 4.571 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7993712425231934
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.580 Vali Acc: 0.341 Test Loss: 4.580 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 1280822
model size : 9.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.457674503326416
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.233 Vali Acc: 0.079 Test Loss: 3.233 Test Acc: 0.079
Validation loss decreased (inf --> -0.078791).  Saving model ...
Epoch: 2 cost time: 0.790266752243042
Epoch: 2, Steps: 10 | Train Loss: 2.684 Vali Loss: 3.278 Vali Acc: 0.178 Test Loss: 3.278 Test Acc: 0.178
Validation loss decreased (-0.078791 --> -0.177614).  Saving model ...
Epoch: 3 cost time: 0.7758841514587402
Epoch: 3, Steps: 10 | Train Loss: 1.444 Vali Loss: 3.026 Vali Acc: 0.246 Test Loss: 3.026 Test Acc: 0.246
Validation loss decreased (-0.177614 --> -0.245852).  Saving model ...
Epoch: 4 cost time: 0.7141830921173096
Epoch: 4, Steps: 10 | Train Loss: 0.733 Vali Loss: 3.160 Vali Acc: 0.292 Test Loss: 3.160 Test Acc: 0.292
Validation loss decreased (-0.245852 --> -0.291733).  Saving model ...
Epoch: 5 cost time: 0.8069303035736084
Epoch: 5, Steps: 10 | Train Loss: 0.296 Vali Loss: 3.371 Vali Acc: 0.305 Test Loss: 3.371 Test Acc: 0.305
Validation loss decreased (-0.291733 --> -0.304672).  Saving model ...
Epoch: 6 cost time: 0.7457976341247559
Epoch: 6, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.544 Vali Acc: 0.321 Test Loss: 3.544 Test Acc: 0.321
Validation loss decreased (-0.304672 --> -0.321141).  Saving model ...
Epoch: 7 cost time: 0.7411527633666992
Epoch: 7, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.629 Vali Acc: 0.316 Test Loss: 3.629 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7712092399597168
Epoch: 8, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.736 Vali Acc: 0.320 Test Loss: 3.736 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7035665512084961
Epoch: 9, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.826 Vali Acc: 0.329 Test Loss: 3.826 Test Acc: 0.329
Validation loss decreased (-0.321141 --> -0.329374).  Saving model ...
Epoch: 10 cost time: 0.7650430202484131
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.904 Vali Acc: 0.331 Test Loss: 3.904 Test Acc: 0.331
Validation loss decreased (-0.329374 --> -0.330549).  Saving model ...
Epoch: 11 cost time: 0.6995463371276855
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.914 Vali Acc: 0.333 Test Loss: 3.914 Test Acc: 0.333
Validation loss decreased (-0.330549 --> -0.332902).  Saving model ...
Epoch: 12 cost time: 0.657480001449585
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.915 Vali Acc: 0.339 Test Loss: 3.915 Test Acc: 0.339
Validation loss decreased (-0.332902 --> -0.338784).  Saving model ...
Epoch: 13 cost time: 0.6412241458892822
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.911 Vali Acc: 0.336 Test Loss: 3.911 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6545164585113525
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.927 Vali Acc: 0.334 Test Loss: 3.927 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5982725620269775
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.946 Vali Acc: 0.334 Test Loss: 3.946 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.657759428024292
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.962 Vali Acc: 0.338 Test Loss: 3.962 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7404804229736328
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.972 Vali Acc: 0.336 Test Loss: 3.972 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7727382183074951
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.969 Vali Acc: 0.334 Test Loss: 3.969 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7762694358825684
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.990 Vali Acc: 0.335 Test Loss: 3.990 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6500401496887207
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.021 Vali Acc: 0.336 Test Loss: 4.021 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7829384803771973
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.032 Vali Acc: 0.339 Test Loss: 4.032 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.739238977432251
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.041 Vali Acc: 0.334 Test Loss: 4.041 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 1280822
model size : 9.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.229076385498047
Epoch: 1, Steps: 10 | Train Loss: 3.341 Vali Loss: 3.219 Vali Acc: 0.081 Test Loss: 3.219 Test Acc: 0.081
Validation loss decreased (inf --> -0.081144).  Saving model ...
Epoch: 2 cost time: 0.7026371955871582
Epoch: 2, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.266 Vali Acc: 0.145 Test Loss: 3.266 Test Acc: 0.145
Validation loss decreased (-0.081144 --> -0.144673).  Saving model ...
Epoch: 3 cost time: 0.7292869091033936
Epoch: 3, Steps: 10 | Train Loss: 1.763 Vali Loss: 2.990 Vali Acc: 0.229 Test Loss: 2.990 Test Acc: 0.229
Validation loss decreased (-0.144673 --> -0.229382).  Saving model ...
Epoch: 4 cost time: 0.6950778961181641
Epoch: 4, Steps: 10 | Train Loss: 0.998 Vali Loss: 2.961 Vali Acc: 0.260 Test Loss: 2.961 Test Acc: 0.260
Validation loss decreased (-0.229382 --> -0.259970).  Saving model ...
Epoch: 5 cost time: 0.732184886932373
Epoch: 5, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.166 Vali Acc: 0.261 Test Loss: 3.166 Test Acc: 0.261
Validation loss decreased (-0.259970 --> -0.261145).  Saving model ...
Epoch: 6 cost time: 0.678898811340332
Epoch: 6, Steps: 10 | Train Loss: 0.164 Vali Loss: 3.209 Vali Acc: 0.300 Test Loss: 3.209 Test Acc: 0.300
Validation loss decreased (-0.261145 --> -0.299968).  Saving model ...
Epoch: 7 cost time: 0.6748228073120117
Epoch: 7, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.416 Vali Acc: 0.292 Test Loss: 3.416 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7230334281921387
Epoch: 8, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.528 Vali Acc: 0.296 Test Loss: 3.528 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6404938697814941
Epoch: 9, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.600 Vali Acc: 0.314 Test Loss: 3.600 Test Acc: 0.314
Validation loss decreased (-0.299968 --> -0.314082).  Saving model ...
Epoch: 10 cost time: 0.8208694458007812
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.684 Vali Acc: 0.308 Test Loss: 3.684 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7523581981658936
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.685 Vali Acc: 0.307 Test Loss: 3.685 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7377419471740723
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.686 Vali Acc: 0.302 Test Loss: 3.686 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7606682777404785
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.698 Vali Acc: 0.305 Test Loss: 3.698 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7499504089355469
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.721 Vali Acc: 0.306 Test Loss: 3.721 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7318325042724609
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.742 Vali Acc: 0.302 Test Loss: 3.742 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.8144938945770264
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.759 Vali Acc: 0.302 Test Loss: 3.759 Test Acc: 0.302
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.7345798015594482
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.776 Vali Acc: 0.304 Test Loss: 3.776 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7222633361816406
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.784 Vali Acc: 0.305 Test Loss: 3.784 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7058556079864502
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.806 Vali Acc: 0.305 Test Loss: 3.806 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 1280822
model size : 9.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3323416709899902
Epoch: 1, Steps: 10 | Train Loss: 3.399 Vali Loss: 3.276 Vali Acc: 0.087 Test Loss: 3.276 Test Acc: 0.087
Validation loss decreased (inf --> -0.087026).  Saving model ...
Epoch: 2 cost time: 0.7173492908477783
Epoch: 2, Steps: 10 | Train Loss: 2.536 Vali Loss: 3.256 Vali Acc: 0.178 Test Loss: 3.256 Test Acc: 0.178
Validation loss decreased (-0.087026 --> -0.177614).  Saving model ...
Epoch: 3 cost time: 0.736807107925415
Epoch: 3, Steps: 10 | Train Loss: 1.386 Vali Loss: 3.274 Vali Acc: 0.245 Test Loss: 3.274 Test Acc: 0.245
Validation loss decreased (-0.177614 --> -0.244673).  Saving model ...
Epoch: 4 cost time: 0.7622435092926025
Epoch: 4, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.391 Vali Acc: 0.288 Test Loss: 3.391 Test Acc: 0.288
Validation loss decreased (-0.244673 --> -0.288201).  Saving model ...
Epoch: 5 cost time: 0.6910202503204346
Epoch: 5, Steps: 10 | Train Loss: 0.241 Vali Loss: 3.775 Vali Acc: 0.295 Test Loss: 3.775 Test Acc: 0.295
Validation loss decreased (-0.288201 --> -0.295256).  Saving model ...
Epoch: 6 cost time: 0.660381555557251
Epoch: 6, Steps: 10 | Train Loss: 0.101 Vali Loss: 3.824 Vali Acc: 0.313 Test Loss: 3.824 Test Acc: 0.313
Validation loss decreased (-0.295256 --> -0.312903).  Saving model ...
Epoch: 7 cost time: 0.6412606239318848
Epoch: 7, Steps: 10 | Train Loss: 0.038 Vali Loss: 4.050 Vali Acc: 0.315 Test Loss: 4.050 Test Acc: 0.315
Validation loss decreased (-0.312903 --> -0.315254).  Saving model ...
Epoch: 8 cost time: 0.7045896053314209
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 4.220 Vali Acc: 0.321 Test Loss: 4.220 Test Acc: 0.321
Validation loss decreased (-0.315254 --> -0.321134).  Saving model ...
Epoch: 9 cost time: 0.6574432849884033
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 4.323 Vali Acc: 0.325 Test Loss: 4.323 Test Acc: 0.325
Validation loss decreased (-0.321134 --> -0.324663).  Saving model ...
Epoch: 10 cost time: 0.7540607452392578
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.339 Vali Acc: 0.322 Test Loss: 4.339 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7542369365692139
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.356 Vali Acc: 0.327 Test Loss: 4.356 Test Acc: 0.327
Validation loss decreased (-0.324663 --> -0.327015).  Saving model ...
Epoch: 12 cost time: 0.7480893135070801
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.350 Vali Acc: 0.328 Test Loss: 4.350 Test Acc: 0.328
Validation loss decreased (-0.327015 --> -0.328192).  Saving model ...
Epoch: 13 cost time: 0.7121834754943848
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.347 Vali Acc: 0.328 Test Loss: 4.347 Test Acc: 0.328
Validation loss decreased (-0.328192 --> -0.328192).  Saving model ...
Epoch: 14 cost time: 0.7618379592895508
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.361 Vali Acc: 0.331 Test Loss: 4.361 Test Acc: 0.331
Validation loss decreased (-0.328192 --> -0.330545).  Saving model ...
Epoch: 15 cost time: 0.7466192245483398
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.375 Vali Acc: 0.336 Test Loss: 4.375 Test Acc: 0.336
Validation loss decreased (-0.330545 --> -0.336427).  Saving model ...
Epoch: 16 cost time: 0.7394351959228516
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.405 Vali Acc: 0.332 Test Loss: 4.405 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6865808963775635
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.424 Vali Acc: 0.331 Test Loss: 4.424 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7123322486877441
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.442 Vali Acc: 0.331 Test Loss: 4.442 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7165679931640625
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.454 Vali Acc: 0.335 Test Loss: 4.454 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6632852554321289
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.468 Vali Acc: 0.333 Test Loss: 4.468 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5851967334747314
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.475 Vali Acc: 0.336 Test Loss: 4.475 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7554090023040771
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.485 Vali Acc: 0.339 Test Loss: 4.485 Test Acc: 0.339
Validation loss decreased (-0.336427 --> -0.338779).  Saving model ...
Epoch: 23 cost time: 0.706282377243042
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.493 Vali Acc: 0.342 Test Loss: 4.493 Test Acc: 0.342
Validation loss decreased (-0.338779 --> -0.342308).  Saving model ...
Epoch: 24 cost time: 0.7722082138061523
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.496 Vali Acc: 0.339 Test Loss: 4.496 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7469727993011475
Epoch: 25, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.506 Vali Acc: 0.336 Test Loss: 4.506 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7989139556884766
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.520 Vali Acc: 0.336 Test Loss: 4.520 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7745609283447266
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.537 Vali Acc: 0.334 Test Loss: 4.537 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7171127796173096
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.548 Vali Acc: 0.339 Test Loss: 4.548 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7582027912139893
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.556 Vali Acc: 0.340 Test Loss: 4.556 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7275612354278564
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.572 Vali Acc: 0.338 Test Loss: 4.572 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6407523155212402
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.588 Vali Acc: 0.338 Test Loss: 4.588 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6759529113769531
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.609 Vali Acc: 0.336 Test Loss: 4.609 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6494970321655273
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.611 Vali Acc: 0.334 Test Loss: 4.611 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 1215286
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.381906270980835
Epoch: 1, Steps: 10 | Train Loss: 3.395 Vali Loss: 3.264 Vali Acc: 0.085 Test Loss: 3.264 Test Acc: 0.085
Validation loss decreased (inf --> -0.084673).  Saving model ...
Epoch: 2 cost time: 0.7575924396514893
Epoch: 2, Steps: 10 | Train Loss: 2.545 Vali Loss: 3.233 Vali Acc: 0.184 Test Loss: 3.233 Test Acc: 0.184
Validation loss decreased (-0.084673 --> -0.183497).  Saving model ...
Epoch: 3 cost time: 0.6753273010253906
Epoch: 3, Steps: 10 | Train Loss: 1.410 Vali Loss: 3.202 Vali Acc: 0.240 Test Loss: 3.202 Test Acc: 0.240
Validation loss decreased (-0.183497 --> -0.239968).  Saving model ...
Epoch: 4 cost time: 0.7747125625610352
Epoch: 4, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.296 Vali Acc: 0.279 Test Loss: 3.296 Test Acc: 0.279
Validation loss decreased (-0.239968 --> -0.278791).  Saving model ...
Epoch: 5 cost time: 0.6907467842102051
Epoch: 5, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.637 Vali Acc: 0.314 Test Loss: 3.637 Test Acc: 0.314
Validation loss decreased (-0.278791 --> -0.314081).  Saving model ...
Epoch: 6 cost time: 0.6949496269226074
Epoch: 6, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.702 Vali Acc: 0.312 Test Loss: 3.702 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.6498322486877441
Epoch: 7, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.862 Vali Acc: 0.318 Test Loss: 3.862 Test Acc: 0.318
Validation loss decreased (-0.314081 --> -0.317608).  Saving model ...
Epoch: 8 cost time: 0.7116115093231201
Epoch: 8, Steps: 10 | Train Loss: 0.016 Vali Loss: 4.025 Vali Acc: 0.315 Test Loss: 4.025 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6396429538726807
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 4.111 Vali Acc: 0.327 Test Loss: 4.111 Test Acc: 0.327
Validation loss decreased (-0.317608 --> -0.327018).  Saving model ...
Epoch: 10 cost time: 0.7325990200042725
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.154 Vali Acc: 0.322 Test Loss: 4.154 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7516107559204102
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.148 Vali Acc: 0.327 Test Loss: 4.148 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7957134246826172
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.158 Vali Acc: 0.334 Test Loss: 4.158 Test Acc: 0.334
Validation loss decreased (-0.327018 --> -0.334076).  Saving model ...
Epoch: 13 cost time: 0.883063793182373
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.162 Vali Acc: 0.331 Test Loss: 4.162 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8311717510223389
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.166 Vali Acc: 0.334 Test Loss: 4.166 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8156049251556396
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.171 Vali Acc: 0.332 Test Loss: 4.171 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.8099088668823242
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.193 Vali Acc: 0.333 Test Loss: 4.193 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7719759941101074
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.212 Vali Acc: 0.333 Test Loss: 4.212 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7967367172241211
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.236 Vali Acc: 0.332 Test Loss: 4.236 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7982001304626465
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.258 Vali Acc: 0.335 Test Loss: 4.258 Test Acc: 0.335
Validation loss decreased (-0.334076 --> -0.335252).  Saving model ...
Epoch: 20 cost time: 0.7980380058288574
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.270 Vali Acc: 0.335 Test Loss: 4.270 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7765395641326904
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.276 Vali Acc: 0.335 Test Loss: 4.276 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8344850540161133
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.286 Vali Acc: 0.335 Test Loss: 4.286 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.793121337890625
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.292 Vali Acc: 0.335 Test Loss: 4.292 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8282804489135742
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.292 Vali Acc: 0.335 Test Loss: 4.292 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8199138641357422
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.305 Vali Acc: 0.333 Test Loss: 4.305 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.795048713684082
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.319 Vali Acc: 0.331 Test Loss: 4.319 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8034927845001221
Epoch: 27, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.339 Vali Acc: 0.334 Test Loss: 4.339 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7737338542938232
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.350 Vali Acc: 0.335 Test Loss: 4.350 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7429945468902588
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.356 Vali Acc: 0.335 Test Loss: 4.356 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3352941176470588
model parameter : 1215286
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0883028507232666
Epoch: 1, Steps: 10 | Train Loss: 3.372 Vali Loss: 3.240 Vali Acc: 0.076 Test Loss: 3.240 Test Acc: 0.076
Validation loss decreased (inf --> -0.076438).  Saving model ...
Epoch: 2 cost time: 0.721550703048706
Epoch: 2, Steps: 10 | Train Loss: 2.618 Vali Loss: 3.185 Vali Acc: 0.172 Test Loss: 3.185 Test Acc: 0.172
Validation loss decreased (-0.076438 --> -0.171733).  Saving model ...
Epoch: 3 cost time: 0.7586703300476074
Epoch: 3, Steps: 10 | Train Loss: 1.477 Vali Loss: 3.074 Vali Acc: 0.262 Test Loss: 3.074 Test Acc: 0.262
Validation loss decreased (-0.171733 --> -0.262322).  Saving model ...
Epoch: 4 cost time: 0.7396025657653809
Epoch: 4, Steps: 10 | Train Loss: 0.687 Vali Loss: 3.110 Vali Acc: 0.289 Test Loss: 3.110 Test Acc: 0.289
Validation loss decreased (-0.262322 --> -0.289381).  Saving model ...
Epoch: 5 cost time: 0.7077250480651855
Epoch: 5, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.378 Vali Acc: 0.309 Test Loss: 3.378 Test Acc: 0.309
Validation loss decreased (-0.289381 --> -0.309378).  Saving model ...
Epoch: 6 cost time: 0.7406153678894043
Epoch: 6, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.489 Vali Acc: 0.318 Test Loss: 3.489 Test Acc: 0.318
Validation loss decreased (-0.309378 --> -0.317612).  Saving model ...
Epoch: 7 cost time: 0.6901016235351562
Epoch: 7, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.625 Vali Acc: 0.316 Test Loss: 3.625 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.660527229309082
Epoch: 8, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.819 Vali Acc: 0.319 Test Loss: 3.819 Test Acc: 0.319
Validation loss decreased (-0.317612 --> -0.318785).  Saving model ...
Epoch: 9 cost time: 0.6640520095825195
Epoch: 9, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.890 Vali Acc: 0.306 Test Loss: 3.890 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6795547008514404
Epoch: 10, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.836 Vali Acc: 0.324 Test Loss: 3.836 Test Acc: 0.324
Validation loss decreased (-0.318785 --> -0.323491).  Saving model ...
Epoch: 11 cost time: 0.7136068344116211
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.840 Vali Acc: 0.325 Test Loss: 3.840 Test Acc: 0.325
Validation loss decreased (-0.323491 --> -0.324667).  Saving model ...
Epoch: 12 cost time: 0.6500344276428223
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.861 Vali Acc: 0.327 Test Loss: 3.861 Test Acc: 0.327
Validation loss decreased (-0.324667 --> -0.327020).  Saving model ...
Epoch: 13 cost time: 0.6902625560760498
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.875 Vali Acc: 0.326 Test Loss: 3.875 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7449524402618408
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.891 Vali Acc: 0.326 Test Loss: 3.891 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7118864059448242
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.903 Vali Acc: 0.326 Test Loss: 3.903 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6896164417266846
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.918 Vali Acc: 0.327 Test Loss: 3.918 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7385854721069336
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.933 Vali Acc: 0.328 Test Loss: 3.933 Test Acc: 0.328
Validation loss decreased (-0.327020 --> -0.328196).  Saving model ...
Epoch: 18 cost time: 0.7702949047088623
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.959 Vali Acc: 0.328 Test Loss: 3.959 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7330408096313477
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.971 Vali Acc: 0.329 Test Loss: 3.971 Test Acc: 0.329
Validation loss decreased (-0.328196 --> -0.329372).  Saving model ...
Epoch: 20 cost time: 0.785346508026123
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.983 Vali Acc: 0.329 Test Loss: 3.983 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7350435256958008
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.995 Vali Acc: 0.328 Test Loss: 3.995 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7756414413452148
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.009 Vali Acc: 0.328 Test Loss: 4.009 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7139425277709961
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.016 Vali Acc: 0.327 Test Loss: 4.016 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7076632976531982
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.020 Vali Acc: 0.328 Test Loss: 4.020 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6896159648895264
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.029 Vali Acc: 0.333 Test Loss: 4.029 Test Acc: 0.333
Validation loss decreased (-0.329372 --> -0.332901).  Saving model ...
Epoch: 26 cost time: 0.7655153274536133
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.042 Vali Acc: 0.333 Test Loss: 4.042 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7510459423065186
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.057 Vali Acc: 0.334 Test Loss: 4.057 Test Acc: 0.334
Validation loss decreased (-0.332901 --> -0.334077).  Saving model ...
Epoch: 28 cost time: 0.7321059703826904
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.068 Vali Acc: 0.328 Test Loss: 4.068 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7154755592346191
Epoch: 29, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.079 Vali Acc: 0.329 Test Loss: 4.079 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6579720973968506
Epoch: 30, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.095 Vali Acc: 0.327 Test Loss: 4.095 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8253881931304932
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.107 Vali Acc: 0.328 Test Loss: 4.107 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.808490514755249
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.123 Vali Acc: 0.327 Test Loss: 4.123 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7834041118621826
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.134 Vali Acc: 0.331 Test Loss: 4.134 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6953268051147461
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.149 Vali Acc: 0.328 Test Loss: 4.149 Test Acc: 0.328
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.720341682434082
Epoch: 35, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.151 Vali Acc: 0.331 Test Loss: 4.151 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6877329349517822
Epoch: 36, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.159 Vali Acc: 0.329 Test Loss: 4.159 Test Acc: 0.329
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6588423252105713
Epoch: 37, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.164 Vali Acc: 0.332 Test Loss: 4.164 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 1215286
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3364272117614746
Epoch: 1, Steps: 10 | Train Loss: 3.311 Vali Loss: 3.256 Vali Acc: 0.062 Test Loss: 3.256 Test Acc: 0.062
Validation loss decreased (inf --> -0.062320).  Saving model ...
Epoch: 2 cost time: 0.7709555625915527
Epoch: 2, Steps: 10 | Train Loss: 2.763 Vali Loss: 3.223 Vali Acc: 0.144 Test Loss: 3.223 Test Acc: 0.144
Validation loss decreased (-0.062320 --> -0.143497).  Saving model ...
Epoch: 3 cost time: 0.7107553482055664
Epoch: 3, Steps: 10 | Train Loss: 1.809 Vali Loss: 3.045 Vali Acc: 0.216 Test Loss: 3.045 Test Acc: 0.216
Validation loss decreased (-0.143497 --> -0.216440).  Saving model ...
Epoch: 4 cost time: 0.7177464962005615
Epoch: 4, Steps: 10 | Train Loss: 0.996 Vali Loss: 2.975 Vali Acc: 0.262 Test Loss: 2.975 Test Acc: 0.262
Validation loss decreased (-0.216440 --> -0.262323).  Saving model ...
Epoch: 5 cost time: 0.7394721508026123
Epoch: 5, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.135 Vali Acc: 0.265 Test Loss: 3.135 Test Acc: 0.265
Validation loss decreased (-0.262323 --> -0.264675).  Saving model ...
Epoch: 6 cost time: 0.6840240955352783
Epoch: 6, Steps: 10 | Train Loss: 0.158 Vali Loss: 3.257 Vali Acc: 0.296 Test Loss: 3.257 Test Acc: 0.296
Validation loss decreased (-0.264675 --> -0.296438).  Saving model ...
Epoch: 7 cost time: 0.6798760890960693
Epoch: 7, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.344 Vali Acc: 0.299 Test Loss: 3.344 Test Acc: 0.299
Validation loss decreased (-0.296438 --> -0.298790).  Saving model ...
Epoch: 8 cost time: 0.7045812606811523
Epoch: 8, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.608 Vali Acc: 0.281 Test Loss: 3.608 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6670849323272705
Epoch: 9, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.674 Vali Acc: 0.288 Test Loss: 3.674 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7574849128723145
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.713 Vali Acc: 0.301 Test Loss: 3.713 Test Acc: 0.301
Validation loss decreased (-0.298790 --> -0.301139).  Saving model ...
Epoch: 11 cost time: 0.701345682144165
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.717 Vali Acc: 0.308 Test Loss: 3.717 Test Acc: 0.308
Validation loss decreased (-0.301139 --> -0.308198).  Saving model ...
Epoch: 12 cost time: 0.6919598579406738
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.721 Vali Acc: 0.305 Test Loss: 3.721 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7300221920013428
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.720 Vali Acc: 0.307 Test Loss: 3.720 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6928350925445557
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.733 Vali Acc: 0.307 Test Loss: 3.733 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6810898780822754
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.750 Vali Acc: 0.306 Test Loss: 3.750 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7184464931488037
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.774 Vali Acc: 0.306 Test Loss: 3.774 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7318179607391357
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.792 Vali Acc: 0.306 Test Loss: 3.792 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7562777996063232
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.810 Vali Acc: 0.304 Test Loss: 3.810 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.6290383338928223
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.828 Vali Acc: 0.302 Test Loss: 3.828 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.5411617755889893
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.846 Vali Acc: 0.302 Test Loss: 3.846 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5849635601043701
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.865 Vali Acc: 0.305 Test Loss: 3.865 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 1215286
model size : 9.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.328420877456665
Epoch: 1, Steps: 10 | Train Loss: 3.337 Vali Loss: 3.268 Vali Acc: 0.086 Test Loss: 3.268 Test Acc: 0.086
Validation loss decreased (inf --> -0.085850).  Saving model ...
Epoch: 2 cost time: 0.7127079963684082
Epoch: 2, Steps: 10 | Train Loss: 2.570 Vali Loss: 3.273 Vali Acc: 0.169 Test Loss: 3.273 Test Acc: 0.169
Validation loss decreased (-0.085850 --> -0.169379).  Saving model ...
Epoch: 3 cost time: 0.7867114543914795
Epoch: 3, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.258 Vali Acc: 0.256 Test Loss: 3.258 Test Acc: 0.256
Validation loss decreased (-0.169379 --> -0.256438).  Saving model ...
Epoch: 4 cost time: 0.6565892696380615
Epoch: 4, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.426 Vali Acc: 0.279 Test Loss: 3.426 Test Acc: 0.279
Validation loss decreased (-0.256438 --> -0.278789).  Saving model ...
Epoch: 5 cost time: 0.7333507537841797
Epoch: 5, Steps: 10 | Train Loss: 0.234 Vali Loss: 3.692 Vali Acc: 0.300 Test Loss: 3.692 Test Acc: 0.300
Validation loss decreased (-0.278789 --> -0.299963).  Saving model ...
Epoch: 6 cost time: 0.8095521926879883
Epoch: 6, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.969 Vali Acc: 0.315 Test Loss: 3.969 Test Acc: 0.315
Validation loss decreased (-0.299963 --> -0.315254).  Saving model ...
Epoch: 7 cost time: 0.6672976016998291
Epoch: 7, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.976 Vali Acc: 0.315 Test Loss: 3.976 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.656857967376709
Epoch: 8, Steps: 10 | Train Loss: 0.023 Vali Loss: 4.267 Vali Acc: 0.312 Test Loss: 4.267 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6413910388946533
Epoch: 9, Steps: 10 | Train Loss: 0.040 Vali Loss: 4.488 Vali Acc: 0.328 Test Loss: 4.488 Test Acc: 0.328
Validation loss decreased (-0.315254 --> -0.328190).  Saving model ...
Epoch: 10 cost time: 0.652001142501831
Epoch: 10, Steps: 10 | Train Loss: 0.009 Vali Loss: 4.498 Vali Acc: 0.315 Test Loss: 4.498 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6643352508544922
Epoch: 11, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.401 Vali Acc: 0.332 Test Loss: 4.401 Test Acc: 0.332
Validation loss decreased (-0.328190 --> -0.331721).  Saving model ...
Epoch: 12 cost time: 0.8287527561187744
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.459 Vali Acc: 0.335 Test Loss: 4.459 Test Acc: 0.335
Validation loss decreased (-0.331721 --> -0.335250).  Saving model ...
Epoch: 13 cost time: 0.6971828937530518
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.532 Vali Acc: 0.342 Test Loss: 4.532 Test Acc: 0.342
Validation loss decreased (-0.335250 --> -0.342308).  Saving model ...
Epoch: 14 cost time: 0.807077169418335
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.596 Vali Acc: 0.340 Test Loss: 4.596 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7012810707092285
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.607 Vali Acc: 0.335 Test Loss: 4.607 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8133857250213623
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.612 Vali Acc: 0.334 Test Loss: 4.612 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7832014560699463
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.598 Vali Acc: 0.334 Test Loss: 4.598 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7727451324462891
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.606 Vali Acc: 0.338 Test Loss: 4.606 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7709681987762451
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.620 Vali Acc: 0.336 Test Loss: 4.620 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7221882343292236
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.631 Vali Acc: 0.334 Test Loss: 4.631 Test Acc: 0.334
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7095649242401123
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.638 Vali Acc: 0.338 Test Loss: 4.638 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6236953735351562
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.642 Vali Acc: 0.335 Test Loss: 4.642 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6682250499725342
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.641 Vali Acc: 0.336 Test Loss: 4.641 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 1182518
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.462158441543579
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.258 Vali Acc: 0.086 Test Loss: 3.258 Test Acc: 0.086
Validation loss decreased (inf --> -0.085850).  Saving model ...
Epoch: 2 cost time: 0.7206027507781982
Epoch: 2, Steps: 10 | Train Loss: 2.605 Vali Loss: 3.248 Vali Acc: 0.174 Test Loss: 3.248 Test Acc: 0.174
Validation loss decreased (-0.085850 --> -0.174085).  Saving model ...
Epoch: 3 cost time: 0.7782750129699707
Epoch: 3, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.186 Vali Acc: 0.259 Test Loss: 3.186 Test Acc: 0.259
Validation loss decreased (-0.174085 --> -0.258792).  Saving model ...
Epoch: 4 cost time: 0.6959896087646484
Epoch: 4, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.325 Vali Acc: 0.272 Test Loss: 3.325 Test Acc: 0.272
Validation loss decreased (-0.258792 --> -0.271731).  Saving model ...
Epoch: 5 cost time: 0.7020807266235352
Epoch: 5, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.547 Vali Acc: 0.300 Test Loss: 3.547 Test Acc: 0.300
Validation loss decreased (-0.271731 --> -0.299965).  Saving model ...
Epoch: 6 cost time: 0.6263024806976318
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.792 Vali Acc: 0.324 Test Loss: 3.792 Test Acc: 0.324
Validation loss decreased (-0.299965 --> -0.323491).  Saving model ...
Epoch: 7 cost time: 0.6558797359466553
Epoch: 7, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.849 Vali Acc: 0.318 Test Loss: 3.849 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6393702030181885
Epoch: 8, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.993 Vali Acc: 0.315 Test Loss: 3.993 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6833937168121338
Epoch: 9, Steps: 10 | Train Loss: 0.031 Vali Loss: 4.178 Vali Acc: 0.326 Test Loss: 4.178 Test Acc: 0.326
Validation loss decreased (-0.323491 --> -0.325841).  Saving model ...
Epoch: 10 cost time: 0.6765580177307129
Epoch: 10, Steps: 10 | Train Loss: 0.022 Vali Loss: 4.259 Vali Acc: 0.336 Test Loss: 4.259 Test Acc: 0.336
Validation loss decreased (-0.325841 --> -0.336428).  Saving model ...
Epoch: 11 cost time: 0.7229816913604736
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.107 Vali Acc: 0.338 Test Loss: 4.107 Test Acc: 0.338
Validation loss decreased (-0.336428 --> -0.337606).  Saving model ...
Epoch: 12 cost time: 0.7065036296844482
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.140 Vali Acc: 0.333 Test Loss: 4.140 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7229273319244385
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.168 Vali Acc: 0.335 Test Loss: 4.168 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6771039962768555
Epoch: 14, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.196 Vali Acc: 0.340 Test Loss: 4.196 Test Acc: 0.340
Validation loss decreased (-0.337606 --> -0.339958).  Saving model ...
Epoch: 15 cost time: 0.7139406204223633
Epoch: 15, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.218 Vali Acc: 0.341 Test Loss: 4.218 Test Acc: 0.341
Validation loss decreased (-0.339958 --> -0.341134).  Saving model ...
Epoch: 16 cost time: 0.7779817581176758
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.247 Vali Acc: 0.340 Test Loss: 4.247 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7297511100769043
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.253 Vali Acc: 0.341 Test Loss: 4.253 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6431915760040283
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.266 Vali Acc: 0.342 Test Loss: 4.266 Test Acc: 0.342
Validation loss decreased (-0.341134 --> -0.342310).  Saving model ...
Epoch: 19 cost time: 0.6530256271362305
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.278 Vali Acc: 0.340 Test Loss: 4.278 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7399489879608154
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.287 Vali Acc: 0.339 Test Loss: 4.287 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6811957359313965
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.300 Vali Acc: 0.339 Test Loss: 4.300 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7060773372650146
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.312 Vali Acc: 0.339 Test Loss: 4.312 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.763418436050415
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.316 Vali Acc: 0.341 Test Loss: 4.316 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7304396629333496
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.323 Vali Acc: 0.342 Test Loss: 4.323 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.746673583984375
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.335 Vali Acc: 0.340 Test Loss: 4.335 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7497408390045166
Epoch: 26, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.348 Vali Acc: 0.339 Test Loss: 4.348 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7776222229003906
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.371 Vali Acc: 0.340 Test Loss: 4.371 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7873914241790771
Epoch: 28, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.381 Vali Acc: 0.341 Test Loss: 4.381 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3423529411764706
model parameter : 1182518
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2999730110168457
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.242 Vali Acc: 0.073 Test Loss: 3.242 Test Acc: 0.073
Validation loss decreased (inf --> -0.072909).  Saving model ...
Epoch: 2 cost time: 0.6909444332122803
Epoch: 2, Steps: 10 | Train Loss: 2.639 Vali Loss: 3.206 Vali Acc: 0.178 Test Loss: 3.206 Test Acc: 0.178
Validation loss decreased (-0.072909 --> -0.177615).  Saving model ...
Epoch: 3 cost time: 0.7266092300415039
Epoch: 3, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.076 Vali Acc: 0.261 Test Loss: 3.076 Test Acc: 0.261
Validation loss decreased (-0.177615 --> -0.261146).  Saving model ...
Epoch: 4 cost time: 0.7958550453186035
Epoch: 4, Steps: 10 | Train Loss: 0.677 Vali Loss: 3.151 Vali Acc: 0.281 Test Loss: 3.151 Test Acc: 0.281
Validation loss decreased (-0.261146 --> -0.281145).  Saving model ...
Epoch: 5 cost time: 0.7257626056671143
Epoch: 5, Steps: 10 | Train Loss: 0.274 Vali Loss: 3.356 Vali Acc: 0.311 Test Loss: 3.356 Test Acc: 0.311
Validation loss decreased (-0.281145 --> -0.310555).  Saving model ...
Epoch: 6 cost time: 0.8142621517181396
Epoch: 6, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.548 Vali Acc: 0.315 Test Loss: 3.548 Test Acc: 0.315
Validation loss decreased (-0.310555 --> -0.315259).  Saving model ...
Epoch: 7 cost time: 0.8216416835784912
Epoch: 7, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.610 Vali Acc: 0.319 Test Loss: 3.610 Test Acc: 0.319
Validation loss decreased (-0.315259 --> -0.318787).  Saving model ...
Epoch: 8 cost time: 0.792102575302124
Epoch: 8, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.724 Vali Acc: 0.332 Test Loss: 3.724 Test Acc: 0.332
Validation loss decreased (-0.318787 --> -0.331727).  Saving model ...
Epoch: 9 cost time: 0.8937585353851318
Epoch: 9, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.955 Vali Acc: 0.320 Test Loss: 3.955 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8130548000335693
Epoch: 10, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.940 Vali Acc: 0.331 Test Loss: 3.940 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7314019203186035
Epoch: 11, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.905 Vali Acc: 0.334 Test Loss: 3.905 Test Acc: 0.334
Validation loss decreased (-0.331727 --> -0.334079).  Saving model ...
Epoch: 12 cost time: 0.7985761165618896
Epoch: 12, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.899 Vali Acc: 0.332 Test Loss: 3.899 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7710742950439453
Epoch: 13, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.906 Vali Acc: 0.332 Test Loss: 3.906 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7186870574951172
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.933 Vali Acc: 0.327 Test Loss: 3.933 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8764443397521973
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.956 Vali Acc: 0.327 Test Loss: 3.956 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.8099346160888672
Epoch: 16, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.982 Vali Acc: 0.328 Test Loss: 3.982 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7016689777374268
Epoch: 17, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.987 Vali Acc: 0.332 Test Loss: 3.987 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.8273115158081055
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.998 Vali Acc: 0.333 Test Loss: 3.998 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.8224523067474365
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.013 Vali Acc: 0.331 Test Loss: 4.013 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.8193821907043457
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.031 Vali Acc: 0.332 Test Loss: 4.031 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.7085952758789062
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.047 Vali Acc: 0.327 Test Loss: 4.047 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 1182518
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1520566940307617
Epoch: 1, Steps: 10 | Train Loss: 3.287 Vali Loss: 3.253 Vali Acc: 0.073 Test Loss: 3.253 Test Acc: 0.073
Validation loss decreased (inf --> -0.072909).  Saving model ...
Epoch: 2 cost time: 0.7469842433929443
Epoch: 2, Steps: 10 | Train Loss: 2.765 Vali Loss: 3.228 Vali Acc: 0.126 Test Loss: 3.228 Test Acc: 0.126
Validation loss decreased (-0.072909 --> -0.125850).  Saving model ...
Epoch: 3 cost time: 0.72031569480896
Epoch: 3, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.044 Vali Acc: 0.233 Test Loss: 3.044 Test Acc: 0.233
Validation loss decreased (-0.125850 --> -0.232911).  Saving model ...
Epoch: 4 cost time: 0.8684802055358887
Epoch: 4, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.000 Vali Acc: 0.251 Test Loss: 3.000 Test Acc: 0.251
Validation loss decreased (-0.232911 --> -0.250558).  Saving model ...
Epoch: 5 cost time: 0.7743256092071533
Epoch: 5, Steps: 10 | Train Loss: 0.450 Vali Loss: 3.101 Vali Acc: 0.292 Test Loss: 3.101 Test Acc: 0.292
Validation loss decreased (-0.250558 --> -0.291734).  Saving model ...
Epoch: 6 cost time: 0.845299482345581
Epoch: 6, Steps: 10 | Train Loss: 0.176 Vali Loss: 3.319 Vali Acc: 0.285 Test Loss: 3.319 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.7007288932800293
Epoch: 7, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.341 Vali Acc: 0.288 Test Loss: 3.341 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.7576749324798584
Epoch: 8, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.472 Vali Acc: 0.294 Test Loss: 3.472 Test Acc: 0.294
Validation loss decreased (-0.291734 --> -0.294083).  Saving model ...
Epoch: 9 cost time: 0.7862088680267334
Epoch: 9, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.628 Vali Acc: 0.289 Test Loss: 3.628 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7583389282226562
Epoch: 10, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.659 Vali Acc: 0.298 Test Loss: 3.659 Test Acc: 0.298
Validation loss decreased (-0.294083 --> -0.297610).  Saving model ...
Epoch: 11 cost time: 0.7461991310119629
Epoch: 11, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.685 Vali Acc: 0.300 Test Loss: 3.685 Test Acc: 0.300
Validation loss decreased (-0.297610 --> -0.299963).  Saving model ...
Epoch: 12 cost time: 0.7880203723907471
Epoch: 12, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.710 Vali Acc: 0.298 Test Loss: 3.710 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7769830226898193
Epoch: 13, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.728 Vali Acc: 0.304 Test Loss: 3.728 Test Acc: 0.304
Validation loss decreased (-0.299963 --> -0.303492).  Saving model ...
Epoch: 14 cost time: 0.7879736423492432
Epoch: 14, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.743 Vali Acc: 0.308 Test Loss: 3.743 Test Acc: 0.308
Validation loss decreased (-0.303492 --> -0.308198).  Saving model ...
Epoch: 15 cost time: 0.8185467720031738
Epoch: 15, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.765 Vali Acc: 0.305 Test Loss: 3.765 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7269768714904785
Epoch: 16, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.787 Vali Acc: 0.304 Test Loss: 3.787 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7286925315856934
Epoch: 17, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.799 Vali Acc: 0.305 Test Loss: 3.799 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7152032852172852
Epoch: 18, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.817 Vali Acc: 0.308 Test Loss: 3.817 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7933480739593506
Epoch: 19, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.842 Vali Acc: 0.307 Test Loss: 3.842 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7310969829559326
Epoch: 20, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.858 Vali Acc: 0.309 Test Loss: 3.858 Test Acc: 0.309
Validation loss decreased (-0.308198 --> -0.309373).  Saving model ...
Epoch: 21 cost time: 0.8597164154052734
Epoch: 21, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.867 Vali Acc: 0.306 Test Loss: 3.867 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8586792945861816
Epoch: 22, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.875 Vali Acc: 0.306 Test Loss: 3.875 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6940388679504395
Epoch: 23, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.887 Vali Acc: 0.306 Test Loss: 3.887 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7818386554718018
Epoch: 24, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.902 Vali Acc: 0.311 Test Loss: 3.902 Test Acc: 0.311
Validation loss decreased (-0.309373 --> -0.310549).  Saving model ...
Epoch: 25 cost time: 0.7965660095214844
Epoch: 25, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.917 Vali Acc: 0.311 Test Loss: 3.917 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8493032455444336
Epoch: 26, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.931 Vali Acc: 0.309 Test Loss: 3.931 Test Acc: 0.309
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8588414192199707
Epoch: 27, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.949 Vali Acc: 0.307 Test Loss: 3.949 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7277047634124756
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.955 Vali Acc: 0.308 Test Loss: 3.955 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7537937164306641
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.973 Vali Acc: 0.309 Test Loss: 3.973 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.677750825881958
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.991 Vali Acc: 0.309 Test Loss: 3.991 Test Acc: 0.309
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7571225166320801
Epoch: 31, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.006 Vali Acc: 0.308 Test Loss: 4.006 Test Acc: 0.308
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7413196563720703
Epoch: 32, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.015 Vali Acc: 0.305 Test Loss: 4.015 Test Acc: 0.305
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8973989486694336
Epoch: 33, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.027 Vali Acc: 0.305 Test Loss: 4.027 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8300471305847168
Epoch: 34, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.043 Vali Acc: 0.305 Test Loss: 4.043 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 1182518
model size : 9.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5039288997650146
Epoch: 1, Steps: 10 | Train Loss: 3.359 Vali Loss: 3.289 Vali Acc: 0.044 Test Loss: 3.289 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.768204927444458
Epoch: 2, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.275 Vali Acc: 0.144 Test Loss: 3.275 Test Acc: 0.144
Validation loss decreased (-0.043497 --> -0.143497).  Saving model ...
Epoch: 3 cost time: 0.7328157424926758
Epoch: 3, Steps: 10 | Train Loss: 2.065 Vali Loss: 3.156 Vali Acc: 0.206 Test Loss: 3.156 Test Acc: 0.206
Validation loss decreased (-0.143497 --> -0.205851).  Saving model ...
Epoch: 4 cost time: 0.756462812423706
Epoch: 4, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.103 Vali Acc: 0.260 Test Loss: 3.103 Test Acc: 0.260
Validation loss decreased (-0.205851 --> -0.259969).  Saving model ...
Epoch: 5 cost time: 0.7468142509460449
Epoch: 5, Steps: 10 | Train Loss: 0.792 Vali Loss: 3.207 Vali Acc: 0.278 Test Loss: 3.207 Test Acc: 0.278
Validation loss decreased (-0.259969 --> -0.277615).  Saving model ...
Epoch: 6 cost time: 0.8111295700073242
Epoch: 6, Steps: 10 | Train Loss: 0.428 Vali Loss: 3.289 Vali Acc: 0.308 Test Loss: 3.289 Test Acc: 0.308
Validation loss decreased (-0.277615 --> -0.308202).  Saving model ...
Epoch: 7 cost time: 0.8561809062957764
Epoch: 7, Steps: 10 | Train Loss: 0.249 Vali Loss: 3.426 Vali Acc: 0.301 Test Loss: 3.426 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8144152164459229
Epoch: 8, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.525 Vali Acc: 0.319 Test Loss: 3.525 Test Acc: 0.319
Validation loss decreased (-0.308202 --> -0.318788).  Saving model ...
Epoch: 9 cost time: 0.816138505935669
Epoch: 9, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.670 Vali Acc: 0.320 Test Loss: 3.670 Test Acc: 0.320
Validation loss decreased (-0.318788 --> -0.319963).  Saving model ...
Epoch: 10 cost time: 0.8296551704406738
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.730 Vali Acc: 0.313 Test Loss: 3.730 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7926814556121826
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.823 Vali Acc: 0.327 Test Loss: 3.823 Test Acc: 0.327
Validation loss decreased (-0.319963 --> -0.327021).  Saving model ...
Epoch: 12 cost time: 0.8139853477478027
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.859 Vali Acc: 0.332 Test Loss: 3.859 Test Acc: 0.332
Validation loss decreased (-0.327021 --> -0.331726).  Saving model ...
Epoch: 13 cost time: 0.7975540161132812
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.884 Vali Acc: 0.334 Test Loss: 3.884 Test Acc: 0.334
Validation loss decreased (-0.331726 --> -0.334079).  Saving model ...
Epoch: 14 cost time: 0.7358171939849854
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.898 Vali Acc: 0.328 Test Loss: 3.898 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.671133279800415
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.901 Vali Acc: 0.331 Test Loss: 3.901 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7041521072387695
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.940 Vali Acc: 0.331 Test Loss: 3.940 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.690326452255249
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.977 Vali Acc: 0.334 Test Loss: 3.977 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6906123161315918
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.981 Vali Acc: 0.332 Test Loss: 3.981 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7701902389526367
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.006 Vali Acc: 0.332 Test Loss: 4.006 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8087921142578125
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.019 Vali Acc: 0.339 Test Loss: 4.019 Test Acc: 0.339
Validation loss decreased (-0.334079 --> -0.338783).  Saving model ...
Epoch: 21 cost time: 0.7456235885620117
Epoch: 21, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.037 Vali Acc: 0.333 Test Loss: 4.037 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8125
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.063 Vali Acc: 0.332 Test Loss: 4.063 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.745901346206665
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.079 Vali Acc: 0.332 Test Loss: 4.079 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7334909439086914
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.094 Vali Acc: 0.336 Test Loss: 4.094 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8296999931335449
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.109 Vali Acc: 0.333 Test Loss: 4.109 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7704792022705078
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.123 Vali Acc: 0.336 Test Loss: 4.123 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7341279983520508
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.142 Vali Acc: 0.339 Test Loss: 4.142 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7867155075073242
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.157 Vali Acc: 0.336 Test Loss: 4.157 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7104506492614746
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.160 Vali Acc: 0.333 Test Loss: 4.160 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8238050937652588
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.165 Vali Acc: 0.334 Test Loss: 4.165 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 1066422
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.319404125213623
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.269 Vali Acc: 0.061 Test Loss: 3.269 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 0.6762115955352783
Epoch: 2, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.254 Vali Acc: 0.141 Test Loss: 3.254 Test Acc: 0.141
Validation loss decreased (-0.061144 --> -0.141144).  Saving model ...
Epoch: 3 cost time: 0.6147623062133789
Epoch: 3, Steps: 10 | Train Loss: 2.093 Vali Loss: 3.138 Vali Acc: 0.189 Test Loss: 3.138 Test Acc: 0.189
Validation loss decreased (-0.141144 --> -0.189380).  Saving model ...
Epoch: 4 cost time: 0.6978662014007568
Epoch: 4, Steps: 10 | Train Loss: 1.404 Vali Loss: 3.063 Vali Acc: 0.246 Test Loss: 3.063 Test Acc: 0.246
Validation loss decreased (-0.189380 --> -0.245852).  Saving model ...
Epoch: 5 cost time: 0.6895053386688232
Epoch: 5, Steps: 10 | Train Loss: 0.818 Vali Loss: 3.130 Vali Acc: 0.275 Test Loss: 3.130 Test Acc: 0.275
Validation loss decreased (-0.245852 --> -0.275263).  Saving model ...
Epoch: 6 cost time: 0.6935958862304688
Epoch: 6, Steps: 10 | Train Loss: 0.433 Vali Loss: 3.201 Vali Acc: 0.291 Test Loss: 3.201 Test Acc: 0.291
Validation loss decreased (-0.275263 --> -0.290556).  Saving model ...
Epoch: 7 cost time: 0.6451447010040283
Epoch: 7, Steps: 10 | Train Loss: 0.244 Vali Loss: 3.351 Vali Acc: 0.312 Test Loss: 3.351 Test Acc: 0.312
Validation loss decreased (-0.290556 --> -0.311731).  Saving model ...
Epoch: 8 cost time: 0.7197487354278564
Epoch: 8, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.417 Vali Acc: 0.309 Test Loss: 3.417 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7367596626281738
Epoch: 9, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.582 Vali Acc: 0.308 Test Loss: 3.582 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.8058962821960449
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.602 Vali Acc: 0.327 Test Loss: 3.602 Test Acc: 0.327
Validation loss decreased (-0.311731 --> -0.327023).  Saving model ...
Epoch: 11 cost time: 0.6802821159362793
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.674 Vali Acc: 0.321 Test Loss: 3.674 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7098143100738525
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.677 Vali Acc: 0.324 Test Loss: 3.677 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6853902339935303
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.720 Vali Acc: 0.329 Test Loss: 3.720 Test Acc: 0.329
Validation loss decreased (-0.327023 --> -0.329375).  Saving model ...
Epoch: 14 cost time: 0.6398389339447021
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.746 Vali Acc: 0.335 Test Loss: 3.746 Test Acc: 0.335
Validation loss decreased (-0.329375 --> -0.335257).  Saving model ...
Epoch: 15 cost time: 0.6072239875793457
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.754 Vali Acc: 0.332 Test Loss: 3.754 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6381878852844238
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.777 Vali Acc: 0.336 Test Loss: 3.777 Test Acc: 0.336
Validation loss decreased (-0.335257 --> -0.336433).  Saving model ...
Epoch: 17 cost time: 0.6380155086517334
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.807 Vali Acc: 0.338 Test Loss: 3.807 Test Acc: 0.338
Validation loss decreased (-0.336433 --> -0.337609).  Saving model ...
Epoch: 18 cost time: 0.6316282749176025
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.813 Vali Acc: 0.335 Test Loss: 3.813 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6198756694793701
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.835 Vali Acc: 0.329 Test Loss: 3.835 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.656653881072998
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.844 Vali Acc: 0.339 Test Loss: 3.844 Test Acc: 0.339
Validation loss decreased (-0.337609 --> -0.338785).  Saving model ...
Epoch: 21 cost time: 0.7526600360870361
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.861 Vali Acc: 0.341 Test Loss: 3.861 Test Acc: 0.341
Validation loss decreased (-0.338785 --> -0.341138).  Saving model ...
Epoch: 22 cost time: 0.8200502395629883
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.883 Vali Acc: 0.340 Test Loss: 3.883 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6860449314117432
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.899 Vali Acc: 0.338 Test Loss: 3.899 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6632246971130371
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.917 Vali Acc: 0.339 Test Loss: 3.917 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7105700969696045
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.928 Vali Acc: 0.341 Test Loss: 3.928 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7678554058074951
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.941 Vali Acc: 0.345 Test Loss: 3.941 Test Acc: 0.345
Validation loss decreased (-0.341138 --> -0.344666).  Saving model ...
Epoch: 27 cost time: 0.6980273723602295
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.956 Vali Acc: 0.345 Test Loss: 3.956 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6237752437591553
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.968 Vali Acc: 0.340 Test Loss: 3.968 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7369394302368164
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.971 Vali Acc: 0.342 Test Loss: 3.971 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6741163730621338
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.975 Vali Acc: 0.344 Test Loss: 3.975 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8158009052276611
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.985 Vali Acc: 0.345 Test Loss: 3.985 Test Acc: 0.345
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8426787853240967
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.005 Vali Acc: 0.345 Test Loss: 4.005 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8906676769256592
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.022 Vali Acc: 0.342 Test Loss: 4.022 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8571462631225586
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.034 Vali Acc: 0.342 Test Loss: 4.034 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.8739175796508789
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.043 Vali Acc: 0.344 Test Loss: 4.043 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.8688228130340576
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.057 Vali Acc: 0.342 Test Loss: 4.057 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 1066422
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.183303117752075
Epoch: 1, Steps: 10 | Train Loss: 3.300 Vali Loss: 3.261 Vali Acc: 0.059 Test Loss: 3.261 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.6457436084747314
Epoch: 2, Steps: 10 | Train Loss: 2.876 Vali Loss: 3.244 Vali Acc: 0.138 Test Loss: 3.244 Test Acc: 0.138
Validation loss decreased (-0.058791 --> -0.137615).  Saving model ...
Epoch: 3 cost time: 0.7290463447570801
Epoch: 3, Steps: 10 | Train Loss: 2.210 Vali Loss: 3.130 Vali Acc: 0.193 Test Loss: 3.130 Test Acc: 0.193
Validation loss decreased (-0.137615 --> -0.192910).  Saving model ...
Epoch: 4 cost time: 0.760453462600708
Epoch: 4, Steps: 10 | Train Loss: 1.507 Vali Loss: 3.017 Vali Acc: 0.252 Test Loss: 3.017 Test Acc: 0.252
Validation loss decreased (-0.192910 --> -0.251735).  Saving model ...
Epoch: 5 cost time: 0.7215025424957275
Epoch: 5, Steps: 10 | Train Loss: 0.934 Vali Loss: 3.037 Vali Acc: 0.279 Test Loss: 3.037 Test Acc: 0.279
Validation loss decreased (-0.251735 --> -0.278793).  Saving model ...
Epoch: 6 cost time: 0.8021774291992188
Epoch: 6, Steps: 10 | Train Loss: 0.512 Vali Loss: 3.095 Vali Acc: 0.293 Test Loss: 3.095 Test Acc: 0.293
Validation loss decreased (-0.278793 --> -0.292910).  Saving model ...
Epoch: 7 cost time: 0.6902236938476562
Epoch: 7, Steps: 10 | Train Loss: 0.284 Vali Loss: 3.208 Vali Acc: 0.311 Test Loss: 3.208 Test Acc: 0.311
Validation loss decreased (-0.292910 --> -0.310556).  Saving model ...
Epoch: 8 cost time: 0.6795892715454102
Epoch: 8, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.258 Vali Acc: 0.320 Test Loss: 3.258 Test Acc: 0.320
Validation loss decreased (-0.310556 --> -0.319967).  Saving model ...
Epoch: 9 cost time: 0.7258419990539551
Epoch: 9, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.411 Vali Acc: 0.307 Test Loss: 3.411 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7904694080352783
Epoch: 10, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.485 Vali Acc: 0.321 Test Loss: 3.485 Test Acc: 0.321
Validation loss decreased (-0.319967 --> -0.321142).  Saving model ...
Epoch: 11 cost time: 0.6234409809112549
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.528 Vali Acc: 0.321 Test Loss: 3.528 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6201784610748291
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.547 Vali Acc: 0.322 Test Loss: 3.547 Test Acc: 0.322
Validation loss decreased (-0.321142 --> -0.322317).  Saving model ...
Epoch: 13 cost time: 0.6440482139587402
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.579 Vali Acc: 0.325 Test Loss: 3.579 Test Acc: 0.325
Validation loss decreased (-0.322317 --> -0.324670).  Saving model ...
Epoch: 14 cost time: 0.6877357959747314
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.590 Vali Acc: 0.328 Test Loss: 3.590 Test Acc: 0.328
Validation loss decreased (-0.324670 --> -0.328199).  Saving model ...
Epoch: 15 cost time: 0.6744248867034912
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.604 Vali Acc: 0.321 Test Loss: 3.604 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7227578163146973
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.623 Vali Acc: 0.326 Test Loss: 3.623 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7227180004119873
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.646 Vali Acc: 0.320 Test Loss: 3.646 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7147495746612549
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.651 Vali Acc: 0.324 Test Loss: 3.651 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7539894580841064
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.675 Vali Acc: 0.327 Test Loss: 3.675 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7135682106018066
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.687 Vali Acc: 0.329 Test Loss: 3.687 Test Acc: 0.329
Validation loss decreased (-0.328199 --> -0.329375).  Saving model ...
Epoch: 21 cost time: 0.6789021492004395
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.699 Vali Acc: 0.328 Test Loss: 3.699 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6425647735595703
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.710 Vali Acc: 0.334 Test Loss: 3.710 Test Acc: 0.334
Validation loss decreased (-0.329375 --> -0.334081).  Saving model ...
Epoch: 23 cost time: 0.7187619209289551
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.722 Vali Acc: 0.332 Test Loss: 3.722 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7140064239501953
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.740 Vali Acc: 0.332 Test Loss: 3.740 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.6115586757659912
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.751 Vali Acc: 0.333 Test Loss: 3.751 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6214587688446045
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.764 Vali Acc: 0.332 Test Loss: 3.764 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8486771583557129
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.779 Vali Acc: 0.331 Test Loss: 3.779 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7753219604492188
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.790 Vali Acc: 0.326 Test Loss: 3.790 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9197814464569092
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.797 Vali Acc: 0.332 Test Loss: 3.797 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7087252140045166
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.806 Vali Acc: 0.334 Test Loss: 3.806 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7079942226409912
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.816 Vali Acc: 0.336 Test Loss: 3.816 Test Acc: 0.336
Validation loss decreased (-0.334081 --> -0.336432).  Saving model ...
Epoch: 32 cost time: 0.7228202819824219
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.836 Vali Acc: 0.332 Test Loss: 3.836 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7466979026794434
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.853 Vali Acc: 0.333 Test Loss: 3.853 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6980111598968506
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.862 Vali Acc: 0.332 Test Loss: 3.862 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7899560928344727
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.870 Vali Acc: 0.333 Test Loss: 3.870 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7854344844818115
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.881 Vali Acc: 0.338 Test Loss: 3.881 Test Acc: 0.338
Validation loss decreased (-0.336432 --> -0.337608).  Saving model ...
Epoch: 37 cost time: 0.8617122173309326
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.886 Vali Acc: 0.336 Test Loss: 3.886 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.8116629123687744
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.887 Vali Acc: 0.334 Test Loss: 3.887 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7431797981262207
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.894 Vali Acc: 0.336 Test Loss: 3.894 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7811534404754639
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.903 Vali Acc: 0.336 Test Loss: 3.903 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8046948909759521
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.909 Vali Acc: 0.338 Test Loss: 3.909 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7132174968719482
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.918 Vali Acc: 0.338 Test Loss: 3.918 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.8208796977996826
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.933 Vali Acc: 0.335 Test Loss: 3.933 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.8186702728271484
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.945 Vali Acc: 0.336 Test Loss: 3.945 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7043299674987793
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.956 Vali Acc: 0.334 Test Loss: 3.956 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.7147674560546875
Epoch: 46, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.964 Vali Acc: 0.336 Test Loss: 3.964 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3376470588235294
model parameter : 1066422
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3611323833465576
Epoch: 1, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.246 Vali Acc: 0.065 Test Loss: 3.246 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 0.7561521530151367
Epoch: 2, Steps: 10 | Train Loss: 2.927 Vali Loss: 3.230 Vali Acc: 0.107 Test Loss: 3.230 Test Acc: 0.107
Validation loss decreased (-0.064673 --> -0.107027).  Saving model ...
Epoch: 3 cost time: 0.677356481552124
Epoch: 3, Steps: 10 | Train Loss: 2.414 Vali Loss: 3.152 Vali Acc: 0.151 Test Loss: 3.152 Test Acc: 0.151
Validation loss decreased (-0.107027 --> -0.150557).  Saving model ...
Epoch: 4 cost time: 0.6965653896331787
Epoch: 4, Steps: 10 | Train Loss: 1.806 Vali Loss: 3.016 Vali Acc: 0.216 Test Loss: 3.016 Test Acc: 0.216
Validation loss decreased (-0.150557 --> -0.216440).  Saving model ...
Epoch: 5 cost time: 0.7248194217681885
Epoch: 5, Steps: 10 | Train Loss: 1.277 Vali Loss: 2.965 Vali Acc: 0.238 Test Loss: 2.965 Test Acc: 0.238
Validation loss decreased (-0.216440 --> -0.237617).  Saving model ...
Epoch: 6 cost time: 0.7272233963012695
Epoch: 6, Steps: 10 | Train Loss: 0.784 Vali Loss: 2.978 Vali Acc: 0.241 Test Loss: 2.978 Test Acc: 0.241
Validation loss decreased (-0.237617 --> -0.241147).  Saving model ...
Epoch: 7 cost time: 0.5838725566864014
Epoch: 7, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.039 Vali Acc: 0.266 Test Loss: 3.039 Test Acc: 0.266
Validation loss decreased (-0.241147 --> -0.265852).  Saving model ...
Epoch: 8 cost time: 0.5836260318756104
Epoch: 8, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.088 Vali Acc: 0.276 Test Loss: 3.088 Test Acc: 0.276
Validation loss decreased (-0.265852 --> -0.276440).  Saving model ...
Epoch: 9 cost time: 0.5912308692932129
Epoch: 9, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.230 Vali Acc: 0.276 Test Loss: 3.230 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6100573539733887
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.254 Vali Acc: 0.289 Test Loss: 3.254 Test Acc: 0.289
Validation loss decreased (-0.276440 --> -0.289379).  Saving model ...
Epoch: 11 cost time: 0.7809937000274658
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.329 Vali Acc: 0.291 Test Loss: 3.329 Test Acc: 0.291
Validation loss decreased (-0.289379 --> -0.290555).  Saving model ...
Epoch: 12 cost time: 0.6814718246459961
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.367 Vali Acc: 0.293 Test Loss: 3.367 Test Acc: 0.293
Validation loss decreased (-0.290555 --> -0.292908).  Saving model ...
Epoch: 13 cost time: 0.7266311645507812
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.418 Vali Acc: 0.286 Test Loss: 3.418 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.684412956237793
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.433 Vali Acc: 0.286 Test Loss: 3.433 Test Acc: 0.286
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7447769641876221
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.447 Vali Acc: 0.293 Test Loss: 3.447 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.761260986328125
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.469 Vali Acc: 0.292 Test Loss: 3.469 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.755563497543335
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.497 Vali Acc: 0.284 Test Loss: 3.497 Test Acc: 0.284
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6383674144744873
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.511 Vali Acc: 0.289 Test Loss: 3.511 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7120606899261475
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.535 Vali Acc: 0.287 Test Loss: 3.535 Test Acc: 0.287
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7560393810272217
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.551 Vali Acc: 0.287 Test Loss: 3.551 Test Acc: 0.287
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8005988597869873
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.562 Vali Acc: 0.288 Test Loss: 3.562 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7874197959899902
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.581 Vali Acc: 0.288 Test Loss: 3.581 Test Acc: 0.288
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 1066422
model size : 6.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2112433910369873
Epoch: 1, Steps: 10 | Train Loss: 3.413 Vali Loss: 3.344 Vali Acc: 0.049 Test Loss: 3.344 Test Acc: 0.049
Validation loss decreased (inf --> -0.049378).  Saving model ...
Epoch: 2 cost time: 0.7335245609283447
Epoch: 2, Steps: 10 | Train Loss: 2.879 Vali Loss: 3.329 Vali Acc: 0.108 Test Loss: 3.329 Test Acc: 0.108
Validation loss decreased (-0.049378 --> -0.108202).  Saving model ...
Epoch: 3 cost time: 0.6762673854827881
Epoch: 3, Steps: 10 | Train Loss: 2.094 Vali Loss: 3.202 Vali Acc: 0.191 Test Loss: 3.202 Test Acc: 0.191
Validation loss decreased (-0.108202 --> -0.190556).  Saving model ...
Epoch: 4 cost time: 0.643388032913208
Epoch: 4, Steps: 10 | Train Loss: 1.344 Vali Loss: 3.147 Vali Acc: 0.262 Test Loss: 3.147 Test Acc: 0.262
Validation loss decreased (-0.190556 --> -0.262321).  Saving model ...
Epoch: 5 cost time: 0.6540720462799072
Epoch: 5, Steps: 10 | Train Loss: 0.821 Vali Loss: 3.262 Vali Acc: 0.273 Test Loss: 3.262 Test Acc: 0.273
Validation loss decreased (-0.262321 --> -0.272909).  Saving model ...
Epoch: 6 cost time: 0.7237918376922607
Epoch: 6, Steps: 10 | Train Loss: 0.431 Vali Loss: 3.343 Vali Acc: 0.320 Test Loss: 3.343 Test Acc: 0.320
Validation loss decreased (-0.272909 --> -0.319967).  Saving model ...
Epoch: 7 cost time: 0.6726758480072021
Epoch: 7, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.421 Vali Acc: 0.314 Test Loss: 3.421 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6795201301574707
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.570 Vali Acc: 0.319 Test Loss: 3.570 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.7857141494750977
Epoch: 9, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.702 Vali Acc: 0.328 Test Loss: 3.702 Test Acc: 0.328
Validation loss decreased (-0.319967 --> -0.328198).  Saving model ...
Epoch: 10 cost time: 0.6736819744110107
Epoch: 10, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.713 Vali Acc: 0.329 Test Loss: 3.713 Test Acc: 0.329
Validation loss decreased (-0.328198 --> -0.329375).  Saving model ...
Epoch: 11 cost time: 0.6075282096862793
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.779 Vali Acc: 0.338 Test Loss: 3.779 Test Acc: 0.338
Validation loss decreased (-0.329375 --> -0.337609).  Saving model ...
Epoch: 12 cost time: 0.7833259105682373
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.875 Vali Acc: 0.329 Test Loss: 3.875 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8657426834106445
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.910 Vali Acc: 0.332 Test Loss: 3.910 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.8371138572692871
Epoch: 14, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.952 Vali Acc: 0.339 Test Loss: 3.952 Test Acc: 0.339
Validation loss decreased (-0.337609 --> -0.338784).  Saving model ...
Epoch: 15 cost time: 0.7757501602172852
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.955 Vali Acc: 0.334 Test Loss: 3.955 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6947813034057617
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.970 Vali Acc: 0.332 Test Loss: 3.970 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7278087139129639
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.994 Vali Acc: 0.339 Test Loss: 3.994 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.74471116065979
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.006 Vali Acc: 0.336 Test Loss: 4.006 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7228100299835205
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.033 Vali Acc: 0.339 Test Loss: 4.033 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.683422327041626
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.081 Vali Acc: 0.339 Test Loss: 4.081 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7983059883117676
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.046 Vali Acc: 0.338 Test Loss: 4.046 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.789527416229248
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.067 Vali Acc: 0.336 Test Loss: 4.067 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7890620231628418
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.104 Vali Acc: 0.338 Test Loss: 4.104 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8289082050323486
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.129 Vali Acc: 0.336 Test Loss: 4.129 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 804278
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.165764570236206
Epoch: 1, Steps: 10 | Train Loss: 3.403 Vali Loss: 3.324 Vali Acc: 0.042 Test Loss: 3.324 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.6236746311187744
Epoch: 2, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.307 Vali Acc: 0.113 Test Loss: 3.307 Test Acc: 0.113
Validation loss decreased (-0.042320 --> -0.112908).  Saving model ...
Epoch: 3 cost time: 0.6537754535675049
Epoch: 3, Steps: 10 | Train Loss: 2.118 Vali Loss: 3.185 Vali Acc: 0.186 Test Loss: 3.185 Test Acc: 0.186
Validation loss decreased (-0.112908 --> -0.185851).  Saving model ...
Epoch: 4 cost time: 0.6683664321899414
Epoch: 4, Steps: 10 | Train Loss: 1.376 Vali Loss: 3.091 Vali Acc: 0.254 Test Loss: 3.091 Test Acc: 0.254
Validation loss decreased (-0.185851 --> -0.254087).  Saving model ...
Epoch: 5 cost time: 0.6943302154541016
Epoch: 5, Steps: 10 | Train Loss: 0.844 Vali Loss: 3.173 Vali Acc: 0.272 Test Loss: 3.173 Test Acc: 0.272
Validation loss decreased (-0.254087 --> -0.271733).  Saving model ...
Epoch: 6 cost time: 0.7028491497039795
Epoch: 6, Steps: 10 | Train Loss: 0.438 Vali Loss: 3.247 Vali Acc: 0.299 Test Loss: 3.247 Test Acc: 0.299
Validation loss decreased (-0.271733 --> -0.298791).  Saving model ...
Epoch: 7 cost time: 0.7562055587768555
Epoch: 7, Steps: 10 | Train Loss: 0.232 Vali Loss: 3.294 Vali Acc: 0.322 Test Loss: 3.294 Test Acc: 0.322
Validation loss decreased (-0.298791 --> -0.322320).  Saving model ...
Epoch: 8 cost time: 0.6579501628875732
Epoch: 8, Steps: 10 | Train Loss: 0.102 Vali Loss: 3.441 Vali Acc: 0.324 Test Loss: 3.441 Test Acc: 0.324
Validation loss decreased (-0.322320 --> -0.323495).  Saving model ...
Epoch: 9 cost time: 0.7101738452911377
Epoch: 9, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.566 Vali Acc: 0.327 Test Loss: 3.566 Test Acc: 0.327
Validation loss decreased (-0.323495 --> -0.327023).  Saving model ...
Epoch: 10 cost time: 0.7472865581512451
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.545 Vali Acc: 0.333 Test Loss: 3.545 Test Acc: 0.333
Validation loss decreased (-0.327023 --> -0.332906).  Saving model ...
Epoch: 11 cost time: 0.7676835060119629
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.626 Vali Acc: 0.328 Test Loss: 3.626 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6678586006164551
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.703 Vali Acc: 0.327 Test Loss: 3.703 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.668358564376831
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.713 Vali Acc: 0.328 Test Loss: 3.713 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6509222984313965
Epoch: 14, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.745 Vali Acc: 0.335 Test Loss: 3.745 Test Acc: 0.335
Validation loss decreased (-0.332906 --> -0.335257).  Saving model ...
Epoch: 15 cost time: 0.6283290386199951
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.785 Vali Acc: 0.331 Test Loss: 3.785 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6506474018096924
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.801 Vali Acc: 0.331 Test Loss: 3.801 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6518235206604004
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.829 Vali Acc: 0.335 Test Loss: 3.829 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7145919799804688
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.840 Vali Acc: 0.340 Test Loss: 3.840 Test Acc: 0.340
Validation loss decreased (-0.335257 --> -0.339962).  Saving model ...
Epoch: 19 cost time: 0.708127498626709
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.861 Vali Acc: 0.339 Test Loss: 3.861 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7122049331665039
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.910 Vali Acc: 0.331 Test Loss: 3.910 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.790611982345581
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.898 Vali Acc: 0.332 Test Loss: 3.898 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7026779651641846
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.901 Vali Acc: 0.336 Test Loss: 3.901 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6977269649505615
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.921 Vali Acc: 0.336 Test Loss: 3.921 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5972514152526855
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.931 Vali Acc: 0.338 Test Loss: 3.931 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6053750514984131
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.941 Vali Acc: 0.341 Test Loss: 3.941 Test Acc: 0.341
Validation loss decreased (-0.339962 --> -0.341137).  Saving model ...
Epoch: 26 cost time: 0.6000843048095703
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.962 Vali Acc: 0.340 Test Loss: 3.962 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6281576156616211
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.968 Vali Acc: 0.339 Test Loss: 3.968 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6103537082672119
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.977 Vali Acc: 0.338 Test Loss: 3.977 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5890083312988281
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.004 Vali Acc: 0.338 Test Loss: 4.004 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6992013454437256
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.023 Vali Acc: 0.338 Test Loss: 4.023 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.6659808158874512
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.031 Vali Acc: 0.338 Test Loss: 4.031 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7052614688873291
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.049 Vali Acc: 0.336 Test Loss: 4.049 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6802172660827637
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.060 Vali Acc: 0.336 Test Loss: 4.060 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.6821937561035156
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.068 Vali Acc: 0.334 Test Loss: 4.068 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.6418683528900146
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.077 Vali Acc: 0.335 Test Loss: 4.077 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 804278
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.0859451293945312
Epoch: 1, Steps: 10 | Train Loss: 3.361 Vali Loss: 3.303 Vali Acc: 0.044 Test Loss: 3.303 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.6017999649047852
Epoch: 2, Steps: 10 | Train Loss: 2.885 Vali Loss: 3.283 Vali Acc: 0.114 Test Loss: 3.283 Test Acc: 0.114
Validation loss decreased (-0.043496 --> -0.114085).  Saving model ...
Epoch: 3 cost time: 0.6863374710083008
Epoch: 3, Steps: 10 | Train Loss: 2.211 Vali Loss: 3.172 Vali Acc: 0.174 Test Loss: 3.172 Test Acc: 0.174
Validation loss decreased (-0.114085 --> -0.174086).  Saving model ...
Epoch: 4 cost time: 0.6879096031188965
Epoch: 4, Steps: 10 | Train Loss: 1.488 Vali Loss: 3.038 Vali Acc: 0.242 Test Loss: 3.038 Test Acc: 0.242
Validation loss decreased (-0.174086 --> -0.242323).  Saving model ...
Epoch: 5 cost time: 0.6782314777374268
Epoch: 5, Steps: 10 | Train Loss: 0.905 Vali Loss: 3.060 Vali Acc: 0.255 Test Loss: 3.060 Test Acc: 0.255
Validation loss decreased (-0.242323 --> -0.255264).  Saving model ...
Epoch: 6 cost time: 0.6096138954162598
Epoch: 6, Steps: 10 | Train Loss: 0.504 Vali Loss: 3.126 Vali Acc: 0.287 Test Loss: 3.126 Test Acc: 0.287
Validation loss decreased (-0.255264 --> -0.287028).  Saving model ...
Epoch: 7 cost time: 0.6763842105865479
Epoch: 7, Steps: 10 | Train Loss: 0.250 Vali Loss: 3.156 Vali Acc: 0.320 Test Loss: 3.156 Test Acc: 0.320
Validation loss decreased (-0.287028 --> -0.319968).  Saving model ...
Epoch: 8 cost time: 0.7208549976348877
Epoch: 8, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.299 Vali Acc: 0.313 Test Loss: 3.299 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7336843013763428
Epoch: 9, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.443 Vali Acc: 0.308 Test Loss: 3.443 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6909236907958984
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.406 Vali Acc: 0.327 Test Loss: 3.406 Test Acc: 0.327
Validation loss decreased (-0.319968 --> -0.327025).  Saving model ...
Epoch: 11 cost time: 0.6838521957397461
Epoch: 11, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.471 Vali Acc: 0.328 Test Loss: 3.471 Test Acc: 0.328
Validation loss decreased (-0.327025 --> -0.328201).  Saving model ...
Epoch: 12 cost time: 0.7663974761962891
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.584 Vali Acc: 0.327 Test Loss: 3.584 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6993680000305176
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.565 Vali Acc: 0.328 Test Loss: 3.565 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7495150566101074
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.557 Vali Acc: 0.326 Test Loss: 3.557 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.8013608455657959
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.585 Vali Acc: 0.327 Test Loss: 3.585 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7817928791046143
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.617 Vali Acc: 0.328 Test Loss: 3.617 Test Acc: 0.328
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7864925861358643
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.637 Vali Acc: 0.331 Test Loss: 3.637 Test Acc: 0.331
Validation loss decreased (-0.328201 --> -0.330552).  Saving model ...
Epoch: 18 cost time: 0.7978789806365967
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.653 Vali Acc: 0.331 Test Loss: 3.653 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8379566669464111
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.665 Vali Acc: 0.331 Test Loss: 3.665 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7993748188018799
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.686 Vali Acc: 0.329 Test Loss: 3.686 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.776512861251831
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.704 Vali Acc: 0.327 Test Loss: 3.704 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7976703643798828
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.719 Vali Acc: 0.325 Test Loss: 3.719 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7267107963562012
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.735 Vali Acc: 0.324 Test Loss: 3.735 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6488175392150879
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.744 Vali Acc: 0.326 Test Loss: 3.744 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.6982183456420898
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.759 Vali Acc: 0.325 Test Loss: 3.759 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7103393077850342
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.776 Vali Acc: 0.327 Test Loss: 3.776 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.6841597557067871
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.783 Vali Acc: 0.328 Test Loss: 3.783 Test Acc: 0.328
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 804278
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3048348426818848
Epoch: 1, Steps: 10 | Train Loss: 3.303 Vali Loss: 3.269 Vali Acc: 0.040 Test Loss: 3.269 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.608100414276123
Epoch: 2, Steps: 10 | Train Loss: 2.957 Vali Loss: 3.258 Vali Acc: 0.088 Test Loss: 3.258 Test Acc: 0.088
Validation loss decreased (-0.039967 --> -0.088203).  Saving model ...
Epoch: 3 cost time: 0.6630816459655762
Epoch: 3, Steps: 10 | Train Loss: 2.437 Vali Loss: 3.194 Vali Acc: 0.141 Test Loss: 3.194 Test Acc: 0.141
Validation loss decreased (-0.088203 --> -0.141145).  Saving model ...
Epoch: 4 cost time: 0.5636231899261475
Epoch: 4, Steps: 10 | Train Loss: 1.822 Vali Loss: 3.035 Vali Acc: 0.208 Test Loss: 3.035 Test Acc: 0.208
Validation loss decreased (-0.141145 --> -0.208205).  Saving model ...
Epoch: 5 cost time: 0.561161994934082
Epoch: 5, Steps: 10 | Train Loss: 1.248 Vali Loss: 2.982 Vali Acc: 0.234 Test Loss: 2.982 Test Acc: 0.234
Validation loss decreased (-0.208205 --> -0.234088).  Saving model ...
Epoch: 6 cost time: 0.5900468826293945
Epoch: 6, Steps: 10 | Train Loss: 0.783 Vali Loss: 3.024 Vali Acc: 0.238 Test Loss: 3.024 Test Acc: 0.238
Validation loss decreased (-0.234088 --> -0.237617).  Saving model ...
Epoch: 7 cost time: 0.5617516040802002
Epoch: 7, Steps: 10 | Train Loss: 0.445 Vali Loss: 2.998 Vali Acc: 0.266 Test Loss: 2.998 Test Acc: 0.266
Validation loss decreased (-0.237617 --> -0.265852).  Saving model ...
Epoch: 8 cost time: 0.58577561378479
Epoch: 8, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.121 Vali Acc: 0.274 Test Loss: 3.121 Test Acc: 0.274
Validation loss decreased (-0.265852 --> -0.274086).  Saving model ...
Epoch: 9 cost time: 0.6629788875579834
Epoch: 9, Steps: 10 | Train Loss: 0.092 Vali Loss: 3.270 Vali Acc: 0.268 Test Loss: 3.270 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6544198989868164
Epoch: 10, Steps: 10 | Train Loss: 0.045 Vali Loss: 3.280 Vali Acc: 0.274 Test Loss: 3.280 Test Acc: 0.274
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6776325702667236
Epoch: 11, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.297 Vali Acc: 0.285 Test Loss: 3.297 Test Acc: 0.285
Validation loss decreased (-0.274086 --> -0.284673).  Saving model ...
Epoch: 12 cost time: 0.5544726848602295
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.396 Vali Acc: 0.287 Test Loss: 3.396 Test Acc: 0.287
Validation loss decreased (-0.284673 --> -0.287025).  Saving model ...
Epoch: 13 cost time: 0.6724903583526611
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.421 Vali Acc: 0.281 Test Loss: 3.421 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6771478652954102
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.423 Vali Acc: 0.284 Test Loss: 3.423 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6630120277404785
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.446 Vali Acc: 0.280 Test Loss: 3.446 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6228187084197998
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.479 Vali Acc: 0.278 Test Loss: 3.479 Test Acc: 0.278
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6186010837554932
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.501 Vali Acc: 0.282 Test Loss: 3.501 Test Acc: 0.282
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.6353144645690918
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.521 Vali Acc: 0.281 Test Loss: 3.521 Test Acc: 0.281
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5556542873382568
Epoch: 19, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.541 Vali Acc: 0.281 Test Loss: 3.541 Test Acc: 0.281
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.639411211013794
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.570 Vali Acc: 0.281 Test Loss: 3.570 Test Acc: 0.281
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6272671222686768
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.589 Vali Acc: 0.280 Test Loss: 3.589 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7119748592376709
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.611 Vali Acc: 0.280 Test Loss: 3.611 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.28705882352941176
model parameter : 804278
model size : 5.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4005043506622314
Epoch: 1, Steps: 10 | Train Loss: 3.468 Vali Loss: 3.277 Vali Acc: 0.064 Test Loss: 3.277 Test Acc: 0.064
Validation loss decreased (inf --> -0.063497).  Saving model ...
Epoch: 2 cost time: 0.6910343170166016
Epoch: 2, Steps: 10 | Train Loss: 2.848 Vali Loss: 3.275 Vali Acc: 0.134 Test Loss: 3.275 Test Acc: 0.134
Validation loss decreased (-0.063497 --> -0.134085).  Saving model ...
Epoch: 3 cost time: 0.597348690032959
Epoch: 3, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.119 Vali Acc: 0.184 Test Loss: 3.119 Test Acc: 0.184
Validation loss decreased (-0.134085 --> -0.183498).  Saving model ...
Epoch: 4 cost time: 0.6390929222106934
Epoch: 4, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.121 Vali Acc: 0.245 Test Loss: 3.121 Test Acc: 0.245
Validation loss decreased (-0.183498 --> -0.244675).  Saving model ...
Epoch: 5 cost time: 0.5309348106384277
Epoch: 5, Steps: 10 | Train Loss: 0.809 Vali Loss: 3.131 Vali Acc: 0.273 Test Loss: 3.131 Test Acc: 0.273
Validation loss decreased (-0.244675 --> -0.272910).  Saving model ...
Epoch: 6 cost time: 0.5758786201477051
Epoch: 6, Steps: 10 | Train Loss: 0.437 Vali Loss: 3.305 Vali Acc: 0.311 Test Loss: 3.305 Test Acc: 0.311
Validation loss decreased (-0.272910 --> -0.310555).  Saving model ...
Epoch: 7 cost time: 0.5849747657775879
Epoch: 7, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.348 Vali Acc: 0.326 Test Loss: 3.348 Test Acc: 0.326
Validation loss decreased (-0.310555 --> -0.325849).  Saving model ...
Epoch: 8 cost time: 0.6283090114593506
Epoch: 8, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.463 Vali Acc: 0.334 Test Loss: 3.463 Test Acc: 0.334
Validation loss decreased (-0.325849 --> -0.334083).  Saving model ...
Epoch: 9 cost time: 0.6857883930206299
Epoch: 9, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.622 Vali Acc: 0.320 Test Loss: 3.622 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6579890251159668
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.648 Vali Acc: 0.336 Test Loss: 3.648 Test Acc: 0.336
Validation loss decreased (-0.334083 --> -0.336434).  Saving model ...
Epoch: 11 cost time: 0.6239397525787354
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.756 Vali Acc: 0.338 Test Loss: 3.756 Test Acc: 0.338
Validation loss decreased (-0.336434 --> -0.337610).  Saving model ...
Epoch: 12 cost time: 0.6687295436859131
Epoch: 12, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.809 Vali Acc: 0.336 Test Loss: 3.809 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6928789615631104
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.839 Vali Acc: 0.340 Test Loss: 3.839 Test Acc: 0.340
Validation loss decreased (-0.337610 --> -0.339962).  Saving model ...
Epoch: 14 cost time: 0.7377846240997314
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.840 Vali Acc: 0.341 Test Loss: 3.840 Test Acc: 0.341
Validation loss decreased (-0.339962 --> -0.341138).  Saving model ...
Epoch: 15 cost time: 0.6348459720611572
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.869 Vali Acc: 0.341 Test Loss: 3.869 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6075122356414795
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.875 Vali Acc: 0.341 Test Loss: 3.875 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5862512588500977
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.894 Vali Acc: 0.341 Test Loss: 3.894 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6582005023956299
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.922 Vali Acc: 0.344 Test Loss: 3.922 Test Acc: 0.344
Validation loss decreased (-0.341138 --> -0.343490).  Saving model ...
Epoch: 19 cost time: 0.5884392261505127
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.945 Vali Acc: 0.340 Test Loss: 3.945 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6952967643737793
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.969 Vali Acc: 0.340 Test Loss: 3.969 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6567356586456299
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.967 Vali Acc: 0.341 Test Loss: 3.967 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6699602603912354
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.985 Vali Acc: 0.345 Test Loss: 3.985 Test Acc: 0.345
Validation loss decreased (-0.343490 --> -0.344666).  Saving model ...
Epoch: 23 cost time: 0.6719558238983154
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.009 Vali Acc: 0.344 Test Loss: 4.009 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7101566791534424
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.024 Vali Acc: 0.347 Test Loss: 4.024 Test Acc: 0.347
Validation loss decreased (-0.344666 --> -0.347019).  Saving model ...
Epoch: 25 cost time: 0.7275331020355225
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.045 Vali Acc: 0.345 Test Loss: 4.045 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7295780181884766
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.064 Vali Acc: 0.345 Test Loss: 4.064 Test Acc: 0.345
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7247834205627441
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.070 Vali Acc: 0.345 Test Loss: 4.070 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6872258186340332
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.087 Vali Acc: 0.344 Test Loss: 4.087 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6989569664001465
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.104 Vali Acc: 0.342 Test Loss: 4.104 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6816208362579346
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.118 Vali Acc: 0.342 Test Loss: 4.118 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6831228733062744
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.128 Vali Acc: 0.339 Test Loss: 4.128 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.7071988582611084
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.133 Vali Acc: 0.342 Test Loss: 4.133 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.694446325302124
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.140 Vali Acc: 0.342 Test Loss: 4.140 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.746265172958374
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.148 Vali Acc: 0.345 Test Loss: 4.148 Test Acc: 0.345
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 673206
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.400053024291992
Epoch: 1, Steps: 10 | Train Loss: 3.475 Vali Loss: 3.276 Vali Acc: 0.066 Test Loss: 3.276 Test Acc: 0.066
Validation loss decreased (inf --> -0.065850).  Saving model ...
Epoch: 2 cost time: 0.624427318572998
Epoch: 2, Steps: 10 | Train Loss: 2.861 Vali Loss: 3.268 Vali Acc: 0.139 Test Loss: 3.268 Test Acc: 0.139
Validation loss decreased (-0.065850 --> -0.138791).  Saving model ...
Epoch: 3 cost time: 0.5517663955688477
Epoch: 3, Steps: 10 | Train Loss: 2.078 Vali Loss: 3.116 Vali Acc: 0.189 Test Loss: 3.116 Test Acc: 0.189
Validation loss decreased (-0.138791 --> -0.189381).  Saving model ...
Epoch: 4 cost time: 0.6033029556274414
Epoch: 4, Steps: 10 | Train Loss: 1.406 Vali Loss: 3.095 Vali Acc: 0.240 Test Loss: 3.095 Test Acc: 0.240
Validation loss decreased (-0.189381 --> -0.239969).  Saving model ...
Epoch: 5 cost time: 0.5558784008026123
Epoch: 5, Steps: 10 | Train Loss: 0.852 Vali Loss: 3.091 Vali Acc: 0.282 Test Loss: 3.091 Test Acc: 0.282
Validation loss decreased (-0.239969 --> -0.282322).  Saving model ...
Epoch: 6 cost time: 0.6023948192596436
Epoch: 6, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.223 Vali Acc: 0.308 Test Loss: 3.223 Test Acc: 0.308
Validation loss decreased (-0.282322 --> -0.308203).  Saving model ...
Epoch: 7 cost time: 0.6278054714202881
Epoch: 7, Steps: 10 | Train Loss: 0.240 Vali Loss: 3.259 Vali Acc: 0.318 Test Loss: 3.259 Test Acc: 0.318
Validation loss decreased (-0.308203 --> -0.317614).  Saving model ...
Epoch: 8 cost time: 0.7457454204559326
Epoch: 8, Steps: 10 | Train Loss: 0.121 Vali Loss: 3.405 Vali Acc: 0.329 Test Loss: 3.405 Test Acc: 0.329
Validation loss decreased (-0.317614 --> -0.329378).  Saving model ...
Epoch: 9 cost time: 0.6835887432098389
Epoch: 9, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.490 Vali Acc: 0.320 Test Loss: 3.490 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6259951591491699
Epoch: 10, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.542 Vali Acc: 0.322 Test Loss: 3.542 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6142578125
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.620 Vali Acc: 0.331 Test Loss: 3.620 Test Acc: 0.331
Validation loss decreased (-0.329378 --> -0.330552).  Saving model ...
Epoch: 12 cost time: 0.6330184936523438
Epoch: 12, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.668 Vali Acc: 0.311 Test Loss: 3.668 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6271276473999023
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.680 Vali Acc: 0.324 Test Loss: 3.680 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.6567347049713135
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.717 Vali Acc: 0.332 Test Loss: 3.717 Test Acc: 0.332
Validation loss decreased (-0.330552 --> -0.331728).  Saving model ...
Epoch: 15 cost time: 0.6144266128540039
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.746 Vali Acc: 0.331 Test Loss: 3.746 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6608092784881592
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.744 Vali Acc: 0.328 Test Loss: 3.744 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6427478790283203
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.758 Vali Acc: 0.332 Test Loss: 3.758 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6134054660797119
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.783 Vali Acc: 0.328 Test Loss: 3.783 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7240612506866455
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.796 Vali Acc: 0.329 Test Loss: 3.796 Test Acc: 0.329
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.6028749942779541
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.817 Vali Acc: 0.334 Test Loss: 3.817 Test Acc: 0.334
Validation loss decreased (-0.331728 --> -0.334079).  Saving model ...
Epoch: 21 cost time: 0.6178503036499023
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.828 Vali Acc: 0.333 Test Loss: 3.828 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6794483661651611
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.849 Vali Acc: 0.333 Test Loss: 3.849 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6306350231170654
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.868 Vali Acc: 0.329 Test Loss: 3.868 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6263279914855957
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.879 Vali Acc: 0.329 Test Loss: 3.879 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7022209167480469
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.892 Vali Acc: 0.332 Test Loss: 3.892 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7705473899841309
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.913 Vali Acc: 0.333 Test Loss: 3.913 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7235033512115479
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.927 Vali Acc: 0.331 Test Loss: 3.927 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7625925540924072
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.938 Vali Acc: 0.332 Test Loss: 3.938 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.830568790435791
Epoch: 29, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.954 Vali Acc: 0.333 Test Loss: 3.954 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7649509906768799
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.969 Vali Acc: 0.335 Test Loss: 3.969 Test Acc: 0.335
Validation loss decreased (-0.334079 --> -0.335254).  Saving model ...
Epoch: 31 cost time: 0.7046654224395752
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.983 Vali Acc: 0.333 Test Loss: 3.983 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6936311721801758
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.990 Vali Acc: 0.333 Test Loss: 3.990 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7783482074737549
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.000 Vali Acc: 0.331 Test Loss: 4.000 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.8055448532104492
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.007 Vali Acc: 0.331 Test Loss: 4.007 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6791625022888184
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.021 Vali Acc: 0.334 Test Loss: 4.021 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.677886962890625
Epoch: 36, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.027 Vali Acc: 0.335 Test Loss: 4.027 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6470115184783936
Epoch: 37, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.039 Vali Acc: 0.333 Test Loss: 4.039 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.6832051277160645
Epoch: 38, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.051 Vali Acc: 0.336 Test Loss: 4.051 Test Acc: 0.336
Validation loss decreased (-0.335254 --> -0.336430).  Saving model ...
Epoch: 39 cost time: 0.7021784782409668
Epoch: 39, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.063 Vali Acc: 0.333 Test Loss: 4.063 Test Acc: 0.333
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7312541007995605
Epoch: 40, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.072 Vali Acc: 0.334 Test Loss: 4.072 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7508265972137451
Epoch: 41, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.074 Vali Acc: 0.339 Test Loss: 4.074 Test Acc: 0.339
Validation loss decreased (-0.336430 --> -0.338783).  Saving model ...
Epoch: 42 cost time: 0.7740006446838379
Epoch: 42, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.088 Vali Acc: 0.338 Test Loss: 4.088 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7363796234130859
Epoch: 43, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.098 Vali Acc: 0.339 Test Loss: 4.098 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.6913561820983887
Epoch: 44, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.109 Vali Acc: 0.336 Test Loss: 4.109 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6855504512786865
Epoch: 45, Steps: 10 | Train Loss: 0.001 Vali Loss: 4.126 Vali Acc: 0.336 Test Loss: 4.126 Test Acc: 0.336
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6931259632110596
Epoch: 46, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.137 Vali Acc: 0.339 Test Loss: 4.137 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6113078594207764
Epoch: 47, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.146 Vali Acc: 0.339 Test Loss: 4.146 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.7691478729248047
Epoch: 48, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.157 Vali Acc: 0.339 Test Loss: 4.157 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.6479551792144775
Epoch: 49, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.159 Vali Acc: 0.338 Test Loss: 4.159 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6773252487182617
Epoch: 50, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.165 Vali Acc: 0.335 Test Loss: 4.165 Test Acc: 0.335
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6746976375579834
Epoch: 51, Steps: 10 | Train Loss: 0.000 Vali Loss: 4.174 Vali Acc: 0.331 Test Loss: 4.174 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 673206
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2636146545410156
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.263 Vali Acc: 0.060 Test Loss: 3.263 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.6981654167175293
Epoch: 2, Steps: 10 | Train Loss: 2.893 Vali Loss: 3.245 Vali Acc: 0.127 Test Loss: 3.245 Test Acc: 0.127
Validation loss decreased (-0.059967 --> -0.127026).  Saving model ...
Epoch: 3 cost time: 0.7723197937011719
Epoch: 3, Steps: 10 | Train Loss: 2.162 Vali Loss: 3.106 Vali Acc: 0.178 Test Loss: 3.106 Test Acc: 0.178
Validation loss decreased (-0.127026 --> -0.177616).  Saving model ...
Epoch: 4 cost time: 0.7233362197875977
Epoch: 4, Steps: 10 | Train Loss: 1.500 Vali Loss: 3.039 Vali Acc: 0.232 Test Loss: 3.039 Test Acc: 0.232
Validation loss decreased (-0.177616 --> -0.231734).  Saving model ...
Epoch: 5 cost time: 0.6689906120300293
Epoch: 5, Steps: 10 | Train Loss: 0.948 Vali Loss: 2.996 Vali Acc: 0.280 Test Loss: 2.996 Test Acc: 0.280
Validation loss decreased (-0.231734 --> -0.279970).  Saving model ...
Epoch: 6 cost time: 0.6545360088348389
Epoch: 6, Steps: 10 | Train Loss: 0.533 Vali Loss: 3.104 Vali Acc: 0.299 Test Loss: 3.104 Test Acc: 0.299
Validation loss decreased (-0.279970 --> -0.298792).  Saving model ...
Epoch: 7 cost time: 0.683037519454956
Epoch: 7, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.110 Vali Acc: 0.325 Test Loss: 3.110 Test Acc: 0.325
Validation loss decreased (-0.298792 --> -0.324675).  Saving model ...
Epoch: 8 cost time: 0.7626123428344727
Epoch: 8, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.280 Vali Acc: 0.324 Test Loss: 3.280 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7160601615905762
Epoch: 9, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.313 Vali Acc: 0.324 Test Loss: 3.313 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.7227425575256348
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.389 Vali Acc: 0.325 Test Loss: 3.389 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6950421333312988
Epoch: 11, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.454 Vali Acc: 0.328 Test Loss: 3.454 Test Acc: 0.328
Validation loss decreased (-0.324675 --> -0.328201).  Saving model ...
Epoch: 12 cost time: 0.7612826824188232
Epoch: 12, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.476 Vali Acc: 0.324 Test Loss: 3.476 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7888729572296143
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.503 Vali Acc: 0.334 Test Loss: 3.503 Test Acc: 0.334
Validation loss decreased (-0.328201 --> -0.334083).  Saving model ...
Epoch: 14 cost time: 0.7070262432098389
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.538 Vali Acc: 0.338 Test Loss: 3.538 Test Acc: 0.338
Validation loss decreased (-0.334083 --> -0.337612).  Saving model ...
Epoch: 15 cost time: 0.7114465236663818
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.572 Vali Acc: 0.331 Test Loss: 3.572 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6750631332397461
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.578 Vali Acc: 0.331 Test Loss: 3.578 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7312703132629395
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.585 Vali Acc: 0.334 Test Loss: 3.585 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6790177822113037
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.598 Vali Acc: 0.339 Test Loss: 3.598 Test Acc: 0.339
Validation loss decreased (-0.337612 --> -0.338788).  Saving model ...
Epoch: 19 cost time: 0.7272109985351562
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.615 Vali Acc: 0.339 Test Loss: 3.615 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8195288181304932
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.636 Vali Acc: 0.338 Test Loss: 3.636 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7017176151275635
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.649 Vali Acc: 0.335 Test Loss: 3.649 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7416083812713623
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.670 Vali Acc: 0.335 Test Loss: 3.670 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.753403902053833
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.702 Vali Acc: 0.331 Test Loss: 3.702 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7772989273071289
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.702 Vali Acc: 0.331 Test Loss: 3.702 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.8718094825744629
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.707 Vali Acc: 0.335 Test Loss: 3.707 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6891021728515625
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.722 Vali Acc: 0.336 Test Loss: 3.722 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6413404941558838
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.731 Vali Acc: 0.338 Test Loss: 3.731 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7600243091583252
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.744 Vali Acc: 0.338 Test Loss: 3.744 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 673206
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3830273151397705
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.252 Vali Acc: 0.049 Test Loss: 3.252 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.7466380596160889
Epoch: 2, Steps: 10 | Train Loss: 2.949 Vali Loss: 3.239 Vali Acc: 0.125 Test Loss: 3.239 Test Acc: 0.125
Validation loss decreased (-0.049379 --> -0.124673).  Saving model ...
Epoch: 3 cost time: 0.7408220767974854
Epoch: 3, Steps: 10 | Train Loss: 2.381 Vali Loss: 3.143 Vali Acc: 0.160 Test Loss: 3.143 Test Acc: 0.160
Validation loss decreased (-0.124673 --> -0.159969).  Saving model ...
Epoch: 4 cost time: 0.7605750560760498
Epoch: 4, Steps: 10 | Train Loss: 1.826 Vali Loss: 3.054 Vali Acc: 0.192 Test Loss: 3.054 Test Acc: 0.192
Validation loss decreased (-0.159969 --> -0.191734).  Saving model ...
Epoch: 5 cost time: 0.7104651927947998
Epoch: 5, Steps: 10 | Train Loss: 1.279 Vali Loss: 2.957 Vali Acc: 0.235 Test Loss: 2.957 Test Acc: 0.235
Validation loss decreased (-0.191734 --> -0.235265).  Saving model ...
Epoch: 6 cost time: 0.6503582000732422
Epoch: 6, Steps: 10 | Train Loss: 0.804 Vali Loss: 3.000 Vali Acc: 0.245 Test Loss: 3.000 Test Acc: 0.245
Validation loss decreased (-0.235265 --> -0.244676).  Saving model ...
Epoch: 7 cost time: 0.6657311916351318
Epoch: 7, Steps: 10 | Train Loss: 0.452 Vali Loss: 3.012 Vali Acc: 0.271 Test Loss: 3.012 Test Acc: 0.271
Validation loss decreased (-0.244676 --> -0.270558).  Saving model ...
Epoch: 8 cost time: 0.6548600196838379
Epoch: 8, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.095 Vali Acc: 0.285 Test Loss: 3.095 Test Acc: 0.285
Validation loss decreased (-0.270558 --> -0.284675).  Saving model ...
Epoch: 9 cost time: 0.6354029178619385
Epoch: 9, Steps: 10 | Train Loss: 0.098 Vali Loss: 3.184 Vali Acc: 0.285 Test Loss: 3.184 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7192647457122803
Epoch: 10, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.268 Vali Acc: 0.286 Test Loss: 3.268 Test Acc: 0.286
Validation loss decreased (-0.284675 --> -0.285850).  Saving model ...
Epoch: 11 cost time: 0.7326862812042236
Epoch: 11, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.332 Vali Acc: 0.292 Test Loss: 3.332 Test Acc: 0.292
Validation loss decreased (-0.285850 --> -0.291731).  Saving model ...
Epoch: 12 cost time: 0.7439699172973633
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.378 Vali Acc: 0.284 Test Loss: 3.378 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7591855525970459
Epoch: 13, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.437 Vali Acc: 0.281 Test Loss: 3.437 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7953605651855469
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.477 Vali Acc: 0.282 Test Loss: 3.477 Test Acc: 0.282
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7227473258972168
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.481 Vali Acc: 0.286 Test Loss: 3.481 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7582156658172607
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.473 Vali Acc: 0.294 Test Loss: 3.473 Test Acc: 0.294
Validation loss decreased (-0.291731 --> -0.294083).  Saving model ...
Epoch: 17 cost time: 0.680246114730835
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.483 Vali Acc: 0.293 Test Loss: 3.483 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7026238441467285
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.512 Vali Acc: 0.293 Test Loss: 3.512 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6993789672851562
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.539 Vali Acc: 0.288 Test Loss: 3.539 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.682866096496582
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.578 Vali Acc: 0.288 Test Loss: 3.578 Test Acc: 0.288
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6828851699829102
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.592 Vali Acc: 0.286 Test Loss: 3.592 Test Acc: 0.286
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7650654315948486
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.604 Vali Acc: 0.288 Test Loss: 3.604 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7469356060028076
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.620 Vali Acc: 0.286 Test Loss: 3.620 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7742068767547607
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.624 Vali Acc: 0.287 Test Loss: 3.624 Test Acc: 0.287
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.815366268157959
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.632 Vali Acc: 0.288 Test Loss: 3.632 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7631216049194336
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.647 Vali Acc: 0.289 Test Loss: 3.647 Test Acc: 0.289
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29411764705882354
model parameter : 673206
model size : 5.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.201050043106079
Epoch: 1, Steps: 10 | Train Loss: 3.376 Vali Loss: 3.276 Vali Acc: 0.054 Test Loss: 3.276 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.640791654586792
Epoch: 2, Steps: 10 | Train Loss: 2.857 Vali Loss: 3.283 Vali Acc: 0.128 Test Loss: 3.283 Test Acc: 0.128
Validation loss decreased (-0.054085 --> -0.128202).  Saving model ...
Epoch: 3 cost time: 0.6797316074371338
Epoch: 3, Steps: 10 | Train Loss: 1.998 Vali Loss: 3.160 Vali Acc: 0.201 Test Loss: 3.160 Test Acc: 0.201
Validation loss decreased (-0.128202 --> -0.201145).  Saving model ...
Epoch: 4 cost time: 0.7415714263916016
Epoch: 4, Steps: 10 | Train Loss: 1.321 Vali Loss: 3.124 Vali Acc: 0.248 Test Loss: 3.124 Test Acc: 0.248
Validation loss decreased (-0.201145 --> -0.248204).  Saving model ...
Epoch: 5 cost time: 0.7260768413543701
Epoch: 5, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.167 Vali Acc: 0.276 Test Loss: 3.167 Test Acc: 0.276
Validation loss decreased (-0.248204 --> -0.276439).  Saving model ...
Epoch: 6 cost time: 0.7120752334594727
Epoch: 6, Steps: 10 | Train Loss: 0.404 Vali Loss: 3.332 Vali Acc: 0.285 Test Loss: 3.332 Test Acc: 0.285
Validation loss decreased (-0.276439 --> -0.284673).  Saving model ...
Epoch: 7 cost time: 0.7363162040710449
Epoch: 7, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.355 Vali Acc: 0.308 Test Loss: 3.355 Test Acc: 0.308
Validation loss decreased (-0.284673 --> -0.308202).  Saving model ...
Epoch: 8 cost time: 0.7398386001586914
Epoch: 8, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.502 Vali Acc: 0.322 Test Loss: 3.502 Test Acc: 0.322
Validation loss decreased (-0.308202 --> -0.322318).  Saving model ...
Epoch: 9 cost time: 0.7456369400024414
Epoch: 9, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.638 Vali Acc: 0.321 Test Loss: 3.638 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7590463161468506
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.684 Vali Acc: 0.321 Test Loss: 3.684 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6753168106079102
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.719 Vali Acc: 0.328 Test Loss: 3.719 Test Acc: 0.328
Validation loss decreased (-0.322318 --> -0.328198).  Saving model ...
Epoch: 12 cost time: 0.6222178936004639
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.806 Vali Acc: 0.328 Test Loss: 3.806 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6150631904602051
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.804 Vali Acc: 0.331 Test Loss: 3.804 Test Acc: 0.331
Validation loss decreased (-0.328198 --> -0.330550).  Saving model ...
Epoch: 14 cost time: 0.7046012878417969
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.830 Vali Acc: 0.338 Test Loss: 3.830 Test Acc: 0.338
Validation loss decreased (-0.330550 --> -0.337609).  Saving model ...
Epoch: 15 cost time: 0.699275016784668
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.870 Vali Acc: 0.336 Test Loss: 3.870 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.713599681854248
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.898 Vali Acc: 0.339 Test Loss: 3.898 Test Acc: 0.339
Validation loss decreased (-0.337609 --> -0.338785).  Saving model ...
Epoch: 17 cost time: 0.6000006198883057
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.914 Vali Acc: 0.340 Test Loss: 3.914 Test Acc: 0.340
Validation loss decreased (-0.338785 --> -0.339961).  Saving model ...
Epoch: 18 cost time: 0.7155044078826904
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.941 Vali Acc: 0.340 Test Loss: 3.941 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7368414402008057
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.961 Vali Acc: 0.339 Test Loss: 3.961 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7111203670501709
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.972 Vali Acc: 0.334 Test Loss: 3.972 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6091408729553223
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.986 Vali Acc: 0.334 Test Loss: 3.986 Test Acc: 0.334
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6976079940795898
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.003 Vali Acc: 0.332 Test Loss: 4.003 Test Acc: 0.332
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.6175572872161865
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.039 Vali Acc: 0.336 Test Loss: 4.039 Test Acc: 0.336
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.6669023036956787
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.055 Vali Acc: 0.340 Test Loss: 4.055 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7380883693695068
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.067 Vali Acc: 0.339 Test Loss: 4.067 Test Acc: 0.339
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7538254261016846
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.080 Vali Acc: 0.333 Test Loss: 4.080 Test Acc: 0.333
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7274434566497803
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.091 Vali Acc: 0.332 Test Loss: 4.091 Test Acc: 0.332
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 607670
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2561404705047607
Epoch: 1, Steps: 10 | Train Loss: 3.371 Vali Loss: 3.260 Vali Acc: 0.065 Test Loss: 3.260 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 0.7037405967712402
Epoch: 2, Steps: 10 | Train Loss: 2.896 Vali Loss: 3.260 Vali Acc: 0.116 Test Loss: 3.260 Test Acc: 0.116
Validation loss decreased (-0.064673 --> -0.116438).  Saving model ...
Epoch: 3 cost time: 0.7164065837860107
Epoch: 3, Steps: 10 | Train Loss: 2.045 Vali Loss: 3.136 Vali Acc: 0.201 Test Loss: 3.136 Test Acc: 0.201
Validation loss decreased (-0.116438 --> -0.201145).  Saving model ...
Epoch: 4 cost time: 0.6468112468719482
Epoch: 4, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.078 Vali Acc: 0.241 Test Loss: 3.078 Test Acc: 0.241
Validation loss decreased (-0.201145 --> -0.241146).  Saving model ...
Epoch: 5 cost time: 0.6529099941253662
Epoch: 5, Steps: 10 | Train Loss: 0.833 Vali Loss: 3.099 Vali Acc: 0.281 Test Loss: 3.099 Test Acc: 0.281
Validation loss decreased (-0.241146 --> -0.281145).  Saving model ...
Epoch: 6 cost time: 0.682689905166626
Epoch: 6, Steps: 10 | Train Loss: 0.422 Vali Loss: 3.252 Vali Acc: 0.296 Test Loss: 3.252 Test Acc: 0.296
Validation loss decreased (-0.281145 --> -0.296438).  Saving model ...
Epoch: 7 cost time: 0.6795973777770996
Epoch: 7, Steps: 10 | Train Loss: 0.221 Vali Loss: 3.242 Vali Acc: 0.311 Test Loss: 3.242 Test Acc: 0.311
Validation loss decreased (-0.296438 --> -0.310556).  Saving model ...
Epoch: 8 cost time: 0.739130973815918
Epoch: 8, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.387 Vali Acc: 0.331 Test Loss: 3.387 Test Acc: 0.331
Validation loss decreased (-0.310556 --> -0.330554).  Saving model ...
Epoch: 9 cost time: 0.6607177257537842
Epoch: 9, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.510 Vali Acc: 0.325 Test Loss: 3.510 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6484940052032471
Epoch: 10, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.544 Vali Acc: 0.328 Test Loss: 3.544 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7641403675079346
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.606 Vali Acc: 0.331 Test Loss: 3.606 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7464473247528076
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.632 Vali Acc: 0.326 Test Loss: 3.632 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.7117514610290527
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.627 Vali Acc: 0.341 Test Loss: 3.627 Test Acc: 0.341
Validation loss decreased (-0.330554 --> -0.341140).  Saving model ...
Epoch: 14 cost time: 0.6221716403961182
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.671 Vali Acc: 0.346 Test Loss: 3.671 Test Acc: 0.346
Validation loss decreased (-0.341140 --> -0.345846).  Saving model ...
Epoch: 15 cost time: 0.6196718215942383
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.720 Vali Acc: 0.342 Test Loss: 3.720 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6193861961364746
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.750 Vali Acc: 0.336 Test Loss: 3.750 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5873098373413086
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.774 Vali Acc: 0.336 Test Loss: 3.774 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6054363250732422
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.787 Vali Acc: 0.339 Test Loss: 3.787 Test Acc: 0.339
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6769859790802002
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.795 Vali Acc: 0.335 Test Loss: 3.795 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7039051055908203
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.800 Vali Acc: 0.335 Test Loss: 3.800 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7115983963012695
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.811 Vali Acc: 0.338 Test Loss: 3.811 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7424283027648926
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.832 Vali Acc: 0.334 Test Loss: 3.832 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.6503725051879883
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.859 Vali Acc: 0.339 Test Loss: 3.859 Test Acc: 0.339
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.6898150444030762
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.879 Vali Acc: 0.340 Test Loss: 3.879 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 607670
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.04435396194458
Epoch: 1, Steps: 10 | Train Loss: 3.331 Vali Loss: 3.264 Vali Acc: 0.044 Test Loss: 3.264 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.671022891998291
Epoch: 2, Steps: 10 | Train Loss: 2.921 Vali Loss: 3.256 Vali Acc: 0.113 Test Loss: 3.256 Test Acc: 0.113
Validation loss decreased (-0.043497 --> -0.112909).  Saving model ...
Epoch: 3 cost time: 0.7842183113098145
Epoch: 3, Steps: 10 | Train Loss: 2.135 Vali Loss: 3.133 Vali Acc: 0.185 Test Loss: 3.133 Test Acc: 0.185
Validation loss decreased (-0.112909 --> -0.184675).  Saving model ...
Epoch: 4 cost time: 0.7541718482971191
Epoch: 4, Steps: 10 | Train Loss: 1.493 Vali Loss: 3.045 Vali Acc: 0.240 Test Loss: 3.045 Test Acc: 0.240
Validation loss decreased (-0.184675 --> -0.239970).  Saving model ...
Epoch: 5 cost time: 0.7754311561584473
Epoch: 5, Steps: 10 | Train Loss: 0.913 Vali Loss: 3.016 Vali Acc: 0.271 Test Loss: 3.016 Test Acc: 0.271
Validation loss decreased (-0.239970 --> -0.270558).  Saving model ...
Epoch: 6 cost time: 0.7440228462219238
Epoch: 6, Steps: 10 | Train Loss: 0.497 Vali Loss: 3.145 Vali Acc: 0.293 Test Loss: 3.145 Test Acc: 0.293
Validation loss decreased (-0.270558 --> -0.292910).  Saving model ...
Epoch: 7 cost time: 0.7383248805999756
Epoch: 7, Steps: 10 | Train Loss: 0.257 Vali Loss: 3.135 Vali Acc: 0.314 Test Loss: 3.135 Test Acc: 0.314
Validation loss decreased (-0.292910 --> -0.314086).  Saving model ...
Epoch: 8 cost time: 0.7876598834991455
Epoch: 8, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.263 Vali Acc: 0.320 Test Loss: 3.263 Test Acc: 0.320
Validation loss decreased (-0.314086 --> -0.319967).  Saving model ...
Epoch: 9 cost time: 0.792452335357666
Epoch: 9, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.357 Vali Acc: 0.333 Test Loss: 3.357 Test Acc: 0.333
Validation loss decreased (-0.319967 --> -0.332908).  Saving model ...
Epoch: 10 cost time: 0.7654592990875244
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.370 Vali Acc: 0.326 Test Loss: 3.370 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6947314739227295
Epoch: 11, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.446 Vali Acc: 0.334 Test Loss: 3.446 Test Acc: 0.334
Validation loss decreased (-0.332908 --> -0.334083).  Saving model ...
Epoch: 12 cost time: 0.7214417457580566
Epoch: 12, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.517 Vali Acc: 0.324 Test Loss: 3.517 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6533725261688232
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.522 Vali Acc: 0.332 Test Loss: 3.522 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7330591678619385
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.533 Vali Acc: 0.333 Test Loss: 3.533 Test Acc: 0.333
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7609245777130127
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.560 Vali Acc: 0.332 Test Loss: 3.560 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.7324247360229492
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.569 Vali Acc: 0.331 Test Loss: 3.569 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7949948310852051
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.595 Vali Acc: 0.333 Test Loss: 3.595 Test Acc: 0.333
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.7789115905761719
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.617 Vali Acc: 0.335 Test Loss: 3.617 Test Acc: 0.335
Validation loss decreased (-0.334083 --> -0.335258).  Saving model ...
Epoch: 19 cost time: 0.8061444759368896
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.634 Vali Acc: 0.341 Test Loss: 3.634 Test Acc: 0.341
Validation loss decreased (-0.335258 --> -0.341140).  Saving model ...
Epoch: 20 cost time: 0.6988122463226318
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.644 Vali Acc: 0.341 Test Loss: 3.644 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6604077816009521
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.654 Vali Acc: 0.338 Test Loss: 3.654 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.73500657081604
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.672 Vali Acc: 0.335 Test Loss: 3.672 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6792263984680176
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.685 Vali Acc: 0.333 Test Loss: 3.685 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6488354206085205
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.700 Vali Acc: 0.333 Test Loss: 3.700 Test Acc: 0.333
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6609876155853271
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.713 Vali Acc: 0.338 Test Loss: 3.713 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7828960418701172
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.733 Vali Acc: 0.339 Test Loss: 3.733 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8189547061920166
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.746 Vali Acc: 0.340 Test Loss: 3.746 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7262716293334961
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.759 Vali Acc: 0.340 Test Loss: 3.759 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7424957752227783
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.770 Vali Acc: 0.341 Test Loss: 3.770 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 607670
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2150394916534424
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.255 Vali Acc: 0.040 Test Loss: 3.255 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.6880092620849609
Epoch: 2, Steps: 10 | Train Loss: 3.029 Vali Loss: 3.250 Vali Acc: 0.089 Test Loss: 3.250 Test Acc: 0.089
Validation loss decreased (-0.039967 --> -0.089379).  Saving model ...
Epoch: 3 cost time: 0.709721565246582
Epoch: 3, Steps: 10 | Train Loss: 2.405 Vali Loss: 3.164 Vali Acc: 0.155 Test Loss: 3.164 Test Acc: 0.155
Validation loss decreased (-0.089379 --> -0.155262).  Saving model ...
Epoch: 4 cost time: 0.7074496746063232
Epoch: 4, Steps: 10 | Train Loss: 1.832 Vali Loss: 3.066 Vali Acc: 0.186 Test Loss: 3.066 Test Acc: 0.186
Validation loss decreased (-0.155262 --> -0.185852).  Saving model ...
Epoch: 5 cost time: 0.6918656826019287
Epoch: 5, Steps: 10 | Train Loss: 1.281 Vali Loss: 2.973 Vali Acc: 0.232 Test Loss: 2.973 Test Acc: 0.232
Validation loss decreased (-0.185852 --> -0.231735).  Saving model ...
Epoch: 6 cost time: 0.6862850189208984
Epoch: 6, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.034 Vali Acc: 0.254 Test Loss: 3.034 Test Acc: 0.254
Validation loss decreased (-0.231735 --> -0.254087).  Saving model ...
Epoch: 7 cost time: 0.6898641586303711
Epoch: 7, Steps: 10 | Train Loss: 0.453 Vali Loss: 3.021 Vali Acc: 0.256 Test Loss: 3.021 Test Acc: 0.256
Validation loss decreased (-0.254087 --> -0.256440).  Saving model ...
Epoch: 8 cost time: 0.7588667869567871
Epoch: 8, Steps: 10 | Train Loss: 0.224 Vali Loss: 3.104 Vali Acc: 0.280 Test Loss: 3.104 Test Acc: 0.280
Validation loss decreased (-0.256440 --> -0.279969).  Saving model ...
Epoch: 9 cost time: 0.6872148513793945
Epoch: 9, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.206 Vali Acc: 0.282 Test Loss: 3.206 Test Acc: 0.282
Validation loss decreased (-0.279969 --> -0.282321).  Saving model ...
Epoch: 10 cost time: 0.7298319339752197
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.240 Vali Acc: 0.291 Test Loss: 3.240 Test Acc: 0.291
Validation loss decreased (-0.282321 --> -0.290556).  Saving model ...
Epoch: 11 cost time: 0.7696523666381836
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.325 Vali Acc: 0.289 Test Loss: 3.325 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6868612766265869
Epoch: 12, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.381 Vali Acc: 0.280 Test Loss: 3.381 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7501966953277588
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.407 Vali Acc: 0.286 Test Loss: 3.407 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7117354869842529
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.430 Vali Acc: 0.291 Test Loss: 3.430 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6438987255096436
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.465 Vali Acc: 0.292 Test Loss: 3.465 Test Acc: 0.292
Validation loss decreased (-0.290556 --> -0.291730).  Saving model ...
Epoch: 16 cost time: 0.6627585887908936
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.479 Vali Acc: 0.293 Test Loss: 3.479 Test Acc: 0.293
Validation loss decreased (-0.291730 --> -0.292906).  Saving model ...
Epoch: 17 cost time: 0.7238752841949463
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.499 Vali Acc: 0.292 Test Loss: 3.499 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.676480770111084
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.525 Vali Acc: 0.295 Test Loss: 3.525 Test Acc: 0.295
Validation loss decreased (-0.292906 --> -0.295259).  Saving model ...
Epoch: 19 cost time: 0.6977167129516602
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.536 Vali Acc: 0.293 Test Loss: 3.536 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.677344560623169
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.549 Vali Acc: 0.289 Test Loss: 3.549 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7398450374603271
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.559 Vali Acc: 0.285 Test Loss: 3.559 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7833609580993652
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.579 Vali Acc: 0.286 Test Loss: 3.579 Test Acc: 0.286
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6618986129760742
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.595 Vali Acc: 0.285 Test Loss: 3.595 Test Acc: 0.285
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6398720741271973
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.615 Vali Acc: 0.288 Test Loss: 3.615 Test Acc: 0.288
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6113619804382324
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.636 Vali Acc: 0.286 Test Loss: 3.636 Test Acc: 0.286
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6060361862182617
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.663 Vali Acc: 0.288 Test Loss: 3.663 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6239578723907471
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.679 Vali Acc: 0.288 Test Loss: 3.679 Test Acc: 0.288
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6875283718109131
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.692 Vali Acc: 0.287 Test Loss: 3.692 Test Acc: 0.287
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2952941176470588
model parameter : 607670
model size : 4.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3103997707366943
Epoch: 1, Steps: 10 | Train Loss: 3.394 Vali Loss: 3.313 Vali Acc: 0.048 Test Loss: 3.313 Test Acc: 0.048
Validation loss decreased (inf --> -0.048202).  Saving model ...
Epoch: 2 cost time: 0.7226254940032959
Epoch: 2, Steps: 10 | Train Loss: 2.807 Vali Loss: 3.289 Vali Acc: 0.115 Test Loss: 3.289 Test Acc: 0.115
Validation loss decreased (-0.048202 --> -0.115261).  Saving model ...
Epoch: 3 cost time: 0.6788167953491211
Epoch: 3, Steps: 10 | Train Loss: 2.042 Vali Loss: 3.150 Vali Acc: 0.201 Test Loss: 3.150 Test Acc: 0.201
Validation loss decreased (-0.115261 --> -0.201145).  Saving model ...
Epoch: 4 cost time: 0.6411032676696777
Epoch: 4, Steps: 10 | Train Loss: 1.335 Vali Loss: 3.134 Vali Acc: 0.258 Test Loss: 3.134 Test Acc: 0.258
Validation loss decreased (-0.201145 --> -0.257616).  Saving model ...
Epoch: 5 cost time: 0.6268608570098877
Epoch: 5, Steps: 10 | Train Loss: 0.784 Vali Loss: 3.234 Vali Acc: 0.287 Test Loss: 3.234 Test Acc: 0.287
Validation loss decreased (-0.257616 --> -0.287026).  Saving model ...
Epoch: 6 cost time: 0.6499607563018799
Epoch: 6, Steps: 10 | Train Loss: 0.448 Vali Loss: 3.302 Vali Acc: 0.318 Test Loss: 3.302 Test Acc: 0.318
Validation loss decreased (-0.287026 --> -0.317614).  Saving model ...
Epoch: 7 cost time: 0.7129867076873779
Epoch: 7, Steps: 10 | Train Loss: 0.256 Vali Loss: 3.488 Vali Acc: 0.311 Test Loss: 3.488 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7379429340362549
Epoch: 8, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.486 Vali Acc: 0.327 Test Loss: 3.486 Test Acc: 0.327
Validation loss decreased (-0.317614 --> -0.327024).  Saving model ...
Epoch: 9 cost time: 0.8259284496307373
Epoch: 9, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.699 Vali Acc: 0.336 Test Loss: 3.699 Test Acc: 0.336
Validation loss decreased (-0.327024 --> -0.336434).  Saving model ...
Epoch: 10 cost time: 0.7355358600616455
Epoch: 10, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.773 Vali Acc: 0.334 Test Loss: 3.773 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7975420951843262
Epoch: 11, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.786 Vali Acc: 0.332 Test Loss: 3.786 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7368693351745605
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.834 Vali Acc: 0.336 Test Loss: 3.834 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.7042715549468994
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.893 Vali Acc: 0.331 Test Loss: 3.893 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.7290623188018799
Epoch: 14, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.910 Vali Acc: 0.335 Test Loss: 3.910 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.7132229804992676
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.923 Vali Acc: 0.335 Test Loss: 3.923 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 0.7461235523223877
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.947 Vali Acc: 0.336 Test Loss: 3.947 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 0.770463228225708
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.970 Vali Acc: 0.334 Test Loss: 3.970 Test Acc: 0.334
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 0.7552807331085205
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.992 Vali Acc: 0.336 Test Loss: 3.992 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 0.7881050109863281
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.999 Vali Acc: 0.336 Test Loss: 3.999 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 574902
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.456205368041992
Epoch: 1, Steps: 10 | Train Loss: 3.380 Vali Loss: 3.310 Vali Acc: 0.041 Test Loss: 3.310 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.67484450340271
Epoch: 2, Steps: 10 | Train Loss: 2.832 Vali Loss: 3.288 Vali Acc: 0.108 Test Loss: 3.288 Test Acc: 0.108
Validation loss decreased (-0.041143 --> -0.108202).  Saving model ...
Epoch: 3 cost time: 0.6480844020843506
Epoch: 3, Steps: 10 | Train Loss: 2.080 Vali Loss: 3.141 Vali Acc: 0.212 Test Loss: 3.141 Test Acc: 0.212
Validation loss decreased (-0.108202 --> -0.211733).  Saving model ...
Epoch: 4 cost time: 0.6902196407318115
Epoch: 4, Steps: 10 | Train Loss: 1.392 Vali Loss: 3.095 Vali Acc: 0.254 Test Loss: 3.095 Test Acc: 0.254
Validation loss decreased (-0.211733 --> -0.254087).  Saving model ...
Epoch: 5 cost time: 0.681915283203125
Epoch: 5, Steps: 10 | Train Loss: 0.824 Vali Loss: 3.177 Vali Acc: 0.278 Test Loss: 3.177 Test Acc: 0.278
Validation loss decreased (-0.254087 --> -0.277615).  Saving model ...
Epoch: 6 cost time: 0.7252330780029297
Epoch: 6, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.219 Vali Acc: 0.304 Test Loss: 3.219 Test Acc: 0.304
Validation loss decreased (-0.277615 --> -0.303497).  Saving model ...
Epoch: 7 cost time: 0.7321462631225586
Epoch: 7, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.377 Vali Acc: 0.313 Test Loss: 3.377 Test Acc: 0.313
Validation loss decreased (-0.303497 --> -0.312907).  Saving model ...
Epoch: 8 cost time: 0.6965665817260742
Epoch: 8, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.396 Vali Acc: 0.319 Test Loss: 3.396 Test Acc: 0.319
Validation loss decreased (-0.312907 --> -0.318790).  Saving model ...
Epoch: 9 cost time: 0.6824696063995361
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.585 Vali Acc: 0.332 Test Loss: 3.585 Test Acc: 0.332
Validation loss decreased (-0.318790 --> -0.331729).  Saving model ...
Epoch: 10 cost time: 0.696204662322998
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.683 Vali Acc: 0.314 Test Loss: 3.683 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7515149116516113
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.661 Vali Acc: 0.331 Test Loss: 3.661 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6286375522613525
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.697 Vali Acc: 0.335 Test Loss: 3.697 Test Acc: 0.335
Validation loss decreased (-0.331729 --> -0.335257).  Saving model ...
Epoch: 13 cost time: 0.7326548099517822
Epoch: 13, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.741 Vali Acc: 0.338 Test Loss: 3.741 Test Acc: 0.338
Validation loss decreased (-0.335257 --> -0.337610).  Saving model ...
Epoch: 14 cost time: 0.7603194713592529
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.747 Vali Acc: 0.338 Test Loss: 3.747 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6146321296691895
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.757 Vali Acc: 0.341 Test Loss: 3.757 Test Acc: 0.341
Validation loss decreased (-0.337610 --> -0.341139).  Saving model ...
Epoch: 16 cost time: 0.6777045726776123
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.781 Vali Acc: 0.340 Test Loss: 3.781 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6808979511260986
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.803 Vali Acc: 0.339 Test Loss: 3.803 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6790475845336914
Epoch: 18, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.822 Vali Acc: 0.345 Test Loss: 3.822 Test Acc: 0.345
Validation loss decreased (-0.341139 --> -0.344668).  Saving model ...
Epoch: 19 cost time: 0.6932673454284668
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.832 Vali Acc: 0.342 Test Loss: 3.832 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7627277374267578
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.854 Vali Acc: 0.340 Test Loss: 3.854 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7974262237548828
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.866 Vali Acc: 0.336 Test Loss: 3.866 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7383913993835449
Epoch: 22, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.887 Vali Acc: 0.338 Test Loss: 3.887 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7637481689453125
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.900 Vali Acc: 0.336 Test Loss: 3.900 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6906492710113525
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.933 Vali Acc: 0.334 Test Loss: 3.933 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6894395351409912
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.945 Vali Acc: 0.333 Test Loss: 3.945 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7761986255645752
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.956 Vali Acc: 0.333 Test Loss: 3.956 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7143986225128174
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.967 Vali Acc: 0.332 Test Loss: 3.967 Test Acc: 0.332
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7579302787780762
Epoch: 28, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.980 Vali Acc: 0.340 Test Loss: 3.980 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 574902
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.423184394836426
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.281 Vali Acc: 0.065 Test Loss: 3.281 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 0.7440204620361328
Epoch: 2, Steps: 10 | Train Loss: 2.873 Vali Loss: 3.261 Vali Acc: 0.115 Test Loss: 3.261 Test Acc: 0.115
Validation loss decreased (-0.064673 --> -0.115262).  Saving model ...
Epoch: 3 cost time: 0.6894862651824951
Epoch: 3, Steps: 10 | Train Loss: 2.141 Vali Loss: 3.119 Vali Acc: 0.179 Test Loss: 3.119 Test Acc: 0.179
Validation loss decreased (-0.115262 --> -0.178792).  Saving model ...
Epoch: 4 cost time: 0.6628847122192383
Epoch: 4, Steps: 10 | Train Loss: 1.503 Vali Loss: 3.031 Vali Acc: 0.241 Test Loss: 3.031 Test Acc: 0.241
Validation loss decreased (-0.178792 --> -0.241146).  Saving model ...
Epoch: 5 cost time: 0.7679026126861572
Epoch: 5, Steps: 10 | Train Loss: 0.938 Vali Loss: 3.073 Vali Acc: 0.274 Test Loss: 3.073 Test Acc: 0.274
Validation loss decreased (-0.241146 --> -0.274087).  Saving model ...
Epoch: 6 cost time: 0.667370080947876
Epoch: 6, Steps: 10 | Train Loss: 0.522 Vali Loss: 3.106 Vali Acc: 0.305 Test Loss: 3.106 Test Acc: 0.305
Validation loss decreased (-0.274087 --> -0.304675).  Saving model ...
Epoch: 7 cost time: 0.6656544208526611
Epoch: 7, Steps: 10 | Train Loss: 0.279 Vali Loss: 3.215 Vali Acc: 0.320 Test Loss: 3.215 Test Acc: 0.320
Validation loss decreased (-0.304675 --> -0.319968).  Saving model ...
Epoch: 8 cost time: 0.7692146301269531
Epoch: 8, Steps: 10 | Train Loss: 0.151 Vali Loss: 3.252 Vali Acc: 0.314 Test Loss: 3.252 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.809746265411377
Epoch: 9, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.411 Vali Acc: 0.327 Test Loss: 3.411 Test Acc: 0.327
Validation loss decreased (-0.319968 --> -0.327025).  Saving model ...
Epoch: 10 cost time: 0.7215743064880371
Epoch: 10, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.470 Vali Acc: 0.322 Test Loss: 3.470 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8003027439117432
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.496 Vali Acc: 0.321 Test Loss: 3.496 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.7915499210357666
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.513 Vali Acc: 0.336 Test Loss: 3.513 Test Acc: 0.336
Validation loss decreased (-0.327025 --> -0.336435).  Saving model ...
Epoch: 13 cost time: 0.791557788848877
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.545 Vali Acc: 0.331 Test Loss: 3.545 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7170817852020264
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.570 Vali Acc: 0.331 Test Loss: 3.570 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6262288093566895
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.594 Vali Acc: 0.331 Test Loss: 3.594 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6894068717956543
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.610 Vali Acc: 0.332 Test Loss: 3.610 Test Acc: 0.332
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.7941370010375977
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.622 Vali Acc: 0.334 Test Loss: 3.622 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7560508251190186
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.635 Vali Acc: 0.328 Test Loss: 3.635 Test Acc: 0.328
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8314478397369385
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.646 Vali Acc: 0.331 Test Loss: 3.646 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8098013401031494
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.669 Vali Acc: 0.328 Test Loss: 3.669 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8516461849212646
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.678 Vali Acc: 0.327 Test Loss: 3.678 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.784696102142334
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.693 Vali Acc: 0.331 Test Loss: 3.693 Test Acc: 0.331
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 574902
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.189237117767334
Epoch: 1, Steps: 10 | Train Loss: 3.299 Vali Loss: 3.262 Vali Acc: 0.058 Test Loss: 3.262 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.6744060516357422
Epoch: 2, Steps: 10 | Train Loss: 2.930 Vali Loss: 3.248 Vali Acc: 0.112 Test Loss: 3.248 Test Acc: 0.112
Validation loss decreased (-0.057614 --> -0.111732).  Saving model ...
Epoch: 3 cost time: 0.6963918209075928
Epoch: 3, Steps: 10 | Train Loss: 2.373 Vali Loss: 3.148 Vali Acc: 0.159 Test Loss: 3.148 Test Acc: 0.159
Validation loss decreased (-0.111732 --> -0.158792).  Saving model ...
Epoch: 4 cost time: 0.6661076545715332
Epoch: 4, Steps: 10 | Train Loss: 1.836 Vali Loss: 3.019 Vali Acc: 0.213 Test Loss: 3.019 Test Acc: 0.213
Validation loss decreased (-0.158792 --> -0.212911).  Saving model ...
Epoch: 5 cost time: 0.7973849773406982
Epoch: 5, Steps: 10 | Train Loss: 1.281 Vali Loss: 2.985 Vali Acc: 0.251 Test Loss: 2.985 Test Acc: 0.251
Validation loss decreased (-0.212911 --> -0.250558).  Saving model ...
Epoch: 6 cost time: 0.7798614501953125
Epoch: 6, Steps: 10 | Train Loss: 0.798 Vali Loss: 2.992 Vali Acc: 0.255 Test Loss: 2.992 Test Acc: 0.255
Validation loss decreased (-0.250558 --> -0.255264).  Saving model ...
Epoch: 7 cost time: 0.8023021221160889
Epoch: 7, Steps: 10 | Train Loss: 0.458 Vali Loss: 3.035 Vali Acc: 0.291 Test Loss: 3.035 Test Acc: 0.291
Validation loss decreased (-0.255264 --> -0.290558).  Saving model ...
Epoch: 8 cost time: 0.9300417900085449
Epoch: 8, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.064 Vali Acc: 0.284 Test Loss: 3.064 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7773313522338867
Epoch: 9, Steps: 10 | Train Loss: 0.104 Vali Loss: 3.232 Vali Acc: 0.279 Test Loss: 3.232 Test Acc: 0.279
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6982488632202148
Epoch: 10, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.277 Vali Acc: 0.299 Test Loss: 3.277 Test Acc: 0.299
Validation loss decreased (-0.290558 --> -0.298791).  Saving model ...
Epoch: 11 cost time: 0.7331011295318604
Epoch: 11, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.355 Vali Acc: 0.291 Test Loss: 3.355 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7407758235931396
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.387 Vali Acc: 0.292 Test Loss: 3.387 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7562854290008545
Epoch: 13, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.411 Vali Acc: 0.291 Test Loss: 3.411 Test Acc: 0.291
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8926336765289307
Epoch: 14, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.428 Vali Acc: 0.292 Test Loss: 3.428 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.862170934677124
Epoch: 15, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.435 Vali Acc: 0.294 Test Loss: 3.435 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7641644477844238
Epoch: 16, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.450 Vali Acc: 0.296 Test Loss: 3.450 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7676601409912109
Epoch: 17, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.471 Vali Acc: 0.293 Test Loss: 3.471 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7858130931854248
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.509 Vali Acc: 0.294 Test Loss: 3.509 Test Acc: 0.294
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7030885219573975
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.524 Vali Acc: 0.299 Test Loss: 3.524 Test Acc: 0.299
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6142170429229736
Epoch: 20, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.543 Vali Acc: 0.298 Test Loss: 3.543 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2988235294117647
model parameter : 574902
model size : 4.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2679805755615234
Epoch: 1, Steps: 10 | Train Loss: 3.426 Vali Loss: 3.270 Vali Acc: 0.079 Test Loss: 3.270 Test Acc: 0.079
Validation loss decreased (inf --> -0.078791).  Saving model ...
Epoch: 2 cost time: 0.7165148258209229
Epoch: 2, Steps: 10 | Train Loss: 2.874 Vali Loss: 3.222 Vali Acc: 0.129 Test Loss: 3.222 Test Acc: 0.129
Validation loss decreased (-0.078791 --> -0.129380).  Saving model ...
Epoch: 3 cost time: 0.7242615222930908
Epoch: 3, Steps: 10 | Train Loss: 2.023 Vali Loss: 3.106 Vali Acc: 0.215 Test Loss: 3.106 Test Acc: 0.215
Validation loss decreased (-0.129380 --> -0.215263).  Saving model ...
Epoch: 4 cost time: 0.7051849365234375
Epoch: 4, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.107 Vali Acc: 0.256 Test Loss: 3.107 Test Acc: 0.256
Validation loss decreased (-0.215263 --> -0.256440).  Saving model ...
Epoch: 5 cost time: 0.7064776420593262
Epoch: 5, Steps: 10 | Train Loss: 0.763 Vali Loss: 3.112 Vali Acc: 0.306 Test Loss: 3.112 Test Acc: 0.306
Validation loss decreased (-0.256440 --> -0.305851).  Saving model ...
Epoch: 6 cost time: 0.6774246692657471
Epoch: 6, Steps: 10 | Train Loss: 0.436 Vali Loss: 3.303 Vali Acc: 0.308 Test Loss: 3.303 Test Acc: 0.308
Validation loss decreased (-0.305851 --> -0.308202).  Saving model ...
Epoch: 7 cost time: 0.5859527587890625
Epoch: 7, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.415 Vali Acc: 0.326 Test Loss: 3.415 Test Acc: 0.326
Validation loss decreased (-0.308202 --> -0.325848).  Saving model ...
Epoch: 8 cost time: 0.6357607841491699
Epoch: 8, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.462 Vali Acc: 0.329 Test Loss: 3.462 Test Acc: 0.329
Validation loss decreased (-0.325848 --> -0.329377).  Saving model ...
Epoch: 9 cost time: 0.6089706420898438
Epoch: 9, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.651 Vali Acc: 0.331 Test Loss: 3.651 Test Acc: 0.331
Validation loss decreased (-0.329377 --> -0.330552).  Saving model ...
Epoch: 10 cost time: 0.6710007190704346
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.706 Vali Acc: 0.335 Test Loss: 3.706 Test Acc: 0.335
Validation loss decreased (-0.330552 --> -0.335257).  Saving model ...
Epoch: 11 cost time: 0.6355299949645996
Epoch: 11, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.768 Vali Acc: 0.344 Test Loss: 3.768 Test Acc: 0.344
Validation loss decreased (-0.335257 --> -0.343492).  Saving model ...
Epoch: 12 cost time: 0.6972436904907227
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.811 Vali Acc: 0.341 Test Loss: 3.811 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7099573612213135
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.815 Vali Acc: 0.345 Test Loss: 3.815 Test Acc: 0.345
Validation loss decreased (-0.343492 --> -0.344668).  Saving model ...
Epoch: 14 cost time: 0.7583754062652588
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.838 Vali Acc: 0.342 Test Loss: 3.838 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7658259868621826
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.866 Vali Acc: 0.341 Test Loss: 3.866 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.704413890838623
Epoch: 16, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.896 Vali Acc: 0.346 Test Loss: 3.896 Test Acc: 0.346
Validation loss decreased (-0.344668 --> -0.345843).  Saving model ...
Epoch: 17 cost time: 0.7552971839904785
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.926 Vali Acc: 0.347 Test Loss: 3.926 Test Acc: 0.347
Validation loss decreased (-0.345843 --> -0.347020).  Saving model ...
Epoch: 18 cost time: 0.7513363361358643
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.936 Vali Acc: 0.347 Test Loss: 3.936 Test Acc: 0.347
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7035238742828369
Epoch: 19, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.940 Vali Acc: 0.346 Test Loss: 3.940 Test Acc: 0.346
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6611714363098145
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.958 Vali Acc: 0.345 Test Loss: 3.958 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7085015773773193
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.990 Vali Acc: 0.342 Test Loss: 3.990 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6718058586120605
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.014 Vali Acc: 0.346 Test Loss: 4.014 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7990901470184326
Epoch: 23, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.026 Vali Acc: 0.347 Test Loss: 4.026 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7475426197052002
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.042 Vali Acc: 0.344 Test Loss: 4.042 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7176635265350342
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.062 Vali Acc: 0.347 Test Loss: 4.062 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.6916780471801758
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.079 Vali Acc: 0.346 Test Loss: 4.079 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7411882877349854
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.079 Vali Acc: 0.346 Test Loss: 4.079 Test Acc: 0.346
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34705882352941175
model parameter : 558518
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2442197799682617
Epoch: 1, Steps: 10 | Train Loss: 3.429 Vali Loss: 3.263 Vali Acc: 0.080 Test Loss: 3.263 Test Acc: 0.080
Validation loss decreased (inf --> -0.079967).  Saving model ...
Epoch: 2 cost time: 0.6241054534912109
Epoch: 2, Steps: 10 | Train Loss: 2.887 Vali Loss: 3.221 Vali Acc: 0.121 Test Loss: 3.221 Test Acc: 0.121
Validation loss decreased (-0.079967 --> -0.121144).  Saving model ...
Epoch: 3 cost time: 0.5996060371398926
Epoch: 3, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.095 Vali Acc: 0.214 Test Loss: 3.095 Test Acc: 0.214
Validation loss decreased (-0.121144 --> -0.214087).  Saving model ...
Epoch: 4 cost time: 0.6424188613891602
Epoch: 4, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.066 Vali Acc: 0.261 Test Loss: 3.066 Test Acc: 0.261
Validation loss decreased (-0.214087 --> -0.261146).  Saving model ...
Epoch: 5 cost time: 0.6343114376068115
Epoch: 5, Steps: 10 | Train Loss: 0.808 Vali Loss: 3.049 Vali Acc: 0.296 Test Loss: 3.049 Test Acc: 0.296
Validation loss decreased (-0.261146 --> -0.296440).  Saving model ...
Epoch: 6 cost time: 0.6759026050567627
Epoch: 6, Steps: 10 | Train Loss: 0.446 Vali Loss: 3.209 Vali Acc: 0.307 Test Loss: 3.209 Test Acc: 0.307
Validation loss decreased (-0.296440 --> -0.307027).  Saving model ...
Epoch: 7 cost time: 0.8141880035400391
Epoch: 7, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.310 Vali Acc: 0.326 Test Loss: 3.310 Test Acc: 0.326
Validation loss decreased (-0.307027 --> -0.325849).  Saving model ...
Epoch: 8 cost time: 0.7588210105895996
Epoch: 8, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.358 Vali Acc: 0.341 Test Loss: 3.358 Test Acc: 0.341
Validation loss decreased (-0.325849 --> -0.341143).  Saving model ...
Epoch: 9 cost time: 0.7876558303833008
Epoch: 9, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.517 Vali Acc: 0.331 Test Loss: 3.517 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7265481948852539
Epoch: 10, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.546 Vali Acc: 0.326 Test Loss: 3.546 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7386243343353271
Epoch: 11, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.612 Vali Acc: 0.327 Test Loss: 3.612 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7034292221069336
Epoch: 12, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.673 Vali Acc: 0.340 Test Loss: 3.673 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6858234405517578
Epoch: 13, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.695 Vali Acc: 0.335 Test Loss: 3.695 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.623694658279419
Epoch: 14, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.715 Vali Acc: 0.326 Test Loss: 3.715 Test Acc: 0.326
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7197637557983398
Epoch: 15, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.747 Vali Acc: 0.327 Test Loss: 3.747 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.617668628692627
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.770 Vali Acc: 0.335 Test Loss: 3.770 Test Acc: 0.335
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6748960018157959
Epoch: 17, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.790 Vali Acc: 0.334 Test Loss: 3.790 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.7771284580230713
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.785 Vali Acc: 0.335 Test Loss: 3.785 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 558518
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5760161876678467
Epoch: 1, Steps: 10 | Train Loss: 3.400 Vali Loss: 3.271 Vali Acc: 0.065 Test Loss: 3.271 Test Acc: 0.065
Validation loss decreased (inf --> -0.064673).  Saving model ...
Epoch: 2 cost time: 0.8340423107147217
Epoch: 2, Steps: 10 | Train Loss: 2.920 Vali Loss: 3.238 Vali Acc: 0.119 Test Loss: 3.238 Test Acc: 0.119
Validation loss decreased (-0.064673 --> -0.118791).  Saving model ...
Epoch: 3 cost time: 0.8874342441558838
Epoch: 3, Steps: 10 | Train Loss: 2.194 Vali Loss: 3.110 Vali Acc: 0.191 Test Loss: 3.110 Test Acc: 0.191
Validation loss decreased (-0.118791 --> -0.190557).  Saving model ...
Epoch: 4 cost time: 0.8169429302215576
Epoch: 4, Steps: 10 | Train Loss: 1.439 Vali Loss: 3.036 Vali Acc: 0.264 Test Loss: 3.036 Test Acc: 0.264
Validation loss decreased (-0.190557 --> -0.263499).  Saving model ...
Epoch: 5 cost time: 0.8063831329345703
Epoch: 5, Steps: 10 | Train Loss: 0.904 Vali Loss: 2.991 Vali Acc: 0.300 Test Loss: 2.991 Test Acc: 0.300
Validation loss decreased (-0.263499 --> -0.299970).  Saving model ...
Epoch: 6 cost time: 0.7453656196594238
Epoch: 6, Steps: 10 | Train Loss: 0.501 Vali Loss: 3.106 Vali Acc: 0.309 Test Loss: 3.106 Test Acc: 0.309
Validation loss decreased (-0.299970 --> -0.309381).  Saving model ...
Epoch: 7 cost time: 0.8057222366333008
Epoch: 7, Steps: 10 | Train Loss: 0.243 Vali Loss: 3.175 Vali Acc: 0.321 Test Loss: 3.175 Test Acc: 0.321
Validation loss decreased (-0.309381 --> -0.321145).  Saving model ...
Epoch: 8 cost time: 0.7997720241546631
Epoch: 8, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.233 Vali Acc: 0.329 Test Loss: 3.233 Test Acc: 0.329
Validation loss decreased (-0.321145 --> -0.329379).  Saving model ...
Epoch: 9 cost time: 0.7423467636108398
Epoch: 9, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.419 Vali Acc: 0.328 Test Loss: 3.419 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7028093338012695
Epoch: 10, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.429 Vali Acc: 0.326 Test Loss: 3.429 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.796438455581665
Epoch: 11, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.474 Vali Acc: 0.326 Test Loss: 3.474 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7693438529968262
Epoch: 12, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.514 Vali Acc: 0.333 Test Loss: 3.514 Test Acc: 0.333
Validation loss decreased (-0.329379 --> -0.332906).  Saving model ...
Epoch: 13 cost time: 0.7419450283050537
Epoch: 13, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.531 Vali Acc: 0.326 Test Loss: 3.531 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8006961345672607
Epoch: 14, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.545 Vali Acc: 0.324 Test Loss: 3.545 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7191743850708008
Epoch: 15, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.564 Vali Acc: 0.324 Test Loss: 3.564 Test Acc: 0.324
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6619083881378174
Epoch: 16, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.590 Vali Acc: 0.327 Test Loss: 3.590 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6217448711395264
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.614 Vali Acc: 0.327 Test Loss: 3.614 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.7237753868103027
Epoch: 18, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.625 Vali Acc: 0.331 Test Loss: 3.625 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.8259701728820801
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.641 Vali Acc: 0.332 Test Loss: 3.641 Test Acc: 0.332
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.7012221813201904
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.651 Vali Acc: 0.338 Test Loss: 3.651 Test Acc: 0.338
Validation loss decreased (-0.332906 --> -0.337611).  Saving model ...
Epoch: 21 cost time: 0.7578403949737549
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.676 Vali Acc: 0.329 Test Loss: 3.676 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7618756294250488
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.695 Vali Acc: 0.328 Test Loss: 3.695 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.838125467300415
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.712 Vali Acc: 0.339 Test Loss: 3.712 Test Acc: 0.339
Validation loss decreased (-0.337611 --> -0.338786).  Saving model ...
Epoch: 24 cost time: 0.7844655513763428
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.725 Vali Acc: 0.335 Test Loss: 3.725 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7924368381500244
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.736 Vali Acc: 0.340 Test Loss: 3.736 Test Acc: 0.340
Validation loss decreased (-0.338786 --> -0.339963).  Saving model ...
Epoch: 26 cost time: 0.7833690643310547
Epoch: 26, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.753 Vali Acc: 0.335 Test Loss: 3.753 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8156347274780273
Epoch: 27, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.762 Vali Acc: 0.333 Test Loss: 3.762 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.8151183128356934
Epoch: 28, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.773 Vali Acc: 0.335 Test Loss: 3.773 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.748967170715332
Epoch: 29, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.787 Vali Acc: 0.333 Test Loss: 3.787 Test Acc: 0.333
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7650406360626221
Epoch: 30, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.798 Vali Acc: 0.334 Test Loss: 3.798 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.8688089847564697
Epoch: 31, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.810 Vali Acc: 0.335 Test Loss: 3.810 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.7931439876556396
Epoch: 32, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.817 Vali Acc: 0.336 Test Loss: 3.817 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.8554973602294922
Epoch: 33, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.828 Vali Acc: 0.333 Test Loss: 3.828 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.8532323837280273
Epoch: 34, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.841 Vali Acc: 0.334 Test Loss: 3.841 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.9173967838287354
Epoch: 35, Steps: 10 | Train Loss: 0.001 Vali Loss: 3.855 Vali Acc: 0.333 Test Loss: 3.855 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34
model parameter : 558518
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.472945213317871
Epoch: 1, Steps: 10 | Train Loss: 3.339 Vali Loss: 3.263 Vali Acc: 0.054 Test Loss: 3.263 Test Acc: 0.054
Validation loss decreased (inf --> -0.054085).  Saving model ...
Epoch: 2 cost time: 0.7742161750793457
Epoch: 2, Steps: 10 | Train Loss: 3.001 Vali Loss: 3.245 Vali Acc: 0.102 Test Loss: 3.245 Test Acc: 0.102
Validation loss decreased (-0.054085 --> -0.102320).  Saving model ...
Epoch: 3 cost time: 0.7705669403076172
Epoch: 3, Steps: 10 | Train Loss: 2.460 Vali Loss: 3.146 Vali Acc: 0.151 Test Loss: 3.146 Test Acc: 0.151
Validation loss decreased (-0.102320 --> -0.150557).  Saving model ...
Epoch: 4 cost time: 0.6896922588348389
Epoch: 4, Steps: 10 | Train Loss: 1.795 Vali Loss: 3.043 Vali Acc: 0.205 Test Loss: 3.043 Test Acc: 0.205
Validation loss decreased (-0.150557 --> -0.204675).  Saving model ...
Epoch: 5 cost time: 0.6807200908660889
Epoch: 5, Steps: 10 | Train Loss: 1.259 Vali Loss: 2.952 Vali Acc: 0.245 Test Loss: 2.952 Test Acc: 0.245
Validation loss decreased (-0.204675 --> -0.244676).  Saving model ...
Epoch: 6 cost time: 0.5801742076873779
Epoch: 6, Steps: 10 | Train Loss: 0.763 Vali Loss: 2.990 Vali Acc: 0.259 Test Loss: 2.990 Test Acc: 0.259
Validation loss decreased (-0.244676 --> -0.258794).  Saving model ...
Epoch: 7 cost time: 0.6091978549957275
Epoch: 7, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.020 Vali Acc: 0.267 Test Loss: 3.020 Test Acc: 0.267
Validation loss decreased (-0.258794 --> -0.267029).  Saving model ...
Epoch: 8 cost time: 0.6923315525054932
Epoch: 8, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.105 Vali Acc: 0.276 Test Loss: 3.105 Test Acc: 0.276
Validation loss decreased (-0.267029 --> -0.276440).  Saving model ...
Epoch: 9 cost time: 0.6769754886627197
Epoch: 9, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.227 Vali Acc: 0.279 Test Loss: 3.227 Test Acc: 0.279
Validation loss decreased (-0.276440 --> -0.278791).  Saving model ...
Epoch: 10 cost time: 0.7156026363372803
Epoch: 10, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.247 Vali Acc: 0.289 Test Loss: 3.247 Test Acc: 0.289
Validation loss decreased (-0.278791 --> -0.289379).  Saving model ...
Epoch: 11 cost time: 0.6949148178100586
Epoch: 11, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.323 Vali Acc: 0.287 Test Loss: 3.323 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6717314720153809
Epoch: 12, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.414 Vali Acc: 0.284 Test Loss: 3.414 Test Acc: 0.284
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6928753852844238
Epoch: 13, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.449 Vali Acc: 0.286 Test Loss: 3.449 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.7233169078826904
Epoch: 14, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.447 Vali Acc: 0.289 Test Loss: 3.447 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.697880744934082
Epoch: 15, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.460 Vali Acc: 0.293 Test Loss: 3.460 Test Acc: 0.293
Validation loss decreased (-0.289379 --> -0.292907).  Saving model ...
Epoch: 16 cost time: 0.7530584335327148
Epoch: 16, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.498 Vali Acc: 0.286 Test Loss: 3.498 Test Acc: 0.286
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.724919319152832
Epoch: 17, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.517 Vali Acc: 0.287 Test Loss: 3.517 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6544513702392578
Epoch: 18, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.527 Vali Acc: 0.288 Test Loss: 3.527 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7263755798339844
Epoch: 19, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.545 Vali Acc: 0.292 Test Loss: 3.545 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6958270072937012
Epoch: 20, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.558 Vali Acc: 0.289 Test Loss: 3.558 Test Acc: 0.289
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7108755111694336
Epoch: 21, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.580 Vali Acc: 0.287 Test Loss: 3.580 Test Acc: 0.287
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7514545917510986
Epoch: 22, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.606 Vali Acc: 0.284 Test Loss: 3.606 Test Acc: 0.284
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.7726263999938965
Epoch: 23, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.626 Vali Acc: 0.288 Test Loss: 3.626 Test Acc: 0.288
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8326728343963623
Epoch: 24, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.636 Vali Acc: 0.289 Test Loss: 3.636 Test Acc: 0.289
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8112587928771973
Epoch: 25, Steps: 10 | Train Loss: 0.002 Vali Loss: 3.649 Vali Acc: 0.291 Test Loss: 3.649 Test Acc: 0.291
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29294117647058826
model parameter : 558518
model size : 4.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.6631247997283936
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.303 Vali Acc: 0.049 Test Loss: 3.303 Test Acc: 0.049
Validation loss decreased (inf --> -0.049379).  Saving model ...
Epoch: 2 cost time: 0.8217694759368896
Epoch: 2, Steps: 10 | Train Loss: 3.041 Vali Loss: 3.250 Vali Acc: 0.111 Test Loss: 3.250 Test Acc: 0.111
Validation loss decreased (-0.049379 --> -0.110556).  Saving model ...
Epoch: 3 cost time: 0.8006515502929688
Epoch: 3, Steps: 10 | Train Loss: 2.568 Vali Loss: 3.221 Vali Acc: 0.140 Test Loss: 3.221 Test Acc: 0.140
Validation loss decreased (-0.110556 --> -0.139968).  Saving model ...
Epoch: 4 cost time: 0.8267412185668945
Epoch: 4, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.160 Vali Acc: 0.192 Test Loss: 3.160 Test Acc: 0.192
Validation loss decreased (-0.139968 --> -0.191733).  Saving model ...
Epoch: 5 cost time: 0.730017900466919
Epoch: 5, Steps: 10 | Train Loss: 1.687 Vali Loss: 3.119 Vali Acc: 0.218 Test Loss: 3.119 Test Acc: 0.218
Validation loss decreased (-0.191733 --> -0.217616).  Saving model ...
Epoch: 6 cost time: 0.7181384563446045
Epoch: 6, Steps: 10 | Train Loss: 1.228 Vali Loss: 3.117 Vali Acc: 0.235 Test Loss: 3.117 Test Acc: 0.235
Validation loss decreased (-0.217616 --> -0.235263).  Saving model ...
Epoch: 7 cost time: 0.7166969776153564
Epoch: 7, Steps: 10 | Train Loss: 0.917 Vali Loss: 3.156 Vali Acc: 0.260 Test Loss: 3.156 Test Acc: 0.260
Validation loss decreased (-0.235263 --> -0.259968).  Saving model ...
Epoch: 8 cost time: 0.7963900566101074
Epoch: 8, Steps: 10 | Train Loss: 0.629 Vali Loss: 3.211 Vali Acc: 0.265 Test Loss: 3.211 Test Acc: 0.265
Validation loss decreased (-0.259968 --> -0.264674).  Saving model ...
Epoch: 9 cost time: 0.7875797748565674
Epoch: 9, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.256 Vali Acc: 0.289 Test Loss: 3.256 Test Acc: 0.289
Validation loss decreased (-0.264674 --> -0.289379).  Saving model ...
Epoch: 10 cost time: 0.7828147411346436
Epoch: 10, Steps: 10 | Train Loss: 0.302 Vali Loss: 3.346 Vali Acc: 0.300 Test Loss: 3.346 Test Acc: 0.300
Validation loss decreased (-0.289379 --> -0.299967).  Saving model ...
Epoch: 11 cost time: 0.7533755302429199
Epoch: 11, Steps: 10 | Train Loss: 0.179 Vali Loss: 3.383 Vali Acc: 0.311 Test Loss: 3.383 Test Acc: 0.311
Validation loss decreased (-0.299967 --> -0.310554).  Saving model ...
Epoch: 12 cost time: 0.654395580291748
Epoch: 12, Steps: 10 | Train Loss: 0.134 Vali Loss: 3.495 Vali Acc: 0.301 Test Loss: 3.495 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7738642692565918
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.515 Vali Acc: 0.318 Test Loss: 3.515 Test Acc: 0.318
Validation loss decreased (-0.310554 --> -0.317612).  Saving model ...
Epoch: 14 cost time: 0.729888916015625
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.592 Vali Acc: 0.325 Test Loss: 3.592 Test Acc: 0.325
Validation loss decreased (-0.317612 --> -0.324670).  Saving model ...
Epoch: 15 cost time: 0.7275917530059814
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.656 Vali Acc: 0.321 Test Loss: 3.656 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7942824363708496
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.703 Vali Acc: 0.314 Test Loss: 3.703 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7490150928497314
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.707 Vali Acc: 0.326 Test Loss: 3.707 Test Acc: 0.326
Validation loss decreased (-0.324670 --> -0.325845).  Saving model ...
Epoch: 18 cost time: 0.7738037109375
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.721 Vali Acc: 0.327 Test Loss: 3.721 Test Acc: 0.327
Validation loss decreased (-0.325845 --> -0.327022).  Saving model ...
Epoch: 19 cost time: 0.8221142292022705
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.746 Vali Acc: 0.320 Test Loss: 3.746 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.806419849395752
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.779 Vali Acc: 0.320 Test Loss: 3.779 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7810611724853516
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.814 Vali Acc: 0.321 Test Loss: 3.814 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.730076789855957
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.825 Vali Acc: 0.332 Test Loss: 3.825 Test Acc: 0.332
Validation loss decreased (-0.327022 --> -0.331726).  Saving model ...
Epoch: 23 cost time: 0.7868304252624512
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.856 Vali Acc: 0.328 Test Loss: 3.856 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7007608413696289
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.880 Vali Acc: 0.321 Test Loss: 3.880 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7212450504302979
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.902 Vali Acc: 0.326 Test Loss: 3.902 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.659576416015625
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.912 Vali Acc: 0.322 Test Loss: 3.912 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7541031837463379
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.927 Vali Acc: 0.322 Test Loss: 3.927 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7714824676513672
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.965 Vali Acc: 0.332 Test Loss: 3.965 Test Acc: 0.332
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7256968021392822
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.984 Vali Acc: 0.331 Test Loss: 3.984 Test Acc: 0.331
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.726520299911499
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.005 Vali Acc: 0.333 Test Loss: 4.005 Test Acc: 0.333
Validation loss decreased (-0.331726 --> -0.332901).  Saving model ...
Epoch: 31 cost time: 0.8933372497558594
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.020 Vali Acc: 0.329 Test Loss: 4.020 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7890346050262451
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.036 Vali Acc: 0.328 Test Loss: 4.036 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7192959785461426
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.047 Vali Acc: 0.331 Test Loss: 4.047 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.843595027923584
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.060 Vali Acc: 0.327 Test Loss: 4.060 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.792137861251831
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.067 Vali Acc: 0.325 Test Loss: 4.067 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8230352401733398
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.077 Vali Acc: 0.322 Test Loss: 4.077 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7713966369628906
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.098 Vali Acc: 0.325 Test Loss: 4.098 Test Acc: 0.325
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7887251377105713
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.101 Vali Acc: 0.324 Test Loss: 4.101 Test Acc: 0.324
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8124072551727295
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.102 Vali Acc: 0.324 Test Loss: 4.102 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7554128170013428
Epoch: 40, Steps: 10 | Train Loss: 0.002 Vali Loss: 4.113 Vali Acc: 0.322 Test Loss: 4.113 Test Acc: 0.322
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 525046
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.182161331176758
Epoch: 1, Steps: 10 | Train Loss: 3.349 Vali Loss: 3.281 Vali Acc: 0.061 Test Loss: 3.281 Test Acc: 0.061
Validation loss decreased (inf --> -0.061144).  Saving model ...
Epoch: 2 cost time: 0.7180144786834717
Epoch: 2, Steps: 10 | Train Loss: 3.000 Vali Loss: 3.230 Vali Acc: 0.115 Test Loss: 3.230 Test Acc: 0.115
Validation loss decreased (-0.061144 --> -0.115262).  Saving model ...
Epoch: 3 cost time: 0.7167763710021973
Epoch: 3, Steps: 10 | Train Loss: 2.594 Vali Loss: 3.202 Vali Acc: 0.148 Test Loss: 3.202 Test Acc: 0.148
Validation loss decreased (-0.115262 --> -0.148203).  Saving model ...
Epoch: 4 cost time: 0.8029294013977051
Epoch: 4, Steps: 10 | Train Loss: 2.144 Vali Loss: 3.137 Vali Acc: 0.191 Test Loss: 3.137 Test Acc: 0.191
Validation loss decreased (-0.148203 --> -0.190557).  Saving model ...
Epoch: 5 cost time: 0.6935131549835205
Epoch: 5, Steps: 10 | Train Loss: 1.716 Vali Loss: 3.080 Vali Acc: 0.222 Test Loss: 3.080 Test Acc: 0.222
Validation loss decreased (-0.190557 --> -0.222322).  Saving model ...
Epoch: 6 cost time: 0.7682874202728271
Epoch: 6, Steps: 10 | Train Loss: 1.262 Vali Loss: 3.067 Vali Acc: 0.234 Test Loss: 3.067 Test Acc: 0.234
Validation loss decreased (-0.222322 --> -0.234087).  Saving model ...
Epoch: 7 cost time: 0.667341947555542
Epoch: 7, Steps: 10 | Train Loss: 0.948 Vali Loss: 3.091 Vali Acc: 0.265 Test Loss: 3.091 Test Acc: 0.265
Validation loss decreased (-0.234087 --> -0.264675).  Saving model ...
Epoch: 8 cost time: 0.782689094543457
Epoch: 8, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.135 Vali Acc: 0.260 Test Loss: 3.135 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.8535385131835938
Epoch: 9, Steps: 10 | Train Loss: 0.424 Vali Loss: 3.176 Vali Acc: 0.300 Test Loss: 3.176 Test Acc: 0.300
Validation loss decreased (-0.264675 --> -0.299968).  Saving model ...
Epoch: 10 cost time: 0.812232494354248
Epoch: 10, Steps: 10 | Train Loss: 0.298 Vali Loss: 3.263 Vali Acc: 0.307 Test Loss: 3.263 Test Acc: 0.307
Validation loss decreased (-0.299968 --> -0.307026).  Saving model ...
Epoch: 11 cost time: 0.8118040561676025
Epoch: 11, Steps: 10 | Train Loss: 0.180 Vali Loss: 3.290 Vali Acc: 0.320 Test Loss: 3.290 Test Acc: 0.320
Validation loss decreased (-0.307026 --> -0.319967).  Saving model ...
Epoch: 12 cost time: 0.8593058586120605
Epoch: 12, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.382 Vali Acc: 0.329 Test Loss: 3.382 Test Acc: 0.329
Validation loss decreased (-0.319967 --> -0.329378).  Saving model ...
Epoch: 13 cost time: 0.7496423721313477
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.409 Vali Acc: 0.316 Test Loss: 3.409 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.738051176071167
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.485 Vali Acc: 0.321 Test Loss: 3.485 Test Acc: 0.321
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7757911682128906
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.546 Vali Acc: 0.327 Test Loss: 3.546 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7881879806518555
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.598 Vali Acc: 0.325 Test Loss: 3.598 Test Acc: 0.325
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8582131862640381
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.595 Vali Acc: 0.327 Test Loss: 3.595 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8168084621429443
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.595 Vali Acc: 0.329 Test Loss: 3.595 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.7309870719909668
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.621 Vali Acc: 0.327 Test Loss: 3.621 Test Acc: 0.327
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8050999641418457
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.645 Vali Acc: 0.329 Test Loss: 3.645 Test Acc: 0.329
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.757282018661499
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.684 Vali Acc: 0.326 Test Loss: 3.684 Test Acc: 0.326
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.8125028610229492
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.698 Vali Acc: 0.333 Test Loss: 3.698 Test Acc: 0.333
Validation loss decreased (-0.329378 --> -0.332904).  Saving model ...
Epoch: 23 cost time: 0.7623453140258789
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.722 Vali Acc: 0.331 Test Loss: 3.722 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8183498382568359
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.745 Vali Acc: 0.328 Test Loss: 3.745 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8143675327301025
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.765 Vali Acc: 0.326 Test Loss: 3.765 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8308279514312744
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.770 Vali Acc: 0.327 Test Loss: 3.770 Test Acc: 0.327
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.758141279220581
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.785 Vali Acc: 0.327 Test Loss: 3.785 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7772598266601562
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.824 Vali Acc: 0.331 Test Loss: 3.824 Test Acc: 0.331
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.8171687126159668
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.832 Vali Acc: 0.329 Test Loss: 3.832 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6308989524841309
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.844 Vali Acc: 0.331 Test Loss: 3.844 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7403631210327148
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.857 Vali Acc: 0.328 Test Loss: 3.857 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6875958442687988
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.874 Vali Acc: 0.329 Test Loss: 3.874 Test Acc: 0.329
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33294117647058824
model parameter : 525046
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.457575798034668
Epoch: 1, Steps: 10 | Train Loss: 3.302 Vali Loss: 3.257 Vali Acc: 0.071 Test Loss: 3.257 Test Acc: 0.071
Validation loss decreased (inf --> -0.070556).  Saving model ...
Epoch: 2 cost time: 0.715825080871582
Epoch: 2, Steps: 10 | Train Loss: 3.016 Vali Loss: 3.210 Vali Acc: 0.124 Test Loss: 3.210 Test Acc: 0.124
Validation loss decreased (-0.070556 --> -0.123497).  Saving model ...
Epoch: 3 cost time: 0.7197484970092773
Epoch: 3, Steps: 10 | Train Loss: 2.654 Vali Loss: 3.180 Vali Acc: 0.155 Test Loss: 3.180 Test Acc: 0.155
Validation loss decreased (-0.123497 --> -0.155262).  Saving model ...
Epoch: 4 cost time: 0.6692473888397217
Epoch: 4, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.113 Vali Acc: 0.185 Test Loss: 3.113 Test Acc: 0.185
Validation loss decreased (-0.155262 --> -0.184675).  Saving model ...
Epoch: 5 cost time: 0.6743698120117188
Epoch: 5, Steps: 10 | Train Loss: 1.807 Vali Loss: 3.039 Vali Acc: 0.231 Test Loss: 3.039 Test Acc: 0.231
Validation loss decreased (-0.184675 --> -0.230558).  Saving model ...
Epoch: 6 cost time: 0.660855770111084
Epoch: 6, Steps: 10 | Train Loss: 1.363 Vali Loss: 3.008 Vali Acc: 0.251 Test Loss: 3.008 Test Acc: 0.251
Validation loss decreased (-0.230558 --> -0.250558).  Saving model ...
Epoch: 7 cost time: 0.6928970813751221
Epoch: 7, Steps: 10 | Train Loss: 1.018 Vali Loss: 3.003 Vali Acc: 0.278 Test Loss: 3.003 Test Acc: 0.278
Validation loss decreased (-0.250558 --> -0.277617).  Saving model ...
Epoch: 8 cost time: 0.4859766960144043
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.025 Vali Acc: 0.286 Test Loss: 3.025 Test Acc: 0.286
Validation loss decreased (-0.277617 --> -0.285852).  Saving model ...
Epoch: 9 cost time: 0.5316088199615479
Epoch: 9, Steps: 10 | Train Loss: 0.483 Vali Loss: 3.058 Vali Acc: 0.305 Test Loss: 3.058 Test Acc: 0.305
Validation loss decreased (-0.285852 --> -0.304675).  Saving model ...
Epoch: 10 cost time: 0.5513627529144287
Epoch: 10, Steps: 10 | Train Loss: 0.346 Vali Loss: 3.107 Vali Acc: 0.305 Test Loss: 3.107 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5850563049316406
Epoch: 11, Steps: 10 | Train Loss: 0.199 Vali Loss: 3.159 Vali Acc: 0.327 Test Loss: 3.159 Test Acc: 0.327
Validation loss decreased (-0.304675 --> -0.327027).  Saving model ...
Epoch: 12 cost time: 0.6168005466461182
Epoch: 12, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.267 Vali Acc: 0.320 Test Loss: 3.267 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6653680801391602
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.279 Vali Acc: 0.328 Test Loss: 3.279 Test Acc: 0.328
Validation loss decreased (-0.327027 --> -0.328203).  Saving model ...
Epoch: 14 cost time: 0.6870744228363037
Epoch: 14, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.326 Vali Acc: 0.329 Test Loss: 3.326 Test Acc: 0.329
Validation loss decreased (-0.328203 --> -0.329379).  Saving model ...
Epoch: 15 cost time: 0.6849589347839355
Epoch: 15, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.363 Vali Acc: 0.328 Test Loss: 3.363 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5738980770111084
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.411 Vali Acc: 0.335 Test Loss: 3.411 Test Acc: 0.335
Validation loss decreased (-0.329379 --> -0.335260).  Saving model ...
Epoch: 17 cost time: 0.7619397640228271
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.416 Vali Acc: 0.332 Test Loss: 3.416 Test Acc: 0.332
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6753957271575928
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.423 Vali Acc: 0.329 Test Loss: 3.423 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.71366286277771
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.439 Vali Acc: 0.332 Test Loss: 3.439 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7843959331512451
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.458 Vali Acc: 0.335 Test Loss: 3.458 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7225627899169922
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.484 Vali Acc: 0.339 Test Loss: 3.484 Test Acc: 0.339
Validation loss decreased (-0.335260 --> -0.338789).  Saving model ...
Epoch: 22 cost time: 0.6113533973693848
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.513 Vali Acc: 0.334 Test Loss: 3.513 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6203014850616455
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.540 Vali Acc: 0.338 Test Loss: 3.540 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7125251293182373
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.559 Vali Acc: 0.336 Test Loss: 3.559 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7402534484863281
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.588 Vali Acc: 0.338 Test Loss: 3.588 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6560671329498291
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.604 Vali Acc: 0.340 Test Loss: 3.604 Test Acc: 0.340
Validation loss decreased (-0.338789 --> -0.339964).  Saving model ...
Epoch: 27 cost time: 0.8201889991760254
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.611 Vali Acc: 0.340 Test Loss: 3.611 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7701170444488525
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.629 Vali Acc: 0.340 Test Loss: 3.629 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.8971753120422363
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.639 Vali Acc: 0.339 Test Loss: 3.639 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.8730471134185791
Epoch: 30, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.653 Vali Acc: 0.338 Test Loss: 3.653 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7290675640106201
Epoch: 31, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.666 Vali Acc: 0.344 Test Loss: 3.666 Test Acc: 0.344
Validation loss decreased (-0.339964 --> -0.343493).  Saving model ...
Epoch: 32 cost time: 0.8065192699432373
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.679 Vali Acc: 0.341 Test Loss: 3.679 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8264446258544922
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.693 Vali Acc: 0.340 Test Loss: 3.693 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7825767993927002
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.718 Vali Acc: 0.338 Test Loss: 3.718 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8056545257568359
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.730 Vali Acc: 0.338 Test Loss: 3.730 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8759903907775879
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.739 Vali Acc: 0.340 Test Loss: 3.739 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8710033893585205
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.753 Vali Acc: 0.335 Test Loss: 3.753 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8569519519805908
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.758 Vali Acc: 0.335 Test Loss: 3.758 Test Acc: 0.335
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8557219505310059
Epoch: 39, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.765 Vali Acc: 0.336 Test Loss: 3.765 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8129632472991943
Epoch: 40, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.776 Vali Acc: 0.338 Test Loss: 3.776 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.790795087814331
Epoch: 41, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.784 Vali Acc: 0.338 Test Loss: 3.784 Test Acc: 0.338
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 525046
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.311075210571289
Epoch: 1, Steps: 10 | Train Loss: 3.264 Vali Loss: 3.247 Vali Acc: 0.074 Test Loss: 3.247 Test Acc: 0.074
Validation loss decreased (inf --> -0.074085).  Saving model ...
Epoch: 2 cost time: 0.6927175521850586
Epoch: 2, Steps: 10 | Train Loss: 3.058 Vali Loss: 3.216 Vali Acc: 0.106 Test Loss: 3.216 Test Acc: 0.106
Validation loss decreased (-0.074085 --> -0.105850).  Saving model ...
Epoch: 3 cost time: 0.7477397918701172
Epoch: 3, Steps: 10 | Train Loss: 2.777 Vali Loss: 3.200 Vali Acc: 0.128 Test Loss: 3.200 Test Acc: 0.128
Validation loss decreased (-0.105850 --> -0.128203).  Saving model ...
Epoch: 4 cost time: 0.6404151916503906
Epoch: 4, Steps: 10 | Train Loss: 2.443 Vali Loss: 3.155 Vali Acc: 0.148 Test Loss: 3.155 Test Acc: 0.148
Validation loss decreased (-0.128203 --> -0.148204).  Saving model ...
Epoch: 5 cost time: 0.6636614799499512
Epoch: 5, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.081 Vali Acc: 0.196 Test Loss: 3.081 Test Acc: 0.196
Validation loss decreased (-0.148204 --> -0.196440).  Saving model ...
Epoch: 6 cost time: 0.6134195327758789
Epoch: 6, Steps: 10 | Train Loss: 1.705 Vali Loss: 3.026 Vali Acc: 0.207 Test Loss: 3.026 Test Acc: 0.207
Validation loss decreased (-0.196440 --> -0.207029).  Saving model ...
Epoch: 7 cost time: 0.6692583560943604
Epoch: 7, Steps: 10 | Train Loss: 1.369 Vali Loss: 2.982 Vali Acc: 0.236 Test Loss: 2.982 Test Acc: 0.236
Validation loss decreased (-0.207029 --> -0.236441).  Saving model ...
Epoch: 8 cost time: 0.7137355804443359
Epoch: 8, Steps: 10 | Train Loss: 1.050 Vali Loss: 2.979 Vali Acc: 0.238 Test Loss: 2.979 Test Acc: 0.238
Validation loss decreased (-0.236441 --> -0.237617).  Saving model ...
Epoch: 9 cost time: 0.6080131530761719
Epoch: 9, Steps: 10 | Train Loss: 0.752 Vali Loss: 2.983 Vali Acc: 0.259 Test Loss: 2.983 Test Acc: 0.259
Validation loss decreased (-0.237617 --> -0.258794).  Saving model ...
Epoch: 10 cost time: 0.6922852993011475
Epoch: 10, Steps: 10 | Train Loss: 0.586 Vali Loss: 3.013 Vali Acc: 0.271 Test Loss: 3.013 Test Acc: 0.271
Validation loss decreased (-0.258794 --> -0.270558).  Saving model ...
Epoch: 11 cost time: 0.6981964111328125
Epoch: 11, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.027 Vali Acc: 0.281 Test Loss: 3.027 Test Acc: 0.281
Validation loss decreased (-0.270558 --> -0.281146).  Saving model ...
Epoch: 12 cost time: 0.6376044750213623
Epoch: 12, Steps: 10 | Train Loss: 0.242 Vali Loss: 3.132 Vali Acc: 0.293 Test Loss: 3.132 Test Acc: 0.293
Validation loss decreased (-0.281146 --> -0.292910).  Saving model ...
Epoch: 13 cost time: 0.6659908294677734
Epoch: 13, Steps: 10 | Train Loss: 0.140 Vali Loss: 3.162 Vali Acc: 0.301 Test Loss: 3.162 Test Acc: 0.301
Validation loss decreased (-0.292910 --> -0.301145).  Saving model ...
Epoch: 14 cost time: 0.7144227027893066
Epoch: 14, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.225 Vali Acc: 0.304 Test Loss: 3.225 Test Acc: 0.304
Validation loss decreased (-0.301145 --> -0.303497).  Saving model ...
Epoch: 15 cost time: 0.7145538330078125
Epoch: 15, Steps: 10 | Train Loss: 0.064 Vali Loss: 3.267 Vali Acc: 0.301 Test Loss: 3.267 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6791567802429199
Epoch: 16, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.334 Vali Acc: 0.304 Test Loss: 3.334 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6999821662902832
Epoch: 17, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.330 Vali Acc: 0.307 Test Loss: 3.330 Test Acc: 0.307
Validation loss decreased (-0.303497 --> -0.307026).  Saving model ...
Epoch: 18 cost time: 0.7644977569580078
Epoch: 18, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.345 Vali Acc: 0.314 Test Loss: 3.345 Test Acc: 0.314
Validation loss decreased (-0.307026 --> -0.314084).  Saving model ...
Epoch: 19 cost time: 0.7907764911651611
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.371 Vali Acc: 0.299 Test Loss: 3.371 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.77774977684021
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.399 Vali Acc: 0.296 Test Loss: 3.399 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.592005729675293
Epoch: 21, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.441 Vali Acc: 0.296 Test Loss: 3.441 Test Acc: 0.296
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5518350601196289
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.454 Vali Acc: 0.306 Test Loss: 3.454 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5657193660736084
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.480 Vali Acc: 0.304 Test Loss: 3.480 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.59259033203125
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.505 Vali Acc: 0.302 Test Loss: 3.505 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.6088829040527344
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.535 Vali Acc: 0.304 Test Loss: 3.535 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6912307739257812
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.553 Vali Acc: 0.302 Test Loss: 3.553 Test Acc: 0.302
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6882758140563965
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.568 Vali Acc: 0.301 Test Loss: 3.568 Test Acc: 0.301
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7131903171539307
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.586 Vali Acc: 0.300 Test Loss: 3.586 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 525046
model size : 3.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.28016996383667
Epoch: 1, Steps: 10 | Train Loss: 3.456 Vali Loss: 3.328 Vali Acc: 0.019 Test Loss: 3.328 Test Acc: 0.019
Validation loss decreased (inf --> -0.018790).  Saving model ...
Epoch: 2 cost time: 0.6058526039123535
Epoch: 2, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.276 Vali Acc: 0.075 Test Loss: 3.276 Test Acc: 0.075
Validation loss decreased (-0.018790 --> -0.075261).  Saving model ...
Epoch: 3 cost time: 0.7332782745361328
Epoch: 3, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.253 Vali Acc: 0.133 Test Loss: 3.253 Test Acc: 0.133
Validation loss decreased (-0.075261 --> -0.132909).  Saving model ...
Epoch: 4 cost time: 0.7360274791717529
Epoch: 4, Steps: 10 | Train Loss: 2.120 Vali Loss: 3.168 Vali Acc: 0.188 Test Loss: 3.168 Test Acc: 0.188
Validation loss decreased (-0.132909 --> -0.188204).  Saving model ...
Epoch: 5 cost time: 0.7821431159973145
Epoch: 5, Steps: 10 | Train Loss: 1.631 Vali Loss: 3.094 Vali Acc: 0.211 Test Loss: 3.094 Test Acc: 0.211
Validation loss decreased (-0.188204 --> -0.210557).  Saving model ...
Epoch: 6 cost time: 0.7624459266662598
Epoch: 6, Steps: 10 | Train Loss: 1.243 Vali Loss: 3.129 Vali Acc: 0.232 Test Loss: 3.129 Test Acc: 0.232
Validation loss decreased (-0.210557 --> -0.231733).  Saving model ...
Epoch: 7 cost time: 0.7079644203186035
Epoch: 7, Steps: 10 | Train Loss: 0.869 Vali Loss: 3.148 Vali Acc: 0.258 Test Loss: 3.148 Test Acc: 0.258
Validation loss decreased (-0.231733 --> -0.257616).  Saving model ...
Epoch: 8 cost time: 0.7628791332244873
Epoch: 8, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.200 Vali Acc: 0.280 Test Loss: 3.200 Test Acc: 0.280
Validation loss decreased (-0.257616 --> -0.279968).  Saving model ...
Epoch: 9 cost time: 0.6802828311920166
Epoch: 9, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.299 Vali Acc: 0.286 Test Loss: 3.299 Test Acc: 0.286
Validation loss decreased (-0.279968 --> -0.285849).  Saving model ...
Epoch: 10 cost time: 0.6736366748809814
Epoch: 10, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.322 Vali Acc: 0.304 Test Loss: 3.322 Test Acc: 0.304
Validation loss decreased (-0.285849 --> -0.303496).  Saving model ...
Epoch: 11 cost time: 0.6470766067504883
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.431 Vali Acc: 0.306 Test Loss: 3.431 Test Acc: 0.306
Validation loss decreased (-0.303496 --> -0.305848).  Saving model ...
Epoch: 12 cost time: 0.7248284816741943
Epoch: 12, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.527 Vali Acc: 0.312 Test Loss: 3.527 Test Acc: 0.312
Validation loss decreased (-0.305848 --> -0.311729).  Saving model ...
Epoch: 13 cost time: 0.7904872894287109
Epoch: 13, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.590 Vali Acc: 0.309 Test Loss: 3.590 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7559065818786621
Epoch: 14, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.617 Vali Acc: 0.319 Test Loss: 3.617 Test Acc: 0.319
Validation loss decreased (-0.311729 --> -0.318787).  Saving model ...
Epoch: 15 cost time: 0.8425078392028809
Epoch: 15, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.681 Vali Acc: 0.316 Test Loss: 3.681 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8221704959869385
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.716 Vali Acc: 0.313 Test Loss: 3.716 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.769582986831665
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.743 Vali Acc: 0.319 Test Loss: 3.743 Test Acc: 0.319
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7526228427886963
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.787 Vali Acc: 0.318 Test Loss: 3.787 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6691508293151855
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.823 Vali Acc: 0.331 Test Loss: 3.823 Test Acc: 0.331
Validation loss decreased (-0.318787 --> -0.330550).  Saving model ...
Epoch: 20 cost time: 0.788682222366333
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.855 Vali Acc: 0.326 Test Loss: 3.855 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.801084041595459
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.866 Vali Acc: 0.319 Test Loss: 3.866 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6854839324951172
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.880 Vali Acc: 0.320 Test Loss: 3.880 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7283408641815186
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.914 Vali Acc: 0.322 Test Loss: 3.914 Test Acc: 0.322
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7218730449676514
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.923 Vali Acc: 0.327 Test Loss: 3.923 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6745700836181641
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.935 Vali Acc: 0.329 Test Loss: 3.935 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7553248405456543
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.948 Vali Acc: 0.326 Test Loss: 3.948 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8373034000396729
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.967 Vali Acc: 0.326 Test Loss: 3.967 Test Acc: 0.326
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.804940938949585
Epoch: 28, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.992 Vali Acc: 0.324 Test Loss: 3.992 Test Acc: 0.324
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7660496234893799
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.012 Vali Acc: 0.325 Test Loss: 4.012 Test Acc: 0.325
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3305882352941176
model parameter : 393974
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3806040287017822
Epoch: 1, Steps: 10 | Train Loss: 3.430 Vali Loss: 3.322 Vali Acc: 0.020 Test Loss: 3.322 Test Acc: 0.020
Validation loss decreased (inf --> -0.019967).  Saving model ...
Epoch: 2 cost time: 0.7040209770202637
Epoch: 2, Steps: 10 | Train Loss: 3.123 Vali Loss: 3.272 Vali Acc: 0.073 Test Loss: 3.272 Test Acc: 0.073
Validation loss decreased (-0.019967 --> -0.072908).  Saving model ...
Epoch: 3 cost time: 0.8432679176330566
Epoch: 3, Steps: 10 | Train Loss: 2.665 Vali Loss: 3.244 Vali Acc: 0.132 Test Loss: 3.244 Test Acc: 0.132
Validation loss decreased (-0.072908 --> -0.131732).  Saving model ...
Epoch: 4 cost time: 0.7093534469604492
Epoch: 4, Steps: 10 | Train Loss: 2.156 Vali Loss: 3.160 Vali Acc: 0.173 Test Loss: 3.160 Test Acc: 0.173
Validation loss decreased (-0.131732 --> -0.172910).  Saving model ...
Epoch: 5 cost time: 0.7242734432220459
Epoch: 5, Steps: 10 | Train Loss: 1.681 Vali Loss: 3.077 Vali Acc: 0.224 Test Loss: 3.077 Test Acc: 0.224
Validation loss decreased (-0.172910 --> -0.223499).  Saving model ...
Epoch: 6 cost time: 0.7566583156585693
Epoch: 6, Steps: 10 | Train Loss: 1.298 Vali Loss: 3.091 Vali Acc: 0.235 Test Loss: 3.091 Test Acc: 0.235
Validation loss decreased (-0.223499 --> -0.235263).  Saving model ...
Epoch: 7 cost time: 0.8106570243835449
Epoch: 7, Steps: 10 | Train Loss: 0.911 Vali Loss: 3.095 Vali Acc: 0.267 Test Loss: 3.095 Test Acc: 0.267
Validation loss decreased (-0.235263 --> -0.267028).  Saving model ...
Epoch: 8 cost time: 0.7800118923187256
Epoch: 8, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.141 Vali Acc: 0.278 Test Loss: 3.141 Test Acc: 0.278
Validation loss decreased (-0.267028 --> -0.277616).  Saving model ...
Epoch: 9 cost time: 0.8053293228149414
Epoch: 9, Steps: 10 | Train Loss: 0.413 Vali Loss: 3.213 Vali Acc: 0.295 Test Loss: 3.213 Test Acc: 0.295
Validation loss decreased (-0.277616 --> -0.295262).  Saving model ...
Epoch: 10 cost time: 0.8781404495239258
Epoch: 10, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.254 Vali Acc: 0.313 Test Loss: 3.254 Test Acc: 0.313
Validation loss decreased (-0.295262 --> -0.312909).  Saving model ...
Epoch: 11 cost time: 0.7920913696289062
Epoch: 11, Steps: 10 | Train Loss: 0.184 Vali Loss: 3.348 Vali Acc: 0.314 Test Loss: 3.348 Test Acc: 0.314
Validation loss decreased (-0.312909 --> -0.314084).  Saving model ...
Epoch: 12 cost time: 0.7361373901367188
Epoch: 12, Steps: 10 | Train Loss: 0.112 Vali Loss: 3.432 Vali Acc: 0.318 Test Loss: 3.432 Test Acc: 0.318
Validation loss decreased (-0.314084 --> -0.317613).  Saving model ...
Epoch: 13 cost time: 0.770247220993042
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.483 Vali Acc: 0.319 Test Loss: 3.483 Test Acc: 0.319
Validation loss decreased (-0.317613 --> -0.318789).  Saving model ...
Epoch: 14 cost time: 0.6967098712921143
Epoch: 14, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.502 Vali Acc: 0.320 Test Loss: 3.502 Test Acc: 0.320
Validation loss decreased (-0.318789 --> -0.319965).  Saving model ...
Epoch: 15 cost time: 0.7649459838867188
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.554 Vali Acc: 0.327 Test Loss: 3.554 Test Acc: 0.327
Validation loss decreased (-0.319965 --> -0.327023).  Saving model ...
Epoch: 16 cost time: 0.7165439128875732
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.586 Vali Acc: 0.327 Test Loss: 3.586 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7913937568664551
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.628 Vali Acc: 0.331 Test Loss: 3.628 Test Acc: 0.331
Validation loss decreased (-0.327023 --> -0.330552).  Saving model ...
Epoch: 18 cost time: 0.7904589176177979
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.668 Vali Acc: 0.320 Test Loss: 3.668 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.736522912979126
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.687 Vali Acc: 0.327 Test Loss: 3.687 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7593245506286621
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.708 Vali Acc: 0.334 Test Loss: 3.708 Test Acc: 0.334
Validation loss decreased (-0.330552 --> -0.334081).  Saving model ...
Epoch: 21 cost time: 0.761406421661377
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.710 Vali Acc: 0.334 Test Loss: 3.710 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7340350151062012
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.722 Vali Acc: 0.338 Test Loss: 3.722 Test Acc: 0.338
Validation loss decreased (-0.334081 --> -0.337610).  Saving model ...
Epoch: 23 cost time: 0.7609684467315674
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.758 Vali Acc: 0.339 Test Loss: 3.758 Test Acc: 0.339
Validation loss decreased (-0.337610 --> -0.338786).  Saving model ...
Epoch: 24 cost time: 0.7994835376739502
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.777 Vali Acc: 0.336 Test Loss: 3.777 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8053061962127686
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.790 Vali Acc: 0.332 Test Loss: 3.790 Test Acc: 0.332
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8153610229492188
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.806 Vali Acc: 0.334 Test Loss: 3.806 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7092504501342773
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.824 Vali Acc: 0.335 Test Loss: 3.824 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.753765344619751
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.848 Vali Acc: 0.339 Test Loss: 3.848 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6750566959381104
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.866 Vali Acc: 0.338 Test Loss: 3.866 Test Acc: 0.338
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7283878326416016
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.875 Vali Acc: 0.336 Test Loss: 3.875 Test Acc: 0.336
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7076084613800049
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.886 Vali Acc: 0.336 Test Loss: 3.886 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8583602905273438
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.903 Vali Acc: 0.336 Test Loss: 3.903 Test Acc: 0.336
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.8096280097961426
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.930 Vali Acc: 0.336 Test Loss: 3.930 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3388235294117647
model parameter : 393974
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.349224090576172
Epoch: 1, Steps: 10 | Train Loss: 3.379 Vali Loss: 3.286 Vali Acc: 0.035 Test Loss: 3.286 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.7253639698028564
Epoch: 2, Steps: 10 | Train Loss: 3.118 Vali Loss: 3.241 Vali Acc: 0.065 Test Loss: 3.241 Test Acc: 0.065
Validation loss decreased (-0.035261 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.6989264488220215
Epoch: 3, Steps: 10 | Train Loss: 2.691 Vali Loss: 3.215 Vali Acc: 0.132 Test Loss: 3.215 Test Acc: 0.132
Validation loss decreased (-0.064673 --> -0.131733).  Saving model ...
Epoch: 4 cost time: 0.6297008991241455
Epoch: 4, Steps: 10 | Train Loss: 2.239 Vali Loss: 3.136 Vali Acc: 0.181 Test Loss: 3.136 Test Acc: 0.181
Validation loss decreased (-0.131733 --> -0.181145).  Saving model ...
Epoch: 5 cost time: 0.8195984363555908
Epoch: 5, Steps: 10 | Train Loss: 1.782 Vali Loss: 3.034 Vali Acc: 0.219 Test Loss: 3.034 Test Acc: 0.219
Validation loss decreased (-0.181145 --> -0.218793).  Saving model ...
Epoch: 6 cost time: 0.7165985107421875
Epoch: 6, Steps: 10 | Train Loss: 1.396 Vali Loss: 3.014 Vali Acc: 0.247 Test Loss: 3.014 Test Acc: 0.247
Validation loss decreased (-0.218793 --> -0.247029).  Saving model ...
Epoch: 7 cost time: 0.780651330947876
Epoch: 7, Steps: 10 | Train Loss: 0.995 Vali Loss: 2.999 Vali Acc: 0.274 Test Loss: 2.999 Test Acc: 0.274
Validation loss decreased (-0.247029 --> -0.274088).  Saving model ...
Epoch: 8 cost time: 0.762017011642456
Epoch: 8, Steps: 10 | Train Loss: 0.714 Vali Loss: 3.029 Vali Acc: 0.276 Test Loss: 3.029 Test Acc: 0.276
Validation loss decreased (-0.274088 --> -0.276440).  Saving model ...
Epoch: 9 cost time: 0.7434990406036377
Epoch: 9, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.078 Vali Acc: 0.300 Test Loss: 3.078 Test Acc: 0.300
Validation loss decreased (-0.276440 --> -0.299969).  Saving model ...
Epoch: 10 cost time: 0.7444705963134766
Epoch: 10, Steps: 10 | Train Loss: 0.308 Vali Loss: 3.121 Vali Acc: 0.321 Test Loss: 3.121 Test Acc: 0.321
Validation loss decreased (-0.299969 --> -0.321145).  Saving model ...
Epoch: 11 cost time: 0.7351088523864746
Epoch: 11, Steps: 10 | Train Loss: 0.200 Vali Loss: 3.208 Vali Acc: 0.314 Test Loss: 3.208 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7260034084320068
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.268 Vali Acc: 0.311 Test Loss: 3.268 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7596378326416016
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.315 Vali Acc: 0.334 Test Loss: 3.315 Test Acc: 0.334
Validation loss decreased (-0.321145 --> -0.334085).  Saving model ...
Epoch: 14 cost time: 0.7069118022918701
Epoch: 14, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.320 Vali Acc: 0.338 Test Loss: 3.320 Test Acc: 0.338
Validation loss decreased (-0.334085 --> -0.337614).  Saving model ...
Epoch: 15 cost time: 0.6997795104980469
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.391 Vali Acc: 0.334 Test Loss: 3.391 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5673236846923828
Epoch: 16, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.412 Vali Acc: 0.329 Test Loss: 3.412 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6073408126831055
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.430 Vali Acc: 0.334 Test Loss: 3.430 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7189555168151855
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.462 Vali Acc: 0.339 Test Loss: 3.462 Test Acc: 0.339
Validation loss decreased (-0.337614 --> -0.338789).  Saving model ...
Epoch: 19 cost time: 0.7725059986114502
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.504 Vali Acc: 0.335 Test Loss: 3.504 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7813994884490967
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.524 Vali Acc: 0.341 Test Loss: 3.524 Test Acc: 0.341
Validation loss decreased (-0.338789 --> -0.341141).  Saving model ...
Epoch: 21 cost time: 0.7635455131530762
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.531 Vali Acc: 0.344 Test Loss: 3.531 Test Acc: 0.344
Validation loss decreased (-0.341141 --> -0.343494).  Saving model ...
Epoch: 22 cost time: 0.7168970108032227
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.537 Vali Acc: 0.341 Test Loss: 3.537 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8119595050811768
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.563 Vali Acc: 0.345 Test Loss: 3.563 Test Acc: 0.345
Validation loss decreased (-0.343494 --> -0.344670).  Saving model ...
Epoch: 24 cost time: 0.7460029125213623
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.580 Vali Acc: 0.340 Test Loss: 3.580 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7631921768188477
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.600 Vali Acc: 0.340 Test Loss: 3.600 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7236514091491699
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.622 Vali Acc: 0.332 Test Loss: 3.622 Test Acc: 0.332
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7173135280609131
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.644 Vali Acc: 0.338 Test Loss: 3.644 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7281434535980225
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.670 Vali Acc: 0.338 Test Loss: 3.670 Test Acc: 0.338
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7949423789978027
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.683 Vali Acc: 0.341 Test Loss: 3.683 Test Acc: 0.341
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7158646583557129
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.683 Vali Acc: 0.339 Test Loss: 3.683 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7174816131591797
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.692 Vali Acc: 0.336 Test Loss: 3.692 Test Acc: 0.336
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7854163646697998
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.705 Vali Acc: 0.338 Test Loss: 3.705 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7747571468353271
Epoch: 33, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.735 Vali Acc: 0.334 Test Loss: 3.735 Test Acc: 0.334
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 393974
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2882461547851562
Epoch: 1, Steps: 10 | Train Loss: 3.309 Vali Loss: 3.265 Vali Acc: 0.048 Test Loss: 3.265 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 0.6864910125732422
Epoch: 2, Steps: 10 | Train Loss: 3.106 Vali Loss: 3.235 Vali Acc: 0.079 Test Loss: 3.235 Test Acc: 0.079
Validation loss decreased (-0.048203 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.6899311542510986
Epoch: 3, Steps: 10 | Train Loss: 2.782 Vali Loss: 3.220 Vali Acc: 0.118 Test Loss: 3.220 Test Acc: 0.118
Validation loss decreased (-0.078791 --> -0.117615).  Saving model ...
Epoch: 4 cost time: 0.5632410049438477
Epoch: 4, Steps: 10 | Train Loss: 2.442 Vali Loss: 3.168 Vali Acc: 0.167 Test Loss: 3.168 Test Acc: 0.167
Validation loss decreased (-0.117615 --> -0.167027).  Saving model ...
Epoch: 5 cost time: 0.6580049991607666
Epoch: 5, Steps: 10 | Train Loss: 2.090 Vali Loss: 3.082 Vali Acc: 0.202 Test Loss: 3.082 Test Acc: 0.202
Validation loss decreased (-0.167027 --> -0.202322).  Saving model ...
Epoch: 6 cost time: 0.6526906490325928
Epoch: 6, Steps: 10 | Train Loss: 1.756 Vali Loss: 3.034 Vali Acc: 0.224 Test Loss: 3.034 Test Acc: 0.224
Validation loss decreased (-0.202322 --> -0.223499).  Saving model ...
Epoch: 7 cost time: 0.5934908390045166
Epoch: 7, Steps: 10 | Train Loss: 1.338 Vali Loss: 2.985 Vali Acc: 0.233 Test Loss: 2.985 Test Acc: 0.233
Validation loss decreased (-0.223499 --> -0.232911).  Saving model ...
Epoch: 8 cost time: 0.7732806205749512
Epoch: 8, Steps: 10 | Train Loss: 1.013 Vali Loss: 2.978 Vali Acc: 0.252 Test Loss: 2.978 Test Acc: 0.252
Validation loss decreased (-0.232911 --> -0.251735).  Saving model ...
Epoch: 9 cost time: 0.6632881164550781
Epoch: 9, Steps: 10 | Train Loss: 0.734 Vali Loss: 2.992 Vali Acc: 0.268 Test Loss: 2.992 Test Acc: 0.268
Validation loss decreased (-0.251735 --> -0.268205).  Saving model ...
Epoch: 10 cost time: 0.6608569622039795
Epoch: 10, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.017 Vali Acc: 0.282 Test Loss: 3.017 Test Acc: 0.282
Validation loss decreased (-0.268205 --> -0.282323).  Saving model ...
Epoch: 11 cost time: 0.6560807228088379
Epoch: 11, Steps: 10 | Train Loss: 0.329 Vali Loss: 3.077 Vali Acc: 0.286 Test Loss: 3.077 Test Acc: 0.286
Validation loss decreased (-0.282323 --> -0.285852).  Saving model ...
Epoch: 12 cost time: 0.6663744449615479
Epoch: 12, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.153 Vali Acc: 0.289 Test Loss: 3.153 Test Acc: 0.289
Validation loss decreased (-0.285852 --> -0.289380).  Saving model ...
Epoch: 13 cost time: 0.693795919418335
Epoch: 13, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.190 Vali Acc: 0.307 Test Loss: 3.190 Test Acc: 0.307
Validation loss decreased (-0.289380 --> -0.307027).  Saving model ...
Epoch: 14 cost time: 0.7847225666046143
Epoch: 14, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.212 Vali Acc: 0.307 Test Loss: 3.212 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7574200630187988
Epoch: 15, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.304 Vali Acc: 0.309 Test Loss: 3.304 Test Acc: 0.309
Validation loss decreased (-0.307027 --> -0.309379).  Saving model ...
Epoch: 16 cost time: 0.6960124969482422
Epoch: 16, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.334 Vali Acc: 0.305 Test Loss: 3.334 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7132411003112793
Epoch: 17, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.372 Vali Acc: 0.306 Test Loss: 3.372 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7312831878662109
Epoch: 18, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.403 Vali Acc: 0.298 Test Loss: 3.403 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.708979606628418
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.444 Vali Acc: 0.302 Test Loss: 3.444 Test Acc: 0.302
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7791647911071777
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.480 Vali Acc: 0.309 Test Loss: 3.480 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.7761092185974121
Epoch: 21, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.489 Vali Acc: 0.311 Test Loss: 3.489 Test Acc: 0.311
Validation loss decreased (-0.309379 --> -0.310553).  Saving model ...
Epoch: 22 cost time: 0.7212090492248535
Epoch: 22, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.502 Vali Acc: 0.309 Test Loss: 3.502 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7316603660583496
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.537 Vali Acc: 0.308 Test Loss: 3.537 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7677342891693115
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.553 Vali Acc: 0.308 Test Loss: 3.553 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7719545364379883
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.578 Vali Acc: 0.304 Test Loss: 3.578 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7074751853942871
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.602 Vali Acc: 0.304 Test Loss: 3.602 Test Acc: 0.304
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6352622509002686
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.622 Vali Acc: 0.301 Test Loss: 3.622 Test Acc: 0.301
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7025406360626221
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.641 Vali Acc: 0.304 Test Loss: 3.641 Test Acc: 0.304
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6054956912994385
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.658 Vali Acc: 0.306 Test Loss: 3.658 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7326228618621826
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.672 Vali Acc: 0.305 Test Loss: 3.672 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7120115756988525
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.690 Vali Acc: 0.305 Test Loss: 3.690 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 393974
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.259063482284546
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.323 Vali Acc: 0.056 Test Loss: 3.323 Test Acc: 0.056
Validation loss decreased (inf --> -0.056437).  Saving model ...
Epoch: 2 cost time: 0.7668578624725342
Epoch: 2, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.294 Vali Acc: 0.095 Test Loss: 3.294 Test Acc: 0.095
Validation loss decreased (-0.056437 --> -0.095261).  Saving model ...
Epoch: 3 cost time: 0.6987793445587158
Epoch: 3, Steps: 10 | Train Loss: 2.535 Vali Loss: 3.264 Vali Acc: 0.124 Test Loss: 3.264 Test Acc: 0.124
Validation loss decreased (-0.095261 --> -0.123497).  Saving model ...
Epoch: 4 cost time: 0.7513158321380615
Epoch: 4, Steps: 10 | Train Loss: 2.084 Vali Loss: 3.161 Vali Acc: 0.174 Test Loss: 3.161 Test Acc: 0.174
Validation loss decreased (-0.123497 --> -0.174086).  Saving model ...
Epoch: 5 cost time: 0.7279613018035889
Epoch: 5, Steps: 10 | Train Loss: 1.641 Vali Loss: 3.149 Vali Acc: 0.218 Test Loss: 3.149 Test Acc: 0.218
Validation loss decreased (-0.174086 --> -0.217616).  Saving model ...
Epoch: 6 cost time: 0.6700825691223145
Epoch: 6, Steps: 10 | Train Loss: 1.207 Vali Loss: 3.157 Vali Acc: 0.249 Test Loss: 3.157 Test Acc: 0.249
Validation loss decreased (-0.217616 --> -0.249380).  Saving model ...
Epoch: 7 cost time: 0.6567065715789795
Epoch: 7, Steps: 10 | Train Loss: 0.894 Vali Loss: 3.176 Vali Acc: 0.272 Test Loss: 3.176 Test Acc: 0.272
Validation loss decreased (-0.249380 --> -0.271733).  Saving model ...
Epoch: 8 cost time: 0.7046308517456055
Epoch: 8, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.249 Vali Acc: 0.287 Test Loss: 3.249 Test Acc: 0.287
Validation loss decreased (-0.271733 --> -0.287026).  Saving model ...
Epoch: 9 cost time: 0.7303555011749268
Epoch: 9, Steps: 10 | Train Loss: 0.432 Vali Loss: 3.279 Vali Acc: 0.298 Test Loss: 3.279 Test Acc: 0.298
Validation loss decreased (-0.287026 --> -0.297614).  Saving model ...
Epoch: 10 cost time: 0.7169935703277588
Epoch: 10, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.375 Vali Acc: 0.324 Test Loss: 3.375 Test Acc: 0.324
Validation loss decreased (-0.297614 --> -0.323496).  Saving model ...
Epoch: 11 cost time: 0.7338237762451172
Epoch: 11, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.430 Vali Acc: 0.326 Test Loss: 3.430 Test Acc: 0.326
Validation loss decreased (-0.323496 --> -0.325848).  Saving model ...
Epoch: 12 cost time: 0.8442692756652832
Epoch: 12, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.572 Vali Acc: 0.326 Test Loss: 3.572 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8043053150177002
Epoch: 13, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.555 Vali Acc: 0.339 Test Loss: 3.555 Test Acc: 0.339
Validation loss decreased (-0.325848 --> -0.338788).  Saving model ...
Epoch: 14 cost time: 0.8133788108825684
Epoch: 14, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.648 Vali Acc: 0.339 Test Loss: 3.648 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7328360080718994
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.709 Vali Acc: 0.327 Test Loss: 3.709 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8133881092071533
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.751 Vali Acc: 0.336 Test Loss: 3.751 Test Acc: 0.336
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7156267166137695
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.766 Vali Acc: 0.342 Test Loss: 3.766 Test Acc: 0.342
Validation loss decreased (-0.338788 --> -0.342315).  Saving model ...
Epoch: 18 cost time: 0.6741735935211182
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.804 Vali Acc: 0.335 Test Loss: 3.804 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7922823429107666
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.839 Vali Acc: 0.334 Test Loss: 3.839 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8284075260162354
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.860 Vali Acc: 0.341 Test Loss: 3.860 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6741073131561279
Epoch: 21, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.893 Vali Acc: 0.341 Test Loss: 3.893 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8038361072540283
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.915 Vali Acc: 0.339 Test Loss: 3.915 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.7406735420227051
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.927 Vali Acc: 0.339 Test Loss: 3.927 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8178210258483887
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.926 Vali Acc: 0.344 Test Loss: 3.926 Test Acc: 0.344
Validation loss decreased (-0.342315 --> -0.343490).  Saving model ...
Epoch: 25 cost time: 0.7768802642822266
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.941 Vali Acc: 0.339 Test Loss: 3.941 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8008811473846436
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.967 Vali Acc: 0.345 Test Loss: 3.967 Test Acc: 0.345
Validation loss decreased (-0.343490 --> -0.344666).  Saving model ...
Epoch: 27 cost time: 0.7593047618865967
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.982 Vali Acc: 0.340 Test Loss: 3.982 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7467880249023438
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.992 Vali Acc: 0.338 Test Loss: 3.992 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.754492998123169
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.013 Vali Acc: 0.339 Test Loss: 4.013 Test Acc: 0.339
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5868575572967529
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.027 Vali Acc: 0.340 Test Loss: 4.027 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7106881141662598
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.042 Vali Acc: 0.339 Test Loss: 4.042 Test Acc: 0.339
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.743748664855957
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.064 Vali Acc: 0.342 Test Loss: 4.064 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6562449932098389
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.090 Vali Acc: 0.340 Test Loss: 4.090 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6966814994812012
Epoch: 34, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.109 Vali Acc: 0.344 Test Loss: 4.109 Test Acc: 0.344
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.7079403400421143
Epoch: 35, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.121 Vali Acc: 0.342 Test Loss: 4.121 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.847015380859375
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.139 Vali Acc: 0.342 Test Loss: 4.139 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 328438
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5770423412323
Epoch: 1, Steps: 10 | Train Loss: 3.328 Vali Loss: 3.318 Vali Acc: 0.068 Test Loss: 3.318 Test Acc: 0.068
Validation loss decreased (inf --> -0.068202).  Saving model ...
Epoch: 2 cost time: 0.5606391429901123
Epoch: 2, Steps: 10 | Train Loss: 3.051 Vali Loss: 3.286 Vali Acc: 0.084 Test Loss: 3.286 Test Acc: 0.084
Validation loss decreased (-0.068202 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 0.7528753280639648
Epoch: 3, Steps: 10 | Train Loss: 2.559 Vali Loss: 3.257 Vali Acc: 0.133 Test Loss: 3.257 Test Acc: 0.133
Validation loss decreased (-0.083497 --> -0.132909).  Saving model ...
Epoch: 4 cost time: 0.7710592746734619
Epoch: 4, Steps: 10 | Train Loss: 2.099 Vali Loss: 3.154 Vali Acc: 0.175 Test Loss: 3.154 Test Acc: 0.175
Validation loss decreased (-0.132909 --> -0.175263).  Saving model ...
Epoch: 5 cost time: 0.6712136268615723
Epoch: 5, Steps: 10 | Train Loss: 1.692 Vali Loss: 3.125 Vali Acc: 0.219 Test Loss: 3.125 Test Acc: 0.219
Validation loss decreased (-0.175263 --> -0.218792).  Saving model ...
Epoch: 6 cost time: 0.6389350891113281
Epoch: 6, Steps: 10 | Train Loss: 1.260 Vali Loss: 3.117 Vali Acc: 0.251 Test Loss: 3.117 Test Acc: 0.251
Validation loss decreased (-0.218792 --> -0.250557).  Saving model ...
Epoch: 7 cost time: 0.828132152557373
Epoch: 7, Steps: 10 | Train Loss: 0.909 Vali Loss: 3.117 Vali Acc: 0.286 Test Loss: 3.117 Test Acc: 0.286
Validation loss decreased (-0.250557 --> -0.285851).  Saving model ...
Epoch: 8 cost time: 0.8282151222229004
Epoch: 8, Steps: 10 | Train Loss: 0.623 Vali Loss: 3.185 Vali Acc: 0.285 Test Loss: 3.185 Test Acc: 0.285
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7745885848999023
Epoch: 9, Steps: 10 | Train Loss: 0.434 Vali Loss: 3.221 Vali Acc: 0.313 Test Loss: 3.221 Test Acc: 0.313
Validation loss decreased (-0.285851 --> -0.312909).  Saving model ...
Epoch: 10 cost time: 0.7703690528869629
Epoch: 10, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.306 Vali Acc: 0.320 Test Loss: 3.306 Test Acc: 0.320
Validation loss decreased (-0.312909 --> -0.319967).  Saving model ...
Epoch: 11 cost time: 0.7362315654754639
Epoch: 11, Steps: 10 | Train Loss: 0.172 Vali Loss: 3.335 Vali Acc: 0.322 Test Loss: 3.335 Test Acc: 0.322
Validation loss decreased (-0.319967 --> -0.322320).  Saving model ...
Epoch: 12 cost time: 0.8105156421661377
Epoch: 12, Steps: 10 | Train Loss: 0.123 Vali Loss: 3.485 Vali Acc: 0.326 Test Loss: 3.485 Test Acc: 0.326
Validation loss decreased (-0.322320 --> -0.325848).  Saving model ...
Epoch: 13 cost time: 0.712270975112915
Epoch: 13, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.449 Vali Acc: 0.340 Test Loss: 3.449 Test Acc: 0.340
Validation loss decreased (-0.325848 --> -0.339966).  Saving model ...
Epoch: 14 cost time: 0.7754111289978027
Epoch: 14, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.518 Vali Acc: 0.335 Test Loss: 3.518 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8076472282409668
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.587 Vali Acc: 0.342 Test Loss: 3.587 Test Acc: 0.342
Validation loss decreased (-0.339966 --> -0.342317).  Saving model ...
Epoch: 16 cost time: 0.7075095176696777
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.637 Vali Acc: 0.341 Test Loss: 3.637 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7565436363220215
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.645 Vali Acc: 0.345 Test Loss: 3.645 Test Acc: 0.345
Validation loss decreased (-0.342317 --> -0.344669).  Saving model ...
Epoch: 18 cost time: 0.7556962966918945
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.666 Vali Acc: 0.349 Test Loss: 3.666 Test Acc: 0.349
Validation loss decreased (-0.344669 --> -0.349375).  Saving model ...
Epoch: 19 cost time: 0.6465969085693359
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.697 Vali Acc: 0.339 Test Loss: 3.697 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7261390686035156
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.726 Vali Acc: 0.342 Test Loss: 3.726 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7447829246520996
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.756 Vali Acc: 0.344 Test Loss: 3.756 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6957380771636963
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.778 Vali Acc: 0.342 Test Loss: 3.778 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7436237335205078
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.788 Vali Acc: 0.340 Test Loss: 3.788 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.7722184658050537
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.783 Vali Acc: 0.340 Test Loss: 3.783 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7190897464752197
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.803 Vali Acc: 0.342 Test Loss: 3.803 Test Acc: 0.342
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6902239322662354
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.839 Vali Acc: 0.338 Test Loss: 3.839 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7785375118255615
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.848 Vali Acc: 0.342 Test Loss: 3.848 Test Acc: 0.342
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7227816581726074
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.847 Vali Acc: 0.347 Test Loss: 3.847 Test Acc: 0.347
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 328438
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.398907423019409
Epoch: 1, Steps: 10 | Train Loss: 3.297 Vali Loss: 3.292 Vali Acc: 0.056 Test Loss: 3.292 Test Acc: 0.056
Validation loss decreased (inf --> -0.056438).  Saving model ...
Epoch: 2 cost time: 0.7630641460418701
Epoch: 2, Steps: 10 | Train Loss: 3.072 Vali Loss: 3.258 Vali Acc: 0.084 Test Loss: 3.258 Test Acc: 0.084
Validation loss decreased (-0.056438 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 0.693774938583374
Epoch: 3, Steps: 10 | Train Loss: 2.633 Vali Loss: 3.227 Vali Acc: 0.135 Test Loss: 3.227 Test Acc: 0.135
Validation loss decreased (-0.083497 --> -0.135262).  Saving model ...
Epoch: 4 cost time: 0.6635177135467529
Epoch: 4, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.129 Vali Acc: 0.178 Test Loss: 3.129 Test Acc: 0.178
Validation loss decreased (-0.135262 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 0.7342729568481445
Epoch: 5, Steps: 10 | Train Loss: 1.785 Vali Loss: 3.081 Vali Acc: 0.211 Test Loss: 3.081 Test Acc: 0.211
Validation loss decreased (-0.177616 --> -0.210557).  Saving model ...
Epoch: 6 cost time: 0.7813317775726318
Epoch: 6, Steps: 10 | Train Loss: 1.381 Vali Loss: 3.048 Vali Acc: 0.256 Test Loss: 3.048 Test Acc: 0.256
Validation loss decreased (-0.210557 --> -0.256440).  Saving model ...
Epoch: 7 cost time: 0.6997387409210205
Epoch: 7, Steps: 10 | Train Loss: 1.030 Vali Loss: 3.031 Vali Acc: 0.274 Test Loss: 3.031 Test Acc: 0.274
Validation loss decreased (-0.256440 --> -0.274087).  Saving model ...
Epoch: 8 cost time: 0.8349885940551758
Epoch: 8, Steps: 10 | Train Loss: 0.703 Vali Loss: 3.068 Vali Acc: 0.281 Test Loss: 3.068 Test Acc: 0.281
Validation loss decreased (-0.274087 --> -0.281146).  Saving model ...
Epoch: 9 cost time: 0.6838374137878418
Epoch: 9, Steps: 10 | Train Loss: 0.499 Vali Loss: 3.086 Vali Acc: 0.307 Test Loss: 3.086 Test Acc: 0.307
Validation loss decreased (-0.281146 --> -0.307028).  Saving model ...
Epoch: 10 cost time: 0.7619888782501221
Epoch: 10, Steps: 10 | Train Loss: 0.326 Vali Loss: 3.173 Vali Acc: 0.306 Test Loss: 3.173 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7065138816833496
Epoch: 11, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.201 Vali Acc: 0.315 Test Loss: 3.201 Test Acc: 0.315
Validation loss decreased (-0.307028 --> -0.315262).  Saving model ...
Epoch: 12 cost time: 0.767305850982666
Epoch: 12, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.325 Vali Acc: 0.331 Test Loss: 3.325 Test Acc: 0.331
Validation loss decreased (-0.315262 --> -0.330555).  Saving model ...
Epoch: 13 cost time: 0.7881791591644287
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.316 Vali Acc: 0.329 Test Loss: 3.316 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8193833827972412
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.344 Vali Acc: 0.328 Test Loss: 3.344 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8277804851531982
Epoch: 15, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.392 Vali Acc: 0.329 Test Loss: 3.392 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7257468700408936
Epoch: 16, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.443 Vali Acc: 0.331 Test Loss: 3.443 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.8171756267547607
Epoch: 17, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.486 Vali Acc: 0.335 Test Loss: 3.486 Test Acc: 0.335
Validation loss decreased (-0.330555 --> -0.335259).  Saving model ...
Epoch: 18 cost time: 0.739760160446167
Epoch: 18, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.505 Vali Acc: 0.340 Test Loss: 3.505 Test Acc: 0.340
Validation loss decreased (-0.335259 --> -0.339965).  Saving model ...
Epoch: 19 cost time: 0.7887177467346191
Epoch: 19, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.516 Vali Acc: 0.341 Test Loss: 3.516 Test Acc: 0.341
Validation loss decreased (-0.339965 --> -0.341141).  Saving model ...
Epoch: 20 cost time: 0.7506730556488037
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.549 Vali Acc: 0.335 Test Loss: 3.549 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8461244106292725
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.564 Vali Acc: 0.333 Test Loss: 3.564 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6592681407928467
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.586 Vali Acc: 0.328 Test Loss: 3.586 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8476238250732422
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.607 Vali Acc: 0.328 Test Loss: 3.607 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6945881843566895
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.613 Vali Acc: 0.334 Test Loss: 3.613 Test Acc: 0.334
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6751000881195068
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.630 Vali Acc: 0.329 Test Loss: 3.630 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7524034976959229
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.656 Vali Acc: 0.329 Test Loss: 3.656 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7903201580047607
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.671 Vali Acc: 0.331 Test Loss: 3.671 Test Acc: 0.331
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7060139179229736
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.681 Vali Acc: 0.331 Test Loss: 3.681 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8029212951660156
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.693 Vali Acc: 0.333 Test Loss: 3.693 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 328438
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1774935722351074
Epoch: 1, Steps: 10 | Train Loss: 3.263 Vali Loss: 3.275 Vali Acc: 0.048 Test Loss: 3.275 Test Acc: 0.048
Validation loss decreased (inf --> -0.048203).  Saving model ...
Epoch: 2 cost time: 0.701876163482666
Epoch: 2, Steps: 10 | Train Loss: 3.098 Vali Loss: 3.253 Vali Acc: 0.066 Test Loss: 3.253 Test Acc: 0.066
Validation loss decreased (-0.048203 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.6510024070739746
Epoch: 3, Steps: 10 | Train Loss: 2.767 Vali Loss: 3.233 Vali Acc: 0.104 Test Loss: 3.233 Test Acc: 0.104
Validation loss decreased (-0.065850 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 0.7083899974822998
Epoch: 4, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.163 Vali Acc: 0.146 Test Loss: 3.163 Test Acc: 0.146
Validation loss decreased (-0.103497 --> -0.145851).  Saving model ...
Epoch: 5 cost time: 0.7210602760314941
Epoch: 5, Steps: 10 | Train Loss: 2.089 Vali Loss: 3.111 Vali Acc: 0.185 Test Loss: 3.111 Test Acc: 0.185
Validation loss decreased (-0.145851 --> -0.184675).  Saving model ...
Epoch: 6 cost time: 0.6830627918243408
Epoch: 6, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.052 Vali Acc: 0.213 Test Loss: 3.052 Test Acc: 0.213
Validation loss decreased (-0.184675 --> -0.212911).  Saving model ...
Epoch: 7 cost time: 0.7041823863983154
Epoch: 7, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.006 Vali Acc: 0.239 Test Loss: 3.006 Test Acc: 0.239
Validation loss decreased (-0.212911 --> -0.238793).  Saving model ...
Epoch: 8 cost time: 0.7971916198730469
Epoch: 8, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.002 Vali Acc: 0.256 Test Loss: 3.002 Test Acc: 0.256
Validation loss decreased (-0.238793 --> -0.256441).  Saving model ...
Epoch: 9 cost time: 0.7185604572296143
Epoch: 9, Steps: 10 | Train Loss: 0.768 Vali Loss: 3.005 Vali Acc: 0.268 Test Loss: 3.005 Test Acc: 0.268
Validation loss decreased (-0.256441 --> -0.268205).  Saving model ...
Epoch: 10 cost time: 0.7069330215454102
Epoch: 10, Steps: 10 | Train Loss: 0.517 Vali Loss: 3.047 Vali Acc: 0.272 Test Loss: 3.047 Test Acc: 0.272
Validation loss decreased (-0.268205 --> -0.271734).  Saving model ...
Epoch: 11 cost time: 0.6233415603637695
Epoch: 11, Steps: 10 | Train Loss: 0.336 Vali Loss: 3.057 Vali Acc: 0.281 Test Loss: 3.057 Test Acc: 0.281
Validation loss decreased (-0.271734 --> -0.281146).  Saving model ...
Epoch: 12 cost time: 0.6525595188140869
Epoch: 12, Steps: 10 | Train Loss: 0.222 Vali Loss: 3.170 Vali Acc: 0.295 Test Loss: 3.170 Test Acc: 0.295
Validation loss decreased (-0.281146 --> -0.295262).  Saving model ...
Epoch: 13 cost time: 0.6486754417419434
Epoch: 13, Steps: 10 | Train Loss: 0.129 Vali Loss: 3.199 Vali Acc: 0.307 Test Loss: 3.199 Test Acc: 0.307
Validation loss decreased (-0.295262 --> -0.307027).  Saving model ...
Epoch: 14 cost time: 0.6109566688537598
Epoch: 14, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.249 Vali Acc: 0.302 Test Loss: 3.249 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5890774726867676
Epoch: 15, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.308 Vali Acc: 0.302 Test Loss: 3.308 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7140874862670898
Epoch: 16, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.343 Vali Acc: 0.304 Test Loss: 3.343 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7711586952209473
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.367 Vali Acc: 0.305 Test Loss: 3.367 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7053623199462891
Epoch: 18, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.386 Vali Acc: 0.307 Test Loss: 3.386 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.7458457946777344
Epoch: 19, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.443 Vali Acc: 0.307 Test Loss: 3.443 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.768486738204956
Epoch: 20, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.482 Vali Acc: 0.307 Test Loss: 3.482 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6809720993041992
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.499 Vali Acc: 0.314 Test Loss: 3.499 Test Acc: 0.314
Validation loss decreased (-0.307027 --> -0.314083).  Saving model ...
Epoch: 22 cost time: 0.6837162971496582
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.512 Vali Acc: 0.312 Test Loss: 3.512 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6920726299285889
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.521 Vali Acc: 0.308 Test Loss: 3.521 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7355270385742188
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.521 Vali Acc: 0.307 Test Loss: 3.521 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6596102714538574
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.546 Vali Acc: 0.307 Test Loss: 3.546 Test Acc: 0.307
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6677618026733398
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.588 Vali Acc: 0.306 Test Loss: 3.588 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6404519081115723
Epoch: 27, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.618 Vali Acc: 0.308 Test Loss: 3.618 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6875259876251221
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.627 Vali Acc: 0.307 Test Loss: 3.627 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7209429740905762
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.643 Vali Acc: 0.306 Test Loss: 3.643 Test Acc: 0.306
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7584214210510254
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.658 Vali Acc: 0.307 Test Loss: 3.658 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7555832862854004
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.680 Vali Acc: 0.301 Test Loss: 3.680 Test Acc: 0.301
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 328438
model size : 2.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3537628650665283
Epoch: 1, Steps: 10 | Train Loss: 3.365 Vali Loss: 3.295 Vali Acc: 0.041 Test Loss: 3.295 Test Acc: 0.041
Validation loss decreased (inf --> -0.041144).  Saving model ...
Epoch: 2 cost time: 0.7350819110870361
Epoch: 2, Steps: 10 | Train Loss: 3.045 Vali Loss: 3.255 Vali Acc: 0.084 Test Loss: 3.255 Test Acc: 0.084
Validation loss decreased (-0.041144 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 0.7649247646331787
Epoch: 3, Steps: 10 | Train Loss: 2.632 Vali Loss: 3.232 Vali Acc: 0.138 Test Loss: 3.232 Test Acc: 0.138
Validation loss decreased (-0.083497 --> -0.137615).  Saving model ...
Epoch: 4 cost time: 0.7142326831817627
Epoch: 4, Steps: 10 | Train Loss: 2.091 Vali Loss: 3.144 Vali Acc: 0.180 Test Loss: 3.144 Test Acc: 0.180
Validation loss decreased (-0.137615 --> -0.179969).  Saving model ...
Epoch: 5 cost time: 0.7307367324829102
Epoch: 5, Steps: 10 | Train Loss: 1.660 Vali Loss: 3.093 Vali Acc: 0.228 Test Loss: 3.093 Test Acc: 0.228
Validation loss decreased (-0.179969 --> -0.228204).  Saving model ...
Epoch: 6 cost time: 0.8325731754302979
Epoch: 6, Steps: 10 | Train Loss: 1.236 Vali Loss: 3.114 Vali Acc: 0.265 Test Loss: 3.114 Test Acc: 0.265
Validation loss decreased (-0.228204 --> -0.264675).  Saving model ...
Epoch: 7 cost time: 0.7019290924072266
Epoch: 7, Steps: 10 | Train Loss: 0.871 Vali Loss: 3.127 Vali Acc: 0.276 Test Loss: 3.127 Test Acc: 0.276
Validation loss decreased (-0.264675 --> -0.276439).  Saving model ...
Epoch: 8 cost time: 0.7618937492370605
Epoch: 8, Steps: 10 | Train Loss: 0.631 Vali Loss: 3.180 Vali Acc: 0.293 Test Loss: 3.180 Test Acc: 0.293
Validation loss decreased (-0.276439 --> -0.292909).  Saving model ...
Epoch: 9 cost time: 0.7685153484344482
Epoch: 9, Steps: 10 | Train Loss: 0.410 Vali Loss: 3.236 Vali Acc: 0.309 Test Loss: 3.236 Test Acc: 0.309
Validation loss decreased (-0.292909 --> -0.309379).  Saving model ...
Epoch: 10 cost time: 0.7225561141967773
Epoch: 10, Steps: 10 | Train Loss: 0.309 Vali Loss: 3.286 Vali Acc: 0.302 Test Loss: 3.286 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8692309856414795
Epoch: 11, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.458 Vali Acc: 0.322 Test Loss: 3.458 Test Acc: 0.322
Validation loss decreased (-0.309379 --> -0.322318).  Saving model ...
Epoch: 12 cost time: 0.8399658203125
Epoch: 12, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.454 Vali Acc: 0.321 Test Loss: 3.454 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7725765705108643
Epoch: 13, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.532 Vali Acc: 0.331 Test Loss: 3.532 Test Acc: 0.331
Validation loss decreased (-0.322318 --> -0.330553).  Saving model ...
Epoch: 14 cost time: 0.7866299152374268
Epoch: 14, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.602 Vali Acc: 0.332 Test Loss: 3.602 Test Acc: 0.332
Validation loss decreased (-0.330553 --> -0.331729).  Saving model ...
Epoch: 15 cost time: 0.8766000270843506
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.626 Vali Acc: 0.334 Test Loss: 3.626 Test Acc: 0.334
Validation loss decreased (-0.331729 --> -0.334081).  Saving model ...
Epoch: 16 cost time: 0.6966493129730225
Epoch: 16, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.672 Vali Acc: 0.338 Test Loss: 3.672 Test Acc: 0.338
Validation loss decreased (-0.334081 --> -0.337610).  Saving model ...
Epoch: 17 cost time: 0.830524206161499
Epoch: 17, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.721 Vali Acc: 0.339 Test Loss: 3.721 Test Acc: 0.339
Validation loss decreased (-0.337610 --> -0.338786).  Saving model ...
Epoch: 18 cost time: 0.8195035457611084
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.762 Vali Acc: 0.334 Test Loss: 3.762 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.734405517578125
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.773 Vali Acc: 0.339 Test Loss: 3.773 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6648654937744141
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.805 Vali Acc: 0.341 Test Loss: 3.805 Test Acc: 0.341
Validation loss decreased (-0.338786 --> -0.341138).  Saving model ...
Epoch: 21 cost time: 0.7281265258789062
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.823 Vali Acc: 0.344 Test Loss: 3.823 Test Acc: 0.344
Validation loss decreased (-0.341138 --> -0.343491).  Saving model ...
Epoch: 22 cost time: 0.818950891494751
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.845 Vali Acc: 0.340 Test Loss: 3.845 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8727200031280518
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.860 Vali Acc: 0.341 Test Loss: 3.860 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7982978820800781
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.879 Vali Acc: 0.340 Test Loss: 3.879 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7593038082122803
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.899 Vali Acc: 0.341 Test Loss: 3.899 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.729771614074707
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.909 Vali Acc: 0.341 Test Loss: 3.909 Test Acc: 0.341
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.748009204864502
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.927 Vali Acc: 0.342 Test Loss: 3.927 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7378971576690674
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.943 Vali Acc: 0.340 Test Loss: 3.943 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7768537998199463
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.962 Vali Acc: 0.340 Test Loss: 3.962 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.6935276985168457
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.990 Vali Acc: 0.338 Test Loss: 3.990 Test Acc: 0.338
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7250754833221436
Epoch: 31, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.011 Vali Acc: 0.336 Test Loss: 4.011 Test Acc: 0.336
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34352941176470586
model parameter : 295670
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3646087646484375
Epoch: 1, Steps: 10 | Train Loss: 3.354 Vali Loss: 3.283 Vali Acc: 0.040 Test Loss: 3.283 Test Acc: 0.040
Validation loss decreased (inf --> -0.039967).  Saving model ...
Epoch: 2 cost time: 0.7292873859405518
Epoch: 2, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.242 Vali Acc: 0.087 Test Loss: 3.242 Test Acc: 0.087
Validation loss decreased (-0.039967 --> -0.087026).  Saving model ...
Epoch: 3 cost time: 0.6551823616027832
Epoch: 3, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.216 Vali Acc: 0.131 Test Loss: 3.216 Test Acc: 0.131
Validation loss decreased (-0.087026 --> -0.130556).  Saving model ...
Epoch: 4 cost time: 0.663597822189331
Epoch: 4, Steps: 10 | Train Loss: 2.129 Vali Loss: 3.127 Vali Acc: 0.178 Test Loss: 3.127 Test Acc: 0.178
Validation loss decreased (-0.130556 --> -0.177616).  Saving model ...
Epoch: 5 cost time: 0.6876227855682373
Epoch: 5, Steps: 10 | Train Loss: 1.686 Vali Loss: 3.064 Vali Acc: 0.228 Test Loss: 3.064 Test Acc: 0.228
Validation loss decreased (-0.177616 --> -0.228205).  Saving model ...
Epoch: 6 cost time: 0.7230002880096436
Epoch: 6, Steps: 10 | Train Loss: 1.261 Vali Loss: 3.070 Vali Acc: 0.258 Test Loss: 3.070 Test Acc: 0.258
Validation loss decreased (-0.228205 --> -0.257616).  Saving model ...
Epoch: 7 cost time: 0.7345387935638428
Epoch: 7, Steps: 10 | Train Loss: 0.900 Vali Loss: 3.067 Vali Acc: 0.279 Test Loss: 3.067 Test Acc: 0.279
Validation loss decreased (-0.257616 --> -0.278793).  Saving model ...
Epoch: 8 cost time: 0.7284433841705322
Epoch: 8, Steps: 10 | Train Loss: 0.657 Vali Loss: 3.102 Vali Acc: 0.304 Test Loss: 3.102 Test Acc: 0.304
Validation loss decreased (-0.278793 --> -0.303498).  Saving model ...
Epoch: 9 cost time: 0.7889342308044434
Epoch: 9, Steps: 10 | Train Loss: 0.421 Vali Loss: 3.160 Vali Acc: 0.320 Test Loss: 3.160 Test Acc: 0.320
Validation loss decreased (-0.303498 --> -0.319968).  Saving model ...
Epoch: 10 cost time: 0.7250640392303467
Epoch: 10, Steps: 10 | Train Loss: 0.300 Vali Loss: 3.190 Vali Acc: 0.320 Test Loss: 3.190 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7470681667327881
Epoch: 11, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.352 Vali Acc: 0.328 Test Loss: 3.352 Test Acc: 0.328
Validation loss decreased (-0.319968 --> -0.328202).  Saving model ...
Epoch: 12 cost time: 0.7474792003631592
Epoch: 12, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.350 Vali Acc: 0.336 Test Loss: 3.350 Test Acc: 0.336
Validation loss decreased (-0.328202 --> -0.336437).  Saving model ...
Epoch: 13 cost time: 0.7447052001953125
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.396 Vali Acc: 0.329 Test Loss: 3.396 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7569210529327393
Epoch: 14, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.471 Vali Acc: 0.334 Test Loss: 3.471 Test Acc: 0.334
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.723853349685669
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.513 Vali Acc: 0.329 Test Loss: 3.513 Test Acc: 0.329
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7084193229675293
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.534 Vali Acc: 0.345 Test Loss: 3.534 Test Acc: 0.345
Validation loss decreased (-0.336437 --> -0.344671).  Saving model ...
Epoch: 17 cost time: 0.7210125923156738
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.572 Vali Acc: 0.339 Test Loss: 3.572 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7614142894744873
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.606 Vali Acc: 0.341 Test Loss: 3.606 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6904118061065674
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.623 Vali Acc: 0.346 Test Loss: 3.623 Test Acc: 0.346
Validation loss decreased (-0.344671 --> -0.345846).  Saving model ...
Epoch: 20 cost time: 0.7201950550079346
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.652 Vali Acc: 0.345 Test Loss: 3.652 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.787543535232544
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.663 Vali Acc: 0.342 Test Loss: 3.663 Test Acc: 0.342
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.908334493637085
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.687 Vali Acc: 0.342 Test Loss: 3.687 Test Acc: 0.342
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.782742977142334
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.700 Vali Acc: 0.346 Test Loss: 3.700 Test Acc: 0.346
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6667485237121582
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.718 Vali Acc: 0.345 Test Loss: 3.718 Test Acc: 0.345
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8180787563323975
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.744 Vali Acc: 0.345 Test Loss: 3.744 Test Acc: 0.345
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7719085216522217
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.758 Vali Acc: 0.349 Test Loss: 3.758 Test Acc: 0.349
Validation loss decreased (-0.345846 --> -0.349374).  Saving model ...
Epoch: 27 cost time: 0.6814312934875488
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.783 Vali Acc: 0.352 Test Loss: 3.783 Test Acc: 0.352
Validation loss decreased (-0.349374 --> -0.351727).  Saving model ...
Epoch: 28 cost time: 0.7261867523193359
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.797 Vali Acc: 0.351 Test Loss: 3.797 Test Acc: 0.351
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7022855281829834
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.811 Vali Acc: 0.347 Test Loss: 3.811 Test Acc: 0.347
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6700105667114258
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.829 Vali Acc: 0.348 Test Loss: 3.829 Test Acc: 0.348
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7723288536071777
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.843 Vali Acc: 0.347 Test Loss: 3.843 Test Acc: 0.347
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6416094303131104
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.854 Vali Acc: 0.348 Test Loss: 3.854 Test Acc: 0.348
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7484781742095947
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.869 Vali Acc: 0.346 Test Loss: 3.869 Test Acc: 0.346
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8985977172851562
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.881 Vali Acc: 0.348 Test Loss: 3.881 Test Acc: 0.348
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.5857343673706055
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.899 Vali Acc: 0.349 Test Loss: 3.899 Test Acc: 0.349
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.681952714920044
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.912 Vali Acc: 0.351 Test Loss: 3.912 Test Acc: 0.351
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8364076614379883
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.919 Vali Acc: 0.351 Test Loss: 3.919 Test Acc: 0.351
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3517647058823529
model parameter : 295670
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3500702381134033
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.279 Vali Acc: 0.036 Test Loss: 3.279 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.752446174621582
Epoch: 2, Steps: 10 | Train Loss: 3.050 Vali Loss: 3.239 Vali Acc: 0.079 Test Loss: 3.239 Test Acc: 0.079
Validation loss decreased (-0.036438 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.697075605392456
Epoch: 3, Steps: 10 | Train Loss: 2.697 Vali Loss: 3.212 Vali Acc: 0.125 Test Loss: 3.212 Test Acc: 0.125
Validation loss decreased (-0.078791 --> -0.124674).  Saving model ...
Epoch: 4 cost time: 0.6652727127075195
Epoch: 4, Steps: 10 | Train Loss: 2.218 Vali Loss: 3.127 Vali Acc: 0.171 Test Loss: 3.127 Test Acc: 0.171
Validation loss decreased (-0.124674 --> -0.170557).  Saving model ...
Epoch: 5 cost time: 0.6370792388916016
Epoch: 5, Steps: 10 | Train Loss: 1.789 Vali Loss: 3.043 Vali Acc: 0.225 Test Loss: 3.043 Test Acc: 0.225
Validation loss decreased (-0.170557 --> -0.224675).  Saving model ...
Epoch: 6 cost time: 0.6869263648986816
Epoch: 6, Steps: 10 | Train Loss: 1.367 Vali Loss: 3.023 Vali Acc: 0.260 Test Loss: 3.023 Test Acc: 0.260
Validation loss decreased (-0.224675 --> -0.259970).  Saving model ...
Epoch: 7 cost time: 0.7270922660827637
Epoch: 7, Steps: 10 | Train Loss: 0.996 Vali Loss: 3.008 Vali Acc: 0.276 Test Loss: 3.008 Test Acc: 0.276
Validation loss decreased (-0.259970 --> -0.276441).  Saving model ...
Epoch: 8 cost time: 0.7497012615203857
Epoch: 8, Steps: 10 | Train Loss: 0.729 Vali Loss: 3.023 Vali Acc: 0.288 Test Loss: 3.023 Test Acc: 0.288
Validation loss decreased (-0.276441 --> -0.288205).  Saving model ...
Epoch: 9 cost time: 0.8049569129943848
Epoch: 9, Steps: 10 | Train Loss: 0.481 Vali Loss: 3.076 Vali Acc: 0.316 Test Loss: 3.076 Test Acc: 0.316
Validation loss decreased (-0.288205 --> -0.316440).  Saving model ...
Epoch: 10 cost time: 0.7764649391174316
Epoch: 10, Steps: 10 | Train Loss: 0.323 Vali Loss: 3.088 Vali Acc: 0.316 Test Loss: 3.088 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7696356773376465
Epoch: 11, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.194 Vali Acc: 0.334 Test Loss: 3.194 Test Acc: 0.334
Validation loss decreased (-0.316440 --> -0.334086).  Saving model ...
Epoch: 12 cost time: 0.7073962688446045
Epoch: 12, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.225 Vali Acc: 0.336 Test Loss: 3.225 Test Acc: 0.336
Validation loss decreased (-0.334086 --> -0.336438).  Saving model ...
Epoch: 13 cost time: 0.8141400814056396
Epoch: 13, Steps: 10 | Train Loss: 0.079 Vali Loss: 3.300 Vali Acc: 0.327 Test Loss: 3.300 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7161033153533936
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.321 Vali Acc: 0.333 Test Loss: 3.321 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6786594390869141
Epoch: 15, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.353 Vali Acc: 0.335 Test Loss: 3.353 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.697106122970581
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.399 Vali Acc: 0.345 Test Loss: 3.399 Test Acc: 0.345
Validation loss decreased (-0.336438 --> -0.344672).  Saving model ...
Epoch: 17 cost time: 0.7762081623077393
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.441 Vali Acc: 0.345 Test Loss: 3.441 Test Acc: 0.345
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6613733768463135
Epoch: 18, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.465 Vali Acc: 0.347 Test Loss: 3.465 Test Acc: 0.347
Validation loss decreased (-0.344672 --> -0.347024).  Saving model ...
Epoch: 19 cost time: 0.6916682720184326
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.474 Vali Acc: 0.346 Test Loss: 3.474 Test Acc: 0.346
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7243096828460693
Epoch: 20, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.520 Vali Acc: 0.338 Test Loss: 3.520 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7012233734130859
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.540 Vali Acc: 0.345 Test Loss: 3.540 Test Acc: 0.345
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.8715810775756836
Epoch: 22, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.561 Vali Acc: 0.349 Test Loss: 3.561 Test Acc: 0.349
Validation loss decreased (-0.347024 --> -0.349376).  Saving model ...
Epoch: 23 cost time: 0.8218162059783936
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.574 Vali Acc: 0.348 Test Loss: 3.574 Test Acc: 0.348
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8055808544158936
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.579 Vali Acc: 0.349 Test Loss: 3.579 Test Acc: 0.349
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8140442371368408
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.596 Vali Acc: 0.341 Test Loss: 3.596 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6883177757263184
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.606 Vali Acc: 0.342 Test Loss: 3.606 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7431788444519043
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.625 Vali Acc: 0.346 Test Loss: 3.625 Test Acc: 0.346
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7443046569824219
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.636 Vali Acc: 0.344 Test Loss: 3.636 Test Acc: 0.344
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7878413200378418
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.653 Vali Acc: 0.344 Test Loss: 3.653 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7689211368560791
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.674 Vali Acc: 0.341 Test Loss: 3.674 Test Acc: 0.341
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8881642818450928
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.689 Vali Acc: 0.340 Test Loss: 3.689 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7357516288757324
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.701 Vali Acc: 0.342 Test Loss: 3.701 Test Acc: 0.342
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 295670
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.353693962097168
Epoch: 1, Steps: 10 | Train Loss: 3.327 Vali Loss: 3.269 Vali Acc: 0.044 Test Loss: 3.269 Test Acc: 0.044
Validation loss decreased (inf --> -0.043497).  Saving model ...
Epoch: 2 cost time: 0.7357442378997803
Epoch: 2, Steps: 10 | Train Loss: 3.091 Vali Loss: 3.239 Vali Acc: 0.061 Test Loss: 3.239 Test Acc: 0.061
Validation loss decreased (-0.043497 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.7161879539489746
Epoch: 3, Steps: 10 | Train Loss: 2.845 Vali Loss: 3.222 Vali Acc: 0.102 Test Loss: 3.222 Test Acc: 0.102
Validation loss decreased (-0.061144 --> -0.102321).  Saving model ...
Epoch: 4 cost time: 0.6792385578155518
Epoch: 4, Steps: 10 | Train Loss: 2.454 Vali Loss: 3.166 Vali Acc: 0.154 Test Loss: 3.166 Test Acc: 0.154
Validation loss decreased (-0.102321 --> -0.154086).  Saving model ...
Epoch: 5 cost time: 0.5969381332397461
Epoch: 5, Steps: 10 | Train Loss: 2.097 Vali Loss: 3.090 Vali Acc: 0.186 Test Loss: 3.090 Test Acc: 0.186
Validation loss decreased (-0.154086 --> -0.185851).  Saving model ...
Epoch: 6 cost time: 0.6843223571777344
Epoch: 6, Steps: 10 | Train Loss: 1.712 Vali Loss: 3.045 Vali Acc: 0.215 Test Loss: 3.045 Test Acc: 0.215
Validation loss decreased (-0.185851 --> -0.215264).  Saving model ...
Epoch: 7 cost time: 0.7206456661224365
Epoch: 7, Steps: 10 | Train Loss: 1.356 Vali Loss: 2.999 Vali Acc: 0.236 Test Loss: 2.999 Test Acc: 0.236
Validation loss decreased (-0.215264 --> -0.236441).  Saving model ...
Epoch: 8 cost time: 0.6684131622314453
Epoch: 8, Steps: 10 | Train Loss: 1.075 Vali Loss: 2.992 Vali Acc: 0.260 Test Loss: 2.992 Test Acc: 0.260
Validation loss decreased (-0.236441 --> -0.259970).  Saving model ...
Epoch: 9 cost time: 0.7165250778198242
Epoch: 9, Steps: 10 | Train Loss: 0.758 Vali Loss: 3.008 Vali Acc: 0.271 Test Loss: 3.008 Test Acc: 0.271
Validation loss decreased (-0.259970 --> -0.270558).  Saving model ...
Epoch: 10 cost time: 0.6928360462188721
Epoch: 10, Steps: 10 | Train Loss: 0.536 Vali Loss: 2.996 Vali Acc: 0.292 Test Loss: 2.996 Test Acc: 0.292
Validation loss decreased (-0.270558 --> -0.291735).  Saving model ...
Epoch: 11 cost time: 0.7002725601196289
Epoch: 11, Steps: 10 | Train Loss: 0.362 Vali Loss: 3.088 Vali Acc: 0.298 Test Loss: 3.088 Test Acc: 0.298
Validation loss decreased (-0.291735 --> -0.297616).  Saving model ...
Epoch: 12 cost time: 0.7210214138031006
Epoch: 12, Steps: 10 | Train Loss: 0.217 Vali Loss: 3.105 Vali Acc: 0.305 Test Loss: 3.105 Test Acc: 0.305
Validation loss decreased (-0.297616 --> -0.304675).  Saving model ...
Epoch: 13 cost time: 0.6659266948699951
Epoch: 13, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.167 Vali Acc: 0.298 Test Loss: 3.167 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7822997570037842
Epoch: 14, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.230 Vali Acc: 0.304 Test Loss: 3.230 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.7291688919067383
Epoch: 15, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.305 Vali Acc: 0.301 Test Loss: 3.305 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6292629241943359
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.343 Vali Acc: 0.311 Test Loss: 3.343 Test Acc: 0.311
Validation loss decreased (-0.304675 --> -0.310555).  Saving model ...
Epoch: 17 cost time: 0.7521929740905762
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.354 Vali Acc: 0.309 Test Loss: 3.354 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7191100120544434
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.387 Vali Acc: 0.307 Test Loss: 3.387 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7383115291595459
Epoch: 19, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.404 Vali Acc: 0.311 Test Loss: 3.404 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7172858715057373
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.455 Vali Acc: 0.304 Test Loss: 3.455 Test Acc: 0.304
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7895965576171875
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.483 Vali Acc: 0.306 Test Loss: 3.483 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.7636644840240479
Epoch: 22, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.508 Vali Acc: 0.300 Test Loss: 3.508 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8136310577392578
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.523 Vali Acc: 0.305 Test Loss: 3.523 Test Acc: 0.305
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7194728851318359
Epoch: 24, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.527 Vali Acc: 0.304 Test Loss: 3.527 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.7956852912902832
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.548 Vali Acc: 0.307 Test Loss: 3.548 Test Acc: 0.307
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7756690979003906
Epoch: 26, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.569 Vali Acc: 0.306 Test Loss: 3.569 Test Acc: 0.306
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31058823529411766
model parameter : 295670
model size : 2.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.271946430206299
Epoch: 1, Steps: 10 | Train Loss: 3.419 Vali Loss: 3.307 Vali Acc: 0.041 Test Loss: 3.307 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.7305316925048828
Epoch: 2, Steps: 10 | Train Loss: 3.054 Vali Loss: 3.262 Vali Acc: 0.082 Test Loss: 3.262 Test Acc: 0.082
Validation loss decreased (-0.041143 --> -0.082320).  Saving model ...
Epoch: 3 cost time: 0.7142701148986816
Epoch: 3, Steps: 10 | Train Loss: 2.566 Vali Loss: 3.241 Vali Acc: 0.136 Test Loss: 3.241 Test Acc: 0.136
Validation loss decreased (-0.082320 --> -0.136438).  Saving model ...
Epoch: 4 cost time: 0.7715566158294678
Epoch: 4, Steps: 10 | Train Loss: 2.076 Vali Loss: 3.169 Vali Acc: 0.185 Test Loss: 3.169 Test Acc: 0.185
Validation loss decreased (-0.136438 --> -0.184674).  Saving model ...
Epoch: 5 cost time: 0.8073334693908691
Epoch: 5, Steps: 10 | Train Loss: 1.620 Vali Loss: 3.126 Vali Acc: 0.228 Test Loss: 3.126 Test Acc: 0.228
Validation loss decreased (-0.184674 --> -0.228204).  Saving model ...
Epoch: 6 cost time: 0.7816801071166992
Epoch: 6, Steps: 10 | Train Loss: 1.229 Vali Loss: 3.126 Vali Acc: 0.268 Test Loss: 3.126 Test Acc: 0.268
Validation loss decreased (-0.228204 --> -0.268204).  Saving model ...
Epoch: 7 cost time: 0.7113902568817139
Epoch: 7, Steps: 10 | Train Loss: 0.923 Vali Loss: 3.204 Vali Acc: 0.274 Test Loss: 3.204 Test Acc: 0.274
Validation loss decreased (-0.268204 --> -0.274086).  Saving model ...
Epoch: 8 cost time: 0.7375764846801758
Epoch: 8, Steps: 10 | Train Loss: 0.616 Vali Loss: 3.238 Vali Acc: 0.295 Test Loss: 3.238 Test Acc: 0.295
Validation loss decreased (-0.274086 --> -0.295262).  Saving model ...
Epoch: 9 cost time: 0.7786872386932373
Epoch: 9, Steps: 10 | Train Loss: 0.393 Vali Loss: 3.268 Vali Acc: 0.304 Test Loss: 3.268 Test Acc: 0.304
Validation loss decreased (-0.295262 --> -0.303497).  Saving model ...
Epoch: 10 cost time: 0.6937925815582275
Epoch: 10, Steps: 10 | Train Loss: 0.259 Vali Loss: 3.382 Vali Acc: 0.299 Test Loss: 3.382 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7561759948730469
Epoch: 11, Steps: 10 | Train Loss: 0.168 Vali Loss: 3.430 Vali Acc: 0.326 Test Loss: 3.430 Test Acc: 0.326
Validation loss decreased (-0.303497 --> -0.325848).  Saving model ...
Epoch: 12 cost time: 0.7650811672210693
Epoch: 12, Steps: 10 | Train Loss: 0.113 Vali Loss: 3.488 Vali Acc: 0.329 Test Loss: 3.488 Test Acc: 0.329
Validation loss decreased (-0.325848 --> -0.329377).  Saving model ...
Epoch: 13 cost time: 0.6863541603088379
Epoch: 13, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.526 Vali Acc: 0.329 Test Loss: 3.526 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6800072193145752
Epoch: 14, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.602 Vali Acc: 0.333 Test Loss: 3.602 Test Acc: 0.333
Validation loss decreased (-0.329377 --> -0.332905).  Saving model ...
Epoch: 15 cost time: 0.7321422100067139
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.690 Vali Acc: 0.329 Test Loss: 3.690 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7546415328979492
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.692 Vali Acc: 0.326 Test Loss: 3.692 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6926121711730957
Epoch: 17, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.714 Vali Acc: 0.331 Test Loss: 3.714 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.6392688751220703
Epoch: 18, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.751 Vali Acc: 0.328 Test Loss: 3.751 Test Acc: 0.328
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7591648101806641
Epoch: 19, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.798 Vali Acc: 0.327 Test Loss: 3.798 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7939505577087402
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.832 Vali Acc: 0.329 Test Loss: 3.832 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7320699691772461
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.854 Vali Acc: 0.333 Test Loss: 3.854 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.6878805160522461
Epoch: 22, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.873 Vali Acc: 0.334 Test Loss: 3.873 Test Acc: 0.334
Validation loss decreased (-0.332905 --> -0.334079).  Saving model ...
Epoch: 23 cost time: 0.6850020885467529
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.899 Vali Acc: 0.331 Test Loss: 3.899 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7485976219177246
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.930 Vali Acc: 0.329 Test Loss: 3.930 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.747154712677002
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.955 Vali Acc: 0.328 Test Loss: 3.955 Test Acc: 0.328
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.6722631454467773
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.961 Vali Acc: 0.326 Test Loss: 3.961 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.746363639831543
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.962 Vali Acc: 0.326 Test Loss: 3.962 Test Acc: 0.326
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7573411464691162
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.979 Vali Acc: 0.327 Test Loss: 3.979 Test Acc: 0.327
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7230453491210938
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.004 Vali Acc: 0.329 Test Loss: 4.004 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.7043075561523438
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.029 Vali Acc: 0.333 Test Loss: 4.029 Test Acc: 0.333
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7700655460357666
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.042 Vali Acc: 0.328 Test Loss: 4.042 Test Acc: 0.328
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6653072834014893
Epoch: 32, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.054 Vali Acc: 0.327 Test Loss: 4.054 Test Acc: 0.327
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3341176470588235
model parameter : 279286
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.435835838317871
Epoch: 1, Steps: 10 | Train Loss: 3.380 Vali Loss: 3.306 Vali Acc: 0.041 Test Loss: 3.306 Test Acc: 0.041
Validation loss decreased (inf --> -0.041143).  Saving model ...
Epoch: 2 cost time: 0.8186304569244385
Epoch: 2, Steps: 10 | Train Loss: 3.049 Vali Loss: 3.260 Vali Acc: 0.084 Test Loss: 3.260 Test Acc: 0.084
Validation loss decreased (-0.041143 --> -0.083497).  Saving model ...
Epoch: 3 cost time: 0.6719136238098145
Epoch: 3, Steps: 10 | Train Loss: 2.582 Vali Loss: 3.237 Vali Acc: 0.131 Test Loss: 3.237 Test Acc: 0.131
Validation loss decreased (-0.083497 --> -0.130556).  Saving model ...
Epoch: 4 cost time: 0.7737505435943604
Epoch: 4, Steps: 10 | Train Loss: 2.124 Vali Loss: 3.165 Vali Acc: 0.172 Test Loss: 3.165 Test Acc: 0.172
Validation loss decreased (-0.130556 --> -0.171733).  Saving model ...
Epoch: 5 cost time: 0.8101847171783447
Epoch: 5, Steps: 10 | Train Loss: 1.659 Vali Loss: 3.106 Vali Acc: 0.219 Test Loss: 3.106 Test Acc: 0.219
Validation loss decreased (-0.171733 --> -0.218792).  Saving model ...
Epoch: 6 cost time: 0.697512149810791
Epoch: 6, Steps: 10 | Train Loss: 1.276 Vali Loss: 3.091 Vali Acc: 0.258 Test Loss: 3.091 Test Acc: 0.258
Validation loss decreased (-0.218792 --> -0.257616).  Saving model ...
Epoch: 7 cost time: 0.7799596786499023
Epoch: 7, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.152 Vali Acc: 0.258 Test Loss: 3.152 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7745978832244873
Epoch: 8, Steps: 10 | Train Loss: 0.621 Vali Loss: 3.180 Vali Acc: 0.291 Test Loss: 3.180 Test Acc: 0.291
Validation loss decreased (-0.257616 --> -0.290556).  Saving model ...
Epoch: 9 cost time: 0.8419761657714844
Epoch: 9, Steps: 10 | Train Loss: 0.408 Vali Loss: 3.202 Vali Acc: 0.305 Test Loss: 3.202 Test Acc: 0.305
Validation loss decreased (-0.290556 --> -0.304674).  Saving model ...
Epoch: 10 cost time: 0.8172976970672607
Epoch: 10, Steps: 10 | Train Loss: 0.283 Vali Loss: 3.294 Vali Acc: 0.305 Test Loss: 3.294 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7985215187072754
Epoch: 11, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.342 Vali Acc: 0.329 Test Loss: 3.342 Test Acc: 0.329
Validation loss decreased (-0.304674 --> -0.329378).  Saving model ...
Epoch: 12 cost time: 0.7678260803222656
Epoch: 12, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.405 Vali Acc: 0.322 Test Loss: 3.405 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8176705837249756
Epoch: 13, Steps: 10 | Train Loss: 0.070 Vali Loss: 3.438 Vali Acc: 0.332 Test Loss: 3.438 Test Acc: 0.332
Validation loss decreased (-0.329378 --> -0.331730).  Saving model ...
Epoch: 14 cost time: 0.7716107368469238
Epoch: 14, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.512 Vali Acc: 0.338 Test Loss: 3.512 Test Acc: 0.338
Validation loss decreased (-0.331730 --> -0.337612).  Saving model ...
Epoch: 15 cost time: 0.7401463985443115
Epoch: 15, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.591 Vali Acc: 0.329 Test Loss: 3.591 Test Acc: 0.329
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7093667984008789
Epoch: 16, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.603 Vali Acc: 0.329 Test Loss: 3.603 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.6376821994781494
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.610 Vali Acc: 0.339 Test Loss: 3.610 Test Acc: 0.339
Validation loss decreased (-0.337612 --> -0.338787).  Saving model ...
Epoch: 18 cost time: 0.8048124313354492
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.644 Vali Acc: 0.339 Test Loss: 3.644 Test Acc: 0.339
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.768733024597168
Epoch: 19, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.685 Vali Acc: 0.336 Test Loss: 3.685 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7735869884490967
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.720 Vali Acc: 0.334 Test Loss: 3.720 Test Acc: 0.334
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7527945041656494
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.729 Vali Acc: 0.338 Test Loss: 3.729 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.6757566928863525
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.735 Vali Acc: 0.341 Test Loss: 3.735 Test Acc: 0.341
Validation loss decreased (-0.338787 --> -0.341139).  Saving model ...
Epoch: 23 cost time: 0.7609550952911377
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.755 Vali Acc: 0.341 Test Loss: 3.755 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8312358856201172
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.799 Vali Acc: 0.335 Test Loss: 3.799 Test Acc: 0.335
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7841217517852783
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.820 Vali Acc: 0.340 Test Loss: 3.820 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8807172775268555
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.815 Vali Acc: 0.340 Test Loss: 3.815 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7965807914733887
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.822 Vali Acc: 0.346 Test Loss: 3.822 Test Acc: 0.346
Validation loss decreased (-0.341139 --> -0.345844).  Saving model ...
Epoch: 28 cost time: 0.8885424137115479
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.846 Vali Acc: 0.340 Test Loss: 3.846 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8414909839630127
Epoch: 29, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.871 Vali Acc: 0.341 Test Loss: 3.871 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.8743364810943604
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.888 Vali Acc: 0.340 Test Loss: 3.888 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8395066261291504
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.897 Vali Acc: 0.344 Test Loss: 3.897 Test Acc: 0.344
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.8028018474578857
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.909 Vali Acc: 0.345 Test Loss: 3.909 Test Acc: 0.345
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8539676666259766
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.919 Vali Acc: 0.342 Test Loss: 3.919 Test Acc: 0.342
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8768622875213623
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.930 Vali Acc: 0.344 Test Loss: 3.930 Test Acc: 0.344
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8600742816925049
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.946 Vali Acc: 0.345 Test Loss: 3.946 Test Acc: 0.345
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.882910966873169
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.971 Vali Acc: 0.346 Test Loss: 3.971 Test Acc: 0.346
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.8671443462371826
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.987 Vali Acc: 0.341 Test Loss: 3.987 Test Acc: 0.341
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3458823529411765
model parameter : 279286
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3202707767486572
Epoch: 1, Steps: 10 | Train Loss: 3.322 Vali Loss: 3.289 Vali Acc: 0.035 Test Loss: 3.289 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.7775881290435791
Epoch: 2, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.242 Vali Acc: 0.082 Test Loss: 3.242 Test Acc: 0.082
Validation loss decreased (-0.035261 --> -0.082321).  Saving model ...
Epoch: 3 cost time: 0.8585913181304932
Epoch: 3, Steps: 10 | Train Loss: 2.631 Vali Loss: 3.216 Vali Acc: 0.124 Test Loss: 3.216 Test Acc: 0.124
Validation loss decreased (-0.082321 --> -0.123497).  Saving model ...
Epoch: 4 cost time: 0.7744197845458984
Epoch: 4, Steps: 10 | Train Loss: 2.237 Vali Loss: 3.141 Vali Acc: 0.174 Test Loss: 3.141 Test Acc: 0.174
Validation loss decreased (-0.123497 --> -0.174086).  Saving model ...
Epoch: 5 cost time: 0.7494449615478516
Epoch: 5, Steps: 10 | Train Loss: 1.753 Vali Loss: 3.065 Vali Acc: 0.226 Test Loss: 3.065 Test Acc: 0.226
Validation loss decreased (-0.174086 --> -0.225852).  Saving model ...
Epoch: 6 cost time: 0.717228889465332
Epoch: 6, Steps: 10 | Train Loss: 1.382 Vali Loss: 3.024 Vali Acc: 0.261 Test Loss: 3.024 Test Acc: 0.261
Validation loss decreased (-0.225852 --> -0.261146).  Saving model ...
Epoch: 7 cost time: 0.661494255065918
Epoch: 7, Steps: 10 | Train Loss: 1.049 Vali Loss: 3.052 Vali Acc: 0.262 Test Loss: 3.052 Test Acc: 0.262
Validation loss decreased (-0.261146 --> -0.262322).  Saving model ...
Epoch: 8 cost time: 0.622443437576294
Epoch: 8, Steps: 10 | Train Loss: 0.698 Vali Loss: 3.068 Vali Acc: 0.293 Test Loss: 3.068 Test Acc: 0.293
Validation loss decreased (-0.262322 --> -0.292910).  Saving model ...
Epoch: 9 cost time: 0.6841778755187988
Epoch: 9, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.093 Vali Acc: 0.312 Test Loss: 3.093 Test Acc: 0.312
Validation loss decreased (-0.292910 --> -0.311734).  Saving model ...
Epoch: 10 cost time: 0.7016968727111816
Epoch: 10, Steps: 10 | Train Loss: 0.306 Vali Loss: 3.159 Vali Acc: 0.307 Test Loss: 3.159 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7376916408538818
Epoch: 11, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.217 Vali Acc: 0.321 Test Loss: 3.217 Test Acc: 0.321
Validation loss decreased (-0.311734 --> -0.321144).  Saving model ...
Epoch: 12 cost time: 0.7567267417907715
Epoch: 12, Steps: 10 | Train Loss: 0.115 Vali Loss: 3.238 Vali Acc: 0.335 Test Loss: 3.238 Test Acc: 0.335
Validation loss decreased (-0.321144 --> -0.335262).  Saving model ...
Epoch: 13 cost time: 0.697699785232544
Epoch: 13, Steps: 10 | Train Loss: 0.072 Vali Loss: 3.272 Vali Acc: 0.344 Test Loss: 3.272 Test Acc: 0.344
Validation loss decreased (-0.335262 --> -0.343497).  Saving model ...
Epoch: 14 cost time: 0.6468005180358887
Epoch: 14, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.335 Vali Acc: 0.344 Test Loss: 3.335 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.687000036239624
Epoch: 15, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.427 Vali Acc: 0.329 Test Loss: 3.427 Test Acc: 0.329
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7214090824127197
Epoch: 16, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.444 Vali Acc: 0.341 Test Loss: 3.444 Test Acc: 0.341
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7162959575653076
Epoch: 17, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.442 Vali Acc: 0.347 Test Loss: 3.442 Test Acc: 0.347
Validation loss decreased (-0.343497 --> -0.347024).  Saving model ...
Epoch: 18 cost time: 0.6814885139465332
Epoch: 18, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.474 Vali Acc: 0.349 Test Loss: 3.474 Test Acc: 0.349
Validation loss decreased (-0.347024 --> -0.349377).  Saving model ...
Epoch: 19 cost time: 0.6987314224243164
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.490 Vali Acc: 0.342 Test Loss: 3.490 Test Acc: 0.342
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8105859756469727
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.530 Vali Acc: 0.340 Test Loss: 3.530 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.71897292137146
Epoch: 21, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.549 Vali Acc: 0.344 Test Loss: 3.549 Test Acc: 0.344
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6876423358917236
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.566 Vali Acc: 0.342 Test Loss: 3.566 Test Acc: 0.342
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6519174575805664
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.580 Vali Acc: 0.342 Test Loss: 3.580 Test Acc: 0.342
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6440391540527344
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.598 Vali Acc: 0.347 Test Loss: 3.598 Test Acc: 0.347
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7057421207427979
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.628 Vali Acc: 0.346 Test Loss: 3.628 Test Acc: 0.346
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.7064757347106934
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.631 Vali Acc: 0.347 Test Loss: 3.631 Test Acc: 0.347
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.6300704479217529
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.636 Vali Acc: 0.344 Test Loss: 3.636 Test Acc: 0.344
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7295615673065186
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.656 Vali Acc: 0.345 Test Loss: 3.656 Test Acc: 0.345
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.34941176470588237
model parameter : 279286
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2687828540802
Epoch: 1, Steps: 10 | Train Loss: 3.283 Vali Loss: 3.277 Vali Acc: 0.045 Test Loss: 3.277 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.6750333309173584
Epoch: 2, Steps: 10 | Train Loss: 3.087 Vali Loss: 3.241 Vali Acc: 0.069 Test Loss: 3.241 Test Acc: 0.069
Validation loss decreased (-0.044673 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.8113901615142822
Epoch: 3, Steps: 10 | Train Loss: 2.779 Vali Loss: 3.227 Vali Acc: 0.105 Test Loss: 3.227 Test Acc: 0.105
Validation loss decreased (-0.069379 --> -0.104674).  Saving model ...
Epoch: 4 cost time: 0.7296969890594482
Epoch: 4, Steps: 10 | Train Loss: 2.465 Vali Loss: 3.178 Vali Acc: 0.145 Test Loss: 3.178 Test Acc: 0.145
Validation loss decreased (-0.104674 --> -0.144674).  Saving model ...
Epoch: 5 cost time: 0.7910358905792236
Epoch: 5, Steps: 10 | Train Loss: 2.103 Vali Loss: 3.101 Vali Acc: 0.180 Test Loss: 3.101 Test Acc: 0.180
Validation loss decreased (-0.144674 --> -0.179969).  Saving model ...
Epoch: 6 cost time: 0.8094704151153564
Epoch: 6, Steps: 10 | Train Loss: 1.732 Vali Loss: 3.032 Vali Acc: 0.225 Test Loss: 3.032 Test Acc: 0.225
Validation loss decreased (-0.179969 --> -0.224676).  Saving model ...
Epoch: 7 cost time: 0.7994093894958496
Epoch: 7, Steps: 10 | Train Loss: 1.418 Vali Loss: 3.011 Vali Acc: 0.228 Test Loss: 3.011 Test Acc: 0.228
Validation loss decreased (-0.224676 --> -0.228205).  Saving model ...
Epoch: 8 cost time: 0.7231574058532715
Epoch: 8, Steps: 10 | Train Loss: 0.995 Vali Loss: 3.009 Vali Acc: 0.252 Test Loss: 3.009 Test Acc: 0.252
Validation loss decreased (-0.228205 --> -0.251735).  Saving model ...
Epoch: 9 cost time: 0.7022240161895752
Epoch: 9, Steps: 10 | Train Loss: 0.743 Vali Loss: 3.015 Vali Acc: 0.273 Test Loss: 3.015 Test Acc: 0.273
Validation loss decreased (-0.251735 --> -0.272911).  Saving model ...
Epoch: 10 cost time: 0.7333846092224121
Epoch: 10, Steps: 10 | Train Loss: 0.530 Vali Loss: 3.040 Vali Acc: 0.289 Test Loss: 3.040 Test Acc: 0.289
Validation loss decreased (-0.272911 --> -0.289381).  Saving model ...
Epoch: 11 cost time: 0.5867364406585693
Epoch: 11, Steps: 10 | Train Loss: 0.347 Vali Loss: 3.079 Vali Acc: 0.294 Test Loss: 3.079 Test Acc: 0.294
Validation loss decreased (-0.289381 --> -0.294087).  Saving model ...
Epoch: 12 cost time: 0.6919639110565186
Epoch: 12, Steps: 10 | Train Loss: 0.196 Vali Loss: 3.131 Vali Acc: 0.295 Test Loss: 3.131 Test Acc: 0.295
Validation loss decreased (-0.294087 --> -0.295263).  Saving model ...
Epoch: 13 cost time: 0.7157816886901855
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.165 Vali Acc: 0.305 Test Loss: 3.165 Test Acc: 0.305
Validation loss decreased (-0.295263 --> -0.304674).  Saving model ...
Epoch: 14 cost time: 0.7436368465423584
Epoch: 14, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.241 Vali Acc: 0.313 Test Loss: 3.241 Test Acc: 0.313
Validation loss decreased (-0.304674 --> -0.312909).  Saving model ...
Epoch: 15 cost time: 0.7543103694915771
Epoch: 15, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.324 Vali Acc: 0.294 Test Loss: 3.324 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7380280494689941
Epoch: 16, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.355 Vali Acc: 0.299 Test Loss: 3.355 Test Acc: 0.299
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7219243049621582
Epoch: 17, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.372 Vali Acc: 0.308 Test Loss: 3.372 Test Acc: 0.308
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7019085884094238
Epoch: 18, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.407 Vali Acc: 0.308 Test Loss: 3.407 Test Acc: 0.308
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.6925182342529297
Epoch: 19, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.441 Vali Acc: 0.314 Test Loss: 3.441 Test Acc: 0.314
Validation loss decreased (-0.312909 --> -0.314083).  Saving model ...
Epoch: 20 cost time: 0.618131160736084
Epoch: 20, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.478 Vali Acc: 0.312 Test Loss: 3.478 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7057609558105469
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.494 Vali Acc: 0.313 Test Loss: 3.494 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.56882643699646
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.503 Vali Acc: 0.311 Test Loss: 3.503 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7301454544067383
Epoch: 23, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.529 Vali Acc: 0.311 Test Loss: 3.529 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7418994903564453
Epoch: 24, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.563 Vali Acc: 0.306 Test Loss: 3.563 Test Acc: 0.306
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7541570663452148
Epoch: 25, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.589 Vali Acc: 0.306 Test Loss: 3.589 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7071785926818848
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.596 Vali Acc: 0.306 Test Loss: 3.596 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6604814529418945
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.605 Vali Acc: 0.308 Test Loss: 3.605 Test Acc: 0.308
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7155389785766602
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.626 Vali Acc: 0.306 Test Loss: 3.626 Test Acc: 0.306
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6874954700469971
Epoch: 29, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.656 Vali Acc: 0.305 Test Loss: 3.656 Test Acc: 0.305
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 279286
model size : 2.30MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.354609727859497
Epoch: 1, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.280 Vali Acc: 0.058 Test Loss: 3.280 Test Acc: 0.058
Validation loss decreased (inf --> -0.057614).  Saving model ...
Epoch: 2 cost time: 0.8032717704772949
Epoch: 2, Steps: 10 | Train Loss: 2.958 Vali Loss: 3.242 Vali Acc: 0.104 Test Loss: 3.242 Test Acc: 0.104
Validation loss decreased (-0.057614 --> -0.103497).  Saving model ...
Epoch: 3 cost time: 0.7856924533843994
Epoch: 3, Steps: 10 | Train Loss: 2.456 Vali Loss: 3.216 Vali Acc: 0.148 Test Loss: 3.216 Test Acc: 0.148
Validation loss decreased (-0.103497 --> -0.148203).  Saving model ...
Epoch: 4 cost time: 0.7378013134002686
Epoch: 4, Steps: 10 | Train Loss: 2.065 Vali Loss: 3.160 Vali Acc: 0.185 Test Loss: 3.160 Test Acc: 0.185
Validation loss decreased (-0.148203 --> -0.184674).  Saving model ...
Epoch: 5 cost time: 0.8075675964355469
Epoch: 5, Steps: 10 | Train Loss: 1.567 Vali Loss: 3.111 Vali Acc: 0.239 Test Loss: 3.111 Test Acc: 0.239
Validation loss decreased (-0.184674 --> -0.238792).  Saving model ...
Epoch: 6 cost time: 0.7692005634307861
Epoch: 6, Steps: 10 | Train Loss: 1.242 Vali Loss: 3.112 Vali Acc: 0.252 Test Loss: 3.112 Test Acc: 0.252
Validation loss decreased (-0.238792 --> -0.251734).  Saving model ...
Epoch: 7 cost time: 0.7044272422790527
Epoch: 7, Steps: 10 | Train Loss: 0.835 Vali Loss: 3.162 Vali Acc: 0.275 Test Loss: 3.162 Test Acc: 0.275
Validation loss decreased (-0.251734 --> -0.275263).  Saving model ...
Epoch: 8 cost time: 0.8186225891113281
Epoch: 8, Steps: 10 | Train Loss: 0.580 Vali Loss: 3.239 Vali Acc: 0.281 Test Loss: 3.239 Test Acc: 0.281
Validation loss decreased (-0.275263 --> -0.281144).  Saving model ...
Epoch: 9 cost time: 0.8202793598175049
Epoch: 9, Steps: 10 | Train Loss: 0.383 Vali Loss: 3.266 Vali Acc: 0.304 Test Loss: 3.266 Test Acc: 0.304
Validation loss decreased (-0.281144 --> -0.303497).  Saving model ...
Epoch: 10 cost time: 0.7086071968078613
Epoch: 10, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.339 Vali Acc: 0.306 Test Loss: 3.339 Test Acc: 0.306
Validation loss decreased (-0.303497 --> -0.305849).  Saving model ...
Epoch: 11 cost time: 0.7350728511810303
Epoch: 11, Steps: 10 | Train Loss: 0.174 Vali Loss: 3.442 Vali Acc: 0.315 Test Loss: 3.442 Test Acc: 0.315
Validation loss decreased (-0.305849 --> -0.315260).  Saving model ...
Epoch: 12 cost time: 0.719315767288208
Epoch: 12, Steps: 10 | Train Loss: 0.131 Vali Loss: 3.520 Vali Acc: 0.314 Test Loss: 3.520 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7114934921264648
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.578 Vali Acc: 0.320 Test Loss: 3.578 Test Acc: 0.320
Validation loss decreased (-0.315260 --> -0.319964).  Saving model ...
Epoch: 14 cost time: 0.6952345371246338
Epoch: 14, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.659 Vali Acc: 0.322 Test Loss: 3.659 Test Acc: 0.322
Validation loss decreased (-0.319964 --> -0.322316).  Saving model ...
Epoch: 15 cost time: 0.702385663986206
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.699 Vali Acc: 0.331 Test Loss: 3.699 Test Acc: 0.331
Validation loss decreased (-0.322316 --> -0.330551).  Saving model ...
Epoch: 16 cost time: 0.74312424659729
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.706 Vali Acc: 0.326 Test Loss: 3.706 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8032267093658447
Epoch: 17, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.741 Vali Acc: 0.326 Test Loss: 3.741 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8263533115386963
Epoch: 18, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.782 Vali Acc: 0.332 Test Loss: 3.782 Test Acc: 0.332
Validation loss decreased (-0.330551 --> -0.331727).  Saving model ...
Epoch: 19 cost time: 0.7602455615997314
Epoch: 19, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.810 Vali Acc: 0.326 Test Loss: 3.810 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7565572261810303
Epoch: 20, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.831 Vali Acc: 0.327 Test Loss: 3.831 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6697888374328613
Epoch: 21, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.856 Vali Acc: 0.322 Test Loss: 3.856 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6135830879211426
Epoch: 22, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.862 Vali Acc: 0.329 Test Loss: 3.862 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6120650768280029
Epoch: 23, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.876 Vali Acc: 0.327 Test Loss: 3.876 Test Acc: 0.327
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5701258182525635
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.896 Vali Acc: 0.329 Test Loss: 3.896 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.7356994152069092
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.918 Vali Acc: 0.329 Test Loss: 3.918 Test Acc: 0.329
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6680397987365723
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.957 Vali Acc: 0.332 Test Loss: 3.957 Test Acc: 0.332
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.7774500846862793
Epoch: 27, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.979 Vali Acc: 0.331 Test Loss: 3.979 Test Acc: 0.331
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.7757272720336914
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.994 Vali Acc: 0.336 Test Loss: 3.994 Test Acc: 0.336
Validation loss decreased (-0.331727 --> -0.336431).  Saving model ...
Epoch: 29 cost time: 0.7630987167358398
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 4.001 Vali Acc: 0.331 Test Loss: 4.001 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.765960693359375
Epoch: 30, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.022 Vali Acc: 0.333 Test Loss: 4.022 Test Acc: 0.333
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6801013946533203
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.042 Vali Acc: 0.335 Test Loss: 4.042 Test Acc: 0.335
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7598202228546143
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.048 Vali Acc: 0.335 Test Loss: 4.048 Test Acc: 0.335
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.783750057220459
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.061 Vali Acc: 0.335 Test Loss: 4.061 Test Acc: 0.335
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7995977401733398
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.085 Vali Acc: 0.334 Test Loss: 4.085 Test Acc: 0.334
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7748582363128662
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.102 Vali Acc: 0.333 Test Loss: 4.102 Test Acc: 0.333
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.8218436241149902
Epoch: 36, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.122 Vali Acc: 0.328 Test Loss: 4.122 Test Acc: 0.328
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7160687446594238
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.133 Vali Acc: 0.334 Test Loss: 4.133 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.8014042377471924
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.141 Vali Acc: 0.333 Test Loss: 4.141 Test Acc: 0.333
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33647058823529413
model parameter : 271094
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4471511840820312
Epoch: 1, Steps: 10 | Train Loss: 3.219 Vali Loss: 3.258 Vali Acc: 0.069 Test Loss: 3.258 Test Acc: 0.069
Validation loss decreased (inf --> -0.069379).  Saving model ...
Epoch: 2 cost time: 0.6794607639312744
Epoch: 2, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.219 Vali Acc: 0.106 Test Loss: 3.219 Test Acc: 0.106
Validation loss decreased (-0.069379 --> -0.105850).  Saving model ...
Epoch: 3 cost time: 0.7441709041595459
Epoch: 3, Steps: 10 | Train Loss: 2.511 Vali Loss: 3.193 Vali Acc: 0.148 Test Loss: 3.193 Test Acc: 0.148
Validation loss decreased (-0.105850 --> -0.148203).  Saving model ...
Epoch: 4 cost time: 0.7829608917236328
Epoch: 4, Steps: 10 | Train Loss: 2.123 Vali Loss: 3.137 Vali Acc: 0.179 Test Loss: 3.137 Test Acc: 0.179
Validation loss decreased (-0.148203 --> -0.178792).  Saving model ...
Epoch: 5 cost time: 0.6490750312805176
Epoch: 5, Steps: 10 | Train Loss: 1.633 Vali Loss: 3.077 Vali Acc: 0.239 Test Loss: 3.077 Test Acc: 0.239
Validation loss decreased (-0.178792 --> -0.238793).  Saving model ...
Epoch: 6 cost time: 0.7018003463745117
Epoch: 6, Steps: 10 | Train Loss: 1.274 Vali Loss: 3.052 Vali Acc: 0.258 Test Loss: 3.052 Test Acc: 0.258
Validation loss decreased (-0.238793 --> -0.257617).  Saving model ...
Epoch: 7 cost time: 0.6822776794433594
Epoch: 7, Steps: 10 | Train Loss: 0.879 Vali Loss: 3.089 Vali Acc: 0.284 Test Loss: 3.089 Test Acc: 0.284
Validation loss decreased (-0.257617 --> -0.283499).  Saving model ...
Epoch: 8 cost time: 0.6560490131378174
Epoch: 8, Steps: 10 | Train Loss: 0.610 Vali Loss: 3.160 Vali Acc: 0.292 Test Loss: 3.160 Test Acc: 0.292
Validation loss decreased (-0.283499 --> -0.291733).  Saving model ...
Epoch: 9 cost time: 0.6127634048461914
Epoch: 9, Steps: 10 | Train Loss: 0.405 Vali Loss: 3.171 Vali Acc: 0.309 Test Loss: 3.171 Test Acc: 0.309
Validation loss decreased (-0.291733 --> -0.309380).  Saving model ...
Epoch: 10 cost time: 0.7025344371795654
Epoch: 10, Steps: 10 | Train Loss: 0.253 Vali Loss: 3.222 Vali Acc: 0.327 Test Loss: 3.222 Test Acc: 0.327
Validation loss decreased (-0.309380 --> -0.327027).  Saving model ...
Epoch: 11 cost time: 0.7547979354858398
Epoch: 11, Steps: 10 | Train Loss: 0.165 Vali Loss: 3.338 Vali Acc: 0.324 Test Loss: 3.338 Test Acc: 0.324
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6879727840423584
Epoch: 12, Steps: 10 | Train Loss: 0.118 Vali Loss: 3.413 Vali Acc: 0.325 Test Loss: 3.413 Test Acc: 0.325
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7401690483093262
Epoch: 13, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.444 Vali Acc: 0.318 Test Loss: 3.444 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6922693252563477
Epoch: 14, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.514 Vali Acc: 0.335 Test Loss: 3.514 Test Acc: 0.335
Validation loss decreased (-0.327027 --> -0.335259).  Saving model ...
Epoch: 15 cost time: 0.729334831237793
Epoch: 15, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.562 Vali Acc: 0.335 Test Loss: 3.562 Test Acc: 0.335
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.743833065032959
Epoch: 16, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.583 Vali Acc: 0.331 Test Loss: 3.583 Test Acc: 0.331
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7218856811523438
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.598 Vali Acc: 0.336 Test Loss: 3.598 Test Acc: 0.336
Validation loss decreased (-0.335259 --> -0.336435).  Saving model ...
Epoch: 18 cost time: 0.7110066413879395
Epoch: 18, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.636 Vali Acc: 0.340 Test Loss: 3.636 Test Acc: 0.340
Validation loss decreased (-0.336435 --> -0.339964).  Saving model ...
Epoch: 19 cost time: 0.7292325496673584
Epoch: 19, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.657 Vali Acc: 0.340 Test Loss: 3.657 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7613885402679443
Epoch: 20, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.688 Vali Acc: 0.338 Test Loss: 3.688 Test Acc: 0.338
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6941428184509277
Epoch: 21, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.729 Vali Acc: 0.338 Test Loss: 3.729 Test Acc: 0.338
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.671527624130249
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.733 Vali Acc: 0.341 Test Loss: 3.733 Test Acc: 0.341
Validation loss decreased (-0.339964 --> -0.341139).  Saving model ...
Epoch: 23 cost time: 0.7186317443847656
Epoch: 23, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.737 Vali Acc: 0.344 Test Loss: 3.737 Test Acc: 0.344
Validation loss decreased (-0.341139 --> -0.343492).  Saving model ...
Epoch: 24 cost time: 0.7198755741119385
Epoch: 24, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.747 Vali Acc: 0.344 Test Loss: 3.747 Test Acc: 0.344
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7531085014343262
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.761 Vali Acc: 0.345 Test Loss: 3.761 Test Acc: 0.345
Validation loss decreased (-0.343492 --> -0.344668).  Saving model ...
Epoch: 26 cost time: 0.6601126194000244
Epoch: 26, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.796 Vali Acc: 0.338 Test Loss: 3.796 Test Acc: 0.338
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8048818111419678
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.814 Vali Acc: 0.339 Test Loss: 3.814 Test Acc: 0.339
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.803164005279541
Epoch: 28, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.830 Vali Acc: 0.340 Test Loss: 3.830 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7816758155822754
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.835 Vali Acc: 0.341 Test Loss: 3.835 Test Acc: 0.341
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.770702600479126
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.853 Vali Acc: 0.340 Test Loss: 3.853 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.7289509773254395
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.867 Vali Acc: 0.339 Test Loss: 3.867 Test Acc: 0.339
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.8033871650695801
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.877 Vali Acc: 0.339 Test Loss: 3.877 Test Acc: 0.339
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.6189355850219727
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.890 Vali Acc: 0.342 Test Loss: 3.890 Test Acc: 0.342
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.775399923324585
Epoch: 34, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.907 Vali Acc: 0.340 Test Loss: 3.907 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.7304282188415527
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.922 Vali Acc: 0.340 Test Loss: 3.922 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3447058823529412
model parameter : 271094
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5559544563293457
Epoch: 1, Steps: 10 | Train Loss: 3.230 Vali Loss: 3.261 Vali Acc: 0.055 Test Loss: 3.261 Test Acc: 0.055
Validation loss decreased (inf --> -0.055262).  Saving model ...
Epoch: 2 cost time: 0.6739959716796875
Epoch: 2, Steps: 10 | Train Loss: 2.990 Vali Loss: 3.220 Vali Acc: 0.108 Test Loss: 3.220 Test Acc: 0.108
Validation loss decreased (-0.055262 --> -0.108203).  Saving model ...
Epoch: 3 cost time: 0.7431635856628418
Epoch: 3, Steps: 10 | Train Loss: 2.580 Vali Loss: 3.189 Vali Acc: 0.151 Test Loss: 3.189 Test Acc: 0.151
Validation loss decreased (-0.108203 --> -0.150556).  Saving model ...
Epoch: 4 cost time: 0.7742958068847656
Epoch: 4, Steps: 10 | Train Loss: 2.212 Vali Loss: 3.134 Vali Acc: 0.167 Test Loss: 3.134 Test Acc: 0.167
Validation loss decreased (-0.150556 --> -0.167027).  Saving model ...
Epoch: 5 cost time: 0.7144520282745361
Epoch: 5, Steps: 10 | Train Loss: 1.735 Vali Loss: 3.054 Vali Acc: 0.222 Test Loss: 3.054 Test Acc: 0.222
Validation loss decreased (-0.167027 --> -0.222322).  Saving model ...
Epoch: 6 cost time: 0.7507550716400146
Epoch: 6, Steps: 10 | Train Loss: 1.369 Vali Loss: 3.006 Vali Acc: 0.259 Test Loss: 3.006 Test Acc: 0.259
Validation loss decreased (-0.222322 --> -0.258793).  Saving model ...
Epoch: 7 cost time: 0.7035231590270996
Epoch: 7, Steps: 10 | Train Loss: 0.967 Vali Loss: 3.020 Vali Acc: 0.276 Test Loss: 3.020 Test Acc: 0.276
Validation loss decreased (-0.258793 --> -0.276440).  Saving model ...
Epoch: 8 cost time: 0.7847280502319336
Epoch: 8, Steps: 10 | Train Loss: 0.695 Vali Loss: 3.068 Vali Acc: 0.285 Test Loss: 3.068 Test Acc: 0.285
Validation loss decreased (-0.276440 --> -0.284675).  Saving model ...
Epoch: 9 cost time: 0.7077114582061768
Epoch: 9, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.076 Vali Acc: 0.301 Test Loss: 3.076 Test Acc: 0.301
Validation loss decreased (-0.284675 --> -0.301146).  Saving model ...
Epoch: 10 cost time: 0.7420070171356201
Epoch: 10, Steps: 10 | Train Loss: 0.294 Vali Loss: 3.108 Vali Acc: 0.320 Test Loss: 3.108 Test Acc: 0.320
Validation loss decreased (-0.301146 --> -0.319969).  Saving model ...
Epoch: 11 cost time: 0.7364251613616943
Epoch: 11, Steps: 10 | Train Loss: 0.187 Vali Loss: 3.217 Vali Acc: 0.329 Test Loss: 3.217 Test Acc: 0.329
Validation loss decreased (-0.319969 --> -0.329380).  Saving model ...
Epoch: 12 cost time: 0.7397406101226807
Epoch: 12, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.294 Vali Acc: 0.320 Test Loss: 3.294 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.778594970703125
Epoch: 13, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.310 Vali Acc: 0.319 Test Loss: 3.310 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.7409672737121582
Epoch: 14, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.337 Vali Acc: 0.327 Test Loss: 3.337 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.7640137672424316
Epoch: 15, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.394 Vali Acc: 0.332 Test Loss: 3.394 Test Acc: 0.332
Validation loss decreased (-0.329380 --> -0.331731).  Saving model ...
Epoch: 16 cost time: 0.7021160125732422
Epoch: 16, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.426 Vali Acc: 0.335 Test Loss: 3.426 Test Acc: 0.335
Validation loss decreased (-0.331731 --> -0.335260).  Saving model ...
Epoch: 17 cost time: 0.7366621494293213
Epoch: 17, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.439 Vali Acc: 0.331 Test Loss: 3.439 Test Acc: 0.331
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7248096466064453
Epoch: 18, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.470 Vali Acc: 0.328 Test Loss: 3.470 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7014870643615723
Epoch: 19, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.494 Vali Acc: 0.331 Test Loss: 3.494 Test Acc: 0.331
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6932251453399658
Epoch: 20, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.516 Vali Acc: 0.329 Test Loss: 3.516 Test Acc: 0.329
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7270398139953613
Epoch: 21, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.540 Vali Acc: 0.331 Test Loss: 3.540 Test Acc: 0.331
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.764998197555542
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.550 Vali Acc: 0.336 Test Loss: 3.550 Test Acc: 0.336
Validation loss decreased (-0.335260 --> -0.336435).  Saving model ...
Epoch: 23 cost time: 0.8356587886810303
Epoch: 23, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.562 Vali Acc: 0.334 Test Loss: 3.562 Test Acc: 0.334
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7528424263000488
Epoch: 24, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.577 Vali Acc: 0.336 Test Loss: 3.577 Test Acc: 0.336
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8221988677978516
Epoch: 25, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.597 Vali Acc: 0.338 Test Loss: 3.597 Test Acc: 0.338
Validation loss decreased (-0.336435 --> -0.337611).  Saving model ...
Epoch: 26 cost time: 0.7711429595947266
Epoch: 26, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.618 Vali Acc: 0.336 Test Loss: 3.618 Test Acc: 0.336
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7662646770477295
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.634 Vali Acc: 0.340 Test Loss: 3.634 Test Acc: 0.340
Validation loss decreased (-0.337611 --> -0.339964).  Saving model ...
Epoch: 28 cost time: 0.7880001068115234
Epoch: 28, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.653 Vali Acc: 0.341 Test Loss: 3.653 Test Acc: 0.341
Validation loss decreased (-0.339964 --> -0.341140).  Saving model ...
Epoch: 29 cost time: 0.7896535396575928
Epoch: 29, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.659 Vali Acc: 0.341 Test Loss: 3.659 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7405104637145996
Epoch: 30, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.677 Vali Acc: 0.341 Test Loss: 3.677 Test Acc: 0.341
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7872610092163086
Epoch: 31, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.690 Vali Acc: 0.340 Test Loss: 3.690 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7745523452758789
Epoch: 32, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.703 Vali Acc: 0.338 Test Loss: 3.703 Test Acc: 0.338
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6417849063873291
Epoch: 33, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.714 Vali Acc: 0.336 Test Loss: 3.714 Test Acc: 0.336
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7501904964447021
Epoch: 34, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.728 Vali Acc: 0.335 Test Loss: 3.728 Test Acc: 0.335
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.7709841728210449
Epoch: 35, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.741 Vali Acc: 0.338 Test Loss: 3.741 Test Acc: 0.338
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.6694793701171875
Epoch: 36, Steps: 10 | Train Loss: 0.004 Vali Loss: 3.757 Vali Acc: 0.338 Test Loss: 3.757 Test Acc: 0.338
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.640533447265625
Epoch: 37, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.769 Vali Acc: 0.334 Test Loss: 3.769 Test Acc: 0.334
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6562044620513916
Epoch: 38, Steps: 10 | Train Loss: 0.003 Vali Loss: 3.779 Vali Acc: 0.335 Test Loss: 3.779 Test Acc: 0.335
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3411764705882353
model parameter : 271094
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.1899499893188477
Epoch: 1, Steps: 10 | Train Loss: 3.232 Vali Loss: 3.254 Vali Acc: 0.060 Test Loss: 3.254 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.639655590057373
Epoch: 2, Steps: 10 | Train Loss: 3.069 Vali Loss: 3.222 Vali Acc: 0.092 Test Loss: 3.222 Test Acc: 0.092
Validation loss decreased (-0.059967 --> -0.091732).  Saving model ...
Epoch: 3 cost time: 0.6270339488983154
Epoch: 3, Steps: 10 | Train Loss: 2.753 Vali Loss: 3.202 Vali Acc: 0.129 Test Loss: 3.202 Test Acc: 0.129
Validation loss decreased (-0.091732 --> -0.129380).  Saving model ...
Epoch: 4 cost time: 0.6087536811828613
Epoch: 4, Steps: 10 | Train Loss: 2.469 Vali Loss: 3.167 Vali Acc: 0.146 Test Loss: 3.167 Test Acc: 0.146
Validation loss decreased (-0.129380 --> -0.145851).  Saving model ...
Epoch: 5 cost time: 0.6406514644622803
Epoch: 5, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.089 Vali Acc: 0.173 Test Loss: 3.089 Test Acc: 0.173
Validation loss decreased (-0.145851 --> -0.172910).  Saving model ...
Epoch: 6 cost time: 0.6479954719543457
Epoch: 6, Steps: 10 | Train Loss: 1.709 Vali Loss: 3.013 Vali Acc: 0.211 Test Loss: 3.013 Test Acc: 0.211
Validation loss decreased (-0.172910 --> -0.210558).  Saving model ...
Epoch: 7 cost time: 0.6738855838775635
Epoch: 7, Steps: 10 | Train Loss: 1.313 Vali Loss: 2.976 Vali Acc: 0.239 Test Loss: 2.976 Test Acc: 0.239
Validation loss decreased (-0.210558 --> -0.238794).  Saving model ...
Epoch: 8 cost time: 0.6836690902709961
Epoch: 8, Steps: 10 | Train Loss: 1.013 Vali Loss: 2.988 Vali Acc: 0.242 Test Loss: 2.988 Test Acc: 0.242
Validation loss decreased (-0.238794 --> -0.242323).  Saving model ...
Epoch: 9 cost time: 0.6178343296051025
Epoch: 9, Steps: 10 | Train Loss: 0.742 Vali Loss: 2.990 Vali Acc: 0.273 Test Loss: 2.990 Test Acc: 0.273
Validation loss decreased (-0.242323 --> -0.272911).  Saving model ...
Epoch: 10 cost time: 0.6619408130645752
Epoch: 10, Steps: 10 | Train Loss: 0.509 Vali Loss: 2.995 Vali Acc: 0.287 Test Loss: 2.995 Test Acc: 0.287
Validation loss decreased (-0.272911 --> -0.287029).  Saving model ...
Epoch: 11 cost time: 0.6782197952270508
Epoch: 11, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.055 Vali Acc: 0.301 Test Loss: 3.055 Test Acc: 0.301
Validation loss decreased (-0.287029 --> -0.301146).  Saving model ...
Epoch: 12 cost time: 0.7642974853515625
Epoch: 12, Steps: 10 | Train Loss: 0.218 Vali Loss: 3.143 Vali Acc: 0.291 Test Loss: 3.143 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6795134544372559
Epoch: 13, Steps: 10 | Train Loss: 0.126 Vali Loss: 3.176 Vali Acc: 0.294 Test Loss: 3.176 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.803497314453125
Epoch: 14, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.233 Vali Acc: 0.298 Test Loss: 3.233 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.764815092086792
Epoch: 15, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.298 Vali Acc: 0.309 Test Loss: 3.298 Test Acc: 0.309
Validation loss decreased (-0.301146 --> -0.309379).  Saving model ...
Epoch: 16 cost time: 0.749347448348999
Epoch: 16, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.345 Vali Acc: 0.305 Test Loss: 3.345 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7247927188873291
Epoch: 17, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.353 Vali Acc: 0.313 Test Loss: 3.353 Test Acc: 0.313
Validation loss decreased (-0.309379 --> -0.312908).  Saving model ...
Epoch: 18 cost time: 0.7547073364257812
Epoch: 18, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.374 Vali Acc: 0.311 Test Loss: 3.374 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8055365085601807
Epoch: 19, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.399 Vali Acc: 0.311 Test Loss: 3.399 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8008890151977539
Epoch: 20, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.425 Vali Acc: 0.309 Test Loss: 3.425 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.7924954891204834
Epoch: 21, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.457 Vali Acc: 0.311 Test Loss: 3.457 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8147103786468506
Epoch: 22, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.472 Vali Acc: 0.308 Test Loss: 3.472 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.732731819152832
Epoch: 23, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.489 Vali Acc: 0.308 Test Loss: 3.489 Test Acc: 0.308
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.8521654605865479
Epoch: 24, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.505 Vali Acc: 0.307 Test Loss: 3.505 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7764143943786621
Epoch: 25, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.529 Vali Acc: 0.309 Test Loss: 3.529 Test Acc: 0.309
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7051465511322021
Epoch: 26, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.568 Vali Acc: 0.305 Test Loss: 3.568 Test Acc: 0.305
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.7493243217468262
Epoch: 27, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.587 Vali Acc: 0.308 Test Loss: 3.587 Test Acc: 0.308
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3129411764705882
model parameter : 271094
model size : 2.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3280181884765625
Epoch: 1, Steps: 10 | Train Loss: 3.380 Vali Loss: 3.340 Vali Acc: 0.032 Test Loss: 3.340 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.722010612487793
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.292 Vali Acc: 0.062 Test Loss: 3.292 Test Acc: 0.062
Validation loss decreased (-0.031731 --> -0.062320).  Saving model ...
Epoch: 3 cost time: 0.6778409481048584
Epoch: 3, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.276 Vali Acc: 0.086 Test Loss: 3.276 Test Acc: 0.086
Validation loss decreased (-0.062320 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.6726949214935303
Epoch: 4, Steps: 10 | Train Loss: 2.643 Vali Loss: 3.247 Vali Acc: 0.116 Test Loss: 3.247 Test Acc: 0.116
Validation loss decreased (-0.085850 --> -0.116438).  Saving model ...
Epoch: 5 cost time: 0.8171215057373047
Epoch: 5, Steps: 10 | Train Loss: 2.345 Vali Loss: 3.194 Vali Acc: 0.152 Test Loss: 3.194 Test Acc: 0.152
Validation loss decreased (-0.116438 --> -0.151733).  Saving model ...
Epoch: 6 cost time: 0.5970442295074463
Epoch: 6, Steps: 10 | Train Loss: 2.012 Vali Loss: 3.145 Vali Acc: 0.172 Test Loss: 3.145 Test Acc: 0.172
Validation loss decreased (-0.151733 --> -0.171733).  Saving model ...
Epoch: 7 cost time: 0.6586899757385254
Epoch: 7, Steps: 10 | Train Loss: 1.749 Vali Loss: 3.101 Vali Acc: 0.182 Test Loss: 3.101 Test Acc: 0.182
Validation loss decreased (-0.171733 --> -0.182322).  Saving model ...
Epoch: 8 cost time: 0.6735224723815918
Epoch: 8, Steps: 10 | Train Loss: 1.490 Vali Loss: 3.077 Vali Acc: 0.219 Test Loss: 3.077 Test Acc: 0.219
Validation loss decreased (-0.182322 --> -0.218793).  Saving model ...
Epoch: 9 cost time: 0.6704754829406738
Epoch: 9, Steps: 10 | Train Loss: 1.302 Vali Loss: 3.095 Vali Acc: 0.234 Test Loss: 3.095 Test Acc: 0.234
Validation loss decreased (-0.218793 --> -0.234087).  Saving model ...
Epoch: 10 cost time: 0.7062582969665527
Epoch: 10, Steps: 10 | Train Loss: 1.007 Vali Loss: 3.107 Vali Acc: 0.233 Test Loss: 3.107 Test Acc: 0.233
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.7025763988494873
Epoch: 11, Steps: 10 | Train Loss: 0.832 Vali Loss: 3.112 Vali Acc: 0.261 Test Loss: 3.112 Test Acc: 0.261
Validation loss decreased (-0.234087 --> -0.261145).  Saving model ...
Epoch: 12 cost time: 0.6945621967315674
Epoch: 12, Steps: 10 | Train Loss: 0.625 Vali Loss: 3.140 Vali Acc: 0.269 Test Loss: 3.140 Test Acc: 0.269
Validation loss decreased (-0.261145 --> -0.269380).  Saving model ...
Epoch: 13 cost time: 0.7279019355773926
Epoch: 13, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.176 Vali Acc: 0.274 Test Loss: 3.176 Test Acc: 0.274
Validation loss decreased (-0.269380 --> -0.274086).  Saving model ...
Epoch: 14 cost time: 0.7314045429229736
Epoch: 14, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.183 Vali Acc: 0.278 Test Loss: 3.183 Test Acc: 0.278
Validation loss decreased (-0.274086 --> -0.277615).  Saving model ...
Epoch: 15 cost time: 0.6502213478088379
Epoch: 15, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.240 Vali Acc: 0.299 Test Loss: 3.240 Test Acc: 0.299
Validation loss decreased (-0.277615 --> -0.298791).  Saving model ...
Epoch: 16 cost time: 0.7135879993438721
Epoch: 16, Steps: 10 | Train Loss: 0.198 Vali Loss: 3.313 Vali Acc: 0.298 Test Loss: 3.313 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.750847339630127
Epoch: 17, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.363 Vali Acc: 0.293 Test Loss: 3.363 Test Acc: 0.293
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7190337181091309
Epoch: 18, Steps: 10 | Train Loss: 0.130 Vali Loss: 3.387 Vali Acc: 0.301 Test Loss: 3.387 Test Acc: 0.301
Validation loss decreased (-0.298791 --> -0.301143).  Saving model ...
Epoch: 19 cost time: 0.6105787754058838
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.420 Vali Acc: 0.304 Test Loss: 3.420 Test Acc: 0.304
Validation loss decreased (-0.301143 --> -0.303495).  Saving model ...
Epoch: 20 cost time: 0.6251645088195801
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.472 Vali Acc: 0.307 Test Loss: 3.472 Test Acc: 0.307
Validation loss decreased (-0.303495 --> -0.307024).  Saving model ...
Epoch: 21 cost time: 0.6801738739013672
Epoch: 21, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.505 Vali Acc: 0.306 Test Loss: 3.505 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7103135585784912
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.531 Vali Acc: 0.312 Test Loss: 3.531 Test Acc: 0.312
Validation loss decreased (-0.307024 --> -0.311729).  Saving model ...
Epoch: 23 cost time: 0.6934342384338379
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.559 Vali Acc: 0.311 Test Loss: 3.559 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7785139083862305
Epoch: 24, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.574 Vali Acc: 0.311 Test Loss: 3.574 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7678675651550293
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.602 Vali Acc: 0.307 Test Loss: 3.602 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7205758094787598
Epoch: 26, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.642 Vali Acc: 0.312 Test Loss: 3.642 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7141587734222412
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.651 Vali Acc: 0.318 Test Loss: 3.651 Test Acc: 0.318
Validation loss decreased (-0.311729 --> -0.317611).  Saving model ...
Epoch: 28 cost time: 0.7897567749023438
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.657 Vali Acc: 0.315 Test Loss: 3.657 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6656560897827148
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.682 Vali Acc: 0.315 Test Loss: 3.682 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7845253944396973
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.698 Vali Acc: 0.315 Test Loss: 3.698 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7053804397583008
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.707 Vali Acc: 0.313 Test Loss: 3.707 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.6669657230377197
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.737 Vali Acc: 0.312 Test Loss: 3.737 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.728175163269043
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.747 Vali Acc: 0.314 Test Loss: 3.747 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6283793449401855
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.769 Vali Acc: 0.311 Test Loss: 3.769 Test Acc: 0.311
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.7303605079650879
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.790 Vali Acc: 0.312 Test Loss: 3.790 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.7622771263122559
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.806 Vali Acc: 0.314 Test Loss: 3.806 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.672987699508667
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.818 Vali Acc: 0.320 Test Loss: 3.818 Test Acc: 0.320
Validation loss decreased (-0.317611 --> -0.319962).  Saving model ...
Epoch: 38 cost time: 0.7718420028686523
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.829 Vali Acc: 0.324 Test Loss: 3.829 Test Acc: 0.324
Validation loss decreased (-0.319962 --> -0.323491).  Saving model ...
Epoch: 39 cost time: 0.6853265762329102
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.845 Vali Acc: 0.321 Test Loss: 3.845 Test Acc: 0.321
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6804351806640625
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.865 Vali Acc: 0.315 Test Loss: 3.865 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6727380752563477
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.882 Vali Acc: 0.314 Test Loss: 3.882 Test Acc: 0.314
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.6918888092041016
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.894 Vali Acc: 0.318 Test Loss: 3.894 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.6118030548095703
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.911 Vali Acc: 0.315 Test Loss: 3.911 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.596541166305542
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.926 Vali Acc: 0.314 Test Loss: 3.926 Test Acc: 0.314
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7433927059173584
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.933 Vali Acc: 0.312 Test Loss: 3.933 Test Acc: 0.312
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6179866790771484
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.937 Vali Acc: 0.316 Test Loss: 3.937 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6335759162902832
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.950 Vali Acc: 0.312 Test Loss: 3.950 Test Acc: 0.312
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.7261273860931396
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.962 Vali Acc: 0.314 Test Loss: 3.962 Test Acc: 0.314
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 260502
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.204930067062378
Epoch: 1, Steps: 10 | Train Loss: 3.357 Vali Loss: 3.333 Vali Acc: 0.036 Test Loss: 3.333 Test Acc: 0.036
Validation loss decreased (inf --> -0.036437).  Saving model ...
Epoch: 2 cost time: 0.6559455394744873
Epoch: 2, Steps: 10 | Train Loss: 3.197 Vali Loss: 3.288 Vali Acc: 0.056 Test Loss: 3.288 Test Acc: 0.056
Validation loss decreased (-0.036437 --> -0.056438).  Saving model ...
Epoch: 3 cost time: 0.6344780921936035
Epoch: 3, Steps: 10 | Train Loss: 2.962 Vali Loss: 3.273 Vali Acc: 0.085 Test Loss: 3.273 Test Acc: 0.085
Validation loss decreased (-0.056438 --> -0.084673).  Saving model ...
Epoch: 4 cost time: 0.6918716430664062
Epoch: 4, Steps: 10 | Train Loss: 2.669 Vali Loss: 3.246 Vali Acc: 0.107 Test Loss: 3.246 Test Acc: 0.107
Validation loss decreased (-0.084673 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.5527575016021729
Epoch: 5, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.195 Vali Acc: 0.147 Test Loss: 3.195 Test Acc: 0.147
Validation loss decreased (-0.107026 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 0.6224701404571533
Epoch: 6, Steps: 10 | Train Loss: 2.052 Vali Loss: 3.148 Vali Acc: 0.166 Test Loss: 3.148 Test Acc: 0.166
Validation loss decreased (-0.147027 --> -0.165851).  Saving model ...
Epoch: 7 cost time: 0.6240832805633545
Epoch: 7, Steps: 10 | Train Loss: 1.775 Vali Loss: 3.100 Vali Acc: 0.185 Test Loss: 3.100 Test Acc: 0.185
Validation loss decreased (-0.165851 --> -0.184675).  Saving model ...
Epoch: 8 cost time: 0.6188807487487793
Epoch: 8, Steps: 10 | Train Loss: 1.524 Vali Loss: 3.069 Vali Acc: 0.214 Test Loss: 3.069 Test Acc: 0.214
Validation loss decreased (-0.184675 --> -0.214087).  Saving model ...
Epoch: 9 cost time: 0.6315066814422607
Epoch: 9, Steps: 10 | Train Loss: 1.353 Vali Loss: 3.077 Vali Acc: 0.226 Test Loss: 3.077 Test Acc: 0.226
Validation loss decreased (-0.214087 --> -0.225852).  Saving model ...
Epoch: 10 cost time: 0.5829455852508545
Epoch: 10, Steps: 10 | Train Loss: 1.038 Vali Loss: 3.087 Vali Acc: 0.216 Test Loss: 3.087 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6000072956085205
Epoch: 11, Steps: 10 | Train Loss: 0.857 Vali Loss: 3.089 Vali Acc: 0.242 Test Loss: 3.089 Test Acc: 0.242
Validation loss decreased (-0.225852 --> -0.242322).  Saving model ...
Epoch: 12 cost time: 0.6330952644348145
Epoch: 12, Steps: 10 | Train Loss: 0.662 Vali Loss: 3.107 Vali Acc: 0.260 Test Loss: 3.107 Test Acc: 0.260
Validation loss decreased (-0.242322 --> -0.259969).  Saving model ...
Epoch: 13 cost time: 0.7705461978912354
Epoch: 13, Steps: 10 | Train Loss: 0.515 Vali Loss: 3.140 Vali Acc: 0.272 Test Loss: 3.140 Test Acc: 0.272
Validation loss decreased (-0.259969 --> -0.271733).  Saving model ...
Epoch: 14 cost time: 0.7146453857421875
Epoch: 14, Steps: 10 | Train Loss: 0.360 Vali Loss: 3.155 Vali Acc: 0.282 Test Loss: 3.155 Test Acc: 0.282
Validation loss decreased (-0.271733 --> -0.282321).  Saving model ...
Epoch: 15 cost time: 0.7386808395385742
Epoch: 15, Steps: 10 | Train Loss: 0.273 Vali Loss: 3.195 Vali Acc: 0.291 Test Loss: 3.195 Test Acc: 0.291
Validation loss decreased (-0.282321 --> -0.290556).  Saving model ...
Epoch: 16 cost time: 0.73726487159729
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.272 Vali Acc: 0.291 Test Loss: 3.272 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7390820980072021
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.307 Vali Acc: 0.301 Test Loss: 3.307 Test Acc: 0.301
Validation loss decreased (-0.290556 --> -0.301143).  Saving model ...
Epoch: 18 cost time: 0.7312846183776855
Epoch: 18, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.331 Vali Acc: 0.304 Test Loss: 3.331 Test Acc: 0.304
Validation loss decreased (-0.301143 --> -0.303496).  Saving model ...
Epoch: 19 cost time: 0.6626548767089844
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.353 Vali Acc: 0.309 Test Loss: 3.353 Test Acc: 0.309
Validation loss decreased (-0.303496 --> -0.309378).  Saving model ...
Epoch: 20 cost time: 0.6625375747680664
Epoch: 20, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.388 Vali Acc: 0.305 Test Loss: 3.388 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6971895694732666
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.413 Vali Acc: 0.304 Test Loss: 3.413 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7804226875305176
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.436 Vali Acc: 0.302 Test Loss: 3.436 Test Acc: 0.302
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8161330223083496
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.459 Vali Acc: 0.306 Test Loss: 3.459 Test Acc: 0.306
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7864165306091309
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.484 Vali Acc: 0.308 Test Loss: 3.484 Test Acc: 0.308
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6839427947998047
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.524 Vali Acc: 0.302 Test Loss: 3.524 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6910738945007324
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.565 Vali Acc: 0.307 Test Loss: 3.565 Test Acc: 0.307
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6802449226379395
Epoch: 27, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.575 Vali Acc: 0.304 Test Loss: 3.575 Test Acc: 0.304
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6402766704559326
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.576 Vali Acc: 0.312 Test Loss: 3.576 Test Acc: 0.312
Validation loss decreased (-0.309378 --> -0.311729).  Saving model ...
Epoch: 29 cost time: 0.7472882270812988
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.590 Vali Acc: 0.312 Test Loss: 3.590 Test Acc: 0.312
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7581796646118164
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.600 Vali Acc: 0.307 Test Loss: 3.600 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6953115463256836
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.613 Vali Acc: 0.313 Test Loss: 3.613 Test Acc: 0.313
Validation loss decreased (-0.311729 --> -0.312905).  Saving model ...
Epoch: 32 cost time: 0.7550148963928223
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.639 Vali Acc: 0.314 Test Loss: 3.639 Test Acc: 0.314
Validation loss decreased (-0.312905 --> -0.314081).  Saving model ...
Epoch: 33 cost time: 0.7878842353820801
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.646 Vali Acc: 0.319 Test Loss: 3.646 Test Acc: 0.319
Validation loss decreased (-0.314081 --> -0.318787).  Saving model ...
Epoch: 34 cost time: 0.7350900173187256
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.681 Vali Acc: 0.321 Test Loss: 3.681 Test Acc: 0.321
Validation loss decreased (-0.318787 --> -0.321140).  Saving model ...
Epoch: 35 cost time: 0.7549381256103516
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.702 Vali Acc: 0.318 Test Loss: 3.702 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.749183177947998
Epoch: 36, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.714 Vali Acc: 0.315 Test Loss: 3.714 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7830827236175537
Epoch: 37, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.719 Vali Acc: 0.321 Test Loss: 3.719 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8024401664733887
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.729 Vali Acc: 0.320 Test Loss: 3.729 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.767146110534668
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.740 Vali Acc: 0.316 Test Loss: 3.740 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7548501491546631
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.762 Vali Acc: 0.318 Test Loss: 3.762 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7733805179595947
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.782 Vali Acc: 0.315 Test Loss: 3.782 Test Acc: 0.315
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7484633922576904
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.795 Vali Acc: 0.314 Test Loss: 3.795 Test Acc: 0.314
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7192330360412598
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.807 Vali Acc: 0.314 Test Loss: 3.807 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.793630838394165
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.811 Vali Acc: 0.316 Test Loss: 3.811 Test Acc: 0.316
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3211764705882353
model parameter : 260502
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4189870357513428
Epoch: 1, Steps: 10 | Train Loss: 3.343 Vali Loss: 3.317 Vali Acc: 0.035 Test Loss: 3.317 Test Acc: 0.035
Validation loss decreased (inf --> -0.035261).  Saving model ...
Epoch: 2 cost time: 0.7815256118774414
Epoch: 2, Steps: 10 | Train Loss: 3.210 Vali Loss: 3.279 Vali Acc: 0.054 Test Loss: 3.279 Test Acc: 0.054
Validation loss decreased (-0.035261 --> -0.054085).  Saving model ...
Epoch: 3 cost time: 0.7426273822784424
Epoch: 3, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.264 Vali Acc: 0.071 Test Loss: 3.264 Test Acc: 0.071
Validation loss decreased (-0.054085 --> -0.070556).  Saving model ...
Epoch: 4 cost time: 0.6814215183258057
Epoch: 4, Steps: 10 | Train Loss: 2.719 Vali Loss: 3.246 Vali Acc: 0.094 Test Loss: 3.246 Test Acc: 0.094
Validation loss decreased (-0.070556 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.6590721607208252
Epoch: 5, Steps: 10 | Train Loss: 2.489 Vali Loss: 3.203 Vali Acc: 0.126 Test Loss: 3.203 Test Acc: 0.126
Validation loss decreased (-0.094085 --> -0.125850).  Saving model ...
Epoch: 6 cost time: 0.5827414989471436
Epoch: 6, Steps: 10 | Train Loss: 2.183 Vali Loss: 3.159 Vali Acc: 0.149 Test Loss: 3.159 Test Acc: 0.149
Validation loss decreased (-0.125850 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 0.6459009647369385
Epoch: 7, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.112 Vali Acc: 0.160 Test Loss: 3.112 Test Acc: 0.160
Validation loss decreased (-0.149380 --> -0.159969).  Saving model ...
Epoch: 8 cost time: 0.6670975685119629
Epoch: 8, Steps: 10 | Train Loss: 1.688 Vali Loss: 3.074 Vali Acc: 0.193 Test Loss: 3.074 Test Acc: 0.193
Validation loss decreased (-0.159969 --> -0.192910).  Saving model ...
Epoch: 9 cost time: 0.737529993057251
Epoch: 9, Steps: 10 | Train Loss: 1.491 Vali Loss: 3.072 Vali Acc: 0.202 Test Loss: 3.072 Test Acc: 0.202
Validation loss decreased (-0.192910 --> -0.202322).  Saving model ...
Epoch: 10 cost time: 0.6980249881744385
Epoch: 10, Steps: 10 | Train Loss: 1.175 Vali Loss: 3.070 Vali Acc: 0.220 Test Loss: 3.070 Test Acc: 0.220
Validation loss decreased (-0.202322 --> -0.219969).  Saving model ...
Epoch: 11 cost time: 0.7582616806030273
Epoch: 11, Steps: 10 | Train Loss: 1.011 Vali Loss: 3.067 Vali Acc: 0.234 Test Loss: 3.067 Test Acc: 0.234
Validation loss decreased (-0.219969 --> -0.234087).  Saving model ...
Epoch: 12 cost time: 0.7313504219055176
Epoch: 12, Steps: 10 | Train Loss: 0.796 Vali Loss: 3.073 Vali Acc: 0.249 Test Loss: 3.073 Test Acc: 0.249
Validation loss decreased (-0.234087 --> -0.249381).  Saving model ...
Epoch: 13 cost time: 0.6860213279724121
Epoch: 13, Steps: 10 | Train Loss: 0.618 Vali Loss: 3.096 Vali Acc: 0.259 Test Loss: 3.096 Test Acc: 0.259
Validation loss decreased (-0.249381 --> -0.258793).  Saving model ...
Epoch: 14 cost time: 0.6820638179779053
Epoch: 14, Steps: 10 | Train Loss: 0.454 Vali Loss: 3.109 Vali Acc: 0.258 Test Loss: 3.109 Test Acc: 0.258
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6534624099731445
Epoch: 15, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.138 Vali Acc: 0.276 Test Loss: 3.138 Test Acc: 0.276
Validation loss decreased (-0.258793 --> -0.276439).  Saving model ...
Epoch: 16 cost time: 0.623145580291748
Epoch: 16, Steps: 10 | Train Loss: 0.263 Vali Loss: 3.194 Vali Acc: 0.291 Test Loss: 3.194 Test Acc: 0.291
Validation loss decreased (-0.276439 --> -0.290556).  Saving model ...
Epoch: 17 cost time: 0.6366500854492188
Epoch: 17, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.227 Vali Acc: 0.287 Test Loss: 3.227 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6514558792114258
Epoch: 18, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.255 Vali Acc: 0.289 Test Loss: 3.255 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6225483417510986
Epoch: 19, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.293 Vali Acc: 0.296 Test Loss: 3.293 Test Acc: 0.296
Validation loss decreased (-0.290556 --> -0.296438).  Saving model ...
Epoch: 20 cost time: 0.6268496513366699
Epoch: 20, Steps: 10 | Train Loss: 0.088 Vali Loss: 3.319 Vali Acc: 0.294 Test Loss: 3.319 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7020461559295654
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.338 Vali Acc: 0.288 Test Loss: 3.338 Test Acc: 0.288
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6257317066192627
Epoch: 22, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.363 Vali Acc: 0.293 Test Loss: 3.363 Test Acc: 0.293
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6993012428283691
Epoch: 23, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.389 Vali Acc: 0.299 Test Loss: 3.389 Test Acc: 0.299
Validation loss decreased (-0.296438 --> -0.298790).  Saving model ...
Epoch: 24 cost time: 0.6845688819885254
Epoch: 24, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.414 Vali Acc: 0.306 Test Loss: 3.414 Test Acc: 0.306
Validation loss decreased (-0.298790 --> -0.305848).  Saving model ...
Epoch: 25 cost time: 0.6835982799530029
Epoch: 25, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.432 Vali Acc: 0.301 Test Loss: 3.432 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7197344303131104
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.475 Vali Acc: 0.306 Test Loss: 3.475 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6481080055236816
Epoch: 27, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.478 Vali Acc: 0.301 Test Loss: 3.478 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6350626945495605
Epoch: 28, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.478 Vali Acc: 0.301 Test Loss: 3.478 Test Acc: 0.301
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6302425861358643
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.491 Vali Acc: 0.300 Test Loss: 3.491 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6458325386047363
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.515 Vali Acc: 0.305 Test Loss: 3.515 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.6200308799743652
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.527 Vali Acc: 0.301 Test Loss: 3.527 Test Acc: 0.301
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.57737135887146
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.551 Vali Acc: 0.299 Test Loss: 3.551 Test Acc: 0.299
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.6451523303985596
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.558 Vali Acc: 0.300 Test Loss: 3.558 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.7179603576660156
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.593 Vali Acc: 0.299 Test Loss: 3.593 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3058823529411765
model parameter : 260502
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.385908365249634
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.296 Vali Acc: 0.029 Test Loss: 3.296 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.6868712902069092
Epoch: 2, Steps: 10 | Train Loss: 3.251 Vali Loss: 3.270 Vali Acc: 0.067 Test Loss: 3.270 Test Acc: 0.067
Validation loss decreased (-0.029379 --> -0.067026).  Saving model ...
Epoch: 3 cost time: 0.5896198749542236
Epoch: 3, Steps: 10 | Train Loss: 3.092 Vali Loss: 3.262 Vali Acc: 0.082 Test Loss: 3.262 Test Acc: 0.082
Validation loss decreased (-0.067026 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 0.5774428844451904
Epoch: 4, Steps: 10 | Train Loss: 2.891 Vali Loss: 3.256 Vali Acc: 0.099 Test Loss: 3.256 Test Acc: 0.099
Validation loss decreased (-0.082320 --> -0.098791).  Saving model ...
Epoch: 5 cost time: 0.661754846572876
Epoch: 5, Steps: 10 | Train Loss: 2.696 Vali Loss: 3.230 Vali Acc: 0.115 Test Loss: 3.230 Test Acc: 0.115
Validation loss decreased (-0.098791 --> -0.115262).  Saving model ...
Epoch: 6 cost time: 0.7020096778869629
Epoch: 6, Steps: 10 | Train Loss: 2.484 Vali Loss: 3.195 Vali Acc: 0.129 Test Loss: 3.195 Test Acc: 0.129
Validation loss decreased (-0.115262 --> -0.129380).  Saving model ...
Epoch: 7 cost time: 0.6421020030975342
Epoch: 7, Steps: 10 | Train Loss: 2.250 Vali Loss: 3.152 Vali Acc: 0.140 Test Loss: 3.152 Test Acc: 0.140
Validation loss decreased (-0.129380 --> -0.139968).  Saving model ...
Epoch: 8 cost time: 0.642512321472168
Epoch: 8, Steps: 10 | Train Loss: 2.040 Vali Loss: 3.111 Vali Acc: 0.161 Test Loss: 3.111 Test Acc: 0.161
Validation loss decreased (-0.139968 --> -0.161145).  Saving model ...
Epoch: 9 cost time: 0.7082610130310059
Epoch: 9, Steps: 10 | Train Loss: 1.869 Vali Loss: 3.094 Vali Acc: 0.193 Test Loss: 3.094 Test Acc: 0.193
Validation loss decreased (-0.161145 --> -0.192910).  Saving model ...
Epoch: 10 cost time: 0.7298107147216797
Epoch: 10, Steps: 10 | Train Loss: 1.589 Vali Loss: 3.083 Vali Acc: 0.192 Test Loss: 3.083 Test Acc: 0.192
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6896131038665771
Epoch: 11, Steps: 10 | Train Loss: 1.366 Vali Loss: 3.067 Vali Acc: 0.195 Test Loss: 3.067 Test Acc: 0.195
Validation loss decreased (-0.192910 --> -0.195263).  Saving model ...
Epoch: 12 cost time: 0.7038497924804688
Epoch: 12, Steps: 10 | Train Loss: 1.170 Vali Loss: 3.061 Vali Acc: 0.214 Test Loss: 3.061 Test Acc: 0.214
Validation loss decreased (-0.195263 --> -0.214087).  Saving model ...
Epoch: 13 cost time: 0.7141783237457275
Epoch: 13, Steps: 10 | Train Loss: 0.954 Vali Loss: 3.071 Vali Acc: 0.224 Test Loss: 3.071 Test Acc: 0.224
Validation loss decreased (-0.214087 --> -0.223499).  Saving model ...
Epoch: 14 cost time: 0.7021574974060059
Epoch: 14, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.074 Vali Acc: 0.231 Test Loss: 3.074 Test Acc: 0.231
Validation loss decreased (-0.223499 --> -0.230557).  Saving model ...
Epoch: 15 cost time: 0.664715051651001
Epoch: 15, Steps: 10 | Train Loss: 0.619 Vali Loss: 3.099 Vali Acc: 0.229 Test Loss: 3.099 Test Acc: 0.229
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6363067626953125
Epoch: 16, Steps: 10 | Train Loss: 0.485 Vali Loss: 3.143 Vali Acc: 0.245 Test Loss: 3.143 Test Acc: 0.245
Validation loss decreased (-0.230557 --> -0.244674).  Saving model ...
Epoch: 17 cost time: 0.6650509834289551
Epoch: 17, Steps: 10 | Train Loss: 0.348 Vali Loss: 3.171 Vali Acc: 0.252 Test Loss: 3.171 Test Acc: 0.252
Validation loss decreased (-0.244674 --> -0.251733).  Saving model ...
Epoch: 18 cost time: 0.6403319835662842
Epoch: 18, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.190 Vali Acc: 0.253 Test Loss: 3.190 Test Acc: 0.253
Validation loss decreased (-0.251733 --> -0.252909).  Saving model ...
Epoch: 19 cost time: 0.6676919460296631
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.223 Vali Acc: 0.256 Test Loss: 3.223 Test Acc: 0.256
Validation loss decreased (-0.252909 --> -0.256438).  Saving model ...
Epoch: 20 cost time: 0.6972565650939941
Epoch: 20, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.271 Vali Acc: 0.255 Test Loss: 3.271 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7326781749725342
Epoch: 21, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.314 Vali Acc: 0.253 Test Loss: 3.314 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7049362659454346
Epoch: 22, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.371 Vali Acc: 0.245 Test Loss: 3.371 Test Acc: 0.245
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6975951194763184
Epoch: 23, Steps: 10 | Train Loss: 0.073 Vali Loss: 3.410 Vali Acc: 0.244 Test Loss: 3.410 Test Acc: 0.244
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7105021476745605
Epoch: 24, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.412 Vali Acc: 0.255 Test Loss: 3.412 Test Acc: 0.255
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6813638210296631
Epoch: 25, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.407 Vali Acc: 0.261 Test Loss: 3.407 Test Acc: 0.261
Validation loss decreased (-0.256438 --> -0.261142).  Saving model ...
Epoch: 26 cost time: 0.8054125308990479
Epoch: 26, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.438 Vali Acc: 0.259 Test Loss: 3.438 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7273879051208496
Epoch: 27, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.472 Vali Acc: 0.259 Test Loss: 3.472 Test Acc: 0.259
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6375205516815186
Epoch: 28, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.498 Vali Acc: 0.260 Test Loss: 3.498 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6329357624053955
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.523 Vali Acc: 0.265 Test Loss: 3.523 Test Acc: 0.265
Validation loss decreased (-0.261142 --> -0.264671).  Saving model ...
Epoch: 30 cost time: 0.6368408203125
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.545 Vali Acc: 0.264 Test Loss: 3.545 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6842176914215088
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.552 Vali Acc: 0.271 Test Loss: 3.552 Test Acc: 0.271
Validation loss decreased (-0.264671 --> -0.270553).  Saving model ...
Epoch: 32 cost time: 0.676715612411499
Epoch: 32, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.576 Vali Acc: 0.268 Test Loss: 3.576 Test Acc: 0.268
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.711467981338501
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.594 Vali Acc: 0.269 Test Loss: 3.594 Test Acc: 0.269
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7525365352630615
Epoch: 34, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.624 Vali Acc: 0.261 Test Loss: 3.624 Test Acc: 0.261
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.6916661262512207
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.643 Vali Acc: 0.260 Test Loss: 3.643 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.748769998550415
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.653 Vali Acc: 0.258 Test Loss: 3.653 Test Acc: 0.258
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7423932552337646
Epoch: 37, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.661 Vali Acc: 0.258 Test Loss: 3.661 Test Acc: 0.258
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.8055741786956787
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.680 Vali Acc: 0.258 Test Loss: 3.680 Test Acc: 0.258
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7199752330780029
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.699 Vali Acc: 0.259 Test Loss: 3.699 Test Acc: 0.259
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.7579386234283447
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.726 Vali Acc: 0.260 Test Loss: 3.726 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7345917224884033
Epoch: 41, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.735 Vali Acc: 0.265 Test Loss: 3.735 Test Acc: 0.265
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27058823529411763
model parameter : 260502
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.4149599075317383
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.361 Vali Acc: 0.039 Test Loss: 3.361 Test Acc: 0.039
Validation loss decreased (inf --> -0.038790).  Saving model ...
Epoch: 2 cost time: 0.6317791938781738
Epoch: 2, Steps: 10 | Train Loss: 3.208 Vali Loss: 3.303 Vali Acc: 0.060 Test Loss: 3.303 Test Acc: 0.060
Validation loss decreased (-0.038790 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.7203335762023926
Epoch: 3, Steps: 10 | Train Loss: 2.925 Vali Loss: 3.267 Vali Acc: 0.082 Test Loss: 3.267 Test Acc: 0.082
Validation loss decreased (-0.059967 --> -0.082320).  Saving model ...
Epoch: 4 cost time: 0.7269449234008789
Epoch: 4, Steps: 10 | Train Loss: 2.592 Vali Loss: 3.225 Vali Acc: 0.114 Test Loss: 3.225 Test Acc: 0.114
Validation loss decreased (-0.082320 --> -0.114085).  Saving model ...
Epoch: 5 cost time: 0.6852130889892578
Epoch: 5, Steps: 10 | Train Loss: 2.327 Vali Loss: 3.193 Vali Acc: 0.148 Test Loss: 3.193 Test Acc: 0.148
Validation loss decreased (-0.114085 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.6645569801330566
Epoch: 6, Steps: 10 | Train Loss: 2.000 Vali Loss: 3.143 Vali Acc: 0.186 Test Loss: 3.143 Test Acc: 0.186
Validation loss decreased (-0.148203 --> -0.185851).  Saving model ...
Epoch: 7 cost time: 0.7194039821624756
Epoch: 7, Steps: 10 | Train Loss: 1.754 Vali Loss: 3.117 Vali Acc: 0.201 Test Loss: 3.117 Test Acc: 0.201
Validation loss decreased (-0.185851 --> -0.201145).  Saving model ...
Epoch: 8 cost time: 0.7269046306610107
Epoch: 8, Steps: 10 | Train Loss: 1.446 Vali Loss: 3.108 Vali Acc: 0.216 Test Loss: 3.108 Test Acc: 0.216
Validation loss decreased (-0.201145 --> -0.216440).  Saving model ...
Epoch: 9 cost time: 0.6736128330230713
Epoch: 9, Steps: 10 | Train Loss: 1.219 Vali Loss: 3.112 Vali Acc: 0.240 Test Loss: 3.112 Test Acc: 0.240
Validation loss decreased (-0.216440 --> -0.239969).  Saving model ...
Epoch: 10 cost time: 0.7062234878540039
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.107 Vali Acc: 0.252 Test Loss: 3.107 Test Acc: 0.252
Validation loss decreased (-0.239969 --> -0.251734).  Saving model ...
Epoch: 11 cost time: 0.6912145614624023
Epoch: 11, Steps: 10 | Train Loss: 0.802 Vali Loss: 3.130 Vali Acc: 0.267 Test Loss: 3.130 Test Acc: 0.267
Validation loss decreased (-0.251734 --> -0.267028).  Saving model ...
Epoch: 12 cost time: 0.5928022861480713
Epoch: 12, Steps: 10 | Train Loss: 0.614 Vali Loss: 3.160 Vali Acc: 0.267 Test Loss: 3.160 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.5886199474334717
Epoch: 13, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.182 Vali Acc: 0.271 Test Loss: 3.182 Test Acc: 0.271
Validation loss decreased (-0.267028 --> -0.270556).  Saving model ...
Epoch: 14 cost time: 0.67708420753479
Epoch: 14, Steps: 10 | Train Loss: 0.366 Vali Loss: 3.252 Vali Acc: 0.289 Test Loss: 3.252 Test Acc: 0.289
Validation loss decreased (-0.270556 --> -0.289379).  Saving model ...
Epoch: 15 cost time: 0.7027342319488525
Epoch: 15, Steps: 10 | Train Loss: 0.261 Vali Loss: 3.274 Vali Acc: 0.288 Test Loss: 3.274 Test Acc: 0.288
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6905243396759033
Epoch: 16, Steps: 10 | Train Loss: 0.183 Vali Loss: 3.320 Vali Acc: 0.293 Test Loss: 3.320 Test Acc: 0.293
Validation loss decreased (-0.289379 --> -0.292908).  Saving model ...
Epoch: 17 cost time: 0.721503734588623
Epoch: 17, Steps: 10 | Train Loss: 0.139 Vali Loss: 3.384 Vali Acc: 0.295 Test Loss: 3.384 Test Acc: 0.295
Validation loss decreased (-0.292908 --> -0.295260).  Saving model ...
Epoch: 18 cost time: 0.8247346878051758
Epoch: 18, Steps: 10 | Train Loss: 0.108 Vali Loss: 3.414 Vali Acc: 0.299 Test Loss: 3.414 Test Acc: 0.299
Validation loss decreased (-0.295260 --> -0.298789).  Saving model ...
Epoch: 19 cost time: 0.6947667598724365
Epoch: 19, Steps: 10 | Train Loss: 0.081 Vali Loss: 3.452 Vali Acc: 0.299 Test Loss: 3.452 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7639627456665039
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.480 Vali Acc: 0.306 Test Loss: 3.480 Test Acc: 0.306
Validation loss decreased (-0.298789 --> -0.305848).  Saving model ...
Epoch: 21 cost time: 0.6677498817443848
Epoch: 21, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.511 Vali Acc: 0.304 Test Loss: 3.511 Test Acc: 0.304
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6643335819244385
Epoch: 22, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.550 Vali Acc: 0.308 Test Loss: 3.550 Test Acc: 0.308
Validation loss decreased (-0.305848 --> -0.308200).  Saving model ...
Epoch: 23 cost time: 0.7189309597015381
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.591 Vali Acc: 0.308 Test Loss: 3.591 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7160687446594238
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.616 Vali Acc: 0.304 Test Loss: 3.616 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7723970413208008
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.633 Vali Acc: 0.307 Test Loss: 3.633 Test Acc: 0.307
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8021085262298584
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.640 Vali Acc: 0.309 Test Loss: 3.640 Test Acc: 0.309
Validation loss decreased (-0.308200 --> -0.309375).  Saving model ...
Epoch: 27 cost time: 0.7085223197937012
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.663 Vali Acc: 0.312 Test Loss: 3.663 Test Acc: 0.312
Validation loss decreased (-0.309375 --> -0.311728).  Saving model ...
Epoch: 28 cost time: 0.7725441455841064
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.708 Vali Acc: 0.308 Test Loss: 3.708 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7424118518829346
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.730 Vali Acc: 0.308 Test Loss: 3.730 Test Acc: 0.308
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7175519466400146
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.732 Vali Acc: 0.309 Test Loss: 3.732 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8036184310913086
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.742 Vali Acc: 0.311 Test Loss: 3.742 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7439684867858887
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.761 Vali Acc: 0.309 Test Loss: 3.761 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.7245771884918213
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.785 Vali Acc: 0.306 Test Loss: 3.785 Test Acc: 0.306
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.6892778873443604
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.793 Vali Acc: 0.306 Test Loss: 3.793 Test Acc: 0.306
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.6753430366516113
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.809 Vali Acc: 0.311 Test Loss: 3.809 Test Acc: 0.311
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.6938631534576416
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.822 Vali Acc: 0.309 Test Loss: 3.822 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.6726949214935303
Epoch: 37, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.834 Vali Acc: 0.313 Test Loss: 3.834 Test Acc: 0.313
Validation loss decreased (-0.311728 --> -0.312903).  Saving model ...
Epoch: 38 cost time: 0.6708619594573975
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.850 Vali Acc: 0.316 Test Loss: 3.850 Test Acc: 0.316
Validation loss decreased (-0.312903 --> -0.316432).  Saving model ...
Epoch: 39 cost time: 0.7020483016967773
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.860 Vali Acc: 0.315 Test Loss: 3.860 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.6965258121490479
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.880 Vali Acc: 0.315 Test Loss: 3.880 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7191808223724365
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.892 Vali Acc: 0.316 Test Loss: 3.892 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7248914241790771
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.898 Vali Acc: 0.311 Test Loss: 3.898 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7259635925292969
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.911 Vali Acc: 0.307 Test Loss: 3.911 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.7253954410552979
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.927 Vali Acc: 0.305 Test Loss: 3.927 Test Acc: 0.305
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.7430400848388672
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.939 Vali Acc: 0.309 Test Loss: 3.939 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.7415568828582764
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.948 Vali Acc: 0.312 Test Loss: 3.948 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.6084885597229004
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.959 Vali Acc: 0.315 Test Loss: 3.959 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6344432830810547
Epoch: 48, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.980 Vali Acc: 0.319 Test Loss: 3.980 Test Acc: 0.319
Validation loss decreased (-0.316432 --> -0.318784).  Saving model ...
Epoch: 49 cost time: 0.5427792072296143
Epoch: 49, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.993 Vali Acc: 0.316 Test Loss: 3.993 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.6061465740203857
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 3.995 Vali Acc: 0.316 Test Loss: 3.995 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.681143045425415
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.008 Vali Acc: 0.318 Test Loss: 4.008 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.8497927188873291
Epoch: 52, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.022 Vali Acc: 0.316 Test Loss: 4.022 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.7944095134735107
Epoch: 53, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.030 Vali Acc: 0.315 Test Loss: 4.030 Test Acc: 0.315
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.8690159320831299
Epoch: 54, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.048 Vali Acc: 0.315 Test Loss: 4.048 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.8364813327789307
Epoch: 55, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.059 Vali Acc: 0.314 Test Loss: 4.059 Test Acc: 0.314
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.7662701606750488
Epoch: 56, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.070 Vali Acc: 0.316 Test Loss: 4.070 Test Acc: 0.316
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.8234462738037109
Epoch: 57, Steps: 10 | Train Loss: 0.004 Vali Loss: 4.074 Vali Acc: 0.319 Test Loss: 4.074 Test Acc: 0.319
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.8340916633605957
Epoch: 58, Steps: 10 | Train Loss: 0.003 Vali Loss: 4.080 Vali Acc: 0.318 Test Loss: 4.080 Test Acc: 0.318
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31882352941176473
model parameter : 194966
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.432455539703369
Epoch: 1, Steps: 10 | Train Loss: 3.347 Vali Loss: 3.362 Vali Acc: 0.029 Test Loss: 3.362 Test Acc: 0.029
Validation loss decreased (inf --> -0.029378).  Saving model ...
Epoch: 2 cost time: 0.6827678680419922
Epoch: 2, Steps: 10 | Train Loss: 3.189 Vali Loss: 3.310 Vali Acc: 0.044 Test Loss: 3.310 Test Acc: 0.044
Validation loss decreased (-0.029378 --> -0.043496).  Saving model ...
Epoch: 3 cost time: 0.7266623973846436
Epoch: 3, Steps: 10 | Train Loss: 2.944 Vali Loss: 3.277 Vali Acc: 0.086 Test Loss: 3.277 Test Acc: 0.086
Validation loss decreased (-0.043496 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.782038688659668
Epoch: 4, Steps: 10 | Train Loss: 2.645 Vali Loss: 3.237 Vali Acc: 0.107 Test Loss: 3.237 Test Acc: 0.107
Validation loss decreased (-0.085850 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.7688271999359131
Epoch: 5, Steps: 10 | Train Loss: 2.380 Vali Loss: 3.205 Vali Acc: 0.127 Test Loss: 3.205 Test Acc: 0.127
Validation loss decreased (-0.107026 --> -0.127027).  Saving model ...
Epoch: 6 cost time: 0.7612824440002441
Epoch: 6, Steps: 10 | Train Loss: 2.082 Vali Loss: 3.154 Vali Acc: 0.149 Test Loss: 3.154 Test Acc: 0.149
Validation loss decreased (-0.127027 --> -0.149380).  Saving model ...
Epoch: 7 cost time: 0.7440776824951172
Epoch: 7, Steps: 10 | Train Loss: 1.808 Vali Loss: 3.121 Vali Acc: 0.185 Test Loss: 3.121 Test Acc: 0.185
Validation loss decreased (-0.149380 --> -0.184675).  Saving model ...
Epoch: 8 cost time: 0.6699850559234619
Epoch: 8, Steps: 10 | Train Loss: 1.539 Vali Loss: 3.102 Vali Acc: 0.207 Test Loss: 3.102 Test Acc: 0.207
Validation loss decreased (-0.184675 --> -0.207028).  Saving model ...
Epoch: 9 cost time: 0.7288846969604492
Epoch: 9, Steps: 10 | Train Loss: 1.290 Vali Loss: 3.096 Vali Acc: 0.213 Test Loss: 3.096 Test Acc: 0.213
Validation loss decreased (-0.207028 --> -0.212910).  Saving model ...
Epoch: 10 cost time: 0.7160046100616455
Epoch: 10, Steps: 10 | Train Loss: 1.052 Vali Loss: 3.091 Vali Acc: 0.228 Test Loss: 3.091 Test Acc: 0.228
Validation loss decreased (-0.212910 --> -0.228204).  Saving model ...
Epoch: 11 cost time: 0.6638002395629883
Epoch: 11, Steps: 10 | Train Loss: 0.872 Vali Loss: 3.106 Vali Acc: 0.245 Test Loss: 3.106 Test Acc: 0.245
Validation loss decreased (-0.228204 --> -0.244675).  Saving model ...
Epoch: 12 cost time: 0.7458832263946533
Epoch: 12, Steps: 10 | Train Loss: 0.661 Vali Loss: 3.132 Vali Acc: 0.254 Test Loss: 3.132 Test Acc: 0.254
Validation loss decreased (-0.244675 --> -0.254086).  Saving model ...
Epoch: 13 cost time: 0.7369489669799805
Epoch: 13, Steps: 10 | Train Loss: 0.506 Vali Loss: 3.144 Vali Acc: 0.268 Test Loss: 3.144 Test Acc: 0.268
Validation loss decreased (-0.254086 --> -0.268204).  Saving model ...
Epoch: 14 cost time: 0.6582889556884766
Epoch: 14, Steps: 10 | Train Loss: 0.397 Vali Loss: 3.211 Vali Acc: 0.271 Test Loss: 3.211 Test Acc: 0.271
Validation loss decreased (-0.268204 --> -0.270556).  Saving model ...
Epoch: 15 cost time: 0.7482843399047852
Epoch: 15, Steps: 10 | Train Loss: 0.280 Vali Loss: 3.239 Vali Acc: 0.276 Test Loss: 3.239 Test Acc: 0.276
Validation loss decreased (-0.270556 --> -0.276438).  Saving model ...
Epoch: 16 cost time: 0.7156620025634766
Epoch: 16, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.277 Vali Acc: 0.285 Test Loss: 3.277 Test Acc: 0.285
Validation loss decreased (-0.276438 --> -0.284673).  Saving model ...
Epoch: 17 cost time: 0.6789107322692871
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.342 Vali Acc: 0.280 Test Loss: 3.342 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7007870674133301
Epoch: 18, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.361 Vali Acc: 0.288 Test Loss: 3.361 Test Acc: 0.288
Validation loss decreased (-0.284673 --> -0.288202).  Saving model ...
Epoch: 19 cost time: 0.683495283126831
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.379 Vali Acc: 0.294 Test Loss: 3.379 Test Acc: 0.294
Validation loss decreased (-0.288202 --> -0.294084).  Saving model ...
Epoch: 20 cost time: 0.6965420246124268
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.404 Vali Acc: 0.294 Test Loss: 3.404 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7847330570220947
Epoch: 21, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.437 Vali Acc: 0.289 Test Loss: 3.437 Test Acc: 0.289
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.7078156471252441
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.473 Vali Acc: 0.292 Test Loss: 3.473 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6622762680053711
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.521 Vali Acc: 0.292 Test Loss: 3.521 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6580767631530762
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.541 Vali Acc: 0.294 Test Loss: 3.541 Test Acc: 0.294
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7283706665039062
Epoch: 25, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.553 Vali Acc: 0.306 Test Loss: 3.553 Test Acc: 0.306
Validation loss decreased (-0.294084 --> -0.305847).  Saving model ...
Epoch: 26 cost time: 0.7077462673187256
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.558 Vali Acc: 0.301 Test Loss: 3.558 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.7135224342346191
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.575 Vali Acc: 0.305 Test Loss: 3.575 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6834840774536133
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.615 Vali Acc: 0.301 Test Loss: 3.615 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7711682319641113
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.638 Vali Acc: 0.309 Test Loss: 3.638 Test Acc: 0.309
Validation loss decreased (-0.305847 --> -0.309375).  Saving model ...
Epoch: 30 cost time: 0.6631402969360352
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.648 Vali Acc: 0.314 Test Loss: 3.648 Test Acc: 0.314
Validation loss decreased (-0.309375 --> -0.314081).  Saving model ...
Epoch: 31 cost time: 0.8443965911865234
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.655 Vali Acc: 0.311 Test Loss: 3.655 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7713747024536133
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.668 Vali Acc: 0.306 Test Loss: 3.668 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8091740608215332
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.685 Vali Acc: 0.304 Test Loss: 3.685 Test Acc: 0.304
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6903512477874756
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.691 Vali Acc: 0.305 Test Loss: 3.691 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7155418395996094
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.704 Vali Acc: 0.307 Test Loss: 3.704 Test Acc: 0.307
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7438013553619385
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.717 Vali Acc: 0.302 Test Loss: 3.717 Test Acc: 0.302
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.6702189445495605
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.728 Vali Acc: 0.300 Test Loss: 3.728 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7469146251678467
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.740 Vali Acc: 0.300 Test Loss: 3.740 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7593717575073242
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.753 Vali Acc: 0.302 Test Loss: 3.753 Test Acc: 0.302
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7177939414978027
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.772 Vali Acc: 0.302 Test Loss: 3.772 Test Acc: 0.302
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31411764705882356
model parameter : 194966
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.377894878387451
Epoch: 1, Steps: 10 | Train Loss: 3.348 Vali Loss: 3.349 Vali Acc: 0.034 Test Loss: 3.349 Test Acc: 0.034
Validation loss decreased (inf --> -0.034084).  Saving model ...
Epoch: 2 cost time: 0.6709592342376709
Epoch: 2, Steps: 10 | Train Loss: 3.222 Vali Loss: 3.309 Vali Acc: 0.039 Test Loss: 3.309 Test Acc: 0.039
Validation loss decreased (-0.034084 --> -0.038790).  Saving model ...
Epoch: 3 cost time: 0.6227407455444336
Epoch: 3, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.283 Vali Acc: 0.075 Test Loss: 3.283 Test Acc: 0.075
Validation loss decreased (-0.038790 --> -0.075261).  Saving model ...
Epoch: 4 cost time: 0.6683790683746338
Epoch: 4, Steps: 10 | Train Loss: 2.726 Vali Loss: 3.248 Vali Acc: 0.105 Test Loss: 3.248 Test Acc: 0.105
Validation loss decreased (-0.075261 --> -0.104673).  Saving model ...
Epoch: 5 cost time: 0.6578061580657959
Epoch: 5, Steps: 10 | Train Loss: 2.480 Vali Loss: 3.219 Vali Acc: 0.128 Test Loss: 3.219 Test Acc: 0.128
Validation loss decreased (-0.104673 --> -0.128203).  Saving model ...
Epoch: 6 cost time: 0.6380374431610107
Epoch: 6, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.170 Vali Acc: 0.152 Test Loss: 3.170 Test Acc: 0.152
Validation loss decreased (-0.128203 --> -0.151733).  Saving model ...
Epoch: 7 cost time: 0.7038979530334473
Epoch: 7, Steps: 10 | Train Loss: 1.954 Vali Loss: 3.134 Vali Acc: 0.168 Test Loss: 3.134 Test Acc: 0.168
Validation loss decreased (-0.151733 --> -0.168204).  Saving model ...
Epoch: 8 cost time: 0.6909162998199463
Epoch: 8, Steps: 10 | Train Loss: 1.668 Vali Loss: 3.108 Vali Acc: 0.200 Test Loss: 3.108 Test Acc: 0.200
Validation loss decreased (-0.168204 --> -0.199969).  Saving model ...
Epoch: 9 cost time: 0.7507984638214111
Epoch: 9, Steps: 10 | Train Loss: 1.432 Vali Loss: 3.094 Vali Acc: 0.207 Test Loss: 3.094 Test Acc: 0.207
Validation loss decreased (-0.199969 --> -0.207028).  Saving model ...
Epoch: 10 cost time: 0.6405506134033203
Epoch: 10, Steps: 10 | Train Loss: 1.191 Vali Loss: 3.080 Vali Acc: 0.220 Test Loss: 3.080 Test Acc: 0.220
Validation loss decreased (-0.207028 --> -0.219969).  Saving model ...
Epoch: 11 cost time: 0.6804683208465576
Epoch: 11, Steps: 10 | Train Loss: 0.993 Vali Loss: 3.083 Vali Acc: 0.232 Test Loss: 3.083 Test Acc: 0.232
Validation loss decreased (-0.219969 --> -0.231734).  Saving model ...
Epoch: 12 cost time: 0.8022563457489014
Epoch: 12, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.092 Vali Acc: 0.247 Test Loss: 3.092 Test Acc: 0.247
Validation loss decreased (-0.231734 --> -0.247028).  Saving model ...
Epoch: 13 cost time: 0.7289636135101318
Epoch: 13, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.111 Vali Acc: 0.258 Test Loss: 3.111 Test Acc: 0.258
Validation loss decreased (-0.247028 --> -0.257616).  Saving model ...
Epoch: 14 cost time: 0.725060224533081
Epoch: 14, Steps: 10 | Train Loss: 0.491 Vali Loss: 3.166 Vali Acc: 0.265 Test Loss: 3.166 Test Acc: 0.265
Validation loss decreased (-0.257616 --> -0.264674).  Saving model ...
Epoch: 15 cost time: 0.6749744415283203
Epoch: 15, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.174 Vali Acc: 0.269 Test Loss: 3.174 Test Acc: 0.269
Validation loss decreased (-0.264674 --> -0.269380).  Saving model ...
Epoch: 16 cost time: 0.6501092910766602
Epoch: 16, Steps: 10 | Train Loss: 0.247 Vali Loss: 3.205 Vali Acc: 0.273 Test Loss: 3.205 Test Acc: 0.273
Validation loss decreased (-0.269380 --> -0.272909).  Saving model ...
Epoch: 17 cost time: 0.6989808082580566
Epoch: 17, Steps: 10 | Train Loss: 0.191 Vali Loss: 3.268 Vali Acc: 0.282 Test Loss: 3.268 Test Acc: 0.282
Validation loss decreased (-0.272909 --> -0.282320).  Saving model ...
Epoch: 18 cost time: 0.691007137298584
Epoch: 18, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.289 Vali Acc: 0.288 Test Loss: 3.289 Test Acc: 0.288
Validation loss decreased (-0.282320 --> -0.288202).  Saving model ...
Epoch: 19 cost time: 0.7973277568817139
Epoch: 19, Steps: 10 | Train Loss: 0.106 Vali Loss: 3.308 Vali Acc: 0.284 Test Loss: 3.308 Test Acc: 0.284
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8277146816253662
Epoch: 20, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.336 Vali Acc: 0.295 Test Loss: 3.336 Test Acc: 0.295
Validation loss decreased (-0.288202 --> -0.295261).  Saving model ...
Epoch: 21 cost time: 0.742511510848999
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.365 Vali Acc: 0.289 Test Loss: 3.365 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7309074401855469
Epoch: 22, Steps: 10 | Train Loss: 0.062 Vali Loss: 3.404 Vali Acc: 0.287 Test Loss: 3.404 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7647550106048584
Epoch: 23, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.447 Vali Acc: 0.286 Test Loss: 3.447 Test Acc: 0.286
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6756381988525391
Epoch: 24, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.471 Vali Acc: 0.296 Test Loss: 3.471 Test Acc: 0.296
Validation loss decreased (-0.295261 --> -0.296436).  Saving model ...
Epoch: 25 cost time: 0.7889547348022461
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.482 Vali Acc: 0.294 Test Loss: 3.482 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6966984272003174
Epoch: 26, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.487 Vali Acc: 0.298 Test Loss: 3.487 Test Acc: 0.298
Validation loss decreased (-0.296436 --> -0.297612).  Saving model ...
Epoch: 27 cost time: 0.5947484970092773
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.502 Vali Acc: 0.293 Test Loss: 3.502 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6243209838867188
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.542 Vali Acc: 0.287 Test Loss: 3.542 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7155783176422119
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.554 Vali Acc: 0.285 Test Loss: 3.554 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.707352876663208
Epoch: 30, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.574 Vali Acc: 0.291 Test Loss: 3.574 Test Acc: 0.291
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6828153133392334
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.568 Vali Acc: 0.291 Test Loss: 3.568 Test Acc: 0.291
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7498795986175537
Epoch: 32, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.586 Vali Acc: 0.295 Test Loss: 3.586 Test Acc: 0.295
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6201324462890625
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.611 Vali Acc: 0.295 Test Loss: 3.611 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7450053691864014
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.617 Vali Acc: 0.296 Test Loss: 3.617 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6838757991790771
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.633 Vali Acc: 0.295 Test Loss: 3.633 Test Acc: 0.295
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6973991394042969
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.647 Vali Acc: 0.293 Test Loss: 3.647 Test Acc: 0.293
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 194966
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.187577962875366
Epoch: 1, Steps: 10 | Train Loss: 3.308 Vali Loss: 3.315 Vali Acc: 0.029 Test Loss: 3.315 Test Acc: 0.029
Validation loss decreased (inf --> -0.029379).  Saving model ...
Epoch: 2 cost time: 0.6348309516906738
Epoch: 2, Steps: 10 | Train Loss: 3.196 Vali Loss: 3.290 Vali Acc: 0.044 Test Loss: 3.290 Test Acc: 0.044
Validation loss decreased (-0.029379 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.5554816722869873
Epoch: 3, Steps: 10 | Train Loss: 3.077 Vali Loss: 3.275 Vali Acc: 0.060 Test Loss: 3.275 Test Acc: 0.060
Validation loss decreased (-0.043497 --> -0.059967).  Saving model ...
Epoch: 4 cost time: 0.7351884841918945
Epoch: 4, Steps: 10 | Train Loss: 2.829 Vali Loss: 3.253 Vali Acc: 0.096 Test Loss: 3.253 Test Acc: 0.096
Validation loss decreased (-0.059967 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 0.6999194622039795
Epoch: 5, Steps: 10 | Train Loss: 2.675 Vali Loss: 3.235 Vali Acc: 0.107 Test Loss: 3.235 Test Acc: 0.107
Validation loss decreased (-0.096438 --> -0.107026).  Saving model ...
Epoch: 6 cost time: 0.720165491104126
Epoch: 6, Steps: 10 | Train Loss: 2.430 Vali Loss: 3.198 Vali Acc: 0.134 Test Loss: 3.198 Test Acc: 0.134
Validation loss decreased (-0.107026 --> -0.134086).  Saving model ...
Epoch: 7 cost time: 0.6815764904022217
Epoch: 7, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.162 Vali Acc: 0.149 Test Loss: 3.162 Test Acc: 0.149
Validation loss decreased (-0.134086 --> -0.149380).  Saving model ...
Epoch: 8 cost time: 0.6988916397094727
Epoch: 8, Steps: 10 | Train Loss: 2.014 Vali Loss: 3.130 Vali Acc: 0.165 Test Loss: 3.130 Test Acc: 0.165
Validation loss decreased (-0.149380 --> -0.164675).  Saving model ...
Epoch: 9 cost time: 0.681891918182373
Epoch: 9, Steps: 10 | Train Loss: 1.784 Vali Loss: 3.107 Vali Acc: 0.196 Test Loss: 3.107 Test Acc: 0.196
Validation loss decreased (-0.164675 --> -0.196440).  Saving model ...
Epoch: 10 cost time: 0.7064476013183594
Epoch: 10, Steps: 10 | Train Loss: 1.557 Vali Loss: 3.084 Vali Acc: 0.200 Test Loss: 3.084 Test Acc: 0.200
Validation loss decreased (-0.196440 --> -0.199969).  Saving model ...
Epoch: 11 cost time: 0.7036938667297363
Epoch: 11, Steps: 10 | Train Loss: 1.358 Vali Loss: 3.074 Vali Acc: 0.211 Test Loss: 3.074 Test Acc: 0.211
Validation loss decreased (-0.199969 --> -0.210557).  Saving model ...
Epoch: 12 cost time: 0.640131950378418
Epoch: 12, Steps: 10 | Train Loss: 1.133 Vali Loss: 3.072 Vali Acc: 0.225 Test Loss: 3.072 Test Acc: 0.225
Validation loss decreased (-0.210557 --> -0.224675).  Saving model ...
Epoch: 13 cost time: 0.7217507362365723
Epoch: 13, Steps: 10 | Train Loss: 0.935 Vali Loss: 3.079 Vali Acc: 0.216 Test Loss: 3.079 Test Acc: 0.216
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7600488662719727
Epoch: 14, Steps: 10 | Train Loss: 0.788 Vali Loss: 3.115 Vali Acc: 0.226 Test Loss: 3.115 Test Acc: 0.226
Validation loss decreased (-0.224675 --> -0.225851).  Saving model ...
Epoch: 15 cost time: 0.6293377876281738
Epoch: 15, Steps: 10 | Train Loss: 0.589 Vali Loss: 3.122 Vali Acc: 0.248 Test Loss: 3.122 Test Acc: 0.248
Validation loss decreased (-0.225851 --> -0.248204).  Saving model ...
Epoch: 16 cost time: 0.7053401470184326
Epoch: 16, Steps: 10 | Train Loss: 0.440 Vali Loss: 3.148 Vali Acc: 0.251 Test Loss: 3.148 Test Acc: 0.251
Validation loss decreased (-0.248204 --> -0.250557).  Saving model ...
Epoch: 17 cost time: 0.7508280277252197
Epoch: 17, Steps: 10 | Train Loss: 0.337 Vali Loss: 3.178 Vali Acc: 0.249 Test Loss: 3.178 Test Acc: 0.249
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.728816032409668
Epoch: 18, Steps: 10 | Train Loss: 0.239 Vali Loss: 3.210 Vali Acc: 0.260 Test Loss: 3.210 Test Acc: 0.260
Validation loss decreased (-0.250557 --> -0.259968).  Saving model ...
Epoch: 19 cost time: 0.7034425735473633
Epoch: 19, Steps: 10 | Train Loss: 0.178 Vali Loss: 3.234 Vali Acc: 0.255 Test Loss: 3.234 Test Acc: 0.255
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.684300422668457
Epoch: 20, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.270 Vali Acc: 0.260 Test Loss: 3.270 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.729210615158081
Epoch: 21, Steps: 10 | Train Loss: 0.105 Vali Loss: 3.307 Vali Acc: 0.256 Test Loss: 3.307 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7829470634460449
Epoch: 22, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.347 Vali Acc: 0.254 Test Loss: 3.347 Test Acc: 0.254
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.7042279243469238
Epoch: 23, Steps: 10 | Train Loss: 0.069 Vali Loss: 3.391 Vali Acc: 0.259 Test Loss: 3.391 Test Acc: 0.259
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.690565824508667
Epoch: 24, Steps: 10 | Train Loss: 0.058 Vali Loss: 3.419 Vali Acc: 0.266 Test Loss: 3.419 Test Acc: 0.266
Validation loss decreased (-0.259968 --> -0.265848).  Saving model ...
Epoch: 25 cost time: 0.6653010845184326
Epoch: 25, Steps: 10 | Train Loss: 0.056 Vali Loss: 3.436 Vali Acc: 0.267 Test Loss: 3.436 Test Acc: 0.267
Validation loss decreased (-0.265848 --> -0.267024).  Saving model ...
Epoch: 26 cost time: 0.680912971496582
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.448 Vali Acc: 0.268 Test Loss: 3.448 Test Acc: 0.268
Validation loss decreased (-0.267024 --> -0.268201).  Saving model ...
Epoch: 27 cost time: 0.6249957084655762
Epoch: 27, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.476 Vali Acc: 0.262 Test Loss: 3.476 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.661574125289917
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.516 Vali Acc: 0.261 Test Loss: 3.516 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6270396709442139
Epoch: 29, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.536 Vali Acc: 0.262 Test Loss: 3.536 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.6964766979217529
Epoch: 30, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.549 Vali Acc: 0.262 Test Loss: 3.549 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.7063946723937988
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.553 Vali Acc: 0.264 Test Loss: 3.553 Test Acc: 0.264
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.7082247734069824
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.570 Vali Acc: 0.267 Test Loss: 3.570 Test Acc: 0.267
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.7043571472167969
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.598 Vali Acc: 0.268 Test Loss: 3.598 Test Acc: 0.268
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.6963067054748535
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.612 Vali Acc: 0.260 Test Loss: 3.612 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6716904640197754
Epoch: 35, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.638 Vali Acc: 0.262 Test Loss: 3.638 Test Acc: 0.262
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.5891444683074951
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.660 Vali Acc: 0.260 Test Loss: 3.660 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26823529411764707
model parameter : 194966
model size : 1.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3929450511932373
Epoch: 1, Steps: 10 | Train Loss: 3.318 Vali Loss: 3.342 Vali Acc: 0.060 Test Loss: 3.342 Test Acc: 0.060
Validation loss decreased (inf --> -0.059967).  Saving model ...
Epoch: 2 cost time: 0.7193505764007568
Epoch: 2, Steps: 10 | Train Loss: 3.166 Vali Loss: 3.305 Vali Acc: 0.069 Test Loss: 3.305 Test Acc: 0.069
Validation loss decreased (-0.059967 --> -0.069379).  Saving model ...
Epoch: 3 cost time: 0.7708675861358643
Epoch: 3, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.273 Vali Acc: 0.081 Test Loss: 3.273 Test Acc: 0.081
Validation loss decreased (-0.069379 --> -0.081144).  Saving model ...
Epoch: 4 cost time: 0.6489272117614746
Epoch: 4, Steps: 10 | Train Loss: 2.646 Vali Loss: 3.243 Vali Acc: 0.107 Test Loss: 3.243 Test Acc: 0.107
Validation loss decreased (-0.081144 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.6318869590759277
Epoch: 5, Steps: 10 | Train Loss: 2.355 Vali Loss: 3.191 Vali Acc: 0.148 Test Loss: 3.191 Test Acc: 0.148
Validation loss decreased (-0.107026 --> -0.148203).  Saving model ...
Epoch: 6 cost time: 0.6564257144927979
Epoch: 6, Steps: 10 | Train Loss: 2.030 Vali Loss: 3.151 Vali Acc: 0.169 Test Loss: 3.151 Test Acc: 0.169
Validation loss decreased (-0.148203 --> -0.169380).  Saving model ...
Epoch: 7 cost time: 0.6709129810333252
Epoch: 7, Steps: 10 | Train Loss: 1.750 Vali Loss: 3.122 Vali Acc: 0.188 Test Loss: 3.122 Test Acc: 0.188
Validation loss decreased (-0.169380 --> -0.188204).  Saving model ...
Epoch: 8 cost time: 0.7807397842407227
Epoch: 8, Steps: 10 | Train Loss: 1.455 Vali Loss: 3.102 Vali Acc: 0.214 Test Loss: 3.102 Test Acc: 0.214
Validation loss decreased (-0.188204 --> -0.214087).  Saving model ...
Epoch: 9 cost time: 0.709064245223999
Epoch: 9, Steps: 10 | Train Loss: 1.200 Vali Loss: 3.114 Vali Acc: 0.227 Test Loss: 3.114 Test Acc: 0.227
Validation loss decreased (-0.214087 --> -0.227028).  Saving model ...
Epoch: 10 cost time: 0.7966535091400146
Epoch: 10, Steps: 10 | Train Loss: 0.961 Vali Loss: 3.121 Vali Acc: 0.246 Test Loss: 3.121 Test Acc: 0.246
Validation loss decreased (-0.227028 --> -0.245851).  Saving model ...
Epoch: 11 cost time: 0.6484992504119873
Epoch: 11, Steps: 10 | Train Loss: 0.810 Vali Loss: 3.139 Vali Acc: 0.255 Test Loss: 3.139 Test Acc: 0.255
Validation loss decreased (-0.245851 --> -0.255263).  Saving model ...
Epoch: 12 cost time: 0.6859745979309082
Epoch: 12, Steps: 10 | Train Loss: 0.606 Vali Loss: 3.164 Vali Acc: 0.258 Test Loss: 3.164 Test Acc: 0.258
Validation loss decreased (-0.255263 --> -0.257615).  Saving model ...
Epoch: 13 cost time: 0.6756110191345215
Epoch: 13, Steps: 10 | Train Loss: 0.484 Vali Loss: 3.188 Vali Acc: 0.286 Test Loss: 3.188 Test Acc: 0.286
Validation loss decreased (-0.257615 --> -0.285850).  Saving model ...
Epoch: 14 cost time: 0.596550703048706
Epoch: 14, Steps: 10 | Train Loss: 0.370 Vali Loss: 3.252 Vali Acc: 0.281 Test Loss: 3.252 Test Acc: 0.281
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6718924045562744
Epoch: 15, Steps: 10 | Train Loss: 0.282 Vali Loss: 3.266 Vali Acc: 0.299 Test Loss: 3.266 Test Acc: 0.299
Validation loss decreased (-0.285850 --> -0.298791).  Saving model ...
Epoch: 16 cost time: 0.6653790473937988
Epoch: 16, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.326 Vali Acc: 0.300 Test Loss: 3.326 Test Acc: 0.300
Validation loss decreased (-0.298791 --> -0.299967).  Saving model ...
Epoch: 17 cost time: 0.746321439743042
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.381 Vali Acc: 0.305 Test Loss: 3.381 Test Acc: 0.305
Validation loss decreased (-0.299967 --> -0.304672).  Saving model ...
Epoch: 18 cost time: 0.7194809913635254
Epoch: 18, Steps: 10 | Train Loss: 0.107 Vali Loss: 3.405 Vali Acc: 0.308 Test Loss: 3.405 Test Acc: 0.308
Validation loss decreased (-0.304672 --> -0.308201).  Saving model ...
Epoch: 19 cost time: 0.7413949966430664
Epoch: 19, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.455 Vali Acc: 0.305 Test Loss: 3.455 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7006938457489014
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.487 Vali Acc: 0.309 Test Loss: 3.487 Test Acc: 0.309
Validation loss decreased (-0.308201 --> -0.309377).  Saving model ...
Epoch: 21 cost time: 0.6863892078399658
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.505 Vali Acc: 0.309 Test Loss: 3.505 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6227359771728516
Epoch: 22, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.547 Vali Acc: 0.311 Test Loss: 3.547 Test Acc: 0.311
Validation loss decreased (-0.309377 --> -0.310553).  Saving model ...
Epoch: 23 cost time: 0.6294872760772705
Epoch: 23, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.583 Vali Acc: 0.312 Test Loss: 3.583 Test Acc: 0.312
Validation loss decreased (-0.310553 --> -0.311729).  Saving model ...
Epoch: 24 cost time: 0.6751704216003418
Epoch: 24, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.610 Vali Acc: 0.308 Test Loss: 3.610 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6681392192840576
Epoch: 25, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.628 Vali Acc: 0.304 Test Loss: 3.628 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7335631847381592
Epoch: 26, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.648 Vali Acc: 0.306 Test Loss: 3.648 Test Acc: 0.306
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.545804500579834
Epoch: 27, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.666 Vali Acc: 0.309 Test Loss: 3.666 Test Acc: 0.309
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6751115322113037
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.673 Vali Acc: 0.309 Test Loss: 3.673 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6887149810791016
Epoch: 29, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.699 Vali Acc: 0.307 Test Loss: 3.699 Test Acc: 0.307
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7302653789520264
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.720 Vali Acc: 0.309 Test Loss: 3.720 Test Acc: 0.309
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6886022090911865
Epoch: 31, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.740 Vali Acc: 0.312 Test Loss: 3.740 Test Acc: 0.312
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6813466548919678
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.762 Vali Acc: 0.309 Test Loss: 3.762 Test Acc: 0.309
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6930732727050781
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.790 Vali Acc: 0.311 Test Loss: 3.790 Test Acc: 0.311
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.31176470588235294
model parameter : 162198
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.168374538421631
Epoch: 1, Steps: 10 | Train Loss: 3.304 Vali Loss: 3.324 Vali Acc: 0.044 Test Loss: 3.324 Test Acc: 0.044
Validation loss decreased (inf --> -0.043496).  Saving model ...
Epoch: 2 cost time: 0.6914386749267578
Epoch: 2, Steps: 10 | Train Loss: 3.179 Vali Loss: 3.290 Vali Acc: 0.061 Test Loss: 3.290 Test Acc: 0.061
Validation loss decreased (-0.043496 --> -0.061144).  Saving model ...
Epoch: 3 cost time: 0.6471507549285889
Epoch: 3, Steps: 10 | Train Loss: 2.878 Vali Loss: 3.262 Vali Acc: 0.078 Test Loss: 3.262 Test Acc: 0.078
Validation loss decreased (-0.061144 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.6262471675872803
Epoch: 4, Steps: 10 | Train Loss: 2.662 Vali Loss: 3.234 Vali Acc: 0.100 Test Loss: 3.234 Test Acc: 0.100
Validation loss decreased (-0.077614 --> -0.099968).  Saving model ...
Epoch: 5 cost time: 0.6321556568145752
Epoch: 5, Steps: 10 | Train Loss: 2.407 Vali Loss: 3.184 Vali Acc: 0.147 Test Loss: 3.184 Test Acc: 0.147
Validation loss decreased (-0.099968 --> -0.147027).  Saving model ...
Epoch: 6 cost time: 0.691359281539917
Epoch: 6, Steps: 10 | Train Loss: 2.063 Vali Loss: 3.142 Vali Acc: 0.174 Test Loss: 3.142 Test Acc: 0.174
Validation loss decreased (-0.147027 --> -0.174086).  Saving model ...
Epoch: 7 cost time: 0.6754250526428223
Epoch: 7, Steps: 10 | Train Loss: 1.813 Vali Loss: 3.107 Vali Acc: 0.206 Test Loss: 3.107 Test Acc: 0.206
Validation loss decreased (-0.174086 --> -0.205851).  Saving model ...
Epoch: 8 cost time: 0.6174993515014648
Epoch: 8, Steps: 10 | Train Loss: 1.523 Vali Loss: 3.082 Vali Acc: 0.235 Test Loss: 3.082 Test Acc: 0.235
Validation loss decreased (-0.205851 --> -0.235263).  Saving model ...
Epoch: 9 cost time: 0.7021498680114746
Epoch: 9, Steps: 10 | Train Loss: 1.262 Vali Loss: 3.079 Vali Acc: 0.242 Test Loss: 3.079 Test Acc: 0.242
Validation loss decreased (-0.235263 --> -0.242322).  Saving model ...
Epoch: 10 cost time: 0.6926519870758057
Epoch: 10, Steps: 10 | Train Loss: 1.024 Vali Loss: 3.079 Vali Acc: 0.258 Test Loss: 3.079 Test Acc: 0.258
Validation loss decreased (-0.242322 --> -0.257616).  Saving model ...
Epoch: 11 cost time: 0.6708080768585205
Epoch: 11, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.089 Vali Acc: 0.262 Test Loss: 3.089 Test Acc: 0.262
Validation loss decreased (-0.257616 --> -0.262322).  Saving model ...
Epoch: 12 cost time: 0.65203857421875
Epoch: 12, Steps: 10 | Train Loss: 0.636 Vali Loss: 3.111 Vali Acc: 0.275 Test Loss: 3.111 Test Acc: 0.275
Validation loss decreased (-0.262322 --> -0.275263).  Saving model ...
Epoch: 13 cost time: 0.6780240535736084
Epoch: 13, Steps: 10 | Train Loss: 0.531 Vali Loss: 3.131 Vali Acc: 0.279 Test Loss: 3.131 Test Acc: 0.279
Validation loss decreased (-0.275263 --> -0.278792).  Saving model ...
Epoch: 14 cost time: 0.6682024002075195
Epoch: 14, Steps: 10 | Train Loss: 0.388 Vali Loss: 3.190 Vali Acc: 0.275 Test Loss: 3.190 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6844186782836914
Epoch: 15, Steps: 10 | Train Loss: 0.292 Vali Loss: 3.207 Vali Acc: 0.296 Test Loss: 3.207 Test Acc: 0.296
Validation loss decreased (-0.278792 --> -0.296439).  Saving model ...
Epoch: 16 cost time: 0.6904168128967285
Epoch: 16, Steps: 10 | Train Loss: 0.211 Vali Loss: 3.261 Vali Acc: 0.302 Test Loss: 3.261 Test Acc: 0.302
Validation loss decreased (-0.296439 --> -0.302320).  Saving model ...
Epoch: 17 cost time: 0.6955008506774902
Epoch: 17, Steps: 10 | Train Loss: 0.162 Vali Loss: 3.295 Vali Acc: 0.295 Test Loss: 3.295 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6645877361297607
Epoch: 18, Steps: 10 | Train Loss: 0.111 Vali Loss: 3.325 Vali Acc: 0.307 Test Loss: 3.325 Test Acc: 0.307
Validation loss decreased (-0.302320 --> -0.307026).  Saving model ...
Epoch: 19 cost time: 0.7035837173461914
Epoch: 19, Steps: 10 | Train Loss: 0.097 Vali Loss: 3.382 Vali Acc: 0.311 Test Loss: 3.382 Test Acc: 0.311
Validation loss decreased (-0.307026 --> -0.310554).  Saving model ...
Epoch: 20 cost time: 0.7423419952392578
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.416 Vali Acc: 0.313 Test Loss: 3.416 Test Acc: 0.313
Validation loss decreased (-0.310554 --> -0.312907).  Saving model ...
Epoch: 21 cost time: 0.7126684188842773
Epoch: 21, Steps: 10 | Train Loss: 0.060 Vali Loss: 3.432 Vali Acc: 0.299 Test Loss: 3.432 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6514904499053955
Epoch: 22, Steps: 10 | Train Loss: 0.050 Vali Loss: 3.467 Vali Acc: 0.311 Test Loss: 3.467 Test Acc: 0.311
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5106656551361084
Epoch: 23, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.496 Vali Acc: 0.311 Test Loss: 3.496 Test Acc: 0.311
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5808632373809814
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.516 Vali Acc: 0.312 Test Loss: 3.516 Test Acc: 0.312
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7179934978485107
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.531 Vali Acc: 0.319 Test Loss: 3.531 Test Acc: 0.319
Validation loss decreased (-0.312907 --> -0.318788).  Saving model ...
Epoch: 26 cost time: 0.6261227130889893
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.543 Vali Acc: 0.313 Test Loss: 3.543 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.653576135635376
Epoch: 27, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.547 Vali Acc: 0.316 Test Loss: 3.547 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6015493869781494
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.563 Vali Acc: 0.320 Test Loss: 3.563 Test Acc: 0.320
Validation loss decreased (-0.318788 --> -0.319964).  Saving model ...
Epoch: 29 cost time: 0.7284579277038574
Epoch: 29, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.589 Vali Acc: 0.321 Test Loss: 3.589 Test Acc: 0.321
Validation loss decreased (-0.319964 --> -0.321141).  Saving model ...
Epoch: 30 cost time: 0.6541039943695068
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.618 Vali Acc: 0.318 Test Loss: 3.618 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7027387619018555
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.637 Vali Acc: 0.326 Test Loss: 3.637 Test Acc: 0.326
Validation loss decreased (-0.321141 --> -0.325846).  Saving model ...
Epoch: 32 cost time: 0.5992186069488525
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.645 Vali Acc: 0.319 Test Loss: 3.645 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6391105651855469
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.661 Vali Acc: 0.320 Test Loss: 3.661 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.839411735534668
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.675 Vali Acc: 0.316 Test Loss: 3.675 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7828984260559082
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.695 Vali Acc: 0.318 Test Loss: 3.695 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5554862022399902
Epoch: 36, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.711 Vali Acc: 0.319 Test Loss: 3.711 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.6518862247467041
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.749 Vali Acc: 0.320 Test Loss: 3.749 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6925628185272217
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.774 Vali Acc: 0.324 Test Loss: 3.774 Test Acc: 0.324
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.562507152557373
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.782 Vali Acc: 0.319 Test Loss: 3.782 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5762546062469482
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.779 Vali Acc: 0.320 Test Loss: 3.779 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6890807151794434
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.788 Vali Acc: 0.321 Test Loss: 3.788 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 162198
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3360300064086914
Epoch: 1, Steps: 10 | Train Loss: 3.305 Vali Loss: 3.307 Vali Acc: 0.045 Test Loss: 3.307 Test Acc: 0.045
Validation loss decreased (inf --> -0.044673).  Saving model ...
Epoch: 2 cost time: 0.7410678863525391
Epoch: 2, Steps: 10 | Train Loss: 3.180 Vali Loss: 3.282 Vali Acc: 0.065 Test Loss: 3.282 Test Acc: 0.065
Validation loss decreased (-0.044673 --> -0.064673).  Saving model ...
Epoch: 3 cost time: 0.7068190574645996
Epoch: 3, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.261 Vali Acc: 0.076 Test Loss: 3.261 Test Acc: 0.076
Validation loss decreased (-0.064673 --> -0.076438).  Saving model ...
Epoch: 4 cost time: 0.7041263580322266
Epoch: 4, Steps: 10 | Train Loss: 2.714 Vali Loss: 3.242 Vali Acc: 0.094 Test Loss: 3.242 Test Acc: 0.094
Validation loss decreased (-0.076438 --> -0.094085).  Saving model ...
Epoch: 5 cost time: 0.6830093860626221
Epoch: 5, Steps: 10 | Train Loss: 2.499 Vali Loss: 3.199 Vali Acc: 0.134 Test Loss: 3.199 Test Acc: 0.134
Validation loss decreased (-0.094085 --> -0.134086).  Saving model ...
Epoch: 6 cost time: 0.7438919544219971
Epoch: 6, Steps: 10 | Train Loss: 2.184 Vali Loss: 3.159 Vali Acc: 0.166 Test Loss: 3.159 Test Acc: 0.166
Validation loss decreased (-0.134086 --> -0.165851).  Saving model ...
Epoch: 7 cost time: 0.6644856929779053
Epoch: 7, Steps: 10 | Train Loss: 1.933 Vali Loss: 3.119 Vali Acc: 0.180 Test Loss: 3.119 Test Acc: 0.180
Validation loss decreased (-0.165851 --> -0.179969).  Saving model ...
Epoch: 8 cost time: 0.6931273937225342
Epoch: 8, Steps: 10 | Train Loss: 1.679 Vali Loss: 3.085 Vali Acc: 0.221 Test Loss: 3.085 Test Acc: 0.221
Validation loss decreased (-0.179969 --> -0.221146).  Saving model ...
Epoch: 9 cost time: 0.7015094757080078
Epoch: 9, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.073 Vali Acc: 0.227 Test Loss: 3.073 Test Acc: 0.227
Validation loss decreased (-0.221146 --> -0.227028).  Saving model ...
Epoch: 10 cost time: 0.7837977409362793
Epoch: 10, Steps: 10 | Train Loss: 1.180 Vali Loss: 3.071 Vali Acc: 0.233 Test Loss: 3.071 Test Acc: 0.233
Validation loss decreased (-0.227028 --> -0.232910).  Saving model ...
Epoch: 11 cost time: 0.7700421810150146
Epoch: 11, Steps: 10 | Train Loss: 0.975 Vali Loss: 3.072 Vali Acc: 0.244 Test Loss: 3.072 Test Acc: 0.244
Validation loss decreased (-0.232910 --> -0.243499).  Saving model ...
Epoch: 12 cost time: 0.7433500289916992
Epoch: 12, Steps: 10 | Train Loss: 0.764 Vali Loss: 3.077 Vali Acc: 0.254 Test Loss: 3.077 Test Acc: 0.254
Validation loss decreased (-0.243499 --> -0.254087).  Saving model ...
Epoch: 13 cost time: 0.8289914131164551
Epoch: 13, Steps: 10 | Train Loss: 0.622 Vali Loss: 3.097 Vali Acc: 0.267 Test Loss: 3.097 Test Acc: 0.267
Validation loss decreased (-0.254087 --> -0.267028).  Saving model ...
Epoch: 14 cost time: 0.8710570335388184
Epoch: 14, Steps: 10 | Train Loss: 0.480 Vali Loss: 3.144 Vali Acc: 0.279 Test Loss: 3.144 Test Acc: 0.279
Validation loss decreased (-0.267028 --> -0.278792).  Saving model ...
Epoch: 15 cost time: 0.7928652763366699
Epoch: 15, Steps: 10 | Train Loss: 0.355 Vali Loss: 3.167 Vali Acc: 0.275 Test Loss: 3.167 Test Acc: 0.275
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8124480247497559
Epoch: 16, Steps: 10 | Train Loss: 0.270 Vali Loss: 3.212 Vali Acc: 0.293 Test Loss: 3.212 Test Acc: 0.293
Validation loss decreased (-0.278792 --> -0.292909).  Saving model ...
Epoch: 17 cost time: 0.7717463970184326
Epoch: 17, Steps: 10 | Train Loss: 0.188 Vali Loss: 3.248 Vali Acc: 0.294 Test Loss: 3.248 Test Acc: 0.294
Validation loss decreased (-0.292909 --> -0.294085).  Saving model ...
Epoch: 18 cost time: 0.8101282119750977
Epoch: 18, Steps: 10 | Train Loss: 0.146 Vali Loss: 3.272 Vali Acc: 0.294 Test Loss: 3.272 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7499196529388428
Epoch: 19, Steps: 10 | Train Loss: 0.122 Vali Loss: 3.322 Vali Acc: 0.295 Test Loss: 3.322 Test Acc: 0.295
Validation loss decreased (-0.294085 --> -0.295261).  Saving model ...
Epoch: 20 cost time: 0.6963889598846436
Epoch: 20, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.357 Vali Acc: 0.296 Test Loss: 3.357 Test Acc: 0.296
Validation loss decreased (-0.295261 --> -0.296437).  Saving model ...
Epoch: 21 cost time: 0.7644281387329102
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.382 Vali Acc: 0.301 Test Loss: 3.382 Test Acc: 0.301
Validation loss decreased (-0.296437 --> -0.301143).  Saving model ...
Epoch: 22 cost time: 0.7616937160491943
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.416 Vali Acc: 0.299 Test Loss: 3.416 Test Acc: 0.299
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8151774406433105
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.441 Vali Acc: 0.296 Test Loss: 3.441 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8356163501739502
Epoch: 24, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.461 Vali Acc: 0.300 Test Loss: 3.461 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.878385066986084
Epoch: 25, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.472 Vali Acc: 0.292 Test Loss: 3.472 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8333172798156738
Epoch: 26, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.484 Vali Acc: 0.296 Test Loss: 3.484 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7582099437713623
Epoch: 27, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.502 Vali Acc: 0.296 Test Loss: 3.502 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7583134174346924
Epoch: 28, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.515 Vali Acc: 0.295 Test Loss: 3.515 Test Acc: 0.295
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7453241348266602
Epoch: 29, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.553 Vali Acc: 0.301 Test Loss: 3.553 Test Acc: 0.301
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7592935562133789
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.616 Vali Acc: 0.302 Test Loss: 3.616 Test Acc: 0.302
Validation loss decreased (-0.301143 --> -0.302317).  Saving model ...
Epoch: 31 cost time: 0.6973130702972412
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.611 Vali Acc: 0.308 Test Loss: 3.611 Test Acc: 0.308
Validation loss decreased (-0.302317 --> -0.308199).  Saving model ...
Epoch: 32 cost time: 0.8322229385375977
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.602 Vali Acc: 0.302 Test Loss: 3.602 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.8761610984802246
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.604 Vali Acc: 0.305 Test Loss: 3.604 Test Acc: 0.305
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.8114352226257324
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.616 Vali Acc: 0.298 Test Loss: 3.616 Test Acc: 0.298
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7684123516082764
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.646 Vali Acc: 0.292 Test Loss: 3.646 Test Acc: 0.292
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7940824031829834
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.660 Vali Acc: 0.295 Test Loss: 3.660 Test Acc: 0.295
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.8573431968688965
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.686 Vali Acc: 0.300 Test Loss: 3.686 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7987360954284668
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.703 Vali Acc: 0.300 Test Loss: 3.703 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.8176290988922119
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.710 Vali Acc: 0.296 Test Loss: 3.710 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.8299195766448975
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.707 Vali Acc: 0.298 Test Loss: 3.707 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.7998883724212646
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.717 Vali Acc: 0.296 Test Loss: 3.717 Test Acc: 0.296
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30823529411764705
model parameter : 162198
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3429934978485107
Epoch: 1, Steps: 10 | Train Loss: 3.289 Vali Loss: 3.281 Vali Acc: 0.034 Test Loss: 3.281 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.6435840129852295
Epoch: 2, Steps: 10 | Train Loss: 3.185 Vali Loss: 3.265 Vali Acc: 0.052 Test Loss: 3.265 Test Acc: 0.052
Validation loss decreased (-0.034085 --> -0.051732).  Saving model ...
Epoch: 3 cost time: 0.8021628856658936
Epoch: 3, Steps: 10 | Train Loss: 3.023 Vali Loss: 3.253 Vali Acc: 0.062 Test Loss: 3.253 Test Acc: 0.062
Validation loss decreased (-0.051732 --> -0.062320).  Saving model ...
Epoch: 4 cost time: 0.7609570026397705
Epoch: 4, Steps: 10 | Train Loss: 2.836 Vali Loss: 3.247 Vali Acc: 0.088 Test Loss: 3.247 Test Acc: 0.088
Validation loss decreased (-0.062320 --> -0.088203).  Saving model ...
Epoch: 5 cost time: 0.6021268367767334
Epoch: 5, Steps: 10 | Train Loss: 2.668 Vali Loss: 3.221 Vali Acc: 0.118 Test Loss: 3.221 Test Acc: 0.118
Validation loss decreased (-0.088203 --> -0.117615).  Saving model ...
Epoch: 6 cost time: 0.6136345863342285
Epoch: 6, Steps: 10 | Train Loss: 2.462 Vali Loss: 3.191 Vali Acc: 0.142 Test Loss: 3.191 Test Acc: 0.142
Validation loss decreased (-0.117615 --> -0.142321).  Saving model ...
Epoch: 7 cost time: 0.5604915618896484
Epoch: 7, Steps: 10 | Train Loss: 2.226 Vali Loss: 3.154 Vali Acc: 0.162 Test Loss: 3.154 Test Acc: 0.162
Validation loss decreased (-0.142321 --> -0.162321).  Saving model ...
Epoch: 8 cost time: 0.6245162487030029
Epoch: 8, Steps: 10 | Train Loss: 2.012 Vali Loss: 3.117 Vali Acc: 0.178 Test Loss: 3.117 Test Acc: 0.178
Validation loss decreased (-0.162321 --> -0.177616).  Saving model ...
Epoch: 9 cost time: 0.5722513198852539
Epoch: 9, Steps: 10 | Train Loss: 1.766 Vali Loss: 3.095 Vali Acc: 0.186 Test Loss: 3.095 Test Acc: 0.186
Validation loss decreased (-0.177616 --> -0.185851).  Saving model ...
Epoch: 10 cost time: 0.5304255485534668
Epoch: 10, Steps: 10 | Train Loss: 1.549 Vali Loss: 3.081 Vali Acc: 0.207 Test Loss: 3.081 Test Acc: 0.207
Validation loss decreased (-0.185851 --> -0.207028).  Saving model ...
Epoch: 11 cost time: 0.6294746398925781
Epoch: 11, Steps: 10 | Train Loss: 1.371 Vali Loss: 3.072 Vali Acc: 0.202 Test Loss: 3.072 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6385824680328369
Epoch: 12, Steps: 10 | Train Loss: 1.116 Vali Loss: 3.070 Vali Acc: 0.212 Test Loss: 3.070 Test Acc: 0.212
Validation loss decreased (-0.207028 --> -0.211734).  Saving model ...
Epoch: 13 cost time: 0.6960511207580566
Epoch: 13, Steps: 10 | Train Loss: 0.976 Vali Loss: 3.075 Vali Acc: 0.215 Test Loss: 3.075 Test Acc: 0.215
Validation loss decreased (-0.211734 --> -0.215263).  Saving model ...
Epoch: 14 cost time: 0.6535847187042236
Epoch: 14, Steps: 10 | Train Loss: 0.766 Vali Loss: 3.106 Vali Acc: 0.225 Test Loss: 3.106 Test Acc: 0.225
Validation loss decreased (-0.215263 --> -0.224675).  Saving model ...
Epoch: 15 cost time: 0.6408963203430176
Epoch: 15, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.109 Vali Acc: 0.236 Test Loss: 3.109 Test Acc: 0.236
Validation loss decreased (-0.224675 --> -0.236439).  Saving model ...
Epoch: 16 cost time: 0.6388647556304932
Epoch: 16, Steps: 10 | Train Loss: 0.475 Vali Loss: 3.153 Vali Acc: 0.242 Test Loss: 3.153 Test Acc: 0.242
Validation loss decreased (-0.236439 --> -0.242321).  Saving model ...
Epoch: 17 cost time: 0.7122316360473633
Epoch: 17, Steps: 10 | Train Loss: 0.364 Vali Loss: 3.189 Vali Acc: 0.254 Test Loss: 3.189 Test Acc: 0.254
Validation loss decreased (-0.242321 --> -0.254086).  Saving model ...
Epoch: 18 cost time: 0.6379971504211426
Epoch: 18, Steps: 10 | Train Loss: 0.258 Vali Loss: 3.207 Vali Acc: 0.260 Test Loss: 3.207 Test Acc: 0.260
Validation loss decreased (-0.254086 --> -0.259968).  Saving model ...
Epoch: 19 cost time: 0.6523532867431641
Epoch: 19, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.263 Vali Acc: 0.261 Test Loss: 3.263 Test Acc: 0.261
Validation loss decreased (-0.259968 --> -0.261144).  Saving model ...
Epoch: 20 cost time: 0.6318256855010986
Epoch: 20, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.291 Vali Acc: 0.264 Test Loss: 3.291 Test Acc: 0.264
Validation loss decreased (-0.261144 --> -0.263496).  Saving model ...
Epoch: 21 cost time: 0.6342206001281738
Epoch: 21, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.319 Vali Acc: 0.267 Test Loss: 3.319 Test Acc: 0.267
Validation loss decreased (-0.263496 --> -0.267026).  Saving model ...
Epoch: 22 cost time: 0.6113011837005615
Epoch: 22, Steps: 10 | Train Loss: 0.096 Vali Loss: 3.360 Vali Acc: 0.262 Test Loss: 3.360 Test Acc: 0.262
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6635360717773438
Epoch: 23, Steps: 10 | Train Loss: 0.076 Vali Loss: 3.377 Vali Acc: 0.258 Test Loss: 3.377 Test Acc: 0.258
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6446149349212646
Epoch: 24, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.403 Vali Acc: 0.262 Test Loss: 3.403 Test Acc: 0.262
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.6294369697570801
Epoch: 25, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.427 Vali Acc: 0.259 Test Loss: 3.427 Test Acc: 0.259
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6991636753082275
Epoch: 26, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.450 Vali Acc: 0.252 Test Loss: 3.450 Test Acc: 0.252
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.7366476058959961
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.478 Vali Acc: 0.260 Test Loss: 3.478 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.613849401473999
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.505 Vali Acc: 0.255 Test Loss: 3.505 Test Acc: 0.255
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6528351306915283
Epoch: 29, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.537 Vali Acc: 0.258 Test Loss: 3.537 Test Acc: 0.258
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7396507263183594
Epoch: 30, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.576 Vali Acc: 0.253 Test Loss: 3.576 Test Acc: 0.253
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7342898845672607
Epoch: 31, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.603 Vali Acc: 0.252 Test Loss: 3.603 Test Acc: 0.252
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26705882352941174
model parameter : 162198
model size : 1.24MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.68500018119812
Epoch: 1, Steps: 10 | Train Loss: 3.369 Vali Loss: 3.300 Vali Acc: 0.042 Test Loss: 3.300 Test Acc: 0.042
Validation loss decreased (inf --> -0.042320).  Saving model ...
Epoch: 2 cost time: 0.739037275314331
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.247 Vali Acc: 0.075 Test Loss: 3.247 Test Acc: 0.075
Validation loss decreased (-0.042320 --> -0.075262).  Saving model ...
Epoch: 3 cost time: 0.6380031108856201
Epoch: 3, Steps: 10 | Train Loss: 2.937 Vali Loss: 3.230 Vali Acc: 0.101 Test Loss: 3.230 Test Acc: 0.101
Validation loss decreased (-0.075262 --> -0.101144).  Saving model ...
Epoch: 4 cost time: 0.760326623916626
Epoch: 4, Steps: 10 | Train Loss: 2.652 Vali Loss: 3.204 Vali Acc: 0.121 Test Loss: 3.204 Test Acc: 0.121
Validation loss decreased (-0.101144 --> -0.121144).  Saving model ...
Epoch: 5 cost time: 0.7450106143951416
Epoch: 5, Steps: 10 | Train Loss: 2.325 Vali Loss: 3.163 Vali Acc: 0.152 Test Loss: 3.163 Test Acc: 0.152
Validation loss decreased (-0.121144 --> -0.151733).  Saving model ...
Epoch: 6 cost time: 0.7246756553649902
Epoch: 6, Steps: 10 | Train Loss: 2.053 Vali Loss: 3.119 Vali Acc: 0.172 Test Loss: 3.119 Test Acc: 0.172
Validation loss decreased (-0.151733 --> -0.171734).  Saving model ...
Epoch: 7 cost time: 0.7389369010925293
Epoch: 7, Steps: 10 | Train Loss: 1.715 Vali Loss: 3.088 Vali Acc: 0.200 Test Loss: 3.088 Test Acc: 0.200
Validation loss decreased (-0.171734 --> -0.199969).  Saving model ...
Epoch: 8 cost time: 0.6460444927215576
Epoch: 8, Steps: 10 | Train Loss: 1.483 Vali Loss: 3.085 Vali Acc: 0.216 Test Loss: 3.085 Test Acc: 0.216
Validation loss decreased (-0.199969 --> -0.216440).  Saving model ...
Epoch: 9 cost time: 0.6736962795257568
Epoch: 9, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.071 Vali Acc: 0.239 Test Loss: 3.071 Test Acc: 0.239
Validation loss decreased (-0.216440 --> -0.238793).  Saving model ...
Epoch: 10 cost time: 0.6643393039703369
Epoch: 10, Steps: 10 | Train Loss: 1.013 Vali Loss: 3.082 Vali Acc: 0.254 Test Loss: 3.082 Test Acc: 0.254
Validation loss decreased (-0.238793 --> -0.254087).  Saving model ...
Epoch: 11 cost time: 0.6218414306640625
Epoch: 11, Steps: 10 | Train Loss: 0.795 Vali Loss: 3.104 Vali Acc: 0.255 Test Loss: 3.104 Test Acc: 0.255
Validation loss decreased (-0.254087 --> -0.255263).  Saving model ...
Epoch: 12 cost time: 0.7609870433807373
Epoch: 12, Steps: 10 | Train Loss: 0.615 Vali Loss: 3.132 Vali Acc: 0.273 Test Loss: 3.132 Test Acc: 0.273
Validation loss decreased (-0.255263 --> -0.272910).  Saving model ...
Epoch: 13 cost time: 0.7352919578552246
Epoch: 13, Steps: 10 | Train Loss: 0.445 Vali Loss: 3.162 Vali Acc: 0.279 Test Loss: 3.162 Test Acc: 0.279
Validation loss decreased (-0.272910 --> -0.278792).  Saving model ...
Epoch: 14 cost time: 0.7379200458526611
Epoch: 14, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.210 Vali Acc: 0.298 Test Loss: 3.210 Test Acc: 0.298
Validation loss decreased (-0.278792 --> -0.297615).  Saving model ...
Epoch: 15 cost time: 0.6597945690155029
Epoch: 15, Steps: 10 | Train Loss: 0.275 Vali Loss: 3.227 Vali Acc: 0.301 Test Loss: 3.227 Test Acc: 0.301
Validation loss decreased (-0.297615 --> -0.301144).  Saving model ...
Epoch: 16 cost time: 0.7261569499969482
Epoch: 16, Steps: 10 | Train Loss: 0.189 Vali Loss: 3.287 Vali Acc: 0.298 Test Loss: 3.287 Test Acc: 0.298
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7076447010040283
Epoch: 17, Steps: 10 | Train Loss: 0.142 Vali Loss: 3.350 Vali Acc: 0.296 Test Loss: 3.350 Test Acc: 0.296
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.7480463981628418
Epoch: 18, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.381 Vali Acc: 0.307 Test Loss: 3.381 Test Acc: 0.307
Validation loss decreased (-0.301144 --> -0.307025).  Saving model ...
Epoch: 19 cost time: 0.6053917407989502
Epoch: 19, Steps: 10 | Train Loss: 0.085 Vali Loss: 3.426 Vali Acc: 0.305 Test Loss: 3.426 Test Acc: 0.305
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7078547477722168
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.479 Vali Acc: 0.307 Test Loss: 3.479 Test Acc: 0.307
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7233130931854248
Epoch: 21, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.491 Vali Acc: 0.301 Test Loss: 3.491 Test Acc: 0.301
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.6675136089324951
Epoch: 22, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.521 Vali Acc: 0.305 Test Loss: 3.521 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.654522180557251
Epoch: 23, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.555 Vali Acc: 0.311 Test Loss: 3.555 Test Acc: 0.311
Validation loss decreased (-0.307025 --> -0.310553).  Saving model ...
Epoch: 24 cost time: 0.7187561988830566
Epoch: 24, Steps: 10 | Train Loss: 0.034 Vali Loss: 3.570 Vali Acc: 0.315 Test Loss: 3.570 Test Acc: 0.315
Validation loss decreased (-0.310553 --> -0.315258).  Saving model ...
Epoch: 25 cost time: 0.6836855411529541
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.598 Vali Acc: 0.311 Test Loss: 3.598 Test Acc: 0.311
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7251651287078857
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.613 Vali Acc: 0.312 Test Loss: 3.613 Test Acc: 0.312
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6947789192199707
Epoch: 27, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.643 Vali Acc: 0.316 Test Loss: 3.643 Test Acc: 0.316
Validation loss decreased (-0.315258 --> -0.316434).  Saving model ...
Epoch: 28 cost time: 0.7021584510803223
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.667 Vali Acc: 0.316 Test Loss: 3.667 Test Acc: 0.316
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.746727705001831
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.691 Vali Acc: 0.320 Test Loss: 3.691 Test Acc: 0.320
Validation loss decreased (-0.316434 --> -0.319963).  Saving model ...
Epoch: 30 cost time: 0.7292399406433105
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.710 Vali Acc: 0.322 Test Loss: 3.710 Test Acc: 0.322
Validation loss decreased (-0.319963 --> -0.322316).  Saving model ...
Epoch: 31 cost time: 0.7298400402069092
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.728 Vali Acc: 0.320 Test Loss: 3.728 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6826171875
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.733 Vali Acc: 0.314 Test Loss: 3.733 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5794689655303955
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.753 Vali Acc: 0.315 Test Loss: 3.753 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.623100996017456
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.773 Vali Acc: 0.319 Test Loss: 3.773 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5701737403869629
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.789 Vali Acc: 0.320 Test Loss: 3.789 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6481413841247559
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.812 Vali Acc: 0.324 Test Loss: 3.812 Test Acc: 0.324
Validation loss decreased (-0.322316 --> -0.323491).  Saving model ...
Epoch: 37 cost time: 0.7320117950439453
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.843 Vali Acc: 0.318 Test Loss: 3.843 Test Acc: 0.318
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7232987880706787
Epoch: 38, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.851 Vali Acc: 0.314 Test Loss: 3.851 Test Acc: 0.314
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7396342754364014
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.858 Vali Acc: 0.316 Test Loss: 3.858 Test Acc: 0.316
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7901294231414795
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.859 Vali Acc: 0.316 Test Loss: 3.859 Test Acc: 0.316
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7853751182556152
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.868 Vali Acc: 0.319 Test Loss: 3.868 Test Acc: 0.319
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6831443309783936
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.885 Vali Acc: 0.319 Test Loss: 3.885 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6603927612304688
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.904 Vali Acc: 0.320 Test Loss: 3.904 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.5692665576934814
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.919 Vali Acc: 0.319 Test Loss: 3.919 Test Acc: 0.319
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.6911172866821289
Epoch: 45, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.936 Vali Acc: 0.315 Test Loss: 3.936 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5835514068603516
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.951 Vali Acc: 0.313 Test Loss: 3.951 Test Acc: 0.313
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3235294117647059
model parameter : 145814
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3058855533599854
Epoch: 1, Steps: 10 | Train Loss: 3.375 Vali Loss: 3.296 Vali Acc: 0.036 Test Loss: 3.296 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.6686832904815674
Epoch: 2, Steps: 10 | Train Loss: 3.193 Vali Loss: 3.251 Vali Acc: 0.058 Test Loss: 3.251 Test Acc: 0.058
Validation loss decreased (-0.036438 --> -0.057615).  Saving model ...
Epoch: 3 cost time: 0.7095005512237549
Epoch: 3, Steps: 10 | Train Loss: 2.966 Vali Loss: 3.233 Vali Acc: 0.104 Test Loss: 3.233 Test Acc: 0.104
Validation loss decreased (-0.057615 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 0.7365589141845703
Epoch: 4, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.208 Vali Acc: 0.116 Test Loss: 3.208 Test Acc: 0.116
Validation loss decreased (-0.103497 --> -0.116439).  Saving model ...
Epoch: 5 cost time: 0.6554961204528809
Epoch: 5, Steps: 10 | Train Loss: 2.378 Vali Loss: 3.170 Vali Acc: 0.146 Test Loss: 3.170 Test Acc: 0.146
Validation loss decreased (-0.116439 --> -0.145851).  Saving model ...
Epoch: 6 cost time: 0.6593647003173828
Epoch: 6, Steps: 10 | Train Loss: 2.117 Vali Loss: 3.123 Vali Acc: 0.161 Test Loss: 3.123 Test Acc: 0.161
Validation loss decreased (-0.145851 --> -0.161145).  Saving model ...
Epoch: 7 cost time: 0.6457631587982178
Epoch: 7, Steps: 10 | Train Loss: 1.777 Vali Loss: 3.086 Vali Acc: 0.191 Test Loss: 3.086 Test Acc: 0.191
Validation loss decreased (-0.161145 --> -0.190557).  Saving model ...
Epoch: 8 cost time: 0.7091701030731201
Epoch: 8, Steps: 10 | Train Loss: 1.550 Vali Loss: 3.081 Vali Acc: 0.204 Test Loss: 3.081 Test Acc: 0.204
Validation loss decreased (-0.190557 --> -0.203499).  Saving model ...
Epoch: 9 cost time: 0.6550352573394775
Epoch: 9, Steps: 10 | Train Loss: 1.264 Vali Loss: 3.057 Vali Acc: 0.233 Test Loss: 3.057 Test Acc: 0.233
Validation loss decreased (-0.203499 --> -0.232911).  Saving model ...
Epoch: 10 cost time: 0.7092304229736328
Epoch: 10, Steps: 10 | Train Loss: 1.069 Vali Loss: 3.065 Vali Acc: 0.241 Test Loss: 3.065 Test Acc: 0.241
Validation loss decreased (-0.232911 --> -0.241146).  Saving model ...
Epoch: 11 cost time: 0.6955235004425049
Epoch: 11, Steps: 10 | Train Loss: 0.846 Vali Loss: 3.080 Vali Acc: 0.251 Test Loss: 3.080 Test Acc: 0.251
Validation loss decreased (-0.241146 --> -0.250557).  Saving model ...
Epoch: 12 cost time: 0.6578097343444824
Epoch: 12, Steps: 10 | Train Loss: 0.650 Vali Loss: 3.097 Vali Acc: 0.262 Test Loss: 3.097 Test Acc: 0.262
Validation loss decreased (-0.250557 --> -0.262322).  Saving model ...
Epoch: 13 cost time: 0.6823723316192627
Epoch: 13, Steps: 10 | Train Loss: 0.479 Vali Loss: 3.123 Vali Acc: 0.279 Test Loss: 3.123 Test Acc: 0.279
Validation loss decreased (-0.262322 --> -0.278792).  Saving model ...
Epoch: 14 cost time: 0.6794919967651367
Epoch: 14, Steps: 10 | Train Loss: 0.394 Vali Loss: 3.178 Vali Acc: 0.289 Test Loss: 3.178 Test Acc: 0.289
Validation loss decreased (-0.278792 --> -0.289380).  Saving model ...
Epoch: 15 cost time: 0.6957874298095703
Epoch: 15, Steps: 10 | Train Loss: 0.285 Vali Loss: 3.194 Vali Acc: 0.299 Test Loss: 3.194 Test Acc: 0.299
Validation loss decreased (-0.289380 --> -0.298792).  Saving model ...
Epoch: 16 cost time: 0.7100493907928467
Epoch: 16, Steps: 10 | Train Loss: 0.190 Vali Loss: 3.239 Vali Acc: 0.293 Test Loss: 3.239 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7325496673583984
Epoch: 17, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.286 Vali Acc: 0.301 Test Loss: 3.286 Test Acc: 0.301
Validation loss decreased (-0.298792 --> -0.301144).  Saving model ...
Epoch: 18 cost time: 0.6951265335083008
Epoch: 18, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.323 Vali Acc: 0.305 Test Loss: 3.323 Test Acc: 0.305
Validation loss decreased (-0.301144 --> -0.304673).  Saving model ...
Epoch: 19 cost time: 0.6694395542144775
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.366 Vali Acc: 0.312 Test Loss: 3.366 Test Acc: 0.312
Validation loss decreased (-0.304673 --> -0.311731).  Saving model ...
Epoch: 20 cost time: 0.663292646408081
Epoch: 20, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.410 Vali Acc: 0.309 Test Loss: 3.410 Test Acc: 0.309
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7242355346679688
Epoch: 21, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.431 Vali Acc: 0.306 Test Loss: 3.431 Test Acc: 0.306
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8031003475189209
Epoch: 22, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.444 Vali Acc: 0.309 Test Loss: 3.444 Test Acc: 0.309
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6788454055786133
Epoch: 23, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.460 Vali Acc: 0.311 Test Loss: 3.460 Test Acc: 0.311
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7781832218170166
Epoch: 24, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.495 Vali Acc: 0.312 Test Loss: 3.495 Test Acc: 0.312
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.7032051086425781
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.521 Vali Acc: 0.314 Test Loss: 3.521 Test Acc: 0.314
Validation loss decreased (-0.311731 --> -0.314082).  Saving model ...
Epoch: 26 cost time: 0.8037817478179932
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.530 Vali Acc: 0.320 Test Loss: 3.530 Test Acc: 0.320
Validation loss decreased (-0.314082 --> -0.319965).  Saving model ...
Epoch: 27 cost time: 0.8044030666351318
Epoch: 27, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.544 Vali Acc: 0.314 Test Loss: 3.544 Test Acc: 0.314
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7294104099273682
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.555 Vali Acc: 0.313 Test Loss: 3.555 Test Acc: 0.313
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7311739921569824
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.570 Vali Acc: 0.318 Test Loss: 3.570 Test Acc: 0.318
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.653733491897583
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.599 Vali Acc: 0.319 Test Loss: 3.599 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6653594970703125
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.620 Vali Acc: 0.314 Test Loss: 3.620 Test Acc: 0.314
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6826841831207275
Epoch: 32, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.631 Vali Acc: 0.319 Test Loss: 3.631 Test Acc: 0.319
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5964319705963135
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.647 Vali Acc: 0.325 Test Loss: 3.647 Test Acc: 0.325
Validation loss decreased (-0.319965 --> -0.324669).  Saving model ...
Epoch: 34 cost time: 0.745598316192627
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.663 Vali Acc: 0.322 Test Loss: 3.663 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7190759181976318
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.680 Vali Acc: 0.319 Test Loss: 3.680 Test Acc: 0.319
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7048723697662354
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.699 Vali Acc: 0.321 Test Loss: 3.699 Test Acc: 0.321
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6862530708312988
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.716 Vali Acc: 0.318 Test Loss: 3.716 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6979019641876221
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.725 Vali Acc: 0.318 Test Loss: 3.725 Test Acc: 0.318
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.8329081535339355
Epoch: 39, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.735 Vali Acc: 0.318 Test Loss: 3.735 Test Acc: 0.318
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.759878396987915
Epoch: 40, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.737 Vali Acc: 0.318 Test Loss: 3.737 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7094833850860596
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.749 Vali Acc: 0.320 Test Loss: 3.749 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.6505429744720459
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.769 Vali Acc: 0.314 Test Loss: 3.769 Test Acc: 0.314
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.6637957096099854
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.784 Vali Acc: 0.315 Test Loss: 3.784 Test Acc: 0.315
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3247058823529412
model parameter : 145814
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.42983078956604
Epoch: 1, Steps: 10 | Train Loss: 3.336 Vali Loss: 3.288 Vali Acc: 0.034 Test Loss: 3.288 Test Acc: 0.034
Validation loss decreased (inf --> -0.034085).  Saving model ...
Epoch: 2 cost time: 0.6919033527374268
Epoch: 2, Steps: 10 | Train Loss: 3.212 Vali Loss: 3.249 Vali Acc: 0.060 Test Loss: 3.249 Test Acc: 0.060
Validation loss decreased (-0.034085 --> -0.059968).  Saving model ...
Epoch: 3 cost time: 0.728935956954956
Epoch: 3, Steps: 10 | Train Loss: 3.007 Vali Loss: 3.233 Vali Acc: 0.100 Test Loss: 3.233 Test Acc: 0.100
Validation loss decreased (-0.059968 --> -0.099968).  Saving model ...
Epoch: 4 cost time: 0.7371025085449219
Epoch: 4, Steps: 10 | Train Loss: 2.741 Vali Loss: 3.213 Vali Acc: 0.127 Test Loss: 3.213 Test Acc: 0.127
Validation loss decreased (-0.099968 --> -0.127027).  Saving model ...
Epoch: 5 cost time: 0.7128796577453613
Epoch: 5, Steps: 10 | Train Loss: 2.458 Vali Loss: 3.180 Vali Acc: 0.149 Test Loss: 3.180 Test Acc: 0.149
Validation loss decreased (-0.127027 --> -0.149380).  Saving model ...
Epoch: 6 cost time: 0.6498429775238037
Epoch: 6, Steps: 10 | Train Loss: 2.216 Vali Loss: 3.135 Vali Acc: 0.172 Test Loss: 3.135 Test Acc: 0.172
Validation loss decreased (-0.149380 --> -0.171733).  Saving model ...
Epoch: 7 cost time: 0.7670698165893555
Epoch: 7, Steps: 10 | Train Loss: 1.904 Vali Loss: 3.094 Vali Acc: 0.192 Test Loss: 3.094 Test Acc: 0.192
Validation loss decreased (-0.171733 --> -0.191734).  Saving model ...
Epoch: 8 cost time: 0.7164838314056396
Epoch: 8, Steps: 10 | Train Loss: 1.708 Vali Loss: 3.082 Vali Acc: 0.206 Test Loss: 3.082 Test Acc: 0.206
Validation loss decreased (-0.191734 --> -0.205852).  Saving model ...
Epoch: 9 cost time: 0.7565100193023682
Epoch: 9, Steps: 10 | Train Loss: 1.417 Vali Loss: 3.053 Vali Acc: 0.226 Test Loss: 3.053 Test Acc: 0.226
Validation loss decreased (-0.205852 --> -0.225852).  Saving model ...
Epoch: 10 cost time: 0.7102503776550293
Epoch: 10, Steps: 10 | Train Loss: 1.192 Vali Loss: 3.050 Vali Acc: 0.229 Test Loss: 3.050 Test Acc: 0.229
Validation loss decreased (-0.225852 --> -0.229381).  Saving model ...
Epoch: 11 cost time: 0.7597827911376953
Epoch: 11, Steps: 10 | Train Loss: 0.972 Vali Loss: 3.059 Vali Acc: 0.247 Test Loss: 3.059 Test Acc: 0.247
Validation loss decreased (-0.229381 --> -0.247028).  Saving model ...
Epoch: 12 cost time: 0.7542850971221924
Epoch: 12, Steps: 10 | Train Loss: 0.774 Vali Loss: 3.061 Vali Acc: 0.259 Test Loss: 3.061 Test Acc: 0.259
Validation loss decreased (-0.247028 --> -0.258793).  Saving model ...
Epoch: 13 cost time: 0.7161500453948975
Epoch: 13, Steps: 10 | Train Loss: 0.591 Vali Loss: 3.079 Vali Acc: 0.253 Test Loss: 3.079 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7784316539764404
Epoch: 14, Steps: 10 | Train Loss: 0.467 Vali Loss: 3.139 Vali Acc: 0.261 Test Loss: 3.139 Test Acc: 0.261
Validation loss decreased (-0.258793 --> -0.261145).  Saving model ...
Epoch: 15 cost time: 0.8364555835723877
Epoch: 15, Steps: 10 | Train Loss: 0.339 Vali Loss: 3.143 Vali Acc: 0.275 Test Loss: 3.143 Test Acc: 0.275
Validation loss decreased (-0.261145 --> -0.275263).  Saving model ...
Epoch: 16 cost time: 0.793365478515625
Epoch: 16, Steps: 10 | Train Loss: 0.238 Vali Loss: 3.188 Vali Acc: 0.278 Test Loss: 3.188 Test Acc: 0.278
Validation loss decreased (-0.275263 --> -0.277615).  Saving model ...
Epoch: 17 cost time: 0.7352747917175293
Epoch: 17, Steps: 10 | Train Loss: 0.185 Vali Loss: 3.236 Vali Acc: 0.284 Test Loss: 3.236 Test Acc: 0.284
Validation loss decreased (-0.277615 --> -0.283497).  Saving model ...
Epoch: 18 cost time: 0.7603423595428467
Epoch: 18, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.263 Vali Acc: 0.287 Test Loss: 3.263 Test Acc: 0.287
Validation loss decreased (-0.283497 --> -0.287026).  Saving model ...
Epoch: 19 cost time: 0.6540107727050781
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.298 Vali Acc: 0.292 Test Loss: 3.298 Test Acc: 0.292
Validation loss decreased (-0.287026 --> -0.291732).  Saving model ...
Epoch: 20 cost time: 0.6533288955688477
Epoch: 20, Steps: 10 | Train Loss: 0.089 Vali Loss: 3.340 Vali Acc: 0.293 Test Loss: 3.340 Test Acc: 0.293
Validation loss decreased (-0.291732 --> -0.292908).  Saving model ...
Epoch: 21 cost time: 0.6918346881866455
Epoch: 21, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.370 Vali Acc: 0.289 Test Loss: 3.370 Test Acc: 0.289
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6039943695068359
Epoch: 22, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.389 Vali Acc: 0.287 Test Loss: 3.389 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7509477138519287
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.416 Vali Acc: 0.292 Test Loss: 3.416 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7275125980377197
Epoch: 24, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.444 Vali Acc: 0.296 Test Loss: 3.444 Test Acc: 0.296
Validation loss decreased (-0.292908 --> -0.296436).  Saving model ...
Epoch: 25 cost time: 0.7429301738739014
Epoch: 25, Steps: 10 | Train Loss: 0.042 Vali Loss: 3.467 Vali Acc: 0.292 Test Loss: 3.467 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7423079013824463
Epoch: 26, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.480 Vali Acc: 0.294 Test Loss: 3.480 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7707087993621826
Epoch: 27, Steps: 10 | Train Loss: 0.028 Vali Loss: 3.495 Vali Acc: 0.298 Test Loss: 3.495 Test Acc: 0.298
Validation loss decreased (-0.296436 --> -0.297612).  Saving model ...
Epoch: 28 cost time: 0.7693283557891846
Epoch: 28, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.515 Vali Acc: 0.294 Test Loss: 3.515 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.7336461544036865
Epoch: 29, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.522 Vali Acc: 0.298 Test Loss: 3.522 Test Acc: 0.298
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6973967552185059
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.546 Vali Acc: 0.295 Test Loss: 3.546 Test Acc: 0.295
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.6892890930175781
Epoch: 31, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.563 Vali Acc: 0.294 Test Loss: 3.563 Test Acc: 0.294
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7370924949645996
Epoch: 32, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.588 Vali Acc: 0.298 Test Loss: 3.588 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.737130880355835
Epoch: 33, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.595 Vali Acc: 0.301 Test Loss: 3.595 Test Acc: 0.301
Validation loss decreased (-0.297612 --> -0.301141).  Saving model ...
Epoch: 34 cost time: 0.6875591278076172
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.601 Vali Acc: 0.292 Test Loss: 3.601 Test Acc: 0.292
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.7474081516265869
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.608 Vali Acc: 0.294 Test Loss: 3.608 Test Acc: 0.294
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.7204265594482422
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.620 Vali Acc: 0.294 Test Loss: 3.620 Test Acc: 0.294
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.7941884994506836
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.641 Vali Acc: 0.295 Test Loss: 3.641 Test Acc: 0.295
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.7646710872650146
Epoch: 38, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.663 Vali Acc: 0.296 Test Loss: 3.663 Test Acc: 0.296
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7219154834747314
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.678 Vali Acc: 0.296 Test Loss: 3.678 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7091100215911865
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.682 Vali Acc: 0.296 Test Loss: 3.682 Test Acc: 0.296
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.7446815967559814
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.694 Vali Acc: 0.296 Test Loss: 3.694 Test Acc: 0.296
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.7036793231964111
Epoch: 42, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.710 Vali Acc: 0.298 Test Loss: 3.710 Test Acc: 0.298
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.7446765899658203
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.727 Vali Acc: 0.299 Test Loss: 3.727 Test Acc: 0.299
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.30117647058823527
model parameter : 145814
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.3369789123535156
Epoch: 1, Steps: 10 | Train Loss: 3.329 Vali Loss: 3.272 Vali Acc: 0.046 Test Loss: 3.272 Test Acc: 0.046
Validation loss decreased (inf --> -0.045850).  Saving model ...
Epoch: 2 cost time: 0.6670553684234619
Epoch: 2, Steps: 10 | Train Loss: 3.214 Vali Loss: 3.246 Vali Acc: 0.071 Test Loss: 3.246 Test Acc: 0.071
Validation loss decreased (-0.045850 --> -0.070556).  Saving model ...
Epoch: 3 cost time: 0.72316575050354
Epoch: 3, Steps: 10 | Train Loss: 3.060 Vali Loss: 3.236 Vali Acc: 0.100 Test Loss: 3.236 Test Acc: 0.100
Validation loss decreased (-0.070556 --> -0.099968).  Saving model ...
Epoch: 4 cost time: 0.7006242275238037
Epoch: 4, Steps: 10 | Train Loss: 2.863 Vali Loss: 3.225 Vali Acc: 0.108 Test Loss: 3.225 Test Acc: 0.108
Validation loss decreased (-0.099968 --> -0.108203).  Saving model ...
Epoch: 5 cost time: 0.7393832206726074
Epoch: 5, Steps: 10 | Train Loss: 2.670 Vali Loss: 3.207 Vali Acc: 0.122 Test Loss: 3.207 Test Acc: 0.122
Validation loss decreased (-0.108203 --> -0.122321).  Saving model ...
Epoch: 6 cost time: 0.6744935512542725
Epoch: 6, Steps: 10 | Train Loss: 2.470 Vali Loss: 3.174 Vali Acc: 0.138 Test Loss: 3.174 Test Acc: 0.138
Validation loss decreased (-0.122321 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 0.683311939239502
Epoch: 7, Steps: 10 | Train Loss: 2.206 Vali Loss: 3.135 Vali Acc: 0.154 Test Loss: 3.135 Test Acc: 0.154
Validation loss decreased (-0.137615 --> -0.154086).  Saving model ...
Epoch: 8 cost time: 0.6527855396270752
Epoch: 8, Steps: 10 | Train Loss: 2.038 Vali Loss: 3.116 Vali Acc: 0.162 Test Loss: 3.116 Test Acc: 0.162
Validation loss decreased (-0.154086 --> -0.162322).  Saving model ...
Epoch: 9 cost time: 0.5951769351959229
Epoch: 9, Steps: 10 | Train Loss: 1.783 Vali Loss: 3.077 Vali Acc: 0.176 Test Loss: 3.077 Test Acc: 0.176
Validation loss decreased (-0.162322 --> -0.176440).  Saving model ...
Epoch: 10 cost time: 0.6152422428131104
Epoch: 10, Steps: 10 | Train Loss: 1.575 Vali Loss: 3.057 Vali Acc: 0.188 Test Loss: 3.057 Test Acc: 0.188
Validation loss decreased (-0.176440 --> -0.188205).  Saving model ...
Epoch: 11 cost time: 0.5493338108062744
Epoch: 11, Steps: 10 | Train Loss: 1.354 Vali Loss: 3.045 Vali Acc: 0.195 Test Loss: 3.045 Test Acc: 0.195
Validation loss decreased (-0.188205 --> -0.195264).  Saving model ...
Epoch: 12 cost time: 0.6702485084533691
Epoch: 12, Steps: 10 | Train Loss: 1.112 Vali Loss: 3.042 Vali Acc: 0.214 Test Loss: 3.042 Test Acc: 0.214
Validation loss decreased (-0.195264 --> -0.214087).  Saving model ...
Epoch: 13 cost time: 0.6970040798187256
Epoch: 13, Steps: 10 | Train Loss: 0.918 Vali Loss: 3.044 Vali Acc: 0.222 Test Loss: 3.044 Test Acc: 0.222
Validation loss decreased (-0.214087 --> -0.222322).  Saving model ...
Epoch: 14 cost time: 0.6811423301696777
Epoch: 14, Steps: 10 | Train Loss: 0.742 Vali Loss: 3.081 Vali Acc: 0.236 Test Loss: 3.081 Test Acc: 0.236
Validation loss decreased (-0.222322 --> -0.236440).  Saving model ...
Epoch: 15 cost time: 0.6822316646575928
Epoch: 15, Steps: 10 | Train Loss: 0.597 Vali Loss: 3.078 Vali Acc: 0.238 Test Loss: 3.078 Test Acc: 0.238
Validation loss decreased (-0.236440 --> -0.237616).  Saving model ...
Epoch: 16 cost time: 0.736403226852417
Epoch: 16, Steps: 10 | Train Loss: 0.443 Vali Loss: 3.120 Vali Acc: 0.242 Test Loss: 3.120 Test Acc: 0.242
Validation loss decreased (-0.237616 --> -0.242322).  Saving model ...
Epoch: 17 cost time: 0.6573455333709717
Epoch: 17, Steps: 10 | Train Loss: 0.325 Vali Loss: 3.150 Vali Acc: 0.247 Test Loss: 3.150 Test Acc: 0.247
Validation loss decreased (-0.242322 --> -0.247027).  Saving model ...
Epoch: 18 cost time: 0.7876834869384766
Epoch: 18, Steps: 10 | Train Loss: 0.248 Vali Loss: 3.183 Vali Acc: 0.254 Test Loss: 3.183 Test Acc: 0.254
Validation loss decreased (-0.247027 --> -0.254086).  Saving model ...
Epoch: 19 cost time: 0.7433438301086426
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.235 Vali Acc: 0.256 Test Loss: 3.235 Test Acc: 0.256
Validation loss decreased (-0.254086 --> -0.256438).  Saving model ...
Epoch: 20 cost time: 0.7171239852905273
Epoch: 20, Steps: 10 | Train Loss: 0.138 Vali Loss: 3.281 Vali Acc: 0.258 Test Loss: 3.281 Test Acc: 0.258
Validation loss decreased (-0.256438 --> -0.257614).  Saving model ...
Epoch: 21 cost time: 0.7043232917785645
Epoch: 21, Steps: 10 | Train Loss: 0.114 Vali Loss: 3.305 Vali Acc: 0.254 Test Loss: 3.305 Test Acc: 0.254
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.664574146270752
Epoch: 22, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.305 Vali Acc: 0.268 Test Loss: 3.305 Test Acc: 0.268
Validation loss decreased (-0.257614 --> -0.268202).  Saving model ...
Epoch: 23 cost time: 0.5645320415496826
Epoch: 23, Steps: 10 | Train Loss: 0.075 Vali Loss: 3.339 Vali Acc: 0.269 Test Loss: 3.339 Test Acc: 0.269
Validation loss decreased (-0.268202 --> -0.269378).  Saving model ...
Epoch: 24 cost time: 0.686098575592041
Epoch: 24, Steps: 10 | Train Loss: 0.059 Vali Loss: 3.384 Vali Acc: 0.264 Test Loss: 3.384 Test Acc: 0.264
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7764809131622314
Epoch: 25, Steps: 10 | Train Loss: 0.055 Vali Loss: 3.423 Vali Acc: 0.264 Test Loss: 3.423 Test Acc: 0.264
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7526717185974121
Epoch: 26, Steps: 10 | Train Loss: 0.043 Vali Loss: 3.428 Vali Acc: 0.260 Test Loss: 3.428 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7253952026367188
Epoch: 27, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.451 Vali Acc: 0.261 Test Loss: 3.451 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7741494178771973
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.483 Vali Acc: 0.265 Test Loss: 3.483 Test Acc: 0.265
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7187778949737549
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.507 Vali Acc: 0.264 Test Loss: 3.507 Test Acc: 0.264
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7692139148712158
Epoch: 30, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.532 Vali Acc: 0.266 Test Loss: 3.532 Test Acc: 0.266
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6963138580322266
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.547 Vali Acc: 0.268 Test Loss: 3.547 Test Acc: 0.268
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.7747750282287598
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.568 Vali Acc: 0.268 Test Loss: 3.568 Test Acc: 0.268
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7252769470214844
Epoch: 33, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.580 Vali Acc: 0.266 Test Loss: 3.580 Test Acc: 0.266
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.26941176470588235
model parameter : 145814
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.5418753623962402
Epoch: 1, Steps: 10 | Train Loss: 3.344 Vali Loss: 3.333 Vali Acc: 0.047 Test Loss: 3.333 Test Acc: 0.047
Validation loss decreased (inf --> -0.047025).  Saving model ...
Epoch: 2 cost time: 0.7852699756622314
Epoch: 2, Steps: 10 | Train Loss: 3.150 Vali Loss: 3.301 Vali Acc: 0.060 Test Loss: 3.301 Test Acc: 0.060
Validation loss decreased (-0.047025 --> -0.059967).  Saving model ...
Epoch: 3 cost time: 0.7294754981994629
Epoch: 3, Steps: 10 | Train Loss: 2.913 Vali Loss: 3.279 Vali Acc: 0.078 Test Loss: 3.279 Test Acc: 0.078
Validation loss decreased (-0.059967 --> -0.077614).  Saving model ...
Epoch: 4 cost time: 0.758131742477417
Epoch: 4, Steps: 10 | Train Loss: 2.603 Vali Loss: 3.241 Vali Acc: 0.111 Test Loss: 3.241 Test Acc: 0.111
Validation loss decreased (-0.077614 --> -0.110556).  Saving model ...
Epoch: 5 cost time: 0.7741029262542725
Epoch: 5, Steps: 10 | Train Loss: 2.309 Vali Loss: 3.193 Vali Acc: 0.155 Test Loss: 3.193 Test Acc: 0.155
Validation loss decreased (-0.110556 --> -0.155262).  Saving model ...
Epoch: 6 cost time: 0.6954774856567383
Epoch: 6, Steps: 10 | Train Loss: 1.996 Vali Loss: 3.151 Vali Acc: 0.173 Test Loss: 3.151 Test Acc: 0.173
Validation loss decreased (-0.155262 --> -0.172910).  Saving model ...
Epoch: 7 cost time: 0.6238951683044434
Epoch: 7, Steps: 10 | Train Loss: 1.731 Vali Loss: 3.116 Vali Acc: 0.198 Test Loss: 3.116 Test Acc: 0.198
Validation loss decreased (-0.172910 --> -0.197616).  Saving model ...
Epoch: 8 cost time: 0.5586497783660889
Epoch: 8, Steps: 10 | Train Loss: 1.466 Vali Loss: 3.127 Vali Acc: 0.208 Test Loss: 3.127 Test Acc: 0.208
Validation loss decreased (-0.197616 --> -0.208204).  Saving model ...
Epoch: 9 cost time: 0.6509346961975098
Epoch: 9, Steps: 10 | Train Loss: 1.214 Vali Loss: 3.120 Vali Acc: 0.244 Test Loss: 3.120 Test Acc: 0.244
Validation loss decreased (-0.208204 --> -0.243498).  Saving model ...
Epoch: 10 cost time: 0.5972557067871094
Epoch: 10, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.103 Vali Acc: 0.251 Test Loss: 3.103 Test Acc: 0.251
Validation loss decreased (-0.243498 --> -0.250557).  Saving model ...
Epoch: 11 cost time: 0.683081865310669
Epoch: 11, Steps: 10 | Train Loss: 0.785 Vali Loss: 3.135 Vali Acc: 0.255 Test Loss: 3.135 Test Acc: 0.255
Validation loss decreased (-0.250557 --> -0.255263).  Saving model ...
Epoch: 12 cost time: 0.6215288639068604
Epoch: 12, Steps: 10 | Train Loss: 0.605 Vali Loss: 3.169 Vali Acc: 0.279 Test Loss: 3.169 Test Acc: 0.279
Validation loss decreased (-0.255263 --> -0.278792).  Saving model ...
Epoch: 13 cost time: 0.7421841621398926
Epoch: 13, Steps: 10 | Train Loss: 0.460 Vali Loss: 3.208 Vali Acc: 0.282 Test Loss: 3.208 Test Acc: 0.282
Validation loss decreased (-0.278792 --> -0.282321).  Saving model ...
Epoch: 14 cost time: 0.7343826293945312
Epoch: 14, Steps: 10 | Train Loss: 0.349 Vali Loss: 3.223 Vali Acc: 0.291 Test Loss: 3.223 Test Acc: 0.291
Validation loss decreased (-0.282321 --> -0.290556).  Saving model ...
Epoch: 15 cost time: 0.7485451698303223
Epoch: 15, Steps: 10 | Train Loss: 0.260 Vali Loss: 3.285 Vali Acc: 0.302 Test Loss: 3.285 Test Acc: 0.302
Validation loss decreased (-0.290556 --> -0.302320).  Saving model ...
Epoch: 16 cost time: 0.7063639163970947
Epoch: 16, Steps: 10 | Train Loss: 0.203 Vali Loss: 3.371 Vali Acc: 0.287 Test Loss: 3.371 Test Acc: 0.287
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.686514139175415
Epoch: 17, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.389 Vali Acc: 0.301 Test Loss: 3.389 Test Acc: 0.301
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.662238597869873
Epoch: 18, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.422 Vali Acc: 0.307 Test Loss: 3.422 Test Acc: 0.307
Validation loss decreased (-0.302320 --> -0.307025).  Saving model ...
Epoch: 19 cost time: 0.6746325492858887
Epoch: 19, Steps: 10 | Train Loss: 0.086 Vali Loss: 3.476 Vali Acc: 0.301 Test Loss: 3.476 Test Acc: 0.301
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6378121376037598
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.503 Vali Acc: 0.304 Test Loss: 3.503 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7049293518066406
Epoch: 21, Steps: 10 | Train Loss: 0.057 Vali Loss: 3.542 Vali Acc: 0.305 Test Loss: 3.542 Test Acc: 0.305
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7209317684173584
Epoch: 22, Steps: 10 | Train Loss: 0.052 Vali Loss: 3.580 Vali Acc: 0.305 Test Loss: 3.580 Test Acc: 0.305
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6986324787139893
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.604 Vali Acc: 0.312 Test Loss: 3.604 Test Acc: 0.312
Validation loss decreased (-0.307025 --> -0.311729).  Saving model ...
Epoch: 24 cost time: 0.7290458679199219
Epoch: 24, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.602 Vali Acc: 0.319 Test Loss: 3.602 Test Acc: 0.319
Validation loss decreased (-0.311729 --> -0.318788).  Saving model ...
Epoch: 25 cost time: 0.6484251022338867
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.630 Vali Acc: 0.315 Test Loss: 3.630 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.674436092376709
Epoch: 26, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.655 Vali Acc: 0.316 Test Loss: 3.655 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6580464839935303
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.688 Vali Acc: 0.315 Test Loss: 3.688 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.7619612216949463
Epoch: 28, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.714 Vali Acc: 0.313 Test Loss: 3.714 Test Acc: 0.313
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7134385108947754
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.736 Vali Acc: 0.309 Test Loss: 3.736 Test Acc: 0.309
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6667449474334717
Epoch: 30, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.755 Vali Acc: 0.316 Test Loss: 3.755 Test Acc: 0.316
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7691507339477539
Epoch: 31, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.755 Vali Acc: 0.320 Test Loss: 3.755 Test Acc: 0.320
Validation loss decreased (-0.318788 --> -0.319962).  Saving model ...
Epoch: 32 cost time: 0.7811076641082764
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.768 Vali Acc: 0.324 Test Loss: 3.768 Test Acc: 0.324
Validation loss decreased (-0.319962 --> -0.323492).  Saving model ...
Epoch: 33 cost time: 0.8343219757080078
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.792 Vali Acc: 0.322 Test Loss: 3.792 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.644432544708252
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.819 Vali Acc: 0.325 Test Loss: 3.819 Test Acc: 0.325
Validation loss decreased (-0.323492 --> -0.324668).  Saving model ...
Epoch: 35 cost time: 0.693875789642334
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.841 Vali Acc: 0.320 Test Loss: 3.841 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7419564723968506
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.850 Vali Acc: 0.322 Test Loss: 3.850 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6867341995239258
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.851 Vali Acc: 0.325 Test Loss: 3.851 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6792922019958496
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.859 Vali Acc: 0.328 Test Loss: 3.859 Test Acc: 0.328
Validation loss decreased (-0.324668 --> -0.328197).  Saving model ...
Epoch: 39 cost time: 0.5919740200042725
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.874 Vali Acc: 0.327 Test Loss: 3.874 Test Acc: 0.327
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.571507453918457
Epoch: 40, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.894 Vali Acc: 0.327 Test Loss: 3.894 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.664034366607666
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.915 Vali Acc: 0.325 Test Loss: 3.915 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.5975000858306885
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.927 Vali Acc: 0.326 Test Loss: 3.927 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.7317686080932617
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.934 Vali Acc: 0.329 Test Loss: 3.934 Test Acc: 0.329
Validation loss decreased (-0.328197 --> -0.329372).  Saving model ...
Epoch: 44 cost time: 0.7537381649017334
Epoch: 44, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.941 Vali Acc: 0.328 Test Loss: 3.941 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6687953472137451
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.953 Vali Acc: 0.326 Test Loss: 3.953 Test Acc: 0.326
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6904044151306152
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.971 Vali Acc: 0.325 Test Loss: 3.971 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.7275443077087402
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.990 Vali Acc: 0.319 Test Loss: 3.990 Test Acc: 0.319
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7303183078765869
Epoch: 48, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.000 Vali Acc: 0.322 Test Loss: 4.000 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.744783878326416
Epoch: 49, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.013 Vali Acc: 0.322 Test Loss: 4.013 Test Acc: 0.322
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.708777904510498
Epoch: 50, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.022 Vali Acc: 0.319 Test Loss: 4.022 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7284200191497803
Epoch: 51, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.032 Vali Acc: 0.320 Test Loss: 4.032 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6750049591064453
Epoch: 52, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.039 Vali Acc: 0.321 Test Loss: 4.039 Test Acc: 0.321
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6687901020050049
Epoch: 53, Steps: 10 | Train Loss: 0.005 Vali Loss: 4.045 Vali Acc: 0.321 Test Loss: 4.045 Test Acc: 0.321
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32941176470588235
model parameter : 137622
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.406179666519165
Epoch: 1, Steps: 10 | Train Loss: 3.342 Vali Loss: 3.341 Vali Acc: 0.033 Test Loss: 3.341 Test Acc: 0.033
Validation loss decreased (inf --> -0.032908).  Saving model ...
Epoch: 2 cost time: 0.7876443862915039
Epoch: 2, Steps: 10 | Train Loss: 3.155 Vali Loss: 3.311 Vali Acc: 0.048 Test Loss: 3.311 Test Acc: 0.048
Validation loss decreased (-0.032908 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.7152509689331055
Epoch: 3, Steps: 10 | Train Loss: 2.939 Vali Loss: 3.289 Vali Acc: 0.071 Test Loss: 3.289 Test Acc: 0.071
Validation loss decreased (-0.048202 --> -0.070555).  Saving model ...
Epoch: 4 cost time: 0.7657604217529297
Epoch: 4, Steps: 10 | Train Loss: 2.653 Vali Loss: 3.254 Vali Acc: 0.096 Test Loss: 3.254 Test Acc: 0.096
Validation loss decreased (-0.070555 --> -0.096438).  Saving model ...
Epoch: 5 cost time: 0.679743766784668
Epoch: 5, Steps: 10 | Train Loss: 2.362 Vali Loss: 3.208 Vali Acc: 0.138 Test Loss: 3.208 Test Acc: 0.138
Validation loss decreased (-0.096438 --> -0.137615).  Saving model ...
Epoch: 6 cost time: 0.6529936790466309
Epoch: 6, Steps: 10 | Train Loss: 2.071 Vali Loss: 3.164 Vali Acc: 0.171 Test Loss: 3.164 Test Acc: 0.171
Validation loss decreased (-0.137615 --> -0.170557).  Saving model ...
Epoch: 7 cost time: 0.7116236686706543
Epoch: 7, Steps: 10 | Train Loss: 1.802 Vali Loss: 3.121 Vali Acc: 0.196 Test Loss: 3.121 Test Acc: 0.196
Validation loss decreased (-0.170557 --> -0.196439).  Saving model ...
Epoch: 8 cost time: 0.7274024486541748
Epoch: 8, Steps: 10 | Train Loss: 1.527 Vali Loss: 3.124 Vali Acc: 0.202 Test Loss: 3.124 Test Acc: 0.202
Validation loss decreased (-0.196439 --> -0.202322).  Saving model ...
Epoch: 9 cost time: 0.617163896560669
Epoch: 9, Steps: 10 | Train Loss: 1.284 Vali Loss: 3.108 Vali Acc: 0.240 Test Loss: 3.108 Test Acc: 0.240
Validation loss decreased (-0.202322 --> -0.239969).  Saving model ...
Epoch: 10 cost time: 0.6353423595428467
Epoch: 10, Steps: 10 | Train Loss: 1.037 Vali Loss: 3.086 Vali Acc: 0.264 Test Loss: 3.086 Test Acc: 0.264
Validation loss decreased (-0.239969 --> -0.263499).  Saving model ...
Epoch: 11 cost time: 0.7687585353851318
Epoch: 11, Steps: 10 | Train Loss: 0.854 Vali Loss: 3.112 Vali Acc: 0.256 Test Loss: 3.112 Test Acc: 0.256
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8592727184295654
Epoch: 12, Steps: 10 | Train Loss: 0.640 Vali Loss: 3.137 Vali Acc: 0.279 Test Loss: 3.137 Test Acc: 0.279
Validation loss decreased (-0.263499 --> -0.278792).  Saving model ...
Epoch: 13 cost time: 0.8107666969299316
Epoch: 13, Steps: 10 | Train Loss: 0.492 Vali Loss: 3.167 Vali Acc: 0.284 Test Loss: 3.167 Test Acc: 0.284
Validation loss decreased (-0.278792 --> -0.283498).  Saving model ...
Epoch: 14 cost time: 0.8103036880493164
Epoch: 14, Steps: 10 | Train Loss: 0.377 Vali Loss: 3.181 Vali Acc: 0.286 Test Loss: 3.181 Test Acc: 0.286
Validation loss decreased (-0.283498 --> -0.285851).  Saving model ...
Epoch: 15 cost time: 0.733034610748291
Epoch: 15, Steps: 10 | Train Loss: 0.267 Vali Loss: 3.247 Vali Acc: 0.291 Test Loss: 3.247 Test Acc: 0.291
Validation loss decreased (-0.285851 --> -0.290556).  Saving model ...
Epoch: 16 cost time: 0.8277182579040527
Epoch: 16, Steps: 10 | Train Loss: 0.215 Vali Loss: 3.308 Vali Acc: 0.292 Test Loss: 3.308 Test Acc: 0.292
Validation loss decreased (-0.290556 --> -0.291732).  Saving model ...
Epoch: 17 cost time: 0.7154390811920166
Epoch: 17, Steps: 10 | Train Loss: 0.159 Vali Loss: 3.337 Vali Acc: 0.306 Test Loss: 3.337 Test Acc: 0.306
Validation loss decreased (-0.291732 --> -0.305849).  Saving model ...
Epoch: 18 cost time: 0.7516434192657471
Epoch: 18, Steps: 10 | Train Loss: 0.120 Vali Loss: 3.366 Vali Acc: 0.309 Test Loss: 3.366 Test Acc: 0.309
Validation loss decreased (-0.305849 --> -0.309378).  Saving model ...
Epoch: 19 cost time: 0.7159454822540283
Epoch: 19, Steps: 10 | Train Loss: 0.090 Vali Loss: 3.418 Vali Acc: 0.308 Test Loss: 3.418 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.719719409942627
Epoch: 20, Steps: 10 | Train Loss: 0.071 Vali Loss: 3.449 Vali Acc: 0.313 Test Loss: 3.449 Test Acc: 0.313
Validation loss decreased (-0.309378 --> -0.312907).  Saving model ...
Epoch: 21 cost time: 0.6898500919342041
Epoch: 21, Steps: 10 | Train Loss: 0.066 Vali Loss: 3.479 Vali Acc: 0.315 Test Loss: 3.479 Test Acc: 0.315
Validation loss decreased (-0.312907 --> -0.315259).  Saving model ...
Epoch: 22 cost time: 0.6522395610809326
Epoch: 22, Steps: 10 | Train Loss: 0.054 Vali Loss: 3.514 Vali Acc: 0.315 Test Loss: 3.514 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7586061954498291
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.552 Vali Acc: 0.315 Test Loss: 3.552 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.7963035106658936
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.542 Vali Acc: 0.315 Test Loss: 3.542 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8424322605133057
Epoch: 25, Steps: 10 | Train Loss: 0.032 Vali Loss: 3.559 Vali Acc: 0.314 Test Loss: 3.559 Test Acc: 0.314
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7362096309661865
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.579 Vali Acc: 0.325 Test Loss: 3.579 Test Acc: 0.325
Validation loss decreased (-0.315259 --> -0.324670).  Saving model ...
Epoch: 27 cost time: 0.857856035232544
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.617 Vali Acc: 0.328 Test Loss: 3.617 Test Acc: 0.328
Validation loss decreased (-0.324670 --> -0.328199).  Saving model ...
Epoch: 28 cost time: 0.7724535465240479
Epoch: 28, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.622 Vali Acc: 0.325 Test Loss: 3.622 Test Acc: 0.325
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.8207089900970459
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.635 Vali Acc: 0.328 Test Loss: 3.635 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6711025238037109
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.651 Vali Acc: 0.327 Test Loss: 3.651 Test Acc: 0.327
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.7446513175964355
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.657 Vali Acc: 0.331 Test Loss: 3.657 Test Acc: 0.331
Validation loss decreased (-0.328199 --> -0.330552).  Saving model ...
Epoch: 32 cost time: 0.6265106201171875
Epoch: 32, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.669 Vali Acc: 0.328 Test Loss: 3.669 Test Acc: 0.328
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6737632751464844
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.689 Vali Acc: 0.328 Test Loss: 3.689 Test Acc: 0.328
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6629848480224609
Epoch: 34, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.715 Vali Acc: 0.326 Test Loss: 3.715 Test Acc: 0.326
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7533020973205566
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.732 Vali Acc: 0.331 Test Loss: 3.732 Test Acc: 0.331
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.7845242023468018
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.743 Vali Acc: 0.332 Test Loss: 3.743 Test Acc: 0.332
Validation loss decreased (-0.330552 --> -0.331727).  Saving model ...
Epoch: 37 cost time: 0.7370638847351074
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.748 Vali Acc: 0.326 Test Loss: 3.748 Test Acc: 0.326
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7281327247619629
Epoch: 38, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.759 Vali Acc: 0.327 Test Loss: 3.759 Test Acc: 0.327
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6990554332733154
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.772 Vali Acc: 0.322 Test Loss: 3.772 Test Acc: 0.322
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7687296867370605
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.795 Vali Acc: 0.326 Test Loss: 3.795 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.8135621547698975
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.823 Vali Acc: 0.322 Test Loss: 3.823 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.697321891784668
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.832 Vali Acc: 0.329 Test Loss: 3.832 Test Acc: 0.329
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7442042827606201
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.835 Vali Acc: 0.326 Test Loss: 3.835 Test Acc: 0.326
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7447800636291504
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.838 Vali Acc: 0.325 Test Loss: 3.838 Test Acc: 0.325
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7783770561218262
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.843 Vali Acc: 0.327 Test Loss: 3.843 Test Acc: 0.327
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6432156562805176
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.853 Vali Acc: 0.320 Test Loss: 3.853 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.33176470588235296
model parameter : 137622
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2239253520965576
Epoch: 1, Steps: 10 | Train Loss: 3.335 Vali Loss: 3.321 Vali Acc: 0.032 Test Loss: 3.321 Test Acc: 0.032
Validation loss decreased (inf --> -0.031731).  Saving model ...
Epoch: 2 cost time: 0.6820101737976074
Epoch: 2, Steps: 10 | Train Loss: 3.154 Vali Loss: 3.295 Vali Acc: 0.048 Test Loss: 3.295 Test Acc: 0.048
Validation loss decreased (-0.031731 --> -0.048202).  Saving model ...
Epoch: 3 cost time: 0.691286563873291
Epoch: 3, Steps: 10 | Train Loss: 2.984 Vali Loss: 3.276 Vali Acc: 0.064 Test Loss: 3.276 Test Acc: 0.064
Validation loss decreased (-0.048202 --> -0.063497).  Saving model ...
Epoch: 4 cost time: 0.5752308368682861
Epoch: 4, Steps: 10 | Train Loss: 2.715 Vali Loss: 3.248 Vali Acc: 0.084 Test Loss: 3.248 Test Acc: 0.084
Validation loss decreased (-0.063497 --> -0.083497).  Saving model ...
Epoch: 5 cost time: 0.6042141914367676
Epoch: 5, Steps: 10 | Train Loss: 2.453 Vali Loss: 3.208 Vali Acc: 0.133 Test Loss: 3.208 Test Acc: 0.133
Validation loss decreased (-0.083497 --> -0.132909).  Saving model ...
Epoch: 6 cost time: 0.5639171600341797
Epoch: 6, Steps: 10 | Train Loss: 2.196 Vali Loss: 3.163 Vali Acc: 0.169 Test Loss: 3.163 Test Acc: 0.169
Validation loss decreased (-0.132909 --> -0.169380).  Saving model ...
Epoch: 7 cost time: 0.6316416263580322
Epoch: 7, Steps: 10 | Train Loss: 1.932 Vali Loss: 3.119 Vali Acc: 0.179 Test Loss: 3.119 Test Acc: 0.179
Validation loss decreased (-0.169380 --> -0.178792).  Saving model ...
Epoch: 8 cost time: 0.6185033321380615
Epoch: 8, Steps: 10 | Train Loss: 1.650 Vali Loss: 3.113 Vali Acc: 0.193 Test Loss: 3.113 Test Acc: 0.193
Validation loss decreased (-0.178792 --> -0.192910).  Saving model ...
Epoch: 9 cost time: 0.5570809841156006
Epoch: 9, Steps: 10 | Train Loss: 1.403 Vali Loss: 3.092 Vali Acc: 0.211 Test Loss: 3.092 Test Acc: 0.211
Validation loss decreased (-0.192910 --> -0.210557).  Saving model ...
Epoch: 10 cost time: 0.6504707336425781
Epoch: 10, Steps: 10 | Train Loss: 1.165 Vali Loss: 3.066 Vali Acc: 0.236 Test Loss: 3.066 Test Acc: 0.236
Validation loss decreased (-0.210557 --> -0.236440).  Saving model ...
Epoch: 11 cost time: 0.6313247680664062
Epoch: 11, Steps: 10 | Train Loss: 0.982 Vali Loss: 3.078 Vali Acc: 0.234 Test Loss: 3.078 Test Acc: 0.234
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7480273246765137
Epoch: 12, Steps: 10 | Train Loss: 0.770 Vali Loss: 3.093 Vali Acc: 0.247 Test Loss: 3.093 Test Acc: 0.247
Validation loss decreased (-0.236440 --> -0.247028).  Saving model ...
Epoch: 13 cost time: 0.619459867477417
Epoch: 13, Steps: 10 | Train Loss: 0.600 Vali Loss: 3.120 Vali Acc: 0.252 Test Loss: 3.120 Test Acc: 0.252
Validation loss decreased (-0.247028 --> -0.251734).  Saving model ...
Epoch: 14 cost time: 0.6927785873413086
Epoch: 14, Steps: 10 | Train Loss: 0.464 Vali Loss: 3.138 Vali Acc: 0.267 Test Loss: 3.138 Test Acc: 0.267
Validation loss decreased (-0.251734 --> -0.267027).  Saving model ...
Epoch: 15 cost time: 0.6442708969116211
Epoch: 15, Steps: 10 | Train Loss: 0.345 Vali Loss: 3.194 Vali Acc: 0.267 Test Loss: 3.194 Test Acc: 0.267
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6509387493133545
Epoch: 16, Steps: 10 | Train Loss: 0.271 Vali Loss: 3.252 Vali Acc: 0.269 Test Loss: 3.252 Test Acc: 0.269
Validation loss decreased (-0.267027 --> -0.269379).  Saving model ...
Epoch: 17 cost time: 0.7061886787414551
Epoch: 17, Steps: 10 | Train Loss: 0.194 Vali Loss: 3.272 Vali Acc: 0.274 Test Loss: 3.272 Test Acc: 0.274
Validation loss decreased (-0.269379 --> -0.274085).  Saving model ...
Epoch: 18 cost time: 0.6184933185577393
Epoch: 18, Steps: 10 | Train Loss: 0.147 Vali Loss: 3.298 Vali Acc: 0.296 Test Loss: 3.298 Test Acc: 0.296
Validation loss decreased (-0.274085 --> -0.296438).  Saving model ...
Epoch: 19 cost time: 0.600980281829834
Epoch: 19, Steps: 10 | Train Loss: 0.110 Vali Loss: 3.359 Vali Acc: 0.280 Test Loss: 3.359 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6371781826019287
Epoch: 20, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.399 Vali Acc: 0.281 Test Loss: 3.399 Test Acc: 0.281
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6961088180541992
Epoch: 21, Steps: 10 | Train Loss: 0.077 Vali Loss: 3.433 Vali Acc: 0.285 Test Loss: 3.433 Test Acc: 0.285
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5625996589660645
Epoch: 22, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.459 Vali Acc: 0.282 Test Loss: 3.459 Test Acc: 0.282
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.6488051414489746
Epoch: 23, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.479 Vali Acc: 0.288 Test Loss: 3.479 Test Acc: 0.288
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.6590800285339355
Epoch: 24, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.471 Vali Acc: 0.291 Test Loss: 3.471 Test Acc: 0.291
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.658642053604126
Epoch: 25, Steps: 10 | Train Loss: 0.038 Vali Loss: 3.486 Vali Acc: 0.293 Test Loss: 3.486 Test Acc: 0.293
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.6577651500701904
Epoch: 26, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.504 Vali Acc: 0.298 Test Loss: 3.504 Test Acc: 0.298
Validation loss decreased (-0.296438 --> -0.297612).  Saving model ...
Epoch: 27 cost time: 0.7055811882019043
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.535 Vali Acc: 0.293 Test Loss: 3.535 Test Acc: 0.293
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7024011611938477
Epoch: 28, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.562 Vali Acc: 0.287 Test Loss: 3.562 Test Acc: 0.287
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6292355060577393
Epoch: 29, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.583 Vali Acc: 0.288 Test Loss: 3.583 Test Acc: 0.288
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7177679538726807
Epoch: 30, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.594 Vali Acc: 0.289 Test Loss: 3.594 Test Acc: 0.289
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.643754243850708
Epoch: 31, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.603 Vali Acc: 0.292 Test Loss: 3.603 Test Acc: 0.292
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6195523738861084
Epoch: 32, Steps: 10 | Train Loss: 0.017 Vali Loss: 3.614 Vali Acc: 0.289 Test Loss: 3.614 Test Acc: 0.289
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6632745265960693
Epoch: 33, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.631 Vali Acc: 0.291 Test Loss: 3.631 Test Acc: 0.291
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7249619960784912
Epoch: 34, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.654 Vali Acc: 0.293 Test Loss: 3.654 Test Acc: 0.293
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.6924829483032227
Epoch: 35, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.672 Vali Acc: 0.291 Test Loss: 3.672 Test Acc: 0.291
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.7595524787902832
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.681 Vali Acc: 0.294 Test Loss: 3.681 Test Acc: 0.294
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.29764705882352943
model parameter : 137622
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2815613746643066
Epoch: 1, Steps: 10 | Train Loss: 3.310 Vali Loss: 3.279 Vali Acc: 0.036 Test Loss: 3.279 Test Acc: 0.036
Validation loss decreased (inf --> -0.036438).  Saving model ...
Epoch: 2 cost time: 0.7039449214935303
Epoch: 2, Steps: 10 | Train Loss: 3.195 Vali Loss: 3.261 Vali Acc: 0.044 Test Loss: 3.261 Test Acc: 0.044
Validation loss decreased (-0.036438 --> -0.043497).  Saving model ...
Epoch: 3 cost time: 0.6484355926513672
Epoch: 3, Steps: 10 | Train Loss: 3.030 Vali Loss: 3.249 Vali Acc: 0.061 Test Loss: 3.249 Test Acc: 0.061
Validation loss decreased (-0.043497 --> -0.061144).  Saving model ...
Epoch: 4 cost time: 0.6367588043212891
Epoch: 4, Steps: 10 | Train Loss: 2.835 Vali Loss: 3.231 Vali Acc: 0.072 Test Loss: 3.231 Test Acc: 0.072
Validation loss decreased (-0.061144 --> -0.071732).  Saving model ...
Epoch: 5 cost time: 0.6560487747192383
Epoch: 5, Steps: 10 | Train Loss: 2.640 Vali Loss: 3.207 Vali Acc: 0.111 Test Loss: 3.207 Test Acc: 0.111
Validation loss decreased (-0.071732 --> -0.110556).  Saving model ...
Epoch: 6 cost time: 0.6149446964263916
Epoch: 6, Steps: 10 | Train Loss: 2.468 Vali Loss: 3.172 Vali Acc: 0.138 Test Loss: 3.172 Test Acc: 0.138
Validation loss decreased (-0.110556 --> -0.137615).  Saving model ...
Epoch: 7 cost time: 0.5992884635925293
Epoch: 7, Steps: 10 | Train Loss: 2.253 Vali Loss: 3.129 Vali Acc: 0.161 Test Loss: 3.129 Test Acc: 0.161
Validation loss decreased (-0.137615 --> -0.161145).  Saving model ...
Epoch: 8 cost time: 0.6103601455688477
Epoch: 8, Steps: 10 | Train Loss: 2.006 Vali Loss: 3.111 Vali Acc: 0.160 Test Loss: 3.111 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5445725917816162
Epoch: 9, Steps: 10 | Train Loss: 1.768 Vali Loss: 3.081 Vali Acc: 0.175 Test Loss: 3.081 Test Acc: 0.175
Validation loss decreased (-0.161145 --> -0.175263).  Saving model ...
Epoch: 10 cost time: 0.6712074279785156
Epoch: 10, Steps: 10 | Train Loss: 1.552 Vali Loss: 3.051 Vali Acc: 0.198 Test Loss: 3.051 Test Acc: 0.198
Validation loss decreased (-0.175263 --> -0.197617).  Saving model ...
Epoch: 11 cost time: 0.6473259925842285
Epoch: 11, Steps: 10 | Train Loss: 1.378 Vali Loss: 3.046 Vali Acc: 0.204 Test Loss: 3.046 Test Acc: 0.204
Validation loss decreased (-0.197617 --> -0.203499).  Saving model ...
Epoch: 12 cost time: 0.7260499000549316
Epoch: 12, Steps: 10 | Train Loss: 1.136 Vali Loss: 3.054 Vali Acc: 0.202 Test Loss: 3.054 Test Acc: 0.202
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7207913398742676
Epoch: 13, Steps: 10 | Train Loss: 0.921 Vali Loss: 3.065 Vali Acc: 0.212 Test Loss: 3.065 Test Acc: 0.212
Validation loss decreased (-0.203499 --> -0.211734).  Saving model ...
Epoch: 14 cost time: 0.6624987125396729
Epoch: 14, Steps: 10 | Train Loss: 0.759 Vali Loss: 3.058 Vali Acc: 0.226 Test Loss: 3.058 Test Acc: 0.226
Validation loss decreased (-0.211734 --> -0.225852).  Saving model ...
Epoch: 15 cost time: 0.637216329574585
Epoch: 15, Steps: 10 | Train Loss: 0.617 Vali Loss: 3.095 Vali Acc: 0.239 Test Loss: 3.095 Test Acc: 0.239
Validation loss decreased (-0.225852 --> -0.238793).  Saving model ...
Epoch: 16 cost time: 0.5900712013244629
Epoch: 16, Steps: 10 | Train Loss: 0.471 Vali Loss: 3.123 Vali Acc: 0.239 Test Loss: 3.123 Test Acc: 0.239
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5695598125457764
Epoch: 17, Steps: 10 | Train Loss: 0.350 Vali Loss: 3.153 Vali Acc: 0.251 Test Loss: 3.153 Test Acc: 0.251
Validation loss decreased (-0.238793 --> -0.250557).  Saving model ...
Epoch: 18 cost time: 0.6088175773620605
Epoch: 18, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.176 Vali Acc: 0.261 Test Loss: 3.176 Test Acc: 0.261
Validation loss decreased (-0.250557 --> -0.261145).  Saving model ...
Epoch: 19 cost time: 0.5276100635528564
Epoch: 19, Steps: 10 | Train Loss: 0.182 Vali Loss: 3.240 Vali Acc: 0.253 Test Loss: 3.240 Test Acc: 0.253
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5915508270263672
Epoch: 20, Steps: 10 | Train Loss: 0.143 Vali Loss: 3.280 Vali Acc: 0.253 Test Loss: 3.280 Test Acc: 0.253
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6091830730438232
Epoch: 21, Steps: 10 | Train Loss: 0.117 Vali Loss: 3.329 Vali Acc: 0.246 Test Loss: 3.329 Test Acc: 0.246
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.551145076751709
Epoch: 22, Steps: 10 | Train Loss: 0.094 Vali Loss: 3.347 Vali Acc: 0.251 Test Loss: 3.347 Test Acc: 0.251
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.789226770401001
Epoch: 23, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.378 Vali Acc: 0.256 Test Loss: 3.378 Test Acc: 0.256
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.699303388595581
Epoch: 24, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.389 Vali Acc: 0.265 Test Loss: 3.389 Test Acc: 0.265
Validation loss decreased (-0.261145 --> -0.264672).  Saving model ...
Epoch: 25 cost time: 0.7379021644592285
Epoch: 25, Steps: 10 | Train Loss: 0.047 Vali Loss: 3.421 Vali Acc: 0.259 Test Loss: 3.421 Test Acc: 0.259
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6728224754333496
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.447 Vali Acc: 0.256 Test Loss: 3.447 Test Acc: 0.256
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7138826847076416
Epoch: 27, Steps: 10 | Train Loss: 0.039 Vali Loss: 3.475 Vali Acc: 0.256 Test Loss: 3.475 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6619746685028076
Epoch: 28, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.494 Vali Acc: 0.261 Test Loss: 3.494 Test Acc: 0.261
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7207324504852295
Epoch: 29, Steps: 10 | Train Loss: 0.029 Vali Loss: 3.515 Vali Acc: 0.268 Test Loss: 3.515 Test Acc: 0.268
Validation loss decreased (-0.264672 --> -0.268200).  Saving model ...
Epoch: 30 cost time: 0.7524442672729492
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.535 Vali Acc: 0.266 Test Loss: 3.535 Test Acc: 0.266
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6415729522705078
Epoch: 31, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.561 Vali Acc: 0.261 Test Loss: 3.561 Test Acc: 0.261
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6487107276916504
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.578 Vali Acc: 0.256 Test Loss: 3.578 Test Acc: 0.256
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6787681579589844
Epoch: 33, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.603 Vali Acc: 0.262 Test Loss: 3.603 Test Acc: 0.262
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.6486642360687256
Epoch: 34, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.631 Vali Acc: 0.268 Test Loss: 3.631 Test Acc: 0.268
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6348223686218262
Epoch: 35, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.658 Vali Acc: 0.268 Test Loss: 3.658 Test Acc: 0.268
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.629148006439209
Epoch: 36, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.658 Vali Acc: 0.272 Test Loss: 3.658 Test Acc: 0.272
Validation loss decreased (-0.268200 --> -0.271728).  Saving model ...
Epoch: 37 cost time: 0.7231159210205078
Epoch: 37, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.664 Vali Acc: 0.272 Test Loss: 3.664 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6980874538421631
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.675 Vali Acc: 0.273 Test Loss: 3.675 Test Acc: 0.273
Validation loss decreased (-0.271728 --> -0.272904).  Saving model ...
Epoch: 39 cost time: 0.6791980266571045
Epoch: 39, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.686 Vali Acc: 0.273 Test Loss: 3.686 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7189507484436035
Epoch: 40, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.714 Vali Acc: 0.272 Test Loss: 3.714 Test Acc: 0.272
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6541476249694824
Epoch: 41, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.732 Vali Acc: 0.268 Test Loss: 3.732 Test Acc: 0.268
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.7346901893615723
Epoch: 42, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.737 Vali Acc: 0.271 Test Loss: 3.737 Test Acc: 0.271
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.673591136932373
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.751 Vali Acc: 0.273 Test Loss: 3.751 Test Acc: 0.273
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.6383457183837891
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.760 Vali Acc: 0.272 Test Loss: 3.760 Test Acc: 0.272
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.6098983287811279
Epoch: 45, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.766 Vali Acc: 0.269 Test Loss: 3.766 Test Acc: 0.269
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.6515529155731201
Epoch: 46, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.778 Vali Acc: 0.271 Test Loss: 3.778 Test Acc: 0.271
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.5740070343017578
Epoch: 47, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.798 Vali Acc: 0.271 Test Loss: 3.798 Test Acc: 0.271
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.6249945163726807
Epoch: 48, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.826 Vali Acc: 0.272 Test Loss: 3.826 Test Acc: 0.272
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.27294117647058824
model parameter : 137622
model size : 1.15MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.2019731998443604
Epoch: 1, Steps: 10 | Train Loss: 3.374 Vali Loss: 3.320 Vali Acc: 0.047 Test Loss: 3.320 Test Acc: 0.047
Validation loss decreased (inf --> -0.047026).  Saving model ...
Epoch: 2 cost time: 0.6606771945953369
Epoch: 2, Steps: 10 | Train Loss: 3.238 Vali Loss: 3.285 Vali Acc: 0.079 Test Loss: 3.285 Test Acc: 0.079
Validation loss decreased (-0.047026 --> -0.078791).  Saving model ...
Epoch: 3 cost time: 0.7019944190979004
Epoch: 3, Steps: 10 | Train Loss: 2.963 Vali Loss: 3.270 Vali Acc: 0.104 Test Loss: 3.270 Test Acc: 0.104
Validation loss decreased (-0.078791 --> -0.103497).  Saving model ...
Epoch: 4 cost time: 0.6627483367919922
Epoch: 4, Steps: 10 | Train Loss: 2.672 Vali Loss: 3.248 Vali Acc: 0.134 Test Loss: 3.248 Test Acc: 0.134
Validation loss decreased (-0.103497 --> -0.134085).  Saving model ...
Epoch: 5 cost time: 0.6239314079284668
Epoch: 5, Steps: 10 | Train Loss: 2.384 Vali Loss: 3.196 Vali Acc: 0.155 Test Loss: 3.196 Test Acc: 0.155
Validation loss decreased (-0.134085 --> -0.155262).  Saving model ...
Epoch: 6 cost time: 0.5601663589477539
Epoch: 6, Steps: 10 | Train Loss: 2.086 Vali Loss: 3.149 Vali Acc: 0.181 Test Loss: 3.149 Test Acc: 0.181
Validation loss decreased (-0.155262 --> -0.181145).  Saving model ...
Epoch: 7 cost time: 0.6550512313842773
Epoch: 7, Steps: 10 | Train Loss: 1.767 Vali Loss: 3.103 Vali Acc: 0.202 Test Loss: 3.103 Test Acc: 0.202
Validation loss decreased (-0.181145 --> -0.202322).  Saving model ...
Epoch: 8 cost time: 0.6545031070709229
Epoch: 8, Steps: 10 | Train Loss: 1.484 Vali Loss: 3.102 Vali Acc: 0.211 Test Loss: 3.102 Test Acc: 0.211
Validation loss decreased (-0.202322 --> -0.210557).  Saving model ...
Epoch: 9 cost time: 0.6745753288269043
Epoch: 9, Steps: 10 | Train Loss: 1.227 Vali Loss: 3.098 Vali Acc: 0.239 Test Loss: 3.098 Test Acc: 0.239
Validation loss decreased (-0.210557 --> -0.238793).  Saving model ...
Epoch: 10 cost time: 0.7715575695037842
Epoch: 10, Steps: 10 | Train Loss: 1.006 Vali Loss: 3.101 Vali Acc: 0.255 Test Loss: 3.101 Test Acc: 0.255
Validation loss decreased (-0.238793 --> -0.255263).  Saving model ...
Epoch: 11 cost time: 0.8074288368225098
Epoch: 11, Steps: 10 | Train Loss: 0.815 Vali Loss: 3.103 Vali Acc: 0.264 Test Loss: 3.103 Test Acc: 0.264
Validation loss decreased (-0.255263 --> -0.263498).  Saving model ...
Epoch: 12 cost time: 0.7364542484283447
Epoch: 12, Steps: 10 | Train Loss: 0.609 Vali Loss: 3.136 Vali Acc: 0.274 Test Loss: 3.136 Test Acc: 0.274
Validation loss decreased (-0.263498 --> -0.274086).  Saving model ...
Epoch: 13 cost time: 0.6739163398742676
Epoch: 13, Steps: 10 | Train Loss: 0.495 Vali Loss: 3.169 Vali Acc: 0.285 Test Loss: 3.169 Test Acc: 0.285
Validation loss decreased (-0.274086 --> -0.284674).  Saving model ...
Epoch: 14 cost time: 0.746769905090332
Epoch: 14, Steps: 10 | Train Loss: 0.356 Vali Loss: 3.226 Vali Acc: 0.289 Test Loss: 3.226 Test Acc: 0.289
Validation loss decreased (-0.284674 --> -0.289380).  Saving model ...
Epoch: 15 cost time: 0.7406771183013916
Epoch: 15, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.265 Vali Acc: 0.304 Test Loss: 3.265 Test Acc: 0.304
Validation loss decreased (-0.289380 --> -0.303497).  Saving model ...
Epoch: 16 cost time: 0.7205252647399902
Epoch: 16, Steps: 10 | Train Loss: 0.202 Vali Loss: 3.304 Vali Acc: 0.311 Test Loss: 3.304 Test Acc: 0.311
Validation loss decreased (-0.303497 --> -0.310555).  Saving model ...
Epoch: 17 cost time: 0.8422706127166748
Epoch: 17, Steps: 10 | Train Loss: 0.149 Vali Loss: 3.362 Vali Acc: 0.308 Test Loss: 3.362 Test Acc: 0.308
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.753920316696167
Epoch: 18, Steps: 10 | Train Loss: 0.119 Vali Loss: 3.393 Vali Acc: 0.302 Test Loss: 3.393 Test Acc: 0.302
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7058389186859131
Epoch: 19, Steps: 10 | Train Loss: 0.087 Vali Loss: 3.447 Vali Acc: 0.312 Test Loss: 3.447 Test Acc: 0.312
Validation loss decreased (-0.310555 --> -0.311730).  Saving model ...
Epoch: 20 cost time: 0.6689341068267822
Epoch: 20, Steps: 10 | Train Loss: 0.068 Vali Loss: 3.483 Vali Acc: 0.307 Test Loss: 3.483 Test Acc: 0.307
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6412677764892578
Epoch: 21, Steps: 10 | Train Loss: 0.065 Vali Loss: 3.500 Vali Acc: 0.313 Test Loss: 3.500 Test Acc: 0.313
Validation loss decreased (-0.311730 --> -0.312906).  Saving model ...
Epoch: 22 cost time: 0.6802473068237305
Epoch: 22, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.531 Vali Acc: 0.314 Test Loss: 3.531 Test Acc: 0.314
Validation loss decreased (-0.312906 --> -0.314082).  Saving model ...
Epoch: 23 cost time: 0.6760752201080322
Epoch: 23, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.563 Vali Acc: 0.313 Test Loss: 3.563 Test Acc: 0.313
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7164158821105957
Epoch: 24, Steps: 10 | Train Loss: 0.040 Vali Loss: 3.594 Vali Acc: 0.315 Test Loss: 3.594 Test Acc: 0.315
Validation loss decreased (-0.314082 --> -0.315258).  Saving model ...
Epoch: 25 cost time: 0.870464563369751
Epoch: 25, Steps: 10 | Train Loss: 0.033 Vali Loss: 3.623 Vali Acc: 0.315 Test Loss: 3.623 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8763480186462402
Epoch: 26, Steps: 10 | Train Loss: 0.030 Vali Loss: 3.658 Vali Acc: 0.319 Test Loss: 3.658 Test Acc: 0.319
Validation loss decreased (-0.315258 --> -0.318787).  Saving model ...
Epoch: 27 cost time: 0.8233048915863037
Epoch: 27, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.669 Vali Acc: 0.320 Test Loss: 3.669 Test Acc: 0.320
Validation loss decreased (-0.318787 --> -0.319963).  Saving model ...
Epoch: 28 cost time: 0.675910234451294
Epoch: 28, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.675 Vali Acc: 0.325 Test Loss: 3.675 Test Acc: 0.325
Validation loss decreased (-0.319963 --> -0.324669).  Saving model ...
Epoch: 29 cost time: 0.7783505916595459
Epoch: 29, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.690 Vali Acc: 0.319 Test Loss: 3.690 Test Acc: 0.319
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.793982744216919
Epoch: 30, Steps: 10 | Train Loss: 0.019 Vali Loss: 3.714 Vali Acc: 0.322 Test Loss: 3.714 Test Acc: 0.322
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6822447776794434
Epoch: 31, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.730 Vali Acc: 0.320 Test Loss: 3.730 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.650280237197876
Epoch: 32, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.740 Vali Acc: 0.324 Test Loss: 3.740 Test Acc: 0.324
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.69205641746521
Epoch: 33, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.759 Vali Acc: 0.325 Test Loss: 3.759 Test Acc: 0.325
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7099847793579102
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.779 Vali Acc: 0.326 Test Loss: 3.779 Test Acc: 0.326
Validation loss decreased (-0.324669 --> -0.325845).  Saving model ...
Epoch: 35 cost time: 0.7837181091308594
Epoch: 35, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.795 Vali Acc: 0.322 Test Loss: 3.795 Test Acc: 0.322
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.8910477161407471
Epoch: 36, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.812 Vali Acc: 0.324 Test Loss: 3.812 Test Acc: 0.324
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.7763304710388184
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.826 Vali Acc: 0.325 Test Loss: 3.826 Test Acc: 0.325
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.8750460147857666
Epoch: 38, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.841 Vali Acc: 0.326 Test Loss: 3.841 Test Acc: 0.326
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.7986125946044922
Epoch: 39, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.856 Vali Acc: 0.322 Test Loss: 3.856 Test Acc: 0.322
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.8830904960632324
Epoch: 40, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.869 Vali Acc: 0.324 Test Loss: 3.869 Test Acc: 0.324
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.8348312377929688
Epoch: 41, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.889 Vali Acc: 0.319 Test Loss: 3.889 Test Acc: 0.319
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.8664250373840332
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.907 Vali Acc: 0.322 Test Loss: 3.907 Test Acc: 0.322
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.7553853988647461
Epoch: 43, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.920 Vali Acc: 0.322 Test Loss: 3.920 Test Acc: 0.322
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.8278107643127441
Epoch: 44, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.934 Vali Acc: 0.319 Test Loss: 3.934 Test Acc: 0.319
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32588235294117646
model parameter : 133526
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.757779359817505
Epoch: 1, Steps: 10 | Train Loss: 3.351 Vali Loss: 3.301 Vali Acc: 0.059 Test Loss: 3.301 Test Acc: 0.059
Validation loss decreased (inf --> -0.058791).  Saving model ...
Epoch: 2 cost time: 0.7390668392181396
Epoch: 2, Steps: 10 | Train Loss: 3.201 Vali Loss: 3.270 Vali Acc: 0.094 Test Loss: 3.270 Test Acc: 0.094
Validation loss decreased (-0.058791 --> -0.094085).  Saving model ...
Epoch: 3 cost time: 0.7618749141693115
Epoch: 3, Steps: 10 | Train Loss: 2.971 Vali Loss: 3.258 Vali Acc: 0.108 Test Loss: 3.258 Test Acc: 0.108
Validation loss decreased (-0.094085 --> -0.108203).  Saving model ...
Epoch: 4 cost time: 0.7551462650299072
Epoch: 4, Steps: 10 | Train Loss: 2.689 Vali Loss: 3.238 Vali Acc: 0.135 Test Loss: 3.238 Test Acc: 0.135
Validation loss decreased (-0.108203 --> -0.135262).  Saving model ...
Epoch: 5 cost time: 0.7357087135314941
Epoch: 5, Steps: 10 | Train Loss: 2.429 Vali Loss: 3.187 Vali Acc: 0.155 Test Loss: 3.187 Test Acc: 0.155
Validation loss decreased (-0.135262 --> -0.155262).  Saving model ...
Epoch: 6 cost time: 0.7605655193328857
Epoch: 6, Steps: 10 | Train Loss: 2.111 Vali Loss: 3.141 Vali Acc: 0.179 Test Loss: 3.141 Test Acc: 0.179
Validation loss decreased (-0.155262 --> -0.178792).  Saving model ...
Epoch: 7 cost time: 0.6607809066772461
Epoch: 7, Steps: 10 | Train Loss: 1.805 Vali Loss: 3.092 Vali Acc: 0.211 Test Loss: 3.092 Test Acc: 0.211
Validation loss decreased (-0.178792 --> -0.210557).  Saving model ...
Epoch: 8 cost time: 0.6599204540252686
Epoch: 8, Steps: 10 | Train Loss: 1.549 Vali Loss: 3.083 Vali Acc: 0.213 Test Loss: 3.083 Test Acc: 0.213
Validation loss decreased (-0.210557 --> -0.212910).  Saving model ...
Epoch: 9 cost time: 0.7420248985290527
Epoch: 9, Steps: 10 | Train Loss: 1.282 Vali Loss: 3.076 Vali Acc: 0.232 Test Loss: 3.076 Test Acc: 0.232
Validation loss decreased (-0.212910 --> -0.231734).  Saving model ...
Epoch: 10 cost time: 0.7570393085479736
Epoch: 10, Steps: 10 | Train Loss: 1.053 Vali Loss: 3.078 Vali Acc: 0.253 Test Loss: 3.078 Test Acc: 0.253
Validation loss decreased (-0.231734 --> -0.252910).  Saving model ...
Epoch: 11 cost time: 0.6693129539489746
Epoch: 11, Steps: 10 | Train Loss: 0.873 Vali Loss: 3.078 Vali Acc: 0.260 Test Loss: 3.078 Test Acc: 0.260
Validation loss decreased (-0.252910 --> -0.259969).  Saving model ...
Epoch: 12 cost time: 0.6484997272491455
Epoch: 12, Steps: 10 | Train Loss: 0.641 Vali Loss: 3.100 Vali Acc: 0.268 Test Loss: 3.100 Test Acc: 0.268
Validation loss decreased (-0.259969 --> -0.268204).  Saving model ...
Epoch: 13 cost time: 0.7575829029083252
Epoch: 13, Steps: 10 | Train Loss: 0.539 Vali Loss: 3.132 Vali Acc: 0.279 Test Loss: 3.132 Test Acc: 0.279
Validation loss decreased (-0.268204 --> -0.278792).  Saving model ...
Epoch: 14 cost time: 0.7334630489349365
Epoch: 14, Steps: 10 | Train Loss: 0.381 Vali Loss: 3.184 Vali Acc: 0.287 Test Loss: 3.184 Test Acc: 0.287
Validation loss decreased (-0.278792 --> -0.287027).  Saving model ...
Epoch: 15 cost time: 0.837059497833252
Epoch: 15, Steps: 10 | Train Loss: 0.288 Vali Loss: 3.209 Vali Acc: 0.292 Test Loss: 3.209 Test Acc: 0.292
Validation loss decreased (-0.287027 --> -0.291733).  Saving model ...
Epoch: 16 cost time: 0.8263387680053711
Epoch: 16, Steps: 10 | Train Loss: 0.213 Vali Loss: 3.252 Vali Acc: 0.302 Test Loss: 3.252 Test Acc: 0.302
Validation loss decreased (-0.291733 --> -0.302320).  Saving model ...
Epoch: 17 cost time: 0.9935863018035889
Epoch: 17, Steps: 10 | Train Loss: 0.154 Vali Loss: 3.334 Vali Acc: 0.304 Test Loss: 3.334 Test Acc: 0.304
Validation loss decreased (-0.302320 --> -0.303496).  Saving model ...
Epoch: 18 cost time: 0.8934636116027832
Epoch: 18, Steps: 10 | Train Loss: 0.128 Vali Loss: 3.348 Vali Acc: 0.306 Test Loss: 3.348 Test Acc: 0.306
Validation loss decreased (-0.303496 --> -0.305849).  Saving model ...
Epoch: 19 cost time: 0.7913577556610107
Epoch: 19, Steps: 10 | Train Loss: 0.095 Vali Loss: 3.396 Vali Acc: 0.302 Test Loss: 3.396 Test Acc: 0.302
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7433147430419922
Epoch: 20, Steps: 10 | Train Loss: 0.074 Vali Loss: 3.419 Vali Acc: 0.304 Test Loss: 3.419 Test Acc: 0.304
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7111217975616455
Epoch: 21, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.432 Vali Acc: 0.318 Test Loss: 3.432 Test Acc: 0.318
Validation loss decreased (-0.305849 --> -0.317613).  Saving model ...
Epoch: 22 cost time: 0.7819035053253174
Epoch: 22, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.457 Vali Acc: 0.315 Test Loss: 3.457 Test Acc: 0.315
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.743511438369751
Epoch: 23, Steps: 10 | Train Loss: 0.046 Vali Loss: 3.497 Vali Acc: 0.315 Test Loss: 3.497 Test Acc: 0.315
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8516249656677246
Epoch: 24, Steps: 10 | Train Loss: 0.041 Vali Loss: 3.524 Vali Acc: 0.312 Test Loss: 3.524 Test Acc: 0.312
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8997082710266113
Epoch: 25, Steps: 10 | Train Loss: 0.035 Vali Loss: 3.535 Vali Acc: 0.315 Test Loss: 3.535 Test Acc: 0.315
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.935976505279541
Epoch: 26, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.560 Vali Acc: 0.316 Test Loss: 3.560 Test Acc: 0.316
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9314961433410645
Epoch: 27, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.577 Vali Acc: 0.322 Test Loss: 3.577 Test Acc: 0.322
Validation loss decreased (-0.317613 --> -0.322317).  Saving model ...
Epoch: 28 cost time: 1.0389957427978516
Epoch: 28, Steps: 10 | Train Loss: 0.023 Vali Loss: 3.590 Vali Acc: 0.320 Test Loss: 3.590 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.9199783802032471
Epoch: 29, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.613 Vali Acc: 0.316 Test Loss: 3.613 Test Acc: 0.316
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.840369462966919
Epoch: 30, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.638 Vali Acc: 0.315 Test Loss: 3.638 Test Acc: 0.315
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8974738121032715
Epoch: 31, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.653 Vali Acc: 0.318 Test Loss: 3.653 Test Acc: 0.318
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.7592825889587402
Epoch: 32, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.659 Vali Acc: 0.313 Test Loss: 3.659 Test Acc: 0.313
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8627109527587891
Epoch: 33, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.665 Vali Acc: 0.315 Test Loss: 3.665 Test Acc: 0.315
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8761739730834961
Epoch: 34, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.671 Vali Acc: 0.318 Test Loss: 3.671 Test Acc: 0.318
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.839468240737915
Epoch: 35, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.682 Vali Acc: 0.315 Test Loss: 3.682 Test Acc: 0.315
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.0518462657928467
Epoch: 36, Steps: 10 | Train Loss: 0.013 Vali Loss: 3.700 Vali Acc: 0.315 Test Loss: 3.700 Test Acc: 0.315
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.9620139598846436
Epoch: 37, Steps: 10 | Train Loss: 0.011 Vali Loss: 3.719 Vali Acc: 0.312 Test Loss: 3.719 Test Acc: 0.312
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.32235294117647056
model parameter : 133526
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.364375114440918
Epoch: 1, Steps: 10 | Train Loss: 3.312 Vali Loss: 3.284 Vali Acc: 0.051 Test Loss: 3.284 Test Acc: 0.051
Validation loss decreased (inf --> -0.050555).  Saving model ...
Epoch: 2 cost time: 0.56070876121521
Epoch: 2, Steps: 10 | Train Loss: 3.176 Vali Loss: 3.259 Vali Acc: 0.087 Test Loss: 3.259 Test Acc: 0.087
Validation loss decreased (-0.050555 --> -0.087026).  Saving model ...
Epoch: 3 cost time: 0.797276496887207
Epoch: 3, Steps: 10 | Train Loss: 2.985 Vali Loss: 3.250 Vali Acc: 0.106 Test Loss: 3.250 Test Acc: 0.106
Validation loss decreased (-0.087026 --> -0.105850).  Saving model ...
Epoch: 4 cost time: 0.6624236106872559
Epoch: 4, Steps: 10 | Train Loss: 2.724 Vali Loss: 3.235 Vali Acc: 0.127 Test Loss: 3.235 Test Acc: 0.127
Validation loss decreased (-0.105850 --> -0.127026).  Saving model ...
Epoch: 5 cost time: 0.7790367603302002
Epoch: 5, Steps: 10 | Train Loss: 2.495 Vali Loss: 3.191 Vali Acc: 0.154 Test Loss: 3.191 Test Acc: 0.154
Validation loss decreased (-0.127026 --> -0.154086).  Saving model ...
Epoch: 6 cost time: 0.7394914627075195
Epoch: 6, Steps: 10 | Train Loss: 2.208 Vali Loss: 3.149 Vali Acc: 0.175 Test Loss: 3.149 Test Acc: 0.175
Validation loss decreased (-0.154086 --> -0.175263).  Saving model ...
Epoch: 7 cost time: 0.8518836498260498
Epoch: 7, Steps: 10 | Train Loss: 1.919 Vali Loss: 3.098 Vali Acc: 0.188 Test Loss: 3.098 Test Acc: 0.188
Validation loss decreased (-0.175263 --> -0.188204).  Saving model ...
Epoch: 8 cost time: 0.7500646114349365
Epoch: 8, Steps: 10 | Train Loss: 1.679 Vali Loss: 3.083 Vali Acc: 0.196 Test Loss: 3.083 Test Acc: 0.196
Validation loss decreased (-0.188204 --> -0.196440).  Saving model ...
Epoch: 9 cost time: 0.6761901378631592
Epoch: 9, Steps: 10 | Train Loss: 1.402 Vali Loss: 3.065 Vali Acc: 0.220 Test Loss: 3.065 Test Acc: 0.220
Validation loss decreased (-0.196440 --> -0.219969).  Saving model ...
Epoch: 10 cost time: 0.6462607383728027
Epoch: 10, Steps: 10 | Train Loss: 1.183 Vali Loss: 3.066 Vali Acc: 0.238 Test Loss: 3.066 Test Acc: 0.238
Validation loss decreased (-0.219969 --> -0.237616).  Saving model ...
Epoch: 11 cost time: 0.6867020130157471
Epoch: 11, Steps: 10 | Train Loss: 0.979 Vali Loss: 3.063 Vali Acc: 0.252 Test Loss: 3.063 Test Acc: 0.252
Validation loss decreased (-0.237616 --> -0.251734).  Saving model ...
Epoch: 12 cost time: 0.6708517074584961
Epoch: 12, Steps: 10 | Train Loss: 0.765 Vali Loss: 3.072 Vali Acc: 0.260 Test Loss: 3.072 Test Acc: 0.260
Validation loss decreased (-0.251734 --> -0.259969).  Saving model ...
Epoch: 13 cost time: 0.7199852466583252
Epoch: 13, Steps: 10 | Train Loss: 0.642 Vali Loss: 3.096 Vali Acc: 0.271 Test Loss: 3.096 Test Acc: 0.271
Validation loss decreased (-0.259969 --> -0.270557).  Saving model ...
Epoch: 14 cost time: 0.8266739845275879
Epoch: 14, Steps: 10 | Train Loss: 0.456 Vali Loss: 3.137 Vali Acc: 0.279 Test Loss: 3.137 Test Acc: 0.279
Validation loss decreased (-0.270557 --> -0.278792).  Saving model ...
Epoch: 15 cost time: 0.7618842124938965
Epoch: 15, Steps: 10 | Train Loss: 0.358 Vali Loss: 3.171 Vali Acc: 0.279 Test Loss: 3.171 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7374858856201172
Epoch: 16, Steps: 10 | Train Loss: 0.254 Vali Loss: 3.207 Vali Acc: 0.292 Test Loss: 3.207 Test Acc: 0.292
Validation loss decreased (-0.278792 --> -0.291733).  Saving model ...
Epoch: 17 cost time: 0.6979763507843018
Epoch: 17, Steps: 10 | Train Loss: 0.197 Vali Loss: 3.265 Vali Acc: 0.291 Test Loss: 3.265 Test Acc: 0.291
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7074048519134521
Epoch: 18, Steps: 10 | Train Loss: 0.153 Vali Loss: 3.283 Vali Acc: 0.294 Test Loss: 3.283 Test Acc: 0.294
Validation loss decreased (-0.291733 --> -0.294085).  Saving model ...
Epoch: 19 cost time: 0.7286131381988525
Epoch: 19, Steps: 10 | Train Loss: 0.109 Vali Loss: 3.326 Vali Acc: 0.294 Test Loss: 3.326 Test Acc: 0.294
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8588447570800781
Epoch: 20, Steps: 10 | Train Loss: 0.084 Vali Loss: 3.355 Vali Acc: 0.291 Test Loss: 3.355 Test Acc: 0.291
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.7365283966064453
Epoch: 21, Steps: 10 | Train Loss: 0.080 Vali Loss: 3.382 Vali Acc: 0.292 Test Loss: 3.382 Test Acc: 0.292
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.7633657455444336
Epoch: 22, Steps: 10 | Train Loss: 0.061 Vali Loss: 3.410 Vali Acc: 0.304 Test Loss: 3.410 Test Acc: 0.304
Validation loss decreased (-0.294085 --> -0.303495).  Saving model ...
Epoch: 23 cost time: 0.696253776550293
Epoch: 23, Steps: 10 | Train Loss: 0.051 Vali Loss: 3.442 Vali Acc: 0.300 Test Loss: 3.442 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7176487445831299
Epoch: 24, Steps: 10 | Train Loss: 0.053 Vali Loss: 3.464 Vali Acc: 0.292 Test Loss: 3.464 Test Acc: 0.292
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8210341930389404
Epoch: 25, Steps: 10 | Train Loss: 0.048 Vali Loss: 3.471 Vali Acc: 0.299 Test Loss: 3.471 Test Acc: 0.299
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.7899479866027832
Epoch: 26, Steps: 10 | Train Loss: 0.036 Vali Loss: 3.510 Vali Acc: 0.300 Test Loss: 3.510 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.7150163650512695
Epoch: 27, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.521 Vali Acc: 0.298 Test Loss: 3.521 Test Acc: 0.298
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7533674240112305
Epoch: 28, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.530 Vali Acc: 0.296 Test Loss: 3.530 Test Acc: 0.296
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.7776479721069336
Epoch: 29, Steps: 10 | Train Loss: 0.025 Vali Loss: 3.549 Vali Acc: 0.292 Test Loss: 3.549 Test Acc: 0.292
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6664032936096191
Epoch: 30, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.571 Vali Acc: 0.298 Test Loss: 3.571 Test Acc: 0.298
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.6233978271484375
Epoch: 31, Steps: 10 | Train Loss: 0.022 Vali Loss: 3.584 Vali Acc: 0.300 Test Loss: 3.584 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.6387593746185303
Epoch: 32, Steps: 10 | Train Loss: 0.021 Vali Loss: 3.591 Vali Acc: 0.298 Test Loss: 3.591 Test Acc: 0.298
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.3035294117647059
model parameter : 133526
model size : 1.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_Handwriting     Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/Handwriting
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             3                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

150
850
>>>>>>>start training : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
150
850
850
Epoch: 1 cost time: 2.7208456993103027
Epoch: 1, Steps: 10 | Train Loss: 3.290 Vali Loss: 3.256 Vali Acc: 0.051 Test Loss: 3.256 Test Acc: 0.051
Validation loss decreased (inf --> -0.050556).  Saving model ...
Epoch: 2 cost time: 0.7642257213592529
Epoch: 2, Steps: 10 | Train Loss: 3.178 Vali Loss: 3.242 Vali Acc: 0.066 Test Loss: 3.242 Test Acc: 0.066
Validation loss decreased (-0.050556 --> -0.065850).  Saving model ...
Epoch: 3 cost time: 0.7552733421325684
Epoch: 3, Steps: 10 | Train Loss: 3.046 Vali Loss: 3.238 Vali Acc: 0.086 Test Loss: 3.238 Test Acc: 0.086
Validation loss decreased (-0.065850 --> -0.085850).  Saving model ...
Epoch: 4 cost time: 0.7017002105712891
Epoch: 4, Steps: 10 | Train Loss: 2.840 Vali Loss: 3.233 Vali Acc: 0.107 Test Loss: 3.233 Test Acc: 0.107
Validation loss decreased (-0.085850 --> -0.107026).  Saving model ...
Epoch: 5 cost time: 0.7135419845581055
Epoch: 5, Steps: 10 | Train Loss: 2.664 Vali Loss: 3.204 Vali Acc: 0.122 Test Loss: 3.204 Test Acc: 0.122
Validation loss decreased (-0.107026 --> -0.122321).  Saving model ...
Epoch: 6 cost time: 0.7041103839874268
Epoch: 6, Steps: 10 | Train Loss: 2.453 Vali Loss: 3.169 Vali Acc: 0.142 Test Loss: 3.169 Test Acc: 0.142
Validation loss decreased (-0.122321 --> -0.142321).  Saving model ...
Epoch: 7 cost time: 0.669208288192749
Epoch: 7, Steps: 10 | Train Loss: 2.242 Vali Loss: 3.124 Vali Acc: 0.164 Test Loss: 3.124 Test Acc: 0.164
Validation loss decreased (-0.142321 --> -0.163498).  Saving model ...
Epoch: 8 cost time: 0.5598752498626709
Epoch: 8, Steps: 10 | Train Loss: 2.004 Vali Loss: 3.099 Vali Acc: 0.158 Test Loss: 3.099 Test Acc: 0.158
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7232820987701416
Epoch: 9, Steps: 10 | Train Loss: 1.772 Vali Loss: 3.068 Vali Acc: 0.180 Test Loss: 3.068 Test Acc: 0.180
Validation loss decreased (-0.163498 --> -0.179969).  Saving model ...
Epoch: 10 cost time: 0.7382345199584961
Epoch: 10, Steps: 10 | Train Loss: 1.569 Vali Loss: 3.056 Vali Acc: 0.188 Test Loss: 3.056 Test Acc: 0.188
Validation loss decreased (-0.179969 --> -0.188205).  Saving model ...
Epoch: 11 cost time: 0.6996846199035645
Epoch: 11, Steps: 10 | Train Loss: 1.319 Vali Loss: 3.040 Vali Acc: 0.209 Test Loss: 3.040 Test Acc: 0.209
Validation loss decreased (-0.188205 --> -0.209381).  Saving model ...
Epoch: 12 cost time: 0.7143232822418213
Epoch: 12, Steps: 10 | Train Loss: 1.130 Vali Loss: 3.035 Vali Acc: 0.216 Test Loss: 3.035 Test Acc: 0.216
Validation loss decreased (-0.209381 --> -0.216440).  Saving model ...
Epoch: 13 cost time: 0.7528078556060791
Epoch: 13, Steps: 10 | Train Loss: 0.966 Vali Loss: 3.040 Vali Acc: 0.231 Test Loss: 3.040 Test Acc: 0.231
Validation loss decreased (-0.216440 --> -0.230558).  Saving model ...
Epoch: 14 cost time: 0.7568135261535645
Epoch: 14, Steps: 10 | Train Loss: 0.756 Vali Loss: 3.071 Vali Acc: 0.231 Test Loss: 3.071 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8141202926635742
Epoch: 15, Steps: 10 | Train Loss: 0.602 Vali Loss: 3.101 Vali Acc: 0.235 Test Loss: 3.101 Test Acc: 0.235
Validation loss decreased (-0.230558 --> -0.235263).  Saving model ...
Epoch: 16 cost time: 0.7518367767333984
Epoch: 16, Steps: 10 | Train Loss: 0.462 Vali Loss: 3.111 Vali Acc: 0.245 Test Loss: 3.111 Test Acc: 0.245
Validation loss decreased (-0.235263 --> -0.244675).  Saving model ...
Epoch: 17 cost time: 0.8291513919830322
Epoch: 17, Steps: 10 | Train Loss: 0.353 Vali Loss: 3.170 Vali Acc: 0.247 Test Loss: 3.170 Test Acc: 0.247
Validation loss decreased (-0.244675 --> -0.247027).  Saving model ...
Epoch: 18 cost time: 0.7432870864868164
Epoch: 18, Steps: 10 | Train Loss: 0.269 Vali Loss: 3.202 Vali Acc: 0.252 Test Loss: 3.202 Test Acc: 0.252
Validation loss decreased (-0.247027 --> -0.251733).  Saving model ...
Epoch: 19 cost time: 0.6445121765136719
Epoch: 19, Steps: 10 | Train Loss: 0.192 Vali Loss: 3.229 Vali Acc: 0.267 Test Loss: 3.229 Test Acc: 0.267
Validation loss decreased (-0.251733 --> -0.267027).  Saving model ...
Epoch: 20 cost time: 0.7179749011993408
Epoch: 20, Steps: 10 | Train Loss: 0.145 Vali Loss: 3.260 Vali Acc: 0.269 Test Loss: 3.260 Test Acc: 0.269
Validation loss decreased (-0.267027 --> -0.269379).  Saving model ...
Epoch: 21 cost time: 0.6704564094543457
Epoch: 21, Steps: 10 | Train Loss: 0.124 Vali Loss: 3.303 Vali Acc: 0.260 Test Loss: 3.303 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7140874862670898
Epoch: 22, Steps: 10 | Train Loss: 0.091 Vali Loss: 3.320 Vali Acc: 0.268 Test Loss: 3.320 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7988080978393555
Epoch: 23, Steps: 10 | Train Loss: 0.067 Vali Loss: 3.357 Vali Acc: 0.267 Test Loss: 3.357 Test Acc: 0.267
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8880050182342529
Epoch: 24, Steps: 10 | Train Loss: 0.063 Vali Loss: 3.376 Vali Acc: 0.267 Test Loss: 3.376 Test Acc: 0.267
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8987791538238525
Epoch: 25, Steps: 10 | Train Loss: 0.049 Vali Loss: 3.399 Vali Acc: 0.272 Test Loss: 3.399 Test Acc: 0.272
Validation loss decreased (-0.269379 --> -0.271731).  Saving model ...
Epoch: 26 cost time: 0.9633090496063232
Epoch: 26, Steps: 10 | Train Loss: 0.044 Vali Loss: 3.437 Vali Acc: 0.273 Test Loss: 3.437 Test Acc: 0.273
Validation loss decreased (-0.271731 --> -0.272907).  Saving model ...
Epoch: 27 cost time: 0.8250935077667236
Epoch: 27, Steps: 10 | Train Loss: 0.037 Vali Loss: 3.458 Vali Acc: 0.274 Test Loss: 3.458 Test Acc: 0.274
Validation loss decreased (-0.272907 --> -0.274083).  Saving model ...
Epoch: 28 cost time: 0.7126095294952393
Epoch: 28, Steps: 10 | Train Loss: 0.031 Vali Loss: 3.486 Vali Acc: 0.272 Test Loss: 3.486 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.6570920944213867
Epoch: 29, Steps: 10 | Train Loss: 0.027 Vali Loss: 3.512 Vali Acc: 0.268 Test Loss: 3.512 Test Acc: 0.268
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.6422600746154785
Epoch: 30, Steps: 10 | Train Loss: 0.026 Vali Loss: 3.535 Vali Acc: 0.275 Test Loss: 3.535 Test Acc: 0.275
Validation loss decreased (-0.274083 --> -0.275259).  Saving model ...
Epoch: 31 cost time: 0.6211345195770264
Epoch: 31, Steps: 10 | Train Loss: 0.024 Vali Loss: 3.547 Vali Acc: 0.273 Test Loss: 3.547 Test Acc: 0.273
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.6679887771606445
Epoch: 32, Steps: 10 | Train Loss: 0.020 Vali Loss: 3.560 Vali Acc: 0.276 Test Loss: 3.560 Test Acc: 0.276
Validation loss decreased (-0.275259 --> -0.276435).  Saving model ...
Epoch: 33 cost time: 0.69454026222229
Epoch: 33, Steps: 10 | Train Loss: 0.018 Vali Loss: 3.577 Vali Acc: 0.276 Test Loss: 3.577 Test Acc: 0.276
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8015477657318115
Epoch: 34, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.600 Vali Acc: 0.275 Test Loss: 3.600 Test Acc: 0.275
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.92427659034729
Epoch: 35, Steps: 10 | Train Loss: 0.016 Vali Loss: 3.614 Vali Acc: 0.275 Test Loss: 3.614 Test Acc: 0.275
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7790772914886475
Epoch: 36, Steps: 10 | Train Loss: 0.014 Vali Loss: 3.625 Vali Acc: 0.279 Test Loss: 3.625 Test Acc: 0.279
Validation loss decreased (-0.276435 --> -0.278787).  Saving model ...
Epoch: 37 cost time: 0.96628737449646
Epoch: 37, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.639 Vali Acc: 0.281 Test Loss: 3.639 Test Acc: 0.281
Validation loss decreased (-0.278787 --> -0.281140).  Saving model ...
Epoch: 38 cost time: 0.8527331352233887
Epoch: 38, Steps: 10 | Train Loss: 0.015 Vali Loss: 3.654 Vali Acc: 0.279 Test Loss: 3.654 Test Acc: 0.279
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7870299816131592
Epoch: 39, Steps: 10 | Train Loss: 0.012 Vali Loss: 3.679 Vali Acc: 0.280 Test Loss: 3.679 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.6388823986053467
Epoch: 40, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.700 Vali Acc: 0.279 Test Loss: 3.700 Test Acc: 0.279
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7263579368591309
Epoch: 41, Steps: 10 | Train Loss: 0.010 Vali Loss: 3.718 Vali Acc: 0.280 Test Loss: 3.718 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6257100105285645
Epoch: 42, Steps: 10 | Train Loss: 0.009 Vali Loss: 3.743 Vali Acc: 0.278 Test Loss: 3.743 Test Acc: 0.278
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6089468002319336
Epoch: 43, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.763 Vali Acc: 0.279 Test Loss: 3.763 Test Acc: 0.279
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.5984029769897461
Epoch: 44, Steps: 10 | Train Loss: 0.008 Vali Loss: 3.775 Vali Acc: 0.276 Test Loss: 3.775 Test Acc: 0.276
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.8824639320373535
Epoch: 45, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.778 Vali Acc: 0.279 Test Loss: 3.778 Test Acc: 0.279
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8159382343292236
Epoch: 46, Steps: 10 | Train Loss: 0.006 Vali Loss: 3.784 Vali Acc: 0.280 Test Loss: 3.784 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.8167209625244141
Epoch: 47, Steps: 10 | Train Loss: 0.007 Vali Loss: 3.786 Vali Acc: 0.279 Test Loss: 3.786 Test Acc: 0.279
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_Handwriting_ETSformer_UEA_ftM_sl152_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
850
test shape: torch.Size([850, 26]) torch.Size([850, 1])
accuracy:0.2811764705882353
model parameter : 133526
model size : 1.13MB
