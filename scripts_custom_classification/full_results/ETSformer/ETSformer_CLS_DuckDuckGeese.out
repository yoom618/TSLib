Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6768767833709717
Epoch: 1, Steps: 4 | Train Loss: 1.764 Vali Loss: 1.664 Vali Acc: 0.120 Test Loss: 1.664 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.534165382385254
Epoch: 2, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.702 Vali Acc: 0.160 Test Loss: 1.702 Test Acc: 0.160
Validation loss decreased (-0.119983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.5741240978240967
Epoch: 3, Steps: 4 | Train Loss: 1.325 Vali Loss: 1.829 Vali Acc: 0.200 Test Loss: 1.829 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.5901403427124023
Epoch: 4, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.989 Vali Acc: 0.200 Test Loss: 1.989 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4363548755645752
Epoch: 5, Steps: 4 | Train Loss: 0.648 Vali Loss: 2.177 Vali Acc: 0.240 Test Loss: 2.177 Test Acc: 0.240
Validation loss decreased (-0.199982 --> -0.239978).  Saving model ...
Epoch: 6 cost time: 1.6242058277130127
Epoch: 6, Steps: 4 | Train Loss: 0.474 Vali Loss: 2.309 Vali Acc: 0.240 Test Loss: 2.309 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6480026245117188
Epoch: 7, Steps: 4 | Train Loss: 0.518 Vali Loss: 2.657 Vali Acc: 0.260 Test Loss: 2.657 Test Acc: 0.260
Validation loss decreased (-0.239978 --> -0.259973).  Saving model ...
Epoch: 8 cost time: 1.7405378818511963
Epoch: 8, Steps: 4 | Train Loss: 0.223 Vali Loss: 2.722 Vali Acc: 0.260 Test Loss: 2.722 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3643417358398438
Epoch: 9, Steps: 4 | Train Loss: 0.193 Vali Loss: 2.707 Vali Acc: 0.260 Test Loss: 2.707 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4768214225769043
Epoch: 10, Steps: 4 | Train Loss: 0.151 Vali Loss: 3.004 Vali Acc: 0.240 Test Loss: 3.004 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.240255355834961
Epoch: 11, Steps: 4 | Train Loss: 0.090 Vali Loss: 3.105 Vali Acc: 0.240 Test Loss: 3.105 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.206641674041748
Epoch: 12, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.299 Vali Acc: 0.260 Test Loss: 3.299 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1512372493743896
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 3.689 Vali Acc: 0.300 Test Loss: 3.689 Test Acc: 0.300
Validation loss decreased (-0.259973 --> -0.299963).  Saving model ...
Epoch: 14 cost time: 1.287729263305664
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.096 Vali Acc: 0.260 Test Loss: 4.096 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2905316352844238
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.315 Vali Acc: 0.260 Test Loss: 4.315 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.232530117034912
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.201 Vali Acc: 0.260 Test Loss: 4.201 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4210476875305176
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.152 Vali Acc: 0.280 Test Loss: 4.152 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.389521598815918
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.215 Vali Acc: 0.280 Test Loss: 4.215 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3611969947814941
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.357 Vali Acc: 0.280 Test Loss: 4.357 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4430510997772217
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.528 Vali Acc: 0.300 Test Loss: 4.528 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3980247974395752
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.669 Vali Acc: 0.300 Test Loss: 4.669 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.6164402961730957
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.768 Vali Acc: 0.300 Test Loss: 4.768 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.5262787342071533
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.860 Vali Acc: 0.300 Test Loss: 4.860 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 10775597
model size : 50.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6064653396606445
Epoch: 1, Steps: 4 | Train Loss: 1.734 Vali Loss: 1.647 Vali Acc: 0.160 Test Loss: 1.647 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.4663677215576172
Epoch: 2, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.661 Vali Acc: 0.140 Test Loss: 1.661 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6818006038665771
Epoch: 3, Steps: 4 | Train Loss: 1.328 Vali Loss: 1.778 Vali Acc: 0.180 Test Loss: 1.778 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179982).  Saving model ...
Epoch: 4 cost time: 1.24220871925354
Epoch: 4, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.903 Vali Acc: 0.200 Test Loss: 1.903 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199981).  Saving model ...
Epoch: 5 cost time: 1.657705307006836
Epoch: 5, Steps: 4 | Train Loss: 0.678 Vali Loss: 2.110 Vali Acc: 0.240 Test Loss: 2.110 Test Acc: 0.240
Validation loss decreased (-0.199981 --> -0.239979).  Saving model ...
Epoch: 6 cost time: 1.3885154724121094
Epoch: 6, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.246 Vali Acc: 0.220 Test Loss: 2.246 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4149279594421387
Epoch: 7, Steps: 4 | Train Loss: 0.543 Vali Loss: 2.570 Vali Acc: 0.260 Test Loss: 2.570 Test Acc: 0.260
Validation loss decreased (-0.239979 --> -0.259974).  Saving model ...
Epoch: 8 cost time: 1.6609280109405518
Epoch: 8, Steps: 4 | Train Loss: 0.239 Vali Loss: 2.649 Vali Acc: 0.220 Test Loss: 2.649 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.364804744720459
Epoch: 9, Steps: 4 | Train Loss: 0.207 Vali Loss: 2.594 Vali Acc: 0.280 Test Loss: 2.594 Test Acc: 0.280
Validation loss decreased (-0.259974 --> -0.279974).  Saving model ...
Epoch: 10 cost time: 1.6101107597351074
Epoch: 10, Steps: 4 | Train Loss: 0.184 Vali Loss: 2.855 Vali Acc: 0.220 Test Loss: 2.855 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.5778229236602783
Epoch: 11, Steps: 4 | Train Loss: 0.092 Vali Loss: 3.000 Vali Acc: 0.260 Test Loss: 3.000 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7485132217407227
Epoch: 12, Steps: 4 | Train Loss: 0.049 Vali Loss: 3.150 Vali Acc: 0.280 Test Loss: 3.150 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.7470524311065674
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 3.599 Vali Acc: 0.260 Test Loss: 3.599 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.3084375858306885
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.896 Vali Acc: 0.240 Test Loss: 3.896 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.6808130741119385
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.054 Vali Acc: 0.260 Test Loss: 4.054 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.7653424739837646
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.976 Vali Acc: 0.240 Test Loss: 3.976 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.372380018234253
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.022 Vali Acc: 0.280 Test Loss: 4.022 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.311281442642212
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.226 Vali Acc: 0.280 Test Loss: 4.226 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2624735832214355
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.447 Vali Acc: 0.300 Test Loss: 4.447 Test Acc: 0.300
Validation loss decreased (-0.279974 --> -0.299956).  Saving model ...
Epoch: 20 cost time: 1.4373018741607666
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.729 Vali Acc: 0.280 Test Loss: 4.729 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.5824530124664307
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.936 Vali Acc: 0.280 Test Loss: 4.936 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.8232650756835938
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.979 Vali Acc: 0.280 Test Loss: 4.979 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5997791290283203
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.991 Vali Acc: 0.280 Test Loss: 4.991 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.6369216442108154
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.952 Vali Acc: 0.260 Test Loss: 4.952 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6094355583190918
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.880 Vali Acc: 0.240 Test Loss: 4.880 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5186128616333008
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.814 Vali Acc: 0.240 Test Loss: 4.814 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.609198808670044
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.760 Vali Acc: 0.240 Test Loss: 4.760 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8315367698669434
Epoch: 28, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.739 Vali Acc: 0.220 Test Loss: 4.739 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.5548102855682373
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.728 Vali Acc: 0.220 Test Loss: 4.728 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 10775597
model size : 50.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.716874837875366
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.644 Vali Acc: 0.140 Test Loss: 1.644 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.4615168571472168
Epoch: 2, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.692 Vali Acc: 0.120 Test Loss: 1.692 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2939062118530273
Epoch: 3, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.736 Vali Acc: 0.180 Test Loss: 1.736 Test Acc: 0.180
Validation loss decreased (-0.139984 --> -0.179983).  Saving model ...
Epoch: 4 cost time: 1.4629905223846436
Epoch: 4, Steps: 4 | Train Loss: 0.825 Vali Loss: 1.820 Vali Acc: 0.200 Test Loss: 1.820 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 1.2677421569824219
Epoch: 5, Steps: 4 | Train Loss: 0.749 Vali Loss: 2.029 Vali Acc: 0.220 Test Loss: 2.029 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219980).  Saving model ...
Epoch: 6 cost time: 1.5315921306610107
Epoch: 6, Steps: 4 | Train Loss: 0.544 Vali Loss: 2.130 Vali Acc: 0.220 Test Loss: 2.130 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.607550859451294
Epoch: 7, Steps: 4 | Train Loss: 0.589 Vali Loss: 2.384 Vali Acc: 0.280 Test Loss: 2.384 Test Acc: 0.280
Validation loss decreased (-0.219980 --> -0.279976).  Saving model ...
Epoch: 8 cost time: 1.4788391590118408
Epoch: 8, Steps: 4 | Train Loss: 0.273 Vali Loss: 2.425 Vali Acc: 0.240 Test Loss: 2.425 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5026283264160156
Epoch: 9, Steps: 4 | Train Loss: 0.227 Vali Loss: 2.442 Vali Acc: 0.280 Test Loss: 2.442 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6681382656097412
Epoch: 10, Steps: 4 | Train Loss: 0.187 Vali Loss: 2.705 Vali Acc: 0.240 Test Loss: 2.705 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3141272068023682
Epoch: 11, Steps: 4 | Train Loss: 0.113 Vali Loss: 2.766 Vali Acc: 0.220 Test Loss: 2.766 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4958817958831787
Epoch: 12, Steps: 4 | Train Loss: 0.058 Vali Loss: 2.883 Vali Acc: 0.260 Test Loss: 2.883 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.415020227432251
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 3.432 Vali Acc: 0.280 Test Loss: 3.432 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5149354934692383
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.695 Vali Acc: 0.220 Test Loss: 3.695 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.5626094341278076
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.714 Vali Acc: 0.260 Test Loss: 3.714 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.431415319442749
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.791 Vali Acc: 0.260 Test Loss: 3.791 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5637643337249756
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.835 Vali Acc: 0.260 Test Loss: 3.835 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 10775597
model size : 50.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.199570894241333
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.653 Vali Acc: 0.160 Test Loss: 1.653 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.290470838546753
Epoch: 2, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.692 Vali Acc: 0.260 Test Loss: 1.692 Test Acc: 0.260
Validation loss decreased (-0.159983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.5056483745574951
Epoch: 3, Steps: 4 | Train Loss: 1.445 Vali Loss: 1.701 Vali Acc: 0.200 Test Loss: 1.701 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3146791458129883
Epoch: 4, Steps: 4 | Train Loss: 0.910 Vali Loss: 1.727 Vali Acc: 0.200 Test Loss: 1.727 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2654438018798828
Epoch: 5, Steps: 4 | Train Loss: 0.869 Vali Loss: 1.893 Vali Acc: 0.300 Test Loss: 1.893 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299981).  Saving model ...
Epoch: 6 cost time: 1.6288721561431885
Epoch: 6, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.923 Vali Acc: 0.220 Test Loss: 1.923 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3856685161590576
Epoch: 7, Steps: 4 | Train Loss: 0.731 Vali Loss: 2.130 Vali Acc: 0.320 Test Loss: 2.130 Test Acc: 0.320
Validation loss decreased (-0.299981 --> -0.319979).  Saving model ...
Epoch: 8 cost time: 1.6150751113891602
Epoch: 8, Steps: 4 | Train Loss: 0.349 Vali Loss: 2.092 Vali Acc: 0.220 Test Loss: 2.092 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5433909893035889
Epoch: 9, Steps: 4 | Train Loss: 0.300 Vali Loss: 2.251 Vali Acc: 0.260 Test Loss: 2.251 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5795810222625732
Epoch: 10, Steps: 4 | Train Loss: 0.214 Vali Loss: 2.479 Vali Acc: 0.240 Test Loss: 2.479 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.7419273853302002
Epoch: 11, Steps: 4 | Train Loss: 0.153 Vali Loss: 2.393 Vali Acc: 0.300 Test Loss: 2.393 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4915764331817627
Epoch: 12, Steps: 4 | Train Loss: 0.130 Vali Loss: 2.596 Vali Acc: 0.220 Test Loss: 2.596 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.6188240051269531
Epoch: 13, Steps: 4 | Train Loss: 0.061 Vali Loss: 3.568 Vali Acc: 0.220 Test Loss: 3.568 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3519492149353027
Epoch: 14, Steps: 4 | Train Loss: 0.058 Vali Loss: 3.207 Vali Acc: 0.260 Test Loss: 3.207 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.694223165512085
Epoch: 15, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.172 Vali Acc: 0.280 Test Loss: 3.172 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6054363250732422
Epoch: 16, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.463 Vali Acc: 0.260 Test Loss: 3.463 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.5438222885131836
Epoch: 17, Steps: 4 | Train Loss: 0.006 Vali Loss: 3.646 Vali Acc: 0.240 Test Loss: 3.646 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 10775597
model size : 50.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3133790493011475
Epoch: 1, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.615 Vali Acc: 0.180 Test Loss: 1.615 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.4838638305664062
Epoch: 2, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.5559077262878418
Epoch: 3, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.768 Vali Acc: 0.220 Test Loss: 1.768 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.364551305770874
Epoch: 4, Steps: 4 | Train Loss: 0.781 Vali Loss: 2.023 Vali Acc: 0.260 Test Loss: 2.023 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259980).  Saving model ...
Epoch: 5 cost time: 1.3991363048553467
Epoch: 5, Steps: 4 | Train Loss: 0.565 Vali Loss: 2.042 Vali Acc: 0.320 Test Loss: 2.042 Test Acc: 0.320
Validation loss decreased (-0.259980 --> -0.319980).  Saving model ...
Epoch: 6 cost time: 1.5544426441192627
Epoch: 6, Steps: 4 | Train Loss: 0.509 Vali Loss: 2.185 Vali Acc: 0.300 Test Loss: 2.185 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.539431095123291
Epoch: 7, Steps: 4 | Train Loss: 0.293 Vali Loss: 2.333 Vali Acc: 0.280 Test Loss: 2.333 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5669946670532227
Epoch: 8, Steps: 4 | Train Loss: 0.313 Vali Loss: 2.434 Vali Acc: 0.260 Test Loss: 2.434 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.409627914428711
Epoch: 9, Steps: 4 | Train Loss: 0.217 Vali Loss: 2.807 Vali Acc: 0.260 Test Loss: 2.807 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4938485622406006
Epoch: 10, Steps: 4 | Train Loss: 0.090 Vali Loss: 2.765 Vali Acc: 0.240 Test Loss: 2.765 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.4750187397003174
Epoch: 11, Steps: 4 | Train Loss: 0.080 Vali Loss: 3.337 Vali Acc: 0.280 Test Loss: 3.337 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2501778602600098
Epoch: 12, Steps: 4 | Train Loss: 0.052 Vali Loss: 4.159 Vali Acc: 0.300 Test Loss: 4.159 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4531166553497314
Epoch: 13, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.946 Vali Acc: 0.280 Test Loss: 3.946 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.525752305984497
Epoch: 14, Steps: 4 | Train Loss: 0.009 Vali Loss: 3.929 Vali Acc: 0.260 Test Loss: 3.929 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.4437861442565918
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.963 Vali Acc: 0.240 Test Loss: 3.963 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 8678445
model size : 42.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4196228981018066
Epoch: 1, Steps: 4 | Train Loss: 1.618 Vali Loss: 1.653 Vali Acc: 0.200 Test Loss: 1.653 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3489055633544922
Epoch: 2, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.566 Vali Acc: 0.200 Test Loss: 1.566 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.3197746276855469
Epoch: 3, Steps: 4 | Train Loss: 1.165 Vali Loss: 1.759 Vali Acc: 0.220 Test Loss: 1.759 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219982).  Saving model ...
Epoch: 4 cost time: 1.247859001159668
Epoch: 4, Steps: 4 | Train Loss: 0.802 Vali Loss: 2.015 Vali Acc: 0.260 Test Loss: 2.015 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259980).  Saving model ...
Epoch: 5 cost time: 1.4396655559539795
Epoch: 5, Steps: 4 | Train Loss: 0.611 Vali Loss: 1.998 Vali Acc: 0.300 Test Loss: 1.998 Test Acc: 0.300
Validation loss decreased (-0.259980 --> -0.299980).  Saving model ...
Epoch: 6 cost time: 1.4192194938659668
Epoch: 6, Steps: 4 | Train Loss: 0.531 Vali Loss: 2.115 Vali Acc: 0.280 Test Loss: 2.115 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4745888710021973
Epoch: 7, Steps: 4 | Train Loss: 0.313 Vali Loss: 2.305 Vali Acc: 0.260 Test Loss: 2.305 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5510478019714355
Epoch: 8, Steps: 4 | Train Loss: 0.343 Vali Loss: 2.429 Vali Acc: 0.260 Test Loss: 2.429 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5273613929748535
Epoch: 9, Steps: 4 | Train Loss: 0.253 Vali Loss: 2.772 Vali Acc: 0.240 Test Loss: 2.772 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.6056337356567383
Epoch: 10, Steps: 4 | Train Loss: 0.095 Vali Loss: 2.757 Vali Acc: 0.260 Test Loss: 2.757 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.165930986404419
Epoch: 11, Steps: 4 | Train Loss: 0.074 Vali Loss: 3.489 Vali Acc: 0.240 Test Loss: 3.489 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5415699481964111
Epoch: 12, Steps: 4 | Train Loss: 0.066 Vali Loss: 4.133 Vali Acc: 0.280 Test Loss: 4.133 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4577233791351318
Epoch: 13, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.795 Vali Acc: 0.280 Test Loss: 3.795 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4996237754821777
Epoch: 14, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.914 Vali Acc: 0.260 Test Loss: 3.914 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.454216718673706
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.058 Vali Acc: 0.280 Test Loss: 4.058 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 8678445
model size : 42.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2701897621154785
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.652 Vali Acc: 0.180 Test Loss: 1.652 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.5646169185638428
Epoch: 2, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.550 Vali Acc: 0.220 Test Loss: 1.550 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.3624813556671143
Epoch: 3, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.708 Vali Acc: 0.200 Test Loss: 1.708 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.360412836074829
Epoch: 4, Steps: 4 | Train Loss: 0.856 Vali Loss: 1.908 Vali Acc: 0.240 Test Loss: 1.908 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239981).  Saving model ...
Epoch: 5 cost time: 1.650228500366211
Epoch: 5, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.933 Vali Acc: 0.260 Test Loss: 1.933 Test Acc: 0.260
Validation loss decreased (-0.239981 --> -0.259981).  Saving model ...
Epoch: 6 cost time: 1.3182291984558105
Epoch: 6, Steps: 4 | Train Loss: 0.545 Vali Loss: 2.048 Vali Acc: 0.260 Test Loss: 2.048 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.479813575744629
Epoch: 7, Steps: 4 | Train Loss: 0.353 Vali Loss: 2.208 Vali Acc: 0.240 Test Loss: 2.208 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6701269149780273
Epoch: 8, Steps: 4 | Train Loss: 0.391 Vali Loss: 2.329 Vali Acc: 0.260 Test Loss: 2.329 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2522194385528564
Epoch: 9, Steps: 4 | Train Loss: 0.313 Vali Loss: 2.585 Vali Acc: 0.200 Test Loss: 2.585 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4655547142028809
Epoch: 10, Steps: 4 | Train Loss: 0.111 Vali Loss: 2.511 Vali Acc: 0.240 Test Loss: 2.511 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.459606647491455
Epoch: 11, Steps: 4 | Train Loss: 0.084 Vali Loss: 3.362 Vali Acc: 0.240 Test Loss: 3.362 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.4688279628753662
Epoch: 12, Steps: 4 | Train Loss: 0.084 Vali Loss: 3.659 Vali Acc: 0.220 Test Loss: 3.659 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.7549240589141846
Epoch: 13, Steps: 4 | Train Loss: 0.034 Vali Loss: 3.219 Vali Acc: 0.300 Test Loss: 3.219 Test Acc: 0.300
Validation loss decreased (-0.259981 --> -0.299968).  Saving model ...
Epoch: 14 cost time: 1.72062349319458
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.347 Vali Acc: 0.220 Test Loss: 3.347 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5411655902862549
Epoch: 15, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.720 Vali Acc: 0.240 Test Loss: 3.720 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7151494026184082
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.984 Vali Acc: 0.220 Test Loss: 3.984 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.476304531097412
Epoch: 17, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.021 Vali Acc: 0.220 Test Loss: 4.021 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3579885959625244
Epoch: 18, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.178 Vali Acc: 0.200 Test Loss: 4.178 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5381317138671875
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.318 Vali Acc: 0.220 Test Loss: 4.318 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.525796890258789
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.365 Vali Acc: 0.220 Test Loss: 4.365 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.4785740375518799
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.415 Vali Acc: 0.220 Test Loss: 4.415 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4272572994232178
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.492 Vali Acc: 0.220 Test Loss: 4.492 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3051655292510986
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.576 Vali Acc: 0.220 Test Loss: 4.576 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 8678445
model size : 42.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.153888702392578
Epoch: 1, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.647 Vali Acc: 0.180 Test Loss: 1.647 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.6298730373382568
Epoch: 2, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.552 Vali Acc: 0.200 Test Loss: 1.552 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.6185343265533447
Epoch: 3, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.646357536315918
Epoch: 4, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.793 Vali Acc: 0.220 Test Loss: 1.793 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3149073123931885
Epoch: 5, Steps: 4 | Train Loss: 0.741 Vali Loss: 1.807 Vali Acc: 0.260 Test Loss: 1.807 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259982).  Saving model ...
Epoch: 6 cost time: 1.3920371532440186
Epoch: 6, Steps: 4 | Train Loss: 0.616 Vali Loss: 1.882 Vali Acc: 0.300 Test Loss: 1.882 Test Acc: 0.300
Validation loss decreased (-0.259982 --> -0.299981).  Saving model ...
Epoch: 7 cost time: 1.1984503269195557
Epoch: 7, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.016 Vali Acc: 0.240 Test Loss: 2.016 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3066949844360352
Epoch: 8, Steps: 4 | Train Loss: 0.467 Vali Loss: 2.108 Vali Acc: 0.280 Test Loss: 2.108 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3816280364990234
Epoch: 9, Steps: 4 | Train Loss: 0.406 Vali Loss: 2.322 Vali Acc: 0.260 Test Loss: 2.322 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4008443355560303
Epoch: 10, Steps: 4 | Train Loss: 0.156 Vali Loss: 2.225 Vali Acc: 0.280 Test Loss: 2.225 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.605379343032837
Epoch: 11, Steps: 4 | Train Loss: 0.094 Vali Loss: 3.209 Vali Acc: 0.260 Test Loss: 3.209 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4662580490112305
Epoch: 12, Steps: 4 | Train Loss: 0.160 Vali Loss: 3.359 Vali Acc: 0.240 Test Loss: 3.359 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6353626251220703
Epoch: 13, Steps: 4 | Train Loss: 0.060 Vali Loss: 2.807 Vali Acc: 0.300 Test Loss: 2.807 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.4748682975769043
Epoch: 14, Steps: 4 | Train Loss: 0.024 Vali Loss: 3.312 Vali Acc: 0.220 Test Loss: 3.312 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2705786228179932
Epoch: 15, Steps: 4 | Train Loss: 0.019 Vali Loss: 3.519 Vali Acc: 0.240 Test Loss: 3.519 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.5171852111816406
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 3.480 Vali Acc: 0.260 Test Loss: 3.480 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 8678445
model size : 42.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.446714162826538
Epoch: 1, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.656 Vali Acc: 0.160 Test Loss: 1.656 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.485640048980713
Epoch: 2, Steps: 4 | Train Loss: 1.471 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.672659158706665
Epoch: 3, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.827 Vali Acc: 0.220 Test Loss: 1.827 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219982).  Saving model ...
Epoch: 4 cost time: 1.6560263633728027
Epoch: 4, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.941 Vali Acc: 0.220 Test Loss: 1.941 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4621703624725342
Epoch: 5, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.126 Vali Acc: 0.260 Test Loss: 2.126 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259979).  Saving model ...
Epoch: 6 cost time: 1.6566455364227295
Epoch: 6, Steps: 4 | Train Loss: 0.669 Vali Loss: 2.380 Vali Acc: 0.220 Test Loss: 2.380 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3909528255462646
Epoch: 7, Steps: 4 | Train Loss: 0.273 Vali Loss: 2.723 Vali Acc: 0.240 Test Loss: 2.723 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5644595623016357
Epoch: 8, Steps: 4 | Train Loss: 0.254 Vali Loss: 2.932 Vali Acc: 0.220 Test Loss: 2.932 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.7323765754699707
Epoch: 9, Steps: 4 | Train Loss: 0.220 Vali Loss: 3.069 Vali Acc: 0.180 Test Loss: 3.069 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.7060461044311523
Epoch: 10, Steps: 4 | Train Loss: 0.132 Vali Loss: 3.480 Vali Acc: 0.260 Test Loss: 3.480 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.6596488952636719
Epoch: 11, Steps: 4 | Train Loss: 0.114 Vali Loss: 3.484 Vali Acc: 0.200 Test Loss: 3.484 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.656505823135376
Epoch: 12, Steps: 4 | Train Loss: 0.056 Vali Loss: 3.478 Vali Acc: 0.240 Test Loss: 3.478 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4972624778747559
Epoch: 13, Steps: 4 | Train Loss: 0.028 Vali Loss: 3.992 Vali Acc: 0.280 Test Loss: 3.992 Test Acc: 0.280
Validation loss decreased (-0.259979 --> -0.279960).  Saving model ...
Epoch: 14 cost time: 1.486438274383545
Epoch: 14, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.574 Vali Acc: 0.300 Test Loss: 4.574 Test Acc: 0.300
Validation loss decreased (-0.279960 --> -0.299954).  Saving model ...
Epoch: 15 cost time: 1.6183552742004395
Epoch: 15, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.866 Vali Acc: 0.240 Test Loss: 4.866 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.5656020641326904
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.091 Vali Acc: 0.280 Test Loss: 5.091 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4331064224243164
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.125 Vali Acc: 0.280 Test Loss: 5.125 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6861844062805176
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.046 Vali Acc: 0.280 Test Loss: 5.046 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6722497940063477
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.020 Vali Acc: 0.280 Test Loss: 5.020 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5989863872528076
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.994 Vali Acc: 0.280 Test Loss: 4.994 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.6917665004730225
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.989 Vali Acc: 0.280 Test Loss: 4.989 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.6876459121704102
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.984 Vali Acc: 0.280 Test Loss: 4.984 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3575921058654785
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.015 Vali Acc: 0.260 Test Loss: 5.015 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3617186546325684
Epoch: 24, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.053 Vali Acc: 0.280 Test Loss: 5.053 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 7629869
model size : 38.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.380892515182495
Epoch: 1, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.646 Vali Acc: 0.160 Test Loss: 1.646 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.3614566326141357
Epoch: 2, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.710 Vali Acc: 0.140 Test Loss: 1.710 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3404462337493896
Epoch: 3, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.810 Vali Acc: 0.200 Test Loss: 1.810 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 1.6330890655517578
Epoch: 4, Steps: 4 | Train Loss: 0.759 Vali Loss: 1.915 Vali Acc: 0.220 Test Loss: 1.915 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219981).  Saving model ...
Epoch: 5 cost time: 1.4875249862670898
Epoch: 5, Steps: 4 | Train Loss: 0.539 Vali Loss: 2.073 Vali Acc: 0.260 Test Loss: 2.073 Test Acc: 0.260
Validation loss decreased (-0.219981 --> -0.259979).  Saving model ...
Epoch: 6 cost time: 1.5572733879089355
Epoch: 6, Steps: 4 | Train Loss: 0.707 Vali Loss: 2.328 Vali Acc: 0.220 Test Loss: 2.328 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.290010929107666
Epoch: 7, Steps: 4 | Train Loss: 0.295 Vali Loss: 2.636 Vali Acc: 0.220 Test Loss: 2.636 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5357861518859863
Epoch: 8, Steps: 4 | Train Loss: 0.289 Vali Loss: 2.760 Vali Acc: 0.240 Test Loss: 2.760 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3640565872192383
Epoch: 9, Steps: 4 | Train Loss: 0.246 Vali Loss: 2.920 Vali Acc: 0.180 Test Loss: 2.920 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.5717990398406982
Epoch: 10, Steps: 4 | Train Loss: 0.151 Vali Loss: 3.253 Vali Acc: 0.260 Test Loss: 3.253 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.5609502792358398
Epoch: 11, Steps: 4 | Train Loss: 0.163 Vali Loss: 3.269 Vali Acc: 0.220 Test Loss: 3.269 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3473846912384033
Epoch: 12, Steps: 4 | Train Loss: 0.068 Vali Loss: 3.305 Vali Acc: 0.220 Test Loss: 3.305 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.3288536071777344
Epoch: 13, Steps: 4 | Train Loss: 0.042 Vali Loss: 3.799 Vali Acc: 0.260 Test Loss: 3.799 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.352750539779663
Epoch: 14, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.328 Vali Acc: 0.280 Test Loss: 4.328 Test Acc: 0.280
Validation loss decreased (-0.259979 --> -0.279957).  Saving model ...
Epoch: 15 cost time: 1.6057074069976807
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.517 Vali Acc: 0.260 Test Loss: 4.517 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.480186939239502
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.613 Vali Acc: 0.280 Test Loss: 4.613 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4624311923980713
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.639 Vali Acc: 0.300 Test Loss: 4.639 Test Acc: 0.300
Validation loss decreased (-0.279957 --> -0.299954).  Saving model ...
Epoch: 18 cost time: 1.604679822921753
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.695 Vali Acc: 0.280 Test Loss: 4.695 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.53533935546875
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.710 Vali Acc: 0.260 Test Loss: 4.710 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.4909272193908691
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.676 Vali Acc: 0.260 Test Loss: 4.676 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.490058422088623
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.640 Vali Acc: 0.260 Test Loss: 4.640 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.5680832862854004
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.640 Vali Acc: 0.260 Test Loss: 4.640 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.297194004058838
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.662 Vali Acc: 0.260 Test Loss: 4.662 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.429792881011963
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.710 Vali Acc: 0.280 Test Loss: 4.710 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.527900218963623
Epoch: 25, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.781 Vali Acc: 0.280 Test Loss: 4.781 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.602720022201538
Epoch: 26, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.839 Vali Acc: 0.280 Test Loss: 4.839 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.3685290813446045
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 4.896 Vali Acc: 0.280 Test Loss: 4.896 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 7629869
model size : 38.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5489258766174316
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.584 Vali Acc: 0.260 Test Loss: 1.584 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.6187658309936523
Epoch: 2, Steps: 4 | Train Loss: 1.432 Vali Loss: 1.647 Vali Acc: 0.220 Test Loss: 1.647 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.628235101699829
Epoch: 3, Steps: 4 | Train Loss: 1.177 Vali Loss: 1.757 Vali Acc: 0.200 Test Loss: 1.757 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6510772705078125
Epoch: 4, Steps: 4 | Train Loss: 0.802 Vali Loss: 1.839 Vali Acc: 0.220 Test Loss: 1.839 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.8002266883850098
Epoch: 5, Steps: 4 | Train Loss: 0.601 Vali Loss: 1.942 Vali Acc: 0.240 Test Loss: 1.942 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.665759563446045
Epoch: 6, Steps: 4 | Train Loss: 0.732 Vali Loss: 2.187 Vali Acc: 0.200 Test Loss: 2.187 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.821847915649414
Epoch: 7, Steps: 4 | Train Loss: 0.325 Vali Loss: 2.482 Vali Acc: 0.220 Test Loss: 2.482 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.581195592880249
Epoch: 8, Steps: 4 | Train Loss: 0.337 Vali Loss: 2.562 Vali Acc: 0.260 Test Loss: 2.562 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.858346939086914
Epoch: 9, Steps: 4 | Train Loss: 0.285 Vali Loss: 2.765 Vali Acc: 0.180 Test Loss: 2.765 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.7992746829986572
Epoch: 10, Steps: 4 | Train Loss: 0.188 Vali Loss: 2.930 Vali Acc: 0.240 Test Loss: 2.930 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.447089672088623
Epoch: 11, Steps: 4 | Train Loss: 0.180 Vali Loss: 3.014 Vali Acc: 0.200 Test Loss: 3.014 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 7629869
model size : 38.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4988906383514404
Epoch: 1, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.595 Vali Acc: 0.180 Test Loss: 1.595 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.4891870021820068
Epoch: 2, Steps: 4 | Train Loss: 1.408 Vali Loss: 1.646 Vali Acc: 0.180 Test Loss: 1.646 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2765700817108154
Epoch: 3, Steps: 4 | Train Loss: 1.274 Vali Loss: 1.678 Vali Acc: 0.200 Test Loss: 1.678 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.5005695819854736
Epoch: 4, Steps: 4 | Train Loss: 0.890 Vali Loss: 1.712 Vali Acc: 0.260 Test Loss: 1.712 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.3480701446533203
Epoch: 5, Steps: 4 | Train Loss: 0.694 Vali Loss: 1.794 Vali Acc: 0.260 Test Loss: 1.794 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6115882396697998
Epoch: 6, Steps: 4 | Train Loss: 0.812 Vali Loss: 2.034 Vali Acc: 0.160 Test Loss: 2.034 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.40688157081604
Epoch: 7, Steps: 4 | Train Loss: 0.411 Vali Loss: 2.277 Vali Acc: 0.200 Test Loss: 2.277 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.38997483253479
Epoch: 8, Steps: 4 | Train Loss: 0.449 Vali Loss: 2.195 Vali Acc: 0.240 Test Loss: 2.195 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4504845142364502
Epoch: 9, Steps: 4 | Train Loss: 0.344 Vali Loss: 2.472 Vali Acc: 0.180 Test Loss: 2.472 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3349151611328125
Epoch: 10, Steps: 4 | Train Loss: 0.300 Vali Loss: 2.377 Vali Acc: 0.220 Test Loss: 2.377 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3296167850494385
Epoch: 11, Steps: 4 | Train Loss: 0.235 Vali Loss: 2.552 Vali Acc: 0.200 Test Loss: 2.552 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0948171615600586
Epoch: 12, Steps: 4 | Train Loss: 0.126 Vali Loss: 2.822 Vali Acc: 0.200 Test Loss: 2.822 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1998953819274902
Epoch: 13, Steps: 4 | Train Loss: 0.096 Vali Loss: 2.751 Vali Acc: 0.240 Test Loss: 2.751 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4440085887908936
Epoch: 14, Steps: 4 | Train Loss: 0.035 Vali Loss: 3.419 Vali Acc: 0.240 Test Loss: 3.419 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 7629869
model size : 38.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4017980098724365
Epoch: 1, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.560 Vali Acc: 0.260 Test Loss: 1.560 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.5935885906219482
Epoch: 2, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.599 Vali Acc: 0.280 Test Loss: 1.599 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.5335469245910645
Epoch: 3, Steps: 4 | Train Loss: 1.243 Vali Loss: 1.678 Vali Acc: 0.300 Test Loss: 1.678 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 1.364093542098999
Epoch: 4, Steps: 4 | Train Loss: 0.838 Vali Loss: 1.879 Vali Acc: 0.220 Test Loss: 1.879 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4706110954284668
Epoch: 5, Steps: 4 | Train Loss: 0.794 Vali Loss: 2.177 Vali Acc: 0.280 Test Loss: 2.177 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4717350006103516
Epoch: 6, Steps: 4 | Train Loss: 0.630 Vali Loss: 2.258 Vali Acc: 0.220 Test Loss: 2.258 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.427398443222046
Epoch: 7, Steps: 4 | Train Loss: 0.405 Vali Loss: 2.419 Vali Acc: 0.240 Test Loss: 2.419 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5676257610321045
Epoch: 8, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.674 Vali Acc: 0.200 Test Loss: 2.674 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.421332836151123
Epoch: 9, Steps: 4 | Train Loss: 0.180 Vali Loss: 2.981 Vali Acc: 0.280 Test Loss: 2.981 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5303912162780762
Epoch: 10, Steps: 4 | Train Loss: 0.143 Vali Loss: 2.980 Vali Acc: 0.260 Test Loss: 2.980 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5142943859100342
Epoch: 11, Steps: 4 | Train Loss: 0.134 Vali Loss: 2.933 Vali Acc: 0.260 Test Loss: 2.933 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.4467761516571045
Epoch: 12, Steps: 4 | Train Loss: 0.060 Vali Loss: 3.274 Vali Acc: 0.280 Test Loss: 3.274 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.456003189086914
Epoch: 13, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.954 Vali Acc: 0.280 Test Loss: 3.954 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 7105581
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3479959964752197
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.537 Vali Acc: 0.240 Test Loss: 1.537 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.3526957035064697
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.574 Vali Acc: 0.320 Test Loss: 1.574 Test Acc: 0.320
Validation loss decreased (-0.239985 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.525897741317749
Epoch: 3, Steps: 4 | Train Loss: 1.259 Vali Loss: 1.643 Vali Acc: 0.300 Test Loss: 1.643 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6202259063720703
Epoch: 4, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.845 Vali Acc: 0.220 Test Loss: 1.845 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3248553276062012
Epoch: 5, Steps: 4 | Train Loss: 0.826 Vali Loss: 2.129 Vali Acc: 0.280 Test Loss: 2.129 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4093189239501953
Epoch: 6, Steps: 4 | Train Loss: 0.655 Vali Loss: 2.171 Vali Acc: 0.260 Test Loss: 2.171 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3775532245635986
Epoch: 7, Steps: 4 | Train Loss: 0.440 Vali Loss: 2.334 Vali Acc: 0.220 Test Loss: 2.334 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.7421965599060059
Epoch: 8, Steps: 4 | Train Loss: 0.259 Vali Loss: 2.542 Vali Acc: 0.220 Test Loss: 2.542 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.514573097229004
Epoch: 9, Steps: 4 | Train Loss: 0.202 Vali Loss: 2.764 Vali Acc: 0.300 Test Loss: 2.764 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.5169317722320557
Epoch: 10, Steps: 4 | Train Loss: 0.161 Vali Loss: 2.766 Vali Acc: 0.260 Test Loss: 2.766 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5991053581237793
Epoch: 11, Steps: 4 | Train Loss: 0.143 Vali Loss: 2.749 Vali Acc: 0.300 Test Loss: 2.749 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4198787212371826
Epoch: 12, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.047 Vali Acc: 0.260 Test Loss: 3.047 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 7105581
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3025453090667725
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.553 Vali Acc: 0.240 Test Loss: 1.553 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.4698901176452637
Epoch: 2, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.560 Vali Acc: 0.320 Test Loss: 1.560 Test Acc: 0.320
Validation loss decreased (-0.239984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.2107491493225098
Epoch: 3, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.599 Vali Acc: 0.320 Test Loss: 1.599 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2682697772979736
Epoch: 4, Steps: 4 | Train Loss: 0.931 Vali Loss: 1.753 Vali Acc: 0.200 Test Loss: 1.753 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.574376106262207
Epoch: 5, Steps: 4 | Train Loss: 0.883 Vali Loss: 2.012 Vali Acc: 0.220 Test Loss: 2.012 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.388249158859253
Epoch: 6, Steps: 4 | Train Loss: 0.723 Vali Loss: 2.033 Vali Acc: 0.240 Test Loss: 2.033 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.5657877922058105
Epoch: 7, Steps: 4 | Train Loss: 0.487 Vali Loss: 2.183 Vali Acc: 0.220 Test Loss: 2.183 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3898990154266357
Epoch: 8, Steps: 4 | Train Loss: 0.291 Vali Loss: 2.379 Vali Acc: 0.240 Test Loss: 2.379 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4545316696166992
Epoch: 9, Steps: 4 | Train Loss: 0.230 Vali Loss: 2.507 Vali Acc: 0.280 Test Loss: 2.507 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1518456935882568
Epoch: 10, Steps: 4 | Train Loss: 0.182 Vali Loss: 2.574 Vali Acc: 0.260 Test Loss: 2.574 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.1825718879699707
Epoch: 11, Steps: 4 | Train Loss: 0.160 Vali Loss: 2.651 Vali Acc: 0.320 Test Loss: 2.651 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6085968017578125
Epoch: 12, Steps: 4 | Train Loss: 0.069 Vali Loss: 2.987 Vali Acc: 0.240 Test Loss: 2.987 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 7105581
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.131922721862793
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.594 Vali Acc: 0.180 Test Loss: 1.594 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.266406536102295
Epoch: 2, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.599 Vali Acc: 0.300 Test Loss: 1.599 Test Acc: 0.300
Validation loss decreased (-0.179984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.3273210525512695
Epoch: 3, Steps: 4 | Train Loss: 1.363 Vali Loss: 1.611 Vali Acc: 0.240 Test Loss: 1.611 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3033270835876465
Epoch: 4, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.705 Vali Acc: 0.180 Test Loss: 1.705 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1662671566009521
Epoch: 5, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.923 Vali Acc: 0.240 Test Loss: 1.923 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3822855949401855
Epoch: 6, Steps: 4 | Train Loss: 0.825 Vali Loss: 1.954 Vali Acc: 0.220 Test Loss: 1.954 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.139331579208374
Epoch: 7, Steps: 4 | Train Loss: 0.612 Vali Loss: 2.050 Vali Acc: 0.180 Test Loss: 2.050 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4330189228057861
Epoch: 8, Steps: 4 | Train Loss: 0.382 Vali Loss: 2.241 Vali Acc: 0.280 Test Loss: 2.241 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2689764499664307
Epoch: 9, Steps: 4 | Train Loss: 0.300 Vali Loss: 2.259 Vali Acc: 0.300 Test Loss: 2.259 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2124545574188232
Epoch: 10, Steps: 4 | Train Loss: 0.291 Vali Loss: 2.301 Vali Acc: 0.240 Test Loss: 2.301 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.4410700798034668
Epoch: 11, Steps: 4 | Train Loss: 0.235 Vali Loss: 2.610 Vali Acc: 0.280 Test Loss: 2.610 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3280444145202637
Epoch: 12, Steps: 4 | Train Loss: 0.178 Vali Loss: 2.785 Vali Acc: 0.300 Test Loss: 2.785 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 7105581
model size : 36.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.471270799636841
Epoch: 1, Steps: 4 | Train Loss: 1.671 Vali Loss: 1.763 Vali Acc: 0.200 Test Loss: 1.763 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.3690505027770996
Epoch: 2, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.768 Vali Acc: 0.240 Test Loss: 1.768 Test Acc: 0.240
Validation loss decreased (-0.199982 --> -0.239982).  Saving model ...
Epoch: 3 cost time: 1.3941144943237305
Epoch: 3, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.768 Vali Acc: 0.240 Test Loss: 1.768 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.518049955368042
Epoch: 4, Steps: 4 | Train Loss: 0.916 Vali Loss: 2.098 Vali Acc: 0.280 Test Loss: 2.098 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279979).  Saving model ...
Epoch: 5 cost time: 1.5822975635528564
Epoch: 5, Steps: 4 | Train Loss: 0.756 Vali Loss: 2.211 Vali Acc: 0.260 Test Loss: 2.211 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3890209197998047
Epoch: 6, Steps: 4 | Train Loss: 0.405 Vali Loss: 2.356 Vali Acc: 0.240 Test Loss: 2.356 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.619412899017334
Epoch: 7, Steps: 4 | Train Loss: 0.302 Vali Loss: 2.626 Vali Acc: 0.260 Test Loss: 2.626 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4401679039001465
Epoch: 8, Steps: 4 | Train Loss: 0.195 Vali Loss: 2.882 Vali Acc: 0.220 Test Loss: 2.882 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.313380479812622
Epoch: 9, Steps: 4 | Train Loss: 0.160 Vali Loss: 2.842 Vali Acc: 0.240 Test Loss: 2.842 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.176880121231079
Epoch: 10, Steps: 4 | Train Loss: 0.283 Vali Loss: 3.366 Vali Acc: 0.260 Test Loss: 3.366 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1938323974609375
Epoch: 11, Steps: 4 | Train Loss: 0.099 Vali Loss: 3.233 Vali Acc: 0.220 Test Loss: 3.233 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2634446620941162
Epoch: 12, Steps: 4 | Train Loss: 0.064 Vali Loss: 4.358 Vali Acc: 0.200 Test Loss: 4.358 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2913696765899658
Epoch: 13, Steps: 4 | Train Loss: 0.036 Vali Loss: 3.984 Vali Acc: 0.240 Test Loss: 3.984 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2733843326568604
Epoch: 14, Steps: 4 | Train Loss: 0.036 Vali Loss: 4.007 Vali Acc: 0.200 Test Loss: 4.007 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6843437
model size : 35.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3384201526641846
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.735 Vali Acc: 0.180 Test Loss: 1.735 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.3358123302459717
Epoch: 2, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.742 Vali Acc: 0.200 Test Loss: 1.742 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.5866999626159668
Epoch: 3, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.744 Vali Acc: 0.240 Test Loss: 1.744 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.3158507347106934
Epoch: 4, Steps: 4 | Train Loss: 0.950 Vali Loss: 2.021 Vali Acc: 0.280 Test Loss: 2.021 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279980).  Saving model ...
Epoch: 5 cost time: 1.5296478271484375
Epoch: 5, Steps: 4 | Train Loss: 0.794 Vali Loss: 2.112 Vali Acc: 0.260 Test Loss: 2.112 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3472609519958496
Epoch: 6, Steps: 4 | Train Loss: 0.437 Vali Loss: 2.254 Vali Acc: 0.240 Test Loss: 2.254 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.55784273147583
Epoch: 7, Steps: 4 | Train Loss: 0.322 Vali Loss: 2.506 Vali Acc: 0.240 Test Loss: 2.506 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.6656320095062256
Epoch: 8, Steps: 4 | Train Loss: 0.214 Vali Loss: 2.726 Vali Acc: 0.220 Test Loss: 2.726 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6161785125732422
Epoch: 9, Steps: 4 | Train Loss: 0.176 Vali Loss: 2.691 Vali Acc: 0.220 Test Loss: 2.691 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.517545461654663
Epoch: 10, Steps: 4 | Train Loss: 0.261 Vali Loss: 3.118 Vali Acc: 0.260 Test Loss: 3.118 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.6722121238708496
Epoch: 11, Steps: 4 | Train Loss: 0.107 Vali Loss: 3.005 Vali Acc: 0.240 Test Loss: 3.005 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5465528964996338
Epoch: 12, Steps: 4 | Train Loss: 0.067 Vali Loss: 3.929 Vali Acc: 0.240 Test Loss: 3.929 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.6684324741363525
Epoch: 13, Steps: 4 | Train Loss: 0.039 Vali Loss: 3.711 Vali Acc: 0.220 Test Loss: 3.711 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.646662950515747
Epoch: 14, Steps: 4 | Train Loss: 0.041 Vali Loss: 3.683 Vali Acc: 0.240 Test Loss: 3.683 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6843437
model size : 35.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.775994300842285
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.724 Vali Acc: 0.220 Test Loss: 1.724 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.515465259552002
Epoch: 2, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.728 Vali Acc: 0.220 Test Loss: 1.728 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5960474014282227
Epoch: 3, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.704 Vali Acc: 0.280 Test Loss: 1.704 Test Acc: 0.280
Validation loss decreased (-0.219983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.7740273475646973
Epoch: 4, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.968 Vali Acc: 0.220 Test Loss: 1.968 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6431875228881836
Epoch: 5, Steps: 4 | Train Loss: 0.837 Vali Loss: 2.000 Vali Acc: 0.260 Test Loss: 2.000 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5457823276519775
Epoch: 6, Steps: 4 | Train Loss: 0.481 Vali Loss: 2.111 Vali Acc: 0.220 Test Loss: 2.111 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4918575286865234
Epoch: 7, Steps: 4 | Train Loss: 0.359 Vali Loss: 2.400 Vali Acc: 0.260 Test Loss: 2.400 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.686187982559204
Epoch: 8, Steps: 4 | Train Loss: 0.242 Vali Loss: 2.516 Vali Acc: 0.220 Test Loss: 2.516 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5798802375793457
Epoch: 9, Steps: 4 | Train Loss: 0.216 Vali Loss: 2.523 Vali Acc: 0.220 Test Loss: 2.523 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5043840408325195
Epoch: 10, Steps: 4 | Train Loss: 0.291 Vali Loss: 2.966 Vali Acc: 0.240 Test Loss: 2.966 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5140447616577148
Epoch: 11, Steps: 4 | Train Loss: 0.135 Vali Loss: 2.742 Vali Acc: 0.220 Test Loss: 2.742 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.5676507949829102
Epoch: 12, Steps: 4 | Train Loss: 0.092 Vali Loss: 3.551 Vali Acc: 0.240 Test Loss: 3.551 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3763158321380615
Epoch: 13, Steps: 4 | Train Loss: 0.048 Vali Loss: 3.413 Vali Acc: 0.200 Test Loss: 3.413 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6843437
model size : 35.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.488938808441162
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.689 Vali Acc: 0.120 Test Loss: 1.689 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 1.2135329246520996
Epoch: 2, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.701 Vali Acc: 0.220 Test Loss: 1.701 Test Acc: 0.220
Validation loss decreased (-0.119983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.1012911796569824
Epoch: 3, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.4356093406677246
Epoch: 4, Steps: 4 | Train Loss: 1.081 Vali Loss: 1.884 Vali Acc: 0.220 Test Loss: 1.884 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3947019577026367
Epoch: 5, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.892 Vali Acc: 0.280 Test Loss: 1.892 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279981).  Saving model ...
Epoch: 6 cost time: 1.4291610717773438
Epoch: 6, Steps: 4 | Train Loss: 0.609 Vali Loss: 1.911 Vali Acc: 0.220 Test Loss: 1.911 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2113726139068604
Epoch: 7, Steps: 4 | Train Loss: 0.439 Vali Loss: 2.145 Vali Acc: 0.200 Test Loss: 2.145 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4110031127929688
Epoch: 8, Steps: 4 | Train Loss: 0.314 Vali Loss: 2.267 Vali Acc: 0.260 Test Loss: 2.267 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3630657196044922
Epoch: 9, Steps: 4 | Train Loss: 0.309 Vali Loss: 2.294 Vali Acc: 0.260 Test Loss: 2.294 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3444173336029053
Epoch: 10, Steps: 4 | Train Loss: 0.404 Vali Loss: 2.710 Vali Acc: 0.220 Test Loss: 2.710 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2706563472747803
Epoch: 11, Steps: 4 | Train Loss: 0.207 Vali Loss: 2.321 Vali Acc: 0.280 Test Loss: 2.321 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.5347859859466553
Epoch: 12, Steps: 4 | Train Loss: 0.168 Vali Loss: 3.054 Vali Acc: 0.240 Test Loss: 3.054 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.473320484161377
Epoch: 13, Steps: 4 | Train Loss: 0.080 Vali Loss: 3.048 Vali Acc: 0.220 Test Loss: 3.048 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2874338626861572
Epoch: 14, Steps: 4 | Train Loss: 0.145 Vali Loss: 3.087 Vali Acc: 0.260 Test Loss: 3.087 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.439267635345459
Epoch: 15, Steps: 4 | Train Loss: 0.089 Vali Loss: 3.303 Vali Acc: 0.220 Test Loss: 3.303 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6843437
model size : 35.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.360646963119507
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.749 Vali Acc: 0.180 Test Loss: 1.749 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.1860263347625732
Epoch: 2, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.612 Vali Acc: 0.240 Test Loss: 1.612 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.4644052982330322
Epoch: 3, Steps: 4 | Train Loss: 1.101 Vali Loss: 1.764 Vali Acc: 0.260 Test Loss: 1.764 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 4 cost time: 1.4232914447784424
Epoch: 4, Steps: 4 | Train Loss: 0.972 Vali Loss: 2.081 Vali Acc: 0.240 Test Loss: 2.081 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.482938528060913
Epoch: 5, Steps: 4 | Train Loss: 0.766 Vali Loss: 2.097 Vali Acc: 0.220 Test Loss: 2.097 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3326234817504883
Epoch: 6, Steps: 4 | Train Loss: 0.418 Vali Loss: 2.338 Vali Acc: 0.280 Test Loss: 2.338 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279977).  Saving model ...
Epoch: 7 cost time: 1.2415485382080078
Epoch: 7, Steps: 4 | Train Loss: 0.417 Vali Loss: 2.549 Vali Acc: 0.200 Test Loss: 2.549 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2119872570037842
Epoch: 8, Steps: 4 | Train Loss: 0.293 Vali Loss: 2.656 Vali Acc: 0.280 Test Loss: 2.656 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2996246814727783
Epoch: 9, Steps: 4 | Train Loss: 0.192 Vali Loss: 2.795 Vali Acc: 0.260 Test Loss: 2.795 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4313850402832031
Epoch: 10, Steps: 4 | Train Loss: 0.106 Vali Loss: 3.107 Vali Acc: 0.260 Test Loss: 3.107 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3733596801757812
Epoch: 11, Steps: 4 | Train Loss: 0.064 Vali Loss: 3.497 Vali Acc: 0.260 Test Loss: 3.497 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5497925281524658
Epoch: 12, Steps: 4 | Train Loss: 0.052 Vali Loss: 3.706 Vali Acc: 0.260 Test Loss: 3.706 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.6104235649108887
Epoch: 13, Steps: 4 | Train Loss: 0.024 Vali Loss: 3.614 Vali Acc: 0.260 Test Loss: 3.614 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.6777751445770264
Epoch: 14, Steps: 4 | Train Loss: 0.014 Vali Loss: 4.066 Vali Acc: 0.260 Test Loss: 4.066 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2705631256103516
Epoch: 15, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.296 Vali Acc: 0.260 Test Loss: 4.296 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3901755809783936
Epoch: 16, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.237 Vali Acc: 0.260 Test Loss: 4.237 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6712365
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5846188068389893
Epoch: 1, Steps: 4 | Train Loss: 1.670 Vali Loss: 1.722 Vali Acc: 0.200 Test Loss: 1.722 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.2349815368652344
Epoch: 2, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.612 Vali Acc: 0.200 Test Loss: 1.612 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.5775320529937744
Epoch: 3, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.739 Vali Acc: 0.240 Test Loss: 1.739 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.5147228240966797
Epoch: 4, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.996 Vali Acc: 0.220 Test Loss: 1.996 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5727128982543945
Epoch: 5, Steps: 4 | Train Loss: 0.804 Vali Loss: 2.036 Vali Acc: 0.220 Test Loss: 2.036 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4844579696655273
Epoch: 6, Steps: 4 | Train Loss: 0.451 Vali Loss: 2.281 Vali Acc: 0.260 Test Loss: 2.281 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259977).  Saving model ...
Epoch: 7 cost time: 1.509721040725708
Epoch: 7, Steps: 4 | Train Loss: 0.461 Vali Loss: 2.450 Vali Acc: 0.200 Test Loss: 2.450 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3903892040252686
Epoch: 8, Steps: 4 | Train Loss: 0.318 Vali Loss: 2.548 Vali Acc: 0.260 Test Loss: 2.548 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.36983323097229
Epoch: 9, Steps: 4 | Train Loss: 0.220 Vali Loss: 2.683 Vali Acc: 0.260 Test Loss: 2.683 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.553394079208374
Epoch: 10, Steps: 4 | Train Loss: 0.123 Vali Loss: 2.912 Vali Acc: 0.240 Test Loss: 2.912 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2348556518554688
Epoch: 11, Steps: 4 | Train Loss: 0.076 Vali Loss: 3.431 Vali Acc: 0.260 Test Loss: 3.431 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5077314376831055
Epoch: 12, Steps: 4 | Train Loss: 0.063 Vali Loss: 3.865 Vali Acc: 0.260 Test Loss: 3.865 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4007189273834229
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 3.585 Vali Acc: 0.280 Test Loss: 3.585 Test Acc: 0.280
Validation loss decreased (-0.259977 --> -0.279964).  Saving model ...
Epoch: 14 cost time: 1.3375496864318848
Epoch: 14, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.132 Vali Acc: 0.240 Test Loss: 4.132 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5381724834442139
Epoch: 15, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.594 Vali Acc: 0.260 Test Loss: 4.594 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2360055446624756
Epoch: 16, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.841 Vali Acc: 0.260 Test Loss: 4.841 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2997338771820068
Epoch: 17, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.007 Vali Acc: 0.280 Test Loss: 5.007 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5052568912506104
Epoch: 18, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.061 Vali Acc: 0.280 Test Loss: 5.061 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3920972347259521
Epoch: 19, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.125 Vali Acc: 0.260 Test Loss: 5.125 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4047162532806396
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.243 Vali Acc: 0.260 Test Loss: 5.243 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.380868673324585
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.324 Vali Acc: 0.240 Test Loss: 5.324 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2445151805877686
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.229 Vali Acc: 0.220 Test Loss: 5.229 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4416980743408203
Epoch: 23, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.150 Vali Acc: 0.240 Test Loss: 5.150 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6712365
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.634795665740967
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.754 Vali Acc: 0.080 Test Loss: 1.754 Test Acc: 0.080
Validation loss decreased (inf --> -0.079982).  Saving model ...
Epoch: 2 cost time: 1.2712311744689941
Epoch: 2, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.641 Vali Acc: 0.220 Test Loss: 1.641 Test Acc: 0.220
Validation loss decreased (-0.079982 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.2954859733581543
Epoch: 3, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.717 Vali Acc: 0.260 Test Loss: 1.717 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.2880184650421143
Epoch: 4, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.923 Vali Acc: 0.220 Test Loss: 1.923 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2510437965393066
Epoch: 5, Steps: 4 | Train Loss: 0.893 Vali Loss: 1.978 Vali Acc: 0.260 Test Loss: 1.978 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.475268840789795
Epoch: 6, Steps: 4 | Train Loss: 0.500 Vali Loss: 2.173 Vali Acc: 0.220 Test Loss: 2.173 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.436269998550415
Epoch: 7, Steps: 4 | Train Loss: 0.516 Vali Loss: 2.248 Vali Acc: 0.200 Test Loss: 2.248 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.4230856895446777
Epoch: 8, Steps: 4 | Train Loss: 0.355 Vali Loss: 2.362 Vali Acc: 0.280 Test Loss: 2.362 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279976).  Saving model ...
Epoch: 9 cost time: 1.1018831729888916
Epoch: 9, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.469 Vali Acc: 0.280 Test Loss: 2.469 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1961641311645508
Epoch: 10, Steps: 4 | Train Loss: 0.152 Vali Loss: 2.673 Vali Acc: 0.260 Test Loss: 2.673 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.307182788848877
Epoch: 11, Steps: 4 | Train Loss: 0.091 Vali Loss: 3.348 Vali Acc: 0.280 Test Loss: 3.348 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2232534885406494
Epoch: 12, Steps: 4 | Train Loss: 0.070 Vali Loss: 3.497 Vali Acc: 0.280 Test Loss: 3.497 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.211209774017334
Epoch: 13, Steps: 4 | Train Loss: 0.029 Vali Loss: 3.538 Vali Acc: 0.240 Test Loss: 3.538 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1925978660583496
Epoch: 14, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.480 Vali Acc: 0.260 Test Loss: 4.480 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.375391960144043
Epoch: 15, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.836 Vali Acc: 0.280 Test Loss: 4.836 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1726644039154053
Epoch: 16, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.580 Vali Acc: 0.280 Test Loss: 4.580 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2124485969543457
Epoch: 17, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.658 Vali Acc: 0.300 Test Loss: 4.658 Test Acc: 0.300
Validation loss decreased (-0.279976 --> -0.299953).  Saving model ...
Epoch: 18 cost time: 1.4899570941925049
Epoch: 18, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.002 Vali Acc: 0.240 Test Loss: 5.002 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2583913803100586
Epoch: 19, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.378 Vali Acc: 0.220 Test Loss: 5.378 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1222691535949707
Epoch: 20, Steps: 4 | Train Loss: 0.002 Vali Loss: 5.637 Vali Acc: 0.220 Test Loss: 5.637 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.436464786529541
Epoch: 21, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.743 Vali Acc: 0.220 Test Loss: 5.743 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2881195545196533
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.697 Vali Acc: 0.200 Test Loss: 5.697 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2829058170318604
Epoch: 23, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.630 Vali Acc: 0.240 Test Loss: 5.630 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3935692310333252
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.625 Vali Acc: 0.240 Test Loss: 5.625 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.374023199081421
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.674 Vali Acc: 0.240 Test Loss: 5.674 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4570488929748535
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 5.751 Vali Acc: 0.220 Test Loss: 5.751 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4843316078186035
Epoch: 27, Steps: 4 | Train Loss: 0.000 Vali Loss: 5.803 Vali Acc: 0.220 Test Loss: 5.803 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 6712365
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2342777252197266
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.746 Vali Acc: 0.080 Test Loss: 1.746 Test Acc: 0.080
Validation loss decreased (inf --> -0.079983).  Saving model ...
Epoch: 2 cost time: 1.2910141944885254
Epoch: 2, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.663 Vali Acc: 0.180 Test Loss: 1.663 Test Acc: 0.180
Validation loss decreased (-0.079983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.1123554706573486
Epoch: 3, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.670 Vali Acc: 0.260 Test Loss: 1.670 Test Acc: 0.260
Validation loss decreased (-0.179983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.1103971004486084
Epoch: 4, Steps: 4 | Train Loss: 1.122 Vali Loss: 1.825 Vali Acc: 0.260 Test Loss: 1.825 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2683186531066895
Epoch: 5, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.882 Vali Acc: 0.220 Test Loss: 1.882 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2406911849975586
Epoch: 6, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.997 Vali Acc: 0.240 Test Loss: 1.997 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5469608306884766
Epoch: 7, Steps: 4 | Train Loss: 0.653 Vali Loss: 1.957 Vali Acc: 0.160 Test Loss: 1.957 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.170698642730713
Epoch: 8, Steps: 4 | Train Loss: 0.428 Vali Loss: 2.099 Vali Acc: 0.240 Test Loss: 2.099 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.614215612411499
Epoch: 9, Steps: 4 | Train Loss: 0.326 Vali Loss: 2.118 Vali Acc: 0.260 Test Loss: 2.118 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5539827346801758
Epoch: 10, Steps: 4 | Train Loss: 0.221 Vali Loss: 2.271 Vali Acc: 0.260 Test Loss: 2.271 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.5180552005767822
Epoch: 11, Steps: 4 | Train Loss: 0.155 Vali Loss: 2.606 Vali Acc: 0.260 Test Loss: 2.606 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6057322025299072
Epoch: 12, Steps: 4 | Train Loss: 0.116 Vali Loss: 2.545 Vali Acc: 0.280 Test Loss: 2.545 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279975).  Saving model ...
Epoch: 13 cost time: 1.2229275703430176
Epoch: 13, Steps: 4 | Train Loss: 0.052 Vali Loss: 2.927 Vali Acc: 0.220 Test Loss: 2.927 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1759142875671387
Epoch: 14, Steps: 4 | Train Loss: 0.036 Vali Loss: 3.003 Vali Acc: 0.240 Test Loss: 3.003 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1073782444000244
Epoch: 15, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.160 Vali Acc: 0.240 Test Loss: 3.160 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.2696001529693604
Epoch: 16, Steps: 4 | Train Loss: 0.010 Vali Loss: 3.714 Vali Acc: 0.220 Test Loss: 3.714 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6421644687652588
Epoch: 17, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.853 Vali Acc: 0.260 Test Loss: 3.853 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2795546054840088
Epoch: 18, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.916 Vali Acc: 0.260 Test Loss: 3.916 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4618456363677979
Epoch: 19, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.005 Vali Acc: 0.280 Test Loss: 4.005 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.382791519165039
Epoch: 20, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.155 Vali Acc: 0.260 Test Loss: 4.155 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2735230922698975
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.205 Vali Acc: 0.240 Test Loss: 4.205 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4818031787872314
Epoch: 22, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.143 Vali Acc: 0.240 Test Loss: 4.143 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6712365
model size : 35.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1491684913635254
Epoch: 1, Steps: 4 | Train Loss: 1.824 Vali Loss: 1.639 Vali Acc: 0.100 Test Loss: 1.639 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.3008220195770264
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.628 Vali Acc: 0.240 Test Loss: 1.628 Test Acc: 0.240
Validation loss decreased (-0.099984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.3087337017059326
Epoch: 3, Steps: 4 | Train Loss: 1.181 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2048375606536865
Epoch: 4, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.760 Vali Acc: 0.200 Test Loss: 1.760 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2823467254638672
Epoch: 5, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.801 Vali Acc: 0.300 Test Loss: 1.801 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299982).  Saving model ...
Epoch: 6 cost time: 1.1597256660461426
Epoch: 6, Steps: 4 | Train Loss: 0.846 Vali Loss: 1.996 Vali Acc: 0.340 Test Loss: 1.996 Test Acc: 0.340
Validation loss decreased (-0.299982 --> -0.339980).  Saving model ...
Epoch: 7 cost time: 1.1402432918548584
Epoch: 7, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.095 Vali Acc: 0.260 Test Loss: 2.095 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.033931016921997
Epoch: 8, Steps: 4 | Train Loss: 0.487 Vali Loss: 2.222 Vali Acc: 0.300 Test Loss: 2.222 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2658007144927979
Epoch: 9, Steps: 4 | Train Loss: 0.306 Vali Loss: 2.354 Vali Acc: 0.320 Test Loss: 2.354 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.262573480606079
Epoch: 10, Steps: 4 | Train Loss: 0.286 Vali Loss: 2.622 Vali Acc: 0.200 Test Loss: 2.622 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4092192649841309
Epoch: 11, Steps: 4 | Train Loss: 0.296 Vali Loss: 2.701 Vali Acc: 0.300 Test Loss: 2.701 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2511749267578125
Epoch: 12, Steps: 4 | Train Loss: 0.184 Vali Loss: 2.937 Vali Acc: 0.220 Test Loss: 2.937 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.353240728378296
Epoch: 13, Steps: 4 | Train Loss: 0.108 Vali Loss: 3.093 Vali Acc: 0.240 Test Loss: 3.093 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2918643951416016
Epoch: 14, Steps: 4 | Train Loss: 0.069 Vali Loss: 3.065 Vali Acc: 0.240 Test Loss: 3.065 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3676762580871582
Epoch: 15, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.361 Vali Acc: 0.280 Test Loss: 3.361 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.358349323272705
Epoch: 16, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.786 Vali Acc: 0.300 Test Loss: 3.786 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 5131053
model size : 24.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.010713577270508
Epoch: 1, Steps: 4 | Train Loss: 1.762 Vali Loss: 1.610 Vali Acc: 0.120 Test Loss: 1.610 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.0669975280761719
Epoch: 2, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.612 Vali Acc: 0.240 Test Loss: 1.612 Test Acc: 0.240
Validation loss decreased (-0.119984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2583763599395752
Epoch: 3, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.669 Vali Acc: 0.220 Test Loss: 1.669 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2385904788970947
Epoch: 4, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2894103527069092
Epoch: 5, Steps: 4 | Train Loss: 0.962 Vali Loss: 1.767 Vali Acc: 0.260 Test Loss: 1.767 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 6 cost time: 1.1511752605438232
Epoch: 6, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.972 Vali Acc: 0.280 Test Loss: 1.972 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279980).  Saving model ...
Epoch: 7 cost time: 1.2719342708587646
Epoch: 7, Steps: 4 | Train Loss: 0.563 Vali Loss: 2.087 Vali Acc: 0.240 Test Loss: 2.087 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1523597240447998
Epoch: 8, Steps: 4 | Train Loss: 0.524 Vali Loss: 2.204 Vali Acc: 0.280 Test Loss: 2.204 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2367196083068848
Epoch: 9, Steps: 4 | Train Loss: 0.332 Vali Loss: 2.311 Vali Acc: 0.280 Test Loss: 2.311 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2046527862548828
Epoch: 10, Steps: 4 | Train Loss: 0.329 Vali Loss: 2.583 Vali Acc: 0.200 Test Loss: 2.583 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1516611576080322
Epoch: 11, Steps: 4 | Train Loss: 0.339 Vali Loss: 2.629 Vali Acc: 0.280 Test Loss: 2.629 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1602041721343994
Epoch: 12, Steps: 4 | Train Loss: 0.208 Vali Loss: 2.849 Vali Acc: 0.220 Test Loss: 2.849 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.147491216659546
Epoch: 13, Steps: 4 | Train Loss: 0.120 Vali Loss: 3.012 Vali Acc: 0.220 Test Loss: 3.012 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1086668968200684
Epoch: 14, Steps: 4 | Train Loss: 0.080 Vali Loss: 3.021 Vali Acc: 0.200 Test Loss: 3.021 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1298189163208008
Epoch: 15, Steps: 4 | Train Loss: 0.046 Vali Loss: 3.334 Vali Acc: 0.300 Test Loss: 3.334 Test Acc: 0.300
Validation loss decreased (-0.279980 --> -0.299967).  Saving model ...
Epoch: 16 cost time: 1.3172698020935059
Epoch: 16, Steps: 4 | Train Loss: 0.028 Vali Loss: 3.819 Vali Acc: 0.280 Test Loss: 3.819 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3840670585632324
Epoch: 17, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.036 Vali Acc: 0.300 Test Loss: 4.036 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2682147026062012
Epoch: 18, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.192 Vali Acc: 0.280 Test Loss: 4.192 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2707562446594238
Epoch: 19, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.299 Vali Acc: 0.280 Test Loss: 4.299 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9736223220825195
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.268 Vali Acc: 0.260 Test Loss: 4.268 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1676223278045654
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.202 Vali Acc: 0.240 Test Loss: 4.202 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3952429294586182
Epoch: 22, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.199 Vali Acc: 0.220 Test Loss: 4.199 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2619051933288574
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.241 Vali Acc: 0.240 Test Loss: 4.241 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3253130912780762
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.328 Vali Acc: 0.240 Test Loss: 4.328 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3680143356323242
Epoch: 25, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.435 Vali Acc: 0.240 Test Loss: 4.435 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 5131053
model size : 24.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1845860481262207
Epoch: 1, Steps: 4 | Train Loss: 1.748 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2516469955444336
Epoch: 2, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.597 Vali Acc: 0.240 Test Loss: 1.597 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2499003410339355
Epoch: 3, Steps: 4 | Train Loss: 1.249 Vali Loss: 1.640 Vali Acc: 0.220 Test Loss: 1.640 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1046302318572998
Epoch: 4, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.680 Vali Acc: 0.200 Test Loss: 1.680 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2489774227142334
Epoch: 5, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.728 Vali Acc: 0.260 Test Loss: 1.728 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.0121521949768066
Epoch: 6, Steps: 4 | Train Loss: 0.952 Vali Loss: 1.917 Vali Acc: 0.300 Test Loss: 1.917 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299981).  Saving model ...
Epoch: 7 cost time: 1.1684768199920654
Epoch: 7, Steps: 4 | Train Loss: 0.607 Vali Loss: 2.000 Vali Acc: 0.240 Test Loss: 2.000 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4434120655059814
Epoch: 8, Steps: 4 | Train Loss: 0.549 Vali Loss: 2.085 Vali Acc: 0.300 Test Loss: 2.085 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0773568153381348
Epoch: 9, Steps: 4 | Train Loss: 0.374 Vali Loss: 2.154 Vali Acc: 0.260 Test Loss: 2.154 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2124016284942627
Epoch: 10, Steps: 4 | Train Loss: 0.351 Vali Loss: 2.391 Vali Acc: 0.240 Test Loss: 2.391 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1744544506072998
Epoch: 11, Steps: 4 | Train Loss: 0.357 Vali Loss: 2.483 Vali Acc: 0.240 Test Loss: 2.483 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.0932283401489258
Epoch: 12, Steps: 4 | Train Loss: 0.229 Vali Loss: 2.667 Vali Acc: 0.240 Test Loss: 2.667 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2090721130371094
Epoch: 13, Steps: 4 | Train Loss: 0.123 Vali Loss: 2.869 Vali Acc: 0.260 Test Loss: 2.869 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2036633491516113
Epoch: 14, Steps: 4 | Train Loss: 0.095 Vali Loss: 2.848 Vali Acc: 0.260 Test Loss: 2.848 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1805028915405273
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 3.074 Vali Acc: 0.280 Test Loss: 3.074 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2009906768798828
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.401 Vali Acc: 0.260 Test Loss: 3.401 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 5131053
model size : 24.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.110760450363159
Epoch: 1, Steps: 4 | Train Loss: 1.699 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.0279996395111084
Epoch: 2, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 0.9753968715667725
Epoch: 3, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.646 Vali Acc: 0.180 Test Loss: 1.646 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.085005283355713
Epoch: 4, Steps: 4 | Train Loss: 1.207 Vali Loss: 1.655 Vali Acc: 0.180 Test Loss: 1.655 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0835473537445068
Epoch: 5, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.677 Vali Acc: 0.280 Test Loss: 1.677 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.0793442726135254
Epoch: 6, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.821 Vali Acc: 0.280 Test Loss: 1.821 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2619049549102783
Epoch: 7, Steps: 4 | Train Loss: 0.707 Vali Loss: 1.893 Vali Acc: 0.200 Test Loss: 1.893 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2262909412384033
Epoch: 8, Steps: 4 | Train Loss: 0.634 Vali Loss: 1.922 Vali Acc: 0.240 Test Loss: 1.922 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2232904434204102
Epoch: 9, Steps: 4 | Train Loss: 0.480 Vali Loss: 2.003 Vali Acc: 0.260 Test Loss: 2.003 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2896833419799805
Epoch: 10, Steps: 4 | Train Loss: 0.441 Vali Loss: 2.141 Vali Acc: 0.220 Test Loss: 2.141 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.232715368270874
Epoch: 11, Steps: 4 | Train Loss: 0.458 Vali Loss: 2.129 Vali Acc: 0.240 Test Loss: 2.129 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.112633228302002
Epoch: 12, Steps: 4 | Train Loss: 0.305 Vali Loss: 2.225 Vali Acc: 0.260 Test Loss: 2.225 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.185422420501709
Epoch: 13, Steps: 4 | Train Loss: 0.178 Vali Loss: 2.486 Vali Acc: 0.240 Test Loss: 2.486 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4290616512298584
Epoch: 14, Steps: 4 | Train Loss: 0.139 Vali Loss: 2.507 Vali Acc: 0.280 Test Loss: 2.507 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.247098445892334
Epoch: 15, Steps: 4 | Train Loss: 0.089 Vali Loss: 2.666 Vali Acc: 0.240 Test Loss: 2.666 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 5131053
model size : 24.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2970328330993652
Epoch: 1, Steps: 4 | Train Loss: 1.842 Vali Loss: 1.624 Vali Acc: 0.260 Test Loss: 1.624 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.2071173191070557
Epoch: 2, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.552 Vali Acc: 0.320 Test Loss: 1.552 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.1354069709777832
Epoch: 3, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.586 Vali Acc: 0.260 Test Loss: 1.586 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2777502536773682
Epoch: 4, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.671 Vali Acc: 0.240 Test Loss: 1.671 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0012726783752441
Epoch: 5, Steps: 4 | Train Loss: 0.964 Vali Loss: 1.846 Vali Acc: 0.220 Test Loss: 1.846 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9480950832366943
Epoch: 6, Steps: 4 | Train Loss: 0.827 Vali Loss: 1.915 Vali Acc: 0.240 Test Loss: 1.915 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2978403568267822
Epoch: 7, Steps: 4 | Train Loss: 0.561 Vali Loss: 2.140 Vali Acc: 0.160 Test Loss: 2.140 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3158349990844727
Epoch: 8, Steps: 4 | Train Loss: 0.473 Vali Loss: 2.173 Vali Acc: 0.320 Test Loss: 2.173 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1943836212158203
Epoch: 9, Steps: 4 | Train Loss: 0.333 Vali Loss: 2.487 Vali Acc: 0.240 Test Loss: 2.487 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3343517780303955
Epoch: 10, Steps: 4 | Train Loss: 0.343 Vali Loss: 2.535 Vali Acc: 0.320 Test Loss: 2.535 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2937068939208984
Epoch: 11, Steps: 4 | Train Loss: 0.215 Vali Loss: 2.738 Vali Acc: 0.280 Test Loss: 2.738 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3023195266723633
Epoch: 12, Steps: 4 | Train Loss: 0.198 Vali Loss: 2.589 Vali Acc: 0.280 Test Loss: 2.589 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4082477
model size : 20.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1688601970672607
Epoch: 1, Steps: 4 | Train Loss: 1.797 Vali Loss: 1.588 Vali Acc: 0.280 Test Loss: 1.588 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.2005581855773926
Epoch: 2, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.532 Vali Acc: 0.300 Test Loss: 1.532 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299985).  Saving model ...
Epoch: 3 cost time: 1.2250378131866455
Epoch: 3, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.560 Vali Acc: 0.240 Test Loss: 1.560 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1995360851287842
Epoch: 4, Steps: 4 | Train Loss: 1.188 Vali Loss: 1.612 Vali Acc: 0.280 Test Loss: 1.612 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.170377254486084
Epoch: 5, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.792 Vali Acc: 0.220 Test Loss: 1.792 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4855396747589111
Epoch: 6, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.855 Vali Acc: 0.260 Test Loss: 1.855 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1576142311096191
Epoch: 7, Steps: 4 | Train Loss: 0.594 Vali Loss: 2.043 Vali Acc: 0.180 Test Loss: 2.043 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.414576768875122
Epoch: 8, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.079 Vali Acc: 0.320 Test Loss: 2.079 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319979).  Saving model ...
Epoch: 9 cost time: 1.142385482788086
Epoch: 9, Steps: 4 | Train Loss: 0.355 Vali Loss: 2.388 Vali Acc: 0.240 Test Loss: 2.388 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4356136322021484
Epoch: 10, Steps: 4 | Train Loss: 0.364 Vali Loss: 2.423 Vali Acc: 0.320 Test Loss: 2.423 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.20607590675354
Epoch: 11, Steps: 4 | Train Loss: 0.230 Vali Loss: 2.570 Vali Acc: 0.300 Test Loss: 2.570 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3215274810791016
Epoch: 12, Steps: 4 | Train Loss: 0.209 Vali Loss: 2.443 Vali Acc: 0.280 Test Loss: 2.443 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2264909744262695
Epoch: 13, Steps: 4 | Train Loss: 0.172 Vali Loss: 2.670 Vali Acc: 0.320 Test Loss: 2.670 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3944201469421387
Epoch: 14, Steps: 4 | Train Loss: 0.180 Vali Loss: 2.765 Vali Acc: 0.320 Test Loss: 2.765 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1906654834747314
Epoch: 15, Steps: 4 | Train Loss: 0.092 Vali Loss: 2.990 Vali Acc: 0.340 Test Loss: 2.990 Test Acc: 0.340
Validation loss decreased (-0.319979 --> -0.339970).  Saving model ...
Epoch: 16 cost time: 1.3451130390167236
Epoch: 16, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.032 Vali Acc: 0.280 Test Loss: 3.032 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2575523853302002
Epoch: 17, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.252 Vali Acc: 0.260 Test Loss: 3.252 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.408468246459961
Epoch: 18, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.254 Vali Acc: 0.300 Test Loss: 3.254 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3671293258666992
Epoch: 19, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.426 Vali Acc: 0.260 Test Loss: 3.426 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1568024158477783
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.819 Vali Acc: 0.240 Test Loss: 3.819 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.158937931060791
Epoch: 21, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.303 Vali Acc: 0.260 Test Loss: 4.303 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.224531650543213
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.465 Vali Acc: 0.260 Test Loss: 4.465 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2932500839233398
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.462 Vali Acc: 0.240 Test Loss: 4.462 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3050148487091064
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.472 Vali Acc: 0.240 Test Loss: 4.472 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3886592388153076
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 4.496 Vali Acc: 0.240 Test Loss: 4.496 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4082477
model size : 20.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.385725736618042
Epoch: 1, Steps: 4 | Train Loss: 1.804 Vali Loss: 1.586 Vali Acc: 0.260 Test Loss: 1.586 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.1235949993133545
Epoch: 2, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.538 Vali Acc: 0.260 Test Loss: 1.538 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.2825236320495605
Epoch: 3, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.546 Vali Acc: 0.220 Test Loss: 1.546 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1516196727752686
Epoch: 4, Steps: 4 | Train Loss: 1.225 Vali Loss: 1.594 Vali Acc: 0.200 Test Loss: 1.594 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2551124095916748
Epoch: 5, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.750 Vali Acc: 0.160 Test Loss: 1.750 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2339067459106445
Epoch: 6, Steps: 4 | Train Loss: 0.891 Vali Loss: 1.814 Vali Acc: 0.200 Test Loss: 1.814 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.225707769393921
Epoch: 7, Steps: 4 | Train Loss: 0.663 Vali Loss: 1.988 Vali Acc: 0.220 Test Loss: 1.988 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3103561401367188
Epoch: 8, Steps: 4 | Train Loss: 0.553 Vali Loss: 1.979 Vali Acc: 0.320 Test Loss: 1.979 Test Acc: 0.320
Validation loss decreased (-0.259985 --> -0.319980).  Saving model ...
Epoch: 9 cost time: 1.0360016822814941
Epoch: 9, Steps: 4 | Train Loss: 0.393 Vali Loss: 2.292 Vali Acc: 0.220 Test Loss: 2.292 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1310687065124512
Epoch: 10, Steps: 4 | Train Loss: 0.419 Vali Loss: 2.305 Vali Acc: 0.280 Test Loss: 2.305 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1659798622131348
Epoch: 11, Steps: 4 | Train Loss: 0.258 Vali Loss: 2.454 Vali Acc: 0.300 Test Loss: 2.454 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.166975498199463
Epoch: 12, Steps: 4 | Train Loss: 0.240 Vali Loss: 2.397 Vali Acc: 0.240 Test Loss: 2.397 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2178828716278076
Epoch: 13, Steps: 4 | Train Loss: 0.227 Vali Loss: 2.658 Vali Acc: 0.240 Test Loss: 2.658 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1109070777893066
Epoch: 14, Steps: 4 | Train Loss: 0.184 Vali Loss: 2.857 Vali Acc: 0.300 Test Loss: 2.857 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2965295314788818
Epoch: 15, Steps: 4 | Train Loss: 0.116 Vali Loss: 3.046 Vali Acc: 0.280 Test Loss: 3.046 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1420507431030273
Epoch: 16, Steps: 4 | Train Loss: 0.052 Vali Loss: 3.142 Vali Acc: 0.240 Test Loss: 3.142 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.306919813156128
Epoch: 17, Steps: 4 | Train Loss: 0.035 Vali Loss: 3.303 Vali Acc: 0.260 Test Loss: 3.303 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1928565502166748
Epoch: 18, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.312 Vali Acc: 0.300 Test Loss: 3.312 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4082477
model size : 20.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1678504943847656
Epoch: 1, Steps: 4 | Train Loss: 1.747 Vali Loss: 1.584 Vali Acc: 0.220 Test Loss: 1.584 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3834803104400635
Epoch: 2, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.530 Vali Acc: 0.260 Test Loss: 1.530 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.1735918521881104
Epoch: 3, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.526 Vali Acc: 0.220 Test Loss: 1.526 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2847893238067627
Epoch: 4, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.568 Vali Acc: 0.220 Test Loss: 1.568 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.372199535369873
Epoch: 5, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.689 Vali Acc: 0.220 Test Loss: 1.689 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3229634761810303
Epoch: 6, Steps: 4 | Train Loss: 0.977 Vali Loss: 1.728 Vali Acc: 0.220 Test Loss: 1.728 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3528132438659668
Epoch: 7, Steps: 4 | Train Loss: 0.768 Vali Loss: 1.874 Vali Acc: 0.220 Test Loss: 1.874 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3791518211364746
Epoch: 8, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.843 Vali Acc: 0.300 Test Loss: 1.843 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299982).  Saving model ...
Epoch: 9 cost time: 1.2445476055145264
Epoch: 9, Steps: 4 | Train Loss: 0.476 Vali Loss: 2.131 Vali Acc: 0.240 Test Loss: 2.131 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2803936004638672
Epoch: 10, Steps: 4 | Train Loss: 0.505 Vali Loss: 2.079 Vali Acc: 0.280 Test Loss: 2.079 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4063773155212402
Epoch: 11, Steps: 4 | Train Loss: 0.343 Vali Loss: 2.184 Vali Acc: 0.240 Test Loss: 2.184 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3113973140716553
Epoch: 12, Steps: 4 | Train Loss: 0.294 Vali Loss: 2.136 Vali Acc: 0.240 Test Loss: 2.136 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5237555503845215
Epoch: 13, Steps: 4 | Train Loss: 0.275 Vali Loss: 2.283 Vali Acc: 0.280 Test Loss: 2.283 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4191739559173584
Epoch: 14, Steps: 4 | Train Loss: 0.217 Vali Loss: 2.514 Vali Acc: 0.280 Test Loss: 2.514 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3108296394348145
Epoch: 15, Steps: 4 | Train Loss: 0.145 Vali Loss: 2.735 Vali Acc: 0.260 Test Loss: 2.735 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1756093502044678
Epoch: 16, Steps: 4 | Train Loss: 0.084 Vali Loss: 2.778 Vali Acc: 0.240 Test Loss: 2.778 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1125457286834717
Epoch: 17, Steps: 4 | Train Loss: 0.053 Vali Loss: 2.909 Vali Acc: 0.240 Test Loss: 2.909 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3067867755889893
Epoch: 18, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.062 Vali Acc: 0.260 Test Loss: 3.062 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4082477
model size : 20.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.334141492843628
Epoch: 1, Steps: 4 | Train Loss: 1.742 Vali Loss: 1.658 Vali Acc: 0.180 Test Loss: 1.658 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.0447096824645996
Epoch: 2, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
Validation loss decreased (-0.179983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.0191922187805176
Epoch: 3, Steps: 4 | Train Loss: 1.118 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2741787433624268
Epoch: 4, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.769 Vali Acc: 0.200 Test Loss: 1.769 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2009751796722412
Epoch: 5, Steps: 4 | Train Loss: 0.810 Vali Loss: 1.900 Vali Acc: 0.200 Test Loss: 1.900 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2239129543304443
Epoch: 6, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.956 Vali Acc: 0.300 Test Loss: 1.956 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299980).  Saving model ...
Epoch: 7 cost time: 1.3296985626220703
Epoch: 7, Steps: 4 | Train Loss: 0.467 Vali Loss: 2.168 Vali Acc: 0.300 Test Loss: 2.168 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1885247230529785
Epoch: 8, Steps: 4 | Train Loss: 0.397 Vali Loss: 2.324 Vali Acc: 0.240 Test Loss: 2.324 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1442713737487793
Epoch: 9, Steps: 4 | Train Loss: 0.344 Vali Loss: 2.564 Vali Acc: 0.260 Test Loss: 2.564 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2725207805633545
Epoch: 10, Steps: 4 | Train Loss: 0.296 Vali Loss: 2.500 Vali Acc: 0.340 Test Loss: 2.500 Test Acc: 0.340
Validation loss decreased (-0.299980 --> -0.339975).  Saving model ...
Epoch: 11 cost time: 1.1032657623291016
Epoch: 11, Steps: 4 | Train Loss: 0.390 Vali Loss: 2.748 Vali Acc: 0.260 Test Loss: 2.748 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3595612049102783
Epoch: 12, Steps: 4 | Train Loss: 0.175 Vali Loss: 2.996 Vali Acc: 0.260 Test Loss: 2.996 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3198130130767822
Epoch: 13, Steps: 4 | Train Loss: 0.164 Vali Loss: 3.250 Vali Acc: 0.320 Test Loss: 3.250 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1052775382995605
Epoch: 14, Steps: 4 | Train Loss: 0.183 Vali Loss: 3.364 Vali Acc: 0.280 Test Loss: 3.364 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3725252151489258
Epoch: 15, Steps: 4 | Train Loss: 0.111 Vali Loss: 3.295 Vali Acc: 0.280 Test Loss: 3.295 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2372169494628906
Epoch: 16, Steps: 4 | Train Loss: 0.031 Vali Loss: 3.585 Vali Acc: 0.320 Test Loss: 3.585 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.170896291732788
Epoch: 17, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.961 Vali Acc: 0.280 Test Loss: 3.961 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3817625045776367
Epoch: 18, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.314 Vali Acc: 0.260 Test Loss: 4.314 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4869258403778076
Epoch: 19, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.414 Vali Acc: 0.260 Test Loss: 4.414 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3876152038574219
Epoch: 20, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.372 Vali Acc: 0.260 Test Loss: 4.372 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 3558189
model size : 18.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7263970375061035
Epoch: 1, Steps: 4 | Train Loss: 1.758 Vali Loss: 1.658 Vali Acc: 0.180 Test Loss: 1.658 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.0907444953918457
Epoch: 2, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.630 Vali Acc: 0.160 Test Loss: 1.630 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2144503593444824
Epoch: 3, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.685 Vali Acc: 0.200 Test Loss: 1.685 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.3563554286956787
Epoch: 4, Steps: 4 | Train Loss: 1.028 Vali Loss: 1.772 Vali Acc: 0.200 Test Loss: 1.772 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2311055660247803
Epoch: 5, Steps: 4 | Train Loss: 0.847 Vali Loss: 1.903 Vali Acc: 0.220 Test Loss: 1.903 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219981).  Saving model ...
Epoch: 6 cost time: 1.4684641361236572
Epoch: 6, Steps: 4 | Train Loss: 0.573 Vali Loss: 1.941 Vali Acc: 0.300 Test Loss: 1.941 Test Acc: 0.300
Validation loss decreased (-0.219981 --> -0.299981).  Saving model ...
Epoch: 7 cost time: 1.341855764389038
Epoch: 7, Steps: 4 | Train Loss: 0.500 Vali Loss: 2.114 Vali Acc: 0.300 Test Loss: 2.114 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.360231637954712
Epoch: 8, Steps: 4 | Train Loss: 0.423 Vali Loss: 2.281 Vali Acc: 0.240 Test Loss: 2.281 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4825794696807861
Epoch: 9, Steps: 4 | Train Loss: 0.379 Vali Loss: 2.506 Vali Acc: 0.240 Test Loss: 2.506 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.5149550437927246
Epoch: 10, Steps: 4 | Train Loss: 0.315 Vali Loss: 2.447 Vali Acc: 0.300 Test Loss: 2.447 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.504913091659546
Epoch: 11, Steps: 4 | Train Loss: 0.429 Vali Loss: 2.667 Vali Acc: 0.260 Test Loss: 2.667 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2494914531707764
Epoch: 12, Steps: 4 | Train Loss: 0.195 Vali Loss: 2.933 Vali Acc: 0.260 Test Loss: 2.933 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2145130634307861
Epoch: 13, Steps: 4 | Train Loss: 0.181 Vali Loss: 3.160 Vali Acc: 0.300 Test Loss: 3.160 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.318676471710205
Epoch: 14, Steps: 4 | Train Loss: 0.204 Vali Loss: 3.270 Vali Acc: 0.300 Test Loss: 3.270 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.4632558822631836
Epoch: 15, Steps: 4 | Train Loss: 0.130 Vali Loss: 3.242 Vali Acc: 0.260 Test Loss: 3.242 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.3021655082702637
Epoch: 16, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.492 Vali Acc: 0.280 Test Loss: 3.492 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 3558189
model size : 18.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.274897336959839
Epoch: 1, Steps: 4 | Train Loss: 1.737 Vali Loss: 1.635 Vali Acc: 0.160 Test Loss: 1.635 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.3119752407073975
Epoch: 2, Steps: 4 | Train Loss: 1.610 Vali Loss: 1.615 Vali Acc: 0.200 Test Loss: 1.615 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.2137203216552734
Epoch: 3, Steps: 4 | Train Loss: 1.181 Vali Loss: 1.636 Vali Acc: 0.180 Test Loss: 1.636 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1778550148010254
Epoch: 4, Steps: 4 | Train Loss: 1.081 Vali Loss: 1.693 Vali Acc: 0.260 Test Loss: 1.693 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.3443946838378906
Epoch: 5, Steps: 4 | Train Loss: 0.889 Vali Loss: 1.857 Vali Acc: 0.220 Test Loss: 1.857 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2380385398864746
Epoch: 6, Steps: 4 | Train Loss: 0.616 Vali Loss: 1.905 Vali Acc: 0.280 Test Loss: 1.905 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.2669050693511963
Epoch: 7, Steps: 4 | Train Loss: 0.544 Vali Loss: 2.044 Vali Acc: 0.280 Test Loss: 2.044 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3985419273376465
Epoch: 8, Steps: 4 | Train Loss: 0.460 Vali Loss: 2.220 Vali Acc: 0.180 Test Loss: 2.220 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4304256439208984
Epoch: 9, Steps: 4 | Train Loss: 0.414 Vali Loss: 2.389 Vali Acc: 0.240 Test Loss: 2.389 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2542724609375
Epoch: 10, Steps: 4 | Train Loss: 0.350 Vali Loss: 2.334 Vali Acc: 0.280 Test Loss: 2.334 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3259503841400146
Epoch: 11, Steps: 4 | Train Loss: 0.484 Vali Loss: 2.585 Vali Acc: 0.260 Test Loss: 2.585 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2939929962158203
Epoch: 12, Steps: 4 | Train Loss: 0.214 Vali Loss: 2.869 Vali Acc: 0.280 Test Loss: 2.869 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.249281406402588
Epoch: 13, Steps: 4 | Train Loss: 0.202 Vali Loss: 3.122 Vali Acc: 0.300 Test Loss: 3.122 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299969).  Saving model ...
Epoch: 14 cost time: 1.4077651500701904
Epoch: 14, Steps: 4 | Train Loss: 0.206 Vali Loss: 3.154 Vali Acc: 0.240 Test Loss: 3.154 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3236241340637207
Epoch: 15, Steps: 4 | Train Loss: 0.138 Vali Loss: 3.128 Vali Acc: 0.260 Test Loss: 3.128 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.21602201461792
Epoch: 16, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.404 Vali Acc: 0.240 Test Loss: 3.404 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.306070327758789
Epoch: 17, Steps: 4 | Train Loss: 0.049 Vali Loss: 3.807 Vali Acc: 0.220 Test Loss: 3.807 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.408949613571167
Epoch: 18, Steps: 4 | Train Loss: 0.012 Vali Loss: 4.018 Vali Acc: 0.200 Test Loss: 4.018 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3766400814056396
Epoch: 19, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.264 Vali Acc: 0.200 Test Loss: 4.264 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2602448463439941
Epoch: 20, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.410 Vali Acc: 0.240 Test Loss: 4.410 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2504379749298096
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.566 Vali Acc: 0.180 Test Loss: 4.566 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1742794513702393
Epoch: 22, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.726 Vali Acc: 0.180 Test Loss: 4.726 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.0732698440551758
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.843 Vali Acc: 0.180 Test Loss: 4.843 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 3558189
model size : 18.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.955080270767212
Epoch: 1, Steps: 4 | Train Loss: 1.749 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2051708698272705
Epoch: 2, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.632 Vali Acc: 0.260 Test Loss: 1.632 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.2906978130340576
Epoch: 3, Steps: 4 | Train Loss: 1.231 Vali Loss: 1.609 Vali Acc: 0.200 Test Loss: 1.609 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.167860746383667
Epoch: 4, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.639 Vali Acc: 0.160 Test Loss: 1.639 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.296560525894165
Epoch: 5, Steps: 4 | Train Loss: 0.961 Vali Loss: 1.766 Vali Acc: 0.200 Test Loss: 1.766 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2886674404144287
Epoch: 6, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.772 Vali Acc: 0.240 Test Loss: 1.772 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1153759956359863
Epoch: 7, Steps: 4 | Train Loss: 0.638 Vali Loss: 1.899 Vali Acc: 0.260 Test Loss: 1.899 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1547648906707764
Epoch: 8, Steps: 4 | Train Loss: 0.560 Vali Loss: 2.070 Vali Acc: 0.200 Test Loss: 2.070 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2281684875488281
Epoch: 9, Steps: 4 | Train Loss: 0.502 Vali Loss: 2.207 Vali Acc: 0.220 Test Loss: 2.207 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.3347344398498535
Epoch: 10, Steps: 4 | Train Loss: 0.443 Vali Loss: 2.114 Vali Acc: 0.220 Test Loss: 2.114 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2316205501556396
Epoch: 11, Steps: 4 | Train Loss: 0.593 Vali Loss: 2.278 Vali Acc: 0.240 Test Loss: 2.278 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.249075174331665
Epoch: 12, Steps: 4 | Train Loss: 0.262 Vali Loss: 2.457 Vali Acc: 0.260 Test Loss: 2.457 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 3558189
model size : 18.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9581797122955322
Epoch: 1, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.603 Vali Acc: 0.180 Test Loss: 1.603 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.1747241020202637
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.532 Vali Acc: 0.180 Test Loss: 1.532 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179985).  Saving model ...
Epoch: 3 cost time: 1.1686975955963135
Epoch: 3, Steps: 4 | Train Loss: 1.340 Vali Loss: 1.564 Vali Acc: 0.320 Test Loss: 1.564 Test Acc: 0.320
Validation loss decreased (-0.179985 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.2342255115509033
Epoch: 4, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.791 Vali Acc: 0.220 Test Loss: 1.791 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2055745124816895
Epoch: 5, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.787 Vali Acc: 0.260 Test Loss: 1.787 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3658251762390137
Epoch: 6, Steps: 4 | Train Loss: 0.725 Vali Loss: 1.944 Vali Acc: 0.260 Test Loss: 1.944 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.266559362411499
Epoch: 7, Steps: 4 | Train Loss: 0.457 Vali Loss: 2.064 Vali Acc: 0.280 Test Loss: 2.064 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2303264141082764
Epoch: 8, Steps: 4 | Train Loss: 0.601 Vali Loss: 2.276 Vali Acc: 0.280 Test Loss: 2.276 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1397671699523926
Epoch: 9, Steps: 4 | Train Loss: 0.307 Vali Loss: 2.455 Vali Acc: 0.260 Test Loss: 2.455 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1725902557373047
Epoch: 10, Steps: 4 | Train Loss: 0.280 Vali Loss: 2.581 Vali Acc: 0.220 Test Loss: 2.581 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2488980293273926
Epoch: 11, Steps: 4 | Train Loss: 0.298 Vali Loss: 2.696 Vali Acc: 0.280 Test Loss: 2.696 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0977261066436768
Epoch: 12, Steps: 4 | Train Loss: 0.144 Vali Loss: 2.827 Vali Acc: 0.260 Test Loss: 2.827 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.06976318359375
Epoch: 13, Steps: 4 | Train Loss: 0.126 Vali Loss: 3.018 Vali Acc: 0.240 Test Loss: 3.018 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3296045
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.949578046798706
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.594 Vali Acc: 0.140 Test Loss: 1.594 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.2398264408111572
Epoch: 2, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.526 Vali Acc: 0.220 Test Loss: 1.526 Test Acc: 0.220
Validation loss decreased (-0.139984 --> -0.219985).  Saving model ...
Epoch: 3 cost time: 0.9799525737762451
Epoch: 3, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.546 Vali Acc: 0.220 Test Loss: 1.546 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1728630065917969
Epoch: 4, Steps: 4 | Train Loss: 1.082 Vali Loss: 1.746 Vali Acc: 0.200 Test Loss: 1.746 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2686820030212402
Epoch: 5, Steps: 4 | Train Loss: 1.047 Vali Loss: 1.751 Vali Acc: 0.240 Test Loss: 1.751 Test Acc: 0.240
Validation loss decreased (-0.219985 --> -0.239982).  Saving model ...
Epoch: 6 cost time: 1.4600610733032227
Epoch: 6, Steps: 4 | Train Loss: 0.765 Vali Loss: 1.897 Vali Acc: 0.280 Test Loss: 1.897 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.2503461837768555
Epoch: 7, Steps: 4 | Train Loss: 0.489 Vali Loss: 2.023 Vali Acc: 0.280 Test Loss: 2.023 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4598872661590576
Epoch: 8, Steps: 4 | Train Loss: 0.663 Vali Loss: 2.234 Vali Acc: 0.260 Test Loss: 2.234 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2350952625274658
Epoch: 9, Steps: 4 | Train Loss: 0.323 Vali Loss: 2.406 Vali Acc: 0.240 Test Loss: 2.406 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2172982692718506
Epoch: 10, Steps: 4 | Train Loss: 0.308 Vali Loss: 2.590 Vali Acc: 0.240 Test Loss: 2.590 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1645307540893555
Epoch: 11, Steps: 4 | Train Loss: 0.343 Vali Loss: 2.674 Vali Acc: 0.260 Test Loss: 2.674 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.148188829421997
Epoch: 12, Steps: 4 | Train Loss: 0.165 Vali Loss: 2.829 Vali Acc: 0.240 Test Loss: 2.829 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2057075500488281
Epoch: 13, Steps: 4 | Train Loss: 0.153 Vali Loss: 3.051 Vali Acc: 0.240 Test Loss: 3.051 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0880861282348633
Epoch: 14, Steps: 4 | Train Loss: 0.080 Vali Loss: 3.290 Vali Acc: 0.260 Test Loss: 3.290 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.2180814743041992
Epoch: 15, Steps: 4 | Train Loss: 0.054 Vali Loss: 3.188 Vali Acc: 0.300 Test Loss: 3.188 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299968).  Saving model ...
Epoch: 16 cost time: 1.3336353302001953
Epoch: 16, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.551 Vali Acc: 0.260 Test Loss: 3.551 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1928000450134277
Epoch: 17, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.844 Vali Acc: 0.260 Test Loss: 3.844 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.268596887588501
Epoch: 18, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.922 Vali Acc: 0.240 Test Loss: 3.922 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.248105764389038
Epoch: 19, Steps: 4 | Train Loss: 0.010 Vali Loss: 3.951 Vali Acc: 0.240 Test Loss: 3.951 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2677340507507324
Epoch: 20, Steps: 4 | Train Loss: 0.010 Vali Loss: 4.051 Vali Acc: 0.240 Test Loss: 4.051 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1666536331176758
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.262 Vali Acc: 0.240 Test Loss: 4.262 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3774616718292236
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.375 Vali Acc: 0.260 Test Loss: 4.375 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2472517490386963
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.409 Vali Acc: 0.260 Test Loss: 4.409 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1686811447143555
Epoch: 24, Steps: 4 | Train Loss: 0.003 Vali Loss: 4.482 Vali Acc: 0.220 Test Loss: 4.482 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2613000869750977
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.607 Vali Acc: 0.220 Test Loss: 4.607 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 3296045
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.055736541748047
Epoch: 1, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.597 Vali Acc: 0.200 Test Loss: 1.597 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2031474113464355
Epoch: 2, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.519 Vali Acc: 0.220 Test Loss: 1.519 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219985).  Saving model ...
Epoch: 3 cost time: 1.2896502017974854
Epoch: 3, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
Validation loss decreased (-0.219985 --> -0.239985).  Saving model ...
Epoch: 4 cost time: 1.2054102420806885
Epoch: 4, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.706 Vali Acc: 0.220 Test Loss: 1.706 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1662096977233887
Epoch: 5, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.704 Vali Acc: 0.220 Test Loss: 1.704 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2191076278686523
Epoch: 6, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.823 Vali Acc: 0.240 Test Loss: 1.823 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2533605098724365
Epoch: 7, Steps: 4 | Train Loss: 0.534 Vali Loss: 1.921 Vali Acc: 0.260 Test Loss: 1.921 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259981).  Saving model ...
Epoch: 8 cost time: 1.0942604541778564
Epoch: 8, Steps: 4 | Train Loss: 0.715 Vali Loss: 2.122 Vali Acc: 0.240 Test Loss: 2.122 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1042520999908447
Epoch: 9, Steps: 4 | Train Loss: 0.359 Vali Loss: 2.281 Vali Acc: 0.220 Test Loss: 2.281 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.148754596710205
Epoch: 10, Steps: 4 | Train Loss: 0.343 Vali Loss: 2.421 Vali Acc: 0.240 Test Loss: 2.421 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2797901630401611
Epoch: 11, Steps: 4 | Train Loss: 0.382 Vali Loss: 2.522 Vali Acc: 0.280 Test Loss: 2.522 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279975).  Saving model ...
Epoch: 12 cost time: 1.0761682987213135
Epoch: 12, Steps: 4 | Train Loss: 0.192 Vali Loss: 2.629 Vali Acc: 0.280 Test Loss: 2.629 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0417323112487793
Epoch: 13, Steps: 4 | Train Loss: 0.165 Vali Loss: 2.801 Vali Acc: 0.260 Test Loss: 2.801 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0497801303863525
Epoch: 14, Steps: 4 | Train Loss: 0.100 Vali Loss: 3.202 Vali Acc: 0.260 Test Loss: 3.202 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2533915042877197
Epoch: 15, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.099 Vali Acc: 0.300 Test Loss: 3.099 Test Acc: 0.300
Validation loss decreased (-0.279975 --> -0.299969).  Saving model ...
Epoch: 16 cost time: 1.0814824104309082
Epoch: 16, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.390 Vali Acc: 0.260 Test Loss: 3.390 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.141216516494751
Epoch: 17, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.693 Vali Acc: 0.280 Test Loss: 3.693 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0049316883087158
Epoch: 18, Steps: 4 | Train Loss: 0.019 Vali Loss: 3.821 Vali Acc: 0.280 Test Loss: 3.821 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.181051254272461
Epoch: 19, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.884 Vali Acc: 0.280 Test Loss: 3.884 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1393680572509766
Epoch: 20, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.013 Vali Acc: 0.280 Test Loss: 4.013 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1192796230316162
Epoch: 21, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.288 Vali Acc: 0.240 Test Loss: 4.288 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2767438888549805
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.379 Vali Acc: 0.240 Test Loss: 4.379 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.18804931640625
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.360 Vali Acc: 0.240 Test Loss: 4.360 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0710058212280273
Epoch: 24, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.402 Vali Acc: 0.240 Test Loss: 4.402 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1682214736938477
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 4.559 Vali Acc: 0.240 Test Loss: 4.559 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 3296045
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.150228977203369
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.624 Vali Acc: 0.200 Test Loss: 1.624 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.0615391731262207
Epoch: 2, Steps: 4 | Train Loss: 1.525 Vali Loss: 1.563 Vali Acc: 0.240 Test Loss: 1.563 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.0942130088806152
Epoch: 3, Steps: 4 | Train Loss: 1.447 Vali Loss: 1.553 Vali Acc: 0.340 Test Loss: 1.553 Test Acc: 0.340
Validation loss decreased (-0.239984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.0418610572814941
Epoch: 4, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0261297225952148
Epoch: 5, Steps: 4 | Train Loss: 1.180 Vali Loss: 1.654 Vali Acc: 0.220 Test Loss: 1.654 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2345526218414307
Epoch: 6, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.713 Vali Acc: 0.280 Test Loss: 1.713 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2297987937927246
Epoch: 7, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.802 Vali Acc: 0.300 Test Loss: 1.802 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2688660621643066
Epoch: 8, Steps: 4 | Train Loss: 0.820 Vali Loss: 1.998 Vali Acc: 0.240 Test Loss: 1.998 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4464209079742432
Epoch: 9, Steps: 4 | Train Loss: 0.447 Vali Loss: 2.147 Vali Acc: 0.260 Test Loss: 2.147 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2004904747009277
Epoch: 10, Steps: 4 | Train Loss: 0.439 Vali Loss: 2.288 Vali Acc: 0.220 Test Loss: 2.288 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2265093326568604
Epoch: 11, Steps: 4 | Train Loss: 0.503 Vali Loss: 2.285 Vali Acc: 0.260 Test Loss: 2.285 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3162801265716553
Epoch: 12, Steps: 4 | Train Loss: 0.252 Vali Loss: 2.288 Vali Acc: 0.300 Test Loss: 2.288 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.319960355758667
Epoch: 13, Steps: 4 | Train Loss: 0.250 Vali Loss: 2.445 Vali Acc: 0.260 Test Loss: 2.445 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 3296045
model size : 17.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3166654109954834
Epoch: 1, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.476 Vali Acc: 0.280 Test Loss: 1.476 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.2472870349884033
Epoch: 2, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.424 Vali Acc: 0.320 Test Loss: 1.424 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319986).  Saving model ...
Epoch: 3 cost time: 1.2062339782714844
Epoch: 3, Steps: 4 | Train Loss: 1.415 Vali Loss: 1.494 Vali Acc: 0.280 Test Loss: 1.494 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2203717231750488
Epoch: 4, Steps: 4 | Train Loss: 1.172 Vali Loss: 1.657 Vali Acc: 0.280 Test Loss: 1.657 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1577775478363037
Epoch: 5, Steps: 4 | Train Loss: 0.785 Vali Loss: 1.735 Vali Acc: 0.300 Test Loss: 1.735 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.191622018814087
Epoch: 6, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.857 Vali Acc: 0.320 Test Loss: 1.857 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1264820098876953
Epoch: 7, Steps: 4 | Train Loss: 0.506 Vali Loss: 1.968 Vali Acc: 0.240 Test Loss: 1.968 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2004296779632568
Epoch: 8, Steps: 4 | Train Loss: 0.432 Vali Loss: 2.135 Vali Acc: 0.280 Test Loss: 2.135 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2893378734588623
Epoch: 9, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.218 Vali Acc: 0.280 Test Loss: 2.218 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.181666612625122
Epoch: 10, Steps: 4 | Train Loss: 0.260 Vali Loss: 2.331 Vali Acc: 0.280 Test Loss: 2.331 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.275562047958374
Epoch: 11, Steps: 4 | Train Loss: 0.251 Vali Loss: 2.433 Vali Acc: 0.260 Test Loss: 2.433 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3269507884979248
Epoch: 12, Steps: 4 | Train Loss: 0.164 Vali Loss: 2.557 Vali Acc: 0.280 Test Loss: 2.557 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3164973
model size : 16.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.248758554458618
Epoch: 1, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.509 Vali Acc: 0.280 Test Loss: 1.509 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.3759665489196777
Epoch: 2, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.459 Vali Acc: 0.260 Test Loss: 1.459 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.361924409866333
Epoch: 3, Steps: 4 | Train Loss: 1.399 Vali Loss: 1.506 Vali Acc: 0.280 Test Loss: 1.506 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.3678569793701172
Epoch: 4, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.642 Vali Acc: 0.260 Test Loss: 1.642 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2461118698120117
Epoch: 5, Steps: 4 | Train Loss: 0.804 Vali Loss: 1.723 Vali Acc: 0.280 Test Loss: 1.723 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.248798131942749
Epoch: 6, Steps: 4 | Train Loss: 0.726 Vali Loss: 1.822 Vali Acc: 0.280 Test Loss: 1.822 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.126081943511963
Epoch: 7, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.945 Vali Acc: 0.240 Test Loss: 1.945 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.170569658279419
Epoch: 8, Steps: 4 | Train Loss: 0.470 Vali Loss: 2.088 Vali Acc: 0.280 Test Loss: 2.088 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3511204719543457
Epoch: 9, Steps: 4 | Train Loss: 0.447 Vali Loss: 2.135 Vali Acc: 0.280 Test Loss: 2.135 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3066482543945312
Epoch: 10, Steps: 4 | Train Loss: 0.281 Vali Loss: 2.233 Vali Acc: 0.300 Test Loss: 2.233 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299978).  Saving model ...
Epoch: 11 cost time: 1.2685637474060059
Epoch: 11, Steps: 4 | Train Loss: 0.272 Vali Loss: 2.431 Vali Acc: 0.240 Test Loss: 2.431 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2315049171447754
Epoch: 12, Steps: 4 | Train Loss: 0.186 Vali Loss: 2.660 Vali Acc: 0.260 Test Loss: 2.660 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.120605707168579
Epoch: 13, Steps: 4 | Train Loss: 0.135 Vali Loss: 2.730 Vali Acc: 0.320 Test Loss: 2.730 Test Acc: 0.320
Validation loss decreased (-0.299978 --> -0.319973).  Saving model ...
Epoch: 14 cost time: 1.1087965965270996
Epoch: 14, Steps: 4 | Train Loss: 0.087 Vali Loss: 3.104 Vali Acc: 0.300 Test Loss: 3.104 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0687191486358643
Epoch: 15, Steps: 4 | Train Loss: 0.061 Vali Loss: 3.280 Vali Acc: 0.260 Test Loss: 3.280 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1071982383728027
Epoch: 16, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.533 Vali Acc: 0.280 Test Loss: 3.533 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.222696304321289
Epoch: 17, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.638 Vali Acc: 0.280 Test Loss: 3.638 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3001766204833984
Epoch: 18, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.819 Vali Acc: 0.280 Test Loss: 3.819 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1673316955566406
Epoch: 19, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.029 Vali Acc: 0.280 Test Loss: 4.029 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.351905107498169
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.156 Vali Acc: 0.280 Test Loss: 4.156 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.1361432075500488
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.184 Vali Acc: 0.280 Test Loss: 4.184 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.276113748550415
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 4.200 Vali Acc: 0.280 Test Loss: 4.200 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1737611293792725
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.254 Vali Acc: 0.280 Test Loss: 4.254 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3164973
model size : 16.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.173914909362793
Epoch: 1, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.495 Vali Acc: 0.260 Test Loss: 1.495 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.2607033252716064
Epoch: 2, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.451 Vali Acc: 0.240 Test Loss: 1.451 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2059886455535889
Epoch: 3, Steps: 4 | Train Loss: 1.379 Vali Loss: 1.495 Vali Acc: 0.240 Test Loss: 1.495 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.222926378250122
Epoch: 4, Steps: 4 | Train Loss: 1.217 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1065917015075684
Epoch: 5, Steps: 4 | Train Loss: 0.831 Vali Loss: 1.670 Vali Acc: 0.280 Test Loss: 1.670 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.1612789630889893
Epoch: 6, Steps: 4 | Train Loss: 0.780 Vali Loss: 1.786 Vali Acc: 0.300 Test Loss: 1.786 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 1.140122890472412
Epoch: 7, Steps: 4 | Train Loss: 0.571 Vali Loss: 1.853 Vali Acc: 0.240 Test Loss: 1.853 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2033193111419678
Epoch: 8, Steps: 4 | Train Loss: 0.519 Vali Loss: 2.002 Vali Acc: 0.280 Test Loss: 2.002 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0725185871124268
Epoch: 9, Steps: 4 | Train Loss: 0.487 Vali Loss: 2.033 Vali Acc: 0.240 Test Loss: 2.033 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1956417560577393
Epoch: 10, Steps: 4 | Train Loss: 0.313 Vali Loss: 2.158 Vali Acc: 0.280 Test Loss: 2.158 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1689167022705078
Epoch: 11, Steps: 4 | Train Loss: 0.291 Vali Loss: 2.427 Vali Acc: 0.240 Test Loss: 2.427 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3482468128204346
Epoch: 12, Steps: 4 | Train Loss: 0.212 Vali Loss: 2.592 Vali Acc: 0.240 Test Loss: 2.592 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2859244346618652
Epoch: 13, Steps: 4 | Train Loss: 0.150 Vali Loss: 2.601 Vali Acc: 0.320 Test Loss: 2.601 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319974).  Saving model ...
Epoch: 14 cost time: 1.4220576286315918
Epoch: 14, Steps: 4 | Train Loss: 0.103 Vali Loss: 2.906 Vali Acc: 0.240 Test Loss: 2.906 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4135305881500244
Epoch: 15, Steps: 4 | Train Loss: 0.075 Vali Loss: 2.969 Vali Acc: 0.240 Test Loss: 2.969 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3415656089782715
Epoch: 16, Steps: 4 | Train Loss: 0.041 Vali Loss: 3.292 Vali Acc: 0.280 Test Loss: 3.292 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3997657299041748
Epoch: 17, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.558 Vali Acc: 0.260 Test Loss: 3.558 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3504436016082764
Epoch: 18, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.753 Vali Acc: 0.260 Test Loss: 3.753 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1807279586791992
Epoch: 19, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.981 Vali Acc: 0.260 Test Loss: 3.981 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2381598949432373
Epoch: 20, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.081 Vali Acc: 0.220 Test Loss: 4.081 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2474164962768555
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.105 Vali Acc: 0.220 Test Loss: 4.105 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2095246315002441
Epoch: 22, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.148 Vali Acc: 0.220 Test Loss: 4.148 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1940176486968994
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 4.201 Vali Acc: 0.260 Test Loss: 4.201 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3164973
model size : 16.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1614105701446533
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.558 Vali Acc: 0.260 Test Loss: 1.558 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.1173222064971924
Epoch: 2, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.524 Vali Acc: 0.240 Test Loss: 1.524 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1540942192077637
Epoch: 3, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.527 Vali Acc: 0.260 Test Loss: 1.527 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 1.1436622142791748
Epoch: 4, Steps: 4 | Train Loss: 1.338 Vali Loss: 1.608 Vali Acc: 0.240 Test Loss: 1.608 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0666260719299316
Epoch: 5, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.673 Vali Acc: 0.280 Test Loss: 1.673 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.2510018348693848
Epoch: 6, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.780 Vali Acc: 0.220 Test Loss: 1.780 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2616174221038818
Epoch: 7, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.794 Vali Acc: 0.240 Test Loss: 1.794 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0991382598876953
Epoch: 8, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.876 Vali Acc: 0.240 Test Loss: 1.876 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1292757987976074
Epoch: 9, Steps: 4 | Train Loss: 0.596 Vali Loss: 1.945 Vali Acc: 0.280 Test Loss: 1.945 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.234093427658081
Epoch: 10, Steps: 4 | Train Loss: 0.387 Vali Loss: 2.046 Vali Acc: 0.360 Test Loss: 2.046 Test Acc: 0.360
Validation loss decreased (-0.279983 --> -0.359980).  Saving model ...
Epoch: 11 cost time: 1.1652514934539795
Epoch: 11, Steps: 4 | Train Loss: 0.371 Vali Loss: 2.184 Vali Acc: 0.240 Test Loss: 2.184 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.227771282196045
Epoch: 12, Steps: 4 | Train Loss: 0.284 Vali Loss: 2.241 Vali Acc: 0.260 Test Loss: 2.241 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1703908443450928
Epoch: 13, Steps: 4 | Train Loss: 0.217 Vali Loss: 2.241 Vali Acc: 0.340 Test Loss: 2.241 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.062387228012085
Epoch: 14, Steps: 4 | Train Loss: 0.165 Vali Loss: 2.430 Vali Acc: 0.280 Test Loss: 2.430 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.1099679470062256
Epoch: 15, Steps: 4 | Train Loss: 0.139 Vali Loss: 2.548 Vali Acc: 0.260 Test Loss: 2.548 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.0966475009918213
Epoch: 16, Steps: 4 | Train Loss: 0.077 Vali Loss: 2.909 Vali Acc: 0.260 Test Loss: 2.909 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0213966369628906
Epoch: 17, Steps: 4 | Train Loss: 0.052 Vali Loss: 3.075 Vali Acc: 0.280 Test Loss: 3.075 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.159532070159912
Epoch: 18, Steps: 4 | Train Loss: 0.034 Vali Loss: 3.224 Vali Acc: 0.260 Test Loss: 3.224 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1646227836608887
Epoch: 19, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.498 Vali Acc: 0.260 Test Loss: 3.498 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.237191915512085
Epoch: 20, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.687 Vali Acc: 0.240 Test Loss: 3.687 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 3164973
model size : 16.97MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.089139699935913
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.675 Vali Acc: 0.200 Test Loss: 1.675 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3071448802947998
Epoch: 2, Steps: 4 | Train Loss: 1.630 Vali Loss: 1.679 Vali Acc: 0.200 Test Loss: 1.679 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1915733814239502
Epoch: 3, Steps: 4 | Train Loss: 1.382 Vali Loss: 1.647 Vali Acc: 0.200 Test Loss: 1.647 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.2308712005615234
Epoch: 4, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.875 Vali Acc: 0.180 Test Loss: 1.875 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3851344585418701
Epoch: 5, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.983 Vali Acc: 0.220 Test Loss: 1.983 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219980).  Saving model ...
Epoch: 6 cost time: 1.3727526664733887
Epoch: 6, Steps: 4 | Train Loss: 0.758 Vali Loss: 2.076 Vali Acc: 0.260 Test Loss: 2.076 Test Acc: 0.260
Validation loss decreased (-0.219980 --> -0.259979).  Saving model ...
Epoch: 7 cost time: 1.2473759651184082
Epoch: 7, Steps: 4 | Train Loss: 0.622 Vali Loss: 2.107 Vali Acc: 0.300 Test Loss: 2.107 Test Acc: 0.300
Validation loss decreased (-0.259979 --> -0.299979).  Saving model ...
Epoch: 8 cost time: 1.2742555141448975
Epoch: 8, Steps: 4 | Train Loss: 0.595 Vali Loss: 2.204 Vali Acc: 0.300 Test Loss: 2.204 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0808587074279785
Epoch: 9, Steps: 4 | Train Loss: 0.476 Vali Loss: 2.600 Vali Acc: 0.260 Test Loss: 2.600 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3004164695739746
Epoch: 10, Steps: 4 | Train Loss: 0.292 Vali Loss: 2.808 Vali Acc: 0.300 Test Loss: 2.808 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1259100437164307
Epoch: 11, Steps: 4 | Train Loss: 0.251 Vali Loss: 3.051 Vali Acc: 0.300 Test Loss: 3.051 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0494768619537354
Epoch: 12, Steps: 4 | Train Loss: 0.180 Vali Loss: 3.089 Vali Acc: 0.300 Test Loss: 3.089 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0951414108276367
Epoch: 13, Steps: 4 | Train Loss: 0.364 Vali Loss: 3.122 Vali Acc: 0.260 Test Loss: 3.122 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.02193284034729
Epoch: 14, Steps: 4 | Train Loss: 0.104 Vali Loss: 3.277 Vali Acc: 0.260 Test Loss: 3.277 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.0820393562316895
Epoch: 15, Steps: 4 | Train Loss: 0.126 Vali Loss: 3.565 Vali Acc: 0.260 Test Loss: 3.565 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.228076457977295
Epoch: 16, Steps: 4 | Train Loss: 0.040 Vali Loss: 3.846 Vali Acc: 0.260 Test Loss: 3.846 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.1938955783843994
Epoch: 17, Steps: 4 | Train Loss: 0.024 Vali Loss: 4.094 Vali Acc: 0.280 Test Loss: 4.094 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 3099437
model size : 16.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4904632568359375
Epoch: 1, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.627 Vali Acc: 0.220 Test Loss: 1.627 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.2408814430236816
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.247983455657959
Epoch: 3, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.2272155284881592
Epoch: 4, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.800 Vali Acc: 0.160 Test Loss: 1.800 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2868714332580566
Epoch: 5, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.907 Vali Acc: 0.200 Test Loss: 1.907 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1727941036224365
Epoch: 6, Steps: 4 | Train Loss: 0.798 Vali Loss: 1.940 Vali Acc: 0.280 Test Loss: 1.940 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.1528189182281494
Epoch: 7, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.995 Vali Acc: 0.320 Test Loss: 1.995 Test Acc: 0.320
Validation loss decreased (-0.279981 --> -0.319980).  Saving model ...
Epoch: 8 cost time: 1.1144285202026367
Epoch: 8, Steps: 4 | Train Loss: 0.620 Vali Loss: 2.118 Vali Acc: 0.240 Test Loss: 2.118 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3359789848327637
Epoch: 9, Steps: 4 | Train Loss: 0.520 Vali Loss: 2.470 Vali Acc: 0.280 Test Loss: 2.470 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3999724388122559
Epoch: 10, Steps: 4 | Train Loss: 0.317 Vali Loss: 2.658 Vali Acc: 0.260 Test Loss: 2.658 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1851251125335693
Epoch: 11, Steps: 4 | Train Loss: 0.276 Vali Loss: 2.900 Vali Acc: 0.300 Test Loss: 2.900 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2166907787322998
Epoch: 12, Steps: 4 | Train Loss: 0.207 Vali Loss: 2.886 Vali Acc: 0.280 Test Loss: 2.886 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3192570209503174
Epoch: 13, Steps: 4 | Train Loss: 0.399 Vali Loss: 2.933 Vali Acc: 0.280 Test Loss: 2.933 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1068933010101318
Epoch: 14, Steps: 4 | Train Loss: 0.123 Vali Loss: 3.131 Vali Acc: 0.280 Test Loss: 3.131 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2660045623779297
Epoch: 15, Steps: 4 | Train Loss: 0.149 Vali Loss: 3.234 Vali Acc: 0.280 Test Loss: 3.234 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.3370442390441895
Epoch: 16, Steps: 4 | Train Loss: 0.050 Vali Loss: 3.557 Vali Acc: 0.320 Test Loss: 3.557 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.362464189529419
Epoch: 17, Steps: 4 | Train Loss: 0.034 Vali Loss: 3.832 Vali Acc: 0.240 Test Loss: 3.832 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3099437
model size : 16.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7923622131347656
Epoch: 1, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.592 Vali Acc: 0.200 Test Loss: 1.592 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.9642159938812256
Epoch: 2, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.613 Vali Acc: 0.220 Test Loss: 1.613 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.0896351337432861
Epoch: 3, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.581 Vali Acc: 0.200 Test Loss: 1.581 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0873210430145264
Epoch: 4, Steps: 4 | Train Loss: 1.078 Vali Loss: 1.749 Vali Acc: 0.180 Test Loss: 1.749 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0317187309265137
Epoch: 5, Steps: 4 | Train Loss: 0.873 Vali Loss: 1.835 Vali Acc: 0.180 Test Loss: 1.835 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1609127521514893
Epoch: 6, Steps: 4 | Train Loss: 0.851 Vali Loss: 1.892 Vali Acc: 0.260 Test Loss: 1.892 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259981).  Saving model ...
Epoch: 7 cost time: 1.0001308917999268
Epoch: 7, Steps: 4 | Train Loss: 0.720 Vali Loss: 1.957 Vali Acc: 0.300 Test Loss: 1.957 Test Acc: 0.300
Validation loss decreased (-0.259981 --> -0.299980).  Saving model ...
Epoch: 8 cost time: 1.1263413429260254
Epoch: 8, Steps: 4 | Train Loss: 0.673 Vali Loss: 2.058 Vali Acc: 0.220 Test Loss: 2.058 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1289100646972656
Epoch: 9, Steps: 4 | Train Loss: 0.572 Vali Loss: 2.390 Vali Acc: 0.280 Test Loss: 2.390 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0682811737060547
Epoch: 10, Steps: 4 | Train Loss: 0.348 Vali Loss: 2.504 Vali Acc: 0.260 Test Loss: 2.504 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.128896713256836
Epoch: 11, Steps: 4 | Train Loss: 0.321 Vali Loss: 2.705 Vali Acc: 0.240 Test Loss: 2.705 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.141474962234497
Epoch: 12, Steps: 4 | Train Loss: 0.240 Vali Loss: 2.718 Vali Acc: 0.280 Test Loss: 2.718 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1924402713775635
Epoch: 13, Steps: 4 | Train Loss: 0.461 Vali Loss: 2.775 Vali Acc: 0.320 Test Loss: 2.775 Test Acc: 0.320
Validation loss decreased (-0.299980 --> -0.319972).  Saving model ...
Epoch: 14 cost time: 1.2262225151062012
Epoch: 14, Steps: 4 | Train Loss: 0.156 Vali Loss: 2.940 Vali Acc: 0.220 Test Loss: 2.940 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1582343578338623
Epoch: 15, Steps: 4 | Train Loss: 0.177 Vali Loss: 2.955 Vali Acc: 0.240 Test Loss: 2.955 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1635456085205078
Epoch: 16, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.290 Vali Acc: 0.300 Test Loss: 3.290 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2476873397827148
Epoch: 17, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.572 Vali Acc: 0.260 Test Loss: 3.572 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0298027992248535
Epoch: 18, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.566 Vali Acc: 0.220 Test Loss: 3.566 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1484899520874023
Epoch: 19, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.570 Vali Acc: 0.240 Test Loss: 3.570 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1013007164001465
Epoch: 20, Steps: 4 | Train Loss: 0.014 Vali Loss: 3.885 Vali Acc: 0.240 Test Loss: 3.885 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0134563446044922
Epoch: 21, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.490 Vali Acc: 0.260 Test Loss: 4.490 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0070059299468994
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.062 Vali Acc: 0.280 Test Loss: 5.062 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.210282325744629
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 5.477 Vali Acc: 0.280 Test Loss: 5.477 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3099437
model size : 16.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1965131759643555
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.610 Vali Acc: 0.160 Test Loss: 1.610 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.1838955879211426
Epoch: 2, Steps: 4 | Train Loss: 1.618 Vali Loss: 1.632 Vali Acc: 0.220 Test Loss: 1.632 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.1973164081573486
Epoch: 3, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.591 Vali Acc: 0.180 Test Loss: 1.591 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.104344129562378
Epoch: 4, Steps: 4 | Train Loss: 1.164 Vali Loss: 1.695 Vali Acc: 0.200 Test Loss: 1.695 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.076279640197754
Epoch: 5, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.754 Vali Acc: 0.240 Test Loss: 1.754 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239982).  Saving model ...
Epoch: 6 cost time: 1.0902378559112549
Epoch: 6, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.812 Vali Acc: 0.220 Test Loss: 1.812 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1199135780334473
Epoch: 7, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.846 Vali Acc: 0.260 Test Loss: 1.846 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259982).  Saving model ...
Epoch: 8 cost time: 1.1984562873840332
Epoch: 8, Steps: 4 | Train Loss: 0.782 Vali Loss: 1.855 Vali Acc: 0.220 Test Loss: 1.855 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0427157878875732
Epoch: 9, Steps: 4 | Train Loss: 0.676 Vali Loss: 2.049 Vali Acc: 0.240 Test Loss: 2.049 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1689929962158203
Epoch: 10, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.177 Vali Acc: 0.280 Test Loss: 2.177 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279978).  Saving model ...
Epoch: 11 cost time: 1.057539701461792
Epoch: 11, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.306 Vali Acc: 0.200 Test Loss: 2.306 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2654614448547363
Epoch: 12, Steps: 4 | Train Loss: 0.289 Vali Loss: 2.388 Vali Acc: 0.220 Test Loss: 2.388 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.1875262260437012
Epoch: 13, Steps: 4 | Train Loss: 0.450 Vali Loss: 2.547 Vali Acc: 0.280 Test Loss: 2.547 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.11844801902771
Epoch: 14, Steps: 4 | Train Loss: 0.193 Vali Loss: 2.748 Vali Acc: 0.260 Test Loss: 2.748 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.102327823638916
Epoch: 15, Steps: 4 | Train Loss: 0.204 Vali Loss: 2.637 Vali Acc: 0.260 Test Loss: 2.637 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.352384090423584
Epoch: 16, Steps: 4 | Train Loss: 0.082 Vali Loss: 2.963 Vali Acc: 0.240 Test Loss: 2.963 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3551025390625
Epoch: 17, Steps: 4 | Train Loss: 0.057 Vali Loss: 3.246 Vali Acc: 0.240 Test Loss: 3.246 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.1015076637268066
Epoch: 18, Steps: 4 | Train Loss: 0.042 Vali Loss: 3.196 Vali Acc: 0.220 Test Loss: 3.196 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1055738925933838
Epoch: 19, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.260 Vali Acc: 0.260 Test Loss: 3.260 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1587183475494385
Epoch: 20, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.649 Vali Acc: 0.240 Test Loss: 3.649 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 3099437
model size : 16.72MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.096897602081299
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1339988708496094
Epoch: 2, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.572 Vali Acc: 0.180 Test Loss: 1.572 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3541052341461182
Epoch: 3, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.565 Vali Acc: 0.220 Test Loss: 1.565 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.3348829746246338
Epoch: 4, Steps: 4 | Train Loss: 1.177 Vali Loss: 1.597 Vali Acc: 0.200 Test Loss: 1.597 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1461880207061768
Epoch: 5, Steps: 4 | Train Loss: 1.097 Vali Loss: 1.672 Vali Acc: 0.220 Test Loss: 1.672 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2307119369506836
Epoch: 6, Steps: 4 | Train Loss: 0.975 Vali Loss: 1.808 Vali Acc: 0.240 Test Loss: 1.808 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239982).  Saving model ...
Epoch: 7 cost time: 1.2748830318450928
Epoch: 7, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.949 Vali Acc: 0.260 Test Loss: 1.949 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259981).  Saving model ...
Epoch: 8 cost time: 1.2084519863128662
Epoch: 8, Steps: 4 | Train Loss: 0.806 Vali Loss: 2.000 Vali Acc: 0.240 Test Loss: 2.000 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1491308212280273
Epoch: 9, Steps: 4 | Train Loss: 0.441 Vali Loss: 2.114 Vali Acc: 0.240 Test Loss: 2.114 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1525661945343018
Epoch: 10, Steps: 4 | Train Loss: 0.617 Vali Loss: 2.191 Vali Acc: 0.260 Test Loss: 2.191 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0889370441436768
Epoch: 11, Steps: 4 | Train Loss: 0.465 Vali Loss: 2.266 Vali Acc: 0.240 Test Loss: 2.266 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0840189456939697
Epoch: 12, Steps: 4 | Train Loss: 0.359 Vali Loss: 2.357 Vali Acc: 0.220 Test Loss: 2.357 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1930439472198486
Epoch: 13, Steps: 4 | Train Loss: 0.227 Vali Loss: 2.504 Vali Acc: 0.280 Test Loss: 2.504 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279975).  Saving model ...
Epoch: 14 cost time: 1.154059648513794
Epoch: 14, Steps: 4 | Train Loss: 0.199 Vali Loss: 2.580 Vali Acc: 0.360 Test Loss: 2.580 Test Acc: 0.360
Validation loss decreased (-0.279975 --> -0.359974).  Saving model ...
Epoch: 15 cost time: 1.2123754024505615
Epoch: 15, Steps: 4 | Train Loss: 0.126 Vali Loss: 2.702 Vali Acc: 0.280 Test Loss: 2.702 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9980185031890869
Epoch: 16, Steps: 4 | Train Loss: 0.125 Vali Loss: 2.892 Vali Acc: 0.240 Test Loss: 2.892 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1479711532592773
Epoch: 17, Steps: 4 | Train Loss: 0.074 Vali Loss: 3.005 Vali Acc: 0.280 Test Loss: 3.005 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1542596817016602
Epoch: 18, Steps: 4 | Train Loss: 0.092 Vali Loss: 3.325 Vali Acc: 0.340 Test Loss: 3.325 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2343666553497314
Epoch: 19, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.395 Vali Acc: 0.320 Test Loss: 3.395 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2445712089538574
Epoch: 20, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.462 Vali Acc: 0.320 Test Loss: 3.462 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.235610008239746
Epoch: 21, Steps: 4 | Train Loss: 0.020 Vali Loss: 3.614 Vali Acc: 0.260 Test Loss: 3.614 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.2188451290130615
Epoch: 22, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.740 Vali Acc: 0.300 Test Loss: 3.740 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.0971360206604004
Epoch: 23, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.757 Vali Acc: 0.280 Test Loss: 3.757 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.220738172531128
Epoch: 24, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.865 Vali Acc: 0.300 Test Loss: 3.865 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 2505389
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8547005653381348
Epoch: 1, Steps: 4 | Train Loss: 1.636 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0509068965911865
Epoch: 2, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.113865852355957
Epoch: 3, Steps: 4 | Train Loss: 1.392 Vali Loss: 1.580 Vali Acc: 0.180 Test Loss: 1.580 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9804964065551758
Epoch: 4, Steps: 4 | Train Loss: 1.184 Vali Loss: 1.602 Vali Acc: 0.180 Test Loss: 1.602 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1826677322387695
Epoch: 5, Steps: 4 | Train Loss: 1.127 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0925581455230713
Epoch: 6, Steps: 4 | Train Loss: 1.021 Vali Loss: 1.816 Vali Acc: 0.240 Test Loss: 1.816 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239982).  Saving model ...
Epoch: 7 cost time: 1.0686616897583008
Epoch: 7, Steps: 4 | Train Loss: 0.845 Vali Loss: 1.937 Vali Acc: 0.280 Test Loss: 1.937 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279981).  Saving model ...
Epoch: 8 cost time: 1.1831941604614258
Epoch: 8, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.997 Vali Acc: 0.200 Test Loss: 1.997 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.059546709060669
Epoch: 9, Steps: 4 | Train Loss: 0.461 Vali Loss: 2.122 Vali Acc: 0.220 Test Loss: 2.122 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.185671091079712
Epoch: 10, Steps: 4 | Train Loss: 0.636 Vali Loss: 2.204 Vali Acc: 0.220 Test Loss: 2.204 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.289860725402832
Epoch: 11, Steps: 4 | Train Loss: 0.472 Vali Loss: 2.287 Vali Acc: 0.260 Test Loss: 2.287 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1736767292022705
Epoch: 12, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.365 Vali Acc: 0.260 Test Loss: 2.365 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1698682308197021
Epoch: 13, Steps: 4 | Train Loss: 0.238 Vali Loss: 2.497 Vali Acc: 0.260 Test Loss: 2.497 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1962125301361084
Epoch: 14, Steps: 4 | Train Loss: 0.220 Vali Loss: 2.612 Vali Acc: 0.360 Test Loss: 2.612 Test Acc: 0.360
Validation loss decreased (-0.279981 --> -0.359974).  Saving model ...
Epoch: 15 cost time: 1.2027149200439453
Epoch: 15, Steps: 4 | Train Loss: 0.147 Vali Loss: 2.700 Vali Acc: 0.300 Test Loss: 2.700 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.2679777145385742
Epoch: 16, Steps: 4 | Train Loss: 0.140 Vali Loss: 2.908 Vali Acc: 0.220 Test Loss: 2.908 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.115051507949829
Epoch: 17, Steps: 4 | Train Loss: 0.092 Vali Loss: 2.934 Vali Acc: 0.280 Test Loss: 2.934 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.358553409576416
Epoch: 18, Steps: 4 | Train Loss: 0.103 Vali Loss: 3.176 Vali Acc: 0.340 Test Loss: 3.176 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2630515098571777
Epoch: 19, Steps: 4 | Train Loss: 0.045 Vali Loss: 3.285 Vali Acc: 0.320 Test Loss: 3.285 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.223118543624878
Epoch: 20, Steps: 4 | Train Loss: 0.029 Vali Loss: 3.425 Vali Acc: 0.320 Test Loss: 3.425 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.3442094326019287
Epoch: 21, Steps: 4 | Train Loss: 0.022 Vali Loss: 3.573 Vali Acc: 0.320 Test Loss: 3.573 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3889906406402588
Epoch: 22, Steps: 4 | Train Loss: 0.021 Vali Loss: 3.723 Vali Acc: 0.340 Test Loss: 3.723 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.3965089321136475
Epoch: 23, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.740 Vali Acc: 0.340 Test Loss: 3.740 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3190550804138184
Epoch: 24, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.849 Vali Acc: 0.340 Test Loss: 3.849 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 2505389
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4819300174713135
Epoch: 1, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.651 Vali Acc: 0.200 Test Loss: 1.651 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.1662533283233643
Epoch: 2, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.1203699111938477
Epoch: 3, Steps: 4 | Train Loss: 1.424 Vali Loss: 1.598 Vali Acc: 0.220 Test Loss: 1.598 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0872445106506348
Epoch: 4, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.608 Vali Acc: 0.200 Test Loss: 1.608 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.06596040725708
Epoch: 5, Steps: 4 | Train Loss: 1.175 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1092808246612549
Epoch: 6, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.781 Vali Acc: 0.220 Test Loss: 1.781 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3114702701568604
Epoch: 7, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.914 Vali Acc: 0.240 Test Loss: 1.914 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9904205799102783
Epoch: 8, Steps: 4 | Train Loss: 0.867 Vali Loss: 1.984 Vali Acc: 0.220 Test Loss: 1.984 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1703133583068848
Epoch: 9, Steps: 4 | Train Loss: 0.508 Vali Loss: 2.098 Vali Acc: 0.240 Test Loss: 2.098 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2124793529510498
Epoch: 10, Steps: 4 | Train Loss: 0.717 Vali Loss: 2.158 Vali Acc: 0.220 Test Loss: 2.158 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.2628087997436523
Epoch: 11, Steps: 4 | Train Loss: 0.511 Vali Loss: 2.215 Vali Acc: 0.260 Test Loss: 2.215 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1567356586456299
Epoch: 12, Steps: 4 | Train Loss: 0.441 Vali Loss: 2.309 Vali Acc: 0.240 Test Loss: 2.309 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2505389
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9653985500335693
Epoch: 1, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.678 Vali Acc: 0.220 Test Loss: 1.678 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.1448140144348145
Epoch: 2, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.641 Vali Acc: 0.160 Test Loss: 1.641 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1601839065551758
Epoch: 3, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.613 Vali Acc: 0.220 Test Loss: 1.613 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.124236822128296
Epoch: 4, Steps: 4 | Train Loss: 1.266 Vali Loss: 1.593 Vali Acc: 0.200 Test Loss: 1.593 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.003530740737915
Epoch: 5, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0135807991027832
Epoch: 6, Steps: 4 | Train Loss: 1.129 Vali Loss: 1.702 Vali Acc: 0.220 Test Loss: 1.702 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.077265977859497
Epoch: 7, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.811 Vali Acc: 0.280 Test Loss: 1.811 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279982).  Saving model ...
Epoch: 8 cost time: 1.0436675548553467
Epoch: 8, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.843 Vali Acc: 0.240 Test Loss: 1.843 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.20253324508667
Epoch: 9, Steps: 4 | Train Loss: 0.595 Vali Loss: 1.932 Vali Acc: 0.220 Test Loss: 1.932 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0515813827514648
Epoch: 10, Steps: 4 | Train Loss: 0.803 Vali Loss: 1.954 Vali Acc: 0.240 Test Loss: 1.954 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.109954833984375
Epoch: 11, Steps: 4 | Train Loss: 0.617 Vali Loss: 1.972 Vali Acc: 0.240 Test Loss: 1.972 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1394906044006348
Epoch: 12, Steps: 4 | Train Loss: 0.526 Vali Loss: 1.990 Vali Acc: 0.260 Test Loss: 1.990 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.228628396987915
Epoch: 13, Steps: 4 | Train Loss: 0.355 Vali Loss: 2.071 Vali Acc: 0.240 Test Loss: 2.071 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0824975967407227
Epoch: 14, Steps: 4 | Train Loss: 0.326 Vali Loss: 2.104 Vali Acc: 0.300 Test Loss: 2.104 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299979).  Saving model ...
Epoch: 15 cost time: 1.2083687782287598
Epoch: 15, Steps: 4 | Train Loss: 0.227 Vali Loss: 2.148 Vali Acc: 0.260 Test Loss: 2.148 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0343387126922607
Epoch: 16, Steps: 4 | Train Loss: 0.215 Vali Loss: 2.273 Vali Acc: 0.300 Test Loss: 2.273 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1008291244506836
Epoch: 17, Steps: 4 | Train Loss: 0.158 Vali Loss: 2.407 Vali Acc: 0.300 Test Loss: 2.407 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.002563714981079
Epoch: 18, Steps: 4 | Train Loss: 0.170 Vali Loss: 2.465 Vali Acc: 0.320 Test Loss: 2.465 Test Acc: 0.320
Validation loss decreased (-0.299979 --> -0.319975).  Saving model ...
Epoch: 19 cost time: 1.2316961288452148
Epoch: 19, Steps: 4 | Train Loss: 0.073 Vali Loss: 2.677 Vali Acc: 0.280 Test Loss: 2.677 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.136887550354004
Epoch: 20, Steps: 4 | Train Loss: 0.049 Vali Loss: 2.912 Vali Acc: 0.260 Test Loss: 2.912 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1175572872161865
Epoch: 21, Steps: 4 | Train Loss: 0.035 Vali Loss: 3.097 Vali Acc: 0.280 Test Loss: 3.097 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1718859672546387
Epoch: 22, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.217 Vali Acc: 0.240 Test Loss: 3.217 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1209795475006104
Epoch: 23, Steps: 4 | Train Loss: 0.021 Vali Loss: 3.148 Vali Acc: 0.260 Test Loss: 3.148 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1339263916015625
Epoch: 24, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.286 Vali Acc: 0.280 Test Loss: 3.286 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.122070074081421
Epoch: 25, Steps: 4 | Train Loss: 0.011 Vali Loss: 3.492 Vali Acc: 0.280 Test Loss: 3.492 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1217825412750244
Epoch: 26, Steps: 4 | Train Loss: 0.008 Vali Loss: 3.678 Vali Acc: 0.300 Test Loss: 3.678 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.0271623134613037
Epoch: 27, Steps: 4 | Train Loss: 0.007 Vali Loss: 3.774 Vali Acc: 0.300 Test Loss: 3.774 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.0378308296203613
Epoch: 28, Steps: 4 | Train Loss: 0.004 Vali Loss: 3.815 Vali Acc: 0.300 Test Loss: 3.815 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 2505389
model size : 12.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.040743589401245
Epoch: 1, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.625 Vali Acc: 0.280 Test Loss: 1.625 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1839308738708496
Epoch: 2, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.580 Vali Acc: 0.220 Test Loss: 1.580 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2154271602630615
Epoch: 3, Steps: 4 | Train Loss: 1.364 Vali Loss: 1.580 Vali Acc: 0.220 Test Loss: 1.580 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.214684247970581
Epoch: 4, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.635 Vali Acc: 0.260 Test Loss: 1.635 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1870026588439941
Epoch: 5, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.689 Vali Acc: 0.280 Test Loss: 1.689 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1450486183166504
Epoch: 6, Steps: 4 | Train Loss: 0.948 Vali Loss: 1.816 Vali Acc: 0.340 Test Loss: 1.816 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339982).  Saving model ...
Epoch: 7 cost time: 1.1864886283874512
Epoch: 7, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.953 Vali Acc: 0.240 Test Loss: 1.953 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0592482089996338
Epoch: 8, Steps: 4 | Train Loss: 0.679 Vali Loss: 1.996 Vali Acc: 0.260 Test Loss: 1.996 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1797335147857666
Epoch: 9, Steps: 4 | Train Loss: 0.655 Vali Loss: 2.052 Vali Acc: 0.200 Test Loss: 2.052 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.187039852142334
Epoch: 10, Steps: 4 | Train Loss: 0.564 Vali Loss: 2.136 Vali Acc: 0.280 Test Loss: 2.136 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1033644676208496
Epoch: 11, Steps: 4 | Train Loss: 0.379 Vali Loss: 2.295 Vali Acc: 0.300 Test Loss: 2.295 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2365546226501465
Epoch: 12, Steps: 4 | Train Loss: 0.354 Vali Loss: 2.405 Vali Acc: 0.260 Test Loss: 2.405 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0214807987213135
Epoch: 13, Steps: 4 | Train Loss: 0.325 Vali Loss: 2.560 Vali Acc: 0.240 Test Loss: 2.560 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.034980297088623
Epoch: 14, Steps: 4 | Train Loss: 0.254 Vali Loss: 2.643 Vali Acc: 0.280 Test Loss: 2.643 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.143772840499878
Epoch: 15, Steps: 4 | Train Loss: 0.160 Vali Loss: 2.844 Vali Acc: 0.300 Test Loss: 2.844 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.101701021194458
Epoch: 16, Steps: 4 | Train Loss: 0.311 Vali Loss: 2.848 Vali Acc: 0.260 Test Loss: 2.848 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1981101
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9122259616851807
Epoch: 1, Steps: 4 | Train Loss: 1.635 Vali Loss: 1.611 Vali Acc: 0.280 Test Loss: 1.611 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.2079792022705078
Epoch: 2, Steps: 4 | Train Loss: 1.555 Vali Loss: 1.577 Vali Acc: 0.260 Test Loss: 1.577 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9540905952453613
Epoch: 3, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0212512016296387
Epoch: 4, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.616 Vali Acc: 0.240 Test Loss: 1.616 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0449016094207764
Epoch: 5, Steps: 4 | Train Loss: 1.133 Vali Loss: 1.679 Vali Acc: 0.260 Test Loss: 1.679 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0693199634552002
Epoch: 6, Steps: 4 | Train Loss: 0.983 Vali Loss: 1.783 Vali Acc: 0.300 Test Loss: 1.783 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 1.1701698303222656
Epoch: 7, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.889 Vali Acc: 0.240 Test Loss: 1.889 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1095023155212402
Epoch: 8, Steps: 4 | Train Loss: 0.722 Vali Loss: 1.967 Vali Acc: 0.280 Test Loss: 1.967 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.072537899017334
Epoch: 9, Steps: 4 | Train Loss: 0.712 Vali Loss: 2.026 Vali Acc: 0.240 Test Loss: 2.026 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1886513233184814
Epoch: 10, Steps: 4 | Train Loss: 0.601 Vali Loss: 2.142 Vali Acc: 0.260 Test Loss: 2.142 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.225813865661621
Epoch: 11, Steps: 4 | Train Loss: 0.413 Vali Loss: 2.325 Vali Acc: 0.280 Test Loss: 2.325 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.174759864807129
Epoch: 12, Steps: 4 | Train Loss: 0.376 Vali Loss: 2.455 Vali Acc: 0.220 Test Loss: 2.455 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9797406196594238
Epoch: 13, Steps: 4 | Train Loss: 0.354 Vali Loss: 2.625 Vali Acc: 0.240 Test Loss: 2.625 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1179659366607666
Epoch: 14, Steps: 4 | Train Loss: 0.292 Vali Loss: 2.737 Vali Acc: 0.240 Test Loss: 2.737 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0957396030426025
Epoch: 15, Steps: 4 | Train Loss: 0.181 Vali Loss: 2.930 Vali Acc: 0.280 Test Loss: 2.930 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0816361904144287
Epoch: 16, Steps: 4 | Train Loss: 0.324 Vali Loss: 2.978 Vali Acc: 0.280 Test Loss: 2.978 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1981101
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9597020149230957
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.624 Vali Acc: 0.280 Test Loss: 1.624 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1280643939971924
Epoch: 2, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.599 Vali Acc: 0.240 Test Loss: 1.599 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1725177764892578
Epoch: 3, Steps: 4 | Train Loss: 1.358 Vali Loss: 1.588 Vali Acc: 0.220 Test Loss: 1.588 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3169772624969482
Epoch: 4, Steps: 4 | Train Loss: 1.210 Vali Loss: 1.623 Vali Acc: 0.220 Test Loss: 1.623 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1681632995605469
Epoch: 5, Steps: 4 | Train Loss: 1.198 Vali Loss: 1.661 Vali Acc: 0.200 Test Loss: 1.661 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.1677651405334473
Epoch: 6, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.753 Vali Acc: 0.300 Test Loss: 1.753 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 1.0763804912567139
Epoch: 7, Steps: 4 | Train Loss: 0.809 Vali Loss: 1.863 Vali Acc: 0.220 Test Loss: 1.863 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2375943660736084
Epoch: 8, Steps: 4 | Train Loss: 0.798 Vali Loss: 1.953 Vali Acc: 0.260 Test Loss: 1.953 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.204122543334961
Epoch: 9, Steps: 4 | Train Loss: 0.745 Vali Loss: 2.017 Vali Acc: 0.240 Test Loss: 2.017 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3635585308074951
Epoch: 10, Steps: 4 | Train Loss: 0.658 Vali Loss: 2.143 Vali Acc: 0.260 Test Loss: 2.143 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.27055025100708
Epoch: 11, Steps: 4 | Train Loss: 0.479 Vali Loss: 2.302 Vali Acc: 0.260 Test Loss: 2.302 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1554315090179443
Epoch: 12, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.392 Vali Acc: 0.220 Test Loss: 2.392 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2431530952453613
Epoch: 13, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.443 Vali Acc: 0.260 Test Loss: 2.443 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2587077617645264
Epoch: 14, Steps: 4 | Train Loss: 0.335 Vali Loss: 2.497 Vali Acc: 0.260 Test Loss: 2.497 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3127198219299316
Epoch: 15, Steps: 4 | Train Loss: 0.210 Vali Loss: 2.658 Vali Acc: 0.240 Test Loss: 2.658 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2831950187683105
Epoch: 16, Steps: 4 | Train Loss: 0.393 Vali Loss: 2.739 Vali Acc: 0.260 Test Loss: 2.739 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1981101
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.82914662361145
Epoch: 1, Steps: 4 | Train Loss: 1.623 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.0442354679107666
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.606 Vali Acc: 0.260 Test Loss: 1.606 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.0783393383026123
Epoch: 3, Steps: 4 | Train Loss: 1.416 Vali Loss: 1.593 Vali Acc: 0.300 Test Loss: 1.593 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.1822550296783447
Epoch: 4, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.611 Vali Acc: 0.160 Test Loss: 1.611 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0907244682312012
Epoch: 5, Steps: 4 | Train Loss: 1.255 Vali Loss: 1.612 Vali Acc: 0.200 Test Loss: 1.612 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1004638671875
Epoch: 6, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.670 Vali Acc: 0.320 Test Loss: 1.670 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 7 cost time: 1.1405961513519287
Epoch: 7, Steps: 4 | Train Loss: 0.886 Vali Loss: 1.755 Vali Acc: 0.260 Test Loss: 1.755 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1001083850860596
Epoch: 8, Steps: 4 | Train Loss: 0.945 Vali Loss: 1.801 Vali Acc: 0.260 Test Loss: 1.801 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9978127479553223
Epoch: 9, Steps: 4 | Train Loss: 0.851 Vali Loss: 1.822 Vali Acc: 0.200 Test Loss: 1.822 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.187704086303711
Epoch: 10, Steps: 4 | Train Loss: 0.730 Vali Loss: 1.879 Vali Acc: 0.340 Test Loss: 1.879 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339981).  Saving model ...
Epoch: 11 cost time: 1.281310796737671
Epoch: 11, Steps: 4 | Train Loss: 0.572 Vali Loss: 1.995 Vali Acc: 0.300 Test Loss: 1.995 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0212504863739014
Epoch: 12, Steps: 4 | Train Loss: 0.473 Vali Loss: 1.960 Vali Acc: 0.260 Test Loss: 1.960 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9479019641876221
Epoch: 13, Steps: 4 | Train Loss: 0.469 Vali Loss: 1.954 Vali Acc: 0.280 Test Loss: 1.954 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1123008728027344
Epoch: 14, Steps: 4 | Train Loss: 0.398 Vali Loss: 1.978 Vali Acc: 0.320 Test Loss: 1.978 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0663678646087646
Epoch: 15, Steps: 4 | Train Loss: 0.263 Vali Loss: 2.033 Vali Acc: 0.320 Test Loss: 2.033 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2773795127868652
Epoch: 16, Steps: 4 | Train Loss: 0.425 Vali Loss: 2.158 Vali Acc: 0.280 Test Loss: 2.158 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1111359596252441
Epoch: 17, Steps: 4 | Train Loss: 0.156 Vali Loss: 2.252 Vali Acc: 0.280 Test Loss: 2.252 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0560648441314697
Epoch: 18, Steps: 4 | Train Loss: 0.114 Vali Loss: 2.464 Vali Acc: 0.300 Test Loss: 2.464 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0223352909088135
Epoch: 19, Steps: 4 | Train Loss: 0.107 Vali Loss: 2.841 Vali Acc: 0.280 Test Loss: 2.841 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0105009078979492
Epoch: 20, Steps: 4 | Train Loss: 0.071 Vali Loss: 3.006 Vali Acc: 0.260 Test Loss: 3.006 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1981101
model size : 10.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.192772388458252
Epoch: 1, Steps: 4 | Train Loss: 1.674 Vali Loss: 1.575 Vali Acc: 0.220 Test Loss: 1.575 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1104905605316162
Epoch: 2, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.549 Vali Acc: 0.340 Test Loss: 1.549 Test Acc: 0.340
Validation loss decreased (-0.219984 --> -0.339985).  Saving model ...
Epoch: 3 cost time: 1.0015869140625
Epoch: 3, Steps: 4 | Train Loss: 1.474 Vali Loss: 1.571 Vali Acc: 0.260 Test Loss: 1.571 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1486010551452637
Epoch: 4, Steps: 4 | Train Loss: 1.238 Vali Loss: 1.624 Vali Acc: 0.300 Test Loss: 1.624 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1210970878601074
Epoch: 5, Steps: 4 | Train Loss: 1.149 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.117994785308838
Epoch: 6, Steps: 4 | Train Loss: 0.919 Vali Loss: 1.701 Vali Acc: 0.220 Test Loss: 1.701 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.048762321472168
Epoch: 7, Steps: 4 | Train Loss: 0.765 Vali Loss: 1.770 Vali Acc: 0.280 Test Loss: 1.770 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1052322387695312
Epoch: 8, Steps: 4 | Train Loss: 0.695 Vali Loss: 1.879 Vali Acc: 0.300 Test Loss: 1.879 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1423513889312744
Epoch: 9, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.059 Vali Acc: 0.240 Test Loss: 2.059 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1296319961547852
Epoch: 10, Steps: 4 | Train Loss: 0.505 Vali Loss: 2.118 Vali Acc: 0.240 Test Loss: 2.118 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.076087474822998
Epoch: 11, Steps: 4 | Train Loss: 0.519 Vali Loss: 2.160 Vali Acc: 0.220 Test Loss: 2.160 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.012547254562378
Epoch: 12, Steps: 4 | Train Loss: 0.345 Vali Loss: 2.369 Vali Acc: 0.320 Test Loss: 2.369 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1718957
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.276104688644409
Epoch: 1, Steps: 4 | Train Loss: 1.647 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.097315788269043
Epoch: 2, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.559 Vali Acc: 0.260 Test Loss: 1.559 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.0503501892089844
Epoch: 3, Steps: 4 | Train Loss: 1.511 Vali Loss: 1.554 Vali Acc: 0.300 Test Loss: 1.554 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.2092790603637695
Epoch: 4, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.604 Vali Acc: 0.300 Test Loss: 1.604 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1459589004516602
Epoch: 5, Steps: 4 | Train Loss: 1.166 Vali Loss: 1.683 Vali Acc: 0.320 Test Loss: 1.683 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 1.0662381649017334
Epoch: 6, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.693 Vali Acc: 0.240 Test Loss: 1.693 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.098386287689209
Epoch: 7, Steps: 4 | Train Loss: 0.775 Vali Loss: 1.744 Vali Acc: 0.240 Test Loss: 1.744 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0483818054199219
Epoch: 8, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.888 Vali Acc: 0.280 Test Loss: 1.888 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.911156177520752
Epoch: 9, Steps: 4 | Train Loss: 0.565 Vali Loss: 2.042 Vali Acc: 0.220 Test Loss: 2.042 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1399962902069092
Epoch: 10, Steps: 4 | Train Loss: 0.560 Vali Loss: 2.112 Vali Acc: 0.240 Test Loss: 2.112 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9468729496002197
Epoch: 11, Steps: 4 | Train Loss: 0.571 Vali Loss: 2.164 Vali Acc: 0.220 Test Loss: 2.164 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1399726867675781
Epoch: 12, Steps: 4 | Train Loss: 0.374 Vali Loss: 2.344 Vali Acc: 0.280 Test Loss: 2.344 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9998288154602051
Epoch: 13, Steps: 4 | Train Loss: 0.357 Vali Loss: 2.548 Vali Acc: 0.280 Test Loss: 2.548 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9385864734649658
Epoch: 14, Steps: 4 | Train Loss: 0.478 Vali Loss: 2.822 Vali Acc: 0.320 Test Loss: 2.822 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.923851728439331
Epoch: 15, Steps: 4 | Train Loss: 0.221 Vali Loss: 2.750 Vali Acc: 0.320 Test Loss: 2.750 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1718957
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2617709636688232
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.611 Vali Acc: 0.220 Test Loss: 1.611 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1677772998809814
Epoch: 2, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.592 Vali Acc: 0.280 Test Loss: 1.592 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.326430320739746
Epoch: 3, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.592 Vali Acc: 0.220 Test Loss: 1.592 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1304097175598145
Epoch: 4, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.644 Vali Acc: 0.280 Test Loss: 1.644 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3382837772369385
Epoch: 5, Steps: 4 | Train Loss: 1.172 Vali Loss: 1.691 Vali Acc: 0.260 Test Loss: 1.691 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3163492679595947
Epoch: 6, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.733 Vali Acc: 0.220 Test Loss: 1.733 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.19380521774292
Epoch: 7, Steps: 4 | Train Loss: 0.834 Vali Loss: 1.771 Vali Acc: 0.200 Test Loss: 1.771 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3613388538360596
Epoch: 8, Steps: 4 | Train Loss: 0.779 Vali Loss: 1.869 Vali Acc: 0.300 Test Loss: 1.869 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299981).  Saving model ...
Epoch: 9 cost time: 1.1268436908721924
Epoch: 9, Steps: 4 | Train Loss: 0.634 Vali Loss: 2.019 Vali Acc: 0.220 Test Loss: 2.019 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1678435802459717
Epoch: 10, Steps: 4 | Train Loss: 0.624 Vali Loss: 2.105 Vali Acc: 0.200 Test Loss: 2.105 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1590721607208252
Epoch: 11, Steps: 4 | Train Loss: 0.632 Vali Loss: 2.158 Vali Acc: 0.220 Test Loss: 2.158 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3606407642364502
Epoch: 12, Steps: 4 | Train Loss: 0.427 Vali Loss: 2.341 Vali Acc: 0.220 Test Loss: 2.341 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.239008903503418
Epoch: 13, Steps: 4 | Train Loss: 0.395 Vali Loss: 2.500 Vali Acc: 0.260 Test Loss: 2.500 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1945505142211914
Epoch: 14, Steps: 4 | Train Loss: 0.516 Vali Loss: 2.744 Vali Acc: 0.340 Test Loss: 2.744 Test Acc: 0.340
Validation loss decreased (-0.299981 --> -0.339973).  Saving model ...
Epoch: 15 cost time: 1.2554044723510742
Epoch: 15, Steps: 4 | Train Loss: 0.243 Vali Loss: 2.614 Vali Acc: 0.320 Test Loss: 2.614 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.217543363571167
Epoch: 16, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.683 Vali Acc: 0.300 Test Loss: 2.683 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0733139514923096
Epoch: 17, Steps: 4 | Train Loss: 0.120 Vali Loss: 2.777 Vali Acc: 0.300 Test Loss: 2.777 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1960744857788086
Epoch: 18, Steps: 4 | Train Loss: 0.079 Vali Loss: 2.939 Vali Acc: 0.280 Test Loss: 2.939 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1169209480285645
Epoch: 19, Steps: 4 | Train Loss: 0.072 Vali Loss: 3.154 Vali Acc: 0.300 Test Loss: 3.154 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.151763677597046
Epoch: 20, Steps: 4 | Train Loss: 0.045 Vali Loss: 3.323 Vali Acc: 0.260 Test Loss: 3.323 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.102781057357788
Epoch: 21, Steps: 4 | Train Loss: 0.057 Vali Loss: 3.477 Vali Acc: 0.260 Test Loss: 3.477 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.0293242931365967
Epoch: 22, Steps: 4 | Train Loss: 0.036 Vali Loss: 3.537 Vali Acc: 0.260 Test Loss: 3.537 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.261826753616333
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 3.512 Vali Acc: 0.260 Test Loss: 3.512 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1220240592956543
Epoch: 24, Steps: 4 | Train Loss: 0.013 Vali Loss: 3.576 Vali Acc: 0.200 Test Loss: 3.576 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1718957
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7858567237854004
Epoch: 1, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.639 Vali Acc: 0.280 Test Loss: 1.639 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1663188934326172
Epoch: 2, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.615 Vali Acc: 0.300 Test Loss: 1.615 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 0.9813556671142578
Epoch: 3, Steps: 4 | Train Loss: 1.515 Vali Loss: 1.616 Vali Acc: 0.220 Test Loss: 1.616 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.058828592300415
Epoch: 4, Steps: 4 | Train Loss: 1.336 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.153609037399292
Epoch: 5, Steps: 4 | Train Loss: 1.261 Vali Loss: 1.665 Vali Acc: 0.240 Test Loss: 1.665 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2300612926483154
Epoch: 6, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.646 Vali Acc: 0.220 Test Loss: 1.646 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.139082908630371
Epoch: 7, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.651 Vali Acc: 0.240 Test Loss: 1.651 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.13751220703125
Epoch: 8, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.754 Vali Acc: 0.240 Test Loss: 1.754 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0412404537200928
Epoch: 9, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.861 Vali Acc: 0.240 Test Loss: 1.861 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 0.9630725383758545
Epoch: 10, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.896 Vali Acc: 0.240 Test Loss: 1.896 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0077226161956787
Epoch: 11, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.887 Vali Acc: 0.260 Test Loss: 1.887 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.0243244171142578
Epoch: 12, Steps: 4 | Train Loss: 0.496 Vali Loss: 1.984 Vali Acc: 0.320 Test Loss: 1.984 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319980).  Saving model ...
Epoch: 13 cost time: 0.9898769855499268
Epoch: 13, Steps: 4 | Train Loss: 0.490 Vali Loss: 2.105 Vali Acc: 0.280 Test Loss: 2.105 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.9691674709320068
Epoch: 14, Steps: 4 | Train Loss: 0.604 Vali Loss: 2.167 Vali Acc: 0.260 Test Loss: 2.167 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0078814029693604
Epoch: 15, Steps: 4 | Train Loss: 0.275 Vali Loss: 2.025 Vali Acc: 0.300 Test Loss: 2.025 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9732882976531982
Epoch: 16, Steps: 4 | Train Loss: 0.280 Vali Loss: 2.050 Vali Acc: 0.260 Test Loss: 2.050 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.161302089691162
Epoch: 17, Steps: 4 | Train Loss: 0.156 Vali Loss: 2.271 Vali Acc: 0.240 Test Loss: 2.271 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0959081649780273
Epoch: 18, Steps: 4 | Train Loss: 0.108 Vali Loss: 2.540 Vali Acc: 0.300 Test Loss: 2.540 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0452852249145508
Epoch: 19, Steps: 4 | Train Loss: 0.103 Vali Loss: 2.721 Vali Acc: 0.320 Test Loss: 2.721 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1732723712921143
Epoch: 20, Steps: 4 | Train Loss: 0.063 Vali Loss: 2.760 Vali Acc: 0.280 Test Loss: 2.760 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1210417747497559
Epoch: 21, Steps: 4 | Train Loss: 0.086 Vali Loss: 2.872 Vali Acc: 0.300 Test Loss: 2.872 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1307954788208008
Epoch: 22, Steps: 4 | Train Loss: 0.041 Vali Loss: 3.016 Vali Acc: 0.300 Test Loss: 3.016 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1718957
model size : 9.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0994532108306885
Epoch: 1, Steps: 4 | Train Loss: 1.866 Vali Loss: 1.645 Vali Acc: 0.220 Test Loss: 1.645 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0251364707946777
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.590 Vali Acc: 0.220 Test Loss: 1.590 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.2461838722229004
Epoch: 3, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.552 Vali Acc: 0.200 Test Loss: 1.552 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2830607891082764
Epoch: 4, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.581 Vali Acc: 0.220 Test Loss: 1.581 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.1218271255493164
Epoch: 5, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.732 Vali Acc: 0.240 Test Loss: 1.732 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 1.0974705219268799
Epoch: 6, Steps: 4 | Train Loss: 0.903 Vali Loss: 1.875 Vali Acc: 0.260 Test Loss: 1.875 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259981).  Saving model ...
Epoch: 7 cost time: 1.072472333908081
Epoch: 7, Steps: 4 | Train Loss: 0.825 Vali Loss: 1.941 Vali Acc: 0.280 Test Loss: 1.941 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279981).  Saving model ...
Epoch: 8 cost time: 0.989403486251831
Epoch: 8, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.941 Vali Acc: 0.300 Test Loss: 1.941 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299981).  Saving model ...
Epoch: 9 cost time: 1.2002909183502197
Epoch: 9, Steps: 4 | Train Loss: 0.650 Vali Loss: 2.045 Vali Acc: 0.280 Test Loss: 2.045 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0156307220458984
Epoch: 10, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.216 Vali Acc: 0.300 Test Loss: 2.216 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1842856407165527
Epoch: 11, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.382 Vali Acc: 0.240 Test Loss: 2.382 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.158721685409546
Epoch: 12, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.490 Vali Acc: 0.260 Test Loss: 2.490 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1805191040039062
Epoch: 13, Steps: 4 | Train Loss: 0.366 Vali Loss: 2.440 Vali Acc: 0.280 Test Loss: 2.440 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.204883337020874
Epoch: 14, Steps: 4 | Train Loss: 0.243 Vali Loss: 2.678 Vali Acc: 0.260 Test Loss: 2.678 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2959587574005127
Epoch: 15, Steps: 4 | Train Loss: 0.214 Vali Loss: 2.928 Vali Acc: 0.260 Test Loss: 2.928 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2604219913482666
Epoch: 16, Steps: 4 | Train Loss: 0.134 Vali Loss: 3.142 Vali Acc: 0.280 Test Loss: 3.142 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1316652297973633
Epoch: 17, Steps: 4 | Train Loss: 0.114 Vali Loss: 3.383 Vali Acc: 0.280 Test Loss: 3.383 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.188204288482666
Epoch: 18, Steps: 4 | Train Loss: 0.095 Vali Loss: 3.364 Vali Acc: 0.280 Test Loss: 3.364 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1587885
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.01139497756958
Epoch: 1, Steps: 4 | Train Loss: 1.811 Vali Loss: 1.678 Vali Acc: 0.200 Test Loss: 1.678 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.0831599235534668
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.628 Vali Acc: 0.200 Test Loss: 1.628 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.2070400714874268
Epoch: 3, Steps: 4 | Train Loss: 1.501 Vali Loss: 1.583 Vali Acc: 0.180 Test Loss: 1.583 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0906023979187012
Epoch: 4, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.615 Vali Acc: 0.260 Test Loss: 1.615 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.07340669631958
Epoch: 5, Steps: 4 | Train Loss: 1.084 Vali Loss: 1.767 Vali Acc: 0.180 Test Loss: 1.767 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0179762840270996
Epoch: 6, Steps: 4 | Train Loss: 0.932 Vali Loss: 1.873 Vali Acc: 0.280 Test Loss: 1.873 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.0866484642028809
Epoch: 7, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.929 Vali Acc: 0.300 Test Loss: 1.929 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299981).  Saving model ...
Epoch: 8 cost time: 1.0605030059814453
Epoch: 8, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.942 Vali Acc: 0.280 Test Loss: 1.942 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.9758501052856445
Epoch: 9, Steps: 4 | Train Loss: 0.701 Vali Loss: 2.079 Vali Acc: 0.260 Test Loss: 2.079 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.086010456085205
Epoch: 10, Steps: 4 | Train Loss: 0.434 Vali Loss: 2.234 Vali Acc: 0.260 Test Loss: 2.234 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.9648635387420654
Epoch: 11, Steps: 4 | Train Loss: 0.455 Vali Loss: 2.369 Vali Acc: 0.240 Test Loss: 2.369 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9678583145141602
Epoch: 12, Steps: 4 | Train Loss: 0.568 Vali Loss: 2.472 Vali Acc: 0.220 Test Loss: 2.472 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.908543586730957
Epoch: 13, Steps: 4 | Train Loss: 0.391 Vali Loss: 2.473 Vali Acc: 0.300 Test Loss: 2.473 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0985774993896484
Epoch: 14, Steps: 4 | Train Loss: 0.270 Vali Loss: 2.665 Vali Acc: 0.240 Test Loss: 2.665 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1748156547546387
Epoch: 15, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.907 Vali Acc: 0.260 Test Loss: 2.907 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.150510549545288
Epoch: 16, Steps: 4 | Train Loss: 0.154 Vali Loss: 3.123 Vali Acc: 0.300 Test Loss: 3.123 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.0921807289123535
Epoch: 17, Steps: 4 | Train Loss: 0.132 Vali Loss: 3.288 Vali Acc: 0.300 Test Loss: 3.288 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1587885
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.952852249145508
Epoch: 1, Steps: 4 | Train Loss: 1.793 Vali Loss: 1.633 Vali Acc: 0.260 Test Loss: 1.633 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 0.9731197357177734
Epoch: 2, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.598 Vali Acc: 0.260 Test Loss: 1.598 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.080650806427002
Epoch: 3, Steps: 4 | Train Loss: 1.513 Vali Loss: 1.574 Vali Acc: 0.220 Test Loss: 1.574 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9333868026733398
Epoch: 4, Steps: 4 | Train Loss: 1.363 Vali Loss: 1.603 Vali Acc: 0.240 Test Loss: 1.603 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.974846363067627
Epoch: 5, Steps: 4 | Train Loss: 1.117 Vali Loss: 1.713 Vali Acc: 0.240 Test Loss: 1.713 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.083909273147583
Epoch: 6, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.814 Vali Acc: 0.300 Test Loss: 1.814 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299982).  Saving model ...
Epoch: 7 cost time: 0.9520282745361328
Epoch: 7, Steps: 4 | Train Loss: 0.877 Vali Loss: 1.885 Vali Acc: 0.260 Test Loss: 1.885 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9760868549346924
Epoch: 8, Steps: 4 | Train Loss: 0.770 Vali Loss: 1.918 Vali Acc: 0.220 Test Loss: 1.918 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.9600405693054199
Epoch: 9, Steps: 4 | Train Loss: 0.755 Vali Loss: 2.028 Vali Acc: 0.220 Test Loss: 2.028 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1673402786254883
Epoch: 10, Steps: 4 | Train Loss: 0.479 Vali Loss: 2.155 Vali Acc: 0.260 Test Loss: 2.155 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.9927144050598145
Epoch: 11, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.288 Vali Acc: 0.280 Test Loss: 2.288 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 0.9719829559326172
Epoch: 12, Steps: 4 | Train Loss: 0.625 Vali Loss: 2.396 Vali Acc: 0.200 Test Loss: 2.396 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.036754846572876
Epoch: 13, Steps: 4 | Train Loss: 0.420 Vali Loss: 2.338 Vali Acc: 0.220 Test Loss: 2.338 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 0.9759304523468018
Epoch: 14, Steps: 4 | Train Loss: 0.308 Vali Loss: 2.466 Vali Acc: 0.220 Test Loss: 2.466 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9415233135223389
Epoch: 15, Steps: 4 | Train Loss: 0.261 Vali Loss: 2.660 Vali Acc: 0.280 Test Loss: 2.660 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.033085584640503
Epoch: 16, Steps: 4 | Train Loss: 0.178 Vali Loss: 2.796 Vali Acc: 0.320 Test Loss: 2.796 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319972).  Saving model ...
Epoch: 17 cost time: 1.1760635375976562
Epoch: 17, Steps: 4 | Train Loss: 0.153 Vali Loss: 2.992 Vali Acc: 0.300 Test Loss: 2.992 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2209415435791016
Epoch: 18, Steps: 4 | Train Loss: 0.138 Vali Loss: 2.962 Vali Acc: 0.260 Test Loss: 2.962 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0928738117218018
Epoch: 19, Steps: 4 | Train Loss: 0.090 Vali Loss: 3.196 Vali Acc: 0.280 Test Loss: 3.196 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.1289186477661133
Epoch: 20, Steps: 4 | Train Loss: 0.053 Vali Loss: 3.453 Vali Acc: 0.260 Test Loss: 3.453 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.23231840133667
Epoch: 21, Steps: 4 | Train Loss: 0.050 Vali Loss: 3.616 Vali Acc: 0.280 Test Loss: 3.616 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.0703554153442383
Epoch: 22, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.606 Vali Acc: 0.260 Test Loss: 3.606 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.171882152557373
Epoch: 23, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.802 Vali Acc: 0.240 Test Loss: 3.802 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9973666667938232
Epoch: 24, Steps: 4 | Train Loss: 0.021 Vali Loss: 3.967 Vali Acc: 0.220 Test Loss: 3.967 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.0790038108825684
Epoch: 25, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.155 Vali Acc: 0.240 Test Loss: 4.155 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.1640112400054932
Epoch: 26, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.278 Vali Acc: 0.280 Test Loss: 4.278 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1587885
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0350964069366455
Epoch: 1, Steps: 4 | Train Loss: 1.717 Vali Loss: 1.628 Vali Acc: 0.240 Test Loss: 1.628 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.1130905151367188
Epoch: 2, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.595 Vali Acc: 0.220 Test Loss: 1.595 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9851381778717041
Epoch: 3, Steps: 4 | Train Loss: 1.507 Vali Loss: 1.562 Vali Acc: 0.220 Test Loss: 1.562 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0573744773864746
Epoch: 4, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.576 Vali Acc: 0.220 Test Loss: 1.576 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9928767681121826
Epoch: 5, Steps: 4 | Train Loss: 1.197 Vali Loss: 1.668 Vali Acc: 0.240 Test Loss: 1.668 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.025129795074463
Epoch: 6, Steps: 4 | Train Loss: 1.066 Vali Loss: 1.714 Vali Acc: 0.280 Test Loss: 1.714 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279983).  Saving model ...
Epoch: 7 cost time: 0.9704952239990234
Epoch: 7, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.758 Vali Acc: 0.260 Test Loss: 1.758 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1233911514282227
Epoch: 8, Steps: 4 | Train Loss: 0.842 Vali Loss: 1.782 Vali Acc: 0.260 Test Loss: 1.782 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1819257736206055
Epoch: 9, Steps: 4 | Train Loss: 0.847 Vali Loss: 1.882 Vali Acc: 0.240 Test Loss: 1.882 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0395007133483887
Epoch: 10, Steps: 4 | Train Loss: 0.561 Vali Loss: 1.982 Vali Acc: 0.260 Test Loss: 1.982 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1434698104858398
Epoch: 11, Steps: 4 | Train Loss: 0.593 Vali Loss: 2.087 Vali Acc: 0.300 Test Loss: 2.087 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299979).  Saving model ...
Epoch: 12 cost time: 1.0948002338409424
Epoch: 12, Steps: 4 | Train Loss: 0.682 Vali Loss: 2.096 Vali Acc: 0.260 Test Loss: 2.096 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0939908027648926
Epoch: 13, Steps: 4 | Train Loss: 0.528 Vali Loss: 1.945 Vali Acc: 0.240 Test Loss: 1.945 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1429712772369385
Epoch: 14, Steps: 4 | Train Loss: 0.386 Vali Loss: 1.990 Vali Acc: 0.300 Test Loss: 1.990 Test Acc: 0.300
Validation loss decreased (-0.299979 --> -0.299980).  Saving model ...
Epoch: 15 cost time: 1.116797924041748
Epoch: 15, Steps: 4 | Train Loss: 0.324 Vali Loss: 2.114 Vali Acc: 0.320 Test Loss: 2.114 Test Acc: 0.320
Validation loss decreased (-0.299980 --> -0.319979).  Saving model ...
Epoch: 16 cost time: 1.1703476905822754
Epoch: 16, Steps: 4 | Train Loss: 0.225 Vali Loss: 2.249 Vali Acc: 0.260 Test Loss: 2.249 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1321630477905273
Epoch: 17, Steps: 4 | Train Loss: 0.170 Vali Loss: 2.335 Vali Acc: 0.300 Test Loss: 2.335 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1117794513702393
Epoch: 18, Steps: 4 | Train Loss: 0.177 Vali Loss: 2.328 Vali Acc: 0.300 Test Loss: 2.328 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.1820991039276123
Epoch: 19, Steps: 4 | Train Loss: 0.117 Vali Loss: 2.501 Vali Acc: 0.260 Test Loss: 2.501 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1545538902282715
Epoch: 20, Steps: 4 | Train Loss: 0.069 Vali Loss: 2.617 Vali Acc: 0.280 Test Loss: 2.617 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1083950996398926
Epoch: 21, Steps: 4 | Train Loss: 0.063 Vali Loss: 2.792 Vali Acc: 0.300 Test Loss: 2.792 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.1269664764404297
Epoch: 22, Steps: 4 | Train Loss: 0.050 Vali Loss: 2.937 Vali Acc: 0.260 Test Loss: 2.937 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.129220724105835
Epoch: 23, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.182 Vali Acc: 0.280 Test Loss: 3.182 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0135068893432617
Epoch: 24, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.301 Vali Acc: 0.280 Test Loss: 3.301 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9597017765045166
Epoch: 25, Steps: 4 | Train Loss: 0.016 Vali Loss: 3.465 Vali Acc: 0.280 Test Loss: 3.465 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1587885
model size : 8.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.822134017944336
Epoch: 1, Steps: 4 | Train Loss: 1.691 Vali Loss: 1.657 Vali Acc: 0.120 Test Loss: 1.657 Test Acc: 0.120
Validation loss decreased (inf --> -0.119983).  Saving model ...
Epoch: 2 cost time: 0.957876443862915
Epoch: 2, Steps: 4 | Train Loss: 1.587 Vali Loss: 1.601 Vali Acc: 0.100 Test Loss: 1.601 Test Acc: 0.100
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0215072631835938
Epoch: 3, Steps: 4 | Train Loss: 1.438 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
Validation loss decreased (-0.119983 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 0.936164140701294
Epoch: 4, Steps: 4 | Train Loss: 1.290 Vali Loss: 1.605 Vali Acc: 0.200 Test Loss: 1.605 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1200480461120605
Epoch: 5, Steps: 4 | Train Loss: 1.137 Vali Loss: 1.682 Vali Acc: 0.160 Test Loss: 1.682 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0427029132843018
Epoch: 6, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.767 Vali Acc: 0.160 Test Loss: 1.767 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0329933166503906
Epoch: 7, Steps: 4 | Train Loss: 0.913 Vali Loss: 1.832 Vali Acc: 0.240 Test Loss: 1.832 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0016486644744873
Epoch: 8, Steps: 4 | Train Loss: 0.656 Vali Loss: 1.853 Vali Acc: 0.220 Test Loss: 1.853 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1152920722961426
Epoch: 9, Steps: 4 | Train Loss: 0.525 Vali Loss: 1.998 Vali Acc: 0.180 Test Loss: 1.998 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.136716365814209
Epoch: 10, Steps: 4 | Train Loss: 0.560 Vali Loss: 2.149 Vali Acc: 0.180 Test Loss: 2.149 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.063582420349121
Epoch: 11, Steps: 4 | Train Loss: 0.457 Vali Loss: 2.275 Vali Acc: 0.240 Test Loss: 2.275 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0999794006347656
Epoch: 12, Steps: 4 | Train Loss: 0.441 Vali Loss: 2.341 Vali Acc: 0.200 Test Loss: 2.341 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.1471507549285889
Epoch: 13, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.492 Vali Acc: 0.220 Test Loss: 2.492 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1522349
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.5412240028381348
Epoch: 1, Steps: 4 | Train Loss: 1.684 Vali Loss: 1.673 Vali Acc: 0.100 Test Loss: 1.673 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 0.9949755668640137
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.633 Vali Acc: 0.140 Test Loss: 1.633 Test Acc: 0.140
Validation loss decreased (-0.099983 --> -0.139984).  Saving model ...
Epoch: 3 cost time: 1.117349624633789
Epoch: 3, Steps: 4 | Train Loss: 1.417 Vali Loss: 1.591 Vali Acc: 0.180 Test Loss: 1.591 Test Acc: 0.180
Validation loss decreased (-0.139984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.0870857238769531
Epoch: 4, Steps: 4 | Train Loss: 1.308 Vali Loss: 1.615 Vali Acc: 0.200 Test Loss: 1.615 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 5 cost time: 1.1660516262054443
Epoch: 5, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.682 Vali Acc: 0.140 Test Loss: 1.682 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9939858913421631
Epoch: 6, Steps: 4 | Train Loss: 0.831 Vali Loss: 1.736 Vali Acc: 0.180 Test Loss: 1.736 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0939631462097168
Epoch: 7, Steps: 4 | Train Loss: 0.949 Vali Loss: 1.833 Vali Acc: 0.200 Test Loss: 1.833 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1013505458831787
Epoch: 8, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.875 Vali Acc: 0.200 Test Loss: 1.875 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.9922218322753906
Epoch: 9, Steps: 4 | Train Loss: 0.570 Vali Loss: 2.027 Vali Acc: 0.180 Test Loss: 2.027 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.1601085662841797
Epoch: 10, Steps: 4 | Train Loss: 0.596 Vali Loss: 2.196 Vali Acc: 0.180 Test Loss: 2.196 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.054175853729248
Epoch: 11, Steps: 4 | Train Loss: 0.489 Vali Loss: 2.329 Vali Acc: 0.260 Test Loss: 2.329 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259977).  Saving model ...
Epoch: 12 cost time: 1.0562870502471924
Epoch: 12, Steps: 4 | Train Loss: 0.446 Vali Loss: 2.407 Vali Acc: 0.220 Test Loss: 2.407 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2761318683624268
Epoch: 13, Steps: 4 | Train Loss: 0.262 Vali Loss: 2.574 Vali Acc: 0.220 Test Loss: 2.574 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1924529075622559
Epoch: 14, Steps: 4 | Train Loss: 0.397 Vali Loss: 2.723 Vali Acc: 0.280 Test Loss: 2.723 Test Acc: 0.280
Validation loss decreased (-0.259977 --> -0.279973).  Saving model ...
Epoch: 15 cost time: 1.2061734199523926
Epoch: 15, Steps: 4 | Train Loss: 0.213 Vali Loss: 2.900 Vali Acc: 0.260 Test Loss: 2.900 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.1202998161315918
Epoch: 16, Steps: 4 | Train Loss: 0.162 Vali Loss: 3.015 Vali Acc: 0.300 Test Loss: 3.015 Test Acc: 0.300
Validation loss decreased (-0.279973 --> -0.299970).  Saving model ...
Epoch: 17 cost time: 1.1284332275390625
Epoch: 17, Steps: 4 | Train Loss: 0.109 Vali Loss: 3.076 Vali Acc: 0.300 Test Loss: 3.076 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.2403564453125
Epoch: 18, Steps: 4 | Train Loss: 0.095 Vali Loss: 2.988 Vali Acc: 0.300 Test Loss: 2.988 Test Acc: 0.300
Validation loss decreased (-0.299970 --> -0.299970).  Saving model ...
Epoch: 19 cost time: 1.1315011978149414
Epoch: 19, Steps: 4 | Train Loss: 0.067 Vali Loss: 3.098 Vali Acc: 0.260 Test Loss: 3.098 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.209928035736084
Epoch: 20, Steps: 4 | Train Loss: 0.053 Vali Loss: 3.370 Vali Acc: 0.280 Test Loss: 3.370 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2570359706878662
Epoch: 21, Steps: 4 | Train Loss: 0.036 Vali Loss: 3.733 Vali Acc: 0.280 Test Loss: 3.733 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.157564640045166
Epoch: 22, Steps: 4 | Train Loss: 0.032 Vali Loss: 3.978 Vali Acc: 0.280 Test Loss: 3.978 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.1581158638000488
Epoch: 23, Steps: 4 | Train Loss: 0.019 Vali Loss: 4.117 Vali Acc: 0.300 Test Loss: 4.117 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.154721975326538
Epoch: 24, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.087 Vali Acc: 0.280 Test Loss: 4.087 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.1751797199249268
Epoch: 25, Steps: 4 | Train Loss: 0.023 Vali Loss: 4.028 Vali Acc: 0.260 Test Loss: 4.028 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.209397792816162
Epoch: 26, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.138 Vali Acc: 0.300 Test Loss: 4.138 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.9469399452209473
Epoch: 27, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.175 Vali Acc: 0.280 Test Loss: 4.175 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1727824211120605
Epoch: 28, Steps: 4 | Train Loss: 0.007 Vali Loss: 4.205 Vali Acc: 0.240 Test Loss: 4.205 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1522349
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2739014625549316
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.652 Vali Acc: 0.080 Test Loss: 1.652 Test Acc: 0.080
Validation loss decreased (inf --> -0.079983).  Saving model ...
Epoch: 2 cost time: 1.2347395420074463
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
Validation loss decreased (-0.079983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.137880802154541
Epoch: 3, Steps: 4 | Train Loss: 1.435 Vali Loss: 1.591 Vali Acc: 0.200 Test Loss: 1.591 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.16391921043396
Epoch: 4, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.600 Vali Acc: 0.200 Test Loss: 1.600 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1177072525024414
Epoch: 5, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1122286319732666
Epoch: 6, Steps: 4 | Train Loss: 0.873 Vali Loss: 1.704 Vali Acc: 0.180 Test Loss: 1.704 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1022722721099854
Epoch: 7, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.799 Vali Acc: 0.220 Test Loss: 1.799 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219982).  Saving model ...
Epoch: 8 cost time: 1.1469261646270752
Epoch: 8, Steps: 4 | Train Loss: 0.756 Vali Loss: 1.834 Vali Acc: 0.200 Test Loss: 1.834 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1996135711669922
Epoch: 9, Steps: 4 | Train Loss: 0.603 Vali Loss: 1.991 Vali Acc: 0.200 Test Loss: 1.991 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1121151447296143
Epoch: 10, Steps: 4 | Train Loss: 0.628 Vali Loss: 2.160 Vali Acc: 0.200 Test Loss: 2.160 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1153318881988525
Epoch: 11, Steps: 4 | Train Loss: 0.535 Vali Loss: 2.262 Vali Acc: 0.260 Test Loss: 2.262 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259977).  Saving model ...
Epoch: 12 cost time: 1.0577685832977295
Epoch: 12, Steps: 4 | Train Loss: 0.462 Vali Loss: 2.391 Vali Acc: 0.200 Test Loss: 2.391 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1099364757537842
Epoch: 13, Steps: 4 | Train Loss: 0.292 Vali Loss: 2.548 Vali Acc: 0.220 Test Loss: 2.548 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.123838186264038
Epoch: 14, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.606 Vali Acc: 0.240 Test Loss: 2.606 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1198830604553223
Epoch: 15, Steps: 4 | Train Loss: 0.240 Vali Loss: 2.851 Vali Acc: 0.260 Test Loss: 2.851 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1596310138702393
Epoch: 16, Steps: 4 | Train Loss: 0.180 Vali Loss: 2.927 Vali Acc: 0.280 Test Loss: 2.927 Test Acc: 0.280
Validation loss decreased (-0.259977 --> -0.279971).  Saving model ...
Epoch: 17 cost time: 1.1247835159301758
Epoch: 17, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.939 Vali Acc: 0.300 Test Loss: 2.939 Test Acc: 0.300
Validation loss decreased (-0.279971 --> -0.299971).  Saving model ...
Epoch: 18 cost time: 1.0528807640075684
Epoch: 18, Steps: 4 | Train Loss: 0.109 Vali Loss: 2.892 Vali Acc: 0.280 Test Loss: 2.892 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0771484375
Epoch: 19, Steps: 4 | Train Loss: 0.077 Vali Loss: 3.046 Vali Acc: 0.260 Test Loss: 3.046 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0833539962768555
Epoch: 20, Steps: 4 | Train Loss: 0.065 Vali Loss: 3.332 Vali Acc: 0.240 Test Loss: 3.332 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0043461322784424
Epoch: 21, Steps: 4 | Train Loss: 0.043 Vali Loss: 3.595 Vali Acc: 0.260 Test Loss: 3.595 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.056640863418579
Epoch: 22, Steps: 4 | Train Loss: 0.039 Vali Loss: 3.728 Vali Acc: 0.280 Test Loss: 3.728 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0749194622039795
Epoch: 23, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.859 Vali Acc: 0.280 Test Loss: 3.859 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1317188739776611
Epoch: 24, Steps: 4 | Train Loss: 0.018 Vali Loss: 3.889 Vali Acc: 0.280 Test Loss: 3.889 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.0944228172302246
Epoch: 25, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.927 Vali Acc: 0.300 Test Loss: 3.927 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1343779563903809
Epoch: 26, Steps: 4 | Train Loss: 0.018 Vali Loss: 4.006 Vali Acc: 0.280 Test Loss: 4.006 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.1846222877502441
Epoch: 27, Steps: 4 | Train Loss: 0.008 Vali Loss: 4.094 Vali Acc: 0.280 Test Loss: 4.094 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1522349
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9715652465820312
Epoch: 1, Steps: 4 | Train Loss: 1.620 Vali Loss: 1.631 Vali Acc: 0.200 Test Loss: 1.631 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.0377600193023682
Epoch: 2, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.611 Vali Acc: 0.180 Test Loss: 1.611 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1013405323028564
Epoch: 3, Steps: 4 | Train Loss: 1.478 Vali Loss: 1.574 Vali Acc: 0.280 Test Loss: 1.574 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.1829192638397217
Epoch: 4, Steps: 4 | Train Loss: 1.381 Vali Loss: 1.576 Vali Acc: 0.260 Test Loss: 1.576 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0928480625152588
Epoch: 5, Steps: 4 | Train Loss: 1.256 Vali Loss: 1.595 Vali Acc: 0.280 Test Loss: 1.595 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1090672016143799
Epoch: 6, Steps: 4 | Train Loss: 1.002 Vali Loss: 1.629 Vali Acc: 0.200 Test Loss: 1.629 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1280517578125
Epoch: 7, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.702 Vali Acc: 0.220 Test Loss: 1.702 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0515496730804443
Epoch: 8, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0575075149536133
Epoch: 9, Steps: 4 | Train Loss: 0.724 Vali Loss: 1.779 Vali Acc: 0.220 Test Loss: 1.779 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0412511825561523
Epoch: 10, Steps: 4 | Train Loss: 0.694 Vali Loss: 1.850 Vali Acc: 0.220 Test Loss: 1.850 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.129920482635498
Epoch: 11, Steps: 4 | Train Loss: 0.629 Vali Loss: 1.910 Vali Acc: 0.300 Test Loss: 1.910 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299981).  Saving model ...
Epoch: 12 cost time: 1.2051546573638916
Epoch: 12, Steps: 4 | Train Loss: 0.544 Vali Loss: 1.936 Vali Acc: 0.220 Test Loss: 1.936 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1557085514068604
Epoch: 13, Steps: 4 | Train Loss: 0.360 Vali Loss: 1.985 Vali Acc: 0.240 Test Loss: 1.985 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.163468360900879
Epoch: 14, Steps: 4 | Train Loss: 0.447 Vali Loss: 1.964 Vali Acc: 0.220 Test Loss: 1.964 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2437145709991455
Epoch: 15, Steps: 4 | Train Loss: 0.301 Vali Loss: 2.115 Vali Acc: 0.300 Test Loss: 2.115 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2543489933013916
Epoch: 16, Steps: 4 | Train Loss: 0.221 Vali Loss: 2.227 Vali Acc: 0.240 Test Loss: 2.227 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.0743029117584229
Epoch: 17, Steps: 4 | Train Loss: 0.181 Vali Loss: 2.287 Vali Acc: 0.280 Test Loss: 2.287 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2082250118255615
Epoch: 18, Steps: 4 | Train Loss: 0.147 Vali Loss: 2.230 Vali Acc: 0.260 Test Loss: 2.230 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2622041702270508
Epoch: 19, Steps: 4 | Train Loss: 0.108 Vali Loss: 2.595 Vali Acc: 0.240 Test Loss: 2.595 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1821198463439941
Epoch: 20, Steps: 4 | Train Loss: 0.101 Vali Loss: 3.005 Vali Acc: 0.260 Test Loss: 3.005 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1752123832702637
Epoch: 21, Steps: 4 | Train Loss: 0.057 Vali Loss: 3.195 Vali Acc: 0.260 Test Loss: 3.195 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1522349
model size : 8.27MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.2173163890838623
Epoch: 1, Steps: 4 | Train Loss: 1.755 Vali Loss: 1.746 Vali Acc: 0.160 Test Loss: 1.746 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.1811676025390625
Epoch: 2, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.677 Vali Acc: 0.140 Test Loss: 1.677 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1070916652679443
Epoch: 3, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.634 Vali Acc: 0.200 Test Loss: 1.634 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.115168571472168
Epoch: 4, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.624 Vali Acc: 0.180 Test Loss: 1.624 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2835826873779297
Epoch: 5, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.664 Vali Acc: 0.180 Test Loss: 1.664 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1765058040618896
Epoch: 6, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.799 Vali Acc: 0.200 Test Loss: 1.799 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.095691442489624
Epoch: 7, Steps: 4 | Train Loss: 0.801 Vali Loss: 1.823 Vali Acc: 0.200 Test Loss: 1.823 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.131500005722046
Epoch: 8, Steps: 4 | Train Loss: 0.642 Vali Loss: 1.883 Vali Acc: 0.240 Test Loss: 1.883 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239981).  Saving model ...
Epoch: 9 cost time: 1.076737642288208
Epoch: 9, Steps: 4 | Train Loss: 0.620 Vali Loss: 1.929 Vali Acc: 0.220 Test Loss: 1.929 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0981721878051758
Epoch: 10, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.090 Vali Acc: 0.240 Test Loss: 2.090 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.19692063331604
Epoch: 11, Steps: 4 | Train Loss: 0.475 Vali Loss: 2.348 Vali Acc: 0.220 Test Loss: 2.348 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.0985167026519775
Epoch: 12, Steps: 4 | Train Loss: 0.323 Vali Loss: 2.511 Vali Acc: 0.240 Test Loss: 2.511 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2457220554351807
Epoch: 13, Steps: 4 | Train Loss: 0.255 Vali Loss: 2.661 Vali Acc: 0.280 Test Loss: 2.661 Test Acc: 0.280
Validation loss decreased (-0.239981 --> -0.279973).  Saving model ...
Epoch: 14 cost time: 1.2294464111328125
Epoch: 14, Steps: 4 | Train Loss: 0.254 Vali Loss: 2.654 Vali Acc: 0.340 Test Loss: 2.654 Test Acc: 0.340
Validation loss decreased (-0.279973 --> -0.339973).  Saving model ...
Epoch: 15 cost time: 1.1715757846832275
Epoch: 15, Steps: 4 | Train Loss: 0.148 Vali Loss: 2.914 Vali Acc: 0.300 Test Loss: 2.914 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.144928216934204
Epoch: 16, Steps: 4 | Train Loss: 0.210 Vali Loss: 2.947 Vali Acc: 0.280 Test Loss: 2.947 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.2121162414550781
Epoch: 17, Steps: 4 | Train Loss: 0.122 Vali Loss: 2.967 Vali Acc: 0.320 Test Loss: 2.967 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3185758590698242
Epoch: 18, Steps: 4 | Train Loss: 0.064 Vali Loss: 3.306 Vali Acc: 0.300 Test Loss: 3.306 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.242133378982544
Epoch: 19, Steps: 4 | Train Loss: 0.087 Vali Loss: 3.493 Vali Acc: 0.280 Test Loss: 3.493 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.1841011047363281
Epoch: 20, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.576 Vali Acc: 0.260 Test Loss: 3.576 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.199341058731079
Epoch: 21, Steps: 4 | Train Loss: 0.024 Vali Loss: 3.754 Vali Acc: 0.260 Test Loss: 3.754 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.1665010452270508
Epoch: 22, Steps: 4 | Train Loss: 0.021 Vali Loss: 4.006 Vali Acc: 0.280 Test Loss: 4.006 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.1737112998962402
Epoch: 23, Steps: 4 | Train Loss: 0.033 Vali Loss: 4.281 Vali Acc: 0.300 Test Loss: 4.281 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.1319262981414795
Epoch: 24, Steps: 4 | Train Loss: 0.013 Vali Loss: 4.371 Vali Acc: 0.300 Test Loss: 4.371 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1489581
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8428170680999756
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.738 Vali Acc: 0.220 Test Loss: 1.738 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.1463053226470947
Epoch: 2, Steps: 4 | Train Loss: 1.519 Vali Loss: 1.660 Vali Acc: 0.160 Test Loss: 1.660 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1459746360778809
Epoch: 3, Steps: 4 | Train Loss: 1.477 Vali Loss: 1.621 Vali Acc: 0.220 Test Loss: 1.621 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.189518928527832
Epoch: 4, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.614 Vali Acc: 0.200 Test Loss: 1.614 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3471159934997559
Epoch: 5, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.654 Vali Acc: 0.220 Test Loss: 1.654 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2100718021392822
Epoch: 6, Steps: 4 | Train Loss: 1.062 Vali Loss: 1.804 Vali Acc: 0.220 Test Loss: 1.804 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3492705821990967
Epoch: 7, Steps: 4 | Train Loss: 0.846 Vali Loss: 1.817 Vali Acc: 0.240 Test Loss: 1.817 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239982).  Saving model ...
Epoch: 8 cost time: 1.1342215538024902
Epoch: 8, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.876 Vali Acc: 0.260 Test Loss: 1.876 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259981).  Saving model ...
Epoch: 9 cost time: 1.3267955780029297
Epoch: 9, Steps: 4 | Train Loss: 0.658 Vali Loss: 1.906 Vali Acc: 0.240 Test Loss: 1.906 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.240772008895874
Epoch: 10, Steps: 4 | Train Loss: 0.444 Vali Loss: 2.046 Vali Acc: 0.280 Test Loss: 2.046 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279980).  Saving model ...
Epoch: 11 cost time: 1.2626466751098633
Epoch: 11, Steps: 4 | Train Loss: 0.514 Vali Loss: 2.254 Vali Acc: 0.220 Test Loss: 2.254 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2761192321777344
Epoch: 12, Steps: 4 | Train Loss: 0.366 Vali Loss: 2.402 Vali Acc: 0.260 Test Loss: 2.402 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3008360862731934
Epoch: 13, Steps: 4 | Train Loss: 0.275 Vali Loss: 2.590 Vali Acc: 0.320 Test Loss: 2.590 Test Acc: 0.320
Validation loss decreased (-0.279980 --> -0.319974).  Saving model ...
Epoch: 14 cost time: 1.4142041206359863
Epoch: 14, Steps: 4 | Train Loss: 0.270 Vali Loss: 2.642 Vali Acc: 0.280 Test Loss: 2.642 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.34507417678833
Epoch: 15, Steps: 4 | Train Loss: 0.166 Vali Loss: 2.892 Vali Acc: 0.300 Test Loss: 2.892 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2414417266845703
Epoch: 16, Steps: 4 | Train Loss: 0.246 Vali Loss: 2.964 Vali Acc: 0.320 Test Loss: 2.964 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.301398515701294
Epoch: 17, Steps: 4 | Train Loss: 0.147 Vali Loss: 2.917 Vali Acc: 0.280 Test Loss: 2.917 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.06858491897583
Epoch: 18, Steps: 4 | Train Loss: 0.079 Vali Loss: 3.206 Vali Acc: 0.300 Test Loss: 3.206 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1552035808563232
Epoch: 19, Steps: 4 | Train Loss: 0.101 Vali Loss: 3.412 Vali Acc: 0.320 Test Loss: 3.412 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1737022399902344
Epoch: 20, Steps: 4 | Train Loss: 0.046 Vali Loss: 3.462 Vali Acc: 0.300 Test Loss: 3.462 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2256765365600586
Epoch: 21, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.696 Vali Acc: 0.280 Test Loss: 3.696 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1815767288208008
Epoch: 22, Steps: 4 | Train Loss: 0.025 Vali Loss: 4.019 Vali Acc: 0.280 Test Loss: 4.019 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.018118143081665
Epoch: 23, Steps: 4 | Train Loss: 0.039 Vali Loss: 4.242 Vali Acc: 0.320 Test Loss: 4.242 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1489581
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.950005531311035
Epoch: 1, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.720 Vali Acc: 0.240 Test Loss: 1.720 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.0337612628936768
Epoch: 2, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.656 Vali Acc: 0.260 Test Loss: 1.656 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.0145237445831299
Epoch: 3, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.636 Vali Acc: 0.240 Test Loss: 1.636 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.197066068649292
Epoch: 4, Steps: 4 | Train Loss: 1.077 Vali Loss: 1.624 Vali Acc: 0.240 Test Loss: 1.624 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0750868320465088
Epoch: 5, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.643 Vali Acc: 0.240 Test Loss: 1.643 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.090041160583496
Epoch: 6, Steps: 4 | Train Loss: 1.091 Vali Loss: 1.751 Vali Acc: 0.220 Test Loss: 1.751 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0458452701568604
Epoch: 7, Steps: 4 | Train Loss: 0.900 Vali Loss: 1.767 Vali Acc: 0.240 Test Loss: 1.767 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0817348957061768
Epoch: 8, Steps: 4 | Train Loss: 0.752 Vali Loss: 1.826 Vali Acc: 0.260 Test Loss: 1.826 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.106628179550171
Epoch: 9, Steps: 4 | Train Loss: 0.688 Vali Loss: 1.848 Vali Acc: 0.240 Test Loss: 1.848 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0425076484680176
Epoch: 10, Steps: 4 | Train Loss: 0.482 Vali Loss: 1.992 Vali Acc: 0.260 Test Loss: 1.992 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0225729942321777
Epoch: 11, Steps: 4 | Train Loss: 0.544 Vali Loss: 2.184 Vali Acc: 0.200 Test Loss: 2.184 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 0.9905362129211426
Epoch: 12, Steps: 4 | Train Loss: 0.421 Vali Loss: 2.306 Vali Acc: 0.240 Test Loss: 2.306 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1489581
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.069861888885498
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.727 Vali Acc: 0.160 Test Loss: 1.727 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 0.9772884845733643
Epoch: 2, Steps: 4 | Train Loss: 1.580 Vali Loss: 1.669 Vali Acc: 0.240 Test Loss: 1.669 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 0.9791009426116943
Epoch: 3, Steps: 4 | Train Loss: 1.512 Vali Loss: 1.656 Vali Acc: 0.280 Test Loss: 1.656 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 0.9677715301513672
Epoch: 4, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.628 Vali Acc: 0.260 Test Loss: 1.628 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9286594390869141
Epoch: 5, Steps: 4 | Train Loss: 1.234 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0840520858764648
Epoch: 6, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.687 Vali Acc: 0.240 Test Loss: 1.687 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0506362915039062
Epoch: 7, Steps: 4 | Train Loss: 0.987 Vali Loss: 1.708 Vali Acc: 0.240 Test Loss: 1.708 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0912697315216064
Epoch: 8, Steps: 4 | Train Loss: 0.865 Vali Loss: 1.768 Vali Acc: 0.240 Test Loss: 1.768 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1555149555206299
Epoch: 9, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.778 Vali Acc: 0.260 Test Loss: 1.778 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0467004776000977
Epoch: 10, Steps: 4 | Train Loss: 0.573 Vali Loss: 1.878 Vali Acc: 0.280 Test Loss: 1.878 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.047313928604126
Epoch: 11, Steps: 4 | Train Loss: 0.632 Vali Loss: 1.960 Vali Acc: 0.300 Test Loss: 1.960 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299980).  Saving model ...
Epoch: 12 cost time: 1.0214214324951172
Epoch: 12, Steps: 4 | Train Loss: 0.500 Vali Loss: 1.946 Vali Acc: 0.300 Test Loss: 1.946 Test Acc: 0.300
Validation loss decreased (-0.299980 --> -0.299981).  Saving model ...
Epoch: 13 cost time: 1.0407917499542236
Epoch: 13, Steps: 4 | Train Loss: 0.399 Vali Loss: 1.983 Vali Acc: 0.380 Test Loss: 1.983 Test Acc: 0.380
Validation loss decreased (-0.299981 --> -0.379980).  Saving model ...
Epoch: 14 cost time: 0.9984889030456543
Epoch: 14, Steps: 4 | Train Loss: 0.355 Vali Loss: 1.906 Vali Acc: 0.300 Test Loss: 1.906 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0350561141967773
Epoch: 15, Steps: 4 | Train Loss: 0.232 Vali Loss: 2.111 Vali Acc: 0.300 Test Loss: 2.111 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1597461700439453
Epoch: 16, Steps: 4 | Train Loss: 0.392 Vali Loss: 2.169 Vali Acc: 0.260 Test Loss: 2.169 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2325222492218018
Epoch: 17, Steps: 4 | Train Loss: 0.199 Vali Loss: 2.103 Vali Acc: 0.320 Test Loss: 2.103 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2293035984039307
Epoch: 18, Steps: 4 | Train Loss: 0.111 Vali Loss: 2.326 Vali Acc: 0.300 Test Loss: 2.326 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1689693927764893
Epoch: 19, Steps: 4 | Train Loss: 0.238 Vali Loss: 2.375 Vali Acc: 0.280 Test Loss: 2.375 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2187728881835938
Epoch: 20, Steps: 4 | Train Loss: 0.091 Vali Loss: 2.414 Vali Acc: 0.280 Test Loss: 2.414 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.9983315467834473
Epoch: 21, Steps: 4 | Train Loss: 0.051 Vali Loss: 2.600 Vali Acc: 0.300 Test Loss: 2.600 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1837272644042969
Epoch: 22, Steps: 4 | Train Loss: 0.040 Vali Loss: 2.798 Vali Acc: 0.320 Test Loss: 2.798 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.048518180847168
Epoch: 23, Steps: 4 | Train Loss: 0.055 Vali Loss: 2.974 Vali Acc: 0.340 Test Loss: 2.974 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1489581
model size : 8.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3582818508148193
Epoch: 1, Steps: 4 | Train Loss: 1.696 Vali Loss: 1.597 Vali Acc: 0.240 Test Loss: 1.597 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.2880055904388428
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.579 Vali Acc: 0.240 Test Loss: 1.579 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.3213903903961182
Epoch: 3, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.604 Vali Acc: 0.200 Test Loss: 1.604 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1837501525878906
Epoch: 4, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.628 Vali Acc: 0.200 Test Loss: 1.628 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2351160049438477
Epoch: 5, Steps: 4 | Train Loss: 1.272 Vali Loss: 1.683 Vali Acc: 0.200 Test Loss: 1.683 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2327847480773926
Epoch: 6, Steps: 4 | Train Loss: 1.025 Vali Loss: 1.728 Vali Acc: 0.220 Test Loss: 1.728 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.342573642730713
Epoch: 7, Steps: 4 | Train Loss: 0.991 Vali Loss: 1.750 Vali Acc: 0.240 Test Loss: 1.750 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1516404151916504
Epoch: 8, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.874 Vali Acc: 0.240 Test Loss: 1.874 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3198919296264648
Epoch: 9, Steps: 4 | Train Loss: 0.756 Vali Loss: 2.014 Vali Acc: 0.280 Test Loss: 2.014 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279980).  Saving model ...
Epoch: 10 cost time: 1.2157561779022217
Epoch: 10, Steps: 4 | Train Loss: 0.736 Vali Loss: 2.130 Vali Acc: 0.240 Test Loss: 2.130 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3288772106170654
Epoch: 11, Steps: 4 | Train Loss: 0.697 Vali Loss: 2.302 Vali Acc: 0.280 Test Loss: 2.302 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2969653606414795
Epoch: 12, Steps: 4 | Train Loss: 0.529 Vali Loss: 2.404 Vali Acc: 0.280 Test Loss: 2.404 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1589775085449219
Epoch: 13, Steps: 4 | Train Loss: 0.397 Vali Loss: 2.531 Vali Acc: 0.280 Test Loss: 2.531 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.1259963512420654
Epoch: 14, Steps: 4 | Train Loss: 0.428 Vali Loss: 2.656 Vali Acc: 0.260 Test Loss: 2.656 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0504560470581055
Epoch: 15, Steps: 4 | Train Loss: 0.320 Vali Loss: 2.749 Vali Acc: 0.240 Test Loss: 2.749 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.0365076065063477
Epoch: 16, Steps: 4 | Train Loss: 0.353 Vali Loss: 2.867 Vali Acc: 0.220 Test Loss: 2.867 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1946702003479004
Epoch: 17, Steps: 4 | Train Loss: 0.265 Vali Loss: 2.958 Vali Acc: 0.220 Test Loss: 2.958 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.0922343730926514
Epoch: 18, Steps: 4 | Train Loss: 0.258 Vali Loss: 2.990 Vali Acc: 0.260 Test Loss: 2.990 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.0631787776947021
Epoch: 19, Steps: 4 | Train Loss: 0.163 Vali Loss: 3.051 Vali Acc: 0.260 Test Loss: 3.051 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1241709
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.066138505935669
Epoch: 1, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.614 Vali Acc: 0.340 Test Loss: 1.614 Test Acc: 0.340
Validation loss decreased (inf --> -0.339984).  Saving model ...
Epoch: 2 cost time: 1.0986714363098145
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.600 Vali Acc: 0.240 Test Loss: 1.600 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.021172285079956
Epoch: 3, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.600 Vali Acc: 0.200 Test Loss: 1.600 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1137466430664062
Epoch: 4, Steps: 4 | Train Loss: 1.399 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1369102001190186
Epoch: 5, Steps: 4 | Train Loss: 1.292 Vali Loss: 1.668 Vali Acc: 0.260 Test Loss: 1.668 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0502994060516357
Epoch: 6, Steps: 4 | Train Loss: 1.070 Vali Loss: 1.710 Vali Acc: 0.240 Test Loss: 1.710 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 0.9822425842285156
Epoch: 7, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.754 Vali Acc: 0.260 Test Loss: 1.754 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1269583702087402
Epoch: 8, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.833 Vali Acc: 0.240 Test Loss: 1.833 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1440086364746094
Epoch: 9, Steps: 4 | Train Loss: 0.793 Vali Loss: 1.946 Vali Acc: 0.240 Test Loss: 1.946 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1810181140899658
Epoch: 10, Steps: 4 | Train Loss: 0.767 Vali Loss: 2.059 Vali Acc: 0.240 Test Loss: 2.059 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.13279128074646
Epoch: 11, Steps: 4 | Train Loss: 0.733 Vali Loss: 2.172 Vali Acc: 0.300 Test Loss: 2.172 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1241709
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6052932739257812
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.1891257762908936
Epoch: 2, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.615 Vali Acc: 0.240 Test Loss: 1.615 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.065007209777832
Epoch: 3, Steps: 4 | Train Loss: 1.511 Vali Loss: 1.612 Vali Acc: 0.200 Test Loss: 1.612 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1038870811462402
Epoch: 4, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.622 Vali Acc: 0.220 Test Loss: 1.622 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1527528762817383
Epoch: 5, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.640 Vali Acc: 0.260 Test Loss: 1.640 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2492845058441162
Epoch: 6, Steps: 4 | Train Loss: 1.100 Vali Loss: 1.671 Vali Acc: 0.260 Test Loss: 1.671 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2395143508911133
Epoch: 7, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.686 Vali Acc: 0.260 Test Loss: 1.686 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.115966796875
Epoch: 8, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.771 Vali Acc: 0.240 Test Loss: 1.771 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.254112720489502
Epoch: 9, Steps: 4 | Train Loss: 0.854 Vali Loss: 1.878 Vali Acc: 0.220 Test Loss: 1.878 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1594727039337158
Epoch: 10, Steps: 4 | Train Loss: 0.809 Vali Loss: 1.972 Vali Acc: 0.220 Test Loss: 1.972 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0669059753417969
Epoch: 11, Steps: 4 | Train Loss: 0.763 Vali Loss: 2.090 Vali Acc: 0.280 Test Loss: 2.090 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279979).  Saving model ...
Epoch: 12 cost time: 1.0716445446014404
Epoch: 12, Steps: 4 | Train Loss: 0.613 Vali Loss: 2.193 Vali Acc: 0.240 Test Loss: 2.193 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.198815107345581
Epoch: 13, Steps: 4 | Train Loss: 0.469 Vali Loss: 2.284 Vali Acc: 0.240 Test Loss: 2.284 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2455806732177734
Epoch: 14, Steps: 4 | Train Loss: 0.484 Vali Loss: 2.413 Vali Acc: 0.240 Test Loss: 2.413 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1316423416137695
Epoch: 15, Steps: 4 | Train Loss: 0.366 Vali Loss: 2.511 Vali Acc: 0.240 Test Loss: 2.511 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.158376693725586
Epoch: 16, Steps: 4 | Train Loss: 0.392 Vali Loss: 2.637 Vali Acc: 0.240 Test Loss: 2.637 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1390306949615479
Epoch: 17, Steps: 4 | Train Loss: 0.304 Vali Loss: 2.785 Vali Acc: 0.220 Test Loss: 2.785 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.123694658279419
Epoch: 18, Steps: 4 | Train Loss: 0.298 Vali Loss: 2.854 Vali Acc: 0.220 Test Loss: 2.854 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1780450344085693
Epoch: 19, Steps: 4 | Train Loss: 0.187 Vali Loss: 2.925 Vali Acc: 0.280 Test Loss: 2.925 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9924912452697754
Epoch: 20, Steps: 4 | Train Loss: 0.151 Vali Loss: 3.045 Vali Acc: 0.280 Test Loss: 3.045 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.0090789794921875
Epoch: 21, Steps: 4 | Train Loss: 0.173 Vali Loss: 3.123 Vali Acc: 0.280 Test Loss: 3.123 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1241709
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.029003143310547
Epoch: 1, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.594 Vali Acc: 0.220 Test Loss: 1.594 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0738043785095215
Epoch: 2, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.1798958778381348
Epoch: 3, Steps: 4 | Train Loss: 1.522 Vali Loss: 1.590 Vali Acc: 0.260 Test Loss: 1.590 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.0749733448028564
Epoch: 4, Steps: 4 | Train Loss: 1.461 Vali Loss: 1.609 Vali Acc: 0.260 Test Loss: 1.609 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0525641441345215
Epoch: 5, Steps: 4 | Train Loss: 1.388 Vali Loss: 1.628 Vali Acc: 0.300 Test Loss: 1.628 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.0609636306762695
Epoch: 6, Steps: 4 | Train Loss: 1.173 Vali Loss: 1.631 Vali Acc: 0.280 Test Loss: 1.631 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0462486743927002
Epoch: 7, Steps: 4 | Train Loss: 1.130 Vali Loss: 1.595 Vali Acc: 0.260 Test Loss: 1.595 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.01171875
Epoch: 8, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.628 Vali Acc: 0.260 Test Loss: 1.628 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0782136917114258
Epoch: 9, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.688 Vali Acc: 0.240 Test Loss: 1.688 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0731701850891113
Epoch: 10, Steps: 4 | Train Loss: 0.934 Vali Loss: 1.751 Vali Acc: 0.260 Test Loss: 1.751 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.00539231300354
Epoch: 11, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.839 Vali Acc: 0.280 Test Loss: 1.839 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.04447603225708
Epoch: 12, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.894 Vali Acc: 0.280 Test Loss: 1.894 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9437000751495361
Epoch: 13, Steps: 4 | Train Loss: 0.550 Vali Loss: 1.934 Vali Acc: 0.260 Test Loss: 1.934 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1003878116607666
Epoch: 14, Steps: 4 | Train Loss: 0.557 Vali Loss: 2.018 Vali Acc: 0.260 Test Loss: 2.018 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9507713317871094
Epoch: 15, Steps: 4 | Train Loss: 0.447 Vali Loss: 2.051 Vali Acc: 0.260 Test Loss: 2.051 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1241709
model size : 5.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8661508560180664
Epoch: 1, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.645 Vali Acc: 0.160 Test Loss: 1.645 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 0.9609806537628174
Epoch: 2, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.635 Vali Acc: 0.180 Test Loss: 1.635 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 0.9167447090148926
Epoch: 3, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.648 Vali Acc: 0.140 Test Loss: 1.648 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0223546028137207
Epoch: 4, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.670 Vali Acc: 0.160 Test Loss: 1.670 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0173423290252686
Epoch: 5, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.695 Vali Acc: 0.140 Test Loss: 1.695 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0896127223968506
Epoch: 6, Steps: 4 | Train Loss: 1.213 Vali Loss: 1.741 Vali Acc: 0.180 Test Loss: 1.741 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0898122787475586
Epoch: 7, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.815 Vali Acc: 0.180 Test Loss: 1.815 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 0.9974935054779053
Epoch: 8, Steps: 4 | Train Loss: 0.910 Vali Loss: 1.924 Vali Acc: 0.180 Test Loss: 1.924 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0384325981140137
Epoch: 9, Steps: 4 | Train Loss: 0.819 Vali Loss: 1.976 Vali Acc: 0.180 Test Loss: 1.976 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.0342516899108887
Epoch: 10, Steps: 4 | Train Loss: 0.586 Vali Loss: 2.065 Vali Acc: 0.180 Test Loss: 2.065 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 0.9194231033325195
Epoch: 11, Steps: 4 | Train Loss: 0.591 Vali Loss: 2.123 Vali Acc: 0.220 Test Loss: 2.123 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219979).  Saving model ...
Epoch: 12 cost time: 0.9327492713928223
Epoch: 12, Steps: 4 | Train Loss: 0.438 Vali Loss: 2.207 Vali Acc: 0.200 Test Loss: 2.207 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1681489944458008
Epoch: 13, Steps: 4 | Train Loss: 0.385 Vali Loss: 2.388 Vali Acc: 0.200 Test Loss: 2.388 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.9591033458709717
Epoch: 14, Steps: 4 | Train Loss: 0.492 Vali Loss: 2.565 Vali Acc: 0.200 Test Loss: 2.565 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9916648864746094
Epoch: 15, Steps: 4 | Train Loss: 0.407 Vali Loss: 2.746 Vali Acc: 0.200 Test Loss: 2.746 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9941318035125732
Epoch: 16, Steps: 4 | Train Loss: 0.330 Vali Loss: 2.920 Vali Acc: 0.220 Test Loss: 2.920 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.047137975692749
Epoch: 17, Steps: 4 | Train Loss: 0.236 Vali Loss: 3.018 Vali Acc: 0.240 Test Loss: 3.018 Test Acc: 0.240
Validation loss decreased (-0.219979 --> -0.239970).  Saving model ...
Epoch: 18 cost time: 1.2395801544189453
Epoch: 18, Steps: 4 | Train Loss: 0.204 Vali Loss: 3.179 Vali Acc: 0.220 Test Loss: 3.179 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.1279206275939941
Epoch: 19, Steps: 4 | Train Loss: 0.180 Vali Loss: 3.267 Vali Acc: 0.220 Test Loss: 3.267 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.959463357925415
Epoch: 20, Steps: 4 | Train Loss: 0.148 Vali Loss: 3.322 Vali Acc: 0.220 Test Loss: 3.322 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.0258636474609375
Epoch: 21, Steps: 4 | Train Loss: 0.104 Vali Loss: 3.394 Vali Acc: 0.220 Test Loss: 3.394 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.0690157413482666
Epoch: 22, Steps: 4 | Train Loss: 0.091 Vali Loss: 3.486 Vali Acc: 0.220 Test Loss: 3.486 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1056933403015137
Epoch: 23, Steps: 4 | Train Loss: 0.088 Vali Loss: 3.558 Vali Acc: 0.180 Test Loss: 3.558 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.3529353141784668
Epoch: 24, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.710 Vali Acc: 0.200 Test Loss: 3.710 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.351409673690796
Epoch: 25, Steps: 4 | Train Loss: 0.056 Vali Loss: 3.860 Vali Acc: 0.220 Test Loss: 3.860 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.252744197845459
Epoch: 26, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.964 Vali Acc: 0.180 Test Loss: 3.964 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.4102520942687988
Epoch: 27, Steps: 4 | Train Loss: 0.031 Vali Loss: 4.040 Vali Acc: 0.180 Test Loss: 4.040 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 979565
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.873194932937622
Epoch: 1, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.650 Vali Acc: 0.160 Test Loss: 1.650 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.0618693828582764
Epoch: 2, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.004514455795288
Epoch: 3, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.647 Vali Acc: 0.220 Test Loss: 1.647 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.0102765560150146
Epoch: 4, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.664 Vali Acc: 0.240 Test Loss: 1.664 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 1.1367087364196777
Epoch: 5, Steps: 4 | Train Loss: 1.174 Vali Loss: 1.699 Vali Acc: 0.200 Test Loss: 1.699 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1287672519683838
Epoch: 6, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.756 Vali Acc: 0.180 Test Loss: 1.756 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1462657451629639
Epoch: 7, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.797 Vali Acc: 0.180 Test Loss: 1.797 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.080209732055664
Epoch: 8, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.899 Vali Acc: 0.180 Test Loss: 1.899 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0027318000793457
Epoch: 9, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.959 Vali Acc: 0.200 Test Loss: 1.959 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.034585952758789
Epoch: 10, Steps: 4 | Train Loss: 0.605 Vali Loss: 2.048 Vali Acc: 0.200 Test Loss: 2.048 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.0937230587005615
Epoch: 11, Steps: 4 | Train Loss: 0.613 Vali Loss: 2.113 Vali Acc: 0.180 Test Loss: 2.113 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.008565902709961
Epoch: 12, Steps: 4 | Train Loss: 0.458 Vali Loss: 2.182 Vali Acc: 0.200 Test Loss: 2.182 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0255141258239746
Epoch: 13, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.373 Vali Acc: 0.200 Test Loss: 2.373 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0206921100616455
Epoch: 14, Steps: 4 | Train Loss: 0.533 Vali Loss: 2.533 Vali Acc: 0.200 Test Loss: 2.533 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 979565
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.256502151489258
Epoch: 1, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.654 Vali Acc: 0.140 Test Loss: 1.654 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.1208512783050537
Epoch: 2, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.646 Vali Acc: 0.200 Test Loss: 1.646 Test Acc: 0.200
Validation loss decreased (-0.139983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.11745285987854
Epoch: 3, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.654 Vali Acc: 0.240 Test Loss: 1.654 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.111262321472168
Epoch: 4, Steps: 4 | Train Loss: 1.336 Vali Loss: 1.677 Vali Acc: 0.240 Test Loss: 1.677 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.161012887954712
Epoch: 5, Steps: 4 | Train Loss: 1.229 Vali Loss: 1.715 Vali Acc: 0.200 Test Loss: 1.715 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1685481071472168
Epoch: 6, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.765 Vali Acc: 0.200 Test Loss: 1.765 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1749053001403809
Epoch: 7, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.821 Vali Acc: 0.180 Test Loss: 1.821 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1083042621612549
Epoch: 8, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.924 Vali Acc: 0.180 Test Loss: 1.924 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1097793579101562
Epoch: 9, Steps: 4 | Train Loss: 0.915 Vali Loss: 1.990 Vali Acc: 0.200 Test Loss: 1.990 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1586506366729736
Epoch: 10, Steps: 4 | Train Loss: 0.653 Vali Loss: 2.077 Vali Acc: 0.180 Test Loss: 2.077 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2137565612792969
Epoch: 11, Steps: 4 | Train Loss: 0.661 Vali Loss: 2.145 Vali Acc: 0.200 Test Loss: 2.145 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1048190593719482
Epoch: 12, Steps: 4 | Train Loss: 0.493 Vali Loss: 2.202 Vali Acc: 0.220 Test Loss: 2.202 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0877890586853027
Epoch: 13, Steps: 4 | Train Loss: 0.443 Vali Loss: 2.361 Vali Acc: 0.220 Test Loss: 2.361 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 979565
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.985339879989624
Epoch: 1, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.1310064792633057
Epoch: 2, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.652 Vali Acc: 0.160 Test Loss: 1.652 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1395580768585205
Epoch: 3, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.649 Vali Acc: 0.280 Test Loss: 1.649 Test Acc: 0.280
Validation loss decreased (-0.179983 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.2159135341644287
Epoch: 4, Steps: 4 | Train Loss: 1.378 Vali Loss: 1.672 Vali Acc: 0.280 Test Loss: 1.672 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0948047637939453
Epoch: 5, Steps: 4 | Train Loss: 1.279 Vali Loss: 1.704 Vali Acc: 0.240 Test Loss: 1.704 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1350195407867432
Epoch: 6, Steps: 4 | Train Loss: 1.265 Vali Loss: 1.716 Vali Acc: 0.200 Test Loss: 1.716 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1932265758514404
Epoch: 7, Steps: 4 | Train Loss: 1.113 Vali Loss: 1.752 Vali Acc: 0.220 Test Loss: 1.752 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0898056030273438
Epoch: 8, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.816 Vali Acc: 0.200 Test Loss: 1.816 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1227085590362549
Epoch: 9, Steps: 4 | Train Loss: 0.982 Vali Loss: 1.834 Vali Acc: 0.220 Test Loss: 1.834 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.0861611366271973
Epoch: 10, Steps: 4 | Train Loss: 0.734 Vali Loss: 1.874 Vali Acc: 0.200 Test Loss: 1.874 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0095279216766357
Epoch: 11, Steps: 4 | Train Loss: 0.758 Vali Loss: 1.913 Vali Acc: 0.200 Test Loss: 1.913 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 0.9767143726348877
Epoch: 12, Steps: 4 | Train Loss: 0.587 Vali Loss: 1.925 Vali Acc: 0.200 Test Loss: 1.925 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.198988676071167
Epoch: 13, Steps: 4 | Train Loss: 0.508 Vali Loss: 1.968 Vali Acc: 0.200 Test Loss: 1.968 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 979565
model size : 4.98MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0903067588806152
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.616 Vali Acc: 0.300 Test Loss: 1.616 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.1346004009246826
Epoch: 2, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.605 Vali Acc: 0.260 Test Loss: 1.605 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2087788581848145
Epoch: 3, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.579 Vali Acc: 0.300 Test Loss: 1.579 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.0848450660705566
Epoch: 4, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.532 Vali Acc: 0.360 Test Loss: 1.532 Test Acc: 0.360
Validation loss decreased (-0.299984 --> -0.359985).  Saving model ...
Epoch: 5 cost time: 1.1755123138427734
Epoch: 5, Steps: 4 | Train Loss: 1.360 Vali Loss: 1.555 Vali Acc: 0.300 Test Loss: 1.555 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1808512210845947
Epoch: 6, Steps: 4 | Train Loss: 1.210 Vali Loss: 1.637 Vali Acc: 0.280 Test Loss: 1.637 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.174992322921753
Epoch: 7, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.732 Vali Acc: 0.280 Test Loss: 1.732 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1455919742584229
Epoch: 8, Steps: 4 | Train Loss: 0.916 Vali Loss: 1.774 Vali Acc: 0.280 Test Loss: 1.774 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2488067150115967
Epoch: 9, Steps: 4 | Train Loss: 0.869 Vali Loss: 1.848 Vali Acc: 0.320 Test Loss: 1.848 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.154465913772583
Epoch: 10, Steps: 4 | Train Loss: 0.764 Vali Loss: 1.922 Vali Acc: 0.280 Test Loss: 1.922 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2184112071990967
Epoch: 11, Steps: 4 | Train Loss: 0.545 Vali Loss: 1.975 Vali Acc: 0.280 Test Loss: 1.975 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1396377086639404
Epoch: 12, Steps: 4 | Train Loss: 0.604 Vali Loss: 2.127 Vali Acc: 0.280 Test Loss: 2.127 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.196608066558838
Epoch: 13, Steps: 4 | Train Loss: 0.500 Vali Loss: 2.264 Vali Acc: 0.280 Test Loss: 2.264 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0413949489593506
Epoch: 14, Steps: 4 | Train Loss: 0.392 Vali Loss: 2.454 Vali Acc: 0.280 Test Loss: 2.454 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 848493
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9206786155700684
Epoch: 1, Steps: 4 | Train Loss: 1.647 Vali Loss: 1.651 Vali Acc: 0.260 Test Loss: 1.651 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.085810661315918
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.0150470733642578
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.596 Vali Acc: 0.300 Test Loss: 1.596 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.196556568145752
Epoch: 4, Steps: 4 | Train Loss: 1.422 Vali Loss: 1.569 Vali Acc: 0.320 Test Loss: 1.569 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319984).  Saving model ...
Epoch: 5 cost time: 1.198716640472412
Epoch: 5, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.568 Vali Acc: 0.240 Test Loss: 1.568 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1475574970245361
Epoch: 6, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.624 Vali Acc: 0.220 Test Loss: 1.624 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.009023666381836
Epoch: 7, Steps: 4 | Train Loss: 0.956 Vali Loss: 1.737 Vali Acc: 0.300 Test Loss: 1.737 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0801188945770264
Epoch: 8, Steps: 4 | Train Loss: 0.968 Vali Loss: 1.769 Vali Acc: 0.280 Test Loss: 1.769 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0889456272125244
Epoch: 9, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.828 Vali Acc: 0.300 Test Loss: 1.828 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2356946468353271
Epoch: 10, Steps: 4 | Train Loss: 0.774 Vali Loss: 1.885 Vali Acc: 0.280 Test Loss: 1.885 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1217296123504639
Epoch: 11, Steps: 4 | Train Loss: 0.576 Vali Loss: 2.018 Vali Acc: 0.260 Test Loss: 2.018 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1373059749603271
Epoch: 12, Steps: 4 | Train Loss: 0.620 Vali Loss: 2.111 Vali Acc: 0.280 Test Loss: 2.111 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2642083168029785
Epoch: 13, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.254 Vali Acc: 0.280 Test Loss: 2.254 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2448041439056396
Epoch: 14, Steps: 4 | Train Loss: 0.425 Vali Loss: 2.433 Vali Acc: 0.260 Test Loss: 2.433 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 848493
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.108405828475952
Epoch: 1, Steps: 4 | Train Loss: 1.655 Vali Loss: 1.617 Vali Acc: 0.220 Test Loss: 1.617 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0443463325500488
Epoch: 2, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.611 Vali Acc: 0.280 Test Loss: 1.611 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.2407500743865967
Epoch: 3, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.582 Vali Acc: 0.340 Test Loss: 1.582 Test Acc: 0.340
Validation loss decreased (-0.279984 --> -0.339984).  Saving model ...
Epoch: 4 cost time: 1.344196081161499
Epoch: 4, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.569 Vali Acc: 0.300 Test Loss: 1.569 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2611606121063232
Epoch: 5, Steps: 4 | Train Loss: 1.414 Vali Loss: 1.560 Vali Acc: 0.260 Test Loss: 1.560 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2251641750335693
Epoch: 6, Steps: 4 | Train Loss: 1.250 Vali Loss: 1.618 Vali Acc: 0.220 Test Loss: 1.618 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1766340732574463
Epoch: 7, Steps: 4 | Train Loss: 0.965 Vali Loss: 1.708 Vali Acc: 0.300 Test Loss: 1.708 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.289719820022583
Epoch: 8, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.765 Vali Acc: 0.280 Test Loss: 1.765 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2655065059661865
Epoch: 9, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.819 Vali Acc: 0.240 Test Loss: 1.819 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1710901260375977
Epoch: 10, Steps: 4 | Train Loss: 0.811 Vali Loss: 1.893 Vali Acc: 0.220 Test Loss: 1.893 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2741401195526123
Epoch: 11, Steps: 4 | Train Loss: 0.613 Vali Loss: 1.963 Vali Acc: 0.240 Test Loss: 1.963 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.1998865604400635
Epoch: 12, Steps: 4 | Train Loss: 0.663 Vali Loss: 2.059 Vali Acc: 0.280 Test Loss: 2.059 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.20170259475708
Epoch: 13, Steps: 4 | Train Loss: 0.561 Vali Loss: 2.182 Vali Acc: 0.280 Test Loss: 2.182 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 848493
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9159154891967773
Epoch: 1, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.696 Vali Acc: 0.260 Test Loss: 1.696 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.0570297241210938
Epoch: 2, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.684 Vali Acc: 0.260 Test Loss: 1.684 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.1047663688659668
Epoch: 3, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.667 Vali Acc: 0.260 Test Loss: 1.667 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.0726933479309082
Epoch: 4, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.656 Vali Acc: 0.200 Test Loss: 1.656 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1958768367767334
Epoch: 5, Steps: 4 | Train Loss: 1.445 Vali Loss: 1.642 Vali Acc: 0.200 Test Loss: 1.642 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1616132259368896
Epoch: 6, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.659 Vali Acc: 0.200 Test Loss: 1.659 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1071138381958008
Epoch: 7, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.715 Vali Acc: 0.240 Test Loss: 1.715 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.034677505493164
Epoch: 8, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.764 Vali Acc: 0.280 Test Loss: 1.764 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 9 cost time: 1.0160574913024902
Epoch: 9, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.800 Vali Acc: 0.240 Test Loss: 1.800 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1097850799560547
Epoch: 10, Steps: 4 | Train Loss: 0.880 Vali Loss: 1.840 Vali Acc: 0.220 Test Loss: 1.840 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0397613048553467
Epoch: 11, Steps: 4 | Train Loss: 0.711 Vali Loss: 1.882 Vali Acc: 0.220 Test Loss: 1.882 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1145684719085693
Epoch: 12, Steps: 4 | Train Loss: 0.738 Vali Loss: 1.951 Vali Acc: 0.200 Test Loss: 1.951 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1311910152435303
Epoch: 13, Steps: 4 | Train Loss: 0.646 Vali Loss: 1.984 Vali Acc: 0.260 Test Loss: 1.984 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.0668244361877441
Epoch: 14, Steps: 4 | Train Loss: 0.536 Vali Loss: 2.041 Vali Acc: 0.240 Test Loss: 2.041 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2107136249542236
Epoch: 15, Steps: 4 | Train Loss: 0.577 Vali Loss: 2.121 Vali Acc: 0.260 Test Loss: 2.121 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.1520490646362305
Epoch: 16, Steps: 4 | Train Loss: 0.472 Vali Loss: 2.127 Vali Acc: 0.240 Test Loss: 2.127 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0899043083190918
Epoch: 17, Steps: 4 | Train Loss: 0.321 Vali Loss: 2.253 Vali Acc: 0.260 Test Loss: 2.253 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.9878170490264893
Epoch: 18, Steps: 4 | Train Loss: 0.311 Vali Loss: 2.330 Vali Acc: 0.280 Test Loss: 2.330 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 848493
model size : 4.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.816380023956299
Epoch: 1, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.637 Vali Acc: 0.200 Test Loss: 1.637 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 0.9076955318450928
Epoch: 2, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.630 Vali Acc: 0.240 Test Loss: 1.630 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.0130128860473633
Epoch: 3, Steps: 4 | Train Loss: 1.505 Vali Loss: 1.647 Vali Acc: 0.240 Test Loss: 1.647 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.8916215896606445
Epoch: 4, Steps: 4 | Train Loss: 1.391 Vali Loss: 1.708 Vali Acc: 0.200 Test Loss: 1.708 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9370768070220947
Epoch: 5, Steps: 4 | Train Loss: 1.192 Vali Loss: 1.785 Vali Acc: 0.180 Test Loss: 1.785 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9139523506164551
Epoch: 6, Steps: 4 | Train Loss: 1.220 Vali Loss: 1.838 Vali Acc: 0.260 Test Loss: 1.838 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 7 cost time: 1.0475409030914307
Epoch: 7, Steps: 4 | Train Loss: 1.033 Vali Loss: 1.877 Vali Acc: 0.220 Test Loss: 1.877 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.055915355682373
Epoch: 8, Steps: 4 | Train Loss: 0.741 Vali Loss: 1.925 Vali Acc: 0.180 Test Loss: 1.925 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.045804738998413
Epoch: 9, Steps: 4 | Train Loss: 0.803 Vali Loss: 2.028 Vali Acc: 0.220 Test Loss: 2.028 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0096900463104248
Epoch: 10, Steps: 4 | Train Loss: 0.763 Vali Loss: 2.148 Vali Acc: 0.220 Test Loss: 2.148 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1324248313903809
Epoch: 11, Steps: 4 | Train Loss: 0.535 Vali Loss: 2.345 Vali Acc: 0.220 Test Loss: 2.345 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1460180282592773
Epoch: 12, Steps: 4 | Train Loss: 0.451 Vali Loss: 2.531 Vali Acc: 0.200 Test Loss: 2.531 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 0.9983830451965332
Epoch: 13, Steps: 4 | Train Loss: 0.469 Vali Loss: 2.753 Vali Acc: 0.260 Test Loss: 2.753 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.057800531387329
Epoch: 14, Steps: 4 | Train Loss: 0.442 Vali Loss: 2.908 Vali Acc: 0.200 Test Loss: 2.908 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 0.9244856834411621
Epoch: 15, Steps: 4 | Train Loss: 0.331 Vali Loss: 3.125 Vali Acc: 0.220 Test Loss: 3.125 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.0121614933013916
Epoch: 16, Steps: 4 | Train Loss: 0.287 Vali Loss: 3.343 Vali Acc: 0.240 Test Loss: 3.343 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 782957
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8402562141418457
Epoch: 1, Steps: 4 | Train Loss: 1.575 Vali Loss: 1.671 Vali Acc: 0.160 Test Loss: 1.671 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.0987036228179932
Epoch: 2, Steps: 4 | Train Loss: 1.519 Vali Loss: 1.669 Vali Acc: 0.260 Test Loss: 1.669 Test Acc: 0.260
Validation loss decreased (-0.159983 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.0853440761566162
Epoch: 3, Steps: 4 | Train Loss: 1.510 Vali Loss: 1.696 Vali Acc: 0.180 Test Loss: 1.696 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1100077629089355
Epoch: 4, Steps: 4 | Train Loss: 1.372 Vali Loss: 1.742 Vali Acc: 0.200 Test Loss: 1.742 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1650593280792236
Epoch: 5, Steps: 4 | Train Loss: 1.191 Vali Loss: 1.815 Vali Acc: 0.200 Test Loss: 1.815 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2033307552337646
Epoch: 6, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.875 Vali Acc: 0.280 Test Loss: 1.875 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.1277801990509033
Epoch: 7, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.895 Vali Acc: 0.220 Test Loss: 1.895 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0891849994659424
Epoch: 8, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.957 Vali Acc: 0.180 Test Loss: 1.957 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1623449325561523
Epoch: 9, Steps: 4 | Train Loss: 0.829 Vali Loss: 2.054 Vali Acc: 0.240 Test Loss: 2.054 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1092453002929688
Epoch: 10, Steps: 4 | Train Loss: 0.789 Vali Loss: 2.173 Vali Acc: 0.200 Test Loss: 2.173 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1263923645019531
Epoch: 11, Steps: 4 | Train Loss: 0.558 Vali Loss: 2.320 Vali Acc: 0.240 Test Loss: 2.320 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1126317977905273
Epoch: 12, Steps: 4 | Train Loss: 0.478 Vali Loss: 2.501 Vali Acc: 0.220 Test Loss: 2.501 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1100237369537354
Epoch: 13, Steps: 4 | Train Loss: 0.513 Vali Loss: 2.706 Vali Acc: 0.260 Test Loss: 2.706 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1154108047485352
Epoch: 14, Steps: 4 | Train Loss: 0.483 Vali Loss: 2.897 Vali Acc: 0.240 Test Loss: 2.897 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1590039730072021
Epoch: 15, Steps: 4 | Train Loss: 0.350 Vali Loss: 3.115 Vali Acc: 0.280 Test Loss: 3.115 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.106734037399292
Epoch: 16, Steps: 4 | Train Loss: 0.314 Vali Loss: 3.330 Vali Acc: 0.300 Test Loss: 3.330 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299967).  Saving model ...
Epoch: 17 cost time: 1.188575029373169
Epoch: 17, Steps: 4 | Train Loss: 0.261 Vali Loss: 3.463 Vali Acc: 0.360 Test Loss: 3.463 Test Acc: 0.360
Validation loss decreased (-0.299967 --> -0.359965).  Saving model ...
Epoch: 18 cost time: 1.2667763233184814
Epoch: 18, Steps: 4 | Train Loss: 0.238 Vali Loss: 3.488 Vali Acc: 0.340 Test Loss: 3.488 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2246501445770264
Epoch: 19, Steps: 4 | Train Loss: 0.306 Vali Loss: 3.660 Vali Acc: 0.300 Test Loss: 3.660 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0147171020507812
Epoch: 20, Steps: 4 | Train Loss: 0.242 Vali Loss: 3.712 Vali Acc: 0.300 Test Loss: 3.712 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.042834758758545
Epoch: 21, Steps: 4 | Train Loss: 0.133 Vali Loss: 3.908 Vali Acc: 0.260 Test Loss: 3.908 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9932200908660889
Epoch: 22, Steps: 4 | Train Loss: 0.133 Vali Loss: 4.027 Vali Acc: 0.320 Test Loss: 4.027 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.1505892276763916
Epoch: 23, Steps: 4 | Train Loss: 0.119 Vali Loss: 4.120 Vali Acc: 0.280 Test Loss: 4.120 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.1958398818969727
Epoch: 24, Steps: 4 | Train Loss: 0.068 Vali Loss: 4.378 Vali Acc: 0.260 Test Loss: 4.378 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.030653476715088
Epoch: 25, Steps: 4 | Train Loss: 0.059 Vali Loss: 4.600 Vali Acc: 0.280 Test Loss: 4.600 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.0308647155761719
Epoch: 26, Steps: 4 | Train Loss: 0.136 Vali Loss: 4.766 Vali Acc: 0.300 Test Loss: 4.766 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.0875585079193115
Epoch: 27, Steps: 4 | Train Loss: 0.052 Vali Loss: 4.908 Vali Acc: 0.360 Test Loss: 4.908 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 782957
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.812255382537842
Epoch: 1, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.647 Vali Acc: 0.260 Test Loss: 1.647 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 0.9601616859436035
Epoch: 2, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.637 Vali Acc: 0.220 Test Loss: 1.637 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0460691452026367
Epoch: 3, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0431907176971436
Epoch: 4, Steps: 4 | Train Loss: 1.405 Vali Loss: 1.715 Vali Acc: 0.160 Test Loss: 1.715 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0977084636688232
Epoch: 5, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.782 Vali Acc: 0.160 Test Loss: 1.782 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0446460247039795
Epoch: 6, Steps: 4 | Train Loss: 1.268 Vali Loss: 1.880 Vali Acc: 0.220 Test Loss: 1.880 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.029129981994629
Epoch: 7, Steps: 4 | Train Loss: 1.142 Vali Loss: 1.887 Vali Acc: 0.200 Test Loss: 1.887 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.0493144989013672
Epoch: 8, Steps: 4 | Train Loss: 0.814 Vali Loss: 1.916 Vali Acc: 0.160 Test Loss: 1.916 Test Acc: 0.160
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1852402687072754
Epoch: 9, Steps: 4 | Train Loss: 0.884 Vali Loss: 2.014 Vali Acc: 0.180 Test Loss: 2.014 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 0.999859094619751
Epoch: 10, Steps: 4 | Train Loss: 0.836 Vali Loss: 2.123 Vali Acc: 0.200 Test Loss: 2.123 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.053525447845459
Epoch: 11, Steps: 4 | Train Loss: 0.606 Vali Loss: 2.262 Vali Acc: 0.200 Test Loss: 2.262 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 782957
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8493411540985107
Epoch: 1, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.648 Vali Acc: 0.100 Test Loss: 1.648 Test Acc: 0.100
Validation loss decreased (inf --> -0.099984).  Saving model ...
Epoch: 2 cost time: 1.1283254623413086
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.631 Vali Acc: 0.020 Test Loss: 1.631 Test Acc: 0.020
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0962629318237305
Epoch: 3, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.647 Vali Acc: 0.260 Test Loss: 1.647 Test Acc: 0.260
Validation loss decreased (-0.099984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.0745739936828613
Epoch: 4, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.664 Vali Acc: 0.260 Test Loss: 1.664 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0807509422302246
Epoch: 5, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.712 Vali Acc: 0.220 Test Loss: 1.712 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.123607873916626
Epoch: 6, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.731 Vali Acc: 0.220 Test Loss: 1.731 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.287034034729004
Epoch: 7, Steps: 4 | Train Loss: 1.218 Vali Loss: 1.731 Vali Acc: 0.200 Test Loss: 1.731 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1250743865966797
Epoch: 8, Steps: 4 | Train Loss: 0.930 Vali Loss: 1.748 Vali Acc: 0.220 Test Loss: 1.748 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.0765354633331299
Epoch: 9, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.826 Vali Acc: 0.220 Test Loss: 1.826 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1325466632843018
Epoch: 10, Steps: 4 | Train Loss: 0.924 Vali Loss: 1.910 Vali Acc: 0.260 Test Loss: 1.910 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0551965236663818
Epoch: 11, Steps: 4 | Train Loss: 0.725 Vali Loss: 1.973 Vali Acc: 0.260 Test Loss: 1.973 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.0479283332824707
Epoch: 12, Steps: 4 | Train Loss: 0.603 Vali Loss: 2.042 Vali Acc: 0.240 Test Loss: 2.042 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.233098030090332
Epoch: 13, Steps: 4 | Train Loss: 0.670 Vali Loss: 2.137 Vali Acc: 0.260 Test Loss: 2.137 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 782957
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9835617542266846
Epoch: 1, Steps: 4 | Train Loss: 1.769 Vali Loss: 1.666 Vali Acc: 0.160 Test Loss: 1.666 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 0.9881300926208496
Epoch: 2, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.641 Vali Acc: 0.160 Test Loss: 1.641 Test Acc: 0.160
Validation loss decreased (-0.159983 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.0303030014038086
Epoch: 3, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.626 Vali Acc: 0.140 Test Loss: 1.626 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1120424270629883
Epoch: 4, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.647 Vali Acc: 0.180 Test Loss: 1.647 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 1.0736050605773926
Epoch: 5, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.673 Vali Acc: 0.160 Test Loss: 1.673 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.188502311706543
Epoch: 6, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.709 Vali Acc: 0.180 Test Loss: 1.709 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1315271854400635
Epoch: 7, Steps: 4 | Train Loss: 1.038 Vali Loss: 1.725 Vali Acc: 0.180 Test Loss: 1.725 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1109018325805664
Epoch: 8, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.772 Vali Acc: 0.180 Test Loss: 1.772 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2228503227233887
Epoch: 9, Steps: 4 | Train Loss: 0.875 Vali Loss: 1.811 Vali Acc: 0.180 Test Loss: 1.811 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2291591167449951
Epoch: 10, Steps: 4 | Train Loss: 0.708 Vali Loss: 1.897 Vali Acc: 0.180 Test Loss: 1.897 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1502296924591064
Epoch: 11, Steps: 4 | Train Loss: 0.514 Vali Loss: 2.053 Vali Acc: 0.260 Test Loss: 2.053 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259979).  Saving model ...
Epoch: 12 cost time: 1.1176269054412842
Epoch: 12, Steps: 4 | Train Loss: 0.521 Vali Loss: 2.237 Vali Acc: 0.240 Test Loss: 2.237 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1680686473846436
Epoch: 13, Steps: 4 | Train Loss: 0.404 Vali Loss: 2.392 Vali Acc: 0.260 Test Loss: 2.392 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1418161392211914
Epoch: 14, Steps: 4 | Train Loss: 0.494 Vali Loss: 2.535 Vali Acc: 0.280 Test Loss: 2.535 Test Acc: 0.280
Validation loss decreased (-0.259979 --> -0.279975).  Saving model ...
Epoch: 15 cost time: 1.0686776638031006
Epoch: 15, Steps: 4 | Train Loss: 0.314 Vali Loss: 2.720 Vali Acc: 0.240 Test Loss: 2.720 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.082465648651123
Epoch: 16, Steps: 4 | Train Loss: 0.283 Vali Loss: 2.760 Vali Acc: 0.220 Test Loss: 2.760 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0773389339447021
Epoch: 17, Steps: 4 | Train Loss: 0.320 Vali Loss: 2.927 Vali Acc: 0.260 Test Loss: 2.927 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0952305793762207
Epoch: 18, Steps: 4 | Train Loss: 0.253 Vali Loss: 2.977 Vali Acc: 0.260 Test Loss: 2.977 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0837759971618652
Epoch: 19, Steps: 4 | Train Loss: 0.208 Vali Loss: 3.032 Vali Acc: 0.240 Test Loss: 3.032 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0863072872161865
Epoch: 20, Steps: 4 | Train Loss: 0.153 Vali Loss: 3.083 Vali Acc: 0.280 Test Loss: 3.083 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1579787731170654
Epoch: 21, Steps: 4 | Train Loss: 0.174 Vali Loss: 3.120 Vali Acc: 0.280 Test Loss: 3.120 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9778268337249756
Epoch: 22, Steps: 4 | Train Loss: 0.113 Vali Loss: 3.206 Vali Acc: 0.300 Test Loss: 3.206 Test Acc: 0.300
Validation loss decreased (-0.279975 --> -0.299968).  Saving model ...
Epoch: 23 cost time: 1.0339775085449219
Epoch: 23, Steps: 4 | Train Loss: 0.086 Vali Loss: 3.293 Vali Acc: 0.320 Test Loss: 3.293 Test Acc: 0.320
Validation loss decreased (-0.299968 --> -0.319967).  Saving model ...
Epoch: 24 cost time: 1.0579254627227783
Epoch: 24, Steps: 4 | Train Loss: 0.073 Vali Loss: 3.370 Vali Acc: 0.300 Test Loss: 3.370 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.0531647205352783
Epoch: 25, Steps: 4 | Train Loss: 0.055 Vali Loss: 3.467 Vali Acc: 0.300 Test Loss: 3.467 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.0604264736175537
Epoch: 26, Steps: 4 | Train Loss: 0.045 Vali Loss: 3.602 Vali Acc: 0.280 Test Loss: 3.602 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0812175273895264
Epoch: 27, Steps: 4 | Train Loss: 0.037 Vali Loss: 3.680 Vali Acc: 0.300 Test Loss: 3.680 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.0650653839111328
Epoch: 28, Steps: 4 | Train Loss: 0.040 Vali Loss: 3.753 Vali Acc: 0.320 Test Loss: 3.753 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0189306735992432
Epoch: 29, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.768 Vali Acc: 0.260 Test Loss: 3.768 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.0680899620056152
Epoch: 30, Steps: 4 | Train Loss: 0.030 Vali Loss: 3.917 Vali Acc: 0.280 Test Loss: 3.917 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1744351387023926
Epoch: 31, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.981 Vali Acc: 0.240 Test Loss: 3.981 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.1733839511871338
Epoch: 32, Steps: 4 | Train Loss: 0.021 Vali Loss: 4.124 Vali Acc: 0.240 Test Loss: 4.124 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.116412878036499
Epoch: 33, Steps: 4 | Train Loss: 0.025 Vali Loss: 4.238 Vali Acc: 0.260 Test Loss: 4.238 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 750189
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8099677562713623
Epoch: 1, Steps: 4 | Train Loss: 1.768 Vali Loss: 1.649 Vali Acc: 0.120 Test Loss: 1.649 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.0614640712738037
Epoch: 2, Steps: 4 | Train Loss: 1.685 Vali Loss: 1.625 Vali Acc: 0.140 Test Loss: 1.625 Test Acc: 0.140
Validation loss decreased (-0.119984 --> -0.139984).  Saving model ...
Epoch: 3 cost time: 1.0842442512512207
Epoch: 3, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.609 Vali Acc: 0.200 Test Loss: 1.609 Test Acc: 0.200
Validation loss decreased (-0.139984 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.0913219451904297
Epoch: 4, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.615 Vali Acc: 0.200 Test Loss: 1.615 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 0.9782848358154297
Epoch: 5, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.651 Vali Acc: 0.180 Test Loss: 1.651 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1484930515289307
Epoch: 6, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.683 Vali Acc: 0.200 Test Loss: 1.683 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1049718856811523
Epoch: 7, Steps: 4 | Train Loss: 1.082 Vali Loss: 1.695 Vali Acc: 0.180 Test Loss: 1.695 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0964868068695068
Epoch: 8, Steps: 4 | Train Loss: 1.125 Vali Loss: 1.758 Vali Acc: 0.200 Test Loss: 1.758 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2934350967407227
Epoch: 9, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.810 Vali Acc: 0.200 Test Loss: 1.810 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1628994941711426
Epoch: 10, Steps: 4 | Train Loss: 0.746 Vali Loss: 1.897 Vali Acc: 0.180 Test Loss: 1.897 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.0189018249511719
Epoch: 11, Steps: 4 | Train Loss: 0.542 Vali Loss: 2.011 Vali Acc: 0.220 Test Loss: 2.011 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219980).  Saving model ...
Epoch: 12 cost time: 1.1296403408050537
Epoch: 12, Steps: 4 | Train Loss: 0.565 Vali Loss: 2.163 Vali Acc: 0.260 Test Loss: 2.163 Test Acc: 0.260
Validation loss decreased (-0.219980 --> -0.259978).  Saving model ...
Epoch: 13 cost time: 1.1781816482543945
Epoch: 13, Steps: 4 | Train Loss: 0.432 Vali Loss: 2.347 Vali Acc: 0.240 Test Loss: 2.347 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3310418128967285
Epoch: 14, Steps: 4 | Train Loss: 0.505 Vali Loss: 2.459 Vali Acc: 0.280 Test Loss: 2.459 Test Acc: 0.280
Validation loss decreased (-0.259978 --> -0.279975).  Saving model ...
Epoch: 15 cost time: 1.1596462726593018
Epoch: 15, Steps: 4 | Train Loss: 0.334 Vali Loss: 2.564 Vali Acc: 0.260 Test Loss: 2.564 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9860656261444092
Epoch: 16, Steps: 4 | Train Loss: 0.299 Vali Loss: 2.619 Vali Acc: 0.240 Test Loss: 2.619 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.0730688571929932
Epoch: 17, Steps: 4 | Train Loss: 0.353 Vali Loss: 2.760 Vali Acc: 0.260 Test Loss: 2.760 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2777931690216064
Epoch: 18, Steps: 4 | Train Loss: 0.298 Vali Loss: 2.856 Vali Acc: 0.260 Test Loss: 2.856 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.2361795902252197
Epoch: 19, Steps: 4 | Train Loss: 0.233 Vali Loss: 2.928 Vali Acc: 0.260 Test Loss: 2.928 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2142581939697266
Epoch: 20, Steps: 4 | Train Loss: 0.172 Vali Loss: 3.042 Vali Acc: 0.280 Test Loss: 3.042 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.2117972373962402
Epoch: 21, Steps: 4 | Train Loss: 0.212 Vali Loss: 3.106 Vali Acc: 0.300 Test Loss: 3.106 Test Acc: 0.300
Validation loss decreased (-0.279975 --> -0.299969).  Saving model ...
Epoch: 22 cost time: 1.2612061500549316
Epoch: 22, Steps: 4 | Train Loss: 0.126 Vali Loss: 3.114 Vali Acc: 0.280 Test Loss: 3.114 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2279014587402344
Epoch: 23, Steps: 4 | Train Loss: 0.099 Vali Loss: 3.225 Vali Acc: 0.300 Test Loss: 3.225 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1824324131011963
Epoch: 24, Steps: 4 | Train Loss: 0.090 Vali Loss: 3.333 Vali Acc: 0.280 Test Loss: 3.333 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3502519130706787
Epoch: 25, Steps: 4 | Train Loss: 0.065 Vali Loss: 3.381 Vali Acc: 0.260 Test Loss: 3.381 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1061010360717773
Epoch: 26, Steps: 4 | Train Loss: 0.053 Vali Loss: 3.541 Vali Acc: 0.280 Test Loss: 3.541 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.103841781616211
Epoch: 27, Steps: 4 | Train Loss: 0.043 Vali Loss: 3.635 Vali Acc: 0.300 Test Loss: 3.635 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1239831447601318
Epoch: 28, Steps: 4 | Train Loss: 0.041 Vali Loss: 3.709 Vali Acc: 0.300 Test Loss: 3.709 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2217450141906738
Epoch: 29, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.740 Vali Acc: 0.320 Test Loss: 3.740 Test Acc: 0.320
Validation loss decreased (-0.299969 --> -0.319963).  Saving model ...
Epoch: 30 cost time: 1.0986733436584473
Epoch: 30, Steps: 4 | Train Loss: 0.034 Vali Loss: 3.810 Vali Acc: 0.300 Test Loss: 3.810 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.253786325454712
Epoch: 31, Steps: 4 | Train Loss: 0.025 Vali Loss: 3.896 Vali Acc: 0.300 Test Loss: 3.896 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1710047721862793
Epoch: 32, Steps: 4 | Train Loss: 0.023 Vali Loss: 3.936 Vali Acc: 0.280 Test Loss: 3.936 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.1178452968597412
Epoch: 33, Steps: 4 | Train Loss: 0.029 Vali Loss: 4.029 Vali Acc: 0.280 Test Loss: 4.029 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.130817174911499
Epoch: 34, Steps: 4 | Train Loss: 0.014 Vali Loss: 4.149 Vali Acc: 0.300 Test Loss: 4.149 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.1284055709838867
Epoch: 35, Steps: 4 | Train Loss: 0.012 Vali Loss: 4.171 Vali Acc: 0.300 Test Loss: 4.171 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.0724527835845947
Epoch: 36, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.355 Vali Acc: 0.320 Test Loss: 4.355 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.047377347946167
Epoch: 37, Steps: 4 | Train Loss: 0.011 Vali Loss: 4.537 Vali Acc: 0.300 Test Loss: 4.537 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0967609882354736
Epoch: 38, Steps: 4 | Train Loss: 0.015 Vali Loss: 4.637 Vali Acc: 0.280 Test Loss: 4.637 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.930034875869751
Epoch: 39, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.637 Vali Acc: 0.300 Test Loss: 4.637 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 750189
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8835136890411377
Epoch: 1, Steps: 4 | Train Loss: 1.738 Vali Loss: 1.614 Vali Acc: 0.180 Test Loss: 1.614 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.0229191780090332
Epoch: 2, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.598 Vali Acc: 0.160 Test Loss: 1.598 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0829691886901855
Epoch: 3, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.594 Vali Acc: 0.180 Test Loss: 1.594 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.0886168479919434
Epoch: 4, Steps: 4 | Train Loss: 1.437 Vali Loss: 1.593 Vali Acc: 0.180 Test Loss: 1.593 Test Acc: 0.180
Validation loss decreased (-0.179984 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 1.1208579540252686
Epoch: 5, Steps: 4 | Train Loss: 1.349 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1539092063903809
Epoch: 6, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.664 Vali Acc: 0.180 Test Loss: 1.664 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1195471286773682
Epoch: 7, Steps: 4 | Train Loss: 1.101 Vali Loss: 1.712 Vali Acc: 0.180 Test Loss: 1.712 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1118896007537842
Epoch: 8, Steps: 4 | Train Loss: 1.154 Vali Loss: 1.785 Vali Acc: 0.200 Test Loss: 1.785 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199982).  Saving model ...
Epoch: 9 cost time: 1.1271088123321533
Epoch: 9, Steps: 4 | Train Loss: 0.933 Vali Loss: 1.829 Vali Acc: 0.220 Test Loss: 1.829 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219982).  Saving model ...
Epoch: 10 cost time: 1.068793535232544
Epoch: 10, Steps: 4 | Train Loss: 0.789 Vali Loss: 1.889 Vali Acc: 0.180 Test Loss: 1.889 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.203779935836792
Epoch: 11, Steps: 4 | Train Loss: 0.583 Vali Loss: 2.006 Vali Acc: 0.260 Test Loss: 2.006 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259980).  Saving model ...
Epoch: 12 cost time: 1.134101152420044
Epoch: 12, Steps: 4 | Train Loss: 0.618 Vali Loss: 2.144 Vali Acc: 0.280 Test Loss: 2.144 Test Acc: 0.280
Validation loss decreased (-0.259980 --> -0.279979).  Saving model ...
Epoch: 13 cost time: 1.1709790229797363
Epoch: 13, Steps: 4 | Train Loss: 0.463 Vali Loss: 2.334 Vali Acc: 0.260 Test Loss: 2.334 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.149726152420044
Epoch: 14, Steps: 4 | Train Loss: 0.560 Vali Loss: 2.457 Vali Acc: 0.260 Test Loss: 2.457 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1234886646270752
Epoch: 15, Steps: 4 | Train Loss: 0.365 Vali Loss: 2.545 Vali Acc: 0.260 Test Loss: 2.545 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1280817985534668
Epoch: 16, Steps: 4 | Train Loss: 0.322 Vali Loss: 2.612 Vali Acc: 0.240 Test Loss: 2.612 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.142256259918213
Epoch: 17, Steps: 4 | Train Loss: 0.417 Vali Loss: 2.764 Vali Acc: 0.260 Test Loss: 2.764 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0488934516906738
Epoch: 18, Steps: 4 | Train Loss: 0.323 Vali Loss: 2.907 Vali Acc: 0.200 Test Loss: 2.907 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9617452621459961
Epoch: 19, Steps: 4 | Train Loss: 0.275 Vali Loss: 3.035 Vali Acc: 0.200 Test Loss: 3.035 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.029268503189087
Epoch: 20, Steps: 4 | Train Loss: 0.190 Vali Loss: 3.086 Vali Acc: 0.260 Test Loss: 3.086 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0707645416259766
Epoch: 21, Steps: 4 | Train Loss: 0.247 Vali Loss: 3.122 Vali Acc: 0.300 Test Loss: 3.122 Test Acc: 0.300
Validation loss decreased (-0.279979 --> -0.299969).  Saving model ...
Epoch: 22 cost time: 1.240934133529663
Epoch: 22, Steps: 4 | Train Loss: 0.151 Vali Loss: 3.127 Vali Acc: 0.320 Test Loss: 3.127 Test Acc: 0.320
Validation loss decreased (-0.299969 --> -0.319969).  Saving model ...
Epoch: 23 cost time: 1.0918443202972412
Epoch: 23, Steps: 4 | Train Loss: 0.120 Vali Loss: 3.089 Vali Acc: 0.280 Test Loss: 3.089 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.1752219200134277
Epoch: 24, Steps: 4 | Train Loss: 0.103 Vali Loss: 3.192 Vali Acc: 0.280 Test Loss: 3.192 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.0835351943969727
Epoch: 25, Steps: 4 | Train Loss: 0.078 Vali Loss: 3.218 Vali Acc: 0.280 Test Loss: 3.218 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.1056859493255615
Epoch: 26, Steps: 4 | Train Loss: 0.061 Vali Loss: 3.313 Vali Acc: 0.340 Test Loss: 3.313 Test Acc: 0.340
Validation loss decreased (-0.319969 --> -0.339967).  Saving model ...
Epoch: 27 cost time: 1.1583356857299805
Epoch: 27, Steps: 4 | Train Loss: 0.050 Vali Loss: 3.431 Vali Acc: 0.320 Test Loss: 3.431 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.1114554405212402
Epoch: 28, Steps: 4 | Train Loss: 0.047 Vali Loss: 3.529 Vali Acc: 0.260 Test Loss: 3.529 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.1404757499694824
Epoch: 29, Steps: 4 | Train Loss: 0.031 Vali Loss: 3.603 Vali Acc: 0.300 Test Loss: 3.603 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.152087926864624
Epoch: 30, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.694 Vali Acc: 0.300 Test Loss: 3.694 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.1616575717926025
Epoch: 31, Steps: 4 | Train Loss: 0.027 Vali Loss: 3.806 Vali Acc: 0.300 Test Loss: 3.806 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1955931186676025
Epoch: 32, Steps: 4 | Train Loss: 0.026 Vali Loss: 3.890 Vali Acc: 0.300 Test Loss: 3.890 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2556414604187012
Epoch: 33, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.957 Vali Acc: 0.300 Test Loss: 3.957 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.1861789226531982
Epoch: 34, Steps: 4 | Train Loss: 0.015 Vali Loss: 3.953 Vali Acc: 0.280 Test Loss: 3.953 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2228622436523438
Epoch: 35, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.998 Vali Acc: 0.280 Test Loss: 3.998 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2460129261016846
Epoch: 36, Steps: 4 | Train Loss: 0.012 Vali Loss: 3.992 Vali Acc: 0.300 Test Loss: 3.992 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 750189
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8692314624786377
Epoch: 1, Steps: 4 | Train Loss: 1.683 Vali Loss: 1.577 Vali Acc: 0.200 Test Loss: 1.577 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.107163906097412
Epoch: 2, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.571 Vali Acc: 0.260 Test Loss: 1.571 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 0.9549133777618408
Epoch: 3, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.585 Vali Acc: 0.260 Test Loss: 1.585 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9983828067779541
Epoch: 4, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.603 Vali Acc: 0.200 Test Loss: 1.603 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0479848384857178
Epoch: 5, Steps: 4 | Train Loss: 1.413 Vali Loss: 1.632 Vali Acc: 0.180 Test Loss: 1.632 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 0.9925110340118408
Epoch: 6, Steps: 4 | Train Loss: 1.196 Vali Loss: 1.647 Vali Acc: 0.140 Test Loss: 1.647 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.0967285633087158
Epoch: 7, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.629 Vali Acc: 0.140 Test Loss: 1.629 Test Acc: 0.140
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1061854362487793
Epoch: 8, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.655 Vali Acc: 0.120 Test Loss: 1.655 Test Acc: 0.120
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.0549449920654297
Epoch: 9, Steps: 4 | Train Loss: 1.055 Vali Loss: 1.704 Vali Acc: 0.180 Test Loss: 1.704 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1056888103485107
Epoch: 10, Steps: 4 | Train Loss: 0.902 Vali Loss: 1.760 Vali Acc: 0.180 Test Loss: 1.760 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.0303800106048584
Epoch: 11, Steps: 4 | Train Loss: 0.679 Vali Loss: 1.876 Vali Acc: 0.180 Test Loss: 1.876 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.1681773662567139
Epoch: 12, Steps: 4 | Train Loss: 0.729 Vali Loss: 1.977 Vali Acc: 0.200 Test Loss: 1.977 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 750189
model size : 4.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7897145748138428
Epoch: 1, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.599 Vali Acc: 0.300 Test Loss: 1.599 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 0.9713788032531738
Epoch: 2, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.9863219261169434
Epoch: 3, Steps: 4 | Train Loss: 1.412 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0408222675323486
Epoch: 4, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 0.9944379329681396
Epoch: 5, Steps: 4 | Train Loss: 1.342 Vali Loss: 1.632 Vali Acc: 0.260 Test Loss: 1.632 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.0152018070220947
Epoch: 6, Steps: 4 | Train Loss: 0.890 Vali Loss: 1.739 Vali Acc: 0.220 Test Loss: 1.739 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0438084602355957
Epoch: 7, Steps: 4 | Train Loss: 0.922 Vali Loss: 1.810 Vali Acc: 0.240 Test Loss: 1.810 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9502577781677246
Epoch: 8, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.871 Vali Acc: 0.180 Test Loss: 1.871 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0675089359283447
Epoch: 9, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.980 Vali Acc: 0.240 Test Loss: 1.980 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0127172470092773
Epoch: 10, Steps: 4 | Train Loss: 0.707 Vali Loss: 2.085 Vali Acc: 0.240 Test Loss: 2.085 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0217044353485107
Epoch: 11, Steps: 4 | Train Loss: 0.768 Vali Loss: 2.214 Vali Acc: 0.260 Test Loss: 2.214 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 733805
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1826627254486084
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.166071891784668
Epoch: 2, Steps: 4 | Train Loss: 1.562 Vali Loss: 1.628 Vali Acc: 0.260 Test Loss: 1.628 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3619341850280762
Epoch: 3, Steps: 4 | Train Loss: 1.447 Vali Loss: 1.599 Vali Acc: 0.220 Test Loss: 1.599 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.219050645828247
Epoch: 4, Steps: 4 | Train Loss: 1.499 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2529428005218506
Epoch: 5, Steps: 4 | Train Loss: 1.366 Vali Loss: 1.669 Vali Acc: 0.220 Test Loss: 1.669 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3472671508789062
Epoch: 6, Steps: 4 | Train Loss: 0.928 Vali Loss: 1.734 Vali Acc: 0.220 Test Loss: 1.734 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.166477918624878
Epoch: 7, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.805 Vali Acc: 0.280 Test Loss: 1.805 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2674193382263184
Epoch: 8, Steps: 4 | Train Loss: 0.934 Vali Loss: 1.852 Vali Acc: 0.260 Test Loss: 1.852 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3061890602111816
Epoch: 9, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.923 Vali Acc: 0.260 Test Loss: 1.923 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0866706371307373
Epoch: 10, Steps: 4 | Train Loss: 0.752 Vali Loss: 2.028 Vali Acc: 0.260 Test Loss: 2.028 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3273942470550537
Epoch: 11, Steps: 4 | Train Loss: 0.795 Vali Loss: 2.154 Vali Acc: 0.260 Test Loss: 2.154 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 733805
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.154934883117676
Epoch: 1, Steps: 4 | Train Loss: 1.598 Vali Loss: 1.675 Vali Acc: 0.240 Test Loss: 1.675 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.2402312755584717
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.215451717376709
Epoch: 3, Steps: 4 | Train Loss: 1.479 Vali Loss: 1.614 Vali Acc: 0.260 Test Loss: 1.614 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.1544601917266846
Epoch: 4, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.612 Vali Acc: 0.340 Test Loss: 1.612 Test Acc: 0.340
Validation loss decreased (-0.259984 --> -0.339984).  Saving model ...
Epoch: 5 cost time: 1.1779170036315918
Epoch: 5, Steps: 4 | Train Loss: 1.407 Vali Loss: 1.663 Vali Acc: 0.220 Test Loss: 1.663 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.166255235671997
Epoch: 6, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.736 Vali Acc: 0.240 Test Loss: 1.736 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1474108695983887
Epoch: 7, Steps: 4 | Train Loss: 1.023 Vali Loss: 1.781 Vali Acc: 0.220 Test Loss: 1.781 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.10595703125
Epoch: 8, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.840 Vali Acc: 0.240 Test Loss: 1.840 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2138316631317139
Epoch: 9, Steps: 4 | Train Loss: 0.944 Vali Loss: 1.911 Vali Acc: 0.240 Test Loss: 1.911 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.254277229309082
Epoch: 10, Steps: 4 | Train Loss: 0.824 Vali Loss: 1.977 Vali Acc: 0.280 Test Loss: 1.977 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.125103235244751
Epoch: 11, Steps: 4 | Train Loss: 0.851 Vali Loss: 2.099 Vali Acc: 0.240 Test Loss: 2.099 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0961039066314697
Epoch: 12, Steps: 4 | Train Loss: 0.826 Vali Loss: 2.251 Vali Acc: 0.240 Test Loss: 2.251 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1596684455871582
Epoch: 13, Steps: 4 | Train Loss: 0.541 Vali Loss: 2.344 Vali Acc: 0.240 Test Loss: 2.344 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1671268939971924
Epoch: 14, Steps: 4 | Train Loss: 0.418 Vali Loss: 2.381 Vali Acc: 0.220 Test Loss: 2.381 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 733805
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6664371490478516
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.671 Vali Acc: 0.200 Test Loss: 1.671 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 0.914543867111206
Epoch: 2, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.656 Vali Acc: 0.180 Test Loss: 1.656 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 0.972437858581543
Epoch: 3, Steps: 4 | Train Loss: 1.513 Vali Loss: 1.642 Vali Acc: 0.220 Test Loss: 1.642 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.0499718189239502
Epoch: 4, Steps: 4 | Train Loss: 1.565 Vali Loss: 1.623 Vali Acc: 0.260 Test Loss: 1.623 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.0896003246307373
Epoch: 5, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.668 Vali Acc: 0.320 Test Loss: 1.668 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319983).  Saving model ...
Epoch: 6 cost time: 0.8945741653442383
Epoch: 6, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.725 Vali Acc: 0.300 Test Loss: 1.725 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0591719150543213
Epoch: 7, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.771 Vali Acc: 0.280 Test Loss: 1.771 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.003208875656128
Epoch: 8, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.816 Vali Acc: 0.260 Test Loss: 1.816 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0410008430480957
Epoch: 9, Steps: 4 | Train Loss: 1.027 Vali Loss: 1.841 Vali Acc: 0.260 Test Loss: 1.841 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0965595245361328
Epoch: 10, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.876 Vali Acc: 0.260 Test Loss: 1.876 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.044618844985962
Epoch: 11, Steps: 4 | Train Loss: 0.937 Vali Loss: 1.937 Vali Acc: 0.280 Test Loss: 1.937 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.080472469329834
Epoch: 12, Steps: 4 | Train Loss: 0.886 Vali Loss: 2.018 Vali Acc: 0.260 Test Loss: 2.018 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0918619632720947
Epoch: 13, Steps: 4 | Train Loss: 0.640 Vali Loss: 2.090 Vali Acc: 0.260 Test Loss: 2.090 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 0.9919497966766357
Epoch: 14, Steps: 4 | Train Loss: 0.507 Vali Loss: 2.086 Vali Acc: 0.260 Test Loss: 2.086 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0048761367797852
Epoch: 15, Steps: 4 | Train Loss: 0.531 Vali Loss: 2.166 Vali Acc: 0.240 Test Loss: 2.166 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 733805
model size : 4.04MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.803534984588623
Epoch: 1, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.627 Vali Acc: 0.220 Test Loss: 1.627 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.076176643371582
Epoch: 2, Steps: 4 | Train Loss: 1.351 Vali Loss: 1.615 Vali Acc: 0.200 Test Loss: 1.615 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1108582019805908
Epoch: 3, Steps: 4 | Train Loss: 1.513 Vali Loss: 1.593 Vali Acc: 0.180 Test Loss: 1.593 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1374285221099854
Epoch: 4, Steps: 4 | Train Loss: 1.386 Vali Loss: 1.576 Vali Acc: 0.140 Test Loss: 1.576 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1356406211853027
Epoch: 5, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.572 Vali Acc: 0.200 Test Loss: 1.572 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.100214958190918
Epoch: 6, Steps: 4 | Train Loss: 1.244 Vali Loss: 1.577 Vali Acc: 0.200 Test Loss: 1.577 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.062652349472046
Epoch: 7, Steps: 4 | Train Loss: 1.275 Vali Loss: 1.601 Vali Acc: 0.280 Test Loss: 1.601 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.1120665073394775
Epoch: 8, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1742877960205078
Epoch: 9, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.685 Vali Acc: 0.260 Test Loss: 1.685 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.963822603225708
Epoch: 10, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.763 Vali Acc: 0.260 Test Loss: 1.763 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3225600719451904
Epoch: 11, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.822 Vali Acc: 0.260 Test Loss: 1.822 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1980173587799072
Epoch: 12, Steps: 4 | Train Loss: 0.749 Vali Loss: 1.897 Vali Acc: 0.280 Test Loss: 1.897 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2542879581451416
Epoch: 13, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.984 Vali Acc: 0.320 Test Loss: 1.984 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319980).  Saving model ...
Epoch: 14 cost time: 1.1020803451538086
Epoch: 14, Steps: 4 | Train Loss: 0.630 Vali Loss: 2.069 Vali Acc: 0.280 Test Loss: 2.069 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2623851299285889
Epoch: 15, Steps: 4 | Train Loss: 0.732 Vali Loss: 2.203 Vali Acc: 0.200 Test Loss: 2.203 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.268430233001709
Epoch: 16, Steps: 4 | Train Loss: 0.459 Vali Loss: 2.317 Vali Acc: 0.220 Test Loss: 2.317 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2226264476776123
Epoch: 17, Steps: 4 | Train Loss: 0.444 Vali Loss: 2.433 Vali Acc: 0.240 Test Loss: 2.433 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2140381336212158
Epoch: 18, Steps: 4 | Train Loss: 0.557 Vali Loss: 2.547 Vali Acc: 0.280 Test Loss: 2.547 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.1564335823059082
Epoch: 19, Steps: 4 | Train Loss: 0.428 Vali Loss: 2.676 Vali Acc: 0.220 Test Loss: 2.676 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2134065628051758
Epoch: 20, Steps: 4 | Train Loss: 0.372 Vali Loss: 2.767 Vali Acc: 0.220 Test Loss: 2.767 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2882626056671143
Epoch: 21, Steps: 4 | Train Loss: 0.473 Vali Loss: 2.833 Vali Acc: 0.220 Test Loss: 2.833 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1573855876922607
Epoch: 22, Steps: 4 | Train Loss: 0.270 Vali Loss: 2.845 Vali Acc: 0.300 Test Loss: 2.845 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1616296768188477
Epoch: 23, Steps: 4 | Train Loss: 0.355 Vali Loss: 2.986 Vali Acc: 0.260 Test Loss: 2.986 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 622157
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.170166015625
Epoch: 1, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.625 Vali Acc: 0.200 Test Loss: 1.625 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.127021312713623
Epoch: 2, Steps: 4 | Train Loss: 1.396 Vali Loss: 1.612 Vali Acc: 0.200 Test Loss: 1.612 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.2122037410736084
Epoch: 3, Steps: 4 | Train Loss: 1.528 Vali Loss: 1.588 Vali Acc: 0.160 Test Loss: 1.588 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.08286452293396
Epoch: 4, Steps: 4 | Train Loss: 1.380 Vali Loss: 1.563 Vali Acc: 0.180 Test Loss: 1.563 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.042001485824585
Epoch: 5, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.557 Vali Acc: 0.200 Test Loss: 1.557 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 6 cost time: 1.0374603271484375
Epoch: 6, Steps: 4 | Train Loss: 1.267 Vali Loss: 1.571 Vali Acc: 0.240 Test Loss: 1.571 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.0315899848937988
Epoch: 7, Steps: 4 | Train Loss: 1.303 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 8 cost time: 1.085982322692871
Epoch: 8, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.613 Vali Acc: 0.260 Test Loss: 1.613 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.0698292255401611
Epoch: 9, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.660 Vali Acc: 0.280 Test Loss: 1.660 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0337343215942383
Epoch: 10, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.713 Vali Acc: 0.240 Test Loss: 1.713 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0982515811920166
Epoch: 11, Steps: 4 | Train Loss: 0.921 Vali Loss: 1.791 Vali Acc: 0.260 Test Loss: 1.791 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.0063958168029785
Epoch: 12, Steps: 4 | Train Loss: 0.762 Vali Loss: 1.859 Vali Acc: 0.300 Test Loss: 1.859 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299981).  Saving model ...
Epoch: 13 cost time: 1.0174057483673096
Epoch: 13, Steps: 4 | Train Loss: 0.648 Vali Loss: 1.953 Vali Acc: 0.320 Test Loss: 1.953 Test Acc: 0.320
Validation loss decreased (-0.299981 --> -0.319980).  Saving model ...
Epoch: 14 cost time: 1.1186556816101074
Epoch: 14, Steps: 4 | Train Loss: 0.653 Vali Loss: 2.064 Vali Acc: 0.320 Test Loss: 2.064 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.041414499282837
Epoch: 15, Steps: 4 | Train Loss: 0.759 Vali Loss: 2.157 Vali Acc: 0.280 Test Loss: 2.157 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0553381443023682
Epoch: 16, Steps: 4 | Train Loss: 0.476 Vali Loss: 2.244 Vali Acc: 0.260 Test Loss: 2.244 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0435459613800049
Epoch: 17, Steps: 4 | Train Loss: 0.459 Vali Loss: 2.296 Vali Acc: 0.280 Test Loss: 2.296 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.037397861480713
Epoch: 18, Steps: 4 | Train Loss: 0.583 Vali Loss: 2.429 Vali Acc: 0.220 Test Loss: 2.429 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9798316955566406
Epoch: 19, Steps: 4 | Train Loss: 0.449 Vali Loss: 2.527 Vali Acc: 0.260 Test Loss: 2.527 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1463191509246826
Epoch: 20, Steps: 4 | Train Loss: 0.380 Vali Loss: 2.577 Vali Acc: 0.240 Test Loss: 2.577 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0762479305267334
Epoch: 21, Steps: 4 | Train Loss: 0.509 Vali Loss: 2.629 Vali Acc: 0.260 Test Loss: 2.629 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0762608051300049
Epoch: 22, Steps: 4 | Train Loss: 0.286 Vali Loss: 2.682 Vali Acc: 0.300 Test Loss: 2.682 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1638751029968262
Epoch: 23, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.780 Vali Acc: 0.280 Test Loss: 2.780 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 622157
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1215367317199707
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.583 Vali Acc: 0.200 Test Loss: 1.583 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.1175768375396729
Epoch: 2, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.572 Vali Acc: 0.240 Test Loss: 1.572 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.1253125667572021
Epoch: 3, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.553 Vali Acc: 0.260 Test Loss: 1.553 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.1389927864074707
Epoch: 4, Steps: 4 | Train Loss: 1.343 Vali Loss: 1.552 Vali Acc: 0.200 Test Loss: 1.552 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1872873306274414
Epoch: 5, Steps: 4 | Train Loss: 1.467 Vali Loss: 1.550 Vali Acc: 0.200 Test Loss: 1.550 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 0.987830400466919
Epoch: 6, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.565 Vali Acc: 0.220 Test Loss: 1.565 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.0963449478149414
Epoch: 7, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.576 Vali Acc: 0.200 Test Loss: 1.576 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1199743747711182
Epoch: 8, Steps: 4 | Train Loss: 1.287 Vali Loss: 1.572 Vali Acc: 0.280 Test Loss: 1.572 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 9 cost time: 1.1564483642578125
Epoch: 9, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9612007141113281
Epoch: 10, Steps: 4 | Train Loss: 1.063 Vali Loss: 1.674 Vali Acc: 0.220 Test Loss: 1.674 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1687054634094238
Epoch: 11, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.742 Vali Acc: 0.240 Test Loss: 1.742 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9685547351837158
Epoch: 12, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.810 Vali Acc: 0.260 Test Loss: 1.810 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0143675804138184
Epoch: 13, Steps: 4 | Train Loss: 0.686 Vali Loss: 1.900 Vali Acc: 0.280 Test Loss: 1.900 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1868844032287598
Epoch: 14, Steps: 4 | Train Loss: 0.684 Vali Loss: 1.986 Vali Acc: 0.260 Test Loss: 1.986 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1160240173339844
Epoch: 15, Steps: 4 | Train Loss: 0.777 Vali Loss: 2.077 Vali Acc: 0.240 Test Loss: 2.077 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.163050651550293
Epoch: 16, Steps: 4 | Train Loss: 0.494 Vali Loss: 2.104 Vali Acc: 0.260 Test Loss: 2.104 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2057652473449707
Epoch: 17, Steps: 4 | Train Loss: 0.475 Vali Loss: 2.156 Vali Acc: 0.320 Test Loss: 2.156 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319978).  Saving model ...
Epoch: 18 cost time: 1.1093056201934814
Epoch: 18, Steps: 4 | Train Loss: 0.603 Vali Loss: 2.225 Vali Acc: 0.300 Test Loss: 2.225 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2570216655731201
Epoch: 19, Steps: 4 | Train Loss: 0.482 Vali Loss: 2.317 Vali Acc: 0.260 Test Loss: 2.317 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1497340202331543
Epoch: 20, Steps: 4 | Train Loss: 0.430 Vali Loss: 2.384 Vali Acc: 0.300 Test Loss: 2.384 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1381945610046387
Epoch: 21, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.419 Vali Acc: 0.280 Test Loss: 2.419 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1226816177368164
Epoch: 22, Steps: 4 | Train Loss: 0.315 Vali Loss: 2.439 Vali Acc: 0.300 Test Loss: 2.439 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0857915878295898
Epoch: 23, Steps: 4 | Train Loss: 0.410 Vali Loss: 2.488 Vali Acc: 0.320 Test Loss: 2.488 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.0482914447784424
Epoch: 24, Steps: 4 | Train Loss: 0.268 Vali Loss: 2.571 Vali Acc: 0.300 Test Loss: 2.571 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.2464540004730225
Epoch: 25, Steps: 4 | Train Loss: 0.193 Vali Loss: 2.693 Vali Acc: 0.320 Test Loss: 2.693 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.1720571517944336
Epoch: 26, Steps: 4 | Train Loss: 0.173 Vali Loss: 2.811 Vali Acc: 0.280 Test Loss: 2.811 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.214900016784668
Epoch: 27, Steps: 4 | Train Loss: 0.158 Vali Loss: 2.886 Vali Acc: 0.260 Test Loss: 2.886 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 622157
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.6425063610076904
Epoch: 1, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.591 Vali Acc: 0.200 Test Loss: 1.591 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.0264739990234375
Epoch: 2, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.587 Vali Acc: 0.220 Test Loss: 1.587 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.0101559162139893
Epoch: 3, Steps: 4 | Train Loss: 1.533 Vali Loss: 1.569 Vali Acc: 0.200 Test Loss: 1.569 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0338029861450195
Epoch: 4, Steps: 4 | Train Loss: 1.377 Vali Loss: 1.566 Vali Acc: 0.180 Test Loss: 1.566 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1377763748168945
Epoch: 5, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.564 Vali Acc: 0.140 Test Loss: 1.564 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.0782575607299805
Epoch: 6, Steps: 4 | Train Loss: 1.331 Vali Loss: 1.544 Vali Acc: 0.300 Test Loss: 1.544 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 1.0939152240753174
Epoch: 7, Steps: 4 | Train Loss: 1.349 Vali Loss: 1.533 Vali Acc: 0.240 Test Loss: 1.533 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1373014450073242
Epoch: 8, Steps: 4 | Train Loss: 1.317 Vali Loss: 1.518 Vali Acc: 0.260 Test Loss: 1.518 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.0793678760528564
Epoch: 9, Steps: 4 | Train Loss: 1.131 Vali Loss: 1.531 Vali Acc: 0.260 Test Loss: 1.531 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.0556261539459229
Epoch: 10, Steps: 4 | Train Loss: 1.100 Vali Loss: 1.552 Vali Acc: 0.260 Test Loss: 1.552 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.149942398071289
Epoch: 11, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.615 Vali Acc: 0.240 Test Loss: 1.615 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2261416912078857
Epoch: 12, Steps: 4 | Train Loss: 0.858 Vali Loss: 1.625 Vali Acc: 0.280 Test Loss: 1.625 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1677711009979248
Epoch: 13, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.680 Vali Acc: 0.280 Test Loss: 1.680 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.1265959739685059
Epoch: 14, Steps: 4 | Train Loss: 0.749 Vali Loss: 1.730 Vali Acc: 0.240 Test Loss: 1.730 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1209795475006104
Epoch: 15, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.754 Vali Acc: 0.220 Test Loss: 1.754 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.307706356048584
Epoch: 16, Steps: 4 | Train Loss: 0.543 Vali Loss: 1.765 Vali Acc: 0.260 Test Loss: 1.765 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 622157
model size : 3.00MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.889921188354492
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.843 Vali Acc: 0.200 Test Loss: 1.843 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 1.0563783645629883
Epoch: 2, Steps: 4 | Train Loss: 1.594 Vali Loss: 1.810 Vali Acc: 0.220 Test Loss: 1.810 Test Acc: 0.220
Validation loss decreased (-0.199982 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.0804660320281982
Epoch: 3, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.759 Vali Acc: 0.260 Test Loss: 1.759 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259982).  Saving model ...
Epoch: 4 cost time: 1.0758612155914307
Epoch: 4, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.695 Vali Acc: 0.260 Test Loss: 1.695 Test Acc: 0.260
Validation loss decreased (-0.259982 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.1972858905792236
Epoch: 5, Steps: 4 | Train Loss: 1.414 Vali Loss: 1.658 Vali Acc: 0.240 Test Loss: 1.658 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1810312271118164
Epoch: 6, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0952277183532715
Epoch: 7, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.677 Vali Acc: 0.220 Test Loss: 1.677 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0222911834716797
Epoch: 8, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.723 Vali Acc: 0.280 Test Loss: 1.723 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 9 cost time: 0.9461483955383301
Epoch: 9, Steps: 4 | Train Loss: 1.009 Vali Loss: 1.803 Vali Acc: 0.260 Test Loss: 1.803 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.141752004623413
Epoch: 10, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.865 Vali Acc: 0.220 Test Loss: 1.865 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.047255277633667
Epoch: 11, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.938 Vali Acc: 0.280 Test Loss: 1.938 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1173131465911865
Epoch: 12, Steps: 4 | Train Loss: 0.913 Vali Loss: 2.011 Vali Acc: 0.260 Test Loss: 2.011 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.165832281112671
Epoch: 13, Steps: 4 | Train Loss: 0.814 Vali Loss: 2.097 Vali Acc: 0.280 Test Loss: 2.097 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1398932933807373
Epoch: 14, Steps: 4 | Train Loss: 0.636 Vali Loss: 2.175 Vali Acc: 0.260 Test Loss: 2.175 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1897532939910889
Epoch: 15, Steps: 4 | Train Loss: 0.646 Vali Loss: 2.333 Vali Acc: 0.240 Test Loss: 2.333 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.097259521484375
Epoch: 16, Steps: 4 | Train Loss: 0.689 Vali Loss: 2.412 Vali Acc: 0.240 Test Loss: 2.412 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1924700736999512
Epoch: 17, Steps: 4 | Train Loss: 0.567 Vali Loss: 2.551 Vali Acc: 0.220 Test Loss: 2.551 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1694681644439697
Epoch: 18, Steps: 4 | Train Loss: 0.483 Vali Loss: 2.696 Vali Acc: 0.220 Test Loss: 2.696 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 491085
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.712397813796997
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.854 Vali Acc: 0.220 Test Loss: 1.854 Test Acc: 0.220
Validation loss decreased (inf --> -0.219981).  Saving model ...
Epoch: 2 cost time: 1.1576018333435059
Epoch: 2, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.809 Vali Acc: 0.220 Test Loss: 1.809 Test Acc: 0.220
Validation loss decreased (-0.219981 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.1323676109313965
Epoch: 3, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.742 Vali Acc: 0.240 Test Loss: 1.742 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.1911780834197998
Epoch: 4, Steps: 4 | Train Loss: 1.406 Vali Loss: 1.720 Vali Acc: 0.260 Test Loss: 1.720 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.1491611003875732
Epoch: 5, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.665 Vali Acc: 0.200 Test Loss: 1.665 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1627802848815918
Epoch: 6, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.657 Vali Acc: 0.200 Test Loss: 1.657 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2729272842407227
Epoch: 7, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279983).  Saving model ...
Epoch: 8 cost time: 1.208897352218628
Epoch: 8, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.716 Vali Acc: 0.220 Test Loss: 1.716 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1526436805725098
Epoch: 9, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.792 Vali Acc: 0.240 Test Loss: 1.792 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1265788078308105
Epoch: 10, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.866 Vali Acc: 0.240 Test Loss: 1.866 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.1600897312164307
Epoch: 11, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.967 Vali Acc: 0.280 Test Loss: 1.967 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.253854513168335
Epoch: 12, Steps: 4 | Train Loss: 0.940 Vali Loss: 2.048 Vali Acc: 0.260 Test Loss: 2.048 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0272343158721924
Epoch: 13, Steps: 4 | Train Loss: 0.829 Vali Loss: 2.135 Vali Acc: 0.260 Test Loss: 2.135 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.0474729537963867
Epoch: 14, Steps: 4 | Train Loss: 0.652 Vali Loss: 2.200 Vali Acc: 0.240 Test Loss: 2.200 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.2054564952850342
Epoch: 15, Steps: 4 | Train Loss: 0.698 Vali Loss: 2.299 Vali Acc: 0.260 Test Loss: 2.299 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.0871918201446533
Epoch: 16, Steps: 4 | Train Loss: 0.705 Vali Loss: 2.384 Vali Acc: 0.260 Test Loss: 2.384 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.9549415111541748
Epoch: 17, Steps: 4 | Train Loss: 0.596 Vali Loss: 2.525 Vali Acc: 0.240 Test Loss: 2.525 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 491085
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.859116554260254
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.843 Vali Acc: 0.220 Test Loss: 1.843 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.0350348949432373
Epoch: 2, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.811 Vali Acc: 0.220 Test Loss: 1.811 Test Acc: 0.220
Validation loss decreased (-0.219982 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.2083961963653564
Epoch: 3, Steps: 4 | Train Loss: 1.602 Vali Loss: 1.759 Vali Acc: 0.220 Test Loss: 1.759 Test Acc: 0.220
Validation loss decreased (-0.219982 --> -0.219982).  Saving model ...
Epoch: 4 cost time: 1.0916495323181152
Epoch: 4, Steps: 4 | Train Loss: 1.455 Vali Loss: 1.720 Vali Acc: 0.200 Test Loss: 1.720 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0763041973114014
Epoch: 5, Steps: 4 | Train Loss: 1.425 Vali Loss: 1.680 Vali Acc: 0.180 Test Loss: 1.680 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1398372650146484
Epoch: 6, Steps: 4 | Train Loss: 1.362 Vali Loss: 1.679 Vali Acc: 0.260 Test Loss: 1.679 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 1.0304009914398193
Epoch: 7, Steps: 4 | Train Loss: 1.316 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0579760074615479
Epoch: 8, Steps: 4 | Train Loss: 1.242 Vali Loss: 1.710 Vali Acc: 0.240 Test Loss: 1.710 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1053211688995361
Epoch: 9, Steps: 4 | Train Loss: 1.072 Vali Loss: 1.753 Vali Acc: 0.240 Test Loss: 1.753 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1376903057098389
Epoch: 10, Steps: 4 | Train Loss: 1.073 Vali Loss: 1.802 Vali Acc: 0.240 Test Loss: 1.802 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1783881187438965
Epoch: 11, Steps: 4 | Train Loss: 1.021 Vali Loss: 1.871 Vali Acc: 0.240 Test Loss: 1.871 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1333677768707275
Epoch: 12, Steps: 4 | Train Loss: 1.018 Vali Loss: 1.942 Vali Acc: 0.260 Test Loss: 1.942 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0940840244293213
Epoch: 13, Steps: 4 | Train Loss: 0.896 Vali Loss: 2.027 Vali Acc: 0.280 Test Loss: 2.027 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279980).  Saving model ...
Epoch: 14 cost time: 1.1392455101013184
Epoch: 14, Steps: 4 | Train Loss: 0.681 Vali Loss: 2.083 Vali Acc: 0.240 Test Loss: 2.083 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0464859008789062
Epoch: 15, Steps: 4 | Train Loss: 0.742 Vali Loss: 2.171 Vali Acc: 0.240 Test Loss: 2.171 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1256320476531982
Epoch: 16, Steps: 4 | Train Loss: 0.727 Vali Loss: 2.272 Vali Acc: 0.260 Test Loss: 2.272 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.0709140300750732
Epoch: 17, Steps: 4 | Train Loss: 0.607 Vali Loss: 2.344 Vali Acc: 0.240 Test Loss: 2.344 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0185565948486328
Epoch: 18, Steps: 4 | Train Loss: 0.573 Vali Loss: 2.481 Vali Acc: 0.200 Test Loss: 2.481 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0278403759002686
Epoch: 19, Steps: 4 | Train Loss: 0.370 Vali Loss: 2.634 Vali Acc: 0.220 Test Loss: 2.634 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.040285348892212
Epoch: 20, Steps: 4 | Train Loss: 0.478 Vali Loss: 2.824 Vali Acc: 0.240 Test Loss: 2.824 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.010826826095581
Epoch: 21, Steps: 4 | Train Loss: 0.462 Vali Loss: 2.950 Vali Acc: 0.240 Test Loss: 2.950 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.146747350692749
Epoch: 22, Steps: 4 | Train Loss: 0.342 Vali Loss: 3.072 Vali Acc: 0.260 Test Loss: 3.072 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.1809523105621338
Epoch: 23, Steps: 4 | Train Loss: 0.238 Vali Loss: 3.229 Vali Acc: 0.260 Test Loss: 3.229 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 491085
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.879037618637085
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.799 Vali Acc: 0.180 Test Loss: 1.799 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 1.0613694190979004
Epoch: 2, Steps: 4 | Train Loss: 1.613 Vali Loss: 1.774 Vali Acc: 0.140 Test Loss: 1.774 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.073561429977417
Epoch: 3, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.726 Vali Acc: 0.200 Test Loss: 1.726 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 0.9951090812683105
Epoch: 4, Steps: 4 | Train Loss: 1.501 Vali Loss: 1.686 Vali Acc: 0.220 Test Loss: 1.686 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 1.242607593536377
Epoch: 5, Steps: 4 | Train Loss: 1.480 Vali Loss: 1.640 Vali Acc: 0.240 Test Loss: 1.640 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.0494840145111084
Epoch: 6, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.632 Vali Acc: 0.240 Test Loss: 1.632 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 7 cost time: 1.1802020072937012
Epoch: 7, Steps: 4 | Train Loss: 1.399 Vali Loss: 1.614 Vali Acc: 0.260 Test Loss: 1.614 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 8 cost time: 1.1136071681976318
Epoch: 8, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.621 Vali Acc: 0.260 Test Loss: 1.621 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.092473030090332
Epoch: 9, Steps: 4 | Train Loss: 1.154 Vali Loss: 1.650 Vali Acc: 0.240 Test Loss: 1.650 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0552215576171875
Epoch: 10, Steps: 4 | Train Loss: 1.143 Vali Loss: 1.673 Vali Acc: 0.240 Test Loss: 1.673 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.0931458473205566
Epoch: 11, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.710 Vali Acc: 0.240 Test Loss: 1.710 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.9593524932861328
Epoch: 12, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.743 Vali Acc: 0.320 Test Loss: 1.743 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319983).  Saving model ...
Epoch: 13 cost time: 0.9614498615264893
Epoch: 13, Steps: 4 | Train Loss: 0.972 Vali Loss: 1.781 Vali Acc: 0.300 Test Loss: 1.781 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.042940378189087
Epoch: 14, Steps: 4 | Train Loss: 0.783 Vali Loss: 1.825 Vali Acc: 0.280 Test Loss: 1.825 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9961111545562744
Epoch: 15, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.878 Vali Acc: 0.220 Test Loss: 1.878 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9770617485046387
Epoch: 16, Steps: 4 | Train Loss: 0.821 Vali Loss: 1.930 Vali Acc: 0.260 Test Loss: 1.930 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.0610227584838867
Epoch: 17, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.993 Vali Acc: 0.220 Test Loss: 1.993 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0467147827148438
Epoch: 18, Steps: 4 | Train Loss: 0.707 Vali Loss: 2.011 Vali Acc: 0.220 Test Loss: 2.011 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.016524076461792
Epoch: 19, Steps: 4 | Train Loss: 0.453 Vali Loss: 2.046 Vali Acc: 0.220 Test Loss: 2.046 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0517833232879639
Epoch: 20, Steps: 4 | Train Loss: 0.530 Vali Loss: 2.159 Vali Acc: 0.220 Test Loss: 2.159 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1066772937774658
Epoch: 21, Steps: 4 | Train Loss: 0.579 Vali Loss: 2.234 Vali Acc: 0.220 Test Loss: 2.234 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.954451322555542
Epoch: 22, Steps: 4 | Train Loss: 0.401 Vali Loss: 2.303 Vali Acc: 0.240 Test Loss: 2.303 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 491085
model size : 2.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.971784830093384
Epoch: 1, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.664 Vali Acc: 0.200 Test Loss: 1.664 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.0182249546051025
Epoch: 2, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.634 Vali Acc: 0.200 Test Loss: 1.634 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.0520765781402588
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.641 Vali Acc: 0.200 Test Loss: 1.641 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0219783782958984
Epoch: 4, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.619 Vali Acc: 0.220 Test Loss: 1.619 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 0.9109170436859131
Epoch: 5, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.607 Vali Acc: 0.240 Test Loss: 1.607 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 0.9758274555206299
Epoch: 6, Steps: 4 | Train Loss: 1.330 Vali Loss: 1.628 Vali Acc: 0.200 Test Loss: 1.628 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9356443881988525
Epoch: 7, Steps: 4 | Train Loss: 1.223 Vali Loss: 1.619 Vali Acc: 0.220 Test Loss: 1.619 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.8984920978546143
Epoch: 8, Steps: 4 | Train Loss: 1.068 Vali Loss: 1.659 Vali Acc: 0.220 Test Loss: 1.659 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0684049129486084
Epoch: 9, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.703 Vali Acc: 0.240 Test Loss: 1.703 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.150336503982544
Epoch: 10, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.766 Vali Acc: 0.300 Test Loss: 1.766 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299982).  Saving model ...
Epoch: 11 cost time: 1.1443583965301514
Epoch: 11, Steps: 4 | Train Loss: 0.844 Vali Loss: 1.862 Vali Acc: 0.300 Test Loss: 1.862 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.079766035079956
Epoch: 12, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.946 Vali Acc: 0.320 Test Loss: 1.946 Test Acc: 0.320
Validation loss decreased (-0.299982 --> -0.319981).  Saving model ...
Epoch: 13 cost time: 1.212653636932373
Epoch: 13, Steps: 4 | Train Loss: 0.884 Vali Loss: 2.055 Vali Acc: 0.240 Test Loss: 2.055 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1171238422393799
Epoch: 14, Steps: 4 | Train Loss: 0.628 Vali Loss: 2.159 Vali Acc: 0.240 Test Loss: 2.159 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.262606143951416
Epoch: 15, Steps: 4 | Train Loss: 0.547 Vali Loss: 2.266 Vali Acc: 0.240 Test Loss: 2.266 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1079790592193604
Epoch: 16, Steps: 4 | Train Loss: 0.589 Vali Loss: 2.361 Vali Acc: 0.240 Test Loss: 2.361 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.2008376121520996
Epoch: 17, Steps: 4 | Train Loss: 0.452 Vali Loss: 2.477 Vali Acc: 0.280 Test Loss: 2.477 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1085960865020752
Epoch: 18, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.598 Vali Acc: 0.300 Test Loss: 2.598 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0773091316223145
Epoch: 19, Steps: 4 | Train Loss: 0.341 Vali Loss: 2.753 Vali Acc: 0.320 Test Loss: 2.753 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1367013454437256
Epoch: 20, Steps: 4 | Train Loss: 0.458 Vali Loss: 2.924 Vali Acc: 0.300 Test Loss: 2.924 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1570823192596436
Epoch: 21, Steps: 4 | Train Loss: 0.304 Vali Loss: 3.054 Vali Acc: 0.280 Test Loss: 3.054 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1353890895843506
Epoch: 22, Steps: 4 | Train Loss: 0.272 Vali Loss: 3.203 Vali Acc: 0.260 Test Loss: 3.203 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 425549
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8571712970733643
Epoch: 1, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.649 Vali Acc: 0.220 Test Loss: 1.649 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 0.9758961200714111
Epoch: 2, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.634 Vali Acc: 0.260 Test Loss: 1.634 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 0.9995477199554443
Epoch: 3, Steps: 4 | Train Loss: 1.535 Vali Loss: 1.628 Vali Acc: 0.280 Test Loss: 1.628 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 0.9994025230407715
Epoch: 4, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.610 Vali Acc: 0.280 Test Loss: 1.610 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.0363788604736328
Epoch: 5, Steps: 4 | Train Loss: 1.263 Vali Loss: 1.606 Vali Acc: 0.260 Test Loss: 1.606 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.169903039932251
Epoch: 6, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.625 Vali Acc: 0.260 Test Loss: 1.625 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0286972522735596
Epoch: 7, Steps: 4 | Train Loss: 1.236 Vali Loss: 1.638 Vali Acc: 0.280 Test Loss: 1.638 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0695135593414307
Epoch: 8, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.667 Vali Acc: 0.260 Test Loss: 1.667 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1925020217895508
Epoch: 9, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.694 Vali Acc: 0.240 Test Loss: 1.694 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.118626356124878
Epoch: 10, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.764 Vali Acc: 0.280 Test Loss: 1.764 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1393589973449707
Epoch: 11, Steps: 4 | Train Loss: 0.854 Vali Loss: 1.862 Vali Acc: 0.280 Test Loss: 1.862 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.9886674880981445
Epoch: 12, Steps: 4 | Train Loss: 0.856 Vali Loss: 1.933 Vali Acc: 0.320 Test Loss: 1.933 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319981).  Saving model ...
Epoch: 13 cost time: 0.9870893955230713
Epoch: 13, Steps: 4 | Train Loss: 0.906 Vali Loss: 1.989 Vali Acc: 0.280 Test Loss: 1.989 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.0594754219055176
Epoch: 14, Steps: 4 | Train Loss: 0.659 Vali Loss: 2.064 Vali Acc: 0.280 Test Loss: 2.064 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1260488033294678
Epoch: 15, Steps: 4 | Train Loss: 0.568 Vali Loss: 2.167 Vali Acc: 0.280 Test Loss: 2.167 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.0466501712799072
Epoch: 16, Steps: 4 | Train Loss: 0.584 Vali Loss: 2.260 Vali Acc: 0.280 Test Loss: 2.260 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.026719093322754
Epoch: 17, Steps: 4 | Train Loss: 0.479 Vali Loss: 2.375 Vali Acc: 0.280 Test Loss: 2.375 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.0505387783050537
Epoch: 18, Steps: 4 | Train Loss: 0.430 Vali Loss: 2.584 Vali Acc: 0.300 Test Loss: 2.584 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.0427169799804688
Epoch: 19, Steps: 4 | Train Loss: 0.361 Vali Loss: 2.795 Vali Acc: 0.300 Test Loss: 2.795 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.032486915588379
Epoch: 20, Steps: 4 | Train Loss: 0.477 Vali Loss: 2.924 Vali Acc: 0.280 Test Loss: 2.924 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.0363223552703857
Epoch: 21, Steps: 4 | Train Loss: 0.320 Vali Loss: 3.010 Vali Acc: 0.260 Test Loss: 3.010 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9661877155303955
Epoch: 22, Steps: 4 | Train Loss: 0.288 Vali Loss: 3.187 Vali Acc: 0.240 Test Loss: 3.187 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 425549
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8407483100891113
Epoch: 1, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.669 Vali Acc: 0.320 Test Loss: 1.669 Test Acc: 0.320
Validation loss decreased (inf --> -0.319983).  Saving model ...
Epoch: 2 cost time: 0.9936602115631104
Epoch: 2, Steps: 4 | Train Loss: 1.628 Vali Loss: 1.662 Vali Acc: 0.280 Test Loss: 1.662 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1203854084014893
Epoch: 3, Steps: 4 | Train Loss: 1.501 Vali Loss: 1.644 Vali Acc: 0.300 Test Loss: 1.644 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0049219131469727
Epoch: 4, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.626 Vali Acc: 0.260 Test Loss: 1.626 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.03440523147583
Epoch: 5, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.620 Vali Acc: 0.280 Test Loss: 1.620 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.086338996887207
Epoch: 6, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.623 Vali Acc: 0.300 Test Loss: 1.623 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.0331807136535645
Epoch: 7, Steps: 4 | Train Loss: 1.239 Vali Loss: 1.608 Vali Acc: 0.260 Test Loss: 1.608 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 0.9291470050811768
Epoch: 8, Steps: 4 | Train Loss: 1.113 Vali Loss: 1.631 Vali Acc: 0.260 Test Loss: 1.631 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 0.969611406326294
Epoch: 9, Steps: 4 | Train Loss: 1.152 Vali Loss: 1.655 Vali Acc: 0.280 Test Loss: 1.655 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0450406074523926
Epoch: 10, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.699 Vali Acc: 0.300 Test Loss: 1.699 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.0959265232086182
Epoch: 11, Steps: 4 | Train Loss: 0.879 Vali Loss: 1.779 Vali Acc: 0.300 Test Loss: 1.779 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 425549
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.7170662879943848
Epoch: 1, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.708 Vali Acc: 0.100 Test Loss: 1.708 Test Acc: 0.100
Validation loss decreased (inf --> -0.099983).  Saving model ...
Epoch: 2 cost time: 0.983717679977417
Epoch: 2, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.696 Vali Acc: 0.080 Test Loss: 1.696 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0985593795776367
Epoch: 3, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.680 Vali Acc: 0.160 Test Loss: 1.680 Test Acc: 0.160
Validation loss decreased (-0.099983 --> -0.159983).  Saving model ...
Epoch: 4 cost time: 0.9973857402801514
Epoch: 4, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.664 Vali Acc: 0.240 Test Loss: 1.664 Test Acc: 0.240
Validation loss decreased (-0.159983 --> -0.239983).  Saving model ...
Epoch: 5 cost time: 0.9815478324890137
Epoch: 5, Steps: 4 | Train Loss: 1.357 Vali Loss: 1.653 Vali Acc: 0.200 Test Loss: 1.653 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.9997990131378174
Epoch: 6, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.656 Vali Acc: 0.200 Test Loss: 1.656 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0855543613433838
Epoch: 7, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.642 Vali Acc: 0.180 Test Loss: 1.642 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.124363660812378
Epoch: 8, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.657 Vali Acc: 0.180 Test Loss: 1.657 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0827357769012451
Epoch: 9, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.660 Vali Acc: 0.200 Test Loss: 1.660 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.221275806427002
Epoch: 10, Steps: 4 | Train Loss: 1.083 Vali Loss: 1.689 Vali Acc: 0.240 Test Loss: 1.689 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2019760608673096
Epoch: 11, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.742 Vali Acc: 0.220 Test Loss: 1.742 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0623257160186768
Epoch: 12, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.772 Vali Acc: 0.200 Test Loss: 1.772 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0665009021759033
Epoch: 13, Steps: 4 | Train Loss: 0.963 Vali Loss: 1.800 Vali Acc: 0.220 Test Loss: 1.800 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0239918231964111
Epoch: 14, Steps: 4 | Train Loss: 0.812 Vali Loss: 1.852 Vali Acc: 0.220 Test Loss: 1.852 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 425549
model size : 2.25MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1026313304901123
Epoch: 1, Steps: 4 | Train Loss: 1.652 Vali Loss: 1.654 Vali Acc: 0.180 Test Loss: 1.654 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.1412732601165771
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.616 Vali Acc: 0.200 Test Loss: 1.616 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 0.8877279758453369
Epoch: 3, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 0.9483208656311035
Epoch: 4, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.544 Vali Acc: 0.260 Test Loss: 1.544 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259985).  Saving model ...
Epoch: 5 cost time: 1.0521397590637207
Epoch: 5, Steps: 4 | Train Loss: 1.398 Vali Loss: 1.533 Vali Acc: 0.280 Test Loss: 1.533 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 0.9669723510742188
Epoch: 6, Steps: 4 | Train Loss: 1.242 Vali Loss: 1.558 Vali Acc: 0.300 Test Loss: 1.558 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.0279004573822021
Epoch: 7, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.602 Vali Acc: 0.280 Test Loss: 1.602 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0079193115234375
Epoch: 8, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.632 Vali Acc: 0.300 Test Loss: 1.632 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.99460768699646
Epoch: 9, Steps: 4 | Train Loss: 1.044 Vali Loss: 1.670 Vali Acc: 0.260 Test Loss: 1.670 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.9272575378417969
Epoch: 10, Steps: 4 | Train Loss: 0.895 Vali Loss: 1.727 Vali Acc: 0.220 Test Loss: 1.727 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1032700538635254
Epoch: 11, Steps: 4 | Train Loss: 0.826 Vali Loss: 1.773 Vali Acc: 0.240 Test Loss: 1.773 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1355040073394775
Epoch: 12, Steps: 4 | Train Loss: 0.772 Vali Loss: 1.815 Vali Acc: 0.260 Test Loss: 1.815 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.0295820236206055
Epoch: 13, Steps: 4 | Train Loss: 0.611 Vali Loss: 1.881 Vali Acc: 0.240 Test Loss: 1.881 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.3282678127288818
Epoch: 14, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.979 Vali Acc: 0.260 Test Loss: 1.979 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0997273921966553
Epoch: 15, Steps: 4 | Train Loss: 0.632 Vali Loss: 2.144 Vali Acc: 0.260 Test Loss: 2.144 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1156127452850342
Epoch: 16, Steps: 4 | Train Loss: 0.445 Vali Loss: 2.262 Vali Acc: 0.240 Test Loss: 2.262 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 392781
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9391589164733887
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.594 Vali Acc: 0.160 Test Loss: 1.594 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.1014926433563232
Epoch: 2, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.563 Vali Acc: 0.220 Test Loss: 1.563 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 0.8698182106018066
Epoch: 3, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.521 Vali Acc: 0.240 Test Loss: 1.521 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 4 cost time: 0.9719810485839844
Epoch: 4, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.496 Vali Acc: 0.260 Test Loss: 1.496 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 5 cost time: 1.0440027713775635
Epoch: 5, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.494 Vali Acc: 0.200 Test Loss: 1.494 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0036332607269287
Epoch: 6, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.532 Vali Acc: 0.300 Test Loss: 1.532 Test Acc: 0.300
Validation loss decreased (-0.259985 --> -0.299985).  Saving model ...
Epoch: 7 cost time: 1.0237493515014648
Epoch: 7, Steps: 4 | Train Loss: 1.260 Vali Loss: 1.564 Vali Acc: 0.260 Test Loss: 1.564 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.069401741027832
Epoch: 8, Steps: 4 | Train Loss: 1.156 Vali Loss: 1.580 Vali Acc: 0.200 Test Loss: 1.580 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.052259922027588
Epoch: 9, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.615 Vali Acc: 0.280 Test Loss: 1.615 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.1061294078826904
Epoch: 10, Steps: 4 | Train Loss: 0.927 Vali Loss: 1.661 Vali Acc: 0.260 Test Loss: 1.661 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1814565658569336
Epoch: 11, Steps: 4 | Train Loss: 0.855 Vali Loss: 1.708 Vali Acc: 0.260 Test Loss: 1.708 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2141456604003906
Epoch: 12, Steps: 4 | Train Loss: 0.811 Vali Loss: 1.756 Vali Acc: 0.220 Test Loss: 1.756 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1675074100494385
Epoch: 13, Steps: 4 | Train Loss: 0.648 Vali Loss: 1.837 Vali Acc: 0.280 Test Loss: 1.837 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.240022897720337
Epoch: 14, Steps: 4 | Train Loss: 0.662 Vali Loss: 1.946 Vali Acc: 0.260 Test Loss: 1.946 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.082925796508789
Epoch: 15, Steps: 4 | Train Loss: 0.659 Vali Loss: 2.084 Vali Acc: 0.240 Test Loss: 2.084 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.165876865386963
Epoch: 16, Steps: 4 | Train Loss: 0.475 Vali Loss: 2.193 Vali Acc: 0.240 Test Loss: 2.193 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 392781
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.898678779602051
Epoch: 1, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.578 Vali Acc: 0.160 Test Loss: 1.578 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.1396267414093018
Epoch: 2, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.553 Vali Acc: 0.160 Test Loss: 1.553 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.0521461963653564
Epoch: 3, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.521 Vali Acc: 0.200 Test Loss: 1.521 Test Acc: 0.200
Validation loss decreased (-0.159984 --> -0.199985).  Saving model ...
Epoch: 4 cost time: 1.2670626640319824
Epoch: 4, Steps: 4 | Train Loss: 1.475 Vali Loss: 1.509 Vali Acc: 0.200 Test Loss: 1.509 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 5 cost time: 1.1206774711608887
Epoch: 5, Steps: 4 | Train Loss: 1.463 Vali Loss: 1.501 Vali Acc: 0.200 Test Loss: 1.501 Test Acc: 0.200
Validation loss decreased (-0.199985 --> -0.199985).  Saving model ...
Epoch: 6 cost time: 1.1228878498077393
Epoch: 6, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.517 Vali Acc: 0.260 Test Loss: 1.517 Test Acc: 0.260
Validation loss decreased (-0.199985 --> -0.259985).  Saving model ...
Epoch: 7 cost time: 1.0843803882598877
Epoch: 7, Steps: 4 | Train Loss: 1.289 Vali Loss: 1.537 Vali Acc: 0.240 Test Loss: 1.537 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0881621837615967
Epoch: 8, Steps: 4 | Train Loss: 1.186 Vali Loss: 1.563 Vali Acc: 0.260 Test Loss: 1.563 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2265143394470215
Epoch: 9, Steps: 4 | Train Loss: 1.103 Vali Loss: 1.594 Vali Acc: 0.260 Test Loss: 1.594 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.094350814819336
Epoch: 10, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.638 Vali Acc: 0.240 Test Loss: 1.638 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.0604400634765625
Epoch: 11, Steps: 4 | Train Loss: 0.892 Vali Loss: 1.682 Vali Acc: 0.220 Test Loss: 1.682 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1653766632080078
Epoch: 12, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.762 Vali Acc: 0.200 Test Loss: 1.762 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.19024658203125
Epoch: 13, Steps: 4 | Train Loss: 0.682 Vali Loss: 1.833 Vali Acc: 0.260 Test Loss: 1.833 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.0777485370635986
Epoch: 14, Steps: 4 | Train Loss: 0.702 Vali Loss: 1.956 Vali Acc: 0.260 Test Loss: 1.956 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.0380926132202148
Epoch: 15, Steps: 4 | Train Loss: 0.705 Vali Loss: 2.056 Vali Acc: 0.240 Test Loss: 2.056 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.144416332244873
Epoch: 16, Steps: 4 | Train Loss: 0.522 Vali Loss: 2.190 Vali Acc: 0.240 Test Loss: 2.190 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 392781
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.858060598373413
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.589 Vali Acc: 0.220 Test Loss: 1.589 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 0.9667587280273438
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.568 Vali Acc: 0.200 Test Loss: 1.568 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0520761013031006
Epoch: 3, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.539 Vali Acc: 0.260 Test Loss: 1.539 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 0.9504890441894531
Epoch: 4, Steps: 4 | Train Loss: 1.481 Vali Loss: 1.532 Vali Acc: 0.280 Test Loss: 1.532 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 5 cost time: 1.0206024646759033
Epoch: 5, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.514 Vali Acc: 0.260 Test Loss: 1.514 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0346095561981201
Epoch: 6, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.518 Vali Acc: 0.180 Test Loss: 1.518 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9803972244262695
Epoch: 7, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.530 Vali Acc: 0.140 Test Loss: 1.530 Test Acc: 0.140
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0214102268218994
Epoch: 8, Steps: 4 | Train Loss: 1.240 Vali Loss: 1.541 Vali Acc: 0.160 Test Loss: 1.541 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0038642883300781
Epoch: 9, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.576 Vali Acc: 0.180 Test Loss: 1.576 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.0198431015014648
Epoch: 10, Steps: 4 | Train Loss: 1.049 Vali Loss: 1.593 Vali Acc: 0.280 Test Loss: 1.593 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9401893615722656
Epoch: 11, Steps: 4 | Train Loss: 0.976 Vali Loss: 1.629 Vali Acc: 0.260 Test Loss: 1.629 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.138695478439331
Epoch: 12, Steps: 4 | Train Loss: 0.939 Vali Loss: 1.663 Vali Acc: 0.260 Test Loss: 1.663 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0450022220611572
Epoch: 13, Steps: 4 | Train Loss: 0.766 Vali Loss: 1.728 Vali Acc: 0.220 Test Loss: 1.728 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.1717758178710938
Epoch: 14, Steps: 4 | Train Loss: 0.770 Vali Loss: 1.798 Vali Acc: 0.220 Test Loss: 1.798 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 392781
model size : 2.13MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8788528442382812
Epoch: 1, Steps: 4 | Train Loss: 1.672 Vali Loss: 1.627 Vali Acc: 0.120 Test Loss: 1.627 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.0361926555633545
Epoch: 2, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.609 Vali Acc: 0.120 Test Loss: 1.609 Test Acc: 0.120
Validation loss decreased (-0.119984 --> -0.119984).  Saving model ...
Epoch: 3 cost time: 0.990361213684082
Epoch: 3, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.590 Vali Acc: 0.160 Test Loss: 1.590 Test Acc: 0.160
Validation loss decreased (-0.119984 --> -0.159984).  Saving model ...
Epoch: 4 cost time: 1.1031239032745361
Epoch: 4, Steps: 4 | Train Loss: 1.483 Vali Loss: 1.581 Vali Acc: 0.160 Test Loss: 1.581 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 5 cost time: 1.1217520236968994
Epoch: 5, Steps: 4 | Train Loss: 1.198 Vali Loss: 1.575 Vali Acc: 0.240 Test Loss: 1.575 Test Acc: 0.240
Validation loss decreased (-0.159984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 0.9468021392822266
Epoch: 6, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.568 Vali Acc: 0.220 Test Loss: 1.568 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 0.9824957847595215
Epoch: 7, Steps: 4 | Train Loss: 0.967 Vali Loss: 1.576 Vali Acc: 0.240 Test Loss: 1.576 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9170589447021484
Epoch: 8, Steps: 4 | Train Loss: 1.161 Vali Loss: 1.594 Vali Acc: 0.280 Test Loss: 1.594 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279984).  Saving model ...
Epoch: 9 cost time: 0.9184694290161133
Epoch: 9, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9513146877288818
Epoch: 10, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.740 Vali Acc: 0.280 Test Loss: 1.740 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0201189517974854
Epoch: 11, Steps: 4 | Train Loss: 0.731 Vali Loss: 1.808 Vali Acc: 0.280 Test Loss: 1.808 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9890408515930176
Epoch: 12, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.907 Vali Acc: 0.260 Test Loss: 1.907 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0297019481658936
Epoch: 13, Steps: 4 | Train Loss: 0.768 Vali Loss: 1.994 Vali Acc: 0.240 Test Loss: 1.994 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.029757022857666
Epoch: 14, Steps: 4 | Train Loss: 0.643 Vali Loss: 2.065 Vali Acc: 0.240 Test Loss: 2.065 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.025956153869629
Epoch: 15, Steps: 4 | Train Loss: 0.710 Vali Loss: 2.149 Vali Acc: 0.240 Test Loss: 2.149 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.0677926540374756
Epoch: 16, Steps: 4 | Train Loss: 0.497 Vali Loss: 2.270 Vali Acc: 0.240 Test Loss: 2.270 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.0624058246612549
Epoch: 17, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.384 Vali Acc: 0.260 Test Loss: 2.384 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1106445789337158
Epoch: 18, Steps: 4 | Train Loss: 0.630 Vali Loss: 2.454 Vali Acc: 0.240 Test Loss: 2.454 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 376397
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8364994525909424
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.593 Vali Acc: 0.160 Test Loss: 1.593 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.0250399112701416
Epoch: 2, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.574 Vali Acc: 0.180 Test Loss: 1.574 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.0070459842681885
Epoch: 3, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.564 Vali Acc: 0.160 Test Loss: 1.564 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 0.9924032688140869
Epoch: 4, Steps: 4 | Train Loss: 1.479 Vali Loss: 1.562 Vali Acc: 0.160 Test Loss: 1.562 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 0.9575309753417969
Epoch: 5, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239985).  Saving model ...
Epoch: 6 cost time: 0.921220064163208
Epoch: 6, Steps: 4 | Train Loss: 1.327 Vali Loss: 1.564 Vali Acc: 0.220 Test Loss: 1.564 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0253605842590332
Epoch: 7, Steps: 4 | Train Loss: 0.975 Vali Loss: 1.560 Vali Acc: 0.220 Test Loss: 1.560 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 0.9268057346343994
Epoch: 8, Steps: 4 | Train Loss: 1.170 Vali Loss: 1.589 Vali Acc: 0.220 Test Loss: 1.589 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.037238597869873
Epoch: 9, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.654 Vali Acc: 0.240 Test Loss: 1.654 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.978764533996582
Epoch: 10, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.705 Vali Acc: 0.260 Test Loss: 1.705 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259983).  Saving model ...
Epoch: 11 cost time: 1.0499646663665771
Epoch: 11, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.805 Vali Acc: 0.240 Test Loss: 1.805 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0127887725830078
Epoch: 12, Steps: 4 | Train Loss: 0.871 Vali Loss: 1.896 Vali Acc: 0.260 Test Loss: 1.896 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.077120304107666
Epoch: 13, Steps: 4 | Train Loss: 0.794 Vali Loss: 2.005 Vali Acc: 0.240 Test Loss: 2.005 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.089397668838501
Epoch: 14, Steps: 4 | Train Loss: 0.681 Vali Loss: 2.074 Vali Acc: 0.220 Test Loss: 2.074 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0603928565979004
Epoch: 15, Steps: 4 | Train Loss: 0.741 Vali Loss: 2.176 Vali Acc: 0.200 Test Loss: 2.176 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1249706745147705
Epoch: 16, Steps: 4 | Train Loss: 0.520 Vali Loss: 2.261 Vali Acc: 0.180 Test Loss: 2.261 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0993456840515137
Epoch: 17, Steps: 4 | Train Loss: 0.569 Vali Loss: 2.338 Vali Acc: 0.240 Test Loss: 2.338 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.0071675777435303
Epoch: 18, Steps: 4 | Train Loss: 0.648 Vali Loss: 2.410 Vali Acc: 0.240 Test Loss: 2.410 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.0925462245941162
Epoch: 19, Steps: 4 | Train Loss: 0.484 Vali Loss: 2.584 Vali Acc: 0.220 Test Loss: 2.584 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.0741262435913086
Epoch: 20, Steps: 4 | Train Loss: 0.547 Vali Loss: 2.747 Vali Acc: 0.260 Test Loss: 2.747 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 376397
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8785109519958496
Epoch: 1, Steps: 4 | Train Loss: 1.668 Vali Loss: 1.623 Vali Acc: 0.160 Test Loss: 1.623 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.140331506729126
Epoch: 2, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.608 Vali Acc: 0.160 Test Loss: 1.608 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.0350189208984375
Epoch: 3, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.600 Vali Acc: 0.160 Test Loss: 1.600 Test Acc: 0.160
Validation loss decreased (-0.159984 --> -0.159984).  Saving model ...
Epoch: 4 cost time: 0.974822998046875
Epoch: 4, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.589 Vali Acc: 0.220 Test Loss: 1.589 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.0080578327178955
Epoch: 5, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.584 Vali Acc: 0.200 Test Loss: 1.584 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.0410971641540527
Epoch: 6, Steps: 4 | Train Loss: 1.368 Vali Loss: 1.574 Vali Acc: 0.180 Test Loss: 1.574 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 0.9514973163604736
Epoch: 7, Steps: 4 | Train Loss: 1.056 Vali Loss: 1.589 Vali Acc: 0.180 Test Loss: 1.589 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9243340492248535
Epoch: 8, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.623 Vali Acc: 0.200 Test Loss: 1.623 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0795354843139648
Epoch: 9, Steps: 4 | Train Loss: 1.175 Vali Loss: 1.677 Vali Acc: 0.180 Test Loss: 1.677 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9869322776794434
Epoch: 10, Steps: 4 | Train Loss: 0.958 Vali Loss: 1.766 Vali Acc: 0.200 Test Loss: 1.766 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.083855152130127
Epoch: 11, Steps: 4 | Train Loss: 0.785 Vali Loss: 1.855 Vali Acc: 0.200 Test Loss: 1.855 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.1005287170410156
Epoch: 12, Steps: 4 | Train Loss: 0.932 Vali Loss: 1.939 Vali Acc: 0.200 Test Loss: 1.939 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.042529821395874
Epoch: 13, Steps: 4 | Train Loss: 0.831 Vali Loss: 2.031 Vali Acc: 0.200 Test Loss: 2.031 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.0429301261901855
Epoch: 14, Steps: 4 | Train Loss: 0.721 Vali Loss: 2.090 Vali Acc: 0.220 Test Loss: 2.090 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.22
model parameter : 376397
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.0098540782928467
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.596 Vali Acc: 0.280 Test Loss: 1.596 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.0604474544525146
Epoch: 2, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.584 Vali Acc: 0.280 Test Loss: 1.584 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.069478988647461
Epoch: 3, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.566 Vali Acc: 0.280 Test Loss: 1.566 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.0563380718231201
Epoch: 4, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.554 Vali Acc: 0.260 Test Loss: 1.554 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.008120059967041
Epoch: 5, Steps: 4 | Train Loss: 1.276 Vali Loss: 1.535 Vali Acc: 0.280 Test Loss: 1.535 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 6 cost time: 1.1324594020843506
Epoch: 6, Steps: 4 | Train Loss: 1.409 Vali Loss: 1.529 Vali Acc: 0.240 Test Loss: 1.529 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0498390197753906
Epoch: 7, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.526 Vali Acc: 0.240 Test Loss: 1.526 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0247411727905273
Epoch: 8, Steps: 4 | Train Loss: 1.250 Vali Loss: 1.534 Vali Acc: 0.240 Test Loss: 1.534 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 0.9598705768585205
Epoch: 9, Steps: 4 | Train Loss: 1.244 Vali Loss: 1.546 Vali Acc: 0.220 Test Loss: 1.546 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 0.9772474765777588
Epoch: 10, Steps: 4 | Train Loss: 1.016 Vali Loss: 1.581 Vali Acc: 0.240 Test Loss: 1.581 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 0.9505431652069092
Epoch: 11, Steps: 4 | Train Loss: 0.854 Vali Loss: 1.619 Vali Acc: 0.260 Test Loss: 1.619 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 0.9128990173339844
Epoch: 12, Steps: 4 | Train Loss: 0.995 Vali Loss: 1.672 Vali Acc: 0.280 Test Loss: 1.672 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 0.9896972179412842
Epoch: 13, Steps: 4 | Train Loss: 0.918 Vali Loss: 1.746 Vali Acc: 0.280 Test Loss: 1.746 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.0430684089660645
Epoch: 14, Steps: 4 | Train Loss: 0.805 Vali Loss: 1.802 Vali Acc: 0.280 Test Loss: 1.802 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 0.9975712299346924
Epoch: 15, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.860 Vali Acc: 0.280 Test Loss: 1.860 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 376397
model size : 2.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.8571224212646484
Epoch: 1, Steps: 4 | Train Loss: 1.617 Vali Loss: 1.591 Vali Acc: 0.260 Test Loss: 1.591 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.0273418426513672
Epoch: 2, Steps: 4 | Train Loss: 1.675 Vali Loss: 1.593 Vali Acc: 0.260 Test Loss: 1.593 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.058290719985962
Epoch: 3, Steps: 4 | Train Loss: 1.449 Vali Loss: 1.620 Vali Acc: 0.280 Test Loss: 1.620 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 0.8583865165710449
Epoch: 4, Steps: 4 | Train Loss: 1.440 Vali Loss: 1.603 Vali Acc: 0.280 Test Loss: 1.603 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.0834698677062988
Epoch: 5, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.625 Vali Acc: 0.240 Test Loss: 1.625 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 0.8983535766601562
Epoch: 6, Steps: 4 | Train Loss: 1.143 Vali Loss: 1.654 Vali Acc: 0.240 Test Loss: 1.654 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0006844997406006
Epoch: 7, Steps: 4 | Train Loss: 1.302 Vali Loss: 1.697 Vali Acc: 0.240 Test Loss: 1.697 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 0.9150304794311523
Epoch: 8, Steps: 4 | Train Loss: 0.926 Vali Loss: 1.737 Vali Acc: 0.240 Test Loss: 1.737 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 0.8889157772064209
Epoch: 9, Steps: 4 | Train Loss: 0.972 Vali Loss: 1.780 Vali Acc: 0.240 Test Loss: 1.780 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 0.9424285888671875
Epoch: 10, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.823 Vali Acc: 0.200 Test Loss: 1.823 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 0.9570121765136719
Epoch: 11, Steps: 4 | Train Loss: 0.835 Vali Loss: 1.894 Vali Acc: 0.220 Test Loss: 1.894 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 0.8162040710449219
Epoch: 12, Steps: 4 | Train Loss: 0.749 Vali Loss: 2.000 Vali Acc: 0.200 Test Loss: 2.000 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 0.9555025100708008
Epoch: 13, Steps: 4 | Train Loss: 0.879 Vali Loss: 2.094 Vali Acc: 0.220 Test Loss: 2.094 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 0.8845837116241455
Epoch: 14, Steps: 4 | Train Loss: 0.606 Vali Loss: 2.164 Vali Acc: 0.220 Test Loss: 2.164 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 368205
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 2.9552574157714844
Epoch: 1, Steps: 4 | Train Loss: 1.614 Vali Loss: 1.616 Vali Acc: 0.220 Test Loss: 1.616 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0650725364685059
Epoch: 2, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 0.9964830875396729
Epoch: 3, Steps: 4 | Train Loss: 1.488 Vali Loss: 1.622 Vali Acc: 0.240 Test Loss: 1.622 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.1209089756011963
Epoch: 4, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.609 Vali Acc: 0.220 Test Loss: 1.609 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1859209537506104
Epoch: 5, Steps: 4 | Train Loss: 1.307 Vali Loss: 1.621 Vali Acc: 0.220 Test Loss: 1.621 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0234503746032715
Epoch: 6, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2025399208068848
Epoch: 7, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.656 Vali Acc: 0.240 Test Loss: 1.656 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2572929859161377
Epoch: 8, Steps: 4 | Train Loss: 0.963 Vali Loss: 1.698 Vali Acc: 0.240 Test Loss: 1.698 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.15034818649292
Epoch: 9, Steps: 4 | Train Loss: 1.009 Vali Loss: 1.739 Vali Acc: 0.240 Test Loss: 1.739 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1292915344238281
Epoch: 10, Steps: 4 | Train Loss: 1.007 Vali Loss: 1.784 Vali Acc: 0.220 Test Loss: 1.784 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.089794635772705
Epoch: 11, Steps: 4 | Train Loss: 0.846 Vali Loss: 1.884 Vali Acc: 0.240 Test Loss: 1.884 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.192889928817749
Epoch: 12, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.956 Vali Acc: 0.240 Test Loss: 1.956 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.0590472221374512
Epoch: 13, Steps: 4 | Train Loss: 0.891 Vali Loss: 2.029 Vali Acc: 0.240 Test Loss: 2.029 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 368205
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.039484739303589
Epoch: 1, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.622 Vali Acc: 0.220 Test Loss: 1.622 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1637167930603027
Epoch: 2, Steps: 4 | Train Loss: 1.663 Vali Loss: 1.630 Vali Acc: 0.220 Test Loss: 1.630 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1555049419403076
Epoch: 3, Steps: 4 | Train Loss: 1.493 Vali Loss: 1.643 Vali Acc: 0.200 Test Loss: 1.643 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2631025314331055
Epoch: 4, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.641 Vali Acc: 0.160 Test Loss: 1.641 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2196378707885742
Epoch: 5, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.649 Vali Acc: 0.180 Test Loss: 1.649 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2916171550750732
Epoch: 6, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.677 Vali Acc: 0.200 Test Loss: 1.677 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2598133087158203
Epoch: 7, Steps: 4 | Train Loss: 1.310 Vali Loss: 1.697 Vali Acc: 0.240 Test Loss: 1.697 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 8 cost time: 1.431419849395752
Epoch: 8, Steps: 4 | Train Loss: 0.993 Vali Loss: 1.692 Vali Acc: 0.240 Test Loss: 1.692 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239983).  Saving model ...
Epoch: 9 cost time: 1.4718496799468994
Epoch: 9, Steps: 4 | Train Loss: 1.042 Vali Loss: 1.719 Vali Acc: 0.240 Test Loss: 1.719 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4727280139923096
Epoch: 10, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.780 Vali Acc: 0.200 Test Loss: 1.780 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.5664784908294678
Epoch: 11, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.852 Vali Acc: 0.200 Test Loss: 1.852 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.614753007888794
Epoch: 12, Steps: 4 | Train Loss: 0.805 Vali Loss: 1.921 Vali Acc: 0.220 Test Loss: 1.921 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5226497650146484
Epoch: 13, Steps: 4 | Train Loss: 0.920 Vali Loss: 1.999 Vali Acc: 0.280 Test Loss: 1.999 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279980).  Saving model ...
Epoch: 14 cost time: 1.5337824821472168
Epoch: 14, Steps: 4 | Train Loss: 0.686 Vali Loss: 2.057 Vali Acc: 0.240 Test Loss: 2.057 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.546072244644165
Epoch: 15, Steps: 4 | Train Loss: 0.585 Vali Loss: 2.137 Vali Acc: 0.260 Test Loss: 2.137 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4151968955993652
Epoch: 16, Steps: 4 | Train Loss: 0.544 Vali Loss: 2.214 Vali Acc: 0.260 Test Loss: 2.214 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.422614336013794
Epoch: 17, Steps: 4 | Train Loss: 0.512 Vali Loss: 2.346 Vali Acc: 0.220 Test Loss: 2.346 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4821367263793945
Epoch: 18, Steps: 4 | Train Loss: 0.547 Vali Loss: 2.501 Vali Acc: 0.240 Test Loss: 2.501 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3642194271087646
Epoch: 19, Steps: 4 | Train Loss: 0.484 Vali Loss: 2.733 Vali Acc: 0.260 Test Loss: 2.733 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.3556652069091797
Epoch: 20, Steps: 4 | Train Loss: 0.359 Vali Loss: 2.980 Vali Acc: 0.180 Test Loss: 2.980 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3674910068511963
Epoch: 21, Steps: 4 | Train Loss: 0.370 Vali Loss: 3.123 Vali Acc: 0.180 Test Loss: 3.123 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2844579219818115
Epoch: 22, Steps: 4 | Train Loss: 0.330 Vali Loss: 3.235 Vali Acc: 0.220 Test Loss: 3.235 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4055120944976807
Epoch: 23, Steps: 4 | Train Loss: 0.269 Vali Loss: 3.377 Vali Acc: 0.240 Test Loss: 3.377 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 368205
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5721774101257324
Epoch: 1, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.590 Vali Acc: 0.180 Test Loss: 1.590 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.390899896621704
Epoch: 2, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.595 Vali Acc: 0.200 Test Loss: 1.595 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.3981525897979736
Epoch: 3, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4803533554077148
Epoch: 4, Steps: 4 | Train Loss: 1.506 Vali Loss: 1.615 Vali Acc: 0.180 Test Loss: 1.615 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4922780990600586
Epoch: 5, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.616 Vali Acc: 0.200 Test Loss: 1.616 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5328915119171143
Epoch: 6, Steps: 4 | Train Loss: 1.241 Vali Loss: 1.625 Vali Acc: 0.260 Test Loss: 1.625 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 7 cost time: 1.429262638092041
Epoch: 7, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.628 Vali Acc: 0.260 Test Loss: 1.628 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.428091049194336
Epoch: 8, Steps: 4 | Train Loss: 1.077 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4946582317352295
Epoch: 9, Steps: 4 | Train Loss: 1.111 Vali Loss: 1.650 Vali Acc: 0.220 Test Loss: 1.650 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2037336826324463
Epoch: 10, Steps: 4 | Train Loss: 1.145 Vali Loss: 1.672 Vali Acc: 0.220 Test Loss: 1.672 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.4306674003601074
Epoch: 11, Steps: 4 | Train Loss: 0.952 Vali Loss: 1.721 Vali Acc: 0.220 Test Loss: 1.721 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.403679609298706
Epoch: 12, Steps: 4 | Train Loss: 0.879 Vali Loss: 1.763 Vali Acc: 0.240 Test Loss: 1.763 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3902215957641602
Epoch: 13, Steps: 4 | Train Loss: 0.988 Vali Loss: 1.815 Vali Acc: 0.260 Test Loss: 1.815 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.220440149307251
Epoch: 14, Steps: 4 | Train Loss: 0.768 Vali Loss: 1.822 Vali Acc: 0.240 Test Loss: 1.822 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3678576946258545
Epoch: 15, Steps: 4 | Train Loss: 0.649 Vali Loss: 1.850 Vali Acc: 0.260 Test Loss: 1.850 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.4177465438842773
Epoch: 16, Steps: 4 | Train Loss: 0.624 Vali Loss: 1.871 Vali Acc: 0.280 Test Loss: 1.871 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279981).  Saving model ...
Epoch: 17 cost time: 1.3652796745300293
Epoch: 17, Steps: 4 | Train Loss: 0.590 Vali Loss: 1.915 Vali Acc: 0.260 Test Loss: 1.915 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3232269287109375
Epoch: 18, Steps: 4 | Train Loss: 0.628 Vali Loss: 1.983 Vali Acc: 0.280 Test Loss: 1.983 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3455238342285156
Epoch: 19, Steps: 4 | Train Loss: 0.546 Vali Loss: 2.077 Vali Acc: 0.280 Test Loss: 2.077 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.3442106246948242
Epoch: 20, Steps: 4 | Train Loss: 0.406 Vali Loss: 2.178 Vali Acc: 0.260 Test Loss: 2.178 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.358072280883789
Epoch: 21, Steps: 4 | Train Loss: 0.430 Vali Loss: 2.280 Vali Acc: 0.300 Test Loss: 2.280 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299977).  Saving model ...
Epoch: 22 cost time: 1.4810991287231445
Epoch: 22, Steps: 4 | Train Loss: 0.402 Vali Loss: 2.348 Vali Acc: 0.300 Test Loss: 2.348 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.4078030586242676
Epoch: 23, Steps: 4 | Train Loss: 0.320 Vali Loss: 2.377 Vali Acc: 0.280 Test Loss: 2.377 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4573144912719727
Epoch: 24, Steps: 4 | Train Loss: 0.282 Vali Loss: 2.325 Vali Acc: 0.260 Test Loss: 2.325 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3801374435424805
Epoch: 25, Steps: 4 | Train Loss: 0.312 Vali Loss: 2.358 Vali Acc: 0.280 Test Loss: 2.358 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.607475996017456
Epoch: 26, Steps: 4 | Train Loss: 0.358 Vali Loss: 2.382 Vali Acc: 0.260 Test Loss: 2.382 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3857903480529785
Epoch: 27, Steps: 4 | Train Loss: 0.195 Vali Loss: 2.448 Vali Acc: 0.260 Test Loss: 2.448 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.3611383438110352
Epoch: 28, Steps: 4 | Train Loss: 0.385 Vali Loss: 2.597 Vali Acc: 0.260 Test Loss: 2.597 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5377919673919678
Epoch: 29, Steps: 4 | Train Loss: 0.163 Vali Loss: 2.658 Vali Acc: 0.280 Test Loss: 2.658 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2737815380096436
Epoch: 30, Steps: 4 | Train Loss: 0.156 Vali Loss: 2.707 Vali Acc: 0.300 Test Loss: 2.707 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.3184006214141846
Epoch: 31, Steps: 4 | Train Loss: 0.121 Vali Loss: 2.747 Vali Acc: 0.300 Test Loss: 2.747 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 368205
model size : 2.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.599928379058838
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.542 Vali Acc: 0.280 Test Loss: 1.542 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.1990578174591064
Epoch: 2, Steps: 4 | Train Loss: 1.427 Vali Loss: 1.604 Vali Acc: 0.220 Test Loss: 1.604 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4299812316894531
Epoch: 3, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.725 Vali Acc: 0.200 Test Loss: 1.725 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.0913138389587402
Epoch: 4, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.870 Vali Acc: 0.240 Test Loss: 1.870 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3857715129852295
Epoch: 5, Steps: 4 | Train Loss: 0.693 Vali Loss: 2.074 Vali Acc: 0.280 Test Loss: 2.074 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3480134010314941
Epoch: 6, Steps: 4 | Train Loss: 0.576 Vali Loss: 2.293 Vali Acc: 0.280 Test Loss: 2.293 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.399773120880127
Epoch: 7, Steps: 4 | Train Loss: 0.522 Vali Loss: 2.474 Vali Acc: 0.280 Test Loss: 2.474 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3330128192901611
Epoch: 8, Steps: 4 | Train Loss: 0.669 Vali Loss: 2.768 Vali Acc: 0.280 Test Loss: 2.768 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2634611129760742
Epoch: 9, Steps: 4 | Train Loss: 0.363 Vali Loss: 2.904 Vali Acc: 0.260 Test Loss: 2.904 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4661164283752441
Epoch: 10, Steps: 4 | Train Loss: 0.325 Vali Loss: 2.924 Vali Acc: 0.260 Test Loss: 2.924 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3750827312469482
Epoch: 11, Steps: 4 | Train Loss: 0.158 Vali Loss: 3.255 Vali Acc: 0.260 Test Loss: 3.255 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 6767385
model size : 35.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.524937629699707
Epoch: 1, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.2382702827453613
Epoch: 2, Steps: 4 | Train Loss: 1.419 Vali Loss: 1.624 Vali Acc: 0.260 Test Loss: 1.624 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4230999946594238
Epoch: 3, Steps: 4 | Train Loss: 1.164 Vali Loss: 1.747 Vali Acc: 0.200 Test Loss: 1.747 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2457802295684814
Epoch: 4, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.839 Vali Acc: 0.220 Test Loss: 1.839 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.129685401916504
Epoch: 5, Steps: 4 | Train Loss: 0.733 Vali Loss: 2.044 Vali Acc: 0.260 Test Loss: 2.044 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.34281587600708
Epoch: 6, Steps: 4 | Train Loss: 0.615 Vali Loss: 2.255 Vali Acc: 0.280 Test Loss: 2.255 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279977).  Saving model ...
Epoch: 7 cost time: 1.3239872455596924
Epoch: 7, Steps: 4 | Train Loss: 0.567 Vali Loss: 2.396 Vali Acc: 0.260 Test Loss: 2.396 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.261167287826538
Epoch: 8, Steps: 4 | Train Loss: 0.705 Vali Loss: 2.679 Vali Acc: 0.260 Test Loss: 2.679 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3364381790161133
Epoch: 9, Steps: 4 | Train Loss: 0.428 Vali Loss: 2.849 Vali Acc: 0.260 Test Loss: 2.849 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3503808975219727
Epoch: 10, Steps: 4 | Train Loss: 0.352 Vali Loss: 2.922 Vali Acc: 0.260 Test Loss: 2.922 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3335585594177246
Epoch: 11, Steps: 4 | Train Loss: 0.186 Vali Loss: 3.262 Vali Acc: 0.240 Test Loss: 3.262 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.367337703704834
Epoch: 12, Steps: 4 | Train Loss: 0.196 Vali Loss: 3.710 Vali Acc: 0.200 Test Loss: 3.710 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.390167236328125
Epoch: 13, Steps: 4 | Train Loss: 0.149 Vali Loss: 4.303 Vali Acc: 0.240 Test Loss: 4.303 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.266554355621338
Epoch: 14, Steps: 4 | Train Loss: 0.094 Vali Loss: 4.377 Vali Acc: 0.240 Test Loss: 4.377 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3062598705291748
Epoch: 15, Steps: 4 | Train Loss: 0.111 Vali Loss: 5.810 Vali Acc: 0.300 Test Loss: 5.810 Test Acc: 0.300
Validation loss decreased (-0.279977 --> -0.299942).  Saving model ...
Epoch: 16 cost time: 1.369687557220459
Epoch: 16, Steps: 4 | Train Loss: 0.056 Vali Loss: 6.320 Vali Acc: 0.300 Test Loss: 6.320 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3742539882659912
Epoch: 17, Steps: 4 | Train Loss: 0.035 Vali Loss: 6.233 Vali Acc: 0.280 Test Loss: 6.233 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.327937364578247
Epoch: 18, Steps: 4 | Train Loss: 0.043 Vali Loss: 6.493 Vali Acc: 0.300 Test Loss: 6.493 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.457563877105713
Epoch: 19, Steps: 4 | Train Loss: 0.021 Vali Loss: 6.712 Vali Acc: 0.280 Test Loss: 6.712 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3616492748260498
Epoch: 20, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.718 Vali Acc: 0.260 Test Loss: 6.718 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.4413678646087646
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 7.373 Vali Acc: 0.200 Test Loss: 7.373 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4371027946472168
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.703 Vali Acc: 0.200 Test Loss: 6.703 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2885246276855469
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.351 Vali Acc: 0.220 Test Loss: 6.351 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3188226222991943
Epoch: 24, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.418 Vali Acc: 0.240 Test Loss: 6.418 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5093934535980225
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.651 Vali Acc: 0.240 Test Loss: 6.651 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 6767385
model size : 35.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.741779327392578
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.582 Vali Acc: 0.300 Test Loss: 1.582 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.4575202465057373
Epoch: 2, Steps: 4 | Train Loss: 1.447 Vali Loss: 1.635 Vali Acc: 0.220 Test Loss: 1.635 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5315907001495361
Epoch: 3, Steps: 4 | Train Loss: 1.252 Vali Loss: 1.702 Vali Acc: 0.180 Test Loss: 1.702 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.383795976638794
Epoch: 4, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.799 Vali Acc: 0.220 Test Loss: 1.799 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5229542255401611
Epoch: 5, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.926 Vali Acc: 0.220 Test Loss: 1.926 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.5048341751098633
Epoch: 6, Steps: 4 | Train Loss: 0.731 Vali Loss: 2.121 Vali Acc: 0.280 Test Loss: 2.121 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3705370426177979
Epoch: 7, Steps: 4 | Train Loss: 0.676 Vali Loss: 2.288 Vali Acc: 0.240 Test Loss: 2.288 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3702433109283447
Epoch: 8, Steps: 4 | Train Loss: 0.760 Vali Loss: 2.493 Vali Acc: 0.220 Test Loss: 2.493 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3954675197601318
Epoch: 9, Steps: 4 | Train Loss: 0.591 Vali Loss: 2.549 Vali Acc: 0.260 Test Loss: 2.549 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4839067459106445
Epoch: 10, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.708 Vali Acc: 0.260 Test Loss: 2.708 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.4446799755096436
Epoch: 11, Steps: 4 | Train Loss: 0.246 Vali Loss: 3.010 Vali Acc: 0.280 Test Loss: 3.010 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 6767385
model size : 35.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4911553859710693
Epoch: 1, Steps: 4 | Train Loss: 1.642 Vali Loss: 1.595 Vali Acc: 0.220 Test Loss: 1.595 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.250396728515625
Epoch: 2, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.642 Vali Acc: 0.200 Test Loss: 1.642 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1517019271850586
Epoch: 3, Steps: 4 | Train Loss: 1.295 Vali Loss: 1.680 Vali Acc: 0.200 Test Loss: 1.680 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4527602195739746
Epoch: 4, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.731 Vali Acc: 0.200 Test Loss: 1.731 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.3020453453063965
Epoch: 5, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.837 Vali Acc: 0.240 Test Loss: 1.837 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239982).  Saving model ...
Epoch: 6 cost time: 1.3807933330535889
Epoch: 6, Steps: 4 | Train Loss: 0.842 Vali Loss: 2.012 Vali Acc: 0.240 Test Loss: 2.012 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3296124935150146
Epoch: 7, Steps: 4 | Train Loss: 0.789 Vali Loss: 2.117 Vali Acc: 0.200 Test Loss: 2.117 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3128442764282227
Epoch: 8, Steps: 4 | Train Loss: 0.831 Vali Loss: 2.180 Vali Acc: 0.200 Test Loss: 2.180 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.3828785419464111
Epoch: 9, Steps: 4 | Train Loss: 0.761 Vali Loss: 2.214 Vali Acc: 0.240 Test Loss: 2.214 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4106073379516602
Epoch: 10, Steps: 4 | Train Loss: 0.485 Vali Loss: 2.322 Vali Acc: 0.320 Test Loss: 2.322 Test Acc: 0.320
Validation loss decreased (-0.239982 --> -0.319977).  Saving model ...
Epoch: 11 cost time: 1.3163371086120605
Epoch: 11, Steps: 4 | Train Loss: 0.328 Vali Loss: 2.464 Vali Acc: 0.300 Test Loss: 2.464 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4465179443359375
Epoch: 12, Steps: 4 | Train Loss: 0.286 Vali Loss: 2.750 Vali Acc: 0.280 Test Loss: 2.750 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2583584785461426
Epoch: 13, Steps: 4 | Train Loss: 0.252 Vali Loss: 2.992 Vali Acc: 0.240 Test Loss: 2.992 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.366468906402588
Epoch: 14, Steps: 4 | Train Loss: 0.154 Vali Loss: 3.315 Vali Acc: 0.280 Test Loss: 3.315 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3315927982330322
Epoch: 15, Steps: 4 | Train Loss: 0.552 Vali Loss: 3.684 Vali Acc: 0.280 Test Loss: 3.684 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3459241390228271
Epoch: 16, Steps: 4 | Train Loss: 0.126 Vali Loss: 3.849 Vali Acc: 0.320 Test Loss: 3.849 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4209630489349365
Epoch: 17, Steps: 4 | Train Loss: 0.064 Vali Loss: 4.267 Vali Acc: 0.300 Test Loss: 4.267 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.4091403484344482
Epoch: 18, Steps: 4 | Train Loss: 0.060 Vali Loss: 4.170 Vali Acc: 0.300 Test Loss: 4.170 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4584171772003174
Epoch: 19, Steps: 4 | Train Loss: 0.020 Vali Loss: 4.591 Vali Acc: 0.280 Test Loss: 4.591 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5045228004455566
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 5.022 Vali Acc: 0.260 Test Loss: 5.022 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 6767385
model size : 35.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.930600881576538
Epoch: 1, Steps: 4 | Train Loss: 1.754 Vali Loss: 1.607 Vali Acc: 0.180 Test Loss: 1.607 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.3417541980743408
Epoch: 2, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.583 Vali Acc: 0.240 Test Loss: 1.583 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.855661153793335
Epoch: 3, Steps: 4 | Train Loss: 1.248 Vali Loss: 1.726 Vali Acc: 0.200 Test Loss: 1.726 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7204346656799316
Epoch: 4, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.938 Vali Acc: 0.280 Test Loss: 1.938 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 1.5851831436157227
Epoch: 5, Steps: 4 | Train Loss: 0.795 Vali Loss: 2.117 Vali Acc: 0.280 Test Loss: 2.117 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6599454879760742
Epoch: 6, Steps: 4 | Train Loss: 0.515 Vali Loss: 2.288 Vali Acc: 0.280 Test Loss: 2.288 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4019520282745361
Epoch: 7, Steps: 4 | Train Loss: 0.479 Vali Loss: 2.534 Vali Acc: 0.240 Test Loss: 2.534 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3222026824951172
Epoch: 8, Steps: 4 | Train Loss: 0.327 Vali Loss: 2.736 Vali Acc: 0.280 Test Loss: 2.736 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.7747142314910889
Epoch: 9, Steps: 4 | Train Loss: 0.364 Vali Loss: 3.078 Vali Acc: 0.260 Test Loss: 3.078 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.6929559707641602
Epoch: 10, Steps: 4 | Train Loss: 0.241 Vali Loss: 3.090 Vali Acc: 0.280 Test Loss: 3.090 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.637817621231079
Epoch: 11, Steps: 4 | Train Loss: 0.194 Vali Loss: 3.107 Vali Acc: 0.280 Test Loss: 3.107 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5823335647583008
Epoch: 12, Steps: 4 | Train Loss: 0.175 Vali Loss: 3.680 Vali Acc: 0.300 Test Loss: 3.680 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299963).  Saving model ...
Epoch: 13 cost time: 1.602015733718872
Epoch: 13, Steps: 4 | Train Loss: 0.124 Vali Loss: 4.111 Vali Acc: 0.260 Test Loss: 4.111 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.731316328048706
Epoch: 14, Steps: 4 | Train Loss: 0.107 Vali Loss: 4.137 Vali Acc: 0.320 Test Loss: 4.137 Test Acc: 0.320
Validation loss decreased (-0.299963 --> -0.319959).  Saving model ...
Epoch: 15 cost time: 1.5329787731170654
Epoch: 15, Steps: 4 | Train Loss: 0.084 Vali Loss: 5.107 Vali Acc: 0.320 Test Loss: 5.107 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6892716884613037
Epoch: 16, Steps: 4 | Train Loss: 0.047 Vali Loss: 5.524 Vali Acc: 0.280 Test Loss: 5.524 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7044317722320557
Epoch: 17, Steps: 4 | Train Loss: 0.040 Vali Loss: 6.167 Vali Acc: 0.260 Test Loss: 6.167 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.804741382598877
Epoch: 18, Steps: 4 | Train Loss: 0.043 Vali Loss: 6.962 Vali Acc: 0.220 Test Loss: 6.962 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.633147954940796
Epoch: 19, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.921 Vali Acc: 0.220 Test Loss: 6.921 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5625627040863037
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 7.035 Vali Acc: 0.240 Test Loss: 7.035 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8322052955627441
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.449 Vali Acc: 0.220 Test Loss: 7.449 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.529550552368164
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.741 Vali Acc: 0.200 Test Loss: 7.741 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6358706951141357
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.022 Vali Acc: 0.220 Test Loss: 8.022 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.4274048805236816
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.337 Vali Acc: 0.260 Test Loss: 8.337 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 5718809
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8773860931396484
Epoch: 1, Steps: 4 | Train Loss: 1.692 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.5157783031463623
Epoch: 2, Steps: 4 | Train Loss: 1.347 Vali Loss: 1.563 Vali Acc: 0.240 Test Loss: 1.563 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.5175061225891113
Epoch: 3, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.676 Vali Acc: 0.180 Test Loss: 1.676 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4562089443206787
Epoch: 4, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.892 Vali Acc: 0.280 Test Loss: 1.892 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 1.517329216003418
Epoch: 5, Steps: 4 | Train Loss: 0.849 Vali Loss: 2.078 Vali Acc: 0.240 Test Loss: 2.078 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3687381744384766
Epoch: 6, Steps: 4 | Train Loss: 0.565 Vali Loss: 2.212 Vali Acc: 0.260 Test Loss: 2.212 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4189636707305908
Epoch: 7, Steps: 4 | Train Loss: 0.548 Vali Loss: 2.434 Vali Acc: 0.240 Test Loss: 2.434 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.397369384765625
Epoch: 8, Steps: 4 | Train Loss: 0.368 Vali Loss: 2.673 Vali Acc: 0.280 Test Loss: 2.673 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4344151020050049
Epoch: 9, Steps: 4 | Train Loss: 0.401 Vali Loss: 2.959 Vali Acc: 0.280 Test Loss: 2.959 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5304102897644043
Epoch: 10, Steps: 4 | Train Loss: 0.279 Vali Loss: 3.005 Vali Acc: 0.280 Test Loss: 3.005 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.46535325050354
Epoch: 11, Steps: 4 | Train Loss: 0.229 Vali Loss: 3.014 Vali Acc: 0.300 Test Loss: 3.014 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299970).  Saving model ...
Epoch: 12 cost time: 1.4286909103393555
Epoch: 12, Steps: 4 | Train Loss: 0.237 Vali Loss: 3.562 Vali Acc: 0.320 Test Loss: 3.562 Test Acc: 0.320
Validation loss decreased (-0.299970 --> -0.319964).  Saving model ...
Epoch: 13 cost time: 1.483466386795044
Epoch: 13, Steps: 4 | Train Loss: 0.154 Vali Loss: 4.047 Vali Acc: 0.320 Test Loss: 4.047 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4019222259521484
Epoch: 14, Steps: 4 | Train Loss: 0.125 Vali Loss: 4.053 Vali Acc: 0.300 Test Loss: 4.053 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4808204174041748
Epoch: 15, Steps: 4 | Train Loss: 0.104 Vali Loss: 5.074 Vali Acc: 0.320 Test Loss: 5.074 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5742063522338867
Epoch: 16, Steps: 4 | Train Loss: 0.055 Vali Loss: 5.391 Vali Acc: 0.260 Test Loss: 5.391 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4363315105438232
Epoch: 17, Steps: 4 | Train Loss: 0.043 Vali Loss: 6.497 Vali Acc: 0.260 Test Loss: 6.497 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4499249458312988
Epoch: 18, Steps: 4 | Train Loss: 0.131 Vali Loss: 7.142 Vali Acc: 0.260 Test Loss: 7.142 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3582589626312256
Epoch: 19, Steps: 4 | Train Loss: 0.011 Vali Loss: 6.911 Vali Acc: 0.300 Test Loss: 6.911 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5530366897583008
Epoch: 20, Steps: 4 | Train Loss: 0.017 Vali Loss: 6.788 Vali Acc: 0.280 Test Loss: 6.788 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.440690517425537
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.950 Vali Acc: 0.220 Test Loss: 6.950 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.5659847259521484
Epoch: 22, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.231 Vali Acc: 0.200 Test Loss: 7.231 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 5718809
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8150253295898438
Epoch: 1, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.612 Vali Acc: 0.200 Test Loss: 1.612 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.4431800842285156
Epoch: 2, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.562 Vali Acc: 0.200 Test Loss: 1.562 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.5555400848388672
Epoch: 3, Steps: 4 | Train Loss: 1.322 Vali Loss: 1.638 Vali Acc: 0.240 Test Loss: 1.638 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.264291524887085
Epoch: 4, Steps: 4 | Train Loss: 1.104 Vali Loss: 1.858 Vali Acc: 0.280 Test Loss: 1.858 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 1.327232837677002
Epoch: 5, Steps: 4 | Train Loss: 0.923 Vali Loss: 2.004 Vali Acc: 0.220 Test Loss: 2.004 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.271956443786621
Epoch: 6, Steps: 4 | Train Loss: 0.611 Vali Loss: 2.110 Vali Acc: 0.260 Test Loss: 2.110 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3670060634613037
Epoch: 7, Steps: 4 | Train Loss: 0.644 Vali Loss: 2.323 Vali Acc: 0.220 Test Loss: 2.323 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.392646312713623
Epoch: 8, Steps: 4 | Train Loss: 0.425 Vali Loss: 2.535 Vali Acc: 0.240 Test Loss: 2.535 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5567231178283691
Epoch: 9, Steps: 4 | Train Loss: 0.462 Vali Loss: 2.829 Vali Acc: 0.260 Test Loss: 2.829 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5874340534210205
Epoch: 10, Steps: 4 | Train Loss: 0.339 Vali Loss: 2.865 Vali Acc: 0.280 Test Loss: 2.865 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.510890007019043
Epoch: 11, Steps: 4 | Train Loss: 0.283 Vali Loss: 2.830 Vali Acc: 0.260 Test Loss: 2.830 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.5721898078918457
Epoch: 12, Steps: 4 | Train Loss: 0.301 Vali Loss: 3.290 Vali Acc: 0.280 Test Loss: 3.290 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4526469707489014
Epoch: 13, Steps: 4 | Train Loss: 0.224 Vali Loss: 3.735 Vali Acc: 0.320 Test Loss: 3.735 Test Acc: 0.320
Validation loss decreased (-0.279981 --> -0.319963).  Saving model ...
Epoch: 14 cost time: 1.7019765377044678
Epoch: 14, Steps: 4 | Train Loss: 0.185 Vali Loss: 3.794 Vali Acc: 0.280 Test Loss: 3.794 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7632148265838623
Epoch: 15, Steps: 4 | Train Loss: 0.128 Vali Loss: 4.657 Vali Acc: 0.320 Test Loss: 4.657 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7904911041259766
Epoch: 16, Steps: 4 | Train Loss: 0.074 Vali Loss: 5.345 Vali Acc: 0.300 Test Loss: 5.345 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.8010423183441162
Epoch: 17, Steps: 4 | Train Loss: 0.048 Vali Loss: 6.296 Vali Acc: 0.260 Test Loss: 6.296 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5845158100128174
Epoch: 18, Steps: 4 | Train Loss: 0.254 Vali Loss: 6.443 Vali Acc: 0.300 Test Loss: 6.443 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.7476155757904053
Epoch: 19, Steps: 4 | Train Loss: 0.029 Vali Loss: 6.021 Vali Acc: 0.300 Test Loss: 6.021 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6336724758148193
Epoch: 20, Steps: 4 | Train Loss: 0.018 Vali Loss: 6.339 Vali Acc: 0.260 Test Loss: 6.339 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.023035764694214
Epoch: 21, Steps: 4 | Train Loss: 0.010 Vali Loss: 7.003 Vali Acc: 0.300 Test Loss: 7.003 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.798919439315796
Epoch: 22, Steps: 4 | Train Loss: 0.007 Vali Loss: 7.595 Vali Acc: 0.280 Test Loss: 7.595 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.8423714637756348
Epoch: 23, Steps: 4 | Train Loss: 0.005 Vali Loss: 8.056 Vali Acc: 0.300 Test Loss: 8.056 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 5718809
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.286423206329346
Epoch: 1, Steps: 4 | Train Loss: 1.651 Vali Loss: 1.609 Vali Acc: 0.240 Test Loss: 1.609 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.4139807224273682
Epoch: 2, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.584 Vali Acc: 0.220 Test Loss: 1.584 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.82338285446167
Epoch: 3, Steps: 4 | Train Loss: 1.380 Vali Loss: 1.623 Vali Acc: 0.240 Test Loss: 1.623 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.5417277812957764
Epoch: 4, Steps: 4 | Train Loss: 1.160 Vali Loss: 1.803 Vali Acc: 0.260 Test Loss: 1.803 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 5 cost time: 1.4300782680511475
Epoch: 5, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.916 Vali Acc: 0.240 Test Loss: 1.916 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4686033725738525
Epoch: 6, Steps: 4 | Train Loss: 0.708 Vali Loss: 1.948 Vali Acc: 0.220 Test Loss: 1.948 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.5349793434143066
Epoch: 7, Steps: 4 | Train Loss: 0.798 Vali Loss: 2.138 Vali Acc: 0.240 Test Loss: 2.138 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5138540267944336
Epoch: 8, Steps: 4 | Train Loss: 0.504 Vali Loss: 2.259 Vali Acc: 0.240 Test Loss: 2.259 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.4943373203277588
Epoch: 9, Steps: 4 | Train Loss: 0.525 Vali Loss: 2.463 Vali Acc: 0.220 Test Loss: 2.463 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.4591834545135498
Epoch: 10, Steps: 4 | Train Loss: 0.418 Vali Loss: 2.555 Vali Acc: 0.280 Test Loss: 2.555 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279974).  Saving model ...
Epoch: 11 cost time: 1.4851183891296387
Epoch: 11, Steps: 4 | Train Loss: 0.346 Vali Loss: 2.504 Vali Acc: 0.260 Test Loss: 2.504 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4239978790283203
Epoch: 12, Steps: 4 | Train Loss: 0.396 Vali Loss: 2.766 Vali Acc: 0.280 Test Loss: 2.766 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3731143474578857
Epoch: 13, Steps: 4 | Train Loss: 0.297 Vali Loss: 2.963 Vali Acc: 0.300 Test Loss: 2.963 Test Acc: 0.300
Validation loss decreased (-0.279974 --> -0.299970).  Saving model ...
Epoch: 14 cost time: 1.4809134006500244
Epoch: 14, Steps: 4 | Train Loss: 0.219 Vali Loss: 2.975 Vali Acc: 0.260 Test Loss: 2.975 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4483709335327148
Epoch: 15, Steps: 4 | Train Loss: 0.150 Vali Loss: 3.231 Vali Acc: 0.260 Test Loss: 3.231 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3893072605133057
Epoch: 16, Steps: 4 | Train Loss: 0.086 Vali Loss: 3.714 Vali Acc: 0.260 Test Loss: 3.714 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3549909591674805
Epoch: 17, Steps: 4 | Train Loss: 0.064 Vali Loss: 4.333 Vali Acc: 0.300 Test Loss: 4.333 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5090365409851074
Epoch: 18, Steps: 4 | Train Loss: 0.257 Vali Loss: 4.629 Vali Acc: 0.280 Test Loss: 4.629 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4865248203277588
Epoch: 19, Steps: 4 | Train Loss: 0.062 Vali Loss: 4.315 Vali Acc: 0.260 Test Loss: 4.315 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6029202938079834
Epoch: 20, Steps: 4 | Train Loss: 0.028 Vali Loss: 5.081 Vali Acc: 0.300 Test Loss: 5.081 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5213985443115234
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.600 Vali Acc: 0.340 Test Loss: 5.600 Test Acc: 0.340
Validation loss decreased (-0.299970 --> -0.339944).  Saving model ...
Epoch: 22 cost time: 1.569490909576416
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.902 Vali Acc: 0.340 Test Loss: 5.902 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5701282024383545
Epoch: 23, Steps: 4 | Train Loss: 0.017 Vali Loss: 6.175 Vali Acc: 0.320 Test Loss: 6.175 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.401076078414917
Epoch: 24, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.377 Vali Acc: 0.340 Test Loss: 6.377 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.5145437717437744
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.597 Vali Acc: 0.340 Test Loss: 6.597 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.4936835765838623
Epoch: 26, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.686 Vali Acc: 0.320 Test Loss: 6.686 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.675205945968628
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.748 Vali Acc: 0.300 Test Loss: 6.748 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.6609869003295898
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.743 Vali Acc: 0.300 Test Loss: 6.743 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.4753696918487549
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.767 Vali Acc: 0.300 Test Loss: 6.767 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.71488356590271
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.794 Vali Acc: 0.300 Test Loss: 6.794 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.4326469898223877
Epoch: 31, Steps: 4 | Train Loss: 0.000 Vali Loss: 6.821 Vali Acc: 0.300 Test Loss: 6.821 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 5718809
model size : 31.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.382333517074585
Epoch: 1, Steps: 4 | Train Loss: 1.759 Vali Loss: 1.655 Vali Acc: 0.240 Test Loss: 1.655 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.5375783443450928
Epoch: 2, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.543 Vali Acc: 0.240 Test Loss: 1.543 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.540283441543579
Epoch: 3, Steps: 4 | Train Loss: 1.294 Vali Loss: 1.734 Vali Acc: 0.200 Test Loss: 1.734 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3223035335540771
Epoch: 4, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.929 Vali Acc: 0.260 Test Loss: 1.929 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259981).  Saving model ...
Epoch: 5 cost time: 1.549121379852295
Epoch: 5, Steps: 4 | Train Loss: 0.693 Vali Loss: 1.980 Vali Acc: 0.260 Test Loss: 1.980 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.6075549125671387
Epoch: 6, Steps: 4 | Train Loss: 0.496 Vali Loss: 2.175 Vali Acc: 0.300 Test Loss: 2.175 Test Acc: 0.300
Validation loss decreased (-0.259981 --> -0.299978).  Saving model ...
Epoch: 7 cost time: 1.390807867050171
Epoch: 7, Steps: 4 | Train Loss: 0.526 Vali Loss: 2.403 Vali Acc: 0.320 Test Loss: 2.403 Test Acc: 0.320
Validation loss decreased (-0.299978 --> -0.319976).  Saving model ...
Epoch: 8 cost time: 1.3716483116149902
Epoch: 8, Steps: 4 | Train Loss: 0.339 Vali Loss: 2.824 Vali Acc: 0.240 Test Loss: 2.824 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.661442518234253
Epoch: 9, Steps: 4 | Train Loss: 0.478 Vali Loss: 2.861 Vali Acc: 0.300 Test Loss: 2.861 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.4662909507751465
Epoch: 10, Steps: 4 | Train Loss: 0.332 Vali Loss: 3.069 Vali Acc: 0.320 Test Loss: 3.069 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.666588544845581
Epoch: 11, Steps: 4 | Train Loss: 0.316 Vali Loss: 3.354 Vali Acc: 0.260 Test Loss: 3.354 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.6748814582824707
Epoch: 12, Steps: 4 | Train Loss: 0.112 Vali Loss: 3.776 Vali Acc: 0.260 Test Loss: 3.776 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.4049477577209473
Epoch: 13, Steps: 4 | Train Loss: 0.093 Vali Loss: 4.323 Vali Acc: 0.280 Test Loss: 4.323 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5785679817199707
Epoch: 14, Steps: 4 | Train Loss: 0.066 Vali Loss: 4.482 Vali Acc: 0.240 Test Loss: 4.482 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.6747441291809082
Epoch: 15, Steps: 4 | Train Loss: 0.150 Vali Loss: 5.221 Vali Acc: 0.280 Test Loss: 5.221 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.6472163200378418
Epoch: 16, Steps: 4 | Train Loss: 0.035 Vali Loss: 5.636 Vali Acc: 0.240 Test Loss: 5.636 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3730177879333496
Epoch: 17, Steps: 4 | Train Loss: 0.026 Vali Loss: 6.003 Vali Acc: 0.240 Test Loss: 6.003 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 5194521
model size : 29.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8656935691833496
Epoch: 1, Steps: 4 | Train Loss: 1.746 Vali Loss: 1.602 Vali Acc: 0.300 Test Loss: 1.602 Test Acc: 0.300
Validation loss decreased (inf --> -0.299984).  Saving model ...
Epoch: 2 cost time: 1.6051158905029297
Epoch: 2, Steps: 4 | Train Loss: 1.541 Vali Loss: 1.512 Vali Acc: 0.260 Test Loss: 1.512 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7140905857086182
Epoch: 3, Steps: 4 | Train Loss: 1.313 Vali Loss: 1.695 Vali Acc: 0.220 Test Loss: 1.695 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.6063063144683838
Epoch: 4, Steps: 4 | Train Loss: 1.020 Vali Loss: 1.878 Vali Acc: 0.280 Test Loss: 1.878 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.6535403728485107
Epoch: 5, Steps: 4 | Train Loss: 0.743 Vali Loss: 1.921 Vali Acc: 0.200 Test Loss: 1.921 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.512864351272583
Epoch: 6, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.094 Vali Acc: 0.280 Test Loss: 2.094 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.6083564758300781
Epoch: 7, Steps: 4 | Train Loss: 0.562 Vali Loss: 2.375 Vali Acc: 0.300 Test Loss: 2.375 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.7101092338562012
Epoch: 8, Steps: 4 | Train Loss: 0.361 Vali Loss: 2.788 Vali Acc: 0.200 Test Loss: 2.788 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.517099142074585
Epoch: 9, Steps: 4 | Train Loss: 0.491 Vali Loss: 2.876 Vali Acc: 0.260 Test Loss: 2.876 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5651600360870361
Epoch: 10, Steps: 4 | Train Loss: 0.345 Vali Loss: 3.079 Vali Acc: 0.300 Test Loss: 3.079 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5504741668701172
Epoch: 11, Steps: 4 | Train Loss: 0.318 Vali Loss: 3.406 Vali Acc: 0.280 Test Loss: 3.406 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 5194521
model size : 29.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.448751449584961
Epoch: 1, Steps: 4 | Train Loss: 1.743 Vali Loss: 1.602 Vali Acc: 0.280 Test Loss: 1.602 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.4669697284698486
Epoch: 2, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.532 Vali Acc: 0.280 Test Loss: 1.532 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.523993730545044
Epoch: 3, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.671 Vali Acc: 0.240 Test Loss: 1.671 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4227354526519775
Epoch: 4, Steps: 4 | Train Loss: 1.047 Vali Loss: 1.812 Vali Acc: 0.260 Test Loss: 1.812 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.6011416912078857
Epoch: 5, Steps: 4 | Train Loss: 0.801 Vali Loss: 1.816 Vali Acc: 0.220 Test Loss: 1.816 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.268502950668335
Epoch: 6, Steps: 4 | Train Loss: 0.593 Vali Loss: 1.971 Vali Acc: 0.300 Test Loss: 1.971 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299980).  Saving model ...
Epoch: 7 cost time: 1.332169532775879
Epoch: 7, Steps: 4 | Train Loss: 0.617 Vali Loss: 2.268 Vali Acc: 0.240 Test Loss: 2.268 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4882636070251465
Epoch: 8, Steps: 4 | Train Loss: 0.402 Vali Loss: 2.647 Vali Acc: 0.220 Test Loss: 2.647 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3490467071533203
Epoch: 9, Steps: 4 | Train Loss: 0.552 Vali Loss: 2.770 Vali Acc: 0.260 Test Loss: 2.770 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3780832290649414
Epoch: 10, Steps: 4 | Train Loss: 0.425 Vali Loss: 3.060 Vali Acc: 0.300 Test Loss: 3.060 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.446141004562378
Epoch: 11, Steps: 4 | Train Loss: 0.382 Vali Loss: 3.444 Vali Acc: 0.280 Test Loss: 3.444 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.5110056400299072
Epoch: 12, Steps: 4 | Train Loss: 0.162 Vali Loss: 3.813 Vali Acc: 0.280 Test Loss: 3.813 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.3625218868255615
Epoch: 13, Steps: 4 | Train Loss: 0.162 Vali Loss: 4.480 Vali Acc: 0.320 Test Loss: 4.480 Test Acc: 0.320
Validation loss decreased (-0.299980 --> -0.319955).  Saving model ...
Epoch: 14 cost time: 1.6601498126983643
Epoch: 14, Steps: 4 | Train Loss: 0.113 Vali Loss: 4.720 Vali Acc: 0.340 Test Loss: 4.720 Test Acc: 0.340
Validation loss decreased (-0.319955 --> -0.339953).  Saving model ...
Epoch: 15 cost time: 1.5365064144134521
Epoch: 15, Steps: 4 | Train Loss: 0.244 Vali Loss: 5.770 Vali Acc: 0.340 Test Loss: 5.770 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6377947330474854
Epoch: 16, Steps: 4 | Train Loss: 0.060 Vali Loss: 6.435 Vali Acc: 0.300 Test Loss: 6.435 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6000514030456543
Epoch: 17, Steps: 4 | Train Loss: 0.049 Vali Loss: 6.559 Vali Acc: 0.300 Test Loss: 6.559 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.613905668258667
Epoch: 18, Steps: 4 | Train Loss: 0.030 Vali Loss: 6.785 Vali Acc: 0.300 Test Loss: 6.785 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.6809310913085938
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.365 Vali Acc: 0.320 Test Loss: 6.365 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.5190255641937256
Epoch: 20, Steps: 4 | Train Loss: 0.011 Vali Loss: 6.725 Vali Acc: 0.280 Test Loss: 6.725 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5875251293182373
Epoch: 21, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.472 Vali Acc: 0.300 Test Loss: 7.472 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.5821290016174316
Epoch: 22, Steps: 4 | Train Loss: 0.005 Vali Loss: 7.819 Vali Acc: 0.300 Test Loss: 7.819 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.636031150817871
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.768 Vali Acc: 0.320 Test Loss: 7.768 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.5291705131530762
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.645 Vali Acc: 0.300 Test Loss: 7.645 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 5194521
model size : 29.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.760545492172241
Epoch: 1, Steps: 4 | Train Loss: 1.752 Vali Loss: 1.663 Vali Acc: 0.260 Test Loss: 1.663 Test Acc: 0.260
Validation loss decreased (inf --> -0.259983).  Saving model ...
Epoch: 2 cost time: 1.409404993057251
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.612 Vali Acc: 0.260 Test Loss: 1.612 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.523242712020874
Epoch: 3, Steps: 4 | Train Loss: 1.353 Vali Loss: 1.670 Vali Acc: 0.220 Test Loss: 1.670 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3473026752471924
Epoch: 4, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.756 Vali Acc: 0.240 Test Loss: 1.756 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4301245212554932
Epoch: 5, Steps: 4 | Train Loss: 0.919 Vali Loss: 1.760 Vali Acc: 0.220 Test Loss: 1.760 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.39064621925354
Epoch: 6, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.840 Vali Acc: 0.260 Test Loss: 1.840 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2741725444793701
Epoch: 7, Steps: 4 | Train Loss: 0.690 Vali Loss: 2.096 Vali Acc: 0.200 Test Loss: 2.096 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2530419826507568
Epoch: 8, Steps: 4 | Train Loss: 0.488 Vali Loss: 2.330 Vali Acc: 0.200 Test Loss: 2.330 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3149170875549316
Epoch: 9, Steps: 4 | Train Loss: 0.669 Vali Loss: 2.348 Vali Acc: 0.260 Test Loss: 2.348 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2931602001190186
Epoch: 10, Steps: 4 | Train Loss: 0.525 Vali Loss: 2.537 Vali Acc: 0.320 Test Loss: 2.537 Test Acc: 0.320
Validation loss decreased (-0.259984 --> -0.319975).  Saving model ...
Epoch: 11 cost time: 1.1695716381072998
Epoch: 11, Steps: 4 | Train Loss: 0.444 Vali Loss: 2.706 Vali Acc: 0.240 Test Loss: 2.706 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1877946853637695
Epoch: 12, Steps: 4 | Train Loss: 0.235 Vali Loss: 2.792 Vali Acc: 0.260 Test Loss: 2.792 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.4231314659118652
Epoch: 13, Steps: 4 | Train Loss: 0.200 Vali Loss: 2.996 Vali Acc: 0.340 Test Loss: 2.996 Test Acc: 0.340
Validation loss decreased (-0.319975 --> -0.339970).  Saving model ...
Epoch: 14 cost time: 1.1985464096069336
Epoch: 14, Steps: 4 | Train Loss: 0.169 Vali Loss: 3.713 Vali Acc: 0.220 Test Loss: 3.713 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.238743543624878
Epoch: 15, Steps: 4 | Train Loss: 0.216 Vali Loss: 4.304 Vali Acc: 0.280 Test Loss: 4.304 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4307236671447754
Epoch: 16, Steps: 4 | Train Loss: 0.086 Vali Loss: 4.186 Vali Acc: 0.300 Test Loss: 4.186 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.207944393157959
Epoch: 17, Steps: 4 | Train Loss: 0.100 Vali Loss: 4.604 Vali Acc: 0.320 Test Loss: 4.604 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3078935146331787
Epoch: 18, Steps: 4 | Train Loss: 0.059 Vali Loss: 5.537 Vali Acc: 0.360 Test Loss: 5.537 Test Acc: 0.360
Validation loss decreased (-0.339970 --> -0.359945).  Saving model ...
Epoch: 19 cost time: 1.4744148254394531
Epoch: 19, Steps: 4 | Train Loss: 0.030 Vali Loss: 5.165 Vali Acc: 0.260 Test Loss: 5.165 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.4166617393493652
Epoch: 20, Steps: 4 | Train Loss: 0.020 Vali Loss: 5.639 Vali Acc: 0.280 Test Loss: 5.639 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4278218746185303
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.579 Vali Acc: 0.320 Test Loss: 6.579 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5365815162658691
Epoch: 22, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.475 Vali Acc: 0.280 Test Loss: 6.475 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.5350875854492188
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.559 Vali Acc: 0.240 Test Loss: 6.559 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.246208667755127
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.779 Vali Acc: 0.200 Test Loss: 6.779 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.3683140277862549
Epoch: 25, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.969 Vali Acc: 0.220 Test Loss: 6.969 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.5571880340576172
Epoch: 26, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.302 Vali Acc: 0.220 Test Loss: 7.302 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.4052011966705322
Epoch: 27, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.593 Vali Acc: 0.240 Test Loss: 7.593 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.473928451538086
Epoch: 28, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.696 Vali Acc: 0.260 Test Loss: 7.696 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 5194521
model size : 29.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8249621391296387
Epoch: 1, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.665 Vali Acc: 0.180 Test Loss: 1.665 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.452996015548706
Epoch: 2, Steps: 4 | Train Loss: 1.365 Vali Loss: 1.732 Vali Acc: 0.200 Test Loss: 1.732 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.402613878250122
Epoch: 3, Steps: 4 | Train Loss: 1.187 Vali Loss: 1.888 Vali Acc: 0.240 Test Loss: 1.888 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239981).  Saving model ...
Epoch: 4 cost time: 1.3252665996551514
Epoch: 4, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.948 Vali Acc: 0.300 Test Loss: 1.948 Test Acc: 0.300
Validation loss decreased (-0.239981 --> -0.299981).  Saving model ...
Epoch: 5 cost time: 1.541057825088501
Epoch: 5, Steps: 4 | Train Loss: 0.734 Vali Loss: 2.151 Vali Acc: 0.240 Test Loss: 2.151 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5109071731567383
Epoch: 6, Steps: 4 | Train Loss: 0.703 Vali Loss: 2.431 Vali Acc: 0.280 Test Loss: 2.431 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.470566749572754
Epoch: 7, Steps: 4 | Train Loss: 0.539 Vali Loss: 2.750 Vali Acc: 0.220 Test Loss: 2.750 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.5453593730926514
Epoch: 8, Steps: 4 | Train Loss: 0.562 Vali Loss: 2.820 Vali Acc: 0.280 Test Loss: 2.820 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.6993136405944824
Epoch: 9, Steps: 4 | Train Loss: 0.337 Vali Loss: 3.068 Vali Acc: 0.260 Test Loss: 3.068 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.5743365287780762
Epoch: 10, Steps: 4 | Train Loss: 0.198 Vali Loss: 3.338 Vali Acc: 0.220 Test Loss: 3.338 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.5064146518707275
Epoch: 11, Steps: 4 | Train Loss: 0.290 Vali Loss: 3.725 Vali Acc: 0.300 Test Loss: 3.725 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.520674228668213
Epoch: 12, Steps: 4 | Train Loss: 0.164 Vali Loss: 4.529 Vali Acc: 0.320 Test Loss: 4.529 Test Acc: 0.320
Validation loss decreased (-0.299981 --> -0.319955).  Saving model ...
Epoch: 13 cost time: 1.5107066631317139
Epoch: 13, Steps: 4 | Train Loss: 0.089 Vali Loss: 4.945 Vali Acc: 0.300 Test Loss: 4.945 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.613142967224121
Epoch: 14, Steps: 4 | Train Loss: 0.072 Vali Loss: 5.288 Vali Acc: 0.260 Test Loss: 5.288 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5678982734680176
Epoch: 15, Steps: 4 | Train Loss: 0.037 Vali Loss: 5.525 Vali Acc: 0.300 Test Loss: 5.525 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5239288806915283
Epoch: 16, Steps: 4 | Train Loss: 0.067 Vali Loss: 6.365 Vali Acc: 0.200 Test Loss: 6.365 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6393465995788574
Epoch: 17, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.466 Vali Acc: 0.240 Test Loss: 6.466 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7606749534606934
Epoch: 18, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.833 Vali Acc: 0.200 Test Loss: 6.833 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.5820443630218506
Epoch: 19, Steps: 4 | Train Loss: 0.005 Vali Loss: 7.275 Vali Acc: 0.200 Test Loss: 7.275 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5853407382965088
Epoch: 20, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.609 Vali Acc: 0.220 Test Loss: 7.609 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4136009216308594
Epoch: 21, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.814 Vali Acc: 0.220 Test Loss: 7.814 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.553091287612915
Epoch: 22, Steps: 4 | Train Loss: 0.002 Vali Loss: 8.002 Vali Acc: 0.220 Test Loss: 8.002 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4932377
model size : 28.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.3397581577301025
Epoch: 1, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.655 Vali Acc: 0.220 Test Loss: 1.655 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.5652267932891846
Epoch: 2, Steps: 4 | Train Loss: 1.362 Vali Loss: 1.713 Vali Acc: 0.200 Test Loss: 1.713 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.6634087562561035
Epoch: 3, Steps: 4 | Train Loss: 1.216 Vali Loss: 1.828 Vali Acc: 0.240 Test Loss: 1.828 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239982).  Saving model ...
Epoch: 4 cost time: 1.4171123504638672
Epoch: 4, Steps: 4 | Train Loss: 0.833 Vali Loss: 1.884 Vali Acc: 0.300 Test Loss: 1.884 Test Acc: 0.300
Validation loss decreased (-0.239982 --> -0.299981).  Saving model ...
Epoch: 5 cost time: 1.8428537845611572
Epoch: 5, Steps: 4 | Train Loss: 0.778 Vali Loss: 2.072 Vali Acc: 0.220 Test Loss: 2.072 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7169809341430664
Epoch: 6, Steps: 4 | Train Loss: 0.781 Vali Loss: 2.355 Vali Acc: 0.280 Test Loss: 2.355 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.791109323501587
Epoch: 7, Steps: 4 | Train Loss: 0.606 Vali Loss: 2.628 Vali Acc: 0.180 Test Loss: 2.628 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.7813704013824463
Epoch: 8, Steps: 4 | Train Loss: 0.628 Vali Loss: 2.669 Vali Acc: 0.280 Test Loss: 2.669 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.8974580764770508
Epoch: 9, Steps: 4 | Train Loss: 0.366 Vali Loss: 2.958 Vali Acc: 0.280 Test Loss: 2.958 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.795755386352539
Epoch: 10, Steps: 4 | Train Loss: 0.225 Vali Loss: 3.289 Vali Acc: 0.240 Test Loss: 3.289 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.778592586517334
Epoch: 11, Steps: 4 | Train Loss: 0.325 Vali Loss: 3.635 Vali Acc: 0.260 Test Loss: 3.635 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.6382877826690674
Epoch: 12, Steps: 4 | Train Loss: 0.198 Vali Loss: 4.130 Vali Acc: 0.300 Test Loss: 4.130 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.7221286296844482
Epoch: 13, Steps: 4 | Train Loss: 0.102 Vali Loss: 4.658 Vali Acc: 0.300 Test Loss: 4.658 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.823563814163208
Epoch: 14, Steps: 4 | Train Loss: 0.206 Vali Loss: 5.189 Vali Acc: 0.300 Test Loss: 5.189 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4932377
model size : 28.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.210038185119629
Epoch: 1, Steps: 4 | Train Loss: 1.678 Vali Loss: 1.632 Vali Acc: 0.220 Test Loss: 1.632 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3252408504486084
Epoch: 2, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.659 Vali Acc: 0.200 Test Loss: 1.659 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3602845668792725
Epoch: 3, Steps: 4 | Train Loss: 1.267 Vali Loss: 1.737 Vali Acc: 0.220 Test Loss: 1.737 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.556483268737793
Epoch: 4, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.801 Vali Acc: 0.220 Test Loss: 1.801 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2564959526062012
Epoch: 5, Steps: 4 | Train Loss: 0.849 Vali Loss: 1.911 Vali Acc: 0.260 Test Loss: 1.911 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259981).  Saving model ...
Epoch: 6 cost time: 1.3917787075042725
Epoch: 6, Steps: 4 | Train Loss: 0.866 Vali Loss: 2.160 Vali Acc: 0.300 Test Loss: 2.160 Test Acc: 0.300
Validation loss decreased (-0.259981 --> -0.299978).  Saving model ...
Epoch: 7 cost time: 1.531538724899292
Epoch: 7, Steps: 4 | Train Loss: 0.680 Vali Loss: 2.371 Vali Acc: 0.220 Test Loss: 2.371 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4671986103057861
Epoch: 8, Steps: 4 | Train Loss: 0.766 Vali Loss: 2.397 Vali Acc: 0.300 Test Loss: 2.397 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3513612747192383
Epoch: 9, Steps: 4 | Train Loss: 0.439 Vali Loss: 2.611 Vali Acc: 0.280 Test Loss: 2.611 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2707502841949463
Epoch: 10, Steps: 4 | Train Loss: 0.275 Vali Loss: 2.916 Vali Acc: 0.260 Test Loss: 2.916 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3515021800994873
Epoch: 11, Steps: 4 | Train Loss: 0.380 Vali Loss: 3.217 Vali Acc: 0.280 Test Loss: 3.217 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.257676601409912
Epoch: 12, Steps: 4 | Train Loss: 0.273 Vali Loss: 3.828 Vali Acc: 0.320 Test Loss: 3.828 Test Acc: 0.320
Validation loss decreased (-0.299978 --> -0.319962).  Saving model ...
Epoch: 13 cost time: 1.2930872440338135
Epoch: 13, Steps: 4 | Train Loss: 0.161 Vali Loss: 4.434 Vali Acc: 0.340 Test Loss: 4.434 Test Acc: 0.340
Validation loss decreased (-0.319962 --> -0.339956).  Saving model ...
Epoch: 14 cost time: 1.4535112380981445
Epoch: 14, Steps: 4 | Train Loss: 0.255 Vali Loss: 4.916 Vali Acc: 0.320 Test Loss: 4.916 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3093302249908447
Epoch: 15, Steps: 4 | Train Loss: 0.081 Vali Loss: 5.135 Vali Acc: 0.300 Test Loss: 5.135 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.4738953113555908
Epoch: 16, Steps: 4 | Train Loss: 0.176 Vali Loss: 5.524 Vali Acc: 0.260 Test Loss: 5.524 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.423194169998169
Epoch: 17, Steps: 4 | Train Loss: 0.039 Vali Loss: 5.604 Vali Acc: 0.300 Test Loss: 5.604 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.4278950691223145
Epoch: 18, Steps: 4 | Train Loss: 0.023 Vali Loss: 6.250 Vali Acc: 0.260 Test Loss: 6.250 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.3793165683746338
Epoch: 19, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.898 Vali Acc: 0.260 Test Loss: 6.898 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.4260625839233398
Epoch: 20, Steps: 4 | Train Loss: 0.019 Vali Loss: 6.824 Vali Acc: 0.240 Test Loss: 6.824 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.53574538230896
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.740 Vali Acc: 0.220 Test Loss: 6.740 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4128177165985107
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 7.108 Vali Acc: 0.240 Test Loss: 7.108 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4493041038513184
Epoch: 23, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.889 Vali Acc: 0.280 Test Loss: 7.889 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4932377
model size : 28.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.158488988876343
Epoch: 1, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.644 Vali Acc: 0.220 Test Loss: 1.644 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.4243528842926025
Epoch: 2, Steps: 4 | Train Loss: 1.405 Vali Loss: 1.655 Vali Acc: 0.220 Test Loss: 1.655 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3464655876159668
Epoch: 3, Steps: 4 | Train Loss: 1.317 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.633847951889038
Epoch: 4, Steps: 4 | Train Loss: 0.955 Vali Loss: 1.719 Vali Acc: 0.260 Test Loss: 1.719 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 5 cost time: 1.4244229793548584
Epoch: 5, Steps: 4 | Train Loss: 0.960 Vali Loss: 1.804 Vali Acc: 0.200 Test Loss: 1.804 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.540027379989624
Epoch: 6, Steps: 4 | Train Loss: 1.009 Vali Loss: 2.090 Vali Acc: 0.340 Test Loss: 2.090 Test Acc: 0.340
Validation loss decreased (-0.259983 --> -0.339979).  Saving model ...
Epoch: 7 cost time: 1.382927656173706
Epoch: 7, Steps: 4 | Train Loss: 0.779 Vali Loss: 2.185 Vali Acc: 0.240 Test Loss: 2.185 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6717405319213867
Epoch: 8, Steps: 4 | Train Loss: 0.932 Vali Loss: 2.160 Vali Acc: 0.260 Test Loss: 2.160 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5606794357299805
Epoch: 9, Steps: 4 | Train Loss: 0.511 Vali Loss: 2.315 Vali Acc: 0.280 Test Loss: 2.315 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4372692108154297
Epoch: 10, Steps: 4 | Train Loss: 0.356 Vali Loss: 2.510 Vali Acc: 0.280 Test Loss: 2.510 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.25704026222229
Epoch: 11, Steps: 4 | Train Loss: 0.411 Vali Loss: 2.560 Vali Acc: 0.280 Test Loss: 2.560 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.4484663009643555
Epoch: 12, Steps: 4 | Train Loss: 0.357 Vali Loss: 2.977 Vali Acc: 0.320 Test Loss: 2.977 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.413924217224121
Epoch: 13, Steps: 4 | Train Loss: 0.261 Vali Loss: 3.319 Vali Acc: 0.360 Test Loss: 3.319 Test Acc: 0.360
Validation loss decreased (-0.339979 --> -0.359967).  Saving model ...
Epoch: 14 cost time: 1.25816011428833
Epoch: 14, Steps: 4 | Train Loss: 0.307 Vali Loss: 3.330 Vali Acc: 0.300 Test Loss: 3.330 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.4753670692443848
Epoch: 15, Steps: 4 | Train Loss: 0.112 Vali Loss: 3.683 Vali Acc: 0.260 Test Loss: 3.683 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.569791555404663
Epoch: 16, Steps: 4 | Train Loss: 0.242 Vali Loss: 4.154 Vali Acc: 0.260 Test Loss: 4.154 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3870606422424316
Epoch: 17, Steps: 4 | Train Loss: 0.058 Vali Loss: 4.239 Vali Acc: 0.200 Test Loss: 4.239 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.470139503479004
Epoch: 18, Steps: 4 | Train Loss: 0.032 Vali Loss: 4.216 Vali Acc: 0.240 Test Loss: 4.216 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4664134979248047
Epoch: 19, Steps: 4 | Train Loss: 0.017 Vali Loss: 4.230 Vali Acc: 0.240 Test Loss: 4.230 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.570085048675537
Epoch: 20, Steps: 4 | Train Loss: 0.025 Vali Loss: 4.367 Vali Acc: 0.280 Test Loss: 4.367 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3338415622711182
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 4.291 Vali Acc: 0.200 Test Loss: 4.291 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4939343929290771
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 4.613 Vali Acc: 0.220 Test Loss: 4.613 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.4266352653503418
Epoch: 23, Steps: 4 | Train Loss: 0.004 Vali Loss: 5.246 Vali Acc: 0.260 Test Loss: 5.246 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 4932377
model size : 28.59MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.848435163497925
Epoch: 1, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.583 Vali Acc: 0.260 Test Loss: 1.583 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3608989715576172
Epoch: 2, Steps: 4 | Train Loss: 1.546 Vali Loss: 1.549 Vali Acc: 0.180 Test Loss: 1.549 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.7416014671325684
Epoch: 3, Steps: 4 | Train Loss: 1.205 Vali Loss: 1.692 Vali Acc: 0.240 Test Loss: 1.692 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4431242942810059
Epoch: 4, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.860 Vali Acc: 0.220 Test Loss: 1.860 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.353055715560913
Epoch: 5, Steps: 4 | Train Loss: 0.705 Vali Loss: 2.079 Vali Acc: 0.220 Test Loss: 2.079 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4040236473083496
Epoch: 6, Steps: 4 | Train Loss: 0.610 Vali Loss: 2.464 Vali Acc: 0.160 Test Loss: 2.464 Test Acc: 0.160
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.4514696598052979
Epoch: 7, Steps: 4 | Train Loss: 0.476 Vali Loss: 2.444 Vali Acc: 0.300 Test Loss: 2.444 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299976).  Saving model ...
Epoch: 8 cost time: 1.3513133525848389
Epoch: 8, Steps: 4 | Train Loss: 0.537 Vali Loss: 2.700 Vali Acc: 0.240 Test Loss: 2.700 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.429431676864624
Epoch: 9, Steps: 4 | Train Loss: 0.301 Vali Loss: 3.069 Vali Acc: 0.260 Test Loss: 3.069 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3632793426513672
Epoch: 10, Steps: 4 | Train Loss: 0.317 Vali Loss: 3.177 Vali Acc: 0.240 Test Loss: 3.177 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.6355400085449219
Epoch: 11, Steps: 4 | Train Loss: 0.276 Vali Loss: 3.742 Vali Acc: 0.260 Test Loss: 3.742 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3325538635253906
Epoch: 12, Steps: 4 | Train Loss: 0.140 Vali Loss: 4.094 Vali Acc: 0.280 Test Loss: 4.094 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.3381242752075195
Epoch: 13, Steps: 4 | Train Loss: 0.140 Vali Loss: 4.164 Vali Acc: 0.320 Test Loss: 4.164 Test Acc: 0.320
Validation loss decreased (-0.299976 --> -0.319958).  Saving model ...
Epoch: 14 cost time: 1.3235337734222412
Epoch: 14, Steps: 4 | Train Loss: 0.183 Vali Loss: 5.007 Vali Acc: 0.260 Test Loss: 5.007 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.394129991531372
Epoch: 15, Steps: 4 | Train Loss: 0.066 Vali Loss: 5.116 Vali Acc: 0.280 Test Loss: 5.116 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.591545581817627
Epoch: 16, Steps: 4 | Train Loss: 0.196 Vali Loss: 4.872 Vali Acc: 0.260 Test Loss: 4.872 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.5108697414398193
Epoch: 17, Steps: 4 | Train Loss: 0.030 Vali Loss: 5.693 Vali Acc: 0.280 Test Loss: 5.693 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5108458995819092
Epoch: 18, Steps: 4 | Train Loss: 0.025 Vali Loss: 5.667 Vali Acc: 0.260 Test Loss: 5.667 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.455354928970337
Epoch: 19, Steps: 4 | Train Loss: 0.010 Vali Loss: 5.395 Vali Acc: 0.340 Test Loss: 5.395 Test Acc: 0.340
Validation loss decreased (-0.319958 --> -0.339946).  Saving model ...
Epoch: 20 cost time: 1.5025053024291992
Epoch: 20, Steps: 4 | Train Loss: 0.012 Vali Loss: 5.710 Vali Acc: 0.300 Test Loss: 5.710 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.3998692035675049
Epoch: 21, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.877 Vali Acc: 0.260 Test Loss: 6.877 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4049208164215088
Epoch: 22, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.961 Vali Acc: 0.260 Test Loss: 6.961 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.4886868000030518
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.792 Vali Acc: 0.220 Test Loss: 6.792 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5604596138000488
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.560 Vali Acc: 0.220 Test Loss: 6.560 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.3858282566070557
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.130 Vali Acc: 0.240 Test Loss: 6.130 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.4750487804412842
Epoch: 26, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.196 Vali Acc: 0.220 Test Loss: 6.196 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3607981204986572
Epoch: 27, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.185 Vali Acc: 0.240 Test Loss: 6.185 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3910996913909912
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.583 Vali Acc: 0.280 Test Loss: 6.583 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.3742601871490479
Epoch: 29, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.068 Vali Acc: 0.260 Test Loss: 7.068 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4801305
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.339454889297485
Epoch: 1, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.610 Vali Acc: 0.260 Test Loss: 1.610 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.5256619453430176
Epoch: 2, Steps: 4 | Train Loss: 1.489 Vali Loss: 1.575 Vali Acc: 0.240 Test Loss: 1.575 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.5735254287719727
Epoch: 3, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.664 Vali Acc: 0.280 Test Loss: 1.664 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.5420420169830322
Epoch: 4, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.806 Vali Acc: 0.240 Test Loss: 1.806 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4224965572357178
Epoch: 5, Steps: 4 | Train Loss: 0.747 Vali Loss: 2.032 Vali Acc: 0.260 Test Loss: 2.032 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6422758102416992
Epoch: 6, Steps: 4 | Train Loss: 0.657 Vali Loss: 2.387 Vali Acc: 0.180 Test Loss: 2.387 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.638939619064331
Epoch: 7, Steps: 4 | Train Loss: 0.505 Vali Loss: 2.365 Vali Acc: 0.300 Test Loss: 2.365 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299976).  Saving model ...
Epoch: 8 cost time: 1.4735069274902344
Epoch: 8, Steps: 4 | Train Loss: 0.564 Vali Loss: 2.584 Vali Acc: 0.240 Test Loss: 2.584 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5523650646209717
Epoch: 9, Steps: 4 | Train Loss: 0.320 Vali Loss: 2.949 Vali Acc: 0.240 Test Loss: 2.949 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5067033767700195
Epoch: 10, Steps: 4 | Train Loss: 0.343 Vali Loss: 3.063 Vali Acc: 0.260 Test Loss: 3.063 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.4586443901062012
Epoch: 11, Steps: 4 | Train Loss: 0.297 Vali Loss: 3.501 Vali Acc: 0.240 Test Loss: 3.501 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.4934563636779785
Epoch: 12, Steps: 4 | Train Loss: 0.156 Vali Loss: 3.880 Vali Acc: 0.260 Test Loss: 3.880 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5192468166351318
Epoch: 13, Steps: 4 | Train Loss: 0.149 Vali Loss: 3.910 Vali Acc: 0.300 Test Loss: 3.910 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.6058802604675293
Epoch: 14, Steps: 4 | Train Loss: 0.159 Vali Loss: 4.670 Vali Acc: 0.280 Test Loss: 4.670 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.4712388515472412
Epoch: 15, Steps: 4 | Train Loss: 0.091 Vali Loss: 4.995 Vali Acc: 0.280 Test Loss: 4.995 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.7524311542510986
Epoch: 16, Steps: 4 | Train Loss: 0.230 Vali Loss: 4.805 Vali Acc: 0.280 Test Loss: 4.805 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.7155177593231201
Epoch: 17, Steps: 4 | Train Loss: 0.035 Vali Loss: 5.861 Vali Acc: 0.220 Test Loss: 5.861 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4801305
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.2092437744140625
Epoch: 1, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.647 Vali Acc: 0.160 Test Loss: 1.647 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.4947829246520996
Epoch: 2, Steps: 4 | Train Loss: 1.494 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.159984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.4572436809539795
Epoch: 3, Steps: 4 | Train Loss: 1.259 Vali Loss: 1.656 Vali Acc: 0.260 Test Loss: 1.656 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.4188580513000488
Epoch: 4, Steps: 4 | Train Loss: 1.063 Vali Loss: 1.774 Vali Acc: 0.200 Test Loss: 1.774 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7175233364105225
Epoch: 5, Steps: 4 | Train Loss: 0.802 Vali Loss: 1.991 Vali Acc: 0.200 Test Loss: 1.991 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5502355098724365
Epoch: 6, Steps: 4 | Train Loss: 0.736 Vali Loss: 2.275 Vali Acc: 0.200 Test Loss: 2.275 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3565711975097656
Epoch: 7, Steps: 4 | Train Loss: 0.571 Vali Loss: 2.249 Vali Acc: 0.280 Test Loss: 2.249 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279978).  Saving model ...
Epoch: 8 cost time: 1.3157117366790771
Epoch: 8, Steps: 4 | Train Loss: 0.644 Vali Loss: 2.481 Vali Acc: 0.220 Test Loss: 2.481 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2792384624481201
Epoch: 9, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.813 Vali Acc: 0.260 Test Loss: 2.813 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.394909381866455
Epoch: 10, Steps: 4 | Train Loss: 0.389 Vali Loss: 2.975 Vali Acc: 0.260 Test Loss: 2.975 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.5418980121612549
Epoch: 11, Steps: 4 | Train Loss: 0.366 Vali Loss: 3.138 Vali Acc: 0.280 Test Loss: 3.138 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.370210886001587
Epoch: 12, Steps: 4 | Train Loss: 0.195 Vali Loss: 3.645 Vali Acc: 0.260 Test Loss: 3.645 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.7147629261016846
Epoch: 13, Steps: 4 | Train Loss: 0.182 Vali Loss: 3.866 Vali Acc: 0.260 Test Loss: 3.866 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.5595982074737549
Epoch: 14, Steps: 4 | Train Loss: 0.258 Vali Loss: 4.295 Vali Acc: 0.320 Test Loss: 4.295 Test Acc: 0.320
Validation loss decreased (-0.279978 --> -0.319957).  Saving model ...
Epoch: 15 cost time: 1.5246930122375488
Epoch: 15, Steps: 4 | Train Loss: 0.134 Vali Loss: 4.761 Vali Acc: 0.280 Test Loss: 4.761 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.4260823726654053
Epoch: 16, Steps: 4 | Train Loss: 0.479 Vali Loss: 4.578 Vali Acc: 0.280 Test Loss: 4.578 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.5792806148529053
Epoch: 17, Steps: 4 | Train Loss: 0.069 Vali Loss: 6.496 Vali Acc: 0.260 Test Loss: 6.496 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5127067565917969
Epoch: 18, Steps: 4 | Train Loss: 0.112 Vali Loss: 5.644 Vali Acc: 0.340 Test Loss: 5.644 Test Acc: 0.340
Validation loss decreased (-0.319957 --> -0.339944).  Saving model ...
Epoch: 19 cost time: 1.6034650802612305
Epoch: 19, Steps: 4 | Train Loss: 0.060 Vali Loss: 5.242 Vali Acc: 0.320 Test Loss: 5.242 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.5568249225616455
Epoch: 20, Steps: 4 | Train Loss: 0.111 Vali Loss: 5.890 Vali Acc: 0.300 Test Loss: 5.890 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.4994926452636719
Epoch: 21, Steps: 4 | Train Loss: 0.012 Vali Loss: 7.804 Vali Acc: 0.300 Test Loss: 7.804 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5097999572753906
Epoch: 22, Steps: 4 | Train Loss: 0.013 Vali Loss: 7.295 Vali Acc: 0.280 Test Loss: 7.295 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4394757747650146
Epoch: 23, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.139 Vali Acc: 0.280 Test Loss: 7.139 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.4443919658660889
Epoch: 24, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.195 Vali Acc: 0.240 Test Loss: 7.195 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2973082065582275
Epoch: 25, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.257 Vali Acc: 0.240 Test Loss: 7.257 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4844508171081543
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.468 Vali Acc: 0.260 Test Loss: 7.468 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5593516826629639
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.729 Vali Acc: 0.260 Test Loss: 7.729 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.5681915283203125
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.993 Vali Acc: 0.260 Test Loss: 7.993 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 4801305
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3734185695648193
Epoch: 1, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.661 Vali Acc: 0.200 Test Loss: 1.661 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3135275840759277
Epoch: 2, Steps: 4 | Train Loss: 1.520 Vali Loss: 1.656 Vali Acc: 0.200 Test Loss: 1.656 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.4069797992706299
Epoch: 3, Steps: 4 | Train Loss: 1.315 Vali Loss: 1.664 Vali Acc: 0.260 Test Loss: 1.664 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.505199670791626
Epoch: 4, Steps: 4 | Train Loss: 1.151 Vali Loss: 1.732 Vali Acc: 0.240 Test Loss: 1.732 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2419624328613281
Epoch: 5, Steps: 4 | Train Loss: 0.867 Vali Loss: 1.917 Vali Acc: 0.200 Test Loss: 1.917 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.327155351638794
Epoch: 6, Steps: 4 | Train Loss: 0.835 Vali Loss: 2.150 Vali Acc: 0.180 Test Loss: 2.150 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3830058574676514
Epoch: 7, Steps: 4 | Train Loss: 0.692 Vali Loss: 2.071 Vali Acc: 0.240 Test Loss: 2.071 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.433424711227417
Epoch: 8, Steps: 4 | Train Loss: 0.718 Vali Loss: 2.251 Vali Acc: 0.240 Test Loss: 2.251 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4035775661468506
Epoch: 9, Steps: 4 | Train Loss: 0.436 Vali Loss: 2.483 Vali Acc: 0.260 Test Loss: 2.483 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6015563011169434
Epoch: 10, Steps: 4 | Train Loss: 0.431 Vali Loss: 2.627 Vali Acc: 0.260 Test Loss: 2.627 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6711657047271729
Epoch: 11, Steps: 4 | Train Loss: 0.398 Vali Loss: 2.568 Vali Acc: 0.300 Test Loss: 2.568 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299974).  Saving model ...
Epoch: 12 cost time: 1.3618967533111572
Epoch: 12, Steps: 4 | Train Loss: 0.248 Vali Loss: 2.755 Vali Acc: 0.300 Test Loss: 2.755 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.485966444015503
Epoch: 13, Steps: 4 | Train Loss: 0.229 Vali Loss: 2.836 Vali Acc: 0.300 Test Loss: 2.836 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4732072353363037
Epoch: 14, Steps: 4 | Train Loss: 0.324 Vali Loss: 3.025 Vali Acc: 0.280 Test Loss: 3.025 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3387031555175781
Epoch: 15, Steps: 4 | Train Loss: 0.170 Vali Loss: 3.810 Vali Acc: 0.260 Test Loss: 3.810 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.4151670932769775
Epoch: 16, Steps: 4 | Train Loss: 0.322 Vali Loss: 3.705 Vali Acc: 0.220 Test Loss: 3.705 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.396251916885376
Epoch: 17, Steps: 4 | Train Loss: 0.115 Vali Loss: 4.302 Vali Acc: 0.300 Test Loss: 4.302 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3483190536499023
Epoch: 18, Steps: 4 | Train Loss: 0.111 Vali Loss: 4.463 Vali Acc: 0.200 Test Loss: 4.463 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.422943353652954
Epoch: 19, Steps: 4 | Train Loss: 0.069 Vali Loss: 4.659 Vali Acc: 0.180 Test Loss: 4.659 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2800023555755615
Epoch: 20, Steps: 4 | Train Loss: 0.052 Vali Loss: 5.075 Vali Acc: 0.320 Test Loss: 5.075 Test Acc: 0.320
Validation loss decreased (-0.299974 --> -0.319949).  Saving model ...
Epoch: 21 cost time: 1.3293359279632568
Epoch: 21, Steps: 4 | Train Loss: 0.067 Vali Loss: 5.169 Vali Acc: 0.260 Test Loss: 5.169 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.441948652267456
Epoch: 22, Steps: 4 | Train Loss: 0.024 Vali Loss: 5.958 Vali Acc: 0.260 Test Loss: 5.958 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.398984432220459
Epoch: 23, Steps: 4 | Train Loss: 0.064 Vali Loss: 6.544 Vali Acc: 0.240 Test Loss: 6.544 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.4525678157806396
Epoch: 24, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.850 Vali Acc: 0.260 Test Loss: 6.850 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.4538946151733398
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.137 Vali Acc: 0.280 Test Loss: 7.137 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.625777006149292
Epoch: 26, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.314 Vali Acc: 0.260 Test Loss: 7.314 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.5583500862121582
Epoch: 27, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.463 Vali Acc: 0.280 Test Loss: 7.463 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.5049612522125244
Epoch: 28, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.598 Vali Acc: 0.300 Test Loss: 7.598 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5300114154815674
Epoch: 29, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.684 Vali Acc: 0.300 Test Loss: 7.684 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.6184067726135254
Epoch: 30, Steps: 4 | Train Loss: 0.000 Vali Loss: 7.706 Vali Acc: 0.300 Test Loss: 7.706 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4801305
model size : 28.09MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9255311489105225
Epoch: 1, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.514 Vali Acc: 0.260 Test Loss: 1.514 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.5845704078674316
Epoch: 2, Steps: 4 | Train Loss: 1.548 Vali Loss: 1.522 Vali Acc: 0.280 Test Loss: 1.522 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.4734716415405273
Epoch: 3, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.704 Vali Acc: 0.320 Test Loss: 1.704 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319983).  Saving model ...
Epoch: 4 cost time: 1.6394717693328857
Epoch: 4, Steps: 4 | Train Loss: 0.816 Vali Loss: 1.925 Vali Acc: 0.280 Test Loss: 1.925 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3719072341918945
Epoch: 5, Steps: 4 | Train Loss: 0.836 Vali Loss: 1.970 Vali Acc: 0.240 Test Loss: 1.970 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.530522108078003
Epoch: 6, Steps: 4 | Train Loss: 0.522 Vali Loss: 2.207 Vali Acc: 0.260 Test Loss: 2.207 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.5508522987365723
Epoch: 7, Steps: 4 | Train Loss: 0.434 Vali Loss: 2.760 Vali Acc: 0.200 Test Loss: 2.760 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5808460712432861
Epoch: 8, Steps: 4 | Train Loss: 0.535 Vali Loss: 2.770 Vali Acc: 0.280 Test Loss: 2.770 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6242682933807373
Epoch: 9, Steps: 4 | Train Loss: 0.289 Vali Loss: 2.801 Vali Acc: 0.280 Test Loss: 2.801 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.6823816299438477
Epoch: 10, Steps: 4 | Train Loss: 0.603 Vali Loss: 3.032 Vali Acc: 0.300 Test Loss: 3.032 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.319322109222412
Epoch: 11, Steps: 4 | Train Loss: 0.216 Vali Loss: 3.424 Vali Acc: 0.320 Test Loss: 3.424 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3344810009002686
Epoch: 12, Steps: 4 | Train Loss: 0.201 Vali Loss: 4.145 Vali Acc: 0.260 Test Loss: 4.145 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2602269649505615
Epoch: 13, Steps: 4 | Train Loss: 0.136 Vali Loss: 4.137 Vali Acc: 0.240 Test Loss: 4.137 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4735769
model size : 27.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.22344970703125
Epoch: 1, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.538 Vali Acc: 0.260 Test Loss: 1.538 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.8245458602905273
Epoch: 2, Steps: 4 | Train Loss: 1.557 Vali Loss: 1.502 Vali Acc: 0.260 Test Loss: 1.502 Test Acc: 0.260
Validation loss decreased (-0.259985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.6192915439605713
Epoch: 3, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.676 Vali Acc: 0.280 Test Loss: 1.676 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279983).  Saving model ...
Epoch: 4 cost time: 1.4518914222717285
Epoch: 4, Steps: 4 | Train Loss: 0.857 Vali Loss: 1.884 Vali Acc: 0.240 Test Loss: 1.884 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.597353219985962
Epoch: 5, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.908 Vali Acc: 0.240 Test Loss: 1.908 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6552636623382568
Epoch: 6, Steps: 4 | Train Loss: 0.580 Vali Loss: 2.168 Vali Acc: 0.240 Test Loss: 2.168 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.66330885887146
Epoch: 7, Steps: 4 | Train Loss: 0.463 Vali Loss: 2.816 Vali Acc: 0.200 Test Loss: 2.816 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.6595585346221924
Epoch: 8, Steps: 4 | Train Loss: 0.618 Vali Loss: 2.687 Vali Acc: 0.260 Test Loss: 2.687 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.5478029251098633
Epoch: 9, Steps: 4 | Train Loss: 0.336 Vali Loss: 2.858 Vali Acc: 0.260 Test Loss: 2.858 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3949759006500244
Epoch: 10, Steps: 4 | Train Loss: 0.716 Vali Loss: 2.984 Vali Acc: 0.300 Test Loss: 2.984 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299970).  Saving model ...
Epoch: 11 cost time: 1.5643141269683838
Epoch: 11, Steps: 4 | Train Loss: 0.258 Vali Loss: 3.505 Vali Acc: 0.280 Test Loss: 3.505 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6659572124481201
Epoch: 12, Steps: 4 | Train Loss: 0.247 Vali Loss: 4.159 Vali Acc: 0.280 Test Loss: 4.159 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.440396785736084
Epoch: 13, Steps: 4 | Train Loss: 0.192 Vali Loss: 4.180 Vali Acc: 0.220 Test Loss: 4.180 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6111781597137451
Epoch: 14, Steps: 4 | Train Loss: 0.181 Vali Loss: 4.481 Vali Acc: 0.300 Test Loss: 4.481 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.795490026473999
Epoch: 15, Steps: 4 | Train Loss: 0.114 Vali Loss: 4.794 Vali Acc: 0.260 Test Loss: 4.794 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.508986473083496
Epoch: 16, Steps: 4 | Train Loss: 0.073 Vali Loss: 4.760 Vali Acc: 0.320 Test Loss: 4.760 Test Acc: 0.320
Validation loss decreased (-0.299970 --> -0.319952).  Saving model ...
Epoch: 17 cost time: 1.412339210510254
Epoch: 17, Steps: 4 | Train Loss: 0.068 Vali Loss: 4.698 Vali Acc: 0.260 Test Loss: 4.698 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.58406662940979
Epoch: 18, Steps: 4 | Train Loss: 0.019 Vali Loss: 5.602 Vali Acc: 0.240 Test Loss: 5.602 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.5946686267852783
Epoch: 19, Steps: 4 | Train Loss: 0.014 Vali Loss: 5.816 Vali Acc: 0.280 Test Loss: 5.816 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.557349443435669
Epoch: 20, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.447 Vali Acc: 0.300 Test Loss: 6.447 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.621732473373413
Epoch: 21, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.817 Vali Acc: 0.280 Test Loss: 6.817 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6312921047210693
Epoch: 22, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.960 Vali Acc: 0.260 Test Loss: 6.960 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.7186927795410156
Epoch: 23, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.950 Vali Acc: 0.280 Test Loss: 6.950 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6113240718841553
Epoch: 24, Steps: 4 | Train Loss: 0.001 Vali Loss: 6.949 Vali Acc: 0.280 Test Loss: 6.949 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.510014533996582
Epoch: 25, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.029 Vali Acc: 0.260 Test Loss: 7.029 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.4721288681030273
Epoch: 26, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.165 Vali Acc: 0.280 Test Loss: 7.165 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4735769
model size : 27.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6290574073791504
Epoch: 1, Steps: 4 | Train Loss: 1.578 Vali Loss: 1.548 Vali Acc: 0.280 Test Loss: 1.548 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.4511232376098633
Epoch: 2, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.509 Vali Acc: 0.280 Test Loss: 1.509 Test Acc: 0.280
Validation loss decreased (-0.279985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.4371087551116943
Epoch: 3, Steps: 4 | Train Loss: 1.052 Vali Loss: 1.636 Vali Acc: 0.300 Test Loss: 1.636 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.4035110473632812
Epoch: 4, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.840 Vali Acc: 0.240 Test Loss: 1.840 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3637044429779053
Epoch: 5, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.836 Vali Acc: 0.240 Test Loss: 1.836 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2410647869110107
Epoch: 6, Steps: 4 | Train Loss: 0.653 Vali Loss: 2.075 Vali Acc: 0.240 Test Loss: 2.075 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3302862644195557
Epoch: 7, Steps: 4 | Train Loss: 0.515 Vali Loss: 2.693 Vali Acc: 0.200 Test Loss: 2.693 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5290734767913818
Epoch: 8, Steps: 4 | Train Loss: 0.690 Vali Loss: 2.507 Vali Acc: 0.240 Test Loss: 2.507 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4102871417999268
Epoch: 9, Steps: 4 | Train Loss: 0.403 Vali Loss: 2.672 Vali Acc: 0.240 Test Loss: 2.672 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.557422399520874
Epoch: 10, Steps: 4 | Train Loss: 0.746 Vali Loss: 2.796 Vali Acc: 0.260 Test Loss: 2.796 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4567642211914062
Epoch: 11, Steps: 4 | Train Loss: 0.312 Vali Loss: 3.398 Vali Acc: 0.240 Test Loss: 3.398 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2880380153656006
Epoch: 12, Steps: 4 | Train Loss: 0.338 Vali Loss: 3.675 Vali Acc: 0.300 Test Loss: 3.675 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.638192892074585
Epoch: 13, Steps: 4 | Train Loss: 0.225 Vali Loss: 3.765 Vali Acc: 0.280 Test Loss: 3.765 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 4735769
model size : 27.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.149811506271362
Epoch: 1, Steps: 4 | Train Loss: 1.597 Vali Loss: 1.526 Vali Acc: 0.280 Test Loss: 1.526 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.421393871307373
Epoch: 2, Steps: 4 | Train Loss: 1.612 Vali Loss: 1.494 Vali Acc: 0.220 Test Loss: 1.494 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4855031967163086
Epoch: 3, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.591 Vali Acc: 0.320 Test Loss: 1.591 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.5175604820251465
Epoch: 4, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.760 Vali Acc: 0.220 Test Loss: 1.760 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3835868835449219
Epoch: 5, Steps: 4 | Train Loss: 1.045 Vali Loss: 1.752 Vali Acc: 0.220 Test Loss: 1.752 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5461716651916504
Epoch: 6, Steps: 4 | Train Loss: 0.765 Vali Loss: 1.938 Vali Acc: 0.200 Test Loss: 1.938 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4051294326782227
Epoch: 7, Steps: 4 | Train Loss: 0.595 Vali Loss: 2.354 Vali Acc: 0.200 Test Loss: 2.354 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5951497554779053
Epoch: 8, Steps: 4 | Train Loss: 0.715 Vali Loss: 2.177 Vali Acc: 0.220 Test Loss: 2.177 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.381425380706787
Epoch: 9, Steps: 4 | Train Loss: 0.470 Vali Loss: 2.339 Vali Acc: 0.220 Test Loss: 2.339 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3726651668548584
Epoch: 10, Steps: 4 | Train Loss: 0.752 Vali Loss: 2.407 Vali Acc: 0.280 Test Loss: 2.407 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.587559700012207
Epoch: 11, Steps: 4 | Train Loss: 0.369 Vali Loss: 2.807 Vali Acc: 0.220 Test Loss: 2.807 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6281726360321045
Epoch: 12, Steps: 4 | Train Loss: 0.351 Vali Loss: 2.865 Vali Acc: 0.260 Test Loss: 2.865 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.391073226928711
Epoch: 13, Steps: 4 | Train Loss: 0.323 Vali Loss: 2.756 Vali Acc: 0.200 Test Loss: 2.756 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 4735769
model size : 27.84MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.079623222351074
Epoch: 1, Steps: 4 | Train Loss: 1.619 Vali Loss: 1.660 Vali Acc: 0.140 Test Loss: 1.660 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.366154432296753
Epoch: 2, Steps: 4 | Train Loss: 1.451 Vali Loss: 1.679 Vali Acc: 0.160 Test Loss: 1.679 Test Acc: 0.160
Validation loss decreased (-0.139983 --> -0.159983).  Saving model ...
Epoch: 3 cost time: 1.3261158466339111
Epoch: 3, Steps: 4 | Train Loss: 1.296 Vali Loss: 1.713 Vali Acc: 0.200 Test Loss: 1.713 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.3520610332489014
Epoch: 4, Steps: 4 | Train Loss: 1.079 Vali Loss: 1.781 Vali Acc: 0.200 Test Loss: 1.781 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5073187351226807
Epoch: 5, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.911 Vali Acc: 0.180 Test Loss: 1.911 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3751907348632812
Epoch: 6, Steps: 4 | Train Loss: 0.787 Vali Loss: 2.021 Vali Acc: 0.220 Test Loss: 2.021 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219980).  Saving model ...
Epoch: 7 cost time: 1.441110610961914
Epoch: 7, Steps: 4 | Train Loss: 0.583 Vali Loss: 2.185 Vali Acc: 0.200 Test Loss: 2.185 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3309376239776611
Epoch: 8, Steps: 4 | Train Loss: 0.437 Vali Loss: 2.350 Vali Acc: 0.220 Test Loss: 2.350 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3321013450622559
Epoch: 9, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.527 Vali Acc: 0.280 Test Loss: 2.527 Test Acc: 0.280
Validation loss decreased (-0.219980 --> -0.279975).  Saving model ...
Epoch: 10 cost time: 1.4898133277893066
Epoch: 10, Steps: 4 | Train Loss: 0.315 Vali Loss: 2.671 Vali Acc: 0.260 Test Loss: 2.671 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3700289726257324
Epoch: 11, Steps: 4 | Train Loss: 0.307 Vali Loss: 2.940 Vali Acc: 0.280 Test Loss: 2.940 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3832831382751465
Epoch: 12, Steps: 4 | Train Loss: 0.212 Vali Loss: 3.147 Vali Acc: 0.300 Test Loss: 3.147 Test Acc: 0.300
Validation loss decreased (-0.279975 --> -0.299969).  Saving model ...
Epoch: 13 cost time: 1.3495562076568604
Epoch: 13, Steps: 4 | Train Loss: 0.247 Vali Loss: 3.338 Vali Acc: 0.240 Test Loss: 3.338 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.460627794265747
Epoch: 14, Steps: 4 | Train Loss: 0.143 Vali Loss: 3.680 Vali Acc: 0.240 Test Loss: 3.680 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.675623893737793
Epoch: 15, Steps: 4 | Train Loss: 0.117 Vali Loss: 4.079 Vali Acc: 0.280 Test Loss: 4.079 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5670802593231201
Epoch: 16, Steps: 4 | Train Loss: 0.085 Vali Loss: 4.326 Vali Acc: 0.300 Test Loss: 4.326 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.5739388465881348
Epoch: 17, Steps: 4 | Train Loss: 0.077 Vali Loss: 4.822 Vali Acc: 0.220 Test Loss: 4.822 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3410115242004395
Epoch: 18, Steps: 4 | Train Loss: 0.050 Vali Loss: 5.200 Vali Acc: 0.240 Test Loss: 5.200 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4057049751281738
Epoch: 19, Steps: 4 | Train Loss: 0.034 Vali Loss: 5.316 Vali Acc: 0.220 Test Loss: 5.316 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4286634922027588
Epoch: 20, Steps: 4 | Train Loss: 0.019 Vali Loss: 5.481 Vali Acc: 0.200 Test Loss: 5.481 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.3192639350891113
Epoch: 21, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.680 Vali Acc: 0.220 Test Loss: 5.680 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3508110046386719
Epoch: 22, Steps: 4 | Train Loss: 0.008 Vali Loss: 5.909 Vali Acc: 0.220 Test Loss: 5.909 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 3255321
model size : 17.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.839369773864746
Epoch: 1, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.639 Vali Acc: 0.200 Test Loss: 1.639 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2751944065093994
Epoch: 2, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.665 Vali Acc: 0.140 Test Loss: 1.665 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4746348857879639
Epoch: 3, Steps: 4 | Train Loss: 1.323 Vali Loss: 1.692 Vali Acc: 0.200 Test Loss: 1.692 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.4020335674285889
Epoch: 4, Steps: 4 | Train Loss: 1.107 Vali Loss: 1.751 Vali Acc: 0.220 Test Loss: 1.751 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219982).  Saving model ...
Epoch: 5 cost time: 1.3818750381469727
Epoch: 5, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.904 Vali Acc: 0.220 Test Loss: 1.904 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2854647636413574
Epoch: 6, Steps: 4 | Train Loss: 0.830 Vali Loss: 2.018 Vali Acc: 0.220 Test Loss: 2.018 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4038112163543701
Epoch: 7, Steps: 4 | Train Loss: 0.619 Vali Loss: 2.181 Vali Acc: 0.240 Test Loss: 2.181 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239978).  Saving model ...
Epoch: 8 cost time: 1.2313594818115234
Epoch: 8, Steps: 4 | Train Loss: 0.466 Vali Loss: 2.334 Vali Acc: 0.240 Test Loss: 2.334 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1204173564910889
Epoch: 9, Steps: 4 | Train Loss: 0.460 Vali Loss: 2.504 Vali Acc: 0.320 Test Loss: 2.504 Test Acc: 0.320
Validation loss decreased (-0.239978 --> -0.319975).  Saving model ...
Epoch: 10 cost time: 1.2833304405212402
Epoch: 10, Steps: 4 | Train Loss: 0.345 Vali Loss: 2.614 Vali Acc: 0.260 Test Loss: 2.614 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.455657720565796
Epoch: 11, Steps: 4 | Train Loss: 0.341 Vali Loss: 2.869 Vali Acc: 0.260 Test Loss: 2.869 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3587620258331299
Epoch: 12, Steps: 4 | Train Loss: 0.236 Vali Loss: 3.212 Vali Acc: 0.260 Test Loss: 3.212 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.468745231628418
Epoch: 13, Steps: 4 | Train Loss: 0.281 Vali Loss: 3.313 Vali Acc: 0.240 Test Loss: 3.313 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.280622959136963
Epoch: 14, Steps: 4 | Train Loss: 0.164 Vali Loss: 3.647 Vali Acc: 0.260 Test Loss: 3.647 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2489001750946045
Epoch: 15, Steps: 4 | Train Loss: 0.142 Vali Loss: 4.061 Vali Acc: 0.280 Test Loss: 4.061 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2492928504943848
Epoch: 16, Steps: 4 | Train Loss: 0.102 Vali Loss: 4.246 Vali Acc: 0.340 Test Loss: 4.246 Test Acc: 0.340
Validation loss decreased (-0.319975 --> -0.339958).  Saving model ...
Epoch: 17 cost time: 1.2761647701263428
Epoch: 17, Steps: 4 | Train Loss: 0.097 Vali Loss: 4.428 Vali Acc: 0.260 Test Loss: 4.428 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.3923203945159912
Epoch: 18, Steps: 4 | Train Loss: 0.071 Vali Loss: 4.717 Vali Acc: 0.260 Test Loss: 4.717 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.3076887130737305
Epoch: 19, Steps: 4 | Train Loss: 0.049 Vali Loss: 5.174 Vali Acc: 0.240 Test Loss: 5.174 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.343595027923584
Epoch: 20, Steps: 4 | Train Loss: 0.026 Vali Loss: 5.561 Vali Acc: 0.220 Test Loss: 5.561 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.3511362075805664
Epoch: 21, Steps: 4 | Train Loss: 0.017 Vali Loss: 5.772 Vali Acc: 0.240 Test Loss: 5.772 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.274369478225708
Epoch: 22, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.050 Vali Acc: 0.240 Test Loss: 6.050 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4924683570861816
Epoch: 23, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.320 Vali Acc: 0.240 Test Loss: 6.320 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2427575588226318
Epoch: 24, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.485 Vali Acc: 0.240 Test Loss: 6.485 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.2950220108032227
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.660 Vali Acc: 0.240 Test Loss: 6.660 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2082602977752686
Epoch: 26, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.814 Vali Acc: 0.240 Test Loss: 6.814 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 3255321
model size : 17.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.431675910949707
Epoch: 1, Steps: 4 | Train Loss: 1.585 Vali Loss: 1.629 Vali Acc: 0.220 Test Loss: 1.629 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.316560983657837
Epoch: 2, Steps: 4 | Train Loss: 1.462 Vali Loss: 1.653 Vali Acc: 0.160 Test Loss: 1.653 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.478874921798706
Epoch: 3, Steps: 4 | Train Loss: 1.338 Vali Loss: 1.672 Vali Acc: 0.180 Test Loss: 1.672 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3618431091308594
Epoch: 4, Steps: 4 | Train Loss: 1.134 Vali Loss: 1.696 Vali Acc: 0.200 Test Loss: 1.696 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4040427207946777
Epoch: 5, Steps: 4 | Train Loss: 1.180 Vali Loss: 1.807 Vali Acc: 0.220 Test Loss: 1.807 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.4571030139923096
Epoch: 6, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.913 Vali Acc: 0.220 Test Loss: 1.913 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3722517490386963
Epoch: 7, Steps: 4 | Train Loss: 0.667 Vali Loss: 2.077 Vali Acc: 0.220 Test Loss: 2.077 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.2550396919250488
Epoch: 8, Steps: 4 | Train Loss: 0.508 Vali Loss: 2.213 Vali Acc: 0.200 Test Loss: 2.213 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3156557083129883
Epoch: 9, Steps: 4 | Train Loss: 0.513 Vali Loss: 2.405 Vali Acc: 0.280 Test Loss: 2.405 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279976).  Saving model ...
Epoch: 10 cost time: 1.4660627841949463
Epoch: 10, Steps: 4 | Train Loss: 0.385 Vali Loss: 2.518 Vali Acc: 0.240 Test Loss: 2.518 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1575932502746582
Epoch: 11, Steps: 4 | Train Loss: 0.410 Vali Loss: 2.783 Vali Acc: 0.260 Test Loss: 2.783 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3861939907073975
Epoch: 12, Steps: 4 | Train Loss: 0.281 Vali Loss: 3.076 Vali Acc: 0.320 Test Loss: 3.076 Test Acc: 0.320
Validation loss decreased (-0.279976 --> -0.319969).  Saving model ...
Epoch: 13 cost time: 1.3199732303619385
Epoch: 13, Steps: 4 | Train Loss: 0.365 Vali Loss: 3.053 Vali Acc: 0.280 Test Loss: 3.053 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3219659328460693
Epoch: 14, Steps: 4 | Train Loss: 0.206 Vali Loss: 3.293 Vali Acc: 0.260 Test Loss: 3.293 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.3639254570007324
Epoch: 15, Steps: 4 | Train Loss: 0.192 Vali Loss: 3.674 Vali Acc: 0.240 Test Loss: 3.674 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4503893852233887
Epoch: 16, Steps: 4 | Train Loss: 0.125 Vali Loss: 3.954 Vali Acc: 0.280 Test Loss: 3.954 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.4965734481811523
Epoch: 17, Steps: 4 | Train Loss: 0.135 Vali Loss: 4.278 Vali Acc: 0.280 Test Loss: 4.278 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.3479702472686768
Epoch: 18, Steps: 4 | Train Loss: 0.094 Vali Loss: 4.568 Vali Acc: 0.280 Test Loss: 4.568 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1696195602416992
Epoch: 19, Steps: 4 | Train Loss: 0.096 Vali Loss: 4.648 Vali Acc: 0.260 Test Loss: 4.648 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.359799861907959
Epoch: 20, Steps: 4 | Train Loss: 0.053 Vali Loss: 5.251 Vali Acc: 0.260 Test Loss: 5.251 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4837665557861328
Epoch: 21, Steps: 4 | Train Loss: 0.033 Vali Loss: 5.674 Vali Acc: 0.260 Test Loss: 5.674 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.4274101257324219
Epoch: 22, Steps: 4 | Train Loss: 0.019 Vali Loss: 5.809 Vali Acc: 0.280 Test Loss: 5.809 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 3255321
model size : 17.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.832306385040283
Epoch: 1, Steps: 4 | Train Loss: 1.599 Vali Loss: 1.671 Vali Acc: 0.200 Test Loss: 1.671 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.3700838088989258
Epoch: 2, Steps: 4 | Train Loss: 1.491 Vali Loss: 1.688 Vali Acc: 0.180 Test Loss: 1.688 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2298071384429932
Epoch: 3, Steps: 4 | Train Loss: 1.413 Vali Loss: 1.683 Vali Acc: 0.200 Test Loss: 1.683 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2774593830108643
Epoch: 4, Steps: 4 | Train Loss: 1.197 Vali Loss: 1.647 Vali Acc: 0.180 Test Loss: 1.647 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1877596378326416
Epoch: 5, Steps: 4 | Train Loss: 1.218 Vali Loss: 1.714 Vali Acc: 0.260 Test Loss: 1.714 Test Acc: 0.260
Validation loss decreased (-0.199983 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.085397720336914
Epoch: 6, Steps: 4 | Train Loss: 0.966 Vali Loss: 1.792 Vali Acc: 0.280 Test Loss: 1.792 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279982).  Saving model ...
Epoch: 7 cost time: 1.3535702228546143
Epoch: 7, Steps: 4 | Train Loss: 0.753 Vali Loss: 1.909 Vali Acc: 0.220 Test Loss: 1.909 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.4453561305999756
Epoch: 8, Steps: 4 | Train Loss: 0.577 Vali Loss: 2.016 Vali Acc: 0.240 Test Loss: 2.016 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1679232120513916
Epoch: 9, Steps: 4 | Train Loss: 0.620 Vali Loss: 2.138 Vali Acc: 0.260 Test Loss: 2.138 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3742072582244873
Epoch: 10, Steps: 4 | Train Loss: 0.467 Vali Loss: 2.219 Vali Acc: 0.220 Test Loss: 2.219 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.413485050201416
Epoch: 11, Steps: 4 | Train Loss: 0.507 Vali Loss: 2.408 Vali Acc: 0.240 Test Loss: 2.408 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1612598896026611
Epoch: 12, Steps: 4 | Train Loss: 0.340 Vali Loss: 2.737 Vali Acc: 0.360 Test Loss: 2.737 Test Acc: 0.360
Validation loss decreased (-0.279982 --> -0.359973).  Saving model ...
Epoch: 13 cost time: 1.2771072387695312
Epoch: 13, Steps: 4 | Train Loss: 0.453 Vali Loss: 2.607 Vali Acc: 0.320 Test Loss: 2.607 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2659952640533447
Epoch: 14, Steps: 4 | Train Loss: 0.256 Vali Loss: 2.763 Vali Acc: 0.300 Test Loss: 2.763 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2775354385375977
Epoch: 15, Steps: 4 | Train Loss: 0.242 Vali Loss: 3.066 Vali Acc: 0.300 Test Loss: 3.066 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3433582782745361
Epoch: 16, Steps: 4 | Train Loss: 0.154 Vali Loss: 3.283 Vali Acc: 0.340 Test Loss: 3.283 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1724607944488525
Epoch: 17, Steps: 4 | Train Loss: 0.169 Vali Loss: 3.426 Vali Acc: 0.240 Test Loss: 3.426 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.411442756652832
Epoch: 18, Steps: 4 | Train Loss: 0.099 Vali Loss: 3.639 Vali Acc: 0.240 Test Loss: 3.639 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3814196586608887
Epoch: 19, Steps: 4 | Train Loss: 0.093 Vali Loss: 3.672 Vali Acc: 0.260 Test Loss: 3.672 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4313182830810547
Epoch: 20, Steps: 4 | Train Loss: 0.056 Vali Loss: 4.165 Vali Acc: 0.280 Test Loss: 4.165 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.2709534168243408
Epoch: 21, Steps: 4 | Train Loss: 0.043 Vali Loss: 4.603 Vali Acc: 0.280 Test Loss: 4.603 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.254227876663208
Epoch: 22, Steps: 4 | Train Loss: 0.025 Vali Loss: 4.666 Vali Acc: 0.300 Test Loss: 4.666 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 3255321
model size : 17.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.215208530426025
Epoch: 1, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.490 Vali Acc: 0.160 Test Loss: 1.490 Test Acc: 0.160
Validation loss decreased (inf --> -0.159985).  Saving model ...
Epoch: 2 cost time: 1.1960885524749756
Epoch: 2, Steps: 4 | Train Loss: 1.417 Vali Loss: 1.475 Vali Acc: 0.280 Test Loss: 1.475 Test Acc: 0.280
Validation loss decreased (-0.159985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.3247263431549072
Epoch: 3, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.541 Vali Acc: 0.200 Test Loss: 1.541 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3030321598052979
Epoch: 4, Steps: 4 | Train Loss: 1.010 Vali Loss: 1.668 Vali Acc: 0.240 Test Loss: 1.668 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5254604816436768
Epoch: 5, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.749 Vali Acc: 0.260 Test Loss: 1.749 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.5207245349884033
Epoch: 6, Steps: 4 | Train Loss: 0.885 Vali Loss: 1.915 Vali Acc: 0.300 Test Loss: 1.915 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299981).  Saving model ...
Epoch: 7 cost time: 1.3171117305755615
Epoch: 7, Steps: 4 | Train Loss: 0.614 Vali Loss: 2.112 Vali Acc: 0.260 Test Loss: 2.112 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5130150318145752
Epoch: 8, Steps: 4 | Train Loss: 0.551 Vali Loss: 2.257 Vali Acc: 0.280 Test Loss: 2.257 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5844190120697021
Epoch: 9, Steps: 4 | Train Loss: 0.423 Vali Loss: 2.483 Vali Acc: 0.260 Test Loss: 2.483 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.4894285202026367
Epoch: 10, Steps: 4 | Train Loss: 0.325 Vali Loss: 2.792 Vali Acc: 0.300 Test Loss: 2.792 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3767414093017578
Epoch: 11, Steps: 4 | Train Loss: 0.263 Vali Loss: 2.982 Vali Acc: 0.240 Test Loss: 2.982 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.504481554031372
Epoch: 12, Steps: 4 | Train Loss: 0.214 Vali Loss: 2.815 Vali Acc: 0.260 Test Loss: 2.815 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.4676439762115479
Epoch: 13, Steps: 4 | Train Loss: 0.181 Vali Loss: 2.920 Vali Acc: 0.260 Test Loss: 2.920 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.5428829193115234
Epoch: 14, Steps: 4 | Train Loss: 0.356 Vali Loss: 3.313 Vali Acc: 0.220 Test Loss: 3.313 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.3090236186981201
Epoch: 15, Steps: 4 | Train Loss: 0.129 Vali Loss: 3.830 Vali Acc: 0.300 Test Loss: 3.830 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.1156184673309326
Epoch: 16, Steps: 4 | Train Loss: 0.093 Vali Loss: 4.165 Vali Acc: 0.220 Test Loss: 4.165 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2731033
model size : 15.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8323237895965576
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.505 Vali Acc: 0.220 Test Loss: 1.505 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 1.3376801013946533
Epoch: 2, Steps: 4 | Train Loss: 1.425 Vali Loss: 1.487 Vali Acc: 0.260 Test Loss: 1.487 Test Acc: 0.260
Validation loss decreased (-0.219985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.2045841217041016
Epoch: 3, Steps: 4 | Train Loss: 1.274 Vali Loss: 1.545 Vali Acc: 0.260 Test Loss: 1.545 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3063855171203613
Epoch: 4, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.637 Vali Acc: 0.240 Test Loss: 1.637 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3839282989501953
Epoch: 5, Steps: 4 | Train Loss: 1.065 Vali Loss: 1.707 Vali Acc: 0.240 Test Loss: 1.707 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3962302207946777
Epoch: 6, Steps: 4 | Train Loss: 0.940 Vali Loss: 1.878 Vali Acc: 0.280 Test Loss: 1.878 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.4185903072357178
Epoch: 7, Steps: 4 | Train Loss: 0.680 Vali Loss: 2.048 Vali Acc: 0.220 Test Loss: 2.048 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2138314247131348
Epoch: 8, Steps: 4 | Train Loss: 0.603 Vali Loss: 2.169 Vali Acc: 0.260 Test Loss: 2.169 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.387223720550537
Epoch: 9, Steps: 4 | Train Loss: 0.476 Vali Loss: 2.404 Vali Acc: 0.260 Test Loss: 2.404 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.39501953125
Epoch: 10, Steps: 4 | Train Loss: 0.358 Vali Loss: 2.720 Vali Acc: 0.300 Test Loss: 2.720 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299973).  Saving model ...
Epoch: 11 cost time: 1.3223462104797363
Epoch: 11, Steps: 4 | Train Loss: 0.295 Vali Loss: 2.898 Vali Acc: 0.260 Test Loss: 2.898 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3710060119628906
Epoch: 12, Steps: 4 | Train Loss: 0.243 Vali Loss: 2.780 Vali Acc: 0.240 Test Loss: 2.780 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3635766506195068
Epoch: 13, Steps: 4 | Train Loss: 0.200 Vali Loss: 2.868 Vali Acc: 0.280 Test Loss: 2.868 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.572019338607788
Epoch: 14, Steps: 4 | Train Loss: 0.428 Vali Loss: 3.268 Vali Acc: 0.220 Test Loss: 3.268 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.513235330581665
Epoch: 15, Steps: 4 | Train Loss: 0.159 Vali Loss: 3.735 Vali Acc: 0.260 Test Loss: 3.735 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.368652105331421
Epoch: 16, Steps: 4 | Train Loss: 0.118 Vali Loss: 4.115 Vali Acc: 0.240 Test Loss: 4.115 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.5059351921081543
Epoch: 17, Steps: 4 | Train Loss: 0.084 Vali Loss: 4.521 Vali Acc: 0.220 Test Loss: 4.521 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.5972926616668701
Epoch: 18, Steps: 4 | Train Loss: 0.060 Vali Loss: 5.071 Vali Acc: 0.260 Test Loss: 5.071 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4378271102905273
Epoch: 19, Steps: 4 | Train Loss: 0.037 Vali Loss: 5.444 Vali Acc: 0.200 Test Loss: 5.444 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.271618127822876
Epoch: 20, Steps: 4 | Train Loss: 0.027 Vali Loss: 5.693 Vali Acc: 0.240 Test Loss: 5.693 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2731033
model size : 15.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8394551277160645
Epoch: 1, Steps: 4 | Train Loss: 1.690 Vali Loss: 1.509 Vali Acc: 0.240 Test Loss: 1.509 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.5360496044158936
Epoch: 2, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.506 Vali Acc: 0.260 Test Loss: 1.506 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.4465982913970947
Epoch: 3, Steps: 4 | Train Loss: 1.300 Vali Loss: 1.556 Vali Acc: 0.260 Test Loss: 1.556 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3465566635131836
Epoch: 4, Steps: 4 | Train Loss: 1.104 Vali Loss: 1.620 Vali Acc: 0.240 Test Loss: 1.620 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4844765663146973
Epoch: 5, Steps: 4 | Train Loss: 1.109 Vali Loss: 1.652 Vali Acc: 0.280 Test Loss: 1.652 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279983).  Saving model ...
Epoch: 6 cost time: 1.2871055603027344
Epoch: 6, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.797 Vali Acc: 0.260 Test Loss: 1.797 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3383917808532715
Epoch: 7, Steps: 4 | Train Loss: 0.765 Vali Loss: 1.935 Vali Acc: 0.280 Test Loss: 1.935 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.475311040878296
Epoch: 8, Steps: 4 | Train Loss: 0.695 Vali Loss: 2.048 Vali Acc: 0.240 Test Loss: 2.048 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4037327766418457
Epoch: 9, Steps: 4 | Train Loss: 0.567 Vali Loss: 2.260 Vali Acc: 0.220 Test Loss: 2.260 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3483400344848633
Epoch: 10, Steps: 4 | Train Loss: 0.416 Vali Loss: 2.547 Vali Acc: 0.260 Test Loss: 2.547 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3459532260894775
Epoch: 11, Steps: 4 | Train Loss: 0.351 Vali Loss: 2.761 Vali Acc: 0.220 Test Loss: 2.761 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1972758769989014
Epoch: 12, Steps: 4 | Train Loss: 0.295 Vali Loss: 2.888 Vali Acc: 0.240 Test Loss: 2.888 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2990951538085938
Epoch: 13, Steps: 4 | Train Loss: 0.247 Vali Loss: 3.196 Vali Acc: 0.220 Test Loss: 3.196 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4682135581970215
Epoch: 14, Steps: 4 | Train Loss: 0.505 Vali Loss: 3.795 Vali Acc: 0.220 Test Loss: 3.795 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.473656415939331
Epoch: 15, Steps: 4 | Train Loss: 0.217 Vali Loss: 4.441 Vali Acc: 0.300 Test Loss: 4.441 Test Acc: 0.300
Validation loss decreased (-0.279983 --> -0.299956).  Saving model ...
Epoch: 16 cost time: 1.408416748046875
Epoch: 16, Steps: 4 | Train Loss: 0.162 Vali Loss: 4.794 Vali Acc: 0.240 Test Loss: 4.794 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2523078918457031
Epoch: 17, Steps: 4 | Train Loss: 0.117 Vali Loss: 5.055 Vali Acc: 0.240 Test Loss: 5.055 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.445295810699463
Epoch: 18, Steps: 4 | Train Loss: 0.103 Vali Loss: 5.392 Vali Acc: 0.260 Test Loss: 5.392 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3893604278564453
Epoch: 19, Steps: 4 | Train Loss: 0.067 Vali Loss: 5.565 Vali Acc: 0.260 Test Loss: 5.565 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3726298809051514
Epoch: 20, Steps: 4 | Train Loss: 0.052 Vali Loss: 5.848 Vali Acc: 0.260 Test Loss: 5.848 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.224987268447876
Epoch: 21, Steps: 4 | Train Loss: 0.039 Vali Loss: 6.094 Vali Acc: 0.260 Test Loss: 6.094 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.4007892608642578
Epoch: 22, Steps: 4 | Train Loss: 0.031 Vali Loss: 6.587 Vali Acc: 0.280 Test Loss: 6.587 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3425750732421875
Epoch: 23, Steps: 4 | Train Loss: 0.048 Vali Loss: 6.402 Vali Acc: 0.240 Test Loss: 6.402 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.4225311279296875
Epoch: 24, Steps: 4 | Train Loss: 0.039 Vali Loss: 6.638 Vali Acc: 0.240 Test Loss: 6.638 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.5386242866516113
Epoch: 25, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.871 Vali Acc: 0.240 Test Loss: 6.871 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2731033
model size : 15.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8389666080474854
Epoch: 1, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.537 Vali Acc: 0.220 Test Loss: 1.537 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 1.129342794418335
Epoch: 2, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.523 Vali Acc: 0.260 Test Loss: 1.523 Test Acc: 0.260
Validation loss decreased (-0.219985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.1925301551818848
Epoch: 3, Steps: 4 | Train Loss: 1.309 Vali Loss: 1.539 Vali Acc: 0.240 Test Loss: 1.539 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.315131425857544
Epoch: 4, Steps: 4 | Train Loss: 1.141 Vali Loss: 1.543 Vali Acc: 0.200 Test Loss: 1.543 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3883700370788574
Epoch: 5, Steps: 4 | Train Loss: 1.153 Vali Loss: 1.547 Vali Acc: 0.240 Test Loss: 1.547 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1924922466278076
Epoch: 6, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.641 Vali Acc: 0.220 Test Loss: 1.641 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2836976051330566
Epoch: 7, Steps: 4 | Train Loss: 0.859 Vali Loss: 1.732 Vali Acc: 0.200 Test Loss: 1.732 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2908110618591309
Epoch: 8, Steps: 4 | Train Loss: 0.787 Vali Loss: 1.812 Vali Acc: 0.200 Test Loss: 1.812 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3013060092926025
Epoch: 9, Steps: 4 | Train Loss: 0.647 Vali Loss: 1.954 Vali Acc: 0.240 Test Loss: 1.954 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.4001033306121826
Epoch: 10, Steps: 4 | Train Loss: 0.483 Vali Loss: 2.138 Vali Acc: 0.240 Test Loss: 2.138 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.175621747970581
Epoch: 11, Steps: 4 | Train Loss: 0.407 Vali Loss: 2.245 Vali Acc: 0.220 Test Loss: 2.245 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.2734839916229248
Epoch: 12, Steps: 4 | Train Loss: 0.333 Vali Loss: 2.325 Vali Acc: 0.260 Test Loss: 2.325 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 2731033
model size : 15.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.73811674118042
Epoch: 1, Steps: 4 | Train Loss: 1.607 Vali Loss: 1.531 Vali Acc: 0.140 Test Loss: 1.531 Test Acc: 0.140
Validation loss decreased (inf --> -0.139985).  Saving model ...
Epoch: 2 cost time: 1.1610958576202393
Epoch: 2, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.515 Vali Acc: 0.180 Test Loss: 1.515 Test Acc: 0.180
Validation loss decreased (-0.139985 --> -0.179985).  Saving model ...
Epoch: 3 cost time: 1.2066590785980225
Epoch: 3, Steps: 4 | Train Loss: 1.229 Vali Loss: 1.557 Vali Acc: 0.200 Test Loss: 1.557 Test Acc: 0.200
Validation loss decreased (-0.179985 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.3205420970916748
Epoch: 4, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.720 Vali Acc: 0.220 Test Loss: 1.720 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 1.295863389968872
Epoch: 5, Steps: 4 | Train Loss: 0.940 Vali Loss: 1.801 Vali Acc: 0.260 Test Loss: 1.801 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259982).  Saving model ...
Epoch: 6 cost time: 1.3630576133728027
Epoch: 6, Steps: 4 | Train Loss: 0.753 Vali Loss: 1.857 Vali Acc: 0.220 Test Loss: 1.857 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1917634010314941
Epoch: 7, Steps: 4 | Train Loss: 0.752 Vali Loss: 2.030 Vali Acc: 0.240 Test Loss: 2.030 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2467644214630127
Epoch: 8, Steps: 4 | Train Loss: 0.679 Vali Loss: 2.216 Vali Acc: 0.280 Test Loss: 2.216 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279978).  Saving model ...
Epoch: 9 cost time: 1.2729127407073975
Epoch: 9, Steps: 4 | Train Loss: 0.376 Vali Loss: 2.390 Vali Acc: 0.260 Test Loss: 2.390 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1965467929840088
Epoch: 10, Steps: 4 | Train Loss: 0.351 Vali Loss: 2.717 Vali Acc: 0.280 Test Loss: 2.717 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.386681318283081
Epoch: 11, Steps: 4 | Train Loss: 0.342 Vali Loss: 2.744 Vali Acc: 0.260 Test Loss: 2.744 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1954855918884277
Epoch: 12, Steps: 4 | Train Loss: 0.235 Vali Loss: 2.993 Vali Acc: 0.280 Test Loss: 2.993 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.0295135974884033
Epoch: 13, Steps: 4 | Train Loss: 0.221 Vali Loss: 3.050 Vali Acc: 0.220 Test Loss: 3.050 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2357988357543945
Epoch: 14, Steps: 4 | Train Loss: 0.222 Vali Loss: 3.523 Vali Acc: 0.260 Test Loss: 3.523 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2379779815673828
Epoch: 15, Steps: 4 | Train Loss: 0.112 Vali Loss: 4.159 Vali Acc: 0.240 Test Loss: 4.159 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2076244354248047
Epoch: 16, Steps: 4 | Train Loss: 0.105 Vali Loss: 4.396 Vali Acc: 0.260 Test Loss: 4.396 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.1285350322723389
Epoch: 17, Steps: 4 | Train Loss: 0.149 Vali Loss: 4.422 Vali Acc: 0.220 Test Loss: 4.422 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.2315864562988281
Epoch: 18, Steps: 4 | Train Loss: 0.047 Vali Loss: 5.007 Vali Acc: 0.280 Test Loss: 5.007 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2468889
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7075695991516113
Epoch: 1, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.505 Vali Acc: 0.180 Test Loss: 1.505 Test Acc: 0.180
Validation loss decreased (inf --> -0.179985).  Saving model ...
Epoch: 2 cost time: 1.2872023582458496
Epoch: 2, Steps: 4 | Train Loss: 1.539 Vali Loss: 1.480 Vali Acc: 0.160 Test Loss: 1.480 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3020648956298828
Epoch: 3, Steps: 4 | Train Loss: 1.252 Vali Loss: 1.525 Vali Acc: 0.240 Test Loss: 1.525 Test Acc: 0.240
Validation loss decreased (-0.179985 --> -0.239985).  Saving model ...
Epoch: 4 cost time: 1.384714126586914
Epoch: 4, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.669 Vali Acc: 0.240 Test Loss: 1.669 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3878016471862793
Epoch: 5, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.742 Vali Acc: 0.260 Test Loss: 1.742 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259983).  Saving model ...
Epoch: 6 cost time: 1.3817424774169922
Epoch: 6, Steps: 4 | Train Loss: 0.786 Vali Loss: 1.810 Vali Acc: 0.240 Test Loss: 1.810 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.3948023319244385
Epoch: 7, Steps: 4 | Train Loss: 0.800 Vali Loss: 2.007 Vali Acc: 0.220 Test Loss: 2.007 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.549302339553833
Epoch: 8, Steps: 4 | Train Loss: 0.725 Vali Loss: 2.191 Vali Acc: 0.300 Test Loss: 2.191 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299978).  Saving model ...
Epoch: 9 cost time: 1.5596823692321777
Epoch: 9, Steps: 4 | Train Loss: 0.406 Vali Loss: 2.364 Vali Acc: 0.240 Test Loss: 2.364 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2747557163238525
Epoch: 10, Steps: 4 | Train Loss: 0.387 Vali Loss: 2.686 Vali Acc: 0.280 Test Loss: 2.686 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.40922212600708
Epoch: 11, Steps: 4 | Train Loss: 0.378 Vali Loss: 2.751 Vali Acc: 0.300 Test Loss: 2.751 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4482085704803467
Epoch: 12, Steps: 4 | Train Loss: 0.257 Vali Loss: 2.988 Vali Acc: 0.280 Test Loss: 2.988 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.521756887435913
Epoch: 13, Steps: 4 | Train Loss: 0.255 Vali Loss: 3.150 Vali Acc: 0.220 Test Loss: 3.150 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.481868028640747
Epoch: 14, Steps: 4 | Train Loss: 0.245 Vali Loss: 3.587 Vali Acc: 0.240 Test Loss: 3.587 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.5524280071258545
Epoch: 15, Steps: 4 | Train Loss: 0.125 Vali Loss: 4.123 Vali Acc: 0.220 Test Loss: 4.123 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2612314224243164
Epoch: 16, Steps: 4 | Train Loss: 0.106 Vali Loss: 4.308 Vali Acc: 0.200 Test Loss: 4.308 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2627804279327393
Epoch: 17, Steps: 4 | Train Loss: 0.192 Vali Loss: 4.699 Vali Acc: 0.240 Test Loss: 4.699 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.353165626525879
Epoch: 18, Steps: 4 | Train Loss: 0.053 Vali Loss: 5.415 Vali Acc: 0.280 Test Loss: 5.415 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2468889
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.062039852142334
Epoch: 1, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.502 Vali Acc: 0.200 Test Loss: 1.502 Test Acc: 0.200
Validation loss decreased (inf --> -0.199985).  Saving model ...
Epoch: 2 cost time: 1.2141664028167725
Epoch: 2, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.482 Vali Acc: 0.160 Test Loss: 1.482 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2326629161834717
Epoch: 3, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.518 Vali Acc: 0.220 Test Loss: 1.518 Test Acc: 0.220
Validation loss decreased (-0.199985 --> -0.219985).  Saving model ...
Epoch: 4 cost time: 1.4859912395477295
Epoch: 4, Steps: 4 | Train Loss: 1.060 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
Validation loss decreased (-0.219985 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.3553667068481445
Epoch: 5, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.715 Vali Acc: 0.240 Test Loss: 1.715 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.5683012008666992
Epoch: 6, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.774 Vali Acc: 0.240 Test Loss: 1.774 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3588535785675049
Epoch: 7, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.942 Vali Acc: 0.220 Test Loss: 1.942 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.4089429378509521
Epoch: 8, Steps: 4 | Train Loss: 0.795 Vali Loss: 2.119 Vali Acc: 0.240 Test Loss: 2.119 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.379762887954712
Epoch: 9, Steps: 4 | Train Loss: 0.456 Vali Loss: 2.264 Vali Acc: 0.260 Test Loss: 2.264 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259977).  Saving model ...
Epoch: 10 cost time: 1.318974494934082
Epoch: 10, Steps: 4 | Train Loss: 0.437 Vali Loss: 2.536 Vali Acc: 0.300 Test Loss: 2.536 Test Acc: 0.300
Validation loss decreased (-0.259977 --> -0.299975).  Saving model ...
Epoch: 11 cost time: 1.341705083847046
Epoch: 11, Steps: 4 | Train Loss: 0.429 Vali Loss: 2.615 Vali Acc: 0.240 Test Loss: 2.615 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2811756134033203
Epoch: 12, Steps: 4 | Train Loss: 0.295 Vali Loss: 2.946 Vali Acc: 0.240 Test Loss: 2.946 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3024685382843018
Epoch: 13, Steps: 4 | Train Loss: 0.308 Vali Loss: 3.215 Vali Acc: 0.220 Test Loss: 3.215 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.260133981704712
Epoch: 14, Steps: 4 | Train Loss: 0.307 Vali Loss: 3.499 Vali Acc: 0.260 Test Loss: 3.499 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.376103162765503
Epoch: 15, Steps: 4 | Train Loss: 0.173 Vali Loss: 4.121 Vali Acc: 0.240 Test Loss: 4.121 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3166618347167969
Epoch: 16, Steps: 4 | Train Loss: 0.141 Vali Loss: 4.699 Vali Acc: 0.220 Test Loss: 4.699 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4813213348388672
Epoch: 17, Steps: 4 | Train Loss: 0.290 Vali Loss: 4.923 Vali Acc: 0.260 Test Loss: 4.923 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.321207046508789
Epoch: 18, Steps: 4 | Train Loss: 0.099 Vali Loss: 5.363 Vali Acc: 0.300 Test Loss: 5.363 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.1729192733764648
Epoch: 19, Steps: 4 | Train Loss: 0.119 Vali Loss: 5.534 Vali Acc: 0.260 Test Loss: 5.534 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2468955516815186
Epoch: 20, Steps: 4 | Train Loss: 0.046 Vali Loss: 5.876 Vali Acc: 0.240 Test Loss: 5.876 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2468889
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.77309250831604
Epoch: 1, Steps: 4 | Train Loss: 1.621 Vali Loss: 1.574 Vali Acc: 0.140 Test Loss: 1.574 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.337395191192627
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.556 Vali Acc: 0.160 Test Loss: 1.556 Test Acc: 0.160
Validation loss decreased (-0.139984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.135054111480713
Epoch: 3, Steps: 4 | Train Loss: 1.325 Vali Loss: 1.551 Vali Acc: 0.220 Test Loss: 1.551 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.3205485343933105
Epoch: 4, Steps: 4 | Train Loss: 1.116 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.367318868637085
Epoch: 5, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.635 Vali Acc: 0.220 Test Loss: 1.635 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1673026084899902
Epoch: 6, Steps: 4 | Train Loss: 0.934 Vali Loss: 1.675 Vali Acc: 0.200 Test Loss: 1.675 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1018123626708984
Epoch: 7, Steps: 4 | Train Loss: 0.969 Vali Loss: 1.815 Vali Acc: 0.200 Test Loss: 1.815 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.248356819152832
Epoch: 8, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.928 Vali Acc: 0.240 Test Loss: 1.928 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239981).  Saving model ...
Epoch: 9 cost time: 1.2245292663574219
Epoch: 9, Steps: 4 | Train Loss: 0.536 Vali Loss: 1.992 Vali Acc: 0.260 Test Loss: 1.992 Test Acc: 0.260
Validation loss decreased (-0.239981 --> -0.259980).  Saving model ...
Epoch: 10 cost time: 1.074099063873291
Epoch: 10, Steps: 4 | Train Loss: 0.536 Vali Loss: 2.153 Vali Acc: 0.220 Test Loss: 2.153 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.307096004486084
Epoch: 11, Steps: 4 | Train Loss: 0.493 Vali Loss: 2.143 Vali Acc: 0.260 Test Loss: 2.143 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2945494651794434
Epoch: 12, Steps: 4 | Train Loss: 0.365 Vali Loss: 2.336 Vali Acc: 0.300 Test Loss: 2.336 Test Acc: 0.300
Validation loss decreased (-0.259980 --> -0.299977).  Saving model ...
Epoch: 13 cost time: 1.2045292854309082
Epoch: 13, Steps: 4 | Train Loss: 0.401 Vali Loss: 2.487 Vali Acc: 0.280 Test Loss: 2.487 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3658151626586914
Epoch: 14, Steps: 4 | Train Loss: 0.397 Vali Loss: 2.685 Vali Acc: 0.300 Test Loss: 2.685 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2631747722625732
Epoch: 15, Steps: 4 | Train Loss: 0.217 Vali Loss: 2.884 Vali Acc: 0.320 Test Loss: 2.884 Test Acc: 0.320
Validation loss decreased (-0.299977 --> -0.319971).  Saving model ...
Epoch: 16 cost time: 1.2636773586273193
Epoch: 16, Steps: 4 | Train Loss: 0.176 Vali Loss: 3.310 Vali Acc: 0.240 Test Loss: 3.310 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2839593887329102
Epoch: 17, Steps: 4 | Train Loss: 0.280 Vali Loss: 3.593 Vali Acc: 0.240 Test Loss: 3.593 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2895281314849854
Epoch: 18, Steps: 4 | Train Loss: 0.156 Vali Loss: 4.025 Vali Acc: 0.240 Test Loss: 4.025 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3806941509246826
Epoch: 19, Steps: 4 | Train Loss: 0.188 Vali Loss: 3.785 Vali Acc: 0.260 Test Loss: 3.785 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3487372398376465
Epoch: 20, Steps: 4 | Train Loss: 0.064 Vali Loss: 4.080 Vali Acc: 0.240 Test Loss: 4.080 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3102173805236816
Epoch: 21, Steps: 4 | Train Loss: 0.042 Vali Loss: 4.527 Vali Acc: 0.300 Test Loss: 4.527 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2345702648162842
Epoch: 22, Steps: 4 | Train Loss: 0.033 Vali Loss: 5.078 Vali Acc: 0.300 Test Loss: 5.078 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5069081783294678
Epoch: 23, Steps: 4 | Train Loss: 0.020 Vali Loss: 5.335 Vali Acc: 0.300 Test Loss: 5.335 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1321284770965576
Epoch: 24, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.423 Vali Acc: 0.300 Test Loss: 5.423 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1666224002838135
Epoch: 25, Steps: 4 | Train Loss: 0.018 Vali Loss: 5.385 Vali Acc: 0.300 Test Loss: 5.385 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 2468889
model size : 14.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.514796733856201
Epoch: 1, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.675 Vali Acc: 0.180 Test Loss: 1.675 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.49896240234375
Epoch: 2, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.602 Vali Acc: 0.220 Test Loss: 1.602 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.3945424556732178
Epoch: 3, Steps: 4 | Train Loss: 1.319 Vali Loss: 1.711 Vali Acc: 0.240 Test Loss: 1.711 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.5157747268676758
Epoch: 4, Steps: 4 | Train Loss: 1.124 Vali Loss: 1.930 Vali Acc: 0.280 Test Loss: 1.930 Test Acc: 0.280
Validation loss decreased (-0.239983 --> -0.279981).  Saving model ...
Epoch: 5 cost time: 1.2757251262664795
Epoch: 5, Steps: 4 | Train Loss: 0.975 Vali Loss: 1.979 Vali Acc: 0.180 Test Loss: 1.979 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.250473976135254
Epoch: 6, Steps: 4 | Train Loss: 0.770 Vali Loss: 2.038 Vali Acc: 0.240 Test Loss: 2.038 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3413035869598389
Epoch: 7, Steps: 4 | Train Loss: 0.541 Vali Loss: 2.212 Vali Acc: 0.220 Test Loss: 2.212 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.370539665222168
Epoch: 8, Steps: 4 | Train Loss: 0.479 Vali Loss: 2.387 Vali Acc: 0.280 Test Loss: 2.387 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.226931095123291
Epoch: 9, Steps: 4 | Train Loss: 0.617 Vali Loss: 2.668 Vali Acc: 0.240 Test Loss: 2.668 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3996496200561523
Epoch: 10, Steps: 4 | Train Loss: 0.338 Vali Loss: 2.944 Vali Acc: 0.240 Test Loss: 2.944 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3083527088165283
Epoch: 11, Steps: 4 | Train Loss: 0.413 Vali Loss: 2.964 Vali Acc: 0.280 Test Loss: 2.964 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3831853866577148
Epoch: 12, Steps: 4 | Train Loss: 0.259 Vali Loss: 3.158 Vali Acc: 0.240 Test Loss: 3.158 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4626858234405518
Epoch: 13, Steps: 4 | Train Loss: 0.227 Vali Loss: 3.228 Vali Acc: 0.280 Test Loss: 3.228 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.4972755908966064
Epoch: 14, Steps: 4 | Train Loss: 0.168 Vali Loss: 3.335 Vali Acc: 0.240 Test Loss: 3.335 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2337817
model size : 13.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.221824407577515
Epoch: 1, Steps: 4 | Train Loss: 1.642 Vali Loss: 1.661 Vali Acc: 0.140 Test Loss: 1.661 Test Acc: 0.140
Validation loss decreased (inf --> -0.139983).  Saving model ...
Epoch: 2 cost time: 1.2641479969024658
Epoch: 2, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.596 Vali Acc: 0.220 Test Loss: 1.596 Test Acc: 0.220
Validation loss decreased (-0.139983 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.3136146068572998
Epoch: 3, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239983).  Saving model ...
Epoch: 4 cost time: 1.4688372611999512
Epoch: 4, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.869 Vali Acc: 0.300 Test Loss: 1.869 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299981).  Saving model ...
Epoch: 5 cost time: 1.2550806999206543
Epoch: 5, Steps: 4 | Train Loss: 1.007 Vali Loss: 1.934 Vali Acc: 0.240 Test Loss: 1.934 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.298335313796997
Epoch: 6, Steps: 4 | Train Loss: 0.814 Vali Loss: 1.992 Vali Acc: 0.260 Test Loss: 1.992 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2276182174682617
Epoch: 7, Steps: 4 | Train Loss: 0.581 Vali Loss: 2.163 Vali Acc: 0.280 Test Loss: 2.163 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.172785758972168
Epoch: 8, Steps: 4 | Train Loss: 0.518 Vali Loss: 2.317 Vali Acc: 0.280 Test Loss: 2.317 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1966750621795654
Epoch: 9, Steps: 4 | Train Loss: 0.626 Vali Loss: 2.580 Vali Acc: 0.260 Test Loss: 2.580 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2500462532043457
Epoch: 10, Steps: 4 | Train Loss: 0.370 Vali Loss: 2.822 Vali Acc: 0.240 Test Loss: 2.822 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.17919921875
Epoch: 11, Steps: 4 | Train Loss: 0.432 Vali Loss: 2.891 Vali Acc: 0.280 Test Loss: 2.891 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3576481342315674
Epoch: 12, Steps: 4 | Train Loss: 0.292 Vali Loss: 3.122 Vali Acc: 0.240 Test Loss: 3.122 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.3972282409667969
Epoch: 13, Steps: 4 | Train Loss: 0.238 Vali Loss: 3.167 Vali Acc: 0.280 Test Loss: 3.167 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.5450620651245117
Epoch: 14, Steps: 4 | Train Loss: 0.185 Vali Loss: 3.327 Vali Acc: 0.220 Test Loss: 3.327 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2337817
model size : 13.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5086724758148193
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.5730488300323486
Epoch: 2, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.582 Vali Acc: 0.240 Test Loss: 1.582 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.376434087753296
Epoch: 3, Steps: 4 | Train Loss: 1.360 Vali Loss: 1.633 Vali Acc: 0.220 Test Loss: 1.633 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.512824296951294
Epoch: 4, Steps: 4 | Train Loss: 1.183 Vali Loss: 1.804 Vali Acc: 0.200 Test Loss: 1.804 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3189585208892822
Epoch: 5, Steps: 4 | Train Loss: 1.047 Vali Loss: 1.854 Vali Acc: 0.200 Test Loss: 1.854 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.493638515472412
Epoch: 6, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.907 Vali Acc: 0.220 Test Loss: 1.907 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3681731224060059
Epoch: 7, Steps: 4 | Train Loss: 0.631 Vali Loss: 2.045 Vali Acc: 0.220 Test Loss: 2.045 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2378127574920654
Epoch: 8, Steps: 4 | Train Loss: 0.577 Vali Loss: 2.179 Vali Acc: 0.280 Test Loss: 2.179 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279978).  Saving model ...
Epoch: 9 cost time: 1.1732776165008545
Epoch: 9, Steps: 4 | Train Loss: 0.676 Vali Loss: 2.450 Vali Acc: 0.260 Test Loss: 2.450 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3469150066375732
Epoch: 10, Steps: 4 | Train Loss: 0.423 Vali Loss: 2.656 Vali Acc: 0.180 Test Loss: 2.656 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4482121467590332
Epoch: 11, Steps: 4 | Train Loss: 0.501 Vali Loss: 2.750 Vali Acc: 0.280 Test Loss: 2.750 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.4433681964874268
Epoch: 12, Steps: 4 | Train Loss: 0.335 Vali Loss: 3.008 Vali Acc: 0.280 Test Loss: 3.008 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.3221168518066406
Epoch: 13, Steps: 4 | Train Loss: 0.271 Vali Loss: 3.239 Vali Acc: 0.260 Test Loss: 3.239 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.5324854850769043
Epoch: 14, Steps: 4 | Train Loss: 0.232 Vali Loss: 3.573 Vali Acc: 0.260 Test Loss: 3.573 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4143619537353516
Epoch: 15, Steps: 4 | Train Loss: 0.214 Vali Loss: 4.227 Vali Acc: 0.220 Test Loss: 4.227 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.3753743171691895
Epoch: 16, Steps: 4 | Train Loss: 0.239 Vali Loss: 4.845 Vali Acc: 0.240 Test Loss: 4.845 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2335047721862793
Epoch: 17, Steps: 4 | Train Loss: 0.230 Vali Loss: 4.551 Vali Acc: 0.220 Test Loss: 4.551 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.244070053100586
Epoch: 18, Steps: 4 | Train Loss: 0.130 Vali Loss: 5.125 Vali Acc: 0.240 Test Loss: 5.125 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2337817
model size : 13.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3555827140808105
Epoch: 1, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.598 Vali Acc: 0.380 Test Loss: 1.598 Test Acc: 0.380
Validation loss decreased (inf --> -0.379984).  Saving model ...
Epoch: 2 cost time: 1.1313576698303223
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.556 Vali Acc: 0.200 Test Loss: 1.556 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.254991054534912
Epoch: 3, Steps: 4 | Train Loss: 1.407 Vali Loss: 1.593 Vali Acc: 0.220 Test Loss: 1.593 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1969013214111328
Epoch: 4, Steps: 4 | Train Loss: 1.244 Vali Loss: 1.736 Vali Acc: 0.200 Test Loss: 1.736 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.361541748046875
Epoch: 5, Steps: 4 | Train Loss: 1.121 Vali Loss: 1.779 Vali Acc: 0.240 Test Loss: 1.779 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2994120121002197
Epoch: 6, Steps: 4 | Train Loss: 1.026 Vali Loss: 1.756 Vali Acc: 0.240 Test Loss: 1.756 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.2484405040740967
Epoch: 7, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.852 Vali Acc: 0.220 Test Loss: 1.852 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.248967170715332
Epoch: 8, Steps: 4 | Train Loss: 0.672 Vali Loss: 1.962 Vali Acc: 0.260 Test Loss: 1.962 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1641321182250977
Epoch: 9, Steps: 4 | Train Loss: 0.757 Vali Loss: 2.173 Vali Acc: 0.220 Test Loss: 2.173 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.1576440334320068
Epoch: 10, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.197 Vali Acc: 0.220 Test Loss: 2.197 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.306119441986084
Epoch: 11, Steps: 4 | Train Loss: 0.568 Vali Loss: 2.277 Vali Acc: 0.260 Test Loss: 2.277 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 2337817
model size : 13.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.829068422317505
Epoch: 1, Steps: 4 | Train Loss: 1.882 Vali Loss: 1.596 Vali Acc: 0.240 Test Loss: 1.596 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.1998424530029297
Epoch: 2, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.537 Vali Acc: 0.280 Test Loss: 1.537 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.1858007907867432
Epoch: 3, Steps: 4 | Train Loss: 1.358 Vali Loss: 1.582 Vali Acc: 0.240 Test Loss: 1.582 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.113633394241333
Epoch: 4, Steps: 4 | Train Loss: 1.112 Vali Loss: 1.700 Vali Acc: 0.220 Test Loss: 1.700 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2965810298919678
Epoch: 5, Steps: 4 | Train Loss: 0.840 Vali Loss: 1.825 Vali Acc: 0.240 Test Loss: 1.825 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.35109281539917
Epoch: 6, Steps: 4 | Train Loss: 0.821 Vali Loss: 1.993 Vali Acc: 0.260 Test Loss: 1.993 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3156723976135254
Epoch: 7, Steps: 4 | Train Loss: 0.774 Vali Loss: 2.124 Vali Acc: 0.260 Test Loss: 2.124 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.457040548324585
Epoch: 8, Steps: 4 | Train Loss: 0.651 Vali Loss: 2.377 Vali Acc: 0.200 Test Loss: 2.377 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.4446651935577393
Epoch: 9, Steps: 4 | Train Loss: 0.368 Vali Loss: 2.446 Vali Acc: 0.240 Test Loss: 2.446 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2408840656280518
Epoch: 10, Steps: 4 | Train Loss: 0.323 Vali Loss: 2.632 Vali Acc: 0.360 Test Loss: 2.632 Test Acc: 0.360
Validation loss decreased (-0.279985 --> -0.359974).  Saving model ...
Epoch: 11 cost time: 1.3007302284240723
Epoch: 11, Steps: 4 | Train Loss: 0.251 Vali Loss: 2.865 Vali Acc: 0.260 Test Loss: 2.865 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2265739440917969
Epoch: 12, Steps: 4 | Train Loss: 0.235 Vali Loss: 2.964 Vali Acc: 0.240 Test Loss: 2.964 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3449959754943848
Epoch: 13, Steps: 4 | Train Loss: 0.401 Vali Loss: 3.164 Vali Acc: 0.240 Test Loss: 3.164 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.470438003540039
Epoch: 14, Steps: 4 | Train Loss: 0.288 Vali Loss: 3.444 Vali Acc: 0.240 Test Loss: 3.444 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3162944316864014
Epoch: 15, Steps: 4 | Train Loss: 0.357 Vali Loss: 3.414 Vali Acc: 0.220 Test Loss: 3.414 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4889564514160156
Epoch: 16, Steps: 4 | Train Loss: 0.098 Vali Loss: 3.490 Vali Acc: 0.200 Test Loss: 3.490 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.4108147621154785
Epoch: 17, Steps: 4 | Train Loss: 0.086 Vali Loss: 3.966 Vali Acc: 0.240 Test Loss: 3.966 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.334601879119873
Epoch: 18, Steps: 4 | Train Loss: 0.264 Vali Loss: 4.907 Vali Acc: 0.260 Test Loss: 4.907 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.3031938076019287
Epoch: 19, Steps: 4 | Train Loss: 0.044 Vali Loss: 4.532 Vali Acc: 0.220 Test Loss: 4.532 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3710119724273682
Epoch: 20, Steps: 4 | Train Loss: 0.037 Vali Loss: 4.441 Vali Acc: 0.240 Test Loss: 4.441 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 2272281
model size : 13.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7089078426361084
Epoch: 1, Steps: 4 | Train Loss: 1.758 Vali Loss: 1.580 Vali Acc: 0.260 Test Loss: 1.580 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.3275377750396729
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.523 Vali Acc: 0.280 Test Loss: 1.523 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.3342013359069824
Epoch: 3, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.559 Vali Acc: 0.220 Test Loss: 1.559 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3654179573059082
Epoch: 4, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.682 Vali Acc: 0.220 Test Loss: 1.682 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2522413730621338
Epoch: 5, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.788 Vali Acc: 0.240 Test Loss: 1.788 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.346360683441162
Epoch: 6, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.952 Vali Acc: 0.280 Test Loss: 1.952 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2584364414215088
Epoch: 7, Steps: 4 | Train Loss: 0.844 Vali Loss: 2.056 Vali Acc: 0.260 Test Loss: 2.056 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.0759074687957764
Epoch: 8, Steps: 4 | Train Loss: 0.687 Vali Loss: 2.296 Vali Acc: 0.260 Test Loss: 2.296 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.3848824501037598
Epoch: 9, Steps: 4 | Train Loss: 0.398 Vali Loss: 2.391 Vali Acc: 0.300 Test Loss: 2.391 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299976).  Saving model ...
Epoch: 10 cost time: 1.4261977672576904
Epoch: 10, Steps: 4 | Train Loss: 0.358 Vali Loss: 2.593 Vali Acc: 0.360 Test Loss: 2.593 Test Acc: 0.360
Validation loss decreased (-0.299976 --> -0.359974).  Saving model ...
Epoch: 11 cost time: 1.2699706554412842
Epoch: 11, Steps: 4 | Train Loss: 0.279 Vali Loss: 2.791 Vali Acc: 0.260 Test Loss: 2.791 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4619336128234863
Epoch: 12, Steps: 4 | Train Loss: 0.252 Vali Loss: 2.926 Vali Acc: 0.280 Test Loss: 2.926 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3442904949188232
Epoch: 13, Steps: 4 | Train Loss: 0.441 Vali Loss: 3.184 Vali Acc: 0.240 Test Loss: 3.184 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4045119285583496
Epoch: 14, Steps: 4 | Train Loss: 0.328 Vali Loss: 3.685 Vali Acc: 0.280 Test Loss: 3.685 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5882070064544678
Epoch: 15, Steps: 4 | Train Loss: 0.411 Vali Loss: 3.822 Vali Acc: 0.240 Test Loss: 3.822 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2225863933563232
Epoch: 16, Steps: 4 | Train Loss: 0.111 Vali Loss: 3.962 Vali Acc: 0.220 Test Loss: 3.962 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3802528381347656
Epoch: 17, Steps: 4 | Train Loss: 0.106 Vali Loss: 4.632 Vali Acc: 0.240 Test Loss: 4.632 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3994805812835693
Epoch: 18, Steps: 4 | Train Loss: 0.320 Vali Loss: 5.470 Vali Acc: 0.240 Test Loss: 5.470 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5563538074493408
Epoch: 19, Steps: 4 | Train Loss: 0.051 Vali Loss: 5.513 Vali Acc: 0.200 Test Loss: 5.513 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3290095329284668
Epoch: 20, Steps: 4 | Train Loss: 0.050 Vali Loss: 5.595 Vali Acc: 0.200 Test Loss: 5.595 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 2272281
model size : 13.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7903120517730713
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.596 Vali Acc: 0.200 Test Loss: 1.596 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.40578031539917
Epoch: 2, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.555 Vali Acc: 0.260 Test Loss: 1.555 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.3252134323120117
Epoch: 3, Steps: 4 | Train Loss: 1.360 Vali Loss: 1.580 Vali Acc: 0.220 Test Loss: 1.580 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2536702156066895
Epoch: 4, Steps: 4 | Train Loss: 1.159 Vali Loss: 1.665 Vali Acc: 0.240 Test Loss: 1.665 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2107398509979248
Epoch: 5, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.756 Vali Acc: 0.240 Test Loss: 1.756 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3146629333496094
Epoch: 6, Steps: 4 | Train Loss: 0.912 Vali Loss: 1.901 Vali Acc: 0.280 Test Loss: 1.901 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279981).  Saving model ...
Epoch: 7 cost time: 1.4312958717346191
Epoch: 7, Steps: 4 | Train Loss: 0.921 Vali Loss: 2.012 Vali Acc: 0.280 Test Loss: 2.012 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2329115867614746
Epoch: 8, Steps: 4 | Train Loss: 0.767 Vali Loss: 2.223 Vali Acc: 0.220 Test Loss: 2.223 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3173444271087646
Epoch: 9, Steps: 4 | Train Loss: 0.447 Vali Loss: 2.292 Vali Acc: 0.280 Test Loss: 2.292 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.423191785812378
Epoch: 10, Steps: 4 | Train Loss: 0.410 Vali Loss: 2.483 Vali Acc: 0.340 Test Loss: 2.483 Test Acc: 0.340
Validation loss decreased (-0.279981 --> -0.339975).  Saving model ...
Epoch: 11 cost time: 1.2699689865112305
Epoch: 11, Steps: 4 | Train Loss: 0.322 Vali Loss: 2.673 Vali Acc: 0.260 Test Loss: 2.673 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2679908275604248
Epoch: 12, Steps: 4 | Train Loss: 0.296 Vali Loss: 2.805 Vali Acc: 0.300 Test Loss: 2.805 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2991321086883545
Epoch: 13, Steps: 4 | Train Loss: 0.476 Vali Loss: 3.110 Vali Acc: 0.240 Test Loss: 3.110 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.1923081874847412
Epoch: 14, Steps: 4 | Train Loss: 0.378 Vali Loss: 3.631 Vali Acc: 0.280 Test Loss: 3.631 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3395023345947266
Epoch: 15, Steps: 4 | Train Loss: 0.503 Vali Loss: 3.924 Vali Acc: 0.240 Test Loss: 3.924 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4891126155853271
Epoch: 16, Steps: 4 | Train Loss: 0.142 Vali Loss: 4.059 Vali Acc: 0.240 Test Loss: 4.059 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2295405864715576
Epoch: 17, Steps: 4 | Train Loss: 0.137 Vali Loss: 4.623 Vali Acc: 0.260 Test Loss: 4.623 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2437052726745605
Epoch: 18, Steps: 4 | Train Loss: 0.411 Vali Loss: 5.573 Vali Acc: 0.280 Test Loss: 5.573 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4271724224090576
Epoch: 19, Steps: 4 | Train Loss: 0.074 Vali Loss: 5.588 Vali Acc: 0.320 Test Loss: 5.588 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.1652941703796387
Epoch: 20, Steps: 4 | Train Loss: 0.096 Vali Loss: 5.552 Vali Acc: 0.260 Test Loss: 5.552 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 2272281
model size : 13.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.018378257751465
Epoch: 1, Steps: 4 | Train Loss: 1.634 Vali Loss: 1.613 Vali Acc: 0.200 Test Loss: 1.613 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2127113342285156
Epoch: 2, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.576 Vali Acc: 0.300 Test Loss: 1.576 Test Acc: 0.300
Validation loss decreased (-0.199984 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.3598706722259521
Epoch: 3, Steps: 4 | Train Loss: 1.376 Vali Loss: 1.592 Vali Acc: 0.240 Test Loss: 1.592 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3735270500183105
Epoch: 4, Steps: 4 | Train Loss: 1.210 Vali Loss: 1.634 Vali Acc: 0.260 Test Loss: 1.634 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3748157024383545
Epoch: 5, Steps: 4 | Train Loss: 1.016 Vali Loss: 1.650 Vali Acc: 0.220 Test Loss: 1.650 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3064484596252441
Epoch: 6, Steps: 4 | Train Loss: 1.003 Vali Loss: 1.759 Vali Acc: 0.280 Test Loss: 1.759 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.39699387550354
Epoch: 7, Steps: 4 | Train Loss: 1.056 Vali Loss: 1.827 Vali Acc: 0.300 Test Loss: 1.827 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1755974292755127
Epoch: 8, Steps: 4 | Train Loss: 0.860 Vali Loss: 1.943 Vali Acc: 0.220 Test Loss: 1.943 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2516982555389404
Epoch: 9, Steps: 4 | Train Loss: 0.519 Vali Loss: 1.994 Vali Acc: 0.320 Test Loss: 1.994 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319980).  Saving model ...
Epoch: 10 cost time: 1.2851035594940186
Epoch: 10, Steps: 4 | Train Loss: 0.500 Vali Loss: 2.085 Vali Acc: 0.340 Test Loss: 2.085 Test Acc: 0.340
Validation loss decreased (-0.319980 --> -0.339979).  Saving model ...
Epoch: 11 cost time: 1.3514201641082764
Epoch: 11, Steps: 4 | Train Loss: 0.393 Vali Loss: 2.233 Vali Acc: 0.280 Test Loss: 2.233 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2491731643676758
Epoch: 12, Steps: 4 | Train Loss: 0.343 Vali Loss: 2.348 Vali Acc: 0.280 Test Loss: 2.348 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3173987865447998
Epoch: 13, Steps: 4 | Train Loss: 0.547 Vali Loss: 2.559 Vali Acc: 0.320 Test Loss: 2.559 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4563279151916504
Epoch: 14, Steps: 4 | Train Loss: 0.427 Vali Loss: 2.656 Vali Acc: 0.260 Test Loss: 2.656 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3960545063018799
Epoch: 15, Steps: 4 | Train Loss: 0.595 Vali Loss: 2.937 Vali Acc: 0.260 Test Loss: 2.937 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.1657090187072754
Epoch: 16, Steps: 4 | Train Loss: 0.176 Vali Loss: 3.015 Vali Acc: 0.240 Test Loss: 3.015 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3328819274902344
Epoch: 17, Steps: 4 | Train Loss: 0.162 Vali Loss: 3.264 Vali Acc: 0.280 Test Loss: 3.264 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.3410789966583252
Epoch: 18, Steps: 4 | Train Loss: 0.442 Vali Loss: 3.953 Vali Acc: 0.240 Test Loss: 3.953 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.4526174068450928
Epoch: 19, Steps: 4 | Train Loss: 0.096 Vali Loss: 4.228 Vali Acc: 0.300 Test Loss: 4.228 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.7006251811981201
Epoch: 20, Steps: 4 | Train Loss: 0.144 Vali Loss: 4.204 Vali Acc: 0.240 Test Loss: 4.204 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 2272281
model size : 13.56MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.115659713745117
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.600 Vali Acc: 0.160 Test Loss: 1.600 Test Acc: 0.160
Validation loss decreased (inf --> -0.159984).  Saving model ...
Epoch: 2 cost time: 1.2137279510498047
Epoch: 2, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.550 Vali Acc: 0.220 Test Loss: 1.550 Test Acc: 0.220
Validation loss decreased (-0.159984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.2620878219604492
Epoch: 3, Steps: 4 | Train Loss: 1.424 Vali Loss: 1.620 Vali Acc: 0.260 Test Loss: 1.620 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.2326388359069824
Epoch: 4, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.736 Vali Acc: 0.200 Test Loss: 1.736 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1742267608642578
Epoch: 5, Steps: 4 | Train Loss: 0.999 Vali Loss: 1.874 Vali Acc: 0.220 Test Loss: 1.874 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1639156341552734
Epoch: 6, Steps: 4 | Train Loss: 0.801 Vali Loss: 1.934 Vali Acc: 0.240 Test Loss: 1.934 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.435502052307129
Epoch: 7, Steps: 4 | Train Loss: 0.662 Vali Loss: 2.032 Vali Acc: 0.240 Test Loss: 2.032 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3037383556365967
Epoch: 8, Steps: 4 | Train Loss: 0.636 Vali Loss: 2.152 Vali Acc: 0.280 Test Loss: 2.152 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279978).  Saving model ...
Epoch: 9 cost time: 1.1800541877746582
Epoch: 9, Steps: 4 | Train Loss: 0.539 Vali Loss: 2.375 Vali Acc: 0.280 Test Loss: 2.375 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.467055082321167
Epoch: 10, Steps: 4 | Train Loss: 0.344 Vali Loss: 2.519 Vali Acc: 0.240 Test Loss: 2.519 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2263603210449219
Epoch: 11, Steps: 4 | Train Loss: 0.347 Vali Loss: 2.755 Vali Acc: 0.280 Test Loss: 2.755 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2537353038787842
Epoch: 12, Steps: 4 | Train Loss: 0.399 Vali Loss: 2.960 Vali Acc: 0.280 Test Loss: 2.960 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.259995937347412
Epoch: 13, Steps: 4 | Train Loss: 0.239 Vali Loss: 3.455 Vali Acc: 0.260 Test Loss: 3.455 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4191079139709473
Epoch: 14, Steps: 4 | Train Loss: 0.163 Vali Loss: 3.618 Vali Acc: 0.240 Test Loss: 3.618 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2706851959228516
Epoch: 15, Steps: 4 | Train Loss: 0.147 Vali Loss: 3.922 Vali Acc: 0.320 Test Loss: 3.922 Test Acc: 0.320
Validation loss decreased (-0.279978 --> -0.319961).  Saving model ...
Epoch: 16 cost time: 1.1633338928222656
Epoch: 16, Steps: 4 | Train Loss: 0.105 Vali Loss: 4.027 Vali Acc: 0.200 Test Loss: 4.027 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.416506290435791
Epoch: 17, Steps: 4 | Train Loss: 0.079 Vali Loss: 4.708 Vali Acc: 0.260 Test Loss: 4.708 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.283797025680542
Epoch: 18, Steps: 4 | Train Loss: 0.049 Vali Loss: 5.418 Vali Acc: 0.280 Test Loss: 5.418 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2021899223327637
Epoch: 19, Steps: 4 | Train Loss: 0.037 Vali Loss: 5.320 Vali Acc: 0.240 Test Loss: 5.320 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.460446834564209
Epoch: 20, Steps: 4 | Train Loss: 0.045 Vali Loss: 5.485 Vali Acc: 0.200 Test Loss: 5.485 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.3491766452789307
Epoch: 21, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.999 Vali Acc: 0.200 Test Loss: 5.999 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3983540534973145
Epoch: 22, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.514 Vali Acc: 0.240 Test Loss: 6.514 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2139849662780762
Epoch: 23, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.829 Vali Acc: 0.280 Test Loss: 6.829 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.3728749752044678
Epoch: 24, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.817 Vali Acc: 0.240 Test Loss: 6.817 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2108697891235352
Epoch: 25, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.520 Vali Acc: 0.240 Test Loss: 6.520 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 2239513
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7129666805267334
Epoch: 1, Steps: 4 | Train Loss: 1.702 Vali Loss: 1.568 Vali Acc: 0.220 Test Loss: 1.568 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.2438602447509766
Epoch: 2, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.539 Vali Acc: 0.200 Test Loss: 1.539 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3842878341674805
Epoch: 3, Steps: 4 | Train Loss: 1.434 Vali Loss: 1.601 Vali Acc: 0.300 Test Loss: 1.601 Test Acc: 0.300
Validation loss decreased (-0.219984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.5227911472320557
Epoch: 4, Steps: 4 | Train Loss: 1.087 Vali Loss: 1.708 Vali Acc: 0.220 Test Loss: 1.708 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4012236595153809
Epoch: 5, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.829 Vali Acc: 0.240 Test Loss: 1.829 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2805848121643066
Epoch: 6, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.883 Vali Acc: 0.220 Test Loss: 1.883 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.4109866619110107
Epoch: 7, Steps: 4 | Train Loss: 0.698 Vali Loss: 2.002 Vali Acc: 0.220 Test Loss: 2.002 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.453847885131836
Epoch: 8, Steps: 4 | Train Loss: 0.690 Vali Loss: 2.102 Vali Acc: 0.280 Test Loss: 2.102 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.3929626941680908
Epoch: 9, Steps: 4 | Train Loss: 0.593 Vali Loss: 2.312 Vali Acc: 0.240 Test Loss: 2.312 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5103988647460938
Epoch: 10, Steps: 4 | Train Loss: 0.377 Vali Loss: 2.487 Vali Acc: 0.240 Test Loss: 2.487 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.530308485031128
Epoch: 11, Steps: 4 | Train Loss: 0.371 Vali Loss: 2.735 Vali Acc: 0.260 Test Loss: 2.735 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.491560459136963
Epoch: 12, Steps: 4 | Train Loss: 0.432 Vali Loss: 2.971 Vali Acc: 0.240 Test Loss: 2.971 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.4718327522277832
Epoch: 13, Steps: 4 | Train Loss: 0.276 Vali Loss: 3.427 Vali Acc: 0.260 Test Loss: 3.427 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 2239513
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3057498931884766
Epoch: 1, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.551 Vali Acc: 0.280 Test Loss: 1.551 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.0582890510559082
Epoch: 2, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.534 Vali Acc: 0.200 Test Loss: 1.534 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1505625247955322
Epoch: 3, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.609 Vali Acc: 0.240 Test Loss: 1.609 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.3531734943389893
Epoch: 4, Steps: 4 | Train Loss: 1.123 Vali Loss: 1.692 Vali Acc: 0.220 Test Loss: 1.692 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.17972993850708
Epoch: 5, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.808 Vali Acc: 0.220 Test Loss: 1.808 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3713281154632568
Epoch: 6, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.853 Vali Acc: 0.220 Test Loss: 1.853 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.231278657913208
Epoch: 7, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.950 Vali Acc: 0.220 Test Loss: 1.950 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.4093024730682373
Epoch: 8, Steps: 4 | Train Loss: 0.770 Vali Loss: 2.054 Vali Acc: 0.260 Test Loss: 2.054 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.4029746055603027
Epoch: 9, Steps: 4 | Train Loss: 0.657 Vali Loss: 2.224 Vali Acc: 0.260 Test Loss: 2.224 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.340000867843628
Epoch: 10, Steps: 4 | Train Loss: 0.426 Vali Loss: 2.389 Vali Acc: 0.240 Test Loss: 2.389 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.3920183181762695
Epoch: 11, Steps: 4 | Train Loss: 0.426 Vali Loss: 2.646 Vali Acc: 0.220 Test Loss: 2.646 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 2239513
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7673466205596924
Epoch: 1, Steps: 4 | Train Loss: 1.647 Vali Loss: 1.562 Vali Acc: 0.240 Test Loss: 1.562 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.4600086212158203
Epoch: 2, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.527 Vali Acc: 0.180 Test Loss: 1.527 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3191068172454834
Epoch: 3, Steps: 4 | Train Loss: 1.488 Vali Loss: 1.570 Vali Acc: 0.240 Test Loss: 1.570 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2869162559509277
Epoch: 4, Steps: 4 | Train Loss: 1.195 Vali Loss: 1.634 Vali Acc: 0.220 Test Loss: 1.634 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.5269386768341064
Epoch: 5, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.730 Vali Acc: 0.200 Test Loss: 1.730 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3570740222930908
Epoch: 6, Steps: 4 | Train Loss: 1.000 Vali Loss: 1.758 Vali Acc: 0.220 Test Loss: 1.758 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.5476174354553223
Epoch: 7, Steps: 4 | Train Loss: 0.874 Vali Loss: 1.803 Vali Acc: 0.200 Test Loss: 1.803 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.5971202850341797
Epoch: 8, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.826 Vali Acc: 0.220 Test Loss: 1.826 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.3604044914245605
Epoch: 9, Steps: 4 | Train Loss: 0.767 Vali Loss: 1.913 Vali Acc: 0.240 Test Loss: 1.913 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.4901769161224365
Epoch: 10, Steps: 4 | Train Loss: 0.513 Vali Loss: 2.003 Vali Acc: 0.260 Test Loss: 2.003 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259980).  Saving model ...
Epoch: 11 cost time: 1.5049121379852295
Epoch: 11, Steps: 4 | Train Loss: 0.494 Vali Loss: 2.163 Vali Acc: 0.320 Test Loss: 2.163 Test Acc: 0.320
Validation loss decreased (-0.259980 --> -0.319978).  Saving model ...
Epoch: 12 cost time: 1.449406623840332
Epoch: 12, Steps: 4 | Train Loss: 0.540 Vali Loss: 2.296 Vali Acc: 0.280 Test Loss: 2.296 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.559905767440796
Epoch: 13, Steps: 4 | Train Loss: 0.435 Vali Loss: 2.617 Vali Acc: 0.360 Test Loss: 2.617 Test Acc: 0.360
Validation loss decreased (-0.319978 --> -0.359974).  Saving model ...
Epoch: 14 cost time: 1.4032464027404785
Epoch: 14, Steps: 4 | Train Loss: 0.284 Vali Loss: 2.781 Vali Acc: 0.300 Test Loss: 2.781 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3228585720062256
Epoch: 15, Steps: 4 | Train Loss: 0.300 Vali Loss: 3.262 Vali Acc: 0.240 Test Loss: 3.262 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3703453540802002
Epoch: 16, Steps: 4 | Train Loss: 0.221 Vali Loss: 3.347 Vali Acc: 0.280 Test Loss: 3.347 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2938101291656494
Epoch: 17, Steps: 4 | Train Loss: 0.177 Vali Loss: 3.303 Vali Acc: 0.260 Test Loss: 3.303 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2312076091766357
Epoch: 18, Steps: 4 | Train Loss: 0.126 Vali Loss: 3.840 Vali Acc: 0.220 Test Loss: 3.840 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2483341693878174
Epoch: 19, Steps: 4 | Train Loss: 0.093 Vali Loss: 4.360 Vali Acc: 0.240 Test Loss: 4.360 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.5250818729400635
Epoch: 20, Steps: 4 | Train Loss: 0.109 Vali Loss: 4.722 Vali Acc: 0.220 Test Loss: 4.722 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3751945495605469
Epoch: 21, Steps: 4 | Train Loss: 0.055 Vali Loss: 5.339 Vali Acc: 0.260 Test Loss: 5.339 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.4809472560882568
Epoch: 22, Steps: 4 | Train Loss: 0.031 Vali Loss: 5.799 Vali Acc: 0.240 Test Loss: 5.799 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2601101398468018
Epoch: 23, Steps: 4 | Train Loss: 0.054 Vali Loss: 5.756 Vali Acc: 0.280 Test Loss: 5.756 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 2239513
model size : 13.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9610109329223633
Epoch: 1, Steps: 4 | Train Loss: 1.650 Vali Loss: 1.710 Vali Acc: 0.240 Test Loss: 1.710 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.513075590133667
Epoch: 2, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.640 Vali Acc: 0.300 Test Loss: 1.640 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.2847387790679932
Epoch: 3, Steps: 4 | Train Loss: 1.492 Vali Loss: 1.626 Vali Acc: 0.240 Test Loss: 1.626 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.412146806716919
Epoch: 4, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.666 Vali Acc: 0.260 Test Loss: 1.666 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.210815668106079
Epoch: 5, Steps: 4 | Train Loss: 1.071 Vali Loss: 1.789 Vali Acc: 0.280 Test Loss: 1.789 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1441867351531982
Epoch: 6, Steps: 4 | Train Loss: 0.956 Vali Loss: 1.867 Vali Acc: 0.260 Test Loss: 1.867 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3176662921905518
Epoch: 7, Steps: 4 | Train Loss: 0.673 Vali Loss: 1.868 Vali Acc: 0.200 Test Loss: 1.868 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5444965362548828
Epoch: 8, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.971 Vali Acc: 0.200 Test Loss: 1.971 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.6295063495635986
Epoch: 9, Steps: 4 | Train Loss: 0.852 Vali Loss: 2.115 Vali Acc: 0.200 Test Loss: 2.115 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.6340994834899902
Epoch: 10, Steps: 4 | Train Loss: 0.789 Vali Loss: 2.293 Vali Acc: 0.260 Test Loss: 2.293 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.5486667156219482
Epoch: 11, Steps: 4 | Train Loss: 0.597 Vali Loss: 2.399 Vali Acc: 0.260 Test Loss: 2.399 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.6533267498016357
Epoch: 12, Steps: 4 | Train Loss: 0.450 Vali Loss: 2.611 Vali Acc: 0.260 Test Loss: 2.611 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1597593
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8662707805633545
Epoch: 1, Steps: 4 | Train Loss: 1.689 Vali Loss: 1.684 Vali Acc: 0.300 Test Loss: 1.684 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 1.2053959369659424
Epoch: 2, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.607 Vali Acc: 0.260 Test Loss: 1.607 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.429631233215332
Epoch: 3, Steps: 4 | Train Loss: 1.526 Vali Loss: 1.596 Vali Acc: 0.240 Test Loss: 1.596 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2726058959960938
Epoch: 4, Steps: 4 | Train Loss: 1.278 Vali Loss: 1.659 Vali Acc: 0.260 Test Loss: 1.659 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2133662700653076
Epoch: 5, Steps: 4 | Train Loss: 1.098 Vali Loss: 1.797 Vali Acc: 0.280 Test Loss: 1.797 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.3376679420471191
Epoch: 6, Steps: 4 | Train Loss: 0.976 Vali Loss: 1.873 Vali Acc: 0.260 Test Loss: 1.873 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1754419803619385
Epoch: 7, Steps: 4 | Train Loss: 0.692 Vali Loss: 1.926 Vali Acc: 0.240 Test Loss: 1.926 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.280526876449585
Epoch: 8, Steps: 4 | Train Loss: 0.978 Vali Loss: 2.007 Vali Acc: 0.240 Test Loss: 2.007 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.5554015636444092
Epoch: 9, Steps: 4 | Train Loss: 0.866 Vali Loss: 2.162 Vali Acc: 0.280 Test Loss: 2.162 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.5944316387176514
Epoch: 10, Steps: 4 | Train Loss: 0.831 Vali Loss: 2.346 Vali Acc: 0.240 Test Loss: 2.346 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5437676906585693
Epoch: 11, Steps: 4 | Train Loss: 0.651 Vali Loss: 2.497 Vali Acc: 0.260 Test Loss: 2.497 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1597593
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.680840253829956
Epoch: 1, Steps: 4 | Train Loss: 1.693 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.0218510627746582
Epoch: 2, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.629 Vali Acc: 0.220 Test Loss: 1.629 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2370209693908691
Epoch: 3, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.2072064876556396
Epoch: 4, Steps: 4 | Train Loss: 1.302 Vali Loss: 1.637 Vali Acc: 0.260 Test Loss: 1.637 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.2445807456970215
Epoch: 5, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.725 Vali Acc: 0.240 Test Loss: 1.725 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2470507621765137
Epoch: 6, Steps: 4 | Train Loss: 1.034 Vali Loss: 1.801 Vali Acc: 0.260 Test Loss: 1.801 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1200051307678223
Epoch: 7, Steps: 4 | Train Loss: 0.739 Vali Loss: 1.827 Vali Acc: 0.200 Test Loss: 1.827 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.12009859085083
Epoch: 8, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.939 Vali Acc: 0.220 Test Loss: 1.939 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2848114967346191
Epoch: 9, Steps: 4 | Train Loss: 0.919 Vali Loss: 2.100 Vali Acc: 0.260 Test Loss: 2.100 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2786602973937988
Epoch: 10, Steps: 4 | Train Loss: 0.880 Vali Loss: 2.312 Vali Acc: 0.200 Test Loss: 2.312 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1472885608673096
Epoch: 11, Steps: 4 | Train Loss: 0.715 Vali Loss: 2.468 Vali Acc: 0.240 Test Loss: 2.468 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2270276546478271
Epoch: 12, Steps: 4 | Train Loss: 0.544 Vali Loss: 2.648 Vali Acc: 0.220 Test Loss: 2.648 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2607777118682861
Epoch: 13, Steps: 4 | Train Loss: 0.393 Vali Loss: 2.886 Vali Acc: 0.280 Test Loss: 2.886 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279971).  Saving model ...
Epoch: 14 cost time: 1.0313053131103516
Epoch: 14, Steps: 4 | Train Loss: 0.481 Vali Loss: 3.053 Vali Acc: 0.260 Test Loss: 3.053 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.1642639636993408
Epoch: 15, Steps: 4 | Train Loss: 0.523 Vali Loss: 3.180 Vali Acc: 0.280 Test Loss: 3.180 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2760605812072754
Epoch: 16, Steps: 4 | Train Loss: 0.257 Vali Loss: 3.361 Vali Acc: 0.260 Test Loss: 3.361 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.4313585758209229
Epoch: 17, Steps: 4 | Train Loss: 0.229 Vali Loss: 3.573 Vali Acc: 0.280 Test Loss: 3.573 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.138202428817749
Epoch: 18, Steps: 4 | Train Loss: 0.487 Vali Loss: 3.867 Vali Acc: 0.220 Test Loss: 3.867 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.235154628753662
Epoch: 19, Steps: 4 | Train Loss: 0.169 Vali Loss: 4.041 Vali Acc: 0.220 Test Loss: 4.041 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1029794216156006
Epoch: 20, Steps: 4 | Train Loss: 0.137 Vali Loss: 4.330 Vali Acc: 0.260 Test Loss: 4.330 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.165271520614624
Epoch: 21, Steps: 4 | Train Loss: 0.122 Vali Loss: 4.736 Vali Acc: 0.300 Test Loss: 4.736 Test Acc: 0.300
Validation loss decreased (-0.279971 --> -0.299953).  Saving model ...
Epoch: 22 cost time: 1.1911416053771973
Epoch: 22, Steps: 4 | Train Loss: 0.118 Vali Loss: 5.043 Vali Acc: 0.280 Test Loss: 5.043 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.2883076667785645
Epoch: 23, Steps: 4 | Train Loss: 0.075 Vali Loss: 5.258 Vali Acc: 0.280 Test Loss: 5.258 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.2239348888397217
Epoch: 24, Steps: 4 | Train Loss: 0.080 Vali Loss: 5.543 Vali Acc: 0.360 Test Loss: 5.543 Test Acc: 0.360
Validation loss decreased (-0.299953 --> -0.359945).  Saving model ...
Epoch: 25 cost time: 1.11970853805542
Epoch: 25, Steps: 4 | Train Loss: 0.040 Vali Loss: 5.901 Vali Acc: 0.400 Test Loss: 5.901 Test Acc: 0.400
Validation loss decreased (-0.359945 --> -0.399941).  Saving model ...
Epoch: 26 cost time: 1.1976885795593262
Epoch: 26, Steps: 4 | Train Loss: 0.033 Vali Loss: 6.143 Vali Acc: 0.420 Test Loss: 6.143 Test Acc: 0.420
Validation loss decreased (-0.399941 --> -0.419939).  Saving model ...
Epoch: 27 cost time: 1.0422143936157227
Epoch: 27, Steps: 4 | Train Loss: 0.022 Vali Loss: 6.263 Vali Acc: 0.400 Test Loss: 6.263 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.2744781970977783
Epoch: 28, Steps: 4 | Train Loss: 0.019 Vali Loss: 6.358 Vali Acc: 0.420 Test Loss: 6.358 Test Acc: 0.420
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.237048625946045
Epoch: 29, Steps: 4 | Train Loss: 0.016 Vali Loss: 6.436 Vali Acc: 0.380 Test Loss: 6.436 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.126204013824463
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.544 Vali Acc: 0.380 Test Loss: 6.544 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.3130300045013428
Epoch: 31, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.693 Vali Acc: 0.360 Test Loss: 6.693 Test Acc: 0.360
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.1864337921142578
Epoch: 32, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.827 Vali Acc: 0.360 Test Loss: 6.827 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.2841956615447998
Epoch: 33, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.982 Vali Acc: 0.360 Test Loss: 6.982 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.132277011871338
Epoch: 34, Steps: 4 | Train Loss: 0.006 Vali Loss: 7.074 Vali Acc: 0.380 Test Loss: 7.074 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.2686827182769775
Epoch: 35, Steps: 4 | Train Loss: 0.008 Vali Loss: 7.147 Vali Acc: 0.400 Test Loss: 7.147 Test Acc: 0.400
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.1427502632141113
Epoch: 36, Steps: 4 | Train Loss: 0.005 Vali Loss: 7.114 Vali Acc: 0.400 Test Loss: 7.114 Test Acc: 0.400
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 1597593
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8040947914123535
Epoch: 1, Steps: 4 | Train Loss: 1.679 Vali Loss: 1.692 Vali Acc: 0.160 Test Loss: 1.692 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.3804714679718018
Epoch: 2, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.637 Vali Acc: 0.200 Test Loss: 1.637 Test Acc: 0.200
Validation loss decreased (-0.159983 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.4049427509307861
Epoch: 3, Steps: 4 | Train Loss: 1.566 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.3874976634979248
Epoch: 4, Steps: 4 | Train Loss: 1.359 Vali Loss: 1.612 Vali Acc: 0.240 Test Loss: 1.612 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.4460718631744385
Epoch: 5, Steps: 4 | Train Loss: 1.199 Vali Loss: 1.671 Vali Acc: 0.220 Test Loss: 1.671 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2521154880523682
Epoch: 6, Steps: 4 | Train Loss: 1.088 Vali Loss: 1.727 Vali Acc: 0.220 Test Loss: 1.727 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1683037281036377
Epoch: 7, Steps: 4 | Train Loss: 0.812 Vali Loss: 1.715 Vali Acc: 0.200 Test Loss: 1.715 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2668507099151611
Epoch: 8, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.769 Vali Acc: 0.220 Test Loss: 1.769 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1750905513763428
Epoch: 9, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.876 Vali Acc: 0.180 Test Loss: 1.876 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.177595615386963
Epoch: 10, Steps: 4 | Train Loss: 0.992 Vali Loss: 2.060 Vali Acc: 0.180 Test Loss: 2.060 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1394193172454834
Epoch: 11, Steps: 4 | Train Loss: 0.802 Vali Loss: 2.161 Vali Acc: 0.280 Test Loss: 2.161 Test Acc: 0.280
Validation loss decreased (-0.239984 --> -0.279978).  Saving model ...
Epoch: 12 cost time: 1.1366727352142334
Epoch: 12, Steps: 4 | Train Loss: 0.638 Vali Loss: 2.248 Vali Acc: 0.240 Test Loss: 2.248 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2395238876342773
Epoch: 13, Steps: 4 | Train Loss: 0.480 Vali Loss: 2.338 Vali Acc: 0.280 Test Loss: 2.338 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2275867462158203
Epoch: 14, Steps: 4 | Train Loss: 0.577 Vali Loss: 2.353 Vali Acc: 0.300 Test Loss: 2.353 Test Acc: 0.300
Validation loss decreased (-0.279978 --> -0.299976).  Saving model ...
Epoch: 15 cost time: 1.1598749160766602
Epoch: 15, Steps: 4 | Train Loss: 0.539 Vali Loss: 2.361 Vali Acc: 0.260 Test Loss: 2.361 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.167358636856079
Epoch: 16, Steps: 4 | Train Loss: 0.305 Vali Loss: 2.469 Vali Acc: 0.280 Test Loss: 2.469 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1639902591705322
Epoch: 17, Steps: 4 | Train Loss: 0.275 Vali Loss: 2.612 Vali Acc: 0.280 Test Loss: 2.612 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.1765327453613281
Epoch: 18, Steps: 4 | Train Loss: 0.578 Vali Loss: 2.869 Vali Acc: 0.380 Test Loss: 2.869 Test Acc: 0.380
Validation loss decreased (-0.299976 --> -0.379971).  Saving model ...
Epoch: 19 cost time: 1.1962039470672607
Epoch: 19, Steps: 4 | Train Loss: 0.210 Vali Loss: 3.008 Vali Acc: 0.280 Test Loss: 3.008 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2699265480041504
Epoch: 20, Steps: 4 | Train Loss: 0.175 Vali Loss: 3.391 Vali Acc: 0.280 Test Loss: 3.391 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2684061527252197
Epoch: 21, Steps: 4 | Train Loss: 0.167 Vali Loss: 3.716 Vali Acc: 0.240 Test Loss: 3.716 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.4256443977355957
Epoch: 22, Steps: 4 | Train Loss: 0.140 Vali Loss: 4.073 Vali Acc: 0.260 Test Loss: 4.073 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.459733009338379
Epoch: 23, Steps: 4 | Train Loss: 0.105 Vali Loss: 4.291 Vali Acc: 0.340 Test Loss: 4.291 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.400928258895874
Epoch: 24, Steps: 4 | Train Loss: 0.119 Vali Loss: 4.575 Vali Acc: 0.300 Test Loss: 4.575 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.2741966247558594
Epoch: 25, Steps: 4 | Train Loss: 0.063 Vali Loss: 4.715 Vali Acc: 0.280 Test Loss: 4.715 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.385239601135254
Epoch: 26, Steps: 4 | Train Loss: 0.051 Vali Loss: 4.728 Vali Acc: 0.240 Test Loss: 4.728 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.2490692138671875
Epoch: 27, Steps: 4 | Train Loss: 0.034 Vali Loss: 4.692 Vali Acc: 0.220 Test Loss: 4.692 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.2953622341156006
Epoch: 28, Steps: 4 | Train Loss: 0.029 Vali Loss: 4.767 Vali Acc: 0.260 Test Loss: 4.767 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1597593
model size : 8.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.915005683898926
Epoch: 1, Steps: 4 | Train Loss: 1.639 Vali Loss: 1.606 Vali Acc: 0.240 Test Loss: 1.606 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.4775433540344238
Epoch: 2, Steps: 4 | Train Loss: 1.624 Vali Loss: 1.576 Vali Acc: 0.260 Test Loss: 1.576 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.4562914371490479
Epoch: 3, Steps: 4 | Train Loss: 1.518 Vali Loss: 1.594 Vali Acc: 0.220 Test Loss: 1.594 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.430206537246704
Epoch: 4, Steps: 4 | Train Loss: 1.323 Vali Loss: 1.648 Vali Acc: 0.220 Test Loss: 1.648 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3282947540283203
Epoch: 5, Steps: 4 | Train Loss: 1.158 Vali Loss: 1.730 Vali Acc: 0.220 Test Loss: 1.730 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.374161958694458
Epoch: 6, Steps: 4 | Train Loss: 0.948 Vali Loss: 1.810 Vali Acc: 0.180 Test Loss: 1.810 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3671469688415527
Epoch: 7, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.889 Vali Acc: 0.240 Test Loss: 1.889 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5048201084136963
Epoch: 8, Steps: 4 | Train Loss: 0.757 Vali Loss: 1.981 Vali Acc: 0.260 Test Loss: 1.981 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2395200729370117
Epoch: 9, Steps: 4 | Train Loss: 0.612 Vali Loss: 2.133 Vali Acc: 0.240 Test Loss: 2.133 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.235788106918335
Epoch: 10, Steps: 4 | Train Loss: 0.518 Vali Loss: 2.309 Vali Acc: 0.260 Test Loss: 2.309 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.372025966644287
Epoch: 11, Steps: 4 | Train Loss: 0.774 Vali Loss: 2.538 Vali Acc: 0.260 Test Loss: 2.538 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.4235708713531494
Epoch: 12, Steps: 4 | Train Loss: 0.421 Vali Loss: 2.647 Vali Acc: 0.240 Test Loss: 2.647 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 1335449
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3864705562591553
Epoch: 1, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.582 Vali Acc: 0.220 Test Loss: 1.582 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.2129764556884766
Epoch: 2, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.547 Vali Acc: 0.220 Test Loss: 1.547 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219985).  Saving model ...
Epoch: 3 cost time: 1.2131588459014893
Epoch: 3, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.576 Vali Acc: 0.260 Test Loss: 1.576 Test Acc: 0.260
Validation loss decreased (-0.219985 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.2620673179626465
Epoch: 4, Steps: 4 | Train Loss: 1.340 Vali Loss: 1.617 Vali Acc: 0.280 Test Loss: 1.617 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 5 cost time: 1.224830150604248
Epoch: 5, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.667 Vali Acc: 0.200 Test Loss: 1.667 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2964146137237549
Epoch: 6, Steps: 4 | Train Loss: 0.976 Vali Loss: 1.736 Vali Acc: 0.220 Test Loss: 1.736 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.288459300994873
Epoch: 7, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.836 Vali Acc: 0.220 Test Loss: 1.836 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.2782907485961914
Epoch: 8, Steps: 4 | Train Loss: 0.801 Vali Loss: 1.945 Vali Acc: 0.260 Test Loss: 1.945 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.5824265480041504
Epoch: 9, Steps: 4 | Train Loss: 0.643 Vali Loss: 2.086 Vali Acc: 0.220 Test Loss: 2.086 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.460857629776001
Epoch: 10, Steps: 4 | Train Loss: 0.549 Vali Loss: 2.277 Vali Acc: 0.240 Test Loss: 2.277 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.3084437847137451
Epoch: 11, Steps: 4 | Train Loss: 0.797 Vali Loss: 2.557 Vali Acc: 0.280 Test Loss: 2.557 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.3283414840698242
Epoch: 12, Steps: 4 | Train Loss: 0.471 Vali Loss: 2.684 Vali Acc: 0.260 Test Loss: 2.684 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.4959731101989746
Epoch: 13, Steps: 4 | Train Loss: 0.401 Vali Loss: 2.834 Vali Acc: 0.240 Test Loss: 2.834 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.3464953899383545
Epoch: 14, Steps: 4 | Train Loss: 0.287 Vali Loss: 3.029 Vali Acc: 0.240 Test Loss: 3.029 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1335449
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7975776195526123
Epoch: 1, Steps: 4 | Train Loss: 1.649 Vali Loss: 1.574 Vali Acc: 0.220 Test Loss: 1.574 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.3026256561279297
Epoch: 2, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.540 Vali Acc: 0.240 Test Loss: 1.540 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.380385160446167
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.557 Vali Acc: 0.240 Test Loss: 1.557 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2635884284973145
Epoch: 4, Steps: 4 | Train Loss: 1.362 Vali Loss: 1.588 Vali Acc: 0.220 Test Loss: 1.588 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2361540794372559
Epoch: 5, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.625 Vali Acc: 0.220 Test Loss: 1.625 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.184877872467041
Epoch: 6, Steps: 4 | Train Loss: 1.026 Vali Loss: 1.699 Vali Acc: 0.260 Test Loss: 1.699 Test Acc: 0.260
Validation loss decreased (-0.239985 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 1.4388806819915771
Epoch: 7, Steps: 4 | Train Loss: 1.066 Vali Loss: 1.782 Vali Acc: 0.200 Test Loss: 1.782 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.305433988571167
Epoch: 8, Steps: 4 | Train Loss: 0.863 Vali Loss: 1.873 Vali Acc: 0.260 Test Loss: 1.873 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.4338481426239014
Epoch: 9, Steps: 4 | Train Loss: 0.698 Vali Loss: 2.001 Vali Acc: 0.240 Test Loss: 2.001 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2476787567138672
Epoch: 10, Steps: 4 | Train Loss: 0.606 Vali Loss: 2.199 Vali Acc: 0.240 Test Loss: 2.199 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.2551774978637695
Epoch: 11, Steps: 4 | Train Loss: 0.854 Vali Loss: 2.430 Vali Acc: 0.260 Test Loss: 2.430 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2489299774169922
Epoch: 12, Steps: 4 | Train Loss: 0.526 Vali Loss: 2.522 Vali Acc: 0.280 Test Loss: 2.522 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279975).  Saving model ...
Epoch: 13 cost time: 1.2998464107513428
Epoch: 13, Steps: 4 | Train Loss: 0.436 Vali Loss: 2.682 Vali Acc: 0.280 Test Loss: 2.682 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.351759672164917
Epoch: 14, Steps: 4 | Train Loss: 0.321 Vali Loss: 2.868 Vali Acc: 0.240 Test Loss: 2.868 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.4805395603179932
Epoch: 15, Steps: 4 | Train Loss: 0.286 Vali Loss: 3.081 Vali Acc: 0.280 Test Loss: 3.081 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3673865795135498
Epoch: 16, Steps: 4 | Train Loss: 0.237 Vali Loss: 3.383 Vali Acc: 0.300 Test Loss: 3.383 Test Acc: 0.300
Validation loss decreased (-0.279975 --> -0.299966).  Saving model ...
Epoch: 17 cost time: 1.3319082260131836
Epoch: 17, Steps: 4 | Train Loss: 0.258 Vali Loss: 3.587 Vali Acc: 0.320 Test Loss: 3.587 Test Acc: 0.320
Validation loss decreased (-0.299966 --> -0.319964).  Saving model ...
Epoch: 18 cost time: 1.3528399467468262
Epoch: 18, Steps: 4 | Train Loss: 0.277 Vali Loss: 3.625 Vali Acc: 0.280 Test Loss: 3.625 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2742114067077637
Epoch: 19, Steps: 4 | Train Loss: 0.423 Vali Loss: 3.922 Vali Acc: 0.300 Test Loss: 3.922 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3319604396820068
Epoch: 20, Steps: 4 | Train Loss: 0.148 Vali Loss: 4.133 Vali Acc: 0.320 Test Loss: 4.133 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3704338073730469
Epoch: 21, Steps: 4 | Train Loss: 0.137 Vali Loss: 4.353 Vali Acc: 0.340 Test Loss: 4.353 Test Acc: 0.340
Validation loss decreased (-0.319964 --> -0.339956).  Saving model ...
Epoch: 22 cost time: 1.510749101638794
Epoch: 22, Steps: 4 | Train Loss: 0.095 Vali Loss: 4.663 Vali Acc: 0.320 Test Loss: 4.663 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5017242431640625
Epoch: 23, Steps: 4 | Train Loss: 0.080 Vali Loss: 5.061 Vali Acc: 0.320 Test Loss: 5.061 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.305004358291626
Epoch: 24, Steps: 4 | Train Loss: 0.080 Vali Loss: 5.276 Vali Acc: 0.320 Test Loss: 5.276 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1718623638153076
Epoch: 25, Steps: 4 | Train Loss: 0.045 Vali Loss: 5.458 Vali Acc: 0.340 Test Loss: 5.458 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.1923673152923584
Epoch: 26, Steps: 4 | Train Loss: 0.029 Vali Loss: 5.659 Vali Acc: 0.300 Test Loss: 5.659 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3061285018920898
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 5.469 Vali Acc: 0.320 Test Loss: 5.469 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.174637794494629
Epoch: 28, Steps: 4 | Train Loss: 0.023 Vali Loss: 5.448 Vali Acc: 0.300 Test Loss: 5.448 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2646963596343994
Epoch: 29, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.525 Vali Acc: 0.300 Test Loss: 5.525 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.3764784336090088
Epoch: 30, Steps: 4 | Train Loss: 0.013 Vali Loss: 5.721 Vali Acc: 0.320 Test Loss: 5.721 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2131094932556152
Epoch: 31, Steps: 4 | Train Loss: 0.011 Vali Loss: 5.943 Vali Acc: 0.340 Test Loss: 5.943 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1335449
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6124212741851807
Epoch: 1, Steps: 4 | Train Loss: 1.627 Vali Loss: 1.544 Vali Acc: 0.300 Test Loss: 1.544 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.1725447177886963
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.519 Vali Acc: 0.220 Test Loss: 1.519 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3569347858428955
Epoch: 3, Steps: 4 | Train Loss: 1.524 Vali Loss: 1.518 Vali Acc: 0.240 Test Loss: 1.518 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1296141147613525
Epoch: 4, Steps: 4 | Train Loss: 1.411 Vali Loss: 1.529 Vali Acc: 0.260 Test Loss: 1.529 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2419819831848145
Epoch: 5, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.553 Vali Acc: 0.240 Test Loss: 1.553 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2418816089630127
Epoch: 6, Steps: 4 | Train Loss: 1.086 Vali Loss: 1.593 Vali Acc: 0.260 Test Loss: 1.593 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.240621566772461
Epoch: 7, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.640 Vali Acc: 0.200 Test Loss: 1.640 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.3075368404388428
Epoch: 8, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.699 Vali Acc: 0.240 Test Loss: 1.699 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.1985058784484863
Epoch: 9, Steps: 4 | Train Loss: 0.773 Vali Loss: 1.772 Vali Acc: 0.260 Test Loss: 1.772 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.3759119510650635
Epoch: 10, Steps: 4 | Train Loss: 0.723 Vali Loss: 1.872 Vali Acc: 0.240 Test Loss: 1.872 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.5272216796875
Epoch: 11, Steps: 4 | Train Loss: 0.895 Vali Loss: 2.034 Vali Acc: 0.240 Test Loss: 2.034 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1335449
model size : 7.55MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4705822467803955
Epoch: 1, Steps: 4 | Train Loss: 1.571 Vali Loss: 1.799 Vali Acc: 0.220 Test Loss: 1.799 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.21718168258667
Epoch: 2, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.741 Vali Acc: 0.260 Test Loss: 1.741 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.1113853454589844
Epoch: 3, Steps: 4 | Train Loss: 1.331 Vali Loss: 1.718 Vali Acc: 0.220 Test Loss: 1.718 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5226695537567139
Epoch: 4, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.716 Vali Acc: 0.220 Test Loss: 1.716 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.431542158126831
Epoch: 5, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.807 Vali Acc: 0.220 Test Loss: 1.807 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2258014678955078
Epoch: 6, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.878 Vali Acc: 0.220 Test Loss: 1.878 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3963344097137451
Epoch: 7, Steps: 4 | Train Loss: 0.763 Vali Loss: 1.917 Vali Acc: 0.280 Test Loss: 1.917 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279981).  Saving model ...
Epoch: 8 cost time: 1.120973825454712
Epoch: 8, Steps: 4 | Train Loss: 0.779 Vali Loss: 1.972 Vali Acc: 0.240 Test Loss: 1.972 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1733627319335938
Epoch: 9, Steps: 4 | Train Loss: 0.758 Vali Loss: 2.042 Vali Acc: 0.180 Test Loss: 2.042 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1745858192443848
Epoch: 10, Steps: 4 | Train Loss: 0.614 Vali Loss: 2.243 Vali Acc: 0.260 Test Loss: 2.243 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.166337490081787
Epoch: 11, Steps: 4 | Train Loss: 0.480 Vali Loss: 2.497 Vali Acc: 0.260 Test Loss: 2.497 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.2988417148590088
Epoch: 12, Steps: 4 | Train Loss: 0.710 Vali Loss: 2.624 Vali Acc: 0.240 Test Loss: 2.624 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.401167869567871
Epoch: 13, Steps: 4 | Train Loss: 0.377 Vali Loss: 2.762 Vali Acc: 0.280 Test Loss: 2.762 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3163540363311768
Epoch: 14, Steps: 4 | Train Loss: 0.257 Vali Loss: 2.945 Vali Acc: 0.280 Test Loss: 2.945 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.256335973739624
Epoch: 15, Steps: 4 | Train Loss: 0.220 Vali Loss: 3.303 Vali Acc: 0.300 Test Loss: 3.303 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299967).  Saving model ...
Epoch: 16 cost time: 1.1518902778625488
Epoch: 16, Steps: 4 | Train Loss: 0.199 Vali Loss: 3.777 Vali Acc: 0.280 Test Loss: 3.777 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3045406341552734
Epoch: 17, Steps: 4 | Train Loss: 0.320 Vali Loss: 4.259 Vali Acc: 0.260 Test Loss: 4.259 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1202812194824219
Epoch: 18, Steps: 4 | Train Loss: 0.297 Vali Loss: 4.492 Vali Acc: 0.280 Test Loss: 4.492 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2820606231689453
Epoch: 19, Steps: 4 | Train Loss: 0.110 Vali Loss: 4.718 Vali Acc: 0.280 Test Loss: 4.718 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3071835041046143
Epoch: 20, Steps: 4 | Train Loss: 0.072 Vali Loss: 5.021 Vali Acc: 0.280 Test Loss: 5.021 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.1763834953308105
Epoch: 21, Steps: 4 | Train Loss: 0.059 Vali Loss: 5.396 Vali Acc: 0.300 Test Loss: 5.396 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2532989978790283
Epoch: 22, Steps: 4 | Train Loss: 0.039 Vali Loss: 5.641 Vali Acc: 0.300 Test Loss: 5.641 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3904085159301758
Epoch: 23, Steps: 4 | Train Loss: 0.036 Vali Loss: 5.772 Vali Acc: 0.300 Test Loss: 5.772 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.305051326751709
Epoch: 24, Steps: 4 | Train Loss: 0.020 Vali Loss: 5.964 Vali Acc: 0.300 Test Loss: 5.964 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.1993963718414307
Epoch: 25, Steps: 4 | Train Loss: 0.019 Vali Loss: 6.054 Vali Acc: 0.300 Test Loss: 6.054 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1204377
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.0575854778289795
Epoch: 1, Steps: 4 | Train Loss: 1.598 Vali Loss: 1.767 Vali Acc: 0.220 Test Loss: 1.767 Test Acc: 0.220
Validation loss decreased (inf --> -0.219982).  Saving model ...
Epoch: 2 cost time: 1.3017308712005615
Epoch: 2, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.713 Vali Acc: 0.260 Test Loss: 1.713 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259983).  Saving model ...
Epoch: 3 cost time: 1.2552266120910645
Epoch: 3, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.683 Vali Acc: 0.260 Test Loss: 1.683 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.2695484161376953
Epoch: 4, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.666 Vali Acc: 0.220 Test Loss: 1.666 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3739194869995117
Epoch: 5, Steps: 4 | Train Loss: 1.246 Vali Loss: 1.756 Vali Acc: 0.220 Test Loss: 1.756 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3215909004211426
Epoch: 6, Steps: 4 | Train Loss: 1.144 Vali Loss: 1.844 Vali Acc: 0.180 Test Loss: 1.844 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2457959651947021
Epoch: 7, Steps: 4 | Train Loss: 0.800 Vali Loss: 1.848 Vali Acc: 0.220 Test Loss: 1.848 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2244367599487305
Epoch: 8, Steps: 4 | Train Loss: 0.832 Vali Loss: 1.915 Vali Acc: 0.240 Test Loss: 1.915 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.296832799911499
Epoch: 9, Steps: 4 | Train Loss: 0.806 Vali Loss: 2.027 Vali Acc: 0.180 Test Loss: 2.027 Test Acc: 0.180
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3924126625061035
Epoch: 10, Steps: 4 | Train Loss: 0.658 Vali Loss: 2.267 Vali Acc: 0.240 Test Loss: 2.267 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.4104626178741455
Epoch: 11, Steps: 4 | Train Loss: 0.520 Vali Loss: 2.551 Vali Acc: 0.240 Test Loss: 2.551 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.3501698970794678
Epoch: 12, Steps: 4 | Train Loss: 0.755 Vali Loss: 2.687 Vali Acc: 0.220 Test Loss: 2.687 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.3289177417755127
Epoch: 13, Steps: 4 | Train Loss: 0.424 Vali Loss: 2.872 Vali Acc: 0.280 Test Loss: 2.872 Test Acc: 0.280
Validation loss decreased (-0.259983 --> -0.279971).  Saving model ...
Epoch: 14 cost time: 1.3677513599395752
Epoch: 14, Steps: 4 | Train Loss: 0.289 Vali Loss: 3.078 Vali Acc: 0.260 Test Loss: 3.078 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.2264950275421143
Epoch: 15, Steps: 4 | Train Loss: 0.252 Vali Loss: 3.570 Vali Acc: 0.300 Test Loss: 3.570 Test Acc: 0.300
Validation loss decreased (-0.279971 --> -0.299964).  Saving model ...
Epoch: 16 cost time: 1.219388484954834
Epoch: 16, Steps: 4 | Train Loss: 0.225 Vali Loss: 4.087 Vali Acc: 0.300 Test Loss: 4.087 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.434441328048706
Epoch: 17, Steps: 4 | Train Loss: 0.329 Vali Loss: 4.386 Vali Acc: 0.260 Test Loss: 4.386 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1783409118652344
Epoch: 18, Steps: 4 | Train Loss: 0.323 Vali Loss: 4.636 Vali Acc: 0.260 Test Loss: 4.636 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.257103443145752
Epoch: 19, Steps: 4 | Train Loss: 0.147 Vali Loss: 4.882 Vali Acc: 0.260 Test Loss: 4.882 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.264751672744751
Epoch: 20, Steps: 4 | Train Loss: 0.092 Vali Loss: 5.252 Vali Acc: 0.240 Test Loss: 5.252 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2020349502563477
Epoch: 21, Steps: 4 | Train Loss: 0.080 Vali Loss: 5.676 Vali Acc: 0.280 Test Loss: 5.676 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.3371202945709229
Epoch: 22, Steps: 4 | Train Loss: 0.055 Vali Loss: 5.891 Vali Acc: 0.280 Test Loss: 5.891 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.3481779098510742
Epoch: 23, Steps: 4 | Train Loss: 0.048 Vali Loss: 6.015 Vali Acc: 0.300 Test Loss: 6.015 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2400612831115723
Epoch: 24, Steps: 4 | Train Loss: 0.028 Vali Loss: 6.265 Vali Acc: 0.300 Test Loss: 6.265 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3854877948760986
Epoch: 25, Steps: 4 | Train Loss: 0.025 Vali Loss: 6.508 Vali Acc: 0.300 Test Loss: 6.508 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1204377
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4816575050354004
Epoch: 1, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.765 Vali Acc: 0.180 Test Loss: 1.765 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 1.3747601509094238
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.733 Vali Acc: 0.220 Test Loss: 1.733 Test Acc: 0.220
Validation loss decreased (-0.179982 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.1959102153778076
Epoch: 3, Steps: 4 | Train Loss: 1.369 Vali Loss: 1.722 Vali Acc: 0.200 Test Loss: 1.722 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1257305145263672
Epoch: 4, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.712 Vali Acc: 0.200 Test Loss: 1.712 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1171207427978516
Epoch: 5, Steps: 4 | Train Loss: 1.313 Vali Loss: 1.778 Vali Acc: 0.200 Test Loss: 1.778 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.1412289142608643
Epoch: 6, Steps: 4 | Train Loss: 1.173 Vali Loss: 1.830 Vali Acc: 0.180 Test Loss: 1.830 Test Acc: 0.180
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2925794124603271
Epoch: 7, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.859 Vali Acc: 0.180 Test Loss: 1.859 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.3563780784606934
Epoch: 8, Steps: 4 | Train Loss: 0.912 Vali Loss: 1.934 Vali Acc: 0.240 Test Loss: 1.934 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239981).  Saving model ...
Epoch: 9 cost time: 1.1278553009033203
Epoch: 9, Steps: 4 | Train Loss: 0.868 Vali Loss: 2.034 Vali Acc: 0.200 Test Loss: 2.034 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2696223258972168
Epoch: 10, Steps: 4 | Train Loss: 0.713 Vali Loss: 2.227 Vali Acc: 0.200 Test Loss: 2.227 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.177657127380371
Epoch: 11, Steps: 4 | Train Loss: 0.578 Vali Loss: 2.397 Vali Acc: 0.240 Test Loss: 2.397 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1730074882507324
Epoch: 12, Steps: 4 | Train Loss: 0.831 Vali Loss: 2.518 Vali Acc: 0.220 Test Loss: 2.518 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2344293594360352
Epoch: 13, Steps: 4 | Train Loss: 0.508 Vali Loss: 2.744 Vali Acc: 0.180 Test Loss: 2.744 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.204451322555542
Epoch: 14, Steps: 4 | Train Loss: 0.341 Vali Loss: 2.896 Vali Acc: 0.220 Test Loss: 2.896 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.1658611297607422
Epoch: 15, Steps: 4 | Train Loss: 0.297 Vali Loss: 3.217 Vali Acc: 0.260 Test Loss: 3.217 Test Acc: 0.260
Validation loss decreased (-0.239981 --> -0.259968).  Saving model ...
Epoch: 16 cost time: 1.0835349559783936
Epoch: 16, Steps: 4 | Train Loss: 0.277 Vali Loss: 3.568 Vali Acc: 0.260 Test Loss: 3.568 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3062970638275146
Epoch: 17, Steps: 4 | Train Loss: 0.389 Vali Loss: 3.938 Vali Acc: 0.240 Test Loss: 3.938 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.0750319957733154
Epoch: 18, Steps: 4 | Train Loss: 0.347 Vali Loss: 4.139 Vali Acc: 0.280 Test Loss: 4.139 Test Acc: 0.280
Validation loss decreased (-0.259968 --> -0.279959).  Saving model ...
Epoch: 19 cost time: 1.1045327186584473
Epoch: 19, Steps: 4 | Train Loss: 0.184 Vali Loss: 4.299 Vali Acc: 0.260 Test Loss: 4.299 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.119481086730957
Epoch: 20, Steps: 4 | Train Loss: 0.115 Vali Loss: 4.617 Vali Acc: 0.280 Test Loss: 4.617 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.0668292045593262
Epoch: 21, Steps: 4 | Train Loss: 0.104 Vali Loss: 4.911 Vali Acc: 0.300 Test Loss: 4.911 Test Acc: 0.300
Validation loss decreased (-0.279959 --> -0.299951).  Saving model ...
Epoch: 22 cost time: 1.1634221076965332
Epoch: 22, Steps: 4 | Train Loss: 0.074 Vali Loss: 5.228 Vali Acc: 0.340 Test Loss: 5.228 Test Acc: 0.340
Validation loss decreased (-0.299951 --> -0.339948).  Saving model ...
Epoch: 23 cost time: 1.256587266921997
Epoch: 23, Steps: 4 | Train Loss: 0.070 Vali Loss: 5.484 Vali Acc: 0.380 Test Loss: 5.484 Test Acc: 0.380
Validation loss decreased (-0.339948 --> -0.379945).  Saving model ...
Epoch: 24 cost time: 1.110997200012207
Epoch: 24, Steps: 4 | Train Loss: 0.050 Vali Loss: 5.635 Vali Acc: 0.380 Test Loss: 5.635 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.1976418495178223
Epoch: 25, Steps: 4 | Train Loss: 0.037 Vali Loss: 5.807 Vali Acc: 0.380 Test Loss: 5.807 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.2586500644683838
Epoch: 26, Steps: 4 | Train Loss: 0.032 Vali Loss: 6.003 Vali Acc: 0.360 Test Loss: 6.003 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.142740249633789
Epoch: 27, Steps: 4 | Train Loss: 0.025 Vali Loss: 6.140 Vali Acc: 0.360 Test Loss: 6.140 Test Acc: 0.360
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2753722667694092
Epoch: 28, Steps: 4 | Train Loss: 0.018 Vali Loss: 6.165 Vali Acc: 0.300 Test Loss: 6.165 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.251706600189209
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 6.331 Vali Acc: 0.300 Test Loss: 6.331 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.1824347972869873
Epoch: 30, Steps: 4 | Train Loss: 0.011 Vali Loss: 6.593 Vali Acc: 0.280 Test Loss: 6.593 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.172680139541626
Epoch: 31, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.833 Vali Acc: 0.300 Test Loss: 6.833 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.199124813079834
Epoch: 32, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.978 Vali Acc: 0.320 Test Loss: 6.978 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1021959781646729
Epoch: 33, Steps: 4 | Train Loss: 0.006 Vali Loss: 7.207 Vali Acc: 0.360 Test Loss: 7.207 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1204377
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.43888521194458
Epoch: 1, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.297309398651123
Epoch: 2, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.668 Vali Acc: 0.220 Test Loss: 1.668 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.502335548400879
Epoch: 3, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.634 Vali Acc: 0.200 Test Loss: 1.634 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3235745429992676
Epoch: 4, Steps: 4 | Train Loss: 1.395 Vali Loss: 1.597 Vali Acc: 0.220 Test Loss: 1.597 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.2338252067565918
Epoch: 5, Steps: 4 | Train Loss: 1.352 Vali Loss: 1.635 Vali Acc: 0.220 Test Loss: 1.635 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2653677463531494
Epoch: 6, Steps: 4 | Train Loss: 1.248 Vali Loss: 1.647 Vali Acc: 0.220 Test Loss: 1.647 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.171308994293213
Epoch: 7, Steps: 4 | Train Loss: 0.943 Vali Loss: 1.657 Vali Acc: 0.200 Test Loss: 1.657 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1958837509155273
Epoch: 8, Steps: 4 | Train Loss: 1.053 Vali Loss: 1.707 Vali Acc: 0.260 Test Loss: 1.707 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259983).  Saving model ...
Epoch: 9 cost time: 1.3519644737243652
Epoch: 9, Steps: 4 | Train Loss: 0.976 Vali Loss: 1.772 Vali Acc: 0.240 Test Loss: 1.772 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3250055313110352
Epoch: 10, Steps: 4 | Train Loss: 0.816 Vali Loss: 1.899 Vali Acc: 0.260 Test Loss: 1.899 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2356164455413818
Epoch: 11, Steps: 4 | Train Loss: 0.675 Vali Loss: 1.994 Vali Acc: 0.260 Test Loss: 1.994 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.2173068523406982
Epoch: 12, Steps: 4 | Train Loss: 0.918 Vali Loss: 2.094 Vali Acc: 0.260 Test Loss: 2.094 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1264450550079346
Epoch: 13, Steps: 4 | Train Loss: 0.615 Vali Loss: 2.175 Vali Acc: 0.300 Test Loss: 2.175 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299978).  Saving model ...
Epoch: 14 cost time: 1.2286155223846436
Epoch: 14, Steps: 4 | Train Loss: 0.406 Vali Loss: 2.242 Vali Acc: 0.320 Test Loss: 2.242 Test Acc: 0.320
Validation loss decreased (-0.299978 --> -0.319978).  Saving model ...
Epoch: 15 cost time: 1.1774489879608154
Epoch: 15, Steps: 4 | Train Loss: 0.347 Vali Loss: 2.308 Vali Acc: 0.300 Test Loss: 2.308 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0656473636627197
Epoch: 16, Steps: 4 | Train Loss: 0.400 Vali Loss: 2.439 Vali Acc: 0.280 Test Loss: 2.439 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.103959321975708
Epoch: 17, Steps: 4 | Train Loss: 0.368 Vali Loss: 2.657 Vali Acc: 0.340 Test Loss: 2.657 Test Acc: 0.340
Validation loss decreased (-0.319978 --> -0.339973).  Saving model ...
Epoch: 18 cost time: 1.151244878768921
Epoch: 18, Steps: 4 | Train Loss: 0.342 Vali Loss: 2.742 Vali Acc: 0.300 Test Loss: 2.742 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.0891547203063965
Epoch: 19, Steps: 4 | Train Loss: 0.262 Vali Loss: 2.732 Vali Acc: 0.260 Test Loss: 2.732 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.3371145725250244
Epoch: 20, Steps: 4 | Train Loss: 0.159 Vali Loss: 2.856 Vali Acc: 0.240 Test Loss: 2.856 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3013031482696533
Epoch: 21, Steps: 4 | Train Loss: 0.139 Vali Loss: 3.026 Vali Acc: 0.300 Test Loss: 3.026 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.1719248294830322
Epoch: 22, Steps: 4 | Train Loss: 0.100 Vali Loss: 3.280 Vali Acc: 0.240 Test Loss: 3.280 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.2508776187896729
Epoch: 23, Steps: 4 | Train Loss: 0.090 Vali Loss: 3.428 Vali Acc: 0.260 Test Loss: 3.428 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.4979963302612305
Epoch: 24, Steps: 4 | Train Loss: 0.061 Vali Loss: 3.632 Vali Acc: 0.300 Test Loss: 3.632 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.321631908416748
Epoch: 25, Steps: 4 | Train Loss: 0.048 Vali Loss: 3.859 Vali Acc: 0.300 Test Loss: 3.859 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.2371034622192383
Epoch: 26, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.824 Vali Acc: 0.320 Test Loss: 3.824 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.23492431640625
Epoch: 27, Steps: 4 | Train Loss: 0.033 Vali Loss: 3.946 Vali Acc: 0.280 Test Loss: 3.946 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1204377
model size : 7.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7679190635681152
Epoch: 1, Steps: 4 | Train Loss: 1.629 Vali Loss: 1.602 Vali Acc: 0.240 Test Loss: 1.602 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.1756923198699951
Epoch: 2, Steps: 4 | Train Loss: 1.576 Vali Loss: 1.581 Vali Acc: 0.260 Test Loss: 1.581 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.1505436897277832
Epoch: 3, Steps: 4 | Train Loss: 1.328 Vali Loss: 1.560 Vali Acc: 0.220 Test Loss: 1.560 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.417562484741211
Epoch: 4, Steps: 4 | Train Loss: 1.318 Vali Loss: 1.617 Vali Acc: 0.260 Test Loss: 1.617 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3320317268371582
Epoch: 5, Steps: 4 | Train Loss: 1.271 Vali Loss: 1.687 Vali Acc: 0.240 Test Loss: 1.687 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3356883525848389
Epoch: 6, Steps: 4 | Train Loss: 0.897 Vali Loss: 1.790 Vali Acc: 0.260 Test Loss: 1.790 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.2925400733947754
Epoch: 7, Steps: 4 | Train Loss: 1.014 Vali Loss: 1.880 Vali Acc: 0.220 Test Loss: 1.880 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.377274990081787
Epoch: 8, Steps: 4 | Train Loss: 0.655 Vali Loss: 1.937 Vali Acc: 0.280 Test Loss: 1.937 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279981).  Saving model ...
Epoch: 9 cost time: 1.3850252628326416
Epoch: 9, Steps: 4 | Train Loss: 0.765 Vali Loss: 2.054 Vali Acc: 0.260 Test Loss: 2.054 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3579487800598145
Epoch: 10, Steps: 4 | Train Loss: 0.651 Vali Loss: 2.183 Vali Acc: 0.260 Test Loss: 2.183 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2230420112609863
Epoch: 11, Steps: 4 | Train Loss: 0.415 Vali Loss: 2.381 Vali Acc: 0.280 Test Loss: 2.381 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.254286289215088
Epoch: 12, Steps: 4 | Train Loss: 0.719 Vali Loss: 2.702 Vali Acc: 0.260 Test Loss: 2.702 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1758275032043457
Epoch: 13, Steps: 4 | Train Loss: 0.364 Vali Loss: 2.823 Vali Acc: 0.240 Test Loss: 2.823 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2856407165527344
Epoch: 14, Steps: 4 | Train Loss: 0.253 Vali Loss: 3.004 Vali Acc: 0.220 Test Loss: 3.004 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.28456449508667
Epoch: 15, Steps: 4 | Train Loss: 0.542 Vali Loss: 3.371 Vali Acc: 0.240 Test Loss: 3.371 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2439637184143066
Epoch: 16, Steps: 4 | Train Loss: 0.221 Vali Loss: 3.515 Vali Acc: 0.260 Test Loss: 3.515 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.277379035949707
Epoch: 17, Steps: 4 | Train Loss: 0.376 Vali Loss: 3.698 Vali Acc: 0.280 Test Loss: 3.698 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.124673843383789
Epoch: 18, Steps: 4 | Train Loss: 0.131 Vali Loss: 3.944 Vali Acc: 0.280 Test Loss: 3.944 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1138841
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.947671890258789
Epoch: 1, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.580 Vali Acc: 0.200 Test Loss: 1.580 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.4052612781524658
Epoch: 2, Steps: 4 | Train Loss: 1.571 Vali Loss: 1.565 Vali Acc: 0.240 Test Loss: 1.565 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2160758972167969
Epoch: 3, Steps: 4 | Train Loss: 1.368 Vali Loss: 1.532 Vali Acc: 0.200 Test Loss: 1.532 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2750682830810547
Epoch: 4, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.568 Vali Acc: 0.260 Test Loss: 1.568 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.2570409774780273
Epoch: 5, Steps: 4 | Train Loss: 1.285 Vali Loss: 1.641 Vali Acc: 0.220 Test Loss: 1.641 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1494529247283936
Epoch: 6, Steps: 4 | Train Loss: 0.945 Vali Loss: 1.738 Vali Acc: 0.240 Test Loss: 1.738 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3114385604858398
Epoch: 7, Steps: 4 | Train Loss: 1.041 Vali Loss: 1.822 Vali Acc: 0.200 Test Loss: 1.822 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1859900951385498
Epoch: 8, Steps: 4 | Train Loss: 0.701 Vali Loss: 1.910 Vali Acc: 0.240 Test Loss: 1.910 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.1738145351409912
Epoch: 9, Steps: 4 | Train Loss: 0.805 Vali Loss: 2.028 Vali Acc: 0.200 Test Loss: 2.028 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.3145124912261963
Epoch: 10, Steps: 4 | Train Loss: 0.693 Vali Loss: 2.180 Vali Acc: 0.280 Test Loss: 2.180 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279978).  Saving model ...
Epoch: 11 cost time: 1.2199945449829102
Epoch: 11, Steps: 4 | Train Loss: 0.465 Vali Loss: 2.359 Vali Acc: 0.280 Test Loss: 2.359 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.3821797370910645
Epoch: 12, Steps: 4 | Train Loss: 0.767 Vali Loss: 2.630 Vali Acc: 0.260 Test Loss: 2.630 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.2564725875854492
Epoch: 13, Steps: 4 | Train Loss: 0.404 Vali Loss: 2.725 Vali Acc: 0.240 Test Loss: 2.725 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3381502628326416
Epoch: 14, Steps: 4 | Train Loss: 0.279 Vali Loss: 2.860 Vali Acc: 0.260 Test Loss: 2.860 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.4361786842346191
Epoch: 15, Steps: 4 | Train Loss: 0.596 Vali Loss: 3.097 Vali Acc: 0.260 Test Loss: 3.097 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3354599475860596
Epoch: 16, Steps: 4 | Train Loss: 0.253 Vali Loss: 3.320 Vali Acc: 0.300 Test Loss: 3.320 Test Acc: 0.300
Validation loss decreased (-0.279978 --> -0.299967).  Saving model ...
Epoch: 17 cost time: 1.298067331314087
Epoch: 17, Steps: 4 | Train Loss: 0.466 Vali Loss: 3.561 Vali Acc: 0.280 Test Loss: 3.561 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1658093929290771
Epoch: 18, Steps: 4 | Train Loss: 0.159 Vali Loss: 3.776 Vali Acc: 0.300 Test Loss: 3.776 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.2732601165771484
Epoch: 19, Steps: 4 | Train Loss: 0.160 Vali Loss: 3.969 Vali Acc: 0.300 Test Loss: 3.969 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2529702186584473
Epoch: 20, Steps: 4 | Train Loss: 0.214 Vali Loss: 4.261 Vali Acc: 0.300 Test Loss: 4.261 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.1804649829864502
Epoch: 21, Steps: 4 | Train Loss: 0.082 Vali Loss: 4.640 Vali Acc: 0.300 Test Loss: 4.640 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.1563472747802734
Epoch: 22, Steps: 4 | Train Loss: 0.054 Vali Loss: 4.948 Vali Acc: 0.300 Test Loss: 4.948 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.186415433883667
Epoch: 23, Steps: 4 | Train Loss: 0.042 Vali Loss: 5.038 Vali Acc: 0.300 Test Loss: 5.038 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.2628862857818604
Epoch: 24, Steps: 4 | Train Loss: 0.036 Vali Loss: 5.139 Vali Acc: 0.320 Test Loss: 5.139 Test Acc: 0.320
Validation loss decreased (-0.299967 --> -0.319949).  Saving model ...
Epoch: 25 cost time: 1.295863389968872
Epoch: 25, Steps: 4 | Train Loss: 0.024 Vali Loss: 5.326 Vali Acc: 0.340 Test Loss: 5.326 Test Acc: 0.340
Validation loss decreased (-0.319949 --> -0.339947).  Saving model ...
Epoch: 26 cost time: 1.2165358066558838
Epoch: 26, Steps: 4 | Train Loss: 0.018 Vali Loss: 5.500 Vali Acc: 0.340 Test Loss: 5.500 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.1349279880523682
Epoch: 27, Steps: 4 | Train Loss: 0.014 Vali Loss: 5.677 Vali Acc: 0.320 Test Loss: 5.677 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 1.14304780960083
Epoch: 28, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.889 Vali Acc: 0.340 Test Loss: 5.889 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.248530387878418
Epoch: 29, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.093 Vali Acc: 0.320 Test Loss: 6.093 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.338047742843628
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.223 Vali Acc: 0.340 Test Loss: 6.223 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 1.3371789455413818
Epoch: 31, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.445 Vali Acc: 0.360 Test Loss: 6.445 Test Acc: 0.360
Validation loss decreased (-0.339947 --> -0.359936).  Saving model ...
Epoch: 32 cost time: 1.2902402877807617
Epoch: 32, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.561 Vali Acc: 0.360 Test Loss: 6.561 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2172846794128418
Epoch: 33, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.639 Vali Acc: 0.360 Test Loss: 6.639 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.5324985980987549
Epoch: 34, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.662 Vali Acc: 0.380 Test Loss: 6.662 Test Acc: 0.380
Validation loss decreased (-0.359936 --> -0.379933).  Saving model ...
Epoch: 35 cost time: 1.2483594417572021
Epoch: 35, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.739 Vali Acc: 0.360 Test Loss: 6.739 Test Acc: 0.360
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.1659038066864014
Epoch: 36, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.747 Vali Acc: 0.360 Test Loss: 6.747 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.3736662864685059
Epoch: 37, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.697 Vali Acc: 0.360 Test Loss: 6.697 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.2453482151031494
Epoch: 38, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.752 Vali Acc: 0.320 Test Loss: 6.752 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.2630016803741455
Epoch: 39, Steps: 4 | Train Loss: 0.004 Vali Loss: 6.772 Vali Acc: 0.320 Test Loss: 6.772 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.3671505451202393
Epoch: 40, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.735 Vali Acc: 0.320 Test Loss: 6.735 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.3881092071533203
Epoch: 41, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.760 Vali Acc: 0.320 Test Loss: 6.760 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.3454039096832275
Epoch: 42, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.835 Vali Acc: 0.320 Test Loss: 6.835 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.2328684329986572
Epoch: 43, Steps: 4 | Train Loss: 0.003 Vali Loss: 6.911 Vali Acc: 0.320 Test Loss: 6.911 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.2818129062652588
Epoch: 44, Steps: 4 | Train Loss: 0.002 Vali Loss: 6.991 Vali Acc: 0.360 Test Loss: 6.991 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1138841
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9228689670562744
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.548 Vali Acc: 0.240 Test Loss: 1.548 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.5186607837677002
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
Validation loss decreased (-0.239985 --> -0.239985).  Saving model ...
Epoch: 3 cost time: 1.4030635356903076
Epoch: 3, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.503 Vali Acc: 0.280 Test Loss: 1.503 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.1869587898254395
Epoch: 4, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.541 Vali Acc: 0.220 Test Loss: 1.541 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4374563694000244
Epoch: 5, Steps: 4 | Train Loss: 1.312 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2364344596862793
Epoch: 6, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.697 Vali Acc: 0.280 Test Loss: 1.697 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3384473323822021
Epoch: 7, Steps: 4 | Train Loss: 1.078 Vali Loss: 1.797 Vali Acc: 0.220 Test Loss: 1.797 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3446109294891357
Epoch: 8, Steps: 4 | Train Loss: 0.751 Vali Loss: 1.876 Vali Acc: 0.260 Test Loss: 1.876 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.4216599464416504
Epoch: 9, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.997 Vali Acc: 0.240 Test Loss: 1.997 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.5165319442749023
Epoch: 10, Steps: 4 | Train Loss: 0.725 Vali Loss: 2.125 Vali Acc: 0.260 Test Loss: 2.125 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.6754329204559326
Epoch: 11, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.295 Vali Acc: 0.220 Test Loss: 2.295 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.6951320171356201
Epoch: 12, Steps: 4 | Train Loss: 0.820 Vali Loss: 2.521 Vali Acc: 0.280 Test Loss: 2.521 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5237789154052734
Epoch: 13, Steps: 4 | Train Loss: 0.454 Vali Loss: 2.627 Vali Acc: 0.260 Test Loss: 2.627 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 1138841
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4616293907165527
Epoch: 1, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.581 Vali Acc: 0.200 Test Loss: 1.581 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2673847675323486
Epoch: 2, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.575 Vali Acc: 0.220 Test Loss: 1.575 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.213437795639038
Epoch: 3, Steps: 4 | Train Loss: 1.445 Vali Loss: 1.547 Vali Acc: 0.280 Test Loss: 1.547 Test Acc: 0.280
Validation loss decreased (-0.219984 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.1399195194244385
Epoch: 4, Steps: 4 | Train Loss: 1.405 Vali Loss: 1.550 Vali Acc: 0.220 Test Loss: 1.550 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2352702617645264
Epoch: 5, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.579 Vali Acc: 0.240 Test Loss: 1.579 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2272670269012451
Epoch: 6, Steps: 4 | Train Loss: 1.057 Vali Loss: 1.635 Vali Acc: 0.240 Test Loss: 1.635 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2959413528442383
Epoch: 7, Steps: 4 | Train Loss: 1.158 Vali Loss: 1.676 Vali Acc: 0.220 Test Loss: 1.676 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.2297368049621582
Epoch: 8, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.710 Vali Acc: 0.280 Test Loss: 1.710 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2813050746917725
Epoch: 9, Steps: 4 | Train Loss: 0.956 Vali Loss: 1.768 Vali Acc: 0.220 Test Loss: 1.768 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.4122834205627441
Epoch: 10, Steps: 4 | Train Loss: 0.806 Vali Loss: 1.845 Vali Acc: 0.220 Test Loss: 1.845 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2081005573272705
Epoch: 11, Steps: 4 | Train Loss: 0.640 Vali Loss: 1.981 Vali Acc: 0.280 Test Loss: 1.981 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2020018100738525
Epoch: 12, Steps: 4 | Train Loss: 0.842 Vali Loss: 2.163 Vali Acc: 0.280 Test Loss: 2.163 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2302398681640625
Epoch: 13, Steps: 4 | Train Loss: 0.537 Vali Loss: 2.192 Vali Acc: 0.320 Test Loss: 2.192 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319978).  Saving model ...
Epoch: 14 cost time: 1.0970814228057861
Epoch: 14, Steps: 4 | Train Loss: 0.396 Vali Loss: 2.201 Vali Acc: 0.300 Test Loss: 2.201 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.245509147644043
Epoch: 15, Steps: 4 | Train Loss: 0.678 Vali Loss: 2.316 Vali Acc: 0.300 Test Loss: 2.316 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3835935592651367
Epoch: 16, Steps: 4 | Train Loss: 0.365 Vali Loss: 2.414 Vali Acc: 0.320 Test Loss: 2.414 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.1693851947784424
Epoch: 17, Steps: 4 | Train Loss: 0.562 Vali Loss: 2.472 Vali Acc: 0.300 Test Loss: 2.472 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.1083629131317139
Epoch: 18, Steps: 4 | Train Loss: 0.252 Vali Loss: 2.467 Vali Acc: 0.260 Test Loss: 2.467 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2614431381225586
Epoch: 19, Steps: 4 | Train Loss: 0.234 Vali Loss: 2.572 Vali Acc: 0.280 Test Loss: 2.572 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.1820361614227295
Epoch: 20, Steps: 4 | Train Loss: 0.395 Vali Loss: 2.871 Vali Acc: 0.280 Test Loss: 2.871 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2494935989379883
Epoch: 21, Steps: 4 | Train Loss: 0.147 Vali Loss: 2.963 Vali Acc: 0.240 Test Loss: 2.963 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.190847635269165
Epoch: 22, Steps: 4 | Train Loss: 0.103 Vali Loss: 3.223 Vali Acc: 0.280 Test Loss: 3.223 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3254785537719727
Epoch: 23, Steps: 4 | Train Loss: 0.080 Vali Loss: 3.414 Vali Acc: 0.260 Test Loss: 3.414 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 1138841
model size : 6.80MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.532533884048462
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.654 Vali Acc: 0.240 Test Loss: 1.654 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.246678352355957
Epoch: 2, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.564 Vali Acc: 0.240 Test Loss: 1.564 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.099456787109375
Epoch: 3, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.529 Vali Acc: 0.260 Test Loss: 1.529 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 1.168355941772461
Epoch: 4, Steps: 4 | Train Loss: 1.280 Vali Loss: 1.590 Vali Acc: 0.200 Test Loss: 1.590 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2165613174438477
Epoch: 5, Steps: 4 | Train Loss: 1.125 Vali Loss: 1.721 Vali Acc: 0.220 Test Loss: 1.721 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1913444995880127
Epoch: 6, Steps: 4 | Train Loss: 0.994 Vali Loss: 1.870 Vali Acc: 0.200 Test Loss: 1.870 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.122182846069336
Epoch: 7, Steps: 4 | Train Loss: 0.956 Vali Loss: 1.888 Vali Acc: 0.200 Test Loss: 1.888 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1928303241729736
Epoch: 8, Steps: 4 | Train Loss: 0.799 Vali Loss: 1.952 Vali Acc: 0.240 Test Loss: 1.952 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2953245639801025
Epoch: 9, Steps: 4 | Train Loss: 0.684 Vali Loss: 2.026 Vali Acc: 0.280 Test Loss: 2.026 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279980).  Saving model ...
Epoch: 10 cost time: 1.1888866424560547
Epoch: 10, Steps: 4 | Train Loss: 0.471 Vali Loss: 2.162 Vali Acc: 0.280 Test Loss: 2.162 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2306275367736816
Epoch: 11, Steps: 4 | Train Loss: 0.397 Vali Loss: 2.312 Vali Acc: 0.260 Test Loss: 2.312 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.2548809051513672
Epoch: 12, Steps: 4 | Train Loss: 0.760 Vali Loss: 2.556 Vali Acc: 0.280 Test Loss: 2.556 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.0570008754730225
Epoch: 13, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.708 Vali Acc: 0.260 Test Loss: 2.708 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2644071578979492
Epoch: 14, Steps: 4 | Train Loss: 0.268 Vali Loss: 2.877 Vali Acc: 0.280 Test Loss: 2.877 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.2475645542144775
Epoch: 15, Steps: 4 | Train Loss: 0.264 Vali Loss: 3.156 Vali Acc: 0.280 Test Loss: 3.156 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2659571170806885
Epoch: 16, Steps: 4 | Train Loss: 0.408 Vali Loss: 3.455 Vali Acc: 0.260 Test Loss: 3.455 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.0633323192596436
Epoch: 17, Steps: 4 | Train Loss: 0.180 Vali Loss: 3.652 Vali Acc: 0.280 Test Loss: 3.652 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.179842472076416
Epoch: 18, Steps: 4 | Train Loss: 0.129 Vali Loss: 3.771 Vali Acc: 0.320 Test Loss: 3.771 Test Acc: 0.320
Validation loss decreased (-0.279980 --> -0.319962).  Saving model ...
Epoch: 19 cost time: 1.0416123867034912
Epoch: 19, Steps: 4 | Train Loss: 0.122 Vali Loss: 3.807 Vali Acc: 0.300 Test Loss: 3.807 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.073061227798462
Epoch: 20, Steps: 4 | Train Loss: 0.095 Vali Loss: 4.154 Vali Acc: 0.300 Test Loss: 4.154 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3480618000030518
Epoch: 21, Steps: 4 | Train Loss: 0.061 Vali Loss: 4.408 Vali Acc: 0.380 Test Loss: 4.408 Test Acc: 0.380
Validation loss decreased (-0.319962 --> -0.379956).  Saving model ...
Epoch: 22 cost time: 1.2692484855651855
Epoch: 22, Steps: 4 | Train Loss: 0.086 Vali Loss: 4.480 Vali Acc: 0.380 Test Loss: 4.480 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.380685567855835
Epoch: 23, Steps: 4 | Train Loss: 0.049 Vali Loss: 4.718 Vali Acc: 0.380 Test Loss: 4.718 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.1188287734985352
Epoch: 24, Steps: 4 | Train Loss: 0.025 Vali Loss: 4.863 Vali Acc: 0.320 Test Loss: 4.863 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0923244953155518
Epoch: 25, Steps: 4 | Train Loss: 0.021 Vali Loss: 5.034 Vali Acc: 0.320 Test Loss: 5.034 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2983124256134033
Epoch: 26, Steps: 4 | Train Loss: 0.015 Vali Loss: 5.128 Vali Acc: 0.320 Test Loss: 5.128 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4248285293579102
Epoch: 27, Steps: 4 | Train Loss: 0.011 Vali Loss: 5.250 Vali Acc: 0.340 Test Loss: 5.250 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2520008087158203
Epoch: 28, Steps: 4 | Train Loss: 0.009 Vali Loss: 5.406 Vali Acc: 0.360 Test Loss: 5.406 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.2319929599761963
Epoch: 29, Steps: 4 | Train Loss: 0.009 Vali Loss: 5.575 Vali Acc: 0.360 Test Loss: 5.575 Test Acc: 0.360
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.1779148578643799
Epoch: 30, Steps: 4 | Train Loss: 0.007 Vali Loss: 5.705 Vali Acc: 0.380 Test Loss: 5.705 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2509715557098389
Epoch: 31, Steps: 4 | Train Loss: 0.009 Vali Loss: 5.899 Vali Acc: 0.360 Test Loss: 5.899 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1106073
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5256283283233643
Epoch: 1, Steps: 4 | Train Loss: 1.637 Vali Loss: 1.704 Vali Acc: 0.240 Test Loss: 1.704 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.1536672115325928
Epoch: 2, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.607 Vali Acc: 0.160 Test Loss: 1.607 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0239148139953613
Epoch: 3, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.552 Vali Acc: 0.300 Test Loss: 1.552 Test Acc: 0.300
Validation loss decreased (-0.239983 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.1987388134002686
Epoch: 4, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.602 Vali Acc: 0.200 Test Loss: 1.602 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3780856132507324
Epoch: 5, Steps: 4 | Train Loss: 1.128 Vali Loss: 1.721 Vali Acc: 0.200 Test Loss: 1.721 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.319148302078247
Epoch: 6, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.855 Vali Acc: 0.240 Test Loss: 1.855 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3126296997070312
Epoch: 7, Steps: 4 | Train Loss: 0.978 Vali Loss: 1.839 Vali Acc: 0.200 Test Loss: 1.839 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3288254737854004
Epoch: 8, Steps: 4 | Train Loss: 0.838 Vali Loss: 1.920 Vali Acc: 0.240 Test Loss: 1.920 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.420731544494629
Epoch: 9, Steps: 4 | Train Loss: 0.735 Vali Loss: 2.019 Vali Acc: 0.280 Test Loss: 2.019 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1934638023376465
Epoch: 10, Steps: 4 | Train Loss: 0.502 Vali Loss: 2.159 Vali Acc: 0.280 Test Loss: 2.159 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.268385648727417
Epoch: 11, Steps: 4 | Train Loss: 0.419 Vali Loss: 2.371 Vali Acc: 0.260 Test Loss: 2.371 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.416881799697876
Epoch: 12, Steps: 4 | Train Loss: 0.797 Vali Loss: 2.572 Vali Acc: 0.260 Test Loss: 2.572 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.5263049602508545
Epoch: 13, Steps: 4 | Train Loss: 0.402 Vali Loss: 2.721 Vali Acc: 0.280 Test Loss: 2.721 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1106073
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5565783977508545
Epoch: 1, Steps: 4 | Train Loss: 1.660 Vali Loss: 1.687 Vali Acc: 0.240 Test Loss: 1.687 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.1812098026275635
Epoch: 2, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.608 Vali Acc: 0.240 Test Loss: 1.608 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.199202537536621
Epoch: 3, Steps: 4 | Train Loss: 1.497 Vali Loss: 1.559 Vali Acc: 0.260 Test Loss: 1.559 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.1484320163726807
Epoch: 4, Steps: 4 | Train Loss: 1.385 Vali Loss: 1.584 Vali Acc: 0.220 Test Loss: 1.584 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1145381927490234
Epoch: 5, Steps: 4 | Train Loss: 1.166 Vali Loss: 1.682 Vali Acc: 0.240 Test Loss: 1.682 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2354981899261475
Epoch: 6, Steps: 4 | Train Loss: 1.074 Vali Loss: 1.795 Vali Acc: 0.280 Test Loss: 1.795 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279982).  Saving model ...
Epoch: 7 cost time: 1.2402899265289307
Epoch: 7, Steps: 4 | Train Loss: 1.034 Vali Loss: 1.836 Vali Acc: 0.200 Test Loss: 1.836 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0626111030578613
Epoch: 8, Steps: 4 | Train Loss: 0.925 Vali Loss: 1.933 Vali Acc: 0.280 Test Loss: 1.933 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.233837604522705
Epoch: 9, Steps: 4 | Train Loss: 0.818 Vali Loss: 1.984 Vali Acc: 0.260 Test Loss: 1.984 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2822074890136719
Epoch: 10, Steps: 4 | Train Loss: 0.555 Vali Loss: 2.121 Vali Acc: 0.280 Test Loss: 2.121 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3188197612762451
Epoch: 11, Steps: 4 | Train Loss: 0.463 Vali Loss: 2.301 Vali Acc: 0.240 Test Loss: 2.301 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.3809397220611572
Epoch: 12, Steps: 4 | Train Loss: 0.857 Vali Loss: 2.530 Vali Acc: 0.300 Test Loss: 2.530 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299975).  Saving model ...
Epoch: 13 cost time: 1.1865758895874023
Epoch: 13, Steps: 4 | Train Loss: 0.452 Vali Loss: 2.680 Vali Acc: 0.240 Test Loss: 2.680 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.1962759494781494
Epoch: 14, Steps: 4 | Train Loss: 0.339 Vali Loss: 2.897 Vali Acc: 0.280 Test Loss: 2.897 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1189608573913574
Epoch: 15, Steps: 4 | Train Loss: 0.330 Vali Loss: 3.193 Vali Acc: 0.300 Test Loss: 3.193 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.370711326599121
Epoch: 16, Steps: 4 | Train Loss: 0.457 Vali Loss: 3.476 Vali Acc: 0.260 Test Loss: 3.476 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.183617115020752
Epoch: 17, Steps: 4 | Train Loss: 0.239 Vali Loss: 3.657 Vali Acc: 0.300 Test Loss: 3.657 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2683534622192383
Epoch: 18, Steps: 4 | Train Loss: 0.179 Vali Loss: 3.850 Vali Acc: 0.320 Test Loss: 3.850 Test Acc: 0.320
Validation loss decreased (-0.299975 --> -0.319961).  Saving model ...
Epoch: 19 cost time: 1.2814059257507324
Epoch: 19, Steps: 4 | Train Loss: 0.190 Vali Loss: 3.959 Vali Acc: 0.260 Test Loss: 3.959 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6965100765228271
Epoch: 20, Steps: 4 | Train Loss: 0.150 Vali Loss: 4.221 Vali Acc: 0.260 Test Loss: 4.221 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1961398124694824
Epoch: 21, Steps: 4 | Train Loss: 0.107 Vali Loss: 4.447 Vali Acc: 0.340 Test Loss: 4.447 Test Acc: 0.340
Validation loss decreased (-0.319961 --> -0.339956).  Saving model ...
Epoch: 22 cost time: 1.2434446811676025
Epoch: 22, Steps: 4 | Train Loss: 0.146 Vali Loss: 4.632 Vali Acc: 0.280 Test Loss: 4.632 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3397865295410156
Epoch: 23, Steps: 4 | Train Loss: 0.091 Vali Loss: 4.945 Vali Acc: 0.300 Test Loss: 4.945 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.4508633613586426
Epoch: 24, Steps: 4 | Train Loss: 0.049 Vali Loss: 5.271 Vali Acc: 0.320 Test Loss: 5.271 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.2767858505249023
Epoch: 25, Steps: 4 | Train Loss: 0.044 Vali Loss: 5.621 Vali Acc: 0.320 Test Loss: 5.621 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2360167503356934
Epoch: 26, Steps: 4 | Train Loss: 0.028 Vali Loss: 5.885 Vali Acc: 0.340 Test Loss: 5.885 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.3026232719421387
Epoch: 27, Steps: 4 | Train Loss: 0.020 Vali Loss: 6.043 Vali Acc: 0.340 Test Loss: 6.043 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0530500411987305
Epoch: 28, Steps: 4 | Train Loss: 0.017 Vali Loss: 6.092 Vali Acc: 0.320 Test Loss: 6.092 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.1207458972930908
Epoch: 29, Steps: 4 | Train Loss: 0.016 Vali Loss: 6.207 Vali Acc: 0.340 Test Loss: 6.207 Test Acc: 0.340
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.2694642543792725
Epoch: 30, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.398 Vali Acc: 0.340 Test Loss: 6.398 Test Acc: 0.340
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.2460956573486328
Epoch: 31, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.611 Vali Acc: 0.340 Test Loss: 6.611 Test Acc: 0.340
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 1106073
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.596312999725342
Epoch: 1, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.664 Vali Acc: 0.240 Test Loss: 1.664 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.2564377784729004
Epoch: 2, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.600 Vali Acc: 0.240 Test Loss: 1.600 Test Acc: 0.240
Validation loss decreased (-0.239983 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2193799018859863
Epoch: 3, Steps: 4 | Train Loss: 1.534 Vali Loss: 1.546 Vali Acc: 0.260 Test Loss: 1.546 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 1.2321035861968994
Epoch: 4, Steps: 4 | Train Loss: 1.431 Vali Loss: 1.534 Vali Acc: 0.240 Test Loss: 1.534 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0329184532165527
Epoch: 5, Steps: 4 | Train Loss: 1.233 Vali Loss: 1.582 Vali Acc: 0.200 Test Loss: 1.582 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2582716941833496
Epoch: 6, Steps: 4 | Train Loss: 1.171 Vali Loss: 1.639 Vali Acc: 0.220 Test Loss: 1.639 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1283633708953857
Epoch: 7, Steps: 4 | Train Loss: 1.105 Vali Loss: 1.667 Vali Acc: 0.200 Test Loss: 1.667 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1881730556488037
Epoch: 8, Steps: 4 | Train Loss: 1.043 Vali Loss: 1.744 Vali Acc: 0.200 Test Loss: 1.744 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.128422498703003
Epoch: 9, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.793 Vali Acc: 0.220 Test Loss: 1.793 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.3603081703186035
Epoch: 10, Steps: 4 | Train Loss: 0.642 Vali Loss: 1.861 Vali Acc: 0.260 Test Loss: 1.861 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.167595386505127
Epoch: 11, Steps: 4 | Train Loss: 0.539 Vali Loss: 1.982 Vali Acc: 0.280 Test Loss: 1.982 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279980).  Saving model ...
Epoch: 12 cost time: 1.1166367530822754
Epoch: 12, Steps: 4 | Train Loss: 0.920 Vali Loss: 2.102 Vali Acc: 0.280 Test Loss: 2.102 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.212496042251587
Epoch: 13, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.127 Vali Acc: 0.260 Test Loss: 2.127 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3731119632720947
Epoch: 14, Steps: 4 | Train Loss: 0.396 Vali Loss: 2.226 Vali Acc: 0.260 Test Loss: 2.226 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1908962726593018
Epoch: 15, Steps: 4 | Train Loss: 0.399 Vali Loss: 2.205 Vali Acc: 0.340 Test Loss: 2.205 Test Acc: 0.340
Validation loss decreased (-0.279980 --> -0.339978).  Saving model ...
Epoch: 16 cost time: 1.3057448863983154
Epoch: 16, Steps: 4 | Train Loss: 0.483 Vali Loss: 2.211 Vali Acc: 0.360 Test Loss: 2.211 Test Acc: 0.360
Validation loss decreased (-0.339978 --> -0.359978).  Saving model ...
Epoch: 17 cost time: 1.2985038757324219
Epoch: 17, Steps: 4 | Train Loss: 0.290 Vali Loss: 2.306 Vali Acc: 0.300 Test Loss: 2.306 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.353189468383789
Epoch: 18, Steps: 4 | Train Loss: 0.225 Vali Loss: 2.443 Vali Acc: 0.360 Test Loss: 2.443 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.321122646331787
Epoch: 19, Steps: 4 | Train Loss: 0.236 Vali Loss: 2.481 Vali Acc: 0.320 Test Loss: 2.481 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.2710189819335938
Epoch: 20, Steps: 4 | Train Loss: 0.184 Vali Loss: 2.576 Vali Acc: 0.300 Test Loss: 2.576 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.239802360534668
Epoch: 21, Steps: 4 | Train Loss: 0.136 Vali Loss: 2.715 Vali Acc: 0.300 Test Loss: 2.715 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.4916412830352783
Epoch: 22, Steps: 4 | Train Loss: 0.172 Vali Loss: 2.755 Vali Acc: 0.280 Test Loss: 2.755 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.216942310333252
Epoch: 23, Steps: 4 | Train Loss: 0.111 Vali Loss: 2.935 Vali Acc: 0.240 Test Loss: 2.935 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.1474621295928955
Epoch: 24, Steps: 4 | Train Loss: 0.066 Vali Loss: 3.282 Vali Acc: 0.240 Test Loss: 3.282 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.1861176490783691
Epoch: 25, Steps: 4 | Train Loss: 0.058 Vali Loss: 3.448 Vali Acc: 0.300 Test Loss: 3.448 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.2788002490997314
Epoch: 26, Steps: 4 | Train Loss: 0.038 Vali Loss: 3.682 Vali Acc: 0.260 Test Loss: 3.682 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1106073
model size : 6.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.393535375595093
Epoch: 1, Steps: 4 | Train Loss: 1.644 Vali Loss: 1.513 Vali Acc: 0.240 Test Loss: 1.513 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.2955162525177002
Epoch: 2, Steps: 4 | Train Loss: 1.543 Vali Loss: 1.519 Vali Acc: 0.220 Test Loss: 1.519 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0656020641326904
Epoch: 3, Steps: 4 | Train Loss: 1.441 Vali Loss: 1.520 Vali Acc: 0.220 Test Loss: 1.520 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1203930377960205
Epoch: 4, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.573 Vali Acc: 0.240 Test Loss: 1.573 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.1331100463867188
Epoch: 5, Steps: 4 | Train Loss: 0.911 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.058609962463379
Epoch: 6, Steps: 4 | Train Loss: 0.964 Vali Loss: 1.697 Vali Acc: 0.180 Test Loss: 1.697 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.1881587505340576
Epoch: 7, Steps: 4 | Train Loss: 0.685 Vali Loss: 1.823 Vali Acc: 0.240 Test Loss: 1.823 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1208021640777588
Epoch: 8, Steps: 4 | Train Loss: 0.751 Vali Loss: 2.003 Vali Acc: 0.220 Test Loss: 2.003 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2014718055725098
Epoch: 9, Steps: 4 | Train Loss: 1.056 Vali Loss: 2.133 Vali Acc: 0.180 Test Loss: 2.133 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0497503280639648
Epoch: 10, Steps: 4 | Train Loss: 0.465 Vali Loss: 2.199 Vali Acc: 0.240 Test Loss: 2.199 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.2233421802520752
Epoch: 11, Steps: 4 | Train Loss: 0.522 Vali Loss: 2.311 Vali Acc: 0.320 Test Loss: 2.311 Test Acc: 0.320
Validation loss decreased (-0.239985 --> -0.319977).  Saving model ...
Epoch: 12 cost time: 1.2200491428375244
Epoch: 12, Steps: 4 | Train Loss: 0.442 Vali Loss: 2.551 Vali Acc: 0.240 Test Loss: 2.551 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3410379886627197
Epoch: 13, Steps: 4 | Train Loss: 0.301 Vali Loss: 2.731 Vali Acc: 0.280 Test Loss: 2.731 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.3981709480285645
Epoch: 14, Steps: 4 | Train Loss: 0.265 Vali Loss: 2.916 Vali Acc: 0.300 Test Loss: 2.916 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.3457372188568115
Epoch: 15, Steps: 4 | Train Loss: 0.250 Vali Loss: 3.053 Vali Acc: 0.280 Test Loss: 3.053 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.2352638244628906
Epoch: 16, Steps: 4 | Train Loss: 0.487 Vali Loss: 3.266 Vali Acc: 0.220 Test Loss: 3.266 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.262826919555664
Epoch: 17, Steps: 4 | Train Loss: 0.167 Vali Loss: 3.532 Vali Acc: 0.240 Test Loss: 3.532 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3902544975280762
Epoch: 18, Steps: 4 | Train Loss: 0.138 Vali Loss: 3.895 Vali Acc: 0.240 Test Loss: 3.895 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0921907424926758
Epoch: 19, Steps: 4 | Train Loss: 0.114 Vali Loss: 4.238 Vali Acc: 0.240 Test Loss: 4.238 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2193796634674072
Epoch: 20, Steps: 4 | Train Loss: 0.087 Vali Loss: 4.584 Vali Acc: 0.320 Test Loss: 4.584 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1665306091308594
Epoch: 21, Steps: 4 | Train Loss: 0.071 Vali Loss: 4.815 Vali Acc: 0.340 Test Loss: 4.815 Test Acc: 0.340
Validation loss decreased (-0.319977 --> -0.339952).  Saving model ...
Epoch: 22 cost time: 1.2616794109344482
Epoch: 22, Steps: 4 | Train Loss: 0.115 Vali Loss: 5.074 Vali Acc: 0.360 Test Loss: 5.074 Test Acc: 0.360
Validation loss decreased (-0.339952 --> -0.359949).  Saving model ...
Epoch: 23 cost time: 1.2135443687438965
Epoch: 23, Steps: 4 | Train Loss: 0.046 Vali Loss: 5.180 Vali Acc: 0.340 Test Loss: 5.180 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.3715879917144775
Epoch: 24, Steps: 4 | Train Loss: 0.030 Vali Loss: 5.483 Vali Acc: 0.360 Test Loss: 5.483 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.4822449684143066
Epoch: 25, Steps: 4 | Train Loss: 0.022 Vali Loss: 5.827 Vali Acc: 0.340 Test Loss: 5.827 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.335663080215454
Epoch: 26, Steps: 4 | Train Loss: 0.017 Vali Loss: 6.171 Vali Acc: 0.340 Test Loss: 6.171 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.5291476249694824
Epoch: 27, Steps: 4 | Train Loss: 0.012 Vali Loss: 6.367 Vali Acc: 0.340 Test Loss: 6.367 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.517442226409912
Epoch: 28, Steps: 4 | Train Loss: 0.010 Vali Loss: 6.482 Vali Acc: 0.380 Test Loss: 6.482 Test Acc: 0.380
Validation loss decreased (-0.359949 --> -0.379935).  Saving model ...
Epoch: 29 cost time: 1.3385627269744873
Epoch: 29, Steps: 4 | Train Loss: 0.015 Vali Loss: 6.497 Vali Acc: 0.380 Test Loss: 6.497 Test Acc: 0.380
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.4085450172424316
Epoch: 30, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.513 Vali Acc: 0.380 Test Loss: 6.513 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.2284178733825684
Epoch: 31, Steps: 4 | Train Loss: 0.006 Vali Loss: 6.549 Vali Acc: 0.380 Test Loss: 6.549 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 1.400669813156128
Epoch: 32, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.721 Vali Acc: 0.380 Test Loss: 6.721 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 1.3419744968414307
Epoch: 33, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.724 Vali Acc: 0.380 Test Loss: 6.724 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 1.324178695678711
Epoch: 34, Steps: 4 | Train Loss: 0.005 Vali Loss: 6.812 Vali Acc: 0.360 Test Loss: 6.812 Test Acc: 0.360
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.22566556930542
Epoch: 35, Steps: 4 | Train Loss: 0.007 Vali Loss: 6.976 Vali Acc: 0.400 Test Loss: 6.976 Test Acc: 0.400
Validation loss decreased (-0.379935 --> -0.399930).  Saving model ...
Epoch: 36 cost time: 1.2011399269104004
Epoch: 36, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.179 Vali Acc: 0.420 Test Loss: 7.179 Test Acc: 0.420
Validation loss decreased (-0.399930 --> -0.419928).  Saving model ...
Epoch: 37 cost time: 1.2149803638458252
Epoch: 37, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.364 Vali Acc: 0.400 Test Loss: 7.364 Test Acc: 0.400
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 1.2160124778747559
Epoch: 38, Steps: 4 | Train Loss: 0.004 Vali Loss: 7.470 Vali Acc: 0.380 Test Loss: 7.470 Test Acc: 0.380
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 1.3244590759277344
Epoch: 39, Steps: 4 | Train Loss: 0.003 Vali Loss: 7.634 Vali Acc: 0.380 Test Loss: 7.634 Test Acc: 0.380
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 1.220233678817749
Epoch: 40, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.732 Vali Acc: 0.380 Test Loss: 7.732 Test Acc: 0.380
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 1.2423884868621826
Epoch: 41, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.836 Vali Acc: 0.380 Test Loss: 7.836 Test Acc: 0.380
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 1.3465187549591064
Epoch: 42, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.874 Vali Acc: 0.380 Test Loss: 7.874 Test Acc: 0.380
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 1.4930682182312012
Epoch: 43, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.867 Vali Acc: 0.380 Test Loss: 7.867 Test Acc: 0.380
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 1.4403221607208252
Epoch: 44, Steps: 4 | Train Loss: 0.001 Vali Loss: 7.882 Vali Acc: 0.380 Test Loss: 7.882 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 1.2306585311889648
Epoch: 45, Steps: 4 | Train Loss: 0.002 Vali Loss: 7.952 Vali Acc: 0.380 Test Loss: 7.952 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 1.224529504776001
Epoch: 46, Steps: 4 | Train Loss: 0.001 Vali Loss: 8.022 Vali Acc: 0.380 Test Loss: 8.022 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.42
model parameter : 1089689
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8847122192382812
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.528 Vali Acc: 0.240 Test Loss: 1.528 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.698826551437378
Epoch: 2, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.515 Vali Acc: 0.280 Test Loss: 1.515 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.550248384475708
Epoch: 3, Steps: 4 | Train Loss: 1.443 Vali Loss: 1.513 Vali Acc: 0.200 Test Loss: 1.513 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4775390625
Epoch: 4, Steps: 4 | Train Loss: 1.319 Vali Loss: 1.562 Vali Acc: 0.220 Test Loss: 1.562 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.594928503036499
Epoch: 5, Steps: 4 | Train Loss: 0.934 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.4495677947998047
Epoch: 6, Steps: 4 | Train Loss: 1.002 Vali Loss: 1.700 Vali Acc: 0.240 Test Loss: 1.700 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3694970607757568
Epoch: 7, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.822 Vali Acc: 0.240 Test Loss: 1.822 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.4083316326141357
Epoch: 8, Steps: 4 | Train Loss: 0.782 Vali Loss: 1.984 Vali Acc: 0.240 Test Loss: 1.984 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.5017273426055908
Epoch: 9, Steps: 4 | Train Loss: 1.059 Vali Loss: 2.134 Vali Acc: 0.200 Test Loss: 2.134 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2491493225097656
Epoch: 10, Steps: 4 | Train Loss: 0.493 Vali Loss: 2.188 Vali Acc: 0.280 Test Loss: 2.188 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3333396911621094
Epoch: 11, Steps: 4 | Train Loss: 0.561 Vali Loss: 2.363 Vali Acc: 0.320 Test Loss: 2.363 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319976).  Saving model ...
Epoch: 12 cost time: 1.4414396286010742
Epoch: 12, Steps: 4 | Train Loss: 0.474 Vali Loss: 2.560 Vali Acc: 0.240 Test Loss: 2.560 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3381969928741455
Epoch: 13, Steps: 4 | Train Loss: 0.333 Vali Loss: 2.757 Vali Acc: 0.260 Test Loss: 2.757 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2967426776885986
Epoch: 14, Steps: 4 | Train Loss: 0.286 Vali Loss: 3.009 Vali Acc: 0.300 Test Loss: 3.009 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4735114574432373
Epoch: 15, Steps: 4 | Train Loss: 0.273 Vali Loss: 3.133 Vali Acc: 0.300 Test Loss: 3.133 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3925607204437256
Epoch: 16, Steps: 4 | Train Loss: 0.536 Vali Loss: 3.344 Vali Acc: 0.260 Test Loss: 3.344 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6111764907836914
Epoch: 17, Steps: 4 | Train Loss: 0.185 Vali Loss: 3.625 Vali Acc: 0.300 Test Loss: 3.625 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.4939532279968262
Epoch: 18, Steps: 4 | Train Loss: 0.157 Vali Loss: 3.934 Vali Acc: 0.300 Test Loss: 3.934 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.2725307941436768
Epoch: 19, Steps: 4 | Train Loss: 0.140 Vali Loss: 4.301 Vali Acc: 0.320 Test Loss: 4.301 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7231080532073975
Epoch: 20, Steps: 4 | Train Loss: 0.104 Vali Loss: 4.672 Vali Acc: 0.360 Test Loss: 4.672 Test Acc: 0.360
Validation loss decreased (-0.319976 --> -0.359953).  Saving model ...
Epoch: 21 cost time: 1.4693398475646973
Epoch: 21, Steps: 4 | Train Loss: 0.084 Vali Loss: 4.953 Vali Acc: 0.380 Test Loss: 4.953 Test Acc: 0.380
Validation loss decreased (-0.359953 --> -0.379950).  Saving model ...
Epoch: 22 cost time: 1.275669813156128
Epoch: 22, Steps: 4 | Train Loss: 0.144 Vali Loss: 5.314 Vali Acc: 0.340 Test Loss: 5.314 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.3638391494750977
Epoch: 23, Steps: 4 | Train Loss: 0.060 Vali Loss: 5.413 Vali Acc: 0.360 Test Loss: 5.413 Test Acc: 0.360
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5267560482025146
Epoch: 24, Steps: 4 | Train Loss: 0.039 Vali Loss: 5.692 Vali Acc: 0.360 Test Loss: 5.692 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.3364861011505127
Epoch: 25, Steps: 4 | Train Loss: 0.030 Vali Loss: 6.079 Vali Acc: 0.340 Test Loss: 6.079 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.2895302772521973
Epoch: 26, Steps: 4 | Train Loss: 0.021 Vali Loss: 6.430 Vali Acc: 0.320 Test Loss: 6.430 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.4173028469085693
Epoch: 27, Steps: 4 | Train Loss: 0.015 Vali Loss: 6.621 Vali Acc: 0.320 Test Loss: 6.621 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.2810401916503906
Epoch: 28, Steps: 4 | Train Loss: 0.013 Vali Loss: 6.677 Vali Acc: 0.360 Test Loss: 6.677 Test Acc: 0.360
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.350539207458496
Epoch: 29, Steps: 4 | Train Loss: 0.018 Vali Loss: 6.744 Vali Acc: 0.380 Test Loss: 6.744 Test Acc: 0.380
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.4769010543823242
Epoch: 30, Steps: 4 | Train Loss: 0.009 Vali Loss: 6.805 Vali Acc: 0.380 Test Loss: 6.805 Test Acc: 0.380
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.390716791152954
Epoch: 31, Steps: 4 | Train Loss: 0.008 Vali Loss: 6.943 Vali Acc: 0.380 Test Loss: 6.943 Test Acc: 0.380
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.38
model parameter : 1089689
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.332720994949341
Epoch: 1, Steps: 4 | Train Loss: 1.622 Vali Loss: 1.546 Vali Acc: 0.240 Test Loss: 1.546 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.2114343643188477
Epoch: 2, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.550 Vali Acc: 0.300 Test Loss: 1.550 Test Acc: 0.300
Validation loss decreased (-0.239985 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 1.2360048294067383
Epoch: 3, Steps: 4 | Train Loss: 1.490 Vali Loss: 1.535 Vali Acc: 0.240 Test Loss: 1.535 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.3648502826690674
Epoch: 4, Steps: 4 | Train Loss: 1.358 Vali Loss: 1.568 Vali Acc: 0.160 Test Loss: 1.568 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.348337173461914
Epoch: 5, Steps: 4 | Train Loss: 0.980 Vali Loss: 1.614 Vali Acc: 0.180 Test Loss: 1.614 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2350456714630127
Epoch: 6, Steps: 4 | Train Loss: 1.051 Vali Loss: 1.676 Vali Acc: 0.240 Test Loss: 1.676 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.3015422821044922
Epoch: 7, Steps: 4 | Train Loss: 0.764 Vali Loss: 1.783 Vali Acc: 0.240 Test Loss: 1.783 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.2078742980957031
Epoch: 8, Steps: 4 | Train Loss: 0.829 Vali Loss: 1.938 Vali Acc: 0.200 Test Loss: 1.938 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1606714725494385
Epoch: 9, Steps: 4 | Train Loss: 1.085 Vali Loss: 2.078 Vali Acc: 0.220 Test Loss: 2.078 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1985359191894531
Epoch: 10, Steps: 4 | Train Loss: 0.533 Vali Loss: 2.168 Vali Acc: 0.280 Test Loss: 2.168 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.3028862476348877
Epoch: 11, Steps: 4 | Train Loss: 0.606 Vali Loss: 2.302 Vali Acc: 0.300 Test Loss: 2.302 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.3971636295318604
Epoch: 12, Steps: 4 | Train Loss: 0.519 Vali Loss: 2.519 Vali Acc: 0.240 Test Loss: 2.519 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 1089689
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.903104066848755
Epoch: 1, Steps: 4 | Train Loss: 1.664 Vali Loss: 1.548 Vali Acc: 0.260 Test Loss: 1.548 Test Acc: 0.260
Validation loss decreased (inf --> -0.259985).  Saving model ...
Epoch: 2 cost time: 1.382725477218628
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.542 Vali Acc: 0.280 Test Loss: 1.542 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.318509578704834
Epoch: 3, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.542 Vali Acc: 0.240 Test Loss: 1.542 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.366023063659668
Epoch: 4, Steps: 4 | Train Loss: 1.421 Vali Loss: 1.569 Vali Acc: 0.200 Test Loss: 1.569 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3915836811065674
Epoch: 5, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.577 Vali Acc: 0.220 Test Loss: 1.577 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3496286869049072
Epoch: 6, Steps: 4 | Train Loss: 1.139 Vali Loss: 1.603 Vali Acc: 0.200 Test Loss: 1.603 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.281407117843628
Epoch: 7, Steps: 4 | Train Loss: 0.864 Vali Loss: 1.679 Vali Acc: 0.240 Test Loss: 1.679 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.5262033939361572
Epoch: 8, Steps: 4 | Train Loss: 0.904 Vali Loss: 1.812 Vali Acc: 0.240 Test Loss: 1.812 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.357100009918213
Epoch: 9, Steps: 4 | Train Loss: 1.132 Vali Loss: 1.924 Vali Acc: 0.240 Test Loss: 1.924 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.2531070709228516
Epoch: 10, Steps: 4 | Train Loss: 0.604 Vali Loss: 1.959 Vali Acc: 0.320 Test Loss: 1.959 Test Acc: 0.320
Validation loss decreased (-0.279985 --> -0.319980).  Saving model ...
Epoch: 11 cost time: 1.216853380203247
Epoch: 11, Steps: 4 | Train Loss: 0.751 Vali Loss: 2.062 Vali Acc: 0.320 Test Loss: 2.062 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2584288120269775
Epoch: 12, Steps: 4 | Train Loss: 0.587 Vali Loss: 2.168 Vali Acc: 0.260 Test Loss: 2.168 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.409088373184204
Epoch: 13, Steps: 4 | Train Loss: 0.435 Vali Loss: 2.268 Vali Acc: 0.260 Test Loss: 2.268 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.3908774852752686
Epoch: 14, Steps: 4 | Train Loss: 0.383 Vali Loss: 2.324 Vali Acc: 0.360 Test Loss: 2.324 Test Acc: 0.360
Validation loss decreased (-0.319980 --> -0.359977).  Saving model ...
Epoch: 15 cost time: 1.353341817855835
Epoch: 15, Steps: 4 | Train Loss: 0.377 Vali Loss: 2.395 Vali Acc: 0.300 Test Loss: 2.395 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.242396354675293
Epoch: 16, Steps: 4 | Train Loss: 0.659 Vali Loss: 2.488 Vali Acc: 0.300 Test Loss: 2.488 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.274562120437622
Epoch: 17, Steps: 4 | Train Loss: 0.261 Vali Loss: 2.564 Vali Acc: 0.280 Test Loss: 2.564 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.2429966926574707
Epoch: 18, Steps: 4 | Train Loss: 0.227 Vali Loss: 2.646 Vali Acc: 0.280 Test Loss: 2.646 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.458939790725708
Epoch: 19, Steps: 4 | Train Loss: 0.210 Vali Loss: 2.715 Vali Acc: 0.260 Test Loss: 2.715 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.422182559967041
Epoch: 20, Steps: 4 | Train Loss: 0.166 Vali Loss: 2.872 Vali Acc: 0.260 Test Loss: 2.872 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.5224406719207764
Epoch: 21, Steps: 4 | Train Loss: 0.153 Vali Loss: 2.937 Vali Acc: 0.260 Test Loss: 2.937 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.3485333919525146
Epoch: 22, Steps: 4 | Train Loss: 0.299 Vali Loss: 3.281 Vali Acc: 0.220 Test Loss: 3.281 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.38673734664917
Epoch: 23, Steps: 4 | Train Loss: 0.115 Vali Loss: 3.576 Vali Acc: 0.200 Test Loss: 3.576 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.3039145469665527
Epoch: 24, Steps: 4 | Train Loss: 0.075 Vali Loss: 3.690 Vali Acc: 0.260 Test Loss: 3.690 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 1089689
model size : 6.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.08979344367981
Epoch: 1, Steps: 4 | Train Loss: 1.701 Vali Loss: 1.718 Vali Acc: 0.160 Test Loss: 1.718 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.1599130630493164
Epoch: 2, Steps: 4 | Train Loss: 1.589 Vali Loss: 1.694 Vali Acc: 0.220 Test Loss: 1.694 Test Acc: 0.220
Validation loss decreased (-0.159983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.2950561046600342
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.671 Vali Acc: 0.160 Test Loss: 1.671 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.413994550704956
Epoch: 4, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.670 Vali Acc: 0.160 Test Loss: 1.670 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.4313604831695557
Epoch: 5, Steps: 4 | Train Loss: 1.307 Vali Loss: 1.714 Vali Acc: 0.240 Test Loss: 1.714 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 6 cost time: 1.2781896591186523
Epoch: 6, Steps: 4 | Train Loss: 1.089 Vali Loss: 1.809 Vali Acc: 0.220 Test Loss: 1.809 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.403520107269287
Epoch: 7, Steps: 4 | Train Loss: 1.093 Vali Loss: 1.877 Vali Acc: 0.260 Test Loss: 1.877 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259981).  Saving model ...
Epoch: 8 cost time: 1.1782100200653076
Epoch: 8, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.927 Vali Acc: 0.260 Test Loss: 1.927 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.256964921951294
Epoch: 9, Steps: 4 | Train Loss: 0.805 Vali Loss: 1.990 Vali Acc: 0.240 Test Loss: 1.990 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2683353424072266
Epoch: 10, Steps: 4 | Train Loss: 0.842 Vali Loss: 2.063 Vali Acc: 0.280 Test Loss: 2.063 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279979).  Saving model ...
Epoch: 11 cost time: 1.2086334228515625
Epoch: 11, Steps: 4 | Train Loss: 0.548 Vali Loss: 2.155 Vali Acc: 0.240 Test Loss: 2.155 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.2293596267700195
Epoch: 12, Steps: 4 | Train Loss: 0.743 Vali Loss: 2.301 Vali Acc: 0.260 Test Loss: 2.301 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.509167194366455
Epoch: 13, Steps: 4 | Train Loss: 0.616 Vali Loss: 2.531 Vali Acc: 0.260 Test Loss: 2.531 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4443423748016357
Epoch: 14, Steps: 4 | Train Loss: 0.387 Vali Loss: 2.758 Vali Acc: 0.260 Test Loss: 2.758 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.2188467979431152
Epoch: 15, Steps: 4 | Train Loss: 0.380 Vali Loss: 2.946 Vali Acc: 0.260 Test Loss: 2.946 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.32930326461792
Epoch: 16, Steps: 4 | Train Loss: 0.367 Vali Loss: 3.153 Vali Acc: 0.280 Test Loss: 3.153 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.2389044761657715
Epoch: 17, Steps: 4 | Train Loss: 0.267 Vali Loss: 3.188 Vali Acc: 0.300 Test Loss: 3.188 Test Acc: 0.300
Validation loss decreased (-0.279979 --> -0.299968).  Saving model ...
Epoch: 18 cost time: 1.487116813659668
Epoch: 18, Steps: 4 | Train Loss: 0.265 Vali Loss: 3.363 Vali Acc: 0.300 Test Loss: 3.363 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2741005420684814
Epoch: 19, Steps: 4 | Train Loss: 0.217 Vali Loss: 3.588 Vali Acc: 0.300 Test Loss: 3.588 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.1328928470611572
Epoch: 20, Steps: 4 | Train Loss: 0.207 Vali Loss: 3.824 Vali Acc: 0.300 Test Loss: 3.824 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.3005106449127197
Epoch: 21, Steps: 4 | Train Loss: 0.210 Vali Loss: 4.074 Vali Acc: 0.300 Test Loss: 4.074 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2806010246276855
Epoch: 22, Steps: 4 | Train Loss: 0.138 Vali Loss: 4.268 Vali Acc: 0.280 Test Loss: 4.268 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.3368241786956787
Epoch: 23, Steps: 4 | Train Loss: 0.137 Vali Loss: 4.531 Vali Acc: 0.260 Test Loss: 4.531 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.2854413986206055
Epoch: 24, Steps: 4 | Train Loss: 0.097 Vali Loss: 4.701 Vali Acc: 0.260 Test Loss: 4.701 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.3229947090148926
Epoch: 25, Steps: 4 | Train Loss: 0.079 Vali Loss: 4.599 Vali Acc: 0.280 Test Loss: 4.599 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.4713444709777832
Epoch: 26, Steps: 4 | Train Loss: 0.089 Vali Loss: 4.600 Vali Acc: 0.300 Test Loss: 4.600 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.106870412826538
Epoch: 27, Steps: 4 | Train Loss: 0.058 Vali Loss: 4.669 Vali Acc: 0.300 Test Loss: 4.669 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 793305
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6858510971069336
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.696 Vali Acc: 0.220 Test Loss: 1.696 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.1471972465515137
Epoch: 2, Steps: 4 | Train Loss: 1.605 Vali Loss: 1.675 Vali Acc: 0.240 Test Loss: 1.675 Test Acc: 0.240
Validation loss decreased (-0.219983 --> -0.239983).  Saving model ...
Epoch: 3 cost time: 1.043761968612671
Epoch: 3, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.663 Vali Acc: 0.200 Test Loss: 1.663 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2185208797454834
Epoch: 4, Steps: 4 | Train Loss: 1.446 Vali Loss: 1.643 Vali Acc: 0.200 Test Loss: 1.643 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1119675636291504
Epoch: 5, Steps: 4 | Train Loss: 1.332 Vali Loss: 1.700 Vali Acc: 0.220 Test Loss: 1.700 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.2174005508422852
Epoch: 6, Steps: 4 | Train Loss: 1.126 Vali Loss: 1.791 Vali Acc: 0.200 Test Loss: 1.791 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1894521713256836
Epoch: 7, Steps: 4 | Train Loss: 1.140 Vali Loss: 1.857 Vali Acc: 0.240 Test Loss: 1.857 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1274611949920654
Epoch: 8, Steps: 4 | Train Loss: 0.962 Vali Loss: 1.916 Vali Acc: 0.200 Test Loss: 1.916 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2117586135864258
Epoch: 9, Steps: 4 | Train Loss: 0.847 Vali Loss: 1.933 Vali Acc: 0.240 Test Loss: 1.933 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.1579322814941406
Epoch: 10, Steps: 4 | Train Loss: 0.884 Vali Loss: 2.007 Vali Acc: 0.260 Test Loss: 2.007 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259980).  Saving model ...
Epoch: 11 cost time: 1.1115856170654297
Epoch: 11, Steps: 4 | Train Loss: 0.582 Vali Loss: 2.112 Vali Acc: 0.300 Test Loss: 2.112 Test Acc: 0.300
Validation loss decreased (-0.259980 --> -0.299979).  Saving model ...
Epoch: 12 cost time: 1.3127591609954834
Epoch: 12, Steps: 4 | Train Loss: 0.785 Vali Loss: 2.267 Vali Acc: 0.240 Test Loss: 2.267 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2616565227508545
Epoch: 13, Steps: 4 | Train Loss: 0.652 Vali Loss: 2.444 Vali Acc: 0.280 Test Loss: 2.444 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2211298942565918
Epoch: 14, Steps: 4 | Train Loss: 0.423 Vali Loss: 2.659 Vali Acc: 0.260 Test Loss: 2.659 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.1762919425964355
Epoch: 15, Steps: 4 | Train Loss: 0.414 Vali Loss: 2.860 Vali Acc: 0.260 Test Loss: 2.860 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1974701881408691
Epoch: 16, Steps: 4 | Train Loss: 0.396 Vali Loss: 3.025 Vali Acc: 0.280 Test Loss: 3.025 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1527900695800781
Epoch: 17, Steps: 4 | Train Loss: 0.299 Vali Loss: 3.175 Vali Acc: 0.300 Test Loss: 3.175 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2359955310821533
Epoch: 18, Steps: 4 | Train Loss: 0.289 Vali Loss: 3.389 Vali Acc: 0.300 Test Loss: 3.389 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.243238925933838
Epoch: 19, Steps: 4 | Train Loss: 0.246 Vali Loss: 3.519 Vali Acc: 0.280 Test Loss: 3.519 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.2784724235534668
Epoch: 20, Steps: 4 | Train Loss: 0.224 Vali Loss: 3.761 Vali Acc: 0.280 Test Loss: 3.761 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1679370403289795
Epoch: 21, Steps: 4 | Train Loss: 0.235 Vali Loss: 3.955 Vali Acc: 0.300 Test Loss: 3.955 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 793305
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6995980739593506
Epoch: 1, Steps: 4 | Train Loss: 1.669 Vali Loss: 1.715 Vali Acc: 0.180 Test Loss: 1.715 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.3331680297851562
Epoch: 2, Steps: 4 | Train Loss: 1.609 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
Validation loss decreased (-0.179983 --> -0.219983).  Saving model ...
Epoch: 3 cost time: 1.2135143280029297
Epoch: 3, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.662 Vali Acc: 0.220 Test Loss: 1.662 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 4 cost time: 1.3866488933563232
Epoch: 4, Steps: 4 | Train Loss: 1.482 Vali Loss: 1.644 Vali Acc: 0.220 Test Loss: 1.644 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.1794941425323486
Epoch: 5, Steps: 4 | Train Loss: 1.345 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.1376559734344482
Epoch: 6, Steps: 4 | Train Loss: 1.178 Vali Loss: 1.735 Vali Acc: 0.200 Test Loss: 1.735 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.4693665504455566
Epoch: 7, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.778 Vali Acc: 0.220 Test Loss: 1.778 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.3207159042358398
Epoch: 8, Steps: 4 | Train Loss: 1.023 Vali Loss: 1.816 Vali Acc: 0.260 Test Loss: 1.816 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259982).  Saving model ...
Epoch: 9 cost time: 1.2690520286560059
Epoch: 9, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.896 Vali Acc: 0.260 Test Loss: 1.896 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.23567533493042
Epoch: 10, Steps: 4 | Train Loss: 0.935 Vali Loss: 1.994 Vali Acc: 0.260 Test Loss: 1.994 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.0590441226959229
Epoch: 11, Steps: 4 | Train Loss: 0.644 Vali Loss: 2.073 Vali Acc: 0.260 Test Loss: 2.073 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3707971572875977
Epoch: 12, Steps: 4 | Train Loss: 0.857 Vali Loss: 2.181 Vali Acc: 0.280 Test Loss: 2.181 Test Acc: 0.280
Validation loss decreased (-0.259982 --> -0.279978).  Saving model ...
Epoch: 13 cost time: 1.2180891036987305
Epoch: 13, Steps: 4 | Train Loss: 0.714 Vali Loss: 2.316 Vali Acc: 0.300 Test Loss: 2.316 Test Acc: 0.300
Validation loss decreased (-0.279978 --> -0.299977).  Saving model ...
Epoch: 14 cost time: 1.389326810836792
Epoch: 14, Steps: 4 | Train Loss: 0.467 Vali Loss: 2.503 Vali Acc: 0.300 Test Loss: 2.503 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.3723533153533936
Epoch: 15, Steps: 4 | Train Loss: 0.473 Vali Loss: 2.673 Vali Acc: 0.260 Test Loss: 2.673 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.1482551097869873
Epoch: 16, Steps: 4 | Train Loss: 0.448 Vali Loss: 2.838 Vali Acc: 0.260 Test Loss: 2.838 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.2805390357971191
Epoch: 17, Steps: 4 | Train Loss: 0.344 Vali Loss: 2.993 Vali Acc: 0.280 Test Loss: 2.993 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2196197509765625
Epoch: 18, Steps: 4 | Train Loss: 0.329 Vali Loss: 3.164 Vali Acc: 0.280 Test Loss: 3.164 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.4684903621673584
Epoch: 19, Steps: 4 | Train Loss: 0.287 Vali Loss: 3.344 Vali Acc: 0.300 Test Loss: 3.344 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.2033648490905762
Epoch: 20, Steps: 4 | Train Loss: 0.249 Vali Loss: 3.525 Vali Acc: 0.300 Test Loss: 3.525 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2536115646362305
Epoch: 21, Steps: 4 | Train Loss: 0.280 Vali Loss: 3.813 Vali Acc: 0.300 Test Loss: 3.813 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3302748203277588
Epoch: 22, Steps: 4 | Train Loss: 0.207 Vali Loss: 3.995 Vali Acc: 0.320 Test Loss: 3.995 Test Acc: 0.320
Validation loss decreased (-0.299977 --> -0.319960).  Saving model ...
Epoch: 23 cost time: 1.2147424221038818
Epoch: 23, Steps: 4 | Train Loss: 0.188 Vali Loss: 4.092 Vali Acc: 0.300 Test Loss: 4.092 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.319455862045288
Epoch: 24, Steps: 4 | Train Loss: 0.135 Vali Loss: 4.207 Vali Acc: 0.280 Test Loss: 4.207 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.28678297996521
Epoch: 25, Steps: 4 | Train Loss: 0.116 Vali Loss: 4.399 Vali Acc: 0.260 Test Loss: 4.399 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.3845677375793457
Epoch: 26, Steps: 4 | Train Loss: 0.123 Vali Loss: 4.559 Vali Acc: 0.280 Test Loss: 4.559 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2901756763458252
Epoch: 27, Steps: 4 | Train Loss: 0.088 Vali Loss: 4.794 Vali Acc: 0.280 Test Loss: 4.794 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.298572063446045
Epoch: 28, Steps: 4 | Train Loss: 0.069 Vali Loss: 4.878 Vali Acc: 0.300 Test Loss: 4.878 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3725273609161377
Epoch: 29, Steps: 4 | Train Loss: 0.056 Vali Loss: 5.024 Vali Acc: 0.300 Test Loss: 5.024 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.289905071258545
Epoch: 30, Steps: 4 | Train Loss: 0.071 Vali Loss: 5.036 Vali Acc: 0.300 Test Loss: 5.036 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.2945942878723145
Epoch: 31, Steps: 4 | Train Loss: 0.044 Vali Loss: 5.057 Vali Acc: 0.300 Test Loss: 5.057 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.20424485206604
Epoch: 32, Steps: 4 | Train Loss: 0.039 Vali Loss: 5.172 Vali Acc: 0.320 Test Loss: 5.172 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 793305
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3985581398010254
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.689 Vali Acc: 0.200 Test Loss: 1.689 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.1299488544464111
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.672 Vali Acc: 0.300 Test Loss: 1.672 Test Acc: 0.300
Validation loss decreased (-0.199983 --> -0.299983).  Saving model ...
Epoch: 3 cost time: 1.0158460140228271
Epoch: 3, Steps: 4 | Train Loss: 1.579 Vali Loss: 1.649 Vali Acc: 0.280 Test Loss: 1.649 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0939440727233887
Epoch: 4, Steps: 4 | Train Loss: 1.527 Vali Loss: 1.628 Vali Acc: 0.280 Test Loss: 1.628 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2782511711120605
Epoch: 5, Steps: 4 | Train Loss: 1.379 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.214170217514038
Epoch: 6, Steps: 4 | Train Loss: 1.258 Vali Loss: 1.679 Vali Acc: 0.200 Test Loss: 1.679 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.1290035247802734
Epoch: 7, Steps: 4 | Train Loss: 1.228 Vali Loss: 1.716 Vali Acc: 0.240 Test Loss: 1.716 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1893975734710693
Epoch: 8, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.740 Vali Acc: 0.240 Test Loss: 1.740 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.2001190185546875
Epoch: 9, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.743 Vali Acc: 0.280 Test Loss: 1.743 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 10 cost time: 1.092090129852295
Epoch: 10, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.786 Vali Acc: 0.240 Test Loss: 1.786 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 11 cost time: 1.208838701248169
Epoch: 11, Steps: 4 | Train Loss: 0.752 Vali Loss: 1.839 Vali Acc: 0.260 Test Loss: 1.839 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 12 cost time: 1.274364709854126
Epoch: 12, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.924 Vali Acc: 0.300 Test Loss: 1.924 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 793305
model size : 4.26MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.8827764987945557
Epoch: 1, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.635 Vali Acc: 0.180 Test Loss: 1.635 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.0631067752838135
Epoch: 2, Steps: 4 | Train Loss: 1.646 Vali Loss: 1.636 Vali Acc: 0.260 Test Loss: 1.636 Test Acc: 0.260
Validation loss decreased (-0.179984 --> -0.259984).  Saving model ...
Epoch: 3 cost time: 1.2195615768432617
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.622 Vali Acc: 0.260 Test Loss: 1.622 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.1920528411865234
Epoch: 4, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.614 Vali Acc: 0.260 Test Loss: 1.614 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.2042853832244873
Epoch: 5, Steps: 4 | Train Loss: 1.136 Vali Loss: 1.646 Vali Acc: 0.300 Test Loss: 1.646 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.1941874027252197
Epoch: 6, Steps: 4 | Train Loss: 1.168 Vali Loss: 1.709 Vali Acc: 0.260 Test Loss: 1.709 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1254546642303467
Epoch: 7, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.791 Vali Acc: 0.220 Test Loss: 1.791 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2044363021850586
Epoch: 8, Steps: 4 | Train Loss: 0.875 Vali Loss: 1.880 Vali Acc: 0.320 Test Loss: 1.880 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319981).  Saving model ...
Epoch: 9 cost time: 1.2318825721740723
Epoch: 9, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.974 Vali Acc: 0.300 Test Loss: 1.974 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3953449726104736
Epoch: 10, Steps: 4 | Train Loss: 0.678 Vali Loss: 2.121 Vali Acc: 0.260 Test Loss: 2.121 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2834296226501465
Epoch: 11, Steps: 4 | Train Loss: 0.580 Vali Loss: 2.215 Vali Acc: 0.360 Test Loss: 2.215 Test Acc: 0.360
Validation loss decreased (-0.319981 --> -0.359978).  Saving model ...
Epoch: 12 cost time: 1.2700564861297607
Epoch: 12, Steps: 4 | Train Loss: 0.663 Vali Loss: 2.337 Vali Acc: 0.340 Test Loss: 2.337 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.230504035949707
Epoch: 13, Steps: 4 | Train Loss: 0.495 Vali Loss: 2.486 Vali Acc: 0.300 Test Loss: 2.486 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.310469627380371
Epoch: 14, Steps: 4 | Train Loss: 0.522 Vali Loss: 2.654 Vali Acc: 0.360 Test Loss: 2.654 Test Acc: 0.360
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2138371467590332
Epoch: 15, Steps: 4 | Train Loss: 0.377 Vali Loss: 2.780 Vali Acc: 0.320 Test Loss: 2.780 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1093778610229492
Epoch: 16, Steps: 4 | Train Loss: 0.393 Vali Loss: 2.935 Vali Acc: 0.280 Test Loss: 2.935 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.3277873992919922
Epoch: 17, Steps: 4 | Train Loss: 0.355 Vali Loss: 3.096 Vali Acc: 0.340 Test Loss: 3.096 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.3507280349731445
Epoch: 18, Steps: 4 | Train Loss: 0.264 Vali Loss: 3.223 Vali Acc: 0.320 Test Loss: 3.223 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.1710357666015625
Epoch: 19, Steps: 4 | Train Loss: 0.252 Vali Loss: 3.325 Vali Acc: 0.320 Test Loss: 3.325 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.3045027256011963
Epoch: 20, Steps: 4 | Train Loss: 0.228 Vali Loss: 3.616 Vali Acc: 0.280 Test Loss: 3.616 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1823632717132568
Epoch: 21, Steps: 4 | Train Loss: 0.157 Vali Loss: 3.793 Vali Acc: 0.280 Test Loss: 3.793 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 662233
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.549776315689087
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.606 Vali Acc: 0.220 Test Loss: 1.606 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.1422059535980225
Epoch: 2, Steps: 4 | Train Loss: 1.647 Vali Loss: 1.598 Vali Acc: 0.240 Test Loss: 1.598 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.17518949508667
Epoch: 3, Steps: 4 | Train Loss: 1.545 Vali Loss: 1.600 Vali Acc: 0.300 Test Loss: 1.600 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 4 cost time: 1.2219183444976807
Epoch: 4, Steps: 4 | Train Loss: 1.438 Vali Loss: 1.610 Vali Acc: 0.240 Test Loss: 1.610 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2240808010101318
Epoch: 5, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.661 Vali Acc: 0.200 Test Loss: 1.661 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2567236423492432
Epoch: 6, Steps: 4 | Train Loss: 1.171 Vali Loss: 1.715 Vali Acc: 0.220 Test Loss: 1.715 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3468968868255615
Epoch: 7, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.779 Vali Acc: 0.220 Test Loss: 1.779 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.206214427947998
Epoch: 8, Steps: 4 | Train Loss: 0.905 Vali Loss: 1.865 Vali Acc: 0.240 Test Loss: 1.865 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2649123668670654
Epoch: 9, Steps: 4 | Train Loss: 0.959 Vali Loss: 1.961 Vali Acc: 0.220 Test Loss: 1.961 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.2385644912719727
Epoch: 10, Steps: 4 | Train Loss: 0.703 Vali Loss: 2.111 Vali Acc: 0.220 Test Loss: 2.111 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2880527973175049
Epoch: 11, Steps: 4 | Train Loss: 0.624 Vali Loss: 2.253 Vali Acc: 0.300 Test Loss: 2.253 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.190911054611206
Epoch: 12, Steps: 4 | Train Loss: 0.686 Vali Loss: 2.380 Vali Acc: 0.300 Test Loss: 2.380 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.248265266418457
Epoch: 13, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.562 Vali Acc: 0.260 Test Loss: 2.562 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 662233
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.5615532398223877
Epoch: 1, Steps: 4 | Train Loss: 1.606 Vali Loss: 1.627 Vali Acc: 0.200 Test Loss: 1.627 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.099107027053833
Epoch: 2, Steps: 4 | Train Loss: 1.687 Vali Loss: 1.614 Vali Acc: 0.200 Test Loss: 1.614 Test Acc: 0.200
Validation loss decreased (-0.199984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.1405551433563232
Epoch: 3, Steps: 4 | Train Loss: 1.552 Vali Loss: 1.609 Vali Acc: 0.220 Test Loss: 1.609 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.2019484043121338
Epoch: 4, Steps: 4 | Train Loss: 1.456 Vali Loss: 1.603 Vali Acc: 0.240 Test Loss: 1.603 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.1713201999664307
Epoch: 5, Steps: 4 | Train Loss: 1.198 Vali Loss: 1.627 Vali Acc: 0.220 Test Loss: 1.627 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2363083362579346
Epoch: 6, Steps: 4 | Train Loss: 1.206 Vali Loss: 1.663 Vali Acc: 0.220 Test Loss: 1.663 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.3254525661468506
Epoch: 7, Steps: 4 | Train Loss: 1.026 Vali Loss: 1.720 Vali Acc: 0.220 Test Loss: 1.720 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.210824728012085
Epoch: 8, Steps: 4 | Train Loss: 0.961 Vali Loss: 1.798 Vali Acc: 0.240 Test Loss: 1.798 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.195826768875122
Epoch: 9, Steps: 4 | Train Loss: 1.012 Vali Loss: 1.878 Vali Acc: 0.240 Test Loss: 1.878 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2935032844543457
Epoch: 10, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.977 Vali Acc: 0.240 Test Loss: 1.977 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2130913734436035
Epoch: 11, Steps: 4 | Train Loss: 0.678 Vali Loss: 2.103 Vali Acc: 0.260 Test Loss: 2.103 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259979).  Saving model ...
Epoch: 12 cost time: 1.2108173370361328
Epoch: 12, Steps: 4 | Train Loss: 0.723 Vali Loss: 2.230 Vali Acc: 0.360 Test Loss: 2.230 Test Acc: 0.360
Validation loss decreased (-0.259979 --> -0.359978).  Saving model ...
Epoch: 13 cost time: 1.2507634162902832
Epoch: 13, Steps: 4 | Train Loss: 0.593 Vali Loss: 2.351 Vali Acc: 0.300 Test Loss: 2.351 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2032475471496582
Epoch: 14, Steps: 4 | Train Loss: 0.604 Vali Loss: 2.454 Vali Acc: 0.300 Test Loss: 2.454 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2048816680908203
Epoch: 15, Steps: 4 | Train Loss: 0.438 Vali Loss: 2.567 Vali Acc: 0.260 Test Loss: 2.567 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1904058456420898
Epoch: 16, Steps: 4 | Train Loss: 0.470 Vali Loss: 2.727 Vali Acc: 0.280 Test Loss: 2.727 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.144200086593628
Epoch: 17, Steps: 4 | Train Loss: 0.453 Vali Loss: 2.842 Vali Acc: 0.340 Test Loss: 2.842 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.4145896434783936
Epoch: 18, Steps: 4 | Train Loss: 0.350 Vali Loss: 2.968 Vali Acc: 0.320 Test Loss: 2.968 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.3358256816864014
Epoch: 19, Steps: 4 | Train Loss: 0.316 Vali Loss: 3.098 Vali Acc: 0.260 Test Loss: 3.098 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2525551319122314
Epoch: 20, Steps: 4 | Train Loss: 0.315 Vali Loss: 3.314 Vali Acc: 0.320 Test Loss: 3.314 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.188913345336914
Epoch: 21, Steps: 4 | Train Loss: 0.217 Vali Loss: 3.534 Vali Acc: 0.260 Test Loss: 3.534 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1107215881347656
Epoch: 22, Steps: 4 | Train Loss: 0.201 Vali Loss: 3.714 Vali Acc: 0.260 Test Loss: 3.714 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 662233
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.329881191253662
Epoch: 1, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.2142503261566162
Epoch: 2, Steps: 4 | Train Loss: 1.633 Vali Loss: 1.556 Vali Acc: 0.180 Test Loss: 1.556 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.053529977798462
Epoch: 3, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.552 Vali Acc: 0.280 Test Loss: 1.552 Test Acc: 0.280
Validation loss decreased (-0.279984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.1789696216583252
Epoch: 4, Steps: 4 | Train Loss: 1.484 Vali Loss: 1.540 Vali Acc: 0.240 Test Loss: 1.540 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1001393795013428
Epoch: 5, Steps: 4 | Train Loss: 1.226 Vali Loss: 1.548 Vali Acc: 0.220 Test Loss: 1.548 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2847259044647217
Epoch: 6, Steps: 4 | Train Loss: 1.270 Vali Loss: 1.582 Vali Acc: 0.240 Test Loss: 1.582 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.1630258560180664
Epoch: 7, Steps: 4 | Train Loss: 1.075 Vali Loss: 1.632 Vali Acc: 0.200 Test Loss: 1.632 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.1367096900939941
Epoch: 8, Steps: 4 | Train Loss: 1.024 Vali Loss: 1.673 Vali Acc: 0.240 Test Loss: 1.673 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2760581970214844
Epoch: 9, Steps: 4 | Train Loss: 1.065 Vali Loss: 1.739 Vali Acc: 0.240 Test Loss: 1.739 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.385023832321167
Epoch: 10, Steps: 4 | Train Loss: 0.843 Vali Loss: 1.833 Vali Acc: 0.200 Test Loss: 1.833 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.3138542175292969
Epoch: 11, Steps: 4 | Train Loss: 0.778 Vali Loss: 1.919 Vali Acc: 0.280 Test Loss: 1.919 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2871294021606445
Epoch: 12, Steps: 4 | Train Loss: 0.778 Vali Loss: 2.014 Vali Acc: 0.300 Test Loss: 2.014 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299980).  Saving model ...
Epoch: 13 cost time: 1.3026096820831299
Epoch: 13, Steps: 4 | Train Loss: 0.711 Vali Loss: 2.073 Vali Acc: 0.260 Test Loss: 2.073 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2090516090393066
Epoch: 14, Steps: 4 | Train Loss: 0.676 Vali Loss: 2.114 Vali Acc: 0.260 Test Loss: 2.114 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.2481648921966553
Epoch: 15, Steps: 4 | Train Loss: 0.514 Vali Loss: 2.150 Vali Acc: 0.260 Test Loss: 2.150 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.3138172626495361
Epoch: 16, Steps: 4 | Train Loss: 0.535 Vali Loss: 2.164 Vali Acc: 0.280 Test Loss: 2.164 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.3478858470916748
Epoch: 17, Steps: 4 | Train Loss: 0.571 Vali Loss: 2.166 Vali Acc: 0.260 Test Loss: 2.166 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2464540004730225
Epoch: 18, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.221 Vali Acc: 0.260 Test Loss: 2.221 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.2875311374664307
Epoch: 19, Steps: 4 | Train Loss: 0.406 Vali Loss: 2.332 Vali Acc: 0.300 Test Loss: 2.332 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.2259716987609863
Epoch: 20, Steps: 4 | Train Loss: 0.383 Vali Loss: 2.473 Vali Acc: 0.240 Test Loss: 2.473 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.4233334064483643
Epoch: 21, Steps: 4 | Train Loss: 0.271 Vali Loss: 2.627 Vali Acc: 0.260 Test Loss: 2.627 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.3399832248687744
Epoch: 22, Steps: 4 | Train Loss: 0.257 Vali Loss: 2.699 Vali Acc: 0.280 Test Loss: 2.699 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 662233
model size : 3.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.531975746154785
Epoch: 1, Steps: 4 | Train Loss: 1.657 Vali Loss: 1.794 Vali Acc: 0.180 Test Loss: 1.794 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 1.2027912139892578
Epoch: 2, Steps: 4 | Train Loss: 1.658 Vali Loss: 1.736 Vali Acc: 0.140 Test Loss: 1.736 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2286016941070557
Epoch: 3, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.676 Vali Acc: 0.200 Test Loss: 1.676 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199983).  Saving model ...
Epoch: 4 cost time: 1.1979470252990723
Epoch: 4, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.644 Vali Acc: 0.220 Test Loss: 1.644 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219984).  Saving model ...
Epoch: 5 cost time: 1.2726936340332031
Epoch: 5, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.648 Vali Acc: 0.240 Test Loss: 1.648 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.300736427307129
Epoch: 6, Steps: 4 | Train Loss: 1.193 Vali Loss: 1.663 Vali Acc: 0.200 Test Loss: 1.663 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1733620166778564
Epoch: 7, Steps: 4 | Train Loss: 1.049 Vali Loss: 1.758 Vali Acc: 0.240 Test Loss: 1.758 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1961228847503662
Epoch: 8, Steps: 4 | Train Loss: 0.985 Vali Loss: 1.823 Vali Acc: 0.260 Test Loss: 1.823 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259982).  Saving model ...
Epoch: 9 cost time: 1.2683613300323486
Epoch: 9, Steps: 4 | Train Loss: 0.850 Vali Loss: 1.911 Vali Acc: 0.240 Test Loss: 1.911 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2217152118682861
Epoch: 10, Steps: 4 | Train Loss: 0.888 Vali Loss: 2.023 Vali Acc: 0.240 Test Loss: 2.023 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.2151877880096436
Epoch: 11, Steps: 4 | Train Loss: 0.691 Vali Loss: 2.122 Vali Acc: 0.240 Test Loss: 2.122 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3028054237365723
Epoch: 12, Steps: 4 | Train Loss: 0.508 Vali Loss: 2.299 Vali Acc: 0.260 Test Loss: 2.299 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2323875427246094
Epoch: 13, Steps: 4 | Train Loss: 0.524 Vali Loss: 2.443 Vali Acc: 0.300 Test Loss: 2.443 Test Acc: 0.300
Validation loss decreased (-0.259982 --> -0.299976).  Saving model ...
Epoch: 14 cost time: 1.254258155822754
Epoch: 14, Steps: 4 | Train Loss: 0.426 Vali Loss: 2.596 Vali Acc: 0.280 Test Loss: 2.596 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.388970136642456
Epoch: 15, Steps: 4 | Train Loss: 0.502 Vali Loss: 2.713 Vali Acc: 0.260 Test Loss: 2.713 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.3292515277862549
Epoch: 16, Steps: 4 | Train Loss: 0.339 Vali Loss: 2.882 Vali Acc: 0.200 Test Loss: 2.882 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.289841651916504
Epoch: 17, Steps: 4 | Train Loss: 0.381 Vali Loss: 3.081 Vali Acc: 0.240 Test Loss: 3.081 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.2455196380615234
Epoch: 18, Steps: 4 | Train Loss: 0.282 Vali Loss: 3.229 Vali Acc: 0.280 Test Loss: 3.229 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.25172758102417
Epoch: 19, Steps: 4 | Train Loss: 0.237 Vali Loss: 3.375 Vali Acc: 0.280 Test Loss: 3.375 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.380115270614624
Epoch: 20, Steps: 4 | Train Loss: 0.195 Vali Loss: 3.450 Vali Acc: 0.280 Test Loss: 3.450 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.2695648670196533
Epoch: 21, Steps: 4 | Train Loss: 0.163 Vali Loss: 3.599 Vali Acc: 0.260 Test Loss: 3.599 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.3232507705688477
Epoch: 22, Steps: 4 | Train Loss: 0.145 Vali Loss: 3.761 Vali Acc: 0.280 Test Loss: 3.761 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.2272248268127441
Epoch: 23, Steps: 4 | Train Loss: 0.122 Vali Loss: 3.829 Vali Acc: 0.260 Test Loss: 3.829 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 596697
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 4.278487205505371
Epoch: 1, Steps: 4 | Train Loss: 1.665 Vali Loss: 1.811 Vali Acc: 0.120 Test Loss: 1.811 Test Acc: 0.120
Validation loss decreased (inf --> -0.119982).  Saving model ...
Epoch: 2 cost time: 1.2541089057922363
Epoch: 2, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.768 Vali Acc: 0.160 Test Loss: 1.768 Test Acc: 0.160
Validation loss decreased (-0.119982 --> -0.159982).  Saving model ...
Epoch: 3 cost time: 1.132737398147583
Epoch: 3, Steps: 4 | Train Loss: 1.536 Vali Loss: 1.704 Vali Acc: 0.160 Test Loss: 1.704 Test Acc: 0.160
Validation loss decreased (-0.159982 --> -0.159983).  Saving model ...
Epoch: 4 cost time: 1.290445327758789
Epoch: 4, Steps: 4 | Train Loss: 1.466 Vali Loss: 1.664 Vali Acc: 0.180 Test Loss: 1.664 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 5 cost time: 1.1328771114349365
Epoch: 5, Steps: 4 | Train Loss: 1.333 Vali Loss: 1.687 Vali Acc: 0.180 Test Loss: 1.687 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2144279479980469
Epoch: 6, Steps: 4 | Train Loss: 1.204 Vali Loss: 1.703 Vali Acc: 0.200 Test Loss: 1.703 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 1.184403896331787
Epoch: 7, Steps: 4 | Train Loss: 1.067 Vali Loss: 1.791 Vali Acc: 0.220 Test Loss: 1.791 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219982).  Saving model ...
Epoch: 8 cost time: 1.1580147743225098
Epoch: 8, Steps: 4 | Train Loss: 1.013 Vali Loss: 1.845 Vali Acc: 0.220 Test Loss: 1.845 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1238470077514648
Epoch: 9, Steps: 4 | Train Loss: 0.882 Vali Loss: 1.949 Vali Acc: 0.240 Test Loss: 1.949 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239981).  Saving model ...
Epoch: 10 cost time: 1.1368741989135742
Epoch: 10, Steps: 4 | Train Loss: 0.906 Vali Loss: 2.075 Vali Acc: 0.240 Test Loss: 2.075 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.35915207862854
Epoch: 11, Steps: 4 | Train Loss: 0.722 Vali Loss: 2.189 Vali Acc: 0.240 Test Loss: 2.189 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.1971309185028076
Epoch: 12, Steps: 4 | Train Loss: 0.534 Vali Loss: 2.291 Vali Acc: 0.260 Test Loss: 2.291 Test Acc: 0.260
Validation loss decreased (-0.239981 --> -0.259977).  Saving model ...
Epoch: 13 cost time: 1.2896099090576172
Epoch: 13, Steps: 4 | Train Loss: 0.555 Vali Loss: 2.398 Vali Acc: 0.300 Test Loss: 2.398 Test Acc: 0.300
Validation loss decreased (-0.259977 --> -0.299976).  Saving model ...
Epoch: 14 cost time: 1.482454776763916
Epoch: 14, Steps: 4 | Train Loss: 0.464 Vali Loss: 2.553 Vali Acc: 0.280 Test Loss: 2.553 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.391204833984375
Epoch: 15, Steps: 4 | Train Loss: 0.545 Vali Loss: 2.735 Vali Acc: 0.220 Test Loss: 2.735 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.396388053894043
Epoch: 16, Steps: 4 | Train Loss: 0.375 Vali Loss: 2.949 Vali Acc: 0.180 Test Loss: 2.949 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3411900997161865
Epoch: 17, Steps: 4 | Train Loss: 0.422 Vali Loss: 3.088 Vali Acc: 0.240 Test Loss: 3.088 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3404779434204102
Epoch: 18, Steps: 4 | Train Loss: 0.309 Vali Loss: 3.171 Vali Acc: 0.280 Test Loss: 3.171 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.2131805419921875
Epoch: 19, Steps: 4 | Train Loss: 0.257 Vali Loss: 3.296 Vali Acc: 0.300 Test Loss: 3.296 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.389139175415039
Epoch: 20, Steps: 4 | Train Loss: 0.223 Vali Loss: 3.461 Vali Acc: 0.280 Test Loss: 3.461 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.3035204410552979
Epoch: 21, Steps: 4 | Train Loss: 0.189 Vali Loss: 3.521 Vali Acc: 0.240 Test Loss: 3.521 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.2311789989471436
Epoch: 22, Steps: 4 | Train Loss: 0.172 Vali Loss: 3.767 Vali Acc: 0.240 Test Loss: 3.767 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.3408284187316895
Epoch: 23, Steps: 4 | Train Loss: 0.140 Vali Loss: 4.022 Vali Acc: 0.260 Test Loss: 4.022 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 596697
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.640120506286621
Epoch: 1, Steps: 4 | Train Loss: 1.645 Vali Loss: 1.801 Vali Acc: 0.180 Test Loss: 1.801 Test Acc: 0.180
Validation loss decreased (inf --> -0.179982).  Saving model ...
Epoch: 2 cost time: 1.1331915855407715
Epoch: 2, Steps: 4 | Train Loss: 1.625 Vali Loss: 1.767 Vali Acc: 0.220 Test Loss: 1.767 Test Acc: 0.220
Validation loss decreased (-0.179982 --> -0.219982).  Saving model ...
Epoch: 3 cost time: 1.1598010063171387
Epoch: 3, Steps: 4 | Train Loss: 1.530 Vali Loss: 1.722 Vali Acc: 0.180 Test Loss: 1.722 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1774582862854004
Epoch: 4, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.0944139957427979
Epoch: 5, Steps: 4 | Train Loss: 1.368 Vali Loss: 1.700 Vali Acc: 0.160 Test Loss: 1.700 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.156630039215088
Epoch: 6, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.699 Vali Acc: 0.260 Test Loss: 1.699 Test Acc: 0.260
Validation loss decreased (-0.219982 --> -0.259983).  Saving model ...
Epoch: 7 cost time: 1.0718770027160645
Epoch: 7, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.787 Vali Acc: 0.180 Test Loss: 1.787 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.1099348068237305
Epoch: 8, Steps: 4 | Train Loss: 1.048 Vali Loss: 1.829 Vali Acc: 0.200 Test Loss: 1.829 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.3593778610229492
Epoch: 9, Steps: 4 | Train Loss: 0.950 Vali Loss: 1.923 Vali Acc: 0.240 Test Loss: 1.923 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.257911205291748
Epoch: 10, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.984 Vali Acc: 0.240 Test Loss: 1.984 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.1118731498718262
Epoch: 11, Steps: 4 | Train Loss: 0.763 Vali Loss: 2.061 Vali Acc: 0.300 Test Loss: 2.061 Test Acc: 0.300
Validation loss decreased (-0.259983 --> -0.299979).  Saving model ...
Epoch: 12 cost time: 1.192213773727417
Epoch: 12, Steps: 4 | Train Loss: 0.581 Vali Loss: 2.166 Vali Acc: 0.300 Test Loss: 2.166 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.2414391040802002
Epoch: 13, Steps: 4 | Train Loss: 0.607 Vali Loss: 2.290 Vali Acc: 0.280 Test Loss: 2.290 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.1835219860076904
Epoch: 14, Steps: 4 | Train Loss: 0.509 Vali Loss: 2.396 Vali Acc: 0.280 Test Loss: 2.396 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.0576844215393066
Epoch: 15, Steps: 4 | Train Loss: 0.574 Vali Loss: 2.546 Vali Acc: 0.260 Test Loss: 2.546 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.055673360824585
Epoch: 16, Steps: 4 | Train Loss: 0.409 Vali Loss: 2.781 Vali Acc: 0.240 Test Loss: 2.781 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.1675944328308105
Epoch: 17, Steps: 4 | Train Loss: 0.476 Vali Loss: 3.039 Vali Acc: 0.280 Test Loss: 3.039 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.345881462097168
Epoch: 18, Steps: 4 | Train Loss: 0.347 Vali Loss: 3.217 Vali Acc: 0.280 Test Loss: 3.217 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.310016393661499
Epoch: 19, Steps: 4 | Train Loss: 0.298 Vali Loss: 3.316 Vali Acc: 0.260 Test Loss: 3.316 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.1127305030822754
Epoch: 20, Steps: 4 | Train Loss: 0.248 Vali Loss: 3.484 Vali Acc: 0.260 Test Loss: 3.484 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1309378147125244
Epoch: 21, Steps: 4 | Train Loss: 0.223 Vali Loss: 3.642 Vali Acc: 0.280 Test Loss: 3.642 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 596697
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9090611934661865
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.725 Vali Acc: 0.240 Test Loss: 1.725 Test Acc: 0.240
Validation loss decreased (inf --> -0.239983).  Saving model ...
Epoch: 2 cost time: 1.1310958862304688
Epoch: 2, Steps: 4 | Train Loss: 1.654 Vali Loss: 1.712 Vali Acc: 0.120 Test Loss: 1.712 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.16591215133667
Epoch: 3, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.669 Vali Acc: 0.260 Test Loss: 1.669 Test Acc: 0.260
Validation loss decreased (-0.239983 --> -0.259983).  Saving model ...
Epoch: 4 cost time: 1.3053715229034424
Epoch: 4, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2570135593414307
Epoch: 5, Steps: 4 | Train Loss: 1.417 Vali Loss: 1.627 Vali Acc: 0.240 Test Loss: 1.627 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2583694458007812
Epoch: 6, Steps: 4 | Train Loss: 1.277 Vali Loss: 1.629 Vali Acc: 0.260 Test Loss: 1.629 Test Acc: 0.260
Validation loss decreased (-0.259983 --> -0.259984).  Saving model ...
Epoch: 7 cost time: 1.1478829383850098
Epoch: 7, Steps: 4 | Train Loss: 1.203 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.3245182037353516
Epoch: 8, Steps: 4 | Train Loss: 1.150 Vali Loss: 1.699 Vali Acc: 0.220 Test Loss: 1.699 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2090179920196533
Epoch: 9, Steps: 4 | Train Loss: 1.022 Vali Loss: 1.766 Vali Acc: 0.300 Test Loss: 1.766 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299982).  Saving model ...
Epoch: 10 cost time: 1.2930359840393066
Epoch: 10, Steps: 4 | Train Loss: 1.040 Vali Loss: 1.872 Vali Acc: 0.240 Test Loss: 1.872 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.2953972816467285
Epoch: 11, Steps: 4 | Train Loss: 0.832 Vali Loss: 1.925 Vali Acc: 0.260 Test Loss: 1.925 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3242979049682617
Epoch: 12, Steps: 4 | Train Loss: 0.652 Vali Loss: 1.995 Vali Acc: 0.240 Test Loss: 1.995 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2295424938201904
Epoch: 13, Steps: 4 | Train Loss: 0.703 Vali Loss: 2.018 Vali Acc: 0.300 Test Loss: 2.018 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.4551775455474854
Epoch: 14, Steps: 4 | Train Loss: 0.600 Vali Loss: 2.073 Vali Acc: 0.240 Test Loss: 2.073 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.3517122268676758
Epoch: 15, Steps: 4 | Train Loss: 0.681 Vali Loss: 2.129 Vali Acc: 0.300 Test Loss: 2.129 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.3469140529632568
Epoch: 16, Steps: 4 | Train Loss: 0.509 Vali Loss: 2.199 Vali Acc: 0.300 Test Loss: 2.199 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.6421549320220947
Epoch: 17, Steps: 4 | Train Loss: 0.582 Vali Loss: 2.287 Vali Acc: 0.280 Test Loss: 2.287 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.2974662780761719
Epoch: 18, Steps: 4 | Train Loss: 0.461 Vali Loss: 2.334 Vali Acc: 0.260 Test Loss: 2.334 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2822964191436768
Epoch: 19, Steps: 4 | Train Loss: 0.336 Vali Loss: 2.468 Vali Acc: 0.340 Test Loss: 2.468 Test Acc: 0.340
Validation loss decreased (-0.299982 --> -0.339975).  Saving model ...
Epoch: 20 cost time: 1.4753730297088623
Epoch: 20, Steps: 4 | Train Loss: 0.314 Vali Loss: 2.509 Vali Acc: 0.300 Test Loss: 2.509 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.4209110736846924
Epoch: 21, Steps: 4 | Train Loss: 0.271 Vali Loss: 2.580 Vali Acc: 0.240 Test Loss: 2.580 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.4437837600708008
Epoch: 22, Steps: 4 | Train Loss: 0.259 Vali Loss: 2.644 Vali Acc: 0.260 Test Loss: 2.644 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.3733561038970947
Epoch: 23, Steps: 4 | Train Loss: 0.215 Vali Loss: 2.704 Vali Acc: 0.260 Test Loss: 2.704 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.4271297454833984
Epoch: 24, Steps: 4 | Train Loss: 0.206 Vali Loss: 2.813 Vali Acc: 0.200 Test Loss: 2.813 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.354391098022461
Epoch: 25, Steps: 4 | Train Loss: 0.168 Vali Loss: 2.911 Vali Acc: 0.220 Test Loss: 2.911 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5207865238189697
Epoch: 26, Steps: 4 | Train Loss: 0.136 Vali Loss: 3.056 Vali Acc: 0.220 Test Loss: 3.056 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.3461973667144775
Epoch: 27, Steps: 4 | Train Loss: 0.123 Vali Loss: 3.219 Vali Acc: 0.220 Test Loss: 3.219 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.4370505809783936
Epoch: 28, Steps: 4 | Train Loss: 0.106 Vali Loss: 3.414 Vali Acc: 0.200 Test Loss: 3.414 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.2798314094543457
Epoch: 29, Steps: 4 | Train Loss: 0.114 Vali Loss: 3.615 Vali Acc: 0.180 Test Loss: 3.615 Test Acc: 0.180
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 596697
model size : 3.51MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4984679222106934
Epoch: 1, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.525 Vali Acc: 0.320 Test Loss: 1.525 Test Acc: 0.320
Validation loss decreased (inf --> -0.319985).  Saving model ...
Epoch: 2 cost time: 1.0903007984161377
Epoch: 2, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.526 Vali Acc: 0.260 Test Loss: 1.526 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.239915370941162
Epoch: 3, Steps: 4 | Train Loss: 1.532 Vali Loss: 1.531 Vali Acc: 0.160 Test Loss: 1.531 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1626107692718506
Epoch: 4, Steps: 4 | Train Loss: 1.416 Vali Loss: 1.536 Vali Acc: 0.320 Test Loss: 1.536 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.225414752960205
Epoch: 5, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.552 Vali Acc: 0.260 Test Loss: 1.552 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.2689545154571533
Epoch: 6, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.615 Vali Acc: 0.260 Test Loss: 1.615 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.3100571632385254
Epoch: 7, Steps: 4 | Train Loss: 1.176 Vali Loss: 1.682 Vali Acc: 0.260 Test Loss: 1.682 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.1902143955230713
Epoch: 8, Steps: 4 | Train Loss: 0.794 Vali Loss: 1.773 Vali Acc: 0.240 Test Loss: 1.773 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.2374870777130127
Epoch: 9, Steps: 4 | Train Loss: 0.795 Vali Loss: 1.887 Vali Acc: 0.240 Test Loss: 1.887 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.151829481124878
Epoch: 10, Steps: 4 | Train Loss: 0.730 Vali Loss: 2.008 Vali Acc: 0.240 Test Loss: 2.008 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.180257797241211
Epoch: 11, Steps: 4 | Train Loss: 0.882 Vali Loss: 2.137 Vali Acc: 0.220 Test Loss: 2.137 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 563929
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3833563327789307
Epoch: 1, Steps: 4 | Train Loss: 1.661 Vali Loss: 1.518 Vali Acc: 0.280 Test Loss: 1.518 Test Acc: 0.280
Validation loss decreased (inf --> -0.279985).  Saving model ...
Epoch: 2 cost time: 1.1967389583587646
Epoch: 2, Steps: 4 | Train Loss: 1.600 Vali Loss: 1.521 Vali Acc: 0.260 Test Loss: 1.521 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3067572116851807
Epoch: 3, Steps: 4 | Train Loss: 1.528 Vali Loss: 1.534 Vali Acc: 0.160 Test Loss: 1.534 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1556496620178223
Epoch: 4, Steps: 4 | Train Loss: 1.442 Vali Loss: 1.538 Vali Acc: 0.300 Test Loss: 1.538 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 5 cost time: 1.0410988330841064
Epoch: 5, Steps: 4 | Train Loss: 1.200 Vali Loss: 1.559 Vali Acc: 0.260 Test Loss: 1.559 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.245528221130371
Epoch: 6, Steps: 4 | Train Loss: 1.274 Vali Loss: 1.596 Vali Acc: 0.240 Test Loss: 1.596 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.0772418975830078
Epoch: 7, Steps: 4 | Train Loss: 1.198 Vali Loss: 1.655 Vali Acc: 0.260 Test Loss: 1.655 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1255097389221191
Epoch: 8, Steps: 4 | Train Loss: 0.830 Vali Loss: 1.739 Vali Acc: 0.200 Test Loss: 1.739 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.0909428596496582
Epoch: 9, Steps: 4 | Train Loss: 0.832 Vali Loss: 1.852 Vali Acc: 0.200 Test Loss: 1.852 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.2704427242279053
Epoch: 10, Steps: 4 | Train Loss: 0.764 Vali Loss: 1.991 Vali Acc: 0.240 Test Loss: 1.991 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1362059116363525
Epoch: 11, Steps: 4 | Train Loss: 0.916 Vali Loss: 2.112 Vali Acc: 0.200 Test Loss: 2.112 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0952951908111572
Epoch: 12, Steps: 4 | Train Loss: 0.755 Vali Loss: 2.230 Vali Acc: 0.220 Test Loss: 2.230 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.2230570316314697
Epoch: 13, Steps: 4 | Train Loss: 0.470 Vali Loss: 2.415 Vali Acc: 0.240 Test Loss: 2.415 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.093970537185669
Epoch: 14, Steps: 4 | Train Loss: 0.849 Vali Loss: 2.607 Vali Acc: 0.220 Test Loss: 2.607 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 563929
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.662186622619629
Epoch: 1, Steps: 4 | Train Loss: 1.659 Vali Loss: 1.582 Vali Acc: 0.240 Test Loss: 1.582 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.0484952926635742
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.577 Vali Acc: 0.220 Test Loss: 1.577 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.0397613048553467
Epoch: 3, Steps: 4 | Train Loss: 1.558 Vali Loss: 1.581 Vali Acc: 0.180 Test Loss: 1.581 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.119354486465454
Epoch: 4, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.577 Vali Acc: 0.300 Test Loss: 1.577 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.1203255653381348
Epoch: 5, Steps: 4 | Train Loss: 1.247 Vali Loss: 1.581 Vali Acc: 0.260 Test Loss: 1.581 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2141563892364502
Epoch: 6, Steps: 4 | Train Loss: 1.322 Vali Loss: 1.613 Vali Acc: 0.280 Test Loss: 1.613 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2445454597473145
Epoch: 7, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.645 Vali Acc: 0.280 Test Loss: 1.645 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.158799648284912
Epoch: 8, Steps: 4 | Train Loss: 0.877 Vali Loss: 1.727 Vali Acc: 0.140 Test Loss: 1.727 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.191472053527832
Epoch: 9, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.817 Vali Acc: 0.220 Test Loss: 1.817 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.161238431930542
Epoch: 10, Steps: 4 | Train Loss: 0.821 Vali Loss: 1.925 Vali Acc: 0.240 Test Loss: 1.925 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.1971583366394043
Epoch: 11, Steps: 4 | Train Loss: 0.965 Vali Loss: 2.051 Vali Acc: 0.220 Test Loss: 2.051 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.0644464492797852
Epoch: 12, Steps: 4 | Train Loss: 0.828 Vali Loss: 2.162 Vali Acc: 0.240 Test Loss: 2.162 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.1449692249298096
Epoch: 13, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.322 Vali Acc: 0.280 Test Loss: 2.322 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2191848754882812
Epoch: 14, Steps: 4 | Train Loss: 0.882 Vali Loss: 2.455 Vali Acc: 0.240 Test Loss: 2.455 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 563929
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.398573637008667
Epoch: 1, Steps: 4 | Train Loss: 1.640 Vali Loss: 1.588 Vali Acc: 0.180 Test Loss: 1.588 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2890276908874512
Epoch: 2, Steps: 4 | Train Loss: 1.588 Vali Loss: 1.586 Vali Acc: 0.200 Test Loss: 1.586 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.154388189315796
Epoch: 3, Steps: 4 | Train Loss: 1.567 Vali Loss: 1.592 Vali Acc: 0.200 Test Loss: 1.592 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.1597223281860352
Epoch: 4, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.575 Vali Acc: 0.240 Test Loss: 1.575 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.100984811782837
Epoch: 5, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.569 Vali Acc: 0.240 Test Loss: 1.569 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.082681655883789
Epoch: 6, Steps: 4 | Train Loss: 1.372 Vali Loss: 1.575 Vali Acc: 0.200 Test Loss: 1.575 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0856785774230957
Epoch: 7, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.577 Vali Acc: 0.200 Test Loss: 1.577 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1254775524139404
Epoch: 8, Steps: 4 | Train Loss: 0.973 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2792840003967285
Epoch: 9, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.688 Vali Acc: 0.160 Test Loss: 1.688 Test Acc: 0.160
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.0471227169036865
Epoch: 10, Steps: 4 | Train Loss: 0.913 Vali Loss: 1.769 Vali Acc: 0.200 Test Loss: 1.769 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1755313873291016
Epoch: 11, Steps: 4 | Train Loss: 1.046 Vali Loss: 1.839 Vali Acc: 0.220 Test Loss: 1.839 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.2561469078063965
Epoch: 12, Steps: 4 | Train Loss: 0.908 Vali Loss: 1.921 Vali Acc: 0.240 Test Loss: 1.921 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1588621139526367
Epoch: 13, Steps: 4 | Train Loss: 0.631 Vali Loss: 1.951 Vali Acc: 0.260 Test Loss: 1.951 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259980).  Saving model ...
Epoch: 14 cost time: 1.255185604095459
Epoch: 14, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.983 Vali Acc: 0.260 Test Loss: 1.983 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.339034080505371
Epoch: 15, Steps: 4 | Train Loss: 0.496 Vali Loss: 2.071 Vali Acc: 0.220 Test Loss: 2.071 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.2516701221466064
Epoch: 16, Steps: 4 | Train Loss: 0.474 Vali Loss: 2.242 Vali Acc: 0.220 Test Loss: 2.242 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.3736376762390137
Epoch: 17, Steps: 4 | Train Loss: 0.432 Vali Loss: 2.376 Vali Acc: 0.260 Test Loss: 2.376 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.3789408206939697
Epoch: 18, Steps: 4 | Train Loss: 0.676 Vali Loss: 2.588 Vali Acc: 0.320 Test Loss: 2.588 Test Acc: 0.320
Validation loss decreased (-0.259980 --> -0.319974).  Saving model ...
Epoch: 19 cost time: 1.2315301895141602
Epoch: 19, Steps: 4 | Train Loss: 0.336 Vali Loss: 2.665 Vali Acc: 0.320 Test Loss: 2.665 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.1296448707580566
Epoch: 20, Steps: 4 | Train Loss: 0.315 Vali Loss: 2.767 Vali Acc: 0.280 Test Loss: 2.767 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.2973976135253906
Epoch: 21, Steps: 4 | Train Loss: 0.331 Vali Loss: 2.855 Vali Acc: 0.240 Test Loss: 2.855 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.0767505168914795
Epoch: 22, Steps: 4 | Train Loss: 0.420 Vali Loss: 2.986 Vali Acc: 0.220 Test Loss: 2.986 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.2158911228179932
Epoch: 23, Steps: 4 | Train Loss: 0.230 Vali Loss: 3.016 Vali Acc: 0.220 Test Loss: 3.016 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.0992321968078613
Epoch: 24, Steps: 4 | Train Loss: 0.225 Vali Loss: 3.160 Vali Acc: 0.260 Test Loss: 3.160 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.105466604232788
Epoch: 25, Steps: 4 | Train Loss: 0.175 Vali Loss: 3.368 Vali Acc: 0.260 Test Loss: 3.368 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.1522948741912842
Epoch: 26, Steps: 4 | Train Loss: 0.270 Vali Loss: 3.361 Vali Acc: 0.240 Test Loss: 3.361 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1486868858337402
Epoch: 27, Steps: 4 | Train Loss: 0.266 Vali Loss: 3.469 Vali Acc: 0.260 Test Loss: 3.469 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.244422197341919
Epoch: 28, Steps: 4 | Train Loss: 0.272 Vali Loss: 3.586 Vali Acc: 0.240 Test Loss: 3.586 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 563929
model size : 3.38MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.833143472671509
Epoch: 1, Steps: 4 | Train Loss: 1.673 Vali Loss: 1.630 Vali Acc: 0.140 Test Loss: 1.630 Test Acc: 0.140
Validation loss decreased (inf --> -0.139984).  Saving model ...
Epoch: 2 cost time: 1.2775006294250488
Epoch: 2, Steps: 4 | Train Loss: 1.677 Vali Loss: 1.628 Vali Acc: 0.160 Test Loss: 1.628 Test Acc: 0.160
Validation loss decreased (-0.139984 --> -0.159984).  Saving model ...
Epoch: 3 cost time: 1.1321282386779785
Epoch: 3, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.631 Vali Acc: 0.180 Test Loss: 1.631 Test Acc: 0.180
Validation loss decreased (-0.159984 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.1845836639404297
Epoch: 4, Steps: 4 | Train Loss: 1.344 Vali Loss: 1.657 Vali Acc: 0.180 Test Loss: 1.657 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3381450176239014
Epoch: 5, Steps: 4 | Train Loss: 1.294 Vali Loss: 1.678 Vali Acc: 0.160 Test Loss: 1.678 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1436631679534912
Epoch: 6, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.746 Vali Acc: 0.200 Test Loss: 1.746 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 1.2789549827575684
Epoch: 7, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.837 Vali Acc: 0.240 Test Loss: 1.837 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239982).  Saving model ...
Epoch: 8 cost time: 1.0589392185211182
Epoch: 8, Steps: 4 | Train Loss: 0.917 Vali Loss: 1.956 Vali Acc: 0.220 Test Loss: 1.956 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2854442596435547
Epoch: 9, Steps: 4 | Train Loss: 1.041 Vali Loss: 2.069 Vali Acc: 0.180 Test Loss: 2.069 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0999360084533691
Epoch: 10, Steps: 4 | Train Loss: 0.753 Vali Loss: 2.133 Vali Acc: 0.180 Test Loss: 2.133 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2975656986236572
Epoch: 11, Steps: 4 | Train Loss: 0.639 Vali Loss: 2.196 Vali Acc: 0.220 Test Loss: 2.196 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1546375751495361
Epoch: 12, Steps: 4 | Train Loss: 0.532 Vali Loss: 2.328 Vali Acc: 0.220 Test Loss: 2.328 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.2545151710510254
Epoch: 13, Steps: 4 | Train Loss: 0.802 Vali Loss: 2.494 Vali Acc: 0.260 Test Loss: 2.494 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259975).  Saving model ...
Epoch: 14 cost time: 1.1712028980255127
Epoch: 14, Steps: 4 | Train Loss: 0.403 Vali Loss: 2.729 Vali Acc: 0.340 Test Loss: 2.729 Test Acc: 0.340
Validation loss decreased (-0.259975 --> -0.339973).  Saving model ...
Epoch: 15 cost time: 1.3018980026245117
Epoch: 15, Steps: 4 | Train Loss: 0.349 Vali Loss: 2.946 Vali Acc: 0.320 Test Loss: 2.946 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3260791301727295
Epoch: 16, Steps: 4 | Train Loss: 0.310 Vali Loss: 3.056 Vali Acc: 0.300 Test Loss: 3.056 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.4007458686828613
Epoch: 17, Steps: 4 | Train Loss: 0.408 Vali Loss: 3.200 Vali Acc: 0.300 Test Loss: 3.200 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.4824519157409668
Epoch: 18, Steps: 4 | Train Loss: 0.298 Vali Loss: 3.379 Vali Acc: 0.280 Test Loss: 3.379 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.33319091796875
Epoch: 19, Steps: 4 | Train Loss: 0.360 Vali Loss: 3.581 Vali Acc: 0.260 Test Loss: 3.581 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.241809368133545
Epoch: 20, Steps: 4 | Train Loss: 0.192 Vali Loss: 3.746 Vali Acc: 0.280 Test Loss: 3.746 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.1920254230499268
Epoch: 21, Steps: 4 | Train Loss: 0.266 Vali Loss: 3.759 Vali Acc: 0.280 Test Loss: 3.759 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.4207677841186523
Epoch: 22, Steps: 4 | Train Loss: 0.148 Vali Loss: 3.878 Vali Acc: 0.260 Test Loss: 3.878 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.188272476196289
Epoch: 23, Steps: 4 | Train Loss: 0.129 Vali Loss: 4.006 Vali Acc: 0.220 Test Loss: 4.006 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.2547168731689453
Epoch: 24, Steps: 4 | Train Loss: 0.096 Vali Loss: 4.228 Vali Acc: 0.260 Test Loss: 4.228 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 547545
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.499300241470337
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.651 Vali Acc: 0.160 Test Loss: 1.651 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.218482255935669
Epoch: 2, Steps: 4 | Train Loss: 1.680 Vali Loss: 1.643 Vali Acc: 0.180 Test Loss: 1.643 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179984).  Saving model ...
Epoch: 3 cost time: 1.0108935832977295
Epoch: 3, Steps: 4 | Train Loss: 1.508 Vali Loss: 1.655 Vali Acc: 0.140 Test Loss: 1.655 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0909903049468994
Epoch: 4, Steps: 4 | Train Loss: 1.365 Vali Loss: 1.684 Vali Acc: 0.160 Test Loss: 1.684 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.2649483680725098
Epoch: 5, Steps: 4 | Train Loss: 1.320 Vali Loss: 1.685 Vali Acc: 0.220 Test Loss: 1.685 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219983).  Saving model ...
Epoch: 6 cost time: 1.2244067192077637
Epoch: 6, Steps: 4 | Train Loss: 1.288 Vali Loss: 1.746 Vali Acc: 0.160 Test Loss: 1.746 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1522216796875
Epoch: 7, Steps: 4 | Train Loss: 0.987 Vali Loss: 1.844 Vali Acc: 0.180 Test Loss: 1.844 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1997191905975342
Epoch: 8, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.961 Vali Acc: 0.180 Test Loss: 1.961 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.206496238708496
Epoch: 9, Steps: 4 | Train Loss: 1.091 Vali Loss: 2.089 Vali Acc: 0.260 Test Loss: 2.089 Test Acc: 0.260
Validation loss decreased (-0.219983 --> -0.259979).  Saving model ...
Epoch: 10 cost time: 1.2013499736785889
Epoch: 10, Steps: 4 | Train Loss: 0.780 Vali Loss: 2.127 Vali Acc: 0.180 Test Loss: 2.127 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.3577306270599365
Epoch: 11, Steps: 4 | Train Loss: 0.678 Vali Loss: 2.222 Vali Acc: 0.200 Test Loss: 2.222 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4006056785583496
Epoch: 12, Steps: 4 | Train Loss: 0.561 Vali Loss: 2.348 Vali Acc: 0.220 Test Loss: 2.348 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1366844177246094
Epoch: 13, Steps: 4 | Train Loss: 0.842 Vali Loss: 2.534 Vali Acc: 0.220 Test Loss: 2.534 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2289321422576904
Epoch: 14, Steps: 4 | Train Loss: 0.432 Vali Loss: 2.785 Vali Acc: 0.240 Test Loss: 2.785 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.1471765041351318
Epoch: 15, Steps: 4 | Train Loss: 0.369 Vali Loss: 3.052 Vali Acc: 0.320 Test Loss: 3.052 Test Acc: 0.320
Validation loss decreased (-0.259979 --> -0.319969).  Saving model ...
Epoch: 16 cost time: 1.191070556640625
Epoch: 16, Steps: 4 | Train Loss: 0.328 Vali Loss: 3.184 Vali Acc: 0.320 Test Loss: 3.184 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.3453936576843262
Epoch: 17, Steps: 4 | Train Loss: 0.453 Vali Loss: 3.445 Vali Acc: 0.300 Test Loss: 3.445 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5060603618621826
Epoch: 18, Steps: 4 | Train Loss: 0.323 Vali Loss: 3.652 Vali Acc: 0.280 Test Loss: 3.652 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.2727277278900146
Epoch: 19, Steps: 4 | Train Loss: 0.381 Vali Loss: 3.898 Vali Acc: 0.280 Test Loss: 3.898 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.3809080123901367
Epoch: 20, Steps: 4 | Train Loss: 0.210 Vali Loss: 4.090 Vali Acc: 0.320 Test Loss: 4.090 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2043507099151611
Epoch: 21, Steps: 4 | Train Loss: 0.288 Vali Loss: 4.161 Vali Acc: 0.280 Test Loss: 4.161 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2755839824676514
Epoch: 22, Steps: 4 | Train Loss: 0.157 Vali Loss: 4.304 Vali Acc: 0.280 Test Loss: 4.304 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.2979531288146973
Epoch: 23, Steps: 4 | Train Loss: 0.136 Vali Loss: 4.476 Vali Acc: 0.260 Test Loss: 4.476 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.2714543342590332
Epoch: 24, Steps: 4 | Train Loss: 0.104 Vali Loss: 4.696 Vali Acc: 0.280 Test Loss: 4.696 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.3529658317565918
Epoch: 25, Steps: 4 | Train Loss: 0.142 Vali Loss: 4.921 Vali Acc: 0.280 Test Loss: 4.921 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 547545
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4332115650177
Epoch: 1, Steps: 4 | Train Loss: 1.656 Vali Loss: 1.612 Vali Acc: 0.180 Test Loss: 1.612 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.1068897247314453
Epoch: 2, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.600 Vali Acc: 0.120 Test Loss: 1.600 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.2253854274749756
Epoch: 3, Steps: 4 | Train Loss: 1.521 Vali Loss: 1.611 Vali Acc: 0.100 Test Loss: 1.611 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.1069486141204834
Epoch: 4, Steps: 4 | Train Loss: 1.360 Vali Loss: 1.647 Vali Acc: 0.100 Test Loss: 1.647 Test Acc: 0.100
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.2456328868865967
Epoch: 5, Steps: 4 | Train Loss: 1.337 Vali Loss: 1.663 Vali Acc: 0.140 Test Loss: 1.663 Test Acc: 0.140
EarlyStopping counter: 4 out of 10
Epoch: 6 cost time: 1.362191915512085
Epoch: 6, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.715 Vali Acc: 0.180 Test Loss: 1.715 Test Acc: 0.180
EarlyStopping counter: 5 out of 10
Epoch: 7 cost time: 1.189694881439209
Epoch: 7, Steps: 4 | Train Loss: 1.029 Vali Loss: 1.790 Vali Acc: 0.160 Test Loss: 1.790 Test Acc: 0.160
EarlyStopping counter: 6 out of 10
Epoch: 8 cost time: 1.153317928314209
Epoch: 8, Steps: 4 | Train Loss: 0.984 Vali Loss: 1.913 Vali Acc: 0.180 Test Loss: 1.913 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 9 cost time: 1.0382483005523682
Epoch: 9, Steps: 4 | Train Loss: 1.132 Vali Loss: 2.055 Vali Acc: 0.180 Test Loss: 2.055 Test Acc: 0.180
EarlyStopping counter: 8 out of 10
Epoch: 10 cost time: 1.0544958114624023
Epoch: 10, Steps: 4 | Train Loss: 0.811 Vali Loss: 2.102 Vali Acc: 0.180 Test Loss: 2.102 Test Acc: 0.180
EarlyStopping counter: 9 out of 10
Epoch: 11 cost time: 1.178858757019043
Epoch: 11, Steps: 4 | Train Loss: 0.715 Vali Loss: 2.192 Vali Acc: 0.220 Test Loss: 2.192 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219978).  Saving model ...
Epoch: 12 cost time: 1.0883586406707764
Epoch: 12, Steps: 4 | Train Loss: 0.618 Vali Loss: 2.302 Vali Acc: 0.260 Test Loss: 2.302 Test Acc: 0.260
Validation loss decreased (-0.219978 --> -0.259977).  Saving model ...
Epoch: 13 cost time: 0.9769032001495361
Epoch: 13, Steps: 4 | Train Loss: 0.876 Vali Loss: 2.429 Vali Acc: 0.260 Test Loss: 2.429 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.4056870937347412
Epoch: 14, Steps: 4 | Train Loss: 0.468 Vali Loss: 2.598 Vali Acc: 0.280 Test Loss: 2.598 Test Acc: 0.280
Validation loss decreased (-0.259977 --> -0.279974).  Saving model ...
Epoch: 15 cost time: 1.2916772365570068
Epoch: 15, Steps: 4 | Train Loss: 0.402 Vali Loss: 2.784 Vali Acc: 0.320 Test Loss: 2.784 Test Acc: 0.320
Validation loss decreased (-0.279974 --> -0.319972).  Saving model ...
Epoch: 16 cost time: 1.0333468914031982
Epoch: 16, Steps: 4 | Train Loss: 0.370 Vali Loss: 2.925 Vali Acc: 0.300 Test Loss: 2.925 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.1479554176330566
Epoch: 17, Steps: 4 | Train Loss: 0.513 Vali Loss: 3.276 Vali Acc: 0.300 Test Loss: 3.276 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1991970539093018
Epoch: 18, Steps: 4 | Train Loss: 0.389 Vali Loss: 3.577 Vali Acc: 0.280 Test Loss: 3.577 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3040351867675781
Epoch: 19, Steps: 4 | Train Loss: 0.415 Vali Loss: 3.864 Vali Acc: 0.240 Test Loss: 3.864 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.162513017654419
Epoch: 20, Steps: 4 | Train Loss: 0.243 Vali Loss: 4.017 Vali Acc: 0.280 Test Loss: 4.017 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2062773704528809
Epoch: 21, Steps: 4 | Train Loss: 0.324 Vali Loss: 4.143 Vali Acc: 0.220 Test Loss: 4.143 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2466983795166016
Epoch: 22, Steps: 4 | Train Loss: 0.191 Vali Loss: 4.380 Vali Acc: 0.220 Test Loss: 4.380 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.293797254562378
Epoch: 23, Steps: 4 | Train Loss: 0.158 Vali Loss: 4.670 Vali Acc: 0.240 Test Loss: 4.670 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.23850417137146
Epoch: 24, Steps: 4 | Train Loss: 0.124 Vali Loss: 4.934 Vali Acc: 0.280 Test Loss: 4.934 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2005269527435303
Epoch: 25, Steps: 4 | Train Loss: 0.153 Vali Loss: 5.257 Vali Acc: 0.300 Test Loss: 5.257 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 547545
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.366851329803467
Epoch: 1, Steps: 4 | Train Loss: 1.655 Vali Loss: 1.636 Vali Acc: 0.040 Test Loss: 1.636 Test Acc: 0.040
Validation loss decreased (inf --> -0.039984).  Saving model ...
Epoch: 2 cost time: 1.2119803428649902
Epoch: 2, Steps: 4 | Train Loss: 1.685 Vali Loss: 1.629 Vali Acc: 0.080 Test Loss: 1.629 Test Acc: 0.080
Validation loss decreased (-0.039984 --> -0.079984).  Saving model ...
Epoch: 3 cost time: 1.1409189701080322
Epoch: 3, Steps: 4 | Train Loss: 1.550 Vali Loss: 1.625 Vali Acc: 0.100 Test Loss: 1.625 Test Acc: 0.100
Validation loss decreased (-0.079984 --> -0.099984).  Saving model ...
Epoch: 4 cost time: 1.2216084003448486
Epoch: 4, Steps: 4 | Train Loss: 1.429 Vali Loss: 1.649 Vali Acc: 0.120 Test Loss: 1.649 Test Acc: 0.120
Validation loss decreased (-0.099984 --> -0.119984).  Saving model ...
Epoch: 5 cost time: 1.2701022624969482
Epoch: 5, Steps: 4 | Train Loss: 1.381 Vali Loss: 1.661 Vali Acc: 0.180 Test Loss: 1.661 Test Acc: 0.180
Validation loss decreased (-0.119984 --> -0.179983).  Saving model ...
Epoch: 6 cost time: 1.1813569068908691
Epoch: 6, Steps: 4 | Train Loss: 1.393 Vali Loss: 1.690 Vali Acc: 0.200 Test Loss: 1.690 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 1.1396219730377197
Epoch: 7, Steps: 4 | Train Loss: 1.137 Vali Loss: 1.688 Vali Acc: 0.200 Test Loss: 1.688 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 8 cost time: 1.0909020900726318
Epoch: 8, Steps: 4 | Train Loss: 1.069 Vali Loss: 1.754 Vali Acc: 0.220 Test Loss: 1.754 Test Acc: 0.220
Validation loss decreased (-0.199983 --> -0.219982).  Saving model ...
Epoch: 9 cost time: 1.2379186153411865
Epoch: 9, Steps: 4 | Train Loss: 1.230 Vali Loss: 1.797 Vali Acc: 0.220 Test Loss: 1.797 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.453850507736206
Epoch: 10, Steps: 4 | Train Loss: 0.915 Vali Loss: 1.819 Vali Acc: 0.240 Test Loss: 1.819 Test Acc: 0.240
Validation loss decreased (-0.219982 --> -0.239982).  Saving model ...
Epoch: 11 cost time: 1.4396576881408691
Epoch: 11, Steps: 4 | Train Loss: 0.835 Vali Loss: 1.855 Vali Acc: 0.240 Test Loss: 1.855 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1950197219848633
Epoch: 12, Steps: 4 | Train Loss: 0.774 Vali Loss: 1.924 Vali Acc: 0.260 Test Loss: 1.924 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259981).  Saving model ...
Epoch: 13 cost time: 1.3114633560180664
Epoch: 13, Steps: 4 | Train Loss: 0.981 Vali Loss: 2.000 Vali Acc: 0.260 Test Loss: 2.000 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2463963031768799
Epoch: 14, Steps: 4 | Train Loss: 0.584 Vali Loss: 2.041 Vali Acc: 0.280 Test Loss: 2.041 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279980).  Saving model ...
Epoch: 15 cost time: 1.1589903831481934
Epoch: 15, Steps: 4 | Train Loss: 0.501 Vali Loss: 2.092 Vali Acc: 0.260 Test Loss: 2.092 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.3453409671783447
Epoch: 16, Steps: 4 | Train Loss: 0.452 Vali Loss: 2.128 Vali Acc: 0.260 Test Loss: 2.128 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.155297040939331
Epoch: 17, Steps: 4 | Train Loss: 0.617 Vali Loss: 2.398 Vali Acc: 0.240 Test Loss: 2.398 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.3033552169799805
Epoch: 18, Steps: 4 | Train Loss: 0.498 Vali Loss: 2.569 Vali Acc: 0.220 Test Loss: 2.569 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.5937621593475342
Epoch: 19, Steps: 4 | Train Loss: 0.492 Vali Loss: 2.738 Vali Acc: 0.260 Test Loss: 2.738 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.2631146907806396
Epoch: 20, Steps: 4 | Train Loss: 0.302 Vali Loss: 2.853 Vali Acc: 0.240 Test Loss: 2.853 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.171656847000122
Epoch: 21, Steps: 4 | Train Loss: 0.417 Vali Loss: 2.959 Vali Acc: 0.240 Test Loss: 2.959 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.191735029220581
Epoch: 22, Steps: 4 | Train Loss: 0.250 Vali Loss: 3.230 Vali Acc: 0.220 Test Loss: 3.230 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.311992883682251
Epoch: 23, Steps: 4 | Train Loss: 0.224 Vali Loss: 3.428 Vali Acc: 0.240 Test Loss: 3.428 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 1.238410234451294
Epoch: 24, Steps: 4 | Train Loss: 0.182 Vali Loss: 3.687 Vali Acc: 0.220 Test Loss: 3.687 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 547545
model size : 3.32MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4258809089660645
Epoch: 1, Steps: 4 | Train Loss: 1.736 Vali Loss: 1.782 Vali Acc: 0.160 Test Loss: 1.782 Test Acc: 0.160
Validation loss decreased (inf --> -0.159982).  Saving model ...
Epoch: 2 cost time: 1.4287762641906738
Epoch: 2, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.769 Vali Acc: 0.140 Test Loss: 1.769 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1065187454223633
Epoch: 3, Steps: 4 | Train Loss: 1.559 Vali Loss: 1.766 Vali Acc: 0.240 Test Loss: 1.766 Test Acc: 0.240
Validation loss decreased (-0.159982 --> -0.239982).  Saving model ...
Epoch: 4 cost time: 1.0581133365631104
Epoch: 4, Steps: 4 | Train Loss: 1.252 Vali Loss: 1.777 Vali Acc: 0.220 Test Loss: 1.777 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0930681228637695
Epoch: 5, Steps: 4 | Train Loss: 1.232 Vali Loss: 1.818 Vali Acc: 0.180 Test Loss: 1.818 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.0878303050994873
Epoch: 6, Steps: 4 | Train Loss: 1.197 Vali Loss: 1.837 Vali Acc: 0.180 Test Loss: 1.837 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.12319016456604
Epoch: 7, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.887 Vali Acc: 0.240 Test Loss: 1.887 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.0686228275299072
Epoch: 8, Steps: 4 | Train Loss: 0.873 Vali Loss: 1.955 Vali Acc: 0.240 Test Loss: 1.955 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.1245315074920654
Epoch: 9, Steps: 4 | Train Loss: 0.702 Vali Loss: 2.034 Vali Acc: 0.200 Test Loss: 2.034 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.1597111225128174
Epoch: 10, Steps: 4 | Train Loss: 0.802 Vali Loss: 2.146 Vali Acc: 0.240 Test Loss: 2.146 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2374215126037598
Epoch: 11, Steps: 4 | Train Loss: 0.777 Vali Loss: 2.272 Vali Acc: 0.260 Test Loss: 2.272 Test Acc: 0.260
Validation loss decreased (-0.239982 --> -0.259977).  Saving model ...
Epoch: 12 cost time: 1.1047661304473877
Epoch: 12, Steps: 4 | Train Loss: 0.624 Vali Loss: 2.433 Vali Acc: 0.340 Test Loss: 2.433 Test Acc: 0.340
Validation loss decreased (-0.259977 --> -0.339976).  Saving model ...
Epoch: 13 cost time: 1.2178313732147217
Epoch: 13, Steps: 4 | Train Loss: 0.472 Vali Loss: 2.597 Vali Acc: 0.240 Test Loss: 2.597 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.2577109336853027
Epoch: 14, Steps: 4 | Train Loss: 0.439 Vali Loss: 2.792 Vali Acc: 0.220 Test Loss: 2.792 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.0373854637145996
Epoch: 15, Steps: 4 | Train Loss: 0.439 Vali Loss: 2.944 Vali Acc: 0.220 Test Loss: 2.944 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.1573870182037354
Epoch: 16, Steps: 4 | Train Loss: 0.378 Vali Loss: 3.154 Vali Acc: 0.280 Test Loss: 3.154 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1388170719146729
Epoch: 17, Steps: 4 | Train Loss: 0.340 Vali Loss: 3.365 Vali Acc: 0.260 Test Loss: 3.365 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.1982102394104004
Epoch: 18, Steps: 4 | Train Loss: 0.398 Vali Loss: 3.610 Vali Acc: 0.260 Test Loss: 3.610 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.1923997402191162
Epoch: 19, Steps: 4 | Train Loss: 0.262 Vali Loss: 3.772 Vali Acc: 0.260 Test Loss: 3.772 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.1215388774871826
Epoch: 20, Steps: 4 | Train Loss: 0.229 Vali Loss: 3.855 Vali Acc: 0.240 Test Loss: 3.855 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.1373801231384277
Epoch: 21, Steps: 4 | Train Loss: 0.173 Vali Loss: 4.034 Vali Acc: 0.260 Test Loss: 4.034 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.220625638961792
Epoch: 22, Steps: 4 | Train Loss: 0.152 Vali Loss: 4.184 Vali Acc: 0.220 Test Loss: 4.184 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 539353
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.305382490158081
Epoch: 1, Steps: 4 | Train Loss: 1.751 Vali Loss: 1.786 Vali Acc: 0.100 Test Loss: 1.786 Test Acc: 0.100
Validation loss decreased (inf --> -0.099982).  Saving model ...
Epoch: 2 cost time: 1.2080090045928955
Epoch: 2, Steps: 4 | Train Loss: 1.630 Vali Loss: 1.780 Vali Acc: 0.100 Test Loss: 1.780 Test Acc: 0.100
Validation loss decreased (-0.099982 --> -0.099982).  Saving model ...
Epoch: 3 cost time: 1.0569279193878174
Epoch: 3, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.781 Vali Acc: 0.180 Test Loss: 1.781 Test Acc: 0.180
Validation loss decreased (-0.099982 --> -0.179982).  Saving model ...
Epoch: 4 cost time: 1.256082534790039
Epoch: 4, Steps: 4 | Train Loss: 1.283 Vali Loss: 1.785 Vali Acc: 0.200 Test Loss: 1.785 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199982).  Saving model ...
Epoch: 5 cost time: 1.3316524028778076
Epoch: 5, Steps: 4 | Train Loss: 1.268 Vali Loss: 1.815 Vali Acc: 0.180 Test Loss: 1.815 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3064439296722412
Epoch: 6, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.825 Vali Acc: 0.180 Test Loss: 1.825 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2379283905029297
Epoch: 7, Steps: 4 | Train Loss: 1.050 Vali Loss: 1.875 Vali Acc: 0.260 Test Loss: 1.875 Test Acc: 0.260
Validation loss decreased (-0.199982 --> -0.259981).  Saving model ...
Epoch: 8 cost time: 1.0418596267700195
Epoch: 8, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.935 Vali Acc: 0.240 Test Loss: 1.935 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.279536247253418
Epoch: 9, Steps: 4 | Train Loss: 0.728 Vali Loss: 1.983 Vali Acc: 0.260 Test Loss: 1.983 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.1217710971832275
Epoch: 10, Steps: 4 | Train Loss: 0.838 Vali Loss: 2.093 Vali Acc: 0.200 Test Loss: 2.093 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3149986267089844
Epoch: 11, Steps: 4 | Train Loss: 0.807 Vali Loss: 2.260 Vali Acc: 0.240 Test Loss: 2.260 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.3836627006530762
Epoch: 12, Steps: 4 | Train Loss: 0.655 Vali Loss: 2.421 Vali Acc: 0.280 Test Loss: 2.421 Test Acc: 0.280
Validation loss decreased (-0.259981 --> -0.279976).  Saving model ...
Epoch: 13 cost time: 1.295943021774292
Epoch: 13, Steps: 4 | Train Loss: 0.501 Vali Loss: 2.598 Vali Acc: 0.200 Test Loss: 2.598 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.3057327270507812
Epoch: 14, Steps: 4 | Train Loss: 0.472 Vali Loss: 2.855 Vali Acc: 0.220 Test Loss: 2.855 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.1953551769256592
Epoch: 15, Steps: 4 | Train Loss: 0.470 Vali Loss: 3.068 Vali Acc: 0.220 Test Loss: 3.068 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.4028611183166504
Epoch: 16, Steps: 4 | Train Loss: 0.418 Vali Loss: 3.315 Vali Acc: 0.220 Test Loss: 3.315 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.1004211902618408
Epoch: 17, Steps: 4 | Train Loss: 0.369 Vali Loss: 3.562 Vali Acc: 0.280 Test Loss: 3.562 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.2525718212127686
Epoch: 18, Steps: 4 | Train Loss: 0.421 Vali Loss: 3.884 Vali Acc: 0.240 Test Loss: 3.884 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.4541583061218262
Epoch: 19, Steps: 4 | Train Loss: 0.289 Vali Loss: 4.127 Vali Acc: 0.220 Test Loss: 4.127 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.4133758544921875
Epoch: 20, Steps: 4 | Train Loss: 0.255 Vali Loss: 4.260 Vali Acc: 0.220 Test Loss: 4.260 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.178293228149414
Epoch: 21, Steps: 4 | Train Loss: 0.196 Vali Loss: 4.264 Vali Acc: 0.220 Test Loss: 4.264 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.1578538417816162
Epoch: 22, Steps: 4 | Train Loss: 0.173 Vali Loss: 4.334 Vali Acc: 0.200 Test Loss: 4.334 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 539353
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.596649169921875
Epoch: 1, Steps: 4 | Train Loss: 1.725 Vali Loss: 1.759 Vali Acc: 0.140 Test Loss: 1.759 Test Acc: 0.140
Validation loss decreased (inf --> -0.139982).  Saving model ...
Epoch: 2 cost time: 1.1971745491027832
Epoch: 2, Steps: 4 | Train Loss: 1.626 Vali Loss: 1.755 Vali Acc: 0.080 Test Loss: 1.755 Test Acc: 0.080
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.4032602310180664
Epoch: 3, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.765 Vali Acc: 0.160 Test Loss: 1.765 Test Acc: 0.160
Validation loss decreased (-0.139982 --> -0.159982).  Saving model ...
Epoch: 4 cost time: 1.2400381565093994
Epoch: 4, Steps: 4 | Train Loss: 1.314 Vali Loss: 1.780 Vali Acc: 0.180 Test Loss: 1.780 Test Acc: 0.180
Validation loss decreased (-0.159982 --> -0.179982).  Saving model ...
Epoch: 5 cost time: 1.3960933685302734
Epoch: 5, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.799 Vali Acc: 0.120 Test Loss: 1.799 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.162348985671997
Epoch: 6, Steps: 4 | Train Loss: 1.265 Vali Loss: 1.781 Vali Acc: 0.200 Test Loss: 1.781 Test Acc: 0.200
Validation loss decreased (-0.179982 --> -0.199982).  Saving model ...
Epoch: 7 cost time: 1.0955760478973389
Epoch: 7, Steps: 4 | Train Loss: 1.106 Vali Loss: 1.847 Vali Acc: 0.240 Test Loss: 1.847 Test Acc: 0.240
Validation loss decreased (-0.199982 --> -0.239982).  Saving model ...
Epoch: 8 cost time: 1.0719294548034668
Epoch: 8, Steps: 4 | Train Loss: 0.933 Vali Loss: 1.909 Vali Acc: 0.280 Test Loss: 1.909 Test Acc: 0.280
Validation loss decreased (-0.239982 --> -0.279981).  Saving model ...
Epoch: 9 cost time: 1.2141122817993164
Epoch: 9, Steps: 4 | Train Loss: 0.760 Vali Loss: 1.983 Vali Acc: 0.240 Test Loss: 1.983 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.2591218948364258
Epoch: 10, Steps: 4 | Train Loss: 0.903 Vali Loss: 2.077 Vali Acc: 0.200 Test Loss: 2.077 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.4660272598266602
Epoch: 11, Steps: 4 | Train Loss: 0.846 Vali Loss: 2.171 Vali Acc: 0.220 Test Loss: 2.171 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.232980489730835
Epoch: 12, Steps: 4 | Train Loss: 0.717 Vali Loss: 2.307 Vali Acc: 0.240 Test Loss: 2.307 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1618528366088867
Epoch: 13, Steps: 4 | Train Loss: 0.552 Vali Loss: 2.474 Vali Acc: 0.240 Test Loss: 2.474 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2935810089111328
Epoch: 14, Steps: 4 | Train Loss: 0.529 Vali Loss: 2.686 Vali Acc: 0.240 Test Loss: 2.686 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.3362510204315186
Epoch: 15, Steps: 4 | Train Loss: 0.531 Vali Loss: 2.801 Vali Acc: 0.220 Test Loss: 2.801 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.2552082538604736
Epoch: 16, Steps: 4 | Train Loss: 0.480 Vali Loss: 2.996 Vali Acc: 0.240 Test Loss: 2.996 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.2082746028900146
Epoch: 17, Steps: 4 | Train Loss: 0.442 Vali Loss: 3.205 Vali Acc: 0.260 Test Loss: 3.205 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.305333137512207
Epoch: 18, Steps: 4 | Train Loss: 0.451 Vali Loss: 3.401 Vali Acc: 0.300 Test Loss: 3.401 Test Acc: 0.300
Validation loss decreased (-0.279981 --> -0.299966).  Saving model ...
Epoch: 19 cost time: 1.176609992980957
Epoch: 19, Steps: 4 | Train Loss: 0.330 Vali Loss: 3.686 Vali Acc: 0.220 Test Loss: 3.686 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2273533344268799
Epoch: 20, Steps: 4 | Train Loss: 0.303 Vali Loss: 3.863 Vali Acc: 0.200 Test Loss: 3.863 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.346834659576416
Epoch: 21, Steps: 4 | Train Loss: 0.232 Vali Loss: 4.009 Vali Acc: 0.240 Test Loss: 4.009 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1097543239593506
Epoch: 22, Steps: 4 | Train Loss: 0.212 Vali Loss: 4.102 Vali Acc: 0.240 Test Loss: 4.102 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.3201878070831299
Epoch: 23, Steps: 4 | Train Loss: 0.295 Vali Loss: 4.075 Vali Acc: 0.220 Test Loss: 4.075 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.1394832134246826
Epoch: 24, Steps: 4 | Train Loss: 0.161 Vali Loss: 4.320 Vali Acc: 0.240 Test Loss: 4.320 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4139626026153564
Epoch: 25, Steps: 4 | Train Loss: 0.136 Vali Loss: 4.586 Vali Acc: 0.220 Test Loss: 4.586 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.2546710968017578
Epoch: 26, Steps: 4 | Train Loss: 0.109 Vali Loss: 4.679 Vali Acc: 0.260 Test Loss: 4.679 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.1506803035736084
Epoch: 27, Steps: 4 | Train Loss: 0.091 Vali Loss: 4.906 Vali Acc: 0.280 Test Loss: 4.906 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.1749637126922607
Epoch: 28, Steps: 4 | Train Loss: 0.074 Vali Loss: 5.121 Vali Acc: 0.260 Test Loss: 5.121 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 539353
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.6813948154449463
Epoch: 1, Steps: 4 | Train Loss: 1.676 Vali Loss: 1.676 Vali Acc: 0.060 Test Loss: 1.676 Test Acc: 0.060
Validation loss decreased (inf --> -0.059983).  Saving model ...
Epoch: 2 cost time: 1.3012170791625977
Epoch: 2, Steps: 4 | Train Loss: 1.596 Vali Loss: 1.679 Vali Acc: 0.120 Test Loss: 1.679 Test Acc: 0.120
Validation loss decreased (-0.059983 --> -0.119983).  Saving model ...
Epoch: 3 cost time: 1.2383918762207031
Epoch: 3, Steps: 4 | Train Loss: 1.553 Vali Loss: 1.682 Vali Acc: 0.180 Test Loss: 1.682 Test Acc: 0.180
Validation loss decreased (-0.119983 --> -0.179983).  Saving model ...
Epoch: 4 cost time: 1.2949535846710205
Epoch: 4, Steps: 4 | Train Loss: 1.310 Vali Loss: 1.688 Vali Acc: 0.200 Test Loss: 1.688 Test Acc: 0.200
Validation loss decreased (-0.179983 --> -0.199983).  Saving model ...
Epoch: 5 cost time: 1.4882922172546387
Epoch: 5, Steps: 4 | Train Loss: 1.356 Vali Loss: 1.687 Vali Acc: 0.180 Test Loss: 1.687 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.3761553764343262
Epoch: 6, Steps: 4 | Train Loss: 1.326 Vali Loss: 1.674 Vali Acc: 0.200 Test Loss: 1.674 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 7 cost time: 1.517317295074463
Epoch: 7, Steps: 4 | Train Loss: 1.190 Vali Loss: 1.691 Vali Acc: 0.240 Test Loss: 1.691 Test Acc: 0.240
Validation loss decreased (-0.199983 --> -0.239983).  Saving model ...
Epoch: 8 cost time: 1.224855899810791
Epoch: 8, Steps: 4 | Train Loss: 0.976 Vali Loss: 1.736 Vali Acc: 0.240 Test Loss: 1.736 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.2281553745269775
Epoch: 9, Steps: 4 | Train Loss: 0.822 Vali Loss: 1.785 Vali Acc: 0.240 Test Loss: 1.785 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5673584938049316
Epoch: 10, Steps: 4 | Train Loss: 0.981 Vali Loss: 1.844 Vali Acc: 0.240 Test Loss: 1.844 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.28468918800354
Epoch: 11, Steps: 4 | Train Loss: 0.901 Vali Loss: 1.898 Vali Acc: 0.240 Test Loss: 1.898 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.5019469261169434
Epoch: 12, Steps: 4 | Train Loss: 0.792 Vali Loss: 1.994 Vali Acc: 0.240 Test Loss: 1.994 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.399569034576416
Epoch: 13, Steps: 4 | Train Loss: 0.632 Vali Loss: 2.094 Vali Acc: 0.220 Test Loss: 2.094 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.3684353828430176
Epoch: 14, Steps: 4 | Train Loss: 0.600 Vali Loss: 2.211 Vali Acc: 0.200 Test Loss: 2.211 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.466381311416626
Epoch: 15, Steps: 4 | Train Loss: 0.643 Vali Loss: 2.272 Vali Acc: 0.200 Test Loss: 2.272 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.262657642364502
Epoch: 16, Steps: 4 | Train Loss: 0.565 Vali Loss: 2.365 Vali Acc: 0.200 Test Loss: 2.365 Test Acc: 0.200
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.3615996837615967
Epoch: 17, Steps: 4 | Train Loss: 0.532 Vali Loss: 2.496 Vali Acc: 0.200 Test Loss: 2.496 Test Acc: 0.200
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.24
model parameter : 539353
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.749845504760742
Epoch: 1, Steps: 4 | Train Loss: 1.747 Vali Loss: 1.728 Vali Acc: 0.200 Test Loss: 1.728 Test Acc: 0.200
Validation loss decreased (inf --> -0.199983).  Saving model ...
Epoch: 2 cost time: 1.5201780796051025
Epoch: 2, Steps: 4 | Train Loss: 1.739 Vali Loss: 1.689 Vali Acc: 0.200 Test Loss: 1.689 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 1.437129020690918
Epoch: 3, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.620 Vali Acc: 0.200 Test Loss: 1.620 Test Acc: 0.200
Validation loss decreased (-0.199983 --> -0.199984).  Saving model ...
Epoch: 4 cost time: 1.1398136615753174
Epoch: 4, Steps: 4 | Train Loss: 1.517 Vali Loss: 1.587 Vali Acc: 0.140 Test Loss: 1.587 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.432753562927246
Epoch: 5, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.560 Vali Acc: 0.140 Test Loss: 1.560 Test Acc: 0.140
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.2159111499786377
Epoch: 6, Steps: 4 | Train Loss: 1.305 Vali Loss: 1.565 Vali Acc: 0.220 Test Loss: 1.565 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 7 cost time: 1.1613588333129883
Epoch: 7, Steps: 4 | Train Loss: 1.231 Vali Loss: 1.580 Vali Acc: 0.260 Test Loss: 1.580 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 8 cost time: 1.3321092128753662
Epoch: 8, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.638 Vali Acc: 0.220 Test Loss: 1.638 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.325228214263916
Epoch: 9, Steps: 4 | Train Loss: 1.063 Vali Loss: 1.703 Vali Acc: 0.220 Test Loss: 1.703 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.263575553894043
Epoch: 10, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.750 Vali Acc: 0.260 Test Loss: 1.750 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.3251056671142578
Epoch: 11, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.820 Vali Acc: 0.300 Test Loss: 1.820 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299982).  Saving model ...
Epoch: 12 cost time: 1.3102190494537354
Epoch: 12, Steps: 4 | Train Loss: 0.884 Vali Loss: 1.873 Vali Acc: 0.260 Test Loss: 1.873 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.3845911026000977
Epoch: 13, Steps: 4 | Train Loss: 0.745 Vali Loss: 1.945 Vali Acc: 0.220 Test Loss: 1.945 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.283940315246582
Epoch: 14, Steps: 4 | Train Loss: 0.776 Vali Loss: 2.001 Vali Acc: 0.260 Test Loss: 2.001 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.2098968029022217
Epoch: 15, Steps: 4 | Train Loss: 0.686 Vali Loss: 2.106 Vali Acc: 0.260 Test Loss: 2.106 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.3246490955352783
Epoch: 16, Steps: 4 | Train Loss: 0.641 Vali Loss: 2.207 Vali Acc: 0.240 Test Loss: 2.207 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2894670963287354
Epoch: 17, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.323 Vali Acc: 0.240 Test Loss: 2.323 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.2472591400146484
Epoch: 18, Steps: 4 | Train Loss: 0.408 Vali Loss: 2.564 Vali Acc: 0.260 Test Loss: 2.564 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.7217884063720703
Epoch: 19, Steps: 4 | Train Loss: 0.450 Vali Loss: 2.813 Vali Acc: 0.240 Test Loss: 2.813 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.286203145980835
Epoch: 20, Steps: 4 | Train Loss: 0.339 Vali Loss: 2.924 Vali Acc: 0.220 Test Loss: 2.924 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.1141703128814697
Epoch: 21, Steps: 4 | Train Loss: 0.371 Vali Loss: 3.048 Vali Acc: 0.220 Test Loss: 3.048 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 397305
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.408921003341675
Epoch: 1, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.740 Vali Acc: 0.160 Test Loss: 1.740 Test Acc: 0.160
Validation loss decreased (inf --> -0.159983).  Saving model ...
Epoch: 2 cost time: 1.110511064529419
Epoch: 2, Steps: 4 | Train Loss: 1.725 Vali Loss: 1.701 Vali Acc: 0.180 Test Loss: 1.701 Test Acc: 0.180
Validation loss decreased (-0.159983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.3257038593292236
Epoch: 3, Steps: 4 | Train Loss: 1.581 Vali Loss: 1.635 Vali Acc: 0.180 Test Loss: 1.635 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179984).  Saving model ...
Epoch: 4 cost time: 1.1739459037780762
Epoch: 4, Steps: 4 | Train Loss: 1.529 Vali Loss: 1.612 Vali Acc: 0.160 Test Loss: 1.612 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2746212482452393
Epoch: 5, Steps: 4 | Train Loss: 1.390 Vali Loss: 1.584 Vali Acc: 0.220 Test Loss: 1.584 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 6 cost time: 1.1361432075500488
Epoch: 6, Steps: 4 | Train Loss: 1.304 Vali Loss: 1.586 Vali Acc: 0.220 Test Loss: 1.586 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.4161131381988525
Epoch: 7, Steps: 4 | Train Loss: 1.224 Vali Loss: 1.592 Vali Acc: 0.220 Test Loss: 1.592 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2141375541687012
Epoch: 8, Steps: 4 | Train Loss: 1.237 Vali Loss: 1.649 Vali Acc: 0.240 Test Loss: 1.649 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 9 cost time: 1.2517058849334717
Epoch: 9, Steps: 4 | Train Loss: 1.076 Vali Loss: 1.692 Vali Acc: 0.220 Test Loss: 1.692 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1629698276519775
Epoch: 10, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.748 Vali Acc: 0.220 Test Loss: 1.748 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.3292953968048096
Epoch: 11, Steps: 4 | Train Loss: 0.948 Vali Loss: 1.806 Vali Acc: 0.200 Test Loss: 1.806 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.1915860176086426
Epoch: 12, Steps: 4 | Train Loss: 0.898 Vali Loss: 1.871 Vali Acc: 0.200 Test Loss: 1.871 Test Acc: 0.200
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.1596131324768066
Epoch: 13, Steps: 4 | Train Loss: 0.784 Vali Loss: 1.958 Vali Acc: 0.240 Test Loss: 1.958 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.2346863746643066
Epoch: 14, Steps: 4 | Train Loss: 0.780 Vali Loss: 2.014 Vali Acc: 0.200 Test Loss: 2.014 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.0520055294036865
Epoch: 15, Steps: 4 | Train Loss: 0.699 Vali Loss: 2.094 Vali Acc: 0.220 Test Loss: 2.094 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.133471965789795
Epoch: 16, Steps: 4 | Train Loss: 0.652 Vali Loss: 2.215 Vali Acc: 0.220 Test Loss: 2.215 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.3093039989471436
Epoch: 17, Steps: 4 | Train Loss: 0.533 Vali Loss: 2.400 Vali Acc: 0.220 Test Loss: 2.400 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.1576440334320068
Epoch: 18, Steps: 4 | Train Loss: 0.427 Vali Loss: 2.647 Vali Acc: 0.260 Test Loss: 2.647 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259974).  Saving model ...
Epoch: 19 cost time: 1.1783251762390137
Epoch: 19, Steps: 4 | Train Loss: 0.461 Vali Loss: 2.793 Vali Acc: 0.260 Test Loss: 2.793 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.380624771118164
Epoch: 20, Steps: 4 | Train Loss: 0.353 Vali Loss: 2.938 Vali Acc: 0.260 Test Loss: 2.938 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.1446268558502197
Epoch: 21, Steps: 4 | Train Loss: 0.408 Vali Loss: 3.042 Vali Acc: 0.260 Test Loss: 3.042 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.2312204837799072
Epoch: 22, Steps: 4 | Train Loss: 0.290 Vali Loss: 3.231 Vali Acc: 0.280 Test Loss: 3.231 Test Acc: 0.280
Validation loss decreased (-0.259974 --> -0.279968).  Saving model ...
Epoch: 23 cost time: 1.0832359790802002
Epoch: 23, Steps: 4 | Train Loss: 0.413 Vali Loss: 3.395 Vali Acc: 0.300 Test Loss: 3.395 Test Acc: 0.300
Validation loss decreased (-0.279968 --> -0.299966).  Saving model ...
Epoch: 24 cost time: 1.222480297088623
Epoch: 24, Steps: 4 | Train Loss: 0.317 Vali Loss: 3.465 Vali Acc: 0.260 Test Loss: 3.465 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.4199166297912598
Epoch: 25, Steps: 4 | Train Loss: 0.416 Vali Loss: 3.476 Vali Acc: 0.240 Test Loss: 3.476 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.3554961681365967
Epoch: 26, Steps: 4 | Train Loss: 0.203 Vali Loss: 3.586 Vali Acc: 0.260 Test Loss: 3.586 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.284904956817627
Epoch: 27, Steps: 4 | Train Loss: 0.196 Vali Loss: 3.783 Vali Acc: 0.300 Test Loss: 3.783 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.2060084342956543
Epoch: 28, Steps: 4 | Train Loss: 0.404 Vali Loss: 3.989 Vali Acc: 0.320 Test Loss: 3.989 Test Acc: 0.320
Validation loss decreased (-0.299966 --> -0.319960).  Saving model ...
Epoch: 29 cost time: 1.145554542541504
Epoch: 29, Steps: 4 | Train Loss: 0.154 Vali Loss: 4.094 Vali Acc: 0.340 Test Loss: 4.094 Test Acc: 0.340
Validation loss decreased (-0.319960 --> -0.339959).  Saving model ...
Epoch: 30 cost time: 1.189375400543213
Epoch: 30, Steps: 4 | Train Loss: 0.269 Vali Loss: 4.167 Vali Acc: 0.340 Test Loss: 4.167 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.2350363731384277
Epoch: 31, Steps: 4 | Train Loss: 0.148 Vali Loss: 4.262 Vali Acc: 0.340 Test Loss: 4.262 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.1331214904785156
Epoch: 32, Steps: 4 | Train Loss: 0.139 Vali Loss: 4.370 Vali Acc: 0.340 Test Loss: 4.370 Test Acc: 0.340
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.0790679454803467
Epoch: 33, Steps: 4 | Train Loss: 0.103 Vali Loss: 4.471 Vali Acc: 0.340 Test Loss: 4.471 Test Acc: 0.340
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.1942987442016602
Epoch: 34, Steps: 4 | Train Loss: 0.084 Vali Loss: 4.530 Vali Acc: 0.340 Test Loss: 4.530 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.183685064315796
Epoch: 35, Steps: 4 | Train Loss: 0.069 Vali Loss: 4.632 Vali Acc: 0.320 Test Loss: 4.632 Test Acc: 0.320
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.1679918766021729
Epoch: 36, Steps: 4 | Train Loss: 0.049 Vali Loss: 4.567 Vali Acc: 0.320 Test Loss: 4.567 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.1244566440582275
Epoch: 37, Steps: 4 | Train Loss: 0.081 Vali Loss: 4.660 Vali Acc: 0.300 Test Loss: 4.660 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.0684101581573486
Epoch: 38, Steps: 4 | Train Loss: 0.058 Vali Loss: 4.880 Vali Acc: 0.300 Test Loss: 4.880 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.0389230251312256
Epoch: 39, Steps: 4 | Train Loss: 0.039 Vali Loss: 5.142 Vali Acc: 0.260 Test Loss: 5.142 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 397305
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.533881664276123
Epoch: 1, Steps: 4 | Train Loss: 1.697 Vali Loss: 1.708 Vali Acc: 0.180 Test Loss: 1.708 Test Acc: 0.180
Validation loss decreased (inf --> -0.179983).  Saving model ...
Epoch: 2 cost time: 1.0349385738372803
Epoch: 2, Steps: 4 | Train Loss: 1.716 Vali Loss: 1.681 Vali Acc: 0.180 Test Loss: 1.681 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179983).  Saving model ...
Epoch: 3 cost time: 1.2363367080688477
Epoch: 3, Steps: 4 | Train Loss: 1.574 Vali Loss: 1.643 Vali Acc: 0.160 Test Loss: 1.643 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.383246898651123
Epoch: 4, Steps: 4 | Train Loss: 1.502 Vali Loss: 1.638 Vali Acc: 0.180 Test Loss: 1.638 Test Acc: 0.180
Validation loss decreased (-0.179983 --> -0.179984).  Saving model ...
Epoch: 5 cost time: 1.1770591735839844
Epoch: 5, Steps: 4 | Train Loss: 1.389 Vali Loss: 1.618 Vali Acc: 0.120 Test Loss: 1.618 Test Acc: 0.120
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2033610343933105
Epoch: 6, Steps: 4 | Train Loss: 1.318 Vali Loss: 1.608 Vali Acc: 0.100 Test Loss: 1.608 Test Acc: 0.100
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.1657531261444092
Epoch: 7, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.179984 --> -0.219984).  Saving model ...
Epoch: 8 cost time: 1.0538415908813477
Epoch: 8, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.626 Vali Acc: 0.160 Test Loss: 1.626 Test Acc: 0.160
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.1352157592773438
Epoch: 9, Steps: 4 | Train Loss: 1.108 Vali Loss: 1.651 Vali Acc: 0.180 Test Loss: 1.651 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.2567827701568604
Epoch: 10, Steps: 4 | Train Loss: 1.110 Vali Loss: 1.668 Vali Acc: 0.180 Test Loss: 1.668 Test Acc: 0.180
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.226025104522705
Epoch: 11, Steps: 4 | Train Loss: 0.974 Vali Loss: 1.708 Vali Acc: 0.220 Test Loss: 1.708 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1014540195465088
Epoch: 12, Steps: 4 | Train Loss: 0.952 Vali Loss: 1.772 Vali Acc: 0.200 Test Loss: 1.772 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.1139154434204102
Epoch: 13, Steps: 4 | Train Loss: 0.814 Vali Loss: 1.824 Vali Acc: 0.200 Test Loss: 1.824 Test Acc: 0.200
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 1.1491186618804932
Epoch: 14, Steps: 4 | Train Loss: 0.808 Vali Loss: 1.873 Vali Acc: 0.200 Test Loss: 1.873 Test Acc: 0.200
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.1855695247650146
Epoch: 15, Steps: 4 | Train Loss: 0.727 Vali Loss: 1.930 Vali Acc: 0.260 Test Loss: 1.930 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259981).  Saving model ...
Epoch: 16 cost time: 1.1286265850067139
Epoch: 16, Steps: 4 | Train Loss: 0.693 Vali Loss: 2.030 Vali Acc: 0.260 Test Loss: 2.030 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2977588176727295
Epoch: 17, Steps: 4 | Train Loss: 0.554 Vali Loss: 2.166 Vali Acc: 0.220 Test Loss: 2.166 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.1703381538391113
Epoch: 18, Steps: 4 | Train Loss: 0.456 Vali Loss: 2.360 Vali Acc: 0.220 Test Loss: 2.360 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3500962257385254
Epoch: 19, Steps: 4 | Train Loss: 0.502 Vali Loss: 2.494 Vali Acc: 0.220 Test Loss: 2.494 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.1585378646850586
Epoch: 20, Steps: 4 | Train Loss: 0.370 Vali Loss: 2.665 Vali Acc: 0.200 Test Loss: 2.665 Test Acc: 0.200
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2196788787841797
Epoch: 21, Steps: 4 | Train Loss: 0.436 Vali Loss: 2.775 Vali Acc: 0.220 Test Loss: 2.775 Test Acc: 0.220
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2371008396148682
Epoch: 22, Steps: 4 | Train Loss: 0.319 Vali Loss: 2.947 Vali Acc: 0.180 Test Loss: 2.947 Test Acc: 0.180
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.329028606414795
Epoch: 23, Steps: 4 | Train Loss: 0.452 Vali Loss: 3.022 Vali Acc: 0.240 Test Loss: 3.022 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.1013922691345215
Epoch: 24, Steps: 4 | Train Loss: 0.326 Vali Loss: 3.135 Vali Acc: 0.260 Test Loss: 3.135 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2393064498901367
Epoch: 25, Steps: 4 | Train Loss: 0.464 Vali Loss: 3.272 Vali Acc: 0.260 Test Loss: 3.272 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.26
model parameter : 397305
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.567509651184082
Epoch: 1, Steps: 4 | Train Loss: 1.667 Vali Loss: 1.635 Vali Acc: 0.200 Test Loss: 1.635 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.2799389362335205
Epoch: 2, Steps: 4 | Train Loss: 1.709 Vali Loss: 1.620 Vali Acc: 0.180 Test Loss: 1.620 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.3753788471221924
Epoch: 3, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.587 Vali Acc: 0.180 Test Loss: 1.587 Test Acc: 0.180
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.451880693435669
Epoch: 4, Steps: 4 | Train Loss: 1.551 Vali Loss: 1.579 Vali Acc: 0.160 Test Loss: 1.579 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.4599337577819824
Epoch: 5, Steps: 4 | Train Loss: 1.476 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 6 cost time: 1.4330418109893799
Epoch: 6, Steps: 4 | Train Loss: 1.340 Vali Loss: 1.569 Vali Acc: 0.260 Test Loss: 1.569 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2464020252227783
Epoch: 7, Steps: 4 | Train Loss: 1.267 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.3995602130889893
Epoch: 8, Steps: 4 | Train Loss: 1.293 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.4760537147521973
Epoch: 9, Steps: 4 | Train Loss: 1.169 Vali Loss: 1.583 Vali Acc: 0.240 Test Loss: 1.583 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.4159255027770996
Epoch: 10, Steps: 4 | Train Loss: 1.185 Vali Loss: 1.592 Vali Acc: 0.260 Test Loss: 1.592 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.416182041168213
Epoch: 11, Steps: 4 | Train Loss: 1.068 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3746347427368164
Epoch: 12, Steps: 4 | Train Loss: 1.033 Vali Loss: 1.679 Vali Acc: 0.280 Test Loss: 1.679 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.4861068725585938
Epoch: 13, Steps: 4 | Train Loss: 0.876 Vali Loss: 1.743 Vali Acc: 0.260 Test Loss: 1.743 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4373242855072021
Epoch: 14, Steps: 4 | Train Loss: 0.872 Vali Loss: 1.805 Vali Acc: 0.280 Test Loss: 1.805 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3206195831298828
Epoch: 15, Steps: 4 | Train Loss: 0.807 Vali Loss: 1.868 Vali Acc: 0.300 Test Loss: 1.868 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299981).  Saving model ...
Epoch: 16 cost time: 1.2998006343841553
Epoch: 16, Steps: 4 | Train Loss: 0.823 Vali Loss: 1.901 Vali Acc: 0.300 Test Loss: 1.901 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2086844444274902
Epoch: 17, Steps: 4 | Train Loss: 0.645 Vali Loss: 1.943 Vali Acc: 0.340 Test Loss: 1.943 Test Acc: 0.340
Validation loss decreased (-0.299981 --> -0.339981).  Saving model ...
Epoch: 18 cost time: 1.3542957305908203
Epoch: 18, Steps: 4 | Train Loss: 0.514 Vali Loss: 2.057 Vali Acc: 0.360 Test Loss: 2.057 Test Acc: 0.360
Validation loss decreased (-0.339981 --> -0.359979).  Saving model ...
Epoch: 19 cost time: 1.350900650024414
Epoch: 19, Steps: 4 | Train Loss: 0.563 Vali Loss: 2.099 Vali Acc: 0.340 Test Loss: 2.099 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.2443146705627441
Epoch: 20, Steps: 4 | Train Loss: 0.450 Vali Loss: 2.212 Vali Acc: 0.300 Test Loss: 2.212 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.3943936824798584
Epoch: 21, Steps: 4 | Train Loss: 0.562 Vali Loss: 2.258 Vali Acc: 0.300 Test Loss: 2.258 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.1139247417449951
Epoch: 22, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.289 Vali Acc: 0.320 Test Loss: 2.289 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.521303653717041
Epoch: 23, Steps: 4 | Train Loss: 0.529 Vali Loss: 2.364 Vali Acc: 0.320 Test Loss: 2.364 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.316284418106079
Epoch: 24, Steps: 4 | Train Loss: 0.375 Vali Loss: 2.445 Vali Acc: 0.340 Test Loss: 2.445 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.4464426040649414
Epoch: 25, Steps: 4 | Train Loss: 0.527 Vali Loss: 2.542 Vali Acc: 0.340 Test Loss: 2.542 Test Acc: 0.340
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.4187228679656982
Epoch: 26, Steps: 4 | Train Loss: 0.272 Vali Loss: 2.628 Vali Acc: 0.320 Test Loss: 2.628 Test Acc: 0.320
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.3665685653686523
Epoch: 27, Steps: 4 | Train Loss: 0.294 Vali Loss: 2.733 Vali Acc: 0.320 Test Loss: 2.733 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.3136842250823975
Epoch: 28, Steps: 4 | Train Loss: 0.536 Vali Loss: 2.842 Vali Acc: 0.360 Test Loss: 2.842 Test Acc: 0.360
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 397305
model size : 2.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.624180555343628
Epoch: 1, Steps: 4 | Train Loss: 1.719 Vali Loss: 1.589 Vali Acc: 0.180 Test Loss: 1.589 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.255807638168335
Epoch: 2, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.577 Vali Acc: 0.240 Test Loss: 1.577 Test Acc: 0.240
Validation loss decreased (-0.179984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.2697174549102783
Epoch: 3, Steps: 4 | Train Loss: 1.537 Vali Loss: 1.572 Vali Acc: 0.260 Test Loss: 1.572 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.2263035774230957
Epoch: 4, Steps: 4 | Train Loss: 1.374 Vali Loss: 1.579 Vali Acc: 0.180 Test Loss: 1.579 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.3939321041107178
Epoch: 5, Steps: 4 | Train Loss: 1.391 Vali Loss: 1.613 Vali Acc: 0.220 Test Loss: 1.613 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.561570644378662
Epoch: 6, Steps: 4 | Train Loss: 1.370 Vali Loss: 1.619 Vali Acc: 0.260 Test Loss: 1.619 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3248226642608643
Epoch: 7, Steps: 4 | Train Loss: 1.222 Vali Loss: 1.635 Vali Acc: 0.300 Test Loss: 1.635 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 8 cost time: 1.2338612079620361
Epoch: 8, Steps: 4 | Train Loss: 1.120 Vali Loss: 1.668 Vali Acc: 0.280 Test Loss: 1.668 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.3424828052520752
Epoch: 9, Steps: 4 | Train Loss: 0.946 Vali Loss: 1.697 Vali Acc: 0.220 Test Loss: 1.697 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.3655586242675781
Epoch: 10, Steps: 4 | Train Loss: 1.021 Vali Loss: 1.760 Vali Acc: 0.220 Test Loss: 1.760 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.2815704345703125
Epoch: 11, Steps: 4 | Train Loss: 1.113 Vali Loss: 1.819 Vali Acc: 0.220 Test Loss: 1.819 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.1424732208251953
Epoch: 12, Steps: 4 | Train Loss: 0.804 Vali Loss: 1.923 Vali Acc: 0.260 Test Loss: 1.923 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.0737473964691162
Epoch: 13, Steps: 4 | Train Loss: 0.927 Vali Loss: 2.051 Vali Acc: 0.260 Test Loss: 2.051 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.9825046062469482
Epoch: 14, Steps: 4 | Train Loss: 0.556 Vali Loss: 2.153 Vali Acc: 0.280 Test Loss: 2.153 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.3028554916381836
Epoch: 15, Steps: 4 | Train Loss: 0.641 Vali Loss: 2.266 Vali Acc: 0.240 Test Loss: 2.266 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 1.4771130084991455
Epoch: 16, Steps: 4 | Train Loss: 0.479 Vali Loss: 2.380 Vali Acc: 0.240 Test Loss: 2.380 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 1.235588550567627
Epoch: 17, Steps: 4 | Train Loss: 0.614 Vali Loss: 2.466 Vali Acc: 0.240 Test Loss: 2.466 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 331769
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.798680543899536
Epoch: 1, Steps: 4 | Train Loss: 1.738 Vali Loss: 1.600 Vali Acc: 0.200 Test Loss: 1.600 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.1546154022216797
Epoch: 2, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.589 Vali Acc: 0.280 Test Loss: 1.589 Test Acc: 0.280
Validation loss decreased (-0.199984 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.235921859741211
Epoch: 3, Steps: 4 | Train Loss: 1.554 Vali Loss: 1.576 Vali Acc: 0.320 Test Loss: 1.576 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 4 cost time: 1.168184757232666
Epoch: 4, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.571 Vali Acc: 0.200 Test Loss: 1.571 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2556779384613037
Epoch: 5, Steps: 4 | Train Loss: 1.403 Vali Loss: 1.587 Vali Acc: 0.160 Test Loss: 1.587 Test Acc: 0.160
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.3004777431488037
Epoch: 6, Steps: 4 | Train Loss: 1.383 Vali Loss: 1.601 Vali Acc: 0.260 Test Loss: 1.601 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.2927570343017578
Epoch: 7, Steps: 4 | Train Loss: 1.234 Vali Loss: 1.619 Vali Acc: 0.300 Test Loss: 1.619 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.252364158630371
Epoch: 8, Steps: 4 | Train Loss: 1.148 Vali Loss: 1.642 Vali Acc: 0.280 Test Loss: 1.642 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.2592039108276367
Epoch: 9, Steps: 4 | Train Loss: 0.958 Vali Loss: 1.702 Vali Acc: 0.240 Test Loss: 1.702 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.385920763015747
Epoch: 10, Steps: 4 | Train Loss: 1.070 Vali Loss: 1.741 Vali Acc: 0.220 Test Loss: 1.741 Test Acc: 0.220
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.2713792324066162
Epoch: 11, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.796 Vali Acc: 0.240 Test Loss: 1.796 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2528996467590332
Epoch: 12, Steps: 4 | Train Loss: 0.828 Vali Loss: 1.890 Vali Acc: 0.280 Test Loss: 1.890 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.2673418521881104
Epoch: 13, Steps: 4 | Train Loss: 0.958 Vali Loss: 1.975 Vali Acc: 0.280 Test Loss: 1.975 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 331769
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.533322811126709
Epoch: 1, Steps: 4 | Train Loss: 1.721 Vali Loss: 1.529 Vali Acc: 0.220 Test Loss: 1.529 Test Acc: 0.220
Validation loss decreased (inf --> -0.219985).  Saving model ...
Epoch: 2 cost time: 1.2275595664978027
Epoch: 2, Steps: 4 | Train Loss: 1.568 Vali Loss: 1.521 Vali Acc: 0.260 Test Loss: 1.521 Test Acc: 0.260
Validation loss decreased (-0.219985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.2090632915496826
Epoch: 3, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.520 Vali Acc: 0.280 Test Loss: 1.520 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.1974282264709473
Epoch: 4, Steps: 4 | Train Loss: 1.459 Vali Loss: 1.522 Vali Acc: 0.220 Test Loss: 1.522 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4608054161071777
Epoch: 5, Steps: 4 | Train Loss: 1.400 Vali Loss: 1.554 Vali Acc: 0.220 Test Loss: 1.554 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.4443209171295166
Epoch: 6, Steps: 4 | Train Loss: 1.385 Vali Loss: 1.574 Vali Acc: 0.220 Test Loss: 1.574 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3553683757781982
Epoch: 7, Steps: 4 | Train Loss: 1.266 Vali Loss: 1.590 Vali Acc: 0.260 Test Loss: 1.590 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.3837356567382812
Epoch: 8, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.610 Vali Acc: 0.300 Test Loss: 1.610 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299984).  Saving model ...
Epoch: 9 cost time: 1.3452692031860352
Epoch: 9, Steps: 4 | Train Loss: 0.992 Vali Loss: 1.629 Vali Acc: 0.280 Test Loss: 1.629 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3772978782653809
Epoch: 10, Steps: 4 | Train Loss: 1.107 Vali Loss: 1.684 Vali Acc: 0.300 Test Loss: 1.684 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6468846797943115
Epoch: 11, Steps: 4 | Train Loss: 1.164 Vali Loss: 1.723 Vali Acc: 0.220 Test Loss: 1.723 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.5625824928283691
Epoch: 12, Steps: 4 | Train Loss: 0.853 Vali Loss: 1.781 Vali Acc: 0.280 Test Loss: 1.781 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2787799835205078
Epoch: 13, Steps: 4 | Train Loss: 0.986 Vali Loss: 1.870 Vali Acc: 0.280 Test Loss: 1.870 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.3113608360290527
Epoch: 14, Steps: 4 | Train Loss: 0.623 Vali Loss: 1.977 Vali Acc: 0.300 Test Loss: 1.977 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.4963433742523193
Epoch: 15, Steps: 4 | Train Loss: 0.739 Vali Loss: 2.082 Vali Acc: 0.280 Test Loss: 2.082 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.5667636394500732
Epoch: 16, Steps: 4 | Train Loss: 0.542 Vali Loss: 2.155 Vali Acc: 0.220 Test Loss: 2.155 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.4584314823150635
Epoch: 17, Steps: 4 | Train Loss: 0.694 Vali Loss: 2.278 Vali Acc: 0.220 Test Loss: 2.278 Test Acc: 0.220
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.3328273296356201
Epoch: 18, Steps: 4 | Train Loss: 0.456 Vali Loss: 2.490 Vali Acc: 0.220 Test Loss: 2.490 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 331769
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.7395753860473633
Epoch: 1, Steps: 4 | Train Loss: 1.769 Vali Loss: 1.583 Vali Acc: 0.200 Test Loss: 1.583 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.254242181777954
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.567 Vali Acc: 0.220 Test Loss: 1.567 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.1452584266662598
Epoch: 3, Steps: 4 | Train Loss: 1.563 Vali Loss: 1.549 Vali Acc: 0.260 Test Loss: 1.549 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259985).  Saving model ...
Epoch: 4 cost time: 1.1242129802703857
Epoch: 4, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.535 Vali Acc: 0.280 Test Loss: 1.535 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 5 cost time: 1.314450979232788
Epoch: 5, Steps: 4 | Train Loss: 1.450 Vali Loss: 1.516 Vali Acc: 0.300 Test Loss: 1.516 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.1840670108795166
Epoch: 6, Steps: 4 | Train Loss: 1.423 Vali Loss: 1.527 Vali Acc: 0.260 Test Loss: 1.527 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2460405826568604
Epoch: 7, Steps: 4 | Train Loss: 1.330 Vali Loss: 1.539 Vali Acc: 0.220 Test Loss: 1.539 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.260087251663208
Epoch: 8, Steps: 4 | Train Loss: 1.250 Vali Loss: 1.551 Vali Acc: 0.280 Test Loss: 1.551 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2711434364318848
Epoch: 9, Steps: 4 | Train Loss: 1.092 Vali Loss: 1.562 Vali Acc: 0.320 Test Loss: 1.562 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319984).  Saving model ...
Epoch: 10 cost time: 1.3163540363311768
Epoch: 10, Steps: 4 | Train Loss: 1.257 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.1457152366638184
Epoch: 11, Steps: 4 | Train Loss: 1.254 Vali Loss: 1.597 Vali Acc: 0.260 Test Loss: 1.597 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.4369111061096191
Epoch: 12, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.2639985084533691
Epoch: 13, Steps: 4 | Train Loss: 1.090 Vali Loss: 1.679 Vali Acc: 0.300 Test Loss: 1.679 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2310054302215576
Epoch: 14, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.700 Vali Acc: 0.280 Test Loss: 1.700 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.146941900253296
Epoch: 15, Steps: 4 | Train Loss: 0.834 Vali Loss: 1.739 Vali Acc: 0.300 Test Loss: 1.739 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.2108075618743896
Epoch: 16, Steps: 4 | Train Loss: 0.649 Vali Loss: 1.739 Vali Acc: 0.260 Test Loss: 1.739 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.1981010437011719
Epoch: 17, Steps: 4 | Train Loss: 0.829 Vali Loss: 1.778 Vali Acc: 0.280 Test Loss: 1.778 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.3044781684875488
Epoch: 18, Steps: 4 | Train Loss: 0.559 Vali Loss: 1.840 Vali Acc: 0.320 Test Loss: 1.840 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 1.2289996147155762
Epoch: 19, Steps: 4 | Train Loss: 0.781 Vali Loss: 1.912 Vali Acc: 0.320 Test Loss: 1.912 Test Acc: 0.320
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 331769
model size : 1.89MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9209043979644775
Epoch: 1, Steps: 4 | Train Loss: 1.714 Vali Loss: 1.676 Vali Acc: 0.220 Test Loss: 1.676 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.4350569248199463
Epoch: 2, Steps: 4 | Train Loss: 1.604 Vali Loss: 1.665 Vali Acc: 0.320 Test Loss: 1.665 Test Acc: 0.320
Validation loss decreased (-0.219983 --> -0.319983).  Saving model ...
Epoch: 3 cost time: 1.1059956550598145
Epoch: 3, Steps: 4 | Train Loss: 1.582 Vali Loss: 1.669 Vali Acc: 0.320 Test Loss: 1.669 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0784292221069336
Epoch: 4, Steps: 4 | Train Loss: 1.470 Vali Loss: 1.652 Vali Acc: 0.320 Test Loss: 1.652 Test Acc: 0.320
Validation loss decreased (-0.319983 --> -0.319983).  Saving model ...
Epoch: 5 cost time: 1.286527156829834
Epoch: 5, Steps: 4 | Train Loss: 1.331 Vali Loss: 1.635 Vali Acc: 0.300 Test Loss: 1.635 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.4415762424468994
Epoch: 6, Steps: 4 | Train Loss: 1.439 Vali Loss: 1.615 Vali Acc: 0.300 Test Loss: 1.615 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.2259280681610107
Epoch: 7, Steps: 4 | Train Loss: 1.196 Vali Loss: 1.640 Vali Acc: 0.280 Test Loss: 1.640 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.1944470405578613
Epoch: 8, Steps: 4 | Train Loss: 1.115 Vali Loss: 1.664 Vali Acc: 0.260 Test Loss: 1.664 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 1.2549920082092285
Epoch: 9, Steps: 4 | Train Loss: 0.942 Vali Loss: 1.699 Vali Acc: 0.320 Test Loss: 1.699 Test Acc: 0.320
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.141599178314209
Epoch: 10, Steps: 4 | Train Loss: 1.083 Vali Loss: 1.739 Vali Acc: 0.280 Test Loss: 1.739 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.2383041381835938
Epoch: 11, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.800 Vali Acc: 0.300 Test Loss: 1.800 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.2673871517181396
Epoch: 12, Steps: 4 | Train Loss: 0.841 Vali Loss: 1.880 Vali Acc: 0.280 Test Loss: 1.880 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 1.0952370166778564
Epoch: 13, Steps: 4 | Train Loss: 0.717 Vali Loss: 1.975 Vali Acc: 0.300 Test Loss: 1.975 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 1.2307767868041992
Epoch: 14, Steps: 4 | Train Loss: 0.556 Vali Loss: 2.062 Vali Acc: 0.300 Test Loss: 2.062 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 299001
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3609611988067627
Epoch: 1, Steps: 4 | Train Loss: 1.693 Vali Loss: 1.660 Vali Acc: 0.220 Test Loss: 1.660 Test Acc: 0.220
Validation loss decreased (inf --> -0.219983).  Saving model ...
Epoch: 2 cost time: 1.0764248371124268
Epoch: 2, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.661 Vali Acc: 0.220 Test Loss: 1.661 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1521522998809814
Epoch: 3, Steps: 4 | Train Loss: 1.577 Vali Loss: 1.648 Vali Acc: 0.200 Test Loss: 1.648 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.138791561126709
Epoch: 4, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.653 Vali Acc: 0.220 Test Loss: 1.653 Test Acc: 0.220
Validation loss decreased (-0.219983 --> -0.219983).  Saving model ...
Epoch: 5 cost time: 1.286161184310913
Epoch: 5, Steps: 4 | Train Loss: 1.335 Vali Loss: 1.618 Vali Acc: 0.300 Test Loss: 1.618 Test Acc: 0.300
Validation loss decreased (-0.219983 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.442732334136963
Epoch: 6, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.591 Vali Acc: 0.200 Test Loss: 1.591 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.305793046951294
Epoch: 7, Steps: 4 | Train Loss: 1.208 Vali Loss: 1.611 Vali Acc: 0.260 Test Loss: 1.611 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.429293155670166
Epoch: 8, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.618 Vali Acc: 0.260 Test Loss: 1.618 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.5176467895507812
Epoch: 9, Steps: 4 | Train Loss: 0.975 Vali Loss: 1.661 Vali Acc: 0.260 Test Loss: 1.661 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3343217372894287
Epoch: 10, Steps: 4 | Train Loss: 1.103 Vali Loss: 1.721 Vali Acc: 0.300 Test Loss: 1.721 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.3648972511291504
Epoch: 11, Steps: 4 | Train Loss: 0.954 Vali Loss: 1.804 Vali Acc: 0.280 Test Loss: 1.804 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.352733850479126
Epoch: 12, Steps: 4 | Train Loss: 0.883 Vali Loss: 1.881 Vali Acc: 0.240 Test Loss: 1.881 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.5647718906402588
Epoch: 13, Steps: 4 | Train Loss: 0.740 Vali Loss: 1.999 Vali Acc: 0.260 Test Loss: 1.999 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.4110596179962158
Epoch: 14, Steps: 4 | Train Loss: 0.587 Vali Loss: 2.070 Vali Acc: 0.280 Test Loss: 2.070 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.5220561027526855
Epoch: 15, Steps: 4 | Train Loss: 0.722 Vali Loss: 2.157 Vali Acc: 0.280 Test Loss: 2.157 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 299001
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3719613552093506
Epoch: 1, Steps: 4 | Train Loss: 1.682 Vali Loss: 1.639 Vali Acc: 0.200 Test Loss: 1.639 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.119823932647705
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.628 Vali Acc: 0.220 Test Loss: 1.628 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.264214277267456
Epoch: 3, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.639 Vali Acc: 0.200 Test Loss: 1.639 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.0189788341522217
Epoch: 4, Steps: 4 | Train Loss: 1.500 Vali Loss: 1.642 Vali Acc: 0.240 Test Loss: 1.642 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.1956050395965576
Epoch: 5, Steps: 4 | Train Loss: 1.346 Vali Loss: 1.614 Vali Acc: 0.240 Test Loss: 1.614 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.2081258296966553
Epoch: 6, Steps: 4 | Train Loss: 1.454 Vali Loss: 1.615 Vali Acc: 0.240 Test Loss: 1.615 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1966922283172607
Epoch: 7, Steps: 4 | Train Loss: 1.251 Vali Loss: 1.623 Vali Acc: 0.240 Test Loss: 1.623 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1977002620697021
Epoch: 8, Steps: 4 | Train Loss: 1.223 Vali Loss: 1.631 Vali Acc: 0.240 Test Loss: 1.631 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.1609611511230469
Epoch: 9, Steps: 4 | Train Loss: 1.011 Vali Loss: 1.654 Vali Acc: 0.260 Test Loss: 1.654 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259983).  Saving model ...
Epoch: 10 cost time: 1.1734857559204102
Epoch: 10, Steps: 4 | Train Loss: 1.155 Vali Loss: 1.713 Vali Acc: 0.320 Test Loss: 1.713 Test Acc: 0.320
Validation loss decreased (-0.259983 --> -0.319983).  Saving model ...
Epoch: 11 cost time: 1.1790807247161865
Epoch: 11, Steps: 4 | Train Loss: 0.990 Vali Loss: 1.777 Vali Acc: 0.240 Test Loss: 1.777 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.259714126586914
Epoch: 12, Steps: 4 | Train Loss: 0.971 Vali Loss: 1.834 Vali Acc: 0.240 Test Loss: 1.834 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.3072474002838135
Epoch: 13, Steps: 4 | Train Loss: 0.789 Vali Loss: 1.929 Vali Acc: 0.240 Test Loss: 1.929 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.4509921073913574
Epoch: 14, Steps: 4 | Train Loss: 0.628 Vali Loss: 2.013 Vali Acc: 0.260 Test Loss: 2.013 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.0312447547912598
Epoch: 15, Steps: 4 | Train Loss: 0.789 Vali Loss: 2.064 Vali Acc: 0.240 Test Loss: 2.064 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.2074565887451172
Epoch: 16, Steps: 4 | Train Loss: 0.731 Vali Loss: 2.134 Vali Acc: 0.280 Test Loss: 2.134 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.3273332118988037
Epoch: 17, Steps: 4 | Train Loss: 0.497 Vali Loss: 2.218 Vali Acc: 0.300 Test Loss: 2.218 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.333097219467163
Epoch: 18, Steps: 4 | Train Loss: 0.525 Vali Loss: 2.358 Vali Acc: 0.260 Test Loss: 2.358 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.2443809509277344
Epoch: 19, Steps: 4 | Train Loss: 0.648 Vali Loss: 2.519 Vali Acc: 0.280 Test Loss: 2.519 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.2747421264648438
Epoch: 20, Steps: 4 | Train Loss: 0.422 Vali Loss: 2.661 Vali Acc: 0.280 Test Loss: 2.661 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 299001
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3800437450408936
Epoch: 1, Steps: 4 | Train Loss: 1.653 Vali Loss: 1.635 Vali Acc: 0.120 Test Loss: 1.635 Test Acc: 0.120
Validation loss decreased (inf --> -0.119984).  Saving model ...
Epoch: 2 cost time: 1.043428659439087
Epoch: 2, Steps: 4 | Train Loss: 1.611 Vali Loss: 1.629 Vali Acc: 0.140 Test Loss: 1.629 Test Acc: 0.140
Validation loss decreased (-0.119984 --> -0.139984).  Saving model ...
Epoch: 3 cost time: 1.143592119216919
Epoch: 3, Steps: 4 | Train Loss: 1.608 Vali Loss: 1.626 Vali Acc: 0.220 Test Loss: 1.626 Test Acc: 0.220
Validation loss decreased (-0.139984 --> -0.219984).  Saving model ...
Epoch: 4 cost time: 1.0348858833312988
Epoch: 4, Steps: 4 | Train Loss: 1.523 Vali Loss: 1.625 Vali Acc: 0.180 Test Loss: 1.625 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1379287242889404
Epoch: 5, Steps: 4 | Train Loss: 1.404 Vali Loss: 1.614 Vali Acc: 0.220 Test Loss: 1.614 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 6 cost time: 1.1824851036071777
Epoch: 6, Steps: 4 | Train Loss: 1.485 Vali Loss: 1.620 Vali Acc: 0.220 Test Loss: 1.620 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2833032608032227
Epoch: 7, Steps: 4 | Train Loss: 1.331 Vali Loss: 1.615 Vali Acc: 0.200 Test Loss: 1.615 Test Acc: 0.200
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1749844551086426
Epoch: 8, Steps: 4 | Train Loss: 1.297 Vali Loss: 1.607 Vali Acc: 0.220 Test Loss: 1.607 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 9 cost time: 1.3436670303344727
Epoch: 9, Steps: 4 | Train Loss: 1.091 Vali Loss: 1.606 Vali Acc: 0.260 Test Loss: 1.606 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 10 cost time: 1.0851845741271973
Epoch: 10, Steps: 4 | Train Loss: 1.214 Vali Loss: 1.622 Vali Acc: 0.300 Test Loss: 1.622 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 11 cost time: 1.2498440742492676
Epoch: 11, Steps: 4 | Train Loss: 1.034 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.1562373638153076
Epoch: 12, Steps: 4 | Train Loss: 1.036 Vali Loss: 1.681 Vali Acc: 0.280 Test Loss: 1.681 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0791094303131104
Epoch: 13, Steps: 4 | Train Loss: 0.876 Vali Loss: 1.717 Vali Acc: 0.300 Test Loss: 1.717 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2696998119354248
Epoch: 14, Steps: 4 | Train Loss: 0.704 Vali Loss: 1.765 Vali Acc: 0.300 Test Loss: 1.765 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.3169760704040527
Epoch: 15, Steps: 4 | Train Loss: 0.905 Vali Loss: 1.816 Vali Acc: 0.280 Test Loss: 1.816 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.3382172584533691
Epoch: 16, Steps: 4 | Train Loss: 0.815 Vali Loss: 1.870 Vali Acc: 0.280 Test Loss: 1.870 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.1601519584655762
Epoch: 17, Steps: 4 | Train Loss: 0.622 Vali Loss: 1.926 Vali Acc: 0.300 Test Loss: 1.926 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.2466535568237305
Epoch: 18, Steps: 4 | Train Loss: 0.599 Vali Loss: 2.019 Vali Acc: 0.300 Test Loss: 2.019 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.5061571598052979
Epoch: 19, Steps: 4 | Train Loss: 0.712 Vali Loss: 2.042 Vali Acc: 0.280 Test Loss: 2.042 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.3300752639770508
Epoch: 20, Steps: 4 | Train Loss: 0.499 Vali Loss: 2.081 Vali Acc: 0.280 Test Loss: 2.081 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 299001
model size : 1.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.005505323410034
Epoch: 1, Steps: 4 | Train Loss: 1.631 Vali Loss: 1.584 Vali Acc: 0.240 Test Loss: 1.584 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.1158337593078613
Epoch: 2, Steps: 4 | Train Loss: 1.591 Vali Loss: 1.580 Vali Acc: 0.240 Test Loss: 1.580 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 3 cost time: 1.0947375297546387
Epoch: 3, Steps: 4 | Train Loss: 1.516 Vali Loss: 1.566 Vali Acc: 0.240 Test Loss: 1.566 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 4 cost time: 1.1285250186920166
Epoch: 4, Steps: 4 | Train Loss: 1.483 Vali Loss: 1.572 Vali Acc: 0.220 Test Loss: 1.572 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.0613250732421875
Epoch: 5, Steps: 4 | Train Loss: 1.440 Vali Loss: 1.573 Vali Acc: 0.300 Test Loss: 1.573 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.1271462440490723
Epoch: 6, Steps: 4 | Train Loss: 1.350 Vali Loss: 1.574 Vali Acc: 0.280 Test Loss: 1.574 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0510146617889404
Epoch: 7, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.595 Vali Acc: 0.260 Test Loss: 1.595 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1549668312072754
Epoch: 8, Steps: 4 | Train Loss: 1.208 Vali Loss: 1.645 Vali Acc: 0.260 Test Loss: 1.645 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.18397855758667
Epoch: 9, Steps: 4 | Train Loss: 1.039 Vali Loss: 1.702 Vali Acc: 0.260 Test Loss: 1.702 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2709484100341797
Epoch: 10, Steps: 4 | Train Loss: 0.953 Vali Loss: 1.734 Vali Acc: 0.240 Test Loss: 1.734 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1610052585601807
Epoch: 11, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.806 Vali Acc: 0.240 Test Loss: 1.806 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3265714645385742
Epoch: 12, Steps: 4 | Train Loss: 0.851 Vali Loss: 1.879 Vali Acc: 0.240 Test Loss: 1.879 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1237232685089111
Epoch: 13, Steps: 4 | Train Loss: 0.910 Vali Loss: 1.959 Vali Acc: 0.260 Test Loss: 1.959 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.1831700801849365
Epoch: 14, Steps: 4 | Train Loss: 0.734 Vali Loss: 2.063 Vali Acc: 0.240 Test Loss: 2.063 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.139366865158081
Epoch: 15, Steps: 4 | Train Loss: 0.611 Vali Loss: 2.157 Vali Acc: 0.220 Test Loss: 2.157 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 282617
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.458364725112915
Epoch: 1, Steps: 4 | Train Loss: 1.713 Vali Loss: 1.621 Vali Acc: 0.200 Test Loss: 1.621 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.3063914775848389
Epoch: 2, Steps: 4 | Train Loss: 1.614 Vali Loss: 1.600 Vali Acc: 0.220 Test Loss: 1.600 Test Acc: 0.220
Validation loss decreased (-0.199984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.1722769737243652
Epoch: 3, Steps: 4 | Train Loss: 1.538 Vali Loss: 1.573 Vali Acc: 0.260 Test Loss: 1.573 Test Acc: 0.260
Validation loss decreased (-0.219984 --> -0.259984).  Saving model ...
Epoch: 4 cost time: 1.1652331352233887
Epoch: 4, Steps: 4 | Train Loss: 1.495 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 1.1908106803894043
Epoch: 5, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.556 Vali Acc: 0.300 Test Loss: 1.556 Test Acc: 0.300
Validation loss decreased (-0.299984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.0643491744995117
Epoch: 6, Steps: 4 | Train Loss: 1.370 Vali Loss: 1.576 Vali Acc: 0.300 Test Loss: 1.576 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.1388065814971924
Epoch: 7, Steps: 4 | Train Loss: 1.188 Vali Loss: 1.614 Vali Acc: 0.260 Test Loss: 1.614 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.0804944038391113
Epoch: 8, Steps: 4 | Train Loss: 1.242 Vali Loss: 1.647 Vali Acc: 0.260 Test Loss: 1.647 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0450901985168457
Epoch: 9, Steps: 4 | Train Loss: 1.056 Vali Loss: 1.708 Vali Acc: 0.240 Test Loss: 1.708 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1055030822753906
Epoch: 10, Steps: 4 | Train Loss: 0.970 Vali Loss: 1.765 Vali Acc: 0.240 Test Loss: 1.765 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.1866731643676758
Epoch: 11, Steps: 4 | Train Loss: 0.923 Vali Loss: 1.806 Vali Acc: 0.260 Test Loss: 1.806 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.1269805431365967
Epoch: 12, Steps: 4 | Train Loss: 0.892 Vali Loss: 1.906 Vali Acc: 0.260 Test Loss: 1.906 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.0181121826171875
Epoch: 13, Steps: 4 | Train Loss: 0.947 Vali Loss: 1.986 Vali Acc: 0.260 Test Loss: 1.986 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.119307279586792
Epoch: 14, Steps: 4 | Train Loss: 0.769 Vali Loss: 2.074 Vali Acc: 0.260 Test Loss: 2.074 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.0867974758148193
Epoch: 15, Steps: 4 | Train Loss: 0.631 Vali Loss: 2.188 Vali Acc: 0.260 Test Loss: 2.188 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 282617
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.4863598346710205
Epoch: 1, Steps: 4 | Train Loss: 1.750 Vali Loss: 1.638 Vali Acc: 0.200 Test Loss: 1.638 Test Acc: 0.200
Validation loss decreased (inf --> -0.199984).  Saving model ...
Epoch: 2 cost time: 1.229668378829956
Epoch: 2, Steps: 4 | Train Loss: 1.618 Vali Loss: 1.628 Vali Acc: 0.180 Test Loss: 1.628 Test Acc: 0.180
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1830017566680908
Epoch: 3, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.601 Vali Acc: 0.120 Test Loss: 1.601 Test Acc: 0.120
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 1.2060482501983643
Epoch: 4, Steps: 4 | Train Loss: 1.512 Vali Loss: 1.596 Vali Acc: 0.160 Test Loss: 1.596 Test Acc: 0.160
EarlyStopping counter: 3 out of 10
Epoch: 5 cost time: 1.0986580848693848
Epoch: 5, Steps: 4 | Train Loss: 1.444 Vali Loss: 1.586 Vali Acc: 0.240 Test Loss: 1.586 Test Acc: 0.240
Validation loss decreased (-0.199984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.2768526077270508
Epoch: 6, Steps: 4 | Train Loss: 1.367 Vali Loss: 1.590 Vali Acc: 0.220 Test Loss: 1.590 Test Acc: 0.220
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2672929763793945
Epoch: 7, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.596 Vali Acc: 0.220 Test Loss: 1.596 Test Acc: 0.220
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2919683456420898
Epoch: 8, Steps: 4 | Train Loss: 1.267 Vali Loss: 1.621 Vali Acc: 0.200 Test Loss: 1.621 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.543466329574585
Epoch: 9, Steps: 4 | Train Loss: 1.085 Vali Loss: 1.673 Vali Acc: 0.220 Test Loss: 1.673 Test Acc: 0.220
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.154646635055542
Epoch: 10, Steps: 4 | Train Loss: 1.001 Vali Loss: 1.734 Vali Acc: 0.220 Test Loss: 1.734 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2898633480072021
Epoch: 11, Steps: 4 | Train Loss: 0.982 Vali Loss: 1.790 Vali Acc: 0.300 Test Loss: 1.790 Test Acc: 0.300
Validation loss decreased (-0.239984 --> -0.299982).  Saving model ...
Epoch: 12 cost time: 1.2655205726623535
Epoch: 12, Steps: 4 | Train Loss: 0.932 Vali Loss: 1.837 Vali Acc: 0.300 Test Loss: 1.837 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.1420226097106934
Epoch: 13, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.923 Vali Acc: 0.280 Test Loss: 1.923 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.2183163166046143
Epoch: 14, Steps: 4 | Train Loss: 0.807 Vali Loss: 2.016 Vali Acc: 0.280 Test Loss: 2.016 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.4794092178344727
Epoch: 15, Steps: 4 | Train Loss: 0.682 Vali Loss: 2.090 Vali Acc: 0.260 Test Loss: 2.090 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.1806385517120361
Epoch: 16, Steps: 4 | Train Loss: 0.628 Vali Loss: 2.156 Vali Acc: 0.260 Test Loss: 2.156 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.2737324237823486
Epoch: 17, Steps: 4 | Train Loss: 0.551 Vali Loss: 2.276 Vali Acc: 0.240 Test Loss: 2.276 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.5744562149047852
Epoch: 18, Steps: 4 | Train Loss: 0.453 Vali Loss: 2.434 Vali Acc: 0.240 Test Loss: 2.434 Test Acc: 0.240
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.4839396476745605
Epoch: 19, Steps: 4 | Train Loss: 0.400 Vali Loss: 2.697 Vali Acc: 0.240 Test Loss: 2.697 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.4130232334136963
Epoch: 20, Steps: 4 | Train Loss: 0.469 Vali Loss: 2.886 Vali Acc: 0.240 Test Loss: 2.886 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.3933689594268799
Epoch: 21, Steps: 4 | Train Loss: 0.348 Vali Loss: 2.996 Vali Acc: 0.240 Test Loss: 2.996 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 282617
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.478726625442505
Epoch: 1, Steps: 4 | Train Loss: 1.586 Vali Loss: 1.641 Vali Acc: 0.180 Test Loss: 1.641 Test Acc: 0.180
Validation loss decreased (inf --> -0.179984).  Saving model ...
Epoch: 2 cost time: 1.2093415260314941
Epoch: 2, Steps: 4 | Train Loss: 1.615 Vali Loss: 1.630 Vali Acc: 0.200 Test Loss: 1.630 Test Acc: 0.200
Validation loss decreased (-0.179984 --> -0.199984).  Saving model ...
Epoch: 3 cost time: 1.2461042404174805
Epoch: 3, Steps: 4 | Train Loss: 1.542 Vali Loss: 1.614 Vali Acc: 0.140 Test Loss: 1.614 Test Acc: 0.140
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.4042131900787354
Epoch: 4, Steps: 4 | Train Loss: 1.540 Vali Loss: 1.591 Vali Acc: 0.260 Test Loss: 1.591 Test Acc: 0.260
Validation loss decreased (-0.199984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.1891167163848877
Epoch: 5, Steps: 4 | Train Loss: 1.487 Vali Loss: 1.574 Vali Acc: 0.300 Test Loss: 1.574 Test Acc: 0.300
Validation loss decreased (-0.259984 --> -0.299984).  Saving model ...
Epoch: 6 cost time: 1.2060096263885498
Epoch: 6, Steps: 4 | Train Loss: 1.433 Vali Loss: 1.567 Vali Acc: 0.240 Test Loss: 1.567 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.0571925640106201
Epoch: 7, Steps: 4 | Train Loss: 1.262 Vali Loss: 1.578 Vali Acc: 0.260 Test Loss: 1.578 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.4025084972381592
Epoch: 8, Steps: 4 | Train Loss: 1.347 Vali Loss: 1.580 Vali Acc: 0.200 Test Loss: 1.580 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.297086238861084
Epoch: 9, Steps: 4 | Train Loss: 1.194 Vali Loss: 1.591 Vali Acc: 0.240 Test Loss: 1.591 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.2058227062225342
Epoch: 10, Steps: 4 | Train Loss: 1.080 Vali Loss: 1.595 Vali Acc: 0.260 Test Loss: 1.595 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.0933079719543457
Epoch: 11, Steps: 4 | Train Loss: 1.054 Vali Loss: 1.611 Vali Acc: 0.240 Test Loss: 1.611 Test Acc: 0.240
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3028337955474854
Epoch: 12, Steps: 4 | Train Loss: 1.015 Vali Loss: 1.634 Vali Acc: 0.260 Test Loss: 1.634 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.2027215957641602
Epoch: 13, Steps: 4 | Train Loss: 1.058 Vali Loss: 1.687 Vali Acc: 0.280 Test Loss: 1.687 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2611243724822998
Epoch: 14, Steps: 4 | Train Loss: 0.894 Vali Loss: 1.725 Vali Acc: 0.280 Test Loss: 1.725 Test Acc: 0.280
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.2135107517242432
Epoch: 15, Steps: 4 | Train Loss: 0.748 Vali Loss: 1.757 Vali Acc: 0.280 Test Loss: 1.757 Test Acc: 0.280
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 282617
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3665895462036133
Epoch: 1, Steps: 4 | Train Loss: 1.648 Vali Loss: 1.553 Vali Acc: 0.280 Test Loss: 1.553 Test Acc: 0.280
Validation loss decreased (inf --> -0.279984).  Saving model ...
Epoch: 2 cost time: 1.1711041927337646
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.560 Vali Acc: 0.320 Test Loss: 1.560 Test Acc: 0.320
Validation loss decreased (-0.279984 --> -0.319984).  Saving model ...
Epoch: 3 cost time: 1.155949354171753
Epoch: 3, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.565 Vali Acc: 0.280 Test Loss: 1.565 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.204761028289795
Epoch: 4, Steps: 4 | Train Loss: 1.460 Vali Loss: 1.569 Vali Acc: 0.280 Test Loss: 1.569 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.3167810440063477
Epoch: 5, Steps: 4 | Train Loss: 1.416 Vali Loss: 1.538 Vali Acc: 0.300 Test Loss: 1.538 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.3371553421020508
Epoch: 6, Steps: 4 | Train Loss: 1.338 Vali Loss: 1.524 Vali Acc: 0.320 Test Loss: 1.524 Test Acc: 0.320
Validation loss decreased (-0.319984 --> -0.319985).  Saving model ...
Epoch: 7 cost time: 1.3695800304412842
Epoch: 7, Steps: 4 | Train Loss: 1.163 Vali Loss: 1.539 Vali Acc: 0.320 Test Loss: 1.539 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.0652015209197998
Epoch: 8, Steps: 4 | Train Loss: 1.135 Vali Loss: 1.566 Vali Acc: 0.280 Test Loss: 1.566 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.1758100986480713
Epoch: 9, Steps: 4 | Train Loss: 1.037 Vali Loss: 1.598 Vali Acc: 0.280 Test Loss: 1.598 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.2547571659088135
Epoch: 10, Steps: 4 | Train Loss: 0.989 Vali Loss: 1.654 Vali Acc: 0.280 Test Loss: 1.654 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.192633867263794
Epoch: 11, Steps: 4 | Train Loss: 0.876 Vali Loss: 1.738 Vali Acc: 0.260 Test Loss: 1.738 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.2589669227600098
Epoch: 12, Steps: 4 | Train Loss: 0.828 Vali Loss: 1.796 Vali Acc: 0.280 Test Loss: 1.796 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.2891619205474854
Epoch: 13, Steps: 4 | Train Loss: 0.755 Vali Loss: 1.877 Vali Acc: 0.260 Test Loss: 1.877 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.295860767364502
Epoch: 14, Steps: 4 | Train Loss: 0.719 Vali Loss: 1.931 Vali Acc: 0.220 Test Loss: 1.931 Test Acc: 0.220
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.39603853225708
Epoch: 15, Steps: 4 | Train Loss: 0.510 Vali Loss: 2.022 Vali Acc: 0.260 Test Loss: 2.022 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.2052536010742188
Epoch: 16, Steps: 4 | Train Loss: 0.620 Vali Loss: 2.159 Vali Acc: 0.240 Test Loss: 2.159 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 274425
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3923377990722656
Epoch: 1, Steps: 4 | Train Loss: 1.662 Vali Loss: 1.563 Vali Acc: 0.260 Test Loss: 1.563 Test Acc: 0.260
Validation loss decreased (inf --> -0.259984).  Saving model ...
Epoch: 2 cost time: 1.1133015155792236
Epoch: 2, Steps: 4 | Train Loss: 1.584 Vali Loss: 1.563 Vali Acc: 0.260 Test Loss: 1.563 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1536564826965332
Epoch: 3, Steps: 4 | Train Loss: 1.549 Vali Loss: 1.565 Vali Acc: 0.280 Test Loss: 1.565 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 4 cost time: 1.0986251831054688
Epoch: 4, Steps: 4 | Train Loss: 1.473 Vali Loss: 1.580 Vali Acc: 0.280 Test Loss: 1.580 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.1298954486846924
Epoch: 5, Steps: 4 | Train Loss: 1.449 Vali Loss: 1.572 Vali Acc: 0.280 Test Loss: 1.572 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.1883559226989746
Epoch: 6, Steps: 4 | Train Loss: 1.353 Vali Loss: 1.568 Vali Acc: 0.300 Test Loss: 1.568 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 7 cost time: 1.2269830703735352
Epoch: 7, Steps: 4 | Train Loss: 1.179 Vali Loss: 1.586 Vali Acc: 0.260 Test Loss: 1.586 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.348050594329834
Epoch: 8, Steps: 4 | Train Loss: 1.161 Vali Loss: 1.630 Vali Acc: 0.260 Test Loss: 1.630 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.2418022155761719
Epoch: 9, Steps: 4 | Train Loss: 1.066 Vali Loss: 1.665 Vali Acc: 0.300 Test Loss: 1.665 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.3234500885009766
Epoch: 10, Steps: 4 | Train Loss: 1.004 Vali Loss: 1.691 Vali Acc: 0.300 Test Loss: 1.691 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 1.3930447101593018
Epoch: 11, Steps: 4 | Train Loss: 0.899 Vali Loss: 1.778 Vali Acc: 0.280 Test Loss: 1.778 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 1.1680786609649658
Epoch: 12, Steps: 4 | Train Loss: 0.866 Vali Loss: 1.824 Vali Acc: 0.280 Test Loss: 1.824 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 1.1652634143829346
Epoch: 13, Steps: 4 | Train Loss: 0.788 Vali Loss: 1.911 Vali Acc: 0.280 Test Loss: 1.911 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 1.2344646453857422
Epoch: 14, Steps: 4 | Train Loss: 0.740 Vali Loss: 2.001 Vali Acc: 0.260 Test Loss: 2.001 Test Acc: 0.260
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 1.1102328300476074
Epoch: 15, Steps: 4 | Train Loss: 0.532 Vali Loss: 2.096 Vali Acc: 0.240 Test Loss: 2.096 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 1.117084264755249
Epoch: 16, Steps: 4 | Train Loss: 0.647 Vali Loss: 2.218 Vali Acc: 0.220 Test Loss: 2.218 Test Acc: 0.220
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.3
model parameter : 274425
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.520317316055298
Epoch: 1, Steps: 4 | Train Loss: 1.643 Vali Loss: 1.604 Vali Acc: 0.220 Test Loss: 1.604 Test Acc: 0.220
Validation loss decreased (inf --> -0.219984).  Saving model ...
Epoch: 2 cost time: 1.0217723846435547
Epoch: 2, Steps: 4 | Train Loss: 1.590 Vali Loss: 1.604 Vali Acc: 0.220 Test Loss: 1.604 Test Acc: 0.220
Validation loss decreased (-0.219984 --> -0.219984).  Saving model ...
Epoch: 3 cost time: 1.2007923126220703
Epoch: 3, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.618 Vali Acc: 0.200 Test Loss: 1.618 Test Acc: 0.200
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.2368426322937012
Epoch: 4, Steps: 4 | Train Loss: 1.469 Vali Loss: 1.644 Vali Acc: 0.240 Test Loss: 1.644 Test Acc: 0.240
Validation loss decreased (-0.219984 --> -0.239984).  Saving model ...
Epoch: 5 cost time: 1.2457399368286133
Epoch: 5, Steps: 4 | Train Loss: 1.447 Vali Loss: 1.620 Vali Acc: 0.240 Test Loss: 1.620 Test Acc: 0.240
Validation loss decreased (-0.239984 --> -0.239984).  Saving model ...
Epoch: 6 cost time: 1.24971342086792
Epoch: 6, Steps: 4 | Train Loss: 1.358 Vali Loss: 1.614 Vali Acc: 0.260 Test Loss: 1.614 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 7 cost time: 1.3622550964355469
Epoch: 7, Steps: 4 | Train Loss: 1.189 Vali Loss: 1.616 Vali Acc: 0.260 Test Loss: 1.616 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.2060692310333252
Epoch: 8, Steps: 4 | Train Loss: 1.219 Vali Loss: 1.646 Vali Acc: 0.280 Test Loss: 1.646 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279984).  Saving model ...
Epoch: 9 cost time: 1.191776990890503
Epoch: 9, Steps: 4 | Train Loss: 1.108 Vali Loss: 1.683 Vali Acc: 0.280 Test Loss: 1.683 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.4620237350463867
Epoch: 10, Steps: 4 | Train Loss: 1.033 Vali Loss: 1.757 Vali Acc: 0.280 Test Loss: 1.757 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.09013032913208
Epoch: 11, Steps: 4 | Train Loss: 0.937 Vali Loss: 1.832 Vali Acc: 0.200 Test Loss: 1.832 Test Acc: 0.200
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.294501781463623
Epoch: 12, Steps: 4 | Train Loss: 0.919 Vali Loss: 1.885 Vali Acc: 0.240 Test Loss: 1.885 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.2511866092681885
Epoch: 13, Steps: 4 | Train Loss: 0.814 Vali Loss: 1.958 Vali Acc: 0.260 Test Loss: 1.958 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.4879539012908936
Epoch: 14, Steps: 4 | Train Loss: 0.765 Vali Loss: 2.051 Vali Acc: 0.280 Test Loss: 2.051 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.366302728652954
Epoch: 15, Steps: 4 | Train Loss: 0.560 Vali Loss: 2.171 Vali Acc: 0.280 Test Loss: 2.171 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.380631923675537
Epoch: 16, Steps: 4 | Train Loss: 0.675 Vali Loss: 2.310 Vali Acc: 0.280 Test Loss: 2.310 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.5382513999938965
Epoch: 17, Steps: 4 | Train Loss: 0.657 Vali Loss: 2.403 Vali Acc: 0.240 Test Loss: 2.403 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.505774974822998
Epoch: 18, Steps: 4 | Train Loss: 0.429 Vali Loss: 2.582 Vali Acc: 0.260 Test Loss: 2.582 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 274425
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.1130712032318115
Epoch: 1, Steps: 4 | Train Loss: 1.601 Vali Loss: 1.579 Vali Acc: 0.240 Test Loss: 1.579 Test Acc: 0.240
Validation loss decreased (inf --> -0.239984).  Saving model ...
Epoch: 2 cost time: 1.256399393081665
Epoch: 2, Steps: 4 | Train Loss: 1.583 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.1543996334075928
Epoch: 3, Steps: 4 | Train Loss: 1.570 Vali Loss: 1.593 Vali Acc: 0.240 Test Loss: 1.593 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 4 cost time: 0.9869697093963623
Epoch: 4, Steps: 4 | Train Loss: 1.488 Vali Loss: 1.607 Vali Acc: 0.260 Test Loss: 1.607 Test Acc: 0.260
Validation loss decreased (-0.239984 --> -0.259984).  Saving model ...
Epoch: 5 cost time: 1.09739351272583
Epoch: 5, Steps: 4 | Train Loss: 1.458 Vali Loss: 1.594 Vali Acc: 0.240 Test Loss: 1.594 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.2894060611724854
Epoch: 6, Steps: 4 | Train Loss: 1.387 Vali Loss: 1.588 Vali Acc: 0.240 Test Loss: 1.588 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.295983076095581
Epoch: 7, Steps: 4 | Train Loss: 1.208 Vali Loss: 1.579 Vali Acc: 0.240 Test Loss: 1.579 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.0714654922485352
Epoch: 8, Steps: 4 | Train Loss: 1.264 Vali Loss: 1.593 Vali Acc: 0.260 Test Loss: 1.593 Test Acc: 0.260
Validation loss decreased (-0.259984 --> -0.259984).  Saving model ...
Epoch: 9 cost time: 1.229337215423584
Epoch: 9, Steps: 4 | Train Loss: 1.162 Vali Loss: 1.606 Vali Acc: 0.260 Test Loss: 1.606 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.1566681861877441
Epoch: 10, Steps: 4 | Train Loss: 1.102 Vali Loss: 1.657 Vali Acc: 0.240 Test Loss: 1.657 Test Acc: 0.240
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.1723742485046387
Epoch: 11, Steps: 4 | Train Loss: 1.016 Vali Loss: 1.694 Vali Acc: 0.260 Test Loss: 1.694 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.3148529529571533
Epoch: 12, Steps: 4 | Train Loss: 1.030 Vali Loss: 1.710 Vali Acc: 0.240 Test Loss: 1.710 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.5188226699829102
Epoch: 13, Steps: 4 | Train Loss: 0.900 Vali Loss: 1.746 Vali Acc: 0.240 Test Loss: 1.746 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.1647331714630127
Epoch: 14, Steps: 4 | Train Loss: 0.832 Vali Loss: 1.788 Vali Acc: 0.260 Test Loss: 1.788 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.2269401550292969
Epoch: 15, Steps: 4 | Train Loss: 0.627 Vali Loss: 1.818 Vali Acc: 0.280 Test Loss: 1.818 Test Acc: 0.280
Validation loss decreased (-0.259984 --> -0.279982).  Saving model ...
Epoch: 16 cost time: 1.1226394176483154
Epoch: 16, Steps: 4 | Train Loss: 0.745 Vali Loss: 1.843 Vali Acc: 0.300 Test Loss: 1.843 Test Acc: 0.300
Validation loss decreased (-0.279982 --> -0.299982).  Saving model ...
Epoch: 17 cost time: 1.1734349727630615
Epoch: 17, Steps: 4 | Train Loss: 0.771 Vali Loss: 1.854 Vali Acc: 0.280 Test Loss: 1.854 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.1329174041748047
Epoch: 18, Steps: 4 | Train Loss: 0.502 Vali Loss: 1.902 Vali Acc: 0.340 Test Loss: 1.902 Test Acc: 0.340
Validation loss decreased (-0.299982 --> -0.339981).  Saving model ...
Epoch: 19 cost time: 1.093041181564331
Epoch: 19, Steps: 4 | Train Loss: 0.911 Vali Loss: 2.005 Vali Acc: 0.360 Test Loss: 2.005 Test Acc: 0.360
Validation loss decreased (-0.339981 --> -0.359980).  Saving model ...
Epoch: 20 cost time: 1.0943586826324463
Epoch: 20, Steps: 4 | Train Loss: 0.585 Vali Loss: 2.125 Vali Acc: 0.340 Test Loss: 2.125 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.2830123901367188
Epoch: 21, Steps: 4 | Train Loss: 0.633 Vali Loss: 2.236 Vali Acc: 0.320 Test Loss: 2.236 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.2603123188018799
Epoch: 22, Steps: 4 | Train Loss: 0.546 Vali Loss: 2.362 Vali Acc: 0.300 Test Loss: 2.362 Test Acc: 0.300
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.2638254165649414
Epoch: 23, Steps: 4 | Train Loss: 0.342 Vali Loss: 2.505 Vali Acc: 0.320 Test Loss: 2.505 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.3892786502838135
Epoch: 24, Steps: 4 | Train Loss: 0.413 Vali Loss: 2.509 Vali Acc: 0.280 Test Loss: 2.509 Test Acc: 0.280
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.267988920211792
Epoch: 25, Steps: 4 | Train Loss: 0.271 Vali Loss: 2.517 Vali Acc: 0.300 Test Loss: 2.517 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.3703179359436035
Epoch: 26, Steps: 4 | Train Loss: 0.298 Vali Loss: 2.563 Vali Acc: 0.300 Test Loss: 2.563 Test Acc: 0.300
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.2474102973937988
Epoch: 27, Steps: 4 | Train Loss: 0.272 Vali Loss: 2.665 Vali Acc: 0.280 Test Loss: 2.665 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.3341591358184814
Epoch: 28, Steps: 4 | Train Loss: 0.200 Vali Loss: 2.779 Vali Acc: 0.260 Test Loss: 2.779 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.1449317932128906
Epoch: 29, Steps: 4 | Train Loss: 0.354 Vali Loss: 2.891 Vali Acc: 0.260 Test Loss: 2.891 Test Acc: 0.260
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.36
model parameter : 274425
model size : 1.67MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.570920467376709
Epoch: 1, Steps: 4 | Train Loss: 1.603 Vali Loss: 1.520 Vali Acc: 0.300 Test Loss: 1.520 Test Acc: 0.300
Validation loss decreased (inf --> -0.299985).  Saving model ...
Epoch: 2 cost time: 1.189401388168335
Epoch: 2, Steps: 4 | Train Loss: 1.573 Vali Loss: 1.513 Vali Acc: 0.280 Test Loss: 1.513 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.282731533050537
Epoch: 3, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.514 Vali Acc: 0.300 Test Loss: 1.514 Test Acc: 0.300
Validation loss decreased (-0.299985 --> -0.299985).  Saving model ...
Epoch: 4 cost time: 1.1279304027557373
Epoch: 4, Steps: 4 | Train Loss: 1.453 Vali Loss: 1.533 Vali Acc: 0.320 Test Loss: 1.533 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319985).  Saving model ...
Epoch: 5 cost time: 1.1724159717559814
Epoch: 5, Steps: 4 | Train Loss: 1.417 Vali Loss: 1.526 Vali Acc: 0.320 Test Loss: 1.526 Test Acc: 0.320
Validation loss decreased (-0.319985 --> -0.319985).  Saving model ...
Epoch: 6 cost time: 1.1351678371429443
Epoch: 6, Steps: 4 | Train Loss: 1.147 Vali Loss: 1.548 Vali Acc: 0.300 Test Loss: 1.548 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.2293415069580078
Epoch: 7, Steps: 4 | Train Loss: 1.282 Vali Loss: 1.571 Vali Acc: 0.300 Test Loss: 1.571 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.2271151542663574
Epoch: 8, Steps: 4 | Train Loss: 1.017 Vali Loss: 1.605 Vali Acc: 0.240 Test Loss: 1.605 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.2556276321411133
Epoch: 9, Steps: 4 | Train Loss: 1.030 Vali Loss: 1.670 Vali Acc: 0.240 Test Loss: 1.670 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.3035893440246582
Epoch: 10, Steps: 4 | Train Loss: 1.167 Vali Loss: 1.728 Vali Acc: 0.240 Test Loss: 1.728 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.2219867706298828
Epoch: 11, Steps: 4 | Train Loss: 0.868 Vali Loss: 1.812 Vali Acc: 0.300 Test Loss: 1.812 Test Acc: 0.300
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 1.3739478588104248
Epoch: 12, Steps: 4 | Train Loss: 0.879 Vali Loss: 1.864 Vali Acc: 0.320 Test Loss: 1.864 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 1.1447656154632568
Epoch: 13, Steps: 4 | Train Loss: 0.797 Vali Loss: 1.947 Vali Acc: 0.280 Test Loss: 1.947 Test Acc: 0.280
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 1.2569262981414795
Epoch: 14, Steps: 4 | Train Loss: 0.616 Vali Loss: 2.055 Vali Acc: 0.320 Test Loss: 2.055 Test Acc: 0.320
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 1.3591663837432861
Epoch: 15, Steps: 4 | Train Loss: 0.528 Vali Loss: 2.124 Vali Acc: 0.300 Test Loss: 2.124 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.32
model parameter : 270329
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.9264509677886963
Epoch: 1, Steps: 4 | Train Loss: 1.616 Vali Loss: 1.515 Vali Acc: 0.240 Test Loss: 1.515 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.1569440364837646
Epoch: 2, Steps: 4 | Train Loss: 1.564 Vali Loss: 1.519 Vali Acc: 0.280 Test Loss: 1.519 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279985).  Saving model ...
Epoch: 3 cost time: 1.2506029605865479
Epoch: 3, Steps: 4 | Train Loss: 1.556 Vali Loss: 1.507 Vali Acc: 0.260 Test Loss: 1.507 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.307750940322876
Epoch: 4, Steps: 4 | Train Loss: 1.478 Vali Loss: 1.523 Vali Acc: 0.260 Test Loss: 1.523 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.113901138305664
Epoch: 5, Steps: 4 | Train Loss: 1.428 Vali Loss: 1.523 Vali Acc: 0.300 Test Loss: 1.523 Test Acc: 0.300
Validation loss decreased (-0.279985 --> -0.299985).  Saving model ...
Epoch: 6 cost time: 1.053147792816162
Epoch: 6, Steps: 4 | Train Loss: 1.152 Vali Loss: 1.542 Vali Acc: 0.280 Test Loss: 1.542 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.111893653869629
Epoch: 7, Steps: 4 | Train Loss: 1.301 Vali Loss: 1.561 Vali Acc: 0.300 Test Loss: 1.561 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.1792409420013428
Epoch: 8, Steps: 4 | Train Loss: 1.032 Vali Loss: 1.588 Vali Acc: 0.260 Test Loss: 1.588 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.0708591938018799
Epoch: 9, Steps: 4 | Train Loss: 1.035 Vali Loss: 1.638 Vali Acc: 0.300 Test Loss: 1.638 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 1.1151387691497803
Epoch: 10, Steps: 4 | Train Loss: 1.196 Vali Loss: 1.689 Vali Acc: 0.320 Test Loss: 1.689 Test Acc: 0.320
Validation loss decreased (-0.299985 --> -0.319983).  Saving model ...
Epoch: 11 cost time: 1.2016899585723877
Epoch: 11, Steps: 4 | Train Loss: 0.878 Vali Loss: 1.776 Vali Acc: 0.280 Test Loss: 1.776 Test Acc: 0.280
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.971214771270752
Epoch: 12, Steps: 4 | Train Loss: 0.888 Vali Loss: 1.854 Vali Acc: 0.320 Test Loss: 1.854 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.0732781887054443
Epoch: 13, Steps: 4 | Train Loss: 0.817 Vali Loss: 1.938 Vali Acc: 0.280 Test Loss: 1.938 Test Acc: 0.280
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.2211718559265137
Epoch: 14, Steps: 4 | Train Loss: 0.656 Vali Loss: 2.027 Vali Acc: 0.300 Test Loss: 2.027 Test Acc: 0.300
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.404503583908081
Epoch: 15, Steps: 4 | Train Loss: 0.624 Vali Loss: 2.087 Vali Acc: 0.340 Test Loss: 2.087 Test Acc: 0.340
Validation loss decreased (-0.319983 --> -0.339979).  Saving model ...
Epoch: 16 cost time: 1.1223173141479492
Epoch: 16, Steps: 4 | Train Loss: 0.594 Vali Loss: 2.193 Vali Acc: 0.340 Test Loss: 2.193 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.2020134925842285
Epoch: 17, Steps: 4 | Train Loss: 0.550 Vali Loss: 2.365 Vali Acc: 0.300 Test Loss: 2.365 Test Acc: 0.300
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.2377917766571045
Epoch: 18, Steps: 4 | Train Loss: 0.428 Vali Loss: 2.571 Vali Acc: 0.240 Test Loss: 2.571 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.3577888011932373
Epoch: 19, Steps: 4 | Train Loss: 0.457 Vali Loss: 2.680 Vali Acc: 0.240 Test Loss: 2.680 Test Acc: 0.240
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.2788610458374023
Epoch: 20, Steps: 4 | Train Loss: 0.381 Vali Loss: 2.793 Vali Acc: 0.260 Test Loss: 2.793 Test Acc: 0.260
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.2162048816680908
Epoch: 21, Steps: 4 | Train Loss: 0.358 Vali Loss: 2.953 Vali Acc: 0.280 Test Loss: 2.953 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.2333738803863525
Epoch: 22, Steps: 4 | Train Loss: 0.329 Vali Loss: 3.104 Vali Acc: 0.260 Test Loss: 3.104 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.322618007659912
Epoch: 23, Steps: 4 | Train Loss: 0.246 Vali Loss: 3.321 Vali Acc: 0.200 Test Loss: 3.321 Test Acc: 0.200
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0708434581756592
Epoch: 24, Steps: 4 | Train Loss: 0.266 Vali Loss: 3.575 Vali Acc: 0.240 Test Loss: 3.575 Test Acc: 0.240
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.2481322288513184
Epoch: 25, Steps: 4 | Train Loss: 0.294 Vali Loss: 3.724 Vali Acc: 0.240 Test Loss: 3.724 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 270329
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.911184072494507
Epoch: 1, Steps: 4 | Train Loss: 1.638 Vali Loss: 1.525 Vali Acc: 0.180 Test Loss: 1.525 Test Acc: 0.180
Validation loss decreased (inf --> -0.179985).  Saving model ...
Epoch: 2 cost time: 1.09602952003479
Epoch: 2, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.523 Vali Acc: 0.260 Test Loss: 1.523 Test Acc: 0.260
Validation loss decreased (-0.179985 --> -0.259985).  Saving model ...
Epoch: 3 cost time: 1.2314198017120361
Epoch: 3, Steps: 4 | Train Loss: 1.561 Vali Loss: 1.524 Vali Acc: 0.280 Test Loss: 1.524 Test Acc: 0.280
Validation loss decreased (-0.259985 --> -0.279985).  Saving model ...
Epoch: 4 cost time: 1.2680609226226807
Epoch: 4, Steps: 4 | Train Loss: 1.503 Vali Loss: 1.542 Vali Acc: 0.240 Test Loss: 1.542 Test Acc: 0.240
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.2041716575622559
Epoch: 5, Steps: 4 | Train Loss: 1.452 Vali Loss: 1.534 Vali Acc: 0.280 Test Loss: 1.534 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5347347259521484
Epoch: 6, Steps: 4 | Train Loss: 1.197 Vali Loss: 1.539 Vali Acc: 0.240 Test Loss: 1.539 Test Acc: 0.240
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.3339319229125977
Epoch: 7, Steps: 4 | Train Loss: 1.341 Vali Loss: 1.568 Vali Acc: 0.280 Test Loss: 1.568 Test Acc: 0.280
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 1.5922119617462158
Epoch: 8, Steps: 4 | Train Loss: 1.061 Vali Loss: 1.601 Vali Acc: 0.220 Test Loss: 1.601 Test Acc: 0.220
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 1.6579992771148682
Epoch: 9, Steps: 4 | Train Loss: 1.060 Vali Loss: 1.640 Vali Acc: 0.260 Test Loss: 1.640 Test Acc: 0.260
EarlyStopping counter: 6 out of 10
Epoch: 10 cost time: 1.7493126392364502
Epoch: 10, Steps: 4 | Train Loss: 1.235 Vali Loss: 1.693 Vali Acc: 0.260 Test Loss: 1.693 Test Acc: 0.260
EarlyStopping counter: 7 out of 10
Epoch: 11 cost time: 1.482790470123291
Epoch: 11, Steps: 4 | Train Loss: 0.929 Vali Loss: 1.737 Vali Acc: 0.240 Test Loss: 1.737 Test Acc: 0.240
EarlyStopping counter: 8 out of 10
Epoch: 12 cost time: 1.2393434047698975
Epoch: 12, Steps: 4 | Train Loss: 0.932 Vali Loss: 1.786 Vali Acc: 0.260 Test Loss: 1.786 Test Acc: 0.260
EarlyStopping counter: 9 out of 10
Epoch: 13 cost time: 1.392397403717041
Epoch: 13, Steps: 4 | Train Loss: 0.862 Vali Loss: 1.865 Vali Acc: 0.240 Test Loss: 1.865 Test Acc: 0.240
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.28
model parameter : 270329
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_DuckDuckGeese   Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/DuckDuckGeese
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             1345                Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

50
50
>>>>>>>start training : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
50
50
50
Epoch: 1 cost time: 3.3085062503814697
Epoch: 1, Steps: 4 | Train Loss: 1.632 Vali Loss: 1.538 Vali Acc: 0.240 Test Loss: 1.538 Test Acc: 0.240
Validation loss decreased (inf --> -0.239985).  Saving model ...
Epoch: 2 cost time: 1.192080020904541
Epoch: 2, Steps: 4 | Train Loss: 1.572 Vali Loss: 1.553 Vali Acc: 0.280 Test Loss: 1.553 Test Acc: 0.280
Validation loss decreased (-0.239985 --> -0.279984).  Saving model ...
Epoch: 3 cost time: 1.32230544090271
Epoch: 3, Steps: 4 | Train Loss: 1.593 Vali Loss: 1.551 Vali Acc: 0.260 Test Loss: 1.551 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.087047815322876
Epoch: 4, Steps: 4 | Train Loss: 1.496 Vali Loss: 1.571 Vali Acc: 0.260 Test Loss: 1.571 Test Acc: 0.260
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.1849472522735596
Epoch: 5, Steps: 4 | Train Loss: 1.472 Vali Loss: 1.568 Vali Acc: 0.260 Test Loss: 1.568 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 1.253321886062622
Epoch: 6, Steps: 4 | Train Loss: 1.229 Vali Loss: 1.562 Vali Acc: 0.260 Test Loss: 1.562 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 1.249678134918213
Epoch: 7, Steps: 4 | Train Loss: 1.368 Vali Loss: 1.571 Vali Acc: 0.240 Test Loss: 1.571 Test Acc: 0.240
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 1.1709682941436768
Epoch: 8, Steps: 4 | Train Loss: 1.138 Vali Loss: 1.583 Vali Acc: 0.280 Test Loss: 1.583 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 9 cost time: 1.1618449687957764
Epoch: 9, Steps: 4 | Train Loss: 1.114 Vali Loss: 1.610 Vali Acc: 0.300 Test Loss: 1.610 Test Acc: 0.300
Validation loss decreased (-0.279984 --> -0.299984).  Saving model ...
Epoch: 10 cost time: 1.285513162612915
Epoch: 10, Steps: 4 | Train Loss: 1.311 Vali Loss: 1.626 Vali Acc: 0.300 Test Loss: 1.626 Test Acc: 0.300
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.384519100189209
Epoch: 11, Steps: 4 | Train Loss: 0.998 Vali Loss: 1.661 Vali Acc: 0.280 Test Loss: 1.661 Test Acc: 0.280
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.3243536949157715
Epoch: 12, Steps: 4 | Train Loss: 1.005 Vali Loss: 1.678 Vali Acc: 0.260 Test Loss: 1.678 Test Acc: 0.260
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.1518447399139404
Epoch: 13, Steps: 4 | Train Loss: 0.907 Vali Loss: 1.727 Vali Acc: 0.260 Test Loss: 1.727 Test Acc: 0.260
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.2392020225524902
Epoch: 14, Steps: 4 | Train Loss: 0.772 Vali Loss: 1.762 Vali Acc: 0.300 Test Loss: 1.762 Test Acc: 0.300
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.0664362907409668
Epoch: 15, Steps: 4 | Train Loss: 0.722 Vali Loss: 1.809 Vali Acc: 0.280 Test Loss: 1.809 Test Acc: 0.280
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.4103150367736816
Epoch: 16, Steps: 4 | Train Loss: 0.746 Vali Loss: 1.909 Vali Acc: 0.280 Test Loss: 1.909 Test Acc: 0.280
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 1.138103723526001
Epoch: 17, Steps: 4 | Train Loss: 0.683 Vali Loss: 2.004 Vali Acc: 0.320 Test Loss: 2.004 Test Acc: 0.320
Validation loss decreased (-0.299984 --> -0.319980).  Saving model ...
Epoch: 18 cost time: 1.089012861251831
Epoch: 18, Steps: 4 | Train Loss: 0.536 Vali Loss: 2.079 Vali Acc: 0.320 Test Loss: 2.079 Test Acc: 0.320
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.2638533115386963
Epoch: 19, Steps: 4 | Train Loss: 0.572 Vali Loss: 2.145 Vali Acc: 0.320 Test Loss: 2.145 Test Acc: 0.320
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.5053486824035645
Epoch: 20, Steps: 4 | Train Loss: 0.472 Vali Loss: 2.224 Vali Acc: 0.320 Test Loss: 2.224 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.1450448036193848
Epoch: 21, Steps: 4 | Train Loss: 0.447 Vali Loss: 2.308 Vali Acc: 0.320 Test Loss: 2.308 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.2206120491027832
Epoch: 22, Steps: 4 | Train Loss: 0.400 Vali Loss: 2.391 Vali Acc: 0.340 Test Loss: 2.391 Test Acc: 0.340
Validation loss decreased (-0.319980 --> -0.339976).  Saving model ...
Epoch: 23 cost time: 1.269413709640503
Epoch: 23, Steps: 4 | Train Loss: 0.346 Vali Loss: 2.544 Vali Acc: 0.340 Test Loss: 2.544 Test Acc: 0.340
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.270493507385254
Epoch: 24, Steps: 4 | Train Loss: 0.345 Vali Loss: 2.664 Vali Acc: 0.340 Test Loss: 2.664 Test Acc: 0.340
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.2089061737060547
Epoch: 25, Steps: 4 | Train Loss: 0.352 Vali Loss: 2.753 Vali Acc: 0.320 Test Loss: 2.753 Test Acc: 0.320
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.2742509841918945
Epoch: 26, Steps: 4 | Train Loss: 0.331 Vali Loss: 2.814 Vali Acc: 0.320 Test Loss: 2.814 Test Acc: 0.320
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.2129442691802979
Epoch: 27, Steps: 4 | Train Loss: 0.267 Vali Loss: 2.917 Vali Acc: 0.340 Test Loss: 2.917 Test Acc: 0.340
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.2408113479614258
Epoch: 28, Steps: 4 | Train Loss: 0.266 Vali Loss: 3.096 Vali Acc: 0.340 Test Loss: 3.096 Test Acc: 0.340
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.3024296760559082
Epoch: 29, Steps: 4 | Train Loss: 0.198 Vali Loss: 3.225 Vali Acc: 0.320 Test Loss: 3.225 Test Acc: 0.320
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.12856125831604
Epoch: 30, Steps: 4 | Train Loss: 0.184 Vali Loss: 3.302 Vali Acc: 0.300 Test Loss: 3.302 Test Acc: 0.300
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.4298458099365234
Epoch: 31, Steps: 4 | Train Loss: 0.182 Vali Loss: 3.387 Vali Acc: 0.300 Test Loss: 3.387 Test Acc: 0.300
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.200533390045166
Epoch: 32, Steps: 4 | Train Loss: 0.188 Vali Loss: 3.509 Vali Acc: 0.300 Test Loss: 3.509 Test Acc: 0.300
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_DuckDuckGeese_ETSformer_UEA_ftM_sl270_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
50
test shape: torch.Size([50, 5]) torch.Size([50, 1])
accuracy:0.34
model parameter : 270329
model size : 1.65MB
