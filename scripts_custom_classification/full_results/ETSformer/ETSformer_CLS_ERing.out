Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7229816913604736
Epoch: 1, Steps: 2 | Train Loss: 2.233 Vali Loss: 1.759 Vali Acc: 0.259 Test Loss: 1.759 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.7341940402984619
Epoch: 2, Steps: 2 | Train Loss: 1.752 Vali Loss: 1.534 Vali Acc: 0.437 Test Loss: 1.534 Test Acc: 0.437
Validation loss decreased (-0.259242 --> -0.437022).  Saving model ...
Epoch: 3 cost time: 0.7115647792816162
Epoch: 3, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.241 Vali Acc: 0.633 Test Loss: 1.241 Test Acc: 0.633
Validation loss decreased (-0.437022 --> -0.633321).  Saving model ...
Epoch: 4 cost time: 0.7293665409088135
Epoch: 4, Steps: 2 | Train Loss: 1.133 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
Validation loss decreased (-0.633321 --> -0.788880).  Saving model ...
Epoch: 5 cost time: 0.7372667789459229
Epoch: 5, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.566 Vali Acc: 0.867 Test Loss: 0.566 Test Acc: 0.867
Validation loss decreased (-0.788880 --> -0.866661).  Saving model ...
Epoch: 6 cost time: 0.6493303775787354
Epoch: 6, Steps: 2 | Train Loss: 0.386 Vali Loss: 0.389 Vali Acc: 0.900 Test Loss: 0.389 Test Acc: 0.900
Validation loss decreased (-0.866661 --> -0.899996).  Saving model ...
Epoch: 7 cost time: 0.6836645603179932
Epoch: 7, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.296 Vali Acc: 0.907 Test Loss: 0.296 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 8 cost time: 0.7179038524627686
Epoch: 8, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922220).  Saving model ...
Epoch: 9 cost time: 0.7246837615966797
Epoch: 9, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 10 cost time: 0.6740846633911133
Epoch: 10, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.180 Vali Acc: 0.926 Test Loss: 0.180 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6733105182647705
Epoch: 11, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6343536376953125
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.6296029090881348
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 14 cost time: 0.6646902561187744
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 15 cost time: 0.6040103435516357
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5972418785095215
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.6199343204498291
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.7166211605072021
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8338875770568848
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8142786026000977
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.6939311027526855
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8102357387542725
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.9037392139434814
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7340571880340576
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.837937593460083
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7169210910797119
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8443019390106201
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 5467206
model size : 30.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7126171588897705
Epoch: 1, Steps: 2 | Train Loss: 2.218 Vali Loss: 1.766 Vali Acc: 0.207 Test Loss: 1.766 Test Acc: 0.207
Validation loss decreased (inf --> -0.207390).  Saving model ...
Epoch: 2 cost time: 0.7369060516357422
Epoch: 2, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.539 Vali Acc: 0.415 Test Loss: 1.539 Test Acc: 0.415
Validation loss decreased (-0.207390 --> -0.414799).  Saving model ...
Epoch: 3 cost time: 0.7249908447265625
Epoch: 3, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.243 Vali Acc: 0.630 Test Loss: 1.243 Test Acc: 0.630
Validation loss decreased (-0.414799 --> -0.629617).  Saving model ...
Epoch: 4 cost time: 0.7553606033325195
Epoch: 4, Steps: 2 | Train Loss: 1.124 Vali Loss: 0.852 Vali Acc: 0.785 Test Loss: 0.852 Test Acc: 0.785
Validation loss decreased (-0.629617 --> -0.785177).  Saving model ...
Epoch: 5 cost time: 0.7327690124511719
Epoch: 5, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.565 Vali Acc: 0.874 Test Loss: 0.565 Test Acc: 0.874
Validation loss decreased (-0.785177 --> -0.874068).  Saving model ...
Epoch: 6 cost time: 0.7376434803009033
Epoch: 6, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
Validation loss decreased (-0.874068 --> -0.911107).  Saving model ...
Epoch: 7 cost time: 0.7279458045959473
Epoch: 7, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.911107 --> -0.929627).  Saving model ...
Epoch: 8 cost time: 0.8494067192077637
Epoch: 8, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 9 cost time: 0.7818589210510254
Epoch: 9, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 10 cost time: 0.8931477069854736
Epoch: 10, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 11 cost time: 0.8249449729919434
Epoch: 11, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.922 Test Loss: 0.181 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.0912773609161377
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 13 cost time: 1.0233871936798096
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933332).  Saving model ...
Epoch: 14 cost time: 0.7957816123962402
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.800804615020752
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8627009391784668
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7870001792907715
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0916013717651367
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8334295749664307
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8678903579711914
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.9160563945770264
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8645398616790771
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.754828691482544
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8251066207885742
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 5467206
model size : 30.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8256754875183105
Epoch: 1, Steps: 2 | Train Loss: 2.178 Vali Loss: 1.769 Vali Acc: 0.219 Test Loss: 1.769 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.7399716377258301
Epoch: 2, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.539 Vali Acc: 0.430 Test Loss: 1.539 Test Acc: 0.430
Validation loss decreased (-0.218501 --> -0.429614).  Saving model ...
Epoch: 3 cost time: 0.7563824653625488
Epoch: 3, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.239 Vali Acc: 0.652 Test Loss: 1.239 Test Acc: 0.652
Validation loss decreased (-0.429614 --> -0.651839).  Saving model ...
Epoch: 4 cost time: 0.6621787548065186
Epoch: 4, Steps: 2 | Train Loss: 1.109 Vali Loss: 0.846 Vali Acc: 0.789 Test Loss: 0.846 Test Acc: 0.789
Validation loss decreased (-0.651839 --> -0.788880).  Saving model ...
Epoch: 5 cost time: 0.7811219692230225
Epoch: 5, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.559 Vali Acc: 0.874 Test Loss: 0.559 Test Acc: 0.874
Validation loss decreased (-0.788880 --> -0.874068).  Saving model ...
Epoch: 6 cost time: 0.8214495182037354
Epoch: 6, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.382 Vali Acc: 0.919 Test Loss: 0.382 Test Acc: 0.919
Validation loss decreased (-0.874068 --> -0.918515).  Saving model ...
Epoch: 7 cost time: 0.8573157787322998
Epoch: 7, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.291 Vali Acc: 0.919 Test Loss: 0.291 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 8 cost time: 0.7911148071289062
Epoch: 8, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.918516 --> -0.933331).  Saving model ...
Epoch: 9 cost time: 0.807335615158081
Epoch: 9, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 10 cost time: 0.8168165683746338
Epoch: 10, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 11 cost time: 0.7385225296020508
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7216887474060059
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.930 Test Loss: 0.175 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7380757331848145
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8058333396911621
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.926 Test Loss: 0.175 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.7246866226196289
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.7645554542541504
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.7066066265106201
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.7854111194610596
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.7563681602478027
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.7771642208099365
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 5467206
model size : 30.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0340538024902344
Epoch: 1, Steps: 2 | Train Loss: 2.147 Vali Loss: 1.803 Vali Acc: 0.189 Test Loss: 1.803 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.7693643569946289
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.577 Vali Acc: 0.400 Test Loss: 1.577 Test Acc: 0.400
Validation loss decreased (-0.188871 --> -0.399984).  Saving model ...
Epoch: 3 cost time: 0.7679228782653809
Epoch: 3, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.281 Vali Acc: 0.630 Test Loss: 1.281 Test Acc: 0.630
Validation loss decreased (-0.399984 --> -0.629617).  Saving model ...
Epoch: 4 cost time: 0.8015282154083252
Epoch: 4, Steps: 2 | Train Loss: 1.143 Vali Loss: 0.890 Vali Acc: 0.759 Test Loss: 0.890 Test Acc: 0.759
Validation loss decreased (-0.629617 --> -0.759250).  Saving model ...
Epoch: 5 cost time: 0.831944465637207
Epoch: 5, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.604 Vali Acc: 0.852 Test Loss: 0.604 Test Acc: 0.852
Validation loss decreased (-0.759250 --> -0.851846).  Saving model ...
Epoch: 6 cost time: 0.7953917980194092
Epoch: 6, Steps: 2 | Train Loss: 0.410 Vali Loss: 0.426 Vali Acc: 0.893 Test Loss: 0.426 Test Acc: 0.893
Validation loss decreased (-0.851846 --> -0.892588).  Saving model ...
Epoch: 7 cost time: 0.9021053314208984
Epoch: 7, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.338 Vali Acc: 0.885 Test Loss: 0.338 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8246066570281982
Epoch: 8, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.892588 --> -0.922220).  Saving model ...
Epoch: 9 cost time: 0.8170840740203857
Epoch: 9, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8873720169067383
Epoch: 10, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.223 Vali Acc: 0.915 Test Loss: 0.223 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8094892501831055
Epoch: 11, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.919 Test Loss: 0.214 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.7723846435546875
Epoch: 12, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.7218387126922607
Epoch: 13, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.7486982345581055
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7648437023162842
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7575969696044922
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7920644283294678
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.0011565685272217
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.0391771793365479
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 1.0313880443572998
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8996765613555908
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9291541576385498
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.9735064506530762
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7843081951141357
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8526444435119629
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8640158176422119
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8015186786651611
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7908823490142822
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.937 Test Loss: 0.251 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7935397624969482
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 5467206
model size : 30.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8220643997192383
Epoch: 1, Steps: 2 | Train Loss: 2.068 Vali Loss: 1.808 Vali Acc: 0.263 Test Loss: 1.808 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.7760226726531982
Epoch: 2, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.584 Vali Acc: 0.415 Test Loss: 1.584 Test Acc: 0.415
Validation loss decreased (-0.262945 --> -0.414799).  Saving model ...
Epoch: 3 cost time: 0.7675206661224365
Epoch: 3, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.284 Vali Acc: 0.644 Test Loss: 1.284 Test Acc: 0.644
Validation loss decreased (-0.414799 --> -0.644432).  Saving model ...
Epoch: 4 cost time: 0.7695896625518799
Epoch: 4, Steps: 2 | Train Loss: 0.971 Vali Loss: 0.875 Vali Acc: 0.841 Test Loss: 0.875 Test Acc: 0.841
Validation loss decreased (-0.644432 --> -0.840732).  Saving model ...
Epoch: 5 cost time: 0.6892638206481934
Epoch: 5, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.566 Vali Acc: 0.911 Test Loss: 0.566 Test Acc: 0.911
Validation loss decreased (-0.840732 --> -0.911105).  Saving model ...
Epoch: 6 cost time: 0.7063827514648438
Epoch: 6, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.380 Vali Acc: 0.922 Test Loss: 0.380 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922218).  Saving model ...
Epoch: 7 cost time: 0.7998607158660889
Epoch: 7, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.273 Vali Acc: 0.937 Test Loss: 0.273 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937034).  Saving model ...
Epoch: 8 cost time: 0.7651236057281494
Epoch: 8, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 9 cost time: 0.8304758071899414
Epoch: 9, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.7556326389312744
Epoch: 10, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.7682361602783203
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.6985790729522705
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.944443 --> -0.951850).  Saving model ...
Epoch: 13 cost time: 1.037196397781372
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 14 cost time: 0.8233072757720947
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7521955966949463
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.8008882999420166
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8625047206878662
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8172464370727539
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8251252174377441
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.7306678295135498
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8030638694763184
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.0324811935424805
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8298532962799072
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3370054
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.072089433670044
Epoch: 1, Steps: 2 | Train Loss: 2.043 Vali Loss: 1.808 Vali Acc: 0.263 Test Loss: 1.808 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 0.7630400657653809
Epoch: 2, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.582 Vali Acc: 0.415 Test Loss: 1.582 Test Acc: 0.415
Validation loss decreased (-0.262945 --> -0.414799).  Saving model ...
Epoch: 3 cost time: 0.7802207469940186
Epoch: 3, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.282 Vali Acc: 0.674 Test Loss: 1.282 Test Acc: 0.674
Validation loss decreased (-0.414799 --> -0.674061).  Saving model ...
Epoch: 4 cost time: 0.8364293575286865
Epoch: 4, Steps: 2 | Train Loss: 1.000 Vali Loss: 0.872 Vali Acc: 0.852 Test Loss: 0.872 Test Acc: 0.852
Validation loss decreased (-0.674061 --> -0.851843).  Saving model ...
Epoch: 5 cost time: 0.8562333583831787
Epoch: 5, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.565 Vali Acc: 0.911 Test Loss: 0.565 Test Acc: 0.911
Validation loss decreased (-0.851843 --> -0.911105).  Saving model ...
Epoch: 6 cost time: 0.8742468357086182
Epoch: 6, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.378 Vali Acc: 0.937 Test Loss: 0.378 Test Acc: 0.937
Validation loss decreased (-0.911105 --> -0.937033).  Saving model ...
Epoch: 7 cost time: 0.8278133869171143
Epoch: 7, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.937033 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.757770299911499
Epoch: 8, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 9 cost time: 0.796412467956543
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 10 cost time: 0.8262972831726074
Epoch: 10, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9331409931182861
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 12 cost time: 1.0128588676452637
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 13 cost time: 0.8323485851287842
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.948147 --> -0.955554).  Saving model ...
Epoch: 14 cost time: 0.856050968170166
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9268498420715332
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.157 Vali Acc: 0.956 Test Loss: 0.157 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9270930290222168
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.959 Test Loss: 0.159 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 17 cost time: 0.9063682556152344
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.161 Vali Acc: 0.959 Test Loss: 0.161 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.9581465721130371
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8361725807189941
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.959 Test Loss: 0.165 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7495596408843994
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.959 Test Loss: 0.167 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8306674957275391
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.959 Test Loss: 0.168 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.8685367107391357
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.959 Test Loss: 0.170 Test Acc: 0.959
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8373589515686035
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.959 Test Loss: 0.171 Test Acc: 0.959
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7434823513031006
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.959 Test Loss: 0.173 Test Acc: 0.959
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9594838619232178
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.959 Test Loss: 0.174 Test Acc: 0.959
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.9167430400848389
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.959 Test Loss: 0.175 Test Acc: 0.959
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 3370054
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9171221256256104
Epoch: 1, Steps: 2 | Train Loss: 2.092 Vali Loss: 1.796 Vali Acc: 0.256 Test Loss: 1.796 Test Acc: 0.256
Validation loss decreased (inf --> -0.255538).  Saving model ...
Epoch: 2 cost time: 0.8127813339233398
Epoch: 2, Steps: 2 | Train Loss: 1.727 Vali Loss: 1.569 Vali Acc: 0.393 Test Loss: 1.569 Test Acc: 0.393
Validation loss decreased (-0.255538 --> -0.392577).  Saving model ...
Epoch: 3 cost time: 0.9656634330749512
Epoch: 3, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.269 Vali Acc: 0.630 Test Loss: 1.269 Test Acc: 0.630
Validation loss decreased (-0.392577 --> -0.629617).  Saving model ...
Epoch: 4 cost time: 0.9953818321228027
Epoch: 4, Steps: 2 | Train Loss: 1.015 Vali Loss: 0.866 Vali Acc: 0.844 Test Loss: 0.866 Test Acc: 0.844
Validation loss decreased (-0.629617 --> -0.844436).  Saving model ...
Epoch: 5 cost time: 0.8410131931304932
Epoch: 5, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.565 Vali Acc: 0.893 Test Loss: 0.565 Test Acc: 0.893
Validation loss decreased (-0.844436 --> -0.892587).  Saving model ...
Epoch: 6 cost time: 0.799079418182373
Epoch: 6, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.379 Vali Acc: 0.930 Test Loss: 0.379 Test Acc: 0.930
Validation loss decreased (-0.892587 --> -0.929626).  Saving model ...
Epoch: 7 cost time: 0.7517235279083252
Epoch: 7, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 8 cost time: 0.9456400871276855
Epoch: 8, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 9 cost time: 0.7858691215515137
Epoch: 9, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 10 cost time: 0.9036769866943359
Epoch: 10, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 11 cost time: 0.7802684307098389
Epoch: 11, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 12 cost time: 0.6824140548706055
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 13 cost time: 0.6760857105255127
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 0.8485679626464844
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 15 cost time: 0.7949550151824951
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.863349199295044
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9621467590332031
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9347419738769531
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7508571147918701
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.853940486907959
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8244807720184326
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.948 Test Loss: 0.180 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8750596046447754
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8347163200378418
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8922286033630371
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9187901020050049
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 3370054
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2940564155578613
Epoch: 1, Steps: 2 | Train Loss: 2.099 Vali Loss: 1.806 Vali Acc: 0.263 Test Loss: 1.806 Test Acc: 0.263
Validation loss decreased (inf --> -0.262945).  Saving model ...
Epoch: 2 cost time: 1.0340628623962402
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.585 Vali Acc: 0.419 Test Loss: 1.585 Test Acc: 0.419
Validation loss decreased (-0.262945 --> -0.418503).  Saving model ...
Epoch: 3 cost time: 0.8351576328277588
Epoch: 3, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.294 Vali Acc: 0.593 Test Loss: 1.294 Test Acc: 0.593
Validation loss decreased (-0.418503 --> -0.592580).  Saving model ...
Epoch: 4 cost time: 0.9699816703796387
Epoch: 4, Steps: 2 | Train Loss: 1.069 Vali Loss: 0.897 Vali Acc: 0.837 Test Loss: 0.897 Test Acc: 0.837
Validation loss decreased (-0.592580 --> -0.837028).  Saving model ...
Epoch: 5 cost time: 0.92806077003479
Epoch: 5, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.603 Vali Acc: 0.870 Test Loss: 0.603 Test Acc: 0.870
Validation loss decreased (-0.837028 --> -0.870364).  Saving model ...
Epoch: 6 cost time: 0.8833622932434082
Epoch: 6, Steps: 2 | Train Loss: 0.425 Vali Loss: 0.424 Vali Acc: 0.896 Test Loss: 0.424 Test Acc: 0.896
Validation loss decreased (-0.870364 --> -0.896292).  Saving model ...
Epoch: 7 cost time: 0.873999834060669
Epoch: 7, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.324 Vali Acc: 0.919 Test Loss: 0.324 Test Acc: 0.919
Validation loss decreased (-0.896292 --> -0.918515).  Saving model ...
Epoch: 8 cost time: 0.8109815120697021
Epoch: 8, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 9 cost time: 0.9280345439910889
Epoch: 9, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.0481033325195312
Epoch: 10, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 11 cost time: 0.8707153797149658
Epoch: 11, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.9488461017608643
Epoch: 12, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.056126356124878
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.0779125690460205
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.9199624061584473
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.9841408729553223
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.9672031402587891
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.9595677852630615
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.0572328567504883
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.9677627086639404
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.9512958526611328
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 3370054
model size : 22.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.5048024654388428
Epoch: 1, Steps: 2 | Train Loss: 1.871 Vali Loss: 1.593 Vali Acc: 0.311 Test Loss: 1.593 Test Acc: 0.311
Validation loss decreased (inf --> -0.311095).  Saving model ...
Epoch: 2 cost time: 0.9807112216949463
Epoch: 2, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.370 Vali Acc: 0.574 Test Loss: 1.370 Test Acc: 0.574
Validation loss decreased (-0.311095 --> -0.574060).  Saving model ...
Epoch: 3 cost time: 0.9851858615875244
Epoch: 3, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.096 Vali Acc: 0.807 Test Loss: 1.096 Test Acc: 0.807
Validation loss decreased (-0.574060 --> -0.807396).  Saving model ...
Epoch: 4 cost time: 0.938798189163208
Epoch: 4, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.742 Vali Acc: 0.878 Test Loss: 0.742 Test Acc: 0.878
Validation loss decreased (-0.807396 --> -0.877770).  Saving model ...
Epoch: 5 cost time: 0.7507913112640381
Epoch: 5, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.485 Vali Acc: 0.911 Test Loss: 0.485 Test Acc: 0.911
Validation loss decreased (-0.877770 --> -0.911106).  Saving model ...
Epoch: 6 cost time: 0.8333921432495117
Epoch: 6, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.338 Vali Acc: 0.937 Test Loss: 0.338 Test Acc: 0.937
Validation loss decreased (-0.911106 --> -0.937034).  Saving model ...
Epoch: 7 cost time: 0.8035094738006592
Epoch: 7, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8906464576721191
Epoch: 8, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 9 cost time: 0.827387809753418
Epoch: 9, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9463920593261719
Epoch: 10, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 11 cost time: 0.8210117816925049
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.940739 --> -0.951850).  Saving model ...
Epoch: 12 cost time: 0.833747148513794
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 13 cost time: 0.7968642711639404
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 14 cost time: 0.9523425102233887
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9026525020599365
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9251112937927246
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8495659828186035
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9829027652740479
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8764312267303467
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8958113193511963
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8945431709289551
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.1194193363189697
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8267087936401367
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2321478
model size : 18.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.076526403427124
Epoch: 1, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.595 Vali Acc: 0.348 Test Loss: 1.595 Test Acc: 0.348
Validation loss decreased (inf --> -0.348132).  Saving model ...
Epoch: 2 cost time: 0.8686542510986328
Epoch: 2, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.371 Vali Acc: 0.533 Test Loss: 1.371 Test Acc: 0.533
Validation loss decreased (-0.348132 --> -0.533320).  Saving model ...
Epoch: 3 cost time: 1.0031259059906006
Epoch: 3, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.095 Vali Acc: 0.807 Test Loss: 1.095 Test Acc: 0.807
Validation loss decreased (-0.533320 --> -0.807396).  Saving model ...
Epoch: 4 cost time: 0.8818073272705078
Epoch: 4, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.736 Vali Acc: 0.867 Test Loss: 0.736 Test Acc: 0.867
Validation loss decreased (-0.807396 --> -0.866659).  Saving model ...
Epoch: 5 cost time: 0.8485751152038574
Epoch: 5, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.476 Vali Acc: 0.922 Test Loss: 0.476 Test Acc: 0.922
Validation loss decreased (-0.866659 --> -0.922217).  Saving model ...
Epoch: 6 cost time: 0.9262213706970215
Epoch: 6, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.332 Vali Acc: 0.937 Test Loss: 0.332 Test Acc: 0.937
Validation loss decreased (-0.922217 --> -0.937034).  Saving model ...
Epoch: 7 cost time: 0.8524413108825684
Epoch: 7, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 8 cost time: 1.0442564487457275
Epoch: 8, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 9 cost time: 0.8842949867248535
Epoch: 9, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8918304443359375
Epoch: 10, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 11 cost time: 0.8380730152130127
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 12 cost time: 0.9255058765411377
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 13 cost time: 0.9571621417999268
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 14 cost time: 0.9341237545013428
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 15 cost time: 0.9140076637268066
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.978032112121582
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.042015790939331
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.0256950855255127
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.967308759689331
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.0031979084014893
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.04060697555542
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.9183154106140137
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9269306659698486
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9197442531585693
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2321478
model size : 18.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.6452598571777344
Epoch: 1, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.602 Vali Acc: 0.352 Test Loss: 1.602 Test Acc: 0.352
Validation loss decreased (inf --> -0.351836).  Saving model ...
Epoch: 2 cost time: 0.8309850692749023
Epoch: 2, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.376 Vali Acc: 0.548 Test Loss: 1.376 Test Acc: 0.548
Validation loss decreased (-0.351836 --> -0.548134).  Saving model ...
Epoch: 3 cost time: 0.8638625144958496
Epoch: 3, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.099 Vali Acc: 0.793 Test Loss: 1.099 Test Acc: 0.793
Validation loss decreased (-0.548134 --> -0.792582).  Saving model ...
Epoch: 4 cost time: 0.8559188842773438
Epoch: 4, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.741 Vali Acc: 0.859 Test Loss: 0.741 Test Acc: 0.859
Validation loss decreased (-0.792582 --> -0.859252).  Saving model ...
Epoch: 5 cost time: 0.8923282623291016
Epoch: 5, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.483 Vali Acc: 0.907 Test Loss: 0.483 Test Acc: 0.907
Validation loss decreased (-0.859252 --> -0.907403).  Saving model ...
Epoch: 6 cost time: 0.914665699005127
Epoch: 6, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.338 Vali Acc: 0.933 Test Loss: 0.338 Test Acc: 0.933
Validation loss decreased (-0.907403 --> -0.933330).  Saving model ...
Epoch: 7 cost time: 0.7515580654144287
Epoch: 7, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.8321783542633057
Epoch: 8, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940739).  Saving model ...
Epoch: 9 cost time: 0.9382846355438232
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 10 cost time: 0.9025204181671143
Epoch: 10, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 11 cost time: 0.9887087345123291
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 12 cost time: 0.8710567951202393
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 13 cost time: 0.9004251956939697
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 14 cost time: 0.8772916793823242
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8536076545715332
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 16 cost time: 0.9154810905456543
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.9069492816925049
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8508193492889404
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9952409267425537
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.0450382232666016
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9995517730712891
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7531158924102783
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8674907684326172
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.0588691234588623
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8416397571563721
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2321478
model size : 18.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9335620403289795
Epoch: 1, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.574 Vali Acc: 0.344 Test Loss: 1.574 Test Acc: 0.344
Validation loss decreased (inf --> -0.344429).  Saving model ...
Epoch: 2 cost time: 0.8463699817657471
Epoch: 2, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.358 Vali Acc: 0.604 Test Loss: 1.358 Test Acc: 0.604
Validation loss decreased (-0.344429 --> -0.603690).  Saving model ...
Epoch: 3 cost time: 0.9400298595428467
Epoch: 3, Steps: 2 | Train Loss: 1.221 Vali Loss: 1.096 Vali Acc: 0.781 Test Loss: 1.096 Test Acc: 0.781
Validation loss decreased (-0.603690 --> -0.781471).  Saving model ...
Epoch: 4 cost time: 0.9019496440887451
Epoch: 4, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.761 Vali Acc: 0.859 Test Loss: 0.761 Test Acc: 0.859
Validation loss decreased (-0.781471 --> -0.859252).  Saving model ...
Epoch: 5 cost time: 0.8891136646270752
Epoch: 5, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
Validation loss decreased (-0.859252 --> -0.892587).  Saving model ...
Epoch: 6 cost time: 0.8901312351226807
Epoch: 6, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.387 Vali Acc: 0.915 Test Loss: 0.387 Test Acc: 0.915
Validation loss decreased (-0.892587 --> -0.914811).  Saving model ...
Epoch: 7 cost time: 0.9079432487487793
Epoch: 7, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.9123215675354004
Epoch: 8, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.914811 --> -0.929627).  Saving model ...
Epoch: 9 cost time: 0.862372875213623
Epoch: 9, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8286654949188232
Epoch: 10, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8378129005432129
Epoch: 11, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 12 cost time: 0.7975130081176758
Epoch: 12, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 13 cost time: 0.9319698810577393
Epoch: 13, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 14 cost time: 0.7821965217590332
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8005087375640869
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7585515975952148
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8672325611114502
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.8314485549926758
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8192214965820312
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.76694655418396
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8340854644775391
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9015347957611084
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8810100555419922
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.002770185470581
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.9226109981536865
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.0046343803405762
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.057729721069336
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.123342752456665
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.143878698348999
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 2321478
model size : 18.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1877033710479736
Epoch: 1, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.619 Vali Acc: 0.319 Test Loss: 1.619 Test Acc: 0.319
Validation loss decreased (inf --> -0.318502).  Saving model ...
Epoch: 2 cost time: 0.8147568702697754
Epoch: 2, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.406 Vali Acc: 0.467 Test Loss: 1.406 Test Acc: 0.467
Validation loss decreased (-0.318502 --> -0.466653).  Saving model ...
Epoch: 3 cost time: 0.8544914722442627
Epoch: 3, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.136 Vali Acc: 0.681 Test Loss: 1.136 Test Acc: 0.681
Validation loss decreased (-0.466653 --> -0.681470).  Saving model ...
Epoch: 4 cost time: 0.9222884178161621
Epoch: 4, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.776 Vali Acc: 0.856 Test Loss: 0.776 Test Acc: 0.856
Validation loss decreased (-0.681470 --> -0.855548).  Saving model ...
Epoch: 5 cost time: 0.8912954330444336
Epoch: 5, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.512 Vali Acc: 0.930 Test Loss: 0.512 Test Acc: 0.930
Validation loss decreased (-0.855548 --> -0.929625).  Saving model ...
Epoch: 6 cost time: 0.8738930225372314
Epoch: 6, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.353 Vali Acc: 0.937 Test Loss: 0.353 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937034).  Saving model ...
Epoch: 7 cost time: 0.871628999710083
Epoch: 7, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.256 Vali Acc: 0.941 Test Loss: 0.256 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 8 cost time: 0.8067188262939453
Epoch: 8, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 9 cost time: 1.042922019958496
Epoch: 9, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 10 cost time: 0.8136165142059326
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9112465381622314
Epoch: 11, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9029736518859863
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 13 cost time: 0.8580436706542969
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 14 cost time: 0.9837300777435303
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 15 cost time: 0.9158210754394531
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9368162155151367
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8544900417327881
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9799313545227051
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8979630470275879
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.8058993816375732
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8482458591461182
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.943695068359375
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8022117614746094
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8589367866516113
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1797190
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.127067804336548
Epoch: 1, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.583 Vali Acc: 0.352 Test Loss: 1.583 Test Acc: 0.352
Validation loss decreased (inf --> -0.351836).  Saving model ...
Epoch: 2 cost time: 0.8531012535095215
Epoch: 2, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.370 Vali Acc: 0.507 Test Loss: 1.370 Test Acc: 0.507
Validation loss decreased (-0.351836 --> -0.507394).  Saving model ...
Epoch: 3 cost time: 0.7523868083953857
Epoch: 3, Steps: 2 | Train Loss: 1.323 Vali Loss: 1.103 Vali Acc: 0.693 Test Loss: 1.103 Test Acc: 0.693
Validation loss decreased (-0.507394 --> -0.692582).  Saving model ...
Epoch: 4 cost time: 0.7732353210449219
Epoch: 4, Steps: 2 | Train Loss: 0.959 Vali Loss: 0.750 Vali Acc: 0.874 Test Loss: 0.750 Test Acc: 0.874
Validation loss decreased (-0.692582 --> -0.874067).  Saving model ...
Epoch: 5 cost time: 0.8472106456756592
Epoch: 5, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.492 Vali Acc: 0.930 Test Loss: 0.492 Test Acc: 0.930
Validation loss decreased (-0.874067 --> -0.929625).  Saving model ...
Epoch: 6 cost time: 0.8065166473388672
Epoch: 6, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.339 Vali Acc: 0.944 Test Loss: 0.339 Test Acc: 0.944
Validation loss decreased (-0.929625 --> -0.944441).  Saving model ...
Epoch: 7 cost time: 0.8267426490783691
Epoch: 7, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948146).  Saving model ...
Epoch: 8 cost time: 0.8296527862548828
Epoch: 8, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 9 cost time: 0.9389200210571289
Epoch: 9, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 10 cost time: 0.7715764045715332
Epoch: 10, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9300217628479004
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.161 Vali Acc: 0.937 Test Loss: 0.161 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9331455230712891
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.159 Vali Acc: 0.937 Test Loss: 0.159 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.9416139125823975
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 0.9113748073577881
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 15 cost time: 0.7851009368896484
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8445849418640137
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9377930164337158
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8296303749084473
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.9793124198913574
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9137332439422607
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8885283470153809
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8714828491210938
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.9973499774932861
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8549404144287109
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1797190
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0427613258361816
Epoch: 1, Steps: 2 | Train Loss: 1.820 Vali Loss: 1.606 Vali Acc: 0.326 Test Loss: 1.606 Test Acc: 0.326
Validation loss decreased (inf --> -0.325910).  Saving model ...
Epoch: 2 cost time: 0.8784561157226562
Epoch: 2, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.391 Vali Acc: 0.474 Test Loss: 1.391 Test Acc: 0.474
Validation loss decreased (-0.325910 --> -0.474060).  Saving model ...
Epoch: 3 cost time: 0.6838192939758301
Epoch: 3, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.118 Vali Acc: 0.689 Test Loss: 1.118 Test Acc: 0.689
Validation loss decreased (-0.474060 --> -0.688878).  Saving model ...
Epoch: 4 cost time: 0.7469210624694824
Epoch: 4, Steps: 2 | Train Loss: 0.955 Vali Loss: 0.758 Vali Acc: 0.893 Test Loss: 0.758 Test Acc: 0.893
Validation loss decreased (-0.688878 --> -0.892585).  Saving model ...
Epoch: 5 cost time: 0.7350022792816162
Epoch: 5, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.491 Vali Acc: 0.930 Test Loss: 0.491 Test Acc: 0.930
Validation loss decreased (-0.892585 --> -0.929625).  Saving model ...
Epoch: 6 cost time: 0.8292667865753174
Epoch: 6, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.333 Vali Acc: 0.941 Test Loss: 0.333 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940737).  Saving model ...
Epoch: 7 cost time: 0.8542351722717285
Epoch: 7, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.7686376571655273
Epoch: 8, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948146).  Saving model ...
Epoch: 9 cost time: 0.9121103286743164
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.9175806045532227
Epoch: 10, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.163 Vali Acc: 0.933 Test Loss: 0.163 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.8745887279510498
Epoch: 11, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.155 Vali Acc: 0.933 Test Loss: 0.155 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.9244256019592285
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.937 Test Loss: 0.153 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.9219772815704346
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.941 Test Loss: 0.154 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.9686923027038574
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.157 Vali Acc: 0.948 Test Loss: 0.157 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 15 cost time: 0.8348546028137207
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.9826278686523438
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8136599063873291
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8475522994995117
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.8342337608337402
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9657649993896484
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.899036169052124
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.853039026260376
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8889460563659668
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.9497263431549072
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8695447444915771
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1797190
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0710794925689697
Epoch: 1, Steps: 2 | Train Loss: 1.836 Vali Loss: 1.616 Vali Acc: 0.326 Test Loss: 1.616 Test Acc: 0.326
Validation loss decreased (inf --> -0.325910).  Saving model ...
Epoch: 2 cost time: 0.6578664779663086
Epoch: 2, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.407 Vali Acc: 0.507 Test Loss: 1.407 Test Acc: 0.507
Validation loss decreased (-0.325910 --> -0.507393).  Saving model ...
Epoch: 3 cost time: 0.6811497211456299
Epoch: 3, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.148 Vali Acc: 0.715 Test Loss: 1.148 Test Acc: 0.715
Validation loss decreased (-0.507393 --> -0.714803).  Saving model ...
Epoch: 4 cost time: 0.7712452411651611
Epoch: 4, Steps: 2 | Train Loss: 1.023 Vali Loss: 0.805 Vali Acc: 0.841 Test Loss: 0.805 Test Acc: 0.841
Validation loss decreased (-0.714803 --> -0.840733).  Saving model ...
Epoch: 5 cost time: 0.8138928413391113
Epoch: 5, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.546 Vali Acc: 0.907 Test Loss: 0.546 Test Acc: 0.907
Validation loss decreased (-0.840733 --> -0.907402).  Saving model ...
Epoch: 6 cost time: 0.7349627017974854
Epoch: 6, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 7 cost time: 0.6853196620941162
Epoch: 7, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 8 cost time: 0.7299754619598389
Epoch: 8, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.7732276916503906
Epoch: 9, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.0203704833984375
Epoch: 10, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.7951116561889648
Epoch: 11, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.7968049049377441
Epoch: 12, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 1.1365370750427246
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.7290418148040771
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8097188472747803
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.865117073059082
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8436751365661621
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.8226704597473145
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.9358880519866943
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.757749080657959
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.7734096050262451
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.910691499710083
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.8260397911071777
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1797190
model size : 16.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7398784160614014
Epoch: 1, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.669 Vali Acc: 0.359 Test Loss: 1.669 Test Acc: 0.359
Validation loss decreased (inf --> -0.359243).  Saving model ...
Epoch: 2 cost time: 0.8475265502929688
Epoch: 2, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.465 Vali Acc: 0.522 Test Loss: 1.465 Test Acc: 0.522
Validation loss decreased (-0.359243 --> -0.522208).  Saving model ...
Epoch: 3 cost time: 0.7841432094573975
Epoch: 3, Steps: 2 | Train Loss: 1.417 Vali Loss: 1.200 Vali Acc: 0.648 Test Loss: 1.200 Test Acc: 0.648
Validation loss decreased (-0.522208 --> -0.648136).  Saving model ...
Epoch: 4 cost time: 0.8646707534790039
Epoch: 4, Steps: 2 | Train Loss: 1.048 Vali Loss: 0.858 Vali Acc: 0.763 Test Loss: 0.858 Test Acc: 0.763
Validation loss decreased (-0.648136 --> -0.762954).  Saving model ...
Epoch: 5 cost time: 0.8644435405731201
Epoch: 5, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.602 Vali Acc: 0.844 Test Loss: 0.602 Test Acc: 0.844
Validation loss decreased (-0.762954 --> -0.844438).  Saving model ...
Epoch: 6 cost time: 0.8543803691864014
Epoch: 6, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.442 Vali Acc: 0.878 Test Loss: 0.442 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877773).  Saving model ...
Epoch: 7 cost time: 0.9520838260650635
Epoch: 7, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
Validation loss decreased (-0.877773 --> -0.918515).  Saving model ...
Epoch: 8 cost time: 0.8131625652313232
Epoch: 8, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933331).  Saving model ...
Epoch: 9 cost time: 0.9742052555084229
Epoch: 9, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 10 cost time: 0.8274168968200684
Epoch: 10, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.8376781940460205
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8242549896240234
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.9697861671447754
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.7988171577453613
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.890892505645752
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8715293407440186
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.8661894798278809
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9178078174591064
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.0278949737548828
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7890536785125732
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.8241105079650879
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8095881938934326
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8412966728210449
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.9206860065460205
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1535046
model size : 15.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1355719566345215
Epoch: 1, Steps: 2 | Train Loss: 1.951 Vali Loss: 1.649 Vali Acc: 0.407 Test Loss: 1.649 Test Acc: 0.407
Validation loss decreased (inf --> -0.407391).  Saving model ...
Epoch: 2 cost time: 0.7364332675933838
Epoch: 2, Steps: 2 | Train Loss: 1.542 Vali Loss: 1.446 Vali Acc: 0.548 Test Loss: 1.446 Test Acc: 0.548
Validation loss decreased (-0.407391 --> -0.548134).  Saving model ...
Epoch: 3 cost time: 0.8613913059234619
Epoch: 3, Steps: 2 | Train Loss: 1.374 Vali Loss: 1.182 Vali Acc: 0.659 Test Loss: 1.182 Test Acc: 0.659
Validation loss decreased (-0.548134 --> -0.659247).  Saving model ...
Epoch: 4 cost time: 0.9255275726318359
Epoch: 4, Steps: 2 | Train Loss: 1.033 Vali Loss: 0.840 Vali Acc: 0.781 Test Loss: 0.840 Test Acc: 0.781
Validation loss decreased (-0.659247 --> -0.781473).  Saving model ...
Epoch: 5 cost time: 0.7431812286376953
Epoch: 5, Steps: 2 | Train Loss: 0.643 Vali Loss: 0.587 Vali Acc: 0.863 Test Loss: 0.587 Test Acc: 0.863
Validation loss decreased (-0.781473 --> -0.862957).  Saving model ...
Epoch: 6 cost time: 0.7779943943023682
Epoch: 6, Steps: 2 | Train Loss: 0.349 Vali Loss: 0.433 Vali Acc: 0.874 Test Loss: 0.433 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874070).  Saving model ...
Epoch: 7 cost time: 0.7896814346313477
Epoch: 7, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.317 Vali Acc: 0.919 Test Loss: 0.317 Test Acc: 0.919
Validation loss decreased (-0.874070 --> -0.918515).  Saving model ...
Epoch: 8 cost time: 0.8033573627471924
Epoch: 8, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933331).  Saving model ...
Epoch: 9 cost time: 0.9483621120452881
Epoch: 9, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 10 cost time: 0.8124327659606934
Epoch: 10, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.823012113571167
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9397776126861572
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.964423656463623
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 1.0089092254638672
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
Validation loss decreased (-0.940739 --> -0.951850).  Saving model ...
Epoch: 15 cost time: 0.9123151302337646
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.0434339046478271
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.192420244216919
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.065340518951416
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.1943089962005615
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.9396417140960693
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.0931570529937744
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.000990867614746
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8745043277740479
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8873867988586426
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1535046
model size : 15.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3971683979034424
Epoch: 1, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.651 Vali Acc: 0.419 Test Loss: 1.651 Test Acc: 0.419
Validation loss decreased (inf --> -0.418502).  Saving model ...
Epoch: 2 cost time: 0.7721729278564453
Epoch: 2, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.446 Vali Acc: 0.567 Test Loss: 1.446 Test Acc: 0.567
Validation loss decreased (-0.418502 --> -0.566652).  Saving model ...
Epoch: 3 cost time: 0.7256994247436523
Epoch: 3, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.181 Vali Acc: 0.663 Test Loss: 1.181 Test Acc: 0.663
Validation loss decreased (-0.566652 --> -0.662951).  Saving model ...
Epoch: 4 cost time: 0.8439276218414307
Epoch: 4, Steps: 2 | Train Loss: 1.026 Vali Loss: 0.839 Vali Acc: 0.815 Test Loss: 0.839 Test Acc: 0.815
Validation loss decreased (-0.662951 --> -0.814806).  Saving model ...
Epoch: 5 cost time: 0.8417577743530273
Epoch: 5, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.587 Vali Acc: 0.859 Test Loss: 0.587 Test Acc: 0.859
Validation loss decreased (-0.814806 --> -0.859253).  Saving model ...
Epoch: 6 cost time: 0.9110949039459229
Epoch: 6, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.436 Vali Acc: 0.874 Test Loss: 0.436 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874070).  Saving model ...
Epoch: 7 cost time: 0.8272690773010254
Epoch: 7, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
Validation loss decreased (-0.874070 --> -0.907404).  Saving model ...
Epoch: 8 cost time: 0.7645552158355713
Epoch: 8, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.253 Vali Acc: 0.915 Test Loss: 0.253 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 9 cost time: 0.7340776920318604
Epoch: 9, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 10 cost time: 0.806387186050415
Epoch: 10, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 11 cost time: 0.8946290016174316
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 12 cost time: 0.7938411235809326
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 13 cost time: 0.7844982147216797
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.926 Test Loss: 0.186 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8394527435302734
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.189 Vali Acc: 0.926 Test Loss: 0.189 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.9039244651794434
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7534656524658203
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9724547863006592
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8820734024047852
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.9502108097076416
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.8508758544921875
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.8784241676330566
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.7502467632293701
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1535046
model size : 15.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0594398975372314
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.663 Vali Acc: 0.344 Test Loss: 1.663 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 0.836237907409668
Epoch: 2, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.460 Vali Acc: 0.552 Test Loss: 1.460 Test Acc: 0.552
Validation loss decreased (-0.344428 --> -0.551837).  Saving model ...
Epoch: 3 cost time: 0.8419368267059326
Epoch: 3, Steps: 2 | Train Loss: 1.411 Vali Loss: 1.197 Vali Acc: 0.663 Test Loss: 1.197 Test Acc: 0.663
Validation loss decreased (-0.551837 --> -0.662951).  Saving model ...
Epoch: 4 cost time: 0.9163181781768799
Epoch: 4, Steps: 2 | Train Loss: 1.114 Vali Loss: 0.861 Vali Acc: 0.811 Test Loss: 0.861 Test Acc: 0.811
Validation loss decreased (-0.662951 --> -0.811103).  Saving model ...
Epoch: 5 cost time: 0.8413124084472656
Epoch: 5, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.615 Vali Acc: 0.859 Test Loss: 0.615 Test Acc: 0.859
Validation loss decreased (-0.811103 --> -0.859253).  Saving model ...
Epoch: 6 cost time: 0.8747477531433105
Epoch: 6, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.467 Vali Acc: 0.881 Test Loss: 0.467 Test Acc: 0.881
Validation loss decreased (-0.859253 --> -0.881477).  Saving model ...
Epoch: 7 cost time: 0.8856537342071533
Epoch: 7, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.366 Vali Acc: 0.893 Test Loss: 0.366 Test Acc: 0.893
Validation loss decreased (-0.881477 --> -0.892589).  Saving model ...
Epoch: 8 cost time: 0.9865298271179199
Epoch: 8, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.301 Vali Acc: 0.904 Test Loss: 0.301 Test Acc: 0.904
Validation loss decreased (-0.892589 --> -0.903701).  Saving model ...
Epoch: 9 cost time: 0.8672945499420166
Epoch: 9, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
Validation loss decreased (-0.903701 --> -0.914812).  Saving model ...
Epoch: 10 cost time: 0.9335041046142578
Epoch: 10, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 11 cost time: 0.9087119102478027
Epoch: 11, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 12 cost time: 0.8962299823760986
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 0.8810937404632568
Epoch: 13, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 0.8339569568634033
Epoch: 14, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9961979389190674
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7835187911987305
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8536136150360107
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.9895756244659424
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.922 Test Loss: 0.231 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.051025152206421
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8396623134613037
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.0325195789337158
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 0.9161295890808105
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.1575629711151123
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.999272346496582
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.926 Test Loss: 0.241 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.113576889038086
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.019479513168335
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.0921595096588135
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.0273895263671875
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.926 Test Loss: 0.244 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0207033157348633
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.0439393520355225
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.061579942703247
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 1535046
model size : 15.64MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9614195823669434
Epoch: 1, Steps: 2 | Train Loss: 1.996 Vali Loss: 1.799 Vali Acc: 0.178 Test Loss: 1.799 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.511542558670044
Epoch: 2, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.602 Vali Acc: 0.352 Test Loss: 1.602 Test Acc: 0.352
Validation loss decreased (-0.177760 --> -0.351836).  Saving model ...
Epoch: 3 cost time: 0.49279165267944336
Epoch: 3, Steps: 2 | Train Loss: 1.475 Vali Loss: 1.322 Vali Acc: 0.533 Test Loss: 1.322 Test Acc: 0.533
Validation loss decreased (-0.351836 --> -0.533320).  Saving model ...
Epoch: 4 cost time: 0.5322787761688232
Epoch: 4, Steps: 2 | Train Loss: 1.093 Vali Loss: 0.931 Vali Acc: 0.726 Test Loss: 0.931 Test Acc: 0.726
Validation loss decreased (-0.533320 --> -0.725917).  Saving model ...
Epoch: 5 cost time: 0.5312964916229248
Epoch: 5, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.637 Vali Acc: 0.811 Test Loss: 0.637 Test Acc: 0.811
Validation loss decreased (-0.725917 --> -0.811105).  Saving model ...
Epoch: 6 cost time: 0.5382513999938965
Epoch: 6, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.439 Vali Acc: 0.867 Test Loss: 0.439 Test Acc: 0.867
Validation loss decreased (-0.811105 --> -0.866662).  Saving model ...
Epoch: 7 cost time: 0.5621054172515869
Epoch: 7, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.313 Vali Acc: 0.904 Test Loss: 0.313 Test Acc: 0.904
Validation loss decreased (-0.866662 --> -0.903701).  Saving model ...
Epoch: 8 cost time: 0.5371992588043213
Epoch: 8, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.903701 --> -0.940738).  Saving model ...
Epoch: 9 cost time: 0.6365044116973877
Epoch: 9, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.5839650630950928
Epoch: 10, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.6392395496368408
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.926 Test Loss: 0.188 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.68013596534729
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6868922710418701
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.622420072555542
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.6140134334564209
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.6199042797088623
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.7197203636169434
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6356062889099121
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.609870195388794
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.6034848690032959
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6027112007141113
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5911734104156494
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6328070163726807
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5834805965423584
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.709277868270874
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.6598167419433594
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6160459518432617
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.6522197723388672
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6691691875457764
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 1403974
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.155256748199463
Epoch: 1, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.813 Vali Acc: 0.148 Test Loss: 1.813 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.8257811069488525
Epoch: 2, Steps: 2 | Train Loss: 1.678 Vali Loss: 1.613 Vali Acc: 0.333 Test Loss: 1.613 Test Acc: 0.333
Validation loss decreased (-0.148130 --> -0.333317).  Saving model ...
Epoch: 3 cost time: 0.8371081352233887
Epoch: 3, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.329 Vali Acc: 0.515 Test Loss: 1.329 Test Acc: 0.515
Validation loss decreased (-0.333317 --> -0.514802).  Saving model ...
Epoch: 4 cost time: 0.7471849918365479
Epoch: 4, Steps: 2 | Train Loss: 1.092 Vali Loss: 0.934 Vali Acc: 0.685 Test Loss: 0.934 Test Acc: 0.685
Validation loss decreased (-0.514802 --> -0.685176).  Saving model ...
Epoch: 5 cost time: 0.8778884410858154
Epoch: 5, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.635 Vali Acc: 0.807 Test Loss: 0.635 Test Acc: 0.807
Validation loss decreased (-0.685176 --> -0.807401).  Saving model ...
Epoch: 6 cost time: 0.9010899066925049
Epoch: 6, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.435 Vali Acc: 0.870 Test Loss: 0.435 Test Acc: 0.870
Validation loss decreased (-0.807401 --> -0.870366).  Saving model ...
Epoch: 7 cost time: 0.9217145442962646
Epoch: 7, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.317 Vali Acc: 0.904 Test Loss: 0.317 Test Acc: 0.904
Validation loss decreased (-0.870366 --> -0.903701).  Saving model ...
Epoch: 8 cost time: 0.8887078762054443
Epoch: 8, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.903701 --> -0.929627).  Saving model ...
Epoch: 9 cost time: 0.8306264877319336
Epoch: 9, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 10 cost time: 0.8637814521789551
Epoch: 10, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9177141189575195
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.9031190872192383
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.109797716140747
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.0595464706420898
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.930 Test Loss: 0.176 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 0.8345444202423096
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 16 cost time: 1.0317614078521729
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.7939088344573975
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8688273429870605
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.9439363479614258
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9148008823394775
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.8551993370056152
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9048182964324951
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8973550796508789
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.801081657409668
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.770117998123169
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.847447395324707
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8650362491607666
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.9265313148498535
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.8767778873443604
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.8481407165527344
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.9979376792907715
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.9493715763092041
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9547138214111328
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.8865628242492676
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.9295763969421387
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9332296848297119
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.9213802814483643
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9058637619018555
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1403974
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9467613697052
Epoch: 1, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.787 Vali Acc: 0.204 Test Loss: 1.787 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.7535591125488281
Epoch: 2, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.584 Vali Acc: 0.367 Test Loss: 1.584 Test Acc: 0.367
Validation loss decreased (-0.203686 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 0.887639045715332
Epoch: 3, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.301 Vali Acc: 0.574 Test Loss: 1.301 Test Acc: 0.574
Validation loss decreased (-0.366651 --> -0.574061).  Saving model ...
Epoch: 4 cost time: 0.8788514137268066
Epoch: 4, Steps: 2 | Train Loss: 1.071 Vali Loss: 0.913 Vali Acc: 0.726 Test Loss: 0.913 Test Acc: 0.726
Validation loss decreased (-0.574061 --> -0.725917).  Saving model ...
Epoch: 5 cost time: 0.8788073062896729
Epoch: 5, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.620 Vali Acc: 0.807 Test Loss: 0.620 Test Acc: 0.807
Validation loss decreased (-0.725917 --> -0.807401).  Saving model ...
Epoch: 6 cost time: 0.9166638851165771
Epoch: 6, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.426 Vali Acc: 0.904 Test Loss: 0.426 Test Acc: 0.904
Validation loss decreased (-0.807401 --> -0.903699).  Saving model ...
Epoch: 7 cost time: 0.7936615943908691
Epoch: 7, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.314 Vali Acc: 0.919 Test Loss: 0.314 Test Acc: 0.919
Validation loss decreased (-0.903699 --> -0.918515).  Saving model ...
Epoch: 8 cost time: 0.8690764904022217
Epoch: 8, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.251 Vali Acc: 0.919 Test Loss: 0.251 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 9 cost time: 0.7987720966339111
Epoch: 9, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 10 cost time: 0.8725094795227051
Epoch: 10, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 11 cost time: 0.8480961322784424
Epoch: 11, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.7705047130584717
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 13 cost time: 0.784299373626709
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8177664279937744
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.872133731842041
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.9027657508850098
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.9767251014709473
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.8366632461547852
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.838388204574585
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.0845212936401367
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.9044637680053711
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.9337310791015625
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 1.0366487503051758
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9311556816101074
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.7688074111938477
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8540389537811279
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.78287672996521
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.7771060466766357
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9024486541748047
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9733259677886963
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.091618537902832
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.9671242237091064
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1403974
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.473083257675171
Epoch: 1, Steps: 2 | Train Loss: 1.944 Vali Loss: 1.718 Vali Acc: 0.244 Test Loss: 1.718 Test Acc: 0.244
Validation loss decreased (inf --> -0.244427).  Saving model ...
Epoch: 2 cost time: 0.8111546039581299
Epoch: 2, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.523 Vali Acc: 0.381 Test Loss: 1.523 Test Acc: 0.381
Validation loss decreased (-0.244427 --> -0.381466).  Saving model ...
Epoch: 3 cost time: 0.8316783905029297
Epoch: 3, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.258 Vali Acc: 0.600 Test Loss: 1.258 Test Acc: 0.600
Validation loss decreased (-0.381466 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.864832878112793
Epoch: 4, Steps: 2 | Train Loss: 1.059 Vali Loss: 0.899 Vali Acc: 0.704 Test Loss: 0.899 Test Acc: 0.704
Validation loss decreased (-0.599987 --> -0.703695).  Saving model ...
Epoch: 5 cost time: 0.7437770366668701
Epoch: 5, Steps: 2 | Train Loss: 0.703 Vali Loss: 0.636 Vali Acc: 0.793 Test Loss: 0.636 Test Acc: 0.793
Validation loss decreased (-0.703695 --> -0.792586).  Saving model ...
Epoch: 6 cost time: 0.758526086807251
Epoch: 6, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.462 Vali Acc: 0.830 Test Loss: 0.462 Test Acc: 0.830
Validation loss decreased (-0.792586 --> -0.829625).  Saving model ...
Epoch: 7 cost time: 1.1522514820098877
Epoch: 7, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.365 Vali Acc: 0.859 Test Loss: 0.365 Test Acc: 0.859
Validation loss decreased (-0.829625 --> -0.859256).  Saving model ...
Epoch: 8 cost time: 0.8324096202850342
Epoch: 8, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.859256 --> -0.911108).  Saving model ...
Epoch: 9 cost time: 0.8546204566955566
Epoch: 9, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 10 cost time: 0.8346724510192871
Epoch: 10, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.237 Vali Acc: 0.915 Test Loss: 0.237 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8510642051696777
Epoch: 11, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 12 cost time: 0.8004519939422607
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 13 cost time: 0.786224365234375
Epoch: 13, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.7655801773071289
Epoch: 14, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.8381776809692383
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8448019027709961
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9550669193267822
Epoch: 17, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7812294960021973
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7117295265197754
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.874239444732666
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7189772129058838
Epoch: 21, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8188521862030029
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7959108352661133
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.7593119144439697
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1403974
model size : 15.14MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.265296697616577
Epoch: 1, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.553 Vali Acc: 0.393 Test Loss: 1.553 Test Acc: 0.393
Validation loss decreased (inf --> -0.392577).  Saving model ...
Epoch: 2 cost time: 0.7641522884368896
Epoch: 2, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.412 Vali Acc: 0.574 Test Loss: 1.412 Test Acc: 0.574
Validation loss decreased (-0.392577 --> -0.574060).  Saving model ...
Epoch: 3 cost time: 0.8166956901550293
Epoch: 3, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.260 Vali Acc: 0.737 Test Loss: 1.260 Test Acc: 0.737
Validation loss decreased (-0.574060 --> -0.737024).  Saving model ...
Epoch: 4 cost time: 0.7561004161834717
Epoch: 4, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.047 Vali Acc: 0.826 Test Loss: 1.047 Test Acc: 0.826
Validation loss decreased (-0.737024 --> -0.825915).  Saving model ...
Epoch: 5 cost time: 0.7712528705596924
Epoch: 5, Steps: 2 | Train Loss: 1.016 Vali Loss: 0.833 Vali Acc: 0.893 Test Loss: 0.833 Test Acc: 0.893
Validation loss decreased (-0.825915 --> -0.892584).  Saving model ...
Epoch: 6 cost time: 0.6826732158660889
Epoch: 6, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.650 Vali Acc: 0.922 Test Loss: 0.650 Test Acc: 0.922
Validation loss decreased (-0.892584 --> -0.922216).  Saving model ...
Epoch: 7 cost time: 0.8039085865020752
Epoch: 7, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.506 Vali Acc: 0.933 Test Loss: 0.506 Test Acc: 0.933
Validation loss decreased (-0.922216 --> -0.933328).  Saving model ...
Epoch: 8 cost time: 0.8178679943084717
Epoch: 8, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.398 Vali Acc: 0.944 Test Loss: 0.398 Test Acc: 0.944
Validation loss decreased (-0.933328 --> -0.944440).  Saving model ...
Epoch: 9 cost time: 0.7711062431335449
Epoch: 9, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.322 Vali Acc: 0.952 Test Loss: 0.322 Test Acc: 0.952
Validation loss decreased (-0.944440 --> -0.951849).  Saving model ...
Epoch: 10 cost time: 0.7363114356994629
Epoch: 10, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.265 Vali Acc: 0.952 Test Loss: 0.265 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 11 cost time: 0.7972853183746338
Epoch: 11, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8093328475952148
Epoch: 12, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8682279586791992
Epoch: 13, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.8690047264099121
Epoch: 14, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.8459084033966064
Epoch: 15, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.8718059062957764
Epoch: 16, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.0010552406311035
Epoch: 17, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.8887279033660889
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.9594340324401855
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.941 Test Loss: 0.159 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.8016364574432373
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 2471494
model size : 14.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.971336603164673
Epoch: 1, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.547 Vali Acc: 0.385 Test Loss: 1.547 Test Acc: 0.385
Validation loss decreased (inf --> -0.385170).  Saving model ...
Epoch: 2 cost time: 0.8321552276611328
Epoch: 2, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.405 Vali Acc: 0.570 Test Loss: 1.405 Test Acc: 0.570
Validation loss decreased (-0.385170 --> -0.570356).  Saving model ...
Epoch: 3 cost time: 0.7149524688720703
Epoch: 3, Steps: 2 | Train Loss: 1.295 Vali Loss: 1.253 Vali Acc: 0.752 Test Loss: 1.253 Test Acc: 0.752
Validation loss decreased (-0.570356 --> -0.751839).  Saving model ...
Epoch: 4 cost time: 0.7583749294281006
Epoch: 4, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.040 Vali Acc: 0.852 Test Loss: 1.040 Test Acc: 0.852
Validation loss decreased (-0.751839 --> -0.851841).  Saving model ...
Epoch: 5 cost time: 0.7548635005950928
Epoch: 5, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.825 Vali Acc: 0.893 Test Loss: 0.825 Test Acc: 0.893
Validation loss decreased (-0.851841 --> -0.892584).  Saving model ...
Epoch: 6 cost time: 0.8366744518280029
Epoch: 6, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.643 Vali Acc: 0.911 Test Loss: 0.643 Test Acc: 0.911
Validation loss decreased (-0.892584 --> -0.911105).  Saving model ...
Epoch: 7 cost time: 0.862285852432251
Epoch: 7, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.500 Vali Acc: 0.926 Test Loss: 0.500 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 8 cost time: 0.8488261699676514
Epoch: 8, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.394 Vali Acc: 0.933 Test Loss: 0.394 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 9 cost time: 0.8674774169921875
Epoch: 9, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.319 Vali Acc: 0.933 Test Loss: 0.319 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 10 cost time: 0.9661798477172852
Epoch: 10, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 11 cost time: 0.9628775119781494
Epoch: 11, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 12 cost time: 0.9475486278533936
Epoch: 12, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.7497615814208984
Epoch: 13, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 0.7654364109039307
Epoch: 14, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.7895722389221191
Epoch: 15, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.8107783794403076
Epoch: 16, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7730777263641357
Epoch: 17, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.705146074295044
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7469933032989502
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.8076138496398926
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8604109287261963
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.941 Test Loss: 0.160 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.9393670558929443
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.941 Test Loss: 0.161 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8719635009765625
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.941 Test Loss: 0.162 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8324830532073975
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.8252873420715332
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 2471494
model size : 14.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.399068832397461
Epoch: 1, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.557 Vali Acc: 0.356 Test Loss: 1.557 Test Acc: 0.356
Validation loss decreased (inf --> -0.355540).  Saving model ...
Epoch: 2 cost time: 0.7301084995269775
Epoch: 2, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.412 Vali Acc: 0.544 Test Loss: 1.412 Test Acc: 0.544
Validation loss decreased (-0.355540 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.717681884765625
Epoch: 3, Steps: 2 | Train Loss: 1.281 Vali Loss: 1.257 Vali Acc: 0.744 Test Loss: 1.257 Test Acc: 0.744
Validation loss decreased (-0.544430 --> -0.744432).  Saving model ...
Epoch: 4 cost time: 0.8413941860198975
Epoch: 4, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.042 Vali Acc: 0.863 Test Loss: 1.042 Test Acc: 0.863
Validation loss decreased (-0.744432 --> -0.862953).  Saving model ...
Epoch: 5 cost time: 0.8456552028656006
Epoch: 5, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.825 Vali Acc: 0.881 Test Loss: 0.825 Test Acc: 0.881
Validation loss decreased (-0.862953 --> -0.881473).  Saving model ...
Epoch: 6 cost time: 0.8169305324554443
Epoch: 6, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.640 Vali Acc: 0.904 Test Loss: 0.640 Test Acc: 0.904
Validation loss decreased (-0.881473 --> -0.903697).  Saving model ...
Epoch: 7 cost time: 0.7997374534606934
Epoch: 7, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.496 Vali Acc: 0.922 Test Loss: 0.496 Test Acc: 0.922
Validation loss decreased (-0.903697 --> -0.922217).  Saving model ...
Epoch: 8 cost time: 0.7520203590393066
Epoch: 8, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.392 Vali Acc: 0.926 Test Loss: 0.392 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 9 cost time: 0.8132429122924805
Epoch: 9, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.318 Vali Acc: 0.933 Test Loss: 0.318 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 10 cost time: 0.8156712055206299
Epoch: 10, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 11 cost time: 0.8838357925415039
Epoch: 11, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 12 cost time: 0.8481488227844238
Epoch: 12, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.858098030090332
Epoch: 13, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 14 cost time: 0.8711144924163818
Epoch: 14, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7730329036712646
Epoch: 15, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.7009158134460449
Epoch: 16, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.7970728874206543
Epoch: 17, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 0.6895458698272705
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.6898648738861084
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.8036084175109863
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 21 cost time: 0.7234232425689697
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.948 Test Loss: 0.159 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7871463298797607
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.7677145004272461
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8951246738433838
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.9307765960693359
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8029348850250244
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.0705852508544922
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.07975172996521
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 1.025033950805664
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7962052822113037
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.8778934478759766
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8374323844909668
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.9433460235595703
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.909226655960083
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 1.1109681129455566
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.9468762874603271
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 1.0396249294281006
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.9835121631622314
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 2471494
model size : 14.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1727135181427
Epoch: 1, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.520 Vali Acc: 0.411 Test Loss: 1.520 Test Acc: 0.411
Validation loss decreased (inf --> -0.411096).  Saving model ...
Epoch: 2 cost time: 0.8833024501800537
Epoch: 2, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.383 Vali Acc: 0.589 Test Loss: 1.383 Test Acc: 0.589
Validation loss decreased (-0.411096 --> -0.588875).  Saving model ...
Epoch: 3 cost time: 0.8881235122680664
Epoch: 3, Steps: 2 | Train Loss: 1.278 Vali Loss: 1.235 Vali Acc: 0.763 Test Loss: 1.235 Test Acc: 0.763
Validation loss decreased (-0.588875 --> -0.762951).  Saving model ...
Epoch: 4 cost time: 0.8838975429534912
Epoch: 4, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.029 Vali Acc: 0.815 Test Loss: 1.029 Test Acc: 0.815
Validation loss decreased (-0.762951 --> -0.814805).  Saving model ...
Epoch: 5 cost time: 0.8126599788665771
Epoch: 5, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.824 Vali Acc: 0.844 Test Loss: 0.824 Test Acc: 0.844
Validation loss decreased (-0.814805 --> -0.844436).  Saving model ...
Epoch: 6 cost time: 0.8889026641845703
Epoch: 6, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.651 Vali Acc: 0.878 Test Loss: 0.651 Test Acc: 0.878
Validation loss decreased (-0.844436 --> -0.877771).  Saving model ...
Epoch: 7 cost time: 0.97981858253479
Epoch: 7, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.516 Vali Acc: 0.900 Test Loss: 0.516 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.9501290321350098
Epoch: 8, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.418 Vali Acc: 0.915 Test Loss: 0.418 Test Acc: 0.915
Validation loss decreased (-0.899995 --> -0.914811).  Saving model ...
Epoch: 9 cost time: 0.7900331020355225
Epoch: 9, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.349 Vali Acc: 0.926 Test Loss: 0.349 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 10 cost time: 0.9373784065246582
Epoch: 10, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.294 Vali Acc: 0.937 Test Loss: 0.294 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 11 cost time: 0.8595428466796875
Epoch: 11, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.877068281173706
Epoch: 12, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.7864017486572266
Epoch: 13, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.8723714351654053
Epoch: 14, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8758769035339355
Epoch: 15, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 16 cost time: 0.8492932319641113
Epoch: 16, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.792978048324585
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.932431697845459
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9023489952087402
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.9173612594604492
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.9051132202148438
Epoch: 21, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.7996261119842529
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.9153292179107666
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.7584395408630371
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.9704978466033936
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 2471494
model size : 14.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9950575828552246
Epoch: 1, Steps: 2 | Train Loss: 2.099 Vali Loss: 2.010 Vali Acc: 0.074 Test Loss: 2.010 Test Acc: 0.074
Validation loss decreased (inf --> -0.074054).  Saving model ...
Epoch: 2 cost time: 0.6847615242004395
Epoch: 2, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.844 Vali Acc: 0.170 Test Loss: 1.844 Test Acc: 0.170
Validation loss decreased (-0.074054 --> -0.170352).  Saving model ...
Epoch: 3 cost time: 0.7705245018005371
Epoch: 3, Steps: 2 | Train Loss: 1.705 Vali Loss: 1.656 Vali Acc: 0.333 Test Loss: 1.656 Test Acc: 0.333
Validation loss decreased (-0.170352 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.8313236236572266
Epoch: 4, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.390 Vali Acc: 0.504 Test Loss: 1.390 Test Acc: 0.504
Validation loss decreased (-0.333317 --> -0.503690).  Saving model ...
Epoch: 5 cost time: 0.7858176231384277
Epoch: 5, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.109 Vali Acc: 0.678 Test Loss: 1.109 Test Acc: 0.678
Validation loss decreased (-0.503690 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 0.76322340965271
Epoch: 6, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.864 Vali Acc: 0.781 Test Loss: 0.864 Test Acc: 0.781
Validation loss decreased (-0.677767 --> -0.781473).  Saving model ...
Epoch: 7 cost time: 0.7610664367675781
Epoch: 7, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.672 Vali Acc: 0.848 Test Loss: 0.672 Test Acc: 0.848
Validation loss decreased (-0.781473 --> -0.848141).  Saving model ...
Epoch: 8 cost time: 0.7560391426086426
Epoch: 8, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.532 Vali Acc: 0.881 Test Loss: 0.532 Test Acc: 0.881
Validation loss decreased (-0.848141 --> -0.881476).  Saving model ...
Epoch: 9 cost time: 0.9149410724639893
Epoch: 9, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.7205047607421875
Epoch: 10, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.341 Vali Acc: 0.926 Test Loss: 0.341 Test Acc: 0.926
Validation loss decreased (-0.899996 --> -0.925923).  Saving model ...
Epoch: 11 cost time: 0.7828857898712158
Epoch: 11, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8656995296478271
Epoch: 12, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.7752048969268799
Epoch: 13, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 14 cost time: 0.9541761875152588
Epoch: 14, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8658368587493896
Epoch: 15, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.8212904930114746
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7889471054077148
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9097549915313721
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.7912254333496094
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 20 cost time: 0.9163990020751953
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.9541146755218506
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.7891280651092529
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.7641172409057617
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.7544243335723877
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.7911989688873291
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.8609633445739746
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 1.103006362915039
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.075169563293457
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.9474573135375977
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.0324769020080566
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.8929245471954346
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8459570407867432
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.1329669952392578
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.9836585521697998
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9851634502410889
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.2742996215820312
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1422918
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.4278154373168945
Epoch: 1, Steps: 2 | Train Loss: 2.094 Vali Loss: 2.000 Vali Acc: 0.085 Test Loss: 2.000 Test Acc: 0.085
Validation loss decreased (inf --> -0.085165).  Saving model ...
Epoch: 2 cost time: 0.8106932640075684
Epoch: 2, Steps: 2 | Train Loss: 1.980 Vali Loss: 1.833 Vali Acc: 0.159 Test Loss: 1.833 Test Acc: 0.159
Validation loss decreased (-0.085165 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.7634162902832031
Epoch: 3, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.643 Vali Acc: 0.337 Test Loss: 1.643 Test Acc: 0.337
Validation loss decreased (-0.159241 --> -0.337021).  Saving model ...
Epoch: 4 cost time: 0.7589786052703857
Epoch: 4, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.377 Vali Acc: 0.526 Test Loss: 1.377 Test Acc: 0.526
Validation loss decreased (-0.337021 --> -0.525912).  Saving model ...
Epoch: 5 cost time: 0.8017885684967041
Epoch: 5, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.095 Vali Acc: 0.696 Test Loss: 1.095 Test Acc: 0.696
Validation loss decreased (-0.525912 --> -0.696285).  Saving model ...
Epoch: 6 cost time: 0.7733154296875
Epoch: 6, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.849 Vali Acc: 0.796 Test Loss: 0.849 Test Acc: 0.796
Validation loss decreased (-0.696285 --> -0.796288).  Saving model ...
Epoch: 7 cost time: 0.8202347755432129
Epoch: 7, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.656 Vali Acc: 0.870 Test Loss: 0.656 Test Acc: 0.870
Validation loss decreased (-0.796288 --> -0.870364).  Saving model ...
Epoch: 8 cost time: 0.8219513893127441
Epoch: 8, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.515 Vali Acc: 0.893 Test Loss: 0.515 Test Acc: 0.893
Validation loss decreased (-0.870364 --> -0.892587).  Saving model ...
Epoch: 9 cost time: 0.7531375885009766
Epoch: 9, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.411 Vali Acc: 0.904 Test Loss: 0.411 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903700).  Saving model ...
Epoch: 10 cost time: 0.7611713409423828
Epoch: 10, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
Validation loss decreased (-0.903700 --> -0.929626).  Saving model ...
Epoch: 11 cost time: 0.7982640266418457
Epoch: 11, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 12 cost time: 0.8289144039154053
Epoch: 12, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 13 cost time: 0.8426742553710938
Epoch: 13, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 14 cost time: 0.9053740501403809
Epoch: 14, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 15 cost time: 0.6807122230529785
Epoch: 15, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8284027576446533
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7598509788513184
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7929694652557373
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.8348433971405029
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7944586277008057
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7013740539550781
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.8845493793487549
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.8116264343261719
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8769183158874512
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1422918
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.864781379699707
Epoch: 1, Steps: 2 | Train Loss: 2.100 Vali Loss: 2.016 Vali Acc: 0.059 Test Loss: 2.016 Test Acc: 0.059
Validation loss decreased (inf --> -0.059239).  Saving model ...
Epoch: 2 cost time: 0.8635013103485107
Epoch: 2, Steps: 2 | Train Loss: 1.923 Vali Loss: 1.846 Vali Acc: 0.141 Test Loss: 1.846 Test Acc: 0.141
Validation loss decreased (-0.059239 --> -0.140722).  Saving model ...
Epoch: 3 cost time: 0.7369205951690674
Epoch: 3, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.653 Vali Acc: 0.337 Test Loss: 1.653 Test Acc: 0.337
Validation loss decreased (-0.140722 --> -0.337021).  Saving model ...
Epoch: 4 cost time: 0.769033670425415
Epoch: 4, Steps: 2 | Train Loss: 1.495 Vali Loss: 1.381 Vali Acc: 0.548 Test Loss: 1.381 Test Acc: 0.548
Validation loss decreased (-0.337021 --> -0.548134).  Saving model ...
Epoch: 5 cost time: 0.8883326053619385
Epoch: 5, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.095 Vali Acc: 0.674 Test Loss: 1.095 Test Acc: 0.674
Validation loss decreased (-0.548134 --> -0.674063).  Saving model ...
Epoch: 6 cost time: 0.8121905326843262
Epoch: 6, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.845 Vali Acc: 0.800 Test Loss: 0.845 Test Acc: 0.800
Validation loss decreased (-0.674063 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.8324625492095947
Epoch: 7, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.649 Vali Acc: 0.874 Test Loss: 0.649 Test Acc: 0.874
Validation loss decreased (-0.799992 --> -0.874068).  Saving model ...
Epoch: 8 cost time: 0.8689987659454346
Epoch: 8, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.505 Vali Acc: 0.896 Test Loss: 0.505 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896291).  Saving model ...
Epoch: 9 cost time: 0.7613527774810791
Epoch: 9, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.8303341865539551
Epoch: 10, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.323 Vali Acc: 0.922 Test Loss: 0.323 Test Acc: 0.922
Validation loss decreased (-0.899996 --> -0.922219).  Saving model ...
Epoch: 11 cost time: 0.8058950901031494
Epoch: 11, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 12 cost time: 0.8267338275909424
Epoch: 12, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.7975924015045166
Epoch: 13, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.7933638095855713
Epoch: 14, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.9304487705230713
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 16 cost time: 0.7195615768432617
Epoch: 16, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.7667021751403809
Epoch: 17, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.7361977100372314
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.8877811431884766
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.8056411743164062
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.8493525981903076
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.7682631015777588
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.8492946624755859
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 1.0091140270233154
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.91680908203125
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8489511013031006
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.9414935111999512
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.944 Test Loss: 0.169 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.9300112724304199
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9267494678497314
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.9311056137084961
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.9514365196228027
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.8677258491516113
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.9853365421295166
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 1422918
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.816281795501709
Epoch: 1, Steps: 2 | Train Loss: 2.082 Vali Loss: 1.982 Vali Acc: 0.048 Test Loss: 1.982 Test Acc: 0.048
Validation loss decreased (inf --> -0.048128).  Saving model ...
Epoch: 2 cost time: 0.7474515438079834
Epoch: 2, Steps: 2 | Train Loss: 1.926 Vali Loss: 1.817 Vali Acc: 0.141 Test Loss: 1.817 Test Acc: 0.141
Validation loss decreased (-0.048128 --> -0.140723).  Saving model ...
Epoch: 3 cost time: 0.9858291149139404
Epoch: 3, Steps: 2 | Train Loss: 1.741 Vali Loss: 1.630 Vali Acc: 0.411 Test Loss: 1.630 Test Acc: 0.411
Validation loss decreased (-0.140723 --> -0.411095).  Saving model ...
Epoch: 4 cost time: 0.7624354362487793
Epoch: 4, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.367 Vali Acc: 0.574 Test Loss: 1.367 Test Acc: 0.574
Validation loss decreased (-0.411095 --> -0.574060).  Saving model ...
Epoch: 5 cost time: 0.7587628364562988
Epoch: 5, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.091 Vali Acc: 0.674 Test Loss: 1.091 Test Acc: 0.674
Validation loss decreased (-0.574060 --> -0.674063).  Saving model ...
Epoch: 6 cost time: 0.7546353340148926
Epoch: 6, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.854 Vali Acc: 0.767 Test Loss: 0.854 Test Acc: 0.767
Validation loss decreased (-0.674063 --> -0.766658).  Saving model ...
Epoch: 7 cost time: 0.8294203281402588
Epoch: 7, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.670 Vali Acc: 0.848 Test Loss: 0.670 Test Acc: 0.848
Validation loss decreased (-0.766658 --> -0.848141).  Saving model ...
Epoch: 8 cost time: 1.0169682502746582
Epoch: 8, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.536 Vali Acc: 0.885 Test Loss: 0.536 Test Acc: 0.885
Validation loss decreased (-0.848141 --> -0.885180).  Saving model ...
Epoch: 9 cost time: 0.9057409763336182
Epoch: 9, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.439 Vali Acc: 0.915 Test Loss: 0.439 Test Acc: 0.915
Validation loss decreased (-0.885180 --> -0.914810).  Saving model ...
Epoch: 10 cost time: 0.8299453258514404
Epoch: 10, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.367 Vali Acc: 0.926 Test Loss: 0.367 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 11 cost time: 0.880547285079956
Epoch: 11, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 12 cost time: 0.7894766330718994
Epoch: 12, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 13 cost time: 0.7410025596618652
Epoch: 13, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.7500360012054443
Epoch: 14, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8307807445526123
Epoch: 15, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6881120204925537
Epoch: 16, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8313214778900146
Epoch: 17, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7922930717468262
Epoch: 18, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.8219029903411865
Epoch: 19, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.8258914947509766
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8334798812866211
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.8549919128417969
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9192297458648682
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.815967321395874
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.8160688877105713
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8654649257659912
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.8203296661376953
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.927293062210083
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.8165268898010254
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.9448537826538086
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.9134588241577148
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.8935863971710205
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.7640798091888428
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.8683757781982422
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1422918
model size : 10.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2376973628997803
Epoch: 1, Steps: 2 | Train Loss: 2.007 Vali Loss: 1.886 Vali Acc: 0.081 Test Loss: 1.886 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.8455970287322998
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.722 Vali Acc: 0.200 Test Loss: 1.722 Test Acc: 0.200
Validation loss decreased (-0.081463 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 0.8480901718139648
Epoch: 3, Steps: 2 | Train Loss: 1.617 Vali Loss: 1.544 Vali Acc: 0.444 Test Loss: 1.544 Test Acc: 0.444
Validation loss decreased (-0.199983 --> -0.444429).  Saving model ...
Epoch: 4 cost time: 0.802436113357544
Epoch: 4, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.294 Vali Acc: 0.622 Test Loss: 1.294 Test Acc: 0.622
Validation loss decreased (-0.444429 --> -0.622209).  Saving model ...
Epoch: 5 cost time: 0.8137438297271729
Epoch: 5, Steps: 2 | Train Loss: 1.126 Vali Loss: 1.040 Vali Acc: 0.744 Test Loss: 1.040 Test Acc: 0.744
Validation loss decreased (-0.622209 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 0.7467846870422363
Epoch: 6, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.820 Vali Acc: 0.800 Test Loss: 0.820 Test Acc: 0.800
Validation loss decreased (-0.744434 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.9029550552368164
Epoch: 7, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.642 Vali Acc: 0.848 Test Loss: 0.642 Test Acc: 0.848
Validation loss decreased (-0.799992 --> -0.848142).  Saving model ...
Epoch: 8 cost time: 0.713350772857666
Epoch: 8, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.848142 --> -0.877773).  Saving model ...
Epoch: 9 cost time: 0.8844444751739502
Epoch: 9, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.404 Vali Acc: 0.896 Test Loss: 0.404 Test Acc: 0.896
Validation loss decreased (-0.877773 --> -0.896292).  Saving model ...
Epoch: 10 cost time: 0.8292179107666016
Epoch: 10, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907404).  Saving model ...
Epoch: 11 cost time: 0.9835903644561768
Epoch: 11, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.283 Vali Acc: 0.915 Test Loss: 0.283 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.8926503658294678
Epoch: 12, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7558712959289551
Epoch: 13, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 0.739140510559082
Epoch: 14, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 15 cost time: 1.1526257991790771
Epoch: 15, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.929628 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.9531819820404053
Epoch: 16, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.0439929962158203
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9723358154296875
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.9643089771270752
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.9468121528625488
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.8675742149353027
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9908990859985352
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.110142707824707
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.048701286315918
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.0822741985321045
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.0723965167999268
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.937 Test Loss: 0.182 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.9860525131225586
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.2499494552612305
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.1103029251098633
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.1355977058410645
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 898630
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1896538734436035
Epoch: 1, Steps: 2 | Train Loss: 2.023 Vali Loss: 1.883 Vali Acc: 0.081 Test Loss: 1.883 Test Acc: 0.081
Validation loss decreased (inf --> -0.081463).  Saving model ...
Epoch: 2 cost time: 0.7778863906860352
Epoch: 2, Steps: 2 | Train Loss: 1.882 Vali Loss: 1.719 Vali Acc: 0.211 Test Loss: 1.719 Test Acc: 0.211
Validation loss decreased (-0.081463 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 0.7802402973175049
Epoch: 3, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.543 Vali Acc: 0.426 Test Loss: 1.543 Test Acc: 0.426
Validation loss decreased (-0.211094 --> -0.425911).  Saving model ...
Epoch: 4 cost time: 0.6505837440490723
Epoch: 4, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.293 Vali Acc: 0.630 Test Loss: 1.293 Test Acc: 0.630
Validation loss decreased (-0.425911 --> -0.629617).  Saving model ...
Epoch: 5 cost time: 0.961381196975708
Epoch: 5, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.039 Vali Acc: 0.730 Test Loss: 1.039 Test Acc: 0.730
Validation loss decreased (-0.629617 --> -0.729619).  Saving model ...
Epoch: 6 cost time: 0.8500895500183105
Epoch: 6, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.819 Vali Acc: 0.778 Test Loss: 0.819 Test Acc: 0.778
Validation loss decreased (-0.729619 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 0.8662559986114502
Epoch: 7, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.640 Vali Acc: 0.826 Test Loss: 0.640 Test Acc: 0.826
Validation loss decreased (-0.777770 --> -0.825920).  Saving model ...
Epoch: 8 cost time: 0.8348712921142578
Epoch: 8, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
Validation loss decreased (-0.825920 --> -0.877773).  Saving model ...
Epoch: 9 cost time: 0.7658395767211914
Epoch: 9, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
Validation loss decreased (-0.877773 --> -0.911107).  Saving model ...
Epoch: 10 cost time: 0.8028178215026855
Epoch: 10, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914812).  Saving model ...
Epoch: 11 cost time: 0.8472702503204346
Epoch: 11, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.280 Vali Acc: 0.915 Test Loss: 0.280 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.8522617816925049
Epoch: 12, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7058088779449463
Epoch: 13, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 0.6510701179504395
Epoch: 14, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 15 cost time: 0.680633544921875
Epoch: 15, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.929628 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.8085753917694092
Epoch: 16, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.782179594039917
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.7899689674377441
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.721677303314209
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.7323973178863525
Epoch: 20, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.7631509304046631
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.9683554172515869
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7492806911468506
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8845803737640381
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.8719282150268555
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.8425359725952148
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.8516919612884521
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.8359026908874512
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.9119579792022705
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.8492720127105713
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 898630
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 4.016010284423828
Epoch: 1, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.899 Vali Acc: 0.096 Test Loss: 1.899 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 1.0889360904693604
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.733 Vali Acc: 0.181 Test Loss: 1.733 Test Acc: 0.181
Validation loss decreased (-0.096277 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.920825719833374
Epoch: 3, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.555 Vali Acc: 0.400 Test Loss: 1.555 Test Acc: 0.400
Validation loss decreased (-0.181464 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 1.018430471420288
Epoch: 4, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.303 Vali Acc: 0.600 Test Loss: 1.303 Test Acc: 0.600
Validation loss decreased (-0.399984 --> -0.599987).  Saving model ...
Epoch: 5 cost time: 1.0539031028747559
Epoch: 5, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.047 Vali Acc: 0.722 Test Loss: 1.047 Test Acc: 0.722
Validation loss decreased (-0.599987 --> -0.722212).  Saving model ...
Epoch: 6 cost time: 0.9230542182922363
Epoch: 6, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.825 Vali Acc: 0.778 Test Loss: 0.825 Test Acc: 0.778
Validation loss decreased (-0.722212 --> -0.777770).  Saving model ...
Epoch: 7 cost time: 0.8783538341522217
Epoch: 7, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.644 Vali Acc: 0.841 Test Loss: 0.644 Test Acc: 0.841
Validation loss decreased (-0.777770 --> -0.840734).  Saving model ...
Epoch: 8 cost time: 0.8612196445465088
Epoch: 8, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.505 Vali Acc: 0.878 Test Loss: 0.505 Test Acc: 0.878
Validation loss decreased (-0.840734 --> -0.877773).  Saving model ...
Epoch: 9 cost time: 0.8583269119262695
Epoch: 9, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.403 Vali Acc: 0.900 Test Loss: 0.403 Test Acc: 0.900
Validation loss decreased (-0.877773 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.8360505104064941
Epoch: 10, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914811).  Saving model ...
Epoch: 11 cost time: 0.7832484245300293
Epoch: 11, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.9344172477722168
Epoch: 12, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.0326650142669678
Epoch: 13, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914813).  Saving model ...
Epoch: 14 cost time: 0.9854652881622314
Epoch: 14, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.914813 --> -0.925924).  Saving model ...
Epoch: 15 cost time: 0.81821608543396
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 16 cost time: 0.912055253982544
Epoch: 16, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 17 cost time: 0.8899919986724854
Epoch: 17, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8605999946594238
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.9053177833557129
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.8509392738342285
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.8355934619903564
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.8441953659057617
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.027611255645752
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0193841457366943
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.0706517696380615
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.941 Test Loss: 0.185 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8020000457763672
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8383827209472656
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.861901044845581
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8692858219146729
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9115786552429199
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.833625316619873
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.8820505142211914
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.8656134605407715
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.7766218185424805
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.9185967445373535
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 36 cost time: 0.867689847946167
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 37 cost time: 0.8363428115844727
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 38 cost time: 0.9567029476165771
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 39 cost time: 0.9298820495605469
Epoch: 39, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 40 cost time: 0.8424866199493408
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 41 cost time: 0.9871513843536377
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 42 cost time: 0.944312572479248
Epoch: 42, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.8544325828552246
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.9978113174438477
Epoch: 44, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.9492411613464355
Epoch: 45, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9180154800415039
Epoch: 46, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.9928538799285889
Epoch: 47, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 1.0560343265533447
Epoch: 48, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.8400638103485107
Epoch: 49, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8074636459350586
Epoch: 50, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 1.0205106735229492
Epoch: 51, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 1.00730299949646
Epoch: 52, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 53 cost time: 1.1349809169769287
Epoch: 53, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 54 cost time: 0.9446730613708496
Epoch: 54, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 55 cost time: 0.9294776916503906
Epoch: 55, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.971498966217041
Epoch: 56, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.8765444755554199
Epoch: 57, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.9899539947509766
Epoch: 58, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.891434907913208
Epoch: 59, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 1.0047738552093506
Epoch: 60, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.8297491073608398
Epoch: 61, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.8930666446685791
Epoch: 62, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.893690824508667
Epoch: 63, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.8389551639556885
Epoch: 64, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.9097182750701904
Epoch: 65, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.839385986328125
Epoch: 66, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 1.053171157836914
Epoch: 67, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.8539261817932129
Epoch: 68, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.9208729267120361
Epoch: 69, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.8816587924957275
Epoch: 70, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 1.0536589622497559
Epoch: 71, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 1.020531415939331
Epoch: 72, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 1.0442376136779785
Epoch: 73, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 898630
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0811245441436768
Epoch: 1, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.913 Vali Acc: 0.119 Test Loss: 1.913 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.9389643669128418
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.750 Vali Acc: 0.204 Test Loss: 1.750 Test Acc: 0.204
Validation loss decreased (-0.118499 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.7749817371368408
Epoch: 3, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.573 Vali Acc: 0.456 Test Loss: 1.573 Test Acc: 0.456
Validation loss decreased (-0.203686 --> -0.455540).  Saving model ...
Epoch: 4 cost time: 0.7624392509460449
Epoch: 4, Steps: 2 | Train Loss: 1.443 Vali Loss: 1.325 Vali Acc: 0.611 Test Loss: 1.325 Test Acc: 0.611
Validation loss decreased (-0.455540 --> -0.611098).  Saving model ...
Epoch: 5 cost time: 0.7953517436981201
Epoch: 5, Steps: 2 | Train Loss: 1.109 Vali Loss: 1.072 Vali Acc: 0.700 Test Loss: 1.072 Test Acc: 0.700
Validation loss decreased (-0.611098 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.9294474124908447
Epoch: 6, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.854 Vali Acc: 0.811 Test Loss: 0.854 Test Acc: 0.811
Validation loss decreased (-0.699989 --> -0.811103).  Saving model ...
Epoch: 7 cost time: 0.8659889698028564
Epoch: 7, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.680 Vali Acc: 0.848 Test Loss: 0.680 Test Acc: 0.848
Validation loss decreased (-0.811103 --> -0.848141).  Saving model ...
Epoch: 8 cost time: 0.8387656211853027
Epoch: 8, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
Validation loss decreased (-0.848141 --> -0.870365).  Saving model ...
Epoch: 9 cost time: 0.876861572265625
Epoch: 9, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.450 Vali Acc: 0.881 Test Loss: 0.450 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881477).  Saving model ...
Epoch: 10 cost time: 0.8652286529541016
Epoch: 10, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.378 Vali Acc: 0.896 Test Loss: 0.378 Test Acc: 0.896
Validation loss decreased (-0.881477 --> -0.896293).  Saving model ...
Epoch: 11 cost time: 0.9325201511383057
Epoch: 11, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.321 Vali Acc: 0.907 Test Loss: 0.321 Test Acc: 0.907
Validation loss decreased (-0.896293 --> -0.907404).  Saving model ...
Epoch: 12 cost time: 0.9036142826080322
Epoch: 12, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 13 cost time: 0.9406049251556396
Epoch: 13, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 14 cost time: 0.8466799259185791
Epoch: 14, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 15 cost time: 0.796776294708252
Epoch: 15, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 0.7786777019500732
Epoch: 16, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8435397148132324
Epoch: 17, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8830420970916748
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.814032793045044
Epoch: 19, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 20 cost time: 0.8267467021942139
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 0.8565866947174072
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 0.9433965682983398
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.922 Test Loss: 0.209 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8696491718292236
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 24 cost time: 0.7694082260131836
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.915 Test Loss: 0.209 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9910180568695068
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.919 Test Loss: 0.208 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9345197677612305
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.919 Test Loss: 0.208 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.0437967777252197
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8383214473724365
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.0229787826538086
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.143381118774414
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.1389718055725098
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 32 cost time: 1.1793115139007568
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.2057034969329834
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.9658329486846924
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.1921911239624023
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.2741518020629883
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.1890439987182617
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0169463157653809
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.0485739707946777
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.225085973739624
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.078129529953003
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 898630
model size : 8.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.943107843399048
Epoch: 1, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.755 Vali Acc: 0.307 Test Loss: 1.755 Test Acc: 0.307
Validation loss decreased (inf --> -0.307390).  Saving model ...
Epoch: 2 cost time: 0.8414595127105713
Epoch: 2, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.602 Vali Acc: 0.389 Test Loss: 1.602 Test Acc: 0.389
Validation loss decreased (-0.307390 --> -0.388873).  Saving model ...
Epoch: 3 cost time: 0.7518072128295898
Epoch: 3, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.433 Vali Acc: 0.511 Test Loss: 1.433 Test Acc: 0.511
Validation loss decreased (-0.388873 --> -0.511097).  Saving model ...
Epoch: 4 cost time: 0.7228288650512695
Epoch: 4, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.196 Vali Acc: 0.663 Test Loss: 1.196 Test Acc: 0.663
Validation loss decreased (-0.511097 --> -0.662951).  Saving model ...
Epoch: 5 cost time: 0.7394094467163086
Epoch: 5, Steps: 2 | Train Loss: 1.043 Vali Loss: 0.956 Vali Acc: 0.770 Test Loss: 0.956 Test Acc: 0.770
Validation loss decreased (-0.662951 --> -0.770361).  Saving model ...
Epoch: 6 cost time: 0.7590961456298828
Epoch: 6, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.748 Vali Acc: 0.841 Test Loss: 0.748 Test Acc: 0.841
Validation loss decreased (-0.770361 --> -0.840733).  Saving model ...
Epoch: 7 cost time: 0.7151298522949219
Epoch: 7, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.583 Vali Acc: 0.878 Test Loss: 0.583 Test Acc: 0.878
Validation loss decreased (-0.840733 --> -0.877772).  Saving model ...
Epoch: 8 cost time: 0.7771694660186768
Epoch: 8, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.464 Vali Acc: 0.911 Test Loss: 0.464 Test Acc: 0.911
Validation loss decreased (-0.877772 --> -0.911106).  Saving model ...
Epoch: 9 cost time: 0.8509175777435303
Epoch: 9, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.377 Vali Acc: 0.915 Test Loss: 0.377 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914811).  Saving model ...
Epoch: 10 cost time: 0.7753913402557373
Epoch: 10, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 11 cost time: 0.752469539642334
Epoch: 11, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922220).  Saving model ...
Epoch: 12 cost time: 0.7634522914886475
Epoch: 12, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.8620650768280029
Epoch: 13, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 14 cost time: 0.8760857582092285
Epoch: 14, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.929628 --> -0.951850).  Saving model ...
Epoch: 15 cost time: 0.8047599792480469
Epoch: 15, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7701184749603271
Epoch: 16, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.7618529796600342
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.8904738426208496
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.7912335395812988
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.7987256050109863
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.7319762706756592
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.7404654026031494
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.7529006004333496
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.8196659088134766
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 636486
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8119053840637207
Epoch: 1, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.752 Vali Acc: 0.322 Test Loss: 1.752 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.8807544708251953
Epoch: 2, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.598 Vali Acc: 0.385 Test Loss: 1.598 Test Acc: 0.385
Validation loss decreased (-0.322205 --> -0.385169).  Saving model ...
Epoch: 3 cost time: 0.8753757476806641
Epoch: 3, Steps: 2 | Train Loss: 1.496 Vali Loss: 1.428 Vali Acc: 0.519 Test Loss: 1.428 Test Acc: 0.519
Validation loss decreased (-0.385169 --> -0.518504).  Saving model ...
Epoch: 4 cost time: 0.7987210750579834
Epoch: 4, Steps: 2 | Train Loss: 1.152 Vali Loss: 1.190 Vali Acc: 0.667 Test Loss: 1.190 Test Acc: 0.667
Validation loss decreased (-0.518504 --> -0.666655).  Saving model ...
Epoch: 5 cost time: 0.7811329364776611
Epoch: 5, Steps: 2 | Train Loss: 1.050 Vali Loss: 0.948 Vali Acc: 0.770 Test Loss: 0.948 Test Acc: 0.770
Validation loss decreased (-0.666655 --> -0.770361).  Saving model ...
Epoch: 6 cost time: 0.7813525199890137
Epoch: 6, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.741 Vali Acc: 0.844 Test Loss: 0.741 Test Acc: 0.844
Validation loss decreased (-0.770361 --> -0.844437).  Saving model ...
Epoch: 7 cost time: 0.9236302375793457
Epoch: 7, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.576 Vali Acc: 0.893 Test Loss: 0.576 Test Acc: 0.893
Validation loss decreased (-0.844437 --> -0.892587).  Saving model ...
Epoch: 8 cost time: 0.9687716960906982
Epoch: 8, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.458 Vali Acc: 0.911 Test Loss: 0.458 Test Acc: 0.911
Validation loss decreased (-0.892587 --> -0.911107).  Saving model ...
Epoch: 9 cost time: 0.9218037128448486
Epoch: 9, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.371 Vali Acc: 0.937 Test Loss: 0.371 Test Acc: 0.937
Validation loss decreased (-0.911107 --> -0.937033).  Saving model ...
Epoch: 10 cost time: 0.9100277423858643
Epoch: 10, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8572378158569336
Epoch: 11, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.817122220993042
Epoch: 12, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.8355183601379395
Epoch: 13, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.9046521186828613
Epoch: 14, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 1.1187160015106201
Epoch: 15, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.944443 --> -0.951850).  Saving model ...
Epoch: 16 cost time: 0.8137376308441162
Epoch: 16, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 17 cost time: 0.9113733768463135
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.8811109066009521
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7604126930236816
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.8404569625854492
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.961052417755127
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9997644424438477
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8502171039581299
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.7162904739379883
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.7117125988006592
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.8445203304290771
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8440606594085693
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 636486
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.50146746635437
Epoch: 1, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.762 Vali Acc: 0.296 Test Loss: 1.762 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.8245697021484375
Epoch: 2, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.608 Vali Acc: 0.415 Test Loss: 1.608 Test Acc: 0.415
Validation loss decreased (-0.296279 --> -0.414799).  Saving model ...
Epoch: 3 cost time: 0.996495246887207
Epoch: 3, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.438 Vali Acc: 0.515 Test Loss: 1.438 Test Acc: 0.515
Validation loss decreased (-0.414799 --> -0.514800).  Saving model ...
Epoch: 4 cost time: 0.9251828193664551
Epoch: 4, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.197 Vali Acc: 0.659 Test Loss: 1.197 Test Acc: 0.659
Validation loss decreased (-0.514800 --> -0.659247).  Saving model ...
Epoch: 5 cost time: 0.829756498336792
Epoch: 5, Steps: 2 | Train Loss: 1.027 Vali Loss: 0.953 Vali Acc: 0.785 Test Loss: 0.953 Test Acc: 0.785
Validation loss decreased (-0.659247 --> -0.785176).  Saving model ...
Epoch: 6 cost time: 0.8861722946166992
Epoch: 6, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.744 Vali Acc: 0.856 Test Loss: 0.744 Test Acc: 0.856
Validation loss decreased (-0.785176 --> -0.855548).  Saving model ...
Epoch: 7 cost time: 0.888141393661499
Epoch: 7, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.577 Vali Acc: 0.904 Test Loss: 0.577 Test Acc: 0.904
Validation loss decreased (-0.855548 --> -0.903698).  Saving model ...
Epoch: 8 cost time: 0.9508006572723389
Epoch: 8, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.457 Vali Acc: 0.915 Test Loss: 0.457 Test Acc: 0.915
Validation loss decreased (-0.903698 --> -0.914810).  Saving model ...
Epoch: 9 cost time: 0.8214647769927979
Epoch: 9, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.370 Vali Acc: 0.922 Test Loss: 0.370 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922219).  Saving model ...
Epoch: 10 cost time: 0.8252725601196289
Epoch: 10, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.307 Vali Acc: 0.926 Test Loss: 0.307 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 11 cost time: 0.8970420360565186
Epoch: 11, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.9278156757354736
Epoch: 12, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7703213691711426
Epoch: 13, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.7214882373809814
Epoch: 14, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 15 cost time: 0.8024890422821045
Epoch: 15, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 16 cost time: 0.7018487453460693
Epoch: 16, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 17 cost time: 0.9007472991943359
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8772518634796143
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8438582420349121
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.7632265090942383
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.7307970523834229
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6883993148803711
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.0295116901397705
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.9587304592132568
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 0.774146318435669
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8149473667144775
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.78558349609375
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8359274864196777
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.9128010272979736
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.835932731628418
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.8243587017059326
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.890357494354248
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.8714985847473145
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.791053056716919
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 636486
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.4977972507476807
Epoch: 1, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.756 Vali Acc: 0.285 Test Loss: 1.756 Test Acc: 0.285
Validation loss decreased (inf --> -0.285168).  Saving model ...
Epoch: 2 cost time: 0.9478464126586914
Epoch: 2, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.607 Vali Acc: 0.448 Test Loss: 1.607 Test Acc: 0.448
Validation loss decreased (-0.285168 --> -0.448132).  Saving model ...
Epoch: 3 cost time: 0.8409943580627441
Epoch: 3, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.440 Vali Acc: 0.570 Test Loss: 1.440 Test Acc: 0.570
Validation loss decreased (-0.448132 --> -0.570356).  Saving model ...
Epoch: 4 cost time: 0.8603544235229492
Epoch: 4, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.205 Vali Acc: 0.670 Test Loss: 1.205 Test Acc: 0.670
Validation loss decreased (-0.570356 --> -0.670358).  Saving model ...
Epoch: 5 cost time: 0.8064212799072266
Epoch: 5, Steps: 2 | Train Loss: 1.081 Vali Loss: 0.968 Vali Acc: 0.770 Test Loss: 0.968 Test Acc: 0.770
Validation loss decreased (-0.670358 --> -0.770361).  Saving model ...
Epoch: 6 cost time: 0.9243626594543457
Epoch: 6, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.766 Vali Acc: 0.819 Test Loss: 0.766 Test Acc: 0.819
Validation loss decreased (-0.770361 --> -0.818511).  Saving model ...
Epoch: 7 cost time: 0.9082400798797607
Epoch: 7, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.607 Vali Acc: 0.867 Test Loss: 0.607 Test Acc: 0.867
Validation loss decreased (-0.818511 --> -0.866661).  Saving model ...
Epoch: 8 cost time: 0.9438595771789551
Epoch: 8, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.494 Vali Acc: 0.885 Test Loss: 0.494 Test Acc: 0.885
Validation loss decreased (-0.866661 --> -0.885180).  Saving model ...
Epoch: 9 cost time: 0.8726353645324707
Epoch: 9, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.411 Vali Acc: 0.907 Test Loss: 0.411 Test Acc: 0.907
Validation loss decreased (-0.885180 --> -0.907403).  Saving model ...
Epoch: 10 cost time: 0.8381478786468506
Epoch: 10, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
Validation loss decreased (-0.907403 --> -0.929626).  Saving model ...
Epoch: 11 cost time: 0.9806578159332275
Epoch: 11, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8458120822906494
Epoch: 12, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.264 Vali Acc: 0.933 Test Loss: 0.264 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.9428839683532715
Epoch: 13, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.8696460723876953
Epoch: 14, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.9027421474456787
Epoch: 15, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 16 cost time: 0.8720331192016602
Epoch: 16, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.892242431640625
Epoch: 17, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.7963356971740723
Epoch: 18, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.0694780349731445
Epoch: 19, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.9247252941131592
Epoch: 20, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.926 Test Loss: 0.192 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.8745148181915283
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.926 Test Loss: 0.191 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.9625649452209473
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8184690475463867
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.0537981986999512
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.8200879096984863
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8591868877410889
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 636486
model size : 7.33MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2501044273376465
Epoch: 1, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.523 Vali Acc: 0.437 Test Loss: 1.523 Test Acc: 0.437
Validation loss decreased (inf --> -0.437022).  Saving model ...
Epoch: 2 cost time: 0.7940373420715332
Epoch: 2, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.389 Vali Acc: 0.548 Test Loss: 1.389 Test Acc: 0.548
Validation loss decreased (-0.437022 --> -0.548134).  Saving model ...
Epoch: 3 cost time: 0.844980001449585
Epoch: 3, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.244 Vali Acc: 0.641 Test Loss: 1.244 Test Acc: 0.641
Validation loss decreased (-0.548134 --> -0.640728).  Saving model ...
Epoch: 4 cost time: 0.8458364009857178
Epoch: 4, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.046 Vali Acc: 0.704 Test Loss: 1.046 Test Acc: 0.704
Validation loss decreased (-0.640728 --> -0.703693).  Saving model ...
Epoch: 5 cost time: 0.8478889465332031
Epoch: 5, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.848 Vali Acc: 0.778 Test Loss: 0.848 Test Acc: 0.778
Validation loss decreased (-0.703693 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 0.8282082080841064
Epoch: 6, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
Validation loss decreased (-0.777769 --> -0.844438).  Saving model ...
Epoch: 7 cost time: 0.8249318599700928
Epoch: 7, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.544 Vali Acc: 0.900 Test Loss: 0.544 Test Acc: 0.900
Validation loss decreased (-0.844438 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.7410399913787842
Epoch: 8, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 9 cost time: 0.8074178695678711
Epoch: 9, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 10 cost time: 0.9392430782318115
Epoch: 10, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 11 cost time: 0.8488633632659912
Epoch: 11, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 12 cost time: 0.8288702964782715
Epoch: 12, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 13 cost time: 0.7608940601348877
Epoch: 13, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.8976089954376221
Epoch: 14, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.096970796585083
Epoch: 15, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.0504837036132812
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.9442148208618164
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 18 cost time: 1.0167348384857178
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 19 cost time: 0.8499584197998047
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.166 Vali Acc: 0.944 Test Loss: 0.166 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 20 cost time: 0.818859338760376
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 21 cost time: 0.7456581592559814
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 22 cost time: 0.8604779243469238
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
Validation loss decreased (-0.948147 --> -0.948147).  Saving model ...
Epoch: 23 cost time: 0.7431533336639404
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.8068187236785889
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8426055908203125
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.9975004196166992
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.919611930847168
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8293225765228271
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9780192375183105
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.9550507068634033
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.8645918369293213
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.84413743019104
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 505414
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.481762409210205
Epoch: 1, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.543 Vali Acc: 0.389 Test Loss: 1.543 Test Acc: 0.389
Validation loss decreased (inf --> -0.388873).  Saving model ...
Epoch: 2 cost time: 0.8647863864898682
Epoch: 2, Steps: 2 | Train Loss: 1.535 Vali Loss: 1.406 Vali Acc: 0.541 Test Loss: 1.406 Test Acc: 0.541
Validation loss decreased (-0.388873 --> -0.540727).  Saving model ...
Epoch: 3 cost time: 0.7919642925262451
Epoch: 3, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.255 Vali Acc: 0.619 Test Loss: 1.255 Test Acc: 0.619
Validation loss decreased (-0.540727 --> -0.618506).  Saving model ...
Epoch: 4 cost time: 0.8959801197052002
Epoch: 4, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.053 Vali Acc: 0.700 Test Loss: 1.053 Test Acc: 0.700
Validation loss decreased (-0.618506 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.9168505668640137
Epoch: 5, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.850 Vali Acc: 0.778 Test Loss: 0.850 Test Acc: 0.778
Validation loss decreased (-0.699989 --> -0.777769).  Saving model ...
Epoch: 6 cost time: 0.8522915840148926
Epoch: 6, Steps: 2 | Train Loss: 0.725 Vali Loss: 0.677 Vali Acc: 0.859 Test Loss: 0.677 Test Acc: 0.859
Validation loss decreased (-0.777769 --> -0.859252).  Saving model ...
Epoch: 7 cost time: 0.7468013763427734
Epoch: 7, Steps: 2 | Train Loss: 0.459 Vali Loss: 0.538 Vali Acc: 0.889 Test Loss: 0.538 Test Acc: 0.889
Validation loss decreased (-0.859252 --> -0.888884).  Saving model ...
Epoch: 8 cost time: 0.8426225185394287
Epoch: 8, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.433 Vali Acc: 0.919 Test Loss: 0.433 Test Acc: 0.919
Validation loss decreased (-0.888884 --> -0.918514).  Saving model ...
Epoch: 9 cost time: 0.8302829265594482
Epoch: 9, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.354 Vali Acc: 0.926 Test Loss: 0.354 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 10 cost time: 0.7653617858886719
Epoch: 10, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 11 cost time: 0.8942601680755615
Epoch: 11, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.7317037582397461
Epoch: 12, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.933331 --> -0.944442).  Saving model ...
Epoch: 13 cost time: 0.8256587982177734
Epoch: 13, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.8538167476654053
Epoch: 14, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 15 cost time: 0.881420373916626
Epoch: 15, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 16 cost time: 0.9605133533477783
Epoch: 16, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8968296051025391
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.168 Vali Acc: 0.944 Test Loss: 0.168 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.9025928974151611
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 19 cost time: 0.9010195732116699
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 20 cost time: 0.9968373775482178
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.98512864112854
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9298462867736816
Epoch: 22, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.8169498443603516
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.8223834037780762
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8067553043365479
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.9491198062896729
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7967753410339355
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.0952956676483154
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.9368228912353516
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 505414
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2029635906219482
Epoch: 1, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.536 Vali Acc: 0.393 Test Loss: 1.536 Test Acc: 0.393
Validation loss decreased (inf --> -0.392577).  Saving model ...
Epoch: 2 cost time: 0.7933154106140137
Epoch: 2, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.396 Vali Acc: 0.530 Test Loss: 1.396 Test Acc: 0.530
Validation loss decreased (-0.392577 --> -0.529616).  Saving model ...
Epoch: 3 cost time: 0.8154840469360352
Epoch: 3, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.244 Vali Acc: 0.604 Test Loss: 1.244 Test Acc: 0.604
Validation loss decreased (-0.529616 --> -0.603691).  Saving model ...
Epoch: 4 cost time: 0.8230307102203369
Epoch: 4, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.040 Vali Acc: 0.737 Test Loss: 1.040 Test Acc: 0.737
Validation loss decreased (-0.603691 --> -0.737027).  Saving model ...
Epoch: 5 cost time: 0.7387945652008057
Epoch: 5, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.838 Vali Acc: 0.826 Test Loss: 0.838 Test Acc: 0.826
Validation loss decreased (-0.737027 --> -0.825918).  Saving model ...
Epoch: 6 cost time: 0.9879031181335449
Epoch: 6, Steps: 2 | Train Loss: 0.716 Vali Loss: 0.667 Vali Acc: 0.870 Test Loss: 0.667 Test Acc: 0.870
Validation loss decreased (-0.825918 --> -0.870364).  Saving model ...
Epoch: 7 cost time: 0.9611008167266846
Epoch: 7, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.529 Vali Acc: 0.911 Test Loss: 0.529 Test Acc: 0.911
Validation loss decreased (-0.870364 --> -0.911106).  Saving model ...
Epoch: 8 cost time: 0.8855669498443604
Epoch: 8, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.426 Vali Acc: 0.922 Test Loss: 0.426 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 9 cost time: 0.8667919635772705
Epoch: 9, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.349 Vali Acc: 0.937 Test Loss: 0.349 Test Acc: 0.937
Validation loss decreased (-0.922218 --> -0.937034).  Saving model ...
Epoch: 10 cost time: 0.7706356048583984
Epoch: 10, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.291 Vali Acc: 0.941 Test Loss: 0.291 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 11 cost time: 0.8479471206665039
Epoch: 11, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.8266744613647461
Epoch: 12, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.9516956806182861
Epoch: 13, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.7977085113525391
Epoch: 14, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.948 Test Loss: 0.187 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 15 cost time: 0.9807260036468506
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8710803985595703
Epoch: 16, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9959325790405273
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.7826321125030518
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948147).  Saving model ...
Epoch: 19 cost time: 0.8689825534820557
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.948147 --> -0.955554).  Saving model ...
Epoch: 20 cost time: 0.8235824108123779
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 21 cost time: 0.7266895771026611
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 22 cost time: 0.7874131202697754
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8547732830047607
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9018480777740479
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8055741786956787
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7184958457946777
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8283305168151855
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8594262599945068
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9784457683563232
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.844022274017334
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8600361347198486
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 505414
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.103527307510376
Epoch: 1, Steps: 2 | Train Loss: 1.653 Vali Loss: 1.536 Vali Acc: 0.341 Test Loss: 1.536 Test Acc: 0.341
Validation loss decreased (inf --> -0.340725).  Saving model ...
Epoch: 2 cost time: 0.8692660331726074
Epoch: 2, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.399 Vali Acc: 0.470 Test Loss: 1.399 Test Acc: 0.470
Validation loss decreased (-0.340725 --> -0.470356).  Saving model ...
Epoch: 3 cost time: 0.8938910961151123
Epoch: 3, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.250 Vali Acc: 0.593 Test Loss: 1.250 Test Acc: 0.593
Validation loss decreased (-0.470356 --> -0.592580).  Saving model ...
Epoch: 4 cost time: 0.8040969371795654
Epoch: 4, Steps: 2 | Train Loss: 1.204 Vali Loss: 1.053 Vali Acc: 0.759 Test Loss: 1.053 Test Acc: 0.759
Validation loss decreased (-0.592580 --> -0.759249).  Saving model ...
Epoch: 5 cost time: 0.8422791957855225
Epoch: 5, Steps: 2 | Train Loss: 0.992 Vali Loss: 0.857 Vali Acc: 0.822 Test Loss: 0.857 Test Acc: 0.822
Validation loss decreased (-0.759249 --> -0.822214).  Saving model ...
Epoch: 6 cost time: 0.9265298843383789
Epoch: 6, Steps: 2 | Train Loss: 0.761 Vali Loss: 0.693 Vali Acc: 0.848 Test Loss: 0.693 Test Acc: 0.848
Validation loss decreased (-0.822214 --> -0.848141).  Saving model ...
Epoch: 7 cost time: 0.912153959274292
Epoch: 7, Steps: 2 | Train Loss: 0.563 Vali Loss: 0.561 Vali Acc: 0.867 Test Loss: 0.561 Test Acc: 0.867
Validation loss decreased (-0.848141 --> -0.866661).  Saving model ...
Epoch: 8 cost time: 0.8943033218383789
Epoch: 8, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.463 Vali Acc: 0.893 Test Loss: 0.463 Test Acc: 0.893
Validation loss decreased (-0.866661 --> -0.892588).  Saving model ...
Epoch: 9 cost time: 0.7757971286773682
Epoch: 9, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.388 Vali Acc: 0.904 Test Loss: 0.388 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903700).  Saving model ...
Epoch: 10 cost time: 0.9680953025817871
Epoch: 10, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.332 Vali Acc: 0.900 Test Loss: 0.332 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.9407622814178467
Epoch: 11, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.7453727722167969
Epoch: 12, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 13 cost time: 0.941199779510498
Epoch: 13, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.240 Vali Acc: 0.915 Test Loss: 0.240 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.7774896621704102
Epoch: 14, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.8071155548095703
Epoch: 15, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.209 Vali Acc: 0.919 Test Loss: 0.209 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.7950124740600586
Epoch: 16, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 17 cost time: 0.7288997173309326
Epoch: 17, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8060269355773926
Epoch: 18, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.919 Test Loss: 0.189 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.8162243366241455
Epoch: 19, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.919 Test Loss: 0.187 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.8632464408874512
Epoch: 20, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.9302659034729004
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.185 Vali Acc: 0.922 Test Loss: 0.185 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.86356520652771
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.186 Vali Acc: 0.922 Test Loss: 0.186 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.8336403369903564
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.919 Test Loss: 0.187 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7422795295715332
Epoch: 24, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.187 Vali Acc: 0.919 Test Loss: 0.187 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.9333982467651367
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.919 Test Loss: 0.188 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.8186764717102051
Epoch: 26, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.189 Vali Acc: 0.919 Test Loss: 0.189 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 505414
model size : 6.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0841615200042725
Epoch: 1, Steps: 2 | Train Loss: 2.071 Vali Loss: 2.027 Vali Acc: 0.126 Test Loss: 2.027 Test Acc: 0.126
Validation loss decreased (inf --> -0.125906).  Saving model ...
Epoch: 2 cost time: 0.8071374893188477
Epoch: 2, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.847 Vali Acc: 0.163 Test Loss: 1.847 Test Acc: 0.163
Validation loss decreased (-0.125906 --> -0.162944).  Saving model ...
Epoch: 3 cost time: 0.8065500259399414
Epoch: 3, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.656 Vali Acc: 0.281 Test Loss: 1.656 Test Acc: 0.281
Validation loss decreased (-0.162944 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.793205976486206
Epoch: 4, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.390 Vali Acc: 0.496 Test Loss: 1.390 Test Acc: 0.496
Validation loss decreased (-0.281465 --> -0.496282).  Saving model ...
Epoch: 5 cost time: 0.697721004486084
Epoch: 5, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.111 Vali Acc: 0.678 Test Loss: 1.111 Test Acc: 0.678
Validation loss decreased (-0.496282 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 0.7688994407653809
Epoch: 6, Steps: 2 | Train Loss: 0.895 Vali Loss: 0.867 Vali Acc: 0.804 Test Loss: 0.867 Test Acc: 0.804
Validation loss decreased (-0.677767 --> -0.803695).  Saving model ...
Epoch: 7 cost time: 0.8152236938476562
Epoch: 7, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.674 Vali Acc: 0.826 Test Loss: 0.674 Test Acc: 0.826
Validation loss decreased (-0.803695 --> -0.825919).  Saving model ...
Epoch: 8 cost time: 1.0146434307098389
Epoch: 8, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.524 Vali Acc: 0.859 Test Loss: 0.524 Test Acc: 0.859
Validation loss decreased (-0.825919 --> -0.859254).  Saving model ...
Epoch: 9 cost time: 0.784168004989624
Epoch: 9, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.417 Vali Acc: 0.900 Test Loss: 0.417 Test Acc: 0.900
Validation loss decreased (-0.859254 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.9106473922729492
Epoch: 10, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.343 Vali Acc: 0.904 Test Loss: 0.343 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 11 cost time: 0.7900316715240479
Epoch: 11, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903701).  Saving model ...
Epoch: 12 cost time: 0.746757984161377
Epoch: 12, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.903701 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 0.7751121520996094
Epoch: 13, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
Validation loss decreased (-0.911109 --> -0.918516).  Saving model ...
Epoch: 14 cost time: 0.9036734104156494
Epoch: 14, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929628).  Saving model ...
Epoch: 15 cost time: 0.8979265689849854
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.7789618968963623
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.7372477054595947
Epoch: 17, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.7884008884429932
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.6790428161621094
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.7958147525787354
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.7219944000244141
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.7563281059265137
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7744073867797852
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6521022319793701
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7624049186706543
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8574886322021484
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.838904857635498
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.8443965911865234
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.9031836986541748
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9302799701690674
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.930 Test Loss: 0.176 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.7967095375061035
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.926 Test Loss: 0.176 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 439878
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8881759643554688
Epoch: 1, Steps: 2 | Train Loss: 2.092 Vali Loss: 2.043 Vali Acc: 0.141 Test Loss: 2.043 Test Acc: 0.141
Validation loss decreased (inf --> -0.140720).  Saving model ...
Epoch: 2 cost time: 0.7959117889404297
Epoch: 2, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.862 Vali Acc: 0.152 Test Loss: 1.862 Test Acc: 0.152
Validation loss decreased (-0.140720 --> -0.151833).  Saving model ...
Epoch: 3 cost time: 0.8415400981903076
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.671 Vali Acc: 0.289 Test Loss: 1.671 Test Acc: 0.289
Validation loss decreased (-0.151833 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.7908515930175781
Epoch: 4, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.401 Vali Acc: 0.504 Test Loss: 1.401 Test Acc: 0.504
Validation loss decreased (-0.288872 --> -0.503690).  Saving model ...
Epoch: 5 cost time: 0.8377370834350586
Epoch: 5, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.118 Vali Acc: 0.678 Test Loss: 1.118 Test Acc: 0.678
Validation loss decreased (-0.503690 --> -0.677767).  Saving model ...
Epoch: 6 cost time: 0.7749109268188477
Epoch: 6, Steps: 2 | Train Loss: 0.882 Vali Loss: 0.870 Vali Acc: 0.789 Test Loss: 0.870 Test Acc: 0.789
Validation loss decreased (-0.677767 --> -0.788880).  Saving model ...
Epoch: 7 cost time: 0.8467922210693359
Epoch: 7, Steps: 2 | Train Loss: 0.575 Vali Loss: 0.675 Vali Acc: 0.819 Test Loss: 0.675 Test Acc: 0.819
Validation loss decreased (-0.788880 --> -0.818512).  Saving model ...
Epoch: 8 cost time: 0.8013474941253662
Epoch: 8, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.525 Vali Acc: 0.859 Test Loss: 0.525 Test Acc: 0.859
Validation loss decreased (-0.818512 --> -0.859254).  Saving model ...
Epoch: 9 cost time: 0.7741661071777344
Epoch: 9, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.419 Vali Acc: 0.889 Test Loss: 0.419 Test Acc: 0.889
Validation loss decreased (-0.859254 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.8120303153991699
Epoch: 10, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.346 Vali Acc: 0.885 Test Loss: 0.346 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.8251254558563232
Epoch: 11, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
Validation loss decreased (-0.888885 --> -0.896293).  Saving model ...
Epoch: 12 cost time: 0.7787082195281982
Epoch: 12, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.262 Vali Acc: 0.904 Test Loss: 0.262 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903701).  Saving model ...
Epoch: 13 cost time: 0.8105297088623047
Epoch: 13, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.236 Vali Acc: 0.904 Test Loss: 0.236 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 14 cost time: 0.8590707778930664
Epoch: 14, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
Validation loss decreased (-0.903701 --> -0.918516).  Saving model ...
Epoch: 15 cost time: 0.933948278427124
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.918516 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.7505316734313965
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.893507719039917
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.9261288642883301
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.8626058101654053
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.9911730289459229
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8949489593505859
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.8804507255554199
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.8510360717773438
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9488918781280518
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8472771644592285
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8502826690673828
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.8260886669158936
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.8419229984283447
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.9730656147003174
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.778033971786499
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.9199690818786621
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.7734470367431641
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 439878
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2345826625823975
Epoch: 1, Steps: 2 | Train Loss: 2.037 Vali Loss: 2.015 Vali Acc: 0.144 Test Loss: 2.015 Test Acc: 0.144
Validation loss decreased (inf --> -0.144424).  Saving model ...
Epoch: 2 cost time: 0.7714948654174805
Epoch: 2, Steps: 2 | Train Loss: 1.921 Vali Loss: 1.834 Vali Acc: 0.167 Test Loss: 1.834 Test Acc: 0.167
Validation loss decreased (-0.144424 --> -0.166648).  Saving model ...
Epoch: 3 cost time: 0.8198649883270264
Epoch: 3, Steps: 2 | Train Loss: 1.735 Vali Loss: 1.641 Vali Acc: 0.304 Test Loss: 1.641 Test Acc: 0.304
Validation loss decreased (-0.166648 --> -0.303687).  Saving model ...
Epoch: 4 cost time: 0.9383258819580078
Epoch: 4, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.370 Vali Acc: 0.511 Test Loss: 1.370 Test Acc: 0.511
Validation loss decreased (-0.303687 --> -0.511097).  Saving model ...
Epoch: 5 cost time: 0.9289569854736328
Epoch: 5, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.088 Vali Acc: 0.696 Test Loss: 1.088 Test Acc: 0.696
Validation loss decreased (-0.511097 --> -0.696285).  Saving model ...
Epoch: 6 cost time: 0.8932812213897705
Epoch: 6, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.842 Vali Acc: 0.800 Test Loss: 0.842 Test Acc: 0.800
Validation loss decreased (-0.696285 --> -0.799992).  Saving model ...
Epoch: 7 cost time: 0.8953797817230225
Epoch: 7, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.652 Vali Acc: 0.833 Test Loss: 0.652 Test Acc: 0.833
Validation loss decreased (-0.799992 --> -0.833327).  Saving model ...
Epoch: 8 cost time: 0.8242177963256836
Epoch: 8, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.507 Vali Acc: 0.878 Test Loss: 0.507 Test Acc: 0.878
Validation loss decreased (-0.833327 --> -0.877773).  Saving model ...
Epoch: 9 cost time: 0.7581222057342529
Epoch: 9, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.403 Vali Acc: 0.893 Test Loss: 0.403 Test Acc: 0.893
Validation loss decreased (-0.877773 --> -0.892589).  Saving model ...
Epoch: 10 cost time: 0.8153750896453857
Epoch: 10, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.332 Vali Acc: 0.896 Test Loss: 0.332 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 11 cost time: 0.8839850425720215
Epoch: 11, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.896293 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.9499666690826416
Epoch: 12, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 1.0991945266723633
Epoch: 13, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.911109 --> -0.922220).  Saving model ...
Epoch: 14 cost time: 0.9205920696258545
Epoch: 14, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 15 cost time: 1.0240256786346436
Epoch: 15, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.193 Vali Acc: 0.919 Test Loss: 0.193 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.9696674346923828
Epoch: 16, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.926 Test Loss: 0.187 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.1331746578216553
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.9106550216674805
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 19 cost time: 0.9466855525970459
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.177 Vali Acc: 0.930 Test Loss: 0.177 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 20 cost time: 1.0087378025054932
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933332).  Saving model ...
Epoch: 21 cost time: 0.8120987415313721
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.8621597290039062
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8261675834655762
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8266119956970215
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.918799638748169
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.7971866130828857
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8783438205718994
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9641628265380859
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0886218547821045
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9628472328186035
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0837516784667969
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 439878
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0971601009368896
Epoch: 1, Steps: 2 | Train Loss: 2.020 Vali Loss: 1.957 Vali Acc: 0.156 Test Loss: 1.957 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.8036293983459473
Epoch: 2, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.783 Vali Acc: 0.178 Test Loss: 1.783 Test Acc: 0.178
Validation loss decreased (-0.155536 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.7473945617675781
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.599 Vali Acc: 0.330 Test Loss: 1.599 Test Acc: 0.330
Validation loss decreased (-0.177760 --> -0.329614).  Saving model ...
Epoch: 4 cost time: 0.779801607131958
Epoch: 4, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.343 Vali Acc: 0.581 Test Loss: 1.343 Test Acc: 0.581
Validation loss decreased (-0.329614 --> -0.581468).  Saving model ...
Epoch: 5 cost time: 0.8248448371887207
Epoch: 5, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.079 Vali Acc: 0.722 Test Loss: 1.079 Test Acc: 0.722
Validation loss decreased (-0.581468 --> -0.722211).  Saving model ...
Epoch: 6 cost time: 0.8095452785491943
Epoch: 6, Steps: 2 | Train Loss: 0.942 Vali Loss: 0.854 Vali Acc: 0.781 Test Loss: 0.854 Test Acc: 0.781
Validation loss decreased (-0.722211 --> -0.781473).  Saving model ...
Epoch: 7 cost time: 0.756777286529541
Epoch: 7, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.680 Vali Acc: 0.811 Test Loss: 0.680 Test Acc: 0.811
Validation loss decreased (-0.781473 --> -0.811104).  Saving model ...
Epoch: 8 cost time: 0.7179772853851318
Epoch: 8, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844439).  Saving model ...
Epoch: 9 cost time: 0.8159482479095459
Epoch: 9, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.448 Vali Acc: 0.852 Test Loss: 0.448 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851847).  Saving model ...
Epoch: 10 cost time: 0.8622167110443115
Epoch: 10, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.379 Vali Acc: 0.896 Test Loss: 0.379 Test Acc: 0.896
Validation loss decreased (-0.851847 --> -0.896293).  Saving model ...
Epoch: 11 cost time: 0.8713951110839844
Epoch: 11, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
Validation loss decreased (-0.896293 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.781980037689209
Epoch: 12, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.296 Vali Acc: 0.907 Test Loss: 0.296 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.7030413150787354
Epoch: 13, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.915 Test Loss: 0.267 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 14 cost time: 0.8232893943786621
Epoch: 14, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 15 cost time: 0.7360532283782959
Epoch: 15, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.231 Vali Acc: 0.915 Test Loss: 0.231 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.6873586177825928
Epoch: 16, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.9795083999633789
Epoch: 17, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 18 cost time: 1.0234599113464355
Epoch: 18, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.7696325778961182
Epoch: 19, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.6803460121154785
Epoch: 20, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9371030330657959
Epoch: 21, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.919 Test Loss: 0.203 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.7082581520080566
Epoch: 22, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.8266942501068115
Epoch: 23, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.015244960784912
Epoch: 24, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.845613956451416
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.9516339302062988
Epoch: 26, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.8005921840667725
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 439878
model size : 6.58MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.393214464187622
Epoch: 1, Steps: 2 | Train Loss: 2.195 Vali Loss: 1.876 Vali Acc: 0.189 Test Loss: 1.876 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.6674351692199707
Epoch: 2, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.740 Vali Acc: 0.215 Test Loss: 1.740 Test Acc: 0.215
Validation loss decreased (-0.188870 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.7476999759674072
Epoch: 3, Steps: 2 | Train Loss: 1.623 Vali Loss: 1.611 Vali Acc: 0.319 Test Loss: 1.611 Test Acc: 0.319
Validation loss decreased (-0.214797 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.8805091381072998
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.449 Vali Acc: 0.511 Test Loss: 1.449 Test Acc: 0.511
Validation loss decreased (-0.318502 --> -0.511097).  Saving model ...
Epoch: 5 cost time: 0.8323047161102295
Epoch: 5, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.263 Vali Acc: 0.648 Test Loss: 1.263 Test Acc: 0.648
Validation loss decreased (-0.511097 --> -0.648136).  Saving model ...
Epoch: 6 cost time: 0.7901928424835205
Epoch: 6, Steps: 2 | Train Loss: 1.127 Vali Loss: 1.078 Vali Acc: 0.778 Test Loss: 1.078 Test Acc: 0.778
Validation loss decreased (-0.648136 --> -0.777767).  Saving model ...
Epoch: 7 cost time: 0.9616577625274658
Epoch: 7, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.909 Vali Acc: 0.811 Test Loss: 0.909 Test Acc: 0.811
Validation loss decreased (-0.777767 --> -0.811102).  Saving model ...
Epoch: 8 cost time: 0.7952778339385986
Epoch: 8, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.764 Vali Acc: 0.830 Test Loss: 0.764 Test Acc: 0.830
Validation loss decreased (-0.811102 --> -0.829622).  Saving model ...
Epoch: 9 cost time: 0.7355194091796875
Epoch: 9, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.829622 --> -0.844438).  Saving model ...
Epoch: 10 cost time: 0.8989264965057373
Epoch: 10, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.539 Vali Acc: 0.878 Test Loss: 0.539 Test Acc: 0.878
Validation loss decreased (-0.844438 --> -0.877772).  Saving model ...
Epoch: 11 cost time: 0.8285007476806641
Epoch: 11, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.453 Vali Acc: 0.896 Test Loss: 0.453 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896292).  Saving model ...
Epoch: 12 cost time: 0.7307925224304199
Epoch: 12, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.381 Vali Acc: 0.907 Test Loss: 0.381 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907404).  Saving model ...
Epoch: 13 cost time: 1.0530946254730225
Epoch: 13, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.322 Vali Acc: 0.926 Test Loss: 0.322 Test Acc: 0.926
Validation loss decreased (-0.907404 --> -0.925923).  Saving model ...
Epoch: 14 cost time: 0.8506631851196289
Epoch: 14, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.280 Vali Acc: 0.930 Test Loss: 0.280 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 15 cost time: 0.8295331001281738
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.8622963428497314
Epoch: 16, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.8540732860565186
Epoch: 17, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.937035 --> -0.951850).  Saving model ...
Epoch: 18 cost time: 0.9029104709625244
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9260010719299316
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.7982134819030762
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.9924793243408203
Epoch: 21, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.8810479640960693
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.0640735626220703
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.9234304428100586
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.8356435298919678
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.7879838943481445
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.913165807723999
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1170246
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0936102867126465
Epoch: 1, Steps: 2 | Train Loss: 2.167 Vali Loss: 1.863 Vali Acc: 0.200 Test Loss: 1.863 Test Acc: 0.200
Validation loss decreased (inf --> -0.199981).  Saving model ...
Epoch: 2 cost time: 1.0678339004516602
Epoch: 2, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.727 Vali Acc: 0.252 Test Loss: 1.727 Test Acc: 0.252
Validation loss decreased (-0.199981 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.8481128215789795
Epoch: 3, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.598 Vali Acc: 0.333 Test Loss: 1.598 Test Acc: 0.333
Validation loss decreased (-0.251835 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.819720983505249
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.435 Vali Acc: 0.507 Test Loss: 1.435 Test Acc: 0.507
Validation loss decreased (-0.333317 --> -0.507393).  Saving model ...
Epoch: 5 cost time: 0.828495979309082
Epoch: 5, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.249 Vali Acc: 0.678 Test Loss: 1.249 Test Acc: 0.678
Validation loss decreased (-0.507393 --> -0.677765).  Saving model ...
Epoch: 6 cost time: 0.9937794208526611
Epoch: 6, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.063 Vali Acc: 0.781 Test Loss: 1.063 Test Acc: 0.781
Validation loss decreased (-0.677765 --> -0.781471).  Saving model ...
Epoch: 7 cost time: 0.9861433506011963
Epoch: 7, Steps: 2 | Train Loss: 0.922 Vali Loss: 0.894 Vali Acc: 0.826 Test Loss: 0.894 Test Acc: 0.826
Validation loss decreased (-0.781471 --> -0.825917).  Saving model ...
Epoch: 8 cost time: 0.8776113986968994
Epoch: 8, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.748 Vali Acc: 0.841 Test Loss: 0.748 Test Acc: 0.841
Validation loss decreased (-0.825917 --> -0.840733).  Saving model ...
Epoch: 9 cost time: 1.0360147953033447
Epoch: 9, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.629 Vali Acc: 0.848 Test Loss: 0.629 Test Acc: 0.848
Validation loss decreased (-0.840733 --> -0.848142).  Saving model ...
Epoch: 10 cost time: 0.8496272563934326
Epoch: 10, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.526 Vali Acc: 0.904 Test Loss: 0.526 Test Acc: 0.904
Validation loss decreased (-0.848142 --> -0.903698).  Saving model ...
Epoch: 11 cost time: 0.8237025737762451
Epoch: 11, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 0.9842624664306641
Epoch: 12, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.368 Vali Acc: 0.922 Test Loss: 0.368 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 13 cost time: 0.9906966686248779
Epoch: 13, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 14 cost time: 0.9239745140075684
Epoch: 14, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.9488732814788818
Epoch: 15, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 16 cost time: 1.0335171222686768
Epoch: 16, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.8707120418548584
Epoch: 17, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.9601612091064453
Epoch: 18, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.9822874069213867
Epoch: 19, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.8212907314300537
Epoch: 20, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.948 Test Loss: 0.189 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.8154687881469727
Epoch: 21, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.8157753944396973
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8197116851806641
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8954713344573975
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8292772769927979
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.827003002166748
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8401601314544678
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.939049243927002
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8873250484466553
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.164 Vali Acc: 0.948 Test Loss: 0.164 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.9283509254455566
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.948 Test Loss: 0.163 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.9574241638183594
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.162 Vali Acc: 0.948 Test Loss: 0.162 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1170246
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.831643581390381
Epoch: 1, Steps: 2 | Train Loss: 2.077 Vali Loss: 1.892 Vali Acc: 0.185 Test Loss: 1.892 Test Acc: 0.185
Validation loss decreased (inf --> -0.185166).  Saving model ...
Epoch: 2 cost time: 0.7556078433990479
Epoch: 2, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.754 Vali Acc: 0.219 Test Loss: 1.754 Test Acc: 0.219
Validation loss decreased (-0.185166 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.7825496196746826
Epoch: 3, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.622 Vali Acc: 0.333 Test Loss: 1.622 Test Acc: 0.333
Validation loss decreased (-0.218501 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.8974039554595947
Epoch: 4, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.456 Vali Acc: 0.507 Test Loss: 1.456 Test Acc: 0.507
Validation loss decreased (-0.333317 --> -0.507393).  Saving model ...
Epoch: 5 cost time: 0.6949453353881836
Epoch: 5, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.265 Vali Acc: 0.663 Test Loss: 1.265 Test Acc: 0.663
Validation loss decreased (-0.507393 --> -0.662950).  Saving model ...
Epoch: 6 cost time: 0.9832909107208252
Epoch: 6, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.074 Vali Acc: 0.767 Test Loss: 1.074 Test Acc: 0.767
Validation loss decreased (-0.662950 --> -0.766656).  Saving model ...
Epoch: 7 cost time: 0.9162619113922119
Epoch: 7, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.900 Vali Acc: 0.822 Test Loss: 0.900 Test Acc: 0.822
Validation loss decreased (-0.766656 --> -0.822213).  Saving model ...
Epoch: 8 cost time: 0.8377432823181152
Epoch: 8, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.751 Vali Acc: 0.856 Test Loss: 0.751 Test Acc: 0.856
Validation loss decreased (-0.822213 --> -0.855548).  Saving model ...
Epoch: 9 cost time: 0.8116245269775391
Epoch: 9, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.628 Vali Acc: 0.881 Test Loss: 0.628 Test Acc: 0.881
Validation loss decreased (-0.855548 --> -0.881475).  Saving model ...
Epoch: 10 cost time: 0.8480284214019775
Epoch: 10, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.525 Vali Acc: 0.889 Test Loss: 0.525 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888884).  Saving model ...
Epoch: 11 cost time: 0.782031774520874
Epoch: 11, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.437 Vali Acc: 0.900 Test Loss: 0.437 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 12 cost time: 0.7745640277862549
Epoch: 12, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
Validation loss decreased (-0.899996 --> -0.918515).  Saving model ...
Epoch: 13 cost time: 0.7959656715393066
Epoch: 13, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.312 Vali Acc: 0.919 Test Loss: 0.312 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 14 cost time: 0.7294936180114746
Epoch: 14, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 15 cost time: 0.7161352634429932
Epoch: 15, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.7763981819152832
Epoch: 16, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.8377547264099121
Epoch: 17, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.8380661010742188
Epoch: 18, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8413171768188477
Epoch: 19, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.8104150295257568
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 0.752922534942627
Epoch: 21, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.8659021854400635
Epoch: 22, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.8716840744018555
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.8418588638305664
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.8400359153747559
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.7776849269866943
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.169 Vali Acc: 0.941 Test Loss: 0.169 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7771775722503662
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7527461051940918
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.166 Vali Acc: 0.937 Test Loss: 0.166 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.7851016521453857
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.941 Test Loss: 0.165 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.7165253162384033
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.7838318347930908
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.8905973434448242
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.7787632942199707
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.944 Test Loss: 0.161 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.8312418460845947
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.161 Vali Acc: 0.948 Test Loss: 0.161 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 35 cost time: 0.734379768371582
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.948147 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.7633655071258545
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.7581818103790283
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.7869656085968018
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.8528587818145752
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.7917892932891846
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 0.801445722579956
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.952 Test Loss: 0.160 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.8804302215576172
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8459138870239258
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.9217326641082764
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8252873420715332
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.9531111717224121
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8571610450744629
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8967103958129883
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.806403636932373
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.86383056640625
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.162 Vali Acc: 0.952 Test Loss: 0.162 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 1170246
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.965177059173584
Epoch: 1, Steps: 2 | Train Loss: 2.116 Vali Loss: 1.867 Vali Acc: 0.152 Test Loss: 1.867 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.7087736129760742
Epoch: 2, Steps: 2 | Train Loss: 1.795 Vali Loss: 1.731 Vali Acc: 0.207 Test Loss: 1.731 Test Acc: 0.207
Validation loss decreased (-0.151833 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.8018193244934082
Epoch: 3, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.602 Vali Acc: 0.326 Test Loss: 1.602 Test Acc: 0.326
Validation loss decreased (-0.207390 --> -0.325910).  Saving model ...
Epoch: 4 cost time: 0.7306962013244629
Epoch: 4, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.440 Vali Acc: 0.585 Test Loss: 1.440 Test Acc: 0.585
Validation loss decreased (-0.325910 --> -0.585171).  Saving model ...
Epoch: 5 cost time: 0.7044954299926758
Epoch: 5, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.255 Vali Acc: 0.711 Test Loss: 1.255 Test Acc: 0.711
Validation loss decreased (-0.585171 --> -0.711099).  Saving model ...
Epoch: 6 cost time: 0.7431421279907227
Epoch: 6, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.070 Vali Acc: 0.774 Test Loss: 1.070 Test Acc: 0.774
Validation loss decreased (-0.711099 --> -0.774063).  Saving model ...
Epoch: 7 cost time: 0.7039484977722168
Epoch: 7, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.904 Vali Acc: 0.822 Test Loss: 0.904 Test Acc: 0.822
Validation loss decreased (-0.774063 --> -0.822213).  Saving model ...
Epoch: 8 cost time: 0.8654794692993164
Epoch: 8, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.761 Vali Acc: 0.830 Test Loss: 0.761 Test Acc: 0.830
Validation loss decreased (-0.822213 --> -0.829622).  Saving model ...
Epoch: 9 cost time: 0.854741096496582
Epoch: 9, Steps: 2 | Train Loss: 0.612 Vali Loss: 0.644 Vali Acc: 0.848 Test Loss: 0.644 Test Acc: 0.848
Validation loss decreased (-0.829622 --> -0.848142).  Saving model ...
Epoch: 10 cost time: 1.0015473365783691
Epoch: 10, Steps: 2 | Train Loss: 0.478 Vali Loss: 0.546 Vali Acc: 0.867 Test Loss: 0.546 Test Acc: 0.867
Validation loss decreased (-0.848142 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 0.7896003723144531
Epoch: 11, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.463 Vali Acc: 0.885 Test Loss: 0.463 Test Acc: 0.885
Validation loss decreased (-0.866661 --> -0.885181).  Saving model ...
Epoch: 12 cost time: 0.729142427444458
Epoch: 12, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.396 Vali Acc: 0.893 Test Loss: 0.396 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 13 cost time: 0.9401638507843018
Epoch: 13, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
Validation loss decreased (-0.892589 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.8566310405731201
Epoch: 14, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925923).  Saving model ...
Epoch: 15 cost time: 0.7537624835968018
Epoch: 15, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.8036272525787354
Epoch: 16, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.8313381671905518
Epoch: 17, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.8950562477111816
Epoch: 18, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.769132137298584
Epoch: 19, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.7942938804626465
Epoch: 20, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.8550069332122803
Epoch: 21, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.8112998008728027
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.8213973045349121
Epoch: 23, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.8226325511932373
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.751945972442627
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1170246
model size : 6.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2707266807556152
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.761 Vali Acc: 0.230 Test Loss: 1.761 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.7674250602722168
Epoch: 2, Steps: 2 | Train Loss: 1.872 Vali Loss: 1.654 Vali Acc: 0.293 Test Loss: 1.654 Test Acc: 0.293
Validation loss decreased (-0.229612 --> -0.292576).  Saving model ...
Epoch: 3 cost time: 0.9660184383392334
Epoch: 3, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.549 Vali Acc: 0.359 Test Loss: 1.549 Test Acc: 0.359
Validation loss decreased (-0.292576 --> -0.359244).  Saving model ...
Epoch: 4 cost time: 1.0916531085968018
Epoch: 4, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.413 Vali Acc: 0.474 Test Loss: 1.413 Test Acc: 0.474
Validation loss decreased (-0.359244 --> -0.474060).  Saving model ...
Epoch: 5 cost time: 0.8999006748199463
Epoch: 5, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.258 Vali Acc: 0.574 Test Loss: 1.258 Test Acc: 0.574
Validation loss decreased (-0.474060 --> -0.574061).  Saving model ...
Epoch: 6 cost time: 0.9862806797027588
Epoch: 6, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.101 Vali Acc: 0.667 Test Loss: 1.101 Test Acc: 0.667
Validation loss decreased (-0.574061 --> -0.666656).  Saving model ...
Epoch: 7 cost time: 0.7746200561523438
Epoch: 7, Steps: 2 | Train Loss: 0.996 Vali Loss: 0.949 Vali Acc: 0.741 Test Loss: 0.949 Test Acc: 0.741
Validation loss decreased (-0.666656 --> -0.740731).  Saving model ...
Epoch: 8 cost time: 0.7859859466552734
Epoch: 8, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.809 Vali Acc: 0.807 Test Loss: 0.809 Test Acc: 0.807
Validation loss decreased (-0.740731 --> -0.807399).  Saving model ...
Epoch: 9 cost time: 0.9743649959564209
Epoch: 9, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.686 Vali Acc: 0.848 Test Loss: 0.686 Test Acc: 0.848
Validation loss decreased (-0.807399 --> -0.848141).  Saving model ...
Epoch: 10 cost time: 0.9450924396514893
Epoch: 10, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862957).  Saving model ...
Epoch: 11 cost time: 0.9799516201019287
Epoch: 11, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.495 Vali Acc: 0.896 Test Loss: 0.495 Test Acc: 0.896
Validation loss decreased (-0.862957 --> -0.896291).  Saving model ...
Epoch: 12 cost time: 0.845538854598999
Epoch: 12, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.427 Vali Acc: 0.904 Test Loss: 0.427 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 13 cost time: 1.072129726409912
Epoch: 13, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.374 Vali Acc: 0.907 Test Loss: 0.374 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907404).  Saving model ...
Epoch: 14 cost time: 0.9452581405639648
Epoch: 14, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 0.9465129375457764
Epoch: 15, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.8819525241851807
Epoch: 16, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 0.9176435470581055
Epoch: 17, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.7685658931732178
Epoch: 18, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.7446093559265137
Epoch: 19, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7749218940734863
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.797644853591919
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.8011374473571777
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.9262971878051758
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.8471250534057617
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.7438492774963379
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8315813541412354
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.8956265449523926
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.7919013500213623
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.9420928955078125
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.8756167888641357
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.9216516017913818
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.8625514507293701
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 1.0461008548736572
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.7660877704620361
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.8977770805358887
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.8603415489196777
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.8278234004974365
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.812946081161499
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.8442685604095459
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 0.7565126419067383
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.8245112895965576
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.822760820388794
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.8256824016571045
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.7949163913726807
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.7434384822845459
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8152573108673096
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.8608071804046631
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.8141326904296875
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.9798188209533691
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.9476630687713623
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.0109963417053223
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.9229049682617188
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.8505315780639648
Epoch: 53, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9139807224273682
Epoch: 54, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 645958
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.6307260990142822
Epoch: 1, Steps: 2 | Train Loss: 1.881 Vali Loss: 1.767 Vali Acc: 0.233 Test Loss: 1.767 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.7782254219055176
Epoch: 2, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.659 Vali Acc: 0.293 Test Loss: 1.659 Test Acc: 0.293
Validation loss decreased (-0.233316 --> -0.292576).  Saving model ...
Epoch: 3 cost time: 0.8105494976043701
Epoch: 3, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.553 Vali Acc: 0.356 Test Loss: 1.553 Test Acc: 0.356
Validation loss decreased (-0.292576 --> -0.355540).  Saving model ...
Epoch: 4 cost time: 0.8235461711883545
Epoch: 4, Steps: 2 | Train Loss: 1.416 Vali Loss: 1.415 Vali Acc: 0.489 Test Loss: 1.415 Test Acc: 0.489
Validation loss decreased (-0.355540 --> -0.488875).  Saving model ...
Epoch: 5 cost time: 0.8916583061218262
Epoch: 5, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.260 Vali Acc: 0.563 Test Loss: 1.260 Test Acc: 0.563
Validation loss decreased (-0.488875 --> -0.562950).  Saving model ...
Epoch: 6 cost time: 0.8486716747283936
Epoch: 6, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.103 Vali Acc: 0.659 Test Loss: 1.103 Test Acc: 0.659
Validation loss decreased (-0.562950 --> -0.659248).  Saving model ...
Epoch: 7 cost time: 0.8697378635406494
Epoch: 7, Steps: 2 | Train Loss: 0.979 Vali Loss: 0.951 Vali Acc: 0.704 Test Loss: 0.951 Test Acc: 0.704
Validation loss decreased (-0.659248 --> -0.703694).  Saving model ...
Epoch: 8 cost time: 0.811593770980835
Epoch: 8, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.810 Vali Acc: 0.785 Test Loss: 0.810 Test Acc: 0.785
Validation loss decreased (-0.703694 --> -0.785177).  Saving model ...
Epoch: 9 cost time: 0.9842231273651123
Epoch: 9, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.688 Vali Acc: 0.822 Test Loss: 0.688 Test Acc: 0.822
Validation loss decreased (-0.785177 --> -0.822215).  Saving model ...
Epoch: 10 cost time: 0.9875094890594482
Epoch: 10, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.584 Vali Acc: 0.852 Test Loss: 0.584 Test Acc: 0.852
Validation loss decreased (-0.822215 --> -0.851846).  Saving model ...
Epoch: 11 cost time: 0.9246842861175537
Epoch: 11, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.498 Vali Acc: 0.881 Test Loss: 0.498 Test Acc: 0.881
Validation loss decreased (-0.851846 --> -0.881477).  Saving model ...
Epoch: 12 cost time: 0.8597218990325928
Epoch: 12, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.429 Vali Acc: 0.904 Test Loss: 0.429 Test Acc: 0.904
Validation loss decreased (-0.881477 --> -0.903699).  Saving model ...
Epoch: 13 cost time: 0.8369400501251221
Epoch: 13, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.374 Vali Acc: 0.911 Test Loss: 0.374 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 14 cost time: 0.7875034809112549
Epoch: 14, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914812).  Saving model ...
Epoch: 15 cost time: 0.9203498363494873
Epoch: 15, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 16 cost time: 0.8348939418792725
Epoch: 16, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.918516 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.8557558059692383
Epoch: 17, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 18 cost time: 1.0120882987976074
Epoch: 18, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.8862974643707275
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 20 cost time: 0.7997496128082275
Epoch: 20, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.9361753463745117
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.8802740573883057
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.835911750793457
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.8954288959503174
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.9512481689453125
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.85906982421875
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.7974798679351807
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.8800003528594971
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.114811658859253
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.7583186626434326
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.8239600658416748
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.9342916011810303
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.8261985778808594
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.8726246356964111
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.8304247856140137
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.9628925323486328
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.0921168327331543
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 645958
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1743500232696533
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.753 Vali Acc: 0.259 Test Loss: 1.753 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.7905445098876953
Epoch: 2, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.644 Vali Acc: 0.330 Test Loss: 1.644 Test Acc: 0.330
Validation loss decreased (-0.259242 --> -0.329613).  Saving model ...
Epoch: 3 cost time: 0.885420560836792
Epoch: 3, Steps: 2 | Train Loss: 1.549 Vali Loss: 1.537 Vali Acc: 0.415 Test Loss: 1.537 Test Acc: 0.415
Validation loss decreased (-0.329613 --> -0.414799).  Saving model ...
Epoch: 4 cost time: 0.8368518352508545
Epoch: 4, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.399 Vali Acc: 0.519 Test Loss: 1.399 Test Acc: 0.519
Validation loss decreased (-0.414799 --> -0.518505).  Saving model ...
Epoch: 5 cost time: 0.7745201587677002
Epoch: 5, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.243 Vali Acc: 0.596 Test Loss: 1.243 Test Acc: 0.596
Validation loss decreased (-0.518505 --> -0.596284).  Saving model ...
Epoch: 6 cost time: 0.8081660270690918
Epoch: 6, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.083 Vali Acc: 0.693 Test Loss: 1.083 Test Acc: 0.693
Validation loss decreased (-0.596284 --> -0.692582).  Saving model ...
Epoch: 7 cost time: 0.8733177185058594
Epoch: 7, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.931 Vali Acc: 0.763 Test Loss: 0.931 Test Acc: 0.763
Validation loss decreased (-0.692582 --> -0.762954).  Saving model ...
Epoch: 8 cost time: 0.954655647277832
Epoch: 8, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.791 Vali Acc: 0.819 Test Loss: 0.791 Test Acc: 0.819
Validation loss decreased (-0.762954 --> -0.818511).  Saving model ...
Epoch: 9 cost time: 0.9045271873474121
Epoch: 9, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.668 Vali Acc: 0.848 Test Loss: 0.668 Test Acc: 0.848
Validation loss decreased (-0.818511 --> -0.848141).  Saving model ...
Epoch: 10 cost time: 0.9471757411956787
Epoch: 10, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.564 Vali Acc: 0.874 Test Loss: 0.564 Test Acc: 0.874
Validation loss decreased (-0.848141 --> -0.874068).  Saving model ...
Epoch: 11 cost time: 0.9388153553009033
Epoch: 11, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.479 Vali Acc: 0.900 Test Loss: 0.479 Test Acc: 0.900
Validation loss decreased (-0.874068 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.8022799491882324
Epoch: 12, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.414 Vali Acc: 0.907 Test Loss: 0.414 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 0.6860404014587402
Epoch: 13, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.361 Vali Acc: 0.911 Test Loss: 0.361 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 14 cost time: 0.8345253467559814
Epoch: 14, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.317 Vali Acc: 0.911 Test Loss: 0.317 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.8352019786834717
Epoch: 15, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.281 Vali Acc: 0.915 Test Loss: 0.281 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.8835084438323975
Epoch: 16, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.914812 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 0.8450462818145752
Epoch: 17, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.9193708896636963
Epoch: 18, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 1.0493037700653076
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.9213528633117676
Epoch: 20, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.8219506740570068
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.9435880184173584
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 23 cost time: 0.9964325428009033
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 1.0656239986419678
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 1.1022529602050781
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 1.0937254428863525
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.0885775089263916
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 1.0020041465759277
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.9761273860931396
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 1.0004520416259766
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 1.0482985973358154
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.9623367786407471
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 33 cost time: 0.9134948253631592
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 34 cost time: 0.8763160705566406
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 35 cost time: 0.8551087379455566
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 36 cost time: 1.050851821899414
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.0379257202148438
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.165 Vali Acc: 0.952 Test Loss: 0.165 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.0571768283843994
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.9979069232940674
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.9625768661499023
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 41 cost time: 1.0487697124481201
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959258).  Saving model ...
Epoch: 42 cost time: 1.0782077312469482
Epoch: 42, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 43 cost time: 1.0761308670043945
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 1.2522883415222168
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
Validation loss decreased (-0.959258 --> -0.959258).  Saving model ...
Epoch: 45 cost time: 1.027259111404419
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 1.0162627696990967
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.9154326915740967
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 1.0564708709716797
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.163 Vali Acc: 0.959 Test Loss: 0.163 Test Acc: 0.959
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 1.2565312385559082
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.959 Test Loss: 0.164 Test Acc: 0.959
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 1.1473569869995117
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 1.4290730953216553
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 1.2749338150024414
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 1.1758575439453125
Epoch: 53, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.9266200065612793
Epoch: 54, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 645958
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.206852912902832
Epoch: 1, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.730 Vali Acc: 0.274 Test Loss: 1.730 Test Acc: 0.274
Validation loss decreased (inf --> -0.274057).  Saving model ...
Epoch: 2 cost time: 0.9209210872650146
Epoch: 2, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.624 Vali Acc: 0.300 Test Loss: 1.624 Test Acc: 0.300
Validation loss decreased (-0.274057 --> -0.299984).  Saving model ...
Epoch: 3 cost time: 0.7901041507720947
Epoch: 3, Steps: 2 | Train Loss: 1.525 Vali Loss: 1.521 Vali Acc: 0.370 Test Loss: 1.521 Test Acc: 0.370
Validation loss decreased (-0.299984 --> -0.370355).  Saving model ...
Epoch: 4 cost time: 0.8962969779968262
Epoch: 4, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.386 Vali Acc: 0.500 Test Loss: 1.386 Test Acc: 0.500
Validation loss decreased (-0.370355 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 0.8871221542358398
Epoch: 5, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.236 Vali Acc: 0.626 Test Loss: 1.236 Test Acc: 0.626
Validation loss decreased (-0.499986 --> -0.625914).  Saving model ...
Epoch: 6 cost time: 0.7026102542877197
Epoch: 6, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.086 Vali Acc: 0.704 Test Loss: 1.086 Test Acc: 0.704
Validation loss decreased (-0.625914 --> -0.703693).  Saving model ...
Epoch: 7 cost time: 0.7550232410430908
Epoch: 7, Steps: 2 | Train Loss: 1.018 Vali Loss: 0.940 Vali Acc: 0.733 Test Loss: 0.940 Test Acc: 0.733
Validation loss decreased (-0.703693 --> -0.733324).  Saving model ...
Epoch: 8 cost time: 0.8528759479522705
Epoch: 8, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.806 Vali Acc: 0.796 Test Loss: 0.806 Test Acc: 0.796
Validation loss decreased (-0.733324 --> -0.796288).  Saving model ...
Epoch: 9 cost time: 0.8111121654510498
Epoch: 9, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.691 Vali Acc: 0.830 Test Loss: 0.691 Test Acc: 0.830
Validation loss decreased (-0.796288 --> -0.829623).  Saving model ...
Epoch: 10 cost time: 0.8200945854187012
Epoch: 10, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
Validation loss decreased (-0.829623 --> -0.844439).  Saving model ...
Epoch: 11 cost time: 0.9557983875274658
Epoch: 11, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.844439 --> -0.862958).  Saving model ...
Epoch: 12 cost time: 0.7673230171203613
Epoch: 12, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.445 Vali Acc: 0.889 Test Loss: 0.445 Test Acc: 0.889
Validation loss decreased (-0.862958 --> -0.888884).  Saving model ...
Epoch: 13 cost time: 0.7545902729034424
Epoch: 13, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.9863052368164062
Epoch: 14, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.354 Vali Acc: 0.907 Test Loss: 0.354 Test Acc: 0.907
Validation loss decreased (-0.888885 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 0.9626901149749756
Epoch: 15, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.320 Vali Acc: 0.911 Test Loss: 0.320 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 16 cost time: 0.901141881942749
Epoch: 16, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.8415887355804443
Epoch: 17, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.8786466121673584
Epoch: 18, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.737654447555542
Epoch: 19, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.7709898948669434
Epoch: 20, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7154231071472168
Epoch: 21, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.8632287979125977
Epoch: 22, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0781030654907227
Epoch: 23, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8167564868927002
Epoch: 24, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.8502695560455322
Epoch: 25, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8551561832427979
Epoch: 26, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.8734419345855713
Epoch: 27, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.9804372787475586
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8741245269775391
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.8541936874389648
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8970770835876465
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 645958
model size : 4.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.055467128753662
Epoch: 1, Steps: 2 | Train Loss: 2.029 Vali Loss: 1.846 Vali Acc: 0.167 Test Loss: 1.846 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.9690816402435303
Epoch: 2, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.742 Vali Acc: 0.248 Test Loss: 1.742 Test Acc: 0.248
Validation loss decreased (-0.166648 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 1.087557315826416
Epoch: 3, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.639 Vali Acc: 0.330 Test Loss: 1.639 Test Acc: 0.330
Validation loss decreased (-0.248131 --> -0.329613).  Saving model ...
Epoch: 4 cost time: 0.9305977821350098
Epoch: 4, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.498 Vali Acc: 0.441 Test Loss: 1.498 Test Acc: 0.441
Validation loss decreased (-0.329613 --> -0.440726).  Saving model ...
Epoch: 5 cost time: 0.9495837688446045
Epoch: 5, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.335 Vali Acc: 0.526 Test Loss: 1.335 Test Acc: 0.526
Validation loss decreased (-0.440726 --> -0.525913).  Saving model ...
Epoch: 6 cost time: 0.8669333457946777
Epoch: 6, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.166 Vali Acc: 0.589 Test Loss: 1.166 Test Acc: 0.589
Validation loss decreased (-0.525913 --> -0.588877).  Saving model ...
Epoch: 7 cost time: 0.83270263671875
Epoch: 7, Steps: 2 | Train Loss: 0.957 Vali Loss: 1.002 Vali Acc: 0.696 Test Loss: 1.002 Test Acc: 0.696
Validation loss decreased (-0.588877 --> -0.696286).  Saving model ...
Epoch: 8 cost time: 0.8339638710021973
Epoch: 8, Steps: 2 | Train Loss: 0.830 Vali Loss: 0.854 Vali Acc: 0.741 Test Loss: 0.854 Test Acc: 0.741
Validation loss decreased (-0.696286 --> -0.740732).  Saving model ...
Epoch: 9 cost time: 0.7864444255828857
Epoch: 9, Steps: 2 | Train Loss: 0.718 Vali Loss: 0.727 Vali Acc: 0.785 Test Loss: 0.727 Test Acc: 0.785
Validation loss decreased (-0.740732 --> -0.785178).  Saving model ...
Epoch: 10 cost time: 0.8875315189361572
Epoch: 10, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.619 Vali Acc: 0.841 Test Loss: 0.619 Test Acc: 0.841
Validation loss decreased (-0.785178 --> -0.840735).  Saving model ...
Epoch: 11 cost time: 0.9356939792633057
Epoch: 11, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.531 Vali Acc: 0.856 Test Loss: 0.531 Test Acc: 0.856
Validation loss decreased (-0.840735 --> -0.855550).  Saving model ...
Epoch: 12 cost time: 1.0092971324920654
Epoch: 12, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.457 Vali Acc: 0.881 Test Loss: 0.457 Test Acc: 0.881
Validation loss decreased (-0.855550 --> -0.881477).  Saving model ...
Epoch: 13 cost time: 0.9987320899963379
Epoch: 13, Steps: 2 | Train Loss: 0.254 Vali Loss: 0.398 Vali Acc: 0.889 Test Loss: 0.398 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.9199535846710205
Epoch: 14, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 1.115936517715454
Epoch: 15, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.308 Vali Acc: 0.915 Test Loss: 0.308 Test Acc: 0.915
Validation loss decreased (-0.899997 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.9716203212738037
Epoch: 16, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.9690639972686768
Epoch: 17, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.7892160415649414
Epoch: 18, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 0.8609695434570312
Epoch: 19, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 1.0595977306365967
Epoch: 20, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.9277260303497314
Epoch: 21, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.950639009475708
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.9233827590942383
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.9169774055480957
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.984208345413208
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.9469106197357178
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.9024660587310791
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.8923063278198242
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.8834640979766846
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.9760644435882568
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.8999185562133789
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.840686559677124
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.8062195777893066
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.8231470584869385
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.888120174407959
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.903663158416748
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.948 Test Loss: 0.178 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.0966341495513916
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.8641722202301025
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.0150032043457031
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.9414055347442627
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.9052062034606934
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.0298137664794922
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.9419901371002197
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 383814
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.336125373840332
Epoch: 1, Steps: 2 | Train Loss: 1.977 Vali Loss: 1.844 Vali Acc: 0.163 Test Loss: 1.844 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.682905912399292
Epoch: 2, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.739 Vali Acc: 0.252 Test Loss: 1.739 Test Acc: 0.252
Validation loss decreased (-0.162945 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.8417422771453857
Epoch: 3, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.634 Vali Acc: 0.322 Test Loss: 1.634 Test Acc: 0.322
Validation loss decreased (-0.251834 --> -0.322206).  Saving model ...
Epoch: 4 cost time: 0.791738748550415
Epoch: 4, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.492 Vali Acc: 0.444 Test Loss: 1.492 Test Acc: 0.444
Validation loss decreased (-0.322206 --> -0.444430).  Saving model ...
Epoch: 5 cost time: 0.7691099643707275
Epoch: 5, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.328 Vali Acc: 0.544 Test Loss: 1.328 Test Acc: 0.544
Validation loss decreased (-0.444430 --> -0.544431).  Saving model ...
Epoch: 6 cost time: 0.8052041530609131
Epoch: 6, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.157 Vali Acc: 0.637 Test Loss: 1.157 Test Acc: 0.637
Validation loss decreased (-0.544431 --> -0.637025).  Saving model ...
Epoch: 7 cost time: 0.9178440570831299
Epoch: 7, Steps: 2 | Train Loss: 0.951 Vali Loss: 0.992 Vali Acc: 0.711 Test Loss: 0.992 Test Acc: 0.711
Validation loss decreased (-0.637025 --> -0.711101).  Saving model ...
Epoch: 8 cost time: 0.8579668998718262
Epoch: 8, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.843 Vali Acc: 0.752 Test Loss: 0.843 Test Acc: 0.752
Validation loss decreased (-0.711101 --> -0.751843).  Saving model ...
Epoch: 9 cost time: 0.7888145446777344
Epoch: 9, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.716 Vali Acc: 0.804 Test Loss: 0.716 Test Acc: 0.804
Validation loss decreased (-0.751843 --> -0.803697).  Saving model ...
Epoch: 10 cost time: 0.7572298049926758
Epoch: 10, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.607 Vali Acc: 0.830 Test Loss: 0.607 Test Acc: 0.830
Validation loss decreased (-0.803697 --> -0.829624).  Saving model ...
Epoch: 11 cost time: 0.8395369052886963
Epoch: 11, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.518 Vali Acc: 0.848 Test Loss: 0.518 Test Acc: 0.848
Validation loss decreased (-0.829624 --> -0.848143).  Saving model ...
Epoch: 12 cost time: 0.8856821060180664
Epoch: 12, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.443 Vali Acc: 0.870 Test Loss: 0.443 Test Acc: 0.870
Validation loss decreased (-0.848143 --> -0.870366).  Saving model ...
Epoch: 13 cost time: 0.9264967441558838
Epoch: 13, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.385 Vali Acc: 0.889 Test Loss: 0.385 Test Acc: 0.889
Validation loss decreased (-0.870366 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.8199460506439209
Epoch: 14, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.334 Vali Acc: 0.904 Test Loss: 0.334 Test Acc: 0.904
Validation loss decreased (-0.888885 --> -0.903700).  Saving model ...
Epoch: 15 cost time: 0.86397385597229
Epoch: 15, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.298 Vali Acc: 0.919 Test Loss: 0.298 Test Acc: 0.919
Validation loss decreased (-0.903700 --> -0.918516).  Saving model ...
Epoch: 16 cost time: 0.7786872386932373
Epoch: 16, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 0.7486603260040283
Epoch: 17, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.918516 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.8573172092437744
Epoch: 18, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.8029940128326416
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.7274317741394043
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.8065354824066162
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.6770048141479492
Epoch: 22, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.8863785266876221
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.7748875617980957
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 25 cost time: 1.0504491329193115
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 26 cost time: 0.8706109523773193
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.948 Test Loss: 0.179 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 27 cost time: 0.8073043823242188
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 28 cost time: 0.733107328414917
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 29 cost time: 0.8321177959442139
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.8078274726867676
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 31 cost time: 0.8710505962371826
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 32 cost time: 0.9313759803771973
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 33 cost time: 0.7773034572601318
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.7884981632232666
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.8257300853729248
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 0.7867124080657959
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.988234281539917
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.8339602947235107
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.8137392997741699
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.867342472076416
Epoch: 40, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.9051940441131592
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.8161349296569824
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.9158508777618408
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.7629752159118652
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.9347312450408936
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.8527829647064209
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.874678373336792
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 383814
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.059950113296509
Epoch: 1, Steps: 2 | Train Loss: 1.918 Vali Loss: 1.785 Vali Acc: 0.215 Test Loss: 1.785 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.8957979679107666
Epoch: 2, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.680 Vali Acc: 0.307 Test Loss: 1.680 Test Acc: 0.307
Validation loss decreased (-0.214797 --> -0.307391).  Saving model ...
Epoch: 3 cost time: 0.8480911254882812
Epoch: 3, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.577 Vali Acc: 0.389 Test Loss: 1.577 Test Acc: 0.389
Validation loss decreased (-0.307391 --> -0.388873).  Saving model ...
Epoch: 4 cost time: 0.8380634784698486
Epoch: 4, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.438 Vali Acc: 0.522 Test Loss: 1.438 Test Acc: 0.522
Validation loss decreased (-0.388873 --> -0.522208).  Saving model ...
Epoch: 5 cost time: 0.8837518692016602
Epoch: 5, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.279 Vali Acc: 0.585 Test Loss: 1.279 Test Acc: 0.585
Validation loss decreased (-0.522208 --> -0.585172).  Saving model ...
Epoch: 6 cost time: 0.8199765682220459
Epoch: 6, Steps: 2 | Train Loss: 1.169 Vali Loss: 1.113 Vali Acc: 0.626 Test Loss: 1.113 Test Acc: 0.626
Validation loss decreased (-0.585172 --> -0.625915).  Saving model ...
Epoch: 7 cost time: 1.1037602424621582
Epoch: 7, Steps: 2 | Train Loss: 0.897 Vali Loss: 0.954 Vali Acc: 0.715 Test Loss: 0.954 Test Acc: 0.715
Validation loss decreased (-0.625915 --> -0.714805).  Saving model ...
Epoch: 8 cost time: 1.072967529296875
Epoch: 8, Steps: 2 | Train Loss: 0.783 Vali Loss: 0.811 Vali Acc: 0.767 Test Loss: 0.811 Test Acc: 0.767
Validation loss decreased (-0.714805 --> -0.766659).  Saving model ...
Epoch: 9 cost time: 0.8628020286560059
Epoch: 9, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.689 Vali Acc: 0.789 Test Loss: 0.689 Test Acc: 0.789
Validation loss decreased (-0.766659 --> -0.788882).  Saving model ...
Epoch: 10 cost time: 0.8751587867736816
Epoch: 10, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.583 Vali Acc: 0.837 Test Loss: 0.583 Test Acc: 0.837
Validation loss decreased (-0.788882 --> -0.837031).  Saving model ...
Epoch: 11 cost time: 1.1447196006774902
Epoch: 11, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.498 Vali Acc: 0.859 Test Loss: 0.498 Test Acc: 0.859
Validation loss decreased (-0.837031 --> -0.859254).  Saving model ...
Epoch: 12 cost time: 0.9171497821807861
Epoch: 12, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.427 Vali Acc: 0.885 Test Loss: 0.427 Test Acc: 0.885
Validation loss decreased (-0.859254 --> -0.885181).  Saving model ...
Epoch: 13 cost time: 1.0187439918518066
Epoch: 13, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.372 Vali Acc: 0.907 Test Loss: 0.372 Test Acc: 0.907
Validation loss decreased (-0.885181 --> -0.907404).  Saving model ...
Epoch: 14 cost time: 0.9725401401519775
Epoch: 14, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 1.0629706382751465
Epoch: 15, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 1.2047865390777588
Epoch: 16, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 0.8494060039520264
Epoch: 17, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 1.2022855281829834
Epoch: 18, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.9433307647705078
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.9977648258209229
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.8029770851135254
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.923687219619751
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.8419249057769775
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.187 Vali Acc: 0.937 Test Loss: 0.187 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8991429805755615
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.9100301265716553
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.8403983116149902
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.8284461498260498
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 28 cost time: 0.8161561489105225
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.850191593170166
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 1.018747091293335
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.8514723777770996
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.9173319339752197
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.9366195201873779
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 34 cost time: 0.8135275840759277
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 35 cost time: 0.8552718162536621
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.7485601902008057
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.8026168346405029
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.8009824752807617
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 39 cost time: 0.857837438583374
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.8524298667907715
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 1.0052940845489502
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 1.029364824295044
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.8525238037109375
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.8124346733093262
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.8309957981109619
Epoch: 45, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.8155741691589355
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.8948776721954346
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.8038561344146729
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.9065225124359131
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.9391846656799316
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 383814
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.12034010887146
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.752 Vali Acc: 0.167 Test Loss: 1.752 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.8699057102203369
Epoch: 2, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.648 Vali Acc: 0.285 Test Loss: 1.648 Test Acc: 0.285
Validation loss decreased (-0.166649 --> -0.285169).  Saving model ...
Epoch: 3 cost time: 0.9033701419830322
Epoch: 3, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.546 Vali Acc: 0.415 Test Loss: 1.546 Test Acc: 0.415
Validation loss decreased (-0.285169 --> -0.414799).  Saving model ...
Epoch: 4 cost time: 0.8664383888244629
Epoch: 4, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.410 Vali Acc: 0.507 Test Loss: 1.410 Test Acc: 0.507
Validation loss decreased (-0.414799 --> -0.507393).  Saving model ...
Epoch: 5 cost time: 0.8068435192108154
Epoch: 5, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.255 Vali Acc: 0.611 Test Loss: 1.255 Test Acc: 0.611
Validation loss decreased (-0.507393 --> -0.611099).  Saving model ...
Epoch: 6 cost time: 0.8618912696838379
Epoch: 6, Steps: 2 | Train Loss: 1.121 Vali Loss: 1.094 Vali Acc: 0.689 Test Loss: 1.094 Test Acc: 0.689
Validation loss decreased (-0.611099 --> -0.688878).  Saving model ...
Epoch: 7 cost time: 0.8724930286407471
Epoch: 7, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.942 Vali Acc: 0.741 Test Loss: 0.942 Test Acc: 0.741
Validation loss decreased (-0.688878 --> -0.740731).  Saving model ...
Epoch: 8 cost time: 0.8545787334442139
Epoch: 8, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.807 Vali Acc: 0.763 Test Loss: 0.807 Test Acc: 0.763
Validation loss decreased (-0.740731 --> -0.762955).  Saving model ...
Epoch: 9 cost time: 0.8656749725341797
Epoch: 9, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.693 Vali Acc: 0.778 Test Loss: 0.693 Test Acc: 0.778
Validation loss decreased (-0.762955 --> -0.777771).  Saving model ...
Epoch: 10 cost time: 0.8362760543823242
Epoch: 10, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.596 Vali Acc: 0.822 Test Loss: 0.596 Test Acc: 0.822
Validation loss decreased (-0.777771 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 0.875434160232544
Epoch: 11, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.518 Vali Acc: 0.859 Test Loss: 0.518 Test Acc: 0.859
Validation loss decreased (-0.822216 --> -0.859254).  Saving model ...
Epoch: 12 cost time: 0.8766593933105469
Epoch: 12, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.454 Vali Acc: 0.881 Test Loss: 0.454 Test Acc: 0.881
Validation loss decreased (-0.859254 --> -0.881477).  Saving model ...
Epoch: 13 cost time: 0.8868556022644043
Epoch: 13, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.403 Vali Acc: 0.893 Test Loss: 0.403 Test Acc: 0.893
Validation loss decreased (-0.881477 --> -0.892589).  Saving model ...
Epoch: 14 cost time: 0.9379262924194336
Epoch: 14, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.360 Vali Acc: 0.896 Test Loss: 0.360 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 15 cost time: 0.754967451095581
Epoch: 15, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.328 Vali Acc: 0.896 Test Loss: 0.328 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 16 cost time: 1.21437668800354
Epoch: 16, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.298 Vali Acc: 0.915 Test Loss: 0.298 Test Acc: 0.915
Validation loss decreased (-0.896293 --> -0.914812).  Saving model ...
Epoch: 17 cost time: 0.9909327030181885
Epoch: 17, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.276 Vali Acc: 0.919 Test Loss: 0.276 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 18 cost time: 0.9766349792480469
Epoch: 18, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 1.1439130306243896
Epoch: 19, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 1.2299566268920898
Epoch: 20, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 21 cost time: 1.0325756072998047
Epoch: 21, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 1.1802966594696045
Epoch: 22, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.961951732635498
Epoch: 23, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.0929303169250488
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.915 Test Loss: 0.219 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.1381633281707764
Epoch: 25, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.919 Test Loss: 0.215 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.0050814151763916
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.2408082485198975
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.1067957878112793
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.0159385204315186
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.004354476928711
Epoch: 30, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.0648787021636963
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 383814
model size : 3.92MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.4174163341522217
Epoch: 1, Steps: 2 | Train Loss: 2.134 Vali Loss: 1.889 Vali Acc: 0.126 Test Loss: 1.889 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.7220211029052734
Epoch: 2, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.764 Vali Acc: 0.181 Test Loss: 1.764 Test Acc: 0.181
Validation loss decreased (-0.125907 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.7341916561126709
Epoch: 3, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.643 Vali Acc: 0.256 Test Loss: 1.643 Test Acc: 0.256
Validation loss decreased (-0.181464 --> -0.255539).  Saving model ...
Epoch: 4 cost time: 0.6885631084442139
Epoch: 4, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.487 Vali Acc: 0.396 Test Loss: 1.487 Test Acc: 0.396
Validation loss decreased (-0.255539 --> -0.396281).  Saving model ...
Epoch: 5 cost time: 0.7570552825927734
Epoch: 5, Steps: 2 | Train Loss: 1.325 Vali Loss: 1.304 Vali Acc: 0.619 Test Loss: 1.304 Test Acc: 0.619
Validation loss decreased (-0.396281 --> -0.618505).  Saving model ...
Epoch: 6 cost time: 0.7463488578796387
Epoch: 6, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.115 Vali Acc: 0.785 Test Loss: 1.115 Test Acc: 0.785
Validation loss decreased (-0.618505 --> -0.785174).  Saving model ...
Epoch: 7 cost time: 0.8760051727294922
Epoch: 7, Steps: 2 | Train Loss: 1.034 Vali Loss: 0.938 Vali Acc: 0.844 Test Loss: 0.938 Test Acc: 0.844
Validation loss decreased (-0.785174 --> -0.844435).  Saving model ...
Epoch: 8 cost time: 0.7763817310333252
Epoch: 8, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.785 Vali Acc: 0.863 Test Loss: 0.785 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862955).  Saving model ...
Epoch: 9 cost time: 0.8167738914489746
Epoch: 9, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.656 Vali Acc: 0.885 Test Loss: 0.656 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885179).  Saving model ...
Epoch: 10 cost time: 0.8397762775421143
Epoch: 10, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.552 Vali Acc: 0.900 Test Loss: 0.552 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 11 cost time: 0.8183755874633789
Epoch: 11, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.471 Vali Acc: 0.915 Test Loss: 0.471 Test Acc: 0.915
Validation loss decreased (-0.899994 --> -0.914810).  Saving model ...
Epoch: 12 cost time: 0.8434841632843018
Epoch: 12, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.408 Vali Acc: 0.919 Test Loss: 0.408 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 13 cost time: 0.8054265975952148
Epoch: 13, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.356 Vali Acc: 0.926 Test Loss: 0.356 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 14 cost time: 1.0451645851135254
Epoch: 14, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 15 cost time: 0.8052549362182617
Epoch: 15, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.7710680961608887
Epoch: 16, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.7198588848114014
Epoch: 17, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.8118119239807129
Epoch: 18, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.9233615398406982
Epoch: 19, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.914905309677124
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.7211575508117676
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.8201422691345215
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.8207488059997559
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.9407365322113037
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.941 Test Loss: 0.164 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.912947416305542
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.162 Vali Acc: 0.944 Test Loss: 0.162 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.7606427669525146
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948147).  Saving model ...
Epoch: 27 cost time: 0.776435375213623
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.158 Vali Acc: 0.944 Test Loss: 0.158 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.8866629600524902
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.157 Vali Acc: 0.941 Test Loss: 0.157 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.0217015743255615
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.157 Vali Acc: 0.944 Test Loss: 0.157 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.9383509159088135
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.018671989440918
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.8436074256896973
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.8708095550537109
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.944 Test Loss: 0.155 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.8681347370147705
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.9325783252716064
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.9032726287841797
Epoch: 36, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 252742
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2555336952209473
Epoch: 1, Steps: 2 | Train Loss: 2.129 Vali Loss: 1.890 Vali Acc: 0.126 Test Loss: 1.890 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.6966731548309326
Epoch: 2, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.765 Vali Acc: 0.181 Test Loss: 1.765 Test Acc: 0.181
Validation loss decreased (-0.125907 --> -0.181464).  Saving model ...
Epoch: 3 cost time: 0.8361530303955078
Epoch: 3, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.643 Vali Acc: 0.285 Test Loss: 1.643 Test Acc: 0.285
Validation loss decreased (-0.181464 --> -0.285169).  Saving model ...
Epoch: 4 cost time: 0.8735671043395996
Epoch: 4, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.487 Vali Acc: 0.430 Test Loss: 1.487 Test Acc: 0.430
Validation loss decreased (-0.285169 --> -0.429615).  Saving model ...
Epoch: 5 cost time: 0.8372824192047119
Epoch: 5, Steps: 2 | Train Loss: 1.354 Vali Loss: 1.304 Vali Acc: 0.611 Test Loss: 1.304 Test Acc: 0.611
Validation loss decreased (-0.429615 --> -0.611098).  Saving model ...
Epoch: 6 cost time: 0.7170298099517822
Epoch: 6, Steps: 2 | Train Loss: 1.082 Vali Loss: 1.113 Vali Acc: 0.744 Test Loss: 1.113 Test Acc: 0.744
Validation loss decreased (-0.611098 --> -0.744433).  Saving model ...
Epoch: 7 cost time: 0.8174960613250732
Epoch: 7, Steps: 2 | Train Loss: 1.009 Vali Loss: 0.935 Vali Acc: 0.807 Test Loss: 0.935 Test Acc: 0.807
Validation loss decreased (-0.744433 --> -0.807398).  Saving model ...
Epoch: 8 cost time: 0.6565465927124023
Epoch: 8, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.781 Vali Acc: 0.848 Test Loss: 0.781 Test Acc: 0.848
Validation loss decreased (-0.807398 --> -0.848140).  Saving model ...
Epoch: 9 cost time: 0.6932632923126221
Epoch: 9, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.652 Vali Acc: 0.878 Test Loss: 0.652 Test Acc: 0.878
Validation loss decreased (-0.848140 --> -0.877771).  Saving model ...
Epoch: 10 cost time: 0.6715590953826904
Epoch: 10, Steps: 2 | Train Loss: 0.418 Vali Loss: 0.547 Vali Acc: 0.907 Test Loss: 0.547 Test Acc: 0.907
Validation loss decreased (-0.877771 --> -0.907402).  Saving model ...
Epoch: 11 cost time: 0.6735751628875732
Epoch: 11, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.466 Vali Acc: 0.911 Test Loss: 0.466 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 12 cost time: 0.774146556854248
Epoch: 12, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.405 Vali Acc: 0.911 Test Loss: 0.405 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 0.7208855152130127
Epoch: 13, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.354 Vali Acc: 0.915 Test Loss: 0.354 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.8919765949249268
Epoch: 14, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 0.8680703639984131
Epoch: 15, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.278 Vali Acc: 0.933 Test Loss: 0.278 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.9319772720336914
Epoch: 16, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.247 Vali Acc: 0.941 Test Loss: 0.247 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 17 cost time: 0.8368842601776123
Epoch: 17, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.8017594814300537
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.9203636646270752
Epoch: 19, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.7376782894134521
Epoch: 20, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.182 Vali Acc: 0.948 Test Loss: 0.182 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.9772765636444092
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.9288618564605713
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.7639052867889404
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.7155776023864746
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.161 Vali Acc: 0.952 Test Loss: 0.161 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.7435567378997803
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.7796525955200195
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.157 Vali Acc: 0.952 Test Loss: 0.157 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.6883392333984375
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.156 Vali Acc: 0.956 Test Loss: 0.156 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.7664661407470703
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.155 Vali Acc: 0.956 Test Loss: 0.155 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.7393481731414795
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.6910049915313721
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.154 Vali Acc: 0.956 Test Loss: 0.154 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.8607265949249268
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.7510578632354736
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.9102053642272949
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.7937123775482178
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8608994483947754
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.9405732154846191
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.8118209838867188
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7715773582458496
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8276669979095459
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7840831279754639
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.155 Vali Acc: 0.952 Test Loss: 0.155 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 252742
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.3281071186065674
Epoch: 1, Steps: 2 | Train Loss: 2.072 Vali Loss: 1.892 Vali Acc: 0.133 Test Loss: 1.892 Test Acc: 0.133
Validation loss decreased (inf --> -0.133314).  Saving model ...
Epoch: 2 cost time: 0.90818190574646
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.766 Vali Acc: 0.178 Test Loss: 1.766 Test Acc: 0.178
Validation loss decreased (-0.133314 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.8917076587677002
Epoch: 3, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.643 Vali Acc: 0.274 Test Loss: 1.643 Test Acc: 0.274
Validation loss decreased (-0.177760 --> -0.274058).  Saving model ...
Epoch: 4 cost time: 0.8444192409515381
Epoch: 4, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.486 Vali Acc: 0.448 Test Loss: 1.486 Test Acc: 0.448
Validation loss decreased (-0.274058 --> -0.448133).  Saving model ...
Epoch: 5 cost time: 0.8633065223693848
Epoch: 5, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.300 Vali Acc: 0.633 Test Loss: 1.300 Test Acc: 0.633
Validation loss decreased (-0.448133 --> -0.633320).  Saving model ...
Epoch: 6 cost time: 0.9630453586578369
Epoch: 6, Steps: 2 | Train Loss: 1.112 Vali Loss: 1.107 Vali Acc: 0.730 Test Loss: 1.107 Test Acc: 0.730
Validation loss decreased (-0.633320 --> -0.729619).  Saving model ...
Epoch: 7 cost time: 0.8862357139587402
Epoch: 7, Steps: 2 | Train Loss: 0.983 Vali Loss: 0.927 Vali Acc: 0.826 Test Loss: 0.927 Test Acc: 0.826
Validation loss decreased (-0.729619 --> -0.825917).  Saving model ...
Epoch: 8 cost time: 0.7791686058044434
Epoch: 8, Steps: 2 | Train Loss: 0.775 Vali Loss: 0.772 Vali Acc: 0.870 Test Loss: 0.772 Test Acc: 0.870
Validation loss decreased (-0.825917 --> -0.870363).  Saving model ...
Epoch: 9 cost time: 0.6347310543060303
Epoch: 9, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.642 Vali Acc: 0.885 Test Loss: 0.642 Test Acc: 0.885
Validation loss decreased (-0.870363 --> -0.885179).  Saving model ...
Epoch: 10 cost time: 0.8258492946624756
Epoch: 10, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.536 Vali Acc: 0.907 Test Loss: 0.536 Test Acc: 0.907
Validation loss decreased (-0.885179 --> -0.907402).  Saving model ...
Epoch: 11 cost time: 0.7358238697052002
Epoch: 11, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.454 Vali Acc: 0.926 Test Loss: 0.454 Test Acc: 0.926
Validation loss decreased (-0.907402 --> -0.925921).  Saving model ...
Epoch: 12 cost time: 0.7512147426605225
Epoch: 12, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.391 Vali Acc: 0.926 Test Loss: 0.391 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 13 cost time: 0.9450407028198242
Epoch: 13, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937034).  Saving model ...
Epoch: 14 cost time: 0.9067656993865967
Epoch: 14, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.299 Vali Acc: 0.941 Test Loss: 0.299 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.8397305011749268
Epoch: 15, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.8133602142333984
Epoch: 16, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.780799150466919
Epoch: 17, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 18 cost time: 0.7982058525085449
Epoch: 18, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9199073314666748
Epoch: 19, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.75771164894104
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 21 cost time: 0.8083400726318359
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.7838180065155029
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.8581185340881348
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.159 Vali Acc: 0.952 Test Loss: 0.159 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 0.9484851360321045
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.156 Vali Acc: 0.952 Test Loss: 0.156 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.8341152667999268
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.154 Vali Acc: 0.952 Test Loss: 0.154 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.7421064376831055
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.153 Vali Acc: 0.952 Test Loss: 0.153 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.6968140602111816
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 28 cost time: 0.7508370876312256
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 29 cost time: 0.713611364364624
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 30 cost time: 0.7996397018432617
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.8230295181274414
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 32 cost time: 0.8824467658996582
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7765333652496338
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7693295478820801
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.7928564548492432
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.848484992980957
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.0522778034210205
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.7635681629180908
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9172811508178711
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.152 Vali Acc: 0.956 Test Loss: 0.152 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.9187412261962891
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.087451457977295
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.151 Vali Acc: 0.956 Test Loss: 0.151 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 252742
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.4376461505889893
Epoch: 1, Steps: 2 | Train Loss: 2.011 Vali Loss: 1.869 Vali Acc: 0.148 Test Loss: 1.869 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.7815749645233154
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.747 Vali Acc: 0.207 Test Loss: 1.747 Test Acc: 0.207
Validation loss decreased (-0.148129 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.7860372066497803
Epoch: 3, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.629 Vali Acc: 0.281 Test Loss: 1.629 Test Acc: 0.281
Validation loss decreased (-0.207390 --> -0.281465).  Saving model ...
Epoch: 4 cost time: 0.804542064666748
Epoch: 4, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.477 Vali Acc: 0.430 Test Loss: 1.477 Test Acc: 0.430
Validation loss decreased (-0.281465 --> -0.429615).  Saving model ...
Epoch: 5 cost time: 0.8828849792480469
Epoch: 5, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.301 Vali Acc: 0.626 Test Loss: 1.301 Test Acc: 0.626
Validation loss decreased (-0.429615 --> -0.625913).  Saving model ...
Epoch: 6 cost time: 0.6270163059234619
Epoch: 6, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.120 Vali Acc: 0.770 Test Loss: 1.120 Test Acc: 0.770
Validation loss decreased (-0.625913 --> -0.770359).  Saving model ...
Epoch: 7 cost time: 0.8123102188110352
Epoch: 7, Steps: 2 | Train Loss: 1.014 Vali Loss: 0.952 Vali Acc: 0.811 Test Loss: 0.952 Test Acc: 0.811
Validation loss decreased (-0.770359 --> -0.811102).  Saving model ...
Epoch: 8 cost time: 0.7001142501831055
Epoch: 8, Steps: 2 | Train Loss: 0.790 Vali Loss: 0.807 Vali Acc: 0.837 Test Loss: 0.807 Test Acc: 0.837
Validation loss decreased (-0.811102 --> -0.837029).  Saving model ...
Epoch: 9 cost time: 0.7710261344909668
Epoch: 9, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.683 Vali Acc: 0.848 Test Loss: 0.683 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 10 cost time: 0.7603433132171631
Epoch: 10, Steps: 2 | Train Loss: 0.515 Vali Loss: 0.581 Vali Acc: 0.867 Test Loss: 0.581 Test Acc: 0.867
Validation loss decreased (-0.848141 --> -0.866661).  Saving model ...
Epoch: 11 cost time: 0.7547111511230469
Epoch: 11, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.503 Vali Acc: 0.878 Test Loss: 0.503 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 12 cost time: 0.6916756629943848
Epoch: 12, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.445 Vali Acc: 0.885 Test Loss: 0.445 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885181).  Saving model ...
Epoch: 13 cost time: 0.6699469089508057
Epoch: 13, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.395 Vali Acc: 0.889 Test Loss: 0.395 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 14 cost time: 0.7669417858123779
Epoch: 14, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.353 Vali Acc: 0.885 Test Loss: 0.353 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8833889961242676
Epoch: 15, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.317 Vali Acc: 0.907 Test Loss: 0.317 Test Acc: 0.907
Validation loss decreased (-0.888885 --> -0.907404).  Saving model ...
Epoch: 16 cost time: 0.6965494155883789
Epoch: 16, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.289 Vali Acc: 0.919 Test Loss: 0.289 Test Acc: 0.919
Validation loss decreased (-0.907404 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 0.82277512550354
Epoch: 17, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 18 cost time: 0.7818613052368164
Epoch: 18, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.7408490180969238
Epoch: 19, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.8119955062866211
Epoch: 20, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 21 cost time: 1.0095674991607666
Epoch: 21, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.8916761875152588
Epoch: 22, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.8590290546417236
Epoch: 23, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.726947546005249
Epoch: 24, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9271697998046875
Epoch: 25, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.9268968105316162
Epoch: 26, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.8841617107391357
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8869974613189697
Epoch: 28, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.8532109260559082
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.8619816303253174
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.8581187725067139
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.808760404586792
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.7346277236938477
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7912342548370361
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.8085262775421143
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7030024528503418
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.7436645030975342
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.9363057613372803
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.079805850982666
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.8794820308685303
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.9900071620941162
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.9135611057281494
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 252742
model size : 3.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8191683292388916
Epoch: 1, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.778 Vali Acc: 0.241 Test Loss: 1.778 Test Acc: 0.241
Validation loss decreased (inf --> -0.240723).  Saving model ...
Epoch: 2 cost time: 0.7561407089233398
Epoch: 2, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.643 Vali Acc: 0.322 Test Loss: 1.643 Test Acc: 0.322
Validation loss decreased (-0.240723 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 0.8649375438690186
Epoch: 3, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.517 Vali Acc: 0.374 Test Loss: 1.517 Test Acc: 0.374
Validation loss decreased (-0.322206 --> -0.374059).  Saving model ...
Epoch: 4 cost time: 0.964146614074707
Epoch: 4, Steps: 2 | Train Loss: 1.418 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
Validation loss decreased (-0.374059 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 0.6840412616729736
Epoch: 5, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.186 Vali Acc: 0.648 Test Loss: 1.186 Test Acc: 0.648
Validation loss decreased (-0.499986 --> -0.648136).  Saving model ...
Epoch: 6 cost time: 0.86965012550354
Epoch: 6, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.014 Vali Acc: 0.767 Test Loss: 1.014 Test Acc: 0.767
Validation loss decreased (-0.648136 --> -0.766657).  Saving model ...
Epoch: 7 cost time: 0.7378427982330322
Epoch: 7, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.858 Vali Acc: 0.815 Test Loss: 0.858 Test Acc: 0.815
Validation loss decreased (-0.766657 --> -0.814806).  Saving model ...
Epoch: 8 cost time: 0.662071704864502
Epoch: 8, Steps: 2 | Train Loss: 0.786 Vali Loss: 0.727 Vali Acc: 0.874 Test Loss: 0.727 Test Acc: 0.874
Validation loss decreased (-0.814806 --> -0.874067).  Saving model ...
Epoch: 9 cost time: 0.6976418495178223
Epoch: 9, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.616 Vali Acc: 0.889 Test Loss: 0.616 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 0.8706021308898926
Epoch: 10, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.522 Vali Acc: 0.907 Test Loss: 0.522 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907402).  Saving model ...
Epoch: 11 cost time: 0.6982672214508057
Epoch: 11, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.448 Vali Acc: 0.904 Test Loss: 0.448 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6594405174255371
Epoch: 12, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.8373956680297852
Epoch: 13, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
Validation loss decreased (-0.907402 --> -0.918515).  Saving model ...
Epoch: 14 cost time: 0.6448607444763184
Epoch: 14, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.305 Vali Acc: 0.919 Test Loss: 0.305 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 15 cost time: 0.7363059520721436
Epoch: 15, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.8653433322906494
Epoch: 16, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.9648714065551758
Epoch: 17, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.955634593963623
Epoch: 18, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.937035 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.9855499267578125
Epoch: 19, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.8204672336578369
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.9220671653747559
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9134721755981445
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7641987800598145
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.944 Test Loss: 0.171 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7948837280273438
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.168 Vali Acc: 0.941 Test Loss: 0.168 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8436427116394043
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.941 Test Loss: 0.167 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7858448028564453
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.166 Vali Acc: 0.941 Test Loss: 0.166 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7055022716522217
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.7158608436584473
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.7755289077758789
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 1.1392641067504883
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7797489166259766
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.8653354644775391
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.8677496910095215
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8482637405395508
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.025773525238037
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.9707076549530029
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.793097734451294
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.7439095973968506
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.7961785793304443
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.948 Test Loss: 0.173 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 187206
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7856953144073486
Epoch: 1, Steps: 2 | Train Loss: 1.992 Vali Loss: 1.778 Vali Acc: 0.237 Test Loss: 1.778 Test Acc: 0.237
Validation loss decreased (inf --> -0.237019).  Saving model ...
Epoch: 2 cost time: 0.768101692199707
Epoch: 2, Steps: 2 | Train Loss: 1.809 Vali Loss: 1.644 Vali Acc: 0.304 Test Loss: 1.644 Test Acc: 0.304
Validation loss decreased (-0.237019 --> -0.303687).  Saving model ...
Epoch: 3 cost time: 0.7832295894622803
Epoch: 3, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.517 Vali Acc: 0.381 Test Loss: 1.517 Test Acc: 0.381
Validation loss decreased (-0.303687 --> -0.381466).  Saving model ...
Epoch: 4 cost time: 0.6966812610626221
Epoch: 4, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.361 Vali Acc: 0.500 Test Loss: 1.361 Test Acc: 0.500
Validation loss decreased (-0.381466 --> -0.499986).  Saving model ...
Epoch: 5 cost time: 0.7283697128295898
Epoch: 5, Steps: 2 | Train Loss: 1.390 Vali Loss: 1.185 Vali Acc: 0.670 Test Loss: 1.185 Test Acc: 0.670
Validation loss decreased (-0.499986 --> -0.670359).  Saving model ...
Epoch: 6 cost time: 0.7312734127044678
Epoch: 6, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.013 Vali Acc: 0.759 Test Loss: 1.013 Test Acc: 0.759
Validation loss decreased (-0.670359 --> -0.759249).  Saving model ...
Epoch: 7 cost time: 0.7272739410400391
Epoch: 7, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.856 Vali Acc: 0.819 Test Loss: 0.856 Test Acc: 0.819
Validation loss decreased (-0.759249 --> -0.818510).  Saving model ...
Epoch: 8 cost time: 0.851668119430542
Epoch: 8, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.724 Vali Acc: 0.863 Test Loss: 0.724 Test Acc: 0.863
Validation loss decreased (-0.818510 --> -0.862956).  Saving model ...
Epoch: 9 cost time: 0.7699053287506104
Epoch: 9, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.614 Vali Acc: 0.870 Test Loss: 0.614 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 10 cost time: 0.7512717247009277
Epoch: 10, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.520 Vali Acc: 0.904 Test Loss: 0.520 Test Acc: 0.904
Validation loss decreased (-0.870364 --> -0.903699).  Saving model ...
Epoch: 11 cost time: 0.7453229427337646
Epoch: 11, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 12 cost time: 0.8005664348602295
Epoch: 12, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.386 Vali Acc: 0.911 Test Loss: 0.386 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 0.8221855163574219
Epoch: 13, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 14 cost time: 0.8187136650085449
Epoch: 14, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.304 Vali Acc: 0.907 Test Loss: 0.304 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.8614535331726074
Epoch: 15, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.271 Vali Acc: 0.922 Test Loss: 0.271 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 0.7497234344482422
Epoch: 16, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (-0.922220 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.7728500366210938
Epoch: 17, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.8382253646850586
Epoch: 18, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 19 cost time: 0.9415111541748047
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.8253602981567383
Epoch: 20, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.7150256633758545
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 22 cost time: 0.8822755813598633
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.8834223747253418
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.9104883670806885
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.8051767349243164
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.8592743873596191
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.9461829662322998
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.0029771327972412
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.165 Vali Acc: 0.948 Test Loss: 0.165 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.0611157417297363
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.166 Vali Acc: 0.948 Test Loss: 0.166 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.0203416347503662
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.0882694721221924
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 1.086444616317749
Epoch: 32, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.054823875427246
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.1491358280181885
Epoch: 34, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.0728065967559814
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.0739920139312744
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.161015510559082
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.0314795970916748
Epoch: 38, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.9503746032714844
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.0510427951812744
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.168 Vali Acc: 0.952 Test Loss: 0.168 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.9904203414916992
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 187206
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.1722354888916016
Epoch: 1, Steps: 2 | Train Loss: 2.025 Vali Loss: 1.747 Vali Acc: 0.259 Test Loss: 1.747 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.7696442604064941
Epoch: 2, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.615 Vali Acc: 0.330 Test Loss: 1.615 Test Acc: 0.330
Validation loss decreased (-0.259242 --> -0.329613).  Saving model ...
Epoch: 3 cost time: 0.7672474384307861
Epoch: 3, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.490 Vali Acc: 0.419 Test Loss: 1.490 Test Acc: 0.419
Validation loss decreased (-0.329613 --> -0.418504).  Saving model ...
Epoch: 4 cost time: 0.9149332046508789
Epoch: 4, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.336 Vali Acc: 0.541 Test Loss: 1.336 Test Acc: 0.541
Validation loss decreased (-0.418504 --> -0.540727).  Saving model ...
Epoch: 5 cost time: 0.8927721977233887
Epoch: 5, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.164 Vali Acc: 0.670 Test Loss: 1.164 Test Acc: 0.670
Validation loss decreased (-0.540727 --> -0.670359).  Saving model ...
Epoch: 6 cost time: 0.8589968681335449
Epoch: 6, Steps: 2 | Train Loss: 1.083 Vali Loss: 0.997 Vali Acc: 0.789 Test Loss: 0.997 Test Acc: 0.789
Validation loss decreased (-0.670359 --> -0.788879).  Saving model ...
Epoch: 7 cost time: 0.888890266418457
Epoch: 7, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.845 Vali Acc: 0.841 Test Loss: 0.845 Test Acc: 0.841
Validation loss decreased (-0.788879 --> -0.840732).  Saving model ...
Epoch: 8 cost time: 0.8877284526824951
Epoch: 8, Steps: 2 | Train Loss: 0.796 Vali Loss: 0.716 Vali Acc: 0.874 Test Loss: 0.716 Test Acc: 0.874
Validation loss decreased (-0.840732 --> -0.874067).  Saving model ...
Epoch: 9 cost time: 0.8769128322601318
Epoch: 9, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.607 Vali Acc: 0.881 Test Loss: 0.607 Test Acc: 0.881
Validation loss decreased (-0.874067 --> -0.881475).  Saving model ...
Epoch: 10 cost time: 0.9287612438201904
Epoch: 10, Steps: 2 | Train Loss: 0.470 Vali Loss: 0.514 Vali Acc: 0.896 Test Loss: 0.514 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896291).  Saving model ...
Epoch: 11 cost time: 0.924997091293335
Epoch: 11, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.439 Vali Acc: 0.911 Test Loss: 0.439 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911107).  Saving model ...
Epoch: 12 cost time: 0.8373336791992188
Epoch: 12, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.9079868793487549
Epoch: 13, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.331 Vali Acc: 0.919 Test Loss: 0.331 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 14 cost time: 0.7230067253112793
Epoch: 14, Steps: 2 | Train Loss: 0.167 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 15 cost time: 0.7848875522613525
Epoch: 15, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.7377605438232422
Epoch: 16, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.7992594242095947
Epoch: 17, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.9446685314178467
Epoch: 18, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.8159935474395752
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.8533031940460205
Epoch: 20, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 21 cost time: 1.0596601963043213
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 22 cost time: 0.8867218494415283
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 23 cost time: 0.8521523475646973
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.172 Vali Acc: 0.944 Test Loss: 0.172 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 24 cost time: 0.8307144641876221
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
Validation loss decreased (-0.944443 --> -0.951850).  Saving model ...
Epoch: 25 cost time: 0.9624159336090088
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 26 cost time: 0.8249549865722656
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.905414342880249
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.948 Test Loss: 0.167 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.848442554473877
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.8262767791748047
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.7491676807403564
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 31 cost time: 0.8090758323669434
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.002427577972412
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8513092994689941
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.0732297897338867
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.8520941734313965
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.952 Test Loss: 0.169 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.7591404914855957
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7739558219909668
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.852424144744873
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.8616302013397217
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.8096785545349121
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 187206
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8099470138549805
Epoch: 1, Steps: 2 | Train Loss: 1.940 Vali Loss: 1.691 Vali Acc: 0.296 Test Loss: 1.691 Test Acc: 0.296
Validation loss decreased (inf --> -0.296279).  Saving model ...
Epoch: 2 cost time: 0.7374086380004883
Epoch: 2, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.569 Vali Acc: 0.363 Test Loss: 1.569 Test Acc: 0.363
Validation loss decreased (-0.296279 --> -0.362947).  Saving model ...
Epoch: 3 cost time: 0.8557875156402588
Epoch: 3, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.456 Vali Acc: 0.441 Test Loss: 1.456 Test Acc: 0.441
Validation loss decreased (-0.362947 --> -0.440726).  Saving model ...
Epoch: 4 cost time: 0.8075613975524902
Epoch: 4, Steps: 2 | Train Loss: 1.490 Vali Loss: 1.315 Vali Acc: 0.552 Test Loss: 1.315 Test Acc: 0.552
Validation loss decreased (-0.440726 --> -0.551839).  Saving model ...
Epoch: 5 cost time: 0.7292172908782959
Epoch: 5, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.161 Vali Acc: 0.704 Test Loss: 1.161 Test Acc: 0.704
Validation loss decreased (-0.551839 --> -0.703692).  Saving model ...
Epoch: 6 cost time: 0.8134081363677979
Epoch: 6, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.010 Vali Acc: 0.763 Test Loss: 1.010 Test Acc: 0.763
Validation loss decreased (-0.703692 --> -0.762953).  Saving model ...
Epoch: 7 cost time: 0.824204683303833
Epoch: 7, Steps: 2 | Train Loss: 0.981 Vali Loss: 0.871 Vali Acc: 0.804 Test Loss: 0.871 Test Acc: 0.804
Validation loss decreased (-0.762953 --> -0.803695).  Saving model ...
Epoch: 8 cost time: 0.7437269687652588
Epoch: 8, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.751 Vali Acc: 0.830 Test Loss: 0.751 Test Acc: 0.830
Validation loss decreased (-0.803695 --> -0.829622).  Saving model ...
Epoch: 9 cost time: 0.7514472007751465
Epoch: 9, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.647 Vali Acc: 0.859 Test Loss: 0.647 Test Acc: 0.859
Validation loss decreased (-0.829622 --> -0.859253).  Saving model ...
Epoch: 10 cost time: 0.7970931529998779
Epoch: 10, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.561 Vali Acc: 0.881 Test Loss: 0.561 Test Acc: 0.881
Validation loss decreased (-0.859253 --> -0.881476).  Saving model ...
Epoch: 11 cost time: 0.7670955657958984
Epoch: 11, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.486 Vali Acc: 0.885 Test Loss: 0.486 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 12 cost time: 0.7633771896362305
Epoch: 12, Steps: 2 | Train Loss: 0.381 Vali Loss: 0.425 Vali Acc: 0.893 Test Loss: 0.425 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 13 cost time: 0.8109562397003174
Epoch: 13, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.376 Vali Acc: 0.900 Test Loss: 0.376 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899996).  Saving model ...
Epoch: 14 cost time: 0.8251585960388184
Epoch: 14, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.340 Vali Acc: 0.911 Test Loss: 0.340 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.7336418628692627
Epoch: 15, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.311 Vali Acc: 0.907 Test Loss: 0.311 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.7734317779541016
Epoch: 16, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.7872276306152344
Epoch: 17, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.8903627395629883
Epoch: 18, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.8178122043609619
Epoch: 19, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.0271451473236084
Epoch: 20, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.847407341003418
Epoch: 21, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.9491257667541504
Epoch: 22, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.9426085948944092
Epoch: 23, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.7526919841766357
Epoch: 24, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.906588077545166
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.8762662410736084
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.7486035823822021
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.8294045925140381
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.9436111450195312
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.848057746887207
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.0292658805847168
Epoch: 31, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.0199494361877441
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.1558022499084473
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 187206
model size : 3.17MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.976125955581665
Epoch: 1, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.609 Vali Acc: 0.359 Test Loss: 1.609 Test Acc: 0.359
Validation loss decreased (inf --> -0.359243).  Saving model ...
Epoch: 2 cost time: 0.8169844150543213
Epoch: 2, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.502 Vali Acc: 0.396 Test Loss: 1.502 Test Acc: 0.396
Validation loss decreased (-0.359243 --> -0.396281).  Saving model ...
Epoch: 3 cost time: 0.8223624229431152
Epoch: 3, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.403 Vali Acc: 0.456 Test Loss: 1.403 Test Acc: 0.456
Validation loss decreased (-0.396281 --> -0.455542).  Saving model ...
Epoch: 4 cost time: 0.9454512596130371
Epoch: 4, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.275 Vali Acc: 0.559 Test Loss: 1.275 Test Acc: 0.559
Validation loss decreased (-0.455542 --> -0.559247).  Saving model ...
Epoch: 5 cost time: 0.7199604511260986
Epoch: 5, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.126 Vali Acc: 0.704 Test Loss: 1.126 Test Acc: 0.704
Validation loss decreased (-0.559247 --> -0.703692).  Saving model ...
Epoch: 6 cost time: 0.7709677219390869
Epoch: 6, Steps: 2 | Train Loss: 1.102 Vali Loss: 0.973 Vali Acc: 0.778 Test Loss: 0.973 Test Acc: 0.778
Validation loss decreased (-0.703692 --> -0.777768).  Saving model ...
Epoch: 7 cost time: 0.739478349685669
Epoch: 7, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.831 Vali Acc: 0.844 Test Loss: 0.831 Test Acc: 0.844
Validation loss decreased (-0.777768 --> -0.844436).  Saving model ...
Epoch: 8 cost time: 0.7886099815368652
Epoch: 8, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.706 Vali Acc: 0.885 Test Loss: 0.706 Test Acc: 0.885
Validation loss decreased (-0.844436 --> -0.885178).  Saving model ...
Epoch: 9 cost time: 0.779038667678833
Epoch: 9, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.598 Vali Acc: 0.915 Test Loss: 0.598 Test Acc: 0.915
Validation loss decreased (-0.885178 --> -0.914809).  Saving model ...
Epoch: 10 cost time: 0.82958984375
Epoch: 10, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.508 Vali Acc: 0.919 Test Loss: 0.508 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 11 cost time: 0.7712514400482178
Epoch: 11, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.437 Vali Acc: 0.922 Test Loss: 0.437 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922218).  Saving model ...
Epoch: 12 cost time: 0.8560986518859863
Epoch: 12, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.373 Vali Acc: 0.933 Test Loss: 0.373 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 13 cost time: 0.7925775051116943
Epoch: 13, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.323 Vali Acc: 0.941 Test Loss: 0.323 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 14 cost time: 0.780280351638794
Epoch: 14, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.286 Vali Acc: 0.941 Test Loss: 0.286 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 1.0523624420166016
Epoch: 15, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.258 Vali Acc: 0.952 Test Loss: 0.258 Test Acc: 0.952
Validation loss decreased (-0.940738 --> -0.951849).  Saving model ...
Epoch: 16 cost time: 0.8323707580566406
Epoch: 16, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.234 Vali Acc: 0.959 Test Loss: 0.234 Test Acc: 0.959
Validation loss decreased (-0.951849 --> -0.959257).  Saving model ...
Epoch: 17 cost time: 0.9568819999694824
Epoch: 17, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.215 Vali Acc: 0.959 Test Loss: 0.215 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 18 cost time: 0.8662028312683105
Epoch: 18, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.202 Vali Acc: 0.959 Test Loss: 0.202 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 19 cost time: 0.7614645957946777
Epoch: 19, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.192 Vali Acc: 0.959 Test Loss: 0.192 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 20 cost time: 0.7170546054840088
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.184 Vali Acc: 0.959 Test Loss: 0.184 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 21 cost time: 0.7346048355102539
Epoch: 21, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.959 Test Loss: 0.179 Test Acc: 0.959
Validation loss decreased (-0.959257 --> -0.959257).  Saving model ...
Epoch: 22 cost time: 0.8346824645996094
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7258563041687012
Epoch: 23, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8051562309265137
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.9267318248748779
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.9013900756835938
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.170 Vali Acc: 0.948 Test Loss: 0.170 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.9277868270874023
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.831824779510498
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.8664448261260986
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7902162075042725
Epoch: 30, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.8867688179016113
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 154438
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.0258214473724365
Epoch: 1, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.625 Vali Acc: 0.352 Test Loss: 1.625 Test Acc: 0.352
Validation loss decreased (inf --> -0.351836).  Saving model ...
Epoch: 2 cost time: 0.844310998916626
Epoch: 2, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.518 Vali Acc: 0.400 Test Loss: 1.518 Test Acc: 0.400
Validation loss decreased (-0.351836 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.7422263622283936
Epoch: 3, Steps: 2 | Train Loss: 1.453 Vali Loss: 1.418 Vali Acc: 0.444 Test Loss: 1.418 Test Acc: 0.444
Validation loss decreased (-0.399985 --> -0.444430).  Saving model ...
Epoch: 4 cost time: 0.7210662364959717
Epoch: 4, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.288 Vali Acc: 0.559 Test Loss: 1.288 Test Acc: 0.559
Validation loss decreased (-0.444430 --> -0.559246).  Saving model ...
Epoch: 5 cost time: 0.8497653007507324
Epoch: 5, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.137 Vali Acc: 0.700 Test Loss: 1.137 Test Acc: 0.700
Validation loss decreased (-0.559246 --> -0.699989).  Saving model ...
Epoch: 6 cost time: 0.7918622493743896
Epoch: 6, Steps: 2 | Train Loss: 1.096 Vali Loss: 0.983 Vali Acc: 0.793 Test Loss: 0.983 Test Acc: 0.793
Validation loss decreased (-0.699989 --> -0.792583).  Saving model ...
Epoch: 7 cost time: 0.7643563747406006
Epoch: 7, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.839 Vali Acc: 0.837 Test Loss: 0.839 Test Acc: 0.837
Validation loss decreased (-0.792583 --> -0.837029).  Saving model ...
Epoch: 8 cost time: 0.8656425476074219
Epoch: 8, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.713 Vali Acc: 0.878 Test Loss: 0.713 Test Acc: 0.878
Validation loss decreased (-0.837029 --> -0.877771).  Saving model ...
Epoch: 9 cost time: 0.7921464443206787
Epoch: 9, Steps: 2 | Train Loss: 0.535 Vali Loss: 0.605 Vali Acc: 0.896 Test Loss: 0.605 Test Acc: 0.896
Validation loss decreased (-0.877771 --> -0.896290).  Saving model ...
Epoch: 10 cost time: 0.6479337215423584
Epoch: 10, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.513 Vali Acc: 0.911 Test Loss: 0.513 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 11 cost time: 0.7722914218902588
Epoch: 11, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.441 Vali Acc: 0.919 Test Loss: 0.441 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 12 cost time: 0.8257710933685303
Epoch: 12, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.8478343486785889
Epoch: 13, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.329 Vali Acc: 0.919 Test Loss: 0.329 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 14 cost time: 0.7424063682556152
Epoch: 14, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933330).  Saving model ...
Epoch: 15 cost time: 0.8637728691101074
Epoch: 15, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.264 Vali Acc: 0.941 Test Loss: 0.264 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 16 cost time: 0.8691089153289795
Epoch: 16, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.7856066226959229
Epoch: 17, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 18 cost time: 0.8689160346984863
Epoch: 18, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.8805267810821533
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.196 Vali Acc: 0.959 Test Loss: 0.196 Test Acc: 0.959
Validation loss decreased (-0.948146 --> -0.959257).  Saving model ...
Epoch: 20 cost time: 0.8812515735626221
Epoch: 20, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.8174149990081787
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.9292738437652588
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.7581896781921387
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.948 Test Loss: 0.177 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7338099479675293
Epoch: 24, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.8425779342651367
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.8672106266021729
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.8793361186981201
Epoch: 27, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.872652530670166
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.8462207317352295
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 154438
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.9969065189361572
Epoch: 1, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.623 Vali Acc: 0.356 Test Loss: 1.623 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 0.8269050121307373
Epoch: 2, Steps: 2 | Train Loss: 1.519 Vali Loss: 1.515 Vali Acc: 0.404 Test Loss: 1.515 Test Acc: 0.404
Validation loss decreased (-0.355539 --> -0.403689).  Saving model ...
Epoch: 3 cost time: 0.8436276912689209
Epoch: 3, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.414 Vali Acc: 0.470 Test Loss: 1.414 Test Acc: 0.470
Validation loss decreased (-0.403689 --> -0.470356).  Saving model ...
Epoch: 4 cost time: 0.7659187316894531
Epoch: 4, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.284 Vali Acc: 0.604 Test Loss: 1.284 Test Acc: 0.604
Validation loss decreased (-0.470356 --> -0.603691).  Saving model ...
Epoch: 5 cost time: 0.7092347145080566
Epoch: 5, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.134 Vali Acc: 0.704 Test Loss: 1.134 Test Acc: 0.704
Validation loss decreased (-0.603691 --> -0.703692).  Saving model ...
Epoch: 6 cost time: 0.808002233505249
Epoch: 6, Steps: 2 | Train Loss: 1.068 Vali Loss: 0.980 Vali Acc: 0.781 Test Loss: 0.980 Test Acc: 0.781
Validation loss decreased (-0.703692 --> -0.781472).  Saving model ...
Epoch: 7 cost time: 0.7253639698028564
Epoch: 7, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.836 Vali Acc: 0.870 Test Loss: 0.836 Test Acc: 0.870
Validation loss decreased (-0.781472 --> -0.870362).  Saving model ...
Epoch: 8 cost time: 0.9587910175323486
Epoch: 8, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.709 Vali Acc: 0.893 Test Loss: 0.709 Test Acc: 0.893
Validation loss decreased (-0.870362 --> -0.892586).  Saving model ...
Epoch: 9 cost time: 0.7807066440582275
Epoch: 9, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.599 Vali Acc: 0.907 Test Loss: 0.599 Test Acc: 0.907
Validation loss decreased (-0.892586 --> -0.907401).  Saving model ...
Epoch: 10 cost time: 0.7934682369232178
Epoch: 10, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.508 Vali Acc: 0.926 Test Loss: 0.508 Test Acc: 0.926
Validation loss decreased (-0.907401 --> -0.925921).  Saving model ...
Epoch: 11 cost time: 0.7899026870727539
Epoch: 11, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.436 Vali Acc: 0.930 Test Loss: 0.436 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 12 cost time: 0.8519537448883057
Epoch: 12, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.374 Vali Acc: 0.933 Test Loss: 0.374 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933330).  Saving model ...
Epoch: 13 cost time: 0.8332149982452393
Epoch: 13, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 0.8307063579559326
Epoch: 14, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.0241079330444336
Epoch: 15, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.9539823532104492
Epoch: 16, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.8619143962860107
Epoch: 17, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.9222564697265625
Epoch: 18, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 19 cost time: 0.9772861003875732
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 20 cost time: 0.7304174900054932
Epoch: 20, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.188 Vali Acc: 0.948 Test Loss: 0.188 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 21 cost time: 0.823479413986206
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.9398260116577148
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 23 cost time: 0.9661171436309814
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 24 cost time: 1.075948715209961
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.176 Vali Acc: 0.948 Test Loss: 0.176 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.9055919647216797
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 26 cost time: 0.9537479877471924
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 27 cost time: 0.8417320251464844
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 28 cost time: 0.8652744293212891
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 29 cost time: 0.9308750629425049
Epoch: 29, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 30 cost time: 0.9531481266021729
Epoch: 30, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.9162585735321045
Epoch: 31, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.845850944519043
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.009772539138794
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.900475263595581
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 35 cost time: 0.8060545921325684
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 36 cost time: 1.0067296028137207
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 37 cost time: 0.7967684268951416
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 38 cost time: 0.9382028579711914
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 39 cost time: 0.853978157043457
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 40 cost time: 1.043607473373413
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 41 cost time: 0.734490156173706
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 42 cost time: 0.7814230918884277
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7375338077545166
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.778221845626831
Epoch: 44, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.7970016002655029
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.8781149387359619
Epoch: 46, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.948 Test Loss: 0.171 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.8400657176971436
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.8444137573242188
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.7873454093933105
Epoch: 49, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.8324182033538818
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.952 Test Loss: 0.172 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.9590826034545898
Epoch: 51, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 52 cost time: 0.9822466373443604
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.797217607498169
Epoch: 53, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7792189121246338
Epoch: 54, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.8820946216583252
Epoch: 55, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.7546253204345703
Epoch: 56, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 57 cost time: 0.8734285831451416
Epoch: 57, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 58 cost time: 0.6907875537872314
Epoch: 58, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 59 cost time: 0.7309451103210449
Epoch: 59, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7277612686157227
Epoch: 60, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7901971340179443
Epoch: 61, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7234983444213867
Epoch: 62, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.7226862907409668
Epoch: 63, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.7428557872772217
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.7770993709564209
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.9990160465240479
Epoch: 66, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.8724377155303955
Epoch: 67, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.9564602375030518
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 154438
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 3.2471306324005127
Epoch: 1, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.654 Vali Acc: 0.400 Test Loss: 1.654 Test Acc: 0.400
Validation loss decreased (inf --> -0.399983).  Saving model ...
Epoch: 2 cost time: 0.7817118167877197
Epoch: 2, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.548 Vali Acc: 0.444 Test Loss: 1.548 Test Acc: 0.444
Validation loss decreased (-0.399983 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.7822201251983643
Epoch: 3, Steps: 2 | Train Loss: 1.469 Vali Loss: 1.451 Vali Acc: 0.485 Test Loss: 1.451 Test Acc: 0.485
Validation loss decreased (-0.444429 --> -0.485171).  Saving model ...
Epoch: 4 cost time: 0.8700087070465088
Epoch: 4, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.325 Vali Acc: 0.559 Test Loss: 1.325 Test Acc: 0.559
Validation loss decreased (-0.485171 --> -0.559246).  Saving model ...
Epoch: 5 cost time: 1.0149190425872803
Epoch: 5, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.177 Vali Acc: 0.674 Test Loss: 1.177 Test Acc: 0.674
Validation loss decreased (-0.559246 --> -0.674062).  Saving model ...
Epoch: 6 cost time: 1.0083730220794678
Epoch: 6, Steps: 2 | Train Loss: 1.041 Vali Loss: 1.026 Vali Acc: 0.726 Test Loss: 1.026 Test Acc: 0.726
Validation loss decreased (-0.674062 --> -0.725916).  Saving model ...
Epoch: 7 cost time: 0.9804654121398926
Epoch: 7, Steps: 2 | Train Loss: 0.926 Vali Loss: 0.885 Vali Acc: 0.774 Test Loss: 0.885 Test Acc: 0.774
Validation loss decreased (-0.725916 --> -0.774065).  Saving model ...
Epoch: 8 cost time: 1.0512306690216064
Epoch: 8, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.761 Vali Acc: 0.833 Test Loss: 0.761 Test Acc: 0.833
Validation loss decreased (-0.774065 --> -0.833326).  Saving model ...
Epoch: 9 cost time: 1.0046119689941406
Epoch: 9, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.655 Vali Acc: 0.863 Test Loss: 0.655 Test Acc: 0.863
Validation loss decreased (-0.833326 --> -0.862956).  Saving model ...
Epoch: 10 cost time: 0.846097469329834
Epoch: 10, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.565 Vali Acc: 0.878 Test Loss: 0.565 Test Acc: 0.878
Validation loss decreased (-0.862956 --> -0.877772).  Saving model ...
Epoch: 11 cost time: 0.907656192779541
Epoch: 11, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.493 Vali Acc: 0.889 Test Loss: 0.493 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.9160819053649902
Epoch: 12, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.432 Vali Acc: 0.893 Test Loss: 0.432 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 13 cost time: 1.0383045673370361
Epoch: 13, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.382 Vali Acc: 0.907 Test Loss: 0.382 Test Acc: 0.907
Validation loss decreased (-0.892588 --> -0.907404).  Saving model ...
Epoch: 14 cost time: 0.8897147178649902
Epoch: 14, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.344 Vali Acc: 0.904 Test Loss: 0.344 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.9616832733154297
Epoch: 15, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922219).  Saving model ...
Epoch: 16 cost time: 0.8386545181274414
Epoch: 16, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 17 cost time: 0.8706002235412598
Epoch: 17, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 18 cost time: 0.7966961860656738
Epoch: 18, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.8311898708343506
Epoch: 19, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.8169705867767334
Epoch: 20, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 0.7488622665405273
Epoch: 21, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.7334356307983398
Epoch: 22, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.8910584449768066
Epoch: 23, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.7424540519714355
Epoch: 24, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 25 cost time: 0.8109321594238281
Epoch: 25, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.8038246631622314
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.903287410736084
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.7634069919586182
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.7957355976104736
Epoch: 29, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.7554469108581543
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.882166862487793
Epoch: 31, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8032443523406982
Epoch: 32, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.8685970306396484
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.706524133682251
Epoch: 34, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.922 Test Loss: 0.208 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.7216923236846924
Epoch: 35, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.8085055351257324
Epoch: 36, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7824993133544922
Epoch: 37, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.8439123630523682
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.7860696315765381
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.726874828338623
Epoch: 40, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.832998514175415
Epoch: 41, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.9756159782409668
Epoch: 42, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.8992793560028076
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.8311452865600586
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.8390679359436035
Epoch: 45, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.9039614200592041
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.6869113445281982
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.770737886428833
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.7373359203338623
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.8681440353393555
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.8365111351013184
Epoch: 51, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.890103816986084
Epoch: 52, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 154438
model size : 3.05MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5015950202941895
Epoch: 1, Steps: 2 | Train Loss: 1.853 Vali Loss: 1.748 Vali Acc: 0.330 Test Loss: 1.748 Test Acc: 0.330
Validation loss decreased (inf --> -0.329612).  Saving model ...
Epoch: 2 cost time: 0.667820930480957
Epoch: 2, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.672 Vali Acc: 0.341 Test Loss: 1.672 Test Acc: 0.341
Validation loss decreased (-0.329612 --> -0.340724).  Saving model ...
Epoch: 3 cost time: 0.6842577457427979
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.608 Vali Acc: 0.356 Test Loss: 1.608 Test Acc: 0.356
Validation loss decreased (-0.340724 --> -0.355539).  Saving model ...
Epoch: 4 cost time: 0.7653601169586182
Epoch: 4, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.536 Vali Acc: 0.393 Test Loss: 1.536 Test Acc: 0.393
Validation loss decreased (-0.355539 --> -0.392577).  Saving model ...
Epoch: 5 cost time: 0.8173129558563232
Epoch: 5, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.448 Vali Acc: 0.441 Test Loss: 1.448 Test Acc: 0.441
Validation loss decreased (-0.392577 --> -0.440726).  Saving model ...
Epoch: 6 cost time: 0.6249570846557617
Epoch: 6, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.346 Vali Acc: 0.504 Test Loss: 1.346 Test Acc: 0.504
Validation loss decreased (-0.440726 --> -0.503690).  Saving model ...
Epoch: 7 cost time: 0.8246369361877441
Epoch: 7, Steps: 2 | Train Loss: 1.268 Vali Loss: 1.240 Vali Acc: 0.559 Test Loss: 1.240 Test Acc: 0.559
Validation loss decreased (-0.503690 --> -0.559247).  Saving model ...
Epoch: 8 cost time: 0.6396031379699707
Epoch: 8, Steps: 2 | Train Loss: 1.213 Vali Loss: 1.134 Vali Acc: 0.622 Test Loss: 1.134 Test Acc: 0.622
Validation loss decreased (-0.559247 --> -0.622211).  Saving model ...
Epoch: 9 cost time: 0.8446757793426514
Epoch: 9, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.029 Vali Acc: 0.707 Test Loss: 1.029 Test Acc: 0.707
Validation loss decreased (-0.622211 --> -0.707397).  Saving model ...
Epoch: 10 cost time: 0.7994368076324463
Epoch: 10, Steps: 2 | Train Loss: 0.912 Vali Loss: 0.928 Vali Acc: 0.774 Test Loss: 0.928 Test Acc: 0.774
Validation loss decreased (-0.707397 --> -0.774065).  Saving model ...
Epoch: 11 cost time: 0.8808550834655762
Epoch: 11, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.834 Vali Acc: 0.819 Test Loss: 0.834 Test Acc: 0.819
Validation loss decreased (-0.774065 --> -0.818510).  Saving model ...
Epoch: 12 cost time: 0.7072758674621582
Epoch: 12, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.747 Vali Acc: 0.844 Test Loss: 0.747 Test Acc: 0.844
Validation loss decreased (-0.818510 --> -0.844437).  Saving model ...
Epoch: 13 cost time: 0.7920255661010742
Epoch: 13, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.671 Vali Acc: 0.867 Test Loss: 0.671 Test Acc: 0.867
Validation loss decreased (-0.844437 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 0.7270681858062744
Epoch: 14, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.603 Vali Acc: 0.878 Test Loss: 0.603 Test Acc: 0.878
Validation loss decreased (-0.866660 --> -0.877772).  Saving model ...
Epoch: 15 cost time: 0.7207958698272705
Epoch: 15, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.545 Vali Acc: 0.889 Test Loss: 0.545 Test Acc: 0.889
Validation loss decreased (-0.877772 --> -0.888883).  Saving model ...
Epoch: 16 cost time: 0.8450851440429688
Epoch: 16, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.496 Vali Acc: 0.893 Test Loss: 0.496 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892588).  Saving model ...
Epoch: 17 cost time: 0.9426770210266113
Epoch: 17, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.454 Vali Acc: 0.904 Test Loss: 0.454 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.921929121017456
Epoch: 18, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.419 Vali Acc: 0.911 Test Loss: 0.419 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.8447771072387695
Epoch: 19, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.387 Vali Acc: 0.915 Test Loss: 0.387 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.7375807762145996
Epoch: 20, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.7860965728759766
Epoch: 21, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.8488836288452148
Epoch: 22, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 23 cost time: 0.7113854885101318
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 24 cost time: 0.7891311645507812
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.296 Vali Acc: 0.922 Test Loss: 0.296 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.8984789848327637
Epoch: 25, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7900595664978027
Epoch: 26, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 0.824967622756958
Epoch: 27, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.752446174621582
Epoch: 28, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 29 cost time: 0.8036682605743408
Epoch: 29, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.9077270030975342
Epoch: 30, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.9262228012084961
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7493352890014648
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.233 Vali Acc: 0.922 Test Loss: 0.233 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7170836925506592
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.8070135116577148
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.7566101551055908
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.8573822975158691
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.9194240570068359
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 38 cost time: 0.716651201248169
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 39 cost time: 0.7175042629241943
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 40 cost time: 0.844534158706665
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 41 cost time: 0.6564888954162598
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.8292932510375977
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.7461671829223633
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.7691175937652588
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.7745285034179688
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.7564189434051514
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.8698499202728271
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.9046890735626221
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.7589926719665527
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.717900276184082
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 51 cost time: 0.6434707641601562
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.7162861824035645
Epoch: 52, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.7916314601898193
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.7094295024871826
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.7083094120025635
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.6775226593017578
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.6605801582336426
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.8097026348114014
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 59 cost time: 0.736191987991333
Epoch: 59, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.813920259475708
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.7681608200073242
Epoch: 61, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.8578588962554932
Epoch: 62, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.969484806060791
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.763038158416748
Epoch: 64, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.9660770893096924
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.941673755645752
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.8435637950897217
Epoch: 67, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.936164379119873
Epoch: 68, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 568774
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8060810565948486
Epoch: 1, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.734 Vali Acc: 0.333 Test Loss: 1.734 Test Acc: 0.333
Validation loss decreased (inf --> -0.333316).  Saving model ...
Epoch: 2 cost time: 0.6792001724243164
Epoch: 2, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.657 Vali Acc: 0.352 Test Loss: 1.657 Test Acc: 0.352
Validation loss decreased (-0.333316 --> -0.351835).  Saving model ...
Epoch: 3 cost time: 0.6963801383972168
Epoch: 3, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.593 Vali Acc: 0.378 Test Loss: 1.593 Test Acc: 0.378
Validation loss decreased (-0.351835 --> -0.377762).  Saving model ...
Epoch: 4 cost time: 0.7283782958984375
Epoch: 4, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.520 Vali Acc: 0.396 Test Loss: 1.520 Test Acc: 0.396
Validation loss decreased (-0.377762 --> -0.396281).  Saving model ...
Epoch: 5 cost time: 0.6719274520874023
Epoch: 5, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.432 Vali Acc: 0.448 Test Loss: 1.432 Test Acc: 0.448
Validation loss decreased (-0.396281 --> -0.448134).  Saving model ...
Epoch: 6 cost time: 0.6023452281951904
Epoch: 6, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.331 Vali Acc: 0.507 Test Loss: 1.331 Test Acc: 0.507
Validation loss decreased (-0.448134 --> -0.507394).  Saving model ...
Epoch: 7 cost time: 0.7110347747802734
Epoch: 7, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.225 Vali Acc: 0.593 Test Loss: 1.225 Test Acc: 0.593
Validation loss decreased (-0.507394 --> -0.592580).  Saving model ...
Epoch: 8 cost time: 0.7706096172332764
Epoch: 8, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.118 Vali Acc: 0.670 Test Loss: 1.118 Test Acc: 0.670
Validation loss decreased (-0.592580 --> -0.670359).  Saving model ...
Epoch: 9 cost time: 0.7927908897399902
Epoch: 9, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.013 Vali Acc: 0.730 Test Loss: 1.013 Test Acc: 0.730
Validation loss decreased (-0.670359 --> -0.729619).  Saving model ...
Epoch: 10 cost time: 0.7014739513397217
Epoch: 10, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.912 Vali Acc: 0.793 Test Loss: 0.912 Test Acc: 0.793
Validation loss decreased (-0.729619 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 0.8916885852813721
Epoch: 11, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.818 Vali Acc: 0.844 Test Loss: 0.818 Test Acc: 0.844
Validation loss decreased (-0.792583 --> -0.844436).  Saving model ...
Epoch: 12 cost time: 0.7989897727966309
Epoch: 12, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.732 Vali Acc: 0.867 Test Loss: 0.732 Test Acc: 0.867
Validation loss decreased (-0.844436 --> -0.866659).  Saving model ...
Epoch: 13 cost time: 0.7356476783752441
Epoch: 13, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.654 Vali Acc: 0.889 Test Loss: 0.654 Test Acc: 0.889
Validation loss decreased (-0.866659 --> -0.888882).  Saving model ...
Epoch: 14 cost time: 0.7255077362060547
Epoch: 14, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.588 Vali Acc: 0.896 Test Loss: 0.588 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 15 cost time: 0.7465791702270508
Epoch: 15, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.530 Vali Acc: 0.904 Test Loss: 0.530 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903698).  Saving model ...
Epoch: 16 cost time: 0.775038480758667
Epoch: 16, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.481 Vali Acc: 0.919 Test Loss: 0.481 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918514).  Saving model ...
Epoch: 17 cost time: 0.7187888622283936
Epoch: 17, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.438 Vali Acc: 0.915 Test Loss: 0.438 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.8106374740600586
Epoch: 18, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.404 Vali Acc: 0.915 Test Loss: 0.404 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.7391297817230225
Epoch: 19, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.374 Vali Acc: 0.919 Test Loss: 0.374 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.7609436511993408
Epoch: 20, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.348 Vali Acc: 0.926 Test Loss: 0.348 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.7609286308288574
Epoch: 21, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.7437150478363037
Epoch: 22, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.311 Vali Acc: 0.922 Test Loss: 0.311 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.0418920516967773
Epoch: 23, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8583238124847412
Epoch: 24, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.284 Vali Acc: 0.922 Test Loss: 0.284 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7342777252197266
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.271 Vali Acc: 0.930 Test Loss: 0.271 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.8149921894073486
Epoch: 26, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 0.8011009693145752
Epoch: 27, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7930517196655273
Epoch: 28, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.7458257675170898
Epoch: 29, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7707319259643555
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.6950454711914062
Epoch: 31, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6842889785766602
Epoch: 32, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.717108964920044
Epoch: 33, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.7613725662231445
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.6673636436462402
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.7549548149108887
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.762016773223877
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7740049362182617
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 39 cost time: 0.8901865482330322
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.7253024578094482
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7354512214660645
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.7110064029693604
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7421901226043701
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.7249162197113037
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6535587310791016
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.8761610984802246
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7522387504577637
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.7085843086242676
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.8012704849243164
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 568774
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8568837642669678
Epoch: 1, Steps: 2 | Train Loss: 1.888 Vali Loss: 1.740 Vali Acc: 0.337 Test Loss: 1.740 Test Acc: 0.337
Validation loss decreased (inf --> -0.337020).  Saving model ...
Epoch: 2 cost time: 0.8242928981781006
Epoch: 2, Steps: 2 | Train Loss: 1.798 Vali Loss: 1.663 Vali Acc: 0.344 Test Loss: 1.663 Test Acc: 0.344
Validation loss decreased (-0.337020 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.7742903232574463
Epoch: 3, Steps: 2 | Train Loss: 1.770 Vali Loss: 1.598 Vali Acc: 0.370 Test Loss: 1.598 Test Acc: 0.370
Validation loss decreased (-0.344428 --> -0.370354).  Saving model ...
Epoch: 4 cost time: 0.6685342788696289
Epoch: 4, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.523 Vali Acc: 0.415 Test Loss: 1.523 Test Acc: 0.415
Validation loss decreased (-0.370354 --> -0.414800).  Saving model ...
Epoch: 5 cost time: 0.7557253837585449
Epoch: 5, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.435 Vali Acc: 0.478 Test Loss: 1.435 Test Acc: 0.478
Validation loss decreased (-0.414800 --> -0.477763).  Saving model ...
Epoch: 6 cost time: 0.7245101928710938
Epoch: 6, Steps: 2 | Train Loss: 1.462 Vali Loss: 1.332 Vali Acc: 0.526 Test Loss: 1.332 Test Acc: 0.526
Validation loss decreased (-0.477763 --> -0.525913).  Saving model ...
Epoch: 7 cost time: 0.7316503524780273
Epoch: 7, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.223 Vali Acc: 0.604 Test Loss: 1.223 Test Acc: 0.604
Validation loss decreased (-0.525913 --> -0.603691).  Saving model ...
Epoch: 8 cost time: 0.6204278469085693
Epoch: 8, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.116 Vali Acc: 0.659 Test Loss: 1.116 Test Acc: 0.659
Validation loss decreased (-0.603691 --> -0.659248).  Saving model ...
Epoch: 9 cost time: 0.620513916015625
Epoch: 9, Steps: 2 | Train Loss: 1.005 Vali Loss: 1.011 Vali Acc: 0.730 Test Loss: 1.011 Test Acc: 0.730
Validation loss decreased (-0.659248 --> -0.729620).  Saving model ...
Epoch: 10 cost time: 0.7313895225524902
Epoch: 10, Steps: 2 | Train Loss: 0.937 Vali Loss: 0.908 Vali Acc: 0.800 Test Loss: 0.908 Test Acc: 0.800
Validation loss decreased (-0.729620 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.9372732639312744
Epoch: 11, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.814 Vali Acc: 0.830 Test Loss: 0.814 Test Acc: 0.830
Validation loss decreased (-0.799991 --> -0.829621).  Saving model ...
Epoch: 12 cost time: 0.8163924217224121
Epoch: 12, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.729 Vali Acc: 0.867 Test Loss: 0.729 Test Acc: 0.867
Validation loss decreased (-0.829621 --> -0.866659).  Saving model ...
Epoch: 13 cost time: 0.7550642490386963
Epoch: 13, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.651 Vali Acc: 0.885 Test Loss: 0.651 Test Acc: 0.885
Validation loss decreased (-0.866659 --> -0.885179).  Saving model ...
Epoch: 14 cost time: 0.7357275485992432
Epoch: 14, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.586 Vali Acc: 0.896 Test Loss: 0.586 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896290).  Saving model ...
Epoch: 15 cost time: 0.7012722492218018
Epoch: 15, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.528 Vali Acc: 0.900 Test Loss: 0.528 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.7382242679595947
Epoch: 16, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.479 Vali Acc: 0.904 Test Loss: 0.479 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 17 cost time: 0.8324439525604248
Epoch: 17, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.437 Vali Acc: 0.907 Test Loss: 0.437 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 0.7699055671691895
Epoch: 18, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.7713444232940674
Epoch: 19, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.373 Vali Acc: 0.919 Test Loss: 0.373 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.774707555770874
Epoch: 20, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.8783469200134277
Epoch: 21, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.327 Vali Acc: 0.926 Test Loss: 0.327 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.7362315654754639
Epoch: 22, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.310 Vali Acc: 0.930 Test Loss: 0.310 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 23 cost time: 0.7469789981842041
Epoch: 23, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.295 Vali Acc: 0.926 Test Loss: 0.295 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.7726702690124512
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.785982608795166
Epoch: 25, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.865347146987915
Epoch: 26, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 27 cost time: 0.7379653453826904
Epoch: 27, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 28 cost time: 0.7583944797515869
Epoch: 28, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.8232724666595459
Epoch: 29, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.8088712692260742
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.7382571697235107
Epoch: 31, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6568901538848877
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.644221305847168
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.7186183929443359
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.7097158432006836
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.7608804702758789
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.8548777103424072
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.7342715263366699
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.693427324295044
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.7142565250396729
Epoch: 40, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7451715469360352
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7052888870239258
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.8092648983001709
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.7664923667907715
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.8562307357788086
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.8171494007110596
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.7246382236480713
Epoch: 47, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.7029273509979248
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.7687585353851318
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.830906867980957
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.7157387733459473
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6988377571105957
Epoch: 52, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.7800111770629883
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.7302496433258057
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.6975171566009521
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.6834330558776855
Epoch: 56, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.8770265579223633
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.7550945281982422
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.6689407825469971
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.764035701751709
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.7643411159515381
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.7349765300750732
Epoch: 62, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.6993534564971924
Epoch: 63, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.841684103012085
Epoch: 64, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.9371709823608398
Epoch: 65, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.9616477489471436
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 1.036738395690918
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 68 cost time: 1.0893399715423584
Epoch: 68, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 69 cost time: 0.9905092716217041
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.8480165004730225
Epoch: 70, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.9379665851593018
Epoch: 71, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 1.0906422138214111
Epoch: 72, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 1.0528783798217773
Epoch: 73, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.9915547370910645
Epoch: 74, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 1.033524990081787
Epoch: 75, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 1.070669174194336
Epoch: 76, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.9258179664611816
Epoch: 77, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.9273338317871094
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.9486954212188721
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 568774
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6282832622528076
Epoch: 1, Steps: 2 | Train Loss: 1.927 Vali Loss: 1.794 Vali Acc: 0.215 Test Loss: 1.794 Test Acc: 0.215
Validation loss decreased (inf --> -0.214797).  Saving model ...
Epoch: 2 cost time: 0.9952890872955322
Epoch: 2, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.719 Vali Acc: 0.278 Test Loss: 1.719 Test Acc: 0.278
Validation loss decreased (-0.214797 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.9774026870727539
Epoch: 3, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.654 Vali Acc: 0.311 Test Loss: 1.654 Test Acc: 0.311
Validation loss decreased (-0.277761 --> -0.311095).  Saving model ...
Epoch: 4 cost time: 0.9181628227233887
Epoch: 4, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.582 Vali Acc: 0.381 Test Loss: 1.582 Test Acc: 0.381
Validation loss decreased (-0.311095 --> -0.381466).  Saving model ...
Epoch: 5 cost time: 0.7659242153167725
Epoch: 5, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.491 Vali Acc: 0.448 Test Loss: 1.491 Test Acc: 0.448
Validation loss decreased (-0.381466 --> -0.448133).  Saving model ...
Epoch: 6 cost time: 0.8922805786132812
Epoch: 6, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.388 Vali Acc: 0.507 Test Loss: 1.388 Test Acc: 0.507
Validation loss decreased (-0.448133 --> -0.507394).  Saving model ...
Epoch: 7 cost time: 0.8075592517852783
Epoch: 7, Steps: 2 | Train Loss: 1.310 Vali Loss: 1.278 Vali Acc: 0.581 Test Loss: 1.278 Test Acc: 0.581
Validation loss decreased (-0.507394 --> -0.581469).  Saving model ...
Epoch: 8 cost time: 0.7025442123413086
Epoch: 8, Steps: 2 | Train Loss: 1.237 Vali Loss: 1.170 Vali Acc: 0.637 Test Loss: 1.170 Test Acc: 0.637
Validation loss decreased (-0.581469 --> -0.637025).  Saving model ...
Epoch: 9 cost time: 0.7290873527526855
Epoch: 9, Steps: 2 | Train Loss: 0.991 Vali Loss: 1.063 Vali Acc: 0.689 Test Loss: 1.063 Test Acc: 0.689
Validation loss decreased (-0.637025 --> -0.688878).  Saving model ...
Epoch: 10 cost time: 0.7331924438476562
Epoch: 10, Steps: 2 | Train Loss: 0.975 Vali Loss: 0.961 Vali Acc: 0.781 Test Loss: 0.961 Test Acc: 0.781
Validation loss decreased (-0.688878 --> -0.781472).  Saving model ...
Epoch: 11 cost time: 0.7741677761077881
Epoch: 11, Steps: 2 | Train Loss: 0.829 Vali Loss: 0.864 Vali Acc: 0.815 Test Loss: 0.864 Test Acc: 0.815
Validation loss decreased (-0.781472 --> -0.814806).  Saving model ...
Epoch: 12 cost time: 0.7563574314117432
Epoch: 12, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.776 Vali Acc: 0.837 Test Loss: 0.776 Test Acc: 0.837
Validation loss decreased (-0.814806 --> -0.837029).  Saving model ...
Epoch: 13 cost time: 0.8751745223999023
Epoch: 13, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.698 Vali Acc: 0.848 Test Loss: 0.698 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 14 cost time: 0.7463715076446533
Epoch: 14, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.630 Vali Acc: 0.859 Test Loss: 0.630 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859253).  Saving model ...
Epoch: 15 cost time: 0.7619545459747314
Epoch: 15, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.571 Vali Acc: 0.870 Test Loss: 0.571 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 16 cost time: 0.7719078063964844
Epoch: 16, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.521 Vali Acc: 0.874 Test Loss: 0.521 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 17 cost time: 0.7203104496002197
Epoch: 17, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.476 Vali Acc: 0.878 Test Loss: 0.476 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 18 cost time: 0.7031068801879883
Epoch: 18, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.439 Vali Acc: 0.885 Test Loss: 0.439 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885181).  Saving model ...
Epoch: 19 cost time: 0.6919219493865967
Epoch: 19, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.407 Vali Acc: 0.904 Test Loss: 0.407 Test Acc: 0.904
Validation loss decreased (-0.885181 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.6538095474243164
Epoch: 20, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.720966100692749
Epoch: 21, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.358 Vali Acc: 0.900 Test Loss: 0.358 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7236018180847168
Epoch: 22, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.339 Vali Acc: 0.900 Test Loss: 0.339 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7026748657226562
Epoch: 23, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.321 Vali Acc: 0.907 Test Loss: 0.321 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 0.6681625843048096
Epoch: 24, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.309 Vali Acc: 0.907 Test Loss: 0.309 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.7039752006530762
Epoch: 25, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.295 Vali Acc: 0.904 Test Loss: 0.295 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6577661037445068
Epoch: 26, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.285 Vali Acc: 0.904 Test Loss: 0.285 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.0270493030548096
Epoch: 27, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.277 Vali Acc: 0.907 Test Loss: 0.277 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 28 cost time: 0.726564884185791
Epoch: 28, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.269 Vali Acc: 0.907 Test Loss: 0.269 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 29 cost time: 0.6064455509185791
Epoch: 29, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.264 Vali Acc: 0.911 Test Loss: 0.264 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 30 cost time: 0.7495708465576172
Epoch: 30, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 31 cost time: 0.708690881729126
Epoch: 31, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.8208310604095459
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.7071022987365723
Epoch: 33, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6887447834014893
Epoch: 34, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.6501317024230957
Epoch: 35, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.6586878299713135
Epoch: 36, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.240 Vali Acc: 0.911 Test Loss: 0.240 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.7434618473052979
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.7171354293823242
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.7028958797454834
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.7277982234954834
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.907 Test Loss: 0.235 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 568774
model size : 3.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.8347489833831787
Epoch: 1, Steps: 2 | Train Loss: 2.055 Vali Loss: 1.911 Vali Acc: 0.159 Test Loss: 1.911 Test Acc: 0.159
Validation loss decreased (inf --> -0.159240).  Saving model ...
Epoch: 2 cost time: 0.600905179977417
Epoch: 2, Steps: 2 | Train Loss: 1.906 Vali Loss: 1.802 Vali Acc: 0.222 Test Loss: 1.802 Test Acc: 0.222
Validation loss decreased (-0.159240 --> -0.222204).  Saving model ...
Epoch: 3 cost time: 0.720444917678833
Epoch: 3, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.718 Vali Acc: 0.285 Test Loss: 1.718 Test Acc: 0.285
Validation loss decreased (-0.222204 --> -0.285168).  Saving model ...
Epoch: 4 cost time: 0.6856465339660645
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.628 Vali Acc: 0.352 Test Loss: 1.628 Test Acc: 0.352
Validation loss decreased (-0.285168 --> -0.351836).  Saving model ...
Epoch: 5 cost time: 0.6155121326446533
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.519 Vali Acc: 0.470 Test Loss: 1.519 Test Acc: 0.470
Validation loss decreased (-0.351836 --> -0.470355).  Saving model ...
Epoch: 6 cost time: 0.7747561931610107
Epoch: 6, Steps: 2 | Train Loss: 1.491 Vali Loss: 1.400 Vali Acc: 0.567 Test Loss: 1.400 Test Acc: 0.567
Validation loss decreased (-0.470355 --> -0.566653).  Saving model ...
Epoch: 7 cost time: 0.6964468955993652
Epoch: 7, Steps: 2 | Train Loss: 1.279 Vali Loss: 1.275 Vali Acc: 0.644 Test Loss: 1.275 Test Acc: 0.644
Validation loss decreased (-0.566653 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.6859164237976074
Epoch: 8, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.151 Vali Acc: 0.715 Test Loss: 1.151 Test Acc: 0.715
Validation loss decreased (-0.644432 --> -0.714803).  Saving model ...
Epoch: 9 cost time: 0.7883780002593994
Epoch: 9, Steps: 2 | Train Loss: 1.043 Vali Loss: 1.031 Vali Acc: 0.737 Test Loss: 1.031 Test Acc: 0.737
Validation loss decreased (-0.714803 --> -0.737027).  Saving model ...
Epoch: 10 cost time: 0.7952079772949219
Epoch: 10, Steps: 2 | Train Loss: 1.003 Vali Loss: 0.922 Vali Acc: 0.778 Test Loss: 0.922 Test Acc: 0.778
Validation loss decreased (-0.737027 --> -0.777769).  Saving model ...
Epoch: 11 cost time: 0.6537139415740967
Epoch: 11, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.823 Vali Acc: 0.811 Test Loss: 0.823 Test Acc: 0.811
Validation loss decreased (-0.777769 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 0.7146294116973877
Epoch: 12, Steps: 2 | Train Loss: 0.695 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
Validation loss decreased (-0.811103 --> -0.844437).  Saving model ...
Epoch: 13 cost time: 0.7390992641448975
Epoch: 13, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.653 Vali Acc: 0.870 Test Loss: 0.653 Test Acc: 0.870
Validation loss decreased (-0.844437 --> -0.870364).  Saving model ...
Epoch: 14 cost time: 0.7890198230743408
Epoch: 14, Steps: 2 | Train Loss: 0.494 Vali Loss: 0.586 Vali Acc: 0.885 Test Loss: 0.586 Test Acc: 0.885
Validation loss decreased (-0.870364 --> -0.885179).  Saving model ...
Epoch: 15 cost time: 0.8971080780029297
Epoch: 15, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.527 Vali Acc: 0.904 Test Loss: 0.527 Test Acc: 0.904
Validation loss decreased (-0.885179 --> -0.903698).  Saving model ...
Epoch: 16 cost time: 0.9300968647003174
Epoch: 16, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.477 Vali Acc: 0.900 Test Loss: 0.477 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.7728044986724854
Epoch: 17, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.432 Vali Acc: 0.911 Test Loss: 0.432 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911107).  Saving model ...
Epoch: 18 cost time: 0.9265069961547852
Epoch: 18, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.395 Vali Acc: 0.911 Test Loss: 0.395 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.8587179183959961
Epoch: 19, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.365 Vali Acc: 0.919 Test Loss: 0.365 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.9939019680023193
Epoch: 20, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.7868390083312988
Epoch: 21, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.869471549987793
Epoch: 22, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.875032901763916
Epoch: 23, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.279 Vali Acc: 0.930 Test Loss: 0.279 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.6876375675201416
Epoch: 24, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.713254451751709
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7856736183166504
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.9162843227386475
Epoch: 27, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.8882524967193604
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.7793905735015869
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.9272122383117676
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.7789454460144043
Epoch: 31, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.8838253021240234
Epoch: 32, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.8992316722869873
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.833747386932373
Epoch: 34, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.7598185539245605
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.775029182434082
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.9099752902984619
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.9207358360290527
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.8558437824249268
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7876694202423096
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.7368409633636475
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.7681193351745605
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.6851742267608643
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.7635552883148193
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.8038928508758545
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.699953556060791
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.8131394386291504
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7663779258728027
Epoch: 48, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6921508312225342
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.7511365413665771
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.7105081081390381
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.7392621040344238
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6187727451324463
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 306630
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.577395439147949
Epoch: 1, Steps: 2 | Train Loss: 2.045 Vali Loss: 1.921 Vali Acc: 0.148 Test Loss: 1.921 Test Acc: 0.148
Validation loss decreased (inf --> -0.148129).  Saving model ...
Epoch: 2 cost time: 0.7031402587890625
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.812 Vali Acc: 0.178 Test Loss: 1.812 Test Acc: 0.178
Validation loss decreased (-0.148129 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.6669754981994629
Epoch: 3, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.727 Vali Acc: 0.267 Test Loss: 1.727 Test Acc: 0.267
Validation loss decreased (-0.177760 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.6459665298461914
Epoch: 4, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.635 Vali Acc: 0.337 Test Loss: 1.635 Test Acc: 0.337
Validation loss decreased (-0.266649 --> -0.337021).  Saving model ...
Epoch: 5 cost time: 0.7776918411254883
Epoch: 5, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.525 Vali Acc: 0.426 Test Loss: 1.525 Test Acc: 0.426
Validation loss decreased (-0.337021 --> -0.425911).  Saving model ...
Epoch: 6 cost time: 0.7089822292327881
Epoch: 6, Steps: 2 | Train Loss: 1.461 Vali Loss: 1.405 Vali Acc: 0.552 Test Loss: 1.405 Test Acc: 0.552
Validation loss decreased (-0.425911 --> -0.551838).  Saving model ...
Epoch: 7 cost time: 0.7481963634490967
Epoch: 7, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.279 Vali Acc: 0.663 Test Loss: 1.279 Test Acc: 0.663
Validation loss decreased (-0.551838 --> -0.662950).  Saving model ...
Epoch: 8 cost time: 0.7302618026733398
Epoch: 8, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.153 Vali Acc: 0.719 Test Loss: 1.153 Test Acc: 0.719
Validation loss decreased (-0.662950 --> -0.718507).  Saving model ...
Epoch: 9 cost time: 0.6886787414550781
Epoch: 9, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.032 Vali Acc: 0.767 Test Loss: 1.032 Test Acc: 0.767
Validation loss decreased (-0.718507 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 0.7359933853149414
Epoch: 10, Steps: 2 | Train Loss: 0.974 Vali Loss: 0.923 Vali Acc: 0.781 Test Loss: 0.923 Test Acc: 0.781
Validation loss decreased (-0.766656 --> -0.781472).  Saving model ...
Epoch: 11 cost time: 0.6155304908752441
Epoch: 11, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.823 Vali Acc: 0.811 Test Loss: 0.823 Test Acc: 0.811
Validation loss decreased (-0.781472 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 1.0948307514190674
Epoch: 12, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.731 Vali Acc: 0.841 Test Loss: 0.731 Test Acc: 0.841
Validation loss decreased (-0.811103 --> -0.840733).  Saving model ...
Epoch: 13 cost time: 0.7569737434387207
Epoch: 13, Steps: 2 | Train Loss: 0.624 Vali Loss: 0.650 Vali Acc: 0.867 Test Loss: 0.650 Test Acc: 0.867
Validation loss decreased (-0.840733 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 0.781470537185669
Epoch: 14, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.582 Vali Acc: 0.881 Test Loss: 0.582 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881476).  Saving model ...
Epoch: 15 cost time: 0.7231197357177734
Epoch: 15, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899995).  Saving model ...
Epoch: 16 cost time: 0.6676466464996338
Epoch: 16, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.470 Vali Acc: 0.915 Test Loss: 0.470 Test Acc: 0.915
Validation loss decreased (-0.899995 --> -0.914810).  Saving model ...
Epoch: 17 cost time: 0.6614644527435303
Epoch: 17, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.425 Vali Acc: 0.919 Test Loss: 0.425 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.7105612754821777
Epoch: 18, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.387 Vali Acc: 0.922 Test Loss: 0.387 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 19 cost time: 0.6339318752288818
Epoch: 19, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.357 Vali Acc: 0.915 Test Loss: 0.357 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.7942516803741455
Epoch: 20, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.332 Vali Acc: 0.922 Test Loss: 0.332 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.6513793468475342
Epoch: 21, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.309 Vali Acc: 0.926 Test Loss: 0.309 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 22 cost time: 0.7448809146881104
Epoch: 22, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.291 Vali Acc: 0.926 Test Loss: 0.291 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 23 cost time: 0.6118781566619873
Epoch: 23, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.275 Vali Acc: 0.930 Test Loss: 0.275 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.6840195655822754
Epoch: 24, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.263 Vali Acc: 0.926 Test Loss: 0.263 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7119612693786621
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.6996955871582031
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.8392877578735352
Epoch: 27, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.6946346759796143
Epoch: 28, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.7787532806396484
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.6865026950836182
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.7048158645629883
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6912155151367188
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.7544395923614502
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.7737195491790771
Epoch: 34, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.6886098384857178
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.7259938716888428
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 37 cost time: 0.7670478820800781
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 38 cost time: 0.807788610458374
Epoch: 38, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 39 cost time: 0.7442784309387207
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 40 cost time: 0.7575855255126953
Epoch: 40, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 41 cost time: 0.731605052947998
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.937 Test Loss: 0.210 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.7344756126403809
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.6418423652648926
Epoch: 43, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.8489828109741211
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.937 Test Loss: 0.208 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.7214608192443848
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.6543974876403809
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.7430520057678223
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.6728687286376953
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.7050549983978271
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.6791660785675049
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.757936954498291
Epoch: 51, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7600533962249756
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.74295973777771
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7343630790710449
Epoch: 54, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6920206546783447
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.7351770401000977
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.7765152454376221
Epoch: 57, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.8439819812774658
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.9470279216766357
Epoch: 59, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 306630
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.705540657043457
Epoch: 1, Steps: 2 | Train Loss: 2.058 Vali Loss: 1.910 Vali Acc: 0.156 Test Loss: 1.910 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.7508490085601807
Epoch: 2, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.803 Vali Acc: 0.215 Test Loss: 1.803 Test Acc: 0.215
Validation loss decreased (-0.155536 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.7327032089233398
Epoch: 3, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.720 Vali Acc: 0.267 Test Loss: 1.720 Test Acc: 0.267
Validation loss decreased (-0.214797 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.6796038150787354
Epoch: 4, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.629 Vali Acc: 0.333 Test Loss: 1.629 Test Acc: 0.333
Validation loss decreased (-0.266649 --> -0.333317).  Saving model ...
Epoch: 5 cost time: 0.6218240261077881
Epoch: 5, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.519 Vali Acc: 0.419 Test Loss: 1.519 Test Acc: 0.419
Validation loss decreased (-0.333317 --> -0.418503).  Saving model ...
Epoch: 6 cost time: 0.8709568977355957
Epoch: 6, Steps: 2 | Train Loss: 1.439 Vali Loss: 1.399 Vali Acc: 0.533 Test Loss: 1.399 Test Acc: 0.533
Validation loss decreased (-0.418503 --> -0.533319).  Saving model ...
Epoch: 7 cost time: 0.7113046646118164
Epoch: 7, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.274 Vali Acc: 0.652 Test Loss: 1.274 Test Acc: 0.652
Validation loss decreased (-0.533319 --> -0.651839).  Saving model ...
Epoch: 8 cost time: 0.6351718902587891
Epoch: 8, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.149 Vali Acc: 0.733 Test Loss: 1.149 Test Acc: 0.733
Validation loss decreased (-0.651839 --> -0.733322).  Saving model ...
Epoch: 9 cost time: 0.6282258033752441
Epoch: 9, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.027 Vali Acc: 0.796 Test Loss: 1.027 Test Acc: 0.796
Validation loss decreased (-0.733322 --> -0.796286).  Saving model ...
Epoch: 10 cost time: 0.6936855316162109
Epoch: 10, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.919 Vali Acc: 0.804 Test Loss: 0.919 Test Acc: 0.804
Validation loss decreased (-0.796286 --> -0.803695).  Saving model ...
Epoch: 11 cost time: 0.6694784164428711
Epoch: 11, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.818 Vali Acc: 0.833 Test Loss: 0.818 Test Acc: 0.833
Validation loss decreased (-0.803695 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 0.6065962314605713
Epoch: 12, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.727 Vali Acc: 0.859 Test Loss: 0.727 Test Acc: 0.859
Validation loss decreased (-0.833325 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 0.7548692226409912
Epoch: 13, Steps: 2 | Train Loss: 0.610 Vali Loss: 0.646 Vali Acc: 0.881 Test Loss: 0.646 Test Acc: 0.881
Validation loss decreased (-0.859252 --> -0.881475).  Saving model ...
Epoch: 14 cost time: 0.6714286804199219
Epoch: 14, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.579 Vali Acc: 0.896 Test Loss: 0.579 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896291).  Saving model ...
Epoch: 15 cost time: 0.7660858631134033
Epoch: 15, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.519 Vali Acc: 0.904 Test Loss: 0.519 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 16 cost time: 0.73728346824646
Epoch: 16, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.467 Vali Acc: 0.907 Test Loss: 0.467 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 17 cost time: 0.6940081119537354
Epoch: 17, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 18 cost time: 0.7098772525787354
Epoch: 18, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.384 Vali Acc: 0.919 Test Loss: 0.384 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 19 cost time: 0.7107315063476562
Epoch: 19, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 0.78025221824646
Epoch: 20, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.328 Vali Acc: 0.926 Test Loss: 0.328 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 21 cost time: 0.7143168449401855
Epoch: 21, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7914512157440186
Epoch: 22, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7881853580474854
Epoch: 23, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6743571758270264
Epoch: 24, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.770951509475708
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.6919252872467041
Epoch: 26, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.6680171489715576
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.8670096397399902
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.231 Vali Acc: 0.941 Test Loss: 0.231 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.7820620536804199
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.7420520782470703
Epoch: 30, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.9175703525543213
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.7377164363861084
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.6733968257904053
Epoch: 33, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.690192461013794
Epoch: 34, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7163517475128174
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.658085823059082
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.7534432411193848
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7873480319976807
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.8130722045898438
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 40 cost time: 0.7295742034912109
Epoch: 40, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.7006039619445801
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.6717512607574463
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.7004523277282715
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.8032395839691162
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.7010273933410645
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.6864078044891357
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.7411437034606934
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.6684916019439697
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.7060256004333496
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 306630
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.823328971862793
Epoch: 1, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.838 Vali Acc: 0.181 Test Loss: 1.838 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.671668291091919
Epoch: 2, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.739 Vali Acc: 0.248 Test Loss: 1.739 Test Acc: 0.248
Validation loss decreased (-0.181463 --> -0.248131).  Saving model ...
Epoch: 3 cost time: 0.6328434944152832
Epoch: 3, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.661 Vali Acc: 0.311 Test Loss: 1.661 Test Acc: 0.311
Validation loss decreased (-0.248131 --> -0.311095).  Saving model ...
Epoch: 4 cost time: 0.6190657615661621
Epoch: 4, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.578 Vali Acc: 0.404 Test Loss: 1.578 Test Acc: 0.404
Validation loss decreased (-0.311095 --> -0.403688).  Saving model ...
Epoch: 5 cost time: 0.6571455001831055
Epoch: 5, Steps: 2 | Train Loss: 1.547 Vali Loss: 1.476 Vali Acc: 0.496 Test Loss: 1.476 Test Acc: 0.496
Validation loss decreased (-0.403688 --> -0.496282).  Saving model ...
Epoch: 6 cost time: 0.6685197353363037
Epoch: 6, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.364 Vali Acc: 0.574 Test Loss: 1.364 Test Acc: 0.574
Validation loss decreased (-0.496282 --> -0.574060).  Saving model ...
Epoch: 7 cost time: 0.5860106945037842
Epoch: 7, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.248 Vali Acc: 0.659 Test Loss: 1.248 Test Acc: 0.659
Validation loss decreased (-0.574060 --> -0.659247).  Saving model ...
Epoch: 8 cost time: 0.5885105133056641
Epoch: 8, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.133 Vali Acc: 0.707 Test Loss: 1.133 Test Acc: 0.707
Validation loss decreased (-0.659247 --> -0.707396).  Saving model ...
Epoch: 9 cost time: 0.5852978229522705
Epoch: 9, Steps: 2 | Train Loss: 1.052 Vali Loss: 1.022 Vali Acc: 0.756 Test Loss: 1.022 Test Acc: 0.756
Validation loss decreased (-0.707396 --> -0.755545).  Saving model ...
Epoch: 10 cost time: 0.6436247825622559
Epoch: 10, Steps: 2 | Train Loss: 0.957 Vali Loss: 0.920 Vali Acc: 0.793 Test Loss: 0.920 Test Acc: 0.793
Validation loss decreased (-0.755545 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 0.6802451610565186
Epoch: 11, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.828 Vali Acc: 0.811 Test Loss: 0.828 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 0.6448197364807129
Epoch: 12, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.744 Vali Acc: 0.833 Test Loss: 0.744 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833326).  Saving model ...
Epoch: 13 cost time: 0.6456687450408936
Epoch: 13, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.670 Vali Acc: 0.837 Test Loss: 0.670 Test Acc: 0.837
Validation loss decreased (-0.833326 --> -0.837030).  Saving model ...
Epoch: 14 cost time: 0.56209397315979
Epoch: 14, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.607 Vali Acc: 0.848 Test Loss: 0.607 Test Acc: 0.848
Validation loss decreased (-0.837030 --> -0.848142).  Saving model ...
Epoch: 15 cost time: 0.5858230590820312
Epoch: 15, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.848142 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 0.582697868347168
Epoch: 16, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.503 Vali Acc: 0.885 Test Loss: 0.503 Test Acc: 0.885
Validation loss decreased (-0.855550 --> -0.885180).  Saving model ...
Epoch: 17 cost time: 0.6416239738464355
Epoch: 17, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.461 Vali Acc: 0.896 Test Loss: 0.461 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896292).  Saving model ...
Epoch: 18 cost time: 0.7257661819458008
Epoch: 18, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.422 Vali Acc: 0.900 Test Loss: 0.422 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.5919287204742432
Epoch: 19, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.392 Vali Acc: 0.904 Test Loss: 0.392 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.6603074073791504
Epoch: 20, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.368 Vali Acc: 0.904 Test Loss: 0.368 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 21 cost time: 0.592083215713501
Epoch: 21, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.345 Vali Acc: 0.904 Test Loss: 0.345 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 22 cost time: 0.637516975402832
Epoch: 22, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.6571195125579834
Epoch: 23, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
Validation loss decreased (-0.907404 --> -0.918515).  Saving model ...
Epoch: 24 cost time: 0.618128776550293
Epoch: 24, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.727623701095581
Epoch: 25, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.8593654632568359
Epoch: 26, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6934854984283447
Epoch: 27, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.8917968273162842
Epoch: 28, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.258 Vali Acc: 0.915 Test Loss: 0.258 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6131365299224854
Epoch: 29, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.6089825630187988
Epoch: 30, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.6350462436676025
Epoch: 31, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.7134215831756592
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.645702600479126
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.6636672019958496
Epoch: 34, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.919 Test Loss: 0.237 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6737735271453857
Epoch: 35, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6522500514984131
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.6656577587127686
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.6734955310821533
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.7104508876800537
Epoch: 39, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.7071764469146729
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 41 cost time: 0.624445915222168
Epoch: 41, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 0.7851369380950928
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.757580041885376
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.69822096824646
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6206614971160889
Epoch: 45, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6380829811096191
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 47 cost time: 0.7320890426635742
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 0.6057529449462891
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 0.614065408706665
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.7983455657958984
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.7066516876220703
Epoch: 51, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.6293036937713623
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5998027324676514
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.6723535060882568
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.6992754936218262
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.6820130348205566
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.8058886528015137
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.919 Test Loss: 0.225 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.775202751159668
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.919 Test Loss: 0.225 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 306630
model size : 2.41MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.595858335494995
Epoch: 1, Steps: 2 | Train Loss: 2.328 Vali Loss: 2.032 Vali Acc: 0.178 Test Loss: 2.032 Test Acc: 0.178
Validation loss decreased (inf --> -0.177757).  Saving model ...
Epoch: 2 cost time: 0.5931313037872314
Epoch: 2, Steps: 2 | Train Loss: 2.237 Vali Loss: 1.941 Vali Acc: 0.204 Test Loss: 1.941 Test Acc: 0.204
Validation loss decreased (-0.177757 --> -0.203684).  Saving model ...
Epoch: 3 cost time: 0.6509356498718262
Epoch: 3, Steps: 2 | Train Loss: 2.082 Vali Loss: 1.865 Vali Acc: 0.226 Test Loss: 1.865 Test Acc: 0.226
Validation loss decreased (-0.203684 --> -0.225907).  Saving model ...
Epoch: 4 cost time: 0.6747114658355713
Epoch: 4, Steps: 2 | Train Loss: 2.005 Vali Loss: 1.782 Vali Acc: 0.259 Test Loss: 1.782 Test Acc: 0.259
Validation loss decreased (-0.225907 --> -0.259241).  Saving model ...
Epoch: 5 cost time: 0.6382508277893066
Epoch: 5, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.678 Vali Acc: 0.307 Test Loss: 1.678 Test Acc: 0.307
Validation loss decreased (-0.259241 --> -0.307391).  Saving model ...
Epoch: 6 cost time: 0.6101787090301514
Epoch: 6, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.562 Vali Acc: 0.352 Test Loss: 1.562 Test Acc: 0.352
Validation loss decreased (-0.307391 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 0.6348409652709961
Epoch: 7, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.444 Vali Acc: 0.389 Test Loss: 1.444 Test Acc: 0.389
Validation loss decreased (-0.351836 --> -0.388874).  Saving model ...
Epoch: 8 cost time: 0.6639914512634277
Epoch: 8, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.320 Vali Acc: 0.452 Test Loss: 1.320 Test Acc: 0.452
Validation loss decreased (-0.388874 --> -0.451839).  Saving model ...
Epoch: 9 cost time: 0.6241106986999512
Epoch: 9, Steps: 2 | Train Loss: 1.277 Vali Loss: 1.197 Vali Acc: 0.537 Test Loss: 1.197 Test Acc: 0.537
Validation loss decreased (-0.451839 --> -0.537025).  Saving model ...
Epoch: 10 cost time: 0.7121388912200928
Epoch: 10, Steps: 2 | Train Loss: 1.094 Vali Loss: 1.078 Vali Acc: 0.600 Test Loss: 1.078 Test Acc: 0.600
Validation loss decreased (-0.537025 --> -0.599989).  Saving model ...
Epoch: 11 cost time: 0.6944396495819092
Epoch: 11, Steps: 2 | Train Loss: 1.083 Vali Loss: 0.967 Vali Acc: 0.663 Test Loss: 0.967 Test Acc: 0.663
Validation loss decreased (-0.599989 --> -0.662953).  Saving model ...
Epoch: 12 cost time: 0.646491289138794
Epoch: 12, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.866 Vali Acc: 0.733 Test Loss: 0.866 Test Acc: 0.733
Validation loss decreased (-0.662953 --> -0.733325).  Saving model ...
Epoch: 13 cost time: 0.7503795623779297
Epoch: 13, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.772 Vali Acc: 0.785 Test Loss: 0.772 Test Acc: 0.785
Validation loss decreased (-0.733325 --> -0.785177).  Saving model ...
Epoch: 14 cost time: 0.7052948474884033
Epoch: 14, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.689 Vali Acc: 0.822 Test Loss: 0.689 Test Acc: 0.822
Validation loss decreased (-0.785177 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 0.5816969871520996
Epoch: 15, Steps: 2 | Train Loss: 0.518 Vali Loss: 0.615 Vali Acc: 0.844 Test Loss: 0.615 Test Acc: 0.844
Validation loss decreased (-0.822215 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 0.67989182472229
Epoch: 16, Steps: 2 | Train Loss: 0.468 Vali Loss: 0.553 Vali Acc: 0.867 Test Loss: 0.553 Test Acc: 0.867
Validation loss decreased (-0.844438 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 0.6117222309112549
Epoch: 17, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.502 Vali Acc: 0.878 Test Loss: 0.502 Test Acc: 0.878
Validation loss decreased (-0.866661 --> -0.877773).  Saving model ...
Epoch: 18 cost time: 0.6673400402069092
Epoch: 18, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.456 Vali Acc: 0.885 Test Loss: 0.456 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885181).  Saving model ...
Epoch: 19 cost time: 0.6582441329956055
Epoch: 19, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.417 Vali Acc: 0.889 Test Loss: 0.417 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.6377608776092529
Epoch: 20, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.383 Vali Acc: 0.900 Test Loss: 0.383 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.6264474391937256
Epoch: 21, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.353 Vali Acc: 0.900 Test Loss: 0.353 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.6208827495574951
Epoch: 22, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.329 Vali Acc: 0.900 Test Loss: 0.329 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.6710481643676758
Epoch: 23, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.311 Vali Acc: 0.900 Test Loss: 0.311 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.6191132068634033
Epoch: 24, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.294 Vali Acc: 0.896 Test Loss: 0.294 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6220529079437256
Epoch: 25, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907405).  Saving model ...
Epoch: 26 cost time: 0.6049878597259521
Epoch: 26, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 0.6490304470062256
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 28 cost time: 0.6322276592254639
Epoch: 28, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 29 cost time: 0.6488826274871826
Epoch: 29, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.6095902919769287
Epoch: 30, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 31 cost time: 0.6540193557739258
Epoch: 31, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 32 cost time: 0.5987701416015625
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 33 cost time: 0.6764764785766602
Epoch: 33, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.915 Test Loss: 0.237 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6479709148406982
Epoch: 34, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.235 Vali Acc: 0.915 Test Loss: 0.235 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6259534358978271
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.232 Vali Acc: 0.915 Test Loss: 0.232 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6333599090576172
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.915 Test Loss: 0.231 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6441471576690674
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.7196886539459229
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.6190202236175537
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.6354920864105225
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.223 Vali Acc: 0.919 Test Loss: 0.223 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.6168341636657715
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 0.6832020282745361
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.919 Test Loss: 0.220 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6966490745544434
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.6483078002929688
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.7040033340454102
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.6790375709533691
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6160786151885986
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.7504878044128418
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6573350429534912
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.919 Test Loss: 0.215 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6880650520324707
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 51 cost time: 0.6349241733551025
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 52 cost time: 0.6742939949035645
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 53 cost time: 0.7070374488830566
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 54 cost time: 0.6431689262390137
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 55 cost time: 0.8027787208557129
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.7704920768737793
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 57 cost time: 0.5946528911590576
Epoch: 57, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 58 cost time: 0.593646764755249
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 59 cost time: 0.5565316677093506
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 60 cost time: 0.5994675159454346
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 61 cost time: 0.6363990306854248
Epoch: 61, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 62 cost time: 0.6655652523040771
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6743083000183105
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.6402461528778076
Epoch: 64, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.6186108589172363
Epoch: 65, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6485426425933838
Epoch: 66, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.7063980102539062
Epoch: 67, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 68 cost time: 0.6118712425231934
Epoch: 68, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6785595417022705
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 70 cost time: 0.6340842247009277
Epoch: 70, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 71 cost time: 0.6923708915710449
Epoch: 71, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 72 cost time: 0.5722062587738037
Epoch: 72, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 73 cost time: 0.5426414012908936
Epoch: 73, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 74 cost time: 0.607290506362915
Epoch: 74, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 75 cost time: 0.7040712833404541
Epoch: 75, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 76 cost time: 0.6523027420043945
Epoch: 76, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 77 cost time: 0.6665971279144287
Epoch: 77, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 78 cost time: 0.6680245399475098
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.7765598297119141
Epoch: 79, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 80 cost time: 0.6376993656158447
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.6936874389648438
Epoch: 81, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5971729755401611
Epoch: 82, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 83 cost time: 0.6403529644012451
Epoch: 83, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 84 cost time: 0.5806360244750977
Epoch: 84, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.6551201343536377
Epoch: 85, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.629112958908081
Epoch: 86, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.6773269176483154
Epoch: 87, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.6964423656463623
Epoch: 88, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.6936228275299072
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.6740827560424805
Epoch: 90, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.5245780944824219
Epoch: 91, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.5678532123565674
Epoch: 92, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.589033842086792
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.6420013904571533
Epoch: 94, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 95 cost time: 0.716651201248169
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 0.7371816635131836
Epoch: 96, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 97 cost time: 0.6530427932739258
Epoch: 97, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 98 cost time: 0.7970318794250488
Epoch: 98, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.6399350166320801
Epoch: 99, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.7448329925537109
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 175558
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6633243560791016
Epoch: 1, Steps: 2 | Train Loss: 2.309 Vali Loss: 2.050 Vali Acc: 0.170 Test Loss: 2.050 Test Acc: 0.170
Validation loss decreased (inf --> -0.170350).  Saving model ...
Epoch: 2 cost time: 0.6878857612609863
Epoch: 2, Steps: 2 | Train Loss: 2.211 Vali Loss: 1.957 Vali Acc: 0.196 Test Loss: 1.957 Test Acc: 0.196
Validation loss decreased (-0.170350 --> -0.196277).  Saving model ...
Epoch: 3 cost time: 0.6245291233062744
Epoch: 3, Steps: 2 | Train Loss: 2.081 Vali Loss: 1.880 Vali Acc: 0.233 Test Loss: 1.880 Test Acc: 0.233
Validation loss decreased (-0.196277 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.597963809967041
Epoch: 4, Steps: 2 | Train Loss: 1.967 Vali Loss: 1.796 Vali Acc: 0.267 Test Loss: 1.796 Test Acc: 0.267
Validation loss decreased (-0.233315 --> -0.266649).  Saving model ...
Epoch: 5 cost time: 0.5876176357269287
Epoch: 5, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.692 Vali Acc: 0.300 Test Loss: 1.692 Test Acc: 0.300
Validation loss decreased (-0.266649 --> -0.299983).  Saving model ...
Epoch: 6 cost time: 0.6468429565429688
Epoch: 6, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.576 Vali Acc: 0.326 Test Loss: 1.576 Test Acc: 0.326
Validation loss decreased (-0.299983 --> -0.325910).  Saving model ...
Epoch: 7 cost time: 0.6193985939025879
Epoch: 7, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.457 Vali Acc: 0.378 Test Loss: 1.457 Test Acc: 0.378
Validation loss decreased (-0.325910 --> -0.377763).  Saving model ...
Epoch: 8 cost time: 0.6745152473449707
Epoch: 8, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.333 Vali Acc: 0.444 Test Loss: 1.333 Test Acc: 0.444
Validation loss decreased (-0.377763 --> -0.444431).  Saving model ...
Epoch: 9 cost time: 0.6663305759429932
Epoch: 9, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.209 Vali Acc: 0.515 Test Loss: 1.209 Test Acc: 0.515
Validation loss decreased (-0.444431 --> -0.514803).  Saving model ...
Epoch: 10 cost time: 0.6063377857208252
Epoch: 10, Steps: 2 | Train Loss: 1.047 Vali Loss: 1.089 Vali Acc: 0.563 Test Loss: 1.089 Test Acc: 0.563
Validation loss decreased (-0.514803 --> -0.562952).  Saving model ...
Epoch: 11 cost time: 0.6364471912384033
Epoch: 11, Steps: 2 | Train Loss: 1.069 Vali Loss: 0.977 Vali Acc: 0.648 Test Loss: 0.977 Test Acc: 0.648
Validation loss decreased (-0.562952 --> -0.648138).  Saving model ...
Epoch: 12 cost time: 0.6731293201446533
Epoch: 12, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.875 Vali Acc: 0.711 Test Loss: 0.875 Test Acc: 0.711
Validation loss decreased (-0.648138 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.5937809944152832
Epoch: 13, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.780 Vali Acc: 0.763 Test Loss: 0.780 Test Acc: 0.763
Validation loss decreased (-0.711102 --> -0.762955).  Saving model ...
Epoch: 14 cost time: 0.6841158866882324
Epoch: 14, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.696 Vali Acc: 0.811 Test Loss: 0.696 Test Acc: 0.811
Validation loss decreased (-0.762955 --> -0.811104).  Saving model ...
Epoch: 15 cost time: 0.6136958599090576
Epoch: 15, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.623 Vali Acc: 0.844 Test Loss: 0.623 Test Acc: 0.844
Validation loss decreased (-0.811104 --> -0.844438).  Saving model ...
Epoch: 16 cost time: 0.5968804359436035
Epoch: 16, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.561 Vali Acc: 0.863 Test Loss: 0.561 Test Acc: 0.863
Validation loss decreased (-0.844438 --> -0.862957).  Saving model ...
Epoch: 17 cost time: 0.5888333320617676
Epoch: 17, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.508 Vali Acc: 0.881 Test Loss: 0.508 Test Acc: 0.881
Validation loss decreased (-0.862957 --> -0.881476).  Saving model ...
Epoch: 18 cost time: 0.6560959815979004
Epoch: 18, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.463 Vali Acc: 0.889 Test Loss: 0.463 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 19 cost time: 0.662461519241333
Epoch: 19, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.422 Vali Acc: 0.893 Test Loss: 0.422 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 20 cost time: 0.6304421424865723
Epoch: 20, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.388 Vali Acc: 0.900 Test Loss: 0.388 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.6069583892822266
Epoch: 21, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.357 Vali Acc: 0.907 Test Loss: 0.357 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.5887587070465088
Epoch: 22, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.334 Vali Acc: 0.904 Test Loss: 0.334 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6153838634490967
Epoch: 23, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6532177925109863
Epoch: 24, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.300 Vali Acc: 0.904 Test Loss: 0.300 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7386541366577148
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.289 Vali Acc: 0.907 Test Loss: 0.289 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 26 cost time: 0.6097781658172607
Epoch: 26, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.279 Vali Acc: 0.907 Test Loss: 0.279 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 27 cost time: 0.722367525100708
Epoch: 27, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.269 Vali Acc: 0.911 Test Loss: 0.269 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 28 cost time: 0.6286306381225586
Epoch: 28, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.261 Vali Acc: 0.911 Test Loss: 0.261 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 29 cost time: 0.7601139545440674
Epoch: 29, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 30 cost time: 0.6428847312927246
Epoch: 30, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 31 cost time: 0.7239916324615479
Epoch: 31, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 32 cost time: 0.6838726997375488
Epoch: 32, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.6027445793151855
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.6533732414245605
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.7243435382843018
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 36 cost time: 0.6227986812591553
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 37 cost time: 0.8001537322998047
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 38 cost time: 0.6513040065765381
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.6748113632202148
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.6723825931549072
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.6932456493377686
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.6366729736328125
Epoch: 42, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.6544997692108154
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.6835963726043701
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6844727993011475
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7214727401733398
Epoch: 46, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6730287075042725
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6404328346252441
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.6235079765319824
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 0.5819706916809082
Epoch: 50, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.5988812446594238
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.6467361450195312
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.7209267616271973
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.6746256351470947
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6936430931091309
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6393251419067383
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.6452937126159668
Epoch: 57, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6337859630584717
Epoch: 58, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5826630592346191
Epoch: 59, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6141982078552246
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 61 cost time: 0.6211392879486084
Epoch: 61, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.6771440505981445
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6970961093902588
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 64 cost time: 0.6142325401306152
Epoch: 64, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 65 cost time: 0.621448278427124
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 66 cost time: 0.816525936126709
Epoch: 66, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 67 cost time: 0.6323308944702148
Epoch: 67, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 68 cost time: 0.6440203189849854
Epoch: 68, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 69 cost time: 0.6792147159576416
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 70 cost time: 0.6009275913238525
Epoch: 70, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 71 cost time: 0.6728100776672363
Epoch: 71, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 72 cost time: 0.6446173191070557
Epoch: 72, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 73 cost time: 0.6287319660186768
Epoch: 73, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 74 cost time: 0.8237009048461914
Epoch: 74, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 75 cost time: 0.7064480781555176
Epoch: 75, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.6159322261810303
Epoch: 76, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 77 cost time: 0.7109107971191406
Epoch: 77, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 78 cost time: 0.6684703826904297
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 79 cost time: 0.6524713039398193
Epoch: 79, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 80 cost time: 0.6853594779968262
Epoch: 80, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 81 cost time: 0.6824259757995605
Epoch: 81, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 82 cost time: 0.7781190872192383
Epoch: 82, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 83 cost time: 0.6012783050537109
Epoch: 83, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 84 cost time: 0.6589901447296143
Epoch: 84, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 85 cost time: 0.5426895618438721
Epoch: 85, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 86 cost time: 0.6546204090118408
Epoch: 86, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 87 cost time: 0.6356947422027588
Epoch: 87, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 88 cost time: 0.6232819557189941
Epoch: 88, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 89 cost time: 0.6919608116149902
Epoch: 89, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 90 cost time: 0.6716494560241699
Epoch: 90, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.668670654296875
Epoch: 91, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.7927484512329102
Epoch: 92, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.6284685134887695
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 0.6966457366943359
Epoch: 94, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 95 cost time: 0.6978015899658203
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 96 cost time: 0.6950569152832031
Epoch: 96, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 97 cost time: 0.713151216506958
Epoch: 97, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 98 cost time: 0.6885240077972412
Epoch: 98, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.637152910232544
Epoch: 99, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.666581392288208
Epoch: 100, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 175558
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4971659183502197
Epoch: 1, Steps: 2 | Train Loss: 2.260 Vali Loss: 2.026 Vali Acc: 0.167 Test Loss: 2.026 Test Acc: 0.167
Validation loss decreased (inf --> -0.166646).  Saving model ...
Epoch: 2 cost time: 0.6845896244049072
Epoch: 2, Steps: 2 | Train Loss: 2.172 Vali Loss: 1.935 Vali Acc: 0.211 Test Loss: 1.935 Test Acc: 0.211
Validation loss decreased (-0.166646 --> -0.211092).  Saving model ...
Epoch: 3 cost time: 0.6660711765289307
Epoch: 3, Steps: 2 | Train Loss: 2.009 Vali Loss: 1.858 Vali Acc: 0.230 Test Loss: 1.858 Test Acc: 0.230
Validation loss decreased (-0.211092 --> -0.229611).  Saving model ...
Epoch: 4 cost time: 0.5936977863311768
Epoch: 4, Steps: 2 | Train Loss: 1.945 Vali Loss: 1.776 Vali Acc: 0.259 Test Loss: 1.776 Test Acc: 0.259
Validation loss decreased (-0.229611 --> -0.259242).  Saving model ...
Epoch: 5 cost time: 0.6257343292236328
Epoch: 5, Steps: 2 | Train Loss: 1.912 Vali Loss: 1.673 Vali Acc: 0.293 Test Loss: 1.673 Test Acc: 0.293
Validation loss decreased (-0.259242 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.6387860774993896
Epoch: 6, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.558 Vali Acc: 0.330 Test Loss: 1.558 Test Acc: 0.330
Validation loss decreased (-0.292576 --> -0.329614).  Saving model ...
Epoch: 7 cost time: 0.7364051342010498
Epoch: 7, Steps: 2 | Train Loss: 1.565 Vali Loss: 1.440 Vali Acc: 0.374 Test Loss: 1.440 Test Acc: 0.374
Validation loss decreased (-0.329614 --> -0.374060).  Saving model ...
Epoch: 8 cost time: 0.6919553279876709
Epoch: 8, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.317 Vali Acc: 0.448 Test Loss: 1.317 Test Acc: 0.448
Validation loss decreased (-0.374060 --> -0.448135).  Saving model ...
Epoch: 9 cost time: 0.6958105564117432
Epoch: 9, Steps: 2 | Train Loss: 1.236 Vali Loss: 1.195 Vali Acc: 0.511 Test Loss: 1.195 Test Acc: 0.511
Validation loss decreased (-0.448135 --> -0.511099).  Saving model ...
Epoch: 10 cost time: 0.7012319564819336
Epoch: 10, Steps: 2 | Train Loss: 1.064 Vali Loss: 1.075 Vali Acc: 0.552 Test Loss: 1.075 Test Acc: 0.552
Validation loss decreased (-0.511099 --> -0.551841).  Saving model ...
Epoch: 11 cost time: 0.712104320526123
Epoch: 11, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.962 Vali Acc: 0.659 Test Loss: 0.962 Test Acc: 0.659
Validation loss decreased (-0.551841 --> -0.659250).  Saving model ...
Epoch: 12 cost time: 0.6803593635559082
Epoch: 12, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.860 Vali Acc: 0.737 Test Loss: 0.860 Test Acc: 0.737
Validation loss decreased (-0.659250 --> -0.737028).  Saving model ...
Epoch: 13 cost time: 0.7075550556182861
Epoch: 13, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.766 Vali Acc: 0.793 Test Loss: 0.766 Test Acc: 0.793
Validation loss decreased (-0.737028 --> -0.792585).  Saving model ...
Epoch: 14 cost time: 0.7883172035217285
Epoch: 14, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.685 Vali Acc: 0.826 Test Loss: 0.685 Test Acc: 0.826
Validation loss decreased (-0.792585 --> -0.825919).  Saving model ...
Epoch: 15 cost time: 0.641049861907959
Epoch: 15, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.612 Vali Acc: 0.863 Test Loss: 0.612 Test Acc: 0.863
Validation loss decreased (-0.825919 --> -0.862957).  Saving model ...
Epoch: 16 cost time: 0.6960115432739258
Epoch: 16, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.551 Vali Acc: 0.874 Test Loss: 0.551 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874069).  Saving model ...
Epoch: 17 cost time: 0.6409885883331299
Epoch: 17, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.499 Vali Acc: 0.896 Test Loss: 0.499 Test Acc: 0.896
Validation loss decreased (-0.874069 --> -0.896291).  Saving model ...
Epoch: 18 cost time: 0.7995326519012451
Epoch: 18, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.454 Vali Acc: 0.900 Test Loss: 0.454 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 19 cost time: 0.7505536079406738
Epoch: 19, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.415 Vali Acc: 0.915 Test Loss: 0.415 Test Acc: 0.915
Validation loss decreased (-0.899995 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.7891895771026611
Epoch: 20, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 21 cost time: 0.7780804634094238
Epoch: 21, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.352 Vali Acc: 0.919 Test Loss: 0.352 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 22 cost time: 0.6627223491668701
Epoch: 22, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.328 Vali Acc: 0.907 Test Loss: 0.328 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.7209370136260986
Epoch: 23, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.309 Vali Acc: 0.915 Test Loss: 0.309 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.722008228302002
Epoch: 24, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.293 Vali Acc: 0.911 Test Loss: 0.293 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7191600799560547
Epoch: 25, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.282 Vali Acc: 0.915 Test Loss: 0.282 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.676567554473877
Epoch: 26, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6596510410308838
Epoch: 27, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.7092809677124023
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.6150927543640137
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.648923397064209
Epoch: 30, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.6790499687194824
Epoch: 31, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.6543123722076416
Epoch: 32, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.6981503963470459
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.679358720779419
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.7783935070037842
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 36 cost time: 0.7170512676239014
Epoch: 36, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.228 Vali Acc: 0.922 Test Loss: 0.228 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 37 cost time: 0.6868557929992676
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 0.780346155166626
Epoch: 38, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 39 cost time: 0.6867282390594482
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 40 cost time: 0.724200963973999
Epoch: 40, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.223 Vali Acc: 0.919 Test Loss: 0.223 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.704134464263916
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 0.8221335411071777
Epoch: 42, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.7893044948577881
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.8608386516571045
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.6817111968994141
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.7511355876922607
Epoch: 46, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.6867845058441162
Epoch: 47, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.6695828437805176
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.7170722484588623
Epoch: 49, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.6630978584289551
Epoch: 50, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.6256155967712402
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.6181581020355225
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.6238856315612793
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 175558
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.668388843536377
Epoch: 1, Steps: 2 | Train Loss: 2.156 Vali Loss: 1.970 Vali Acc: 0.178 Test Loss: 1.970 Test Acc: 0.178
Validation loss decreased (inf --> -0.177758).  Saving model ...
Epoch: 2 cost time: 0.742262601852417
Epoch: 2, Steps: 2 | Train Loss: 2.139 Vali Loss: 1.888 Vali Acc: 0.211 Test Loss: 1.888 Test Acc: 0.211
Validation loss decreased (-0.177758 --> -0.211092).  Saving model ...
Epoch: 3 cost time: 0.7585577964782715
Epoch: 3, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.818 Vali Acc: 0.237 Test Loss: 1.818 Test Acc: 0.237
Validation loss decreased (-0.211092 --> -0.237019).  Saving model ...
Epoch: 4 cost time: 0.7363259792327881
Epoch: 4, Steps: 2 | Train Loss: 1.884 Vali Loss: 1.742 Vali Acc: 0.285 Test Loss: 1.742 Test Acc: 0.285
Validation loss decreased (-0.237019 --> -0.285168).  Saving model ...
Epoch: 5 cost time: 0.7051498889923096
Epoch: 5, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.649 Vali Acc: 0.322 Test Loss: 1.649 Test Acc: 0.322
Validation loss decreased (-0.285168 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 0.7205731868743896
Epoch: 6, Steps: 2 | Train Loss: 1.723 Vali Loss: 1.543 Vali Acc: 0.367 Test Loss: 1.543 Test Acc: 0.367
Validation loss decreased (-0.322206 --> -0.366651).  Saving model ...
Epoch: 7 cost time: 0.6655809879302979
Epoch: 7, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.435 Vali Acc: 0.400 Test Loss: 1.435 Test Acc: 0.400
Validation loss decreased (-0.366651 --> -0.399986).  Saving model ...
Epoch: 8 cost time: 0.6902539730072021
Epoch: 8, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.321 Vali Acc: 0.430 Test Loss: 1.321 Test Acc: 0.430
Validation loss decreased (-0.399986 --> -0.429616).  Saving model ...
Epoch: 9 cost time: 0.6512665748596191
Epoch: 9, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.206 Vali Acc: 0.496 Test Loss: 1.206 Test Acc: 0.496
Validation loss decreased (-0.429616 --> -0.496284).  Saving model ...
Epoch: 10 cost time: 0.6362981796264648
Epoch: 10, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.094 Vali Acc: 0.548 Test Loss: 1.094 Test Acc: 0.548
Validation loss decreased (-0.496284 --> -0.548137).  Saving model ...
Epoch: 11 cost time: 0.6679704189300537
Epoch: 11, Steps: 2 | Train Loss: 1.043 Vali Loss: 0.989 Vali Acc: 0.615 Test Loss: 0.989 Test Acc: 0.615
Validation loss decreased (-0.548137 --> -0.614805).  Saving model ...
Epoch: 12 cost time: 0.6397514343261719
Epoch: 12, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.893 Vali Acc: 0.711 Test Loss: 0.893 Test Acc: 0.711
Validation loss decreased (-0.614805 --> -0.711102).  Saving model ...
Epoch: 13 cost time: 0.7080645561218262
Epoch: 13, Steps: 2 | Train Loss: 0.781 Vali Loss: 0.802 Vali Acc: 0.763 Test Loss: 0.802 Test Acc: 0.763
Validation loss decreased (-0.711102 --> -0.762955).  Saving model ...
Epoch: 14 cost time: 0.6625411510467529
Epoch: 14, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.724 Vali Acc: 0.793 Test Loss: 0.724 Test Acc: 0.793
Validation loss decreased (-0.762955 --> -0.792585).  Saving model ...
Epoch: 15 cost time: 0.648428201675415
Epoch: 15, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.654 Vali Acc: 0.822 Test Loss: 0.654 Test Acc: 0.822
Validation loss decreased (-0.792585 --> -0.822216).  Saving model ...
Epoch: 16 cost time: 0.7614200115203857
Epoch: 16, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.595 Vali Acc: 0.841 Test Loss: 0.595 Test Acc: 0.841
Validation loss decreased (-0.822216 --> -0.840735).  Saving model ...
Epoch: 17 cost time: 0.6269760131835938
Epoch: 17, Steps: 2 | Train Loss: 0.384 Vali Loss: 0.545 Vali Acc: 0.863 Test Loss: 0.545 Test Acc: 0.863
Validation loss decreased (-0.840735 --> -0.862958).  Saving model ...
Epoch: 18 cost time: 0.6558613777160645
Epoch: 18, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.500 Vali Acc: 0.867 Test Loss: 0.500 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 19 cost time: 0.6591854095458984
Epoch: 19, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.462 Vali Acc: 0.889 Test Loss: 0.462 Test Acc: 0.889
Validation loss decreased (-0.866662 --> -0.888884).  Saving model ...
Epoch: 20 cost time: 0.6498241424560547
Epoch: 20, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.428 Vali Acc: 0.881 Test Loss: 0.428 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6815354824066162
Epoch: 21, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.398 Vali Acc: 0.881 Test Loss: 0.398 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5973286628723145
Epoch: 22, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.375 Vali Acc: 0.885 Test Loss: 0.375 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.622948408126831
Epoch: 23, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.354 Vali Acc: 0.889 Test Loss: 0.354 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888885).  Saving model ...
Epoch: 24 cost time: 0.6737565994262695
Epoch: 24, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.338 Vali Acc: 0.885 Test Loss: 0.338 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6480438709259033
Epoch: 25, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.325 Vali Acc: 0.893 Test Loss: 0.325 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 26 cost time: 0.6803784370422363
Epoch: 26, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.6872823238372803
Epoch: 27, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.6361865997314453
Epoch: 28, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.294 Vali Acc: 0.885 Test Loss: 0.294 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.6494274139404297
Epoch: 29, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.287 Vali Acc: 0.889 Test Loss: 0.287 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.6678893566131592
Epoch: 30, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.280 Vali Acc: 0.893 Test Loss: 0.280 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892590).  Saving model ...
Epoch: 31 cost time: 0.6656749248504639
Epoch: 31, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.275 Vali Acc: 0.896 Test Loss: 0.275 Test Acc: 0.896
Validation loss decreased (-0.892590 --> -0.896294).  Saving model ...
Epoch: 32 cost time: 0.6602580547332764
Epoch: 32, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.271 Vali Acc: 0.900 Test Loss: 0.271 Test Acc: 0.900
Validation loss decreased (-0.896294 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.7059686183929443
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.267 Vali Acc: 0.904 Test Loss: 0.267 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 34 cost time: 0.685060977935791
Epoch: 34, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.264 Vali Acc: 0.904 Test Loss: 0.264 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 35 cost time: 0.6708865165710449
Epoch: 35, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.261 Vali Acc: 0.907 Test Loss: 0.261 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 36 cost time: 0.696558952331543
Epoch: 36, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.259 Vali Acc: 0.907 Test Loss: 0.259 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 37 cost time: 0.783658504486084
Epoch: 37, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 38 cost time: 0.697735071182251
Epoch: 38, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 39 cost time: 0.617804765701294
Epoch: 39, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 40 cost time: 0.6845004558563232
Epoch: 40, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914812).  Saving model ...
Epoch: 41 cost time: 0.6515731811523438
Epoch: 41, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.6796431541442871
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.6862256526947021
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.7006769180297852
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.661931037902832
Epoch: 45, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.248 Vali Acc: 0.911 Test Loss: 0.248 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.6022982597351074
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.247 Vali Acc: 0.907 Test Loss: 0.247 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.6982202529907227
Epoch: 47, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.907 Test Loss: 0.247 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.6842825412750244
Epoch: 48, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.247 Vali Acc: 0.907 Test Loss: 0.247 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.6581318378448486
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.246 Vali Acc: 0.907 Test Loss: 0.246 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.6883783340454102
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.246 Vali Acc: 0.907 Test Loss: 0.246 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 175558
model size : 1.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.617967367172241
Epoch: 1, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.667 Vali Acc: 0.311 Test Loss: 1.667 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.650223970413208
Epoch: 2, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.586 Vali Acc: 0.396 Test Loss: 1.586 Test Acc: 0.396
Validation loss decreased (-0.311094 --> -0.396280).  Saving model ...
Epoch: 3 cost time: 0.6731948852539062
Epoch: 3, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.520 Vali Acc: 0.452 Test Loss: 1.520 Test Acc: 0.452
Validation loss decreased (-0.396280 --> -0.451837).  Saving model ...
Epoch: 4 cost time: 0.6865584850311279
Epoch: 4, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.448 Vali Acc: 0.537 Test Loss: 1.448 Test Acc: 0.537
Validation loss decreased (-0.451837 --> -0.537023).  Saving model ...
Epoch: 5 cost time: 0.7107303142547607
Epoch: 5, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.358 Vali Acc: 0.593 Test Loss: 1.358 Test Acc: 0.593
Validation loss decreased (-0.537023 --> -0.592579).  Saving model ...
Epoch: 6 cost time: 0.7101678848266602
Epoch: 6, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.258 Vali Acc: 0.630 Test Loss: 1.258 Test Acc: 0.630
Validation loss decreased (-0.592579 --> -0.629617).  Saving model ...
Epoch: 7 cost time: 0.6958177089691162
Epoch: 7, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.153 Vali Acc: 0.719 Test Loss: 1.153 Test Acc: 0.719
Validation loss decreased (-0.629617 --> -0.718507).  Saving model ...
Epoch: 8 cost time: 0.6820359230041504
Epoch: 8, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.048 Vali Acc: 0.767 Test Loss: 1.048 Test Acc: 0.767
Validation loss decreased (-0.718507 --> -0.766656).  Saving model ...
Epoch: 9 cost time: 0.6831362247467041
Epoch: 9, Steps: 2 | Train Loss: 0.935 Vali Loss: 0.945 Vali Acc: 0.811 Test Loss: 0.945 Test Acc: 0.811
Validation loss decreased (-0.766656 --> -0.811102).  Saving model ...
Epoch: 10 cost time: 0.6830935478210449
Epoch: 10, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.849 Vali Acc: 0.848 Test Loss: 0.849 Test Acc: 0.848
Validation loss decreased (-0.811102 --> -0.848140).  Saving model ...
Epoch: 11 cost time: 0.792722225189209
Epoch: 11, Steps: 2 | Train Loss: 0.740 Vali Loss: 0.759 Vali Acc: 0.870 Test Loss: 0.759 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 12 cost time: 0.8242678642272949
Epoch: 12, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.679 Vali Acc: 0.893 Test Loss: 0.679 Test Acc: 0.893
Validation loss decreased (-0.870363 --> -0.892586).  Saving model ...
Epoch: 13 cost time: 0.7521090507507324
Epoch: 13, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.606 Vali Acc: 0.911 Test Loss: 0.606 Test Acc: 0.911
Validation loss decreased (-0.892586 --> -0.911105).  Saving model ...
Epoch: 14 cost time: 0.7501585483551025
Epoch: 14, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.542 Vali Acc: 0.926 Test Loss: 0.542 Test Acc: 0.926
Validation loss decreased (-0.911105 --> -0.925921).  Saving model ...
Epoch: 15 cost time: 0.6826508045196533
Epoch: 15, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.484 Vali Acc: 0.941 Test Loss: 0.484 Test Acc: 0.941
Validation loss decreased (-0.925921 --> -0.940736).  Saving model ...
Epoch: 16 cost time: 0.7542600631713867
Epoch: 16, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.436 Vali Acc: 0.948 Test Loss: 0.436 Test Acc: 0.948
Validation loss decreased (-0.940736 --> -0.948144).  Saving model ...
Epoch: 17 cost time: 0.6085190773010254
Epoch: 17, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.396 Vali Acc: 0.944 Test Loss: 0.396 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6593279838562012
Epoch: 18, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.362 Vali Acc: 0.937 Test Loss: 0.362 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.6922757625579834
Epoch: 19, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.335 Vali Acc: 0.941 Test Loss: 0.335 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.718374490737915
Epoch: 20, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.311 Vali Acc: 0.941 Test Loss: 0.311 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.995593786239624
Epoch: 21, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.707991361618042
Epoch: 22, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.276 Vali Acc: 0.944 Test Loss: 0.276 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.7015788555145264
Epoch: 23, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.263 Vali Acc: 0.944 Test Loss: 0.263 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.7105593681335449
Epoch: 24, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.6777794361114502
Epoch: 25, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.7134575843811035
Epoch: 26, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 110022
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6378676891326904
Epoch: 1, Steps: 2 | Train Loss: 1.812 Vali Loss: 1.658 Vali Acc: 0.352 Test Loss: 1.658 Test Acc: 0.352
Validation loss decreased (inf --> -0.351835).  Saving model ...
Epoch: 2 cost time: 0.7039196491241455
Epoch: 2, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.577 Vali Acc: 0.415 Test Loss: 1.577 Test Acc: 0.415
Validation loss decreased (-0.351835 --> -0.414799).  Saving model ...
Epoch: 3 cost time: 0.7098660469055176
Epoch: 3, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.511 Vali Acc: 0.433 Test Loss: 1.511 Test Acc: 0.433
Validation loss decreased (-0.414799 --> -0.433318).  Saving model ...
Epoch: 4 cost time: 0.672278642654419
Epoch: 4, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.438 Vali Acc: 0.496 Test Loss: 1.438 Test Acc: 0.496
Validation loss decreased (-0.433318 --> -0.496282).  Saving model ...
Epoch: 5 cost time: 0.7365467548370361
Epoch: 5, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.349 Vali Acc: 0.574 Test Loss: 1.349 Test Acc: 0.574
Validation loss decreased (-0.496282 --> -0.574061).  Saving model ...
Epoch: 6 cost time: 0.6813814640045166
Epoch: 6, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.249 Vali Acc: 0.633 Test Loss: 1.249 Test Acc: 0.633
Validation loss decreased (-0.574061 --> -0.633321).  Saving model ...
Epoch: 7 cost time: 0.6488654613494873
Epoch: 7, Steps: 2 | Train Loss: 1.210 Vali Loss: 1.144 Vali Acc: 0.711 Test Loss: 1.144 Test Acc: 0.711
Validation loss decreased (-0.633321 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 0.6729311943054199
Epoch: 8, Steps: 2 | Train Loss: 1.073 Vali Loss: 1.039 Vali Acc: 0.778 Test Loss: 1.039 Test Acc: 0.778
Validation loss decreased (-0.711100 --> -0.777767).  Saving model ...
Epoch: 9 cost time: 0.685309648513794
Epoch: 9, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.936 Vali Acc: 0.826 Test Loss: 0.936 Test Acc: 0.826
Validation loss decreased (-0.777767 --> -0.825917).  Saving model ...
Epoch: 10 cost time: 0.6243076324462891
Epoch: 10, Steps: 2 | Train Loss: 0.827 Vali Loss: 0.838 Vali Acc: 0.848 Test Loss: 0.838 Test Acc: 0.848
Validation loss decreased (-0.825917 --> -0.848140).  Saving model ...
Epoch: 11 cost time: 0.6807522773742676
Epoch: 11, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.748 Vali Acc: 0.874 Test Loss: 0.748 Test Acc: 0.874
Validation loss decreased (-0.848140 --> -0.874067).  Saving model ...
Epoch: 12 cost time: 0.6906836032867432
Epoch: 12, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.667 Vali Acc: 0.889 Test Loss: 0.667 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888882).  Saving model ...
Epoch: 13 cost time: 0.7181994915008545
Epoch: 13, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.595 Vali Acc: 0.907 Test Loss: 0.595 Test Acc: 0.907
Validation loss decreased (-0.888882 --> -0.907401).  Saving model ...
Epoch: 14 cost time: 0.7213013172149658
Epoch: 14, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.531 Vali Acc: 0.922 Test Loss: 0.531 Test Acc: 0.922
Validation loss decreased (-0.907401 --> -0.922217).  Saving model ...
Epoch: 15 cost time: 0.7425768375396729
Epoch: 15, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.474 Vali Acc: 0.930 Test Loss: 0.474 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 16 cost time: 0.6716105937957764
Epoch: 16, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.426 Vali Acc: 0.941 Test Loss: 0.426 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940736).  Saving model ...
Epoch: 17 cost time: 0.7216391563415527
Epoch: 17, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.385 Vali Acc: 0.944 Test Loss: 0.385 Test Acc: 0.944
Validation loss decreased (-0.940736 --> -0.944441).  Saving model ...
Epoch: 18 cost time: 0.5951910018920898
Epoch: 18, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.352 Vali Acc: 0.941 Test Loss: 0.352 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.6920120716094971
Epoch: 19, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.325 Vali Acc: 0.944 Test Loss: 0.325 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 20 cost time: 0.6985921859741211
Epoch: 20, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.302 Vali Acc: 0.944 Test Loss: 0.302 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 21 cost time: 0.7301442623138428
Epoch: 21, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.7911219596862793
Epoch: 22, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.266 Vali Acc: 0.944 Test Loss: 0.266 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 23 cost time: 0.8278300762176514
Epoch: 23, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.253 Vali Acc: 0.948 Test Loss: 0.253 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 24 cost time: 0.7371041774749756
Epoch: 24, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 25 cost time: 0.7310190200805664
Epoch: 25, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6879494190216064
Epoch: 26, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.7491450309753418
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.729198694229126
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.7368893623352051
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 30 cost time: 0.7017488479614258
Epoch: 30, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.210 Vali Acc: 0.952 Test Loss: 0.210 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 31 cost time: 0.7521319389343262
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 32 cost time: 0.722804069519043
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6873998641967773
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.7784085273742676
Epoch: 34, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.8612067699432373
Epoch: 35, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.8479461669921875
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.7647175788879395
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.6749505996704102
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.7586941719055176
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6626965999603271
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.6698174476623535
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 110022
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5883052349090576
Epoch: 1, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.671 Vali Acc: 0.330 Test Loss: 1.671 Test Acc: 0.330
Validation loss decreased (inf --> -0.329613).  Saving model ...
Epoch: 2 cost time: 0.7352809906005859
Epoch: 2, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.589 Vali Acc: 0.381 Test Loss: 1.589 Test Acc: 0.381
Validation loss decreased (-0.329613 --> -0.381466).  Saving model ...
Epoch: 3 cost time: 0.7446544170379639
Epoch: 3, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.522 Vali Acc: 0.426 Test Loss: 1.522 Test Acc: 0.426
Validation loss decreased (-0.381466 --> -0.425911).  Saving model ...
Epoch: 4 cost time: 0.8437857627868652
Epoch: 4, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.449 Vali Acc: 0.470 Test Loss: 1.449 Test Acc: 0.470
Validation loss decreased (-0.425911 --> -0.470356).  Saving model ...
Epoch: 5 cost time: 0.6778848171234131
Epoch: 5, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.359 Vali Acc: 0.541 Test Loss: 1.359 Test Acc: 0.541
Validation loss decreased (-0.470356 --> -0.540727).  Saving model ...
Epoch: 6 cost time: 0.7012939453125
Epoch: 6, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.259 Vali Acc: 0.652 Test Loss: 1.259 Test Acc: 0.652
Validation loss decreased (-0.540727 --> -0.651839).  Saving model ...
Epoch: 7 cost time: 0.6617660522460938
Epoch: 7, Steps: 2 | Train Loss: 1.228 Vali Loss: 1.155 Vali Acc: 0.711 Test Loss: 1.155 Test Acc: 0.711
Validation loss decreased (-0.651839 --> -0.711100).  Saving model ...
Epoch: 8 cost time: 0.7178905010223389
Epoch: 8, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.048 Vali Acc: 0.763 Test Loss: 1.048 Test Acc: 0.763
Validation loss decreased (-0.711100 --> -0.762952).  Saving model ...
Epoch: 9 cost time: 0.6502285003662109
Epoch: 9, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.945 Vali Acc: 0.807 Test Loss: 0.945 Test Acc: 0.807
Validation loss decreased (-0.762952 --> -0.807398).  Saving model ...
Epoch: 10 cost time: 0.6725494861602783
Epoch: 10, Steps: 2 | Train Loss: 0.834 Vali Loss: 0.848 Vali Acc: 0.848 Test Loss: 0.848 Test Acc: 0.848
Validation loss decreased (-0.807398 --> -0.848140).  Saving model ...
Epoch: 11 cost time: 0.6712226867675781
Epoch: 11, Steps: 2 | Train Loss: 0.756 Vali Loss: 0.757 Vali Acc: 0.863 Test Loss: 0.757 Test Acc: 0.863
Validation loss decreased (-0.848140 --> -0.862955).  Saving model ...
Epoch: 12 cost time: 0.7633981704711914
Epoch: 12, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.676 Vali Acc: 0.874 Test Loss: 0.676 Test Acc: 0.874
Validation loss decreased (-0.862955 --> -0.874067).  Saving model ...
Epoch: 13 cost time: 0.7146773338317871
Epoch: 13, Steps: 2 | Train Loss: 0.501 Vali Loss: 0.603 Vali Acc: 0.896 Test Loss: 0.603 Test Acc: 0.896
Validation loss decreased (-0.874067 --> -0.896290).  Saving model ...
Epoch: 14 cost time: 0.7641787528991699
Epoch: 14, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.540 Vali Acc: 0.919 Test Loss: 0.540 Test Acc: 0.919
Validation loss decreased (-0.896290 --> -0.918513).  Saving model ...
Epoch: 15 cost time: 0.68955397605896
Epoch: 15, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.483 Vali Acc: 0.933 Test Loss: 0.483 Test Acc: 0.933
Validation loss decreased (-0.918513 --> -0.933329).  Saving model ...
Epoch: 16 cost time: 0.6176559925079346
Epoch: 16, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.435 Vali Acc: 0.937 Test Loss: 0.435 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 17 cost time: 0.6181554794311523
Epoch: 17, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.393 Vali Acc: 0.941 Test Loss: 0.393 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 18 cost time: 0.6455628871917725
Epoch: 18, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.360 Vali Acc: 0.948 Test Loss: 0.360 Test Acc: 0.948
Validation loss decreased (-0.940737 --> -0.948145).  Saving model ...
Epoch: 19 cost time: 0.6393606662750244
Epoch: 19, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.333 Vali Acc: 0.948 Test Loss: 0.333 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 20 cost time: 0.7081151008605957
Epoch: 20, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.310 Vali Acc: 0.948 Test Loss: 0.310 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 21 cost time: 0.7103700637817383
Epoch: 21, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6481530666351318
Epoch: 22, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.274 Vali Acc: 0.941 Test Loss: 0.274 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.63474440574646
Epoch: 23, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5592069625854492
Epoch: 24, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.6595973968505859
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7305333614349365
Epoch: 26, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7011489868164062
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.7430424690246582
Epoch: 28, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.6737818717956543
Epoch: 29, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7035510540008545
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 110022
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.549560070037842
Epoch: 1, Steps: 2 | Train Loss: 1.762 Vali Loss: 1.669 Vali Acc: 0.344 Test Loss: 1.669 Test Acc: 0.344
Validation loss decreased (inf --> -0.344428).  Saving model ...
Epoch: 2 cost time: 0.7807283401489258
Epoch: 2, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.592 Vali Acc: 0.396 Test Loss: 1.592 Test Acc: 0.396
Validation loss decreased (-0.344428 --> -0.396280).  Saving model ...
Epoch: 3 cost time: 0.7390532493591309
Epoch: 3, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.529 Vali Acc: 0.437 Test Loss: 1.529 Test Acc: 0.437
Validation loss decreased (-0.396280 --> -0.437022).  Saving model ...
Epoch: 4 cost time: 0.6839723587036133
Epoch: 4, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.460 Vali Acc: 0.456 Test Loss: 1.460 Test Acc: 0.456
Validation loss decreased (-0.437022 --> -0.455541).  Saving model ...
Epoch: 5 cost time: 0.6710066795349121
Epoch: 5, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.374 Vali Acc: 0.537 Test Loss: 1.374 Test Acc: 0.537
Validation loss decreased (-0.455541 --> -0.537023).  Saving model ...
Epoch: 6 cost time: 0.7543702125549316
Epoch: 6, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.278 Vali Acc: 0.600 Test Loss: 1.278 Test Acc: 0.600
Validation loss decreased (-0.537023 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.7431786060333252
Epoch: 7, Steps: 2 | Train Loss: 1.231 Vali Loss: 1.178 Vali Acc: 0.693 Test Loss: 1.178 Test Acc: 0.693
Validation loss decreased (-0.599987 --> -0.692581).  Saving model ...
Epoch: 8 cost time: 0.6891984939575195
Epoch: 8, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.077 Vali Acc: 0.733 Test Loss: 1.077 Test Acc: 0.733
Validation loss decreased (-0.692581 --> -0.733323).  Saving model ...
Epoch: 9 cost time: 0.6553025245666504
Epoch: 9, Steps: 2 | Train Loss: 0.997 Vali Loss: 0.979 Vali Acc: 0.770 Test Loss: 0.979 Test Acc: 0.770
Validation loss decreased (-0.733323 --> -0.770361).  Saving model ...
Epoch: 10 cost time: 0.692549467086792
Epoch: 10, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.885 Vali Acc: 0.793 Test Loss: 0.885 Test Acc: 0.793
Validation loss decreased (-0.770361 --> -0.792584).  Saving model ...
Epoch: 11 cost time: 0.6508402824401855
Epoch: 11, Steps: 2 | Train Loss: 0.770 Vali Loss: 0.798 Vali Acc: 0.815 Test Loss: 0.798 Test Acc: 0.815
Validation loss decreased (-0.792584 --> -0.814807).  Saving model ...
Epoch: 12 cost time: 0.8392629623413086
Epoch: 12, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
Validation loss decreased (-0.814807 --> -0.840734).  Saving model ...
Epoch: 13 cost time: 0.775723934173584
Epoch: 13, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.650 Vali Acc: 0.863 Test Loss: 0.650 Test Acc: 0.863
Validation loss decreased (-0.840734 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 0.7315413951873779
Epoch: 14, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.589 Vali Acc: 0.874 Test Loss: 0.589 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 15 cost time: 0.6577334403991699
Epoch: 15, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.533 Vali Acc: 0.896 Test Loss: 0.533 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.7373476028442383
Epoch: 16, Steps: 2 | Train Loss: 0.351 Vali Loss: 0.486 Vali Acc: 0.900 Test Loss: 0.486 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.6754496097564697
Epoch: 17, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.444 Vali Acc: 0.911 Test Loss: 0.444 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 18 cost time: 0.6848056316375732
Epoch: 18, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.410 Vali Acc: 0.915 Test Loss: 0.410 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.6227209568023682
Epoch: 19, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.381 Vali Acc: 0.926 Test Loss: 0.381 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925922).  Saving model ...
Epoch: 20 cost time: 0.6281156539916992
Epoch: 20, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.357 Vali Acc: 0.930 Test Loss: 0.357 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 21 cost time: 0.8195888996124268
Epoch: 21, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.336 Vali Acc: 0.922 Test Loss: 0.336 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7305705547332764
Epoch: 22, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.319 Vali Acc: 0.919 Test Loss: 0.319 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.719491720199585
Epoch: 23, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.8703501224517822
Epoch: 24, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.7162425518035889
Epoch: 25, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.7132167816162109
Epoch: 26, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.7956023216247559
Epoch: 27, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.6733307838439941
Epoch: 28, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.7697792053222656
Epoch: 29, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.7754411697387695
Epoch: 30, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.249 Vali Acc: 0.915 Test Loss: 0.249 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 110022
model size : 1.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.754535675048828
Epoch: 1, Steps: 2 | Train Loss: 2.057 Vali Loss: 1.932 Vali Acc: 0.181 Test Loss: 1.932 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.650071382522583
Epoch: 2, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.836 Vali Acc: 0.215 Test Loss: 1.836 Test Acc: 0.215
Validation loss decreased (-0.181462 --> -0.214796).  Saving model ...
Epoch: 3 cost time: 0.6706142425537109
Epoch: 3, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.760 Vali Acc: 0.233 Test Loss: 1.760 Test Acc: 0.233
Validation loss decreased (-0.214796 --> -0.233316).  Saving model ...
Epoch: 4 cost time: 0.6648008823394775
Epoch: 4, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.678 Vali Acc: 0.256 Test Loss: 1.678 Test Acc: 0.256
Validation loss decreased (-0.233316 --> -0.255539).  Saving model ...
Epoch: 5 cost time: 0.6361517906188965
Epoch: 5, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.577 Vali Acc: 0.322 Test Loss: 1.577 Test Acc: 0.322
Validation loss decreased (-0.255539 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 0.5222899913787842
Epoch: 6, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.461 Vali Acc: 0.433 Test Loss: 1.461 Test Acc: 0.433
Validation loss decreased (-0.322206 --> -0.433319).  Saving model ...
Epoch: 7 cost time: 0.5688669681549072
Epoch: 7, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.341 Vali Acc: 0.589 Test Loss: 1.341 Test Acc: 0.589
Validation loss decreased (-0.433319 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 0.616811990737915
Epoch: 8, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.217 Vali Acc: 0.704 Test Loss: 1.217 Test Acc: 0.704
Validation loss decreased (-0.588875 --> -0.703692).  Saving model ...
Epoch: 9 cost time: 0.6815946102142334
Epoch: 9, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.095 Vali Acc: 0.767 Test Loss: 1.095 Test Acc: 0.767
Validation loss decreased (-0.703692 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 0.621617317199707
Epoch: 10, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.978 Vali Acc: 0.789 Test Loss: 0.978 Test Acc: 0.789
Validation loss decreased (-0.766656 --> -0.788879).  Saving model ...
Epoch: 11 cost time: 0.6311595439910889
Epoch: 11, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.871 Vali Acc: 0.822 Test Loss: 0.871 Test Acc: 0.822
Validation loss decreased (-0.788879 --> -0.822214).  Saving model ...
Epoch: 12 cost time: 0.72611403465271
Epoch: 12, Steps: 2 | Train Loss: 0.753 Vali Loss: 0.775 Vali Acc: 0.822 Test Loss: 0.775 Test Acc: 0.822
Validation loss decreased (-0.822214 --> -0.822214).  Saving model ...
Epoch: 13 cost time: 0.6166408061981201
Epoch: 13, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.691 Vali Acc: 0.848 Test Loss: 0.691 Test Acc: 0.848
Validation loss decreased (-0.822214 --> -0.848141).  Saving model ...
Epoch: 14 cost time: 0.7025117874145508
Epoch: 14, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.619 Vali Acc: 0.867 Test Loss: 0.619 Test Acc: 0.867
Validation loss decreased (-0.848141 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 0.7224154472351074
Epoch: 15, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.556 Vali Acc: 0.893 Test Loss: 0.556 Test Acc: 0.893
Validation loss decreased (-0.866660 --> -0.892587).  Saving model ...
Epoch: 16 cost time: 0.6751809120178223
Epoch: 16, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.503 Vali Acc: 0.893 Test Loss: 0.503 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892588).  Saving model ...
Epoch: 17 cost time: 0.6878173351287842
Epoch: 17, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.457 Vali Acc: 0.893 Test Loss: 0.457 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892588).  Saving model ...
Epoch: 18 cost time: 0.7578909397125244
Epoch: 18, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.420 Vali Acc: 0.896 Test Loss: 0.420 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.7122089862823486
Epoch: 19, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.389 Vali Acc: 0.904 Test Loss: 0.389 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.6397485733032227
Epoch: 20, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.360 Vali Acc: 0.904 Test Loss: 0.360 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903700).  Saving model ...
Epoch: 21 cost time: 0.6669778823852539
Epoch: 21, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.715435266494751
Epoch: 22, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.311 Vali Acc: 0.915 Test Loss: 0.311 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 23 cost time: 0.6414914131164551
Epoch: 23, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.293 Vali Acc: 0.919 Test Loss: 0.293 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 0.7413802146911621
Epoch: 24, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.6868240833282471
Epoch: 25, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.7389886379241943
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.6408703327178955
Epoch: 27, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.6714117527008057
Epoch: 28, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.7975354194641113
Epoch: 29, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.941 Test Loss: 0.237 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.7007694244384766
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 31 cost time: 0.7820155620574951
Epoch: 31, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 32 cost time: 0.724433422088623
Epoch: 32, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 33 cost time: 0.6385073661804199
Epoch: 33, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6465625762939453
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.704866886138916
Epoch: 35, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.6783087253570557
Epoch: 36, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6515510082244873
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7365102767944336
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6664142608642578
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.596203088760376
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5808670520782471
Epoch: 41, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7351343631744385
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.6452896595001221
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6883401870727539
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7545199394226074
Epoch: 45, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6912260055541992
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 77254
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5650126934051514
Epoch: 1, Steps: 2 | Train Loss: 2.070 Vali Loss: 1.963 Vali Acc: 0.174 Test Loss: 1.963 Test Acc: 0.174
Validation loss decreased (inf --> -0.174054).  Saving model ...
Epoch: 2 cost time: 0.7179760932922363
Epoch: 2, Steps: 2 | Train Loss: 1.931 Vali Loss: 1.866 Vali Acc: 0.185 Test Loss: 1.866 Test Acc: 0.185
Validation loss decreased (-0.174054 --> -0.185167).  Saving model ...
Epoch: 3 cost time: 0.7790579795837402
Epoch: 3, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.790 Vali Acc: 0.200 Test Loss: 1.790 Test Acc: 0.200
Validation loss decreased (-0.185167 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.7734532356262207
Epoch: 4, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.707 Vali Acc: 0.233 Test Loss: 1.707 Test Acc: 0.233
Validation loss decreased (-0.199982 --> -0.233316).  Saving model ...
Epoch: 5 cost time: 0.6831178665161133
Epoch: 5, Steps: 2 | Train Loss: 1.595 Vali Loss: 1.604 Vali Acc: 0.293 Test Loss: 1.604 Test Acc: 0.293
Validation loss decreased (-0.233316 --> -0.292577).  Saving model ...
Epoch: 6 cost time: 0.7154748439788818
Epoch: 6, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.487 Vali Acc: 0.381 Test Loss: 1.487 Test Acc: 0.381
Validation loss decreased (-0.292577 --> -0.381467).  Saving model ...
Epoch: 7 cost time: 0.7029983997344971
Epoch: 7, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.365 Vali Acc: 0.522 Test Loss: 1.365 Test Acc: 0.522
Validation loss decreased (-0.381467 --> -0.522209).  Saving model ...
Epoch: 8 cost time: 0.6136436462402344
Epoch: 8, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.237 Vali Acc: 0.674 Test Loss: 1.237 Test Acc: 0.674
Validation loss decreased (-0.522209 --> -0.674062).  Saving model ...
Epoch: 9 cost time: 0.6507213115692139
Epoch: 9, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.112 Vali Acc: 0.748 Test Loss: 1.112 Test Acc: 0.748
Validation loss decreased (-0.674062 --> -0.748137).  Saving model ...
Epoch: 10 cost time: 0.6849772930145264
Epoch: 10, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.993 Vali Acc: 0.789 Test Loss: 0.993 Test Acc: 0.789
Validation loss decreased (-0.748137 --> -0.788879).  Saving model ...
Epoch: 11 cost time: 0.6718618869781494
Epoch: 11, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.883 Vali Acc: 0.807 Test Loss: 0.883 Test Acc: 0.807
Validation loss decreased (-0.788879 --> -0.807399).  Saving model ...
Epoch: 12 cost time: 0.6484842300415039
Epoch: 12, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.785 Vali Acc: 0.837 Test Loss: 0.785 Test Acc: 0.837
Validation loss decreased (-0.807399 --> -0.837029).  Saving model ...
Epoch: 13 cost time: 0.7319273948669434
Epoch: 13, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.699 Vali Acc: 0.856 Test Loss: 0.699 Test Acc: 0.856
Validation loss decreased (-0.837029 --> -0.855549).  Saving model ...
Epoch: 14 cost time: 0.6259772777557373
Epoch: 14, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.624 Vali Acc: 0.859 Test Loss: 0.624 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 15 cost time: 0.6781320571899414
Epoch: 15, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.560 Vali Acc: 0.885 Test Loss: 0.560 Test Acc: 0.885
Validation loss decreased (-0.859253 --> -0.885180).  Saving model ...
Epoch: 16 cost time: 0.6485366821289062
Epoch: 16, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.505 Vali Acc: 0.889 Test Loss: 0.505 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.6992983818054199
Epoch: 17, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.459 Vali Acc: 0.907 Test Loss: 0.459 Test Acc: 0.907
Validation loss decreased (-0.888884 --> -0.907403).  Saving model ...
Epoch: 18 cost time: 0.6556730270385742
Epoch: 18, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.421 Vali Acc: 0.911 Test Loss: 0.421 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.6335022449493408
Epoch: 19, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.606252908706665
Epoch: 20, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.359 Vali Acc: 0.922 Test Loss: 0.359 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 21 cost time: 0.667600154876709
Epoch: 21, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.333 Vali Acc: 0.915 Test Loss: 0.333 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.7346453666687012
Epoch: 22, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.7792191505432129
Epoch: 23, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.291 Vali Acc: 0.915 Test Loss: 0.291 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.7890141010284424
Epoch: 24, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.6833782196044922
Epoch: 25, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.263 Vali Acc: 0.937 Test Loss: 0.263 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 26 cost time: 0.6141276359558105
Epoch: 26, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.253 Vali Acc: 0.937 Test Loss: 0.253 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.6519010066986084
Epoch: 27, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 28 cost time: 0.6659102439880371
Epoch: 28, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.7146735191345215
Epoch: 29, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.7052876949310303
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6695318222045898
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.7614848613739014
Epoch: 32, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6917674541473389
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.7275421619415283
Epoch: 34, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.6960780620574951
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.7726929187774658
Epoch: 36, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.6747791767120361
Epoch: 37, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.7805180549621582
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6685326099395752
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.587287187576294
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6549263000488281
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.58095383644104
Epoch: 42, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6085667610168457
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6322758197784424
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6812794208526611
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6844754219055176
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6257617473602295
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 77254
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5165398120880127
Epoch: 1, Steps: 2 | Train Loss: 2.037 Vali Loss: 1.969 Vali Acc: 0.181 Test Loss: 1.969 Test Acc: 0.181
Validation loss decreased (inf --> -0.181462).  Saving model ...
Epoch: 2 cost time: 0.6702761650085449
Epoch: 2, Steps: 2 | Train Loss: 1.922 Vali Loss: 1.871 Vali Acc: 0.207 Test Loss: 1.871 Test Acc: 0.207
Validation loss decreased (-0.181462 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.6777124404907227
Epoch: 3, Steps: 2 | Train Loss: 1.824 Vali Loss: 1.794 Vali Acc: 0.222 Test Loss: 1.794 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.7389867305755615
Epoch: 4, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.711 Vali Acc: 0.263 Test Loss: 1.711 Test Acc: 0.263
Validation loss decreased (-0.222204 --> -0.262946).  Saving model ...
Epoch: 5 cost time: 0.6600844860076904
Epoch: 5, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.607 Vali Acc: 0.311 Test Loss: 1.607 Test Acc: 0.311
Validation loss decreased (-0.262946 --> -0.311095).  Saving model ...
Epoch: 6 cost time: 0.801659345626831
Epoch: 6, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.490 Vali Acc: 0.396 Test Loss: 1.490 Test Acc: 0.396
Validation loss decreased (-0.311095 --> -0.396281).  Saving model ...
Epoch: 7 cost time: 0.7880260944366455
Epoch: 7, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.366 Vali Acc: 0.548 Test Loss: 1.366 Test Acc: 0.548
Validation loss decreased (-0.396281 --> -0.548134).  Saving model ...
Epoch: 8 cost time: 0.8579812049865723
Epoch: 8, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.237 Vali Acc: 0.693 Test Loss: 1.237 Test Acc: 0.693
Validation loss decreased (-0.548134 --> -0.692580).  Saving model ...
Epoch: 9 cost time: 0.8013482093811035
Epoch: 9, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.110 Vali Acc: 0.778 Test Loss: 1.110 Test Acc: 0.778
Validation loss decreased (-0.692580 --> -0.777767).  Saving model ...
Epoch: 10 cost time: 0.8627042770385742
Epoch: 10, Steps: 2 | Train Loss: 1.024 Vali Loss: 0.989 Vali Acc: 0.819 Test Loss: 0.989 Test Acc: 0.819
Validation loss decreased (-0.777767 --> -0.818509).  Saving model ...
Epoch: 11 cost time: 0.8205709457397461
Epoch: 11, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.877 Vali Acc: 0.841 Test Loss: 0.877 Test Acc: 0.841
Validation loss decreased (-0.818509 --> -0.840732).  Saving model ...
Epoch: 12 cost time: 0.7049150466918945
Epoch: 12, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.776 Vali Acc: 0.859 Test Loss: 0.776 Test Acc: 0.859
Validation loss decreased (-0.840732 --> -0.859251).  Saving model ...
Epoch: 13 cost time: 0.8382301330566406
Epoch: 13, Steps: 2 | Train Loss: 0.560 Vali Loss: 0.689 Vali Acc: 0.885 Test Loss: 0.689 Test Acc: 0.885
Validation loss decreased (-0.859251 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.7360315322875977
Epoch: 14, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.614 Vali Acc: 0.889 Test Loss: 0.614 Test Acc: 0.889
Validation loss decreased (-0.885178 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 0.7121188640594482
Epoch: 15, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.549 Vali Acc: 0.893 Test Loss: 0.549 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892587).  Saving model ...
Epoch: 16 cost time: 0.7692165374755859
Epoch: 16, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.7511281967163086
Epoch: 17, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.449 Vali Acc: 0.911 Test Loss: 0.449 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 18 cost time: 0.7014076709747314
Epoch: 18, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 19 cost time: 0.6253511905670166
Epoch: 19, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.379 Vali Acc: 0.919 Test Loss: 0.379 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 20 cost time: 0.813014030456543
Epoch: 20, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.350 Vali Acc: 0.915 Test Loss: 0.350 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7382326126098633
Epoch: 21, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.325 Vali Acc: 0.919 Test Loss: 0.325 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 22 cost time: 0.7159509658813477
Epoch: 22, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.304 Vali Acc: 0.919 Test Loss: 0.304 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 23 cost time: 0.6988916397094727
Epoch: 23, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.285 Vali Acc: 0.922 Test Loss: 0.285 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 0.6464154720306396
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 25 cost time: 0.6403374671936035
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6937494277954102
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.7556393146514893
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.6825339794158936
Epoch: 28, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 29 cost time: 0.6972005367279053
Epoch: 29, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 30 cost time: 0.7425899505615234
Epoch: 30, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 31 cost time: 0.7571806907653809
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.7179327011108398
Epoch: 32, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7036309242248535
Epoch: 33, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6820552349090576
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.6958222389221191
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.948 Test Loss: 0.212 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 36 cost time: 0.7663004398345947
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 37 cost time: 0.7277002334594727
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.6382300853729248
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.769317626953125
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7368535995483398
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.7245206832885742
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.774101734161377
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6629440784454346
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.8203544616699219
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6379530429840088
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.693469762802124
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.6697793006896973
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 77254
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4036967754364014
Epoch: 1, Steps: 2 | Train Loss: 2.012 Vali Loss: 1.922 Vali Acc: 0.156 Test Loss: 1.922 Test Acc: 0.156
Validation loss decreased (inf --> -0.155536).  Saving model ...
Epoch: 2 cost time: 0.6940841674804688
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.828 Vali Acc: 0.181 Test Loss: 1.828 Test Acc: 0.181
Validation loss decreased (-0.155536 --> -0.181463).  Saving model ...
Epoch: 3 cost time: 0.6309657096862793
Epoch: 3, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.755 Vali Acc: 0.200 Test Loss: 1.755 Test Acc: 0.200
Validation loss decreased (-0.181463 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.7619302272796631
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.677 Vali Acc: 0.244 Test Loss: 1.677 Test Acc: 0.244
Validation loss decreased (-0.199982 --> -0.244428).  Saving model ...
Epoch: 5 cost time: 0.6194593906402588
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.580 Vali Acc: 0.296 Test Loss: 1.580 Test Acc: 0.296
Validation loss decreased (-0.244428 --> -0.296281).  Saving model ...
Epoch: 6 cost time: 1.0006444454193115
Epoch: 6, Steps: 2 | Train Loss: 1.685 Vali Loss: 1.469 Vali Acc: 0.415 Test Loss: 1.469 Test Acc: 0.415
Validation loss decreased (-0.296281 --> -0.414800).  Saving model ...
Epoch: 7 cost time: 0.7729907035827637
Epoch: 7, Steps: 2 | Train Loss: 1.467 Vali Loss: 1.353 Vali Acc: 0.589 Test Loss: 1.353 Test Acc: 0.589
Validation loss decreased (-0.414800 --> -0.588875).  Saving model ...
Epoch: 8 cost time: 0.7535049915313721
Epoch: 8, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.233 Vali Acc: 0.670 Test Loss: 1.233 Test Acc: 0.670
Validation loss decreased (-0.588875 --> -0.670358).  Saving model ...
Epoch: 9 cost time: 0.6742672920227051
Epoch: 9, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.114 Vali Acc: 0.752 Test Loss: 1.114 Test Acc: 0.752
Validation loss decreased (-0.670358 --> -0.751841).  Saving model ...
Epoch: 10 cost time: 0.68064284324646
Epoch: 10, Steps: 2 | Train Loss: 1.030 Vali Loss: 1.002 Vali Acc: 0.774 Test Loss: 1.002 Test Acc: 0.774
Validation loss decreased (-0.751841 --> -0.774064).  Saving model ...
Epoch: 11 cost time: 0.7801408767700195
Epoch: 11, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.897 Vali Acc: 0.796 Test Loss: 0.897 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 12 cost time: 0.686053991317749
Epoch: 12, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.804 Vali Acc: 0.815 Test Loss: 0.804 Test Acc: 0.815
Validation loss decreased (-0.796287 --> -0.814807).  Saving model ...
Epoch: 13 cost time: 0.6911678314208984
Epoch: 13, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.721 Vali Acc: 0.830 Test Loss: 0.721 Test Acc: 0.830
Validation loss decreased (-0.814807 --> -0.829622).  Saving model ...
Epoch: 14 cost time: 0.8251793384552002
Epoch: 14, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.649 Vali Acc: 0.852 Test Loss: 0.649 Test Acc: 0.852
Validation loss decreased (-0.829622 --> -0.851845).  Saving model ...
Epoch: 15 cost time: 0.773937463760376
Epoch: 15, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.588 Vali Acc: 0.867 Test Loss: 0.588 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 0.6918239593505859
Epoch: 16, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 17 cost time: 0.7373149394989014
Epoch: 17, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.488 Vali Acc: 0.878 Test Loss: 0.488 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877773).  Saving model ...
Epoch: 18 cost time: 0.7402524948120117
Epoch: 18, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.448 Vali Acc: 0.885 Test Loss: 0.448 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885181).  Saving model ...
Epoch: 19 cost time: 0.646050214767456
Epoch: 19, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.415 Vali Acc: 0.896 Test Loss: 0.415 Test Acc: 0.896
Validation loss decreased (-0.885181 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 0.712791919708252
Epoch: 20, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.386 Vali Acc: 0.896 Test Loss: 0.386 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 21 cost time: 0.7068905830383301
Epoch: 21, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.361 Vali Acc: 0.896 Test Loss: 0.361 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896293).  Saving model ...
Epoch: 22 cost time: 0.7314753532409668
Epoch: 22, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.339 Vali Acc: 0.904 Test Loss: 0.339 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903700).  Saving model ...
Epoch: 23 cost time: 0.7314114570617676
Epoch: 23, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.320 Vali Acc: 0.907 Test Loss: 0.320 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 0.6944575309753418
Epoch: 24, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.303 Vali Acc: 0.911 Test Loss: 0.303 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 25 cost time: 0.6064903736114502
Epoch: 25, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.289 Vali Acc: 0.915 Test Loss: 0.289 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.6746220588684082
Epoch: 26, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.278 Vali Acc: 0.907 Test Loss: 0.278 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.8059177398681641
Epoch: 27, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.268 Vali Acc: 0.911 Test Loss: 0.268 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.7530512809753418
Epoch: 28, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.260 Vali Acc: 0.911 Test Loss: 0.260 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.7526788711547852
Epoch: 29, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.254 Vali Acc: 0.915 Test Loss: 0.254 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 30 cost time: 0.8236618041992188
Epoch: 30, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7635586261749268
Epoch: 31, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.7319185733795166
Epoch: 32, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.7396059036254883
Epoch: 33, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.236 Vali Acc: 0.915 Test Loss: 0.236 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 34 cost time: 0.8284950256347656
Epoch: 34, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.717888593673706
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.231 Vali Acc: 0.915 Test Loss: 0.231 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914813).  Saving model ...
Epoch: 36 cost time: 0.7225382328033447
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
Validation loss decreased (-0.914813 --> -0.918516).  Saving model ...
Epoch: 37 cost time: 0.7303428649902344
Epoch: 37, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 38 cost time: 0.6284172534942627
Epoch: 38, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.225 Vali Acc: 0.919 Test Loss: 0.225 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.6366868019104004
Epoch: 39, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.915 Test Loss: 0.224 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.7027010917663574
Epoch: 40, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.222 Vali Acc: 0.915 Test Loss: 0.222 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.7115261554718018
Epoch: 41, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 42 cost time: 0.7800400257110596
Epoch: 42, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 0.7270066738128662
Epoch: 43, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.7469761371612549
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6332442760467529
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.7263057231903076
Epoch: 46, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.8005414009094238
Epoch: 47, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.6816575527191162
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.6782808303833008
Epoch: 49, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.715958833694458
Epoch: 50, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.6812050342559814
Epoch: 51, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.6935708522796631
Epoch: 52, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 77254
model size : 1.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5849971771240234
Epoch: 1, Steps: 2 | Train Loss: 1.975 Vali Loss: 1.802 Vali Acc: 0.181 Test Loss: 1.802 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.620952844619751
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.716 Vali Acc: 0.211 Test Loss: 1.716 Test Acc: 0.211
Validation loss decreased (-0.181463 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 0.7695856094360352
Epoch: 3, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.645 Vali Acc: 0.259 Test Loss: 1.645 Test Acc: 0.259
Validation loss decreased (-0.211094 --> -0.259243).  Saving model ...
Epoch: 4 cost time: 0.6541273593902588
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.567 Vali Acc: 0.333 Test Loss: 1.567 Test Acc: 0.333
Validation loss decreased (-0.259243 --> -0.333318).  Saving model ...
Epoch: 5 cost time: 0.8399713039398193
Epoch: 5, Steps: 2 | Train Loss: 1.571 Vali Loss: 1.473 Vali Acc: 0.463 Test Loss: 1.473 Test Acc: 0.463
Validation loss decreased (-0.333318 --> -0.462948).  Saving model ...
Epoch: 6 cost time: 0.7065379619598389
Epoch: 6, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.366 Vali Acc: 0.574 Test Loss: 1.366 Test Acc: 0.574
Validation loss decreased (-0.462948 --> -0.574060).  Saving model ...
Epoch: 7 cost time: 0.678318977355957
Epoch: 7, Steps: 2 | Train Loss: 1.261 Vali Loss: 1.253 Vali Acc: 0.659 Test Loss: 1.253 Test Acc: 0.659
Validation loss decreased (-0.574060 --> -0.659247).  Saving model ...
Epoch: 8 cost time: 0.644622802734375
Epoch: 8, Steps: 2 | Train Loss: 1.198 Vali Loss: 1.138 Vali Acc: 0.719 Test Loss: 1.138 Test Acc: 0.719
Validation loss decreased (-0.659247 --> -0.718507).  Saving model ...
Epoch: 9 cost time: 0.607633113861084
Epoch: 9, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.027 Vali Acc: 0.767 Test Loss: 1.027 Test Acc: 0.767
Validation loss decreased (-0.718507 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 0.6466352939605713
Epoch: 10, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.920 Vali Acc: 0.793 Test Loss: 0.920 Test Acc: 0.793
Validation loss decreased (-0.766656 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 0.702603816986084
Epoch: 11, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.823 Vali Acc: 0.826 Test Loss: 0.823 Test Acc: 0.826
Validation loss decreased (-0.792583 --> -0.825918).  Saving model ...
Epoch: 12 cost time: 0.7753491401672363
Epoch: 12, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
Validation loss decreased (-0.825918 --> -0.855548).  Saving model ...
Epoch: 13 cost time: 0.660506010055542
Epoch: 13, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.658 Vali Acc: 0.874 Test Loss: 0.658 Test Acc: 0.874
Validation loss decreased (-0.855548 --> -0.874067).  Saving model ...
Epoch: 14 cost time: 0.6234273910522461
Epoch: 14, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.590 Vali Acc: 0.885 Test Loss: 0.590 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885179).  Saving model ...
Epoch: 15 cost time: 0.653702974319458
Epoch: 15, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.532 Vali Acc: 0.896 Test Loss: 0.532 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.6653940677642822
Epoch: 16, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.484 Vali Acc: 0.896 Test Loss: 0.484 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 17 cost time: 0.7974019050598145
Epoch: 17, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.441 Vali Acc: 0.915 Test Loss: 0.441 Test Acc: 0.915
Validation loss decreased (-0.896291 --> -0.914810).  Saving model ...
Epoch: 18 cost time: 0.7392432689666748
Epoch: 18, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.402 Vali Acc: 0.915 Test Loss: 0.402 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.6719837188720703
Epoch: 19, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.372 Vali Acc: 0.922 Test Loss: 0.372 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 0.7159757614135742
Epoch: 20, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.347 Vali Acc: 0.919 Test Loss: 0.347 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6389615535736084
Epoch: 21, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.326 Vali Acc: 0.919 Test Loss: 0.326 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5801076889038086
Epoch: 22, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.310 Vali Acc: 0.915 Test Loss: 0.310 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5995376110076904
Epoch: 23, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.7003364562988281
Epoch: 24, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.285 Vali Acc: 0.907 Test Loss: 0.285 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.638251781463623
Epoch: 25, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.277 Vali Acc: 0.911 Test Loss: 0.277 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.7160012722015381
Epoch: 26, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.271 Vali Acc: 0.919 Test Loss: 0.271 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.7528543472290039
Epoch: 27, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.6584625244140625
Epoch: 28, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.8137013912200928
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.6804838180541992
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.7579703330993652
Epoch: 31, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.6956682205200195
Epoch: 32, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.6557447910308838
Epoch: 33, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.6421780586242676
Epoch: 34, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.7812721729278564
Epoch: 35, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6966016292572021
Epoch: 36, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6555490493774414
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.7449374198913574
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.620093584060669
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.7421772480010986
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.8523974418640137
Epoch: 41, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.8245151042938232
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.8558690547943115
Epoch: 43, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6462855339050293
Epoch: 44, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.7261476516723633
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 60870
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5243330001831055
Epoch: 1, Steps: 2 | Train Loss: 1.963 Vali Loss: 1.813 Vali Acc: 0.178 Test Loss: 1.813 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.7303946018218994
Epoch: 2, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.725 Vali Acc: 0.200 Test Loss: 1.725 Test Acc: 0.200
Validation loss decreased (-0.177760 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 0.6541879177093506
Epoch: 3, Steps: 2 | Train Loss: 1.709 Vali Loss: 1.653 Vali Acc: 0.244 Test Loss: 1.653 Test Acc: 0.244
Validation loss decreased (-0.199983 --> -0.244428).  Saving model ...
Epoch: 4 cost time: 0.5906076431274414
Epoch: 4, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.575 Vali Acc: 0.333 Test Loss: 1.575 Test Acc: 0.333
Validation loss decreased (-0.244428 --> -0.333318).  Saving model ...
Epoch: 5 cost time: 0.6945846080780029
Epoch: 5, Steps: 2 | Train Loss: 1.558 Vali Loss: 1.480 Vali Acc: 0.452 Test Loss: 1.480 Test Acc: 0.452
Validation loss decreased (-0.333318 --> -0.451837).  Saving model ...
Epoch: 6 cost time: 0.6396975517272949
Epoch: 6, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.373 Vali Acc: 0.541 Test Loss: 1.373 Test Acc: 0.541
Validation loss decreased (-0.451837 --> -0.540727).  Saving model ...
Epoch: 7 cost time: 0.661482572555542
Epoch: 7, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.259 Vali Acc: 0.630 Test Loss: 1.259 Test Acc: 0.630
Validation loss decreased (-0.540727 --> -0.629617).  Saving model ...
Epoch: 8 cost time: 0.6406171321868896
Epoch: 8, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.143 Vali Acc: 0.693 Test Loss: 1.143 Test Acc: 0.693
Validation loss decreased (-0.629617 --> -0.692581).  Saving model ...
Epoch: 9 cost time: 0.6244673728942871
Epoch: 9, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.030 Vali Acc: 0.767 Test Loss: 1.030 Test Acc: 0.767
Validation loss decreased (-0.692581 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 0.8106129169464111
Epoch: 10, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.923 Vali Acc: 0.804 Test Loss: 0.923 Test Acc: 0.804
Validation loss decreased (-0.766656 --> -0.803694).  Saving model ...
Epoch: 11 cost time: 0.687408447265625
Epoch: 11, Steps: 2 | Train Loss: 0.833 Vali Loss: 0.824 Vali Acc: 0.819 Test Loss: 0.824 Test Acc: 0.819
Validation loss decreased (-0.803694 --> -0.818510).  Saving model ...
Epoch: 12 cost time: 0.7013447284698486
Epoch: 12, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.735 Vali Acc: 0.867 Test Loss: 0.735 Test Acc: 0.867
Validation loss decreased (-0.818510 --> -0.866659).  Saving model ...
Epoch: 13 cost time: 0.6400363445281982
Epoch: 13, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.658 Vali Acc: 0.878 Test Loss: 0.658 Test Acc: 0.878
Validation loss decreased (-0.866659 --> -0.877771).  Saving model ...
Epoch: 14 cost time: 0.6537139415740967
Epoch: 14, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.589 Vali Acc: 0.900 Test Loss: 0.589 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899994).  Saving model ...
Epoch: 15 cost time: 0.649773359298706
Epoch: 15, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.531 Vali Acc: 0.907 Test Loss: 0.531 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 16 cost time: 0.6675794124603271
Epoch: 16, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.482 Vali Acc: 0.911 Test Loss: 0.482 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.7088882923126221
Epoch: 17, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.439 Vali Acc: 0.919 Test Loss: 0.439 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918514).  Saving model ...
Epoch: 18 cost time: 0.6653702259063721
Epoch: 18, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.399 Vali Acc: 0.919 Test Loss: 0.399 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 19 cost time: 0.6558787822723389
Epoch: 19, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.368 Vali Acc: 0.922 Test Loss: 0.368 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 20 cost time: 0.6779820919036865
Epoch: 20, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.7535302639007568
Epoch: 21, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.6478681564331055
Epoch: 22, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.6371514797210693
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6398999691009521
Epoch: 24, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.6588950157165527
Epoch: 25, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.268 Vali Acc: 0.926 Test Loss: 0.268 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 26 cost time: 0.6585519313812256
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 27 cost time: 0.6876416206359863
Epoch: 27, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.5950148105621338
Epoch: 28, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.6864814758300781
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.6862614154815674
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.7561380863189697
Epoch: 31, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.6740291118621826
Epoch: 32, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.6852586269378662
Epoch: 33, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.6018788814544678
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.6548998355865479
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.6602399349212646
Epoch: 36, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.648123025894165
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6556105613708496
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.7148866653442383
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.6460635662078857
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.6674277782440186
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.6379692554473877
Epoch: 42, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7619891166687012
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.6881632804870605
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.7068929672241211
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.937 Test Loss: 0.209 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6315343379974365
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 60870
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7695043087005615
Epoch: 1, Steps: 2 | Train Loss: 1.998 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.7421026229858398
Epoch: 2, Steps: 2 | Train Loss: 1.870 Vali Loss: 1.780 Vali Acc: 0.204 Test Loss: 1.780 Test Acc: 0.204
Validation loss decreased (-0.177759 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.6820278167724609
Epoch: 3, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.707 Vali Acc: 0.248 Test Loss: 1.707 Test Acc: 0.248
Validation loss decreased (-0.203686 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.7803382873535156
Epoch: 4, Steps: 2 | Train Loss: 1.661 Vali Loss: 1.626 Vali Acc: 0.274 Test Loss: 1.626 Test Acc: 0.274
Validation loss decreased (-0.248131 --> -0.274058).  Saving model ...
Epoch: 5 cost time: 0.6658387184143066
Epoch: 5, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.529 Vali Acc: 0.344 Test Loss: 1.529 Test Acc: 0.344
Validation loss decreased (-0.274058 --> -0.344429).  Saving model ...
Epoch: 6 cost time: 0.6492421627044678
Epoch: 6, Steps: 2 | Train Loss: 1.464 Vali Loss: 1.419 Vali Acc: 0.459 Test Loss: 1.419 Test Acc: 0.459
Validation loss decreased (-0.344429 --> -0.459245).  Saving model ...
Epoch: 7 cost time: 0.5947275161743164
Epoch: 7, Steps: 2 | Train Loss: 1.321 Vali Loss: 1.301 Vali Acc: 0.619 Test Loss: 1.301 Test Acc: 0.619
Validation loss decreased (-0.459245 --> -0.618506).  Saving model ...
Epoch: 8 cost time: 0.6461968421936035
Epoch: 8, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.182 Vali Acc: 0.707 Test Loss: 1.182 Test Acc: 0.707
Validation loss decreased (-0.618506 --> -0.707396).  Saving model ...
Epoch: 9 cost time: 0.5552089214324951
Epoch: 9, Steps: 2 | Train Loss: 1.078 Vali Loss: 1.067 Vali Acc: 0.767 Test Loss: 1.067 Test Acc: 0.767
Validation loss decreased (-0.707396 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 0.8623661994934082
Epoch: 10, Steps: 2 | Train Loss: 0.953 Vali Loss: 0.954 Vali Acc: 0.807 Test Loss: 0.954 Test Acc: 0.807
Validation loss decreased (-0.766656 --> -0.807398).  Saving model ...
Epoch: 11 cost time: 0.6050679683685303
Epoch: 11, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.852 Vali Acc: 0.833 Test Loss: 0.852 Test Acc: 0.833
Validation loss decreased (-0.807398 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 0.6079599857330322
Epoch: 12, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.760 Vali Acc: 0.863 Test Loss: 0.760 Test Acc: 0.863
Validation loss decreased (-0.833325 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.6588571071624756
Epoch: 13, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.679 Vali Acc: 0.885 Test Loss: 0.679 Test Acc: 0.885
Validation loss decreased (-0.862955 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.6590075492858887
Epoch: 14, Steps: 2 | Train Loss: 0.591 Vali Loss: 0.608 Vali Acc: 0.896 Test Loss: 0.608 Test Acc: 0.896
Validation loss decreased (-0.885178 --> -0.896290).  Saving model ...
Epoch: 15 cost time: 0.6460342407226562
Epoch: 15, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.548 Vali Acc: 0.911 Test Loss: 0.548 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911106).  Saving model ...
Epoch: 16 cost time: 0.6754336357116699
Epoch: 16, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.497 Vali Acc: 0.911 Test Loss: 0.497 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.7189428806304932
Epoch: 17, Steps: 2 | Train Loss: 0.363 Vali Loss: 0.453 Vali Acc: 0.911 Test Loss: 0.453 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 18 cost time: 0.7514941692352295
Epoch: 18, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.412 Vali Acc: 0.915 Test Loss: 0.412 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 19 cost time: 0.6664063930511475
Epoch: 19, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.381 Vali Acc: 0.915 Test Loss: 0.381 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 20 cost time: 0.6959338188171387
Epoch: 20, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.6522469520568848
Epoch: 21, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.333 Vali Acc: 0.915 Test Loss: 0.333 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.7656941413879395
Epoch: 22, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.316 Vali Acc: 0.922 Test Loss: 0.316 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 23 cost time: 0.8557205200195312
Epoch: 23, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.301 Vali Acc: 0.922 Test Loss: 0.301 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 0.6750209331512451
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.6569929122924805
Epoch: 25, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.6737217903137207
Epoch: 26, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.6893196105957031
Epoch: 27, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.6587231159210205
Epoch: 28, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.6949527263641357
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.6889894008636475
Epoch: 30, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.240 Vali Acc: 0.922 Test Loss: 0.240 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.6999130249023438
Epoch: 31, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.6162786483764648
Epoch: 32, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.6070678234100342
Epoch: 33, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.6100547313690186
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 35 cost time: 0.551323652267456
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5635805130004883
Epoch: 36, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.221 Vali Acc: 0.922 Test Loss: 0.221 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6020247936248779
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5577991008758545
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5851056575775146
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6198763847351074
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.7536346912384033
Epoch: 41, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.7066318988800049
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.700589656829834
Epoch: 43, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.729896068572998
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 60870
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7660562992095947
Epoch: 1, Steps: 2 | Train Loss: 1.933 Vali Loss: 1.846 Vali Acc: 0.167 Test Loss: 1.846 Test Acc: 0.167
Validation loss decreased (inf --> -0.166648).  Saving model ...
Epoch: 2 cost time: 0.6360788345336914
Epoch: 2, Steps: 2 | Train Loss: 1.862 Vali Loss: 1.759 Vali Acc: 0.193 Test Loss: 1.759 Test Acc: 0.193
Validation loss decreased (-0.166648 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.597639799118042
Epoch: 3, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.689 Vali Acc: 0.207 Test Loss: 1.689 Test Acc: 0.207
Validation loss decreased (-0.192575 --> -0.207391).  Saving model ...
Epoch: 4 cost time: 0.6480591297149658
Epoch: 4, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.613 Vali Acc: 0.233 Test Loss: 1.613 Test Acc: 0.233
Validation loss decreased (-0.207391 --> -0.233317).  Saving model ...
Epoch: 5 cost time: 0.6318809986114502
Epoch: 5, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.520 Vali Acc: 0.322 Test Loss: 1.520 Test Acc: 0.322
Validation loss decreased (-0.233317 --> -0.322207).  Saving model ...
Epoch: 6 cost time: 0.5914971828460693
Epoch: 6, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.417 Vali Acc: 0.478 Test Loss: 1.417 Test Acc: 0.478
Validation loss decreased (-0.322207 --> -0.477764).  Saving model ...
Epoch: 7 cost time: 0.6271746158599854
Epoch: 7, Steps: 2 | Train Loss: 1.342 Vali Loss: 1.305 Vali Acc: 0.630 Test Loss: 1.305 Test Acc: 0.630
Validation loss decreased (-0.477764 --> -0.629617).  Saving model ...
Epoch: 8 cost time: 0.6285381317138672
Epoch: 8, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.193 Vali Acc: 0.689 Test Loss: 1.193 Test Acc: 0.689
Validation loss decreased (-0.629617 --> -0.688877).  Saving model ...
Epoch: 9 cost time: 0.6376376152038574
Epoch: 9, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.083 Vali Acc: 0.719 Test Loss: 1.083 Test Acc: 0.719
Validation loss decreased (-0.688877 --> -0.718508).  Saving model ...
Epoch: 10 cost time: 0.6537482738494873
Epoch: 10, Steps: 2 | Train Loss: 0.995 Vali Loss: 0.977 Vali Acc: 0.752 Test Loss: 0.977 Test Acc: 0.752
Validation loss decreased (-0.718508 --> -0.751842).  Saving model ...
Epoch: 11 cost time: 0.6195688247680664
Epoch: 11, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.882 Vali Acc: 0.789 Test Loss: 0.882 Test Acc: 0.789
Validation loss decreased (-0.751842 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 0.625969409942627
Epoch: 12, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.795 Vali Acc: 0.807 Test Loss: 0.795 Test Acc: 0.807
Validation loss decreased (-0.788880 --> -0.807399).  Saving model ...
Epoch: 13 cost time: 0.618506908416748
Epoch: 13, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.719 Vali Acc: 0.830 Test Loss: 0.719 Test Acc: 0.830
Validation loss decreased (-0.807399 --> -0.829622).  Saving model ...
Epoch: 14 cost time: 0.7065765857696533
Epoch: 14, Steps: 2 | Train Loss: 0.618 Vali Loss: 0.651 Vali Acc: 0.852 Test Loss: 0.651 Test Acc: 0.852
Validation loss decreased (-0.829622 --> -0.851845).  Saving model ...
Epoch: 15 cost time: 0.6009173393249512
Epoch: 15, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.593 Vali Acc: 0.863 Test Loss: 0.593 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862957).  Saving model ...
Epoch: 16 cost time: 0.5994317531585693
Epoch: 16, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.543 Vali Acc: 0.878 Test Loss: 0.543 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877772).  Saving model ...
Epoch: 17 cost time: 0.5922112464904785
Epoch: 17, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.499 Vali Acc: 0.881 Test Loss: 0.499 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 18 cost time: 0.625596284866333
Epoch: 18, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.460 Vali Acc: 0.889 Test Loss: 0.460 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 19 cost time: 0.8219273090362549
Epoch: 19, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.428 Vali Acc: 0.900 Test Loss: 0.428 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.6848444938659668
Epoch: 20, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.401 Vali Acc: 0.907 Test Loss: 0.401 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 21 cost time: 0.6383943557739258
Epoch: 21, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 22 cost time: 0.6195809841156006
Epoch: 22, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.360 Vali Acc: 0.907 Test Loss: 0.360 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6960358619689941
Epoch: 23, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.343 Vali Acc: 0.907 Test Loss: 0.343 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.8260617256164551
Epoch: 24, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.329 Vali Acc: 0.907 Test Loss: 0.329 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7262454032897949
Epoch: 25, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.317 Vali Acc: 0.907 Test Loss: 0.317 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.8156239986419678
Epoch: 26, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 0.6938784122467041
Epoch: 27, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.299 Vali Acc: 0.904 Test Loss: 0.299 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6669080257415771
Epoch: 28, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.6396973133087158
Epoch: 29, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.283 Vali Acc: 0.907 Test Loss: 0.283 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.7244365215301514
Epoch: 30, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.276 Vali Acc: 0.907 Test Loss: 0.276 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.766657829284668
Epoch: 31, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.269 Vali Acc: 0.907 Test Loss: 0.269 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.6648645401000977
Epoch: 32, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.264 Vali Acc: 0.907 Test Loss: 0.264 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.6148252487182617
Epoch: 33, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.260 Vali Acc: 0.907 Test Loss: 0.260 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.7092146873474121
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.256 Vali Acc: 0.907 Test Loss: 0.256 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.660813570022583
Epoch: 35, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.253 Vali Acc: 0.907 Test Loss: 0.253 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.6455612182617188
Epoch: 36, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.251 Vali Acc: 0.907 Test Loss: 0.251 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 60870
model size : 1.47MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.564255714416504
Epoch: 1, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.764 Vali Acc: 0.200 Test Loss: 1.764 Test Acc: 0.200
Validation loss decreased (inf --> -0.199982).  Saving model ...
Epoch: 2 cost time: 0.6733174324035645
Epoch: 2, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.708 Vali Acc: 0.252 Test Loss: 1.708 Test Acc: 0.252
Validation loss decreased (-0.199982 --> -0.251835).  Saving model ...
Epoch: 3 cost time: 0.6143295764923096
Epoch: 3, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.668 Vali Acc: 0.285 Test Loss: 1.668 Test Acc: 0.285
Validation loss decreased (-0.251835 --> -0.285169).  Saving model ...
Epoch: 4 cost time: 0.7006771564483643
Epoch: 4, Steps: 2 | Train Loss: 1.489 Vali Loss: 1.629 Vali Acc: 0.315 Test Loss: 1.629 Test Acc: 0.315
Validation loss decreased (-0.285169 --> -0.314799).  Saving model ...
Epoch: 5 cost time: 0.700610876083374
Epoch: 5, Steps: 2 | Train Loss: 1.501 Vali Loss: 1.581 Vali Acc: 0.367 Test Loss: 1.581 Test Acc: 0.367
Validation loss decreased (-0.314799 --> -0.366651).  Saving model ...
Epoch: 6 cost time: 0.6083228588104248
Epoch: 6, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.526 Vali Acc: 0.407 Test Loss: 1.526 Test Acc: 0.407
Validation loss decreased (-0.366651 --> -0.407392).  Saving model ...
Epoch: 7 cost time: 0.656597375869751
Epoch: 7, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.464 Vali Acc: 0.452 Test Loss: 1.464 Test Acc: 0.452
Validation loss decreased (-0.407392 --> -0.451837).  Saving model ...
Epoch: 8 cost time: 0.6353003978729248
Epoch: 8, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.399 Vali Acc: 0.493 Test Loss: 1.399 Test Acc: 0.493
Validation loss decreased (-0.451837 --> -0.492579).  Saving model ...
Epoch: 9 cost time: 0.7138471603393555
Epoch: 9, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.331 Vali Acc: 0.541 Test Loss: 1.331 Test Acc: 0.541
Validation loss decreased (-0.492579 --> -0.540727).  Saving model ...
Epoch: 10 cost time: 0.6993241310119629
Epoch: 10, Steps: 2 | Train Loss: 1.185 Vali Loss: 1.262 Vali Acc: 0.581 Test Loss: 1.262 Test Acc: 0.581
Validation loss decreased (-0.540727 --> -0.581469).  Saving model ...
Epoch: 11 cost time: 0.6640663146972656
Epoch: 11, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.193 Vali Acc: 0.619 Test Loss: 1.193 Test Acc: 0.619
Validation loss decreased (-0.581469 --> -0.618507).  Saving model ...
Epoch: 12 cost time: 0.6614611148834229
Epoch: 12, Steps: 2 | Train Loss: 1.011 Vali Loss: 1.125 Vali Acc: 0.659 Test Loss: 1.125 Test Acc: 0.659
Validation loss decreased (-0.618507 --> -0.659248).  Saving model ...
Epoch: 13 cost time: 0.7325856685638428
Epoch: 13, Steps: 2 | Train Loss: 0.892 Vali Loss: 1.057 Vali Acc: 0.689 Test Loss: 1.057 Test Acc: 0.689
Validation loss decreased (-0.659248 --> -0.688878).  Saving model ...
Epoch: 14 cost time: 0.6901633739471436
Epoch: 14, Steps: 2 | Train Loss: 0.862 Vali Loss: 0.993 Vali Acc: 0.741 Test Loss: 0.993 Test Acc: 0.741
Validation loss decreased (-0.688878 --> -0.740731).  Saving model ...
Epoch: 15 cost time: 0.7264549732208252
Epoch: 15, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.930 Vali Acc: 0.778 Test Loss: 0.930 Test Acc: 0.778
Validation loss decreased (-0.740731 --> -0.777768).  Saving model ...
Epoch: 16 cost time: 0.7766876220703125
Epoch: 16, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.872 Vali Acc: 0.819 Test Loss: 0.872 Test Acc: 0.819
Validation loss decreased (-0.777768 --> -0.818510).  Saving model ...
Epoch: 17 cost time: 0.6363165378570557
Epoch: 17, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.816 Vali Acc: 0.837 Test Loss: 0.816 Test Acc: 0.837
Validation loss decreased (-0.818510 --> -0.837029).  Saving model ...
Epoch: 18 cost time: 0.6764569282531738
Epoch: 18, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.762 Vali Acc: 0.856 Test Loss: 0.762 Test Acc: 0.856
Validation loss decreased (-0.837029 --> -0.855548).  Saving model ...
Epoch: 19 cost time: 0.8065743446350098
Epoch: 19, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.711 Vali Acc: 0.863 Test Loss: 0.711 Test Acc: 0.863
Validation loss decreased (-0.855548 --> -0.862956).  Saving model ...
Epoch: 20 cost time: 0.7193620204925537
Epoch: 20, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.663 Vali Acc: 0.874 Test Loss: 0.663 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874067).  Saving model ...
Epoch: 21 cost time: 0.725919246673584
Epoch: 21, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.619 Vali Acc: 0.874 Test Loss: 0.619 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.7384541034698486
Epoch: 22, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.579 Vali Acc: 0.893 Test Loss: 0.579 Test Acc: 0.893
Validation loss decreased (-0.874068 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.6980867385864258
Epoch: 23, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.542 Vali Acc: 0.893 Test Loss: 0.542 Test Acc: 0.893
Validation loss decreased (-0.892587 --> -0.892587).  Saving model ...
Epoch: 24 cost time: 0.6790330410003662
Epoch: 24, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.507 Vali Acc: 0.904 Test Loss: 0.507 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903699).  Saving model ...
Epoch: 25 cost time: 0.7219595909118652
Epoch: 25, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.478 Vali Acc: 0.900 Test Loss: 0.478 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7672491073608398
Epoch: 26, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.453 Vali Acc: 0.907 Test Loss: 0.453 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.6887936592102051
Epoch: 27, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.430 Vali Acc: 0.907 Test Loss: 0.430 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 0.6720037460327148
Epoch: 28, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.410 Vali Acc: 0.907 Test Loss: 0.410 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.6579663753509521
Epoch: 29, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.392 Vali Acc: 0.911 Test Loss: 0.392 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.6353540420532227
Epoch: 30, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.376 Vali Acc: 0.911 Test Loss: 0.376 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.6907429695129395
Epoch: 31, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.362 Vali Acc: 0.911 Test Loss: 0.362 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 32 cost time: 0.7551829814910889
Epoch: 32, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.350 Vali Acc: 0.911 Test Loss: 0.350 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 0.7456245422363281
Epoch: 33, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.337 Vali Acc: 0.915 Test Loss: 0.337 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 34 cost time: 0.6111204624176025
Epoch: 34, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.326 Vali Acc: 0.915 Test Loss: 0.326 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 35 cost time: 0.7473390102386475
Epoch: 35, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 36 cost time: 0.6612899303436279
Epoch: 36, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 37 cost time: 0.7852168083190918
Epoch: 37, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 38 cost time: 0.8440220355987549
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.7917616367340088
Epoch: 39, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 40 cost time: 0.80517578125
Epoch: 40, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 41 cost time: 0.7128362655639648
Epoch: 41, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 42 cost time: 0.7745912075042725
Epoch: 42, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 0.6788508892059326
Epoch: 43, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.7805817127227783
Epoch: 44, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 45 cost time: 0.6603069305419922
Epoch: 45, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.6711006164550781
Epoch: 46, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.6743619441986084
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.251 Vali Acc: 0.941 Test Loss: 0.251 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.7506728172302246
Epoch: 48, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.249 Vali Acc: 0.941 Test Loss: 0.249 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.7105846405029297
Epoch: 49, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.248 Vali Acc: 0.941 Test Loss: 0.248 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.7206640243530273
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 51 cost time: 0.6448521614074707
Epoch: 51, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 52 cost time: 0.7116856575012207
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 53 cost time: 0.6956987380981445
Epoch: 53, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 54 cost time: 0.8149755001068115
Epoch: 54, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6469836235046387
Epoch: 55, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6412496566772461
Epoch: 56, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7197442054748535
Epoch: 57, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6316831111907959
Epoch: 58, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.5991663932800293
Epoch: 59, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.6042087078094482
Epoch: 60, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.608116865158081
Epoch: 61, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.6260218620300293
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.7508199214935303
Epoch: 63, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 280326
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5838329792022705
Epoch: 1, Steps: 2 | Train Loss: 1.878 Vali Loss: 1.766 Vali Acc: 0.185 Test Loss: 1.766 Test Acc: 0.185
Validation loss decreased (inf --> -0.185168).  Saving model ...
Epoch: 2 cost time: 0.6789388656616211
Epoch: 2, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.710 Vali Acc: 0.230 Test Loss: 1.710 Test Acc: 0.230
Validation loss decreased (-0.185168 --> -0.229613).  Saving model ...
Epoch: 3 cost time: 0.6566228866577148
Epoch: 3, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.668 Vali Acc: 0.263 Test Loss: 1.668 Test Acc: 0.263
Validation loss decreased (-0.229613 --> -0.262946).  Saving model ...
Epoch: 4 cost time: 0.6341097354888916
Epoch: 4, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.630 Vali Acc: 0.304 Test Loss: 1.630 Test Acc: 0.304
Validation loss decreased (-0.262946 --> -0.303687).  Saving model ...
Epoch: 5 cost time: 0.5942661762237549
Epoch: 5, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.580 Vali Acc: 0.348 Test Loss: 1.580 Test Acc: 0.348
Validation loss decreased (-0.303687 --> -0.348132).  Saving model ...
Epoch: 6 cost time: 0.7295238971710205
Epoch: 6, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.526 Vali Acc: 0.393 Test Loss: 1.526 Test Acc: 0.393
Validation loss decreased (-0.348132 --> -0.392577).  Saving model ...
Epoch: 7 cost time: 0.5165576934814453
Epoch: 7, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.463 Vali Acc: 0.441 Test Loss: 1.463 Test Acc: 0.441
Validation loss decreased (-0.392577 --> -0.440726).  Saving model ...
Epoch: 8 cost time: 0.6265928745269775
Epoch: 8, Steps: 2 | Train Loss: 1.252 Vali Loss: 1.395 Vali Acc: 0.485 Test Loss: 1.395 Test Acc: 0.485
Validation loss decreased (-0.440726 --> -0.485171).  Saving model ...
Epoch: 9 cost time: 0.6083214282989502
Epoch: 9, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.325 Vali Acc: 0.541 Test Loss: 1.325 Test Acc: 0.541
Validation loss decreased (-0.485171 --> -0.540727).  Saving model ...
Epoch: 10 cost time: 0.6439385414123535
Epoch: 10, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.256 Vali Acc: 0.570 Test Loss: 1.256 Test Acc: 0.570
Validation loss decreased (-0.540727 --> -0.570358).  Saving model ...
Epoch: 11 cost time: 0.6383984088897705
Epoch: 11, Steps: 2 | Train Loss: 1.058 Vali Loss: 1.186 Vali Acc: 0.607 Test Loss: 1.186 Test Acc: 0.607
Validation loss decreased (-0.570358 --> -0.607396).  Saving model ...
Epoch: 12 cost time: 0.6248230934143066
Epoch: 12, Steps: 2 | Train Loss: 1.022 Vali Loss: 1.117 Vali Acc: 0.652 Test Loss: 1.117 Test Acc: 0.652
Validation loss decreased (-0.607396 --> -0.651841).  Saving model ...
Epoch: 13 cost time: 0.7096602916717529
Epoch: 13, Steps: 2 | Train Loss: 0.862 Vali Loss: 1.050 Vali Acc: 0.711 Test Loss: 1.050 Test Acc: 0.711
Validation loss decreased (-0.651841 --> -0.711101).  Saving model ...
Epoch: 14 cost time: 0.597100019454956
Epoch: 14, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.985 Vali Acc: 0.748 Test Loss: 0.985 Test Acc: 0.748
Validation loss decreased (-0.711101 --> -0.748138).  Saving model ...
Epoch: 15 cost time: 0.5411407947540283
Epoch: 15, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.920 Vali Acc: 0.789 Test Loss: 0.920 Test Acc: 0.789
Validation loss decreased (-0.748138 --> -0.788880).  Saving model ...
Epoch: 16 cost time: 0.5661754608154297
Epoch: 16, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.860 Vali Acc: 0.811 Test Loss: 0.860 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 0.5854640007019043
Epoch: 17, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.804 Vali Acc: 0.822 Test Loss: 0.804 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 0.5554895401000977
Epoch: 18, Steps: 2 | Train Loss: 0.606 Vali Loss: 0.750 Vali Acc: 0.833 Test Loss: 0.750 Test Acc: 0.833
Validation loss decreased (-0.822214 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 0.5930461883544922
Epoch: 19, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.700 Vali Acc: 0.844 Test Loss: 0.700 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844437).  Saving model ...
Epoch: 20 cost time: 0.5427258014678955
Epoch: 20, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.652 Vali Acc: 0.852 Test Loss: 0.652 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 21 cost time: 0.5780274868011475
Epoch: 21, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 22 cost time: 0.6052126884460449
Epoch: 22, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.569 Vali Acc: 0.874 Test Loss: 0.569 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 23 cost time: 0.5746700763702393
Epoch: 23, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.532 Vali Acc: 0.881 Test Loss: 0.532 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881476).  Saving model ...
Epoch: 24 cost time: 0.589763879776001
Epoch: 24, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.499 Vali Acc: 0.904 Test Loss: 0.499 Test Acc: 0.904
Validation loss decreased (-0.881476 --> -0.903699).  Saving model ...
Epoch: 25 cost time: 0.560488224029541
Epoch: 25, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.471 Vali Acc: 0.896 Test Loss: 0.471 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7258033752441406
Epoch: 26, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.653019905090332
Epoch: 27, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.6385476589202881
Epoch: 28, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.401 Vali Acc: 0.911 Test Loss: 0.401 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 29 cost time: 0.6291263103485107
Epoch: 29, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.635199785232544
Epoch: 30, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.368 Vali Acc: 0.915 Test Loss: 0.368 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.6186873912811279
Epoch: 31, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.356 Vali Acc: 0.911 Test Loss: 0.356 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.677025556564331
Epoch: 32, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.344 Vali Acc: 0.911 Test Loss: 0.344 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6698167324066162
Epoch: 33, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.333 Vali Acc: 0.911 Test Loss: 0.333 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.6343984603881836
Epoch: 34, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 35 cost time: 0.6047701835632324
Epoch: 35, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.6148474216461182
Epoch: 36, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.6739513874053955
Epoch: 37, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.302 Vali Acc: 0.911 Test Loss: 0.302 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.6584382057189941
Epoch: 38, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.295 Vali Acc: 0.911 Test Loss: 0.295 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.8044619560241699
Epoch: 39, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.289 Vali Acc: 0.907 Test Loss: 0.289 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6553549766540527
Epoch: 40, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.283 Vali Acc: 0.915 Test Loss: 0.283 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 41 cost time: 0.6314272880554199
Epoch: 41, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 42 cost time: 0.6120831966400146
Epoch: 42, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.272 Vali Acc: 0.919 Test Loss: 0.272 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 43 cost time: 0.6374928951263428
Epoch: 43, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.5685169696807861
Epoch: 44, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 0.6222689151763916
Epoch: 45, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.629479169845581
Epoch: 46, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.259 Vali Acc: 0.922 Test Loss: 0.259 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 47 cost time: 0.6268167495727539
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.256 Vali Acc: 0.926 Test Loss: 0.256 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 48 cost time: 0.6318788528442383
Epoch: 48, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 49 cost time: 0.5882306098937988
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 50 cost time: 0.6570916175842285
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 51 cost time: 0.6473214626312256
Epoch: 51, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.6553683280944824
Epoch: 52, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.6316473484039307
Epoch: 53, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.6239309310913086
Epoch: 54, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 55 cost time: 0.6743745803833008
Epoch: 55, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 56 cost time: 0.6549577713012695
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 57 cost time: 0.7202517986297607
Epoch: 57, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.6453056335449219
Epoch: 58, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 0.6437656879425049
Epoch: 59, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.7646300792694092
Epoch: 60, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6866466999053955
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 62 cost time: 0.7062225341796875
Epoch: 62, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 63 cost time: 0.6411957740783691
Epoch: 63, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 0.6327791213989258
Epoch: 64, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 65 cost time: 0.591627836227417
Epoch: 65, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.226 Vali Acc: 0.941 Test Loss: 0.226 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 66 cost time: 0.6055214405059814
Epoch: 66, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 67 cost time: 0.6106047630310059
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 68 cost time: 0.6771085262298584
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 69 cost time: 0.7164576053619385
Epoch: 69, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 0.7448382377624512
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 0.6340062618255615
Epoch: 71, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.944 Test Loss: 0.219 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.626908540725708
Epoch: 72, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.6448454856872559
Epoch: 73, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.6903259754180908
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.6162300109863281
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.6798570156097412
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 77 cost time: 0.6161556243896484
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 78 cost time: 0.5698513984680176
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 79 cost time: 0.5361409187316895
Epoch: 79, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 80 cost time: 0.5858821868896484
Epoch: 80, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 81 cost time: 0.6800777912139893
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 82 cost time: 0.6498501300811768
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 280326
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.663219451904297
Epoch: 1, Steps: 2 | Train Loss: 1.867 Vali Loss: 1.769 Vali Acc: 0.159 Test Loss: 1.769 Test Acc: 0.159
Validation loss decreased (inf --> -0.159242).  Saving model ...
Epoch: 2 cost time: 0.6472091674804688
Epoch: 2, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.711 Vali Acc: 0.196 Test Loss: 1.711 Test Acc: 0.196
Validation loss decreased (-0.159242 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 0.8261764049530029
Epoch: 3, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.668 Vali Acc: 0.248 Test Loss: 1.668 Test Acc: 0.248
Validation loss decreased (-0.196279 --> -0.248131).  Saving model ...
Epoch: 4 cost time: 0.7179620265960693
Epoch: 4, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.628 Vali Acc: 0.278 Test Loss: 1.628 Test Acc: 0.278
Validation loss decreased (-0.248131 --> -0.277761).  Saving model ...
Epoch: 5 cost time: 0.690561056137085
Epoch: 5, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.578 Vali Acc: 0.322 Test Loss: 1.578 Test Acc: 0.322
Validation loss decreased (-0.277761 --> -0.322206).  Saving model ...
Epoch: 6 cost time: 0.6947879791259766
Epoch: 6, Steps: 2 | Train Loss: 1.559 Vali Loss: 1.520 Vali Acc: 0.389 Test Loss: 1.520 Test Acc: 0.389
Validation loss decreased (-0.322206 --> -0.388874).  Saving model ...
Epoch: 7 cost time: 0.6955158710479736
Epoch: 7, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.456 Vali Acc: 0.448 Test Loss: 1.456 Test Acc: 0.448
Validation loss decreased (-0.388874 --> -0.448134).  Saving model ...
Epoch: 8 cost time: 0.7560784816741943
Epoch: 8, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.388 Vali Acc: 0.496 Test Loss: 1.388 Test Acc: 0.496
Validation loss decreased (-0.448134 --> -0.496282).  Saving model ...
Epoch: 9 cost time: 0.659088134765625
Epoch: 9, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.317 Vali Acc: 0.559 Test Loss: 1.317 Test Acc: 0.559
Validation loss decreased (-0.496282 --> -0.559246).  Saving model ...
Epoch: 10 cost time: 0.7321176528930664
Epoch: 10, Steps: 2 | Train Loss: 1.159 Vali Loss: 1.245 Vali Acc: 0.615 Test Loss: 1.245 Test Acc: 0.615
Validation loss decreased (-0.559246 --> -0.614802).  Saving model ...
Epoch: 11 cost time: 0.6456584930419922
Epoch: 11, Steps: 2 | Train Loss: 1.067 Vali Loss: 1.173 Vali Acc: 0.648 Test Loss: 1.173 Test Acc: 0.648
Validation loss decreased (-0.614802 --> -0.648136).  Saving model ...
Epoch: 12 cost time: 0.6618599891662598
Epoch: 12, Steps: 2 | Train Loss: 0.968 Vali Loss: 1.103 Vali Acc: 0.685 Test Loss: 1.103 Test Acc: 0.685
Validation loss decreased (-0.648136 --> -0.685174).  Saving model ...
Epoch: 13 cost time: 0.6852169036865234
Epoch: 13, Steps: 2 | Train Loss: 0.861 Vali Loss: 1.034 Vali Acc: 0.741 Test Loss: 1.034 Test Acc: 0.741
Validation loss decreased (-0.685174 --> -0.740730).  Saving model ...
Epoch: 14 cost time: 0.7891688346862793
Epoch: 14, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.967 Vali Acc: 0.793 Test Loss: 0.967 Test Acc: 0.793
Validation loss decreased (-0.740730 --> -0.792583).  Saving model ...
Epoch: 15 cost time: 0.6772215366363525
Epoch: 15, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.903 Vali Acc: 0.822 Test Loss: 0.903 Test Acc: 0.822
Validation loss decreased (-0.792583 --> -0.822213).  Saving model ...
Epoch: 16 cost time: 0.6734762191772461
Epoch: 16, Steps: 2 | Train Loss: 0.726 Vali Loss: 0.844 Vali Acc: 0.833 Test Loss: 0.844 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 17 cost time: 0.7112798690795898
Epoch: 17, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.787 Vali Acc: 0.856 Test Loss: 0.787 Test Acc: 0.856
Validation loss decreased (-0.833325 --> -0.855548).  Saving model ...
Epoch: 18 cost time: 0.7810473442077637
Epoch: 18, Steps: 2 | Train Loss: 0.597 Vali Loss: 0.732 Vali Acc: 0.867 Test Loss: 0.732 Test Acc: 0.867
Validation loss decreased (-0.855548 --> -0.866659).  Saving model ...
Epoch: 19 cost time: 0.7476308345794678
Epoch: 19, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.683 Vali Acc: 0.874 Test Loss: 0.683 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 20 cost time: 0.7867083549499512
Epoch: 20, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.634 Vali Acc: 0.889 Test Loss: 0.634 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 0.7738525867462158
Epoch: 21, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.590 Vali Acc: 0.904 Test Loss: 0.590 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 22 cost time: 0.7950856685638428
Epoch: 22, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.551 Vali Acc: 0.904 Test Loss: 0.551 Test Acc: 0.904
Validation loss decreased (-0.903698 --> -0.903698).  Saving model ...
Epoch: 23 cost time: 0.6829104423522949
Epoch: 23, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.513 Vali Acc: 0.907 Test Loss: 0.513 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.7080376148223877
Epoch: 24, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.478 Vali Acc: 0.915 Test Loss: 0.478 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 25 cost time: 0.8084464073181152
Epoch: 25, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.449 Vali Acc: 0.919 Test Loss: 0.449 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.7423675060272217
Epoch: 26, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.424 Vali Acc: 0.922 Test Loss: 0.424 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 0.7698853015899658
Epoch: 27, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.401 Vali Acc: 0.919 Test Loss: 0.401 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.7513723373413086
Epoch: 28, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.381 Vali Acc: 0.926 Test Loss: 0.381 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.7361032962799072
Epoch: 29, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.363 Vali Acc: 0.930 Test Loss: 0.363 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.7793431282043457
Epoch: 30, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.348 Vali Acc: 0.930 Test Loss: 0.348 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.791541576385498
Epoch: 31, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.335 Vali Acc: 0.933 Test Loss: 0.335 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 32 cost time: 0.7561590671539307
Epoch: 32, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.323 Vali Acc: 0.933 Test Loss: 0.323 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.840341329574585
Epoch: 33, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.312 Vali Acc: 0.933 Test Loss: 0.312 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.7262825965881348
Epoch: 34, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6551957130432129
Epoch: 35, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.8138856887817383
Epoch: 36, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.288 Vali Acc: 0.930 Test Loss: 0.288 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.738684892654419
Epoch: 37, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.6534008979797363
Epoch: 38, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.6649291515350342
Epoch: 39, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.6514730453491211
Epoch: 40, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.264 Vali Acc: 0.937 Test Loss: 0.264 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.6555776596069336
Epoch: 41, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.259 Vali Acc: 0.937 Test Loss: 0.259 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.6930868625640869
Epoch: 42, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.6302328109741211
Epoch: 43, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.250 Vali Acc: 0.937 Test Loss: 0.250 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.6547195911407471
Epoch: 44, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.246 Vali Acc: 0.937 Test Loss: 0.246 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.6461350917816162
Epoch: 45, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.243 Vali Acc: 0.937 Test Loss: 0.243 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.6978754997253418
Epoch: 46, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.7041256427764893
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.8062472343444824
Epoch: 48, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.6967372894287109
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 50 cost time: 0.6498148441314697
Epoch: 50, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.6880693435668945
Epoch: 51, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.7552194595336914
Epoch: 52, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.7890005111694336
Epoch: 53, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.7105495929718018
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 55 cost time: 0.6848495006561279
Epoch: 55, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 56 cost time: 0.7063548564910889
Epoch: 56, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 57 cost time: 0.6950592994689941
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 58 cost time: 0.6944785118103027
Epoch: 58, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 59 cost time: 0.8193528652191162
Epoch: 59, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 280326
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.379132032394409
Epoch: 1, Steps: 2 | Train Loss: 1.835 Vali Loss: 1.753 Vali Acc: 0.148 Test Loss: 1.753 Test Acc: 0.148
Validation loss decreased (inf --> -0.148131).  Saving model ...
Epoch: 2 cost time: 0.6350772380828857
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.698 Vali Acc: 0.207 Test Loss: 1.698 Test Acc: 0.207
Validation loss decreased (-0.148131 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.7758147716522217
Epoch: 3, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.657 Vali Acc: 0.248 Test Loss: 1.657 Test Acc: 0.248
Validation loss decreased (-0.207390 --> -0.248132).  Saving model ...
Epoch: 4 cost time: 0.6412088871002197
Epoch: 4, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.619 Vali Acc: 0.274 Test Loss: 1.619 Test Acc: 0.274
Validation loss decreased (-0.248132 --> -0.274058).  Saving model ...
Epoch: 5 cost time: 0.7435357570648193
Epoch: 5, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.569 Vali Acc: 0.326 Test Loss: 1.569 Test Acc: 0.326
Validation loss decreased (-0.274058 --> -0.325910).  Saving model ...
Epoch: 6 cost time: 0.6800110340118408
Epoch: 6, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.514 Vali Acc: 0.374 Test Loss: 1.514 Test Acc: 0.374
Validation loss decreased (-0.325910 --> -0.374059).  Saving model ...
Epoch: 7 cost time: 0.6796808242797852
Epoch: 7, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.452 Vali Acc: 0.419 Test Loss: 1.452 Test Acc: 0.419
Validation loss decreased (-0.374059 --> -0.418504).  Saving model ...
Epoch: 8 cost time: 0.8105497360229492
Epoch: 8, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.387 Vali Acc: 0.485 Test Loss: 1.387 Test Acc: 0.485
Validation loss decreased (-0.418504 --> -0.485171).  Saving model ...
Epoch: 9 cost time: 0.6837172508239746
Epoch: 9, Steps: 2 | Train Loss: 1.257 Vali Loss: 1.316 Vali Acc: 0.559 Test Loss: 1.316 Test Acc: 0.559
Validation loss decreased (-0.485171 --> -0.559246).  Saving model ...
Epoch: 10 cost time: 0.6633706092834473
Epoch: 10, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.248 Vali Acc: 0.604 Test Loss: 1.248 Test Acc: 0.604
Validation loss decreased (-0.559246 --> -0.603691).  Saving model ...
Epoch: 11 cost time: 0.7276709079742432
Epoch: 11, Steps: 2 | Train Loss: 1.120 Vali Loss: 1.178 Vali Acc: 0.648 Test Loss: 1.178 Test Acc: 0.648
Validation loss decreased (-0.603691 --> -0.648136).  Saving model ...
Epoch: 12 cost time: 0.678635835647583
Epoch: 12, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.109 Vali Acc: 0.667 Test Loss: 1.109 Test Acc: 0.667
Validation loss decreased (-0.648136 --> -0.666656).  Saving model ...
Epoch: 13 cost time: 0.749614953994751
Epoch: 13, Steps: 2 | Train Loss: 0.904 Vali Loss: 1.042 Vali Acc: 0.689 Test Loss: 1.042 Test Acc: 0.689
Validation loss decreased (-0.666656 --> -0.688878).  Saving model ...
Epoch: 14 cost time: 0.7456440925598145
Epoch: 14, Steps: 2 | Train Loss: 0.921 Vali Loss: 0.978 Vali Acc: 0.726 Test Loss: 0.978 Test Acc: 0.726
Validation loss decreased (-0.688878 --> -0.725916).  Saving model ...
Epoch: 15 cost time: 0.728093147277832
Epoch: 15, Steps: 2 | Train Loss: 0.823 Vali Loss: 0.916 Vali Acc: 0.781 Test Loss: 0.916 Test Acc: 0.781
Validation loss decreased (-0.725916 --> -0.781472).  Saving model ...
Epoch: 16 cost time: 0.7004001140594482
Epoch: 16, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.858 Vali Acc: 0.793 Test Loss: 0.858 Test Acc: 0.793
Validation loss decreased (-0.781472 --> -0.792584).  Saving model ...
Epoch: 17 cost time: 0.7193155288696289
Epoch: 17, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.802 Vali Acc: 0.804 Test Loss: 0.802 Test Acc: 0.804
Validation loss decreased (-0.792584 --> -0.803696).  Saving model ...
Epoch: 18 cost time: 0.7598617076873779
Epoch: 18, Steps: 2 | Train Loss: 0.646 Vali Loss: 0.748 Vali Acc: 0.819 Test Loss: 0.748 Test Acc: 0.819
Validation loss decreased (-0.803696 --> -0.818511).  Saving model ...
Epoch: 19 cost time: 0.8664665222167969
Epoch: 19, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.699 Vali Acc: 0.833 Test Loss: 0.699 Test Acc: 0.833
Validation loss decreased (-0.818511 --> -0.833326).  Saving model ...
Epoch: 20 cost time: 0.7850213050842285
Epoch: 20, Steps: 2 | Train Loss: 0.570 Vali Loss: 0.652 Vali Acc: 0.844 Test Loss: 0.652 Test Acc: 0.844
Validation loss decreased (-0.833326 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.7900948524475098
Epoch: 21, Steps: 2 | Train Loss: 0.480 Vali Loss: 0.608 Vali Acc: 0.859 Test Loss: 0.608 Test Acc: 0.859
Validation loss decreased (-0.844438 --> -0.859253).  Saving model ...
Epoch: 22 cost time: 0.8138060569763184
Epoch: 22, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.568 Vali Acc: 0.874 Test Loss: 0.568 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 23 cost time: 0.7361512184143066
Epoch: 23, Steps: 2 | Train Loss: 0.382 Vali Loss: 0.530 Vali Acc: 0.900 Test Loss: 0.530 Test Acc: 0.900
Validation loss decreased (-0.874068 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.7681024074554443
Epoch: 24, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.496 Vali Acc: 0.904 Test Loss: 0.496 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 25 cost time: 0.7469444274902344
Epoch: 25, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.469 Vali Acc: 0.904 Test Loss: 0.469 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 26 cost time: 0.6490535736083984
Epoch: 26, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.442 Vali Acc: 0.915 Test Loss: 0.442 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.8028650283813477
Epoch: 27, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.419 Vali Acc: 0.922 Test Loss: 0.419 Test Acc: 0.922
Validation loss decreased (-0.914810 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 0.7196986675262451
Epoch: 28, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.398 Vali Acc: 0.919 Test Loss: 0.398 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5953333377838135
Epoch: 29, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.378 Vali Acc: 0.922 Test Loss: 0.378 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.6237354278564453
Epoch: 30, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.360 Vali Acc: 0.922 Test Loss: 0.360 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 0.5885553359985352
Epoch: 31, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.344 Vali Acc: 0.922 Test Loss: 0.344 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.7750983238220215
Epoch: 32, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.331 Vali Acc: 0.926 Test Loss: 0.331 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.6362838745117188
Epoch: 33, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.319 Vali Acc: 0.930 Test Loss: 0.319 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.7127728462219238
Epoch: 34, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.310 Vali Acc: 0.933 Test Loss: 0.310 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 35 cost time: 0.9049017429351807
Epoch: 35, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.7060360908508301
Epoch: 36, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.7452080249786377
Epoch: 37, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.285 Vali Acc: 0.926 Test Loss: 0.285 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.7848515510559082
Epoch: 38, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6739051342010498
Epoch: 39, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7726311683654785
Epoch: 40, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.770287275314331
Epoch: 41, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.767359733581543
Epoch: 42, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.671630859375
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7791805267333984
Epoch: 44, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.253 Vali Acc: 0.922 Test Loss: 0.253 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.8621196746826172
Epoch: 45, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.6678495407104492
Epoch: 46, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 280326
model size : 1.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.665595293045044
Epoch: 1, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.747 Vali Acc: 0.252 Test Loss: 1.747 Test Acc: 0.252
Validation loss decreased (inf --> -0.251834).  Saving model ...
Epoch: 2 cost time: 0.670280933380127
Epoch: 2, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.692 Vali Acc: 0.311 Test Loss: 1.692 Test Acc: 0.311
Validation loss decreased (-0.251834 --> -0.311094).  Saving model ...
Epoch: 3 cost time: 0.5916299819946289
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.650 Vali Acc: 0.363 Test Loss: 1.650 Test Acc: 0.363
Validation loss decreased (-0.311094 --> -0.362946).  Saving model ...
Epoch: 4 cost time: 0.622401237487793
Epoch: 4, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.613 Vali Acc: 0.400 Test Loss: 1.613 Test Acc: 0.400
Validation loss decreased (-0.362946 --> -0.399984).  Saving model ...
Epoch: 5 cost time: 0.6063976287841797
Epoch: 5, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.565 Vali Acc: 0.448 Test Loss: 1.565 Test Acc: 0.448
Validation loss decreased (-0.399984 --> -0.448132).  Saving model ...
Epoch: 6 cost time: 0.7967371940612793
Epoch: 6, Steps: 2 | Train Loss: 1.641 Vali Loss: 1.510 Vali Acc: 0.507 Test Loss: 1.510 Test Acc: 0.507
Validation loss decreased (-0.448132 --> -0.507392).  Saving model ...
Epoch: 7 cost time: 0.6175136566162109
Epoch: 7, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.449 Vali Acc: 0.559 Test Loss: 1.449 Test Acc: 0.559
Validation loss decreased (-0.507392 --> -0.559245).  Saving model ...
Epoch: 8 cost time: 0.6113290786743164
Epoch: 8, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.383 Vali Acc: 0.611 Test Loss: 1.383 Test Acc: 0.611
Validation loss decreased (-0.559245 --> -0.611097).  Saving model ...
Epoch: 9 cost time: 0.7221822738647461
Epoch: 9, Steps: 2 | Train Loss: 1.361 Vali Loss: 1.315 Vali Acc: 0.626 Test Loss: 1.315 Test Acc: 0.626
Validation loss decreased (-0.611097 --> -0.625913).  Saving model ...
Epoch: 10 cost time: 0.6971580982208252
Epoch: 10, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.244 Vali Acc: 0.656 Test Loss: 1.244 Test Acc: 0.656
Validation loss decreased (-0.625913 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 0.700136661529541
Epoch: 11, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.173 Vali Acc: 0.689 Test Loss: 1.173 Test Acc: 0.689
Validation loss decreased (-0.655543 --> -0.688877).  Saving model ...
Epoch: 12 cost time: 0.6668293476104736
Epoch: 12, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.102 Vali Acc: 0.715 Test Loss: 1.102 Test Acc: 0.715
Validation loss decreased (-0.688877 --> -0.714804).  Saving model ...
Epoch: 13 cost time: 0.6535971164703369
Epoch: 13, Steps: 2 | Train Loss: 0.956 Vali Loss: 1.031 Vali Acc: 0.733 Test Loss: 1.031 Test Acc: 0.733
Validation loss decreased (-0.714804 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 0.7740597724914551
Epoch: 14, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.964 Vali Acc: 0.752 Test Loss: 0.964 Test Acc: 0.752
Validation loss decreased (-0.733323 --> -0.751842).  Saving model ...
Epoch: 15 cost time: 0.6549293994903564
Epoch: 15, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.898 Vali Acc: 0.778 Test Loss: 0.898 Test Acc: 0.778
Validation loss decreased (-0.751842 --> -0.777769).  Saving model ...
Epoch: 16 cost time: 0.6317582130432129
Epoch: 16, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.838 Vali Acc: 0.793 Test Loss: 0.838 Test Acc: 0.793
Validation loss decreased (-0.777769 --> -0.792584).  Saving model ...
Epoch: 17 cost time: 0.5985727310180664
Epoch: 17, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.782 Vali Acc: 0.807 Test Loss: 0.782 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807400).  Saving model ...
Epoch: 18 cost time: 0.6297106742858887
Epoch: 18, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.727 Vali Acc: 0.837 Test Loss: 0.727 Test Acc: 0.837
Validation loss decreased (-0.807400 --> -0.837030).  Saving model ...
Epoch: 19 cost time: 0.6321449279785156
Epoch: 19, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.676 Vali Acc: 0.848 Test Loss: 0.676 Test Acc: 0.848
Validation loss decreased (-0.837030 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.699254035949707
Epoch: 20, Steps: 2 | Train Loss: 0.526 Vali Loss: 0.629 Vali Acc: 0.859 Test Loss: 0.629 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859253).  Saving model ...
Epoch: 21 cost time: 0.7549145221710205
Epoch: 21, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.586 Vali Acc: 0.874 Test Loss: 0.586 Test Acc: 0.874
Validation loss decreased (-0.859253 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.8521347045898438
Epoch: 22, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.547 Vali Acc: 0.904 Test Loss: 0.547 Test Acc: 0.904
Validation loss decreased (-0.874068 --> -0.903698).  Saving model ...
Epoch: 23 cost time: 0.7916786670684814
Epoch: 23, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.513 Vali Acc: 0.907 Test Loss: 0.513 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.7742688655853271
Epoch: 24, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.480 Vali Acc: 0.915 Test Loss: 0.480 Test Acc: 0.915
Validation loss decreased (-0.907402 --> -0.914810).  Saving model ...
Epoch: 25 cost time: 0.6979537010192871
Epoch: 25, Steps: 2 | Train Loss: 0.322 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.7151930332183838
Epoch: 26, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.426 Vali Acc: 0.930 Test Loss: 0.426 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.8689093589782715
Epoch: 27, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.403 Vali Acc: 0.937 Test Loss: 0.403 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 28 cost time: 0.6972100734710693
Epoch: 28, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.381 Vali Acc: 0.941 Test Loss: 0.381 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 29 cost time: 0.7550134658813477
Epoch: 29, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.362 Vali Acc: 0.944 Test Loss: 0.362 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.7817990779876709
Epoch: 30, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.344 Vali Acc: 0.944 Test Loss: 0.344 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.7247457504272461
Epoch: 31, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.327 Vali Acc: 0.948 Test Loss: 0.327 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.7017626762390137
Epoch: 32, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.313 Vali Acc: 0.948 Test Loss: 0.313 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.7786660194396973
Epoch: 33, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.301 Vali Acc: 0.948 Test Loss: 0.301 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 34 cost time: 0.7722158432006836
Epoch: 34, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.291 Vali Acc: 0.948 Test Loss: 0.291 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 35 cost time: 0.7146162986755371
Epoch: 35, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.281 Vali Acc: 0.948 Test Loss: 0.281 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 36 cost time: 0.6329305171966553
Epoch: 36, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.274 Vali Acc: 0.948 Test Loss: 0.274 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.6932544708251953
Epoch: 37, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.266 Vali Acc: 0.952 Test Loss: 0.266 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.6145734786987305
Epoch: 38, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.259 Vali Acc: 0.952 Test Loss: 0.259 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.7045323848724365
Epoch: 39, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.253 Vali Acc: 0.952 Test Loss: 0.253 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.6072063446044922
Epoch: 40, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.7402350902557373
Epoch: 41, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.243 Vali Acc: 0.952 Test Loss: 0.243 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.6371939182281494
Epoch: 42, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.237 Vali Acc: 0.952 Test Loss: 0.237 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 43 cost time: 0.6382005214691162
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.233 Vali Acc: 0.952 Test Loss: 0.233 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.7056121826171875
Epoch: 44, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.228 Vali Acc: 0.952 Test Loss: 0.228 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.6789638996124268
Epoch: 45, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.224 Vali Acc: 0.952 Test Loss: 0.224 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.7420456409454346
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.220 Vali Acc: 0.952 Test Loss: 0.220 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.665595293045044
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 48 cost time: 0.7632503509521484
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 49 cost time: 0.7625579833984375
Epoch: 49, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.7715821266174316
Epoch: 50, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.209 Vali Acc: 0.952 Test Loss: 0.209 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 51 cost time: 0.6651031970977783
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 52 cost time: 0.6195540428161621
Epoch: 52, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.952 Test Loss: 0.206 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 53 cost time: 0.7329511642456055
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.204 Vali Acc: 0.952 Test Loss: 0.204 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 54 cost time: 0.7517895698547363
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 55 cost time: 0.7021157741546631
Epoch: 55, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 56 cost time: 0.7153315544128418
Epoch: 56, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 57 cost time: 0.690826416015625
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 58 cost time: 0.6910436153411865
Epoch: 58, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 59 cost time: 0.6917190551757812
Epoch: 59, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.197 Vali Acc: 0.952 Test Loss: 0.197 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 60 cost time: 0.7539811134338379
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 61 cost time: 0.6991517543792725
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 62 cost time: 0.7486543655395508
Epoch: 62, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 63 cost time: 0.681384801864624
Epoch: 63, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.6932239532470703
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 65 cost time: 0.6207878589630127
Epoch: 65, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 66 cost time: 0.6536681652069092
Epoch: 66, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.952 Test Loss: 0.192 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 67 cost time: 0.6974730491638184
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 68 cost time: 0.7358617782592773
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.952 Test Loss: 0.191 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 69 cost time: 0.7080583572387695
Epoch: 69, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 70 cost time: 0.6977686882019043
Epoch: 70, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.952 Test Loss: 0.189 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 71 cost time: 0.6337988376617432
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 72 cost time: 0.7519679069519043
Epoch: 72, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 73 cost time: 0.6323850154876709
Epoch: 73, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 74 cost time: 0.7006316184997559
Epoch: 74, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 75 cost time: 0.7948386669158936
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 76 cost time: 0.7015185356140137
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 77 cost time: 0.6437022686004639
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 78 cost time: 0.8774874210357666
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 79 cost time: 0.675119161605835
Epoch: 79, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 80 cost time: 0.7590517997741699
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 81 cost time: 0.8345649242401123
Epoch: 81, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 82 cost time: 0.9510040283203125
Epoch: 82, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 83 cost time: 0.7815461158752441
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 84 cost time: 0.7235107421875
Epoch: 84, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 85 cost time: 0.736853837966919
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 86 cost time: 0.681016206741333
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.952 Test Loss: 0.179 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.7106759548187256
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.6410853862762451
Epoch: 88, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.178 Vali Acc: 0.952 Test Loss: 0.178 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.6977522373199463
Epoch: 89, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.5834910869598389
Epoch: 90, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.6185731887817383
Epoch: 91, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.7247731685638428
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.8234109878540039
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.6862547397613525
Epoch: 94, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.8052656650543213
Epoch: 95, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 149254
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.700634002685547
Epoch: 1, Steps: 2 | Train Loss: 1.796 Vali Loss: 1.738 Vali Acc: 0.267 Test Loss: 1.738 Test Acc: 0.267
Validation loss decreased (inf --> -0.266649).  Saving model ...
Epoch: 2 cost time: 0.8143110275268555
Epoch: 2, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.684 Vali Acc: 0.352 Test Loss: 1.684 Test Acc: 0.352
Validation loss decreased (-0.266649 --> -0.351835).  Saving model ...
Epoch: 3 cost time: 0.7664294242858887
Epoch: 3, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.643 Vali Acc: 0.407 Test Loss: 1.643 Test Acc: 0.407
Validation loss decreased (-0.351835 --> -0.407391).  Saving model ...
Epoch: 4 cost time: 0.6540591716766357
Epoch: 4, Steps: 2 | Train Loss: 1.632 Vali Loss: 1.605 Vali Acc: 0.459 Test Loss: 1.605 Test Acc: 0.459
Validation loss decreased (-0.407391 --> -0.459243).  Saving model ...
Epoch: 5 cost time: 0.7275810241699219
Epoch: 5, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.557 Vali Acc: 0.496 Test Loss: 1.557 Test Acc: 0.496
Validation loss decreased (-0.459243 --> -0.496281).  Saving model ...
Epoch: 6 cost time: 0.7056257724761963
Epoch: 6, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.503 Vali Acc: 0.541 Test Loss: 1.503 Test Acc: 0.541
Validation loss decreased (-0.496281 --> -0.540726).  Saving model ...
Epoch: 7 cost time: 0.6983201503753662
Epoch: 7, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.442 Vali Acc: 0.596 Test Loss: 1.442 Test Acc: 0.596
Validation loss decreased (-0.540726 --> -0.596282).  Saving model ...
Epoch: 8 cost time: 0.6321115493774414
Epoch: 8, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.377 Vali Acc: 0.615 Test Loss: 1.377 Test Acc: 0.615
Validation loss decreased (-0.596282 --> -0.614801).  Saving model ...
Epoch: 9 cost time: 0.6523003578186035
Epoch: 9, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.308 Vali Acc: 0.656 Test Loss: 1.308 Test Acc: 0.656
Validation loss decreased (-0.614801 --> -0.655542).  Saving model ...
Epoch: 10 cost time: 0.8068327903747559
Epoch: 10, Steps: 2 | Train Loss: 1.266 Vali Loss: 1.238 Vali Acc: 0.681 Test Loss: 1.238 Test Acc: 0.681
Validation loss decreased (-0.655542 --> -0.681469).  Saving model ...
Epoch: 11 cost time: 0.706366777420044
Epoch: 11, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.166 Vali Acc: 0.707 Test Loss: 1.166 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707396).  Saving model ...
Epoch: 12 cost time: 0.6663098335266113
Epoch: 12, Steps: 2 | Train Loss: 1.086 Vali Loss: 1.094 Vali Acc: 0.726 Test Loss: 1.094 Test Acc: 0.726
Validation loss decreased (-0.707396 --> -0.725915).  Saving model ...
Epoch: 13 cost time: 0.6832940578460693
Epoch: 13, Steps: 2 | Train Loss: 0.973 Vali Loss: 1.024 Vali Acc: 0.752 Test Loss: 1.024 Test Acc: 0.752
Validation loss decreased (-0.725915 --> -0.751842).  Saving model ...
Epoch: 14 cost time: 0.6466164588928223
Epoch: 14, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.957 Vali Acc: 0.759 Test Loss: 0.957 Test Acc: 0.759
Validation loss decreased (-0.751842 --> -0.759250).  Saving model ...
Epoch: 15 cost time: 0.6623263359069824
Epoch: 15, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.892 Vali Acc: 0.781 Test Loss: 0.892 Test Acc: 0.781
Validation loss decreased (-0.759250 --> -0.781473).  Saving model ...
Epoch: 16 cost time: 0.6285674571990967
Epoch: 16, Steps: 2 | Train Loss: 0.776 Vali Loss: 0.831 Vali Acc: 0.804 Test Loss: 0.831 Test Acc: 0.804
Validation loss decreased (-0.781473 --> -0.803695).  Saving model ...
Epoch: 17 cost time: 0.7035040855407715
Epoch: 17, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.774 Vali Acc: 0.815 Test Loss: 0.774 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814807).  Saving model ...
Epoch: 18 cost time: 0.7219846248626709
Epoch: 18, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.720 Vali Acc: 0.841 Test Loss: 0.720 Test Acc: 0.841
Validation loss decreased (-0.814807 --> -0.840734).  Saving model ...
Epoch: 19 cost time: 0.6644482612609863
Epoch: 19, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.669 Vali Acc: 0.852 Test Loss: 0.669 Test Acc: 0.852
Validation loss decreased (-0.840734 --> -0.851845).  Saving model ...
Epoch: 20 cost time: 0.6136000156402588
Epoch: 20, Steps: 2 | Train Loss: 0.521 Vali Loss: 0.622 Vali Acc: 0.885 Test Loss: 0.622 Test Acc: 0.885
Validation loss decreased (-0.851845 --> -0.885179).  Saving model ...
Epoch: 21 cost time: 0.6529202461242676
Epoch: 21, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.579 Vali Acc: 0.900 Test Loss: 0.579 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.6640365123748779
Epoch: 22, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.541 Vali Acc: 0.911 Test Loss: 0.541 Test Acc: 0.911
Validation loss decreased (-0.899994 --> -0.911106).  Saving model ...
Epoch: 23 cost time: 0.7642529010772705
Epoch: 23, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.506 Vali Acc: 0.922 Test Loss: 0.506 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.670595645904541
Epoch: 24, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.474 Vali Acc: 0.922 Test Loss: 0.474 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.7148239612579346
Epoch: 25, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.446 Vali Acc: 0.930 Test Loss: 0.446 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929625).  Saving model ...
Epoch: 26 cost time: 0.7326946258544922
Epoch: 26, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.420 Vali Acc: 0.930 Test Loss: 0.420 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.6858084201812744
Epoch: 27, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.396 Vali Acc: 0.930 Test Loss: 0.396 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 28 cost time: 0.6979057788848877
Epoch: 28, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.375 Vali Acc: 0.933 Test Loss: 0.375 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.7465801239013672
Epoch: 29, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.356 Vali Acc: 0.944 Test Loss: 0.356 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.7165181636810303
Epoch: 30, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.338 Vali Acc: 0.948 Test Loss: 0.338 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 31 cost time: 0.7761647701263428
Epoch: 31, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.322 Vali Acc: 0.948 Test Loss: 0.322 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.7508070468902588
Epoch: 32, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.308 Vali Acc: 0.948 Test Loss: 0.308 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 33 cost time: 0.7294206619262695
Epoch: 33, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.296 Vali Acc: 0.952 Test Loss: 0.296 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.6995062828063965
Epoch: 34, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.286 Vali Acc: 0.952 Test Loss: 0.286 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 35 cost time: 0.7471466064453125
Epoch: 35, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.276 Vali Acc: 0.952 Test Loss: 0.276 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 36 cost time: 0.6560261249542236
Epoch: 36, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.268 Vali Acc: 0.952 Test Loss: 0.268 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 37 cost time: 0.696181058883667
Epoch: 37, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.261 Vali Acc: 0.952 Test Loss: 0.261 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 38 cost time: 0.7412528991699219
Epoch: 38, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.254 Vali Acc: 0.952 Test Loss: 0.254 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 39 cost time: 0.6978199481964111
Epoch: 39, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.248 Vali Acc: 0.952 Test Loss: 0.248 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 40 cost time: 0.6311140060424805
Epoch: 40, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.241 Vali Acc: 0.952 Test Loss: 0.241 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 41 cost time: 0.6588225364685059
Epoch: 41, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951849).  Saving model ...
Epoch: 42 cost time: 0.7006709575653076
Epoch: 42, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
Validation loss decreased (-0.951849 --> -0.951850).  Saving model ...
Epoch: 43 cost time: 0.6844363212585449
Epoch: 43, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 44 cost time: 0.7100422382354736
Epoch: 44, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.952 Test Loss: 0.222 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 45 cost time: 0.7561774253845215
Epoch: 45, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 46 cost time: 0.7343077659606934
Epoch: 46, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 47 cost time: 0.7925209999084473
Epoch: 47, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.211 Vali Acc: 0.956 Test Loss: 0.211 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 48 cost time: 0.7103638648986816
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 49 cost time: 0.7985634803771973
Epoch: 49, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.7474126815795898
Epoch: 50, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 51 cost time: 0.7886543273925781
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 52 cost time: 0.7193238735198975
Epoch: 52, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 53 cost time: 0.7112586498260498
Epoch: 53, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 54 cost time: 0.6323559284210205
Epoch: 54, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 55 cost time: 0.779639720916748
Epoch: 55, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 56 cost time: 0.6611638069152832
Epoch: 56, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 57 cost time: 0.6933650970458984
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 58 cost time: 0.660517692565918
Epoch: 58, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.956 Test Loss: 0.190 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 59 cost time: 0.6832387447357178
Epoch: 59, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 60 cost time: 0.6711113452911377
Epoch: 60, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 61 cost time: 0.6322143077850342
Epoch: 61, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 62 cost time: 0.6240894794464111
Epoch: 62, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.187 Vali Acc: 0.952 Test Loss: 0.187 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.6693100929260254
Epoch: 63, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.7261416912078857
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.7254815101623535
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.6535258293151855
Epoch: 66, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.6880950927734375
Epoch: 67, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.7099556922912598
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.184 Vali Acc: 0.952 Test Loss: 0.184 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.6654384136199951
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.952 Test Loss: 0.183 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.6766328811645508
Epoch: 70, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.7536187171936035
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 149254
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4233829975128174
Epoch: 1, Steps: 2 | Train Loss: 1.784 Vali Loss: 1.714 Vali Acc: 0.270 Test Loss: 1.714 Test Acc: 0.270
Validation loss decreased (inf --> -0.270353).  Saving model ...
Epoch: 2 cost time: 0.8290462493896484
Epoch: 2, Steps: 2 | Train Loss: 1.825 Vali Loss: 1.661 Vali Acc: 0.348 Test Loss: 1.661 Test Acc: 0.348
Validation loss decreased (-0.270353 --> -0.348132).  Saving model ...
Epoch: 3 cost time: 0.6970305442810059
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.620 Vali Acc: 0.407 Test Loss: 1.620 Test Acc: 0.407
Validation loss decreased (-0.348132 --> -0.407391).  Saving model ...
Epoch: 4 cost time: 0.7584731578826904
Epoch: 4, Steps: 2 | Train Loss: 1.613 Vali Loss: 1.582 Vali Acc: 0.456 Test Loss: 1.582 Test Acc: 0.456
Validation loss decreased (-0.407391 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 0.692333459854126
Epoch: 5, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.534 Vali Acc: 0.504 Test Loss: 1.534 Test Acc: 0.504
Validation loss decreased (-0.455540 --> -0.503688).  Saving model ...
Epoch: 6 cost time: 0.6993789672851562
Epoch: 6, Steps: 2 | Train Loss: 1.628 Vali Loss: 1.480 Vali Acc: 0.556 Test Loss: 1.480 Test Acc: 0.556
Validation loss decreased (-0.503688 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 0.6874938011169434
Epoch: 7, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.420 Vali Acc: 0.600 Test Loss: 1.420 Test Acc: 0.600
Validation loss decreased (-0.555541 --> -0.599986).  Saving model ...
Epoch: 8 cost time: 0.7366139888763428
Epoch: 8, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.356 Vali Acc: 0.648 Test Loss: 1.356 Test Acc: 0.648
Validation loss decreased (-0.599986 --> -0.648135).  Saving model ...
Epoch: 9 cost time: 0.8547887802124023
Epoch: 9, Steps: 2 | Train Loss: 1.353 Vali Loss: 1.289 Vali Acc: 0.678 Test Loss: 1.289 Test Acc: 0.678
Validation loss decreased (-0.648135 --> -0.677765).  Saving model ...
Epoch: 10 cost time: 0.7857449054718018
Epoch: 10, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.220 Vali Acc: 0.700 Test Loss: 1.220 Test Acc: 0.700
Validation loss decreased (-0.677765 --> -0.699988).  Saving model ...
Epoch: 11 cost time: 0.6858682632446289
Epoch: 11, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.149 Vali Acc: 0.730 Test Loss: 1.149 Test Acc: 0.730
Validation loss decreased (-0.699988 --> -0.729618).  Saving model ...
Epoch: 12 cost time: 0.7191305160522461
Epoch: 12, Steps: 2 | Train Loss: 1.104 Vali Loss: 1.078 Vali Acc: 0.748 Test Loss: 1.078 Test Acc: 0.748
Validation loss decreased (-0.729618 --> -0.748137).  Saving model ...
Epoch: 13 cost time: 0.6820266246795654
Epoch: 13, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.007 Vali Acc: 0.774 Test Loss: 1.007 Test Acc: 0.774
Validation loss decreased (-0.748137 --> -0.774064).  Saving model ...
Epoch: 14 cost time: 0.7733595371246338
Epoch: 14, Steps: 2 | Train Loss: 0.906 Vali Loss: 0.940 Vali Acc: 0.778 Test Loss: 0.940 Test Acc: 0.778
Validation loss decreased (-0.774064 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 0.6829514503479004
Epoch: 15, Steps: 2 | Train Loss: 0.851 Vali Loss: 0.876 Vali Acc: 0.800 Test Loss: 0.876 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.7011358737945557
Epoch: 16, Steps: 2 | Train Loss: 0.769 Vali Loss: 0.815 Vali Acc: 0.826 Test Loss: 0.815 Test Acc: 0.826
Validation loss decreased (-0.799991 --> -0.825918).  Saving model ...
Epoch: 17 cost time: 0.7022707462310791
Epoch: 17, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.758 Vali Acc: 0.833 Test Loss: 0.758 Test Acc: 0.833
Validation loss decreased (-0.825918 --> -0.833326).  Saving model ...
Epoch: 18 cost time: 0.7101919651031494
Epoch: 18, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.702 Vali Acc: 0.852 Test Loss: 0.702 Test Acc: 0.852
Validation loss decreased (-0.833326 --> -0.851845).  Saving model ...
Epoch: 19 cost time: 0.7966699600219727
Epoch: 19, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.653 Vali Acc: 0.867 Test Loss: 0.653 Test Acc: 0.867
Validation loss decreased (-0.851845 --> -0.866660).  Saving model ...
Epoch: 20 cost time: 0.7326927185058594
Epoch: 20, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.606 Vali Acc: 0.889 Test Loss: 0.606 Test Acc: 0.889
Validation loss decreased (-0.866660 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 0.7151849269866943
Epoch: 21, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.564 Vali Acc: 0.915 Test Loss: 0.564 Test Acc: 0.915
Validation loss decreased (-0.888883 --> -0.914809).  Saving model ...
Epoch: 22 cost time: 0.7833664417266846
Epoch: 22, Steps: 2 | Train Loss: 0.396 Vali Loss: 0.527 Vali Acc: 0.926 Test Loss: 0.527 Test Acc: 0.926
Validation loss decreased (-0.914809 --> -0.925921).  Saving model ...
Epoch: 23 cost time: 0.8496575355529785
Epoch: 23, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.492 Vali Acc: 0.937 Test Loss: 0.492 Test Acc: 0.937
Validation loss decreased (-0.925921 --> -0.937032).  Saving model ...
Epoch: 24 cost time: 0.6746065616607666
Epoch: 24, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.461 Vali Acc: 0.937 Test Loss: 0.461 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937032).  Saving model ...
Epoch: 25 cost time: 0.6570186614990234
Epoch: 25, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.433 Vali Acc: 0.937 Test Loss: 0.433 Test Acc: 0.937
Validation loss decreased (-0.937032 --> -0.937033).  Saving model ...
Epoch: 26 cost time: 0.7405140399932861
Epoch: 26, Steps: 2 | Train Loss: 0.271 Vali Loss: 0.408 Vali Acc: 0.937 Test Loss: 0.408 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937033).  Saving model ...
Epoch: 27 cost time: 0.7276833057403564
Epoch: 27, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.385 Vali Acc: 0.941 Test Loss: 0.385 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 28 cost time: 0.7140965461730957
Epoch: 28, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.364 Vali Acc: 0.944 Test Loss: 0.364 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 29 cost time: 0.9217209815979004
Epoch: 29, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.345 Vali Acc: 0.944 Test Loss: 0.345 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 30 cost time: 0.7540287971496582
Epoch: 30, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.328 Vali Acc: 0.944 Test Loss: 0.328 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 31 cost time: 0.7105453014373779
Epoch: 31, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.312 Vali Acc: 0.948 Test Loss: 0.312 Test Acc: 0.948
Validation loss decreased (-0.944441 --> -0.948145).  Saving model ...
Epoch: 32 cost time: 0.9297842979431152
Epoch: 32, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.298 Vali Acc: 0.944 Test Loss: 0.298 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.7537412643432617
Epoch: 33, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.286 Vali Acc: 0.952 Test Loss: 0.286 Test Acc: 0.952
Validation loss decreased (-0.948145 --> -0.951849).  Saving model ...
Epoch: 34 cost time: 0.7990913391113281
Epoch: 34, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.275 Vali Acc: 0.956 Test Loss: 0.275 Test Acc: 0.956
Validation loss decreased (-0.951849 --> -0.955553).  Saving model ...
Epoch: 35 cost time: 0.704603910446167
Epoch: 35, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.266 Vali Acc: 0.956 Test Loss: 0.266 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 36 cost time: 0.6844308376312256
Epoch: 36, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.257 Vali Acc: 0.956 Test Loss: 0.257 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 37 cost time: 0.6652679443359375
Epoch: 37, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.250 Vali Acc: 0.952 Test Loss: 0.250 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6717398166656494
Epoch: 38, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.242 Vali Acc: 0.952 Test Loss: 0.242 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.689378023147583
Epoch: 39, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.236 Vali Acc: 0.952 Test Loss: 0.236 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.7117502689361572
Epoch: 40, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.231 Vali Acc: 0.952 Test Loss: 0.231 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.7389843463897705
Epoch: 41, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.226 Vali Acc: 0.952 Test Loss: 0.226 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.7473487854003906
Epoch: 42, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.222 Vali Acc: 0.952 Test Loss: 0.222 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.7567448616027832
Epoch: 43, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.217 Vali Acc: 0.952 Test Loss: 0.217 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.7195804119110107
Epoch: 44, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 45 cost time: 0.7036576271057129
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 46 cost time: 0.7570605278015137
Epoch: 46, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.207 Vali Acc: 0.956 Test Loss: 0.207 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 47 cost time: 0.806795597076416
Epoch: 47, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 48 cost time: 0.7349696159362793
Epoch: 48, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 49 cost time: 0.7568860054016113
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.201 Vali Acc: 0.956 Test Loss: 0.201 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 50 cost time: 0.7714169025421143
Epoch: 50, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 51 cost time: 0.7357254028320312
Epoch: 51, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 52 cost time: 0.7681174278259277
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.195 Vali Acc: 0.956 Test Loss: 0.195 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 53 cost time: 0.7645833492279053
Epoch: 53, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.193 Vali Acc: 0.956 Test Loss: 0.193 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 54 cost time: 0.7888693809509277
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.192 Vali Acc: 0.956 Test Loss: 0.192 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 55 cost time: 0.7806017398834229
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.191 Vali Acc: 0.956 Test Loss: 0.191 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 56 cost time: 0.7791609764099121
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.189 Vali Acc: 0.956 Test Loss: 0.189 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 57 cost time: 0.7293751239776611
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.188 Vali Acc: 0.956 Test Loss: 0.188 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 58 cost time: 0.7498476505279541
Epoch: 58, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 59 cost time: 0.7281482219696045
Epoch: 59, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.185 Vali Acc: 0.956 Test Loss: 0.185 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 60 cost time: 0.6644504070281982
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.184 Vali Acc: 0.956 Test Loss: 0.184 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 61 cost time: 0.7244467735290527
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.183 Vali Acc: 0.956 Test Loss: 0.183 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 62 cost time: 0.6276366710662842
Epoch: 62, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.182 Vali Acc: 0.956 Test Loss: 0.182 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 63 cost time: 0.7104675769805908
Epoch: 63, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.181 Vali Acc: 0.956 Test Loss: 0.181 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 64 cost time: 0.7024037837982178
Epoch: 64, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 65 cost time: 0.7284142971038818
Epoch: 65, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 66 cost time: 0.6724636554718018
Epoch: 66, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 67 cost time: 0.748539924621582
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 68 cost time: 0.7860555648803711
Epoch: 68, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 69 cost time: 0.7323558330535889
Epoch: 69, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 70 cost time: 0.6662693023681641
Epoch: 70, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 71 cost time: 0.9023983478546143
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.175 Vali Acc: 0.956 Test Loss: 0.175 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 72 cost time: 0.7923092842102051
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.174 Vali Acc: 0.956 Test Loss: 0.174 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 73 cost time: 0.7092530727386475
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.173 Vali Acc: 0.956 Test Loss: 0.173 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 74 cost time: 0.7001340389251709
Epoch: 74, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 75 cost time: 0.6615562438964844
Epoch: 75, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.172 Vali Acc: 0.956 Test Loss: 0.172 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 76 cost time: 0.6840612888336182
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.171 Vali Acc: 0.956 Test Loss: 0.171 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 77 cost time: 0.698875904083252
Epoch: 77, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.170 Vali Acc: 0.956 Test Loss: 0.170 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 78 cost time: 0.7083621025085449
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.169 Vali Acc: 0.956 Test Loss: 0.169 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 79 cost time: 0.8385777473449707
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.168 Vali Acc: 0.956 Test Loss: 0.168 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 80 cost time: 0.7824227809906006
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 81 cost time: 0.6971533298492432
Epoch: 81, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.167 Vali Acc: 0.956 Test Loss: 0.167 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 82 cost time: 0.6781680583953857
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 83 cost time: 0.7087085247039795
Epoch: 83, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.166 Vali Acc: 0.956 Test Loss: 0.166 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 84 cost time: 0.7478697299957275
Epoch: 84, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.165 Vali Acc: 0.956 Test Loss: 0.165 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 85 cost time: 0.6573245525360107
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 86 cost time: 0.6867716312408447
Epoch: 86, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 87 cost time: 0.651146411895752
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.164 Vali Acc: 0.956 Test Loss: 0.164 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 88 cost time: 0.6773025989532471
Epoch: 88, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 89 cost time: 0.7167890071868896
Epoch: 89, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.163 Vali Acc: 0.956 Test Loss: 0.163 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 90 cost time: 0.7381951808929443
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 91 cost time: 0.7158010005950928
Epoch: 91, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.162 Vali Acc: 0.956 Test Loss: 0.162 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 92 cost time: 0.7970786094665527
Epoch: 92, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 93 cost time: 0.7053804397583008
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 94 cost time: 0.7179036140441895
Epoch: 94, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 95 cost time: 0.7681283950805664
Epoch: 95, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.161 Vali Acc: 0.956 Test Loss: 0.161 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 96 cost time: 0.7491941452026367
Epoch: 96, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 97 cost time: 0.8100385665893555
Epoch: 97, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 98 cost time: 0.7804644107818604
Epoch: 98, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.160 Vali Acc: 0.956 Test Loss: 0.160 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 99 cost time: 0.6933629512786865
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 100 cost time: 0.7320752143859863
Epoch: 100, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.159 Vali Acc: 0.956 Test Loss: 0.159 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 149254
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6491458415985107
Epoch: 1, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.718 Vali Acc: 0.237 Test Loss: 1.718 Test Acc: 0.237
Validation loss decreased (inf --> -0.237020).  Saving model ...
Epoch: 2 cost time: 0.7626488208770752
Epoch: 2, Steps: 2 | Train Loss: 1.850 Vali Loss: 1.667 Vali Acc: 0.307 Test Loss: 1.667 Test Acc: 0.307
Validation loss decreased (-0.237020 --> -0.307391).  Saving model ...
Epoch: 3 cost time: 0.6653416156768799
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.627 Vali Acc: 0.374 Test Loss: 1.627 Test Acc: 0.374
Validation loss decreased (-0.307391 --> -0.374058).  Saving model ...
Epoch: 4 cost time: 0.6305277347564697
Epoch: 4, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.590 Vali Acc: 0.407 Test Loss: 1.590 Test Acc: 0.407
Validation loss decreased (-0.374058 --> -0.407392).  Saving model ...
Epoch: 5 cost time: 0.6390643119812012
Epoch: 5, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.544 Vali Acc: 0.478 Test Loss: 1.544 Test Acc: 0.478
Validation loss decreased (-0.407392 --> -0.477762).  Saving model ...
Epoch: 6 cost time: 0.7244412899017334
Epoch: 6, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.491 Vali Acc: 0.548 Test Loss: 1.491 Test Acc: 0.548
Validation loss decreased (-0.477762 --> -0.548133).  Saving model ...
Epoch: 7 cost time: 0.6473190784454346
Epoch: 7, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.432 Vali Acc: 0.596 Test Loss: 1.432 Test Acc: 0.596
Validation loss decreased (-0.548133 --> -0.596282).  Saving model ...
Epoch: 8 cost time: 0.7288281917572021
Epoch: 8, Steps: 2 | Train Loss: 1.441 Vali Loss: 1.368 Vali Acc: 0.648 Test Loss: 1.368 Test Acc: 0.648
Validation loss decreased (-0.596282 --> -0.648134).  Saving model ...
Epoch: 9 cost time: 0.6945502758026123
Epoch: 9, Steps: 2 | Train Loss: 1.330 Vali Loss: 1.301 Vali Acc: 0.681 Test Loss: 1.301 Test Acc: 0.681
Validation loss decreased (-0.648134 --> -0.681468).  Saving model ...
Epoch: 10 cost time: 0.6093814373016357
Epoch: 10, Steps: 2 | Train Loss: 1.326 Vali Loss: 1.233 Vali Acc: 0.719 Test Loss: 1.233 Test Acc: 0.719
Validation loss decreased (-0.681468 --> -0.718506).  Saving model ...
Epoch: 11 cost time: 0.6113009452819824
Epoch: 11, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.163 Vali Acc: 0.741 Test Loss: 1.163 Test Acc: 0.741
Validation loss decreased (-0.718506 --> -0.740729).  Saving model ...
Epoch: 12 cost time: 0.6127338409423828
Epoch: 12, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.093 Vali Acc: 0.756 Test Loss: 1.093 Test Acc: 0.756
Validation loss decreased (-0.740729 --> -0.755545).  Saving model ...
Epoch: 13 cost time: 0.6964099407196045
Epoch: 13, Steps: 2 | Train Loss: 1.023 Vali Loss: 1.024 Vali Acc: 0.763 Test Loss: 1.024 Test Acc: 0.763
Validation loss decreased (-0.755545 --> -0.762953).  Saving model ...
Epoch: 14 cost time: 0.6639688014984131
Epoch: 14, Steps: 2 | Train Loss: 0.954 Vali Loss: 0.959 Vali Acc: 0.767 Test Loss: 0.959 Test Acc: 0.767
Validation loss decreased (-0.762953 --> -0.766657).  Saving model ...
Epoch: 15 cost time: 0.6964962482452393
Epoch: 15, Steps: 2 | Train Loss: 0.894 Vali Loss: 0.896 Vali Acc: 0.774 Test Loss: 0.896 Test Acc: 0.774
Validation loss decreased (-0.766657 --> -0.774065).  Saving model ...
Epoch: 16 cost time: 0.6179587841033936
Epoch: 16, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.837 Vali Acc: 0.785 Test Loss: 0.837 Test Acc: 0.785
Validation loss decreased (-0.774065 --> -0.785177).  Saving model ...
Epoch: 17 cost time: 0.6907861232757568
Epoch: 17, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.780 Vali Acc: 0.804 Test Loss: 0.780 Test Acc: 0.804
Validation loss decreased (-0.785177 --> -0.803696).  Saving model ...
Epoch: 18 cost time: 0.76094651222229
Epoch: 18, Steps: 2 | Train Loss: 0.686 Vali Loss: 0.726 Vali Acc: 0.822 Test Loss: 0.726 Test Acc: 0.822
Validation loss decreased (-0.803696 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 0.7421071529388428
Epoch: 19, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.677 Vali Acc: 0.848 Test Loss: 0.677 Test Acc: 0.848
Validation loss decreased (-0.822215 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.6329305171966553
Epoch: 20, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.632 Vali Acc: 0.885 Test Loss: 0.632 Test Acc: 0.885
Validation loss decreased (-0.848141 --> -0.885179).  Saving model ...
Epoch: 21 cost time: 0.6903703212738037
Epoch: 21, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.590 Vali Acc: 0.900 Test Loss: 0.590 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.7293827533721924
Epoch: 22, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.553 Vali Acc: 0.907 Test Loss: 0.553 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 23 cost time: 0.782996416091919
Epoch: 23, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.519 Vali Acc: 0.922 Test Loss: 0.519 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.7270851135253906
Epoch: 24, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.489 Vali Acc: 0.922 Test Loss: 0.489 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.7240345478057861
Epoch: 25, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.460 Vali Acc: 0.926 Test Loss: 0.460 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.6561036109924316
Epoch: 26, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.436 Vali Acc: 0.926 Test Loss: 0.436 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 27 cost time: 0.7366087436676025
Epoch: 27, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.413 Vali Acc: 0.922 Test Loss: 0.413 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6197187900543213
Epoch: 28, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.392 Vali Acc: 0.922 Test Loss: 0.392 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.686030387878418
Epoch: 29, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.372 Vali Acc: 0.933 Test Loss: 0.372 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.6352026462554932
Epoch: 30, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.355 Vali Acc: 0.933 Test Loss: 0.355 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.5788426399230957
Epoch: 31, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.339 Vali Acc: 0.937 Test Loss: 0.339 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.6778237819671631
Epoch: 32, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.324 Vali Acc: 0.941 Test Loss: 0.324 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.5874490737915039
Epoch: 33, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6193265914916992
Epoch: 34, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 35 cost time: 0.6457650661468506
Epoch: 35, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.292 Vali Acc: 0.941 Test Loss: 0.292 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.5844786167144775
Epoch: 36, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6367330551147461
Epoch: 37, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.275 Vali Acc: 0.937 Test Loss: 0.275 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6426181793212891
Epoch: 38, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.628870964050293
Epoch: 39, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.262 Vali Acc: 0.937 Test Loss: 0.262 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6692416667938232
Epoch: 40, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.258 Vali Acc: 0.941 Test Loss: 0.258 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 41 cost time: 0.6483509540557861
Epoch: 41, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 42 cost time: 0.7819004058837891
Epoch: 42, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.7866103649139404
Epoch: 43, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.657487154006958
Epoch: 44, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.6954574584960938
Epoch: 45, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.6356034278869629
Epoch: 46, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.6731739044189453
Epoch: 47, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.607527494430542
Epoch: 48, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.7381093502044678
Epoch: 49, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.5903210639953613
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.6421566009521484
Epoch: 51, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.626448392868042
Epoch: 52, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.7396726608276367
Epoch: 53, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.6381585597991943
Epoch: 54, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.681394100189209
Epoch: 55, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 149254
model size : 1.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.500728130340576
Epoch: 1, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.854 Vali Acc: 0.196 Test Loss: 1.854 Test Acc: 0.196
Validation loss decreased (inf --> -0.196278).  Saving model ...
Epoch: 2 cost time: 0.7065126895904541
Epoch: 2, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.791 Vali Acc: 0.219 Test Loss: 1.791 Test Acc: 0.219
Validation loss decreased (-0.196278 --> -0.218501).  Saving model ...
Epoch: 3 cost time: 0.6832575798034668
Epoch: 3, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.745 Vali Acc: 0.230 Test Loss: 1.745 Test Acc: 0.230
Validation loss decreased (-0.218501 --> -0.229612).  Saving model ...
Epoch: 4 cost time: 0.6369225978851318
Epoch: 4, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.701 Vali Acc: 0.252 Test Loss: 1.701 Test Acc: 0.252
Validation loss decreased (-0.229612 --> -0.251835).  Saving model ...
Epoch: 5 cost time: 0.6928107738494873
Epoch: 5, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.646 Vali Acc: 0.289 Test Loss: 1.646 Test Acc: 0.289
Validation loss decreased (-0.251835 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.7373919486999512
Epoch: 6, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.582 Vali Acc: 0.352 Test Loss: 1.582 Test Acc: 0.352
Validation loss decreased (-0.288872 --> -0.351836).  Saving model ...
Epoch: 7 cost time: 0.7297201156616211
Epoch: 7, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.512 Vali Acc: 0.422 Test Loss: 1.512 Test Acc: 0.422
Validation loss decreased (-0.351836 --> -0.422207).  Saving model ...
Epoch: 8 cost time: 0.662961483001709
Epoch: 8, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.437 Vali Acc: 0.500 Test Loss: 1.437 Test Acc: 0.500
Validation loss decreased (-0.422207 --> -0.499986).  Saving model ...
Epoch: 9 cost time: 0.7907581329345703
Epoch: 9, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.362 Vali Acc: 0.589 Test Loss: 1.362 Test Acc: 0.589
Validation loss decreased (-0.499986 --> -0.588875).  Saving model ...
Epoch: 10 cost time: 0.649573564529419
Epoch: 10, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.284 Vali Acc: 0.637 Test Loss: 1.284 Test Acc: 0.637
Validation loss decreased (-0.588875 --> -0.637024).  Saving model ...
Epoch: 11 cost time: 0.6333510875701904
Epoch: 11, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.206 Vali Acc: 0.707 Test Loss: 1.206 Test Acc: 0.707
Validation loss decreased (-0.637024 --> -0.707395).  Saving model ...
Epoch: 12 cost time: 0.6970829963684082
Epoch: 12, Steps: 2 | Train Loss: 1.134 Vali Loss: 1.128 Vali Acc: 0.756 Test Loss: 1.128 Test Acc: 0.756
Validation loss decreased (-0.707395 --> -0.755544).  Saving model ...
Epoch: 13 cost time: 0.6509194374084473
Epoch: 13, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.050 Vali Acc: 0.778 Test Loss: 1.050 Test Acc: 0.778
Validation loss decreased (-0.755544 --> -0.777767).  Saving model ...
Epoch: 14 cost time: 0.7492737770080566
Epoch: 14, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.978 Vali Acc: 0.826 Test Loss: 0.978 Test Acc: 0.826
Validation loss decreased (-0.777767 --> -0.825916).  Saving model ...
Epoch: 15 cost time: 0.6456620693206787
Epoch: 15, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.908 Vali Acc: 0.844 Test Loss: 0.908 Test Acc: 0.844
Validation loss decreased (-0.825916 --> -0.844435).  Saving model ...
Epoch: 16 cost time: 0.7126893997192383
Epoch: 16, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.843 Vali Acc: 0.856 Test Loss: 0.843 Test Acc: 0.856
Validation loss decreased (-0.844435 --> -0.855547).  Saving model ...
Epoch: 17 cost time: 0.7073080539703369
Epoch: 17, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.784 Vali Acc: 0.874 Test Loss: 0.784 Test Acc: 0.874
Validation loss decreased (-0.855547 --> -0.874066).  Saving model ...
Epoch: 18 cost time: 0.6562442779541016
Epoch: 18, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.729 Vali Acc: 0.878 Test Loss: 0.729 Test Acc: 0.878
Validation loss decreased (-0.874066 --> -0.877770).  Saving model ...
Epoch: 19 cost time: 0.735637903213501
Epoch: 19, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.678 Vali Acc: 0.881 Test Loss: 0.678 Test Acc: 0.881
Validation loss decreased (-0.877770 --> -0.881475).  Saving model ...
Epoch: 20 cost time: 0.6582314968109131
Epoch: 20, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.632 Vali Acc: 0.896 Test Loss: 0.632 Test Acc: 0.896
Validation loss decreased (-0.881475 --> -0.896290).  Saving model ...
Epoch: 21 cost time: 0.6573834419250488
Epoch: 21, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.589 Vali Acc: 0.911 Test Loss: 0.589 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 22 cost time: 0.7123761177062988
Epoch: 22, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.549 Vali Acc: 0.922 Test Loss: 0.549 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922217).  Saving model ...
Epoch: 23 cost time: 0.6313929557800293
Epoch: 23, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.512 Vali Acc: 0.926 Test Loss: 0.512 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 24 cost time: 0.6497764587402344
Epoch: 24, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.479 Vali Acc: 0.926 Test Loss: 0.479 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.7142252922058105
Epoch: 25, Steps: 2 | Train Loss: 0.321 Vali Loss: 0.449 Vali Acc: 0.926 Test Loss: 0.449 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.6595420837402344
Epoch: 26, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.422 Vali Acc: 0.926 Test Loss: 0.422 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 27 cost time: 0.709277868270874
Epoch: 27, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.397 Vali Acc: 0.933 Test Loss: 0.397 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.6965508460998535
Epoch: 28, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.375 Vali Acc: 0.930 Test Loss: 0.375 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.5977680683135986
Epoch: 29, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.357 Vali Acc: 0.941 Test Loss: 0.357 Test Acc: 0.941
Validation loss decreased (-0.933329 --> -0.940737).  Saving model ...
Epoch: 30 cost time: 0.6052730083465576
Epoch: 30, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.340 Vali Acc: 0.941 Test Loss: 0.340 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 31 cost time: 0.5749516487121582
Epoch: 31, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.326 Vali Acc: 0.941 Test Loss: 0.326 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940737).  Saving model ...
Epoch: 32 cost time: 0.5674030780792236
Epoch: 32, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.313 Vali Acc: 0.944 Test Loss: 0.313 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 0.6157782077789307
Epoch: 33, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.301 Vali Acc: 0.941 Test Loss: 0.301 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.8326301574707031
Epoch: 34, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.291 Vali Acc: 0.944 Test Loss: 0.291 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6793768405914307
Epoch: 35, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.282 Vali Acc: 0.944 Test Loss: 0.282 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6441473960876465
Epoch: 36, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.273 Vali Acc: 0.944 Test Loss: 0.273 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.7883436679840088
Epoch: 37, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.267 Vali Acc: 0.944 Test Loss: 0.267 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.7587761878967285
Epoch: 38, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6647472381591797
Epoch: 39, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.728949785232544
Epoch: 40, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6512961387634277
Epoch: 41, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.246 Vali Acc: 0.944 Test Loss: 0.246 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6807177066802979
Epoch: 42, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.241 Vali Acc: 0.948 Test Loss: 0.241 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.7754442691802979
Epoch: 43, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.948 Test Loss: 0.237 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.6887049674987793
Epoch: 44, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.233 Vali Acc: 0.948 Test Loss: 0.233 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.7324185371398926
Epoch: 45, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.230 Vali Acc: 0.948 Test Loss: 0.230 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.7192142009735107
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.227 Vali Acc: 0.948 Test Loss: 0.227 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.6837954521179199
Epoch: 47, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.224 Vali Acc: 0.948 Test Loss: 0.224 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.6795487403869629
Epoch: 48, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.221 Vali Acc: 0.948 Test Loss: 0.221 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.6773269176483154
Epoch: 49, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.218 Vali Acc: 0.952 Test Loss: 0.218 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.7585575580596924
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.215 Vali Acc: 0.956 Test Loss: 0.215 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 51 cost time: 0.7120366096496582
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.956 Test Loss: 0.213 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 52 cost time: 0.7511425018310547
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.956 Test Loss: 0.210 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 53 cost time: 0.6536846160888672
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.208 Vali Acc: 0.956 Test Loss: 0.208 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 54 cost time: 0.7167632579803467
Epoch: 54, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955553).  Saving model ...
Epoch: 55 cost time: 0.6913433074951172
Epoch: 55, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6959233283996582
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.6764576435089111
Epoch: 57, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6528749465942383
Epoch: 58, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.6486465930938721
Epoch: 59, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7434682846069336
Epoch: 60, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.7959921360015869
Epoch: 61, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.7868814468383789
Epoch: 62, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.7784535884857178
Epoch: 63, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.8062303066253662
Epoch: 64, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 83718
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.7378575801849365
Epoch: 1, Steps: 2 | Train Loss: 1.947 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.7018933296203613
Epoch: 2, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.807 Vali Acc: 0.200 Test Loss: 1.807 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6653604507446289
Epoch: 3, Steps: 2 | Train Loss: 1.852 Vali Loss: 1.759 Vali Acc: 0.222 Test Loss: 1.759 Test Acc: 0.222
Validation loss decreased (-0.199982 --> -0.222205).  Saving model ...
Epoch: 4 cost time: 0.7818424701690674
Epoch: 4, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.715 Vali Acc: 0.248 Test Loss: 1.715 Test Acc: 0.248
Validation loss decreased (-0.222205 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.8253843784332275
Epoch: 5, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.659 Vali Acc: 0.289 Test Loss: 1.659 Test Acc: 0.289
Validation loss decreased (-0.248131 --> -0.288872).  Saving model ...
Epoch: 6 cost time: 0.6558792591094971
Epoch: 6, Steps: 2 | Train Loss: 1.532 Vali Loss: 1.595 Vali Acc: 0.344 Test Loss: 1.595 Test Acc: 0.344
Validation loss decreased (-0.288872 --> -0.344428).  Saving model ...
Epoch: 7 cost time: 0.9636237621307373
Epoch: 7, Steps: 2 | Train Loss: 1.512 Vali Loss: 1.524 Vali Acc: 0.407 Test Loss: 1.524 Test Acc: 0.407
Validation loss decreased (-0.344428 --> -0.407392).  Saving model ...
Epoch: 8 cost time: 0.7455999851226807
Epoch: 8, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.449 Vali Acc: 0.504 Test Loss: 1.449 Test Acc: 0.504
Validation loss decreased (-0.407392 --> -0.503689).  Saving model ...
Epoch: 9 cost time: 0.7284948825836182
Epoch: 9, Steps: 2 | Train Loss: 1.338 Vali Loss: 1.372 Vali Acc: 0.585 Test Loss: 1.372 Test Acc: 0.585
Validation loss decreased (-0.503689 --> -0.585171).  Saving model ...
Epoch: 10 cost time: 0.7264020442962646
Epoch: 10, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.293 Vali Acc: 0.648 Test Loss: 1.293 Test Acc: 0.648
Validation loss decreased (-0.585171 --> -0.648135).  Saving model ...
Epoch: 11 cost time: 0.6781010627746582
Epoch: 11, Steps: 2 | Train Loss: 1.212 Vali Loss: 1.214 Vali Acc: 0.693 Test Loss: 1.214 Test Acc: 0.693
Validation loss decreased (-0.648135 --> -0.692580).  Saving model ...
Epoch: 12 cost time: 0.7393174171447754
Epoch: 12, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.136 Vali Acc: 0.737 Test Loss: 1.136 Test Acc: 0.737
Validation loss decreased (-0.692580 --> -0.737026).  Saving model ...
Epoch: 13 cost time: 0.7443926334381104
Epoch: 13, Steps: 2 | Train Loss: 0.977 Vali Loss: 1.059 Vali Acc: 0.778 Test Loss: 1.059 Test Acc: 0.778
Validation loss decreased (-0.737026 --> -0.777767).  Saving model ...
Epoch: 14 cost time: 0.6611051559448242
Epoch: 14, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.984 Vali Acc: 0.800 Test Loss: 0.984 Test Acc: 0.800
Validation loss decreased (-0.777767 --> -0.799990).  Saving model ...
Epoch: 15 cost time: 0.7513251304626465
Epoch: 15, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.915 Vali Acc: 0.844 Test Loss: 0.915 Test Acc: 0.844
Validation loss decreased (-0.799990 --> -0.844435).  Saving model ...
Epoch: 16 cost time: 0.689007043838501
Epoch: 16, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.849 Vali Acc: 0.863 Test Loss: 0.849 Test Acc: 0.863
Validation loss decreased (-0.844435 --> -0.862954).  Saving model ...
Epoch: 17 cost time: 0.7743029594421387
Epoch: 17, Steps: 2 | Train Loss: 0.722 Vali Loss: 0.789 Vali Acc: 0.878 Test Loss: 0.789 Test Acc: 0.878
Validation loss decreased (-0.862954 --> -0.877770).  Saving model ...
Epoch: 18 cost time: 0.7155945301055908
Epoch: 18, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.734 Vali Acc: 0.900 Test Loss: 0.734 Test Acc: 0.900
Validation loss decreased (-0.877770 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.6737127304077148
Epoch: 19, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.682 Vali Acc: 0.900 Test Loss: 0.682 Test Acc: 0.900
Validation loss decreased (-0.899993 --> -0.899993).  Saving model ...
Epoch: 20 cost time: 0.6834664344787598
Epoch: 20, Steps: 2 | Train Loss: 0.528 Vali Loss: 0.636 Vali Acc: 0.904 Test Loss: 0.636 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 21 cost time: 0.6882350444793701
Epoch: 21, Steps: 2 | Train Loss: 0.430 Vali Loss: 0.593 Vali Acc: 0.915 Test Loss: 0.593 Test Acc: 0.915
Validation loss decreased (-0.903697 --> -0.914809).  Saving model ...
Epoch: 22 cost time: 0.6822688579559326
Epoch: 22, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.553 Vali Acc: 0.922 Test Loss: 0.553 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922217).  Saving model ...
Epoch: 23 cost time: 0.7662160396575928
Epoch: 23, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.516 Vali Acc: 0.930 Test Loss: 0.516 Test Acc: 0.930
Validation loss decreased (-0.922217 --> -0.929624).  Saving model ...
Epoch: 24 cost time: 0.6962249279022217
Epoch: 24, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.483 Vali Acc: 0.930 Test Loss: 0.483 Test Acc: 0.930
Validation loss decreased (-0.929624 --> -0.929625).  Saving model ...
Epoch: 25 cost time: 0.6858365535736084
Epoch: 25, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.453 Vali Acc: 0.930 Test Loss: 0.453 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 26 cost time: 0.7190558910369873
Epoch: 26, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.426 Vali Acc: 0.933 Test Loss: 0.426 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 27 cost time: 0.7662708759307861
Epoch: 27, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.400 Vali Acc: 0.933 Test Loss: 0.400 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.6568195819854736
Epoch: 28, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.378 Vali Acc: 0.933 Test Loss: 0.378 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.671825647354126
Epoch: 29, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.358 Vali Acc: 0.933 Test Loss: 0.358 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.7632718086242676
Epoch: 30, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.341 Vali Acc: 0.937 Test Loss: 0.341 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.8041973114013672
Epoch: 31, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.326 Vali Acc: 0.937 Test Loss: 0.326 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.6741852760314941
Epoch: 32, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.312 Vali Acc: 0.937 Test Loss: 0.312 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 33 cost time: 0.7678894996643066
Epoch: 33, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.300 Vali Acc: 0.933 Test Loss: 0.300 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.7446291446685791
Epoch: 34, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.7144768238067627
Epoch: 35, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 36 cost time: 0.69814133644104
Epoch: 36, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 37 cost time: 0.6686158180236816
Epoch: 37, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.785243034362793
Epoch: 38, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.259 Vali Acc: 0.944 Test Loss: 0.259 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.7674322128295898
Epoch: 39, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.7455980777740479
Epoch: 40, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.6205060482025146
Epoch: 41, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.244 Vali Acc: 0.948 Test Loss: 0.244 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.6129980087280273
Epoch: 42, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.240 Vali Acc: 0.948 Test Loss: 0.240 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.6198689937591553
Epoch: 43, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.771651029586792
Epoch: 44, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.6921584606170654
Epoch: 45, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6833672523498535
Epoch: 46, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.226 Vali Acc: 0.948 Test Loss: 0.226 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.6595988273620605
Epoch: 47, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.223 Vali Acc: 0.948 Test Loss: 0.223 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.6179845333099365
Epoch: 48, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.220 Vali Acc: 0.948 Test Loss: 0.220 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.6333463191986084
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.216 Vali Acc: 0.952 Test Loss: 0.216 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 50 cost time: 0.6306531429290771
Epoch: 50, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.952 Test Loss: 0.214 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 51 cost time: 0.6968669891357422
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.952 Test Loss: 0.211 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 52 cost time: 0.779818058013916
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.952 Test Loss: 0.208 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 53 cost time: 0.6761124134063721
Epoch: 53, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955553).  Saving model ...
Epoch: 54 cost time: 0.8132791519165039
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.205 Vali Acc: 0.956 Test Loss: 0.205 Test Acc: 0.956
Validation loss decreased (-0.955553 --> -0.955554).  Saving model ...
Epoch: 55 cost time: 0.7428414821624756
Epoch: 55, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.203 Vali Acc: 0.956 Test Loss: 0.203 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 56 cost time: 0.7526760101318359
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.202 Vali Acc: 0.952 Test Loss: 0.202 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.7171981334686279
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.737684965133667
Epoch: 58, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.956 Test Loss: 0.199 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 59 cost time: 0.7221224308013916
Epoch: 59, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.959 Test Loss: 0.198 Test Acc: 0.959
Validation loss decreased (-0.955554 --> -0.959257).  Saving model ...
Epoch: 60 cost time: 0.6843695640563965
Epoch: 60, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.6302433013916016
Epoch: 61, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.956 Test Loss: 0.197 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.7144489288330078
Epoch: 62, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.6426305770874023
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.956 Test Loss: 0.196 Test Acc: 0.956
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.7016525268554688
Epoch: 64, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.952 Test Loss: 0.196 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.5836834907531738
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.6872506141662598
Epoch: 66, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.952 Test Loss: 0.195 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.6696438789367676
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.952 Test Loss: 0.194 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.703871488571167
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.6592230796813965
Epoch: 69, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.193 Vali Acc: 0.952 Test Loss: 0.193 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9592592592592593
model parameter : 83718
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4679982662200928
Epoch: 1, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.867 Vali Acc: 0.193 Test Loss: 1.867 Test Acc: 0.193
Validation loss decreased (inf --> -0.192574).  Saving model ...
Epoch: 2 cost time: 0.6291515827178955
Epoch: 2, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.802 Vali Acc: 0.200 Test Loss: 1.802 Test Acc: 0.200
Validation loss decreased (-0.192574 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.6825313568115234
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.755 Vali Acc: 0.226 Test Loss: 1.755 Test Acc: 0.226
Validation loss decreased (-0.199982 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.6446418762207031
Epoch: 4, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.710 Vali Acc: 0.248 Test Loss: 1.710 Test Acc: 0.248
Validation loss decreased (-0.225908 --> -0.248131).  Saving model ...
Epoch: 5 cost time: 0.6497056484222412
Epoch: 5, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.654 Vali Acc: 0.315 Test Loss: 1.654 Test Acc: 0.315
Validation loss decreased (-0.248131 --> -0.314798).  Saving model ...
Epoch: 6 cost time: 0.5735902786254883
Epoch: 6, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.589 Vali Acc: 0.396 Test Loss: 1.589 Test Acc: 0.396
Validation loss decreased (-0.314798 --> -0.396280).  Saving model ...
Epoch: 7 cost time: 0.6484251022338867
Epoch: 7, Steps: 2 | Train Loss: 1.480 Vali Loss: 1.518 Vali Acc: 0.467 Test Loss: 1.518 Test Acc: 0.467
Validation loss decreased (-0.396280 --> -0.466651).  Saving model ...
Epoch: 8 cost time: 0.5900952816009521
Epoch: 8, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.443 Vali Acc: 0.533 Test Loss: 1.443 Test Acc: 0.533
Validation loss decreased (-0.466651 --> -0.533319).  Saving model ...
Epoch: 9 cost time: 0.6330640316009521
Epoch: 9, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.366 Vali Acc: 0.611 Test Loss: 1.366 Test Acc: 0.611
Validation loss decreased (-0.533319 --> -0.611097).  Saving model ...
Epoch: 10 cost time: 0.5414738655090332
Epoch: 10, Steps: 2 | Train Loss: 1.256 Vali Loss: 1.287 Vali Acc: 0.681 Test Loss: 1.287 Test Acc: 0.681
Validation loss decreased (-0.611097 --> -0.681469).  Saving model ...
Epoch: 11 cost time: 0.7174456119537354
Epoch: 11, Steps: 2 | Train Loss: 1.191 Vali Loss: 1.208 Vali Acc: 0.707 Test Loss: 1.208 Test Acc: 0.707
Validation loss decreased (-0.681469 --> -0.707395).  Saving model ...
Epoch: 12 cost time: 0.6298863887786865
Epoch: 12, Steps: 2 | Train Loss: 1.133 Vali Loss: 1.128 Vali Acc: 0.748 Test Loss: 1.128 Test Acc: 0.748
Validation loss decreased (-0.707395 --> -0.748137).  Saving model ...
Epoch: 13 cost time: 0.8818135261535645
Epoch: 13, Steps: 2 | Train Loss: 0.984 Vali Loss: 1.051 Vali Acc: 0.819 Test Loss: 1.051 Test Acc: 0.819
Validation loss decreased (-0.748137 --> -0.818508).  Saving model ...
Epoch: 14 cost time: 0.6729743480682373
Epoch: 14, Steps: 2 | Train Loss: 0.902 Vali Loss: 0.977 Vali Acc: 0.837 Test Loss: 0.977 Test Acc: 0.837
Validation loss decreased (-0.818508 --> -0.837027).  Saving model ...
Epoch: 15 cost time: 0.6253297328948975
Epoch: 15, Steps: 2 | Train Loss: 0.844 Vali Loss: 0.907 Vali Acc: 0.848 Test Loss: 0.907 Test Acc: 0.848
Validation loss decreased (-0.837027 --> -0.848139).  Saving model ...
Epoch: 16 cost time: 0.6481192111968994
Epoch: 16, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.842 Vali Acc: 0.848 Test Loss: 0.842 Test Acc: 0.848
Validation loss decreased (-0.848139 --> -0.848140).  Saving model ...
Epoch: 17 cost time: 0.6858341693878174
Epoch: 17, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.782 Vali Acc: 0.878 Test Loss: 0.782 Test Acc: 0.878
Validation loss decreased (-0.848140 --> -0.877770).  Saving model ...
Epoch: 18 cost time: 0.7461466789245605
Epoch: 18, Steps: 2 | Train Loss: 0.626 Vali Loss: 0.727 Vali Acc: 0.889 Test Loss: 0.727 Test Acc: 0.889
Validation loss decreased (-0.877770 --> -0.888882).  Saving model ...
Epoch: 19 cost time: 0.6637063026428223
Epoch: 19, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.674 Vali Acc: 0.907 Test Loss: 0.674 Test Acc: 0.907
Validation loss decreased (-0.888882 --> -0.907401).  Saving model ...
Epoch: 20 cost time: 0.6720988750457764
Epoch: 20, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.627 Vali Acc: 0.911 Test Loss: 0.627 Test Acc: 0.911
Validation loss decreased (-0.907401 --> -0.911105).  Saving model ...
Epoch: 21 cost time: 0.6565039157867432
Epoch: 21, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.584 Vali Acc: 0.915 Test Loss: 0.584 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914809).  Saving model ...
Epoch: 22 cost time: 0.7091062068939209
Epoch: 22, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.544 Vali Acc: 0.915 Test Loss: 0.544 Test Acc: 0.915
Validation loss decreased (-0.914809 --> -0.914809).  Saving model ...
Epoch: 23 cost time: 0.66314697265625
Epoch: 23, Steps: 2 | Train Loss: 0.385 Vali Loss: 0.506 Vali Acc: 0.919 Test Loss: 0.506 Test Acc: 0.919
Validation loss decreased (-0.914809 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.6497466564178467
Epoch: 24, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.473 Vali Acc: 0.922 Test Loss: 0.473 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 25 cost time: 0.6996996402740479
Epoch: 25, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.443 Vali Acc: 0.922 Test Loss: 0.443 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 26 cost time: 0.5642879009246826
Epoch: 26, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.417 Vali Acc: 0.926 Test Loss: 0.417 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 27 cost time: 0.6632888317108154
Epoch: 27, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.393 Vali Acc: 0.926 Test Loss: 0.393 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.6282649040222168
Epoch: 28, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.371 Vali Acc: 0.937 Test Loss: 0.371 Test Acc: 0.937
Validation loss decreased (-0.925922 --> -0.937033).  Saving model ...
Epoch: 29 cost time: 0.6002919673919678
Epoch: 29, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.351 Vali Acc: 0.937 Test Loss: 0.351 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.6887071132659912
Epoch: 30, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.334 Vali Acc: 0.941 Test Loss: 0.334 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940737).  Saving model ...
Epoch: 31 cost time: 0.778752326965332
Epoch: 31, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.319 Vali Acc: 0.941 Test Loss: 0.319 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 32 cost time: 0.5866000652313232
Epoch: 32, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.648052453994751
Epoch: 33, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.292 Vali Acc: 0.944 Test Loss: 0.292 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6492555141448975
Epoch: 34, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.944 Test Loss: 0.280 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6427788734436035
Epoch: 35, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.270 Vali Acc: 0.948 Test Loss: 0.270 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 36 cost time: 0.6794331073760986
Epoch: 36, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.262 Vali Acc: 0.944 Test Loss: 0.262 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6903748512268066
Epoch: 37, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.255 Vali Acc: 0.944 Test Loss: 0.255 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.707939863204956
Epoch: 38, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.249 Vali Acc: 0.944 Test Loss: 0.249 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.709069013595581
Epoch: 39, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.244 Vali Acc: 0.941 Test Loss: 0.244 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6449799537658691
Epoch: 40, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.7693564891815186
Epoch: 41, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.6666300296783447
Epoch: 42, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.651871919631958
Epoch: 43, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6677985191345215
Epoch: 44, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.6621880531311035
Epoch: 45, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 83718
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.428684949874878
Epoch: 1, Steps: 2 | Train Loss: 1.987 Vali Loss: 1.859 Vali Acc: 0.185 Test Loss: 1.859 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.44963526725769043
Epoch: 2, Steps: 2 | Train Loss: 1.920 Vali Loss: 1.796 Vali Acc: 0.204 Test Loss: 1.796 Test Acc: 0.204
Validation loss decreased (-0.185167 --> -0.203686).  Saving model ...
Epoch: 3 cost time: 0.5381619930267334
Epoch: 3, Steps: 2 | Train Loss: 1.841 Vali Loss: 1.750 Vali Acc: 0.207 Test Loss: 1.750 Test Acc: 0.207
Validation loss decreased (-0.203686 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.5673210620880127
Epoch: 4, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.707 Vali Acc: 0.219 Test Loss: 1.707 Test Acc: 0.219
Validation loss decreased (-0.207390 --> -0.218501).  Saving model ...
Epoch: 5 cost time: 0.5833930969238281
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.650 Vali Acc: 0.274 Test Loss: 1.650 Test Acc: 0.274
Validation loss decreased (-0.218501 --> -0.274058).  Saving model ...
Epoch: 6 cost time: 0.6212170124053955
Epoch: 6, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.587 Vali Acc: 0.337 Test Loss: 1.587 Test Acc: 0.337
Validation loss decreased (-0.274058 --> -0.337021).  Saving model ...
Epoch: 7 cost time: 0.5693976879119873
Epoch: 7, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.518 Vali Acc: 0.415 Test Loss: 1.518 Test Acc: 0.415
Validation loss decreased (-0.337021 --> -0.414800).  Saving model ...
Epoch: 8 cost time: 0.5220503807067871
Epoch: 8, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.444 Vali Acc: 0.544 Test Loss: 1.444 Test Acc: 0.544
Validation loss decreased (-0.414800 --> -0.544430).  Saving model ...
Epoch: 9 cost time: 0.6078524589538574
Epoch: 9, Steps: 2 | Train Loss: 1.366 Vali Loss: 1.370 Vali Acc: 0.633 Test Loss: 1.370 Test Acc: 0.633
Validation loss decreased (-0.544430 --> -0.633320).  Saving model ...
Epoch: 10 cost time: 0.5301203727722168
Epoch: 10, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.293 Vali Acc: 0.670 Test Loss: 1.293 Test Acc: 0.670
Validation loss decreased (-0.633320 --> -0.670357).  Saving model ...
Epoch: 11 cost time: 0.6817677021026611
Epoch: 11, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.216 Vali Acc: 0.730 Test Loss: 1.216 Test Acc: 0.730
Validation loss decreased (-0.670357 --> -0.729617).  Saving model ...
Epoch: 12 cost time: 0.6930925846099854
Epoch: 12, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.139 Vali Acc: 0.781 Test Loss: 1.139 Test Acc: 0.781
Validation loss decreased (-0.729617 --> -0.781470).  Saving model ...
Epoch: 13 cost time: 0.5720813274383545
Epoch: 13, Steps: 2 | Train Loss: 1.020 Vali Loss: 1.063 Vali Acc: 0.811 Test Loss: 1.063 Test Acc: 0.811
Validation loss decreased (-0.781470 --> -0.811100).  Saving model ...
Epoch: 14 cost time: 0.528494119644165
Epoch: 14, Steps: 2 | Train Loss: 0.963 Vali Loss: 0.991 Vali Acc: 0.848 Test Loss: 0.991 Test Acc: 0.848
Validation loss decreased (-0.811100 --> -0.848138).  Saving model ...
Epoch: 15 cost time: 0.5502371788024902
Epoch: 15, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.923 Vali Acc: 0.885 Test Loss: 0.923 Test Acc: 0.885
Validation loss decreased (-0.848138 --> -0.885176).  Saving model ...
Epoch: 16 cost time: 0.5560357570648193
Epoch: 16, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.860 Vali Acc: 0.889 Test Loss: 0.860 Test Acc: 0.889
Validation loss decreased (-0.885176 --> -0.888880).  Saving model ...
Epoch: 17 cost time: 0.5422277450561523
Epoch: 17, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.801 Vali Acc: 0.896 Test Loss: 0.801 Test Acc: 0.896
Validation loss decreased (-0.888880 --> -0.896288).  Saving model ...
Epoch: 18 cost time: 0.5674209594726562
Epoch: 18, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.747 Vali Acc: 0.900 Test Loss: 0.747 Test Acc: 0.900
Validation loss decreased (-0.896288 --> -0.899993).  Saving model ...
Epoch: 19 cost time: 0.5236122608184814
Epoch: 19, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.697 Vali Acc: 0.904 Test Loss: 0.697 Test Acc: 0.904
Validation loss decreased (-0.899993 --> -0.903697).  Saving model ...
Epoch: 20 cost time: 0.5286533832550049
Epoch: 20, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.652 Vali Acc: 0.904 Test Loss: 0.652 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903697).  Saving model ...
Epoch: 21 cost time: 0.6524660587310791
Epoch: 21, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.610 Vali Acc: 0.904 Test Loss: 0.610 Test Acc: 0.904
Validation loss decreased (-0.903697 --> -0.903698).  Saving model ...
Epoch: 22 cost time: 0.5354564189910889
Epoch: 22, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.572 Vali Acc: 0.911 Test Loss: 0.572 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911105).  Saving model ...
Epoch: 23 cost time: 0.523216962814331
Epoch: 23, Steps: 2 | Train Loss: 0.438 Vali Loss: 0.536 Vali Acc: 0.907 Test Loss: 0.536 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5280497074127197
Epoch: 24, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.503 Vali Acc: 0.915 Test Loss: 0.503 Test Acc: 0.915
Validation loss decreased (-0.911105 --> -0.914810).  Saving model ...
Epoch: 25 cost time: 0.6339149475097656
Epoch: 25, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.473 Vali Acc: 0.915 Test Loss: 0.473 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 26 cost time: 0.5412676334381104
Epoch: 26, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.447 Vali Acc: 0.915 Test Loss: 0.447 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914810).  Saving model ...
Epoch: 27 cost time: 0.6417481899261475
Epoch: 27, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.424 Vali Acc: 0.926 Test Loss: 0.424 Test Acc: 0.926
Validation loss decreased (-0.914810 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.5804688930511475
Epoch: 28, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.401 Vali Acc: 0.926 Test Loss: 0.401 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.5751545429229736
Epoch: 29, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.382 Vali Acc: 0.930 Test Loss: 0.382 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.5440092086791992
Epoch: 30, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.366 Vali Acc: 0.930 Test Loss: 0.366 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.5490398406982422
Epoch: 31, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.6338024139404297
Epoch: 32, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.337 Vali Acc: 0.926 Test Loss: 0.337 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5146079063415527
Epoch: 33, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.325 Vali Acc: 0.926 Test Loss: 0.325 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.550260066986084
Epoch: 34, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.314 Vali Acc: 0.926 Test Loss: 0.314 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5702691078186035
Epoch: 35, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.5623705387115479
Epoch: 36, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.294 Vali Acc: 0.926 Test Loss: 0.294 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6102797985076904
Epoch: 37, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5436842441558838
Epoch: 38, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6162519454956055
Epoch: 39, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6543822288513184
Epoch: 40, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.607342004776001
Epoch: 41, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.6667892932891846
Epoch: 42, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.258 Vali Acc: 0.937 Test Loss: 0.258 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.6213886737823486
Epoch: 43, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.254 Vali Acc: 0.933 Test Loss: 0.254 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.6798393726348877
Epoch: 44, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.6545696258544922
Epoch: 45, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.245 Vali Acc: 0.941 Test Loss: 0.245 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.5948166847229004
Epoch: 46, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6067261695861816
Epoch: 47, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.6314363479614258
Epoch: 48, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.236 Vali Acc: 0.941 Test Loss: 0.236 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.6471238136291504
Epoch: 49, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.233 Vali Acc: 0.941 Test Loss: 0.233 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.6301648616790771
Epoch: 50, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.6462018489837646
Epoch: 51, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.6116406917572021
Epoch: 52, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.652094841003418
Epoch: 53, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.7011301517486572
Epoch: 54, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.6622941493988037
Epoch: 55, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.6721706390380859
Epoch: 56, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.6302390098571777
Epoch: 57, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.6424574851989746
Epoch: 58, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.6308667659759521
Epoch: 59, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.5870544910430908
Epoch: 60, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.5711679458618164
Epoch: 61, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.5949497222900391
Epoch: 62, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 0.6070055961608887
Epoch: 63, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.621910572052002
Epoch: 64, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.6531496047973633
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.6126036643981934
Epoch: 66, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.5819766521453857
Epoch: 67, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.6512446403503418
Epoch: 68, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.6446385383605957
Epoch: 69, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.6032369136810303
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6151740550994873
Epoch: 71, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.6584010124206543
Epoch: 72, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 73 cost time: 0.6290607452392578
Epoch: 73, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 74 cost time: 0.6113975048065186
Epoch: 74, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.5954337120056152
Epoch: 75, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6984622478485107
Epoch: 76, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.6327528953552246
Epoch: 77, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.6399326324462891
Epoch: 78, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.6496288776397705
Epoch: 79, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.6619093418121338
Epoch: 80, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.6760561466217041
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.6972413063049316
Epoch: 82, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.5280699729919434
Epoch: 83, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 83718
model size : 0.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.402606725692749
Epoch: 1, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.826 Vali Acc: 0.315 Test Loss: 1.826 Test Acc: 0.315
Validation loss decreased (inf --> -0.314797).  Saving model ...
Epoch: 2 cost time: 0.6495177745819092
Epoch: 2, Steps: 2 | Train Loss: 1.794 Vali Loss: 1.767 Vali Acc: 0.326 Test Loss: 1.767 Test Acc: 0.326
Validation loss decreased (-0.314797 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.533902645111084
Epoch: 3, Steps: 2 | Train Loss: 1.764 Vali Loss: 1.722 Vali Acc: 0.337 Test Loss: 1.722 Test Acc: 0.337
Validation loss decreased (-0.325908 --> -0.337020).  Saving model ...
Epoch: 4 cost time: 0.5895226001739502
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.680 Vali Acc: 0.367 Test Loss: 1.680 Test Acc: 0.367
Validation loss decreased (-0.337020 --> -0.366650).  Saving model ...
Epoch: 5 cost time: 0.6047036647796631
Epoch: 5, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.629 Vali Acc: 0.396 Test Loss: 1.629 Test Acc: 0.396
Validation loss decreased (-0.366650 --> -0.396280).  Saving model ...
Epoch: 6 cost time: 0.6054959297180176
Epoch: 6, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.571 Vali Acc: 0.456 Test Loss: 1.571 Test Acc: 0.456
Validation loss decreased (-0.396280 --> -0.455540).  Saving model ...
Epoch: 7 cost time: 0.6497623920440674
Epoch: 7, Steps: 2 | Train Loss: 1.507 Vali Loss: 1.506 Vali Acc: 0.504 Test Loss: 1.506 Test Acc: 0.504
Validation loss decreased (-0.455540 --> -0.503689).  Saving model ...
Epoch: 8 cost time: 0.6588659286499023
Epoch: 8, Steps: 2 | Train Loss: 1.494 Vali Loss: 1.437 Vali Acc: 0.530 Test Loss: 1.437 Test Acc: 0.530
Validation loss decreased (-0.503689 --> -0.529615).  Saving model ...
Epoch: 9 cost time: 0.6619243621826172
Epoch: 9, Steps: 2 | Train Loss: 1.319 Vali Loss: 1.365 Vali Acc: 0.544 Test Loss: 1.365 Test Acc: 0.544
Validation loss decreased (-0.529615 --> -0.544431).  Saving model ...
Epoch: 10 cost time: 0.6381349563598633
Epoch: 10, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.291 Vali Acc: 0.574 Test Loss: 1.291 Test Acc: 0.574
Validation loss decreased (-0.544431 --> -0.574061).  Saving model ...
Epoch: 11 cost time: 0.6231098175048828
Epoch: 11, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.216 Vali Acc: 0.604 Test Loss: 1.216 Test Acc: 0.604
Validation loss decreased (-0.574061 --> -0.603692).  Saving model ...
Epoch: 12 cost time: 0.6595616340637207
Epoch: 12, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.141 Vali Acc: 0.637 Test Loss: 1.141 Test Acc: 0.637
Validation loss decreased (-0.603692 --> -0.637026).  Saving model ...
Epoch: 13 cost time: 0.7369256019592285
Epoch: 13, Steps: 2 | Train Loss: 0.951 Vali Loss: 1.069 Vali Acc: 0.667 Test Loss: 1.069 Test Acc: 0.667
Validation loss decreased (-0.637026 --> -0.666656).  Saving model ...
Epoch: 14 cost time: 0.6924800872802734
Epoch: 14, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.999 Vali Acc: 0.696 Test Loss: 0.999 Test Acc: 0.696
Validation loss decreased (-0.666656 --> -0.696286).  Saving model ...
Epoch: 15 cost time: 0.6129097938537598
Epoch: 15, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.934 Vali Acc: 0.733 Test Loss: 0.934 Test Acc: 0.733
Validation loss decreased (-0.696286 --> -0.733324).  Saving model ...
Epoch: 16 cost time: 0.657808780670166
Epoch: 16, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.871 Vali Acc: 0.770 Test Loss: 0.871 Test Acc: 0.770
Validation loss decreased (-0.733324 --> -0.770362).  Saving model ...
Epoch: 17 cost time: 0.7561295032501221
Epoch: 17, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.812 Vali Acc: 0.793 Test Loss: 0.812 Test Acc: 0.793
Validation loss decreased (-0.770362 --> -0.792584).  Saving model ...
Epoch: 18 cost time: 0.7305076122283936
Epoch: 18, Steps: 2 | Train Loss: 0.621 Vali Loss: 0.757 Vali Acc: 0.807 Test Loss: 0.757 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807400).  Saving model ...
Epoch: 19 cost time: 0.6572396755218506
Epoch: 19, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.705 Vali Acc: 0.826 Test Loss: 0.705 Test Acc: 0.826
Validation loss decreased (-0.807400 --> -0.825919).  Saving model ...
Epoch: 20 cost time: 0.6725044250488281
Epoch: 20, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
Validation loss decreased (-0.825919 --> -0.844438).  Saving model ...
Epoch: 21 cost time: 0.6832654476165771
Epoch: 21, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.613 Vali Acc: 0.848 Test Loss: 0.613 Test Acc: 0.848
Validation loss decreased (-0.844438 --> -0.848142).  Saving model ...
Epoch: 22 cost time: 0.702160120010376
Epoch: 22, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.574 Vali Acc: 0.863 Test Loss: 0.574 Test Acc: 0.863
Validation loss decreased (-0.848142 --> -0.862957).  Saving model ...
Epoch: 23 cost time: 0.7182934284210205
Epoch: 23, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.537 Vali Acc: 0.867 Test Loss: 0.537 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 24 cost time: 0.6105380058288574
Epoch: 24, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.503 Vali Acc: 0.889 Test Loss: 0.503 Test Acc: 0.889
Validation loss decreased (-0.866661 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 0.6663153171539307
Epoch: 25, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.475 Vali Acc: 0.896 Test Loss: 0.475 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 26 cost time: 0.6178786754608154
Epoch: 26, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.448 Vali Acc: 0.907 Test Loss: 0.448 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.6175711154937744
Epoch: 27, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.7061750888824463
Epoch: 28, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 29 cost time: 0.6617014408111572
Epoch: 29, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.383 Vali Acc: 0.922 Test Loss: 0.383 Test Acc: 0.922
Validation loss decreased (-0.918514 --> -0.922218).  Saving model ...
Epoch: 30 cost time: 0.6590485572814941
Epoch: 30, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.365 Vali Acc: 0.922 Test Loss: 0.365 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 0.6446552276611328
Epoch: 31, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.348 Vali Acc: 0.922 Test Loss: 0.348 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.6062500476837158
Epoch: 32, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 0.6350498199462891
Epoch: 33, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.319 Vali Acc: 0.933 Test Loss: 0.319 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.675429105758667
Epoch: 34, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 35 cost time: 0.6769251823425293
Epoch: 35, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 36 cost time: 0.6804046630859375
Epoch: 36, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.290 Vali Acc: 0.933 Test Loss: 0.290 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.68015456199646
Epoch: 37, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.6565382480621338
Epoch: 38, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.6226084232330322
Epoch: 39, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.694713830947876
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.266 Vali Acc: 0.933 Test Loss: 0.266 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.6480915546417236
Epoch: 41, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.6308102607727051
Epoch: 42, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.254 Vali Acc: 0.941 Test Loss: 0.254 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 43 cost time: 0.5646524429321289
Epoch: 43, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.250 Vali Acc: 0.941 Test Loss: 0.250 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.6051309108734131
Epoch: 44, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.246 Vali Acc: 0.941 Test Loss: 0.246 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.6217372417449951
Epoch: 45, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.941 Test Loss: 0.242 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.5656676292419434
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.7596848011016846
Epoch: 47, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.236 Vali Acc: 0.944 Test Loss: 0.236 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.7757349014282227
Epoch: 48, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.233 Vali Acc: 0.944 Test Loss: 0.233 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.6734120845794678
Epoch: 49, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.944 Test Loss: 0.230 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6743519306182861
Epoch: 50, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.7901225090026855
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.7060222625732422
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.6541798114776611
Epoch: 53, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.6454417705535889
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.6196022033691406
Epoch: 55, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.595996618270874
Epoch: 56, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.6703360080718994
Epoch: 57, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.5930428504943848
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.5633306503295898
Epoch: 59, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.6545398235321045
Epoch: 60, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.6966004371643066
Epoch: 61, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.5862956047058105
Epoch: 62, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 0.6051301956176758
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 0.5705749988555908
Epoch: 64, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 0.7095251083374023
Epoch: 65, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 0.617790937423706
Epoch: 66, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 0.661515474319458
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.7047872543334961
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 69 cost time: 0.6804063320159912
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 0.6461098194122314
Epoch: 70, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 0.6324577331542969
Epoch: 71, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.6391375064849854
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.6789262294769287
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.8101046085357666
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 75 cost time: 0.5932602882385254
Epoch: 75, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 76 cost time: 0.6651244163513184
Epoch: 76, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 77 cost time: 0.5915694236755371
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 78 cost time: 0.6970250606536865
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 79 cost time: 0.6103062629699707
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.5849182605743408
Epoch: 80, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 0.6849679946899414
Epoch: 81, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.5473818778991699
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.6055912971496582
Epoch: 83, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 0.549832820892334
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 0.5301101207733154
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 86 cost time: 0.6061303615570068
Epoch: 86, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 0.6119644641876221
Epoch: 87, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 0.6299097537994385
Epoch: 88, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 89 cost time: 0.6893830299377441
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 90 cost time: 0.6587824821472168
Epoch: 90, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 91 cost time: 0.7272095680236816
Epoch: 91, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 0.6817615032196045
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 0.7080059051513672
Epoch: 93, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 0.6374318599700928
Epoch: 94, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.6630828380584717
Epoch: 95, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 96 cost time: 0.6919848918914795
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 97 cost time: 0.5672752857208252
Epoch: 97, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 98 cost time: 0.6690073013305664
Epoch: 98, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 99 cost time: 0.645301103591919
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 100 cost time: 0.6668236255645752
Epoch: 100, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 50950
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5865323543548584
Epoch: 1, Steps: 2 | Train Loss: 1.765 Vali Loss: 1.827 Vali Acc: 0.307 Test Loss: 1.827 Test Acc: 0.307
Validation loss decreased (inf --> -0.307389).  Saving model ...
Epoch: 2 cost time: 0.6573951244354248
Epoch: 2, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.767 Vali Acc: 0.326 Test Loss: 1.767 Test Acc: 0.326
Validation loss decreased (-0.307389 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.6853365898132324
Epoch: 3, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.722 Vali Acc: 0.330 Test Loss: 1.722 Test Acc: 0.330
Validation loss decreased (-0.325908 --> -0.329612).  Saving model ...
Epoch: 4 cost time: 0.7398545742034912
Epoch: 4, Steps: 2 | Train Loss: 1.717 Vali Loss: 1.680 Vali Acc: 0.348 Test Loss: 1.680 Test Acc: 0.348
Validation loss decreased (-0.329612 --> -0.348131).  Saving model ...
Epoch: 5 cost time: 0.6492514610290527
Epoch: 5, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.628 Vali Acc: 0.393 Test Loss: 1.628 Test Acc: 0.393
Validation loss decreased (-0.348131 --> -0.392576).  Saving model ...
Epoch: 6 cost time: 0.608475923538208
Epoch: 6, Steps: 2 | Train Loss: 1.536 Vali Loss: 1.569 Vali Acc: 0.444 Test Loss: 1.569 Test Acc: 0.444
Validation loss decreased (-0.392576 --> -0.444429).  Saving model ...
Epoch: 7 cost time: 0.6067163944244385
Epoch: 7, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.504 Vali Acc: 0.481 Test Loss: 1.504 Test Acc: 0.481
Validation loss decreased (-0.444429 --> -0.481466).  Saving model ...
Epoch: 8 cost time: 0.6152939796447754
Epoch: 8, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.434 Vali Acc: 0.522 Test Loss: 1.434 Test Acc: 0.522
Validation loss decreased (-0.481466 --> -0.522208).  Saving model ...
Epoch: 9 cost time: 0.6711106300354004
Epoch: 9, Steps: 2 | Train Loss: 1.318 Vali Loss: 1.362 Vali Acc: 0.563 Test Loss: 1.362 Test Acc: 0.563
Validation loss decreased (-0.522208 --> -0.562949).  Saving model ...
Epoch: 10 cost time: 0.6421511173248291
Epoch: 10, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.287 Vali Acc: 0.589 Test Loss: 1.287 Test Acc: 0.589
Validation loss decreased (-0.562949 --> -0.588876).  Saving model ...
Epoch: 11 cost time: 0.6493606567382812
Epoch: 11, Steps: 2 | Train Loss: 1.097 Vali Loss: 1.211 Vali Acc: 0.619 Test Loss: 1.211 Test Acc: 0.619
Validation loss decreased (-0.588876 --> -0.618506).  Saving model ...
Epoch: 12 cost time: 0.6679646968841553
Epoch: 12, Steps: 2 | Train Loss: 1.119 Vali Loss: 1.137 Vali Acc: 0.633 Test Loss: 1.137 Test Acc: 0.633
Validation loss decreased (-0.618506 --> -0.633322).  Saving model ...
Epoch: 13 cost time: 0.6253325939178467
Epoch: 13, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.065 Vali Acc: 0.674 Test Loss: 1.065 Test Acc: 0.674
Validation loss decreased (-0.633322 --> -0.674063).  Saving model ...
Epoch: 14 cost time: 0.5878231525421143
Epoch: 14, Steps: 2 | Train Loss: 0.879 Vali Loss: 0.994 Vali Acc: 0.704 Test Loss: 0.994 Test Acc: 0.704
Validation loss decreased (-0.674063 --> -0.703694).  Saving model ...
Epoch: 15 cost time: 0.581017255783081
Epoch: 15, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.927 Vali Acc: 0.744 Test Loss: 0.927 Test Acc: 0.744
Validation loss decreased (-0.703694 --> -0.744435).  Saving model ...
Epoch: 16 cost time: 0.6778831481933594
Epoch: 16, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.864 Vali Acc: 0.756 Test Loss: 0.864 Test Acc: 0.756
Validation loss decreased (-0.744435 --> -0.755547).  Saving model ...
Epoch: 17 cost time: 0.7295453548431396
Epoch: 17, Steps: 2 | Train Loss: 0.672 Vali Loss: 0.804 Vali Acc: 0.785 Test Loss: 0.804 Test Acc: 0.785
Validation loss decreased (-0.755547 --> -0.785177).  Saving model ...
Epoch: 18 cost time: 0.645923376083374
Epoch: 18, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.749 Vali Acc: 0.822 Test Loss: 0.749 Test Acc: 0.822
Validation loss decreased (-0.785177 --> -0.822215).  Saving model ...
Epoch: 19 cost time: 0.7131047248840332
Epoch: 19, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.697 Vali Acc: 0.848 Test Loss: 0.697 Test Acc: 0.848
Validation loss decreased (-0.822215 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.6690361499786377
Epoch: 20, Steps: 2 | Train Loss: 0.492 Vali Loss: 0.649 Vali Acc: 0.852 Test Loss: 0.649 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 21 cost time: 0.8178606033325195
Epoch: 21, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.604 Vali Acc: 0.859 Test Loss: 0.604 Test Acc: 0.859
Validation loss decreased (-0.851845 --> -0.859253).  Saving model ...
Epoch: 22 cost time: 0.6807160377502441
Epoch: 22, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.564 Vali Acc: 0.885 Test Loss: 0.564 Test Acc: 0.885
Validation loss decreased (-0.859253 --> -0.885180).  Saving model ...
Epoch: 23 cost time: 0.686037540435791
Epoch: 23, Steps: 2 | Train Loss: 0.360 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.885180 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.6301381587982178
Epoch: 24, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.494 Vali Acc: 0.907 Test Loss: 0.494 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.6551468372344971
Epoch: 25, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.464 Vali Acc: 0.911 Test Loss: 0.464 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 26 cost time: 0.6750988960266113
Epoch: 26, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.607558012008667
Epoch: 27, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.415 Vali Acc: 0.907 Test Loss: 0.415 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5782370567321777
Epoch: 28, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.393 Vali Acc: 0.915 Test Loss: 0.393 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.697167158126831
Epoch: 29, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.374 Vali Acc: 0.919 Test Loss: 0.374 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 30 cost time: 0.5882205963134766
Epoch: 30, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.356 Vali Acc: 0.926 Test Loss: 0.356 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.6771345138549805
Epoch: 31, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.339 Vali Acc: 0.930 Test Loss: 0.339 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.6556346416473389
Epoch: 32, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.6620347499847412
Epoch: 33, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6828451156616211
Epoch: 34, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.300 Vali Acc: 0.930 Test Loss: 0.300 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6898648738861084
Epoch: 35, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.7205703258514404
Epoch: 36, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.282 Vali Acc: 0.930 Test Loss: 0.282 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6227259635925293
Epoch: 37, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.274 Vali Acc: 0.933 Test Loss: 0.274 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.7481341361999512
Epoch: 38, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.6669917106628418
Epoch: 39, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.263 Vali Acc: 0.933 Test Loss: 0.263 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.7326788902282715
Epoch: 40, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.258 Vali Acc: 0.933 Test Loss: 0.258 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.7856919765472412
Epoch: 41, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.6604201793670654
Epoch: 42, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.7001566886901855
Epoch: 43, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.7455542087554932
Epoch: 44, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.692338228225708
Epoch: 45, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.6954154968261719
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.8149251937866211
Epoch: 47, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.7285974025726318
Epoch: 48, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.6992731094360352
Epoch: 49, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.6947546005249023
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.6758902072906494
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.7947514057159424
Epoch: 52, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.6899425983428955
Epoch: 53, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.937035 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.6574099063873291
Epoch: 54, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.6777145862579346
Epoch: 55, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.643364429473877
Epoch: 56, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.6437404155731201
Epoch: 57, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.5966689586639404
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.6414809226989746
Epoch: 59, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.6044526100158691
Epoch: 60, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.6615402698516846
Epoch: 61, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.7984466552734375
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 63 cost time: 0.7114806175231934
Epoch: 63, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.944 Test Loss: 0.198 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 64 cost time: 0.7372241020202637
Epoch: 64, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 0.7335004806518555
Epoch: 65, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 0.7439541816711426
Epoch: 66, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 0.6690473556518555
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.6817827224731445
Epoch: 68, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 0.734776496887207
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 0.7117524147033691
Epoch: 70, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 0.7008407115936279
Epoch: 71, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 0.6544778347015381
Epoch: 72, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 0.6944665908813477
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 0.6309292316436768
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 0.6354248523712158
Epoch: 75, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 0.6548843383789062
Epoch: 76, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 0.6405599117279053
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 0.6544208526611328
Epoch: 78, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 0.69590163230896
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 80 cost time: 0.6303606033325195
Epoch: 80, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 81 cost time: 0.6522078514099121
Epoch: 81, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 82 cost time: 0.6142358779907227
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 83 cost time: 0.5968396663665771
Epoch: 83, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 0.6703529357910156
Epoch: 84, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 0.646533727645874
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 86 cost time: 0.6411683559417725
Epoch: 86, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 0.6365151405334473
Epoch: 87, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 0.6269237995147705
Epoch: 88, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 89 cost time: 0.657447099685669
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 90 cost time: 0.6490836143493652
Epoch: 90, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.6812117099761963
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 92 cost time: 0.6867880821228027
Epoch: 92, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 0.6442885398864746
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 0.6557681560516357
Epoch: 94, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.6406774520874023
Epoch: 95, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5519170761108398
Epoch: 96, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 97 cost time: 0.6604361534118652
Epoch: 97, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 98 cost time: 0.5712354183197021
Epoch: 98, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 99 cost time: 0.7615470886230469
Epoch: 99, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 100 cost time: 0.7035868167877197
Epoch: 100, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 50950
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.625856876373291
Epoch: 1, Steps: 2 | Train Loss: 1.807 Vali Loss: 1.812 Vali Acc: 0.315 Test Loss: 1.812 Test Acc: 0.315
Validation loss decreased (inf --> -0.314797).  Saving model ...
Epoch: 2 cost time: 0.7357301712036133
Epoch: 2, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.752 Vali Acc: 0.337 Test Loss: 1.752 Test Acc: 0.337
Validation loss decreased (-0.314797 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.6171362400054932
Epoch: 3, Steps: 2 | Train Loss: 1.780 Vali Loss: 1.706 Vali Acc: 0.341 Test Loss: 1.706 Test Acc: 0.341
Validation loss decreased (-0.337020 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.674511194229126
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.664 Vali Acc: 0.359 Test Loss: 1.664 Test Acc: 0.359
Validation loss decreased (-0.340724 --> -0.359243).  Saving model ...
Epoch: 5 cost time: 0.6890223026275635
Epoch: 5, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.612 Vali Acc: 0.404 Test Loss: 1.612 Test Acc: 0.404
Validation loss decreased (-0.359243 --> -0.403688).  Saving model ...
Epoch: 6 cost time: 0.641751766204834
Epoch: 6, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.553 Vali Acc: 0.441 Test Loss: 1.553 Test Acc: 0.441
Validation loss decreased (-0.403688 --> -0.440725).  Saving model ...
Epoch: 7 cost time: 0.5869977474212646
Epoch: 7, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.488 Vali Acc: 0.500 Test Loss: 1.488 Test Acc: 0.500
Validation loss decreased (-0.440725 --> -0.499985).  Saving model ...
Epoch: 8 cost time: 0.61549973487854
Epoch: 8, Steps: 2 | Train Loss: 1.454 Vali Loss: 1.417 Vali Acc: 0.541 Test Loss: 1.417 Test Acc: 0.541
Validation loss decreased (-0.499985 --> -0.540727).  Saving model ...
Epoch: 9 cost time: 0.694251537322998
Epoch: 9, Steps: 2 | Train Loss: 1.287 Vali Loss: 1.345 Vali Acc: 0.574 Test Loss: 1.345 Test Acc: 0.574
Validation loss decreased (-0.540727 --> -0.574061).  Saving model ...
Epoch: 10 cost time: 0.6135356426239014
Epoch: 10, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.269 Vali Acc: 0.593 Test Loss: 1.269 Test Acc: 0.593
Validation loss decreased (-0.574061 --> -0.592580).  Saving model ...
Epoch: 11 cost time: 0.687891960144043
Epoch: 11, Steps: 2 | Train Loss: 1.077 Vali Loss: 1.194 Vali Acc: 0.619 Test Loss: 1.194 Test Acc: 0.619
Validation loss decreased (-0.592580 --> -0.618507).  Saving model ...
Epoch: 12 cost time: 0.5989892482757568
Epoch: 12, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.119 Vali Acc: 0.648 Test Loss: 1.119 Test Acc: 0.648
Validation loss decreased (-0.618507 --> -0.648137).  Saving model ...
Epoch: 13 cost time: 0.6441125869750977
Epoch: 13, Steps: 2 | Train Loss: 0.910 Vali Loss: 1.047 Vali Acc: 0.681 Test Loss: 1.047 Test Acc: 0.681
Validation loss decreased (-0.648137 --> -0.681471).  Saving model ...
Epoch: 14 cost time: 0.7128918170928955
Epoch: 14, Steps: 2 | Train Loss: 0.901 Vali Loss: 0.977 Vali Acc: 0.722 Test Loss: 0.977 Test Acc: 0.722
Validation loss decreased (-0.681471 --> -0.722212).  Saving model ...
Epoch: 15 cost time: 0.6856198310852051
Epoch: 15, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.910 Vali Acc: 0.763 Test Loss: 0.910 Test Acc: 0.763
Validation loss decreased (-0.722212 --> -0.762954).  Saving model ...
Epoch: 16 cost time: 0.6717736721038818
Epoch: 16, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.847 Vali Acc: 0.800 Test Loss: 0.847 Test Acc: 0.800
Validation loss decreased (-0.762954 --> -0.799992).  Saving model ...
Epoch: 17 cost time: 0.7639963626861572
Epoch: 17, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.789 Vali Acc: 0.830 Test Loss: 0.789 Test Acc: 0.830
Validation loss decreased (-0.799992 --> -0.829622).  Saving model ...
Epoch: 18 cost time: 0.6033751964569092
Epoch: 18, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.734 Vali Acc: 0.844 Test Loss: 0.734 Test Acc: 0.844
Validation loss decreased (-0.829622 --> -0.844437).  Saving model ...
Epoch: 19 cost time: 0.6964249610900879
Epoch: 19, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.684 Vali Acc: 0.848 Test Loss: 0.684 Test Acc: 0.848
Validation loss decreased (-0.844437 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.6954197883605957
Epoch: 20, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.637 Vali Acc: 0.859 Test Loss: 0.637 Test Acc: 0.859
Validation loss decreased (-0.848141 --> -0.859253).  Saving model ...
Epoch: 21 cost time: 0.7543594837188721
Epoch: 21, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.594 Vali Acc: 0.885 Test Loss: 0.594 Test Acc: 0.885
Validation loss decreased (-0.859253 --> -0.885179).  Saving model ...
Epoch: 22 cost time: 0.647392749786377
Epoch: 22, Steps: 2 | Train Loss: 0.473 Vali Loss: 0.555 Vali Acc: 0.889 Test Loss: 0.555 Test Acc: 0.889
Validation loss decreased (-0.885179 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 0.6650700569152832
Epoch: 23, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.518 Vali Acc: 0.907 Test Loss: 0.518 Test Acc: 0.907
Validation loss decreased (-0.888883 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.673781156539917
Epoch: 24, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.6678578853607178
Epoch: 25, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.456 Vali Acc: 0.911 Test Loss: 0.456 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 26 cost time: 0.6461448669433594
Epoch: 26, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.430 Vali Acc: 0.911 Test Loss: 0.430 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.6253929138183594
Epoch: 27, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.408 Vali Acc: 0.911 Test Loss: 0.408 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.6502668857574463
Epoch: 28, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 29 cost time: 0.6268415451049805
Epoch: 29, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.369 Vali Acc: 0.911 Test Loss: 0.369 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.617457389831543
Epoch: 30, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.351 Vali Acc: 0.915 Test Loss: 0.351 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.5828101634979248
Epoch: 31, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.335 Vali Acc: 0.919 Test Loss: 0.335 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 32 cost time: 0.6149516105651855
Epoch: 32, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.321 Vali Acc: 0.919 Test Loss: 0.321 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.650993824005127
Epoch: 33, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.308 Vali Acc: 0.919 Test Loss: 0.308 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.5645895004272461
Epoch: 34, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.5830645561218262
Epoch: 35, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.672435998916626
Epoch: 36, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.279 Vali Acc: 0.926 Test Loss: 0.279 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 0.7534246444702148
Epoch: 37, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.7051057815551758
Epoch: 38, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.6358902454376221
Epoch: 39, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.6390600204467773
Epoch: 40, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.5787420272827148
Epoch: 41, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.248 Vali Acc: 0.930 Test Loss: 0.248 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.6587703227996826
Epoch: 42, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.243 Vali Acc: 0.933 Test Loss: 0.243 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.6182107925415039
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.6065714359283447
Epoch: 44, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.6551682949066162
Epoch: 45, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.6635043621063232
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.6316592693328857
Epoch: 47, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.6721949577331543
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.683751106262207
Epoch: 49, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.6632969379425049
Epoch: 50, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.218 Vali Acc: 0.937 Test Loss: 0.218 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.6426818370819092
Epoch: 51, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.6325573921203613
Epoch: 52, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.6311540603637695
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 54 cost time: 0.6112582683563232
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.5965566635131836
Epoch: 55, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 56 cost time: 0.6755108833312988
Epoch: 56, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 57 cost time: 0.5843822956085205
Epoch: 57, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.6489925384521484
Epoch: 58, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.6125302314758301
Epoch: 59, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.6217730045318604
Epoch: 60, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5979824066162109
Epoch: 61, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 62 cost time: 0.7677462100982666
Epoch: 62, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 63 cost time: 0.910771369934082
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 64 cost time: 0.6478250026702881
Epoch: 64, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 65 cost time: 0.7508940696716309
Epoch: 65, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 66 cost time: 0.7870609760284424
Epoch: 66, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 67 cost time: 0.6923184394836426
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 50950
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.6361799240112305
Epoch: 1, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.772 Vali Acc: 0.367 Test Loss: 1.772 Test Acc: 0.367
Validation loss decreased (inf --> -0.366649).  Saving model ...
Epoch: 2 cost time: 0.5908651351928711
Epoch: 2, Steps: 2 | Train Loss: 1.693 Vali Loss: 1.714 Vali Acc: 0.396 Test Loss: 1.714 Test Acc: 0.396
Validation loss decreased (-0.366649 --> -0.396279).  Saving model ...
Epoch: 3 cost time: 0.6115121841430664
Epoch: 3, Steps: 2 | Train Loss: 1.694 Vali Loss: 1.671 Vali Acc: 0.419 Test Loss: 1.671 Test Acc: 0.419
Validation loss decreased (-0.396279 --> -0.418502).  Saving model ...
Epoch: 4 cost time: 0.6132004261016846
Epoch: 4, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.631 Vali Acc: 0.426 Test Loss: 1.631 Test Acc: 0.426
Validation loss decreased (-0.418502 --> -0.425910).  Saving model ...
Epoch: 5 cost time: 0.6472671031951904
Epoch: 5, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.582 Vali Acc: 0.444 Test Loss: 1.582 Test Acc: 0.444
Validation loss decreased (-0.425910 --> -0.444429).  Saving model ...
Epoch: 6 cost time: 0.6278703212738037
Epoch: 6, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.526 Vali Acc: 0.470 Test Loss: 1.526 Test Acc: 0.470
Validation loss decreased (-0.444429 --> -0.470355).  Saving model ...
Epoch: 7 cost time: 0.6711599826812744
Epoch: 7, Steps: 2 | Train Loss: 1.444 Vali Loss: 1.465 Vali Acc: 0.496 Test Loss: 1.465 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496282).  Saving model ...
Epoch: 8 cost time: 0.5751841068267822
Epoch: 8, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.400 Vali Acc: 0.530 Test Loss: 1.400 Test Acc: 0.530
Validation loss decreased (-0.496282 --> -0.529616).  Saving model ...
Epoch: 9 cost time: 0.5455701351165771
Epoch: 9, Steps: 2 | Train Loss: 1.347 Vali Loss: 1.332 Vali Acc: 0.552 Test Loss: 1.332 Test Acc: 0.552
Validation loss decreased (-0.529616 --> -0.551839).  Saving model ...
Epoch: 10 cost time: 0.5158817768096924
Epoch: 10, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.262 Vali Acc: 0.578 Test Loss: 1.262 Test Acc: 0.578
Validation loss decreased (-0.551839 --> -0.577765).  Saving model ...
Epoch: 11 cost time: 0.4968993663787842
Epoch: 11, Steps: 2 | Train Loss: 1.105 Vali Loss: 1.192 Vali Acc: 0.615 Test Loss: 1.192 Test Acc: 0.615
Validation loss decreased (-0.577765 --> -0.614803).  Saving model ...
Epoch: 12 cost time: 0.5425033569335938
Epoch: 12, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.122 Vali Acc: 0.656 Test Loss: 1.122 Test Acc: 0.656
Validation loss decreased (-0.614803 --> -0.655544).  Saving model ...
Epoch: 13 cost time: 0.5471229553222656
Epoch: 13, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.055 Vali Acc: 0.674 Test Loss: 1.055 Test Acc: 0.674
Validation loss decreased (-0.655544 --> -0.674064).  Saving model ...
Epoch: 14 cost time: 0.4965081214904785
Epoch: 14, Steps: 2 | Train Loss: 0.948 Vali Loss: 0.991 Vali Acc: 0.707 Test Loss: 0.991 Test Acc: 0.707
Validation loss decreased (-0.674064 --> -0.707398).  Saving model ...
Epoch: 15 cost time: 0.5122735500335693
Epoch: 15, Steps: 2 | Train Loss: 0.952 Vali Loss: 0.929 Vali Acc: 0.726 Test Loss: 0.929 Test Acc: 0.726
Validation loss decreased (-0.707398 --> -0.725917).  Saving model ...
Epoch: 16 cost time: 0.49703192710876465
Epoch: 16, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.871 Vali Acc: 0.759 Test Loss: 0.871 Test Acc: 0.759
Validation loss decreased (-0.725917 --> -0.759251).  Saving model ...
Epoch: 17 cost time: 0.4944803714752197
Epoch: 17, Steps: 2 | Train Loss: 0.704 Vali Loss: 0.815 Vali Acc: 0.781 Test Loss: 0.815 Test Acc: 0.781
Validation loss decreased (-0.759251 --> -0.781473).  Saving model ...
Epoch: 18 cost time: 0.5102701187133789
Epoch: 18, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.763 Vali Acc: 0.815 Test Loss: 0.763 Test Acc: 0.815
Validation loss decreased (-0.781473 --> -0.814807).  Saving model ...
Epoch: 19 cost time: 0.536017656326294
Epoch: 19, Steps: 2 | Train Loss: 0.633 Vali Loss: 0.715 Vali Acc: 0.822 Test Loss: 0.715 Test Acc: 0.822
Validation loss decreased (-0.814807 --> -0.822215).  Saving model ...
Epoch: 20 cost time: 0.6296772956848145
Epoch: 20, Steps: 2 | Train Loss: 0.534 Vali Loss: 0.671 Vali Acc: 0.837 Test Loss: 0.671 Test Acc: 0.837
Validation loss decreased (-0.822215 --> -0.837030).  Saving model ...
Epoch: 21 cost time: 0.581035852432251
Epoch: 21, Steps: 2 | Train Loss: 0.540 Vali Loss: 0.629 Vali Acc: 0.841 Test Loss: 0.629 Test Acc: 0.841
Validation loss decreased (-0.837030 --> -0.840734).  Saving model ...
Epoch: 22 cost time: 0.6184346675872803
Epoch: 22, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.591 Vali Acc: 0.852 Test Loss: 0.591 Test Acc: 0.852
Validation loss decreased (-0.840734 --> -0.851846).  Saving model ...
Epoch: 23 cost time: 0.5958476066589355
Epoch: 23, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.556 Vali Acc: 0.863 Test Loss: 0.556 Test Acc: 0.863
Validation loss decreased (-0.851846 --> -0.862957).  Saving model ...
Epoch: 24 cost time: 0.5957968235015869
Epoch: 24, Steps: 2 | Train Loss: 0.412 Vali Loss: 0.523 Vali Acc: 0.878 Test Loss: 0.523 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877773).  Saving model ...
Epoch: 25 cost time: 0.6208367347717285
Epoch: 25, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.494 Vali Acc: 0.900 Test Loss: 0.494 Test Acc: 0.900
Validation loss decreased (-0.877773 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.7275290489196777
Epoch: 26, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.468 Vali Acc: 0.900 Test Loss: 0.468 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.6372120380401611
Epoch: 27, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.444 Vali Acc: 0.893 Test Loss: 0.444 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5609734058380127
Epoch: 28, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.424 Vali Acc: 0.907 Test Loss: 0.424 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.5828342437744141
Epoch: 29, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.403 Vali Acc: 0.915 Test Loss: 0.403 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.6238138675689697
Epoch: 30, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.385 Vali Acc: 0.919 Test Loss: 0.385 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 31 cost time: 0.5688483715057373
Epoch: 31, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.368 Vali Acc: 0.922 Test Loss: 0.368 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.6661632061004639
Epoch: 32, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925922).  Saving model ...
Epoch: 33 cost time: 0.6348276138305664
Epoch: 33, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.339 Vali Acc: 0.930 Test Loss: 0.339 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.609276294708252
Epoch: 34, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.5539727210998535
Epoch: 35, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.315 Vali Acc: 0.930 Test Loss: 0.315 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 36 cost time: 0.6150214672088623
Epoch: 36, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.306 Vali Acc: 0.926 Test Loss: 0.306 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6356751918792725
Epoch: 37, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.6183693408966064
Epoch: 38, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.292 Vali Acc: 0.926 Test Loss: 0.292 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.6700706481933594
Epoch: 39, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.286 Vali Acc: 0.926 Test Loss: 0.286 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5930640697479248
Epoch: 40, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.5877532958984375
Epoch: 41, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6761915683746338
Epoch: 42, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.6920840740203857
Epoch: 43, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.260 Vali Acc: 0.933 Test Loss: 0.260 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5483794212341309
Epoch: 44, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.255 Vali Acc: 0.941 Test Loss: 0.255 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.5017533302307129
Epoch: 45, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6142239570617676
Epoch: 46, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.6100692749023438
Epoch: 47, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.6524059772491455
Epoch: 48, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.239 Vali Acc: 0.944 Test Loss: 0.239 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.581240177154541
Epoch: 49, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6100468635559082
Epoch: 50, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.232 Vali Acc: 0.944 Test Loss: 0.232 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.5618090629577637
Epoch: 51, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.229 Vali Acc: 0.944 Test Loss: 0.229 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.7236409187316895
Epoch: 52, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.228 Vali Acc: 0.944 Test Loss: 0.228 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.5770862102508545
Epoch: 53, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.944 Test Loss: 0.226 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.648486852645874
Epoch: 54, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.6499354839324951
Epoch: 55, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 56 cost time: 0.6404550075531006
Epoch: 56, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 57 cost time: 0.5965175628662109
Epoch: 57, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 58 cost time: 0.6671798229217529
Epoch: 58, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 59 cost time: 0.5914738178253174
Epoch: 59, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 60 cost time: 0.7268962860107422
Epoch: 60, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 61 cost time: 0.6769964694976807
Epoch: 61, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 62 cost time: 0.6991145610809326
Epoch: 62, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 63 cost time: 0.5907788276672363
Epoch: 63, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 64 cost time: 0.5825967788696289
Epoch: 64, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 65 cost time: 0.599501371383667
Epoch: 65, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 66 cost time: 0.7974362373352051
Epoch: 66, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 67 cost time: 0.6472041606903076
Epoch: 67, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 68 cost time: 0.6389164924621582
Epoch: 68, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.6137466430664062
Epoch: 69, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 70 cost time: 0.6275575160980225
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 71 cost time: 0.6011865139007568
Epoch: 71, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 72 cost time: 0.6732683181762695
Epoch: 72, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 73 cost time: 0.6562542915344238
Epoch: 73, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 74 cost time: 0.6689279079437256
Epoch: 74, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 75 cost time: 0.6369204521179199
Epoch: 75, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 76 cost time: 0.6032567024230957
Epoch: 76, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 77 cost time: 0.5517549514770508
Epoch: 77, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 78 cost time: 0.5707294940948486
Epoch: 78, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 79 cost time: 0.6040866374969482
Epoch: 79, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 80 cost time: 0.586233377456665
Epoch: 80, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 81 cost time: 0.5471129417419434
Epoch: 81, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 82 cost time: 0.5911235809326172
Epoch: 82, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 83 cost time: 0.5809509754180908
Epoch: 83, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 50950
model size : 0.82MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4551405906677246
Epoch: 1, Steps: 2 | Train Loss: 1.782 Vali Loss: 1.746 Vali Acc: 0.159 Test Loss: 1.746 Test Acc: 0.159
Validation loss decreased (inf --> -0.159242).  Saving model ...
Epoch: 2 cost time: 0.5770254135131836
Epoch: 2, Steps: 2 | Train Loss: 1.629 Vali Loss: 1.685 Vali Acc: 0.178 Test Loss: 1.685 Test Acc: 0.178
Validation loss decreased (-0.159242 --> -0.177761).  Saving model ...
Epoch: 3 cost time: 0.5922939777374268
Epoch: 3, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.642 Vali Acc: 0.196 Test Loss: 1.642 Test Acc: 0.196
Validation loss decreased (-0.177761 --> -0.196280).  Saving model ...
Epoch: 4 cost time: 0.5738072395324707
Epoch: 4, Steps: 2 | Train Loss: 1.529 Vali Loss: 1.601 Vali Acc: 0.226 Test Loss: 1.601 Test Acc: 0.226
Validation loss decreased (-0.196280 --> -0.225910).  Saving model ...
Epoch: 5 cost time: 0.5582194328308105
Epoch: 5, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.549 Vali Acc: 0.274 Test Loss: 1.549 Test Acc: 0.274
Validation loss decreased (-0.225910 --> -0.274059).  Saving model ...
Epoch: 6 cost time: 0.5589025020599365
Epoch: 6, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.489 Vali Acc: 0.333 Test Loss: 1.489 Test Acc: 0.333
Validation loss decreased (-0.274059 --> -0.333318).  Saving model ...
Epoch: 7 cost time: 0.5807087421417236
Epoch: 7, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.423 Vali Acc: 0.419 Test Loss: 1.423 Test Acc: 0.419
Validation loss decreased (-0.333318 --> -0.418504).  Saving model ...
Epoch: 8 cost time: 0.5647947788238525
Epoch: 8, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.352 Vali Acc: 0.515 Test Loss: 1.352 Test Acc: 0.515
Validation loss decreased (-0.418504 --> -0.514801).  Saving model ...
Epoch: 9 cost time: 0.5576541423797607
Epoch: 9, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.279 Vali Acc: 0.556 Test Loss: 1.279 Test Acc: 0.556
Validation loss decreased (-0.514801 --> -0.555543).  Saving model ...
Epoch: 10 cost time: 0.5990643501281738
Epoch: 10, Steps: 2 | Train Loss: 1.192 Vali Loss: 1.205 Vali Acc: 0.626 Test Loss: 1.205 Test Acc: 0.626
Validation loss decreased (-0.555543 --> -0.625914).  Saving model ...
Epoch: 11 cost time: 0.6249630451202393
Epoch: 11, Steps: 2 | Train Loss: 1.102 Vali Loss: 1.133 Vali Acc: 0.670 Test Loss: 1.133 Test Acc: 0.670
Validation loss decreased (-0.625914 --> -0.670359).  Saving model ...
Epoch: 12 cost time: 0.630913496017456
Epoch: 12, Steps: 2 | Train Loss: 1.015 Vali Loss: 1.061 Vali Acc: 0.704 Test Loss: 1.061 Test Acc: 0.704
Validation loss decreased (-0.670359 --> -0.703693).  Saving model ...
Epoch: 13 cost time: 0.591174840927124
Epoch: 13, Steps: 2 | Train Loss: 0.852 Vali Loss: 0.993 Vali Acc: 0.748 Test Loss: 0.993 Test Acc: 0.748
Validation loss decreased (-0.703693 --> -0.748138).  Saving model ...
Epoch: 14 cost time: 0.6292824745178223
Epoch: 14, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.927 Vali Acc: 0.793 Test Loss: 0.927 Test Acc: 0.793
Validation loss decreased (-0.748138 --> -0.792583).  Saving model ...
Epoch: 15 cost time: 0.7058372497558594
Epoch: 15, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.867 Vali Acc: 0.811 Test Loss: 0.867 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811102).  Saving model ...
Epoch: 16 cost time: 0.633638858795166
Epoch: 16, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.808 Vali Acc: 0.841 Test Loss: 0.808 Test Acc: 0.841
Validation loss decreased (-0.811102 --> -0.840733).  Saving model ...
Epoch: 17 cost time: 0.6184906959533691
Epoch: 17, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.752 Vali Acc: 0.863 Test Loss: 0.752 Test Acc: 0.863
Validation loss decreased (-0.840733 --> -0.862955).  Saving model ...
Epoch: 18 cost time: 0.6042046546936035
Epoch: 18, Steps: 2 | Train Loss: 0.584 Vali Loss: 0.699 Vali Acc: 0.867 Test Loss: 0.699 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866660).  Saving model ...
Epoch: 19 cost time: 0.6097326278686523
Epoch: 19, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.651 Vali Acc: 0.881 Test Loss: 0.651 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881475).  Saving model ...
Epoch: 20 cost time: 0.5851798057556152
Epoch: 20, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.607 Vali Acc: 0.889 Test Loss: 0.607 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 0.6294698715209961
Epoch: 21, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.569 Vali Acc: 0.896 Test Loss: 0.569 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 22 cost time: 0.6561832427978516
Epoch: 22, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.534 Vali Acc: 0.893 Test Loss: 0.534 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.644733190536499
Epoch: 23, Steps: 2 | Train Loss: 0.367 Vali Loss: 0.502 Vali Acc: 0.904 Test Loss: 0.502 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 24 cost time: 0.6497838497161865
Epoch: 24, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.472 Vali Acc: 0.904 Test Loss: 0.472 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 25 cost time: 0.6118197441101074
Epoch: 25, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 26 cost time: 0.6763081550598145
Epoch: 26, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.419 Vali Acc: 0.911 Test Loss: 0.419 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.6521773338317871
Epoch: 27, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.396 Vali Acc: 0.911 Test Loss: 0.396 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.6348023414611816
Epoch: 28, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.375 Vali Acc: 0.919 Test Loss: 0.375 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 29 cost time: 0.6965813636779785
Epoch: 29, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.357 Vali Acc: 0.922 Test Loss: 0.357 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 30 cost time: 0.649491548538208
Epoch: 30, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.341 Vali Acc: 0.922 Test Loss: 0.341 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 0.6226286888122559
Epoch: 31, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.6291193962097168
Epoch: 32, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.315 Vali Acc: 0.926 Test Loss: 0.315 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.619725227355957
Epoch: 33, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.304 Vali Acc: 0.926 Test Loss: 0.304 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 34 cost time: 0.6286847591400146
Epoch: 34, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.294 Vali Acc: 0.930 Test Loss: 0.294 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.6311836242675781
Epoch: 35, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.6138770580291748
Epoch: 36, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.277 Vali Acc: 0.933 Test Loss: 0.277 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.6520187854766846
Epoch: 37, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.270 Vali Acc: 0.937 Test Loss: 0.270 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.5975368022918701
Epoch: 38, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.265 Vali Acc: 0.937 Test Loss: 0.265 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 39 cost time: 0.5979554653167725
Epoch: 39, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.6437771320343018
Epoch: 40, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.255 Vali Acc: 0.937 Test Loss: 0.255 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.5885834693908691
Epoch: 41, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.6287157535552979
Epoch: 42, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.248 Vali Acc: 0.937 Test Loss: 0.248 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.6554644107818604
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.643073558807373
Epoch: 44, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.653888463973999
Epoch: 45, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.5850136280059814
Epoch: 46, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.6468722820281982
Epoch: 47, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.6303849220275879
Epoch: 48, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.6109561920166016
Epoch: 49, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.655472993850708
Epoch: 50, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 51 cost time: 0.6633052825927734
Epoch: 51, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.6009330749511719
Epoch: 52, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.6139135360717773
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.617332935333252
Epoch: 54, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.5869851112365723
Epoch: 55, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 56 cost time: 0.614553689956665
Epoch: 56, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 57 cost time: 0.6195178031921387
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.6023638248443604
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 59 cost time: 0.5929322242736816
Epoch: 59, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 60 cost time: 0.6186554431915283
Epoch: 60, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 61 cost time: 0.6535022258758545
Epoch: 61, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 62 cost time: 0.5831289291381836
Epoch: 62, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 63 cost time: 0.5617287158966064
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 64 cost time: 0.5741016864776611
Epoch: 64, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 65 cost time: 0.5214695930480957
Epoch: 65, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 66 cost time: 0.5559923648834229
Epoch: 66, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 67 cost time: 0.5908477306365967
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 68 cost time: 0.5877091884613037
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 69 cost time: 0.5835185050964355
Epoch: 69, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 70 cost time: 0.5975098609924316
Epoch: 70, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 71 cost time: 0.5327470302581787
Epoch: 71, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 72 cost time: 0.6182119846343994
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 73 cost time: 0.6301143169403076
Epoch: 73, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 74 cost time: 0.5944478511810303
Epoch: 74, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 75 cost time: 0.5839967727661133
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 76 cost time: 0.6049156188964844
Epoch: 76, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.6641228199005127
Epoch: 77, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.6058223247528076
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.573521614074707
Epoch: 79, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.5914969444274902
Epoch: 80, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.5793209075927734
Epoch: 81, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.7124805450439453
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.6083154678344727
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.6709127426147461
Epoch: 84, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.6607480049133301
Epoch: 85, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 34566
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.216820001602173
Epoch: 1, Steps: 2 | Train Loss: 1.774 Vali Loss: 1.750 Vali Acc: 0.133 Test Loss: 1.750 Test Acc: 0.133
Validation loss decreased (inf --> -0.133316).  Saving model ...
Epoch: 2 cost time: 0.5509943962097168
Epoch: 2, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.689 Vali Acc: 0.159 Test Loss: 1.689 Test Acc: 0.159
Validation loss decreased (-0.133316 --> -0.159242).  Saving model ...
Epoch: 3 cost time: 0.5755500793457031
Epoch: 3, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.645 Vali Acc: 0.196 Test Loss: 1.645 Test Acc: 0.196
Validation loss decreased (-0.159242 --> -0.196280).  Saving model ...
Epoch: 4 cost time: 0.6220188140869141
Epoch: 4, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.604 Vali Acc: 0.222 Test Loss: 1.604 Test Acc: 0.222
Validation loss decreased (-0.196280 --> -0.222206).  Saving model ...
Epoch: 5 cost time: 0.6406800746917725
Epoch: 5, Steps: 2 | Train Loss: 1.618 Vali Loss: 1.552 Vali Acc: 0.248 Test Loss: 1.552 Test Acc: 0.248
Validation loss decreased (-0.222206 --> -0.248133).  Saving model ...
Epoch: 6 cost time: 0.6813864707946777
Epoch: 6, Steps: 2 | Train Loss: 1.380 Vali Loss: 1.491 Vali Acc: 0.285 Test Loss: 1.491 Test Acc: 0.285
Validation loss decreased (-0.248133 --> -0.285170).  Saving model ...
Epoch: 7 cost time: 0.6849067211151123
Epoch: 7, Steps: 2 | Train Loss: 1.385 Vali Loss: 1.424 Vali Acc: 0.393 Test Loss: 1.424 Test Acc: 0.393
Validation loss decreased (-0.285170 --> -0.392578).  Saving model ...
Epoch: 8 cost time: 0.7188541889190674
Epoch: 8, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.352 Vali Acc: 0.493 Test Loss: 1.352 Test Acc: 0.493
Validation loss decreased (-0.392578 --> -0.492579).  Saving model ...
Epoch: 9 cost time: 0.6202516555786133
Epoch: 9, Steps: 2 | Train Loss: 1.205 Vali Loss: 1.278 Vali Acc: 0.581 Test Loss: 1.278 Test Acc: 0.581
Validation loss decreased (-0.492579 --> -0.581469).  Saving model ...
Epoch: 10 cost time: 0.6446895599365234
Epoch: 10, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.203 Vali Acc: 0.637 Test Loss: 1.203 Test Acc: 0.637
Validation loss decreased (-0.581469 --> -0.637025).  Saving model ...
Epoch: 11 cost time: 0.6279199123382568
Epoch: 11, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.130 Vali Acc: 0.689 Test Loss: 1.130 Test Acc: 0.689
Validation loss decreased (-0.637025 --> -0.688878).  Saving model ...
Epoch: 12 cost time: 0.5580191612243652
Epoch: 12, Steps: 2 | Train Loss: 1.034 Vali Loss: 1.058 Vali Acc: 0.752 Test Loss: 1.058 Test Acc: 0.752
Validation loss decreased (-0.688878 --> -0.751841).  Saving model ...
Epoch: 13 cost time: 0.6251928806304932
Epoch: 13, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.989 Vali Acc: 0.778 Test Loss: 0.989 Test Acc: 0.778
Validation loss decreased (-0.751841 --> -0.777768).  Saving model ...
Epoch: 14 cost time: 0.6151387691497803
Epoch: 14, Steps: 2 | Train Loss: 0.850 Vali Loss: 0.923 Vali Acc: 0.819 Test Loss: 0.923 Test Acc: 0.819
Validation loss decreased (-0.777768 --> -0.818509).  Saving model ...
Epoch: 15 cost time: 0.6996548175811768
Epoch: 15, Steps: 2 | Train Loss: 0.773 Vali Loss: 0.862 Vali Acc: 0.848 Test Loss: 0.862 Test Acc: 0.848
Validation loss decreased (-0.818509 --> -0.848140).  Saving model ...
Epoch: 16 cost time: 0.6290056705474854
Epoch: 16, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.803 Vali Acc: 0.867 Test Loss: 0.803 Test Acc: 0.867
Validation loss decreased (-0.848140 --> -0.866659).  Saving model ...
Epoch: 17 cost time: 0.6526896953582764
Epoch: 17, Steps: 2 | Train Loss: 0.644 Vali Loss: 0.747 Vali Acc: 0.881 Test Loss: 0.747 Test Acc: 0.881
Validation loss decreased (-0.866659 --> -0.881474).  Saving model ...
Epoch: 18 cost time: 0.6526391506195068
Epoch: 18, Steps: 2 | Train Loss: 0.581 Vali Loss: 0.695 Vali Acc: 0.896 Test Loss: 0.695 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896289).  Saving model ...
Epoch: 19 cost time: 0.6532561779022217
Epoch: 19, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.646 Vali Acc: 0.911 Test Loss: 0.646 Test Acc: 0.911
Validation loss decreased (-0.896289 --> -0.911105).  Saving model ...
Epoch: 20 cost time: 0.6390283107757568
Epoch: 20, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.602 Vali Acc: 0.922 Test Loss: 0.602 Test Acc: 0.922
Validation loss decreased (-0.911105 --> -0.922216).  Saving model ...
Epoch: 21 cost time: 0.539813756942749
Epoch: 21, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.565 Vali Acc: 0.922 Test Loss: 0.565 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 22 cost time: 0.5726220607757568
Epoch: 22, Steps: 2 | Train Loss: 0.405 Vali Loss: 0.529 Vali Acc: 0.919 Test Loss: 0.529 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6588137149810791
Epoch: 23, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.497 Vali Acc: 0.919 Test Loss: 0.497 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5534164905548096
Epoch: 24, Steps: 2 | Train Loss: 0.315 Vali Loss: 0.468 Vali Acc: 0.915 Test Loss: 0.468 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5809986591339111
Epoch: 25, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.441 Vali Acc: 0.915 Test Loss: 0.441 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5261704921722412
Epoch: 26, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.416 Vali Acc: 0.915 Test Loss: 0.416 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5612466335296631
Epoch: 27, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.392 Vali Acc: 0.919 Test Loss: 0.392 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5373051166534424
Epoch: 28, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.5424332618713379
Epoch: 29, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.354 Vali Acc: 0.922 Test Loss: 0.354 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5767695903778076
Epoch: 30, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.338 Vali Acc: 0.926 Test Loss: 0.338 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 31 cost time: 0.6350226402282715
Epoch: 31, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.323 Vali Acc: 0.926 Test Loss: 0.323 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.6237950325012207
Epoch: 32, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.311 Vali Acc: 0.926 Test Loss: 0.311 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.6725835800170898
Epoch: 33, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.299 Vali Acc: 0.930 Test Loss: 0.299 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.5627655982971191
Epoch: 34, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.290 Vali Acc: 0.930 Test Loss: 0.290 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 35 cost time: 0.6312122344970703
Epoch: 35, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.281 Vali Acc: 0.930 Test Loss: 0.281 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.6333777904510498
Epoch: 36, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.5885999202728271
Epoch: 37, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.6316781044006348
Epoch: 38, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6588618755340576
Epoch: 39, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.933 Test Loss: 0.256 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 40 cost time: 0.5866544246673584
Epoch: 40, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.7049336433410645
Epoch: 41, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.248 Vali Acc: 0.933 Test Loss: 0.248 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.647576093673706
Epoch: 42, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.6388504505157471
Epoch: 43, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.6146233081817627
Epoch: 44, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.617131233215332
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.6089785099029541
Epoch: 46, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.5887513160705566
Epoch: 47, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.6311047077178955
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 49 cost time: 0.6234183311462402
Epoch: 49, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.6158242225646973
Epoch: 50, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 51 cost time: 0.5749959945678711
Epoch: 51, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.5720229148864746
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.5654251575469971
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.6371734142303467
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.6211977005004883
Epoch: 55, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.210 Vali Acc: 0.948 Test Loss: 0.210 Test Acc: 0.948
Validation loss decreased (-0.940739 --> -0.948146).  Saving model ...
Epoch: 56 cost time: 0.5781097412109375
Epoch: 56, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 57 cost time: 0.5927186012268066
Epoch: 57, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 58 cost time: 0.6190662384033203
Epoch: 58, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.208 Vali Acc: 0.948 Test Loss: 0.208 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 59 cost time: 0.6378312110900879
Epoch: 59, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.948 Test Loss: 0.207 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 60 cost time: 0.6493077278137207
Epoch: 60, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.948 Test Loss: 0.206 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 61 cost time: 0.6592719554901123
Epoch: 61, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.948 Test Loss: 0.205 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 62 cost time: 0.6111414432525635
Epoch: 62, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.948 Test Loss: 0.204 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.622514009475708
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.948 Test Loss: 0.203 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.6159648895263672
Epoch: 64, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.948 Test Loss: 0.201 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.6997718811035156
Epoch: 65, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.5804078578948975
Epoch: 66, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.618654727935791
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.6931276321411133
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.6489710807800293
Epoch: 69, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 70 cost time: 0.6875700950622559
Epoch: 70, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 71 cost time: 0.7862610816955566
Epoch: 71, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 72 cost time: 0.6026394367218018
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 73 cost time: 0.64300537109375
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 74 cost time: 0.6465325355529785
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 75 cost time: 0.5279197692871094
Epoch: 75, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 76 cost time: 0.5595905780792236
Epoch: 76, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 77 cost time: 0.6337244510650635
Epoch: 77, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.5577700138092041
Epoch: 78, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 79 cost time: 0.575117826461792
Epoch: 79, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 80 cost time: 0.6471161842346191
Epoch: 80, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 81 cost time: 0.6210598945617676
Epoch: 81, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 82 cost time: 0.709014892578125
Epoch: 82, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 83 cost time: 0.6434557437896729
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.6536970138549805
Epoch: 84, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.7234621047973633
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.6340756416320801
Epoch: 86, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.6751914024353027
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.6533970832824707
Epoch: 88, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.6563055515289307
Epoch: 89, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.6862635612487793
Epoch: 90, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.6364502906799316
Epoch: 91, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.6774358749389648
Epoch: 92, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 34566
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3689382076263428
Epoch: 1, Steps: 2 | Train Loss: 1.739 Vali Loss: 1.756 Vali Acc: 0.144 Test Loss: 1.756 Test Acc: 0.144
Validation loss decreased (inf --> -0.144427).  Saving model ...
Epoch: 2 cost time: 0.49904632568359375
Epoch: 2, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.694 Vali Acc: 0.159 Test Loss: 1.694 Test Acc: 0.159
Validation loss decreased (-0.144427 --> -0.159242).  Saving model ...
Epoch: 3 cost time: 0.4810466766357422
Epoch: 3, Steps: 2 | Train Loss: 1.550 Vali Loss: 1.651 Vali Acc: 0.167 Test Loss: 1.651 Test Acc: 0.167
Validation loss decreased (-0.159242 --> -0.166650).  Saving model ...
Epoch: 4 cost time: 0.5420322418212891
Epoch: 4, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.610 Vali Acc: 0.185 Test Loss: 1.610 Test Acc: 0.185
Validation loss decreased (-0.166650 --> -0.185169).  Saving model ...
Epoch: 5 cost time: 0.5942621231079102
Epoch: 5, Steps: 2 | Train Loss: 1.579 Vali Loss: 1.558 Vali Acc: 0.237 Test Loss: 1.558 Test Acc: 0.237
Validation loss decreased (-0.185169 --> -0.237021).  Saving model ...
Epoch: 6 cost time: 0.5738973617553711
Epoch: 6, Steps: 2 | Train Loss: 1.367 Vali Loss: 1.497 Vali Acc: 0.274 Test Loss: 1.497 Test Acc: 0.274
Validation loss decreased (-0.237021 --> -0.274059).  Saving model ...
Epoch: 7 cost time: 0.6104004383087158
Epoch: 7, Steps: 2 | Train Loss: 1.368 Vali Loss: 1.430 Vali Acc: 0.356 Test Loss: 1.430 Test Acc: 0.356
Validation loss decreased (-0.274059 --> -0.355541).  Saving model ...
Epoch: 8 cost time: 0.5953853130340576
Epoch: 8, Steps: 2 | Train Loss: 1.336 Vali Loss: 1.358 Vali Acc: 0.459 Test Loss: 1.358 Test Acc: 0.459
Validation loss decreased (-0.355541 --> -0.459246).  Saving model ...
Epoch: 9 cost time: 0.6476345062255859
Epoch: 9, Steps: 2 | Train Loss: 1.149 Vali Loss: 1.283 Vali Acc: 0.596 Test Loss: 1.283 Test Acc: 0.596
Validation loss decreased (-0.459246 --> -0.596283).  Saving model ...
Epoch: 10 cost time: 0.669058084487915
Epoch: 10, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.207 Vali Acc: 0.656 Test Loss: 1.207 Test Acc: 0.656
Validation loss decreased (-0.596283 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 0.6402192115783691
Epoch: 11, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.134 Vali Acc: 0.733 Test Loss: 1.134 Test Acc: 0.733
Validation loss decreased (-0.655543 --> -0.733322).  Saving model ...
Epoch: 12 cost time: 0.602320671081543
Epoch: 12, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.061 Vali Acc: 0.774 Test Loss: 1.061 Test Acc: 0.774
Validation loss decreased (-0.733322 --> -0.774063).  Saving model ...
Epoch: 13 cost time: 0.5723779201507568
Epoch: 13, Steps: 2 | Train Loss: 0.914 Vali Loss: 0.991 Vali Acc: 0.819 Test Loss: 0.991 Test Acc: 0.819
Validation loss decreased (-0.774063 --> -0.818509).  Saving model ...
Epoch: 14 cost time: 0.5504343509674072
Epoch: 14, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.924 Vali Acc: 0.844 Test Loss: 0.924 Test Acc: 0.844
Validation loss decreased (-0.818509 --> -0.844435).  Saving model ...
Epoch: 15 cost time: 0.5764615535736084
Epoch: 15, Steps: 2 | Train Loss: 0.751 Vali Loss: 0.863 Vali Acc: 0.859 Test Loss: 0.863 Test Acc: 0.859
Validation loss decreased (-0.844435 --> -0.859251).  Saving model ...
Epoch: 16 cost time: 0.6141238212585449
Epoch: 16, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.803 Vali Acc: 0.874 Test Loss: 0.803 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874066).  Saving model ...
Epoch: 17 cost time: 0.6293635368347168
Epoch: 17, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.747 Vali Acc: 0.904 Test Loss: 0.747 Test Acc: 0.904
Validation loss decreased (-0.874066 --> -0.903696).  Saving model ...
Epoch: 18 cost time: 0.6971824169158936
Epoch: 18, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.694 Vali Acc: 0.904 Test Loss: 0.694 Test Acc: 0.904
Validation loss decreased (-0.903696 --> -0.903697).  Saving model ...
Epoch: 19 cost time: 0.6088263988494873
Epoch: 19, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.645 Vali Acc: 0.919 Test Loss: 0.645 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918512).  Saving model ...
Epoch: 20 cost time: 0.6101815700531006
Epoch: 20, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.600 Vali Acc: 0.919 Test Loss: 0.600 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918513).  Saving model ...
Epoch: 21 cost time: 0.5879297256469727
Epoch: 21, Steps: 2 | Train Loss: 0.462 Vali Loss: 0.560 Vali Acc: 0.919 Test Loss: 0.560 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 22 cost time: 0.6980266571044922
Epoch: 22, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.524 Vali Acc: 0.922 Test Loss: 0.524 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 23 cost time: 0.6215534210205078
Epoch: 23, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.491 Vali Acc: 0.922 Test Loss: 0.491 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.5723865032196045
Epoch: 24, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.461 Vali Acc: 0.919 Test Loss: 0.461 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5999526977539062
Epoch: 25, Steps: 2 | Train Loss: 0.314 Vali Loss: 0.434 Vali Acc: 0.919 Test Loss: 0.434 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5932562351226807
Epoch: 26, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.409 Vali Acc: 0.922 Test Loss: 0.409 Test Acc: 0.922
Validation loss decreased (-0.922217 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 0.6086692810058594
Epoch: 27, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.386 Vali Acc: 0.930 Test Loss: 0.386 Test Acc: 0.930
Validation loss decreased (-0.922218 --> -0.929626).  Saving model ...
Epoch: 28 cost time: 0.5413110256195068
Epoch: 28, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.366 Vali Acc: 0.933 Test Loss: 0.366 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.5987858772277832
Epoch: 29, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.349 Vali Acc: 0.933 Test Loss: 0.349 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 30 cost time: 0.5849130153656006
Epoch: 30, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.333 Vali Acc: 0.933 Test Loss: 0.333 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.6606423854827881
Epoch: 31, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.320 Vali Acc: 0.933 Test Loss: 0.320 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 32 cost time: 0.6321659088134766
Epoch: 32, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.308 Vali Acc: 0.933 Test Loss: 0.308 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 33 cost time: 0.6654195785522461
Epoch: 33, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 34 cost time: 0.5921971797943115
Epoch: 34, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.289 Vali Acc: 0.933 Test Loss: 0.289 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 35 cost time: 0.714946985244751
Epoch: 35, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.281 Vali Acc: 0.933 Test Loss: 0.281 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 36 cost time: 0.7003824710845947
Epoch: 36, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.6391787528991699
Epoch: 37, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.6159641742706299
Epoch: 38, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.6555485725402832
Epoch: 39, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6702110767364502
Epoch: 40, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.252 Vali Acc: 0.933 Test Loss: 0.252 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.6587178707122803
Epoch: 41, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 42 cost time: 0.662334680557251
Epoch: 42, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.686692476272583
Epoch: 43, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.7129077911376953
Epoch: 44, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.6306819915771484
Epoch: 45, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.6742794513702393
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.6127583980560303
Epoch: 47, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.648113489151001
Epoch: 48, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.6102213859558105
Epoch: 49, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 50 cost time: 0.6415824890136719
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 51 cost time: 0.6309161186218262
Epoch: 51, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.6237771511077881
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.6286437511444092
Epoch: 53, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.6660535335540771
Epoch: 54, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5815539360046387
Epoch: 55, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6175129413604736
Epoch: 56, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 57 cost time: 0.626685380935669
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.7456068992614746
Epoch: 58, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 59 cost time: 0.6767687797546387
Epoch: 59, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 60 cost time: 0.6715128421783447
Epoch: 60, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 61 cost time: 0.6409649848937988
Epoch: 61, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 62 cost time: 0.618748664855957
Epoch: 62, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 63 cost time: 0.6362311840057373
Epoch: 63, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 64 cost time: 0.6583249568939209
Epoch: 64, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 65 cost time: 0.6845018863677979
Epoch: 65, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 66 cost time: 0.6380555629730225
Epoch: 66, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 67 cost time: 0.670191764831543
Epoch: 67, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 68 cost time: 0.6242358684539795
Epoch: 68, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 69 cost time: 0.6118619441986084
Epoch: 69, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 70 cost time: 0.6523473262786865
Epoch: 70, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 34566
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2112910747528076
Epoch: 1, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.729 Vali Acc: 0.141 Test Loss: 1.729 Test Acc: 0.141
Validation loss decreased (inf --> -0.140723).  Saving model ...
Epoch: 2 cost time: 0.5695421695709229
Epoch: 2, Steps: 2 | Train Loss: 1.588 Vali Loss: 1.673 Vali Acc: 0.159 Test Loss: 1.673 Test Acc: 0.159
Validation loss decreased (-0.140723 --> -0.159243).  Saving model ...
Epoch: 3 cost time: 0.6512155532836914
Epoch: 3, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.633 Vali Acc: 0.189 Test Loss: 1.633 Test Acc: 0.189
Validation loss decreased (-0.159243 --> -0.188873).  Saving model ...
Epoch: 4 cost time: 0.502540111541748
Epoch: 4, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.595 Vali Acc: 0.215 Test Loss: 1.595 Test Acc: 0.215
Validation loss decreased (-0.188873 --> -0.214799).  Saving model ...
Epoch: 5 cost time: 0.544701337814331
Epoch: 5, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.547 Vali Acc: 0.270 Test Loss: 1.547 Test Acc: 0.270
Validation loss decreased (-0.214799 --> -0.270355).  Saving model ...
Epoch: 6 cost time: 0.6151673793792725
Epoch: 6, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.490 Vali Acc: 0.333 Test Loss: 1.490 Test Acc: 0.333
Validation loss decreased (-0.270355 --> -0.333318).  Saving model ...
Epoch: 7 cost time: 0.6428999900817871
Epoch: 7, Steps: 2 | Train Loss: 1.350 Vali Loss: 1.427 Vali Acc: 0.407 Test Loss: 1.427 Test Acc: 0.407
Validation loss decreased (-0.333318 --> -0.407393).  Saving model ...
Epoch: 8 cost time: 0.6032660007476807
Epoch: 8, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.360 Vali Acc: 0.470 Test Loss: 1.360 Test Acc: 0.470
Validation loss decreased (-0.407393 --> -0.470357).  Saving model ...
Epoch: 9 cost time: 0.6274001598358154
Epoch: 9, Steps: 2 | Train Loss: 1.218 Vali Loss: 1.290 Vali Acc: 0.544 Test Loss: 1.290 Test Acc: 0.544
Validation loss decreased (-0.470357 --> -0.544432).  Saving model ...
Epoch: 10 cost time: 0.643286943435669
Epoch: 10, Steps: 2 | Train Loss: 1.220 Vali Loss: 1.219 Vali Acc: 0.622 Test Loss: 1.219 Test Acc: 0.622
Validation loss decreased (-0.544432 --> -0.622210).  Saving model ...
Epoch: 11 cost time: 0.6047616004943848
Epoch: 11, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.150 Vali Acc: 0.678 Test Loss: 1.150 Test Acc: 0.678
Validation loss decreased (-0.622210 --> -0.677766).  Saving model ...
Epoch: 12 cost time: 0.611457347869873
Epoch: 12, Steps: 2 | Train Loss: 1.006 Vali Loss: 1.082 Vali Acc: 0.737 Test Loss: 1.082 Test Acc: 0.737
Validation loss decreased (-0.677766 --> -0.737026).  Saving model ...
Epoch: 13 cost time: 0.6378786563873291
Epoch: 13, Steps: 2 | Train Loss: 0.930 Vali Loss: 1.016 Vali Acc: 0.785 Test Loss: 1.016 Test Acc: 0.785
Validation loss decreased (-0.737026 --> -0.785175).  Saving model ...
Epoch: 14 cost time: 0.6218278408050537
Epoch: 14, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.954 Vali Acc: 0.837 Test Loss: 0.954 Test Acc: 0.837
Validation loss decreased (-0.785175 --> -0.837028).  Saving model ...
Epoch: 15 cost time: 0.6617429256439209
Epoch: 15, Steps: 2 | Train Loss: 0.772 Vali Loss: 0.895 Vali Acc: 0.856 Test Loss: 0.895 Test Acc: 0.856
Validation loss decreased (-0.837028 --> -0.855547).  Saving model ...
Epoch: 16 cost time: 0.6610884666442871
Epoch: 16, Steps: 2 | Train Loss: 0.763 Vali Loss: 0.839 Vali Acc: 0.881 Test Loss: 0.839 Test Acc: 0.881
Validation loss decreased (-0.855547 --> -0.881473).  Saving model ...
Epoch: 17 cost time: 0.6083571910858154
Epoch: 17, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.785 Vali Acc: 0.878 Test Loss: 0.785 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6944563388824463
Epoch: 18, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.734 Vali Acc: 0.893 Test Loss: 0.734 Test Acc: 0.893
Validation loss decreased (-0.881473 --> -0.892585).  Saving model ...
Epoch: 19 cost time: 0.6486005783081055
Epoch: 19, Steps: 2 | Train Loss: 0.554 Vali Loss: 0.686 Vali Acc: 0.896 Test Loss: 0.686 Test Acc: 0.896
Validation loss decreased (-0.892585 --> -0.896289).  Saving model ...
Epoch: 20 cost time: 0.6384849548339844
Epoch: 20, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.642 Vali Acc: 0.907 Test Loss: 0.642 Test Acc: 0.907
Validation loss decreased (-0.896289 --> -0.907401).  Saving model ...
Epoch: 21 cost time: 0.7178826332092285
Epoch: 21, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.602 Vali Acc: 0.919 Test Loss: 0.602 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918512).  Saving model ...
Epoch: 22 cost time: 0.5910184383392334
Epoch: 22, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.566 Vali Acc: 0.915 Test Loss: 0.566 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6187820434570312
Epoch: 23, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.533 Vali Acc: 0.915 Test Loss: 0.533 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6117496490478516
Epoch: 24, Steps: 2 | Train Loss: 0.366 Vali Loss: 0.504 Vali Acc: 0.915 Test Loss: 0.504 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5862038135528564
Epoch: 25, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.476 Vali Acc: 0.919 Test Loss: 0.476 Test Acc: 0.919
Validation loss decreased (-0.918512 --> -0.918514).  Saving model ...
Epoch: 26 cost time: 0.5437178611755371
Epoch: 26, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.451 Vali Acc: 0.919 Test Loss: 0.451 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 27 cost time: 0.6229782104492188
Epoch: 27, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.427 Vali Acc: 0.919 Test Loss: 0.427 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.5310506820678711
Epoch: 28, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.406 Vali Acc: 0.926 Test Loss: 0.406 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.5214910507202148
Epoch: 29, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.388 Vali Acc: 0.926 Test Loss: 0.388 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.5883536338806152
Epoch: 30, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.5707247257232666
Epoch: 31, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.356 Vali Acc: 0.930 Test Loss: 0.356 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.5838949680328369
Epoch: 32, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.343 Vali Acc: 0.926 Test Loss: 0.343 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6968832015991211
Epoch: 33, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.6432642936706543
Epoch: 34, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.321 Vali Acc: 0.926 Test Loss: 0.321 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6560142040252686
Epoch: 35, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.311 Vali Acc: 0.930 Test Loss: 0.311 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 36 cost time: 0.7079591751098633
Epoch: 36, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.303 Vali Acc: 0.930 Test Loss: 0.303 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 37 cost time: 0.709618330001831
Epoch: 37, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.295 Vali Acc: 0.930 Test Loss: 0.295 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.6317837238311768
Epoch: 38, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7083451747894287
Epoch: 39, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.7056992053985596
Epoch: 40, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 0.6792073249816895
Epoch: 41, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 0.6570217609405518
Epoch: 42, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 0.6736471652984619
Epoch: 43, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 0.6935164928436279
Epoch: 44, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.260 Vali Acc: 0.922 Test Loss: 0.260 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 0.6726930141448975
Epoch: 45, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 0.6266167163848877
Epoch: 46, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 0.680474042892456
Epoch: 47, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 34566
model size : 0.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3978934288024902
Epoch: 1, Steps: 2 | Train Loss: 1.998 Vali Loss: 1.905 Vali Acc: 0.096 Test Loss: 1.905 Test Acc: 0.096
Validation loss decreased (inf --> -0.096277).  Saving model ...
Epoch: 2 cost time: 0.7291364669799805
Epoch: 2, Steps: 2 | Train Loss: 1.939 Vali Loss: 1.831 Vali Acc: 0.159 Test Loss: 1.831 Test Acc: 0.159
Validation loss decreased (-0.096277 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.6115555763244629
Epoch: 3, Steps: 2 | Train Loss: 1.776 Vali Loss: 1.779 Vali Acc: 0.207 Test Loss: 1.779 Test Acc: 0.207
Validation loss decreased (-0.159241 --> -0.207390).  Saving model ...
Epoch: 4 cost time: 0.6263000965118408
Epoch: 4, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.735 Vali Acc: 0.252 Test Loss: 1.735 Test Acc: 0.252
Validation loss decreased (-0.207390 --> -0.251835).  Saving model ...
Epoch: 5 cost time: 0.5435700416564941
Epoch: 5, Steps: 2 | Train Loss: 1.806 Vali Loss: 1.678 Vali Acc: 0.281 Test Loss: 1.678 Test Acc: 0.281
Validation loss decreased (-0.251835 --> -0.281465).  Saving model ...
Epoch: 6 cost time: 0.614750862121582
Epoch: 6, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.613 Vali Acc: 0.333 Test Loss: 1.613 Test Acc: 0.333
Validation loss decreased (-0.281465 --> -0.333317).  Saving model ...
Epoch: 7 cost time: 0.6305637359619141
Epoch: 7, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.542 Vali Acc: 0.393 Test Loss: 1.542 Test Acc: 0.393
Validation loss decreased (-0.333317 --> -0.392577).  Saving model ...
Epoch: 8 cost time: 0.6240849494934082
Epoch: 8, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.467 Vali Acc: 0.448 Test Loss: 1.467 Test Acc: 0.448
Validation loss decreased (-0.392577 --> -0.448133).  Saving model ...
Epoch: 9 cost time: 0.6265649795532227
Epoch: 9, Steps: 2 | Train Loss: 1.493 Vali Loss: 1.390 Vali Acc: 0.481 Test Loss: 1.390 Test Acc: 0.481
Validation loss decreased (-0.448133 --> -0.481468).  Saving model ...
Epoch: 10 cost time: 0.6225743293762207
Epoch: 10, Steps: 2 | Train Loss: 1.392 Vali Loss: 1.312 Vali Acc: 0.526 Test Loss: 1.312 Test Acc: 0.526
Validation loss decreased (-0.481468 --> -0.525913).  Saving model ...
Epoch: 11 cost time: 0.6219625473022461
Epoch: 11, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.235 Vali Acc: 0.604 Test Loss: 1.235 Test Acc: 0.604
Validation loss decreased (-0.525913 --> -0.603691).  Saving model ...
Epoch: 12 cost time: 0.674675703048706
Epoch: 12, Steps: 2 | Train Loss: 1.131 Vali Loss: 1.159 Vali Acc: 0.663 Test Loss: 1.159 Test Acc: 0.663
Validation loss decreased (-0.603691 --> -0.662951).  Saving model ...
Epoch: 13 cost time: 0.6410408020019531
Epoch: 13, Steps: 2 | Train Loss: 1.100 Vali Loss: 1.084 Vali Acc: 0.696 Test Loss: 1.084 Test Acc: 0.696
Validation loss decreased (-0.662951 --> -0.696285).  Saving model ...
Epoch: 14 cost time: 0.6652915477752686
Epoch: 14, Steps: 2 | Train Loss: 0.925 Vali Loss: 1.011 Vali Acc: 0.737 Test Loss: 1.011 Test Acc: 0.737
Validation loss decreased (-0.696285 --> -0.737027).  Saving model ...
Epoch: 15 cost time: 0.6664550304412842
Epoch: 15, Steps: 2 | Train Loss: 0.825 Vali Loss: 0.942 Vali Acc: 0.763 Test Loss: 0.942 Test Acc: 0.763
Validation loss decreased (-0.737027 --> -0.762954).  Saving model ...
Epoch: 16 cost time: 0.6121668815612793
Epoch: 16, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.875 Vali Acc: 0.793 Test Loss: 0.875 Test Acc: 0.793
Validation loss decreased (-0.762954 --> -0.792584).  Saving model ...
Epoch: 17 cost time: 0.6332716941833496
Epoch: 17, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.812 Vali Acc: 0.822 Test Loss: 0.812 Test Acc: 0.822
Validation loss decreased (-0.792584 --> -0.822214).  Saving model ...
Epoch: 18 cost time: 0.6454501152038574
Epoch: 18, Steps: 2 | Train Loss: 0.706 Vali Loss: 0.753 Vali Acc: 0.837 Test Loss: 0.753 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837030).  Saving model ...
Epoch: 19 cost time: 0.6489920616149902
Epoch: 19, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.698 Vali Acc: 0.859 Test Loss: 0.698 Test Acc: 0.859
Validation loss decreased (-0.837030 --> -0.859252).  Saving model ...
Epoch: 20 cost time: 0.7281455993652344
Epoch: 20, Steps: 2 | Train Loss: 0.609 Vali Loss: 0.648 Vali Acc: 0.870 Test Loss: 0.648 Test Acc: 0.870
Validation loss decreased (-0.859252 --> -0.870364).  Saving model ...
Epoch: 21 cost time: 0.6455526351928711
Epoch: 21, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.601 Vali Acc: 0.893 Test Loss: 0.601 Test Acc: 0.893
Validation loss decreased (-0.870364 --> -0.892587).  Saving model ...
Epoch: 22 cost time: 0.5481343269348145
Epoch: 22, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.559 Vali Acc: 0.889 Test Loss: 0.559 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5348877906799316
Epoch: 23, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.521 Vali Acc: 0.896 Test Loss: 0.521 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 24 cost time: 0.5965597629547119
Epoch: 24, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.6223318576812744
Epoch: 25, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.455 Vali Acc: 0.896 Test Loss: 0.455 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.7359058856964111
Epoch: 26, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.427 Vali Acc: 0.896 Test Loss: 0.427 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5424938201904297
Epoch: 27, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.403 Vali Acc: 0.904 Test Loss: 0.403 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903700).  Saving model ...
Epoch: 28 cost time: 0.5460250377655029
Epoch: 28, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.381 Vali Acc: 0.907 Test Loss: 0.381 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 29 cost time: 0.6422667503356934
Epoch: 29, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.363 Vali Acc: 0.915 Test Loss: 0.363 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.6550652980804443
Epoch: 30, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.344 Vali Acc: 0.919 Test Loss: 0.344 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 31 cost time: 0.6403641700744629
Epoch: 31, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.327 Vali Acc: 0.922 Test Loss: 0.327 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 32 cost time: 0.6192970275878906
Epoch: 32, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 33 cost time: 0.7037301063537598
Epoch: 33, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.302 Vali Acc: 0.922 Test Loss: 0.302 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 0.734682559967041
Epoch: 34, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.6551198959350586
Epoch: 35, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.6669306755065918
Epoch: 36, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.274 Vali Acc: 0.922 Test Loss: 0.274 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.6578903198242188
Epoch: 37, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 38 cost time: 0.6629071235656738
Epoch: 38, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.261 Vali Acc: 0.930 Test Loss: 0.261 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.6449370384216309
Epoch: 39, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.677478551864624
Epoch: 40, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.7103424072265625
Epoch: 41, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.245 Vali Acc: 0.933 Test Loss: 0.245 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.6546206474304199
Epoch: 42, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.6201534271240234
Epoch: 43, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.6148910522460938
Epoch: 44, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.6515274047851562
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.6327190399169922
Epoch: 46, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.6726853847503662
Epoch: 47, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.6444535255432129
Epoch: 48, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 49 cost time: 0.6246969699859619
Epoch: 49, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.6296682357788086
Epoch: 50, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.7306673526763916
Epoch: 51, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.6682229042053223
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.6164085865020752
Epoch: 53, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.213 Vali Acc: 0.948 Test Loss: 0.213 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 54 cost time: 0.6376862525939941
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.6894216537475586
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.6368300914764404
Epoch: 56, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 57 cost time: 0.7311129570007324
Epoch: 57, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 58 cost time: 0.6808257102966309
Epoch: 58, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 59 cost time: 0.7309949398040771
Epoch: 59, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 60 cost time: 0.5937821865081787
Epoch: 60, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 61 cost time: 0.752387523651123
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 62 cost time: 0.6432173252105713
Epoch: 62, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 63 cost time: 0.687861442565918
Epoch: 63, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 26374
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4436521530151367
Epoch: 1, Steps: 2 | Train Loss: 1.953 Vali Loss: 1.877 Vali Acc: 0.089 Test Loss: 1.877 Test Acc: 0.089
Validation loss decreased (inf --> -0.088870).  Saving model ...
Epoch: 2 cost time: 0.5654089450836182
Epoch: 2, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.803 Vali Acc: 0.193 Test Loss: 1.803 Test Acc: 0.193
Validation loss decreased (-0.088870 --> -0.192575).  Saving model ...
Epoch: 3 cost time: 0.6065351963043213
Epoch: 3, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.752 Vali Acc: 0.256 Test Loss: 1.752 Test Acc: 0.256
Validation loss decreased (-0.192575 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.6269369125366211
Epoch: 4, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.708 Vali Acc: 0.289 Test Loss: 1.708 Test Acc: 0.289
Validation loss decreased (-0.255538 --> -0.288872).  Saving model ...
Epoch: 5 cost time: 0.5829129219055176
Epoch: 5, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.651 Vali Acc: 0.330 Test Loss: 1.651 Test Acc: 0.330
Validation loss decreased (-0.288872 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.535341739654541
Epoch: 6, Steps: 2 | Train Loss: 1.622 Vali Loss: 1.587 Vali Acc: 0.385 Test Loss: 1.587 Test Acc: 0.385
Validation loss decreased (-0.329613 --> -0.385169).  Saving model ...
Epoch: 7 cost time: 0.5024573802947998
Epoch: 7, Steps: 2 | Train Loss: 1.583 Vali Loss: 1.516 Vali Acc: 0.415 Test Loss: 1.516 Test Acc: 0.415
Validation loss decreased (-0.385169 --> -0.414800).  Saving model ...
Epoch: 8 cost time: 0.5053186416625977
Epoch: 8, Steps: 2 | Train Loss: 1.430 Vali Loss: 1.442 Vali Acc: 0.444 Test Loss: 1.442 Test Acc: 0.444
Validation loss decreased (-0.414800 --> -0.444430).  Saving model ...
Epoch: 9 cost time: 0.546452522277832
Epoch: 9, Steps: 2 | Train Loss: 1.442 Vali Loss: 1.366 Vali Acc: 0.481 Test Loss: 1.366 Test Acc: 0.481
Validation loss decreased (-0.444430 --> -0.481468).  Saving model ...
Epoch: 10 cost time: 0.5548293590545654
Epoch: 10, Steps: 2 | Train Loss: 1.346 Vali Loss: 1.290 Vali Acc: 0.570 Test Loss: 1.290 Test Acc: 0.570
Validation loss decreased (-0.481468 --> -0.570357).  Saving model ...
Epoch: 11 cost time: 0.5727612972259521
Epoch: 11, Steps: 2 | Train Loss: 1.161 Vali Loss: 1.213 Vali Acc: 0.633 Test Loss: 1.213 Test Acc: 0.633
Validation loss decreased (-0.570357 --> -0.633321).  Saving model ...
Epoch: 12 cost time: 0.5654919147491455
Epoch: 12, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.137 Vali Acc: 0.678 Test Loss: 1.137 Test Acc: 0.678
Validation loss decreased (-0.633321 --> -0.677766).  Saving model ...
Epoch: 13 cost time: 0.5601637363433838
Epoch: 13, Steps: 2 | Train Loss: 1.068 Vali Loss: 1.064 Vali Acc: 0.704 Test Loss: 1.064 Test Acc: 0.704
Validation loss decreased (-0.677766 --> -0.703693).  Saving model ...
Epoch: 14 cost time: 0.6070632934570312
Epoch: 14, Steps: 2 | Train Loss: 0.939 Vali Loss: 0.993 Vali Acc: 0.748 Test Loss: 0.993 Test Acc: 0.748
Validation loss decreased (-0.703693 --> -0.748138).  Saving model ...
Epoch: 15 cost time: 0.6419713497161865
Epoch: 15, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.924 Vali Acc: 0.781 Test Loss: 0.924 Test Acc: 0.781
Validation loss decreased (-0.748138 --> -0.781472).  Saving model ...
Epoch: 16 cost time: 0.5819036960601807
Epoch: 16, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.859 Vali Acc: 0.811 Test Loss: 0.859 Test Acc: 0.811
Validation loss decreased (-0.781472 --> -0.811103).  Saving model ...
Epoch: 17 cost time: 0.6349475383758545
Epoch: 17, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.797 Vali Acc: 0.826 Test Loss: 0.797 Test Acc: 0.826
Validation loss decreased (-0.811103 --> -0.825918).  Saving model ...
Epoch: 18 cost time: 0.5977914333343506
Epoch: 18, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.738 Vali Acc: 0.837 Test Loss: 0.738 Test Acc: 0.837
Validation loss decreased (-0.825918 --> -0.837030).  Saving model ...
Epoch: 19 cost time: 0.5544948577880859
Epoch: 19, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.684 Vali Acc: 0.852 Test Loss: 0.684 Test Acc: 0.852
Validation loss decreased (-0.837030 --> -0.851845).  Saving model ...
Epoch: 20 cost time: 0.620917797088623
Epoch: 20, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.634 Vali Acc: 0.878 Test Loss: 0.634 Test Acc: 0.878
Validation loss decreased (-0.851845 --> -0.877771).  Saving model ...
Epoch: 21 cost time: 0.6050620079040527
Epoch: 21, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.588 Vali Acc: 0.896 Test Loss: 0.588 Test Acc: 0.896
Validation loss decreased (-0.877771 --> -0.896290).  Saving model ...
Epoch: 22 cost time: 0.6848042011260986
Epoch: 22, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.547 Vali Acc: 0.889 Test Loss: 0.547 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6046438217163086
Epoch: 23, Steps: 2 | Train Loss: 0.391 Vali Loss: 0.510 Vali Acc: 0.893 Test Loss: 0.510 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6963868141174316
Epoch: 24, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.476 Vali Acc: 0.904 Test Loss: 0.476 Test Acc: 0.904
Validation loss decreased (-0.896290 --> -0.903699).  Saving model ...
Epoch: 25 cost time: 0.562222957611084
Epoch: 25, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.445 Vali Acc: 0.907 Test Loss: 0.445 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 26 cost time: 0.6214861869812012
Epoch: 26, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.6923635005950928
Epoch: 27, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.393 Vali Acc: 0.911 Test Loss: 0.393 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.6331896781921387
Epoch: 28, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.371 Vali Acc: 0.922 Test Loss: 0.371 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 29 cost time: 0.6159288883209229
Epoch: 29, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6170544624328613
Epoch: 30, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.334 Vali Acc: 0.933 Test Loss: 0.334 Test Acc: 0.933
Validation loss decreased (-0.922219 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.5555152893066406
Epoch: 31, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.318 Vali Acc: 0.941 Test Loss: 0.318 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 32 cost time: 0.6316931247711182
Epoch: 32, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 0.6746542453765869
Epoch: 33, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.293 Vali Acc: 0.944 Test Loss: 0.293 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 34 cost time: 0.6447932720184326
Epoch: 34, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.283 Vali Acc: 0.941 Test Loss: 0.283 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.6448392868041992
Epoch: 35, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.274 Vali Acc: 0.944 Test Loss: 0.274 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.5470528602600098
Epoch: 36, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.267 Vali Acc: 0.948 Test Loss: 0.267 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948145).  Saving model ...
Epoch: 37 cost time: 0.6099023818969727
Epoch: 37, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.260 Vali Acc: 0.948 Test Loss: 0.260 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 38 cost time: 0.738915205001831
Epoch: 38, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.7136728763580322
Epoch: 39, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 0.5822787284851074
Epoch: 40, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.243 Vali Acc: 0.948 Test Loss: 0.243 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 41 cost time: 0.6851832866668701
Epoch: 41, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.238 Vali Acc: 0.948 Test Loss: 0.238 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 42 cost time: 0.5839087963104248
Epoch: 42, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.234 Vali Acc: 0.948 Test Loss: 0.234 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 43 cost time: 0.590850830078125
Epoch: 43, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.231 Vali Acc: 0.948 Test Loss: 0.231 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 44 cost time: 0.6480040550231934
Epoch: 44, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.228 Vali Acc: 0.948 Test Loss: 0.228 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 45 cost time: 0.5934386253356934
Epoch: 45, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.225 Vali Acc: 0.948 Test Loss: 0.225 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 46 cost time: 0.6366491317749023
Epoch: 46, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.222 Vali Acc: 0.948 Test Loss: 0.222 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 47 cost time: 0.5964322090148926
Epoch: 47, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.219 Vali Acc: 0.948 Test Loss: 0.219 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 48 cost time: 0.5762410163879395
Epoch: 48, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.948 Test Loss: 0.217 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 49 cost time: 0.6710700988769531
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.948 Test Loss: 0.214 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 50 cost time: 0.6267037391662598
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.948 Test Loss: 0.211 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 51 cost time: 0.6867895126342773
Epoch: 51, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.209 Vali Acc: 0.948 Test Loss: 0.209 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 52 cost time: 0.6076014041900635
Epoch: 52, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.207 Vali Acc: 0.952 Test Loss: 0.207 Test Acc: 0.952
Validation loss decreased (-0.948146 --> -0.951850).  Saving model ...
Epoch: 53 cost time: 0.7066230773925781
Epoch: 53, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.205 Vali Acc: 0.952 Test Loss: 0.205 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 54 cost time: 0.5570366382598877
Epoch: 54, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.203 Vali Acc: 0.952 Test Loss: 0.203 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 55 cost time: 0.593651533126831
Epoch: 55, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.952 Test Loss: 0.201 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 56 cost time: 0.5856642723083496
Epoch: 56, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.952 Test Loss: 0.200 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 57 cost time: 0.625359296798706
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.199 Vali Acc: 0.952 Test Loss: 0.199 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 58 cost time: 0.5876791477203369
Epoch: 58, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.198 Vali Acc: 0.952 Test Loss: 0.198 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 59 cost time: 0.6435987949371338
Epoch: 59, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.610870361328125
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.6225640773773193
Epoch: 61, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.7394237518310547
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.624342679977417
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.948 Test Loss: 0.194 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.6235780715942383
Epoch: 64, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.948 Test Loss: 0.193 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.787712812423706
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.192 Vali Acc: 0.948 Test Loss: 0.192 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.6217155456542969
Epoch: 66, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.948 Test Loss: 0.191 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.6465959548950195
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.190 Vali Acc: 0.948 Test Loss: 0.190 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.6536970138549805
Epoch: 68, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.188 Vali Acc: 0.952 Test Loss: 0.188 Test Acc: 0.952
Validation loss decreased (-0.951850 --> -0.951850).  Saving model ...
Epoch: 69 cost time: 0.8109860420227051
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.187 Vali Acc: 0.956 Test Loss: 0.187 Test Acc: 0.956
Validation loss decreased (-0.951850 --> -0.955554).  Saving model ...
Epoch: 70 cost time: 0.7321867942810059
Epoch: 70, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.956 Test Loss: 0.186 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 71 cost time: 0.7714552879333496
Epoch: 71, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.186 Vali Acc: 0.952 Test Loss: 0.186 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 72 cost time: 0.629101037979126
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.952 Test Loss: 0.185 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 73 cost time: 0.6623990535736084
Epoch: 73, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.185 Vali Acc: 0.948 Test Loss: 0.185 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 74 cost time: 0.665438175201416
Epoch: 74, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 75 cost time: 0.6120848655700684
Epoch: 75, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.184 Vali Acc: 0.948 Test Loss: 0.184 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 76 cost time: 0.6111650466918945
Epoch: 76, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.948 Test Loss: 0.183 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 77 cost time: 0.5994307994842529
Epoch: 77, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.182 Vali Acc: 0.952 Test Loss: 0.182 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 78 cost time: 0.5539772510528564
Epoch: 78, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.952 Test Loss: 0.181 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 79 cost time: 0.5074765682220459
Epoch: 79, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 80 cost time: 0.5935502052307129
Epoch: 80, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 81 cost time: 0.6269083023071289
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 82 cost time: 0.5657174587249756
Epoch: 82, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.179 Vali Acc: 0.956 Test Loss: 0.179 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 83 cost time: 0.5599517822265625
Epoch: 83, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.956 Test Loss: 0.178 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 84 cost time: 0.6145439147949219
Epoch: 84, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 85 cost time: 0.6313397884368896
Epoch: 85, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.177 Vali Acc: 0.956 Test Loss: 0.177 Test Acc: 0.956
Validation loss decreased (-0.955554 --> -0.955554).  Saving model ...
Epoch: 86 cost time: 0.6048355102539062
Epoch: 86, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 87 cost time: 0.6373298168182373
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.177 Vali Acc: 0.952 Test Loss: 0.177 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 88 cost time: 0.6129372119903564
Epoch: 88, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 89 cost time: 0.6582753658294678
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 4 out of 10
Epoch: 90 cost time: 0.601834774017334
Epoch: 90, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 91 cost time: 0.5979411602020264
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 92 cost time: 0.7137002944946289
Epoch: 92, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 93 cost time: 0.7456140518188477
Epoch: 93, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.952 Test Loss: 0.176 Test Acc: 0.952
EarlyStopping counter: 8 out of 10
Epoch: 94 cost time: 0.6432466506958008
Epoch: 94, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 95 cost time: 0.6697680950164795
Epoch: 95, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.175 Vali Acc: 0.952 Test Loss: 0.175 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 26374
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0157811641693115
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.855 Vali Acc: 0.144 Test Loss: 1.855 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.5953190326690674
Epoch: 2, Steps: 2 | Train Loss: 1.928 Vali Loss: 1.782 Vali Acc: 0.207 Test Loss: 1.782 Test Acc: 0.207
Validation loss decreased (-0.144426 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.546105146408081
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.733 Vali Acc: 0.267 Test Loss: 1.733 Test Acc: 0.267
Validation loss decreased (-0.207390 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.5497393608093262
Epoch: 4, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.690 Vali Acc: 0.300 Test Loss: 1.690 Test Acc: 0.300
Validation loss decreased (-0.266649 --> -0.299983).  Saving model ...
Epoch: 5 cost time: 0.5575666427612305
Epoch: 5, Steps: 2 | Train Loss: 1.753 Vali Loss: 1.634 Vali Acc: 0.341 Test Loss: 1.634 Test Acc: 0.341
Validation loss decreased (-0.299983 --> -0.340724).  Saving model ...
Epoch: 6 cost time: 0.6401638984680176
Epoch: 6, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.570 Vali Acc: 0.378 Test Loss: 1.570 Test Acc: 0.378
Validation loss decreased (-0.340724 --> -0.377762).  Saving model ...
Epoch: 7 cost time: 0.609006404876709
Epoch: 7, Steps: 2 | Train Loss: 1.581 Vali Loss: 1.500 Vali Acc: 0.396 Test Loss: 1.500 Test Acc: 0.396
Validation loss decreased (-0.377762 --> -0.396281).  Saving model ...
Epoch: 8 cost time: 0.7034924030303955
Epoch: 8, Steps: 2 | Train Loss: 1.420 Vali Loss: 1.427 Vali Acc: 0.452 Test Loss: 1.427 Test Acc: 0.452
Validation loss decreased (-0.396281 --> -0.451838).  Saving model ...
Epoch: 9 cost time: 0.7136170864105225
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.352 Vali Acc: 0.519 Test Loss: 1.352 Test Acc: 0.519
Validation loss decreased (-0.451838 --> -0.518505).  Saving model ...
Epoch: 10 cost time: 0.6473946571350098
Epoch: 10, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.276 Vali Acc: 0.581 Test Loss: 1.276 Test Acc: 0.581
Validation loss decreased (-0.518505 --> -0.581469).  Saving model ...
Epoch: 11 cost time: 0.6462302207946777
Epoch: 11, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.199 Vali Acc: 0.644 Test Loss: 1.199 Test Acc: 0.644
Validation loss decreased (-0.581469 --> -0.644432).  Saving model ...
Epoch: 12 cost time: 0.5748605728149414
Epoch: 12, Steps: 2 | Train Loss: 1.118 Vali Loss: 1.125 Vali Acc: 0.693 Test Loss: 1.125 Test Acc: 0.693
Validation loss decreased (-0.644432 --> -0.692581).  Saving model ...
Epoch: 13 cost time: 0.6300930976867676
Epoch: 13, Steps: 2 | Train Loss: 1.066 Vali Loss: 1.053 Vali Acc: 0.722 Test Loss: 1.053 Test Acc: 0.722
Validation loss decreased (-0.692581 --> -0.722212).  Saving model ...
Epoch: 14 cost time: 0.5947849750518799
Epoch: 14, Steps: 2 | Train Loss: 0.935 Vali Loss: 0.982 Vali Acc: 0.781 Test Loss: 0.982 Test Acc: 0.781
Validation loss decreased (-0.722212 --> -0.781472).  Saving model ...
Epoch: 15 cost time: 0.5799808502197266
Epoch: 15, Steps: 2 | Train Loss: 0.814 Vali Loss: 0.914 Vali Acc: 0.811 Test Loss: 0.914 Test Acc: 0.811
Validation loss decreased (-0.781472 --> -0.811102).  Saving model ...
Epoch: 16 cost time: 0.5873911380767822
Epoch: 16, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.850 Vali Acc: 0.830 Test Loss: 0.850 Test Acc: 0.830
Validation loss decreased (-0.811102 --> -0.829621).  Saving model ...
Epoch: 17 cost time: 0.6679003238677979
Epoch: 17, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.789 Vali Acc: 0.848 Test Loss: 0.789 Test Acc: 0.848
Validation loss decreased (-0.829621 --> -0.848140).  Saving model ...
Epoch: 18 cost time: 0.6238498687744141
Epoch: 18, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.732 Vali Acc: 0.859 Test Loss: 0.732 Test Acc: 0.859
Validation loss decreased (-0.848140 --> -0.859252).  Saving model ...
Epoch: 19 cost time: 0.6605298519134521
Epoch: 19, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.679 Vali Acc: 0.859 Test Loss: 0.679 Test Acc: 0.859
Validation loss decreased (-0.859252 --> -0.859252).  Saving model ...
Epoch: 20 cost time: 0.5786640644073486
Epoch: 20, Steps: 2 | Train Loss: 0.555 Vali Loss: 0.630 Vali Acc: 0.878 Test Loss: 0.630 Test Acc: 0.878
Validation loss decreased (-0.859252 --> -0.877771).  Saving model ...
Epoch: 21 cost time: 0.60746169090271
Epoch: 21, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.585 Vali Acc: 0.885 Test Loss: 0.585 Test Acc: 0.885
Validation loss decreased (-0.877771 --> -0.885179).  Saving model ...
Epoch: 22 cost time: 0.6862308979034424
Epoch: 22, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.545 Vali Acc: 0.896 Test Loss: 0.545 Test Acc: 0.896
Validation loss decreased (-0.885179 --> -0.896291).  Saving model ...
Epoch: 23 cost time: 0.5668973922729492
Epoch: 23, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.508 Vali Acc: 0.904 Test Loss: 0.508 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 24 cost time: 0.632753849029541
Epoch: 24, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.474 Vali Acc: 0.915 Test Loss: 0.474 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914810).  Saving model ...
Epoch: 25 cost time: 0.6061108112335205
Epoch: 25, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.444 Vali Acc: 0.930 Test Loss: 0.444 Test Acc: 0.930
Validation loss decreased (-0.914810 --> -0.929625).  Saving model ...
Epoch: 26 cost time: 0.6099762916564941
Epoch: 26, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.417 Vali Acc: 0.930 Test Loss: 0.417 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.6294004917144775
Epoch: 27, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.393 Vali Acc: 0.933 Test Loss: 0.393 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.6130187511444092
Epoch: 28, Steps: 2 | Train Loss: 0.241 Vali Loss: 0.371 Vali Acc: 0.933 Test Loss: 0.371 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 29 cost time: 0.618340015411377
Epoch: 29, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.352 Vali Acc: 0.937 Test Loss: 0.352 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 30 cost time: 0.62068772315979
Epoch: 30, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.334 Vali Acc: 0.937 Test Loss: 0.334 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 31 cost time: 0.5792734622955322
Epoch: 31, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.317 Vali Acc: 0.937 Test Loss: 0.317 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.6816349029541016
Epoch: 32, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 33 cost time: 0.6080775260925293
Epoch: 33, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.292 Vali Acc: 0.937 Test Loss: 0.292 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.6624026298522949
Epoch: 34, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.944 Test Loss: 0.281 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 35 cost time: 0.6870076656341553
Epoch: 35, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.272 Vali Acc: 0.944 Test Loss: 0.272 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 36 cost time: 0.6383411884307861
Epoch: 36, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.264 Vali Acc: 0.944 Test Loss: 0.264 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.6235506534576416
Epoch: 37, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.257 Vali Acc: 0.944 Test Loss: 0.257 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.5992772579193115
Epoch: 38, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.251 Vali Acc: 0.944 Test Loss: 0.251 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.6305232048034668
Epoch: 39, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.6781463623046875
Epoch: 40, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.240 Vali Acc: 0.944 Test Loss: 0.240 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.5718796253204346
Epoch: 41, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.235 Vali Acc: 0.944 Test Loss: 0.235 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.6129472255706787
Epoch: 42, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.5802624225616455
Epoch: 43, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.613966703414917
Epoch: 44, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.5996277332305908
Epoch: 45, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.6003828048706055
Epoch: 46, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.4740879535675049
Epoch: 47, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5528159141540527
Epoch: 48, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4476947784423828
Epoch: 49, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.472597599029541
Epoch: 50, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.780118465423584
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.5601744651794434
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.554804801940918
Epoch: 53, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.5432467460632324
Epoch: 54, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.200 Vali Acc: 0.944 Test Loss: 0.200 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.5980579853057861
Epoch: 55, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.199 Vali Acc: 0.944 Test Loss: 0.199 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.5776011943817139
Epoch: 56, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.6608657836914062
Epoch: 57, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.7167425155639648
Epoch: 58, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.194 Vali Acc: 0.944 Test Loss: 0.194 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 59 cost time: 0.6476395130157471
Epoch: 59, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.193 Vali Acc: 0.944 Test Loss: 0.193 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 60 cost time: 0.6490585803985596
Epoch: 60, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.192 Vali Acc: 0.944 Test Loss: 0.192 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 61 cost time: 0.6351969242095947
Epoch: 61, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.191 Vali Acc: 0.944 Test Loss: 0.191 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 62 cost time: 0.6792392730712891
Epoch: 62, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.190 Vali Acc: 0.944 Test Loss: 0.190 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 63 cost time: 0.5994212627410889
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 64 cost time: 0.558610200881958
Epoch: 64, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.189 Vali Acc: 0.944 Test Loss: 0.189 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 65 cost time: 0.5814111232757568
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.188 Vali Acc: 0.944 Test Loss: 0.188 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 66 cost time: 0.5608210563659668
Epoch: 66, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 67 cost time: 0.597724199295044
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 68 cost time: 0.7009456157684326
Epoch: 68, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 69 cost time: 0.6326601505279541
Epoch: 69, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 70 cost time: 0.6204299926757812
Epoch: 70, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 71 cost time: 0.6475629806518555
Epoch: 71, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 72 cost time: 0.6223833560943604
Epoch: 72, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 73 cost time: 0.6165201663970947
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 74 cost time: 0.6097095012664795
Epoch: 74, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 75 cost time: 0.625511884689331
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 76 cost time: 0.5575146675109863
Epoch: 76, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 77 cost time: 0.6245591640472412
Epoch: 77, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.181 Vali Acc: 0.944 Test Loss: 0.181 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 78 cost time: 0.6451668739318848
Epoch: 78, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.180 Vali Acc: 0.944 Test Loss: 0.180 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 79 cost time: 0.6240582466125488
Epoch: 79, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 80 cost time: 0.6286823749542236
Epoch: 80, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.179 Vali Acc: 0.944 Test Loss: 0.179 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 81 cost time: 0.5686781406402588
Epoch: 81, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 82 cost time: 0.6296632289886475
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 83 cost time: 0.6204946041107178
Epoch: 83, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.177 Vali Acc: 0.944 Test Loss: 0.177 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 84 cost time: 0.5977621078491211
Epoch: 84, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 85 cost time: 0.7544434070587158
Epoch: 85, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 86 cost time: 0.6398787498474121
Epoch: 86, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.176 Vali Acc: 0.944 Test Loss: 0.176 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 87 cost time: 0.6108577251434326
Epoch: 87, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 88 cost time: 0.6916043758392334
Epoch: 88, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 89 cost time: 0.6350705623626709
Epoch: 89, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 90 cost time: 0.6708250045776367
Epoch: 90, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 91 cost time: 0.6510035991668701
Epoch: 91, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 92 cost time: 0.6577517986297607
Epoch: 92, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 93 cost time: 0.6350953578948975
Epoch: 93, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.175 Vali Acc: 0.944 Test Loss: 0.175 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 0.590726375579834
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 95 cost time: 0.565474271774292
Epoch: 95, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 96 cost time: 0.6191017627716064
Epoch: 96, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.174 Vali Acc: 0.944 Test Loss: 0.174 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 97 cost time: 0.5761682987213135
Epoch: 97, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
Validation loss decreased (-0.944443 --> -0.948146).  Saving model ...
Epoch: 98 cost time: 0.6231987476348877
Epoch: 98, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.5672056674957275
Epoch: 99, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.948 Test Loss: 0.175 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.5750856399536133
Epoch: 100, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.948 Test Loss: 0.174 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 26374
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.382477283477783
Epoch: 1, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.802 Vali Acc: 0.207 Test Loss: 1.802 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.5840973854064941
Epoch: 2, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.735 Vali Acc: 0.270 Test Loss: 1.735 Test Acc: 0.270
Validation loss decreased (-0.207389 --> -0.270353).  Saving model ...
Epoch: 3 cost time: 0.6192164421081543
Epoch: 3, Steps: 2 | Train Loss: 1.730 Vali Loss: 1.689 Vali Acc: 0.319 Test Loss: 1.689 Test Acc: 0.319
Validation loss decreased (-0.270353 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.6183760166168213
Epoch: 4, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.649 Vali Acc: 0.337 Test Loss: 1.649 Test Acc: 0.337
Validation loss decreased (-0.318502 --> -0.337021).  Saving model ...
Epoch: 5 cost time: 0.5962100028991699
Epoch: 5, Steps: 2 | Train Loss: 1.758 Vali Loss: 1.598 Vali Acc: 0.367 Test Loss: 1.598 Test Acc: 0.367
Validation loss decreased (-0.337021 --> -0.366651).  Saving model ...
Epoch: 6 cost time: 0.609668493270874
Epoch: 6, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.538 Vali Acc: 0.415 Test Loss: 1.538 Test Acc: 0.415
Validation loss decreased (-0.366651 --> -0.414799).  Saving model ...
Epoch: 7 cost time: 0.5482597351074219
Epoch: 7, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.474 Vali Acc: 0.463 Test Loss: 1.474 Test Acc: 0.463
Validation loss decreased (-0.414799 --> -0.462948).  Saving model ...
Epoch: 8 cost time: 0.597844123840332
Epoch: 8, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.406 Vali Acc: 0.511 Test Loss: 1.406 Test Acc: 0.511
Validation loss decreased (-0.462948 --> -0.511097).  Saving model ...
Epoch: 9 cost time: 0.5630512237548828
Epoch: 9, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.337 Vali Acc: 0.578 Test Loss: 1.337 Test Acc: 0.578
Validation loss decreased (-0.511097 --> -0.577764).  Saving model ...
Epoch: 10 cost time: 0.5873808860778809
Epoch: 10, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.267 Vali Acc: 0.630 Test Loss: 1.267 Test Acc: 0.630
Validation loss decreased (-0.577764 --> -0.629617).  Saving model ...
Epoch: 11 cost time: 0.5831089019775391
Epoch: 11, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.195 Vali Acc: 0.667 Test Loss: 1.195 Test Acc: 0.667
Validation loss decreased (-0.629617 --> -0.666655).  Saving model ...
Epoch: 12 cost time: 0.5740616321563721
Epoch: 12, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.126 Vali Acc: 0.689 Test Loss: 1.126 Test Acc: 0.689
Validation loss decreased (-0.666655 --> -0.688878).  Saving model ...
Epoch: 13 cost time: 0.511193037033081
Epoch: 13, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.058 Vali Acc: 0.733 Test Loss: 1.058 Test Acc: 0.733
Validation loss decreased (-0.688878 --> -0.733323).  Saving model ...
Epoch: 14 cost time: 0.5393431186676025
Epoch: 14, Steps: 2 | Train Loss: 1.008 Vali Loss: 0.992 Vali Acc: 0.774 Test Loss: 0.992 Test Acc: 0.774
Validation loss decreased (-0.733323 --> -0.774064).  Saving model ...
Epoch: 15 cost time: 0.5436186790466309
Epoch: 15, Steps: 2 | Train Loss: 0.896 Vali Loss: 0.928 Vali Acc: 0.796 Test Loss: 0.928 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 16 cost time: 0.5931277275085449
Epoch: 16, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.867 Vali Acc: 0.807 Test Loss: 0.867 Test Acc: 0.807
Validation loss decreased (-0.796287 --> -0.807399).  Saving model ...
Epoch: 17 cost time: 0.604748010635376
Epoch: 17, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.808 Vali Acc: 0.826 Test Loss: 0.808 Test Acc: 0.826
Validation loss decreased (-0.807399 --> -0.825918).  Saving model ...
Epoch: 18 cost time: 0.5601506233215332
Epoch: 18, Steps: 2 | Train Loss: 0.800 Vali Loss: 0.754 Vali Acc: 0.841 Test Loss: 0.754 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840733).  Saving model ...
Epoch: 19 cost time: 0.5674819946289062
Epoch: 19, Steps: 2 | Train Loss: 0.710 Vali Loss: 0.703 Vali Acc: 0.863 Test Loss: 0.703 Test Acc: 0.863
Validation loss decreased (-0.840733 --> -0.862956).  Saving model ...
Epoch: 20 cost time: 0.581507682800293
Epoch: 20, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.656 Vali Acc: 0.874 Test Loss: 0.656 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 21 cost time: 0.5836665630340576
Epoch: 21, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.612 Vali Acc: 0.881 Test Loss: 0.612 Test Acc: 0.881
Validation loss decreased (-0.874068 --> -0.881475).  Saving model ...
Epoch: 22 cost time: 0.665602445602417
Epoch: 22, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.573 Vali Acc: 0.881 Test Loss: 0.573 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 23 cost time: 0.6250514984130859
Epoch: 23, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.537 Vali Acc: 0.881 Test Loss: 0.537 Test Acc: 0.881
Validation loss decreased (-0.881476 --> -0.881476).  Saving model ...
Epoch: 24 cost time: 0.6227960586547852
Epoch: 24, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.504 Vali Acc: 0.889 Test Loss: 0.504 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 0.5782558917999268
Epoch: 25, Steps: 2 | Train Loss: 0.406 Vali Loss: 0.474 Vali Acc: 0.900 Test Loss: 0.474 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.572303056716919
Epoch: 26, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.448 Vali Acc: 0.907 Test Loss: 0.448 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.5374212265014648
Epoch: 27, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.424 Vali Acc: 0.904 Test Loss: 0.424 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5945875644683838
Epoch: 28, Steps: 2 | Train Loss: 0.313 Vali Loss: 0.402 Vali Acc: 0.907 Test Loss: 0.402 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.6212973594665527
Epoch: 29, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.383 Vali Acc: 0.911 Test Loss: 0.383 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.6370141506195068
Epoch: 30, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.365 Vali Acc: 0.915 Test Loss: 0.365 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.5838143825531006
Epoch: 31, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.349 Vali Acc: 0.915 Test Loss: 0.349 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.662987470626831
Epoch: 32, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.5667259693145752
Epoch: 33, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.321 Vali Acc: 0.919 Test Loss: 0.321 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.6117539405822754
Epoch: 34, Steps: 2 | Train Loss: 0.187 Vali Loss: 0.310 Vali Acc: 0.919 Test Loss: 0.310 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.5861845016479492
Epoch: 35, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.300 Vali Acc: 0.919 Test Loss: 0.300 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 36 cost time: 0.6171813011169434
Epoch: 36, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.291 Vali Acc: 0.922 Test Loss: 0.291 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.6147365570068359
Epoch: 37, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.284 Vali Acc: 0.926 Test Loss: 0.284 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.5386364459991455
Epoch: 38, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5901837348937988
Epoch: 39, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.270 Vali Acc: 0.926 Test Loss: 0.270 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.5711121559143066
Epoch: 40, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.265 Vali Acc: 0.922 Test Loss: 0.265 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.554696798324585
Epoch: 41, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.5535941123962402
Epoch: 42, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.530160665512085
Epoch: 43, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.5877792835235596
Epoch: 44, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.246 Vali Acc: 0.926 Test Loss: 0.246 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.5981447696685791
Epoch: 45, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.243 Vali Acc: 0.926 Test Loss: 0.243 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 46 cost time: 0.6676273345947266
Epoch: 46, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 47 cost time: 0.6011061668395996
Epoch: 47, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 48 cost time: 0.5945203304290771
Epoch: 48, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.5827145576477051
Epoch: 49, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.929627 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.5822300910949707
Epoch: 50, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.571058988571167
Epoch: 51, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.222 Vali Acc: 0.941 Test Loss: 0.222 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 52 cost time: 0.6128661632537842
Epoch: 52, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.220 Vali Acc: 0.941 Test Loss: 0.220 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 53 cost time: 0.6251075267791748
Epoch: 53, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.6393239498138428
Epoch: 54, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.5922095775604248
Epoch: 55, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 56 cost time: 0.6120009422302246
Epoch: 56, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.6376495361328125
Epoch: 57, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6114718914031982
Epoch: 58, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.6890437602996826
Epoch: 59, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.593879222869873
Epoch: 60, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.6379504203796387
Epoch: 61, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.584956169128418
Epoch: 62, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5391712188720703
Epoch: 63, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.5758624076843262
Epoch: 64, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.5653419494628906
Epoch: 65, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 26374
model size : 0.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.4502508640289307
Epoch: 1, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.497 Vali Acc: 0.419 Test Loss: 1.497 Test Acc: 0.419
Validation loss decreased (inf --> -0.418504).  Saving model ...
Epoch: 2 cost time: 0.5853893756866455
Epoch: 2, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.307 Vali Acc: 0.533 Test Loss: 1.307 Test Acc: 0.533
Validation loss decreased (-0.418504 --> -0.533320).  Saving model ...
Epoch: 3 cost time: 0.49871134757995605
Epoch: 3, Steps: 2 | Train Loss: 1.179 Vali Loss: 1.061 Vali Acc: 0.759 Test Loss: 1.061 Test Acc: 0.759
Validation loss decreased (-0.533320 --> -0.759249).  Saving model ...
Epoch: 4 cost time: 0.5707581043243408
Epoch: 4, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.746 Vali Acc: 0.856 Test Loss: 0.746 Test Acc: 0.856
Validation loss decreased (-0.759249 --> -0.855548).  Saving model ...
Epoch: 5 cost time: 0.5483217239379883
Epoch: 5, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.518 Vali Acc: 0.893 Test Loss: 0.518 Test Acc: 0.893
Validation loss decreased (-0.855548 --> -0.892587).  Saving model ...
Epoch: 6 cost time: 0.6590640544891357
Epoch: 6, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
Validation loss decreased (-0.892587 --> -0.914811).  Saving model ...
Epoch: 7 cost time: 0.580491304397583
Epoch: 7, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.284 Vali Acc: 0.933 Test Loss: 0.284 Test Acc: 0.933
Validation loss decreased (-0.914811 --> -0.933330).  Saving model ...
Epoch: 8 cost time: 0.5222795009613037
Epoch: 8, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5789387226104736
Epoch: 9, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.5841760635375977
Epoch: 10, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933332).  Saving model ...
Epoch: 11 cost time: 0.5552716255187988
Epoch: 11, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 12 cost time: 0.6341989040374756
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 13 cost time: 0.5617384910583496
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5309312343597412
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.933 Test Loss: 0.173 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5350878238677979
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.4788987636566162
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5412476062774658
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5391604900360107
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5645804405212402
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6294422149658203
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.5706238746643066
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5672264099121094
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 2837542
model size : 20.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5818073749542236
Epoch: 1, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.494 Vali Acc: 0.441 Test Loss: 1.494 Test Acc: 0.441
Validation loss decreased (inf --> -0.440726).  Saving model ...
Epoch: 2 cost time: 0.5431861877441406
Epoch: 2, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.305 Vali Acc: 0.556 Test Loss: 1.305 Test Acc: 0.556
Validation loss decreased (-0.440726 --> -0.555543).  Saving model ...
Epoch: 3 cost time: 0.5515220165252686
Epoch: 3, Steps: 2 | Train Loss: 1.193 Vali Loss: 1.061 Vali Acc: 0.759 Test Loss: 1.061 Test Acc: 0.759
Validation loss decreased (-0.555543 --> -0.759249).  Saving model ...
Epoch: 4 cost time: 0.6379625797271729
Epoch: 4, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.750 Vali Acc: 0.841 Test Loss: 0.750 Test Acc: 0.841
Validation loss decreased (-0.759249 --> -0.840733).  Saving model ...
Epoch: 5 cost time: 0.5484306812286377
Epoch: 5, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
Validation loss decreased (-0.840733 --> -0.892587).  Saving model ...
Epoch: 6 cost time: 0.6195552349090576
Epoch: 6, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.378 Vali Acc: 0.911 Test Loss: 0.378 Test Acc: 0.911
Validation loss decreased (-0.892587 --> -0.911107).  Saving model ...
Epoch: 7 cost time: 0.5265836715698242
Epoch: 7, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
Validation loss decreased (-0.911107 --> -0.922219).  Saving model ...
Epoch: 8 cost time: 0.5402915477752686
Epoch: 8, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.239 Vali Acc: 0.922 Test Loss: 0.239 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 9 cost time: 0.579998254776001
Epoch: 9, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 10 cost time: 0.6136622428894043
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.191 Vali Acc: 0.930 Test Loss: 0.191 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 11 cost time: 0.54537034034729
Epoch: 11, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.7386548519134521
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 13 cost time: 0.6687521934509277
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 14 cost time: 0.5644195079803467
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.926 Test Loss: 0.181 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6365535259246826
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5551159381866455
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.6089019775390625
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.6223325729370117
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.569694995880127
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6444478034973145
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.6766040325164795
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.6440844535827637
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6412515640258789
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 2837542
model size : 20.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.301568031311035
Epoch: 1, Steps: 2 | Train Loss: 1.721 Vali Loss: 1.502 Vali Acc: 0.444 Test Loss: 1.502 Test Acc: 0.444
Validation loss decreased (inf --> -0.444429).  Saving model ...
Epoch: 2 cost time: 0.6139864921569824
Epoch: 2, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.320 Vali Acc: 0.563 Test Loss: 1.320 Test Acc: 0.563
Validation loss decreased (-0.444429 --> -0.562950).  Saving model ...
Epoch: 3 cost time: 0.5362188816070557
Epoch: 3, Steps: 2 | Train Loss: 1.154 Vali Loss: 1.083 Vali Acc: 0.726 Test Loss: 1.083 Test Acc: 0.726
Validation loss decreased (-0.562950 --> -0.725915).  Saving model ...
Epoch: 4 cost time: 0.5698587894439697
Epoch: 4, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.780 Vali Acc: 0.841 Test Loss: 0.780 Test Acc: 0.841
Validation loss decreased (-0.725915 --> -0.840733).  Saving model ...
Epoch: 5 cost time: 0.5633480548858643
Epoch: 5, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.560 Vali Acc: 0.874 Test Loss: 0.560 Test Acc: 0.874
Validation loss decreased (-0.840733 --> -0.874068).  Saving model ...
Epoch: 6 cost time: 0.5442829132080078
Epoch: 6, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.415 Vali Acc: 0.896 Test Loss: 0.415 Test Acc: 0.896
Validation loss decreased (-0.874068 --> -0.896292).  Saving model ...
Epoch: 7 cost time: 0.4811861515045166
Epoch: 7, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.330 Vali Acc: 0.907 Test Loss: 0.330 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907404).  Saving model ...
Epoch: 8 cost time: 0.5939748287200928
Epoch: 8, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
Validation loss decreased (-0.907404 --> -0.922219).  Saving model ...
Epoch: 9 cost time: 0.48728394508361816
Epoch: 9, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 10 cost time: 0.5357213020324707
Epoch: 10, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.5897088050842285
Epoch: 11, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5714924335479736
Epoch: 12, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5299193859100342
Epoch: 13, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6069920063018799
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6236369609832764
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.6425495147705078
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.6007242202758789
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6440329551696777
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6470654010772705
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.5569977760314941
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 2837542
model size : 20.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.232905626296997
Epoch: 1, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.481 Vali Acc: 0.433 Test Loss: 1.481 Test Acc: 0.433
Validation loss decreased (inf --> -0.433319).  Saving model ...
Epoch: 2 cost time: 0.5606884956359863
Epoch: 2, Steps: 2 | Train Loss: 1.405 Vali Loss: 1.318 Vali Acc: 0.641 Test Loss: 1.318 Test Acc: 0.641
Validation loss decreased (-0.433319 --> -0.640728).  Saving model ...
Epoch: 3 cost time: 0.575486421585083
Epoch: 3, Steps: 2 | Train Loss: 1.215 Vali Loss: 1.109 Vali Acc: 0.652 Test Loss: 1.109 Test Acc: 0.652
Validation loss decreased (-0.640728 --> -0.651841).  Saving model ...
Epoch: 4 cost time: 0.5098628997802734
Epoch: 4, Steps: 2 | Train Loss: 0.933 Vali Loss: 0.841 Vali Acc: 0.737 Test Loss: 0.841 Test Acc: 0.737
Validation loss decreased (-0.651841 --> -0.737029).  Saving model ...
Epoch: 5 cost time: 0.5213587284088135
Epoch: 5, Steps: 2 | Train Loss: 0.662 Vali Loss: 0.640 Vali Acc: 0.789 Test Loss: 0.640 Test Acc: 0.789
Validation loss decreased (-0.737029 --> -0.788882).  Saving model ...
Epoch: 6 cost time: 0.5255992412567139
Epoch: 6, Steps: 2 | Train Loss: 0.422 Vali Loss: 0.509 Vali Acc: 0.826 Test Loss: 0.509 Test Acc: 0.826
Validation loss decreased (-0.788882 --> -0.825921).  Saving model ...
Epoch: 7 cost time: 0.5076916217803955
Epoch: 7, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.433 Vali Acc: 0.841 Test Loss: 0.433 Test Acc: 0.841
Validation loss decreased (-0.825921 --> -0.840736).  Saving model ...
Epoch: 8 cost time: 0.5360677242279053
Epoch: 8, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.393 Vali Acc: 0.837 Test Loss: 0.393 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5901896953582764
Epoch: 9, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.360 Vali Acc: 0.863 Test Loss: 0.360 Test Acc: 0.863
Validation loss decreased (-0.840736 --> -0.862959).  Saving model ...
Epoch: 10 cost time: 0.5237140655517578
Epoch: 10, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.334 Vali Acc: 0.874 Test Loss: 0.334 Test Acc: 0.874
Validation loss decreased (-0.862959 --> -0.874071).  Saving model ...
Epoch: 11 cost time: 0.6274080276489258
Epoch: 11, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.311 Vali Acc: 0.893 Test Loss: 0.311 Test Acc: 0.893
Validation loss decreased (-0.874071 --> -0.892589).  Saving model ...
Epoch: 12 cost time: 0.5942831039428711
Epoch: 12, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.301 Vali Acc: 0.893 Test Loss: 0.301 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892590).  Saving model ...
Epoch: 13 cost time: 0.6426353454589844
Epoch: 13, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.892590 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 0.6187067031860352
Epoch: 14, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.907 Test Loss: 0.291 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 0.6136012077331543
Epoch: 15, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.289 Vali Acc: 0.907 Test Loss: 0.289 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 16 cost time: 0.663532018661499
Epoch: 16, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.288 Vali Acc: 0.907 Test Loss: 0.288 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 17 cost time: 0.6037726402282715
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.289 Vali Acc: 0.904 Test Loss: 0.289 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.6212162971496582
Epoch: 18, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.290 Vali Acc: 0.904 Test Loss: 0.290 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.654693603515625
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5750010013580322
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.298 Vali Acc: 0.904 Test Loss: 0.298 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6533267498016357
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.6565685272216797
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.301 Vali Acc: 0.896 Test Loss: 0.301 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.6000912189483643
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.6517305374145508
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.893 Test Loss: 0.304 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 0.625723123550415
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.896 Test Loss: 0.305 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 0.6672782897949219
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.307 Vali Acc: 0.896 Test Loss: 0.307 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 2837542
model size : 20.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2446885108947754
Epoch: 1, Steps: 2 | Train Loss: 2.051 Vali Loss: 1.675 Vali Acc: 0.370 Test Loss: 1.675 Test Acc: 0.370
Validation loss decreased (inf --> -0.370354).  Saving model ...
Epoch: 2 cost time: 0.4960758686065674
Epoch: 2, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.462 Vali Acc: 0.485 Test Loss: 1.462 Test Acc: 0.485
Validation loss decreased (-0.370354 --> -0.485171).  Saving model ...
Epoch: 3 cost time: 0.5968832969665527
Epoch: 3, Steps: 2 | Train Loss: 1.436 Vali Loss: 1.191 Vali Acc: 0.630 Test Loss: 1.191 Test Acc: 0.630
Validation loss decreased (-0.485171 --> -0.629618).  Saving model ...
Epoch: 4 cost time: 0.618868350982666
Epoch: 4, Steps: 2 | Train Loss: 1.077 Vali Loss: 0.843 Vali Acc: 0.796 Test Loss: 0.843 Test Acc: 0.796
Validation loss decreased (-0.629618 --> -0.796288).  Saving model ...
Epoch: 5 cost time: 0.48818254470825195
Epoch: 5, Steps: 2 | Train Loss: 0.696 Vali Loss: 0.577 Vali Acc: 0.856 Test Loss: 0.577 Test Acc: 0.856
Validation loss decreased (-0.796288 --> -0.855550).  Saving model ...
Epoch: 6 cost time: 0.6200220584869385
Epoch: 6, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.394 Vali Acc: 0.937 Test Loss: 0.394 Test Acc: 0.937
Validation loss decreased (-0.855550 --> -0.937033).  Saving model ...
Epoch: 7 cost time: 0.5537259578704834
Epoch: 7, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5156276226043701
Epoch: 8, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5791172981262207
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.5801341533660889
Epoch: 10, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 0.578474760055542
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937035).  Saving model ...
Epoch: 12 cost time: 0.5562829971313477
Epoch: 12, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.629570484161377
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.587761402130127
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6193134784698486
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5618247985839844
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.555495023727417
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5608639717102051
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5188887119293213
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.534611701965332
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5132415294647217
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1788966
model size : 16.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.240633964538574
Epoch: 1, Steps: 2 | Train Loss: 2.048 Vali Loss: 1.684 Vali Acc: 0.378 Test Loss: 1.684 Test Acc: 0.378
Validation loss decreased (inf --> -0.377761).  Saving model ...
Epoch: 2 cost time: 0.569373369216919
Epoch: 2, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.470 Vali Acc: 0.493 Test Loss: 1.470 Test Acc: 0.493
Validation loss decreased (-0.377761 --> -0.492578).  Saving model ...
Epoch: 3 cost time: 0.6225326061248779
Epoch: 3, Steps: 2 | Train Loss: 1.406 Vali Loss: 1.197 Vali Acc: 0.622 Test Loss: 1.197 Test Acc: 0.622
Validation loss decreased (-0.492578 --> -0.622210).  Saving model ...
Epoch: 4 cost time: 0.5567190647125244
Epoch: 4, Steps: 2 | Train Loss: 1.052 Vali Loss: 0.848 Vali Acc: 0.800 Test Loss: 0.848 Test Acc: 0.800
Validation loss decreased (-0.622210 --> -0.799992).  Saving model ...
Epoch: 5 cost time: 0.5927338600158691
Epoch: 5, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.585 Vali Acc: 0.881 Test Loss: 0.585 Test Acc: 0.881
Validation loss decreased (-0.799992 --> -0.881476).  Saving model ...
Epoch: 6 cost time: 0.558297872543335
Epoch: 6, Steps: 2 | Train Loss: 0.394 Vali Loss: 0.405 Vali Acc: 0.930 Test Loss: 0.405 Test Acc: 0.930
Validation loss decreased (-0.881476 --> -0.929626).  Saving model ...
Epoch: 7 cost time: 0.5554249286651611
Epoch: 7, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.302 Vali Acc: 0.933 Test Loss: 0.302 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 8 cost time: 0.6081233024597168
Epoch: 8, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5069327354431152
Epoch: 9, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6214182376861572
Epoch: 10, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6026151180267334
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.604480504989624
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.184 Vali Acc: 0.933 Test Loss: 0.184 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6563997268676758
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 14 cost time: 0.6241886615753174
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.800551176071167
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6664519309997559
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.7036511898040771
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.7142312526702881
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.751685380935669
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.6323392391204834
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.8462362289428711
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.7708964347839355
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.6822829246520996
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.6839158535003662
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6702492237091064
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6788256168365479
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6427571773529053
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.619351863861084
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.55660080909729
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6396613121032715
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5638370513916016
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6164793968200684
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5682373046875
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1788966
model size : 16.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5172550678253174
Epoch: 1, Steps: 2 | Train Loss: 2.053 Vali Loss: 1.688 Vali Acc: 0.393 Test Loss: 1.688 Test Acc: 0.393
Validation loss decreased (inf --> -0.392576).  Saving model ...
Epoch: 2 cost time: 0.5999898910522461
Epoch: 2, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.476 Vali Acc: 0.474 Test Loss: 1.476 Test Acc: 0.474
Validation loss decreased (-0.392576 --> -0.474059).  Saving model ...
Epoch: 3 cost time: 0.6221675872802734
Epoch: 3, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.207 Vali Acc: 0.630 Test Loss: 1.207 Test Acc: 0.630
Validation loss decreased (-0.474059 --> -0.629618).  Saving model ...
Epoch: 4 cost time: 0.6606349945068359
Epoch: 4, Steps: 2 | Train Loss: 1.091 Vali Loss: 0.866 Vali Acc: 0.789 Test Loss: 0.866 Test Acc: 0.789
Validation loss decreased (-0.629618 --> -0.788880).  Saving model ...
Epoch: 5 cost time: 0.5679342746734619
Epoch: 5, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.614 Vali Acc: 0.830 Test Loss: 0.614 Test Acc: 0.830
Validation loss decreased (-0.788880 --> -0.829623).  Saving model ...
Epoch: 6 cost time: 0.5912966728210449
Epoch: 6, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.829623 --> -0.911107).  Saving model ...
Epoch: 7 cost time: 0.5726833343505859
Epoch: 7, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5883433818817139
Epoch: 8, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918516).  Saving model ...
Epoch: 9 cost time: 0.5700500011444092
Epoch: 9, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 10 cost time: 0.492769718170166
Epoch: 10, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.4983351230621338
Epoch: 11, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5488145351409912
Epoch: 12, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6374726295471191
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5052061080932617
Epoch: 14, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.4721353054046631
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5228304862976074
Epoch: 16, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.200 Vali Acc: 0.922 Test Loss: 0.200 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5791301727294922
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6394379138946533
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5848121643066406
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6234591007232666
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1788966
model size : 16.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.387195348739624
Epoch: 1, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.687 Vali Acc: 0.415 Test Loss: 1.687 Test Acc: 0.415
Validation loss decreased (inf --> -0.414798).  Saving model ...
Epoch: 2 cost time: 0.6608014106750488
Epoch: 2, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.488 Vali Acc: 0.500 Test Loss: 1.488 Test Acc: 0.500
Validation loss decreased (-0.414798 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.5597076416015625
Epoch: 3, Steps: 2 | Train Loss: 1.448 Vali Loss: 1.240 Vali Acc: 0.570 Test Loss: 1.240 Test Acc: 0.570
Validation loss decreased (-0.499985 --> -0.570358).  Saving model ...
Epoch: 4 cost time: 0.5195498466491699
Epoch: 4, Steps: 2 | Train Loss: 1.130 Vali Loss: 0.926 Vali Acc: 0.685 Test Loss: 0.926 Test Acc: 0.685
Validation loss decreased (-0.570358 --> -0.685176).  Saving model ...
Epoch: 5 cost time: 0.59755539894104
Epoch: 5, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.693 Vali Acc: 0.752 Test Loss: 0.693 Test Acc: 0.752
Validation loss decreased (-0.685176 --> -0.751845).  Saving model ...
Epoch: 6 cost time: 0.6503391265869141
Epoch: 6, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.534 Vali Acc: 0.774 Test Loss: 0.534 Test Acc: 0.774
Validation loss decreased (-0.751845 --> -0.774069).  Saving model ...
Epoch: 7 cost time: 0.7888936996459961
Epoch: 7, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.444 Vali Acc: 0.811 Test Loss: 0.444 Test Acc: 0.811
Validation loss decreased (-0.774069 --> -0.811107).  Saving model ...
Epoch: 8 cost time: 0.5708925724029541
Epoch: 8, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.392 Vali Acc: 0.856 Test Loss: 0.392 Test Acc: 0.856
Validation loss decreased (-0.811107 --> -0.855552).  Saving model ...
Epoch: 9 cost time: 0.6723811626434326
Epoch: 9, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.362 Vali Acc: 0.856 Test Loss: 0.362 Test Acc: 0.856
Validation loss decreased (-0.855552 --> -0.855552).  Saving model ...
Epoch: 10 cost time: 0.6423423290252686
Epoch: 10, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.337 Vali Acc: 0.867 Test Loss: 0.337 Test Acc: 0.867
Validation loss decreased (-0.855552 --> -0.866663).  Saving model ...
Epoch: 11 cost time: 0.6247327327728271
Epoch: 11, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.332 Vali Acc: 0.859 Test Loss: 0.332 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5172333717346191
Epoch: 12, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.331 Vali Acc: 0.856 Test Loss: 0.331 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6489644050598145
Epoch: 13, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.296 Vali Acc: 0.878 Test Loss: 0.296 Test Acc: 0.878
Validation loss decreased (-0.866663 --> -0.877775).  Saving model ...
Epoch: 14 cost time: 0.5866000652313232
Epoch: 14, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
Validation loss decreased (-0.877775 --> -0.892590).  Saving model ...
Epoch: 15 cost time: 0.585787296295166
Epoch: 15, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.297 Vali Acc: 0.881 Test Loss: 0.297 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.48283934593200684
Epoch: 16, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.276 Vali Acc: 0.904 Test Loss: 0.276 Test Acc: 0.904
Validation loss decreased (-0.892590 --> -0.903701).  Saving model ...
Epoch: 17 cost time: 0.537592887878418
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.286 Vali Acc: 0.893 Test Loss: 0.286 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5944550037384033
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5931046009063721
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.584193229675293
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.5472326278686523
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.276 Vali Acc: 0.904 Test Loss: 0.276 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 22 cost time: 0.5636234283447266
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.278 Vali Acc: 0.907 Test Loss: 0.278 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 23 cost time: 0.6224865913391113
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.281 Vali Acc: 0.911 Test Loss: 0.281 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.6079750061035156
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.282 Vali Acc: 0.907 Test Loss: 0.282 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.7554943561553955
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6911003589630127
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.283 Vali Acc: 0.896 Test Loss: 0.283 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6860513687133789
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.286 Vali Acc: 0.893 Test Loss: 0.286 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.7846279144287109
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.290 Vali Acc: 0.893 Test Loss: 0.290 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6817727088928223
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.294 Vali Acc: 0.893 Test Loss: 0.294 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6893062591552734
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.297 Vali Acc: 0.893 Test Loss: 0.297 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6075630187988281
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.5460093021392822
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.611236572265625
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 1788966
model size : 16.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.135796308517456
Epoch: 1, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.696 Vali Acc: 0.304 Test Loss: 1.696 Test Acc: 0.304
Validation loss decreased (inf --> -0.303687).  Saving model ...
Epoch: 2 cost time: 0.525266170501709
Epoch: 2, Steps: 2 | Train Loss: 1.659 Vali Loss: 1.467 Vali Acc: 0.478 Test Loss: 1.467 Test Acc: 0.478
Validation loss decreased (-0.303687 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 0.5595443248748779
Epoch: 3, Steps: 2 | Train Loss: 1.294 Vali Loss: 1.183 Vali Acc: 0.689 Test Loss: 1.183 Test Acc: 0.689
Validation loss decreased (-0.477763 --> -0.688877).  Saving model ...
Epoch: 4 cost time: 0.572709321975708
Epoch: 4, Steps: 2 | Train Loss: 1.035 Vali Loss: 0.816 Vali Acc: 0.856 Test Loss: 0.816 Test Acc: 0.856
Validation loss decreased (-0.688877 --> -0.855547).  Saving model ...
Epoch: 5 cost time: 0.5683231353759766
Epoch: 5, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.548 Vali Acc: 0.900 Test Loss: 0.548 Test Acc: 0.900
Validation loss decreased (-0.855547 --> -0.899995).  Saving model ...
Epoch: 6 cost time: 0.5807962417602539
Epoch: 6, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.384 Vali Acc: 0.933 Test Loss: 0.384 Test Acc: 0.933
Validation loss decreased (-0.899995 --> -0.933329).  Saving model ...
Epoch: 7 cost time: 0.5703356266021729
Epoch: 7, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.294 Vali Acc: 0.933 Test Loss: 0.294 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 8 cost time: 0.6217498779296875
Epoch: 8, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.6451783180236816
Epoch: 9, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937035).  Saving model ...
Epoch: 10 cost time: 0.5685436725616455
Epoch: 10, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 11 cost time: 0.5800974369049072
Epoch: 11, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5613880157470703
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6726930141448975
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.5911812782287598
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5677735805511475
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5353381633758545
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5557162761688232
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.6308321952819824
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6099889278411865
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6197152137756348
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1264678
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3502185344696045
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.699 Vali Acc: 0.337 Test Loss: 1.699 Test Acc: 0.337
Validation loss decreased (inf --> -0.337020).  Saving model ...
Epoch: 2 cost time: 0.578873872756958
Epoch: 2, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.471 Vali Acc: 0.456 Test Loss: 1.471 Test Acc: 0.456
Validation loss decreased (-0.337020 --> -0.455541).  Saving model ...
Epoch: 3 cost time: 0.4973781108856201
Epoch: 3, Steps: 2 | Train Loss: 1.293 Vali Loss: 1.188 Vali Acc: 0.715 Test Loss: 1.188 Test Acc: 0.715
Validation loss decreased (-0.455541 --> -0.714803).  Saving model ...
Epoch: 4 cost time: 0.5587506294250488
Epoch: 4, Steps: 2 | Train Loss: 1.048 Vali Loss: 0.822 Vali Acc: 0.863 Test Loss: 0.822 Test Acc: 0.863
Validation loss decreased (-0.714803 --> -0.862955).  Saving model ...
Epoch: 5 cost time: 0.655193567276001
Epoch: 5, Steps: 2 | Train Loss: 0.588 Vali Loss: 0.555 Vali Acc: 0.915 Test Loss: 0.555 Test Acc: 0.915
Validation loss decreased (-0.862955 --> -0.914809).  Saving model ...
Epoch: 6 cost time: 0.6554925441741943
Epoch: 6, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.391 Vali Acc: 0.933 Test Loss: 0.391 Test Acc: 0.933
Validation loss decreased (-0.914809 --> -0.933329).  Saving model ...
Epoch: 7 cost time: 0.6119544506072998
Epoch: 7, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6566877365112305
Epoch: 8, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.6451597213745117
Epoch: 9, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 0.59641432762146
Epoch: 10, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937035).  Saving model ...
Epoch: 11 cost time: 0.6337943077087402
Epoch: 11, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 12 cost time: 0.5979828834533691
Epoch: 12, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6506106853485107
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.602433443069458
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5747861862182617
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.5539505481719971
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7537782192230225
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.5861110687255859
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 0.5814805030822754
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 0.545177698135376
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 0.5768423080444336
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 1264678
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3496146202087402
Epoch: 1, Steps: 2 | Train Loss: 1.887 Vali Loss: 1.679 Vali Acc: 0.304 Test Loss: 1.679 Test Acc: 0.304
Validation loss decreased (inf --> -0.303687).  Saving model ...
Epoch: 2 cost time: 0.6375253200531006
Epoch: 2, Steps: 2 | Train Loss: 1.537 Vali Loss: 1.458 Vali Acc: 0.485 Test Loss: 1.458 Test Acc: 0.485
Validation loss decreased (-0.303687 --> -0.485171).  Saving model ...
Epoch: 3 cost time: 0.7387914657592773
Epoch: 3, Steps: 2 | Train Loss: 1.276 Vali Loss: 1.186 Vali Acc: 0.707 Test Loss: 1.186 Test Acc: 0.707
Validation loss decreased (-0.485171 --> -0.707396).  Saving model ...
Epoch: 4 cost time: 0.5700209140777588
Epoch: 4, Steps: 2 | Train Loss: 1.044 Vali Loss: 0.835 Vali Acc: 0.870 Test Loss: 0.835 Test Acc: 0.870
Validation loss decreased (-0.707396 --> -0.870362).  Saving model ...
Epoch: 5 cost time: 0.7451276779174805
Epoch: 5, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.580 Vali Acc: 0.900 Test Loss: 0.580 Test Acc: 0.900
Validation loss decreased (-0.870362 --> -0.899994).  Saving model ...
Epoch: 6 cost time: 0.6342868804931641
Epoch: 6, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.423 Vali Acc: 0.904 Test Loss: 0.423 Test Acc: 0.904
Validation loss decreased (-0.899994 --> -0.903699).  Saving model ...
Epoch: 7 cost time: 0.5758919715881348
Epoch: 7, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.336 Vali Acc: 0.911 Test Loss: 0.336 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911108).  Saving model ...
Epoch: 8 cost time: 0.5845460891723633
Epoch: 8, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.285 Vali Acc: 0.919 Test Loss: 0.285 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 9 cost time: 0.5901143550872803
Epoch: 9, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.254 Vali Acc: 0.922 Test Loss: 0.254 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 10 cost time: 0.6945505142211914
Epoch: 10, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 11 cost time: 0.5596790313720703
Epoch: 11, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 12 cost time: 0.616849422454834
Epoch: 12, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.6105923652648926
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6605212688446045
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6221847534179688
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.542248010635376
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6212635040283203
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.584658145904541
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5929582118988037
Epoch: 19, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.5385332107543945
Epoch: 20, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5578234195709229
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5785059928894043
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.655937910079956
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5981137752532959
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.6278162002563477
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5640263557434082
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5769376754760742
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.241 Vali Acc: 0.930 Test Loss: 0.241 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5369899272918701
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6105155944824219
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1264678
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5706191062927246
Epoch: 1, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.645 Vali Acc: 0.356 Test Loss: 1.645 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 0.5918660163879395
Epoch: 2, Steps: 2 | Train Loss: 1.566 Vali Loss: 1.439 Vali Acc: 0.552 Test Loss: 1.439 Test Acc: 0.552
Validation loss decreased (-0.355539 --> -0.551837).  Saving model ...
Epoch: 3 cost time: 0.6168696880340576
Epoch: 3, Steps: 2 | Train Loss: 1.351 Vali Loss: 1.190 Vali Acc: 0.748 Test Loss: 1.190 Test Acc: 0.748
Validation loss decreased (-0.551837 --> -0.748136).  Saving model ...
Epoch: 4 cost time: 0.6089718341827393
Epoch: 4, Steps: 2 | Train Loss: 1.072 Vali Loss: 0.872 Vali Acc: 0.837 Test Loss: 0.872 Test Acc: 0.837
Validation loss decreased (-0.748136 --> -0.837028).  Saving model ...
Epoch: 5 cost time: 0.5866107940673828
Epoch: 5, Steps: 2 | Train Loss: 0.679 Vali Loss: 0.643 Vali Acc: 0.844 Test Loss: 0.643 Test Acc: 0.844
Validation loss decreased (-0.837028 --> -0.844438).  Saving model ...
Epoch: 6 cost time: 0.5510132312774658
Epoch: 6, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.506 Vali Acc: 0.863 Test Loss: 0.506 Test Acc: 0.863
Validation loss decreased (-0.844438 --> -0.862958).  Saving model ...
Epoch: 7 cost time: 0.5900042057037354
Epoch: 7, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.431 Vali Acc: 0.859 Test Loss: 0.431 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6015124320983887
Epoch: 8, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866663).  Saving model ...
Epoch: 9 cost time: 0.5213167667388916
Epoch: 9, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.357 Vali Acc: 0.889 Test Loss: 0.357 Test Acc: 0.889
Validation loss decreased (-0.866663 --> -0.888885).  Saving model ...
Epoch: 10 cost time: 0.5103275775909424
Epoch: 10, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
Validation loss decreased (-0.888885 --> -0.888886).  Saving model ...
Epoch: 11 cost time: 0.554175615310669
Epoch: 11, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.320 Vali Acc: 0.893 Test Loss: 0.320 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892589).  Saving model ...
Epoch: 12 cost time: 0.5741968154907227
Epoch: 12, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.312 Vali Acc: 0.893 Test Loss: 0.312 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 13 cost time: 0.7373149394989014
Epoch: 13, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.311 Vali Acc: 0.893 Test Loss: 0.311 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 14 cost time: 0.5859692096710205
Epoch: 14, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
Validation loss decreased (-0.892589 --> -0.899997).  Saving model ...
Epoch: 15 cost time: 0.729975700378418
Epoch: 15, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.297 Vali Acc: 0.904 Test Loss: 0.297 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 16 cost time: 0.6416194438934326
Epoch: 16, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.298 Vali Acc: 0.904 Test Loss: 0.298 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6163144111633301
Epoch: 17, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.296 Vali Acc: 0.900 Test Loss: 0.296 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.586406946182251
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.676511287689209
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5873098373413086
Epoch: 20, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.6465210914611816
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.300 Vali Acc: 0.896 Test Loss: 0.300 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6721653938293457
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.302 Vali Acc: 0.896 Test Loss: 0.302 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6929643154144287
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.304 Vali Acc: 0.896 Test Loss: 0.304 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6739919185638428
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.305 Vali Acc: 0.896 Test Loss: 0.305 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.713625431060791
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.306 Vali Acc: 0.896 Test Loss: 0.306 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 1264678
model size : 14.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1482717990875244
Epoch: 1, Steps: 2 | Train Loss: 2.051 Vali Loss: 1.708 Vali Acc: 0.237 Test Loss: 1.708 Test Acc: 0.237
Validation loss decreased (inf --> -0.237020).  Saving model ...
Epoch: 2 cost time: 0.49685025215148926
Epoch: 2, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.499 Vali Acc: 0.430 Test Loss: 1.499 Test Acc: 0.430
Validation loss decreased (-0.237020 --> -0.429615).  Saving model ...
Epoch: 3 cost time: 0.5385806560516357
Epoch: 3, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.221 Vali Acc: 0.726 Test Loss: 1.221 Test Acc: 0.726
Validation loss decreased (-0.429615 --> -0.725914).  Saving model ...
Epoch: 4 cost time: 0.5435473918914795
Epoch: 4, Steps: 2 | Train Loss: 1.179 Vali Loss: 0.829 Vali Acc: 0.889 Test Loss: 0.829 Test Acc: 0.889
Validation loss decreased (-0.725914 --> -0.888881).  Saving model ...
Epoch: 5 cost time: 0.5808720588684082
Epoch: 5, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.536 Vali Acc: 0.926 Test Loss: 0.536 Test Acc: 0.926
Validation loss decreased (-0.888881 --> -0.925921).  Saving model ...
Epoch: 6 cost time: 0.7543587684631348
Epoch: 6, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.359 Vali Acc: 0.941 Test Loss: 0.359 Test Acc: 0.941
Validation loss decreased (-0.925921 --> -0.940737).  Saving model ...
Epoch: 7 cost time: 0.6152646541595459
Epoch: 7, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.259 Vali Acc: 0.963 Test Loss: 0.259 Test Acc: 0.963
Validation loss decreased (-0.940737 --> -0.962960).  Saving model ...
Epoch: 8 cost time: 0.6540346145629883
Epoch: 8, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.206 Vali Acc: 0.956 Test Loss: 0.206 Test Acc: 0.956
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5774619579315186
Epoch: 9, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.180 Vali Acc: 0.956 Test Loss: 0.180 Test Acc: 0.956
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 0.6561541557312012
Epoch: 10, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 0.6106970310211182
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.159 Vali Acc: 0.944 Test Loss: 0.159 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 0.5684001445770264
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.156 Vali Acc: 0.944 Test Loss: 0.156 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 0.5738663673400879
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.156 Vali Acc: 0.948 Test Loss: 0.156 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 0.5964102745056152
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.158 Vali Acc: 0.948 Test Loss: 0.158 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 0.5432183742523193
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.160 Vali Acc: 0.948 Test Loss: 0.160 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 0.5790603160858154
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.163 Vali Acc: 0.952 Test Loss: 0.163 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 0.565777063369751
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.167 Vali Acc: 0.952 Test Loss: 0.167 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9629629629629629
model parameter : 1002534
model size : 13.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2665457725524902
Epoch: 1, Steps: 2 | Train Loss: 1.994 Vali Loss: 1.708 Vali Acc: 0.248 Test Loss: 1.708 Test Acc: 0.248
Validation loss decreased (inf --> -0.248131).  Saving model ...
Epoch: 2 cost time: 0.5851328372955322
Epoch: 2, Steps: 2 | Train Loss: 1.737 Vali Loss: 1.500 Vali Acc: 0.433 Test Loss: 1.500 Test Acc: 0.433
Validation loss decreased (-0.248131 --> -0.433318).  Saving model ...
Epoch: 3 cost time: 0.5997452735900879
Epoch: 3, Steps: 2 | Train Loss: 1.541 Vali Loss: 1.222 Vali Acc: 0.700 Test Loss: 1.222 Test Acc: 0.700
Validation loss decreased (-0.433318 --> -0.699988).  Saving model ...
Epoch: 4 cost time: 0.5746490955352783
Epoch: 4, Steps: 2 | Train Loss: 1.152 Vali Loss: 0.834 Vali Acc: 0.870 Test Loss: 0.834 Test Acc: 0.870
Validation loss decreased (-0.699988 --> -0.870362).  Saving model ...
Epoch: 5 cost time: 0.6037077903747559
Epoch: 5, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.543 Vali Acc: 0.926 Test Loss: 0.543 Test Acc: 0.926
Validation loss decreased (-0.870362 --> -0.925920).  Saving model ...
Epoch: 6 cost time: 0.6694848537445068
Epoch: 6, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.367 Vali Acc: 0.933 Test Loss: 0.367 Test Acc: 0.933
Validation loss decreased (-0.925920 --> -0.933330).  Saving model ...
Epoch: 7 cost time: 0.6132025718688965
Epoch: 7, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.268 Vali Acc: 0.944 Test Loss: 0.268 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944442).  Saving model ...
Epoch: 8 cost time: 0.5759856700897217
Epoch: 8, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.215 Vali Acc: 0.952 Test Loss: 0.215 Test Acc: 0.952
Validation loss decreased (-0.944442 --> -0.951850).  Saving model ...
Epoch: 9 cost time: 0.6928689479827881
Epoch: 9, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.186 Vali Acc: 0.948 Test Loss: 0.186 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.8165123462677002
Epoch: 10, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.172 Vali Acc: 0.948 Test Loss: 0.172 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.652982234954834
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.165 Vali Acc: 0.944 Test Loss: 0.165 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5860738754272461
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.163 Vali Acc: 0.944 Test Loss: 0.163 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 0.6076028347015381
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.164 Vali Acc: 0.944 Test Loss: 0.164 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 0.6759603023529053
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.167 Vali Acc: 0.944 Test Loss: 0.167 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 0.7217767238616943
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.944 Test Loss: 0.170 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 0.5516316890716553
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.944 Test Loss: 0.173 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 0.6582672595977783
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 0.6456048488616943
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9518518518518518
model parameter : 1002534
model size : 13.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3487751483917236
Epoch: 1, Steps: 2 | Train Loss: 2.016 Vali Loss: 1.740 Vali Acc: 0.189 Test Loss: 1.740 Test Acc: 0.189
Validation loss decreased (inf --> -0.188871).  Saving model ...
Epoch: 2 cost time: 0.5718493461608887
Epoch: 2, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.537 Vali Acc: 0.378 Test Loss: 1.537 Test Acc: 0.378
Validation loss decreased (-0.188871 --> -0.377762).  Saving model ...
Epoch: 3 cost time: 0.6642351150512695
Epoch: 3, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.268 Vali Acc: 0.604 Test Loss: 1.268 Test Acc: 0.604
Validation loss decreased (-0.377762 --> -0.603691).  Saving model ...
Epoch: 4 cost time: 0.5389416217803955
Epoch: 4, Steps: 2 | Train Loss: 1.167 Vali Loss: 0.890 Vali Acc: 0.807 Test Loss: 0.890 Test Acc: 0.807
Validation loss decreased (-0.603691 --> -0.807399).  Saving model ...
Epoch: 5 cost time: 0.4947624206542969
Epoch: 5, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.605 Vali Acc: 0.863 Test Loss: 0.605 Test Acc: 0.863
Validation loss decreased (-0.807399 --> -0.862957).  Saving model ...
Epoch: 6 cost time: 0.6446249485015869
Epoch: 6, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.427 Vali Acc: 0.911 Test Loss: 0.427 Test Acc: 0.911
Validation loss decreased (-0.862957 --> -0.911107).  Saving model ...
Epoch: 7 cost time: 0.6027545928955078
Epoch: 7, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.323 Vali Acc: 0.904 Test Loss: 0.323 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.6273438930511475
Epoch: 8, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918516).  Saving model ...
Epoch: 9 cost time: 0.6381652355194092
Epoch: 9, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 10 cost time: 0.5824117660522461
Epoch: 10, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 11 cost time: 0.6226279735565186
Epoch: 11, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5993516445159912
Epoch: 12, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.6671090126037598
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6335248947143555
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.6078534126281738
Epoch: 15, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.662217378616333
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.5996196269989014
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.577890157699585
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.6548879146575928
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.6794493198394775
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 1002534
model size : 13.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1318047046661377
Epoch: 1, Steps: 2 | Train Loss: 1.940 Vali Loss: 1.677 Vali Acc: 0.322 Test Loss: 1.677 Test Acc: 0.322
Validation loss decreased (inf --> -0.322205).  Saving model ...
Epoch: 2 cost time: 0.6052963733673096
Epoch: 2, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.494 Vali Acc: 0.500 Test Loss: 1.494 Test Acc: 0.500
Validation loss decreased (-0.322205 --> -0.499985).  Saving model ...
Epoch: 3 cost time: 0.5312213897705078
Epoch: 3, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.254 Vali Acc: 0.689 Test Loss: 1.254 Test Acc: 0.689
Validation loss decreased (-0.499985 --> -0.688876).  Saving model ...
Epoch: 4 cost time: 0.5498552322387695
Epoch: 4, Steps: 2 | Train Loss: 1.209 Vali Loss: 0.918 Vali Acc: 0.811 Test Loss: 0.918 Test Acc: 0.811
Validation loss decreased (-0.688876 --> -0.811102).  Saving model ...
Epoch: 5 cost time: 0.6877646446228027
Epoch: 5, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.661 Vali Acc: 0.833 Test Loss: 0.661 Test Acc: 0.833
Validation loss decreased (-0.811102 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.6191856861114502
Epoch: 6, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 7 cost time: 0.633751392364502
Epoch: 7, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.411 Vali Acc: 0.867 Test Loss: 0.411 Test Acc: 0.867
Validation loss decreased (-0.844439 --> -0.866663).  Saving model ...
Epoch: 8 cost time: 0.6102390289306641
Epoch: 8, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.359 Vali Acc: 0.881 Test Loss: 0.359 Test Acc: 0.881
Validation loss decreased (-0.866663 --> -0.881478).  Saving model ...
Epoch: 9 cost time: 0.6632611751556396
Epoch: 9, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.881478 --> -0.888886).  Saving model ...
Epoch: 10 cost time: 0.5831308364868164
Epoch: 10, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.302 Vali Acc: 0.900 Test Loss: 0.302 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 11 cost time: 0.6630966663360596
Epoch: 11, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 12 cost time: 0.6280272006988525
Epoch: 12, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.276 Vali Acc: 0.904 Test Loss: 0.276 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 13 cost time: 0.6206493377685547
Epoch: 13, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.270 Vali Acc: 0.900 Test Loss: 0.270 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.583345890045166
Epoch: 14, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.266 Vali Acc: 0.904 Test Loss: 0.266 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 15 cost time: 0.6109268665313721
Epoch: 15, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.266 Vali Acc: 0.907 Test Loss: 0.266 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 16 cost time: 0.6145720481872559
Epoch: 16, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.904 Test Loss: 0.265 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6006395816802979
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.265 Vali Acc: 0.904 Test Loss: 0.265 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.6335554122924805
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.267 Vali Acc: 0.900 Test Loss: 0.267 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5520079135894775
Epoch: 19, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.269 Vali Acc: 0.900 Test Loss: 0.269 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6249880790710449
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.271 Vali Acc: 0.896 Test Loss: 0.271 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.635270357131958
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.274 Vali Acc: 0.893 Test Loss: 0.274 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6093697547912598
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.277 Vali Acc: 0.893 Test Loss: 0.277 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5985701084136963
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6168863773345947
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.279 Vali Acc: 0.904 Test Loss: 0.279 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5855667591094971
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.280 Vali Acc: 0.904 Test Loss: 0.280 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 1002534
model size : 13.60MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.541571855545044
Epoch: 1, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.701 Vali Acc: 0.293 Test Loss: 1.701 Test Acc: 0.293
Validation loss decreased (inf --> -0.292576).  Saving model ...
Epoch: 2 cost time: 0.6892380714416504
Epoch: 2, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.480 Vali Acc: 0.437 Test Loss: 1.480 Test Acc: 0.437
Validation loss decreased (-0.292576 --> -0.437022).  Saving model ...
Epoch: 3 cost time: 0.6093704700469971
Epoch: 3, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.203 Vali Acc: 0.696 Test Loss: 1.203 Test Acc: 0.696
Validation loss decreased (-0.437022 --> -0.696284).  Saving model ...
Epoch: 4 cost time: 0.5920186042785645
Epoch: 4, Steps: 2 | Train Loss: 1.043 Vali Loss: 0.849 Vali Acc: 0.811 Test Loss: 0.849 Test Acc: 0.811
Validation loss decreased (-0.696284 --> -0.811103).  Saving model ...
Epoch: 5 cost time: 0.6224691867828369
Epoch: 5, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.578 Vali Acc: 0.863 Test Loss: 0.578 Test Acc: 0.863
Validation loss decreased (-0.811103 --> -0.862957).  Saving model ...
Epoch: 6 cost time: 0.6328918933868408
Epoch: 6, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.414 Vali Acc: 0.889 Test Loss: 0.414 Test Acc: 0.889
Validation loss decreased (-0.862957 --> -0.888885).  Saving model ...
Epoch: 7 cost time: 0.603945255279541
Epoch: 7, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.314 Vali Acc: 0.900 Test Loss: 0.314 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 8 cost time: 0.5747554302215576
Epoch: 8, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.255 Vali Acc: 0.915 Test Loss: 0.255 Test Acc: 0.915
Validation loss decreased (-0.899997 --> -0.914812).  Saving model ...
Epoch: 9 cost time: 0.5637311935424805
Epoch: 9, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 10 cost time: 0.5105609893798828
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929628).  Saving model ...
Epoch: 11 cost time: 0.6187024116516113
Epoch: 11, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5834653377532959
Epoch: 12, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.194 Vali Acc: 0.926 Test Loss: 0.194 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.5835709571838379
Epoch: 13, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.926 Test Loss: 0.195 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 0.6226558685302734
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.926 Test Loss: 0.197 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 0.5181639194488525
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 0.5627140998840332
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 0.49372172355651855
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 0.5621883869171143
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 0.5704469680786133
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 0.542762279510498
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 871462
model size : 13.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.349778175354004
Epoch: 1, Steps: 2 | Train Loss: 1.934 Vali Loss: 1.696 Vali Acc: 0.281 Test Loss: 1.696 Test Acc: 0.281
Validation loss decreased (inf --> -0.281465).  Saving model ...
Epoch: 2 cost time: 0.6173617839813232
Epoch: 2, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.477 Vali Acc: 0.456 Test Loss: 1.477 Test Acc: 0.456
Validation loss decreased (-0.281465 --> -0.455541).  Saving model ...
Epoch: 3 cost time: 0.5788712501525879
Epoch: 3, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.205 Vali Acc: 0.667 Test Loss: 1.205 Test Acc: 0.667
Validation loss decreased (-0.455541 --> -0.666655).  Saving model ...
Epoch: 4 cost time: 0.5745992660522461
Epoch: 4, Steps: 2 | Train Loss: 1.083 Vali Loss: 0.856 Vali Acc: 0.800 Test Loss: 0.856 Test Acc: 0.800
Validation loss decreased (-0.666655 --> -0.799991).  Saving model ...
Epoch: 5 cost time: 0.6540842056274414
Epoch: 5, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.589 Vali Acc: 0.863 Test Loss: 0.589 Test Acc: 0.863
Validation loss decreased (-0.799991 --> -0.862957).  Saving model ...
Epoch: 6 cost time: 0.7272303104400635
Epoch: 6, Steps: 2 | Train Loss: 0.362 Vali Loss: 0.426 Vali Acc: 0.878 Test Loss: 0.426 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877774).  Saving model ...
Epoch: 7 cost time: 0.620091438293457
Epoch: 7, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.327 Vali Acc: 0.896 Test Loss: 0.327 Test Acc: 0.896
Validation loss decreased (-0.877774 --> -0.896293).  Saving model ...
Epoch: 8 cost time: 0.6614668369293213
Epoch: 8, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.267 Vali Acc: 0.907 Test Loss: 0.267 Test Acc: 0.907
Validation loss decreased (-0.896293 --> -0.907405).  Saving model ...
Epoch: 9 cost time: 0.6182475090026855
Epoch: 9, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.232 Vali Acc: 0.907 Test Loss: 0.232 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 10 cost time: 0.5521876811981201
Epoch: 10, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.214 Vali Acc: 0.911 Test Loss: 0.214 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 11 cost time: 0.6226789951324463
Epoch: 11, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.206 Vali Acc: 0.919 Test Loss: 0.206 Test Acc: 0.919
Validation loss decreased (-0.911109 --> -0.918516).  Saving model ...
Epoch: 12 cost time: 0.6186072826385498
Epoch: 12, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 13 cost time: 0.6027004718780518
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.922 Test Loss: 0.204 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.553286075592041
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6393389701843262
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.208 Vali Acc: 0.926 Test Loss: 0.208 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 16 cost time: 0.6028337478637695
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5528833866119385
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.597550630569458
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5722644329071045
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.6189649105072021
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.716829776763916
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.223 Vali Acc: 0.926 Test Loss: 0.223 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.62721848487854
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6947195529937744
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.6255767345428467
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6117198467254639
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6653633117675781
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6224255561828613
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.593127965927124
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6489758491516113
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6311938762664795
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6409950256347656
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6969344615936279
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.7699329853057861
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 871462
model size : 13.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.456505298614502
Epoch: 1, Steps: 2 | Train Loss: 1.866 Vali Loss: 1.640 Vali Acc: 0.348 Test Loss: 1.640 Test Acc: 0.348
Validation loss decreased (inf --> -0.348132).  Saving model ...
Epoch: 2 cost time: 0.5831568241119385
Epoch: 2, Steps: 2 | Train Loss: 1.521 Vali Loss: 1.431 Vali Acc: 0.511 Test Loss: 1.431 Test Acc: 0.511
Validation loss decreased (-0.348132 --> -0.511097).  Saving model ...
Epoch: 3 cost time: 0.4986839294433594
Epoch: 3, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.175 Vali Acc: 0.681 Test Loss: 1.175 Test Acc: 0.681
Validation loss decreased (-0.511097 --> -0.681470).  Saving model ...
Epoch: 4 cost time: 0.6561489105224609
Epoch: 4, Steps: 2 | Train Loss: 1.042 Vali Loss: 0.853 Vali Acc: 0.789 Test Loss: 0.853 Test Acc: 0.789
Validation loss decreased (-0.681470 --> -0.788880).  Saving model ...
Epoch: 5 cost time: 0.6052505970001221
Epoch: 5, Steps: 2 | Train Loss: 0.677 Vali Loss: 0.606 Vali Acc: 0.844 Test Loss: 0.606 Test Acc: 0.844
Validation loss decreased (-0.788880 --> -0.844438).  Saving model ...
Epoch: 6 cost time: 0.8011307716369629
Epoch: 6, Steps: 2 | Train Loss: 0.398 Vali Loss: 0.453 Vali Acc: 0.856 Test Loss: 0.453 Test Acc: 0.856
Validation loss decreased (-0.844438 --> -0.855551).  Saving model ...
Epoch: 7 cost time: 0.6548416614532471
Epoch: 7, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.357 Vali Acc: 0.878 Test Loss: 0.357 Test Acc: 0.878
Validation loss decreased (-0.855551 --> -0.877774).  Saving model ...
Epoch: 8 cost time: 0.6596643924713135
Epoch: 8, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.877774 --> -0.899997).  Saving model ...
Epoch: 9 cost time: 0.6713442802429199
Epoch: 9, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.262 Vali Acc: 0.907 Test Loss: 0.262 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907405).  Saving model ...
Epoch: 10 cost time: 0.6793608665466309
Epoch: 10, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
Validation loss decreased (-0.907405 --> -0.914812).  Saving model ...
Epoch: 11 cost time: 0.7032930850982666
Epoch: 11, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 12 cost time: 0.622161865234375
Epoch: 12, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.919 Test Loss: 0.227 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 0.6934623718261719
Epoch: 13, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.63570237159729
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.6624724864959717
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.231 Vali Acc: 0.919 Test Loss: 0.231 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.6250970363616943
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.6467158794403076
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5936279296875
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.238 Vali Acc: 0.915 Test Loss: 0.238 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.665665864944458
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.240 Vali Acc: 0.915 Test Loss: 0.240 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6422293186187744
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.7025463581085205
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.6090469360351562
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.6431353092193604
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.606778621673584
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.5806772708892822
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6303513050079346
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6448423862457275
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.926 Test Loss: 0.251 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6504294872283936
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.613074779510498
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.6556644439697266
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.6017515659332275
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.6316752433776855
Epoch: 32, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.6485180854797363
Epoch: 33, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.6441512107849121
Epoch: 34, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.5886924266815186
Epoch: 35, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.5973730087280273
Epoch: 36, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.7690701484680176
Epoch: 37, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.6568527221679688
Epoch: 38, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 871462
model size : 13.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.066514253616333
Epoch: 1, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.612 Vali Acc: 0.419 Test Loss: 1.612 Test Acc: 0.419
Validation loss decreased (inf --> -0.418502).  Saving model ...
Epoch: 2 cost time: 0.508624792098999
Epoch: 2, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.420 Vali Acc: 0.552 Test Loss: 1.420 Test Acc: 0.552
Validation loss decreased (-0.418502 --> -0.551838).  Saving model ...
Epoch: 3 cost time: 0.5444576740264893
Epoch: 3, Steps: 2 | Train Loss: 1.437 Vali Loss: 1.190 Vali Acc: 0.663 Test Loss: 1.190 Test Acc: 0.663
Validation loss decreased (-0.551838 --> -0.662951).  Saving model ...
Epoch: 4 cost time: 0.5402224063873291
Epoch: 4, Steps: 2 | Train Loss: 1.104 Vali Loss: 0.901 Vali Acc: 0.733 Test Loss: 0.901 Test Acc: 0.733
Validation loss decreased (-0.662951 --> -0.733324).  Saving model ...
Epoch: 5 cost time: 0.5322115421295166
Epoch: 5, Steps: 2 | Train Loss: 0.739 Vali Loss: 0.674 Vali Acc: 0.793 Test Loss: 0.674 Test Acc: 0.793
Validation loss decreased (-0.733324 --> -0.792586).  Saving model ...
Epoch: 6 cost time: 0.5493273735046387
Epoch: 6, Steps: 2 | Train Loss: 0.504 Vali Loss: 0.533 Vali Acc: 0.811 Test Loss: 0.533 Test Acc: 0.811
Validation loss decreased (-0.792586 --> -0.811106).  Saving model ...
Epoch: 7 cost time: 0.5973398685455322
Epoch: 7, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.443 Vali Acc: 0.859 Test Loss: 0.443 Test Acc: 0.859
Validation loss decreased (-0.811106 --> -0.859255).  Saving model ...
Epoch: 8 cost time: 0.5329513549804688
Epoch: 8, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.387 Vali Acc: 0.867 Test Loss: 0.387 Test Acc: 0.867
Validation loss decreased (-0.859255 --> -0.866663).  Saving model ...
Epoch: 9 cost time: 0.5391213893890381
Epoch: 9, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.352 Vali Acc: 0.885 Test Loss: 0.352 Test Acc: 0.885
Validation loss decreased (-0.866663 --> -0.885182).  Saving model ...
Epoch: 10 cost time: 0.6092681884765625
Epoch: 10, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.334 Vali Acc: 0.863 Test Loss: 0.334 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5613150596618652
Epoch: 11, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
Validation loss decreased (-0.885182 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.5874359607696533
Epoch: 12, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.300 Vali Acc: 0.893 Test Loss: 0.300 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.6228563785552979
Epoch: 13, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.896 Test Loss: 0.291 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5906054973602295
Epoch: 14, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.288 Vali Acc: 0.907 Test Loss: 0.288 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.6071517467498779
Epoch: 15, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.307 Vali Acc: 0.878 Test Loss: 0.307 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.6361236572265625
Epoch: 16, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.301 Vali Acc: 0.896 Test Loss: 0.301 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 0.7226994037628174
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.284 Vali Acc: 0.907 Test Loss: 0.284 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 0.6186585426330566
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.911 Test Loss: 0.285 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.6069741249084473
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.6195335388183594
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.6660349369049072
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 0.6107296943664551
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5406792163848877
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5467221736907959
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5511267185211182
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.303 Vali Acc: 0.907 Test Loss: 0.303 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5453834533691406
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.5413165092468262
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.304 Vali Acc: 0.911 Test Loss: 0.304 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6731986999511719
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.301 Vali Acc: 0.907 Test Loss: 0.301 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5504059791564941
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.299 Vali Acc: 0.907 Test Loss: 0.299 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5669245719909668
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.904 Test Loss: 0.298 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.512901782989502
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 871462
model size : 13.10MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3940012454986572
Epoch: 1, Steps: 2 | Train Loss: 1.999 Vali Loss: 1.868 Vali Acc: 0.133 Test Loss: 1.868 Test Acc: 0.133
Validation loss decreased (inf --> -0.133315).  Saving model ...
Epoch: 2 cost time: 0.5749852657318115
Epoch: 2, Steps: 2 | Train Loss: 1.831 Vali Loss: 1.631 Vali Acc: 0.289 Test Loss: 1.631 Test Acc: 0.289
Validation loss decreased (-0.133315 --> -0.288873).  Saving model ...
Epoch: 3 cost time: 0.6500394344329834
Epoch: 3, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.321 Vali Acc: 0.600 Test Loss: 1.321 Test Acc: 0.600
Validation loss decreased (-0.288873 --> -0.599987).  Saving model ...
Epoch: 4 cost time: 0.6556258201599121
Epoch: 4, Steps: 2 | Train Loss: 1.074 Vali Loss: 0.919 Vali Acc: 0.767 Test Loss: 0.919 Test Acc: 0.767
Validation loss decreased (-0.599987 --> -0.766657).  Saving model ...
Epoch: 5 cost time: 0.6328432559967041
Epoch: 5, Steps: 2 | Train Loss: 0.675 Vali Loss: 0.610 Vali Acc: 0.881 Test Loss: 0.610 Test Acc: 0.881
Validation loss decreased (-0.766657 --> -0.881475).  Saving model ...
Epoch: 6 cost time: 0.5908098220825195
Epoch: 6, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.416 Vali Acc: 0.926 Test Loss: 0.416 Test Acc: 0.926
Validation loss decreased (-0.881475 --> -0.925922).  Saving model ...
Epoch: 7 cost time: 0.5956401824951172
Epoch: 7, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 8 cost time: 0.6161642074584961
Epoch: 8, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 9 cost time: 0.6394016742706299
Epoch: 9, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 0.6156089305877686
Epoch: 10, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 0.5864367485046387
Epoch: 11, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.176 Vali Acc: 0.926 Test Loss: 0.176 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 0.5980839729309082
Epoch: 12, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.929627 --> -0.940739).  Saving model ...
Epoch: 13 cost time: 0.5790438652038574
Epoch: 13, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5874769687652588
Epoch: 14, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5532369613647461
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5953793525695801
Epoch: 16, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5566296577453613
Epoch: 17, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5740644931793213
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 0.5073637962341309
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 0.6400856971740723
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 0.6390676498413086
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 0.5777957439422607
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 805926
model size : 12.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.5653419494628906
Epoch: 1, Steps: 2 | Train Loss: 2.023 Vali Loss: 1.848 Vali Acc: 0.148 Test Loss: 1.848 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.6912457942962646
Epoch: 2, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.612 Vali Acc: 0.289 Test Loss: 1.612 Test Acc: 0.289
Validation loss decreased (-0.148130 --> -0.288873).  Saving model ...
Epoch: 3 cost time: 0.5900022983551025
Epoch: 3, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.308 Vali Acc: 0.604 Test Loss: 1.308 Test Acc: 0.604
Validation loss decreased (-0.288873 --> -0.603691).  Saving model ...
Epoch: 4 cost time: 0.6130154132843018
Epoch: 4, Steps: 2 | Train Loss: 1.057 Vali Loss: 0.914 Vali Acc: 0.785 Test Loss: 0.914 Test Acc: 0.785
Validation loss decreased (-0.603691 --> -0.785176).  Saving model ...
Epoch: 5 cost time: 0.6596066951751709
Epoch: 5, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.614 Vali Acc: 0.856 Test Loss: 0.614 Test Acc: 0.856
Validation loss decreased (-0.785176 --> -0.855549).  Saving model ...
Epoch: 6 cost time: 0.6733074188232422
Epoch: 6, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.426 Vali Acc: 0.919 Test Loss: 0.426 Test Acc: 0.919
Validation loss decreased (-0.855549 --> -0.918514).  Saving model ...
Epoch: 7 cost time: 0.5854558944702148
Epoch: 7, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.312 Vali Acc: 0.926 Test Loss: 0.312 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925923).  Saving model ...
Epoch: 8 cost time: 0.6167335510253906
Epoch: 8, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.247 Vali Acc: 0.926 Test Loss: 0.247 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 9 cost time: 0.5209267139434814
Epoch: 9, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929628).  Saving model ...
Epoch: 10 cost time: 0.5771918296813965
Epoch: 10, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.193 Vali Acc: 0.922 Test Loss: 0.193 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5893118381500244
Epoch: 11, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.188 Vali Acc: 0.919 Test Loss: 0.188 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.6075425148010254
Epoch: 12, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 0.5543496608734131
Epoch: 13, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 14 cost time: 0.5678863525390625
Epoch: 14, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5999443531036377
Epoch: 15, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.186 Vali Acc: 0.930 Test Loss: 0.186 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.6191785335540771
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.5997862815856934
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5703606605529785
Epoch: 18, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5834686756134033
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.6160159111022949
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.6753816604614258
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.6522948741912842
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5880365371704102
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.6470611095428467
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.7222268581390381
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.6691558361053467
Epoch: 26, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.6334717273712158
Epoch: 27, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.6876747608184814
Epoch: 28, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.7144346237182617
Epoch: 29, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.7350108623504639
Epoch: 30, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.634892463684082
Epoch: 31, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 805926
model size : 12.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2856688499450684
Epoch: 1, Steps: 2 | Train Loss: 2.035 Vali Loss: 1.844 Vali Acc: 0.148 Test Loss: 1.844 Test Acc: 0.148
Validation loss decreased (inf --> -0.148130).  Saving model ...
Epoch: 2 cost time: 0.5814764499664307
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.613 Vali Acc: 0.344 Test Loss: 1.613 Test Acc: 0.344
Validation loss decreased (-0.148130 --> -0.344428).  Saving model ...
Epoch: 3 cost time: 0.641650915145874
Epoch: 3, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.316 Vali Acc: 0.637 Test Loss: 1.316 Test Acc: 0.637
Validation loss decreased (-0.344428 --> -0.637024).  Saving model ...
Epoch: 4 cost time: 0.6287765502929688
Epoch: 4, Steps: 2 | Train Loss: 1.091 Vali Loss: 0.936 Vali Acc: 0.767 Test Loss: 0.936 Test Acc: 0.767
Validation loss decreased (-0.637024 --> -0.766657).  Saving model ...
Epoch: 5 cost time: 0.6966898441314697
Epoch: 5, Steps: 2 | Train Loss: 0.735 Vali Loss: 0.644 Vali Acc: 0.833 Test Loss: 0.644 Test Acc: 0.833
Validation loss decreased (-0.766657 --> -0.833327).  Saving model ...
Epoch: 6 cost time: 0.6721415519714355
Epoch: 6, Steps: 2 | Train Loss: 0.439 Vali Loss: 0.460 Vali Acc: 0.874 Test Loss: 0.460 Test Acc: 0.874
Validation loss decreased (-0.833327 --> -0.874069).  Saving model ...
Epoch: 7 cost time: 0.6009831428527832
Epoch: 7, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.350 Vali Acc: 0.904 Test Loss: 0.350 Test Acc: 0.904
Validation loss decreased (-0.874069 --> -0.903700).  Saving model ...
Epoch: 8 cost time: 0.5768907070159912
Epoch: 8, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.284 Vali Acc: 0.907 Test Loss: 0.284 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907405).  Saving model ...
Epoch: 9 cost time: 0.6487057209014893
Epoch: 9, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 10 cost time: 0.6019048690795898
Epoch: 10, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.232 Vali Acc: 0.904 Test Loss: 0.232 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.5770599842071533
Epoch: 11, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.904 Test Loss: 0.227 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5894684791564941
Epoch: 12, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
Validation loss decreased (-0.907405 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 0.6414437294006348
Epoch: 13, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.918516 --> -0.929627).  Saving model ...
Epoch: 14 cost time: 0.6215927600860596
Epoch: 14, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.7460169792175293
Epoch: 15, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.6540155410766602
Epoch: 16, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.6415750980377197
Epoch: 17, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.625774621963501
Epoch: 18, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.6058752536773682
Epoch: 19, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5900070667266846
Epoch: 20, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.5790059566497803
Epoch: 21, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.6100990772247314
Epoch: 22, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.234 Vali Acc: 0.926 Test Loss: 0.234 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.6277511119842529
Epoch: 23, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.6092767715454102
Epoch: 24, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.6050031185150146
Epoch: 25, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 805926
model size : 12.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.273019790649414
Epoch: 1, Steps: 2 | Train Loss: 2.039 Vali Loss: 1.801 Vali Acc: 0.144 Test Loss: 1.801 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.5792603492736816
Epoch: 2, Steps: 2 | Train Loss: 1.815 Vali Loss: 1.584 Vali Acc: 0.463 Test Loss: 1.584 Test Acc: 0.463
Validation loss decreased (-0.144426 --> -0.462947).  Saving model ...
Epoch: 3 cost time: 0.5071020126342773
Epoch: 3, Steps: 2 | Train Loss: 1.546 Vali Loss: 1.310 Vali Acc: 0.656 Test Loss: 1.310 Test Acc: 0.656
Validation loss decreased (-0.462947 --> -0.655542).  Saving model ...
Epoch: 4 cost time: 0.5615015029907227
Epoch: 4, Steps: 2 | Train Loss: 1.184 Vali Loss: 0.958 Vali Acc: 0.752 Test Loss: 0.958 Test Acc: 0.752
Validation loss decreased (-0.655542 --> -0.751842).  Saving model ...
Epoch: 5 cost time: 0.5311119556427002
Epoch: 5, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.688 Vali Acc: 0.804 Test Loss: 0.688 Test Acc: 0.804
Validation loss decreased (-0.751842 --> -0.803697).  Saving model ...
Epoch: 6 cost time: 0.5463197231292725
Epoch: 6, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.521 Vali Acc: 0.870 Test Loss: 0.521 Test Acc: 0.870
Validation loss decreased (-0.803697 --> -0.870365).  Saving model ...
Epoch: 7 cost time: 0.5481843948364258
Epoch: 7, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.427 Vali Acc: 0.852 Test Loss: 0.427 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 0.5726327896118164
Epoch: 8, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.373 Vali Acc: 0.852 Test Loss: 0.373 Test Acc: 0.852
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 0.5824964046478271
Epoch: 9, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.338 Vali Acc: 0.878 Test Loss: 0.338 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877774).  Saving model ...
Epoch: 10 cost time: 0.5802257061004639
Epoch: 10, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.317 Vali Acc: 0.896 Test Loss: 0.317 Test Acc: 0.896
Validation loss decreased (-0.877774 --> -0.896293).  Saving model ...
Epoch: 11 cost time: 0.6324634552001953
Epoch: 11, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.306 Vali Acc: 0.881 Test Loss: 0.306 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5579049587249756
Epoch: 12, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 13 cost time: 0.5744478702545166
Epoch: 13, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.289 Vali Acc: 0.904 Test Loss: 0.289 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 14 cost time: 0.5790977478027344
Epoch: 14, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.289 Vali Acc: 0.885 Test Loss: 0.289 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5324296951293945
Epoch: 15, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.282 Vali Acc: 0.893 Test Loss: 0.282 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.5405580997467041
Epoch: 16, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5639851093292236
Epoch: 17, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 0.539879322052002
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 0.506800651550293
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 0.5576765537261963
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.284 Vali Acc: 0.896 Test Loss: 0.284 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 0.45734500885009766
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.285 Vali Acc: 0.893 Test Loss: 0.285 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 0.5059006214141846
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.286 Vali Acc: 0.893 Test Loss: 0.286 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 0.5668413639068604
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.287 Vali Acc: 0.896 Test Loss: 0.287 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 805926
model size : 12.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2587642669677734
Epoch: 1, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.735 Vali Acc: 0.315 Test Loss: 1.735 Test Acc: 0.315
Validation loss decreased (inf --> -0.314797).  Saving model ...
Epoch: 2 cost time: 0.5217838287353516
Epoch: 2, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.580 Vali Acc: 0.415 Test Loss: 1.580 Test Acc: 0.415
Validation loss decreased (-0.314797 --> -0.414799).  Saving model ...
Epoch: 3 cost time: 0.5432209968566895
Epoch: 3, Steps: 2 | Train Loss: 1.407 Vali Loss: 1.412 Vali Acc: 0.530 Test Loss: 1.412 Test Acc: 0.530
Validation loss decreased (-0.414799 --> -0.529616).  Saving model ...
Epoch: 4 cost time: 0.5509421825408936
Epoch: 4, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.181 Vali Acc: 0.644 Test Loss: 1.181 Test Acc: 0.644
Validation loss decreased (-0.529616 --> -0.644433).  Saving model ...
Epoch: 5 cost time: 0.5922517776489258
Epoch: 5, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.942 Vali Acc: 0.767 Test Loss: 0.942 Test Acc: 0.767
Validation loss decreased (-0.644433 --> -0.766657).  Saving model ...
Epoch: 6 cost time: 0.5590717792510986
Epoch: 6, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.738 Vali Acc: 0.852 Test Loss: 0.738 Test Acc: 0.852
Validation loss decreased (-0.766657 --> -0.851844).  Saving model ...
Epoch: 7 cost time: 0.551203727722168
Epoch: 7, Steps: 2 | Train Loss: 0.516 Vali Loss: 0.581 Vali Acc: 0.881 Test Loss: 0.581 Test Acc: 0.881
Validation loss decreased (-0.851844 --> -0.881476).  Saving model ...
Epoch: 8 cost time: 0.5583176612854004
Epoch: 8, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.465 Vali Acc: 0.896 Test Loss: 0.465 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896292).  Saving model ...
Epoch: 9 cost time: 0.4858517646789551
Epoch: 9, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.384 Vali Acc: 0.900 Test Loss: 0.384 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.49071192741394043
Epoch: 10, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
Validation loss decreased (-0.899996 --> -0.911108).  Saving model ...
Epoch: 11 cost time: 0.4405038356781006
Epoch: 11, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 12 cost time: 0.4561176300048828
Epoch: 12, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 13 cost time: 0.5432751178741455
Epoch: 13, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4662482738494873
Epoch: 14, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.922 Test Loss: 0.222 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 15 cost time: 0.4719386100769043
Epoch: 15, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 16 cost time: 0.43801093101501465
Epoch: 16, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 17 cost time: 0.45064210891723633
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.4903261661529541
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.922 Test Loss: 0.198 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 19 cost time: 0.4825773239135742
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.922 Test Loss: 0.197 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.4621315002441406
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 0.5425353050231934
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.6282174587249756
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5488200187683105
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.6222007274627686
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.929628 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.5092568397521973
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 26 cost time: 0.5392625331878662
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 27 cost time: 0.52915358543396
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 28 cost time: 0.5507833957672119
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.533562421798706
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.4814307689666748
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.49060893058776855
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.48380208015441895
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 0.49923181533813477
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 0.46199846267700195
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 0.44357824325561523
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 0.4356117248535156
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 0.44681239128112793
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1287718
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.320739507675171
Epoch: 1, Steps: 2 | Train Loss: 1.846 Vali Loss: 1.726 Vali Acc: 0.311 Test Loss: 1.726 Test Acc: 0.311
Validation loss decreased (inf --> -0.311094).  Saving model ...
Epoch: 2 cost time: 0.5419981479644775
Epoch: 2, Steps: 2 | Train Loss: 1.551 Vali Loss: 1.573 Vali Acc: 0.426 Test Loss: 1.573 Test Acc: 0.426
Validation loss decreased (-0.311094 --> -0.425910).  Saving model ...
Epoch: 3 cost time: 0.5421113967895508
Epoch: 3, Steps: 2 | Train Loss: 1.399 Vali Loss: 1.407 Vali Acc: 0.522 Test Loss: 1.407 Test Acc: 0.522
Validation loss decreased (-0.425910 --> -0.522208).  Saving model ...
Epoch: 4 cost time: 0.5673620700836182
Epoch: 4, Steps: 2 | Train Loss: 1.314 Vali Loss: 1.177 Vali Acc: 0.670 Test Loss: 1.177 Test Acc: 0.670
Validation loss decreased (-0.522208 --> -0.670359).  Saving model ...
Epoch: 5 cost time: 0.6196169853210449
Epoch: 5, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.942 Vali Acc: 0.796 Test Loss: 0.942 Test Acc: 0.796
Validation loss decreased (-0.670359 --> -0.796287).  Saving model ...
Epoch: 6 cost time: 0.6381974220275879
Epoch: 6, Steps: 2 | Train Loss: 0.694 Vali Loss: 0.740 Vali Acc: 0.863 Test Loss: 0.740 Test Acc: 0.863
Validation loss decreased (-0.796287 --> -0.862956).  Saving model ...
Epoch: 7 cost time: 0.6125895977020264
Epoch: 7, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.585 Vali Acc: 0.889 Test Loss: 0.585 Test Acc: 0.889
Validation loss decreased (-0.862956 --> -0.888883).  Saving model ...
Epoch: 8 cost time: 0.6011185646057129
Epoch: 8, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.470 Vali Acc: 0.893 Test Loss: 0.470 Test Acc: 0.893
Validation loss decreased (-0.888883 --> -0.892588).  Saving model ...
Epoch: 9 cost time: 0.5699260234832764
Epoch: 9, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.390 Vali Acc: 0.900 Test Loss: 0.390 Test Acc: 0.900
Validation loss decreased (-0.892588 --> -0.899996).  Saving model ...
Epoch: 10 cost time: 0.6478397846221924
Epoch: 10, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914812).  Saving model ...
Epoch: 11 cost time: 0.595501184463501
Epoch: 11, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.5758950710296631
Epoch: 12, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.258 Vali Acc: 0.919 Test Loss: 0.258 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 0.6348171234130859
Epoch: 13, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.241 Vali Acc: 0.915 Test Loss: 0.241 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.6049118041992188
Epoch: 14, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.229 Vali Acc: 0.911 Test Loss: 0.229 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5576131343841553
Epoch: 15, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.219 Vali Acc: 0.915 Test Loss: 0.219 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 0.5976676940917969
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.915 Test Loss: 0.211 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 0.5946207046508789
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.915 Test Loss: 0.206 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 0.5652174949645996
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.919 Test Loss: 0.204 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 19 cost time: 0.579613208770752
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 20 cost time: 0.5840451717376709
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 0.5853719711303711
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.561471700668335
Epoch: 22, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.5834715366363525
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.6010532379150391
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.5949242115020752
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.5925428867340088
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.5640294551849365
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.5845129489898682
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.554966926574707
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.5267665386199951
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.5504693984985352
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.5819237232208252
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.6208987236022949
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.6031014919281006
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5849916934967041
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.6546852588653564
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.577822208404541
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5599076747894287
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5024681091308594
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.4956812858581543
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.43544864654541016
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 1287718
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.178306818008423
Epoch: 1, Steps: 2 | Train Loss: 1.810 Vali Loss: 1.720 Vali Acc: 0.319 Test Loss: 1.720 Test Acc: 0.319
Validation loss decreased (inf --> -0.318501).  Saving model ...
Epoch: 2 cost time: 0.6192224025726318
Epoch: 2, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.570 Vali Acc: 0.448 Test Loss: 1.570 Test Acc: 0.448
Validation loss decreased (-0.318501 --> -0.448132).  Saving model ...
Epoch: 3 cost time: 0.6403295993804932
Epoch: 3, Steps: 2 | Train Loss: 1.429 Vali Loss: 1.406 Vali Acc: 0.567 Test Loss: 1.406 Test Acc: 0.567
Validation loss decreased (-0.448132 --> -0.566653).  Saving model ...
Epoch: 4 cost time: 0.6020839214324951
Epoch: 4, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.181 Vali Acc: 0.678 Test Loss: 1.181 Test Acc: 0.678
Validation loss decreased (-0.566653 --> -0.677766).  Saving model ...
Epoch: 5 cost time: 0.6148114204406738
Epoch: 5, Steps: 2 | Train Loss: 1.007 Vali Loss: 0.951 Vali Acc: 0.800 Test Loss: 0.951 Test Acc: 0.800
Validation loss decreased (-0.677766 --> -0.799990).  Saving model ...
Epoch: 6 cost time: 0.6246705055236816
Epoch: 6, Steps: 2 | Train Loss: 0.731 Vali Loss: 0.755 Vali Acc: 0.833 Test Loss: 0.755 Test Acc: 0.833
Validation loss decreased (-0.799990 --> -0.833326).  Saving model ...
Epoch: 7 cost time: 0.6103124618530273
Epoch: 7, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.606 Vali Acc: 0.863 Test Loss: 0.606 Test Acc: 0.863
Validation loss decreased (-0.833326 --> -0.862957).  Saving model ...
Epoch: 8 cost time: 0.642301082611084
Epoch: 8, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.495 Vali Acc: 0.878 Test Loss: 0.495 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877773).  Saving model ...
Epoch: 9 cost time: 0.5907173156738281
Epoch: 9, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.418 Vali Acc: 0.896 Test Loss: 0.418 Test Acc: 0.896
Validation loss decreased (-0.877773 --> -0.896292).  Saving model ...
Epoch: 10 cost time: 0.6625127792358398
Epoch: 10, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.358 Vali Acc: 0.896 Test Loss: 0.358 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896293).  Saving model ...
Epoch: 11 cost time: 0.6506917476654053
Epoch: 11, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.316 Vali Acc: 0.904 Test Loss: 0.316 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903701).  Saving model ...
Epoch: 12 cost time: 0.5762414932250977
Epoch: 12, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.287 Vali Acc: 0.907 Test Loss: 0.287 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 13 cost time: 0.5715556144714355
Epoch: 13, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.270 Vali Acc: 0.911 Test Loss: 0.270 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 14 cost time: 0.5624773502349854
Epoch: 14, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 15 cost time: 0.49312782287597656
Epoch: 15, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.241 Vali Acc: 0.915 Test Loss: 0.241 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.5572612285614014
Epoch: 16, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 0.5732734203338623
Epoch: 17, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5771157741546631
Epoch: 18, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4656074047088623
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.223 Vali Acc: 0.919 Test Loss: 0.223 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 20 cost time: 0.502718448638916
Epoch: 20, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 21 cost time: 0.6025478839874268
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 22 cost time: 0.5759267807006836
Epoch: 22, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 23 cost time: 0.5394585132598877
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 24 cost time: 0.5873415470123291
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.6381521224975586
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.6128764152526855
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6196887493133545
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5885334014892578
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.6406745910644531
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6284084320068359
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5743954181671143
Epoch: 31, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6276495456695557
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6296582221984863
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 1287718
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0353751182556152
Epoch: 1, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.731 Vali Acc: 0.289 Test Loss: 1.731 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.5018656253814697
Epoch: 2, Steps: 2 | Train Loss: 1.616 Vali Loss: 1.587 Vali Acc: 0.433 Test Loss: 1.587 Test Acc: 0.433
Validation loss decreased (-0.288872 --> -0.433317).  Saving model ...
Epoch: 3 cost time: 0.54020094871521
Epoch: 3, Steps: 2 | Train Loss: 1.511 Vali Loss: 1.433 Vali Acc: 0.515 Test Loss: 1.433 Test Acc: 0.515
Validation loss decreased (-0.433317 --> -0.514800).  Saving model ...
Epoch: 4 cost time: 0.49938392639160156
Epoch: 4, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.224 Vali Acc: 0.652 Test Loss: 1.224 Test Acc: 0.652
Validation loss decreased (-0.514800 --> -0.651840).  Saving model ...
Epoch: 5 cost time: 0.4725158214569092
Epoch: 5, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.009 Vali Acc: 0.719 Test Loss: 1.009 Test Acc: 0.719
Validation loss decreased (-0.651840 --> -0.718508).  Saving model ...
Epoch: 6 cost time: 0.5014500617980957
Epoch: 6, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.825 Vali Acc: 0.752 Test Loss: 0.825 Test Acc: 0.752
Validation loss decreased (-0.718508 --> -0.751844).  Saving model ...
Epoch: 7 cost time: 0.5306055545806885
Epoch: 7, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.684 Vali Acc: 0.789 Test Loss: 0.684 Test Acc: 0.789
Validation loss decreased (-0.751844 --> -0.788882).  Saving model ...
Epoch: 8 cost time: 0.589153528213501
Epoch: 8, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.578 Vali Acc: 0.811 Test Loss: 0.578 Test Acc: 0.811
Validation loss decreased (-0.788882 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 0.5615689754486084
Epoch: 9, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.503 Vali Acc: 0.833 Test Loss: 0.503 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.5655555725097656
Epoch: 10, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.445 Vali Acc: 0.874 Test Loss: 0.445 Test Acc: 0.874
Validation loss decreased (-0.833328 --> -0.874070).  Saving model ...
Epoch: 11 cost time: 0.5839366912841797
Epoch: 11, Steps: 2 | Train Loss: 0.229 Vali Loss: 0.404 Vali Acc: 0.893 Test Loss: 0.404 Test Acc: 0.893
Validation loss decreased (-0.874070 --> -0.892589).  Saving model ...
Epoch: 12 cost time: 0.5597021579742432
Epoch: 12, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.376 Vali Acc: 0.881 Test Loss: 0.376 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4838864803314209
Epoch: 13, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.361 Vali Acc: 0.856 Test Loss: 0.361 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.536609411239624
Epoch: 14, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.343 Vali Acc: 0.867 Test Loss: 0.343 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.47788023948669434
Epoch: 15, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
Validation loss decreased (-0.892589 --> -0.907404).  Saving model ...
Epoch: 16 cost time: 0.5380020141601562
Epoch: 16, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.307 Vali Acc: 0.904 Test Loss: 0.307 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5669119358062744
Epoch: 17, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.297 Vali Acc: 0.907 Test Loss: 0.297 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 18 cost time: 0.5058925151824951
Epoch: 18, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.289 Vali Acc: 0.911 Test Loss: 0.289 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.5194571018218994
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.283 Vali Acc: 0.911 Test Loss: 0.283 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 0.5011842250823975
Epoch: 20, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.6198539733886719
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.5668156147003174
Epoch: 22, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.272 Vali Acc: 0.907 Test Loss: 0.272 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.46933436393737793
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.5620810985565186
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5327868461608887
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.269 Vali Acc: 0.907 Test Loss: 0.269 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5753540992736816
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.269 Vali Acc: 0.907 Test Loss: 0.269 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.611732006072998
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.6164085865020752
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5454416275024414
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.271 Vali Acc: 0.907 Test Loss: 0.271 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.6194298267364502
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.271 Vali Acc: 0.907 Test Loss: 0.271 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6791627407073975
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.272 Vali Acc: 0.907 Test Loss: 0.272 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6370315551757812
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.272 Vali Acc: 0.904 Test Loss: 0.272 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.6235930919647217
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.274 Vali Acc: 0.904 Test Loss: 0.274 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 1287718
model size : 9.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3923256397247314
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.700 Vali Acc: 0.163 Test Loss: 1.700 Test Acc: 0.163
Validation loss decreased (inf --> -0.162946).  Saving model ...
Epoch: 2 cost time: 0.4612104892730713
Epoch: 2, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.534 Vali Acc: 0.400 Test Loss: 1.534 Test Acc: 0.400
Validation loss decreased (-0.162946 --> -0.399985).  Saving model ...
Epoch: 3 cost time: 0.5468597412109375
Epoch: 3, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.365 Vali Acc: 0.630 Test Loss: 1.365 Test Acc: 0.630
Validation loss decreased (-0.399985 --> -0.629616).  Saving model ...
Epoch: 4 cost time: 0.5682339668273926
Epoch: 4, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.130 Vali Acc: 0.744 Test Loss: 1.130 Test Acc: 0.744
Validation loss decreased (-0.629616 --> -0.744433).  Saving model ...
Epoch: 5 cost time: 0.45586705207824707
Epoch: 5, Steps: 2 | Train Loss: 0.966 Vali Loss: 0.893 Vali Acc: 0.819 Test Loss: 0.893 Test Acc: 0.819
Validation loss decreased (-0.744433 --> -0.818510).  Saving model ...
Epoch: 6 cost time: 0.49241161346435547
Epoch: 6, Steps: 2 | Train Loss: 0.691 Vali Loss: 0.687 Vali Acc: 0.878 Test Loss: 0.687 Test Acc: 0.878
Validation loss decreased (-0.818510 --> -0.877771).  Saving model ...
Epoch: 7 cost time: 0.5000154972076416
Epoch: 7, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.529 Vali Acc: 0.893 Test Loss: 0.529 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892587).  Saving model ...
Epoch: 8 cost time: 0.5400960445404053
Epoch: 8, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.417 Vali Acc: 0.907 Test Loss: 0.417 Test Acc: 0.907
Validation loss decreased (-0.892587 --> -0.907403).  Saving model ...
Epoch: 9 cost time: 0.5281696319580078
Epoch: 9, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.336 Vali Acc: 0.919 Test Loss: 0.336 Test Acc: 0.919
Validation loss decreased (-0.907403 --> -0.918515).  Saving model ...
Epoch: 10 cost time: 0.5418190956115723
Epoch: 10, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.283 Vali Acc: 0.922 Test Loss: 0.283 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 11 cost time: 0.6205482482910156
Epoch: 11, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 12 cost time: 0.5710601806640625
Epoch: 12, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 13 cost time: 0.5534777641296387
Epoch: 13, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.208 Vali Acc: 0.919 Test Loss: 0.208 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5202457904815674
Epoch: 14, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.196 Vali Acc: 0.926 Test Loss: 0.196 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 15 cost time: 0.5667095184326172
Epoch: 15, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.930 Test Loss: 0.189 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 16 cost time: 0.6030979156494141
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933332).  Saving model ...
Epoch: 17 cost time: 0.5353496074676514
Epoch: 17, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.6174113750457764
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.49236536026000977
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.4266674518585205
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5875542163848877
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5396089553833008
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.549034833908081
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.6052689552307129
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5871381759643555
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.546349048614502
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.6545677185058594
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5519182682037354
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5459427833557129
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 763430
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.232747793197632
Epoch: 1, Steps: 2 | Train Loss: 1.875 Vali Loss: 1.693 Vali Acc: 0.193 Test Loss: 1.693 Test Acc: 0.193
Validation loss decreased (inf --> -0.192576).  Saving model ...
Epoch: 2 cost time: 0.5171170234680176
Epoch: 2, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.529 Vali Acc: 0.426 Test Loss: 1.529 Test Acc: 0.426
Validation loss decreased (-0.192576 --> -0.425911).  Saving model ...
Epoch: 3 cost time: 0.5197353363037109
Epoch: 3, Steps: 2 | Train Loss: 1.451 Vali Loss: 1.362 Vali Acc: 0.615 Test Loss: 1.362 Test Acc: 0.615
Validation loss decreased (-0.425911 --> -0.614801).  Saving model ...
Epoch: 4 cost time: 0.5858948230743408
Epoch: 4, Steps: 2 | Train Loss: 1.156 Vali Loss: 1.131 Vali Acc: 0.733 Test Loss: 1.131 Test Acc: 0.733
Validation loss decreased (-0.614801 --> -0.733322).  Saving model ...
Epoch: 5 cost time: 0.5200016498565674
Epoch: 5, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.897 Vali Acc: 0.837 Test Loss: 0.897 Test Acc: 0.837
Validation loss decreased (-0.733322 --> -0.837028).  Saving model ...
Epoch: 6 cost time: 0.6038894653320312
Epoch: 6, Steps: 2 | Train Loss: 0.693 Vali Loss: 0.693 Vali Acc: 0.878 Test Loss: 0.693 Test Acc: 0.878
Validation loss decreased (-0.837028 --> -0.877771).  Saving model ...
Epoch: 7 cost time: 0.5707323551177979
Epoch: 7, Steps: 2 | Train Loss: 0.461 Vali Loss: 0.536 Vali Acc: 0.900 Test Loss: 0.536 Test Acc: 0.900
Validation loss decreased (-0.877771 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.5213806629180908
Epoch: 8, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.423 Vali Acc: 0.911 Test Loss: 0.423 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911107).  Saving model ...
Epoch: 9 cost time: 0.5427577495574951
Epoch: 9, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.342 Vali Acc: 0.919 Test Loss: 0.342 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 10 cost time: 0.6116492748260498
Epoch: 10, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.287 Vali Acc: 0.919 Test Loss: 0.287 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 11 cost time: 0.6115930080413818
Epoch: 11, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.6142053604125977
Epoch: 12, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 13 cost time: 0.5461838245391846
Epoch: 13, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 14 cost time: 0.5554263591766357
Epoch: 14, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 15 cost time: 0.525867223739624
Epoch: 15, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 16 cost time: 0.47707128524780273
Epoch: 16, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5634772777557373
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.518702507019043
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.922 Test Loss: 0.182 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4207897186279297
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.49043774604797363
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.930 Test Loss: 0.183 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4911034107208252
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.5105769634246826
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.926 Test Loss: 0.183 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.5215094089508057
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.4594905376434326
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.919 Test Loss: 0.183 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.568906307220459
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.183 Vali Acc: 0.922 Test Loss: 0.183 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 763430
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1859147548675537
Epoch: 1, Steps: 2 | Train Loss: 1.868 Vali Loss: 1.693 Vali Acc: 0.237 Test Loss: 1.693 Test Acc: 0.237
Validation loss decreased (inf --> -0.237020).  Saving model ...
Epoch: 2 cost time: 0.5309677124023438
Epoch: 2, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.534 Vali Acc: 0.459 Test Loss: 1.534 Test Acc: 0.459
Validation loss decreased (-0.237020 --> -0.459244).  Saving model ...
Epoch: 3 cost time: 0.5570418834686279
Epoch: 3, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.372 Vali Acc: 0.581 Test Loss: 1.372 Test Acc: 0.581
Validation loss decreased (-0.459244 --> -0.581468).  Saving model ...
Epoch: 4 cost time: 0.5644130706787109
Epoch: 4, Steps: 2 | Train Loss: 1.173 Vali Loss: 1.148 Vali Acc: 0.700 Test Loss: 1.148 Test Acc: 0.700
Validation loss decreased (-0.581468 --> -0.699989).  Saving model ...
Epoch: 5 cost time: 0.5682299137115479
Epoch: 5, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.921 Vali Acc: 0.807 Test Loss: 0.921 Test Acc: 0.807
Validation loss decreased (-0.699989 --> -0.807398).  Saving model ...
Epoch: 6 cost time: 0.5882611274719238
Epoch: 6, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.724 Vali Acc: 0.863 Test Loss: 0.724 Test Acc: 0.863
Validation loss decreased (-0.807398 --> -0.862956).  Saving model ...
Epoch: 7 cost time: 0.5598905086517334
Epoch: 7, Steps: 2 | Train Loss: 0.509 Vali Loss: 0.572 Vali Acc: 0.896 Test Loss: 0.572 Test Acc: 0.896
Validation loss decreased (-0.862956 --> -0.896291).  Saving model ...
Epoch: 8 cost time: 0.5320003032684326
Epoch: 8, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.462 Vali Acc: 0.900 Test Loss: 0.462 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 0.5483295917510986
Epoch: 9, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.380 Vali Acc: 0.907 Test Loss: 0.380 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907404).  Saving model ...
Epoch: 10 cost time: 0.5654170513153076
Epoch: 10, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 11 cost time: 0.5649971961975098
Epoch: 11, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 12 cost time: 0.5021066665649414
Epoch: 12, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.262 Vali Acc: 0.915 Test Loss: 0.262 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 13 cost time: 0.5836644172668457
Epoch: 13, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 14 cost time: 0.5443825721740723
Epoch: 14, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 15 cost time: 0.5141828060150146
Epoch: 15, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.5101203918457031
Epoch: 16, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.5446619987487793
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.6245486736297607
Epoch: 18, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.6616547107696533
Epoch: 19, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.926 Test Loss: 0.209 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5620067119598389
Epoch: 20, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5733742713928223
Epoch: 21, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.556753396987915
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5903627872467041
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5317142009735107
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.5082058906555176
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.4825115203857422
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.206 Vali Acc: 0.926 Test Loss: 0.206 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.5845057964324951
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.6020922660827637
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 763430
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0715534687042236
Epoch: 1, Steps: 2 | Train Loss: 1.857 Vali Loss: 1.700 Vali Acc: 0.289 Test Loss: 1.700 Test Acc: 0.289
Validation loss decreased (inf --> -0.288872).  Saving model ...
Epoch: 2 cost time: 0.46322178840637207
Epoch: 2, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.554 Vali Acc: 0.441 Test Loss: 1.554 Test Acc: 0.441
Validation loss decreased (-0.288872 --> -0.440725).  Saving model ...
Epoch: 3 cost time: 0.4974489212036133
Epoch: 3, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.405 Vali Acc: 0.556 Test Loss: 1.405 Test Acc: 0.556
Validation loss decreased (-0.440725 --> -0.555542).  Saving model ...
Epoch: 4 cost time: 0.5153255462646484
Epoch: 4, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.197 Vali Acc: 0.689 Test Loss: 1.197 Test Acc: 0.689
Validation loss decreased (-0.555542 --> -0.688877).  Saving model ...
Epoch: 5 cost time: 0.5064346790313721
Epoch: 5, Steps: 2 | Train Loss: 1.050 Vali Loss: 0.987 Vali Acc: 0.774 Test Loss: 0.987 Test Acc: 0.774
Validation loss decreased (-0.688877 --> -0.774064).  Saving model ...
Epoch: 6 cost time: 0.48044395446777344
Epoch: 6, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.803 Vali Acc: 0.811 Test Loss: 0.803 Test Acc: 0.811
Validation loss decreased (-0.774064 --> -0.811103).  Saving model ...
Epoch: 7 cost time: 0.5854551792144775
Epoch: 7, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.660 Vali Acc: 0.830 Test Loss: 0.660 Test Acc: 0.830
Validation loss decreased (-0.811103 --> -0.829623).  Saving model ...
Epoch: 8 cost time: 0.4845395088195801
Epoch: 8, Steps: 2 | Train Loss: 0.496 Vali Loss: 0.556 Vali Acc: 0.833 Test Loss: 0.556 Test Acc: 0.833
Validation loss decreased (-0.829623 --> -0.833328).  Saving model ...
Epoch: 9 cost time: 0.45536255836486816
Epoch: 9, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.482 Vali Acc: 0.856 Test Loss: 0.482 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855551).  Saving model ...
Epoch: 10 cost time: 0.5652830600738525
Epoch: 10, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.431 Vali Acc: 0.874 Test Loss: 0.431 Test Acc: 0.874
Validation loss decreased (-0.855551 --> -0.874070).  Saving model ...
Epoch: 11 cost time: 0.5606753826141357
Epoch: 11, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 12 cost time: 0.5507855415344238
Epoch: 12, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.371 Vali Acc: 0.881 Test Loss: 0.371 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 13 cost time: 0.5065975189208984
Epoch: 13, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5627901554107666
Epoch: 14, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.332 Vali Acc: 0.881 Test Loss: 0.332 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 15 cost time: 0.5307912826538086
Epoch: 15, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.319 Vali Acc: 0.885 Test Loss: 0.319 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 16 cost time: 0.5711090564727783
Epoch: 16, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5288493633270264
Epoch: 17, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.304 Vali Acc: 0.896 Test Loss: 0.304 Test Acc: 0.896
Validation loss decreased (-0.888886 --> -0.896293).  Saving model ...
Epoch: 18 cost time: 0.540022611618042
Epoch: 18, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.297 Vali Acc: 0.904 Test Loss: 0.297 Test Acc: 0.904
Validation loss decreased (-0.896293 --> -0.903701).  Saving model ...
Epoch: 19 cost time: 0.5748500823974609
Epoch: 19, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5308287143707275
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.292 Vali Acc: 0.896 Test Loss: 0.292 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5220139026641846
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5511453151702881
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.284 Vali Acc: 0.896 Test Loss: 0.284 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5402717590332031
Epoch: 23, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.283 Vali Acc: 0.893 Test Loss: 0.283 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5305168628692627
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.893 Test Loss: 0.282 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.4889395236968994
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.282 Vali Acc: 0.896 Test Loss: 0.282 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.49944114685058594
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.282 Vali Acc: 0.896 Test Loss: 0.282 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4776613712310791
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.283 Vali Acc: 0.900 Test Loss: 0.283 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.45743298530578613
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.284 Vali Acc: 0.896 Test Loss: 0.284 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 763430
model size : 7.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1793673038482666
Epoch: 1, Steps: 2 | Train Loss: 2.407 Vali Loss: 2.065 Vali Acc: 0.059 Test Loss: 2.065 Test Acc: 0.059
Validation loss decreased (inf --> -0.059239).  Saving model ...
Epoch: 2 cost time: 0.5143873691558838
Epoch: 2, Steps: 2 | Train Loss: 2.020 Vali Loss: 1.881 Vali Acc: 0.119 Test Loss: 1.881 Test Acc: 0.119
Validation loss decreased (-0.059239 --> -0.118500).  Saving model ...
Epoch: 3 cost time: 0.5977127552032471
Epoch: 3, Steps: 2 | Train Loss: 1.833 Vali Loss: 1.681 Vali Acc: 0.300 Test Loss: 1.681 Test Acc: 0.300
Validation loss decreased (-0.118500 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.520747184753418
Epoch: 4, Steps: 2 | Train Loss: 1.564 Vali Loss: 1.402 Vali Acc: 0.619 Test Loss: 1.402 Test Acc: 0.619
Validation loss decreased (-0.299983 --> -0.618504).  Saving model ...
Epoch: 5 cost time: 0.5421533584594727
Epoch: 5, Steps: 2 | Train Loss: 1.176 Vali Loss: 1.110 Vali Acc: 0.770 Test Loss: 1.110 Test Acc: 0.770
Validation loss decreased (-0.618504 --> -0.770359).  Saving model ...
Epoch: 6 cost time: 0.5076768398284912
Epoch: 6, Steps: 2 | Train Loss: 0.910 Vali Loss: 0.849 Vali Acc: 0.826 Test Loss: 0.849 Test Acc: 0.826
Validation loss decreased (-0.770359 --> -0.825917).  Saving model ...
Epoch: 7 cost time: 0.4955775737762451
Epoch: 7, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.647 Vali Acc: 0.863 Test Loss: 0.647 Test Acc: 0.863
Validation loss decreased (-0.825917 --> -0.862956).  Saving model ...
Epoch: 8 cost time: 0.4635579586029053
Epoch: 8, Steps: 2 | Train Loss: 0.395 Vali Loss: 0.498 Vali Acc: 0.896 Test Loss: 0.498 Test Acc: 0.896
Validation loss decreased (-0.862956 --> -0.896291).  Saving model ...
Epoch: 9 cost time: 0.5020771026611328
Epoch: 9, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.391 Vali Acc: 0.919 Test Loss: 0.391 Test Acc: 0.919
Validation loss decreased (-0.896291 --> -0.918515).  Saving model ...
Epoch: 10 cost time: 0.496246337890625
Epoch: 10, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.319 Vali Acc: 0.926 Test Loss: 0.319 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 11 cost time: 0.5022547245025635
Epoch: 11, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.267 Vali Acc: 0.933 Test Loss: 0.267 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.5238966941833496
Epoch: 12, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.4683113098144531
Epoch: 13, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.46571969985961914
Epoch: 14, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.454500675201416
Epoch: 15, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.44406700134277344
Epoch: 16, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 17 cost time: 0.5414457321166992
Epoch: 17, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.933332 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.5072848796844482
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.517728328704834
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.49584126472473145
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.4763507843017578
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4725525379180908
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.170 Vali Acc: 0.941 Test Loss: 0.170 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.536409854888916
Epoch: 23, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.933 Test Loss: 0.170 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5077681541442871
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5161435604095459
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5654957294464111
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5227134227752686
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.4880092144012451
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.5073659420013428
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.5765326023101807
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.4962046146392822
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5316064357757568
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 501286
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.048187494277954
Epoch: 1, Steps: 2 | Train Loss: 2.381 Vali Loss: 2.056 Vali Acc: 0.041 Test Loss: 2.056 Test Acc: 0.041
Validation loss decreased (inf --> -0.040720).  Saving model ...
Epoch: 2 cost time: 0.5120432376861572
Epoch: 2, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.871 Vali Acc: 0.115 Test Loss: 1.871 Test Acc: 0.115
Validation loss decreased (-0.040720 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 0.5505006313323975
Epoch: 3, Steps: 2 | Train Loss: 1.838 Vali Loss: 1.672 Vali Acc: 0.278 Test Loss: 1.672 Test Acc: 0.278
Validation loss decreased (-0.114796 --> -0.277761).  Saving model ...
Epoch: 4 cost time: 0.49824953079223633
Epoch: 4, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.396 Vali Acc: 0.622 Test Loss: 1.396 Test Acc: 0.622
Validation loss decreased (-0.277761 --> -0.622208).  Saving model ...
Epoch: 5 cost time: 0.5117981433868408
Epoch: 5, Steps: 2 | Train Loss: 1.189 Vali Loss: 1.107 Vali Acc: 0.741 Test Loss: 1.107 Test Acc: 0.741
Validation loss decreased (-0.622208 --> -0.740730).  Saving model ...
Epoch: 6 cost time: 0.4924025535583496
Epoch: 6, Steps: 2 | Train Loss: 0.918 Vali Loss: 0.849 Vali Acc: 0.822 Test Loss: 0.849 Test Acc: 0.822
Validation loss decreased (-0.740730 --> -0.822214).  Saving model ...
Epoch: 7 cost time: 0.5552682876586914
Epoch: 7, Steps: 2 | Train Loss: 0.625 Vali Loss: 0.650 Vali Acc: 0.870 Test Loss: 0.650 Test Acc: 0.870
Validation loss decreased (-0.822214 --> -0.870364).  Saving model ...
Epoch: 8 cost time: 0.5845396518707275
Epoch: 8, Steps: 2 | Train Loss: 0.413 Vali Loss: 0.503 Vali Acc: 0.900 Test Loss: 0.503 Test Acc: 0.900
Validation loss decreased (-0.870364 --> -0.899995).  Saving model ...
Epoch: 9 cost time: 0.560593843460083
Epoch: 9, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.397 Vali Acc: 0.922 Test Loss: 0.397 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.922218).  Saving model ...
Epoch: 10 cost time: 0.6567988395690918
Epoch: 10, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.325 Vali Acc: 0.926 Test Loss: 0.325 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925923).  Saving model ...
Epoch: 11 cost time: 0.5155158042907715
Epoch: 11, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.274 Vali Acc: 0.937 Test Loss: 0.274 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937034).  Saving model ...
Epoch: 12 cost time: 0.49362778663635254
Epoch: 12, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4960594177246094
Epoch: 13, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5340003967285156
Epoch: 14, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 0.5667064189910889
Epoch: 15, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.186 Vali Acc: 0.933 Test Loss: 0.186 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 0.582982063293457
Epoch: 16, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.6286423206329346
Epoch: 17, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.6115639209747314
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.6067583560943604
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.61570143699646
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.6434471607208252
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.933 Test Loss: 0.172 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.547337532043457
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.930 Test Loss: 0.171 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5319943428039551
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.926 Test Loss: 0.171 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.492098331451416
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.171 Vali Acc: 0.930 Test Loss: 0.171 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.470811128616333
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5290720462799072
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.172 Vali Acc: 0.930 Test Loss: 0.172 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4757652282714844
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.926 Test Loss: 0.173 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.4950094223022461
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.173 Vali Acc: 0.930 Test Loss: 0.173 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.46715569496154785
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.926 Test Loss: 0.174 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 501286
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1210978031158447
Epoch: 1, Steps: 2 | Train Loss: 2.313 Vali Loss: 2.071 Vali Acc: 0.033 Test Loss: 2.071 Test Acc: 0.033
Validation loss decreased (inf --> -0.033313).  Saving model ...
Epoch: 2 cost time: 0.4871859550476074
Epoch: 2, Steps: 2 | Train Loss: 1.938 Vali Loss: 1.889 Vali Acc: 0.115 Test Loss: 1.889 Test Acc: 0.115
Validation loss decreased (-0.033313 --> -0.114796).  Saving model ...
Epoch: 3 cost time: 0.45383667945861816
Epoch: 3, Steps: 2 | Train Loss: 1.783 Vali Loss: 1.694 Vali Acc: 0.237 Test Loss: 1.694 Test Acc: 0.237
Validation loss decreased (-0.114796 --> -0.237020).  Saving model ...
Epoch: 4 cost time: 0.44971251487731934
Epoch: 4, Steps: 2 | Train Loss: 1.573 Vali Loss: 1.423 Vali Acc: 0.574 Test Loss: 1.423 Test Acc: 0.574
Validation loss decreased (-0.237020 --> -0.574060).  Saving model ...
Epoch: 5 cost time: 0.473388671875
Epoch: 5, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.139 Vali Acc: 0.726 Test Loss: 1.139 Test Acc: 0.726
Validation loss decreased (-0.574060 --> -0.725915).  Saving model ...
Epoch: 6 cost time: 0.40201616287231445
Epoch: 6, Steps: 2 | Train Loss: 0.915 Vali Loss: 0.883 Vali Acc: 0.793 Test Loss: 0.883 Test Acc: 0.793
Validation loss decreased (-0.725915 --> -0.792584).  Saving model ...
Epoch: 7 cost time: 0.4364299774169922
Epoch: 7, Steps: 2 | Train Loss: 0.654 Vali Loss: 0.686 Vali Acc: 0.852 Test Loss: 0.686 Test Acc: 0.852
Validation loss decreased (-0.792584 --> -0.851845).  Saving model ...
Epoch: 8 cost time: 0.4263467788696289
Epoch: 8, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.540 Vali Acc: 0.874 Test Loss: 0.540 Test Acc: 0.874
Validation loss decreased (-0.851845 --> -0.874069).  Saving model ...
Epoch: 9 cost time: 0.5046572685241699
Epoch: 9, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.434 Vali Acc: 0.893 Test Loss: 0.434 Test Acc: 0.893
Validation loss decreased (-0.874069 --> -0.892588).  Saving model ...
Epoch: 10 cost time: 0.4757399559020996
Epoch: 10, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.360 Vali Acc: 0.904 Test Loss: 0.360 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903700).  Saving model ...
Epoch: 11 cost time: 0.47712063789367676
Epoch: 11, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.311 Vali Acc: 0.919 Test Loss: 0.311 Test Acc: 0.919
Validation loss decreased (-0.903700 --> -0.918515).  Saving model ...
Epoch: 12 cost time: 0.5036141872406006
Epoch: 12, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.273 Vali Acc: 0.933 Test Loss: 0.273 Test Acc: 0.933
Validation loss decreased (-0.918515 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.48279881477355957
Epoch: 13, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 14 cost time: 0.474257230758667
Epoch: 14, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.5093767642974854
Epoch: 15, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5003931522369385
Epoch: 16, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 17 cost time: 0.48939061164855957
Epoch: 17, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.5051991939544678
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.45071840286254883
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4844777584075928
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.930 Test Loss: 0.188 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.47519993782043457
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.187 Vali Acc: 0.926 Test Loss: 0.187 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5005543231964111
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.188 Vali Acc: 0.926 Test Loss: 0.188 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.47203993797302246
Epoch: 23, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.190 Vali Acc: 0.930 Test Loss: 0.190 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.45468926429748535
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 0.3904993534088135
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 0.41685938835144043
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 0.4146456718444824
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 0.415325403213501
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.193 Vali Acc: 0.926 Test Loss: 0.193 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 501286
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1043994426727295
Epoch: 1, Steps: 2 | Train Loss: 2.254 Vali Loss: 2.028 Vali Acc: 0.048 Test Loss: 2.028 Test Acc: 0.048
Validation loss decreased (inf --> -0.048128).  Saving model ...
Epoch: 2 cost time: 0.515641450881958
Epoch: 2, Steps: 2 | Train Loss: 1.971 Vali Loss: 1.864 Vali Acc: 0.089 Test Loss: 1.864 Test Acc: 0.089
Validation loss decreased (-0.048128 --> -0.088870).  Saving model ...
Epoch: 3 cost time: 0.495882511138916
Epoch: 3, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.689 Vali Acc: 0.204 Test Loss: 1.689 Test Acc: 0.204
Validation loss decreased (-0.088870 --> -0.203687).  Saving model ...
Epoch: 4 cost time: 0.49711036682128906
Epoch: 4, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.447 Vali Acc: 0.507 Test Loss: 1.447 Test Acc: 0.507
Validation loss decreased (-0.203687 --> -0.507393).  Saving model ...
Epoch: 5 cost time: 0.4920320510864258
Epoch: 5, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.192 Vali Acc: 0.630 Test Loss: 1.192 Test Acc: 0.630
Validation loss decreased (-0.507393 --> -0.629618).  Saving model ...
Epoch: 6 cost time: 0.48341965675354004
Epoch: 6, Steps: 2 | Train Loss: 1.023 Vali Loss: 0.961 Vali Acc: 0.707 Test Loss: 0.961 Test Acc: 0.707
Validation loss decreased (-0.629618 --> -0.707398).  Saving model ...
Epoch: 7 cost time: 0.47014689445495605
Epoch: 7, Steps: 2 | Train Loss: 0.748 Vali Loss: 0.779 Vali Acc: 0.767 Test Loss: 0.779 Test Acc: 0.767
Validation loss decreased (-0.707398 --> -0.766659).  Saving model ...
Epoch: 8 cost time: 0.518923282623291
Epoch: 8, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.642 Vali Acc: 0.811 Test Loss: 0.642 Test Acc: 0.811
Validation loss decreased (-0.766659 --> -0.811105).  Saving model ...
Epoch: 9 cost time: 0.4903862476348877
Epoch: 9, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.542 Vali Acc: 0.833 Test Loss: 0.542 Test Acc: 0.833
Validation loss decreased (-0.811105 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.49871134757995605
Epoch: 10, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.474 Vali Acc: 0.830 Test Loss: 0.474 Test Acc: 0.830
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4886746406555176
Epoch: 11, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.431 Vali Acc: 0.826 Test Loss: 0.431 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 0.5383658409118652
Epoch: 12, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.392 Vali Acc: 0.841 Test Loss: 0.392 Test Acc: 0.841
Validation loss decreased (-0.833328 --> -0.840737).  Saving model ...
Epoch: 13 cost time: 0.5461373329162598
Epoch: 13, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.365 Vali Acc: 0.852 Test Loss: 0.365 Test Acc: 0.852
Validation loss decreased (-0.840737 --> -0.851848).  Saving model ...
Epoch: 14 cost time: 0.532820463180542
Epoch: 14, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.340 Vali Acc: 0.881 Test Loss: 0.340 Test Acc: 0.881
Validation loss decreased (-0.851848 --> -0.881478).  Saving model ...
Epoch: 15 cost time: 0.4636354446411133
Epoch: 15, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.322 Vali Acc: 0.893 Test Loss: 0.322 Test Acc: 0.893
Validation loss decreased (-0.881478 --> -0.892589).  Saving model ...
Epoch: 16 cost time: 0.4636359214782715
Epoch: 16, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.309 Vali Acc: 0.893 Test Loss: 0.309 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 17 cost time: 0.42316389083862305
Epoch: 17, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892590).  Saving model ...
Epoch: 18 cost time: 0.44674158096313477
Epoch: 18, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.293 Vali Acc: 0.893 Test Loss: 0.293 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 19 cost time: 0.4490840435028076
Epoch: 19, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.49235010147094727
Epoch: 20, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.293 Vali Acc: 0.878 Test Loss: 0.293 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.43145155906677246
Epoch: 21, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.287 Vali Acc: 0.881 Test Loss: 0.287 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.43583226203918457
Epoch: 22, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.284 Vali Acc: 0.881 Test Loss: 0.284 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.4388890266418457
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.45938611030578613
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.892590 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.48813843727111816
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4935567378997803
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.277 Vali Acc: 0.896 Test Loss: 0.277 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4940357208251953
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.587632417678833
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.896 Test Loss: 0.280 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.5131103992462158
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.281 Vali Acc: 0.896 Test Loss: 0.281 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.5237724781036377
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.283 Vali Acc: 0.893 Test Loss: 0.283 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5148873329162598
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.285 Vali Acc: 0.893 Test Loss: 0.285 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5353288650512695
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5039832592010498
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5649676322937012
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.287 Vali Acc: 0.900 Test Loss: 0.287 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 501286
model size : 6.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0575058460235596
Epoch: 1, Steps: 2 | Train Loss: 2.349 Vali Loss: 2.068 Vali Acc: 0.159 Test Loss: 2.068 Test Acc: 0.159
Validation loss decreased (inf --> -0.159239).  Saving model ...
Epoch: 2 cost time: 0.5577077865600586
Epoch: 2, Steps: 2 | Train Loss: 2.049 Vali Loss: 1.882 Vali Acc: 0.196 Test Loss: 1.882 Test Acc: 0.196
Validation loss decreased (-0.159239 --> -0.196277).  Saving model ...
Epoch: 3 cost time: 0.5495274066925049
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.678 Vali Acc: 0.289 Test Loss: 1.678 Test Acc: 0.289
Validation loss decreased (-0.196277 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.481231689453125
Epoch: 4, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.392 Vali Acc: 0.563 Test Loss: 1.392 Test Acc: 0.563
Validation loss decreased (-0.288872 --> -0.562949).  Saving model ...
Epoch: 5 cost time: 0.4644157886505127
Epoch: 5, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.097 Vali Acc: 0.767 Test Loss: 1.097 Test Acc: 0.767
Validation loss decreased (-0.562949 --> -0.766656).  Saving model ...
Epoch: 6 cost time: 0.5105743408203125
Epoch: 6, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.848 Vali Acc: 0.822 Test Loss: 0.848 Test Acc: 0.822
Validation loss decreased (-0.766656 --> -0.822214).  Saving model ...
Epoch: 7 cost time: 0.5131957530975342
Epoch: 7, Steps: 2 | Train Loss: 0.598 Vali Loss: 0.660 Vali Acc: 0.852 Test Loss: 0.660 Test Acc: 0.852
Validation loss decreased (-0.822214 --> -0.851845).  Saving model ...
Epoch: 8 cost time: 0.5128803253173828
Epoch: 8, Steps: 2 | Train Loss: 0.403 Vali Loss: 0.516 Vali Acc: 0.893 Test Loss: 0.516 Test Acc: 0.893
Validation loss decreased (-0.851845 --> -0.892587).  Saving model ...
Epoch: 9 cost time: 0.5445396900177002
Epoch: 9, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.412 Vali Acc: 0.896 Test Loss: 0.412 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896292).  Saving model ...
Epoch: 10 cost time: 0.551123857498169
Epoch: 10, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.340 Vali Acc: 0.889 Test Loss: 0.340 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.6199209690093994
Epoch: 11, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.284 Vali Acc: 0.904 Test Loss: 0.284 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903701).  Saving model ...
Epoch: 12 cost time: 0.526782751083374
Epoch: 12, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.903701 --> -0.911109).  Saving model ...
Epoch: 13 cost time: 0.5523829460144043
Epoch: 13, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.223 Vali Acc: 0.915 Test Loss: 0.223 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914813).  Saving model ...
Epoch: 14 cost time: 0.6384549140930176
Epoch: 14, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.207 Vali Acc: 0.926 Test Loss: 0.207 Test Acc: 0.926
Validation loss decreased (-0.914813 --> -0.925924).  Saving model ...
Epoch: 15 cost time: 0.5585944652557373
Epoch: 15, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.926 Test Loss: 0.197 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 16 cost time: 0.563748836517334
Epoch: 16, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.5666086673736572
Epoch: 17, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.5555210113525391
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.187 Vali Acc: 0.933 Test Loss: 0.187 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.5379152297973633
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.5393714904785156
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.534721851348877
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.182 Vali Acc: 0.930 Test Loss: 0.182 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5067167282104492
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.181 Vali Acc: 0.930 Test Loss: 0.181 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4837946891784668
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.47804903984069824
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.930 Test Loss: 0.180 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.4981060028076172
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5077311992645264
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5410394668579102
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 28 cost time: 0.5130598545074463
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4815340042114258
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.930 Test Loss: 0.179 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.516577959060669
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 31 cost time: 0.5552389621734619
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5857639312744141
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.6123909950256348
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.933 Test Loss: 0.179 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5000905990600586
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.5442872047424316
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4780619144439697
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5683369636535645
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.56351637840271
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.46359992027282715
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.45223188400268555
Epoch: 40, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4990835189819336
Epoch: 41, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4824066162109375
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5479493141174316
Epoch: 43, Steps: 2 | Train Loss: 0.000 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5752201080322266
Epoch: 44, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.180 Vali Acc: 0.937 Test Loss: 0.180 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 370214
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.026352882385254
Epoch: 1, Steps: 2 | Train Loss: 2.348 Vali Loss: 2.061 Vali Acc: 0.156 Test Loss: 2.061 Test Acc: 0.156
Validation loss decreased (inf --> -0.155535).  Saving model ...
Epoch: 2 cost time: 0.4444725513458252
Epoch: 2, Steps: 2 | Train Loss: 2.073 Vali Loss: 1.877 Vali Acc: 0.185 Test Loss: 1.877 Test Acc: 0.185
Validation loss decreased (-0.155535 --> -0.185166).  Saving model ...
Epoch: 3 cost time: 0.4610903263092041
Epoch: 3, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.675 Vali Acc: 0.289 Test Loss: 1.675 Test Acc: 0.289
Validation loss decreased (-0.185166 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.4453928470611572
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.392 Vali Acc: 0.581 Test Loss: 1.392 Test Acc: 0.581
Validation loss decreased (-0.288872 --> -0.581468).  Saving model ...
Epoch: 5 cost time: 0.4161698818206787
Epoch: 5, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.100 Vali Acc: 0.744 Test Loss: 1.100 Test Acc: 0.744
Validation loss decreased (-0.581468 --> -0.744433).  Saving model ...
Epoch: 6 cost time: 0.4315006732940674
Epoch: 6, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.853 Vali Acc: 0.811 Test Loss: 0.853 Test Acc: 0.811
Validation loss decreased (-0.744433 --> -0.811103).  Saving model ...
Epoch: 7 cost time: 0.5108907222747803
Epoch: 7, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.665 Vali Acc: 0.841 Test Loss: 0.665 Test Acc: 0.841
Validation loss decreased (-0.811103 --> -0.840734).  Saving model ...
Epoch: 8 cost time: 0.49423837661743164
Epoch: 8, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.521 Vali Acc: 0.874 Test Loss: 0.521 Test Acc: 0.874
Validation loss decreased (-0.840734 --> -0.874069).  Saving model ...
Epoch: 9 cost time: 0.4914562702178955
Epoch: 9, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.418 Vali Acc: 0.893 Test Loss: 0.418 Test Acc: 0.893
Validation loss decreased (-0.874069 --> -0.892588).  Saving model ...
Epoch: 10 cost time: 0.5338425636291504
Epoch: 10, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.346 Vali Acc: 0.896 Test Loss: 0.346 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896293).  Saving model ...
Epoch: 11 cost time: 0.547532320022583
Epoch: 11, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.896293 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.5276005268096924
Epoch: 12, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 0.5601115226745605
Epoch: 13, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 14 cost time: 0.5323636531829834
Epoch: 14, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5245108604431152
Epoch: 15, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 16 cost time: 0.5188593864440918
Epoch: 16, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.925924 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.49611592292785645
Epoch: 17, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.49489760398864746
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.45636773109436035
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 20 cost time: 0.4794280529022217
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.4630601406097412
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 22 cost time: 0.47341036796569824
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.185 Vali Acc: 0.937 Test Loss: 0.185 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.3973855972290039
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.40930986404418945
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.930 Test Loss: 0.184 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.4274921417236328
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.46448683738708496
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.184 Vali Acc: 0.926 Test Loss: 0.184 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.4787147045135498
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5023951530456543
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4937713146209717
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4210774898529053
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5634706020355225
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.5279395580291748
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.185 Vali Acc: 0.930 Test Loss: 0.185 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 370214
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2216947078704834
Epoch: 1, Steps: 2 | Train Loss: 2.265 Vali Loss: 2.038 Vali Acc: 0.137 Test Loss: 2.038 Test Acc: 0.137
Validation loss decreased (inf --> -0.137017).  Saving model ...
Epoch: 2 cost time: 0.5063533782958984
Epoch: 2, Steps: 2 | Train Loss: 2.047 Vali Loss: 1.860 Vali Acc: 0.159 Test Loss: 1.860 Test Acc: 0.159
Validation loss decreased (-0.137017 --> -0.159241).  Saving model ...
Epoch: 3 cost time: 0.5661389827728271
Epoch: 3, Steps: 2 | Train Loss: 1.816 Vali Loss: 1.665 Vali Acc: 0.267 Test Loss: 1.665 Test Acc: 0.267
Validation loss decreased (-0.159241 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 0.4752030372619629
Epoch: 4, Steps: 2 | Train Loss: 1.635 Vali Loss: 1.391 Vali Acc: 0.581 Test Loss: 1.391 Test Acc: 0.581
Validation loss decreased (-0.266650 --> -0.581468).  Saving model ...
Epoch: 5 cost time: 0.4946119785308838
Epoch: 5, Steps: 2 | Train Loss: 1.178 Vali Loss: 1.111 Vali Acc: 0.733 Test Loss: 1.111 Test Acc: 0.733
Validation loss decreased (-0.581468 --> -0.733322).  Saving model ...
Epoch: 6 cost time: 0.5209004878997803
Epoch: 6, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.874 Vali Acc: 0.785 Test Loss: 0.874 Test Acc: 0.785
Validation loss decreased (-0.733322 --> -0.785176).  Saving model ...
Epoch: 7 cost time: 0.5076467990875244
Epoch: 7, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.695 Vali Acc: 0.815 Test Loss: 0.695 Test Acc: 0.815
Validation loss decreased (-0.785176 --> -0.814808).  Saving model ...
Epoch: 8 cost time: 0.504302978515625
Epoch: 8, Steps: 2 | Train Loss: 0.474 Vali Loss: 0.557 Vali Acc: 0.859 Test Loss: 0.557 Test Acc: 0.859
Validation loss decreased (-0.814808 --> -0.859254).  Saving model ...
Epoch: 9 cost time: 0.439039945602417
Epoch: 9, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.459 Vali Acc: 0.881 Test Loss: 0.459 Test Acc: 0.881
Validation loss decreased (-0.859254 --> -0.881477).  Saving model ...
Epoch: 10 cost time: 0.4630148410797119
Epoch: 10, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.388 Vali Acc: 0.889 Test Loss: 0.388 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.4527747631072998
Epoch: 11, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.332 Vali Acc: 0.904 Test Loss: 0.332 Test Acc: 0.904
Validation loss decreased (-0.888885 --> -0.903700).  Saving model ...
Epoch: 12 cost time: 0.4573357105255127
Epoch: 12, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.296 Vali Acc: 0.907 Test Loss: 0.296 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 13 cost time: 0.4429936408996582
Epoch: 13, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.271 Vali Acc: 0.915 Test Loss: 0.271 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 14 cost time: 0.48013901710510254
Epoch: 14, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 15 cost time: 0.4604799747467041
Epoch: 15, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.45084428787231445
Epoch: 16, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.233 Vali Acc: 0.915 Test Loss: 0.233 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.46366214752197266
Epoch: 17, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5112671852111816
Epoch: 18, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5287296772003174
Epoch: 19, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.5179181098937988
Epoch: 20, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5499556064605713
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.214 Vali Acc: 0.919 Test Loss: 0.214 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49932384490966797
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.216 Vali Acc: 0.907 Test Loss: 0.216 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.47807884216308594
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.915 Test Loss: 0.218 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5016241073608398
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.219 Vali Acc: 0.915 Test Loss: 0.219 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5379705429077148
Epoch: 25, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.218 Vali Acc: 0.911 Test Loss: 0.218 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5330591201782227
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.215 Vali Acc: 0.915 Test Loss: 0.215 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.4873535633087158
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.213 Vali Acc: 0.915 Test Loss: 0.213 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5041866302490234
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.4973640441894531
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 30 cost time: 0.5193119049072266
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.5214059352874756
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.546623945236206
Epoch: 32, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5534012317657471
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 34 cost time: 0.4690825939178467
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.46881699562072754
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5392439365386963
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5291562080383301
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5429799556732178
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5213325023651123
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.48172640800476074
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.919 Test Loss: 0.212 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4982881546020508
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5328681468963623
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5481979846954346
Epoch: 43, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 370214
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2310292720794678
Epoch: 1, Steps: 2 | Train Loss: 2.165 Vali Loss: 1.958 Vali Acc: 0.144 Test Loss: 1.958 Test Acc: 0.144
Validation loss decreased (inf --> -0.144425).  Saving model ...
Epoch: 2 cost time: 0.5170807838439941
Epoch: 2, Steps: 2 | Train Loss: 1.962 Vali Loss: 1.798 Vali Acc: 0.178 Test Loss: 1.798 Test Acc: 0.178
Validation loss decreased (-0.144425 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.49120569229125977
Epoch: 3, Steps: 2 | Train Loss: 1.754 Vali Loss: 1.621 Vali Acc: 0.381 Test Loss: 1.621 Test Acc: 0.381
Validation loss decreased (-0.177760 --> -0.381465).  Saving model ...
Epoch: 4 cost time: 0.49285078048706055
Epoch: 4, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.373 Vali Acc: 0.589 Test Loss: 1.373 Test Acc: 0.589
Validation loss decreased (-0.381465 --> -0.588875).  Saving model ...
Epoch: 5 cost time: 0.5342662334442139
Epoch: 5, Steps: 2 | Train Loss: 1.214 Vali Loss: 1.118 Vali Acc: 0.704 Test Loss: 1.118 Test Acc: 0.704
Validation loss decreased (-0.588875 --> -0.703693).  Saving model ...
Epoch: 6 cost time: 0.5429244041442871
Epoch: 6, Steps: 2 | Train Loss: 0.934 Vali Loss: 0.902 Vali Acc: 0.722 Test Loss: 0.902 Test Acc: 0.722
Validation loss decreased (-0.703693 --> -0.722213).  Saving model ...
Epoch: 7 cost time: 0.5234954357147217
Epoch: 7, Steps: 2 | Train Loss: 0.698 Vali Loss: 0.737 Vali Acc: 0.744 Test Loss: 0.737 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744437).  Saving model ...
Epoch: 8 cost time: 0.4923977851867676
Epoch: 8, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.612 Vali Acc: 0.826 Test Loss: 0.612 Test Acc: 0.826
Validation loss decreased (-0.744437 --> -0.825920).  Saving model ...
Epoch: 9 cost time: 0.4588916301727295
Epoch: 9, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.523 Vali Acc: 0.848 Test Loss: 0.523 Test Acc: 0.848
Validation loss decreased (-0.825920 --> -0.848143).  Saving model ...
Epoch: 10 cost time: 0.4429640769958496
Epoch: 10, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.462 Vali Acc: 0.844 Test Loss: 0.462 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4495999813079834
Epoch: 11, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.414 Vali Acc: 0.874 Test Loss: 0.414 Test Acc: 0.874
Validation loss decreased (-0.848143 --> -0.874070).  Saving model ...
Epoch: 12 cost time: 0.41205263137817383
Epoch: 12, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.383 Vali Acc: 0.881 Test Loss: 0.383 Test Acc: 0.881
Validation loss decreased (-0.874070 --> -0.881478).  Saving model ...
Epoch: 13 cost time: 0.45678091049194336
Epoch: 13, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.361 Vali Acc: 0.874 Test Loss: 0.361 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5226321220397949
Epoch: 14, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.342 Vali Acc: 0.881 Test Loss: 0.342 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 15 cost time: 0.4615137577056885
Epoch: 15, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.881478 --> -0.888886).  Saving model ...
Epoch: 16 cost time: 0.4595606327056885
Epoch: 16, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.318 Vali Acc: 0.900 Test Loss: 0.318 Test Acc: 0.900
Validation loss decreased (-0.888886 --> -0.899997).  Saving model ...
Epoch: 17 cost time: 0.46827244758605957
Epoch: 17, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.307 Vali Acc: 0.896 Test Loss: 0.307 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4691946506500244
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.301 Vali Acc: 0.896 Test Loss: 0.301 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.5527627468109131
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.296 Vali Acc: 0.896 Test Loss: 0.296 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.5155906677246094
Epoch: 20, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.293 Vali Acc: 0.893 Test Loss: 0.293 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.46773338317871094
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.5547513961791992
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5011954307556152
Epoch: 23, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.285 Vali Acc: 0.885 Test Loss: 0.285 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 0.5375986099243164
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.281 Vali Acc: 0.900 Test Loss: 0.281 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.5221965312957764
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.896 Test Loss: 0.279 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5798463821411133
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.896 Test Loss: 0.279 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4659273624420166
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.896 Test Loss: 0.279 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5006301403045654
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.279 Vali Acc: 0.896 Test Loss: 0.279 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6577563285827637
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.280 Vali Acc: 0.900 Test Loss: 0.280 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 0.7426764965057373
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.282 Vali Acc: 0.900 Test Loss: 0.282 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.6445727348327637
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.285 Vali Acc: 0.896 Test Loss: 0.285 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.664806604385376
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.896 Test Loss: 0.289 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5984182357788086
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.290 Vali Acc: 0.896 Test Loss: 0.290 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5907442569732666
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.6275899410247803
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.287 Vali Acc: 0.896 Test Loss: 0.287 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6139740943908691
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.5000050067901611
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.286 Vali Acc: 0.900 Test Loss: 0.286 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.542992353439331
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.896 Test Loss: 0.286 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.49535131454467773
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.286 Vali Acc: 0.896 Test Loss: 0.286 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 370214
model size : 6.31MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.228618860244751
Epoch: 1, Steps: 2 | Train Loss: 1.948 Vali Loss: 1.698 Vali Acc: 0.300 Test Loss: 1.698 Test Acc: 0.300
Validation loss decreased (inf --> -0.299983).  Saving model ...
Epoch: 2 cost time: 0.5079207420349121
Epoch: 2, Steps: 2 | Train Loss: 1.818 Vali Loss: 1.557 Vali Acc: 0.407 Test Loss: 1.557 Test Acc: 0.407
Validation loss decreased (-0.299983 --> -0.407392).  Saving model ...
Epoch: 3 cost time: 0.5072267055511475
Epoch: 3, Steps: 2 | Train Loss: 1.561 Vali Loss: 1.394 Vali Acc: 0.593 Test Loss: 1.394 Test Acc: 0.593
Validation loss decreased (-0.407392 --> -0.592579).  Saving model ...
Epoch: 4 cost time: 0.4996922016143799
Epoch: 4, Steps: 2 | Train Loss: 1.434 Vali Loss: 1.156 Vali Acc: 0.748 Test Loss: 1.156 Test Acc: 0.748
Validation loss decreased (-0.592579 --> -0.748137).  Saving model ...
Epoch: 5 cost time: 0.47199034690856934
Epoch: 5, Steps: 2 | Train Loss: 1.103 Vali Loss: 0.910 Vali Acc: 0.822 Test Loss: 0.910 Test Acc: 0.822
Validation loss decreased (-0.748137 --> -0.822213).  Saving model ...
Epoch: 6 cost time: 0.4884006977081299
Epoch: 6, Steps: 2 | Train Loss: 0.801 Vali Loss: 0.699 Vali Acc: 0.874 Test Loss: 0.699 Test Acc: 0.874
Validation loss decreased (-0.822213 --> -0.874067).  Saving model ...
Epoch: 7 cost time: 0.49388861656188965
Epoch: 7, Steps: 2 | Train Loss: 0.596 Vali Loss: 0.540 Vali Acc: 0.900 Test Loss: 0.540 Test Acc: 0.900
Validation loss decreased (-0.874067 --> -0.899995).  Saving model ...
Epoch: 8 cost time: 0.5101580619812012
Epoch: 8, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.427 Vali Acc: 0.922 Test Loss: 0.427 Test Acc: 0.922
Validation loss decreased (-0.899995 --> -0.922218).  Saving model ...
Epoch: 9 cost time: 0.5115165710449219
Epoch: 9, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.347 Vali Acc: 0.933 Test Loss: 0.347 Test Acc: 0.933
Validation loss decreased (-0.922218 --> -0.933330).  Saving model ...
Epoch: 10 cost time: 0.4278545379638672
Epoch: 10, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.292 Vali Acc: 0.930 Test Loss: 0.292 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.4192357063293457
Epoch: 11, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.252 Vali Acc: 0.941 Test Loss: 0.252 Test Acc: 0.941
Validation loss decreased (-0.933330 --> -0.940738).  Saving model ...
Epoch: 12 cost time: 0.5215578079223633
Epoch: 12, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 0.4949939250946045
Epoch: 13, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 0.5410549640655518
Epoch: 14, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940739).  Saving model ...
Epoch: 15 cost time: 0.5004057884216309
Epoch: 15, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 16 cost time: 0.5061705112457275
Epoch: 16, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.941 Test Loss: 0.180 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.46562814712524414
Epoch: 17, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.5002362728118896
Epoch: 18, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.5043423175811768
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.48082566261291504
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4871232509613037
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5529842376708984
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4932277202606201
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.933 Test Loss: 0.174 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.49066853523254395
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.4957261085510254
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4964182376861572
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.6652207374572754
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.6535327434539795
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.6640455722808838
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.656320333480835
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.7222208976745605
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.676199197769165
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5599899291992188
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.6106548309326172
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.176 Vali Acc: 0.933 Test Loss: 0.176 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 304678
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.039504289627075
Epoch: 1, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.711 Vali Acc: 0.263 Test Loss: 1.711 Test Acc: 0.263
Validation loss decreased (inf --> -0.262946).  Saving model ...
Epoch: 2 cost time: 0.5799746513366699
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.569 Vali Acc: 0.411 Test Loss: 1.569 Test Acc: 0.411
Validation loss decreased (-0.262946 --> -0.411095).  Saving model ...
Epoch: 3 cost time: 0.5734267234802246
Epoch: 3, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.406 Vali Acc: 0.556 Test Loss: 1.406 Test Acc: 0.556
Validation loss decreased (-0.411095 --> -0.555541).  Saving model ...
Epoch: 4 cost time: 0.5835280418395996
Epoch: 4, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.170 Vali Acc: 0.722 Test Loss: 1.170 Test Acc: 0.722
Validation loss decreased (-0.555541 --> -0.722211).  Saving model ...
Epoch: 5 cost time: 0.5606777667999268
Epoch: 5, Steps: 2 | Train Loss: 1.135 Vali Loss: 0.925 Vali Acc: 0.815 Test Loss: 0.925 Test Acc: 0.815
Validation loss decreased (-0.722211 --> -0.814806).  Saving model ...
Epoch: 6 cost time: 0.5987615585327148
Epoch: 6, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.714 Vali Acc: 0.874 Test Loss: 0.714 Test Acc: 0.874
Validation loss decreased (-0.814806 --> -0.874067).  Saving model ...
Epoch: 7 cost time: 0.5906648635864258
Epoch: 7, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.555 Vali Acc: 0.904 Test Loss: 0.555 Test Acc: 0.904
Validation loss decreased (-0.874067 --> -0.903698).  Saving model ...
Epoch: 8 cost time: 0.5635991096496582
Epoch: 8, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.903698 --> -0.922218).  Saving model ...
Epoch: 9 cost time: 0.5415472984313965
Epoch: 9, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.360 Vali Acc: 0.926 Test Loss: 0.360 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 10 cost time: 0.5291192531585693
Epoch: 10, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.305 Vali Acc: 0.930 Test Loss: 0.305 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 11 cost time: 0.5537917613983154
Epoch: 11, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 12 cost time: 0.5323183536529541
Epoch: 12, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 13 cost time: 0.5635123252868652
Epoch: 13, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.929627 --> -0.940739).  Saving model ...
Epoch: 14 cost time: 0.5381133556365967
Epoch: 14, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 15 cost time: 0.5481626987457275
Epoch: 15, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5161838531494141
Epoch: 16, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.49463582038879395
Epoch: 17, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5140800476074219
Epoch: 18, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.510535717010498
Epoch: 19, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.178 Vali Acc: 0.941 Test Loss: 0.178 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.5148885250091553
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5303635597229004
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49525022506713867
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.177 Vali Acc: 0.933 Test Loss: 0.177 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.4998509883880615
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5182821750640869
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5347254276275635
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5904788970947266
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.565401554107666
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.178 Vali Acc: 0.930 Test Loss: 0.178 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5479717254638672
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.6046059131622314
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.178 Vali Acc: 0.933 Test Loss: 0.178 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 304678
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.194488048553467
Epoch: 1, Steps: 2 | Train Loss: 1.930 Vali Loss: 1.711 Vali Acc: 0.259 Test Loss: 1.711 Test Acc: 0.259
Validation loss decreased (inf --> -0.259242).  Saving model ...
Epoch: 2 cost time: 0.49972987174987793
Epoch: 2, Steps: 2 | Train Loss: 1.848 Vali Loss: 1.572 Vali Acc: 0.370 Test Loss: 1.572 Test Acc: 0.370
Validation loss decreased (-0.259242 --> -0.370355).  Saving model ...
Epoch: 3 cost time: 0.4701366424560547
Epoch: 3, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.414 Vali Acc: 0.589 Test Loss: 1.414 Test Acc: 0.589
Validation loss decreased (-0.370355 --> -0.588875).  Saving model ...
Epoch: 4 cost time: 0.4686276912689209
Epoch: 4, Steps: 2 | Train Loss: 1.424 Vali Loss: 1.184 Vali Acc: 0.722 Test Loss: 1.184 Test Acc: 0.722
Validation loss decreased (-0.588875 --> -0.722210).  Saving model ...
Epoch: 5 cost time: 0.5638270378112793
Epoch: 5, Steps: 2 | Train Loss: 1.101 Vali Loss: 0.947 Vali Acc: 0.804 Test Loss: 0.947 Test Acc: 0.804
Validation loss decreased (-0.722210 --> -0.803694).  Saving model ...
Epoch: 6 cost time: 0.5273168087005615
Epoch: 6, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.742 Vali Acc: 0.867 Test Loss: 0.742 Test Acc: 0.867
Validation loss decreased (-0.803694 --> -0.866659).  Saving model ...
Epoch: 7 cost time: 0.49277448654174805
Epoch: 7, Steps: 2 | Train Loss: 0.635 Vali Loss: 0.586 Vali Acc: 0.907 Test Loss: 0.586 Test Acc: 0.907
Validation loss decreased (-0.866659 --> -0.907402).  Saving model ...
Epoch: 8 cost time: 0.4812428951263428
Epoch: 8, Steps: 2 | Train Loss: 0.411 Vali Loss: 0.476 Vali Acc: 0.911 Test Loss: 0.476 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 9 cost time: 0.5231759548187256
Epoch: 9, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.397 Vali Acc: 0.919 Test Loss: 0.397 Test Acc: 0.919
Validation loss decreased (-0.911106 --> -0.918515).  Saving model ...
Epoch: 10 cost time: 0.46825432777404785
Epoch: 10, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.341 Vali Acc: 0.915 Test Loss: 0.341 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 0.49277329444885254
Epoch: 11, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.301 Vali Acc: 0.926 Test Loss: 0.301 Test Acc: 0.926
Validation loss decreased (-0.918515 --> -0.925923).  Saving model ...
Epoch: 12 cost time: 0.48107361793518066
Epoch: 12, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.269 Vali Acc: 0.926 Test Loss: 0.269 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 13 cost time: 0.5785715579986572
Epoch: 13, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5351259708404541
Epoch: 14, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 15 cost time: 0.5524542331695557
Epoch: 15, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 16 cost time: 0.5537426471710205
Epoch: 16, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.926 Test Loss: 0.210 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 17 cost time: 0.5690944194793701
Epoch: 17, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 18 cost time: 0.5836567878723145
Epoch: 18, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.603503942489624
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 0.5475869178771973
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 0.5441741943359375
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 0.5765924453735352
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.201 Vali Acc: 0.922 Test Loss: 0.201 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 0.5989217758178711
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 0.5656561851501465
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.922 Test Loss: 0.199 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 0.5309453010559082
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 0.626666784286499
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 0.5269169807434082
Epoch: 27, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 304678
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.996931791305542
Epoch: 1, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.665 Vali Acc: 0.322 Test Loss: 1.665 Test Acc: 0.322
Validation loss decreased (inf --> -0.322206).  Saving model ...
Epoch: 2 cost time: 0.445817232131958
Epoch: 2, Steps: 2 | Train Loss: 1.771 Vali Loss: 1.539 Vali Acc: 0.467 Test Loss: 1.539 Test Acc: 0.467
Validation loss decreased (-0.322206 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 0.44830894470214844
Epoch: 3, Steps: 2 | Train Loss: 1.545 Vali Loss: 1.396 Vali Acc: 0.641 Test Loss: 1.396 Test Acc: 0.641
Validation loss decreased (-0.466651 --> -0.640727).  Saving model ...
Epoch: 4 cost time: 0.5264835357666016
Epoch: 4, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.190 Vali Acc: 0.774 Test Loss: 1.190 Test Acc: 0.774
Validation loss decreased (-0.640727 --> -0.774062).  Saving model ...
Epoch: 5 cost time: 0.5009520053863525
Epoch: 5, Steps: 2 | Train Loss: 1.125 Vali Loss: 0.976 Vali Acc: 0.804 Test Loss: 0.976 Test Acc: 0.804
Validation loss decreased (-0.774062 --> -0.803694).  Saving model ...
Epoch: 6 cost time: 0.5342721939086914
Epoch: 6, Steps: 2 | Train Loss: 0.880 Vali Loss: 0.790 Vali Acc: 0.833 Test Loss: 0.790 Test Acc: 0.833
Validation loss decreased (-0.803694 --> -0.833325).  Saving model ...
Epoch: 7 cost time: 0.5283679962158203
Epoch: 7, Steps: 2 | Train Loss: 0.690 Vali Loss: 0.649 Vali Acc: 0.867 Test Loss: 0.649 Test Acc: 0.867
Validation loss decreased (-0.833325 --> -0.866660).  Saving model ...
Epoch: 8 cost time: 0.530482292175293
Epoch: 8, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.551 Vali Acc: 0.859 Test Loss: 0.551 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 0.5200247764587402
Epoch: 9, Steps: 2 | Train Loss: 0.401 Vali Loss: 0.481 Vali Acc: 0.870 Test Loss: 0.481 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870366).  Saving model ...
Epoch: 10 cost time: 0.5048887729644775
Epoch: 10, Steps: 2 | Train Loss: 0.309 Vali Loss: 0.431 Vali Acc: 0.889 Test Loss: 0.431 Test Acc: 0.889
Validation loss decreased (-0.870366 --> -0.888885).  Saving model ...
Epoch: 11 cost time: 0.5266745090484619
Epoch: 11, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.395 Vali Acc: 0.885 Test Loss: 0.395 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4626176357269287
Epoch: 12, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.369 Vali Acc: 0.885 Test Loss: 0.369 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 0.48212194442749023
Epoch: 13, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.347 Vali Acc: 0.900 Test Loss: 0.347 Test Acc: 0.900
Validation loss decreased (-0.888885 --> -0.899997).  Saving model ...
Epoch: 14 cost time: 0.5547080039978027
Epoch: 14, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.334 Vali Acc: 0.904 Test Loss: 0.334 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903700).  Saving model ...
Epoch: 15 cost time: 0.5306951999664307
Epoch: 15, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.321 Vali Acc: 0.896 Test Loss: 0.321 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5012495517730713
Epoch: 16, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.315 Vali Acc: 0.900 Test Loss: 0.315 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.503432035446167
Epoch: 17, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.310 Vali Acc: 0.900 Test Loss: 0.310 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.39676880836486816
Epoch: 18, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.303 Vali Acc: 0.904 Test Loss: 0.303 Test Acc: 0.904
Validation loss decreased (-0.903700 --> -0.903701).  Saving model ...
Epoch: 19 cost time: 0.49960803985595703
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.304 Vali Acc: 0.885 Test Loss: 0.304 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.41367316246032715
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.308 Vali Acc: 0.881 Test Loss: 0.308 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.46581435203552246
Epoch: 21, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.298 Vali Acc: 0.885 Test Loss: 0.298 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.45137619972229004
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.290 Vali Acc: 0.896 Test Loss: 0.290 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.46569395065307617
Epoch: 23, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 24 cost time: 0.45022106170654297
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.294 Vali Acc: 0.896 Test Loss: 0.294 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5279622077941895
Epoch: 25, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.896 Test Loss: 0.289 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5229201316833496
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5304076671600342
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.298 Vali Acc: 0.896 Test Loss: 0.298 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5253555774688721
Epoch: 28, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.302 Vali Acc: 0.893 Test Loss: 0.302 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4993607997894287
Epoch: 29, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.49471306800842285
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.295 Vali Acc: 0.893 Test Loss: 0.295 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.5245015621185303
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.292 Vali Acc: 0.885 Test Loss: 0.292 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.49268412590026855
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.48139309883117676
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 304678
model size : 6.06MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2447004318237305
Epoch: 1, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.721 Vali Acc: 0.233 Test Loss: 1.721 Test Acc: 0.233
Validation loss decreased (inf --> -0.233316).  Saving model ...
Epoch: 2 cost time: 0.5252518653869629
Epoch: 2, Steps: 2 | Train Loss: 1.575 Vali Loss: 1.587 Vali Acc: 0.370 Test Loss: 1.587 Test Acc: 0.370
Validation loss decreased (-0.233316 --> -0.370355).  Saving model ...
Epoch: 3 cost time: 0.4929685592651367
Epoch: 3, Steps: 2 | Train Loss: 1.449 Vali Loss: 1.434 Vali Acc: 0.515 Test Loss: 1.434 Test Acc: 0.515
Validation loss decreased (-0.370355 --> -0.514800).  Saving model ...
Epoch: 4 cost time: 0.47870969772338867
Epoch: 4, Steps: 2 | Train Loss: 1.239 Vali Loss: 1.212 Vali Acc: 0.633 Test Loss: 1.212 Test Acc: 0.633
Validation loss decreased (-0.514800 --> -0.633321).  Saving model ...
Epoch: 5 cost time: 0.5025250911712646
Epoch: 5, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.977 Vali Acc: 0.748 Test Loss: 0.977 Test Acc: 0.748
Validation loss decreased (-0.633321 --> -0.748138).  Saving model ...
Epoch: 6 cost time: 0.5180513858795166
Epoch: 6, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.768 Vali Acc: 0.822 Test Loss: 0.768 Test Acc: 0.822
Validation loss decreased (-0.748138 --> -0.822215).  Saving model ...
Epoch: 7 cost time: 0.5192999839782715
Epoch: 7, Steps: 2 | Train Loss: 0.539 Vali Loss: 0.602 Vali Acc: 0.859 Test Loss: 0.602 Test Acc: 0.859
Validation loss decreased (-0.822215 --> -0.859253).  Saving model ...
Epoch: 8 cost time: 0.6104755401611328
Epoch: 8, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.479 Vali Acc: 0.889 Test Loss: 0.479 Test Acc: 0.889
Validation loss decreased (-0.859253 --> -0.888884).  Saving model ...
Epoch: 9 cost time: 0.49643898010253906
Epoch: 9, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.391 Vali Acc: 0.911 Test Loss: 0.391 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911107).  Saving model ...
Epoch: 10 cost time: 0.5580811500549316
Epoch: 10, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
Validation loss decreased (-0.911107 --> -0.925923).  Saving model ...
Epoch: 11 cost time: 0.49892592430114746
Epoch: 11, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.279 Vali Acc: 0.933 Test Loss: 0.279 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 12 cost time: 0.5706510543823242
Epoch: 12, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 13 cost time: 0.5567097663879395
Epoch: 13, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 14 cost time: 0.5151886940002441
Epoch: 14, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 15 cost time: 0.5264408588409424
Epoch: 15, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 16 cost time: 0.5840926170349121
Epoch: 16, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 17 cost time: 0.5753762722015381
Epoch: 17, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 18 cost time: 0.5818157196044922
Epoch: 18, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 19 cost time: 0.5643930435180664
Epoch: 19, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.5254392623901367
Epoch: 20, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.5812842845916748
Epoch: 21, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5507962703704834
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.6079692840576172
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5689778327941895
Epoch: 24, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5928382873535156
Epoch: 25, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.549187183380127
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4935586452484131
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.46790313720703125
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.4549722671508789
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.46227431297302246
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 271910
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1996796131134033
Epoch: 1, Steps: 2 | Train Loss: 1.676 Vali Loss: 1.712 Vali Acc: 0.211 Test Loss: 1.712 Test Acc: 0.211
Validation loss decreased (inf --> -0.211094).  Saving model ...
Epoch: 2 cost time: 0.5494248867034912
Epoch: 2, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.579 Vali Acc: 0.367 Test Loss: 1.579 Test Acc: 0.367
Validation loss decreased (-0.211094 --> -0.366651).  Saving model ...
Epoch: 3 cost time: 0.5351097583770752
Epoch: 3, Steps: 2 | Train Loss: 1.422 Vali Loss: 1.428 Vali Acc: 0.533 Test Loss: 1.428 Test Acc: 0.533
Validation loss decreased (-0.366651 --> -0.533319).  Saving model ...
Epoch: 4 cost time: 0.5405375957489014
Epoch: 4, Steps: 2 | Train Loss: 1.250 Vali Loss: 1.208 Vali Acc: 0.674 Test Loss: 1.208 Test Acc: 0.674
Validation loss decreased (-0.533319 --> -0.674062).  Saving model ...
Epoch: 5 cost time: 0.5393896102905273
Epoch: 5, Steps: 2 | Train Loss: 0.999 Vali Loss: 0.976 Vali Acc: 0.770 Test Loss: 0.976 Test Acc: 0.770
Validation loss decreased (-0.674062 --> -0.770361).  Saving model ...
Epoch: 6 cost time: 0.49355483055114746
Epoch: 6, Steps: 2 | Train Loss: 0.760 Vali Loss: 0.769 Vali Acc: 0.822 Test Loss: 0.769 Test Acc: 0.822
Validation loss decreased (-0.770361 --> -0.822215).  Saving model ...
Epoch: 7 cost time: 0.5226547718048096
Epoch: 7, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.604 Vali Acc: 0.870 Test Loss: 0.604 Test Acc: 0.870
Validation loss decreased (-0.822215 --> -0.870364).  Saving model ...
Epoch: 8 cost time: 0.5238401889801025
Epoch: 8, Steps: 2 | Train Loss: 0.343 Vali Loss: 0.483 Vali Acc: 0.896 Test Loss: 0.483 Test Acc: 0.896
Validation loss decreased (-0.870364 --> -0.896291).  Saving model ...
Epoch: 9 cost time: 0.5487697124481201
Epoch: 9, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.397 Vali Acc: 0.904 Test Loss: 0.397 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903700).  Saving model ...
Epoch: 10 cost time: 0.5445611476898193
Epoch: 10, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.335 Vali Acc: 0.907 Test Loss: 0.335 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 11 cost time: 0.5450026988983154
Epoch: 11, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.288 Vali Acc: 0.911 Test Loss: 0.288 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 12 cost time: 0.554396390914917
Epoch: 12, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918516).  Saving model ...
Epoch: 13 cost time: 0.49866795539855957
Epoch: 13, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 14 cost time: 0.5474369525909424
Epoch: 14, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 15 cost time: 0.4674191474914551
Epoch: 15, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5354747772216797
Epoch: 16, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.926 Test Loss: 0.205 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 17 cost time: 0.5249593257904053
Epoch: 17, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
Validation loss decreased (-0.925924 --> -0.937035).  Saving model ...
Epoch: 18 cost time: 0.477982759475708
Epoch: 18, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.5120363235473633
Epoch: 19, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.5588641166687012
Epoch: 20, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.535844087600708
Epoch: 21, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5361232757568359
Epoch: 22, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.49798083305358887
Epoch: 23, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.4897294044494629
Epoch: 24, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5059421062469482
Epoch: 25, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.486497163772583
Epoch: 26, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.6111946105957031
Epoch: 27, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5398519039154053
Epoch: 28, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5540120601654053
Epoch: 29, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5903003215789795
Epoch: 30, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.6740052700042725
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.6258139610290527
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5906569957733154
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 271910
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2090911865234375
Epoch: 1, Steps: 2 | Train Loss: 1.733 Vali Loss: 1.707 Vali Acc: 0.181 Test Loss: 1.707 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.5637369155883789
Epoch: 2, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.577 Vali Acc: 0.385 Test Loss: 1.577 Test Acc: 0.385
Validation loss decreased (-0.181464 --> -0.385169).  Saving model ...
Epoch: 3 cost time: 0.5590274333953857
Epoch: 3, Steps: 2 | Train Loss: 1.463 Vali Loss: 1.430 Vali Acc: 0.511 Test Loss: 1.430 Test Acc: 0.511
Validation loss decreased (-0.385169 --> -0.511097).  Saving model ...
Epoch: 4 cost time: 0.49637722969055176
Epoch: 4, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.219 Vali Acc: 0.622 Test Loss: 1.219 Test Acc: 0.622
Validation loss decreased (-0.511097 --> -0.622210).  Saving model ...
Epoch: 5 cost time: 0.5024659633636475
Epoch: 5, Steps: 2 | Train Loss: 1.024 Vali Loss: 0.995 Vali Acc: 0.744 Test Loss: 0.995 Test Acc: 0.744
Validation loss decreased (-0.622210 --> -0.744434).  Saving model ...
Epoch: 6 cost time: 0.5503740310668945
Epoch: 6, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.795 Vali Acc: 0.807 Test Loss: 0.795 Test Acc: 0.807
Validation loss decreased (-0.744434 --> -0.807399).  Saving model ...
Epoch: 7 cost time: 0.5673940181732178
Epoch: 7, Steps: 2 | Train Loss: 0.574 Vali Loss: 0.635 Vali Acc: 0.848 Test Loss: 0.635 Test Acc: 0.848
Validation loss decreased (-0.807399 --> -0.848142).  Saving model ...
Epoch: 8 cost time: 0.5514383316040039
Epoch: 8, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.517 Vali Acc: 0.859 Test Loss: 0.517 Test Acc: 0.859
Validation loss decreased (-0.848142 --> -0.859254).  Saving model ...
Epoch: 9 cost time: 0.588092565536499
Epoch: 9, Steps: 2 | Train Loss: 0.289 Vali Loss: 0.431 Vali Acc: 0.878 Test Loss: 0.431 Test Acc: 0.878
Validation loss decreased (-0.859254 --> -0.877773).  Saving model ...
Epoch: 10 cost time: 0.5929338932037354
Epoch: 10, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.368 Vali Acc: 0.900 Test Loss: 0.368 Test Acc: 0.900
Validation loss decreased (-0.877773 --> -0.899996).  Saving model ...
Epoch: 11 cost time: 0.6272919178009033
Epoch: 11, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.322 Vali Acc: 0.896 Test Loss: 0.322 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.615257740020752
Epoch: 12, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.288 Vali Acc: 0.904 Test Loss: 0.288 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903701).  Saving model ...
Epoch: 13 cost time: 0.6373355388641357
Epoch: 13, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.265 Vali Acc: 0.915 Test Loss: 0.265 Test Acc: 0.915
Validation loss decreased (-0.903701 --> -0.914812).  Saving model ...
Epoch: 14 cost time: 0.610511064529419
Epoch: 14, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 15 cost time: 0.5729146003723145
Epoch: 15, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 16 cost time: 0.5665285587310791
Epoch: 16, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5410580635070801
Epoch: 17, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.221 Vali Acc: 0.915 Test Loss: 0.221 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.5795116424560547
Epoch: 18, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.915 Test Loss: 0.217 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5658528804779053
Epoch: 19, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 20 cost time: 0.6541788578033447
Epoch: 20, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5596129894256592
Epoch: 21, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 0.5317478179931641
Epoch: 22, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 23 cost time: 0.4833076000213623
Epoch: 23, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5585668087005615
Epoch: 24, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5262467861175537
Epoch: 25, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5436148643493652
Epoch: 26, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.514352560043335
Epoch: 27, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5631461143493652
Epoch: 28, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.6205298900604248
Epoch: 29, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.922 Test Loss: 0.211 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.6537752151489258
Epoch: 30, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.7266731262207031
Epoch: 31, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 32 cost time: 0.6198160648345947
Epoch: 32, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.6298103332519531
Epoch: 33, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5609922409057617
Epoch: 34, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6066117286682129
Epoch: 35, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5841281414031982
Epoch: 36, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.6214113235473633
Epoch: 37, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.590897798538208
Epoch: 38, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5797066688537598
Epoch: 39, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5941717624664307
Epoch: 40, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5651397705078125
Epoch: 41, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.6314504146575928
Epoch: 42, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 271910
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.135282039642334
Epoch: 1, Steps: 2 | Train Loss: 1.686 Vali Loss: 1.675 Vali Acc: 0.348 Test Loss: 1.675 Test Acc: 0.348
Validation loss decreased (inf --> -0.348131).  Saving model ...
Epoch: 2 cost time: 0.6004137992858887
Epoch: 2, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.556 Vali Acc: 0.437 Test Loss: 1.556 Test Acc: 0.437
Validation loss decreased (-0.348131 --> -0.437021).  Saving model ...
Epoch: 3 cost time: 0.5720858573913574
Epoch: 3, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.424 Vali Acc: 0.519 Test Loss: 1.424 Test Acc: 0.519
Validation loss decreased (-0.437021 --> -0.518504).  Saving model ...
Epoch: 4 cost time: 0.5729820728302002
Epoch: 4, Steps: 2 | Train Loss: 1.308 Vali Loss: 1.237 Vali Acc: 0.619 Test Loss: 1.237 Test Acc: 0.619
Validation loss decreased (-0.518504 --> -0.618506).  Saving model ...
Epoch: 5 cost time: 0.5450143814086914
Epoch: 5, Steps: 2 | Train Loss: 1.101 Vali Loss: 1.039 Vali Acc: 0.641 Test Loss: 1.039 Test Acc: 0.641
Validation loss decreased (-0.618506 --> -0.640730).  Saving model ...
Epoch: 6 cost time: 0.49887514114379883
Epoch: 6, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.860 Vali Acc: 0.730 Test Loss: 0.860 Test Acc: 0.730
Validation loss decreased (-0.640730 --> -0.729621).  Saving model ...
Epoch: 7 cost time: 0.5195326805114746
Epoch: 7, Steps: 2 | Train Loss: 0.680 Vali Loss: 0.715 Vali Acc: 0.800 Test Loss: 0.715 Test Acc: 0.800
Validation loss decreased (-0.729621 --> -0.799993).  Saving model ...
Epoch: 8 cost time: 0.5019524097442627
Epoch: 8, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.606 Vali Acc: 0.819 Test Loss: 0.606 Test Acc: 0.819
Validation loss decreased (-0.799993 --> -0.818512).  Saving model ...
Epoch: 9 cost time: 0.5383889675140381
Epoch: 9, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.527 Vali Acc: 0.833 Test Loss: 0.527 Test Acc: 0.833
Validation loss decreased (-0.818512 --> -0.833328).  Saving model ...
Epoch: 10 cost time: 0.4988226890563965
Epoch: 10, Steps: 2 | Train Loss: 0.284 Vali Loss: 0.470 Vali Acc: 0.833 Test Loss: 0.470 Test Acc: 0.833
Validation loss decreased (-0.833328 --> -0.833329).  Saving model ...
Epoch: 11 cost time: 0.622133731842041
Epoch: 11, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.430 Vali Acc: 0.852 Test Loss: 0.430 Test Acc: 0.852
Validation loss decreased (-0.833329 --> -0.851848).  Saving model ...
Epoch: 12 cost time: 0.5418586730957031
Epoch: 12, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.401 Vali Acc: 0.859 Test Loss: 0.401 Test Acc: 0.859
Validation loss decreased (-0.851848 --> -0.859255).  Saving model ...
Epoch: 13 cost time: 0.5347123146057129
Epoch: 13, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.380 Vali Acc: 0.856 Test Loss: 0.380 Test Acc: 0.856
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5698845386505127
Epoch: 14, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.363 Vali Acc: 0.856 Test Loss: 0.363 Test Acc: 0.856
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 0.5106565952301025
Epoch: 15, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
Validation loss decreased (-0.859255 --> -0.877774).  Saving model ...
Epoch: 16 cost time: 0.5080201625823975
Epoch: 16, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.334 Vali Acc: 0.889 Test Loss: 0.334 Test Acc: 0.889
Validation loss decreased (-0.877774 --> -0.888886).  Saving model ...
Epoch: 17 cost time: 0.5230100154876709
Epoch: 17, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.326 Vali Acc: 0.885 Test Loss: 0.326 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.45374321937561035
Epoch: 18, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.320 Vali Acc: 0.885 Test Loss: 0.320 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4448258876800537
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.315 Vali Acc: 0.893 Test Loss: 0.315 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892589).  Saving model ...
Epoch: 20 cost time: 0.4810903072357178
Epoch: 20, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.314 Vali Acc: 0.878 Test Loss: 0.314 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.49437761306762695
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.315 Vali Acc: 0.878 Test Loss: 0.315 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.575463056564331
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.310 Vali Acc: 0.878 Test Loss: 0.310 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5861430168151855
Epoch: 23, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.306 Vali Acc: 0.878 Test Loss: 0.306 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5746912956237793
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.304 Vali Acc: 0.881 Test Loss: 0.304 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5499866008758545
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.303 Vali Acc: 0.885 Test Loss: 0.303 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.5553889274597168
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.303 Vali Acc: 0.881 Test Loss: 0.303 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5024299621582031
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.303 Vali Acc: 0.881 Test Loss: 0.303 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5926685333251953
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.302 Vali Acc: 0.881 Test Loss: 0.302 Test Acc: 0.881
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5617020130157471
Epoch: 29, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.302 Vali Acc: 0.881 Test Loss: 0.302 Test Acc: 0.881
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 271910
model size : 5.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.042253255844116
Epoch: 1, Steps: 2 | Train Loss: 2.094 Vali Loss: 1.982 Vali Acc: 0.100 Test Loss: 1.982 Test Acc: 0.100
Validation loss decreased (inf --> -0.099980).  Saving model ...
Epoch: 2 cost time: 0.4582493305206299
Epoch: 2, Steps: 2 | Train Loss: 2.047 Vali Loss: 1.861 Vali Acc: 0.122 Test Loss: 1.861 Test Acc: 0.122
Validation loss decreased (-0.099980 --> -0.122204).  Saving model ...
Epoch: 3 cost time: 0.4834482669830322
Epoch: 3, Steps: 2 | Train Loss: 1.802 Vali Loss: 1.741 Vali Acc: 0.174 Test Loss: 1.741 Test Acc: 0.174
Validation loss decreased (-0.122204 --> -0.174057).  Saving model ...
Epoch: 4 cost time: 0.4666321277618408
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.583 Vali Acc: 0.370 Test Loss: 1.583 Test Acc: 0.370
Validation loss decreased (-0.174057 --> -0.370355).  Saving model ...
Epoch: 5 cost time: 0.5042085647583008
Epoch: 5, Steps: 2 | Train Loss: 1.502 Vali Loss: 1.399 Vali Acc: 0.504 Test Loss: 1.399 Test Acc: 0.504
Validation loss decreased (-0.370355 --> -0.503690).  Saving model ...
Epoch: 6 cost time: 0.4967665672302246
Epoch: 6, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.215 Vali Acc: 0.581 Test Loss: 1.215 Test Acc: 0.581
Validation loss decreased (-0.503690 --> -0.581469).  Saving model ...
Epoch: 7 cost time: 0.46421098709106445
Epoch: 7, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.049 Vali Acc: 0.678 Test Loss: 1.049 Test Acc: 0.678
Validation loss decreased (-0.581469 --> -0.677767).  Saving model ...
Epoch: 8 cost time: 0.524662971496582
Epoch: 8, Steps: 2 | Train Loss: 0.821 Vali Loss: 0.904 Vali Acc: 0.707 Test Loss: 0.904 Test Acc: 0.707
Validation loss decreased (-0.677767 --> -0.707398).  Saving model ...
Epoch: 9 cost time: 0.5751428604125977
Epoch: 9, Steps: 2 | Train Loss: 0.720 Vali Loss: 0.777 Vali Acc: 0.759 Test Loss: 0.777 Test Acc: 0.759
Validation loss decreased (-0.707398 --> -0.759251).  Saving model ...
Epoch: 10 cost time: 0.5590970516204834
Epoch: 10, Steps: 2 | Train Loss: 0.549 Vali Loss: 0.671 Vali Acc: 0.800 Test Loss: 0.671 Test Acc: 0.800
Validation loss decreased (-0.759251 --> -0.799993).  Saving model ...
Epoch: 11 cost time: 0.5964560508728027
Epoch: 11, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.580 Vali Acc: 0.826 Test Loss: 0.580 Test Acc: 0.826
Validation loss decreased (-0.799993 --> -0.825920).  Saving model ...
Epoch: 12 cost time: 0.5170011520385742
Epoch: 12, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.503 Vali Acc: 0.844 Test Loss: 0.503 Test Acc: 0.844
Validation loss decreased (-0.825920 --> -0.844439).  Saving model ...
Epoch: 13 cost time: 0.5157597064971924
Epoch: 13, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.440 Vali Acc: 0.863 Test Loss: 0.440 Test Acc: 0.863
Validation loss decreased (-0.844439 --> -0.862959).  Saving model ...
Epoch: 14 cost time: 0.5329995155334473
Epoch: 14, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.388 Vali Acc: 0.878 Test Loss: 0.388 Test Acc: 0.878
Validation loss decreased (-0.862959 --> -0.877774).  Saving model ...
Epoch: 15 cost time: 0.5438919067382812
Epoch: 15, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.348 Vali Acc: 0.893 Test Loss: 0.348 Test Acc: 0.893
Validation loss decreased (-0.877774 --> -0.892589).  Saving model ...
Epoch: 16 cost time: 0.5575962066650391
Epoch: 16, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
Validation loss decreased (-0.892589 --> -0.903701).  Saving model ...
Epoch: 17 cost time: 0.5146424770355225
Epoch: 17, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
Validation loss decreased (-0.903701 --> -0.911108).  Saving model ...
Epoch: 18 cost time: 0.5366199016571045
Epoch: 18, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.5464720726013184
Epoch: 19, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.249 Vali Acc: 0.911 Test Loss: 0.249 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 0.5513651371002197
Epoch: 20, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 0.5307669639587402
Epoch: 21, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
Validation loss decreased (-0.911109 --> -0.918516).  Saving model ...
Epoch: 22 cost time: 0.4988102912902832
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 23 cost time: 0.5350992679595947
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 24 cost time: 0.4895505905151367
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.922 Test Loss: 0.210 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 25 cost time: 0.44228243827819824
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 26 cost time: 0.4950389862060547
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.49643921852111816
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.922 Test Loss: 0.203 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.5150864124298096
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5058987140655518
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.5112862586975098
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5463263988494873
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.540708065032959
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.5634913444519043
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.5455200672149658
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.5306649208068848
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 36 cost time: 0.6089508533477783
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 37 cost time: 0.6043188571929932
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5745251178741455
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6103835105895996
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5091102123260498
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5794899463653564
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.5434384346008301
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.5669498443603516
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5716860294342041
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.5577192306518555
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.4731588363647461
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5043497085571289
Epoch: 47, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.6034305095672607
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.5858840942382812
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.563704252243042
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.4887685775756836
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.4875965118408203
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5772697925567627
Epoch: 53, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5539536476135254
Epoch: 54, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.197 Vali Acc: 0.944 Test Loss: 0.197 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.5451116561889648
Epoch: 55, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.5726289749145508
Epoch: 56, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.5511023998260498
Epoch: 57, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.5577635765075684
Epoch: 58, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.5394105911254883
Epoch: 59, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.5567762851715088
Epoch: 60, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.5583803653717041
Epoch: 61, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.539710283279419
Epoch: 62, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 63 cost time: 0.5514481067657471
Epoch: 63, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 2 out of 10
Epoch: 64 cost time: 0.532090425491333
Epoch: 64, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 3 out of 10
Epoch: 65 cost time: 0.5680792331695557
Epoch: 65, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 66 cost time: 0.5588943958282471
Epoch: 66, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 67 cost time: 0.48788881301879883
Epoch: 67, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 68 cost time: 0.5182492733001709
Epoch: 68, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 7 out of 10
Epoch: 69 cost time: 0.474445104598999
Epoch: 69, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 8 out of 10
Epoch: 70 cost time: 0.5720205307006836
Epoch: 70, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 9 out of 10
Epoch: 71 cost time: 0.5164685249328613
Epoch: 71, Steps: 2 | Train Loss: 0.001 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 611110
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.315612316131592
Epoch: 1, Steps: 2 | Train Loss: 2.089 Vali Loss: 1.986 Vali Acc: 0.093 Test Loss: 1.986 Test Acc: 0.093
Validation loss decreased (inf --> -0.092573).  Saving model ...
Epoch: 2 cost time: 0.5512583255767822
Epoch: 2, Steps: 2 | Train Loss: 2.044 Vali Loss: 1.866 Vali Acc: 0.104 Test Loss: 1.866 Test Acc: 0.104
Validation loss decreased (-0.092573 --> -0.103685).  Saving model ...
Epoch: 3 cost time: 0.5144302845001221
Epoch: 3, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.745 Vali Acc: 0.141 Test Loss: 1.745 Test Acc: 0.141
Validation loss decreased (-0.103685 --> -0.140723).  Saving model ...
Epoch: 4 cost time: 0.567716121673584
Epoch: 4, Steps: 2 | Train Loss: 1.700 Vali Loss: 1.588 Vali Acc: 0.352 Test Loss: 1.588 Test Acc: 0.352
Validation loss decreased (-0.140723 --> -0.351836).  Saving model ...
Epoch: 5 cost time: 0.5790069103240967
Epoch: 5, Steps: 2 | Train Loss: 1.509 Vali Loss: 1.405 Vali Acc: 0.481 Test Loss: 1.405 Test Acc: 0.481
Validation loss decreased (-0.351836 --> -0.481467).  Saving model ...
Epoch: 6 cost time: 0.6265604496002197
Epoch: 6, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.221 Vali Acc: 0.600 Test Loss: 1.221 Test Acc: 0.600
Validation loss decreased (-0.481467 --> -0.599988).  Saving model ...
Epoch: 7 cost time: 0.546471118927002
Epoch: 7, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.055 Vali Acc: 0.674 Test Loss: 1.055 Test Acc: 0.674
Validation loss decreased (-0.599988 --> -0.674064).  Saving model ...
Epoch: 8 cost time: 0.507882833480835
Epoch: 8, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.910 Vali Acc: 0.707 Test Loss: 0.910 Test Acc: 0.707
Validation loss decreased (-0.674064 --> -0.707398).  Saving model ...
Epoch: 9 cost time: 0.5464377403259277
Epoch: 9, Steps: 2 | Train Loss: 0.733 Vali Loss: 0.783 Vali Acc: 0.741 Test Loss: 0.783 Test Acc: 0.741
Validation loss decreased (-0.707398 --> -0.740733).  Saving model ...
Epoch: 10 cost time: 0.5947129726409912
Epoch: 10, Steps: 2 | Train Loss: 0.569 Vali Loss: 0.680 Vali Acc: 0.770 Test Loss: 0.680 Test Acc: 0.770
Validation loss decreased (-0.740733 --> -0.770364).  Saving model ...
Epoch: 11 cost time: 0.501331090927124
Epoch: 11, Steps: 2 | Train Loss: 0.437 Vali Loss: 0.590 Vali Acc: 0.811 Test Loss: 0.590 Test Acc: 0.811
Validation loss decreased (-0.770364 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 0.5036194324493408
Epoch: 12, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.514 Vali Acc: 0.826 Test Loss: 0.514 Test Acc: 0.826
Validation loss decreased (-0.811105 --> -0.825921).  Saving model ...
Epoch: 13 cost time: 0.4484565258026123
Epoch: 13, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.451 Vali Acc: 0.848 Test Loss: 0.451 Test Acc: 0.848
Validation loss decreased (-0.825921 --> -0.848144).  Saving model ...
Epoch: 14 cost time: 0.48932480812072754
Epoch: 14, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.398 Vali Acc: 0.881 Test Loss: 0.398 Test Acc: 0.881
Validation loss decreased (-0.848144 --> -0.881477).  Saving model ...
Epoch: 15 cost time: 0.5424504280090332
Epoch: 15, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.359 Vali Acc: 0.893 Test Loss: 0.359 Test Acc: 0.893
Validation loss decreased (-0.881477 --> -0.892589).  Saving model ...
Epoch: 16 cost time: 0.4604053497314453
Epoch: 16, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.324 Vali Acc: 0.911 Test Loss: 0.324 Test Acc: 0.911
Validation loss decreased (-0.892589 --> -0.911108).  Saving model ...
Epoch: 17 cost time: 0.5178830623626709
Epoch: 17, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.296 Vali Acc: 0.907 Test Loss: 0.296 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5298013687133789
Epoch: 18, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.274 Vali Acc: 0.911 Test Loss: 0.274 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 19 cost time: 0.5439109802246094
Epoch: 19, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.256 Vali Acc: 0.911 Test Loss: 0.256 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 20 cost time: 0.5024669170379639
Epoch: 20, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 0.5688707828521729
Epoch: 21, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.233 Vali Acc: 0.911 Test Loss: 0.233 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 22 cost time: 0.5709195137023926
Epoch: 22, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.911 Test Loss: 0.226 Test Acc: 0.911
Validation loss decreased (-0.911109 --> -0.911109).  Saving model ...
Epoch: 23 cost time: 0.6238493919372559
Epoch: 23, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.915 Test Loss: 0.220 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914813).  Saving model ...
Epoch: 24 cost time: 0.6291162967681885
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.915 Test Loss: 0.216 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 25 cost time: 0.5973896980285645
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.915 Test Loss: 0.212 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 26 cost time: 0.5725219249725342
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.210 Vali Acc: 0.915 Test Loss: 0.210 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 27 cost time: 0.5711703300476074
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.922 Test Loss: 0.207 Test Acc: 0.922
Validation loss decreased (-0.914813 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.5299501419067383
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.206 Vali Acc: 0.922 Test Loss: 0.206 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.5758740901947021
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.205 Vali Acc: 0.919 Test Loss: 0.205 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.58882737159729
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.919 Test Loss: 0.204 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.5491385459899902
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.919 Test Loss: 0.203 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5503833293914795
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.203 Vali Acc: 0.919 Test Loss: 0.203 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4946746826171875
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 34 cost time: 0.5938999652862549
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.202 Vali Acc: 0.922 Test Loss: 0.202 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 35 cost time: 0.5401678085327148
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 36 cost time: 0.49739551544189453
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 37 cost time: 0.49182772636413574
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 38 cost time: 0.4984285831451416
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5520100593566895
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 40 cost time: 0.564990758895874
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 41 cost time: 0.4969203472137451
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5188586711883545
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5861937999725342
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5278096199035645
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5525805950164795
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5343818664550781
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5485258102416992
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5582501888275146
Epoch: 48, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5280451774597168
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.5601801872253418
Epoch: 50, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 611110
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.168116807937622
Epoch: 1, Steps: 2 | Train Loss: 2.107 Vali Loss: 1.945 Vali Acc: 0.107 Test Loss: 1.945 Test Acc: 0.107
Validation loss decreased (inf --> -0.107388).  Saving model ...
Epoch: 2 cost time: 0.5195150375366211
Epoch: 2, Steps: 2 | Train Loss: 2.017 Vali Loss: 1.829 Vali Acc: 0.126 Test Loss: 1.829 Test Acc: 0.126
Validation loss decreased (-0.107388 --> -0.125908).  Saving model ...
Epoch: 3 cost time: 0.4981412887573242
Epoch: 3, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.713 Vali Acc: 0.159 Test Loss: 1.713 Test Acc: 0.159
Validation loss decreased (-0.125908 --> -0.159242).  Saving model ...
Epoch: 4 cost time: 0.4999048709869385
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.562 Vali Acc: 0.367 Test Loss: 1.562 Test Acc: 0.367
Validation loss decreased (-0.159242 --> -0.366651).  Saving model ...
Epoch: 5 cost time: 0.48784852027893066
Epoch: 5, Steps: 2 | Train Loss: 1.523 Vali Loss: 1.387 Vali Acc: 0.526 Test Loss: 1.387 Test Acc: 0.526
Validation loss decreased (-0.366651 --> -0.525912).  Saving model ...
Epoch: 6 cost time: 0.52400803565979
Epoch: 6, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.211 Vali Acc: 0.619 Test Loss: 1.211 Test Acc: 0.619
Validation loss decreased (-0.525912 --> -0.618506).  Saving model ...
Epoch: 7 cost time: 0.4861793518066406
Epoch: 7, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.053 Vali Acc: 0.674 Test Loss: 1.053 Test Acc: 0.674
Validation loss decreased (-0.618506 --> -0.674064).  Saving model ...
Epoch: 8 cost time: 0.48323845863342285
Epoch: 8, Steps: 2 | Train Loss: 0.867 Vali Loss: 0.916 Vali Acc: 0.722 Test Loss: 0.916 Test Acc: 0.722
Validation loss decreased (-0.674064 --> -0.722213).  Saving model ...
Epoch: 9 cost time: 0.4892106056213379
Epoch: 9, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.797 Vali Acc: 0.744 Test Loss: 0.797 Test Acc: 0.744
Validation loss decreased (-0.722213 --> -0.744436).  Saving model ...
Epoch: 10 cost time: 0.5264203548431396
Epoch: 10, Steps: 2 | Train Loss: 0.608 Vali Loss: 0.700 Vali Acc: 0.744 Test Loss: 0.700 Test Acc: 0.744
Validation loss decreased (-0.744436 --> -0.744437).  Saving model ...
Epoch: 11 cost time: 0.567176103591919
Epoch: 11, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.615 Vali Acc: 0.778 Test Loss: 0.615 Test Acc: 0.778
Validation loss decreased (-0.744437 --> -0.777772).  Saving model ...
Epoch: 12 cost time: 0.5410890579223633
Epoch: 12, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.541 Vali Acc: 0.800 Test Loss: 0.541 Test Acc: 0.800
Validation loss decreased (-0.777772 --> -0.799995).  Saving model ...
Epoch: 13 cost time: 0.5966620445251465
Epoch: 13, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.480 Vali Acc: 0.841 Test Loss: 0.480 Test Acc: 0.841
Validation loss decreased (-0.799995 --> -0.840736).  Saving model ...
Epoch: 14 cost time: 0.5718502998352051
Epoch: 14, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.428 Vali Acc: 0.863 Test Loss: 0.428 Test Acc: 0.863
Validation loss decreased (-0.840736 --> -0.862959).  Saving model ...
Epoch: 15 cost time: 0.5346195697784424
Epoch: 15, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.388 Vali Acc: 0.881 Test Loss: 0.388 Test Acc: 0.881
Validation loss decreased (-0.862959 --> -0.881478).  Saving model ...
Epoch: 16 cost time: 0.5133147239685059
Epoch: 16, Steps: 2 | Train Loss: 0.166 Vali Loss: 0.356 Vali Acc: 0.893 Test Loss: 0.356 Test Acc: 0.893
Validation loss decreased (-0.881478 --> -0.892589).  Saving model ...
Epoch: 17 cost time: 0.56966233253479
Epoch: 17, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.330 Vali Acc: 0.893 Test Loss: 0.330 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 18 cost time: 0.5532801151275635
Epoch: 18, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.307 Vali Acc: 0.904 Test Loss: 0.307 Test Acc: 0.904
Validation loss decreased (-0.892589 --> -0.903701).  Saving model ...
Epoch: 19 cost time: 0.5708835124969482
Epoch: 19, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
Validation loss decreased (-0.903701 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 0.5445966720581055
Epoch: 20, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.272 Vali Acc: 0.911 Test Loss: 0.272 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.5822470188140869
Epoch: 21, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.261 Vali Acc: 0.907 Test Loss: 0.261 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5625429153442383
Epoch: 22, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.252 Vali Acc: 0.907 Test Loss: 0.252 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5321133136749268
Epoch: 23, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.245 Vali Acc: 0.907 Test Loss: 0.245 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.5166289806365967
Epoch: 24, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.240 Vali Acc: 0.915 Test Loss: 0.240 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.5259292125701904
Epoch: 25, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.236 Vali Acc: 0.915 Test Loss: 0.236 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.5055093765258789
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.233 Vali Acc: 0.915 Test Loss: 0.233 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.5000083446502686
Epoch: 27, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.4977846145629883
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 29 cost time: 0.5449306964874268
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925924).  Saving model ...
Epoch: 30 cost time: 0.5571036338806152
Epoch: 30, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 31 cost time: 0.5728156566619873
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.225 Vali Acc: 0.926 Test Loss: 0.225 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 32 cost time: 0.5748386383056641
Epoch: 32, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.5602281093597412
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.596358060836792
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.6102395057678223
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.6087198257446289
Epoch: 36, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5760531425476074
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.6283268928527832
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.5692753791809082
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5721662044525146
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5456259250640869
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5496628284454346
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 611110
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.8533313274383545
Epoch: 1, Steps: 2 | Train Loss: 1.989 Vali Loss: 1.871 Vali Acc: 0.178 Test Loss: 1.871 Test Acc: 0.178
Validation loss decreased (inf --> -0.177759).  Saving model ...
Epoch: 2 cost time: 0.4265449047088623
Epoch: 2, Steps: 2 | Train Loss: 1.904 Vali Loss: 1.762 Vali Acc: 0.200 Test Loss: 1.762 Test Acc: 0.200
Validation loss decreased (-0.177759 --> -0.199982).  Saving model ...
Epoch: 3 cost time: 0.42858386039733887
Epoch: 3, Steps: 2 | Train Loss: 1.755 Vali Loss: 1.654 Vali Acc: 0.352 Test Loss: 1.654 Test Acc: 0.352
Validation loss decreased (-0.199982 --> -0.351835).  Saving model ...
Epoch: 4 cost time: 0.4251437187194824
Epoch: 4, Steps: 2 | Train Loss: 1.642 Vali Loss: 1.516 Vali Acc: 0.444 Test Loss: 1.516 Test Acc: 0.444
Validation loss decreased (-0.351835 --> -0.444429).  Saving model ...
Epoch: 5 cost time: 0.4685049057006836
Epoch: 5, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.355 Vali Acc: 0.548 Test Loss: 1.355 Test Acc: 0.548
Validation loss decreased (-0.444429 --> -0.548135).  Saving model ...
Epoch: 6 cost time: 0.46300554275512695
Epoch: 6, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.194 Vali Acc: 0.648 Test Loss: 1.194 Test Acc: 0.648
Validation loss decreased (-0.548135 --> -0.648136).  Saving model ...
Epoch: 7 cost time: 0.4639720916748047
Epoch: 7, Steps: 2 | Train Loss: 1.168 Vali Loss: 1.049 Vali Acc: 0.670 Test Loss: 1.049 Test Acc: 0.670
Validation loss decreased (-0.648136 --> -0.670360).  Saving model ...
Epoch: 8 cost time: 0.4628713130950928
Epoch: 8, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.925 Vali Acc: 0.678 Test Loss: 0.925 Test Acc: 0.678
Validation loss decreased (-0.670360 --> -0.677769).  Saving model ...
Epoch: 9 cost time: 0.46919703483581543
Epoch: 9, Steps: 2 | Train Loss: 0.817 Vali Loss: 0.819 Vali Acc: 0.704 Test Loss: 0.819 Test Acc: 0.704
Validation loss decreased (-0.677769 --> -0.703696).  Saving model ...
Epoch: 10 cost time: 0.4671502113342285
Epoch: 10, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.735 Vali Acc: 0.719 Test Loss: 0.735 Test Acc: 0.719
Validation loss decreased (-0.703696 --> -0.718511).  Saving model ...
Epoch: 11 cost time: 0.48178529739379883
Epoch: 11, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.663 Vali Acc: 0.726 Test Loss: 0.663 Test Acc: 0.726
Validation loss decreased (-0.718511 --> -0.725919).  Saving model ...
Epoch: 12 cost time: 0.4622809886932373
Epoch: 12, Steps: 2 | Train Loss: 0.435 Vali Loss: 0.602 Vali Acc: 0.733 Test Loss: 0.602 Test Acc: 0.733
Validation loss decreased (-0.725919 --> -0.733327).  Saving model ...
Epoch: 13 cost time: 0.4905998706817627
Epoch: 13, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.550 Vali Acc: 0.741 Test Loss: 0.550 Test Acc: 0.741
Validation loss decreased (-0.733327 --> -0.740735).  Saving model ...
Epoch: 14 cost time: 0.43734240531921387
Epoch: 14, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.506 Vali Acc: 0.774 Test Loss: 0.506 Test Acc: 0.774
Validation loss decreased (-0.740735 --> -0.774069).  Saving model ...
Epoch: 15 cost time: 0.481395959854126
Epoch: 15, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.471 Vali Acc: 0.785 Test Loss: 0.471 Test Acc: 0.785
Validation loss decreased (-0.774069 --> -0.785180).  Saving model ...
Epoch: 16 cost time: 0.5786712169647217
Epoch: 16, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.445 Vali Acc: 0.841 Test Loss: 0.445 Test Acc: 0.841
Validation loss decreased (-0.785180 --> -0.840736).  Saving model ...
Epoch: 17 cost time: 0.468825101852417
Epoch: 17, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.423 Vali Acc: 0.852 Test Loss: 0.423 Test Acc: 0.852
Validation loss decreased (-0.840736 --> -0.851848).  Saving model ...
Epoch: 18 cost time: 0.49693775177001953
Epoch: 18, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.402 Vali Acc: 0.848 Test Loss: 0.402 Test Acc: 0.848
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4836735725402832
Epoch: 19, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.385 Vali Acc: 0.852 Test Loss: 0.385 Test Acc: 0.852
Validation loss decreased (-0.851848 --> -0.851848).  Saving model ...
Epoch: 20 cost time: 0.43488526344299316
Epoch: 20, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.372 Vali Acc: 0.863 Test Loss: 0.372 Test Acc: 0.863
Validation loss decreased (-0.851848 --> -0.862959).  Saving model ...
Epoch: 21 cost time: 0.4302380084991455
Epoch: 21, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.360 Vali Acc: 0.863 Test Loss: 0.360 Test Acc: 0.863
Validation loss decreased (-0.862959 --> -0.862959).  Saving model ...
Epoch: 22 cost time: 0.4198000431060791
Epoch: 22, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.348 Vali Acc: 0.870 Test Loss: 0.348 Test Acc: 0.870
Validation loss decreased (-0.862959 --> -0.870367).  Saving model ...
Epoch: 23 cost time: 0.4261476993560791
Epoch: 23, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.338 Vali Acc: 0.870 Test Loss: 0.338 Test Acc: 0.870
Validation loss decreased (-0.870367 --> -0.870367).  Saving model ...
Epoch: 24 cost time: 0.4236717224121094
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.330 Vali Acc: 0.885 Test Loss: 0.330 Test Acc: 0.885
Validation loss decreased (-0.870367 --> -0.885182).  Saving model ...
Epoch: 25 cost time: 0.41353511810302734
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.325 Vali Acc: 0.893 Test Loss: 0.325 Test Acc: 0.893
Validation loss decreased (-0.885182 --> -0.892589).  Saving model ...
Epoch: 26 cost time: 0.43110036849975586
Epoch: 26, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.319 Vali Acc: 0.896 Test Loss: 0.319 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 27 cost time: 0.41430187225341797
Epoch: 27, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4860696792602539
Epoch: 28, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.310 Vali Acc: 0.885 Test Loss: 0.310 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4442477226257324
Epoch: 29, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.308 Vali Acc: 0.874 Test Loss: 0.308 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.4867713451385498
Epoch: 30, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.305 Vali Acc: 0.881 Test Loss: 0.305 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4696512222290039
Epoch: 31, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.302 Vali Acc: 0.885 Test Loss: 0.302 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.4852638244628906
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.301 Vali Acc: 0.881 Test Loss: 0.301 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5430033206939697
Epoch: 33, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.301 Vali Acc: 0.881 Test Loss: 0.301 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.42807936668395996
Epoch: 34, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.301 Vali Acc: 0.885 Test Loss: 0.301 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.4800889492034912
Epoch: 35, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.885 Test Loss: 0.301 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4944453239440918
Epoch: 36, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.301 Vali Acc: 0.885 Test Loss: 0.301 Test Acc: 0.885
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 611110
model size : 4.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1833226680755615
Epoch: 1, Steps: 2 | Train Loss: 1.873 Vali Loss: 1.805 Vali Acc: 0.285 Test Loss: 1.805 Test Acc: 0.285
Validation loss decreased (inf --> -0.285167).  Saving model ...
Epoch: 2 cost time: 0.5197076797485352
Epoch: 2, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.686 Vali Acc: 0.341 Test Loss: 1.686 Test Acc: 0.341
Validation loss decreased (-0.285167 --> -0.340724).  Saving model ...
Epoch: 3 cost time: 0.5283637046813965
Epoch: 3, Steps: 2 | Train Loss: 1.643 Vali Loss: 1.572 Vali Acc: 0.378 Test Loss: 1.572 Test Acc: 0.378
Validation loss decreased (-0.340724 --> -0.377762).  Saving model ...
Epoch: 4 cost time: 0.48292064666748047
Epoch: 4, Steps: 2 | Train Loss: 1.554 Vali Loss: 1.428 Vali Acc: 0.437 Test Loss: 1.428 Test Acc: 0.437
Validation loss decreased (-0.377762 --> -0.437023).  Saving model ...
Epoch: 5 cost time: 0.4533705711364746
Epoch: 5, Steps: 2 | Train Loss: 1.329 Vali Loss: 1.258 Vali Acc: 0.548 Test Loss: 1.258 Test Acc: 0.548
Validation loss decreased (-0.437023 --> -0.548136).  Saving model ...
Epoch: 6 cost time: 0.4818718433380127
Epoch: 6, Steps: 2 | Train Loss: 1.172 Vali Loss: 1.081 Vali Acc: 0.748 Test Loss: 1.081 Test Acc: 0.748
Validation loss decreased (-0.548136 --> -0.748137).  Saving model ...
Epoch: 7 cost time: 0.46983933448791504
Epoch: 7, Steps: 2 | Train Loss: 0.936 Vali Loss: 0.915 Vali Acc: 0.811 Test Loss: 0.915 Test Acc: 0.811
Validation loss decreased (-0.748137 --> -0.811102).  Saving model ...
Epoch: 8 cost time: 0.46605634689331055
Epoch: 8, Steps: 2 | Train Loss: 0.813 Vali Loss: 0.770 Vali Acc: 0.867 Test Loss: 0.770 Test Acc: 0.867
Validation loss decreased (-0.811102 --> -0.866659).  Saving model ...
Epoch: 9 cost time: 0.4349219799041748
Epoch: 9, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.648 Vali Acc: 0.889 Test Loss: 0.648 Test Acc: 0.889
Validation loss decreased (-0.866659 --> -0.888882).  Saving model ...
Epoch: 10 cost time: 0.45297789573669434
Epoch: 10, Steps: 2 | Train Loss: 0.460 Vali Loss: 0.547 Vali Acc: 0.911 Test Loss: 0.547 Test Acc: 0.911
Validation loss decreased (-0.888882 --> -0.911106).  Saving model ...
Epoch: 11 cost time: 0.48687195777893066
Epoch: 11, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.464 Vali Acc: 0.930 Test Loss: 0.464 Test Acc: 0.930
Validation loss decreased (-0.911106 --> -0.929625).  Saving model ...
Epoch: 12 cost time: 0.515620231628418
Epoch: 12, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.398 Vali Acc: 0.937 Test Loss: 0.398 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 13 cost time: 0.5048336982727051
Epoch: 13, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.345 Vali Acc: 0.941 Test Loss: 0.345 Test Acc: 0.941
Validation loss decreased (-0.937033 --> -0.940737).  Saving model ...
Epoch: 14 cost time: 0.528766393661499
Epoch: 14, Steps: 2 | Train Loss: 0.149 Vali Loss: 0.304 Vali Acc: 0.941 Test Loss: 0.304 Test Acc: 0.941
Validation loss decreased (-0.940737 --> -0.940738).  Saving model ...
Epoch: 15 cost time: 0.4619171619415283
Epoch: 15, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.271 Vali Acc: 0.944 Test Loss: 0.271 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.4886927604675293
Epoch: 16, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 17 cost time: 0.5313670635223389
Epoch: 17, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.46533894538879395
Epoch: 18, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4915628433227539
Epoch: 19, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.517916202545166
Epoch: 20, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.4945409297943115
Epoch: 21, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 22 cost time: 0.544029712677002
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5527527332305908
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5107018947601318
Epoch: 24, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5530648231506348
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.48408031463623047
Epoch: 26, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.42395758628845215
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.41661572456359863
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.4050486087799072
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.44178104400634766
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.4532344341278076
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 348966
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.091482162475586
Epoch: 1, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.784 Vali Acc: 0.278 Test Loss: 1.784 Test Acc: 0.278
Validation loss decreased (inf --> -0.277760).  Saving model ...
Epoch: 2 cost time: 0.5341198444366455
Epoch: 2, Steps: 2 | Train Loss: 1.734 Vali Loss: 1.666 Vali Acc: 0.322 Test Loss: 1.666 Test Acc: 0.322
Validation loss decreased (-0.277760 --> -0.322206).  Saving model ...
Epoch: 3 cost time: 0.571225643157959
Epoch: 3, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.553 Vali Acc: 0.393 Test Loss: 1.553 Test Acc: 0.393
Validation loss decreased (-0.322206 --> -0.392577).  Saving model ...
Epoch: 4 cost time: 0.4797022342681885
Epoch: 4, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.411 Vali Acc: 0.467 Test Loss: 1.411 Test Acc: 0.467
Validation loss decreased (-0.392577 --> -0.466653).  Saving model ...
Epoch: 5 cost time: 0.511223316192627
Epoch: 5, Steps: 2 | Train Loss: 1.282 Vali Loss: 1.244 Vali Acc: 0.611 Test Loss: 1.244 Test Acc: 0.611
Validation loss decreased (-0.466653 --> -0.611099).  Saving model ...
Epoch: 6 cost time: 0.528205394744873
Epoch: 6, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.072 Vali Acc: 0.770 Test Loss: 1.072 Test Acc: 0.770
Validation loss decreased (-0.611099 --> -0.770360).  Saving model ...
Epoch: 7 cost time: 0.5671391487121582
Epoch: 7, Steps: 2 | Train Loss: 0.925 Vali Loss: 0.910 Vali Acc: 0.815 Test Loss: 0.910 Test Acc: 0.815
Validation loss decreased (-0.770360 --> -0.814806).  Saving model ...
Epoch: 8 cost time: 0.5469319820404053
Epoch: 8, Steps: 2 | Train Loss: 0.808 Vali Loss: 0.770 Vali Acc: 0.863 Test Loss: 0.770 Test Acc: 0.863
Validation loss decreased (-0.814806 --> -0.862955).  Saving model ...
Epoch: 9 cost time: 0.5310747623443604
Epoch: 9, Steps: 2 | Train Loss: 0.615 Vali Loss: 0.652 Vali Acc: 0.893 Test Loss: 0.652 Test Acc: 0.893
Validation loss decreased (-0.862955 --> -0.892586).  Saving model ...
Epoch: 10 cost time: 0.5438113212585449
Epoch: 10, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.553 Vali Acc: 0.922 Test Loss: 0.553 Test Acc: 0.922
Validation loss decreased (-0.892586 --> -0.922217).  Saving model ...
Epoch: 11 cost time: 0.4742250442504883
Epoch: 11, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.471 Vali Acc: 0.926 Test Loss: 0.471 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 12 cost time: 0.49141955375671387
Epoch: 12, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.405 Vali Acc: 0.933 Test Loss: 0.405 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 13 cost time: 0.5211155414581299
Epoch: 13, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.354 Vali Acc: 0.937 Test Loss: 0.354 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 14 cost time: 0.4594447612762451
Epoch: 14, Steps: 2 | Train Loss: 0.165 Vali Loss: 0.313 Vali Acc: 0.933 Test Loss: 0.313 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47236180305480957
Epoch: 15, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.280 Vali Acc: 0.937 Test Loss: 0.280 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 16 cost time: 0.43753600120544434
Epoch: 16, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.256 Vali Acc: 0.937 Test Loss: 0.256 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 17 cost time: 0.44083142280578613
Epoch: 17, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.45360898971557617
Epoch: 18, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.43572330474853516
Epoch: 19, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.40721869468688965
Epoch: 20, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 21 cost time: 0.4795382022857666
Epoch: 21, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4521188735961914
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5080947875976562
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.49643921852111816
Epoch: 24, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.5371460914611816
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5248630046844482
Epoch: 26, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.47847580909729004
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5741820335388184
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944443).  Saving model ...
Epoch: 29 cost time: 0.5683813095092773
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 30 cost time: 0.5588474273681641
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 31 cost time: 0.5307135581970215
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 32 cost time: 0.535254955291748
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 33 cost time: 0.4961214065551758
Epoch: 33, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.186 Vali Acc: 0.944 Test Loss: 0.186 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 34 cost time: 0.4903888702392578
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 35 cost time: 0.47027158737182617
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4916722774505615
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.184 Vali Acc: 0.941 Test Loss: 0.184 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.493488073348999
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.47227907180786133
Epoch: 38, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4546816349029541
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.183 Vali Acc: 0.941 Test Loss: 0.183 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4945063591003418
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.48247218132019043
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4839901924133301
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5170469284057617
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5194869041442871
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.182 Vali Acc: 0.941 Test Loss: 0.182 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 348966
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.14090895652771
Epoch: 1, Steps: 2 | Train Loss: 1.804 Vali Loss: 1.760 Vali Acc: 0.326 Test Loss: 1.760 Test Acc: 0.326
Validation loss decreased (inf --> -0.325908).  Saving model ...
Epoch: 2 cost time: 0.5317890644073486
Epoch: 2, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.646 Vali Acc: 0.378 Test Loss: 1.646 Test Acc: 0.378
Validation loss decreased (-0.325908 --> -0.377761).  Saving model ...
Epoch: 3 cost time: 0.5695958137512207
Epoch: 3, Steps: 2 | Train Loss: 1.610 Vali Loss: 1.537 Vali Acc: 0.444 Test Loss: 1.537 Test Acc: 0.444
Validation loss decreased (-0.377761 --> -0.444429).  Saving model ...
Epoch: 4 cost time: 0.5080900192260742
Epoch: 4, Steps: 2 | Train Loss: 1.497 Vali Loss: 1.400 Vali Acc: 0.526 Test Loss: 1.400 Test Acc: 0.526
Validation loss decreased (-0.444429 --> -0.525912).  Saving model ...
Epoch: 5 cost time: 0.5504639148712158
Epoch: 5, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.240 Vali Acc: 0.644 Test Loss: 1.240 Test Acc: 0.644
Validation loss decreased (-0.525912 --> -0.644432).  Saving model ...
Epoch: 6 cost time: 0.5515224933624268
Epoch: 6, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.074 Vali Acc: 0.752 Test Loss: 1.074 Test Acc: 0.752
Validation loss decreased (-0.644432 --> -0.751841).  Saving model ...
Epoch: 7 cost time: 0.48552632331848145
Epoch: 7, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.920 Vali Acc: 0.826 Test Loss: 0.920 Test Acc: 0.826
Validation loss decreased (-0.751841 --> -0.825917).  Saving model ...
Epoch: 8 cost time: 0.466724157333374
Epoch: 8, Steps: 2 | Train Loss: 0.811 Vali Loss: 0.786 Vali Acc: 0.852 Test Loss: 0.786 Test Acc: 0.852
Validation loss decreased (-0.825917 --> -0.851844).  Saving model ...
Epoch: 9 cost time: 0.47918057441711426
Epoch: 9, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.674 Vali Acc: 0.878 Test Loss: 0.674 Test Acc: 0.878
Validation loss decreased (-0.851844 --> -0.877771).  Saving model ...
Epoch: 10 cost time: 0.5150048732757568
Epoch: 10, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.579 Vali Acc: 0.893 Test Loss: 0.579 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892587).  Saving model ...
Epoch: 11 cost time: 0.4898250102996826
Epoch: 11, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.501 Vali Acc: 0.900 Test Loss: 0.501 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.4561452865600586
Epoch: 12, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.437 Vali Acc: 0.907 Test Loss: 0.437 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 0.4801466464996338
Epoch: 13, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.387 Vali Acc: 0.904 Test Loss: 0.387 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.4960768222808838
Epoch: 14, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.4869728088378906
Epoch: 15, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.312 Vali Acc: 0.915 Test Loss: 0.312 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.5132639408111572
Epoch: 16, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.506190299987793
Epoch: 17, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 18 cost time: 0.49541783332824707
Epoch: 18, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 19 cost time: 0.5161616802215576
Epoch: 19, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 20 cost time: 0.5048301219940186
Epoch: 20, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.225 Vali Acc: 0.933 Test Loss: 0.225 Test Acc: 0.933
Validation loss decreased (-0.922220 --> -0.933331).  Saving model ...
Epoch: 21 cost time: 0.5346145629882812
Epoch: 21, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.4926753044128418
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.5246281623840332
Epoch: 23, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.4761993885040283
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5224509239196777
Epoch: 25, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5353717803955078
Epoch: 26, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5798184871673584
Epoch: 27, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5638058185577393
Epoch: 28, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5236709117889404
Epoch: 29, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.4869832992553711
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.466688871383667
Epoch: 31, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.556159257888794
Epoch: 32, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.509711742401123
Epoch: 33, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.201 Vali Acc: 0.930 Test Loss: 0.201 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 348966
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.096630573272705
Epoch: 1, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.688 Vali Acc: 0.356 Test Loss: 1.688 Test Acc: 0.356
Validation loss decreased (inf --> -0.355539).  Saving model ...
Epoch: 2 cost time: 0.46715784072875977
Epoch: 2, Steps: 2 | Train Loss: 1.660 Vali Loss: 1.582 Vali Acc: 0.407 Test Loss: 1.582 Test Acc: 0.407
Validation loss decreased (-0.355539 --> -0.407392).  Saving model ...
Epoch: 3 cost time: 0.49188661575317383
Epoch: 3, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.483 Vali Acc: 0.493 Test Loss: 1.483 Test Acc: 0.493
Validation loss decreased (-0.407392 --> -0.492578).  Saving model ...
Epoch: 4 cost time: 0.5043494701385498
Epoch: 4, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.361 Vali Acc: 0.652 Test Loss: 1.361 Test Acc: 0.652
Validation loss decreased (-0.492578 --> -0.651838).  Saving model ...
Epoch: 5 cost time: 0.46864771842956543
Epoch: 5, Steps: 2 | Train Loss: 1.332 Vali Loss: 1.218 Vali Acc: 0.733 Test Loss: 1.218 Test Acc: 0.733
Validation loss decreased (-0.651838 --> -0.733321).  Saving model ...
Epoch: 6 cost time: 0.531728982925415
Epoch: 6, Steps: 2 | Train Loss: 1.170 Vali Loss: 1.072 Vali Acc: 0.781 Test Loss: 1.072 Test Acc: 0.781
Validation loss decreased (-0.733321 --> -0.781471).  Saving model ...
Epoch: 7 cost time: 0.561060905456543
Epoch: 7, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.937 Vali Acc: 0.815 Test Loss: 0.937 Test Acc: 0.815
Validation loss decreased (-0.781471 --> -0.814805).  Saving model ...
Epoch: 8 cost time: 0.5214571952819824
Epoch: 8, Steps: 2 | Train Loss: 0.863 Vali Loss: 0.820 Vali Acc: 0.815 Test Loss: 0.820 Test Acc: 0.815
Validation loss decreased (-0.814805 --> -0.814807).  Saving model ...
Epoch: 9 cost time: 0.4886820316314697
Epoch: 9, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.723 Vali Acc: 0.830 Test Loss: 0.723 Test Acc: 0.830
Validation loss decreased (-0.814807 --> -0.829622).  Saving model ...
Epoch: 10 cost time: 0.5305438041687012
Epoch: 10, Steps: 2 | Train Loss: 0.571 Vali Loss: 0.642 Vali Acc: 0.867 Test Loss: 0.642 Test Acc: 0.867
Validation loss decreased (-0.829622 --> -0.866660).  Saving model ...
Epoch: 11 cost time: 0.5471823215484619
Epoch: 11, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.574 Vali Acc: 0.863 Test Loss: 0.574 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.5740146636962891
Epoch: 12, Steps: 2 | Train Loss: 0.458 Vali Loss: 0.519 Vali Acc: 0.885 Test Loss: 0.519 Test Acc: 0.885
Validation loss decreased (-0.866660 --> -0.885180).  Saving model ...
Epoch: 13 cost time: 0.5165553092956543
Epoch: 13, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.474 Vali Acc: 0.896 Test Loss: 0.474 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896292).  Saving model ...
Epoch: 14 cost time: 0.4710690975189209
Epoch: 14, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.439 Vali Acc: 0.889 Test Loss: 0.439 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.47025060653686523
Epoch: 15, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.409 Vali Acc: 0.896 Test Loss: 0.409 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896292).  Saving model ...
Epoch: 16 cost time: 0.43370723724365234
Epoch: 16, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.386 Vali Acc: 0.889 Test Loss: 0.386 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.43505263328552246
Epoch: 17, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.366 Vali Acc: 0.878 Test Loss: 0.366 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.4585428237915039
Epoch: 18, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.349 Vali Acc: 0.893 Test Loss: 0.349 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4107799530029297
Epoch: 19, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.336 Vali Acc: 0.900 Test Loss: 0.336 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899997).  Saving model ...
Epoch: 20 cost time: 0.4251213073730469
Epoch: 20, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.326 Vali Acc: 0.900 Test Loss: 0.326 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.42903804779052734
Epoch: 21, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.319 Vali Acc: 0.907 Test Loss: 0.319 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.5493903160095215
Epoch: 22, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.314 Vali Acc: 0.904 Test Loss: 0.314 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5402703285217285
Epoch: 23, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5678179264068604
Epoch: 24, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.301 Vali Acc: 0.900 Test Loss: 0.301 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5565977096557617
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.296 Vali Acc: 0.896 Test Loss: 0.296 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5805909633636475
Epoch: 26, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.292 Vali Acc: 0.911 Test Loss: 0.292 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 27 cost time: 0.5285592079162598
Epoch: 27, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.289 Vali Acc: 0.907 Test Loss: 0.289 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.6521070003509521
Epoch: 28, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.287 Vali Acc: 0.907 Test Loss: 0.287 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5627040863037109
Epoch: 29, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.285 Vali Acc: 0.904 Test Loss: 0.285 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5407860279083252
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.284 Vali Acc: 0.900 Test Loss: 0.284 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.545825719833374
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.5999488830566406
Epoch: 32, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.282 Vali Acc: 0.904 Test Loss: 0.282 Test Acc: 0.904
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5041313171386719
Epoch: 33, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.281 Vali Acc: 0.904 Test Loss: 0.281 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5292444229125977
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.280 Vali Acc: 0.904 Test Loss: 0.280 Test Acc: 0.904
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.517798662185669
Epoch: 35, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.280 Vali Acc: 0.904 Test Loss: 0.280 Test Acc: 0.904
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.483426570892334
Epoch: 36, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.279 Vali Acc: 0.904 Test Loss: 0.279 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9111111111111111
model parameter : 348966
model size : 3.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.007648229598999
Epoch: 1, Steps: 2 | Train Loss: 1.998 Vali Loss: 1.774 Vali Acc: 0.181 Test Loss: 1.774 Test Acc: 0.181
Validation loss decreased (inf --> -0.181464).  Saving model ...
Epoch: 2 cost time: 0.46442389488220215
Epoch: 2, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.655 Vali Acc: 0.233 Test Loss: 1.655 Test Acc: 0.233
Validation loss decreased (-0.181464 --> -0.233317).  Saving model ...
Epoch: 3 cost time: 0.507620096206665
Epoch: 3, Steps: 2 | Train Loss: 1.555 Vali Loss: 1.543 Vali Acc: 0.363 Test Loss: 1.543 Test Acc: 0.363
Validation loss decreased (-0.233317 --> -0.362948).  Saving model ...
Epoch: 4 cost time: 0.5374929904937744
Epoch: 4, Steps: 2 | Train Loss: 1.607 Vali Loss: 1.398 Vali Acc: 0.493 Test Loss: 1.398 Test Acc: 0.493
Validation loss decreased (-0.362948 --> -0.492579).  Saving model ...
Epoch: 5 cost time: 0.49733924865722656
Epoch: 5, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.230 Vali Acc: 0.622 Test Loss: 1.230 Test Acc: 0.622
Validation loss decreased (-0.492579 --> -0.622210).  Saving model ...
Epoch: 6 cost time: 0.5301580429077148
Epoch: 6, Steps: 2 | Train Loss: 1.096 Vali Loss: 1.063 Vali Acc: 0.700 Test Loss: 1.063 Test Acc: 0.700
Validation loss decreased (-0.622210 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.49912524223327637
Epoch: 7, Steps: 2 | Train Loss: 1.003 Vali Loss: 0.907 Vali Acc: 0.767 Test Loss: 0.907 Test Acc: 0.767
Validation loss decreased (-0.699989 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 0.505669355392456
Epoch: 8, Steps: 2 | Train Loss: 0.747 Vali Loss: 0.772 Vali Acc: 0.811 Test Loss: 0.772 Test Acc: 0.811
Validation loss decreased (-0.766658 --> -0.811103).  Saving model ...
Epoch: 9 cost time: 0.49747467041015625
Epoch: 9, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.659 Vali Acc: 0.833 Test Loss: 0.659 Test Acc: 0.833
Validation loss decreased (-0.811103 --> -0.833327).  Saving model ...
Epoch: 10 cost time: 0.44432497024536133
Epoch: 10, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.567 Vali Acc: 0.859 Test Loss: 0.567 Test Acc: 0.859
Validation loss decreased (-0.833327 --> -0.859254).  Saving model ...
Epoch: 11 cost time: 0.49243807792663574
Epoch: 11, Steps: 2 | Train Loss: 0.431 Vali Loss: 0.491 Vali Acc: 0.889 Test Loss: 0.491 Test Acc: 0.889
Validation loss decreased (-0.859254 --> -0.888884).  Saving model ...
Epoch: 12 cost time: 0.5390810966491699
Epoch: 12, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.422 Vali Acc: 0.911 Test Loss: 0.422 Test Acc: 0.911
Validation loss decreased (-0.888884 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 0.5236105918884277
Epoch: 13, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.366 Vali Acc: 0.919 Test Loss: 0.366 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 14 cost time: 0.5246562957763672
Epoch: 14, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.320 Vali Acc: 0.930 Test Loss: 0.320 Test Acc: 0.930
Validation loss decreased (-0.918515 --> -0.929626).  Saving model ...
Epoch: 15 cost time: 0.5752801895141602
Epoch: 15, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.286 Vali Acc: 0.930 Test Loss: 0.286 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.45011186599731445
Epoch: 16, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 0.46188879013061523
Epoch: 17, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 18 cost time: 0.46628880500793457
Epoch: 18, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.4183831214904785
Epoch: 19, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 20 cost time: 0.4643855094909668
Epoch: 20, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 0.43578553199768066
Epoch: 21, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.4234631061553955
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 23 cost time: 0.42226457595825195
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.186 Vali Acc: 0.937 Test Loss: 0.186 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 24 cost time: 0.4777054786682129
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.183 Vali Acc: 0.937 Test Loss: 0.183 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 25 cost time: 0.46564292907714844
Epoch: 25, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.181 Vali Acc: 0.937 Test Loss: 0.181 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 26 cost time: 0.4339907169342041
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 27 cost time: 0.48894596099853516
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.4604756832122803
Epoch: 28, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.5130889415740967
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 30 cost time: 0.4602067470550537
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 31 cost time: 0.48844408988952637
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.5381150245666504
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.49164247512817383
Epoch: 33, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.46686553955078125
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5243394374847412
Epoch: 35, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.563319206237793
Epoch: 36, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.5415997505187988
Epoch: 37, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.171 Vali Acc: 0.941 Test Loss: 0.171 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5392038822174072
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.49812793731689453
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.5430104732513428
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.173 Vali Acc: 0.941 Test Loss: 0.173 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.5069477558135986
Epoch: 41, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.5047125816345215
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.48506593704223633
Epoch: 43, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 217894
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9931271076202393
Epoch: 1, Steps: 2 | Train Loss: 2.014 Vali Loss: 1.768 Vali Acc: 0.219 Test Loss: 1.768 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.43909192085266113
Epoch: 2, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.651 Vali Acc: 0.281 Test Loss: 1.651 Test Acc: 0.281
Validation loss decreased (-0.218501 --> -0.281465).  Saving model ...
Epoch: 3 cost time: 0.5416824817657471
Epoch: 3, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.539 Vali Acc: 0.396 Test Loss: 1.539 Test Acc: 0.396
Validation loss decreased (-0.281465 --> -0.396281).  Saving model ...
Epoch: 4 cost time: 0.494884729385376
Epoch: 4, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.395 Vali Acc: 0.515 Test Loss: 1.395 Test Acc: 0.515
Validation loss decreased (-0.396281 --> -0.514801).  Saving model ...
Epoch: 5 cost time: 0.49592113494873047
Epoch: 5, Steps: 2 | Train Loss: 1.301 Vali Loss: 1.228 Vali Acc: 0.604 Test Loss: 1.228 Test Acc: 0.604
Validation loss decreased (-0.514801 --> -0.603691).  Saving model ...
Epoch: 6 cost time: 0.5085749626159668
Epoch: 6, Steps: 2 | Train Loss: 1.113 Vali Loss: 1.062 Vali Acc: 0.700 Test Loss: 1.062 Test Acc: 0.700
Validation loss decreased (-0.603691 --> -0.699989).  Saving model ...
Epoch: 7 cost time: 0.5351221561431885
Epoch: 7, Steps: 2 | Train Loss: 1.012 Vali Loss: 0.907 Vali Acc: 0.785 Test Loss: 0.907 Test Acc: 0.785
Validation loss decreased (-0.699989 --> -0.785176).  Saving model ...
Epoch: 8 cost time: 0.5421650409698486
Epoch: 8, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.772 Vali Acc: 0.830 Test Loss: 0.772 Test Acc: 0.830
Validation loss decreased (-0.785176 --> -0.829622).  Saving model ...
Epoch: 9 cost time: 0.5362319946289062
Epoch: 9, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.660 Vali Acc: 0.859 Test Loss: 0.660 Test Acc: 0.859
Validation loss decreased (-0.829622 --> -0.859253).  Saving model ...
Epoch: 10 cost time: 0.5983254909515381
Epoch: 10, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.569 Vali Acc: 0.889 Test Loss: 0.569 Test Acc: 0.889
Validation loss decreased (-0.859253 --> -0.888883).  Saving model ...
Epoch: 11 cost time: 0.47455620765686035
Epoch: 11, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.493 Vali Acc: 0.904 Test Loss: 0.493 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903699).  Saving model ...
Epoch: 12 cost time: 0.5215761661529541
Epoch: 12, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.425 Vali Acc: 0.911 Test Loss: 0.425 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911107).  Saving model ...
Epoch: 13 cost time: 0.5089161396026611
Epoch: 13, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.5643458366394043
Epoch: 14, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.326 Vali Acc: 0.926 Test Loss: 0.326 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925923).  Saving model ...
Epoch: 15 cost time: 0.5693714618682861
Epoch: 15, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.293 Vali Acc: 0.930 Test Loss: 0.293 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 16 cost time: 0.5237464904785156
Epoch: 16, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.267 Vali Acc: 0.930 Test Loss: 0.267 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 0.4716343879699707
Epoch: 17, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 18 cost time: 0.40575599670410156
Epoch: 18, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 19 cost time: 0.5069904327392578
Epoch: 19, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 20 cost time: 0.4378201961517334
Epoch: 20, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 21 cost time: 0.43053269386291504
Epoch: 21, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 22 cost time: 0.410541296005249
Epoch: 22, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.42865681648254395
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.5481441020965576
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.49932217597961426
Epoch: 25, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.182 Vali Acc: 0.933 Test Loss: 0.182 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933332).  Saving model ...
Epoch: 26 cost time: 0.5778012275695801
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
Validation loss decreased (-0.933332 --> -0.933332).  Saving model ...
Epoch: 27 cost time: 0.5835778713226318
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
Validation loss decreased (-0.933332 --> -0.937035).  Saving model ...
Epoch: 28 cost time: 0.5596847534179688
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.5684230327606201
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.6160252094268799
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5727667808532715
Epoch: 31, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.5403001308441162
Epoch: 32, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.5405383110046387
Epoch: 33, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.5200207233428955
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5099117755889893
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5851955413818359
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.48701000213623047
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.175 Vali Acc: 0.937 Test Loss: 0.175 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.46347665786743164
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5374772548675537
Epoch: 39, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.176 Vali Acc: 0.937 Test Loss: 0.176 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4394066333770752
Epoch: 40, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.43875670433044434
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.177 Vali Acc: 0.937 Test Loss: 0.177 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.44005513191223145
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.42107510566711426
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 217894
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0445141792297363
Epoch: 1, Steps: 2 | Train Loss: 1.978 Vali Loss: 1.735 Vali Acc: 0.219 Test Loss: 1.735 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.4837062358856201
Epoch: 2, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.622 Vali Acc: 0.330 Test Loss: 1.622 Test Acc: 0.330
Validation loss decreased (-0.218501 --> -0.329613).  Saving model ...
Epoch: 3 cost time: 0.4454948902130127
Epoch: 3, Steps: 2 | Train Loss: 1.592 Vali Loss: 1.514 Vali Acc: 0.411 Test Loss: 1.514 Test Acc: 0.411
Validation loss decreased (-0.329613 --> -0.411096).  Saving model ...
Epoch: 4 cost time: 0.5048210620880127
Epoch: 4, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.376 Vali Acc: 0.552 Test Loss: 1.376 Test Acc: 0.552
Validation loss decreased (-0.411096 --> -0.551838).  Saving model ...
Epoch: 5 cost time: 0.4843709468841553
Epoch: 5, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.217 Vali Acc: 0.641 Test Loss: 1.217 Test Acc: 0.641
Validation loss decreased (-0.551838 --> -0.640729).  Saving model ...
Epoch: 6 cost time: 0.47096681594848633
Epoch: 6, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.058 Vali Acc: 0.730 Test Loss: 1.058 Test Acc: 0.730
Validation loss decreased (-0.640729 --> -0.729619).  Saving model ...
Epoch: 7 cost time: 0.4731330871582031
Epoch: 7, Steps: 2 | Train Loss: 1.056 Vali Loss: 0.910 Vali Acc: 0.781 Test Loss: 0.910 Test Acc: 0.781
Validation loss decreased (-0.729619 --> -0.781472).  Saving model ...
Epoch: 8 cost time: 0.5095977783203125
Epoch: 8, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.782 Vali Acc: 0.830 Test Loss: 0.782 Test Acc: 0.830
Validation loss decreased (-0.781472 --> -0.829622).  Saving model ...
Epoch: 9 cost time: 0.5369651317596436
Epoch: 9, Steps: 2 | Train Loss: 0.658 Vali Loss: 0.675 Vali Acc: 0.863 Test Loss: 0.675 Test Acc: 0.863
Validation loss decreased (-0.829622 --> -0.862956).  Saving model ...
Epoch: 10 cost time: 0.5225999355316162
Epoch: 10, Steps: 2 | Train Loss: 0.511 Vali Loss: 0.589 Vali Acc: 0.870 Test Loss: 0.589 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 11 cost time: 0.5494275093078613
Epoch: 11, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.519 Vali Acc: 0.881 Test Loss: 0.519 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881476).  Saving model ...
Epoch: 12 cost time: 0.6090879440307617
Epoch: 12, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.455 Vali Acc: 0.896 Test Loss: 0.455 Test Acc: 0.896
Validation loss decreased (-0.881476 --> -0.896292).  Saving model ...
Epoch: 13 cost time: 0.5013670921325684
Epoch: 13, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.403 Vali Acc: 0.907 Test Loss: 0.403 Test Acc: 0.907
Validation loss decreased (-0.896292 --> -0.907403).  Saving model ...
Epoch: 14 cost time: 0.5388648509979248
Epoch: 14, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.361 Vali Acc: 0.911 Test Loss: 0.361 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.5182836055755615
Epoch: 15, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.4413919448852539
Epoch: 16, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.302 Vali Acc: 0.919 Test Loss: 0.302 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 17 cost time: 0.4356553554534912
Epoch: 17, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 18 cost time: 0.3994615077972412
Epoch: 18, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.266 Vali Acc: 0.926 Test Loss: 0.266 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 19 cost time: 0.44316554069519043
Epoch: 19, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.48113298416137695
Epoch: 20, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 0.45665502548217773
Epoch: 21, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 22 cost time: 0.4743645191192627
Epoch: 22, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 23 cost time: 0.4507789611816406
Epoch: 23, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 24 cost time: 0.44158005714416504
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.5513968467712402
Epoch: 25, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.5076539516448975
Epoch: 26, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.5450835227966309
Epoch: 27, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.49503588676452637
Epoch: 28, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.5528485774993896
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.5400738716125488
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5209689140319824
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.4601633548736572
Epoch: 32, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5143880844116211
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5869784355163574
Epoch: 34, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.47661900520324707
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4926304817199707
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.47466039657592773
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4548354148864746
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4380161762237549
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 217894
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9731202125549316
Epoch: 1, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.652 Vali Acc: 0.263 Test Loss: 1.652 Test Acc: 0.263
Validation loss decreased (inf --> -0.262946).  Saving model ...
Epoch: 2 cost time: 0.5172817707061768
Epoch: 2, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.549 Vali Acc: 0.467 Test Loss: 1.549 Test Acc: 0.467
Validation loss decreased (-0.262946 --> -0.466651).  Saving model ...
Epoch: 3 cost time: 0.5141360759735107
Epoch: 3, Steps: 2 | Train Loss: 1.457 Vali Loss: 1.453 Vali Acc: 0.596 Test Loss: 1.453 Test Acc: 0.596
Validation loss decreased (-0.466651 --> -0.596282).  Saving model ...
Epoch: 4 cost time: 0.5679538249969482
Epoch: 4, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.331 Vali Acc: 0.659 Test Loss: 1.331 Test Acc: 0.659
Validation loss decreased (-0.596282 --> -0.659246).  Saving model ...
Epoch: 5 cost time: 0.5265944004058838
Epoch: 5, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.192 Vali Acc: 0.693 Test Loss: 1.192 Test Acc: 0.693
Validation loss decreased (-0.659246 --> -0.692581).  Saving model ...
Epoch: 6 cost time: 0.5416433811187744
Epoch: 6, Steps: 2 | Train Loss: 1.070 Vali Loss: 1.053 Vali Acc: 0.711 Test Loss: 1.053 Test Acc: 0.711
Validation loss decreased (-0.692581 --> -0.711101).  Saving model ...
Epoch: 7 cost time: 0.5178005695343018
Epoch: 7, Steps: 2 | Train Loss: 0.990 Vali Loss: 0.926 Vali Acc: 0.726 Test Loss: 0.926 Test Acc: 0.726
Validation loss decreased (-0.711101 --> -0.725917).  Saving model ...
Epoch: 8 cost time: 0.5290894508361816
Epoch: 8, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.814 Vali Acc: 0.744 Test Loss: 0.814 Test Acc: 0.744
Validation loss decreased (-0.725917 --> -0.744436).  Saving model ...
Epoch: 9 cost time: 0.49431753158569336
Epoch: 9, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.721 Vali Acc: 0.774 Test Loss: 0.721 Test Acc: 0.774
Validation loss decreased (-0.744436 --> -0.774067).  Saving model ...
Epoch: 10 cost time: 0.46802735328674316
Epoch: 10, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.647 Vali Acc: 0.804 Test Loss: 0.647 Test Acc: 0.804
Validation loss decreased (-0.774067 --> -0.803697).  Saving model ...
Epoch: 11 cost time: 0.4877128601074219
Epoch: 11, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.587 Vali Acc: 0.822 Test Loss: 0.587 Test Acc: 0.822
Validation loss decreased (-0.803697 --> -0.822216).  Saving model ...
Epoch: 12 cost time: 0.5440292358398438
Epoch: 12, Steps: 2 | Train Loss: 0.397 Vali Loss: 0.535 Vali Acc: 0.830 Test Loss: 0.535 Test Acc: 0.830
Validation loss decreased (-0.822216 --> -0.829624).  Saving model ...
Epoch: 13 cost time: 0.5652906894683838
Epoch: 13, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.494 Vali Acc: 0.841 Test Loss: 0.494 Test Acc: 0.841
Validation loss decreased (-0.829624 --> -0.840736).  Saving model ...
Epoch: 14 cost time: 0.5394301414489746
Epoch: 14, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.461 Vali Acc: 0.837 Test Loss: 0.461 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.6035318374633789
Epoch: 15, Steps: 2 | Train Loss: 0.249 Vali Loss: 0.434 Vali Acc: 0.844 Test Loss: 0.434 Test Acc: 0.844
Validation loss decreased (-0.840736 --> -0.844440).  Saving model ...
Epoch: 16 cost time: 0.4988701343536377
Epoch: 16, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.412 Vali Acc: 0.856 Test Loss: 0.412 Test Acc: 0.856
Validation loss decreased (-0.844440 --> -0.855551).  Saving model ...
Epoch: 17 cost time: 0.522280216217041
Epoch: 17, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.394 Vali Acc: 0.859 Test Loss: 0.394 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 18 cost time: 0.5330121517181396
Epoch: 18, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.379 Vali Acc: 0.863 Test Loss: 0.379 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862959).  Saving model ...
Epoch: 19 cost time: 0.6350500583648682
Epoch: 19, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
Validation loss decreased (-0.862959 --> -0.870367).  Saving model ...
Epoch: 20 cost time: 0.6165487766265869
Epoch: 20, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.352 Vali Acc: 0.870 Test Loss: 0.352 Test Acc: 0.870
Validation loss decreased (-0.870367 --> -0.870367).  Saving model ...
Epoch: 21 cost time: 0.6017189025878906
Epoch: 21, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.340 Vali Acc: 0.881 Test Loss: 0.340 Test Acc: 0.881
Validation loss decreased (-0.870367 --> -0.881478).  Saving model ...
Epoch: 22 cost time: 0.607403039932251
Epoch: 22, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.330 Vali Acc: 0.885 Test Loss: 0.330 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 23 cost time: 0.6271493434906006
Epoch: 23, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.323 Vali Acc: 0.889 Test Loss: 0.323 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888886).  Saving model ...
Epoch: 24 cost time: 0.6548671722412109
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.317 Vali Acc: 0.889 Test Loss: 0.317 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 25 cost time: 0.5921928882598877
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.313 Vali Acc: 0.889 Test Loss: 0.313 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 26 cost time: 0.652712345123291
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.311 Vali Acc: 0.893 Test Loss: 0.311 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892589).  Saving model ...
Epoch: 27 cost time: 0.649982213973999
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.309 Vali Acc: 0.896 Test Loss: 0.309 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 28 cost time: 0.5718436241149902
Epoch: 28, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.307 Vali Acc: 0.900 Test Loss: 0.307 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 29 cost time: 0.5827152729034424
Epoch: 29, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 30 cost time: 0.5460155010223389
Epoch: 30, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.302 Vali Acc: 0.893 Test Loss: 0.302 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5901222229003906
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.301 Vali Acc: 0.885 Test Loss: 0.301 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5823068618774414
Epoch: 32, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.300 Vali Acc: 0.885 Test Loss: 0.300 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.592860221862793
Epoch: 33, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.300 Vali Acc: 0.885 Test Loss: 0.300 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5951869487762451
Epoch: 34, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5731096267700195
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.298 Vali Acc: 0.896 Test Loss: 0.298 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.6181201934814453
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.298 Vali Acc: 0.893 Test Loss: 0.298 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.575669527053833
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.5614478588104248
Epoch: 38, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.5440735816955566
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.300 Vali Acc: 0.893 Test Loss: 0.300 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 217894
model size : 3.28MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.175431728363037
Epoch: 1, Steps: 2 | Train Loss: 1.781 Vali Loss: 1.612 Vali Acc: 0.396 Test Loss: 1.612 Test Acc: 0.396
Validation loss decreased (inf --> -0.396280).  Saving model ...
Epoch: 2 cost time: 0.547684907913208
Epoch: 2, Steps: 2 | Train Loss: 1.578 Vali Loss: 1.508 Vali Acc: 0.444 Test Loss: 1.508 Test Acc: 0.444
Validation loss decreased (-0.396280 --> -0.444429).  Saving model ...
Epoch: 3 cost time: 0.5211873054504395
Epoch: 3, Steps: 2 | Train Loss: 1.553 Vali Loss: 1.407 Vali Acc: 0.519 Test Loss: 1.407 Test Acc: 0.519
Validation loss decreased (-0.444429 --> -0.518504).  Saving model ...
Epoch: 4 cost time: 0.5191800594329834
Epoch: 4, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.282 Vali Acc: 0.578 Test Loss: 1.282 Test Acc: 0.578
Validation loss decreased (-0.518504 --> -0.577765).  Saving model ...
Epoch: 5 cost time: 0.5087237358093262
Epoch: 5, Steps: 2 | Train Loss: 1.219 Vali Loss: 1.135 Vali Acc: 0.648 Test Loss: 1.135 Test Acc: 0.648
Validation loss decreased (-0.577765 --> -0.648137).  Saving model ...
Epoch: 6 cost time: 0.5577495098114014
Epoch: 6, Steps: 2 | Train Loss: 1.001 Vali Loss: 0.986 Vali Acc: 0.726 Test Loss: 0.986 Test Acc: 0.726
Validation loss decreased (-0.648137 --> -0.725916).  Saving model ...
Epoch: 7 cost time: 0.512441873550415
Epoch: 7, Steps: 2 | Train Loss: 0.865 Vali Loss: 0.843 Vali Acc: 0.781 Test Loss: 0.843 Test Acc: 0.781
Validation loss decreased (-0.725916 --> -0.781473).  Saving model ...
Epoch: 8 cost time: 0.48567986488342285
Epoch: 8, Steps: 2 | Train Loss: 0.665 Vali Loss: 0.715 Vali Acc: 0.841 Test Loss: 0.715 Test Acc: 0.841
Validation loss decreased (-0.781473 --> -0.840734).  Saving model ...
Epoch: 9 cost time: 0.6010127067565918
Epoch: 9, Steps: 2 | Train Loss: 0.498 Vali Loss: 0.604 Vali Acc: 0.870 Test Loss: 0.604 Test Acc: 0.870
Validation loss decreased (-0.840734 --> -0.870364).  Saving model ...
Epoch: 10 cost time: 0.5864667892456055
Epoch: 10, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.515 Vali Acc: 0.881 Test Loss: 0.515 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881476).  Saving model ...
Epoch: 11 cost time: 0.4960143566131592
Epoch: 11, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.443 Vali Acc: 0.885 Test Loss: 0.443 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885181).  Saving model ...
Epoch: 12 cost time: 0.5299701690673828
Epoch: 12, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.390 Vali Acc: 0.904 Test Loss: 0.390 Test Acc: 0.904
Validation loss decreased (-0.885181 --> -0.903700).  Saving model ...
Epoch: 13 cost time: 0.563664436340332
Epoch: 13, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.343 Vali Acc: 0.915 Test Loss: 0.343 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.5735571384429932
Epoch: 14, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.305 Vali Acc: 0.926 Test Loss: 0.305 Test Acc: 0.926
Validation loss decreased (-0.914811 --> -0.925923).  Saving model ...
Epoch: 15 cost time: 0.46161961555480957
Epoch: 15, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.276 Vali Acc: 0.926 Test Loss: 0.276 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 16 cost time: 0.5052611827850342
Epoch: 16, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 17 cost time: 0.5153424739837646
Epoch: 17, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 18 cost time: 0.5189764499664307
Epoch: 18, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 19 cost time: 0.5244488716125488
Epoch: 19, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.216 Vali Acc: 0.937 Test Loss: 0.216 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.5641255378723145
Epoch: 20, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5142688751220703
Epoch: 21, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.5027511119842529
Epoch: 22, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.5526401996612549
Epoch: 23, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.511394739151001
Epoch: 24, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.5178687572479248
Epoch: 25, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.4855329990386963
Epoch: 26, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.191 Vali Acc: 0.933 Test Loss: 0.191 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.5444610118865967
Epoch: 27, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.49364542961120605
Epoch: 28, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5098552703857422
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 152358
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.05576229095459
Epoch: 1, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.610 Vali Acc: 0.411 Test Loss: 1.610 Test Acc: 0.411
Validation loss decreased (inf --> -0.411095).  Saving model ...
Epoch: 2 cost time: 0.42251157760620117
Epoch: 2, Steps: 2 | Train Loss: 1.538 Vali Loss: 1.508 Vali Acc: 0.452 Test Loss: 1.508 Test Acc: 0.452
Validation loss decreased (-0.411095 --> -0.451837).  Saving model ...
Epoch: 3 cost time: 0.43472766876220703
Epoch: 3, Steps: 2 | Train Loss: 1.534 Vali Loss: 1.408 Vali Acc: 0.511 Test Loss: 1.408 Test Acc: 0.511
Validation loss decreased (-0.451837 --> -0.511097).  Saving model ...
Epoch: 4 cost time: 0.47299909591674805
Epoch: 4, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.284 Vali Acc: 0.570 Test Loss: 1.284 Test Acc: 0.570
Validation loss decreased (-0.511097 --> -0.570358).  Saving model ...
Epoch: 5 cost time: 0.46935009956359863
Epoch: 5, Steps: 2 | Train Loss: 1.211 Vali Loss: 1.139 Vali Acc: 0.648 Test Loss: 1.139 Test Acc: 0.648
Validation loss decreased (-0.570358 --> -0.648137).  Saving model ...
Epoch: 6 cost time: 0.4978053569793701
Epoch: 6, Steps: 2 | Train Loss: 1.010 Vali Loss: 0.991 Vali Acc: 0.759 Test Loss: 0.991 Test Acc: 0.759
Validation loss decreased (-0.648137 --> -0.759249).  Saving model ...
Epoch: 7 cost time: 0.5314540863037109
Epoch: 7, Steps: 2 | Train Loss: 0.846 Vali Loss: 0.851 Vali Acc: 0.800 Test Loss: 0.851 Test Acc: 0.800
Validation loss decreased (-0.759249 --> -0.799991).  Saving model ...
Epoch: 8 cost time: 0.46122145652770996
Epoch: 8, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.724 Vali Acc: 0.826 Test Loss: 0.724 Test Acc: 0.826
Validation loss decreased (-0.799991 --> -0.825919).  Saving model ...
Epoch: 9 cost time: 0.4529752731323242
Epoch: 9, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.614 Vali Acc: 0.863 Test Loss: 0.614 Test Acc: 0.863
Validation loss decreased (-0.825919 --> -0.862957).  Saving model ...
Epoch: 10 cost time: 0.47709131240844727
Epoch: 10, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.527 Vali Acc: 0.874 Test Loss: 0.527 Test Acc: 0.874
Validation loss decreased (-0.862957 --> -0.874069).  Saving model ...
Epoch: 11 cost time: 0.475757360458374
Epoch: 11, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.456 Vali Acc: 0.885 Test Loss: 0.456 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885181).  Saving model ...
Epoch: 12 cost time: 0.473247766494751
Epoch: 12, Steps: 2 | Train Loss: 0.261 Vali Loss: 0.403 Vali Acc: 0.893 Test Loss: 0.403 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 13 cost time: 0.5143885612487793
Epoch: 13, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.356 Vali Acc: 0.907 Test Loss: 0.356 Test Acc: 0.907
Validation loss decreased (-0.892589 --> -0.907404).  Saving model ...
Epoch: 14 cost time: 0.48242807388305664
Epoch: 14, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.318 Vali Acc: 0.911 Test Loss: 0.318 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 15 cost time: 0.49029994010925293
Epoch: 15, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.288 Vali Acc: 0.915 Test Loss: 0.288 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 16 cost time: 0.4841122627258301
Epoch: 16, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.919 Test Loss: 0.265 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 17 cost time: 0.42375636100769043
Epoch: 17, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 18 cost time: 0.4815633296966553
Epoch: 18, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 19 cost time: 0.5007121562957764
Epoch: 19, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 20 cost time: 0.5679135322570801
Epoch: 20, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 21 cost time: 0.49314069747924805
Epoch: 21, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 22 cost time: 0.5286743640899658
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 23 cost time: 0.4939243793487549
Epoch: 23, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 24 cost time: 0.44934821128845215
Epoch: 24, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.43014073371887207
Epoch: 25, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5077168941497803
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.43615126609802246
Epoch: 27, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.4237639904022217
Epoch: 28, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.4125251770019531
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.43727540969848633
Epoch: 30, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4306783676147461
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 32 cost time: 0.42455267906188965
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.198 Vali Acc: 0.930 Test Loss: 0.198 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4908900260925293
Epoch: 33, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.45954036712646484
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5242679119110107
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.5027868747711182
Epoch: 36, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.47763895988464355
Epoch: 37, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5705437660217285
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5075404644012451
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4875800609588623
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.45377206802368164
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.46591687202453613
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.4766356945037842
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 152358
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0895676612854004
Epoch: 1, Steps: 2 | Train Loss: 1.749 Vali Loss: 1.616 Vali Acc: 0.407 Test Loss: 1.616 Test Acc: 0.407
Validation loss decreased (inf --> -0.407391).  Saving model ...
Epoch: 2 cost time: 0.4573848247528076
Epoch: 2, Steps: 2 | Train Loss: 1.505 Vali Loss: 1.517 Vali Acc: 0.478 Test Loss: 1.517 Test Acc: 0.478
Validation loss decreased (-0.407391 --> -0.477763).  Saving model ...
Epoch: 3 cost time: 0.45012378692626953
Epoch: 3, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.420 Vali Acc: 0.515 Test Loss: 1.420 Test Acc: 0.515
Validation loss decreased (-0.477763 --> -0.514801).  Saving model ...
Epoch: 4 cost time: 0.4387836456298828
Epoch: 4, Steps: 2 | Train Loss: 1.408 Vali Loss: 1.299 Vali Acc: 0.570 Test Loss: 1.299 Test Acc: 0.570
Validation loss decreased (-0.514801 --> -0.570357).  Saving model ...
Epoch: 5 cost time: 0.4506547451019287
Epoch: 5, Steps: 2 | Train Loss: 1.225 Vali Loss: 1.158 Vali Acc: 0.648 Test Loss: 1.158 Test Acc: 0.648
Validation loss decreased (-0.570357 --> -0.648137).  Saving model ...
Epoch: 6 cost time: 0.5286195278167725
Epoch: 6, Steps: 2 | Train Loss: 1.031 Vali Loss: 1.015 Vali Acc: 0.726 Test Loss: 1.015 Test Acc: 0.726
Validation loss decreased (-0.648137 --> -0.725916).  Saving model ...
Epoch: 7 cost time: 0.4647958278656006
Epoch: 7, Steps: 2 | Train Loss: 0.861 Vali Loss: 0.877 Vali Acc: 0.767 Test Loss: 0.877 Test Acc: 0.767
Validation loss decreased (-0.725916 --> -0.766658).  Saving model ...
Epoch: 8 cost time: 0.5225121974945068
Epoch: 8, Steps: 2 | Train Loss: 0.663 Vali Loss: 0.754 Vali Acc: 0.819 Test Loss: 0.754 Test Acc: 0.819
Validation loss decreased (-0.766658 --> -0.818511).  Saving model ...
Epoch: 9 cost time: 0.5339956283569336
Epoch: 9, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.647 Vali Acc: 0.844 Test Loss: 0.647 Test Acc: 0.844
Validation loss decreased (-0.818511 --> -0.844438).  Saving model ...
Epoch: 10 cost time: 0.4814305305480957
Epoch: 10, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.562 Vali Acc: 0.863 Test Loss: 0.562 Test Acc: 0.863
Validation loss decreased (-0.844438 --> -0.862957).  Saving model ...
Epoch: 11 cost time: 0.5099751949310303
Epoch: 11, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877773).  Saving model ...
Epoch: 12 cost time: 0.5528769493103027
Epoch: 12, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.441 Vali Acc: 0.881 Test Loss: 0.441 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 13 cost time: 0.5369279384613037
Epoch: 13, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.394 Vali Acc: 0.893 Test Loss: 0.394 Test Acc: 0.893
Validation loss decreased (-0.881477 --> -0.892589).  Saving model ...
Epoch: 14 cost time: 0.5744845867156982
Epoch: 14, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.355 Vali Acc: 0.907 Test Loss: 0.355 Test Acc: 0.907
Validation loss decreased (-0.892589 --> -0.907404).  Saving model ...
Epoch: 15 cost time: 0.49962425231933594
Epoch: 15, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.325 Vali Acc: 0.907 Test Loss: 0.325 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 16 cost time: 0.48316383361816406
Epoch: 16, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.301 Vali Acc: 0.907 Test Loss: 0.301 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 17 cost time: 0.49236083030700684
Epoch: 17, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.283 Vali Acc: 0.904 Test Loss: 0.283 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5646774768829346
Epoch: 18, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.269 Vali Acc: 0.907 Test Loss: 0.269 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907405).  Saving model ...
Epoch: 19 cost time: 0.5118763446807861
Epoch: 19, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.259 Vali Acc: 0.907 Test Loss: 0.259 Test Acc: 0.907
Validation loss decreased (-0.907405 --> -0.907405).  Saving model ...
Epoch: 20 cost time: 0.5197551250457764
Epoch: 20, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.251 Vali Acc: 0.911 Test Loss: 0.251 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911109).  Saving model ...
Epoch: 21 cost time: 0.5314998626708984
Epoch: 21, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914812).  Saving model ...
Epoch: 22 cost time: 0.47457432746887207
Epoch: 22, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.241 Vali Acc: 0.915 Test Loss: 0.241 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 23 cost time: 0.4350850582122803
Epoch: 23, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.238 Vali Acc: 0.915 Test Loss: 0.238 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.5475504398345947
Epoch: 24, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.235 Vali Acc: 0.911 Test Loss: 0.235 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.5259833335876465
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5353083610534668
Epoch: 26, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.232 Vali Acc: 0.915 Test Loss: 0.232 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.491574764251709
Epoch: 27, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914813).  Saving model ...
Epoch: 28 cost time: 0.46083545684814453
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.229 Vali Acc: 0.915 Test Loss: 0.229 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 29 cost time: 0.5179758071899414
Epoch: 29, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.915 Test Loss: 0.229 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 30 cost time: 0.5767407417297363
Epoch: 30, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.5489699840545654
Epoch: 31, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5450799465179443
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.911 Test Loss: 0.228 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5498356819152832
Epoch: 33, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.227 Vali Acc: 0.911 Test Loss: 0.227 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5873978137969971
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 35 cost time: 0.5636892318725586
Epoch: 35, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.915 Test Loss: 0.226 Test Acc: 0.915
Validation loss decreased (-0.914813 --> -0.914813).  Saving model ...
Epoch: 36 cost time: 0.5318071842193604
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.914813 --> -0.918516).  Saving model ...
Epoch: 37 cost time: 0.5252790451049805
Epoch: 37, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 38 cost time: 0.5543074607849121
Epoch: 38, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.4859614372253418
Epoch: 39, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.226 Vali Acc: 0.919 Test Loss: 0.226 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.5189251899719238
Epoch: 40, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.226 Vali Acc: 0.915 Test Loss: 0.226 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5592985153198242
Epoch: 41, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5404477119445801
Epoch: 42, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5296492576599121
Epoch: 43, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4684455394744873
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.6029088497161865
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.46516942977905273
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5035016536712646
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5330009460449219
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.226 Vali Acc: 0.915 Test Loss: 0.226 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4952507019042969
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.226 Vali Acc: 0.915 Test Loss: 0.226 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 152358
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.11676025390625
Epoch: 1, Steps: 2 | Train Loss: 1.750 Vali Loss: 1.605 Vali Acc: 0.404 Test Loss: 1.605 Test Acc: 0.404
Validation loss decreased (inf --> -0.403688).  Saving model ...
Epoch: 2 cost time: 0.5007822513580322
Epoch: 2, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.515 Vali Acc: 0.470 Test Loss: 1.515 Test Acc: 0.470
Validation loss decreased (-0.403688 --> -0.470355).  Saving model ...
Epoch: 3 cost time: 0.5033082962036133
Epoch: 3, Steps: 2 | Train Loss: 1.576 Vali Loss: 1.428 Vali Acc: 0.496 Test Loss: 1.428 Test Acc: 0.496
Validation loss decreased (-0.470355 --> -0.496282).  Saving model ...
Epoch: 4 cost time: 0.5029408931732178
Epoch: 4, Steps: 2 | Train Loss: 1.460 Vali Loss: 1.320 Vali Acc: 0.533 Test Loss: 1.320 Test Acc: 0.533
Validation loss decreased (-0.496282 --> -0.533320).  Saving model ...
Epoch: 5 cost time: 0.5213413238525391
Epoch: 5, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.193 Vali Acc: 0.570 Test Loss: 1.193 Test Acc: 0.570
Validation loss decreased (-0.533320 --> -0.570358).  Saving model ...
Epoch: 6 cost time: 0.5234055519104004
Epoch: 6, Steps: 2 | Train Loss: 1.165 Vali Loss: 1.063 Vali Acc: 0.674 Test Loss: 1.063 Test Acc: 0.674
Validation loss decreased (-0.570358 --> -0.674063).  Saving model ...
Epoch: 7 cost time: 0.4523580074310303
Epoch: 7, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.939 Vali Acc: 0.756 Test Loss: 0.939 Test Acc: 0.756
Validation loss decreased (-0.674063 --> -0.755546).  Saving model ...
Epoch: 8 cost time: 0.4755837917327881
Epoch: 8, Steps: 2 | Train Loss: 0.826 Vali Loss: 0.827 Vali Acc: 0.789 Test Loss: 0.827 Test Acc: 0.789
Validation loss decreased (-0.755546 --> -0.788881).  Saving model ...
Epoch: 9 cost time: 0.620187520980835
Epoch: 9, Steps: 2 | Train Loss: 0.702 Vali Loss: 0.729 Vali Acc: 0.815 Test Loss: 0.729 Test Acc: 0.815
Validation loss decreased (-0.788881 --> -0.814808).  Saving model ...
Epoch: 10 cost time: 0.528508186340332
Epoch: 10, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.648 Vali Acc: 0.822 Test Loss: 0.648 Test Acc: 0.822
Validation loss decreased (-0.814808 --> -0.822216).  Saving model ...
Epoch: 11 cost time: 0.4957847595214844
Epoch: 11, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
Validation loss decreased (-0.822216 --> -0.844439).  Saving model ...
Epoch: 12 cost time: 0.4549386501312256
Epoch: 12, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.532 Vali Acc: 0.856 Test Loss: 0.532 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 13 cost time: 0.4243950843811035
Epoch: 13, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.488 Vali Acc: 0.863 Test Loss: 0.488 Test Acc: 0.863
Validation loss decreased (-0.855550 --> -0.862958).  Saving model ...
Epoch: 14 cost time: 0.4059128761291504
Epoch: 14, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.453 Vali Acc: 0.878 Test Loss: 0.453 Test Acc: 0.878
Validation loss decreased (-0.862958 --> -0.877773).  Saving model ...
Epoch: 15 cost time: 0.4333150386810303
Epoch: 15, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
Validation loss decreased (-0.877773 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.4437119960784912
Epoch: 16, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.397 Vali Acc: 0.896 Test Loss: 0.397 Test Acc: 0.896
Validation loss decreased (-0.888885 --> -0.896292).  Saving model ...
Epoch: 17 cost time: 0.45651793479919434
Epoch: 17, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.378 Vali Acc: 0.893 Test Loss: 0.378 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4280409812927246
Epoch: 18, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.362 Vali Acc: 0.893 Test Loss: 0.362 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 0.4305531978607178
Epoch: 19, Steps: 2 | Train Loss: 0.182 Vali Loss: 0.350 Vali Acc: 0.893 Test Loss: 0.350 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 0.3834540843963623
Epoch: 20, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.341 Vali Acc: 0.893 Test Loss: 0.341 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 0.471235990524292
Epoch: 21, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.334 Vali Acc: 0.885 Test Loss: 0.334 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 0.4926316738128662
Epoch: 22, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.327 Vali Acc: 0.893 Test Loss: 0.327 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 0.5305008888244629
Epoch: 23, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.322 Vali Acc: 0.900 Test Loss: 0.322 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899997).  Saving model ...
Epoch: 24 cost time: 0.48516345024108887
Epoch: 24, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.317 Vali Acc: 0.900 Test Loss: 0.317 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.4973905086517334
Epoch: 25, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.312 Vali Acc: 0.896 Test Loss: 0.312 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.543907642364502
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.308 Vali Acc: 0.904 Test Loss: 0.308 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 27 cost time: 0.5555808544158936
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5422134399414062
Epoch: 28, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.300 Vali Acc: 0.896 Test Loss: 0.300 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.548551082611084
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.889 Test Loss: 0.298 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5228962898254395
Epoch: 30, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5129144191741943
Epoch: 31, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.294 Vali Acc: 0.889 Test Loss: 0.294 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.499056339263916
Epoch: 32, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.5406181812286377
Epoch: 33, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.5951411724090576
Epoch: 34, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.293 Vali Acc: 0.896 Test Loss: 0.293 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.582289457321167
Epoch: 35, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4714393615722656
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.293 Vali Acc: 0.904 Test Loss: 0.293 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 37 cost time: 0.4914419651031494
Epoch: 37, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.896 Test Loss: 0.292 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5229775905609131
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5730831623077393
Epoch: 39, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5532543659210205
Epoch: 40, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.295 Vali Acc: 0.885 Test Loss: 0.295 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5134842395782471
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.297 Vali Acc: 0.881 Test Loss: 0.297 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.505894660949707
Epoch: 42, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.297 Vali Acc: 0.881 Test Loss: 0.297 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.5077114105224609
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.295 Vali Acc: 0.885 Test Loss: 0.295 Test Acc: 0.885
EarlyStopping counter: 7 out of 10
Epoch: 44 cost time: 0.4909939765930176
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.292 Vali Acc: 0.889 Test Loss: 0.292 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 45 cost time: 0.5390751361846924
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.291 Vali Acc: 0.889 Test Loss: 0.291 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 46 cost time: 0.5402369499206543
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.290 Vali Acc: 0.893 Test Loss: 0.290 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 152358
model size : 3.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1060948371887207
Epoch: 1, Steps: 2 | Train Loss: 1.638 Vali Loss: 1.528 Vali Acc: 0.452 Test Loss: 1.528 Test Acc: 0.452
Validation loss decreased (inf --> -0.451837).  Saving model ...
Epoch: 2 cost time: 0.6094610691070557
Epoch: 2, Steps: 2 | Train Loss: 1.543 Vali Loss: 1.435 Vali Acc: 0.544 Test Loss: 1.435 Test Acc: 0.544
Validation loss decreased (-0.451837 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.6515083312988281
Epoch: 3, Steps: 2 | Train Loss: 1.383 Vali Loss: 1.342 Vali Acc: 0.615 Test Loss: 1.342 Test Acc: 0.615
Validation loss decreased (-0.544430 --> -0.614801).  Saving model ...
Epoch: 4 cost time: 0.557642936706543
Epoch: 4, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.218 Vali Acc: 0.707 Test Loss: 1.218 Test Acc: 0.707
Validation loss decreased (-0.614801 --> -0.707395).  Saving model ...
Epoch: 5 cost time: 0.5395524501800537
Epoch: 5, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.073 Vali Acc: 0.811 Test Loss: 1.073 Test Acc: 0.811
Validation loss decreased (-0.707395 --> -0.811100).  Saving model ...
Epoch: 6 cost time: 0.5452024936676025
Epoch: 6, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.925 Vali Acc: 0.841 Test Loss: 0.925 Test Acc: 0.841
Validation loss decreased (-0.811100 --> -0.840731).  Saving model ...
Epoch: 7 cost time: 0.5818579196929932
Epoch: 7, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.788 Vali Acc: 0.870 Test Loss: 0.788 Test Acc: 0.870
Validation loss decreased (-0.840731 --> -0.870362).  Saving model ...
Epoch: 8 cost time: 0.4674072265625
Epoch: 8, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.664 Vali Acc: 0.904 Test Loss: 0.664 Test Acc: 0.904
Validation loss decreased (-0.870362 --> -0.903697).  Saving model ...
Epoch: 9 cost time: 0.4999217987060547
Epoch: 9, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.560 Vali Acc: 0.919 Test Loss: 0.560 Test Acc: 0.919
Validation loss decreased (-0.903697 --> -0.918513).  Saving model ...
Epoch: 10 cost time: 0.49340224266052246
Epoch: 10, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.475 Vali Acc: 0.930 Test Loss: 0.475 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929625).  Saving model ...
Epoch: 11 cost time: 0.49111199378967285
Epoch: 11, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.406 Vali Acc: 0.930 Test Loss: 0.406 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929626).  Saving model ...
Epoch: 12 cost time: 0.49326276779174805
Epoch: 12, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.350 Vali Acc: 0.941 Test Loss: 0.350 Test Acc: 0.941
Validation loss decreased (-0.929626 --> -0.940737).  Saving model ...
Epoch: 13 cost time: 0.4753379821777344
Epoch: 13, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.305 Vali Acc: 0.944 Test Loss: 0.305 Test Acc: 0.944
Validation loss decreased (-0.940737 --> -0.944441).  Saving model ...
Epoch: 14 cost time: 0.49837398529052734
Epoch: 14, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.271 Vali Acc: 0.956 Test Loss: 0.271 Test Acc: 0.956
Validation loss decreased (-0.944441 --> -0.955553).  Saving model ...
Epoch: 15 cost time: 0.4680469036102295
Epoch: 15, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.247 Vali Acc: 0.948 Test Loss: 0.247 Test Acc: 0.948
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.49452757835388184
Epoch: 16, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.232 Vali Acc: 0.948 Test Loss: 0.232 Test Acc: 0.948
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.5085403919219971
Epoch: 17, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.218 Vali Acc: 0.948 Test Loss: 0.218 Test Acc: 0.948
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5518643856048584
Epoch: 18, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.202 Vali Acc: 0.948 Test Loss: 0.202 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5487334728240967
Epoch: 19, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.190 Vali Acc: 0.952 Test Loss: 0.190 Test Acc: 0.952
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5407631397247314
Epoch: 20, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.180 Vali Acc: 0.952 Test Loss: 0.180 Test Acc: 0.952
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5453155040740967
Epoch: 21, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.174 Vali Acc: 0.952 Test Loss: 0.174 Test Acc: 0.952
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 0.5702846050262451
Epoch: 22, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 0.5464620590209961
Epoch: 23, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.166 Vali Acc: 0.952 Test Loss: 0.166 Test Acc: 0.952
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 0.5340633392333984
Epoch: 24, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.164 Vali Acc: 0.952 Test Loss: 0.164 Test Acc: 0.952
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 119590
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.075561285018921
Epoch: 1, Steps: 2 | Train Loss: 1.656 Vali Loss: 1.533 Vali Acc: 0.459 Test Loss: 1.533 Test Acc: 0.459
Validation loss decreased (inf --> -0.459244).  Saving model ...
Epoch: 2 cost time: 0.5104365348815918
Epoch: 2, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.440 Vali Acc: 0.581 Test Loss: 1.440 Test Acc: 0.581
Validation loss decreased (-0.459244 --> -0.581467).  Saving model ...
Epoch: 3 cost time: 0.44808459281921387
Epoch: 3, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.348 Vali Acc: 0.656 Test Loss: 1.348 Test Acc: 0.656
Validation loss decreased (-0.581467 --> -0.655542).  Saving model ...
Epoch: 4 cost time: 0.45717334747314453
Epoch: 4, Steps: 2 | Train Loss: 1.328 Vali Loss: 1.224 Vali Acc: 0.733 Test Loss: 1.224 Test Acc: 0.733
Validation loss decreased (-0.655542 --> -0.733321).  Saving model ...
Epoch: 5 cost time: 0.47742533683776855
Epoch: 5, Steps: 2 | Train Loss: 1.150 Vali Loss: 1.080 Vali Acc: 0.800 Test Loss: 1.080 Test Acc: 0.800
Validation loss decreased (-0.733321 --> -0.799989).  Saving model ...
Epoch: 6 cost time: 0.476060152053833
Epoch: 6, Steps: 2 | Train Loss: 0.954 Vali Loss: 0.932 Vali Acc: 0.856 Test Loss: 0.932 Test Acc: 0.856
Validation loss decreased (-0.799989 --> -0.855546).  Saving model ...
Epoch: 7 cost time: 0.506359338760376
Epoch: 7, Steps: 2 | Train Loss: 0.805 Vali Loss: 0.794 Vali Acc: 0.878 Test Loss: 0.794 Test Acc: 0.878
Validation loss decreased (-0.855546 --> -0.877770).  Saving model ...
Epoch: 8 cost time: 0.48979902267456055
Epoch: 8, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.670 Vali Acc: 0.915 Test Loss: 0.670 Test Acc: 0.915
Validation loss decreased (-0.877770 --> -0.914808).  Saving model ...
Epoch: 9 cost time: 0.4759407043457031
Epoch: 9, Steps: 2 | Train Loss: 0.487 Vali Loss: 0.567 Vali Acc: 0.926 Test Loss: 0.567 Test Acc: 0.926
Validation loss decreased (-0.914808 --> -0.925920).  Saving model ...
Epoch: 10 cost time: 0.45101499557495117
Epoch: 10, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.482 Vali Acc: 0.930 Test Loss: 0.482 Test Acc: 0.930
Validation loss decreased (-0.925920 --> -0.929625).  Saving model ...
Epoch: 11 cost time: 0.4642364978790283
Epoch: 11, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.414 Vali Acc: 0.933 Test Loss: 0.414 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 12 cost time: 0.4727182388305664
Epoch: 12, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.358 Vali Acc: 0.937 Test Loss: 0.358 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 13 cost time: 0.5204610824584961
Epoch: 13, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.313 Vali Acc: 0.948 Test Loss: 0.313 Test Acc: 0.948
Validation loss decreased (-0.937033 --> -0.948145).  Saving model ...
Epoch: 14 cost time: 0.5072824954986572
Epoch: 14, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.278 Vali Acc: 0.948 Test Loss: 0.278 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948145).  Saving model ...
Epoch: 15 cost time: 0.4487447738647461
Epoch: 15, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.253 Vali Acc: 0.941 Test Loss: 0.253 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.5055625438690186
Epoch: 16, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 0.515167236328125
Epoch: 17, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.219 Vali Acc: 0.941 Test Loss: 0.219 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 0.5482139587402344
Epoch: 18, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 0.5814080238342285
Epoch: 19, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 0.5242815017700195
Epoch: 20, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.187 Vali Acc: 0.944 Test Loss: 0.187 Test Acc: 0.944
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 0.5831935405731201
Epoch: 21, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.181 Vali Acc: 0.948 Test Loss: 0.181 Test Acc: 0.948
Validation loss decreased (-0.948145 --> -0.948146).  Saving model ...
Epoch: 22 cost time: 0.5464327335357666
Epoch: 22, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.176 Vali Acc: 0.956 Test Loss: 0.176 Test Acc: 0.956
Validation loss decreased (-0.948146 --> -0.955554).  Saving model ...
Epoch: 23 cost time: 0.5865416526794434
Epoch: 23, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.173 Vali Acc: 0.952 Test Loss: 0.173 Test Acc: 0.952
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5847282409667969
Epoch: 24, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.171 Vali Acc: 0.952 Test Loss: 0.171 Test Acc: 0.952
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.650754451751709
Epoch: 25, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.170 Vali Acc: 0.952 Test Loss: 0.170 Test Acc: 0.952
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.5971593856811523
Epoch: 26, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.5094339847564697
Epoch: 27, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.5226955413818359
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.49161314964294434
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.169 Vali Acc: 0.948 Test Loss: 0.169 Test Acc: 0.948
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.4794774055480957
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.5164916515350342
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 0.481914758682251
Epoch: 32, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.948 Test Loss: 0.168 Test Acc: 0.948
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9555555555555556
model parameter : 119590
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.3110673427581787
Epoch: 1, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.556 Vali Acc: 0.430 Test Loss: 1.556 Test Acc: 0.430
Validation loss decreased (inf --> -0.429614).  Saving model ...
Epoch: 2 cost time: 0.5290155410766602
Epoch: 2, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.464 Vali Acc: 0.544 Test Loss: 1.464 Test Acc: 0.544
Validation loss decreased (-0.429614 --> -0.544430).  Saving model ...
Epoch: 3 cost time: 0.5453813076019287
Epoch: 3, Steps: 2 | Train Loss: 1.445 Vali Loss: 1.374 Vali Acc: 0.626 Test Loss: 1.374 Test Acc: 0.626
Validation loss decreased (-0.544430 --> -0.625912).  Saving model ...
Epoch: 4 cost time: 0.5554144382476807
Epoch: 4, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.254 Vali Acc: 0.685 Test Loss: 1.254 Test Acc: 0.685
Validation loss decreased (-0.625912 --> -0.685173).  Saving model ...
Epoch: 5 cost time: 0.5618994235992432
Epoch: 5, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.113 Vali Acc: 0.752 Test Loss: 1.113 Test Acc: 0.752
Validation loss decreased (-0.685173 --> -0.751841).  Saving model ...
Epoch: 6 cost time: 0.5235176086425781
Epoch: 6, Steps: 2 | Train Loss: 1.013 Vali Loss: 0.968 Vali Acc: 0.811 Test Loss: 0.968 Test Acc: 0.811
Validation loss decreased (-0.751841 --> -0.811101).  Saving model ...
Epoch: 7 cost time: 0.5168368816375732
Epoch: 7, Steps: 2 | Train Loss: 0.839 Vali Loss: 0.832 Vali Acc: 0.837 Test Loss: 0.832 Test Acc: 0.837
Validation loss decreased (-0.811101 --> -0.837029).  Saving model ...
Epoch: 8 cost time: 0.5330750942230225
Epoch: 8, Steps: 2 | Train Loss: 0.659 Vali Loss: 0.710 Vali Acc: 0.867 Test Loss: 0.710 Test Acc: 0.867
Validation loss decreased (-0.837029 --> -0.866660).  Saving model ...
Epoch: 9 cost time: 0.4842846393585205
Epoch: 9, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.608 Vali Acc: 0.889 Test Loss: 0.608 Test Acc: 0.889
Validation loss decreased (-0.866660 --> -0.888883).  Saving model ...
Epoch: 10 cost time: 0.5629580020904541
Epoch: 10, Steps: 2 | Train Loss: 0.452 Vali Loss: 0.523 Vali Acc: 0.904 Test Loss: 0.523 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 11 cost time: 0.4913618564605713
Epoch: 11, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.456 Vali Acc: 0.919 Test Loss: 0.456 Test Acc: 0.919
Validation loss decreased (-0.903698 --> -0.918514).  Saving model ...
Epoch: 12 cost time: 0.5000925064086914
Epoch: 12, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.400 Vali Acc: 0.930 Test Loss: 0.400 Test Acc: 0.930
Validation loss decreased (-0.918514 --> -0.929626).  Saving model ...
Epoch: 13 cost time: 0.49102091789245605
Epoch: 13, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.355 Vali Acc: 0.930 Test Loss: 0.355 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 14 cost time: 0.5151491165161133
Epoch: 14, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.318 Vali Acc: 0.937 Test Loss: 0.318 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 15 cost time: 0.5139584541320801
Epoch: 15, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.290 Vali Acc: 0.944 Test Loss: 0.290 Test Acc: 0.944
Validation loss decreased (-0.937034 --> -0.944442).  Saving model ...
Epoch: 16 cost time: 0.5180208683013916
Epoch: 16, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.269 Vali Acc: 0.937 Test Loss: 0.269 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.4748232364654541
Epoch: 17, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.251 Vali Acc: 0.933 Test Loss: 0.251 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.46643567085266113
Epoch: 18, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.4596574306488037
Epoch: 19, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 0.5247855186462402
Epoch: 20, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 0.4890727996826172
Epoch: 21, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 0.4701087474822998
Epoch: 22, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 0.49362730979919434
Epoch: 23, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 0.494556188583374
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 0.5306808948516846
Epoch: 25, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 119590
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0517430305480957
Epoch: 1, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.573 Vali Acc: 0.363 Test Loss: 1.573 Test Acc: 0.363
Validation loss decreased (inf --> -0.362947).  Saving model ...
Epoch: 2 cost time: 0.5492401123046875
Epoch: 2, Steps: 2 | Train Loss: 1.626 Vali Loss: 1.486 Vali Acc: 0.493 Test Loss: 1.486 Test Acc: 0.493
Validation loss decreased (-0.362947 --> -0.492578).  Saving model ...
Epoch: 3 cost time: 0.5240011215209961
Epoch: 3, Steps: 2 | Train Loss: 1.476 Vali Loss: 1.402 Vali Acc: 0.578 Test Loss: 1.402 Test Acc: 0.578
Validation loss decreased (-0.492578 --> -0.577764).  Saving model ...
Epoch: 4 cost time: 0.5320155620574951
Epoch: 4, Steps: 2 | Train Loss: 1.369 Vali Loss: 1.291 Vali Acc: 0.648 Test Loss: 1.291 Test Acc: 0.648
Validation loss decreased (-0.577764 --> -0.648135).  Saving model ...
Epoch: 5 cost time: 0.5414524078369141
Epoch: 5, Steps: 2 | Train Loss: 1.233 Vali Loss: 1.162 Vali Acc: 0.707 Test Loss: 1.162 Test Acc: 0.707
Validation loss decreased (-0.648135 --> -0.707396).  Saving model ...
Epoch: 6 cost time: 0.4720909595489502
Epoch: 6, Steps: 2 | Train Loss: 1.089 Vali Loss: 1.028 Vali Acc: 0.737 Test Loss: 1.028 Test Acc: 0.737
Validation loss decreased (-0.707396 --> -0.737027).  Saving model ...
Epoch: 7 cost time: 0.48952651023864746
Epoch: 7, Steps: 2 | Train Loss: 0.888 Vali Loss: 0.904 Vali Acc: 0.763 Test Loss: 0.904 Test Acc: 0.763
Validation loss decreased (-0.737027 --> -0.762954).  Saving model ...
Epoch: 8 cost time: 0.5161843299865723
Epoch: 8, Steps: 2 | Train Loss: 0.779 Vali Loss: 0.794 Vali Acc: 0.815 Test Loss: 0.794 Test Acc: 0.815
Validation loss decreased (-0.762954 --> -0.814807).  Saving model ...
Epoch: 9 cost time: 0.45574426651000977
Epoch: 9, Steps: 2 | Train Loss: 0.653 Vali Loss: 0.702 Vali Acc: 0.833 Test Loss: 0.702 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 10 cost time: 0.4434959888458252
Epoch: 10, Steps: 2 | Train Loss: 0.580 Vali Loss: 0.626 Vali Acc: 0.848 Test Loss: 0.626 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.848142).  Saving model ...
Epoch: 11 cost time: 0.48531031608581543
Epoch: 11, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.565 Vali Acc: 0.870 Test Loss: 0.565 Test Acc: 0.870
Validation loss decreased (-0.848142 --> -0.870365).  Saving model ...
Epoch: 12 cost time: 0.44571495056152344
Epoch: 12, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.514 Vali Acc: 0.878 Test Loss: 0.514 Test Acc: 0.878
Validation loss decreased (-0.870365 --> -0.877773).  Saving model ...
Epoch: 13 cost time: 0.4325394630432129
Epoch: 13, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.471 Vali Acc: 0.881 Test Loss: 0.471 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 14 cost time: 0.47730112075805664
Epoch: 14, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.437 Vali Acc: 0.885 Test Loss: 0.437 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 15 cost time: 0.4925391674041748
Epoch: 15, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.408 Vali Acc: 0.889 Test Loss: 0.408 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 16 cost time: 0.48502254486083984
Epoch: 16, Steps: 2 | Train Loss: 0.209 Vali Loss: 0.385 Vali Acc: 0.893 Test Loss: 0.385 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 17 cost time: 0.5114367008209229
Epoch: 17, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.365 Vali Acc: 0.896 Test Loss: 0.365 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 18 cost time: 0.49273252487182617
Epoch: 18, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.349 Vali Acc: 0.896 Test Loss: 0.349 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 19 cost time: 0.5037150382995605
Epoch: 19, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.336 Vali Acc: 0.893 Test Loss: 0.336 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.5397706031799316
Epoch: 20, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.325 Vali Acc: 0.896 Test Loss: 0.325 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 21 cost time: 0.516690731048584
Epoch: 21, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.317 Vali Acc: 0.896 Test Loss: 0.317 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 22 cost time: 0.5107626914978027
Epoch: 22, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.309 Vali Acc: 0.900 Test Loss: 0.309 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 23 cost time: 0.5404272079467773
Epoch: 23, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.303 Vali Acc: 0.896 Test Loss: 0.303 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.5299205780029297
Epoch: 24, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.4812610149383545
Epoch: 25, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 26 cost time: 0.5345079898834229
Epoch: 26, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.289 Vali Acc: 0.900 Test Loss: 0.289 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 27 cost time: 0.5179898738861084
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.286 Vali Acc: 0.896 Test Loss: 0.286 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5273098945617676
Epoch: 28, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.283 Vali Acc: 0.896 Test Loss: 0.283 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5500345230102539
Epoch: 29, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.282 Vali Acc: 0.896 Test Loss: 0.282 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.5544788837432861
Epoch: 30, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.280 Vali Acc: 0.896 Test Loss: 0.280 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.5252895355224609
Epoch: 31, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 32 cost time: 0.5167040824890137
Epoch: 32, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 33 cost time: 0.5201008319854736
Epoch: 33, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 34 cost time: 0.5043926239013672
Epoch: 34, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.47998547554016113
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.893 Test Loss: 0.279 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4431169033050537
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.279 Vali Acc: 0.893 Test Loss: 0.279 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.47855687141418457
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.279 Vali Acc: 0.893 Test Loss: 0.279 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4874553680419922
Epoch: 38, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.279 Vali Acc: 0.893 Test Loss: 0.279 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.5763099193572998
Epoch: 39, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.4384338855743408
Epoch: 40, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.278 Vali Acc: 0.896 Test Loss: 0.278 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.4699282646179199
Epoch: 41, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 0.5214970111846924
Epoch: 42, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 0.4361755847930908
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 0.488170862197876
Epoch: 44, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.277 Vali Acc: 0.900 Test Loss: 0.277 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5483231544494629
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5093462467193604
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.278 Vali Acc: 0.900 Test Loss: 0.278 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5538923740386963
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5084044933319092
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.280 Vali Acc: 0.896 Test Loss: 0.280 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.564429521560669
Epoch: 49, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.896 Test Loss: 0.281 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5492277145385742
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.281 Vali Acc: 0.896 Test Loss: 0.281 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5866529941558838
Epoch: 51, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.281 Vali Acc: 0.896 Test Loss: 0.281 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5382373332977295
Epoch: 52, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5561122894287109
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.279 Vali Acc: 0.900 Test Loss: 0.279 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 119590
model size : 2.91MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0385639667510986
Epoch: 1, Steps: 2 | Train Loss: 2.209 Vali Loss: 1.989 Vali Acc: 0.126 Test Loss: 1.989 Test Acc: 0.126
Validation loss decreased (inf --> -0.125906).  Saving model ...
Epoch: 2 cost time: 0.46693968772888184
Epoch: 2, Steps: 2 | Train Loss: 2.097 Vali Loss: 1.866 Vali Acc: 0.193 Test Loss: 1.866 Test Acc: 0.193
Validation loss decreased (-0.125906 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 0.4504091739654541
Epoch: 3, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.744 Vali Acc: 0.241 Test Loss: 1.744 Test Acc: 0.241
Validation loss decreased (-0.192574 --> -0.240723).  Saving model ...
Epoch: 4 cost time: 0.45443034172058105
Epoch: 4, Steps: 2 | Train Loss: 1.702 Vali Loss: 1.583 Vali Acc: 0.341 Test Loss: 1.583 Test Acc: 0.341
Validation loss decreased (-0.240723 --> -0.340725).  Saving model ...
Epoch: 5 cost time: 0.46297645568847656
Epoch: 5, Steps: 2 | Train Loss: 1.504 Vali Loss: 1.396 Vali Acc: 0.585 Test Loss: 1.396 Test Acc: 0.585
Validation loss decreased (-0.340725 --> -0.585171).  Saving model ...
Epoch: 6 cost time: 0.5048689842224121
Epoch: 6, Steps: 2 | Train Loss: 1.263 Vali Loss: 1.203 Vali Acc: 0.700 Test Loss: 1.203 Test Acc: 0.700
Validation loss decreased (-0.585171 --> -0.699988).  Saving model ...
Epoch: 7 cost time: 0.46083617210388184
Epoch: 7, Steps: 2 | Train Loss: 1.090 Vali Loss: 1.021 Vali Acc: 0.789 Test Loss: 1.021 Test Acc: 0.789
Validation loss decreased (-0.699988 --> -0.788879).  Saving model ...
Epoch: 8 cost time: 0.439486026763916
Epoch: 8, Steps: 2 | Train Loss: 0.871 Vali Loss: 0.860 Vali Acc: 0.826 Test Loss: 0.860 Test Acc: 0.826
Validation loss decreased (-0.788879 --> -0.825917).  Saving model ...
Epoch: 9 cost time: 0.4955027103424072
Epoch: 9, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.722 Vali Acc: 0.856 Test Loss: 0.722 Test Acc: 0.856
Validation loss decreased (-0.825917 --> -0.855548).  Saving model ...
Epoch: 10 cost time: 0.5493600368499756
Epoch: 10, Steps: 2 | Train Loss: 0.544 Vali Loss: 0.606 Vali Acc: 0.870 Test Loss: 0.606 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 11 cost time: 0.5630862712860107
Epoch: 11, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.512 Vali Acc: 0.900 Test Loss: 0.512 Test Acc: 0.900
Validation loss decreased (-0.870364 --> -0.899995).  Saving model ...
Epoch: 12 cost time: 0.5095617771148682
Epoch: 12, Steps: 2 | Train Loss: 0.299 Vali Loss: 0.438 Vali Acc: 0.907 Test Loss: 0.438 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 0.5125138759613037
Epoch: 13, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.377 Vali Acc: 0.911 Test Loss: 0.377 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 14 cost time: 0.5041408538818359
Epoch: 14, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 15 cost time: 0.5409696102142334
Epoch: 15, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918516).  Saving model ...
Epoch: 16 cost time: 0.5399153232574463
Epoch: 16, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.264 Vali Acc: 0.926 Test Loss: 0.264 Test Acc: 0.926
Validation loss decreased (-0.918516 --> -0.925923).  Saving model ...
Epoch: 17 cost time: 0.48598814010620117
Epoch: 17, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 18 cost time: 0.5492241382598877
Epoch: 18, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.5172955989837646
Epoch: 19, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.933331 --> -0.940739).  Saving model ...
Epoch: 20 cost time: 0.5138969421386719
Epoch: 20, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.5075523853302002
Epoch: 21, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5258352756500244
Epoch: 22, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.184 Vali Acc: 0.937 Test Loss: 0.184 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4590137004852295
Epoch: 23, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.181 Vali Acc: 0.941 Test Loss: 0.181 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 24 cost time: 0.4616720676422119
Epoch: 24, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.179 Vali Acc: 0.941 Test Loss: 0.179 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 25 cost time: 0.558243989944458
Epoch: 25, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.178 Vali Acc: 0.944 Test Loss: 0.178 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 26 cost time: 0.5465736389160156
Epoch: 26, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.517310619354248
Epoch: 27, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 0.5323770046234131
Epoch: 28, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 0.5604536533355713
Epoch: 29, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 0.5278561115264893
Epoch: 30, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 0.5514495372772217
Epoch: 31, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.171 Vali Acc: 0.937 Test Loss: 0.171 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 0.5535588264465332
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.170 Vali Acc: 0.937 Test Loss: 0.170 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 0.5934171676635742
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.169 Vali Acc: 0.937 Test Loss: 0.169 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 0.5468037128448486
Epoch: 34, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 0.5530080795288086
Epoch: 35, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.168 Vali Acc: 0.937 Test Loss: 0.168 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 103206
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.216444730758667
Epoch: 1, Steps: 2 | Train Loss: 2.197 Vali Loss: 1.994 Vali Acc: 0.152 Test Loss: 1.994 Test Acc: 0.152
Validation loss decreased (inf --> -0.151832).  Saving model ...
Epoch: 2 cost time: 0.45743298530578613
Epoch: 2, Steps: 2 | Train Loss: 2.050 Vali Loss: 1.870 Vali Acc: 0.193 Test Loss: 1.870 Test Acc: 0.193
Validation loss decreased (-0.151832 --> -0.192574).  Saving model ...
Epoch: 3 cost time: 0.4997401237487793
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.748 Vali Acc: 0.244 Test Loss: 1.748 Test Acc: 0.244
Validation loss decreased (-0.192574 --> -0.244427).  Saving model ...
Epoch: 4 cost time: 0.41948628425598145
Epoch: 4, Steps: 2 | Train Loss: 1.682 Vali Loss: 1.589 Vali Acc: 0.319 Test Loss: 1.589 Test Acc: 0.319
Validation loss decreased (-0.244427 --> -0.318503).  Saving model ...
Epoch: 5 cost time: 0.45409679412841797
Epoch: 5, Steps: 2 | Train Loss: 1.481 Vali Loss: 1.402 Vali Acc: 0.559 Test Loss: 1.402 Test Acc: 0.559
Validation loss decreased (-0.318503 --> -0.559245).  Saving model ...
Epoch: 6 cost time: 0.4363391399383545
Epoch: 6, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.210 Vali Acc: 0.689 Test Loss: 1.210 Test Acc: 0.689
Validation loss decreased (-0.559245 --> -0.688877).  Saving model ...
Epoch: 7 cost time: 0.4385390281677246
Epoch: 7, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.029 Vali Acc: 0.767 Test Loss: 1.029 Test Acc: 0.767
Validation loss decreased (-0.688877 --> -0.766656).  Saving model ...
Epoch: 8 cost time: 0.45729947090148926
Epoch: 8, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.868 Vali Acc: 0.822 Test Loss: 0.868 Test Acc: 0.822
Validation loss decreased (-0.766656 --> -0.822214).  Saving model ...
Epoch: 9 cost time: 0.4265103340148926
Epoch: 9, Steps: 2 | Train Loss: 0.724 Vali Loss: 0.730 Vali Acc: 0.856 Test Loss: 0.730 Test Acc: 0.856
Validation loss decreased (-0.822214 --> -0.855548).  Saving model ...
Epoch: 10 cost time: 0.4559597969055176
Epoch: 10, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.616 Vali Acc: 0.870 Test Loss: 0.616 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 11 cost time: 0.46601390838623047
Epoch: 11, Steps: 2 | Train Loss: 0.447 Vali Loss: 0.523 Vali Acc: 0.893 Test Loss: 0.523 Test Acc: 0.893
Validation loss decreased (-0.870364 --> -0.892587).  Saving model ...
Epoch: 12 cost time: 0.4288351535797119
Epoch: 12, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.449 Vali Acc: 0.907 Test Loss: 0.449 Test Acc: 0.907
Validation loss decreased (-0.892587 --> -0.907403).  Saving model ...
Epoch: 13 cost time: 0.4498119354248047
Epoch: 13, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.389 Vali Acc: 0.915 Test Loss: 0.389 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 14 cost time: 0.47133350372314453
Epoch: 14, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.344 Vali Acc: 0.915 Test Loss: 0.344 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 15 cost time: 0.5251462459564209
Epoch: 15, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
Validation loss decreased (-0.914811 --> -0.933330).  Saving model ...
Epoch: 16 cost time: 0.5056483745574951
Epoch: 16, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933331).  Saving model ...
Epoch: 17 cost time: 0.5112764835357666
Epoch: 17, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.5520451068878174
Epoch: 18, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 19 cost time: 0.5184507369995117
Epoch: 19, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.217 Vali Acc: 0.937 Test Loss: 0.217 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 20 cost time: 0.5239756107330322
Epoch: 20, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.206 Vali Acc: 0.941 Test Loss: 0.206 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 21 cost time: 0.5741868019104004
Epoch: 21, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 22 cost time: 0.539872407913208
Epoch: 22, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 23 cost time: 0.5562934875488281
Epoch: 23, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.188 Vali Acc: 0.937 Test Loss: 0.188 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6005115509033203
Epoch: 24, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.185 Vali Acc: 0.933 Test Loss: 0.185 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 0.5205662250518799
Epoch: 25, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.183 Vali Acc: 0.933 Test Loss: 0.183 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 0.543828010559082
Epoch: 26, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.181 Vali Acc: 0.933 Test Loss: 0.181 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 0.44887757301330566
Epoch: 27, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.180 Vali Acc: 0.933 Test Loss: 0.180 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 0.45644092559814453
Epoch: 28, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.179 Vali Acc: 0.937 Test Loss: 0.179 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 0.4801781177520752
Epoch: 29, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 0.45809197425842285
Epoch: 30, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.178 Vali Acc: 0.937 Test Loss: 0.178 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 0.48247265815734863
Epoch: 31, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.177 Vali Acc: 0.941 Test Loss: 0.177 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 32 cost time: 0.5043361186981201
Epoch: 32, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.176 Vali Acc: 0.941 Test Loss: 0.176 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.45688462257385254
Epoch: 33, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 34 cost time: 0.546515703201294
Epoch: 34, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.175 Vali Acc: 0.941 Test Loss: 0.175 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 35 cost time: 0.476548433303833
Epoch: 35, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.941 Test Loss: 0.174 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 36 cost time: 0.5535659790039062
Epoch: 36, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.174 Vali Acc: 0.937 Test Loss: 0.174 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5342762470245361
Epoch: 37, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5260648727416992
Epoch: 38, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.572808027267456
Epoch: 39, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.6175787448883057
Epoch: 40, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.173 Vali Acc: 0.937 Test Loss: 0.173 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.5373806953430176
Epoch: 41, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.5945587158203125
Epoch: 42, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.5862822532653809
Epoch: 43, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.6142239570617676
Epoch: 44, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.5812103748321533
Epoch: 45, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.941 Test Loss: 0.172 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 46 cost time: 0.5341465473175049
Epoch: 46, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.5671133995056152
Epoch: 47, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.5740528106689453
Epoch: 48, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.5117843151092529
Epoch: 49, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4723317623138428
Epoch: 50, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.49448156356811523
Epoch: 51, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.51751708984375
Epoch: 52, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.5106453895568848
Epoch: 53, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.5045011043548584
Epoch: 54, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.5603272914886475
Epoch: 55, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.172 Vali Acc: 0.937 Test Loss: 0.172 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 103206
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2958784103393555
Epoch: 1, Steps: 2 | Train Loss: 2.181 Vali Loss: 1.997 Vali Acc: 0.152 Test Loss: 1.997 Test Acc: 0.152
Validation loss decreased (inf --> -0.151832).  Saving model ...
Epoch: 2 cost time: 0.533841609954834
Epoch: 2, Steps: 2 | Train Loss: 1.998 Vali Loss: 1.876 Vali Acc: 0.207 Test Loss: 1.876 Test Acc: 0.207
Validation loss decreased (-0.151832 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.5040686130523682
Epoch: 3, Steps: 2 | Train Loss: 1.800 Vali Loss: 1.757 Vali Acc: 0.256 Test Loss: 1.757 Test Acc: 0.256
Validation loss decreased (-0.207389 --> -0.255538).  Saving model ...
Epoch: 4 cost time: 0.5235936641693115
Epoch: 4, Steps: 2 | Train Loss: 1.690 Vali Loss: 1.602 Vali Acc: 0.319 Test Loss: 1.602 Test Acc: 0.319
Validation loss decreased (-0.255538 --> -0.318503).  Saving model ...
Epoch: 5 cost time: 0.5204575061798096
Epoch: 5, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.420 Vali Acc: 0.559 Test Loss: 1.420 Test Acc: 0.559
Validation loss decreased (-0.318503 --> -0.559245).  Saving model ...
Epoch: 6 cost time: 0.48215460777282715
Epoch: 6, Steps: 2 | Train Loss: 1.272 Vali Loss: 1.234 Vali Acc: 0.641 Test Loss: 1.234 Test Acc: 0.641
Validation loss decreased (-0.559245 --> -0.640728).  Saving model ...
Epoch: 7 cost time: 0.49103546142578125
Epoch: 7, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.057 Vali Acc: 0.726 Test Loss: 1.057 Test Acc: 0.726
Validation loss decreased (-0.640728 --> -0.725915).  Saving model ...
Epoch: 8 cost time: 0.5165250301361084
Epoch: 8, Steps: 2 | Train Loss: 0.889 Vali Loss: 0.902 Vali Acc: 0.781 Test Loss: 0.902 Test Acc: 0.781
Validation loss decreased (-0.725915 --> -0.781472).  Saving model ...
Epoch: 9 cost time: 0.5399925708770752
Epoch: 9, Steps: 2 | Train Loss: 0.736 Vali Loss: 0.768 Vali Acc: 0.819 Test Loss: 0.768 Test Acc: 0.819
Validation loss decreased (-0.781472 --> -0.818511).  Saving model ...
Epoch: 10 cost time: 0.4953193664550781
Epoch: 10, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.659 Vali Acc: 0.837 Test Loss: 0.659 Test Acc: 0.837
Validation loss decreased (-0.818511 --> -0.837030).  Saving model ...
Epoch: 11 cost time: 0.46557092666625977
Epoch: 11, Steps: 2 | Train Loss: 0.493 Vali Loss: 0.569 Vali Acc: 0.870 Test Loss: 0.569 Test Acc: 0.870
Validation loss decreased (-0.837030 --> -0.870365).  Saving model ...
Epoch: 12 cost time: 0.43710827827453613
Epoch: 12, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.497 Vali Acc: 0.870 Test Loss: 0.497 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 13 cost time: 0.44095897674560547
Epoch: 13, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.437 Vali Acc: 0.893 Test Loss: 0.437 Test Acc: 0.893
Validation loss decreased (-0.870365 --> -0.892588).  Saving model ...
Epoch: 14 cost time: 0.49060821533203125
Epoch: 14, Steps: 2 | Train Loss: 0.247 Vali Loss: 0.392 Vali Acc: 0.896 Test Loss: 0.392 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 15 cost time: 0.47258853912353516
Epoch: 15, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.354 Vali Acc: 0.900 Test Loss: 0.354 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 16 cost time: 0.4732058048248291
Epoch: 16, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.323 Vali Acc: 0.915 Test Loss: 0.323 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914812).  Saving model ...
Epoch: 17 cost time: 0.5170414447784424
Epoch: 17, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.298 Vali Acc: 0.907 Test Loss: 0.298 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 0.4972665309906006
Epoch: 18, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.277 Vali Acc: 0.915 Test Loss: 0.277 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 19 cost time: 0.530768871307373
Epoch: 19, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
Validation loss decreased (-0.914812 --> -0.925923).  Saving model ...
Epoch: 20 cost time: 0.5350503921508789
Epoch: 20, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.244 Vali Acc: 0.937 Test Loss: 0.244 Test Acc: 0.937
Validation loss decreased (-0.925923 --> -0.937035).  Saving model ...
Epoch: 21 cost time: 0.48507070541381836
Epoch: 21, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4829542636871338
Epoch: 22, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4919288158416748
Epoch: 23, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4717600345611572
Epoch: 24, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.479276180267334
Epoch: 25, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.503380537033081
Epoch: 26, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.43102145195007324
Epoch: 27, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.5223178863525391
Epoch: 28, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5097956657409668
Epoch: 29, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.4910738468170166
Epoch: 30, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5080325603485107
Epoch: 31, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.4897644519805908
Epoch: 32, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 33 cost time: 0.5040450096130371
Epoch: 33, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5056724548339844
Epoch: 34, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.472057580947876
Epoch: 35, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.37323975563049316
Epoch: 36, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4345438480377197
Epoch: 37, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.451519250869751
Epoch: 38, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.44201087951660156
Epoch: 39, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.200 Vali Acc: 0.930 Test Loss: 0.200 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.4671485424041748
Epoch: 40, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5091187953948975
Epoch: 41, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.48387789726257324
Epoch: 42, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 43 cost time: 0.4441101551055908
Epoch: 43, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 44 cost time: 0.506432294845581
Epoch: 44, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 45 cost time: 0.48148488998413086
Epoch: 45, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5380444526672363
Epoch: 46, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.485764741897583
Epoch: 47, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.5171303749084473
Epoch: 48, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.6223225593566895
Epoch: 49, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.4918332099914551
Epoch: 50, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5216014385223389
Epoch: 51, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5903480052947998
Epoch: 52, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 53 cost time: 0.608767032623291
Epoch: 53, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 54 cost time: 0.5328493118286133
Epoch: 54, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 103206
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9709556102752686
Epoch: 1, Steps: 2 | Train Loss: 2.018 Vali Loss: 1.899 Vali Acc: 0.126 Test Loss: 1.899 Test Acc: 0.126
Validation loss decreased (inf --> -0.125907).  Saving model ...
Epoch: 2 cost time: 0.4439656734466553
Epoch: 2, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.789 Vali Acc: 0.178 Test Loss: 1.789 Test Acc: 0.178
Validation loss decreased (-0.125907 --> -0.177760).  Saving model ...
Epoch: 3 cost time: 0.45300984382629395
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.681 Vali Acc: 0.256 Test Loss: 1.681 Test Acc: 0.256
Validation loss decreased (-0.177760 --> -0.255539).  Saving model ...
Epoch: 4 cost time: 0.4634358882904053
Epoch: 4, Steps: 2 | Train Loss: 1.582 Vali Loss: 1.542 Vali Acc: 0.433 Test Loss: 1.542 Test Acc: 0.433
Validation loss decreased (-0.255539 --> -0.433318).  Saving model ...
Epoch: 5 cost time: 0.47458720207214355
Epoch: 5, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.381 Vali Acc: 0.607 Test Loss: 1.381 Test Acc: 0.607
Validation loss decreased (-0.433318 --> -0.607394).  Saving model ...
Epoch: 6 cost time: 0.46846580505371094
Epoch: 6, Steps: 2 | Train Loss: 1.299 Vali Loss: 1.216 Vali Acc: 0.670 Test Loss: 1.216 Test Acc: 0.670
Validation loss decreased (-0.607394 --> -0.670358).  Saving model ...
Epoch: 7 cost time: 0.47178030014038086
Epoch: 7, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.060 Vali Acc: 0.719 Test Loss: 1.060 Test Acc: 0.719
Validation loss decreased (-0.670358 --> -0.718508).  Saving model ...
Epoch: 8 cost time: 0.518165111541748
Epoch: 8, Steps: 2 | Train Loss: 0.930 Vali Loss: 0.922 Vali Acc: 0.733 Test Loss: 0.922 Test Acc: 0.733
Validation loss decreased (-0.718508 --> -0.733324).  Saving model ...
Epoch: 9 cost time: 0.48532724380493164
Epoch: 9, Steps: 2 | Train Loss: 0.759 Vali Loss: 0.805 Vali Acc: 0.763 Test Loss: 0.805 Test Acc: 0.763
Validation loss decreased (-0.733324 --> -0.762955).  Saving model ...
Epoch: 10 cost time: 0.5236160755157471
Epoch: 10, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.708 Vali Acc: 0.807 Test Loss: 0.708 Test Acc: 0.807
Validation loss decreased (-0.762955 --> -0.807400).  Saving model ...
Epoch: 11 cost time: 0.5491814613342285
Epoch: 11, Steps: 2 | Train Loss: 0.561 Vali Loss: 0.629 Vali Acc: 0.811 Test Loss: 0.629 Test Acc: 0.811
Validation loss decreased (-0.807400 --> -0.811105).  Saving model ...
Epoch: 12 cost time: 0.562751054763794
Epoch: 12, Steps: 2 | Train Loss: 0.428 Vali Loss: 0.566 Vali Acc: 0.830 Test Loss: 0.566 Test Acc: 0.830
Validation loss decreased (-0.811105 --> -0.829624).  Saving model ...
Epoch: 13 cost time: 0.5160903930664062
Epoch: 13, Steps: 2 | Train Loss: 0.404 Vali Loss: 0.513 Vali Acc: 0.856 Test Loss: 0.513 Test Acc: 0.856
Validation loss decreased (-0.829624 --> -0.855550).  Saving model ...
Epoch: 14 cost time: 0.5156018733978271
Epoch: 14, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.473 Vali Acc: 0.837 Test Loss: 0.473 Test Acc: 0.837
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5660288333892822
Epoch: 15, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.438 Vali Acc: 0.874 Test Loss: 0.438 Test Acc: 0.874
Validation loss decreased (-0.855550 --> -0.874070).  Saving model ...
Epoch: 16 cost time: 0.5410289764404297
Epoch: 16, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.412 Vali Acc: 0.874 Test Loss: 0.412 Test Acc: 0.874
Validation loss decreased (-0.874070 --> -0.874070).  Saving model ...
Epoch: 17 cost time: 0.49518823623657227
Epoch: 17, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.390 Vali Acc: 0.885 Test Loss: 0.390 Test Acc: 0.885
Validation loss decreased (-0.874070 --> -0.885181).  Saving model ...
Epoch: 18 cost time: 0.500497579574585
Epoch: 18, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.373 Vali Acc: 0.896 Test Loss: 0.373 Test Acc: 0.896
Validation loss decreased (-0.885181 --> -0.896293).  Saving model ...
Epoch: 19 cost time: 0.48621225357055664
Epoch: 19, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.360 Vali Acc: 0.885 Test Loss: 0.360 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4803783893585205
Epoch: 20, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.346 Vali Acc: 0.900 Test Loss: 0.346 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 21 cost time: 0.49591803550720215
Epoch: 21, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.333 Vali Acc: 0.907 Test Loss: 0.333 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 22 cost time: 0.5327093601226807
Epoch: 22, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.325 Vali Acc: 0.900 Test Loss: 0.325 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.6416184902191162
Epoch: 23, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.318 Vali Acc: 0.896 Test Loss: 0.318 Test Acc: 0.896
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.4690718650817871
Epoch: 24, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.313 Vali Acc: 0.893 Test Loss: 0.313 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.3718595504760742
Epoch: 25, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.309 Vali Acc: 0.896 Test Loss: 0.309 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.4522426128387451
Epoch: 26, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.306 Vali Acc: 0.904 Test Loss: 0.306 Test Acc: 0.904
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 0.47391486167907715
Epoch: 27, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.305 Vali Acc: 0.900 Test Loss: 0.305 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 0.5699915885925293
Epoch: 28, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.300 Vali Acc: 0.904 Test Loss: 0.300 Test Acc: 0.904
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 0.5269496440887451
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 0.5077977180480957
Epoch: 30, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.297 Vali Acc: 0.896 Test Loss: 0.297 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 0.5554816722869873
Epoch: 31, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 103206
model size : 2.85MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9966702461242676
Epoch: 1, Steps: 2 | Train Loss: 2.029 Vali Loss: 1.803 Vali Acc: 0.207 Test Loss: 1.803 Test Acc: 0.207
Validation loss decreased (inf --> -0.207389).  Saving model ...
Epoch: 2 cost time: 0.38275575637817383
Epoch: 2, Steps: 2 | Train Loss: 1.823 Vali Loss: 1.707 Vali Acc: 0.263 Test Loss: 1.707 Test Acc: 0.263
Validation loss decreased (-0.207389 --> -0.262946).  Saving model ...
Epoch: 3 cost time: 0.41802525520324707
Epoch: 3, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.632 Vali Acc: 0.326 Test Loss: 1.632 Test Acc: 0.326
Validation loss decreased (-0.262946 --> -0.325910).  Saving model ...
Epoch: 4 cost time: 0.44222140312194824
Epoch: 4, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.552 Vali Acc: 0.374 Test Loss: 1.552 Test Acc: 0.374
Validation loss decreased (-0.325910 --> -0.374059).  Saving model ...
Epoch: 5 cost time: 0.4188199043273926
Epoch: 5, Steps: 2 | Train Loss: 1.706 Vali Loss: 1.454 Vali Acc: 0.456 Test Loss: 1.454 Test Acc: 0.456
Validation loss decreased (-0.374059 --> -0.455541).  Saving model ...
Epoch: 6 cost time: 0.4298276901245117
Epoch: 6, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.346 Vali Acc: 0.622 Test Loss: 1.346 Test Acc: 0.622
Validation loss decreased (-0.455541 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 0.49100160598754883
Epoch: 7, Steps: 2 | Train Loss: 1.322 Vali Loss: 1.230 Vali Acc: 0.704 Test Loss: 1.230 Test Acc: 0.704
Validation loss decreased (-0.622209 --> -0.703691).  Saving model ...
Epoch: 8 cost time: 0.47353267669677734
Epoch: 8, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.115 Vali Acc: 0.744 Test Loss: 1.115 Test Acc: 0.744
Validation loss decreased (-0.703691 --> -0.744433).  Saving model ...
Epoch: 9 cost time: 0.4774742126464844
Epoch: 9, Steps: 2 | Train Loss: 0.986 Vali Loss: 1.002 Vali Acc: 0.774 Test Loss: 1.002 Test Acc: 0.774
Validation loss decreased (-0.744433 --> -0.774064).  Saving model ...
Epoch: 10 cost time: 0.44707417488098145
Epoch: 10, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.896 Vali Acc: 0.796 Test Loss: 0.896 Test Acc: 0.796
Validation loss decreased (-0.774064 --> -0.796287).  Saving model ...
Epoch: 11 cost time: 0.4649050235748291
Epoch: 11, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.797 Vali Acc: 0.815 Test Loss: 0.797 Test Acc: 0.815
Validation loss decreased (-0.796287 --> -0.814807).  Saving model ...
Epoch: 12 cost time: 0.4402492046356201
Epoch: 12, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.710 Vali Acc: 0.859 Test Loss: 0.710 Test Acc: 0.859
Validation loss decreased (-0.814807 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 0.4798707962036133
Epoch: 13, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.636 Vali Acc: 0.863 Test Loss: 0.636 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862957).  Saving model ...
Epoch: 14 cost time: 0.4683837890625
Epoch: 14, Steps: 2 | Train Loss: 0.489 Vali Loss: 0.572 Vali Acc: 0.867 Test Loss: 0.572 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 15 cost time: 0.4639859199523926
Epoch: 15, Steps: 2 | Train Loss: 0.364 Vali Loss: 0.516 Vali Acc: 0.885 Test Loss: 0.516 Test Acc: 0.885
Validation loss decreased (-0.866661 --> -0.885180).  Saving model ...
Epoch: 16 cost time: 0.43715381622314453
Epoch: 16, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.467 Vali Acc: 0.889 Test Loss: 0.467 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.5062360763549805
Epoch: 17, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.424 Vali Acc: 0.900 Test Loss: 0.424 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899996).  Saving model ...
Epoch: 18 cost time: 0.5222499370574951
Epoch: 18, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.388 Vali Acc: 0.904 Test Loss: 0.388 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 19 cost time: 0.42636966705322266
Epoch: 19, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.357 Vali Acc: 0.911 Test Loss: 0.357 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 20 cost time: 0.43880176544189453
Epoch: 20, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.332 Vali Acc: 0.911 Test Loss: 0.332 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.42984652519226074
Epoch: 21, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.312 Vali Acc: 0.911 Test Loss: 0.312 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.44563984870910645
Epoch: 22, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.45108652114868164
Epoch: 23, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.43358898162841797
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.274 Vali Acc: 0.915 Test Loss: 0.274 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.43354177474975586
Epoch: 25, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.264 Vali Acc: 0.919 Test Loss: 0.264 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 26 cost time: 0.4082603454589844
Epoch: 26, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.41088247299194336
Epoch: 27, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.42477846145629883
Epoch: 28, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.3735964298248291
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.4450995922088623
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.40292835235595703
Epoch: 31, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.3855447769165039
Epoch: 32, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.42996644973754883
Epoch: 33, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 34 cost time: 0.43170595169067383
Epoch: 34, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 35 cost time: 0.4332144260406494
Epoch: 35, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4269850254058838
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 37 cost time: 0.44168901443481445
Epoch: 37, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 38 cost time: 0.45523810386657715
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 39 cost time: 0.44080305099487305
Epoch: 39, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 0.44429731369018555
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 0.48455047607421875
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 0.48877406120300293
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 0.515012264251709
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 0.4836127758026123
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 0.46224474906921387
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 0.45900678634643555
Epoch: 46, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 0.4787709712982178
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.214 Vali Acc: 0.930 Test Loss: 0.214 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 0.50238037109375
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.930 Test Loss: 0.213 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 297382
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.272186756134033
Epoch: 1, Steps: 2 | Train Loss: 2.006 Vali Loss: 1.794 Vali Acc: 0.170 Test Loss: 1.794 Test Acc: 0.170
Validation loss decreased (inf --> -0.170352).  Saving model ...
Epoch: 2 cost time: 0.47011494636535645
Epoch: 2, Steps: 2 | Train Loss: 1.829 Vali Loss: 1.700 Vali Acc: 0.244 Test Loss: 1.700 Test Acc: 0.244
Validation loss decreased (-0.170352 --> -0.244427).  Saving model ...
Epoch: 3 cost time: 0.448836088180542
Epoch: 3, Steps: 2 | Train Loss: 1.645 Vali Loss: 1.625 Vali Acc: 0.315 Test Loss: 1.625 Test Acc: 0.315
Validation loss decreased (-0.244427 --> -0.314799).  Saving model ...
Epoch: 4 cost time: 0.47446107864379883
Epoch: 4, Steps: 2 | Train Loss: 1.584 Vali Loss: 1.546 Vali Acc: 0.370 Test Loss: 1.546 Test Acc: 0.370
Validation loss decreased (-0.314799 --> -0.370355).  Saving model ...
Epoch: 5 cost time: 0.4699585437774658
Epoch: 5, Steps: 2 | Train Loss: 1.673 Vali Loss: 1.449 Vali Acc: 0.478 Test Loss: 1.449 Test Acc: 0.478
Validation loss decreased (-0.370355 --> -0.477763).  Saving model ...
Epoch: 6 cost time: 0.49902844429016113
Epoch: 6, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.343 Vali Acc: 0.622 Test Loss: 1.343 Test Acc: 0.622
Validation loss decreased (-0.477763 --> -0.622209).  Saving model ...
Epoch: 7 cost time: 0.49157142639160156
Epoch: 7, Steps: 2 | Train Loss: 1.296 Vali Loss: 1.229 Vali Acc: 0.704 Test Loss: 1.229 Test Acc: 0.704
Validation loss decreased (-0.622209 --> -0.703691).  Saving model ...
Epoch: 8 cost time: 0.5050206184387207
Epoch: 8, Steps: 2 | Train Loss: 1.132 Vali Loss: 1.115 Vali Acc: 0.730 Test Loss: 1.115 Test Acc: 0.730
Validation loss decreased (-0.703691 --> -0.729618).  Saving model ...
Epoch: 9 cost time: 0.533682107925415
Epoch: 9, Steps: 2 | Train Loss: 0.980 Vali Loss: 1.004 Vali Acc: 0.763 Test Loss: 1.004 Test Acc: 0.763
Validation loss decreased (-0.729618 --> -0.762953).  Saving model ...
Epoch: 10 cost time: 0.4783761501312256
Epoch: 10, Steps: 2 | Train Loss: 0.876 Vali Loss: 0.899 Vali Acc: 0.793 Test Loss: 0.899 Test Acc: 0.793
Validation loss decreased (-0.762953 --> -0.792584).  Saving model ...
Epoch: 11 cost time: 0.4550449848175049
Epoch: 11, Steps: 2 | Train Loss: 0.738 Vali Loss: 0.801 Vali Acc: 0.811 Test Loss: 0.801 Test Acc: 0.811
Validation loss decreased (-0.792584 --> -0.811103).  Saving model ...
Epoch: 12 cost time: 0.4531700611114502
Epoch: 12, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.716 Vali Acc: 0.819 Test Loss: 0.716 Test Acc: 0.819
Validation loss decreased (-0.811103 --> -0.818511).  Saving model ...
Epoch: 13 cost time: 0.505042552947998
Epoch: 13, Steps: 2 | Train Loss: 0.567 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
Validation loss decreased (-0.818511 --> -0.844438).  Saving model ...
Epoch: 14 cost time: 0.5277843475341797
Epoch: 14, Steps: 2 | Train Loss: 0.499 Vali Loss: 0.578 Vali Acc: 0.870 Test Loss: 0.578 Test Acc: 0.870
Validation loss decreased (-0.844438 --> -0.870365).  Saving model ...
Epoch: 15 cost time: 0.5276510715484619
Epoch: 15, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.522 Vali Acc: 0.881 Test Loss: 0.522 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881476).  Saving model ...
Epoch: 16 cost time: 0.5326263904571533
Epoch: 16, Steps: 2 | Train Loss: 0.353 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
Validation loss decreased (-0.881476 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.4795801639556885
Epoch: 17, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.431 Vali Acc: 0.904 Test Loss: 0.431 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.49464845657348633
Epoch: 18, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.395 Vali Acc: 0.904 Test Loss: 0.395 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 19 cost time: 0.4811997413635254
Epoch: 19, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.364 Vali Acc: 0.896 Test Loss: 0.364 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4753122329711914
Epoch: 20, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.339 Vali Acc: 0.907 Test Loss: 0.339 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.46079373359680176
Epoch: 21, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.318 Vali Acc: 0.904 Test Loss: 0.318 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.49224019050598145
Epoch: 22, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 23 cost time: 0.45574498176574707
Epoch: 23, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.289 Vali Acc: 0.915 Test Loss: 0.289 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.48455166816711426
Epoch: 24, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.277 Vali Acc: 0.915 Test Loss: 0.277 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.4915339946746826
Epoch: 25, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 26 cost time: 0.5232930183410645
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 27 cost time: 0.5240950584411621
Epoch: 27, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.252 Vali Acc: 0.919 Test Loss: 0.252 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.5072462558746338
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.246 Vali Acc: 0.919 Test Loss: 0.246 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 29 cost time: 0.4520587921142578
Epoch: 29, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.48566150665283203
Epoch: 30, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.237 Vali Acc: 0.915 Test Loss: 0.237 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.4350883960723877
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.234 Vali Acc: 0.915 Test Loss: 0.234 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.48317456245422363
Epoch: 32, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.232 Vali Acc: 0.919 Test Loss: 0.232 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 33 cost time: 0.5057148933410645
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.230 Vali Acc: 0.919 Test Loss: 0.230 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 34 cost time: 0.5252914428710938
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.229 Vali Acc: 0.919 Test Loss: 0.229 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 35 cost time: 0.5190379619598389
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.228 Vali Acc: 0.919 Test Loss: 0.228 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 36 cost time: 0.5369794368743896
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.227 Vali Acc: 0.915 Test Loss: 0.227 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5268049240112305
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.225 Vali Acc: 0.915 Test Loss: 0.225 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5658538341522217
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.5295922756195068
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.223 Vali Acc: 0.919 Test Loss: 0.223 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.539362907409668
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.4746720790863037
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.221 Vali Acc: 0.919 Test Loss: 0.221 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 42 cost time: 0.525810718536377
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.220 Vali Acc: 0.919 Test Loss: 0.220 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 43 cost time: 0.541790246963501
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.4902334213256836
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 0.5316624641418457
Epoch: 45, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 46 cost time: 0.4989151954650879
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 47 cost time: 0.4849541187286377
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 0.4892418384552002
Epoch: 48, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 0.5050005912780762
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.4780144691467285
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5547683238983154
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.5273027420043945
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5074243545532227
Epoch: 53, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.218 Vali Acc: 0.919 Test Loss: 0.218 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5341503620147705
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.46682190895080566
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.4378662109375
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.5454773902893066
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.5095539093017578
Epoch: 58, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.216 Vali Acc: 0.919 Test Loss: 0.216 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 297382
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.197005033493042
Epoch: 1, Steps: 2 | Train Loss: 1.991 Vali Loss: 1.785 Vali Acc: 0.163 Test Loss: 1.785 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.5317375659942627
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.694 Vali Acc: 0.267 Test Loss: 1.694 Test Acc: 0.267
Validation loss decreased (-0.162945 --> -0.266650).  Saving model ...
Epoch: 3 cost time: 0.5240175724029541
Epoch: 3, Steps: 2 | Train Loss: 1.667 Vali Loss: 1.622 Vali Acc: 0.333 Test Loss: 1.622 Test Acc: 0.333
Validation loss decreased (-0.266650 --> -0.333317).  Saving model ...
Epoch: 4 cost time: 0.5182843208312988
Epoch: 4, Steps: 2 | Train Loss: 1.611 Vali Loss: 1.546 Vali Acc: 0.407 Test Loss: 1.546 Test Acc: 0.407
Validation loss decreased (-0.333317 --> -0.407392).  Saving model ...
Epoch: 5 cost time: 0.5897297859191895
Epoch: 5, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.452 Vali Acc: 0.507 Test Loss: 1.452 Test Acc: 0.507
Validation loss decreased (-0.407392 --> -0.507393).  Saving model ...
Epoch: 6 cost time: 0.58349609375
Epoch: 6, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.349 Vali Acc: 0.641 Test Loss: 1.349 Test Acc: 0.641
Validation loss decreased (-0.507393 --> -0.640727).  Saving model ...
Epoch: 7 cost time: 0.5591764450073242
Epoch: 7, Steps: 2 | Train Loss: 1.312 Vali Loss: 1.240 Vali Acc: 0.693 Test Loss: 1.240 Test Acc: 0.693
Validation loss decreased (-0.640727 --> -0.692580).  Saving model ...
Epoch: 8 cost time: 0.5116794109344482
Epoch: 8, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.130 Vali Acc: 0.722 Test Loss: 1.130 Test Acc: 0.722
Validation loss decreased (-0.692580 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 0.556351900100708
Epoch: 9, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.022 Vali Acc: 0.752 Test Loss: 1.022 Test Acc: 0.752
Validation loss decreased (-0.722211 --> -0.751842).  Saving model ...
Epoch: 10 cost time: 0.5157308578491211
Epoch: 10, Steps: 2 | Train Loss: 0.932 Vali Loss: 0.920 Vali Acc: 0.774 Test Loss: 0.920 Test Acc: 0.774
Validation loss decreased (-0.751842 --> -0.774065).  Saving model ...
Epoch: 11 cost time: 0.5680396556854248
Epoch: 11, Steps: 2 | Train Loss: 0.766 Vali Loss: 0.825 Vali Acc: 0.785 Test Loss: 0.825 Test Acc: 0.785
Validation loss decreased (-0.774065 --> -0.785177).  Saving model ...
Epoch: 12 cost time: 0.5151402950286865
Epoch: 12, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.742 Vali Acc: 0.815 Test Loss: 0.742 Test Acc: 0.815
Validation loss decreased (-0.785177 --> -0.814807).  Saving model ...
Epoch: 13 cost time: 0.5359537601470947
Epoch: 13, Steps: 2 | Train Loss: 0.602 Vali Loss: 0.670 Vali Acc: 0.826 Test Loss: 0.670 Test Acc: 0.826
Validation loss decreased (-0.814807 --> -0.825919).  Saving model ...
Epoch: 14 cost time: 0.5647737979888916
Epoch: 14, Steps: 2 | Train Loss: 0.551 Vali Loss: 0.608 Vali Acc: 0.841 Test Loss: 0.608 Test Acc: 0.841
Validation loss decreased (-0.825919 --> -0.840735).  Saving model ...
Epoch: 15 cost time: 0.4858567714691162
Epoch: 15, Steps: 2 | Train Loss: 0.414 Vali Loss: 0.552 Vali Acc: 0.870 Test Loss: 0.552 Test Acc: 0.870
Validation loss decreased (-0.840735 --> -0.870365).  Saving model ...
Epoch: 16 cost time: 0.49472546577453613
Epoch: 16, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.504 Vali Acc: 0.881 Test Loss: 0.504 Test Acc: 0.881
Validation loss decreased (-0.870365 --> -0.881476).  Saving model ...
Epoch: 17 cost time: 0.4935483932495117
Epoch: 17, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.462 Vali Acc: 0.893 Test Loss: 0.462 Test Acc: 0.893
Validation loss decreased (-0.881476 --> -0.892588).  Saving model ...
Epoch: 18 cost time: 0.5027866363525391
Epoch: 18, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.425 Vali Acc: 0.896 Test Loss: 0.425 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.5087301731109619
Epoch: 19, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.5002932548522949
Epoch: 20, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.369 Vali Acc: 0.904 Test Loss: 0.369 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 21 cost time: 0.4720156192779541
Epoch: 21, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.348 Vali Acc: 0.900 Test Loss: 0.348 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.499147891998291
Epoch: 22, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.331 Vali Acc: 0.907 Test Loss: 0.331 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.5210304260253906
Epoch: 23, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.318 Vali Acc: 0.907 Test Loss: 0.318 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 24 cost time: 0.5523302555084229
Epoch: 24, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.907 Test Loss: 0.305 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 25 cost time: 0.49640846252441406
Epoch: 25, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.295 Vali Acc: 0.915 Test Loss: 0.295 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.5182008743286133
Epoch: 26, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.5152757167816162
Epoch: 27, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.277 Vali Acc: 0.915 Test Loss: 0.277 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 28 cost time: 0.49527668952941895
Epoch: 28, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.270 Vali Acc: 0.915 Test Loss: 0.270 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 29 cost time: 0.5279414653778076
Epoch: 29, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.264 Vali Acc: 0.915 Test Loss: 0.264 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 30 cost time: 0.5401182174682617
Epoch: 30, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 31 cost time: 0.5561022758483887
Epoch: 31, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 32 cost time: 0.5622870922088623
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 33 cost time: 0.49705934524536133
Epoch: 33, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.489795446395874
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.249 Vali Acc: 0.915 Test Loss: 0.249 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4852023124694824
Epoch: 35, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.247 Vali Acc: 0.915 Test Loss: 0.247 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4925556182861328
Epoch: 36, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5350539684295654
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.243 Vali Acc: 0.919 Test Loss: 0.243 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 38 cost time: 0.47858095169067383
Epoch: 38, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.5304255485534668
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.240 Vali Acc: 0.919 Test Loss: 0.240 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.5295867919921875
Epoch: 40, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.5083634853363037
Epoch: 41, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 42 cost time: 0.4847440719604492
Epoch: 42, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 0.5400948524475098
Epoch: 43, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.237 Vali Acc: 0.922 Test Loss: 0.237 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 44 cost time: 0.49893736839294434
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.236 Vali Acc: 0.922 Test Loss: 0.236 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 45 cost time: 0.5070991516113281
Epoch: 45, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 46 cost time: 0.5286777019500732
Epoch: 46, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 47 cost time: 0.4767930507659912
Epoch: 47, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.922 Test Loss: 0.235 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 48 cost time: 0.49222278594970703
Epoch: 48, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 49 cost time: 0.5122890472412109
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 50 cost time: 0.5601506233215332
Epoch: 50, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 51 cost time: 0.5235865116119385
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 52 cost time: 0.49660491943359375
Epoch: 52, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 53 cost time: 0.5259101390838623
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 54 cost time: 0.5157666206359863
Epoch: 54, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 55 cost time: 0.5526461601257324
Epoch: 55, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.234 Vali Acc: 0.919 Test Loss: 0.234 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 56 cost time: 0.5985243320465088
Epoch: 56, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 57 cost time: 0.5773739814758301
Epoch: 57, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 58 cost time: 0.602475643157959
Epoch: 58, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9222222222222223
model parameter : 297382
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9799234867095947
Epoch: 1, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.717 Vali Acc: 0.252 Test Loss: 1.717 Test Acc: 0.252
Validation loss decreased (inf --> -0.251835).  Saving model ...
Epoch: 2 cost time: 0.5075485706329346
Epoch: 2, Steps: 2 | Train Loss: 1.720 Vali Loss: 1.634 Vali Acc: 0.315 Test Loss: 1.634 Test Acc: 0.315
Validation loss decreased (-0.251835 --> -0.314798).  Saving model ...
Epoch: 3 cost time: 0.4730386734008789
Epoch: 3, Steps: 2 | Train Loss: 1.556 Vali Loss: 1.569 Vali Acc: 0.367 Test Loss: 1.569 Test Acc: 0.367
Validation loss decreased (-0.314798 --> -0.366651).  Saving model ...
Epoch: 4 cost time: 0.43280673027038574
Epoch: 4, Steps: 2 | Train Loss: 1.514 Vali Loss: 1.501 Vali Acc: 0.437 Test Loss: 1.501 Test Acc: 0.437
Validation loss decreased (-0.366651 --> -0.437022).  Saving model ...
Epoch: 5 cost time: 0.40670228004455566
Epoch: 5, Steps: 2 | Train Loss: 1.562 Vali Loss: 1.417 Vali Acc: 0.607 Test Loss: 1.417 Test Acc: 0.607
Validation loss decreased (-0.437022 --> -0.607393).  Saving model ...
Epoch: 6 cost time: 0.42235231399536133
Epoch: 6, Steps: 2 | Train Loss: 1.315 Vali Loss: 1.325 Vali Acc: 0.674 Test Loss: 1.325 Test Acc: 0.674
Validation loss decreased (-0.607393 --> -0.674061).  Saving model ...
Epoch: 7 cost time: 0.39723873138427734
Epoch: 7, Steps: 2 | Train Loss: 1.232 Vali Loss: 1.227 Vali Acc: 0.722 Test Loss: 1.227 Test Acc: 0.722
Validation loss decreased (-0.674061 --> -0.722210).  Saving model ...
Epoch: 8 cost time: 0.45631861686706543
Epoch: 8, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.129 Vali Acc: 0.741 Test Loss: 1.129 Test Acc: 0.741
Validation loss decreased (-0.722210 --> -0.740729).  Saving model ...
Epoch: 9 cost time: 0.4663558006286621
Epoch: 9, Steps: 2 | Train Loss: 1.029 Vali Loss: 1.034 Vali Acc: 0.744 Test Loss: 1.034 Test Acc: 0.744
Validation loss decreased (-0.740729 --> -0.744434).  Saving model ...
Epoch: 10 cost time: 0.4239189624786377
Epoch: 10, Steps: 2 | Train Loss: 0.943 Vali Loss: 0.942 Vali Acc: 0.756 Test Loss: 0.942 Test Acc: 0.756
Validation loss decreased (-0.744434 --> -0.755546).  Saving model ...
Epoch: 11 cost time: 0.47026944160461426
Epoch: 11, Steps: 2 | Train Loss: 0.804 Vali Loss: 0.857 Vali Acc: 0.767 Test Loss: 0.857 Test Acc: 0.767
Validation loss decreased (-0.755546 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 0.5057032108306885
Epoch: 12, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.781 Vali Acc: 0.789 Test Loss: 0.781 Test Acc: 0.789
Validation loss decreased (-0.766658 --> -0.788881).  Saving model ...
Epoch: 13 cost time: 0.501737117767334
Epoch: 13, Steps: 2 | Train Loss: 0.651 Vali Loss: 0.716 Vali Acc: 0.807 Test Loss: 0.716 Test Acc: 0.807
Validation loss decreased (-0.788881 --> -0.807400).  Saving model ...
Epoch: 14 cost time: 0.4782280921936035
Epoch: 14, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.659 Vali Acc: 0.822 Test Loss: 0.659 Test Acc: 0.822
Validation loss decreased (-0.807400 --> -0.822216).  Saving model ...
Epoch: 15 cost time: 0.47835612297058105
Epoch: 15, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.609 Vali Acc: 0.826 Test Loss: 0.609 Test Acc: 0.826
Validation loss decreased (-0.822216 --> -0.825920).  Saving model ...
Epoch: 16 cost time: 0.4974677562713623
Epoch: 16, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.566 Vali Acc: 0.833 Test Loss: 0.566 Test Acc: 0.833
Validation loss decreased (-0.825920 --> -0.833328).  Saving model ...
Epoch: 17 cost time: 0.4677596092224121
Epoch: 17, Steps: 2 | Train Loss: 0.375 Vali Loss: 0.528 Vali Acc: 0.856 Test Loss: 0.528 Test Acc: 0.856
Validation loss decreased (-0.833328 --> -0.855550).  Saving model ...
Epoch: 18 cost time: 0.5212104320526123
Epoch: 18, Steps: 2 | Train Loss: 0.336 Vali Loss: 0.495 Vali Acc: 0.856 Test Loss: 0.495 Test Acc: 0.856
Validation loss decreased (-0.855550 --> -0.855551).  Saving model ...
Epoch: 19 cost time: 0.5059685707092285
Epoch: 19, Steps: 2 | Train Loss: 0.292 Vali Loss: 0.467 Vali Acc: 0.859 Test Loss: 0.467 Test Acc: 0.859
Validation loss decreased (-0.855551 --> -0.859255).  Saving model ...
Epoch: 20 cost time: 0.5158133506774902
Epoch: 20, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.445 Vali Acc: 0.867 Test Loss: 0.445 Test Acc: 0.867
Validation loss decreased (-0.859255 --> -0.866662).  Saving model ...
Epoch: 21 cost time: 0.49348974227905273
Epoch: 21, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.425 Vali Acc: 0.870 Test Loss: 0.425 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 22 cost time: 0.4792022705078125
Epoch: 22, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.409 Vali Acc: 0.870 Test Loss: 0.409 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 23 cost time: 0.5001575946807861
Epoch: 23, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.396 Vali Acc: 0.878 Test Loss: 0.396 Test Acc: 0.878
Validation loss decreased (-0.870366 --> -0.877774).  Saving model ...
Epoch: 24 cost time: 0.5155744552612305
Epoch: 24, Steps: 2 | Train Loss: 0.211 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 25 cost time: 0.49240946769714355
Epoch: 25, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.374 Vali Acc: 0.881 Test Loss: 0.374 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 26 cost time: 0.4570441246032715
Epoch: 26, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.365 Vali Acc: 0.896 Test Loss: 0.365 Test Acc: 0.896
Validation loss decreased (-0.881478 --> -0.896293).  Saving model ...
Epoch: 27 cost time: 0.5015058517456055
Epoch: 27, Steps: 2 | Train Loss: 0.134 Vali Loss: 0.357 Vali Acc: 0.893 Test Loss: 0.357 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.42126035690307617
Epoch: 28, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.350 Vali Acc: 0.893 Test Loss: 0.350 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.41249895095825195
Epoch: 29, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.345 Vali Acc: 0.893 Test Loss: 0.345 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 0.43422532081604004
Epoch: 30, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.340 Vali Acc: 0.885 Test Loss: 0.340 Test Acc: 0.885
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 0.4542558193206787
Epoch: 31, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.336 Vali Acc: 0.889 Test Loss: 0.336 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 0.47533130645751953
Epoch: 32, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.333 Vali Acc: 0.874 Test Loss: 0.333 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 0.4508340358734131
Epoch: 33, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.330 Vali Acc: 0.874 Test Loss: 0.330 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 0.43910956382751465
Epoch: 34, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.326 Vali Acc: 0.874 Test Loss: 0.326 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 0.41668152809143066
Epoch: 35, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.324 Vali Acc: 0.870 Test Loss: 0.324 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 0.4172995090484619
Epoch: 36, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.320 Vali Acc: 0.878 Test Loss: 0.320 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 297382
model size : 2.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1774375438690186
Epoch: 1, Steps: 2 | Train Loss: 2.039 Vali Loss: 1.901 Vali Acc: 0.274 Test Loss: 1.901 Test Acc: 0.274
Validation loss decreased (inf --> -0.274055).  Saving model ...
Epoch: 2 cost time: 0.4553840160369873
Epoch: 2, Steps: 2 | Train Loss: 1.985 Vali Loss: 1.805 Vali Acc: 0.322 Test Loss: 1.805 Test Acc: 0.322
Validation loss decreased (-0.274055 --> -0.322204).  Saving model ...
Epoch: 3 cost time: 0.5065739154815674
Epoch: 3, Steps: 2 | Train Loss: 1.832 Vali Loss: 1.730 Vali Acc: 0.341 Test Loss: 1.730 Test Acc: 0.341
Validation loss decreased (-0.322204 --> -0.340723).  Saving model ...
Epoch: 4 cost time: 0.5209665298461914
Epoch: 4, Steps: 2 | Train Loss: 1.897 Vali Loss: 1.648 Vali Acc: 0.363 Test Loss: 1.648 Test Acc: 0.363
Validation loss decreased (-0.340723 --> -0.362946).  Saving model ...
Epoch: 5 cost time: 0.4292128086090088
Epoch: 5, Steps: 2 | Train Loss: 1.670 Vali Loss: 1.546 Vali Acc: 0.415 Test Loss: 1.546 Test Acc: 0.415
Validation loss decreased (-0.362946 --> -0.414799).  Saving model ...
Epoch: 6 cost time: 0.5260169506072998
Epoch: 6, Steps: 2 | Train Loss: 1.630 Vali Loss: 1.433 Vali Acc: 0.493 Test Loss: 1.433 Test Acc: 0.493
Validation loss decreased (-0.414799 --> -0.492578).  Saving model ...
Epoch: 7 cost time: 0.4681396484375
Epoch: 7, Steps: 2 | Train Loss: 1.372 Vali Loss: 1.314 Vali Acc: 0.559 Test Loss: 1.314 Test Acc: 0.559
Validation loss decreased (-0.492578 --> -0.559246).  Saving model ...
Epoch: 8 cost time: 0.4396629333496094
Epoch: 8, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.196 Vali Acc: 0.648 Test Loss: 1.196 Test Acc: 0.648
Validation loss decreased (-0.559246 --> -0.648136).  Saving model ...
Epoch: 9 cost time: 0.5857131481170654
Epoch: 9, Steps: 2 | Train Loss: 1.114 Vali Loss: 1.081 Vali Acc: 0.741 Test Loss: 1.081 Test Acc: 0.741
Validation loss decreased (-0.648136 --> -0.740730).  Saving model ...
Epoch: 10 cost time: 0.4675726890563965
Epoch: 10, Steps: 2 | Train Loss: 0.945 Vali Loss: 0.974 Vali Acc: 0.811 Test Loss: 0.974 Test Acc: 0.811
Validation loss decreased (-0.740730 --> -0.811101).  Saving model ...
Epoch: 11 cost time: 0.46413087844848633
Epoch: 11, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.875 Vali Acc: 0.856 Test Loss: 0.875 Test Acc: 0.856
Validation loss decreased (-0.811101 --> -0.855547).  Saving model ...
Epoch: 12 cost time: 0.4199867248535156
Epoch: 12, Steps: 2 | Train Loss: 0.816 Vali Loss: 0.785 Vali Acc: 0.859 Test Loss: 0.785 Test Acc: 0.859
Validation loss decreased (-0.855547 --> -0.859251).  Saving model ...
Epoch: 13 cost time: 0.4501945972442627
Epoch: 13, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.702 Vali Acc: 0.874 Test Loss: 0.702 Test Acc: 0.874
Validation loss decreased (-0.859251 --> -0.874067).  Saving model ...
Epoch: 14 cost time: 0.4375040531158447
Epoch: 14, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.628 Vali Acc: 0.893 Test Loss: 0.628 Test Acc: 0.893
Validation loss decreased (-0.874067 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.48316073417663574
Epoch: 15, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.563 Vali Acc: 0.896 Test Loss: 0.563 Test Acc: 0.896
Validation loss decreased (-0.892586 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.470975399017334
Epoch: 16, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.507 Vali Acc: 0.911 Test Loss: 0.507 Test Acc: 0.911
Validation loss decreased (-0.896291 --> -0.911106).  Saving model ...
Epoch: 17 cost time: 0.4225625991821289
Epoch: 17, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.457 Vali Acc: 0.926 Test Loss: 0.457 Test Acc: 0.926
Validation loss decreased (-0.911106 --> -0.925921).  Saving model ...
Epoch: 18 cost time: 0.40732812881469727
Epoch: 18, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.414 Vali Acc: 0.930 Test Loss: 0.414 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 19 cost time: 0.43829989433288574
Epoch: 19, Steps: 2 | Train Loss: 0.208 Vali Loss: 0.378 Vali Acc: 0.937 Test Loss: 0.378 Test Acc: 0.937
Validation loss decreased (-0.929625 --> -0.937033).  Saving model ...
Epoch: 20 cost time: 0.3907907009124756
Epoch: 20, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.348 Vali Acc: 0.933 Test Loss: 0.348 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.48433399200439453
Epoch: 21, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.324 Vali Acc: 0.933 Test Loss: 0.324 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.4179267883300781
Epoch: 22, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.306 Vali Acc: 0.922 Test Loss: 0.306 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.42470598220825195
Epoch: 23, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.290 Vali Acc: 0.922 Test Loss: 0.290 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.46188974380493164
Epoch: 24, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.275 Vali Acc: 0.926 Test Loss: 0.275 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 0.47239160537719727
Epoch: 25, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 0.44290757179260254
Epoch: 26, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.255 Vali Acc: 0.933 Test Loss: 0.255 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 0.49236011505126953
Epoch: 27, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.247 Vali Acc: 0.933 Test Loss: 0.247 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 0.5207526683807373
Epoch: 28, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.240 Vali Acc: 0.933 Test Loss: 0.240 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 0.5322291851043701
Epoch: 29, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 166310
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0378527641296387
Epoch: 1, Steps: 2 | Train Loss: 2.028 Vali Loss: 1.885 Vali Acc: 0.300 Test Loss: 1.885 Test Acc: 0.300
Validation loss decreased (inf --> -0.299981).  Saving model ...
Epoch: 2 cost time: 0.47464919090270996
Epoch: 2, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.789 Vali Acc: 0.326 Test Loss: 1.789 Test Acc: 0.326
Validation loss decreased (-0.299981 --> -0.325908).  Saving model ...
Epoch: 3 cost time: 0.4752838611602783
Epoch: 3, Steps: 2 | Train Loss: 1.865 Vali Loss: 1.715 Vali Acc: 0.344 Test Loss: 1.715 Test Acc: 0.344
Validation loss decreased (-0.325908 --> -0.344427).  Saving model ...
Epoch: 4 cost time: 0.4694230556488037
Epoch: 4, Steps: 2 | Train Loss: 1.889 Vali Loss: 1.634 Vali Acc: 0.393 Test Loss: 1.634 Test Acc: 0.393
Validation loss decreased (-0.344427 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.518291711807251
Epoch: 5, Steps: 2 | Train Loss: 1.696 Vali Loss: 1.533 Vali Acc: 0.452 Test Loss: 1.533 Test Acc: 0.452
Validation loss decreased (-0.392576 --> -0.451837).  Saving model ...
Epoch: 6 cost time: 0.5035464763641357
Epoch: 6, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.421 Vali Acc: 0.522 Test Loss: 1.421 Test Acc: 0.522
Validation loss decreased (-0.451837 --> -0.522208).  Saving model ...
Epoch: 7 cost time: 0.49354124069213867
Epoch: 7, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.304 Vali Acc: 0.589 Test Loss: 1.304 Test Acc: 0.589
Validation loss decreased (-0.522208 --> -0.588876).  Saving model ...
Epoch: 8 cost time: 0.5381720066070557
Epoch: 8, Steps: 2 | Train Loss: 1.304 Vali Loss: 1.188 Vali Acc: 0.656 Test Loss: 1.188 Test Acc: 0.656
Validation loss decreased (-0.588876 --> -0.655544).  Saving model ...
Epoch: 9 cost time: 0.5040814876556396
Epoch: 9, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.074 Vali Acc: 0.741 Test Loss: 1.074 Test Acc: 0.741
Validation loss decreased (-0.655544 --> -0.740730).  Saving model ...
Epoch: 10 cost time: 0.4592568874359131
Epoch: 10, Steps: 2 | Train Loss: 0.972 Vali Loss: 0.969 Vali Acc: 0.793 Test Loss: 0.969 Test Acc: 0.793
Validation loss decreased (-0.740730 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 0.4827601909637451
Epoch: 11, Steps: 2 | Train Loss: 0.789 Vali Loss: 0.872 Vali Acc: 0.844 Test Loss: 0.872 Test Acc: 0.844
Validation loss decreased (-0.792583 --> -0.844436).  Saving model ...
Epoch: 12 cost time: 0.48601245880126953
Epoch: 12, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.782 Vali Acc: 0.878 Test Loss: 0.782 Test Acc: 0.878
Validation loss decreased (-0.844436 --> -0.877770).  Saving model ...
Epoch: 13 cost time: 0.5176148414611816
Epoch: 13, Steps: 2 | Train Loss: 0.668 Vali Loss: 0.701 Vali Acc: 0.885 Test Loss: 0.701 Test Acc: 0.885
Validation loss decreased (-0.877770 --> -0.885178).  Saving model ...
Epoch: 14 cost time: 0.5611035823822021
Epoch: 14, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.628 Vali Acc: 0.893 Test Loss: 0.628 Test Acc: 0.893
Validation loss decreased (-0.885178 --> -0.892586).  Saving model ...
Epoch: 15 cost time: 0.45784974098205566
Epoch: 15, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.563 Vali Acc: 0.904 Test Loss: 0.563 Test Acc: 0.904
Validation loss decreased (-0.892586 --> -0.903698).  Saving model ...
Epoch: 16 cost time: 0.4413623809814453
Epoch: 16, Steps: 2 | Train Loss: 0.481 Vali Loss: 0.508 Vali Acc: 0.907 Test Loss: 0.508 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 17 cost time: 0.43276286125183105
Epoch: 17, Steps: 2 | Train Loss: 0.344 Vali Loss: 0.460 Vali Acc: 0.922 Test Loss: 0.460 Test Acc: 0.922
Validation loss decreased (-0.907402 --> -0.922218).  Saving model ...
Epoch: 18 cost time: 0.43164753913879395
Epoch: 18, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.418 Vali Acc: 0.926 Test Loss: 0.418 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 19 cost time: 0.4656672477722168
Epoch: 19, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.382 Vali Acc: 0.922 Test Loss: 0.382 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4762406349182129
Epoch: 20, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 21 cost time: 0.46504974365234375
Epoch: 21, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.330 Vali Acc: 0.922 Test Loss: 0.330 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4857048988342285
Epoch: 22, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.311 Vali Acc: 0.919 Test Loss: 0.311 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.47339606285095215
Epoch: 23, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.48026418685913086
Epoch: 24, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.281 Vali Acc: 0.922 Test Loss: 0.281 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4714951515197754
Epoch: 25, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.269 Vali Acc: 0.919 Test Loss: 0.269 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.4613616466522217
Epoch: 26, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.259 Vali Acc: 0.919 Test Loss: 0.259 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.4791889190673828
Epoch: 27, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.49652099609375
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.4792478084564209
Epoch: 29, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.45398688316345215
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 31 cost time: 0.5063261985778809
Epoch: 31, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 32 cost time: 0.45804834365844727
Epoch: 32, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 33 cost time: 0.48624134063720703
Epoch: 33, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 34 cost time: 0.46994996070861816
Epoch: 34, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4205935001373291
Epoch: 35, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.220 Vali Acc: 0.922 Test Loss: 0.220 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.42221784591674805
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.922 Test Loss: 0.219 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4365851879119873
Epoch: 37, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.922 Test Loss: 0.218 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.4319140911102295
Epoch: 38, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.46669507026672363
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.44843196868896484
Epoch: 40, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.381603479385376
Epoch: 41, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.414076566696167
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.41653966903686523
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 166310
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1719233989715576
Epoch: 1, Steps: 2 | Train Loss: 2.072 Vali Loss: 1.881 Vali Acc: 0.281 Test Loss: 1.881 Test Acc: 0.281
Validation loss decreased (inf --> -0.281463).  Saving model ...
Epoch: 2 cost time: 0.49109673500061035
Epoch: 2, Steps: 2 | Train Loss: 1.949 Vali Loss: 1.787 Vali Acc: 0.304 Test Loss: 1.787 Test Acc: 0.304
Validation loss decreased (-0.281463 --> -0.303686).  Saving model ...
Epoch: 3 cost time: 0.515667200088501
Epoch: 3, Steps: 2 | Train Loss: 1.856 Vali Loss: 1.714 Vali Acc: 0.356 Test Loss: 1.714 Test Acc: 0.356
Validation loss decreased (-0.303686 --> -0.355538).  Saving model ...
Epoch: 4 cost time: 0.4969308376312256
Epoch: 4, Steps: 2 | Train Loss: 1.899 Vali Loss: 1.635 Vali Acc: 0.404 Test Loss: 1.635 Test Acc: 0.404
Validation loss decreased (-0.355538 --> -0.403687).  Saving model ...
Epoch: 5 cost time: 0.41869425773620605
Epoch: 5, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.537 Vali Acc: 0.456 Test Loss: 1.537 Test Acc: 0.456
Validation loss decreased (-0.403687 --> -0.455540).  Saving model ...
Epoch: 6 cost time: 0.4562861919403076
Epoch: 6, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.428 Vali Acc: 0.530 Test Loss: 1.428 Test Acc: 0.530
Validation loss decreased (-0.455540 --> -0.529615).  Saving model ...
Epoch: 7 cost time: 0.45307302474975586
Epoch: 7, Steps: 2 | Train Loss: 1.397 Vali Loss: 1.313 Vali Acc: 0.619 Test Loss: 1.313 Test Acc: 0.619
Validation loss decreased (-0.529615 --> -0.618505).  Saving model ...
Epoch: 8 cost time: 0.4602367877960205
Epoch: 8, Steps: 2 | Train Loss: 1.306 Vali Loss: 1.199 Vali Acc: 0.678 Test Loss: 1.199 Test Acc: 0.678
Validation loss decreased (-0.618505 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 0.4846479892730713
Epoch: 9, Steps: 2 | Train Loss: 1.129 Vali Loss: 1.088 Vali Acc: 0.744 Test Loss: 1.088 Test Acc: 0.744
Validation loss decreased (-0.677766 --> -0.744434).  Saving model ...
Epoch: 10 cost time: 0.5006351470947266
Epoch: 10, Steps: 2 | Train Loss: 0.980 Vali Loss: 0.986 Vali Acc: 0.781 Test Loss: 0.986 Test Acc: 0.781
Validation loss decreased (-0.744434 --> -0.781472).  Saving model ...
Epoch: 11 cost time: 0.4672122001647949
Epoch: 11, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.891 Vali Acc: 0.826 Test Loss: 0.891 Test Acc: 0.826
Validation loss decreased (-0.781472 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.4703209400177002
Epoch: 12, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.804 Vali Acc: 0.863 Test Loss: 0.804 Test Acc: 0.863
Validation loss decreased (-0.825917 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.45726680755615234
Epoch: 13, Steps: 2 | Train Loss: 0.701 Vali Loss: 0.725 Vali Acc: 0.859 Test Loss: 0.725 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.5359561443328857
Epoch: 14, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.655 Vali Acc: 0.867 Test Loss: 0.655 Test Acc: 0.867
Validation loss decreased (-0.862955 --> -0.866660).  Saving model ...
Epoch: 15 cost time: 0.44617772102355957
Epoch: 15, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.592 Vali Acc: 0.870 Test Loss: 0.592 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 16 cost time: 0.45947718620300293
Epoch: 16, Steps: 2 | Train Loss: 0.497 Vali Loss: 0.538 Vali Acc: 0.885 Test Loss: 0.538 Test Acc: 0.885
Validation loss decreased (-0.870364 --> -0.885180).  Saving model ...
Epoch: 17 cost time: 0.4538695812225342
Epoch: 17, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.491 Vali Acc: 0.896 Test Loss: 0.491 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 18 cost time: 0.513702392578125
Epoch: 18, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.449 Vali Acc: 0.900 Test Loss: 0.449 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.47284531593322754
Epoch: 19, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.414 Vali Acc: 0.907 Test Loss: 0.414 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907403).  Saving model ...
Epoch: 20 cost time: 0.4949374198913574
Epoch: 20, Steps: 2 | Train Loss: 0.216 Vali Loss: 0.385 Vali Acc: 0.911 Test Loss: 0.385 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 21 cost time: 0.5263574123382568
Epoch: 21, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.361 Vali Acc: 0.904 Test Loss: 0.361 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.59659743309021
Epoch: 22, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.342 Vali Acc: 0.911 Test Loss: 0.342 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.5179767608642578
Epoch: 23, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.325 Vali Acc: 0.915 Test Loss: 0.325 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.5015277862548828
Epoch: 24, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.309 Vali Acc: 0.911 Test Loss: 0.309 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4739854335784912
Epoch: 25, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5204892158508301
Epoch: 26, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.545753002166748
Epoch: 27, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.278 Vali Acc: 0.907 Test Loss: 0.278 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 0.5196390151977539
Epoch: 28, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 0.5098085403442383
Epoch: 29, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.264 Vali Acc: 0.907 Test Loss: 0.264 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 0.5555005073547363
Epoch: 30, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.258 Vali Acc: 0.907 Test Loss: 0.258 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 0.4973607063293457
Epoch: 31, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.254 Vali Acc: 0.907 Test Loss: 0.254 Test Acc: 0.907
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 0.48064494132995605
Epoch: 32, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 0.5059590339660645
Epoch: 33, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.246 Vali Acc: 0.907 Test Loss: 0.246 Test Acc: 0.907
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 166310
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2385447025299072
Epoch: 1, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.870 Vali Acc: 0.333 Test Loss: 1.870 Test Acc: 0.333
Validation loss decreased (inf --> -0.333315).  Saving model ...
Epoch: 2 cost time: 0.48650193214416504
Epoch: 2, Steps: 2 | Train Loss: 1.969 Vali Loss: 1.784 Vali Acc: 0.378 Test Loss: 1.784 Test Acc: 0.378
Validation loss decreased (-0.333315 --> -0.377760).  Saving model ...
Epoch: 3 cost time: 0.48694300651550293
Epoch: 3, Steps: 2 | Train Loss: 1.861 Vali Loss: 1.717 Vali Acc: 0.389 Test Loss: 1.717 Test Acc: 0.389
Validation loss decreased (-0.377760 --> -0.388872).  Saving model ...
Epoch: 4 cost time: 0.43245625495910645
Epoch: 4, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.644 Vali Acc: 0.430 Test Loss: 1.644 Test Acc: 0.430
Validation loss decreased (-0.388872 --> -0.429613).  Saving model ...
Epoch: 5 cost time: 0.46749091148376465
Epoch: 5, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.554 Vali Acc: 0.489 Test Loss: 1.554 Test Acc: 0.489
Validation loss decreased (-0.429613 --> -0.488873).  Saving model ...
Epoch: 6 cost time: 0.5409023761749268
Epoch: 6, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.453 Vali Acc: 0.556 Test Loss: 1.453 Test Acc: 0.556
Validation loss decreased (-0.488873 --> -0.555541).  Saving model ...
Epoch: 7 cost time: 0.5068271160125732
Epoch: 7, Steps: 2 | Train Loss: 1.413 Vali Loss: 1.346 Vali Acc: 0.641 Test Loss: 1.346 Test Acc: 0.641
Validation loss decreased (-0.555541 --> -0.640727).  Saving model ...
Epoch: 8 cost time: 0.421816349029541
Epoch: 8, Steps: 2 | Train Loss: 1.311 Vali Loss: 1.240 Vali Acc: 0.678 Test Loss: 1.240 Test Acc: 0.678
Validation loss decreased (-0.640727 --> -0.677765).  Saving model ...
Epoch: 9 cost time: 0.4576418399810791
Epoch: 9, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.137 Vali Acc: 0.711 Test Loss: 1.137 Test Acc: 0.711
Validation loss decreased (-0.677765 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 0.39756131172180176
Epoch: 10, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.041 Vali Acc: 0.730 Test Loss: 1.041 Test Acc: 0.730
Validation loss decreased (-0.711100 --> -0.729619).  Saving model ...
Epoch: 11 cost time: 0.45291638374328613
Epoch: 11, Steps: 2 | Train Loss: 0.891 Vali Loss: 0.950 Vali Acc: 0.756 Test Loss: 0.950 Test Acc: 0.756
Validation loss decreased (-0.729619 --> -0.755546).  Saving model ...
Epoch: 12 cost time: 0.5060946941375732
Epoch: 12, Steps: 2 | Train Loss: 0.887 Vali Loss: 0.868 Vali Acc: 0.793 Test Loss: 0.868 Test Acc: 0.793
Validation loss decreased (-0.755546 --> -0.792584).  Saving model ...
Epoch: 13 cost time: 0.467299222946167
Epoch: 13, Steps: 2 | Train Loss: 0.809 Vali Loss: 0.792 Vali Acc: 0.848 Test Loss: 0.792 Test Acc: 0.848
Validation loss decreased (-0.792584 --> -0.848140).  Saving model ...
Epoch: 14 cost time: 0.49886655807495117
Epoch: 14, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.726 Vali Acc: 0.856 Test Loss: 0.726 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 15 cost time: 0.535128116607666
Epoch: 15, Steps: 2 | Train Loss: 0.642 Vali Loss: 0.667 Vali Acc: 0.874 Test Loss: 0.667 Test Acc: 0.874
Validation loss decreased (-0.855548 --> -0.874067).  Saving model ...
Epoch: 16 cost time: 0.495635986328125
Epoch: 16, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.617 Vali Acc: 0.867 Test Loss: 0.617 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.5669229030609131
Epoch: 17, Steps: 2 | Train Loss: 0.486 Vali Loss: 0.572 Vali Acc: 0.870 Test Loss: 0.572 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.483034610748291
Epoch: 18, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.533 Vali Acc: 0.870 Test Loss: 0.533 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 0.5505077838897705
Epoch: 19, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.498 Vali Acc: 0.874 Test Loss: 0.498 Test Acc: 0.874
Validation loss decreased (-0.874067 --> -0.874069).  Saving model ...
Epoch: 20 cost time: 0.49498581886291504
Epoch: 20, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.471 Vali Acc: 0.878 Test Loss: 0.471 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 21 cost time: 0.5391218662261963
Epoch: 21, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5055007934570312
Epoch: 22, Steps: 2 | Train Loss: 0.287 Vali Loss: 0.428 Vali Acc: 0.867 Test Loss: 0.428 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5085353851318359
Epoch: 23, Steps: 2 | Train Loss: 0.222 Vali Loss: 0.411 Vali Acc: 0.874 Test Loss: 0.411 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4939084053039551
Epoch: 24, Steps: 2 | Train Loss: 0.210 Vali Loss: 0.397 Vali Acc: 0.874 Test Loss: 0.397 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4925394058227539
Epoch: 25, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.384 Vali Acc: 0.885 Test Loss: 0.384 Test Acc: 0.885
Validation loss decreased (-0.877773 --> -0.885181).  Saving model ...
Epoch: 26 cost time: 0.4852712154388428
Epoch: 26, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.371 Vali Acc: 0.881 Test Loss: 0.371 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 0.4843156337738037
Epoch: 27, Steps: 2 | Train Loss: 0.199 Vali Loss: 0.359 Vali Acc: 0.893 Test Loss: 0.359 Test Acc: 0.893
Validation loss decreased (-0.885181 --> -0.892589).  Saving model ...
Epoch: 28 cost time: 0.46814393997192383
Epoch: 28, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.350 Vali Acc: 0.889 Test Loss: 0.350 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.47168397903442383
Epoch: 29, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.342 Vali Acc: 0.893 Test Loss: 0.342 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 30 cost time: 0.412477970123291
Epoch: 30, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.336 Vali Acc: 0.893 Test Loss: 0.336 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 31 cost time: 0.4252195358276367
Epoch: 31, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.330 Vali Acc: 0.893 Test Loss: 0.330 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 32 cost time: 0.44293713569641113
Epoch: 32, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.324 Vali Acc: 0.893 Test Loss: 0.324 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 33 cost time: 0.4506559371948242
Epoch: 33, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4772660732269287
Epoch: 34, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.317 Vali Acc: 0.893 Test Loss: 0.317 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 35 cost time: 0.5049731731414795
Epoch: 35, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.314 Vali Acc: 0.889 Test Loss: 0.314 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.429046630859375
Epoch: 36, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.311 Vali Acc: 0.896 Test Loss: 0.311 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 37 cost time: 0.4321284294128418
Epoch: 37, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.49410486221313477
Epoch: 38, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5312235355377197
Epoch: 39, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.5287744998931885
Epoch: 40, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.5210332870483398
Epoch: 41, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.484102725982666
Epoch: 42, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.299 Vali Acc: 0.893 Test Loss: 0.299 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 43 cost time: 0.4956245422363281
Epoch: 43, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.297 Vali Acc: 0.896 Test Loss: 0.297 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 44 cost time: 0.4714813232421875
Epoch: 44, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 0.48580098152160645
Epoch: 45, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.294 Vali Acc: 0.900 Test Loss: 0.294 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 0.4641265869140625
Epoch: 46, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 47 cost time: 0.4742152690887451
Epoch: 47, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.291 Vali Acc: 0.904 Test Loss: 0.291 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5239942073822021
Epoch: 48, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.291 Vali Acc: 0.904 Test Loss: 0.291 Test Acc: 0.904
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.47073936462402344
Epoch: 49, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5119831562042236
Epoch: 50, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.292 Vali Acc: 0.896 Test Loss: 0.292 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.49419569969177246
Epoch: 51, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5462148189544678
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.291 Vali Acc: 0.893 Test Loss: 0.291 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.5210697650909424
Epoch: 53, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.290 Vali Acc: 0.896 Test Loss: 0.290 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.48543643951416016
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.289 Vali Acc: 0.896 Test Loss: 0.289 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.48958349227905273
Epoch: 55, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.286 Vali Acc: 0.896 Test Loss: 0.286 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.45906591415405273
Epoch: 56, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.286 Vali Acc: 0.904 Test Loss: 0.286 Test Acc: 0.904
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 166310
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9966771602630615
Epoch: 1, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.777 Vali Acc: 0.170 Test Loss: 1.777 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.48689723014831543
Epoch: 2, Steps: 2 | Train Loss: 1.722 Vali Loss: 1.692 Vali Acc: 0.207 Test Loss: 1.692 Test Acc: 0.207
Validation loss decreased (-0.170353 --> -0.207390).  Saving model ...
Epoch: 3 cost time: 0.596400260925293
Epoch: 3, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.623 Vali Acc: 0.267 Test Loss: 1.623 Test Acc: 0.267
Validation loss decreased (-0.207390 --> -0.266650).  Saving model ...
Epoch: 4 cost time: 0.5235395431518555
Epoch: 4, Steps: 2 | Train Loss: 1.500 Vali Loss: 1.546 Vali Acc: 0.344 Test Loss: 1.546 Test Acc: 0.344
Validation loss decreased (-0.266650 --> -0.344429).  Saving model ...
Epoch: 5 cost time: 0.5065639019012451
Epoch: 5, Steps: 2 | Train Loss: 1.403 Vali Loss: 1.452 Vali Acc: 0.456 Test Loss: 1.452 Test Acc: 0.456
Validation loss decreased (-0.344429 --> -0.455541).  Saving model ...
Epoch: 6 cost time: 0.5172264575958252
Epoch: 6, Steps: 2 | Train Loss: 1.410 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.455541 --> -0.599987).  Saving model ...
Epoch: 7 cost time: 0.49277210235595703
Epoch: 7, Steps: 2 | Train Loss: 1.265 Vali Loss: 1.236 Vali Acc: 0.667 Test Loss: 1.236 Test Acc: 0.667
Validation loss decreased (-0.599987 --> -0.666654).  Saving model ...
Epoch: 8 cost time: 0.5600249767303467
Epoch: 8, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.125 Vali Acc: 0.715 Test Loss: 1.125 Test Acc: 0.715
Validation loss decreased (-0.666654 --> -0.714804).  Saving model ...
Epoch: 9 cost time: 0.4936702251434326
Epoch: 9, Steps: 2 | Train Loss: 0.966 Vali Loss: 1.016 Vali Acc: 0.752 Test Loss: 1.016 Test Acc: 0.752
Validation loss decreased (-0.714804 --> -0.751842).  Saving model ...
Epoch: 10 cost time: 0.5102529525756836
Epoch: 10, Steps: 2 | Train Loss: 0.868 Vali Loss: 0.914 Vali Acc: 0.800 Test Loss: 0.914 Test Acc: 0.800
Validation loss decreased (-0.751842 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.5484402179718018
Epoch: 11, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.822 Vali Acc: 0.837 Test Loss: 0.822 Test Acc: 0.837
Validation loss decreased (-0.799991 --> -0.837029).  Saving model ...
Epoch: 12 cost time: 0.5026323795318604
Epoch: 12, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.739 Vali Acc: 0.848 Test Loss: 0.739 Test Acc: 0.848
Validation loss decreased (-0.837029 --> -0.848141).  Saving model ...
Epoch: 13 cost time: 0.5552544593811035
Epoch: 13, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.668 Vali Acc: 0.863 Test Loss: 0.668 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 0.5589041709899902
Epoch: 14, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.604 Vali Acc: 0.874 Test Loss: 0.604 Test Acc: 0.874
Validation loss decreased (-0.862956 --> -0.874068).  Saving model ...
Epoch: 15 cost time: 0.5563549995422363
Epoch: 15, Steps: 2 | Train Loss: 0.419 Vali Loss: 0.547 Vali Acc: 0.874 Test Loss: 0.547 Test Acc: 0.874
Validation loss decreased (-0.874068 --> -0.874069).  Saving model ...
Epoch: 16 cost time: 0.49411821365356445
Epoch: 16, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.497 Vali Acc: 0.881 Test Loss: 0.497 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881477).  Saving model ...
Epoch: 17 cost time: 0.47301578521728516
Epoch: 17, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.457 Vali Acc: 0.889 Test Loss: 0.457 Test Acc: 0.889
Validation loss decreased (-0.881477 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.45104098320007324
Epoch: 18, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.423 Vali Acc: 0.896 Test Loss: 0.423 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.5278019905090332
Epoch: 19, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.394 Vali Acc: 0.900 Test Loss: 0.394 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.44155406951904297
Epoch: 20, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.366 Vali Acc: 0.904 Test Loss: 0.366 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 21 cost time: 0.4745452404022217
Epoch: 21, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
Validation loss decreased (-0.903700 --> -0.914811).  Saving model ...
Epoch: 22 cost time: 0.4683253765106201
Epoch: 22, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.322 Vali Acc: 0.911 Test Loss: 0.322 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4960319995880127
Epoch: 23, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.308 Vali Acc: 0.911 Test Loss: 0.308 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5068168640136719
Epoch: 24, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.295 Vali Acc: 0.915 Test Loss: 0.295 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.48421144485473633
Epoch: 25, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 26 cost time: 0.5351758003234863
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.275 Vali Acc: 0.915 Test Loss: 0.275 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 27 cost time: 0.583355188369751
Epoch: 27, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.268 Vali Acc: 0.922 Test Loss: 0.268 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.5870208740234375
Epoch: 28, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.263 Vali Acc: 0.922 Test Loss: 0.263 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.5861248970031738
Epoch: 29, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.258 Vali Acc: 0.926 Test Loss: 0.258 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 30 cost time: 0.5714037418365479
Epoch: 30, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 31 cost time: 0.5544373989105225
Epoch: 31, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.5713512897491455
Epoch: 32, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.251 Vali Acc: 0.922 Test Loss: 0.251 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5443377494812012
Epoch: 33, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.250 Vali Acc: 0.922 Test Loss: 0.250 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5531859397888184
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.248 Vali Acc: 0.922 Test Loss: 0.248 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5817604064941406
Epoch: 35, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5145773887634277
Epoch: 36, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5465250015258789
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 38 cost time: 0.5133540630340576
Epoch: 38, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 39 cost time: 0.505889892578125
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.239 Vali Acc: 0.930 Test Loss: 0.239 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.4959874153137207
Epoch: 40, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.48565030097961426
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.237 Vali Acc: 0.930 Test Loss: 0.237 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.48581981658935547
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.5117294788360596
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.45210814476013184
Epoch: 44, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 45 cost time: 0.511709451675415
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.5350532531738281
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.232 Vali Acc: 0.930 Test Loss: 0.232 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.5511746406555176
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.5126421451568604
Epoch: 48, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.5710294246673584
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5471365451812744
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.230 Vali Acc: 0.926 Test Loss: 0.230 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5819509029388428
Epoch: 51, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5550923347473145
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.554797887802124
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.5855247974395752
Epoch: 54, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.49135327339172363
Epoch: 55, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 56 cost time: 0.5567803382873535
Epoch: 56, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 100774
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0683741569519043
Epoch: 1, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.761 Vali Acc: 0.204 Test Loss: 1.761 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.4362368583679199
Epoch: 2, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.676 Vali Acc: 0.244 Test Loss: 1.676 Test Acc: 0.244
Validation loss decreased (-0.203686 --> -0.244428).  Saving model ...
Epoch: 3 cost time: 0.48996615409851074
Epoch: 3, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.607 Vali Acc: 0.270 Test Loss: 1.607 Test Acc: 0.270
Validation loss decreased (-0.244428 --> -0.270354).  Saving model ...
Epoch: 4 cost time: 0.49175453186035156
Epoch: 4, Steps: 2 | Train Loss: 1.483 Vali Loss: 1.532 Vali Acc: 0.341 Test Loss: 1.532 Test Acc: 0.341
Validation loss decreased (-0.270354 --> -0.340725).  Saving model ...
Epoch: 5 cost time: 0.45542383193969727
Epoch: 5, Steps: 2 | Train Loss: 1.386 Vali Loss: 1.438 Vali Acc: 0.493 Test Loss: 1.438 Test Acc: 0.493
Validation loss decreased (-0.340725 --> -0.492578).  Saving model ...
Epoch: 6 cost time: 0.44679784774780273
Epoch: 6, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.335 Vali Acc: 0.585 Test Loss: 1.335 Test Acc: 0.585
Validation loss decreased (-0.492578 --> -0.585172).  Saving model ...
Epoch: 7 cost time: 0.4769737720489502
Epoch: 7, Steps: 2 | Train Loss: 1.227 Vali Loss: 1.224 Vali Acc: 0.648 Test Loss: 1.224 Test Acc: 0.648
Validation loss decreased (-0.585172 --> -0.648136).  Saving model ...
Epoch: 8 cost time: 0.43448376655578613
Epoch: 8, Steps: 2 | Train Loss: 1.155 Vali Loss: 1.115 Vali Acc: 0.722 Test Loss: 1.115 Test Acc: 0.722
Validation loss decreased (-0.648136 --> -0.722211).  Saving model ...
Epoch: 9 cost time: 0.4642372131347656
Epoch: 9, Steps: 2 | Train Loss: 0.943 Vali Loss: 1.009 Vali Acc: 0.763 Test Loss: 1.009 Test Acc: 0.763
Validation loss decreased (-0.722211 --> -0.762953).  Saving model ...
Epoch: 10 cost time: 0.44084787368774414
Epoch: 10, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.909 Vali Acc: 0.807 Test Loss: 0.909 Test Acc: 0.807
Validation loss decreased (-0.762953 --> -0.807398).  Saving model ...
Epoch: 11 cost time: 0.49596190452575684
Epoch: 11, Steps: 2 | Train Loss: 0.713 Vali Loss: 0.818 Vali Acc: 0.844 Test Loss: 0.818 Test Acc: 0.844
Validation loss decreased (-0.807398 --> -0.844436).  Saving model ...
Epoch: 12 cost time: 0.4663712978363037
Epoch: 12, Steps: 2 | Train Loss: 0.678 Vali Loss: 0.737 Vali Acc: 0.859 Test Loss: 0.737 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 0.48516273498535156
Epoch: 13, Steps: 2 | Train Loss: 0.559 Vali Loss: 0.666 Vali Acc: 0.863 Test Loss: 0.666 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862956).  Saving model ...
Epoch: 14 cost time: 0.4231076240539551
Epoch: 14, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.603 Vali Acc: 0.870 Test Loss: 0.603 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870364).  Saving model ...
Epoch: 15 cost time: 0.45502591133117676
Epoch: 15, Steps: 2 | Train Loss: 0.416 Vali Loss: 0.547 Vali Acc: 0.881 Test Loss: 0.547 Test Acc: 0.881
Validation loss decreased (-0.870364 --> -0.881476).  Saving model ...
Epoch: 16 cost time: 0.49027442932128906
Epoch: 16, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.499 Vali Acc: 0.889 Test Loss: 0.499 Test Acc: 0.889
Validation loss decreased (-0.881476 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.4612095355987549
Epoch: 17, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.459 Vali Acc: 0.889 Test Loss: 0.459 Test Acc: 0.889
Validation loss decreased (-0.888884 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.45019102096557617
Epoch: 18, Steps: 2 | Train Loss: 0.267 Vali Loss: 0.425 Vali Acc: 0.896 Test Loss: 0.425 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.44756245613098145
Epoch: 19, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.395 Vali Acc: 0.904 Test Loss: 0.395 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.4157893657684326
Epoch: 20, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.367 Vali Acc: 0.911 Test Loss: 0.367 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 21 cost time: 0.4642355442047119
Epoch: 21, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.343 Vali Acc: 0.911 Test Loss: 0.343 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.4446702003479004
Epoch: 22, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.324 Vali Acc: 0.915 Test Loss: 0.324 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 23 cost time: 0.4752933979034424
Epoch: 23, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.309 Vali Acc: 0.919 Test Loss: 0.309 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918515).  Saving model ...
Epoch: 24 cost time: 0.45480895042419434
Epoch: 24, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.297 Vali Acc: 0.919 Test Loss: 0.297 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 0.48384666442871094
Epoch: 25, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.4989910125732422
Epoch: 26, Steps: 2 | Train Loss: 0.069 Vali Loss: 0.278 Vali Acc: 0.919 Test Loss: 0.278 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 27 cost time: 0.44358205795288086
Epoch: 27, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.273 Vali Acc: 0.919 Test Loss: 0.273 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 28 cost time: 0.45137715339660645
Epoch: 28, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 29 cost time: 0.49547481536865234
Epoch: 29, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.263 Vali Acc: 0.919 Test Loss: 0.263 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 30 cost time: 0.4428691864013672
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.260 Vali Acc: 0.919 Test Loss: 0.260 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 31 cost time: 0.45911383628845215
Epoch: 31, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 32 cost time: 0.4532585144042969
Epoch: 32, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.255 Vali Acc: 0.922 Test Loss: 0.255 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 33 cost time: 0.4252171516418457
Epoch: 33, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.254 Vali Acc: 0.926 Test Loss: 0.254 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 34 cost time: 0.3868372440338135
Epoch: 34, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 35 cost time: 0.38860607147216797
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.41460132598876953
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.247 Vali Acc: 0.922 Test Loss: 0.247 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.3907816410064697
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.3855867385864258
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.244 Vali Acc: 0.919 Test Loss: 0.244 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.4057772159576416
Epoch: 39, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.243 Vali Acc: 0.919 Test Loss: 0.243 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.41413450241088867
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.43503427505493164
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.45426440238952637
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.241 Vali Acc: 0.919 Test Loss: 0.241 Test Acc: 0.919
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.4427177906036377
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.240 Vali Acc: 0.919 Test Loss: 0.240 Test Acc: 0.919
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 0.43303346633911133
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 0.4422316551208496
Epoch: 45, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.239 Vali Acc: 0.919 Test Loss: 0.239 Test Acc: 0.919
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 100774
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.14395809173584
Epoch: 1, Steps: 2 | Train Loss: 1.900 Vali Loss: 1.760 Vali Acc: 0.178 Test Loss: 1.760 Test Acc: 0.178
Validation loss decreased (inf --> -0.177760).  Saving model ...
Epoch: 2 cost time: 0.4583897590637207
Epoch: 2, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.677 Vali Acc: 0.230 Test Loss: 1.677 Test Acc: 0.230
Validation loss decreased (-0.177760 --> -0.229613).  Saving model ...
Epoch: 3 cost time: 0.46852922439575195
Epoch: 3, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.610 Vali Acc: 0.319 Test Loss: 1.610 Test Acc: 0.319
Validation loss decreased (-0.229613 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.46713685989379883
Epoch: 4, Steps: 2 | Train Loss: 1.484 Vali Loss: 1.537 Vali Acc: 0.393 Test Loss: 1.537 Test Acc: 0.393
Validation loss decreased (-0.318502 --> -0.392577).  Saving model ...
Epoch: 5 cost time: 0.4791748523712158
Epoch: 5, Steps: 2 | Train Loss: 1.378 Vali Loss: 1.447 Vali Acc: 0.504 Test Loss: 1.447 Test Acc: 0.504
Validation loss decreased (-0.392577 --> -0.503689).  Saving model ...
Epoch: 6 cost time: 0.4164893627166748
Epoch: 6, Steps: 2 | Train Loss: 1.340 Vali Loss: 1.348 Vali Acc: 0.581 Test Loss: 1.348 Test Acc: 0.581
Validation loss decreased (-0.503689 --> -0.581468).  Saving model ...
Epoch: 7 cost time: 0.43903207778930664
Epoch: 7, Steps: 2 | Train Loss: 1.242 Vali Loss: 1.242 Vali Acc: 0.637 Test Loss: 1.242 Test Acc: 0.637
Validation loss decreased (-0.581468 --> -0.637025).  Saving model ...
Epoch: 8 cost time: 0.4754917621612549
Epoch: 8, Steps: 2 | Train Loss: 1.143 Vali Loss: 1.137 Vali Acc: 0.685 Test Loss: 1.137 Test Acc: 0.685
Validation loss decreased (-0.637025 --> -0.685174).  Saving model ...
Epoch: 9 cost time: 0.4481043815612793
Epoch: 9, Steps: 2 | Train Loss: 0.974 Vali Loss: 1.035 Vali Acc: 0.715 Test Loss: 1.035 Test Acc: 0.715
Validation loss decreased (-0.685174 --> -0.714804).  Saving model ...
Epoch: 10 cost time: 0.39293861389160156
Epoch: 10, Steps: 2 | Train Loss: 0.883 Vali Loss: 0.940 Vali Acc: 0.744 Test Loss: 0.940 Test Acc: 0.744
Validation loss decreased (-0.714804 --> -0.744435).  Saving model ...
Epoch: 11 cost time: 0.46706676483154297
Epoch: 11, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.853 Vali Acc: 0.800 Test Loss: 0.853 Test Acc: 0.800
Validation loss decreased (-0.744435 --> -0.799991).  Saving model ...
Epoch: 12 cost time: 0.44583845138549805
Epoch: 12, Steps: 2 | Train Loss: 0.688 Vali Loss: 0.774 Vali Acc: 0.822 Test Loss: 0.774 Test Acc: 0.822
Validation loss decreased (-0.799991 --> -0.822214).  Saving model ...
Epoch: 13 cost time: 0.4700000286102295
Epoch: 13, Steps: 2 | Train Loss: 0.568 Vali Loss: 0.705 Vali Acc: 0.819 Test Loss: 0.705 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 0.46140527725219727
Epoch: 14, Steps: 2 | Train Loss: 0.469 Vali Loss: 0.644 Vali Acc: 0.837 Test Loss: 0.644 Test Acc: 0.837
Validation loss decreased (-0.822214 --> -0.837031).  Saving model ...
Epoch: 15 cost time: 0.44605422019958496
Epoch: 15, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.590 Vali Acc: 0.856 Test Loss: 0.590 Test Acc: 0.856
Validation loss decreased (-0.837031 --> -0.855550).  Saving model ...
Epoch: 16 cost time: 0.4762701988220215
Epoch: 16, Steps: 2 | Train Loss: 0.331 Vali Loss: 0.543 Vali Acc: 0.859 Test Loss: 0.543 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 17 cost time: 0.49441051483154297
Epoch: 17, Steps: 2 | Train Loss: 0.329 Vali Loss: 0.504 Vali Acc: 0.874 Test Loss: 0.504 Test Acc: 0.874
Validation loss decreased (-0.859254 --> -0.874069).  Saving model ...
Epoch: 18 cost time: 0.5556240081787109
Epoch: 18, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.471 Vali Acc: 0.874 Test Loss: 0.471 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 19 cost time: 0.49007153511047363
Epoch: 19, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.442 Vali Acc: 0.881 Test Loss: 0.442 Test Acc: 0.881
Validation loss decreased (-0.874069 --> -0.881477).  Saving model ...
Epoch: 20 cost time: 0.5370104312896729
Epoch: 20, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.412 Vali Acc: 0.893 Test Loss: 0.412 Test Acc: 0.893
Validation loss decreased (-0.881477 --> -0.892588).  Saving model ...
Epoch: 21 cost time: 0.4795520305633545
Epoch: 21, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.387 Vali Acc: 0.881 Test Loss: 0.387 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5126371383666992
Epoch: 22, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.366 Vali Acc: 0.885 Test Loss: 0.366 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4647648334503174
Epoch: 23, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.350 Vali Acc: 0.885 Test Loss: 0.350 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.4780585765838623
Epoch: 24, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.336 Vali Acc: 0.881 Test Loss: 0.336 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 0.4740889072418213
Epoch: 25, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.325 Vali Acc: 0.885 Test Loss: 0.325 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 0.5304861068725586
Epoch: 26, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.315 Vali Acc: 0.885 Test Loss: 0.315 Test Acc: 0.885
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 0.5113613605499268
Epoch: 27, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 0.46001362800598145
Epoch: 28, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.301 Vali Acc: 0.885 Test Loss: 0.301 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 0.5196590423583984
Epoch: 29, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 0.5274784564971924
Epoch: 30, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
Validation loss decreased (-0.892588 --> -0.892590).  Saving model ...
Epoch: 31 cost time: 0.4635798931121826
Epoch: 31, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.495908260345459
Epoch: 32, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.286 Vali Acc: 0.893 Test Loss: 0.286 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 33 cost time: 0.5114195346832275
Epoch: 33, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.284 Vali Acc: 0.893 Test Loss: 0.284 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 34 cost time: 0.5472939014434814
Epoch: 34, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.281 Vali Acc: 0.889 Test Loss: 0.281 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.4509470462799072
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.278 Vali Acc: 0.885 Test Loss: 0.278 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.505242109298706
Epoch: 36, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.275 Vali Acc: 0.889 Test Loss: 0.275 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.477367639541626
Epoch: 37, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.273 Vali Acc: 0.889 Test Loss: 0.273 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.5197646617889404
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.271 Vali Acc: 0.893 Test Loss: 0.271 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 39 cost time: 0.5315349102020264
Epoch: 39, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.270 Vali Acc: 0.893 Test Loss: 0.270 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 40 cost time: 0.516326904296875
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.269 Vali Acc: 0.893 Test Loss: 0.269 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 41 cost time: 0.5126845836639404
Epoch: 41, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.268 Vali Acc: 0.889 Test Loss: 0.268 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.4837939739227295
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.267 Vali Acc: 0.893 Test Loss: 0.267 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 43 cost time: 0.42009854316711426
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.266 Vali Acc: 0.893 Test Loss: 0.266 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 44 cost time: 0.4590909481048584
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.266 Vali Acc: 0.893 Test Loss: 0.266 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 45 cost time: 0.5164010524749756
Epoch: 45, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.265 Vali Acc: 0.889 Test Loss: 0.265 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.4806210994720459
Epoch: 46, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.264 Vali Acc: 0.889 Test Loss: 0.264 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.5032031536102295
Epoch: 47, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.263 Vali Acc: 0.889 Test Loss: 0.263 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4656496047973633
Epoch: 48, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.262 Vali Acc: 0.889 Test Loss: 0.262 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.4908447265625
Epoch: 49, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.262 Vali Acc: 0.893 Test Loss: 0.262 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 50 cost time: 0.48645901679992676
Epoch: 50, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.885 Test Loss: 0.261 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.4477412700653076
Epoch: 51, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.261 Vali Acc: 0.885 Test Loss: 0.261 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.5219743251800537
Epoch: 52, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.5171699523925781
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.889 Test Loss: 0.261 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.5171966552734375
Epoch: 54, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.261 Vali Acc: 0.893 Test Loss: 0.261 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 55 cost time: 0.5006241798400879
Epoch: 55, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.261 Vali Acc: 0.893 Test Loss: 0.261 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 56 cost time: 0.49184322357177734
Epoch: 56, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.260 Vali Acc: 0.893 Test Loss: 0.260 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 57 cost time: 0.48616766929626465
Epoch: 57, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.259 Vali Acc: 0.896 Test Loss: 0.259 Test Acc: 0.896
Validation loss decreased (-0.892590 --> -0.896294).  Saving model ...
Epoch: 58 cost time: 0.5278806686401367
Epoch: 58, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.258 Vali Acc: 0.896 Test Loss: 0.258 Test Acc: 0.896
Validation loss decreased (-0.896294 --> -0.896294).  Saving model ...
Epoch: 59 cost time: 0.5404884815216064
Epoch: 59, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.257 Vali Acc: 0.896 Test Loss: 0.257 Test Acc: 0.896
Validation loss decreased (-0.896294 --> -0.896294).  Saving model ...
Epoch: 60 cost time: 0.47872257232666016
Epoch: 60, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.256 Vali Acc: 0.896 Test Loss: 0.256 Test Acc: 0.896
Validation loss decreased (-0.896294 --> -0.896294).  Saving model ...
Epoch: 61 cost time: 0.501781702041626
Epoch: 61, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.255 Vali Acc: 0.896 Test Loss: 0.255 Test Acc: 0.896
Validation loss decreased (-0.896294 --> -0.896294).  Saving model ...
Epoch: 62 cost time: 0.5417587757110596
Epoch: 62, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.896 Test Loss: 0.254 Test Acc: 0.896
Validation loss decreased (-0.896294 --> -0.896294).  Saving model ...
Epoch: 63 cost time: 0.41261935234069824
Epoch: 63, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.254 Vali Acc: 0.900 Test Loss: 0.254 Test Acc: 0.900
Validation loss decreased (-0.896294 --> -0.899997).  Saving model ...
Epoch: 64 cost time: 0.4502434730529785
Epoch: 64, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 65 cost time: 0.44728636741638184
Epoch: 65, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 66 cost time: 0.43342137336730957
Epoch: 66, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 67 cost time: 0.5150902271270752
Epoch: 67, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 68 cost time: 0.42516422271728516
Epoch: 68, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 69 cost time: 0.45885229110717773
Epoch: 69, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 70 cost time: 0.4277310371398926
Epoch: 70, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.904 Test Loss: 0.253 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.43137502670288086
Epoch: 71, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.252 Vali Acc: 0.904 Test Loss: 0.252 Test Acc: 0.904
Validation loss decreased (-0.903701 --> -0.903701).  Saving model ...
Epoch: 72 cost time: 0.43267107009887695
Epoch: 72, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 73 cost time: 0.45529985427856445
Epoch: 73, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 2 out of 10
Epoch: 74 cost time: 0.5259461402893066
Epoch: 74, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.253 Vali Acc: 0.900 Test Loss: 0.253 Test Acc: 0.900
EarlyStopping counter: 3 out of 10
Epoch: 75 cost time: 0.5056459903717041
Epoch: 75, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.896 Test Loss: 0.253 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 76 cost time: 0.48333311080932617
Epoch: 76, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.896 Test Loss: 0.253 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 77 cost time: 0.48735547065734863
Epoch: 77, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.896 Test Loss: 0.253 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 78 cost time: 0.5675981044769287
Epoch: 78, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.896 Test Loss: 0.253 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 79 cost time: 0.5372958183288574
Epoch: 79, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.253 Vali Acc: 0.896 Test Loss: 0.253 Test Acc: 0.896
EarlyStopping counter: 8 out of 10
Epoch: 80 cost time: 0.4856076240539551
Epoch: 80, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.252 Vali Acc: 0.896 Test Loss: 0.252 Test Acc: 0.896
EarlyStopping counter: 9 out of 10
Epoch: 81 cost time: 0.5487608909606934
Epoch: 81, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.252 Vali Acc: 0.896 Test Loss: 0.252 Test Acc: 0.896
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 100774
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.06767201423645
Epoch: 1, Steps: 2 | Train Loss: 1.860 Vali Loss: 1.728 Vali Acc: 0.219 Test Loss: 1.728 Test Acc: 0.219
Validation loss decreased (inf --> -0.218501).  Saving model ...
Epoch: 2 cost time: 0.5174007415771484
Epoch: 2, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.653 Vali Acc: 0.281 Test Loss: 1.653 Test Acc: 0.281
Validation loss decreased (-0.218501 --> -0.281465).  Saving model ...
Epoch: 3 cost time: 0.46745944023132324
Epoch: 3, Steps: 2 | Train Loss: 1.687 Vali Loss: 1.592 Vali Acc: 0.326 Test Loss: 1.592 Test Acc: 0.326
Validation loss decreased (-0.281465 --> -0.325910).  Saving model ...
Epoch: 4 cost time: 0.47432374954223633
Epoch: 4, Steps: 2 | Train Loss: 1.539 Vali Loss: 1.525 Vali Acc: 0.374 Test Loss: 1.525 Test Acc: 0.374
Validation loss decreased (-0.325910 --> -0.374059).  Saving model ...
Epoch: 5 cost time: 0.4587090015411377
Epoch: 5, Steps: 2 | Train Loss: 1.431 Vali Loss: 1.442 Vali Acc: 0.489 Test Loss: 1.442 Test Acc: 0.489
Validation loss decreased (-0.374059 --> -0.488874).  Saving model ...
Epoch: 6 cost time: 0.48505377769470215
Epoch: 6, Steps: 2 | Train Loss: 1.396 Vali Loss: 1.350 Vali Acc: 0.585 Test Loss: 1.350 Test Acc: 0.585
Validation loss decreased (-0.488874 --> -0.585172).  Saving model ...
Epoch: 7 cost time: 0.4745345115661621
Epoch: 7, Steps: 2 | Train Loss: 1.275 Vali Loss: 1.252 Vali Acc: 0.641 Test Loss: 1.252 Test Acc: 0.641
Validation loss decreased (-0.585172 --> -0.640728).  Saving model ...
Epoch: 8 cost time: 0.4743931293487549
Epoch: 8, Steps: 2 | Train Loss: 1.216 Vali Loss: 1.154 Vali Acc: 0.696 Test Loss: 1.154 Test Acc: 0.696
Validation loss decreased (-0.640728 --> -0.696285).  Saving model ...
Epoch: 9 cost time: 0.5191259384155273
Epoch: 9, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.058 Vali Acc: 0.722 Test Loss: 1.058 Test Acc: 0.722
Validation loss decreased (-0.696285 --> -0.722212).  Saving model ...
Epoch: 10 cost time: 0.4566359519958496
Epoch: 10, Steps: 2 | Train Loss: 0.960 Vali Loss: 0.968 Vali Acc: 0.770 Test Loss: 0.968 Test Acc: 0.770
Validation loss decreased (-0.722212 --> -0.770361).  Saving model ...
Epoch: 11 cost time: 0.49133896827697754
Epoch: 11, Steps: 2 | Train Loss: 0.815 Vali Loss: 0.885 Vali Acc: 0.819 Test Loss: 0.885 Test Acc: 0.819
Validation loss decreased (-0.770361 --> -0.818510).  Saving model ...
Epoch: 12 cost time: 0.5064325332641602
Epoch: 12, Steps: 2 | Train Loss: 0.785 Vali Loss: 0.809 Vali Acc: 0.848 Test Loss: 0.809 Test Acc: 0.848
Validation loss decreased (-0.818510 --> -0.848140).  Saving model ...
Epoch: 13 cost time: 0.4888184070587158
Epoch: 13, Steps: 2 | Train Loss: 0.673 Vali Loss: 0.743 Vali Acc: 0.856 Test Loss: 0.743 Test Acc: 0.856
Validation loss decreased (-0.848140 --> -0.855548).  Saving model ...
Epoch: 14 cost time: 0.5214846134185791
Epoch: 14, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.684 Vali Acc: 0.859 Test Loss: 0.684 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 15 cost time: 0.5054590702056885
Epoch: 15, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.631 Vali Acc: 0.863 Test Loss: 0.631 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862957).  Saving model ...
Epoch: 16 cost time: 0.48480892181396484
Epoch: 16, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.586 Vali Acc: 0.867 Test Loss: 0.586 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 0.4966433048248291
Epoch: 17, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.547 Vali Acc: 0.870 Test Loss: 0.547 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 18 cost time: 0.4834272861480713
Epoch: 18, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.514 Vali Acc: 0.885 Test Loss: 0.514 Test Acc: 0.885
Validation loss decreased (-0.870365 --> -0.885180).  Saving model ...
Epoch: 19 cost time: 0.5038979053497314
Epoch: 19, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.484 Vali Acc: 0.885 Test Loss: 0.484 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 20 cost time: 0.5089666843414307
Epoch: 20, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.457 Vali Acc: 0.870 Test Loss: 0.457 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4875319004058838
Epoch: 21, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.435 Vali Acc: 0.867 Test Loss: 0.435 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 0.49033689498901367
Epoch: 22, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.416 Vali Acc: 0.878 Test Loss: 0.416 Test Acc: 0.878
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 0.47468113899230957
Epoch: 23, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.402 Vali Acc: 0.878 Test Loss: 0.402 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 0.5259883403778076
Epoch: 24, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.388 Vali Acc: 0.885 Test Loss: 0.388 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885181).  Saving model ...
Epoch: 25 cost time: 0.4932854175567627
Epoch: 25, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.378 Vali Acc: 0.885 Test Loss: 0.378 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 26 cost time: 0.5439496040344238
Epoch: 26, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.367 Vali Acc: 0.885 Test Loss: 0.367 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885182).  Saving model ...
Epoch: 27 cost time: 0.5464656352996826
Epoch: 27, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.358 Vali Acc: 0.885 Test Loss: 0.358 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 28 cost time: 0.4827921390533447
Epoch: 28, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.349 Vali Acc: 0.885 Test Loss: 0.349 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 29 cost time: 0.515498161315918
Epoch: 29, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.343 Vali Acc: 0.885 Test Loss: 0.343 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 30 cost time: 0.5393078327178955
Epoch: 30, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.337 Vali Acc: 0.881 Test Loss: 0.337 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.529608964920044
Epoch: 31, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.332 Vali Acc: 0.885 Test Loss: 0.332 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 32 cost time: 0.5325157642364502
Epoch: 32, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.328 Vali Acc: 0.889 Test Loss: 0.328 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.48070669174194336
Epoch: 33, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.325 Vali Acc: 0.889 Test Loss: 0.325 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.5044879913330078
Epoch: 34, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.322 Vali Acc: 0.889 Test Loss: 0.322 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.464740514755249
Epoch: 35, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.318 Vali Acc: 0.889 Test Loss: 0.318 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 36 cost time: 0.40341997146606445
Epoch: 36, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.315 Vali Acc: 0.889 Test Loss: 0.315 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 37 cost time: 0.4626035690307617
Epoch: 37, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.312 Vali Acc: 0.889 Test Loss: 0.312 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 38 cost time: 0.48433661460876465
Epoch: 38, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.310 Vali Acc: 0.889 Test Loss: 0.310 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 39 cost time: 0.44857144355773926
Epoch: 39, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.308 Vali Acc: 0.889 Test Loss: 0.308 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 40 cost time: 0.41596126556396484
Epoch: 40, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.306 Vali Acc: 0.889 Test Loss: 0.306 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 41 cost time: 0.4144299030303955
Epoch: 41, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.40550851821899414
Epoch: 42, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.506361722946167
Epoch: 43, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.303 Vali Acc: 0.889 Test Loss: 0.303 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 44 cost time: 0.5267810821533203
Epoch: 44, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.5570299625396729
Epoch: 45, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.302 Vali Acc: 0.893 Test Loss: 0.302 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892590).  Saving model ...
Epoch: 46 cost time: 0.5105104446411133
Epoch: 46, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.302 Vali Acc: 0.889 Test Loss: 0.302 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4838521480560303
Epoch: 47, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.302 Vali Acc: 0.893 Test Loss: 0.302 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 48 cost time: 0.4511439800262451
Epoch: 48, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.301 Vali Acc: 0.893 Test Loss: 0.301 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 49 cost time: 0.5178711414337158
Epoch: 49, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.300 Vali Acc: 0.893 Test Loss: 0.300 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 50 cost time: 0.4872252941131592
Epoch: 50, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.299 Vali Acc: 0.889 Test Loss: 0.299 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 51 cost time: 0.476346492767334
Epoch: 51, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 52 cost time: 0.49552488327026367
Epoch: 52, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.297 Vali Acc: 0.889 Test Loss: 0.297 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 53 cost time: 0.4698159694671631
Epoch: 53, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.296 Vali Acc: 0.889 Test Loss: 0.296 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 54 cost time: 0.4396653175354004
Epoch: 54, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.296 Vali Acc: 0.893 Test Loss: 0.296 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 55 cost time: 0.5060029029846191
Epoch: 55, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.296 Vali Acc: 0.893 Test Loss: 0.296 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 56 cost time: 0.5164525508880615
Epoch: 56, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5155937671661377
Epoch: 57, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.293 Vali Acc: 0.889 Test Loss: 0.293 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5793976783752441
Epoch: 58, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.293 Vali Acc: 0.893 Test Loss: 0.293 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 59 cost time: 0.4223763942718506
Epoch: 59, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.293 Vali Acc: 0.893 Test Loss: 0.293 Test Acc: 0.893
Validation loss decreased (-0.892590 --> -0.892590).  Saving model ...
Epoch: 60 cost time: 0.3755679130554199
Epoch: 60, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.896 Test Loss: 0.292 Test Acc: 0.896
Validation loss decreased (-0.892590 --> -0.896293).  Saving model ...
Epoch: 61 cost time: 0.42777204513549805
Epoch: 61, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 62 cost time: 0.4768857955932617
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 63 cost time: 0.4451894760131836
Epoch: 63, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.291 Vali Acc: 0.893 Test Loss: 0.291 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 64 cost time: 0.4037792682647705
Epoch: 64, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.290 Vali Acc: 0.893 Test Loss: 0.290 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 65 cost time: 0.4278852939605713
Epoch: 65, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.290 Vali Acc: 0.893 Test Loss: 0.290 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 66 cost time: 0.43378353118896484
Epoch: 66, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.289 Vali Acc: 0.893 Test Loss: 0.289 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 67 cost time: 0.4895753860473633
Epoch: 67, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.290 Vali Acc: 0.893 Test Loss: 0.290 Test Acc: 0.893
EarlyStopping counter: 5 out of 10
Epoch: 68 cost time: 0.4688303470611572
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.893 Test Loss: 0.289 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 69 cost time: 0.4881563186645508
Epoch: 69, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.289 Vali Acc: 0.893 Test Loss: 0.289 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 70 cost time: 0.5045170783996582
Epoch: 70, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 8 out of 10
Epoch: 71 cost time: 0.47100067138671875
Epoch: 71, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.289 Vali Acc: 0.889 Test Loss: 0.289 Test Acc: 0.889
EarlyStopping counter: 9 out of 10
Epoch: 72 cost time: 0.4495258331298828
Epoch: 72, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.290 Vali Acc: 0.889 Test Loss: 0.290 Test Acc: 0.889
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 100774
model size : 1.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.048349142074585
Epoch: 1, Steps: 2 | Train Loss: 2.017 Vali Loss: 1.846 Vali Acc: 0.300 Test Loss: 1.846 Test Acc: 0.300
Validation loss decreased (inf --> -0.299982).  Saving model ...
Epoch: 2 cost time: 0.5147087574005127
Epoch: 2, Steps: 2 | Train Loss: 1.972 Vali Loss: 1.759 Vali Acc: 0.344 Test Loss: 1.759 Test Acc: 0.344
Validation loss decreased (-0.299982 --> -0.344427).  Saving model ...
Epoch: 3 cost time: 0.5045268535614014
Epoch: 3, Steps: 2 | Train Loss: 1.786 Vali Loss: 1.688 Vali Acc: 0.385 Test Loss: 1.688 Test Acc: 0.385
Validation loss decreased (-0.344427 --> -0.385168).  Saving model ...
Epoch: 4 cost time: 0.5516009330749512
Epoch: 4, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.608 Vali Acc: 0.407 Test Loss: 1.608 Test Acc: 0.407
Validation loss decreased (-0.385168 --> -0.407391).  Saving model ...
Epoch: 5 cost time: 0.561366081237793
Epoch: 5, Steps: 2 | Train Loss: 1.570 Vali Loss: 1.508 Vali Acc: 0.467 Test Loss: 1.508 Test Acc: 0.467
Validation loss decreased (-0.407391 --> -0.466652).  Saving model ...
Epoch: 6 cost time: 0.47061991691589355
Epoch: 6, Steps: 2 | Train Loss: 1.533 Vali Loss: 1.396 Vali Acc: 0.515 Test Loss: 1.396 Test Acc: 0.515
Validation loss decreased (-0.466652 --> -0.514801).  Saving model ...
Epoch: 7 cost time: 0.5079169273376465
Epoch: 7, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.277 Vali Acc: 0.563 Test Loss: 1.277 Test Acc: 0.563
Validation loss decreased (-0.514801 --> -0.562950).  Saving model ...
Epoch: 8 cost time: 0.45427870750427246
Epoch: 8, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.157 Vali Acc: 0.652 Test Loss: 1.157 Test Acc: 0.652
Validation loss decreased (-0.562950 --> -0.651840).  Saving model ...
Epoch: 9 cost time: 0.4818894863128662
Epoch: 9, Steps: 2 | Train Loss: 1.050 Vali Loss: 1.042 Vali Acc: 0.756 Test Loss: 1.042 Test Acc: 0.756
Validation loss decreased (-0.651840 --> -0.755545).  Saving model ...
Epoch: 10 cost time: 0.46784472465515137
Epoch: 10, Steps: 2 | Train Loss: 0.908 Vali Loss: 0.933 Vali Acc: 0.819 Test Loss: 0.933 Test Acc: 0.819
Validation loss decreased (-0.755545 --> -0.818509).  Saving model ...
Epoch: 11 cost time: 0.5060625076293945
Epoch: 11, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.831 Vali Acc: 0.856 Test Loss: 0.831 Test Acc: 0.856
Validation loss decreased (-0.818509 --> -0.855547).  Saving model ...
Epoch: 12 cost time: 0.5401463508605957
Epoch: 12, Steps: 2 | Train Loss: 0.687 Vali Loss: 0.737 Vali Acc: 0.881 Test Loss: 0.737 Test Acc: 0.881
Validation loss decreased (-0.855547 --> -0.881474).  Saving model ...
Epoch: 13 cost time: 0.5172927379608154
Epoch: 13, Steps: 2 | Train Loss: 0.613 Vali Loss: 0.655 Vali Acc: 0.896 Test Loss: 0.655 Test Acc: 0.896
Validation loss decreased (-0.881474 --> -0.896290).  Saving model ...
Epoch: 14 cost time: 0.48950862884521484
Epoch: 14, Steps: 2 | Train Loss: 0.523 Vali Loss: 0.583 Vali Acc: 0.911 Test Loss: 0.583 Test Acc: 0.911
Validation loss decreased (-0.896290 --> -0.911105).  Saving model ...
Epoch: 15 cost time: 0.5264668464660645
Epoch: 15, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.522 Vali Acc: 0.919 Test Loss: 0.522 Test Acc: 0.919
Validation loss decreased (-0.911105 --> -0.918513).  Saving model ...
Epoch: 16 cost time: 0.5483121871948242
Epoch: 16, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.471 Vali Acc: 0.930 Test Loss: 0.471 Test Acc: 0.930
Validation loss decreased (-0.918513 --> -0.929625).  Saving model ...
Epoch: 17 cost time: 0.505094051361084
Epoch: 17, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.428 Vali Acc: 0.930 Test Loss: 0.428 Test Acc: 0.930
Validation loss decreased (-0.929625 --> -0.929625).  Saving model ...
Epoch: 18 cost time: 0.5388939380645752
Epoch: 18, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.391 Vali Acc: 0.933 Test Loss: 0.391 Test Acc: 0.933
Validation loss decreased (-0.929625 --> -0.933329).  Saving model ...
Epoch: 19 cost time: 0.5596461296081543
Epoch: 19, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.360 Vali Acc: 0.930 Test Loss: 0.360 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 0.4994940757751465
Epoch: 20, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.335 Vali Acc: 0.915 Test Loss: 0.335 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 0.5648291110992432
Epoch: 21, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 0.5372474193572998
Epoch: 22, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.297 Vali Acc: 0.922 Test Loss: 0.297 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 0.5671536922454834
Epoch: 23, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.282 Vali Acc: 0.926 Test Loss: 0.282 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 0.5453405380249023
Epoch: 24, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.269 Vali Acc: 0.933 Test Loss: 0.269 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933331).  Saving model ...
Epoch: 25 cost time: 0.5377869606018066
Epoch: 25, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.259 Vali Acc: 0.933 Test Loss: 0.259 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 26 cost time: 0.560002326965332
Epoch: 26, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.250 Vali Acc: 0.933 Test Loss: 0.250 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 27 cost time: 0.5430307388305664
Epoch: 27, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5273332595825195
Epoch: 28, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.5601806640625
Epoch: 29, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.234 Vali Acc: 0.933 Test Loss: 0.234 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.5397047996520996
Epoch: 30, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.5486586093902588
Epoch: 31, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.4717245101928711
Epoch: 32, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.48134636878967285
Epoch: 33, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.4229438304901123
Epoch: 34, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4932870864868164
Epoch: 35, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5395407676696777
Epoch: 36, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5269978046417236
Epoch: 37, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5306832790374756
Epoch: 38, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.498279333114624
Epoch: 39, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5160143375396729
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 41 cost time: 0.544438362121582
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.5617058277130127
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.5236363410949707
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.5268476009368896
Epoch: 44, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5412240028381348
Epoch: 45, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.5304741859436035
Epoch: 46, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.5333950519561768
Epoch: 47, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.5264406204223633
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.5108773708343506
Epoch: 49, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.5485038757324219
Epoch: 50, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 51 cost time: 0.5443329811096191
Epoch: 51, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 0.5137710571289062
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 0.5841960906982422
Epoch: 53, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.5986475944519043
Epoch: 54, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.5083584785461426
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.5375728607177734
Epoch: 56, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.506537914276123
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.4615762233734131
Epoch: 58, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.4780285358428955
Epoch: 59, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.4649691581726074
Epoch: 60, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.4657323360443115
Epoch: 61, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.4967811107635498
Epoch: 62, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.5214498043060303
Epoch: 63, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.5120129585266113
Epoch: 64, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.47622084617614746
Epoch: 65, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.5076167583465576
Epoch: 66, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 0.5462656021118164
Epoch: 67, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 0.5593593120574951
Epoch: 68, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 69 cost time: 0.5296106338500977
Epoch: 69, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.5572667121887207
Epoch: 70, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.6087772846221924
Epoch: 71, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.5173449516296387
Epoch: 72, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.5188112258911133
Epoch: 73, Steps: 2 | Train Loss: 0.005 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.5052192211151123
Epoch: 74, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.5306692123413086
Epoch: 75, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 0.5419838428497314
Epoch: 76, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.517622709274292
Epoch: 77, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.5280578136444092
Epoch: 78, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.5386669635772705
Epoch: 79, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 0.5224919319152832
Epoch: 80, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5130593776702881
Epoch: 81, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 82 cost time: 0.5040097236633301
Epoch: 82, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.5137982368469238
Epoch: 83, Steps: 2 | Train Loss: 0.004 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.47963547706604004
Epoch: 84, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.4768514633178711
Epoch: 85, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.5000183582305908
Epoch: 86, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.552203893661499
Epoch: 87, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.523958683013916
Epoch: 88, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.5308892726898193
Epoch: 89, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 90 cost time: 0.5009517669677734
Epoch: 90, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.506218671798706
Epoch: 91, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.5091402530670166
Epoch: 92, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 93 cost time: 0.5324428081512451
Epoch: 93, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 0.5432987213134766
Epoch: 94, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 95 cost time: 0.5205280780792236
Epoch: 95, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 96 cost time: 0.5388913154602051
Epoch: 96, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 97 cost time: 0.5365133285522461
Epoch: 97, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 98 cost time: 0.5394837856292725
Epoch: 98, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 99 cost time: 0.5180635452270508
Epoch: 99, Steps: 2 | Train Loss: 0.003 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 100 cost time: 0.5548305511474609
Epoch: 100, Steps: 2 | Train Loss: 0.002 Vali Loss: 0.202 Vali Acc: 0.930 Test Loss: 0.202 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 68006
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0263545513153076
Epoch: 1, Steps: 2 | Train Loss: 1.993 Vali Loss: 1.862 Vali Acc: 0.256 Test Loss: 1.862 Test Acc: 0.256
Validation loss decreased (inf --> -0.255537).  Saving model ...
Epoch: 2 cost time: 0.43515801429748535
Epoch: 2, Steps: 2 | Train Loss: 1.952 Vali Loss: 1.776 Vali Acc: 0.311 Test Loss: 1.776 Test Acc: 0.311
Validation loss decreased (-0.255537 --> -0.311093).  Saving model ...
Epoch: 3 cost time: 0.5205380916595459
Epoch: 3, Steps: 2 | Train Loss: 1.773 Vali Loss: 1.705 Vali Acc: 0.341 Test Loss: 1.705 Test Acc: 0.341
Validation loss decreased (-0.311093 --> -0.340724).  Saving model ...
Epoch: 4 cost time: 0.4503357410430908
Epoch: 4, Steps: 2 | Train Loss: 1.708 Vali Loss: 1.625 Vali Acc: 0.393 Test Loss: 1.625 Test Acc: 0.393
Validation loss decreased (-0.340724 --> -0.392576).  Saving model ...
Epoch: 5 cost time: 0.5009002685546875
Epoch: 5, Steps: 2 | Train Loss: 1.577 Vali Loss: 1.525 Vali Acc: 0.437 Test Loss: 1.525 Test Acc: 0.437
Validation loss decreased (-0.392576 --> -0.437022).  Saving model ...
Epoch: 6 cost time: 0.4930591583251953
Epoch: 6, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.414 Vali Acc: 0.496 Test Loss: 1.414 Test Acc: 0.496
Validation loss decreased (-0.437022 --> -0.496282).  Saving model ...
Epoch: 7 cost time: 0.40883708000183105
Epoch: 7, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.295 Vali Acc: 0.556 Test Loss: 1.295 Test Acc: 0.556
Validation loss decreased (-0.496282 --> -0.555543).  Saving model ...
Epoch: 8 cost time: 0.42069339752197266
Epoch: 8, Steps: 2 | Train Loss: 1.286 Vali Loss: 1.175 Vali Acc: 0.633 Test Loss: 1.175 Test Acc: 0.633
Validation loss decreased (-0.555543 --> -0.633322).  Saving model ...
Epoch: 9 cost time: 0.48943471908569336
Epoch: 9, Steps: 2 | Train Loss: 1.051 Vali Loss: 1.059 Vali Acc: 0.733 Test Loss: 1.059 Test Acc: 0.733
Validation loss decreased (-0.633322 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.5344686508178711
Epoch: 10, Steps: 2 | Train Loss: 0.928 Vali Loss: 0.951 Vali Acc: 0.789 Test Loss: 0.951 Test Acc: 0.789
Validation loss decreased (-0.733323 --> -0.788879).  Saving model ...
Epoch: 11 cost time: 0.5267913341522217
Epoch: 11, Steps: 2 | Train Loss: 0.859 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
Validation loss decreased (-0.788879 --> -0.833325).  Saving model ...
Epoch: 12 cost time: 0.5100350379943848
Epoch: 12, Steps: 2 | Train Loss: 0.685 Vali Loss: 0.756 Vali Acc: 0.859 Test Loss: 0.756 Test Acc: 0.859
Validation loss decreased (-0.833325 --> -0.859252).  Saving model ...
Epoch: 13 cost time: 0.5168862342834473
Epoch: 13, Steps: 2 | Train Loss: 0.623 Vali Loss: 0.674 Vali Acc: 0.874 Test Loss: 0.674 Test Acc: 0.874
Validation loss decreased (-0.859252 --> -0.874067).  Saving model ...
Epoch: 14 cost time: 0.4999713897705078
Epoch: 14, Steps: 2 | Train Loss: 0.533 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
Validation loss decreased (-0.874067 --> -0.888883).  Saving model ...
Epoch: 15 cost time: 0.48371243476867676
Epoch: 15, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.540 Vali Acc: 0.896 Test Loss: 0.540 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 16 cost time: 0.4926285743713379
Epoch: 16, Steps: 2 | Train Loss: 0.357 Vali Loss: 0.489 Vali Acc: 0.900 Test Loss: 0.489 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 17 cost time: 0.5478558540344238
Epoch: 17, Steps: 2 | Train Loss: 0.302 Vali Loss: 0.445 Vali Acc: 0.904 Test Loss: 0.445 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 18 cost time: 0.6108884811401367
Epoch: 18, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.408 Vali Acc: 0.900 Test Loss: 0.408 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.517021656036377
Epoch: 19, Steps: 2 | Train Loss: 0.237 Vali Loss: 0.377 Vali Acc: 0.904 Test Loss: 0.377 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.45746302604675293
Epoch: 20, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.351 Vali Acc: 0.900 Test Loss: 0.351 Test Acc: 0.900
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4596431255340576
Epoch: 21, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.331 Vali Acc: 0.911 Test Loss: 0.331 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.49733853340148926
Epoch: 22, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.313 Vali Acc: 0.911 Test Loss: 0.313 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 23 cost time: 0.5006768703460693
Epoch: 23, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.297 Vali Acc: 0.911 Test Loss: 0.297 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 24 cost time: 0.4388749599456787
Epoch: 24, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 25 cost time: 0.48212456703186035
Epoch: 25, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.914812 --> -0.922219).  Saving model ...
Epoch: 26 cost time: 0.46238040924072266
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.264 Vali Acc: 0.922 Test Loss: 0.264 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.43035411834716797
Epoch: 27, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 28 cost time: 0.42780041694641113
Epoch: 28, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 29 cost time: 0.43793773651123047
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.46240806579589844
Epoch: 30, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.244 Vali Acc: 0.922 Test Loss: 0.244 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 31 cost time: 0.45348024368286133
Epoch: 31, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
Validation loss decreased (-0.922220 --> -0.922220).  Saving model ...
Epoch: 32 cost time: 0.46069979667663574
Epoch: 32, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.238 Vali Acc: 0.919 Test Loss: 0.238 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.48517513275146484
Epoch: 33, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.236 Vali Acc: 0.919 Test Loss: 0.236 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.46915483474731445
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.235 Vali Acc: 0.919 Test Loss: 0.235 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.49829745292663574
Epoch: 35, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.233 Vali Acc: 0.919 Test Loss: 0.233 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.49877190589904785
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 37 cost time: 0.5155618190765381
Epoch: 37, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.230 Vali Acc: 0.922 Test Loss: 0.230 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.5470356941223145
Epoch: 38, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.922 Test Loss: 0.229 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.5177147388458252
Epoch: 39, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 40 cost time: 0.5202813148498535
Epoch: 40, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 41 cost time: 0.5457875728607178
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 42 cost time: 0.5381722450256348
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 43 cost time: 0.5199117660522461
Epoch: 43, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.227 Vali Acc: 0.926 Test Loss: 0.227 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 44 cost time: 0.540215253829956
Epoch: 44, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5225656032562256
Epoch: 45, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.4999380111694336
Epoch: 46, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5411794185638428
Epoch: 47, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.226 Vali Acc: 0.922 Test Loss: 0.226 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5212254524230957
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.225 Vali Acc: 0.922 Test Loss: 0.225 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.4996614456176758
Epoch: 49, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5028119087219238
Epoch: 50, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.224 Vali Acc: 0.922 Test Loss: 0.224 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.4662899971008301
Epoch: 51, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.5064189434051514
Epoch: 52, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.48416638374328613
Epoch: 53, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.223 Vali Acc: 0.922 Test Loss: 0.223 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9259259259259259
model parameter : 68006
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.189847469329834
Epoch: 1, Steps: 2 | Train Loss: 1.940 Vali Loss: 1.864 Vali Acc: 0.296 Test Loss: 1.864 Test Acc: 0.296
Validation loss decreased (inf --> -0.296278).  Saving model ...
Epoch: 2 cost time: 0.5070137977600098
Epoch: 2, Steps: 2 | Train Loss: 1.877 Vali Loss: 1.779 Vali Acc: 0.322 Test Loss: 1.779 Test Acc: 0.322
Validation loss decreased (-0.296278 --> -0.322204).  Saving model ...
Epoch: 3 cost time: 0.5484116077423096
Epoch: 3, Steps: 2 | Train Loss: 1.763 Vali Loss: 1.710 Vali Acc: 0.348 Test Loss: 1.710 Test Acc: 0.348
Validation loss decreased (-0.322204 --> -0.348131).  Saving model ...
Epoch: 4 cost time: 0.47708916664123535
Epoch: 4, Steps: 2 | Train Loss: 1.725 Vali Loss: 1.632 Vali Acc: 0.385 Test Loss: 1.632 Test Acc: 0.385
Validation loss decreased (-0.348131 --> -0.385169).  Saving model ...
Epoch: 5 cost time: 0.6036529541015625
Epoch: 5, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.534 Vali Acc: 0.426 Test Loss: 1.534 Test Acc: 0.426
Validation loss decreased (-0.385169 --> -0.425911).  Saving model ...
Epoch: 6 cost time: 0.5212383270263672
Epoch: 6, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.424 Vali Acc: 0.489 Test Loss: 1.424 Test Acc: 0.489
Validation loss decreased (-0.425911 --> -0.488875).  Saving model ...
Epoch: 7 cost time: 0.49576592445373535
Epoch: 7, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.308 Vali Acc: 0.537 Test Loss: 1.308 Test Acc: 0.537
Validation loss decreased (-0.488875 --> -0.537024).  Saving model ...
Epoch: 8 cost time: 0.5009524822235107
Epoch: 8, Steps: 2 | Train Loss: 1.259 Vali Loss: 1.190 Vali Acc: 0.615 Test Loss: 1.190 Test Acc: 0.615
Validation loss decreased (-0.537024 --> -0.614803).  Saving model ...
Epoch: 9 cost time: 0.48352861404418945
Epoch: 9, Steps: 2 | Train Loss: 1.063 Vali Loss: 1.077 Vali Acc: 0.722 Test Loss: 1.077 Test Acc: 0.722
Validation loss decreased (-0.614803 --> -0.722211).  Saving model ...
Epoch: 10 cost time: 0.5601205825805664
Epoch: 10, Steps: 2 | Train Loss: 0.964 Vali Loss: 0.972 Vali Acc: 0.767 Test Loss: 0.972 Test Acc: 0.767
Validation loss decreased (-0.722211 --> -0.766657).  Saving model ...
Epoch: 11 cost time: 0.48241496086120605
Epoch: 11, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.872 Vali Acc: 0.837 Test Loss: 0.872 Test Acc: 0.837
Validation loss decreased (-0.766657 --> -0.837028).  Saving model ...
Epoch: 12 cost time: 0.4930148124694824
Epoch: 12, Steps: 2 | Train Loss: 0.699 Vali Loss: 0.780 Vali Acc: 0.859 Test Loss: 0.780 Test Acc: 0.859
Validation loss decreased (-0.837028 --> -0.859251).  Saving model ...
Epoch: 13 cost time: 0.48921680450439453
Epoch: 13, Steps: 2 | Train Loss: 0.638 Vali Loss: 0.700 Vali Acc: 0.870 Test Loss: 0.700 Test Acc: 0.870
Validation loss decreased (-0.859251 --> -0.870363).  Saving model ...
Epoch: 14 cost time: 0.5003321170806885
Epoch: 14, Steps: 2 | Train Loss: 0.545 Vali Loss: 0.628 Vali Acc: 0.878 Test Loss: 0.628 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 15 cost time: 0.47174763679504395
Epoch: 15, Steps: 2 | Train Loss: 0.467 Vali Loss: 0.567 Vali Acc: 0.878 Test Loss: 0.567 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 16 cost time: 0.48125433921813965
Epoch: 16, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.515 Vali Acc: 0.881 Test Loss: 0.515 Test Acc: 0.881
Validation loss decreased (-0.877772 --> -0.881476).  Saving model ...
Epoch: 17 cost time: 0.5160543918609619
Epoch: 17, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.472 Vali Acc: 0.885 Test Loss: 0.472 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 18 cost time: 0.4486393928527832
Epoch: 18, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.434 Vali Acc: 0.881 Test Loss: 0.434 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 0.4280714988708496
Epoch: 19, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.402 Vali Acc: 0.896 Test Loss: 0.402 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896292).  Saving model ...
Epoch: 20 cost time: 0.5025155544281006
Epoch: 20, Steps: 2 | Train Loss: 0.205 Vali Loss: 0.375 Vali Acc: 0.900 Test Loss: 0.375 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 21 cost time: 0.4236471652984619
Epoch: 21, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.352 Vali Acc: 0.896 Test Loss: 0.352 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.4790506362915039
Epoch: 22, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.334 Vali Acc: 0.893 Test Loss: 0.334 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.4377002716064453
Epoch: 23, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.318 Vali Acc: 0.896 Test Loss: 0.318 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 0.45065784454345703
Epoch: 24, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.304 Vali Acc: 0.900 Test Loss: 0.304 Test Acc: 0.900
Validation loss decreased (-0.899996 --> -0.899997).  Saving model ...
Epoch: 25 cost time: 0.4599170684814453
Epoch: 25, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.293 Vali Acc: 0.904 Test Loss: 0.293 Test Acc: 0.904
Validation loss decreased (-0.899997 --> -0.903701).  Saving model ...
Epoch: 26 cost time: 0.49640893936157227
Epoch: 26, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.283 Vali Acc: 0.907 Test Loss: 0.283 Test Acc: 0.907
Validation loss decreased (-0.903701 --> -0.907405).  Saving model ...
Epoch: 27 cost time: 0.45268917083740234
Epoch: 27, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.276 Vali Acc: 0.911 Test Loss: 0.276 Test Acc: 0.911
Validation loss decreased (-0.907405 --> -0.911108).  Saving model ...
Epoch: 28 cost time: 0.4711148738861084
Epoch: 28, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.270 Vali Acc: 0.907 Test Loss: 0.270 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4823014736175537
Epoch: 29, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.264 Vali Acc: 0.907 Test Loss: 0.264 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.543940544128418
Epoch: 30, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.260 Vali Acc: 0.907 Test Loss: 0.260 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 0.5425307750701904
Epoch: 31, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.256 Vali Acc: 0.904 Test Loss: 0.256 Test Acc: 0.904
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 0.4285862445831299
Epoch: 32, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.253 Vali Acc: 0.911 Test Loss: 0.253 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911109).  Saving model ...
Epoch: 33 cost time: 0.5285201072692871
Epoch: 33, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.251 Vali Acc: 0.907 Test Loss: 0.251 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.54079270362854
Epoch: 34, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.250 Vali Acc: 0.907 Test Loss: 0.250 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.5238521099090576
Epoch: 35, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.248 Vali Acc: 0.907 Test Loss: 0.248 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5067203044891357
Epoch: 36, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.246 Vali Acc: 0.915 Test Loss: 0.246 Test Acc: 0.915
Validation loss decreased (-0.911109 --> -0.914812).  Saving model ...
Epoch: 37 cost time: 0.5215857028961182
Epoch: 37, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.245 Vali Acc: 0.915 Test Loss: 0.245 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 38 cost time: 0.4788393974304199
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.244 Vali Acc: 0.915 Test Loss: 0.244 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 39 cost time: 0.514352560043335
Epoch: 39, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.243 Vali Acc: 0.915 Test Loss: 0.243 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 40 cost time: 0.4840049743652344
Epoch: 40, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 41 cost time: 0.4304814338684082
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.242 Vali Acc: 0.915 Test Loss: 0.242 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 42 cost time: 0.441601037979126
Epoch: 42, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.241 Vali Acc: 0.915 Test Loss: 0.241 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 43 cost time: 0.459716796875
Epoch: 43, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.45548105239868164
Epoch: 44, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.41067957878112793
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.444913387298584
Epoch: 46, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.241 Vali Acc: 0.907 Test Loss: 0.241 Test Acc: 0.907
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.4586184024810791
Epoch: 47, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.240 Vali Acc: 0.907 Test Loss: 0.240 Test Acc: 0.907
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.46019911766052246
Epoch: 48, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.239 Vali Acc: 0.907 Test Loss: 0.239 Test Acc: 0.907
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.47890424728393555
Epoch: 49, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.238 Vali Acc: 0.907 Test Loss: 0.238 Test Acc: 0.907
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.49809861183166504
Epoch: 50, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.4926114082336426
Epoch: 51, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.47278261184692383
Epoch: 52, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.236 Vali Acc: 0.911 Test Loss: 0.236 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 68006
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.073423147201538
Epoch: 1, Steps: 2 | Train Loss: 2.008 Vali Loss: 1.876 Vali Acc: 0.274 Test Loss: 1.876 Test Acc: 0.274
Validation loss decreased (inf --> -0.274055).  Saving model ...
Epoch: 2 cost time: 0.4489305019378662
Epoch: 2, Steps: 2 | Train Loss: 1.941 Vali Loss: 1.798 Vali Acc: 0.296 Test Loss: 1.798 Test Acc: 0.296
Validation loss decreased (-0.274055 --> -0.296278).  Saving model ...
Epoch: 3 cost time: 0.5070436000823975
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.734 Vali Acc: 0.304 Test Loss: 1.734 Test Acc: 0.304
Validation loss decreased (-0.296278 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.48213720321655273
Epoch: 4, Steps: 2 | Train Loss: 1.805 Vali Loss: 1.662 Vali Acc: 0.322 Test Loss: 1.662 Test Acc: 0.322
Validation loss decreased (-0.303686 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.4970264434814453
Epoch: 5, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.571 Vali Acc: 0.363 Test Loss: 1.571 Test Acc: 0.363
Validation loss decreased (-0.322206 --> -0.362947).  Saving model ...
Epoch: 6 cost time: 0.531064510345459
Epoch: 6, Steps: 2 | Train Loss: 1.580 Vali Loss: 1.470 Vali Acc: 0.419 Test Loss: 1.470 Test Acc: 0.419
Validation loss decreased (-0.362947 --> -0.418504).  Saving model ...
Epoch: 7 cost time: 0.46642470359802246
Epoch: 7, Steps: 2 | Train Loss: 1.468 Vali Loss: 1.362 Vali Acc: 0.493 Test Loss: 1.362 Test Acc: 0.493
Validation loss decreased (-0.418504 --> -0.492579).  Saving model ...
Epoch: 8 cost time: 0.4827132225036621
Epoch: 8, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.254 Vali Acc: 0.544 Test Loss: 1.254 Test Acc: 0.544
Validation loss decreased (-0.492579 --> -0.544432).  Saving model ...
Epoch: 9 cost time: 0.5162961483001709
Epoch: 9, Steps: 2 | Train Loss: 1.182 Vali Loss: 1.150 Vali Acc: 0.637 Test Loss: 1.150 Test Acc: 0.637
Validation loss decreased (-0.544432 --> -0.637026).  Saving model ...
Epoch: 10 cost time: 0.5047903060913086
Epoch: 10, Steps: 2 | Train Loss: 1.080 Vali Loss: 1.052 Vali Acc: 0.707 Test Loss: 1.052 Test Acc: 0.707
Validation loss decreased (-0.637026 --> -0.707397).  Saving model ...
Epoch: 11 cost time: 0.47907280921936035
Epoch: 11, Steps: 2 | Train Loss: 1.031 Vali Loss: 0.960 Vali Acc: 0.759 Test Loss: 0.960 Test Acc: 0.759
Validation loss decreased (-0.707397 --> -0.759250).  Saving model ...
Epoch: 12 cost time: 0.49368977546691895
Epoch: 12, Steps: 2 | Train Loss: 0.849 Vali Loss: 0.874 Vali Acc: 0.789 Test Loss: 0.874 Test Acc: 0.789
Validation loss decreased (-0.759250 --> -0.788880).  Saving model ...
Epoch: 13 cost time: 0.44045186042785645
Epoch: 13, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.797 Vali Acc: 0.811 Test Loss: 0.797 Test Acc: 0.811
Validation loss decreased (-0.788880 --> -0.811103).  Saving model ...
Epoch: 14 cost time: 0.4496495723724365
Epoch: 14, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.728 Vali Acc: 0.822 Test Loss: 0.728 Test Acc: 0.822
Validation loss decreased (-0.811103 --> -0.822215).  Saving model ...
Epoch: 15 cost time: 0.43914175033569336
Epoch: 15, Steps: 2 | Train Loss: 0.616 Vali Loss: 0.668 Vali Acc: 0.833 Test Loss: 0.668 Test Acc: 0.833
Validation loss decreased (-0.822215 --> -0.833327).  Saving model ...
Epoch: 16 cost time: 0.4930233955383301
Epoch: 16, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.616 Vali Acc: 0.822 Test Loss: 0.616 Test Acc: 0.822
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 0.44858288764953613
Epoch: 17, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.572 Vali Acc: 0.826 Test Loss: 0.572 Test Acc: 0.826
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 0.45370054244995117
Epoch: 18, Steps: 2 | Train Loss: 0.377 Vali Loss: 0.533 Vali Acc: 0.844 Test Loss: 0.533 Test Acc: 0.844
Validation loss decreased (-0.833327 --> -0.844439).  Saving model ...
Epoch: 19 cost time: 0.45077967643737793
Epoch: 19, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.500 Vali Acc: 0.844 Test Loss: 0.500 Test Acc: 0.844
Validation loss decreased (-0.844439 --> -0.844439).  Saving model ...
Epoch: 20 cost time: 0.4678497314453125
Epoch: 20, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.472 Vali Acc: 0.856 Test Loss: 0.472 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855551).  Saving model ...
Epoch: 21 cost time: 0.4231226444244385
Epoch: 21, Steps: 2 | Train Loss: 0.290 Vali Loss: 0.448 Vali Acc: 0.863 Test Loss: 0.448 Test Acc: 0.863
Validation loss decreased (-0.855551 --> -0.862958).  Saving model ...
Epoch: 22 cost time: 0.44083094596862793
Epoch: 22, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.427 Vali Acc: 0.867 Test Loss: 0.427 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 23 cost time: 0.5125575065612793
Epoch: 23, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.409 Vali Acc: 0.863 Test Loss: 0.409 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.45427966117858887
Epoch: 24, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.392 Vali Acc: 0.870 Test Loss: 0.392 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 25 cost time: 0.449493408203125
Epoch: 25, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.379 Vali Acc: 0.885 Test Loss: 0.379 Test Acc: 0.885
Validation loss decreased (-0.870366 --> -0.885181).  Saving model ...
Epoch: 26 cost time: 0.449068546295166
Epoch: 26, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.368 Vali Acc: 0.885 Test Loss: 0.368 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885182).  Saving model ...
Epoch: 27 cost time: 0.44522714614868164
Epoch: 27, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.360 Vali Acc: 0.878 Test Loss: 0.360 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4618394374847412
Epoch: 28, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.351 Vali Acc: 0.878 Test Loss: 0.351 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 0.4761192798614502
Epoch: 29, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.345 Vali Acc: 0.885 Test Loss: 0.345 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 30 cost time: 0.46558165550231934
Epoch: 30, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.339 Vali Acc: 0.878 Test Loss: 0.339 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.504723310470581
Epoch: 31, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.333 Vali Acc: 0.881 Test Loss: 0.333 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5083091259002686
Epoch: 32, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.329 Vali Acc: 0.885 Test Loss: 0.329 Test Acc: 0.885
Validation loss decreased (-0.885182 --> -0.885182).  Saving model ...
Epoch: 33 cost time: 0.46674489974975586
Epoch: 33, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.326 Vali Acc: 0.889 Test Loss: 0.326 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888886).  Saving model ...
Epoch: 34 cost time: 0.5264186859130859
Epoch: 34, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.321 Vali Acc: 0.889 Test Loss: 0.321 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 35 cost time: 0.5045149326324463
Epoch: 35, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.317 Vali Acc: 0.881 Test Loss: 0.317 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.4866805076599121
Epoch: 36, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.313 Vali Acc: 0.881 Test Loss: 0.313 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4750072956085205
Epoch: 37, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.311 Vali Acc: 0.881 Test Loss: 0.311 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4835495948791504
Epoch: 38, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.309 Vali Acc: 0.881 Test Loss: 0.309 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4493415355682373
Epoch: 39, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.308 Vali Acc: 0.881 Test Loss: 0.308 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.40785980224609375
Epoch: 40, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.306 Vali Acc: 0.881 Test Loss: 0.306 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.434528112411499
Epoch: 41, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 42 cost time: 0.41463565826416016
Epoch: 42, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 43 cost time: 0.408062219619751
Epoch: 43, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.43924713134765625
Epoch: 44, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.305 Vali Acc: 0.889 Test Loss: 0.305 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 45 cost time: 0.4273107051849365
Epoch: 45, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.304 Vali Acc: 0.889 Test Loss: 0.304 Test Acc: 0.889
Validation loss decreased (-0.888886 --> -0.888886).  Saving model ...
Epoch: 46 cost time: 0.39109134674072266
Epoch: 46, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.304 Vali Acc: 0.885 Test Loss: 0.304 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.4045391082763672
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.302 Vali Acc: 0.881 Test Loss: 0.302 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.38802504539489746
Epoch: 48, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.299 Vali Acc: 0.881 Test Loss: 0.299 Test Acc: 0.881
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.39670372009277344
Epoch: 49, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.297 Vali Acc: 0.893 Test Loss: 0.297 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892590).  Saving model ...
Epoch: 50 cost time: 0.4399700164794922
Epoch: 50, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
Validation loss decreased (-0.892590 --> -0.896293).  Saving model ...
Epoch: 51 cost time: 0.4544041156768799
Epoch: 51, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
Validation loss decreased (-0.896293 --> -0.896293).  Saving model ...
Epoch: 52 cost time: 0.4755558967590332
Epoch: 52, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.295 Vali Acc: 0.900 Test Loss: 0.295 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 53 cost time: 0.4753594398498535
Epoch: 53, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5210084915161133
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.48799824714660645
Epoch: 55, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.295 Vali Acc: 0.885 Test Loss: 0.295 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.4655330181121826
Epoch: 56, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.295 Vali Acc: 0.889 Test Loss: 0.295 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.48148036003112793
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.294 Vali Acc: 0.885 Test Loss: 0.294 Test Acc: 0.885
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5045263767242432
Epoch: 58, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.294 Vali Acc: 0.893 Test Loss: 0.294 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 59 cost time: 0.45061469078063965
Epoch: 59, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.293 Vali Acc: 0.893 Test Loss: 0.293 Test Acc: 0.893
EarlyStopping counter: 7 out of 10
Epoch: 60 cost time: 0.4926927089691162
Epoch: 60, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
Validation loss decreased (-0.899997 --> -0.907404).  Saving model ...
Epoch: 61 cost time: 0.45325446128845215
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 62 cost time: 0.44560813903808594
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 63 cost time: 0.519578218460083
Epoch: 63, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.291 Vali Acc: 0.907 Test Loss: 0.291 Test Acc: 0.907
Validation loss decreased (-0.907404 --> -0.907404).  Saving model ...
Epoch: 64 cost time: 0.5300750732421875
Epoch: 64, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 65 cost time: 0.5379865169525146
Epoch: 65, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.292 Vali Acc: 0.907 Test Loss: 0.292 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 66 cost time: 0.48037052154541016
Epoch: 66, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.904 Test Loss: 0.292 Test Acc: 0.904
EarlyStopping counter: 3 out of 10
Epoch: 67 cost time: 0.41022777557373047
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.896 Test Loss: 0.293 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 68 cost time: 0.4696078300476074
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 5 out of 10
Epoch: 69 cost time: 0.45979809761047363
Epoch: 69, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 6 out of 10
Epoch: 70 cost time: 0.47400665283203125
Epoch: 70, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.293 Vali Acc: 0.900 Test Loss: 0.293 Test Acc: 0.900
EarlyStopping counter: 7 out of 10
Epoch: 71 cost time: 0.46188926696777344
Epoch: 71, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 8 out of 10
Epoch: 72 cost time: 0.41754889488220215
Epoch: 72, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.292 Vali Acc: 0.900 Test Loss: 0.292 Test Acc: 0.900
EarlyStopping counter: 9 out of 10
Epoch: 73 cost time: 0.49948811531066895
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.291 Vali Acc: 0.900 Test Loss: 0.291 Test Acc: 0.900
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9074074074074074
model parameter : 68006
model size : 1.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.182562828063965
Epoch: 1, Steps: 2 | Train Loss: 2.170 Vali Loss: 1.857 Vali Acc: 0.181 Test Loss: 1.857 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.4349637031555176
Epoch: 2, Steps: 2 | Train Loss: 1.886 Vali Loss: 1.770 Vali Acc: 0.215 Test Loss: 1.770 Test Acc: 0.215
Validation loss decreased (-0.181463 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.49075818061828613
Epoch: 3, Steps: 2 | Train Loss: 1.826 Vali Loss: 1.697 Vali Acc: 0.259 Test Loss: 1.697 Test Acc: 0.259
Validation loss decreased (-0.214797 --> -0.259242).  Saving model ...
Epoch: 4 cost time: 0.5070421695709229
Epoch: 4, Steps: 2 | Train Loss: 1.688 Vali Loss: 1.619 Vali Acc: 0.319 Test Loss: 1.619 Test Acc: 0.319
Validation loss decreased (-0.259242 --> -0.318502).  Saving model ...
Epoch: 5 cost time: 0.4853184223175049
Epoch: 5, Steps: 2 | Train Loss: 1.790 Vali Loss: 1.521 Vali Acc: 0.396 Test Loss: 1.521 Test Acc: 0.396
Validation loss decreased (-0.318502 --> -0.396281).  Saving model ...
Epoch: 6 cost time: 0.5073888301849365
Epoch: 6, Steps: 2 | Train Loss: 1.465 Vali Loss: 1.412 Vali Acc: 0.507 Test Loss: 1.412 Test Acc: 0.507
Validation loss decreased (-0.396281 --> -0.507393).  Saving model ...
Epoch: 7 cost time: 0.5032086372375488
Epoch: 7, Steps: 2 | Train Loss: 1.450 Vali Loss: 1.297 Vali Acc: 0.633 Test Loss: 1.297 Test Acc: 0.633
Validation loss decreased (-0.507393 --> -0.633320).  Saving model ...
Epoch: 8 cost time: 0.4953267574310303
Epoch: 8, Steps: 2 | Train Loss: 1.262 Vali Loss: 1.181 Vali Acc: 0.674 Test Loss: 1.181 Test Acc: 0.674
Validation loss decreased (-0.633320 --> -0.674062).  Saving model ...
Epoch: 9 cost time: 0.49012041091918945
Epoch: 9, Steps: 2 | Train Loss: 1.093 Vali Loss: 1.068 Vali Acc: 0.726 Test Loss: 1.068 Test Acc: 0.726
Validation loss decreased (-0.674062 --> -0.725915).  Saving model ...
Epoch: 10 cost time: 0.46910715103149414
Epoch: 10, Steps: 2 | Train Loss: 0.999 Vali Loss: 0.961 Vali Acc: 0.737 Test Loss: 0.961 Test Acc: 0.737
Validation loss decreased (-0.725915 --> -0.737027).  Saving model ...
Epoch: 11 cost time: 0.47303175926208496
Epoch: 11, Steps: 2 | Train Loss: 0.866 Vali Loss: 0.862 Vali Acc: 0.781 Test Loss: 0.862 Test Acc: 0.781
Validation loss decreased (-0.737027 --> -0.781473).  Saving model ...
Epoch: 12 cost time: 0.4522249698638916
Epoch: 12, Steps: 2 | Train Loss: 0.697 Vali Loss: 0.773 Vali Acc: 0.819 Test Loss: 0.773 Test Acc: 0.819
Validation loss decreased (-0.781473 --> -0.818511).  Saving model ...
Epoch: 13 cost time: 0.4914546012878418
Epoch: 13, Steps: 2 | Train Loss: 0.655 Vali Loss: 0.695 Vali Acc: 0.837 Test Loss: 0.695 Test Acc: 0.837
Validation loss decreased (-0.818511 --> -0.837030).  Saving model ...
Epoch: 14 cost time: 0.4492976665496826
Epoch: 14, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.628 Vali Acc: 0.848 Test Loss: 0.628 Test Acc: 0.848
Validation loss decreased (-0.837030 --> -0.848142).  Saving model ...
Epoch: 15 cost time: 0.4583852291107178
Epoch: 15, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.569 Vali Acc: 0.867 Test Loss: 0.569 Test Acc: 0.867
Validation loss decreased (-0.848142 --> -0.866661).  Saving model ...
Epoch: 16 cost time: 0.5093464851379395
Epoch: 16, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.516 Vali Acc: 0.867 Test Loss: 0.516 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866662).  Saving model ...
Epoch: 17 cost time: 0.4765148162841797
Epoch: 17, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.469 Vali Acc: 0.885 Test Loss: 0.469 Test Acc: 0.885
Validation loss decreased (-0.866662 --> -0.885180).  Saving model ...
Epoch: 18 cost time: 0.46725964546203613
Epoch: 18, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.427 Vali Acc: 0.896 Test Loss: 0.427 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.4196937084197998
Epoch: 19, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.391 Vali Acc: 0.904 Test Loss: 0.391 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.4453096389770508
Epoch: 20, Steps: 2 | Train Loss: 0.212 Vali Loss: 0.360 Vali Acc: 0.911 Test Loss: 0.360 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.3991570472717285
Epoch: 21, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.334 Vali Acc: 0.911 Test Loss: 0.334 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.4134993553161621
Epoch: 22, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.314 Vali Acc: 0.915 Test Loss: 0.314 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 23 cost time: 0.4284849166870117
Epoch: 23, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.295 Vali Acc: 0.919 Test Loss: 0.295 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 24 cost time: 0.44681477546691895
Epoch: 24, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 0.4288790225982666
Epoch: 25, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.268 Vali Acc: 0.919 Test Loss: 0.268 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 26 cost time: 0.4406430721282959
Epoch: 26, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.258 Vali Acc: 0.922 Test Loss: 0.258 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.4523649215698242
Epoch: 27, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925923).  Saving model ...
Epoch: 28 cost time: 0.44277501106262207
Epoch: 28, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.925923 --> -0.933331).  Saving model ...
Epoch: 29 cost time: 0.48493289947509766
Epoch: 29, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.237 Vali Acc: 0.933 Test Loss: 0.237 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 30 cost time: 0.4583456516265869
Epoch: 30, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.5028631687164307
Epoch: 31, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.4407844543457031
Epoch: 32, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.4709188938140869
Epoch: 33, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.4545176029205322
Epoch: 34, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.446134090423584
Epoch: 35, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 0.4241342544555664
Epoch: 36, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 0.4502530097961426
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 0.459705114364624
Epoch: 38, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 0.48584842681884766
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 0.44513368606567383
Epoch: 40, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 0.45141005516052246
Epoch: 41, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 0.4708390235900879
Epoch: 42, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 0.5105130672454834
Epoch: 43, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 51622
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.907534122467041
Epoch: 1, Steps: 2 | Train Loss: 2.172 Vali Loss: 1.855 Vali Acc: 0.185 Test Loss: 1.855 Test Acc: 0.185
Validation loss decreased (inf --> -0.185167).  Saving model ...
Epoch: 2 cost time: 0.39962339401245117
Epoch: 2, Steps: 2 | Train Loss: 1.924 Vali Loss: 1.769 Vali Acc: 0.215 Test Loss: 1.769 Test Acc: 0.215
Validation loss decreased (-0.185167 --> -0.214797).  Saving model ...
Epoch: 3 cost time: 0.42948293685913086
Epoch: 3, Steps: 2 | Train Loss: 1.842 Vali Loss: 1.697 Vali Acc: 0.252 Test Loss: 1.697 Test Acc: 0.252
Validation loss decreased (-0.214797 --> -0.251835).  Saving model ...
Epoch: 4 cost time: 0.42864179611206055
Epoch: 4, Steps: 2 | Train Loss: 1.704 Vali Loss: 1.618 Vali Acc: 0.296 Test Loss: 1.618 Test Acc: 0.296
Validation loss decreased (-0.251835 --> -0.296280).  Saving model ...
Epoch: 5 cost time: 0.4238879680633545
Epoch: 5, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.521 Vali Acc: 0.393 Test Loss: 1.521 Test Acc: 0.393
Validation loss decreased (-0.296280 --> -0.392577).  Saving model ...
Epoch: 6 cost time: 0.45241498947143555
Epoch: 6, Steps: 2 | Train Loss: 1.488 Vali Loss: 1.412 Vali Acc: 0.504 Test Loss: 1.412 Test Acc: 0.504
Validation loss decreased (-0.392577 --> -0.503690).  Saving model ...
Epoch: 7 cost time: 0.4771862030029297
Epoch: 7, Steps: 2 | Train Loss: 1.487 Vali Loss: 1.298 Vali Acc: 0.615 Test Loss: 1.298 Test Acc: 0.615
Validation loss decreased (-0.503690 --> -0.614802).  Saving model ...
Epoch: 8 cost time: 0.4380488395690918
Epoch: 8, Steps: 2 | Train Loss: 1.291 Vali Loss: 1.183 Vali Acc: 0.652 Test Loss: 1.183 Test Acc: 0.652
Validation loss decreased (-0.614802 --> -0.651840).  Saving model ...
Epoch: 9 cost time: 0.4602475166320801
Epoch: 9, Steps: 2 | Train Loss: 1.106 Vali Loss: 1.071 Vali Acc: 0.700 Test Loss: 1.071 Test Acc: 0.700
Validation loss decreased (-0.651840 --> -0.699989).  Saving model ...
Epoch: 10 cost time: 0.5708568096160889
Epoch: 10, Steps: 2 | Train Loss: 0.993 Vali Loss: 0.966 Vali Acc: 0.722 Test Loss: 0.966 Test Acc: 0.722
Validation loss decreased (-0.699989 --> -0.722213).  Saving model ...
Epoch: 11 cost time: 0.5645263195037842
Epoch: 11, Steps: 2 | Train Loss: 0.857 Vali Loss: 0.867 Vali Acc: 0.767 Test Loss: 0.867 Test Acc: 0.767
Validation loss decreased (-0.722213 --> -0.766658).  Saving model ...
Epoch: 12 cost time: 0.503929615020752
Epoch: 12, Steps: 2 | Train Loss: 0.707 Vali Loss: 0.779 Vali Acc: 0.807 Test Loss: 0.779 Test Acc: 0.807
Validation loss decreased (-0.766658 --> -0.807400).  Saving model ...
Epoch: 13 cost time: 0.5157058238983154
Epoch: 13, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.703 Vali Acc: 0.837 Test Loss: 0.703 Test Acc: 0.837
Validation loss decreased (-0.807400 --> -0.837030).  Saving model ...
Epoch: 14 cost time: 0.4749634265899658
Epoch: 14, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.635 Vali Acc: 0.852 Test Loss: 0.635 Test Acc: 0.852
Validation loss decreased (-0.837030 --> -0.851845).  Saving model ...
Epoch: 15 cost time: 0.607764482498169
Epoch: 15, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.577 Vali Acc: 0.863 Test Loss: 0.577 Test Acc: 0.863
Validation loss decreased (-0.851845 --> -0.862957).  Saving model ...
Epoch: 16 cost time: 0.6005492210388184
Epoch: 16, Steps: 2 | Train Loss: 0.421 Vali Loss: 0.524 Vali Acc: 0.867 Test Loss: 0.524 Test Acc: 0.867
Validation loss decreased (-0.862957 --> -0.866661).  Saving model ...
Epoch: 17 cost time: 0.6513895988464355
Epoch: 17, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.478 Vali Acc: 0.893 Test Loss: 0.478 Test Acc: 0.893
Validation loss decreased (-0.866661 --> -0.892588).  Saving model ...
Epoch: 18 cost time: 0.6415574550628662
Epoch: 18, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.436 Vali Acc: 0.896 Test Loss: 0.436 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.5878951549530029
Epoch: 19, Steps: 2 | Train Loss: 0.242 Vali Loss: 0.400 Vali Acc: 0.900 Test Loss: 0.400 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 20 cost time: 0.5734841823577881
Epoch: 20, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.370 Vali Acc: 0.915 Test Loss: 0.370 Test Acc: 0.915
Validation loss decreased (-0.899996 --> -0.914811).  Saving model ...
Epoch: 21 cost time: 0.583714485168457
Epoch: 21, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.343 Vali Acc: 0.922 Test Loss: 0.343 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 22 cost time: 0.5493700504302979
Epoch: 22, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5233912467956543
Epoch: 23, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.304 Vali Acc: 0.915 Test Loss: 0.304 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.5223615169525146
Epoch: 24, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.288 Vali Acc: 0.919 Test Loss: 0.288 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 0.5419185161590576
Epoch: 25, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 0.5147848129272461
Epoch: 26, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.578251838684082
Epoch: 27, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.5536420345306396
Epoch: 28, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 29 cost time: 0.5940439701080322
Epoch: 29, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.6042807102203369
Epoch: 30, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.5942707061767578
Epoch: 31, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.5715551376342773
Epoch: 32, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.232 Vali Acc: 0.933 Test Loss: 0.232 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 33 cost time: 0.6009860038757324
Epoch: 33, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 34 cost time: 0.6046481132507324
Epoch: 34, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 35 cost time: 0.5809271335601807
Epoch: 35, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.623767614364624
Epoch: 36, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5687108039855957
Epoch: 37, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5517730712890625
Epoch: 38, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.6182894706726074
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5599467754364014
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.580590009689331
Epoch: 41, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5427834987640381
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.44162416458129883
Epoch: 43, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.4979567527770996
Epoch: 44, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.214 Vali Acc: 0.926 Test Loss: 0.214 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 51622
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.100161552429199
Epoch: 1, Steps: 2 | Train Loss: 2.120 Vali Loss: 1.826 Vali Acc: 0.181 Test Loss: 1.826 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.5082776546478271
Epoch: 2, Steps: 2 | Train Loss: 1.905 Vali Loss: 1.741 Vali Acc: 0.211 Test Loss: 1.741 Test Acc: 0.211
Validation loss decreased (-0.181463 --> -0.211094).  Saving model ...
Epoch: 3 cost time: 0.47742390632629395
Epoch: 3, Steps: 2 | Train Loss: 1.839 Vali Loss: 1.671 Vali Acc: 0.219 Test Loss: 1.671 Test Acc: 0.219
Validation loss decreased (-0.211094 --> -0.218502).  Saving model ...
Epoch: 4 cost time: 0.4831252098083496
Epoch: 4, Steps: 2 | Train Loss: 1.683 Vali Loss: 1.594 Vali Acc: 0.281 Test Loss: 1.594 Test Acc: 0.281
Validation loss decreased (-0.218502 --> -0.281466).  Saving model ...
Epoch: 5 cost time: 0.4598832130432129
Epoch: 5, Steps: 2 | Train Loss: 1.747 Vali Loss: 1.500 Vali Acc: 0.419 Test Loss: 1.500 Test Acc: 0.419
Validation loss decreased (-0.281466 --> -0.418504).  Saving model ...
Epoch: 6 cost time: 0.4967002868652344
Epoch: 6, Steps: 2 | Train Loss: 1.520 Vali Loss: 1.394 Vali Acc: 0.541 Test Loss: 1.394 Test Acc: 0.541
Validation loss decreased (-0.418504 --> -0.540727).  Saving model ...
Epoch: 7 cost time: 0.4955010414123535
Epoch: 7, Steps: 2 | Train Loss: 1.447 Vali Loss: 1.283 Vali Acc: 0.622 Test Loss: 1.283 Test Acc: 0.622
Validation loss decreased (-0.540727 --> -0.622209).  Saving model ...
Epoch: 8 cost time: 0.49452829360961914
Epoch: 8, Steps: 2 | Train Loss: 1.300 Vali Loss: 1.172 Vali Acc: 0.678 Test Loss: 1.172 Test Acc: 0.678
Validation loss decreased (-0.622209 --> -0.677766).  Saving model ...
Epoch: 9 cost time: 0.4906327724456787
Epoch: 9, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.063 Vali Acc: 0.711 Test Loss: 1.063 Test Acc: 0.711
Validation loss decreased (-0.677766 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 0.4708826541900635
Epoch: 10, Steps: 2 | Train Loss: 1.006 Vali Loss: 0.961 Vali Acc: 0.741 Test Loss: 0.961 Test Acc: 0.741
Validation loss decreased (-0.711100 --> -0.740731).  Saving model ...
Epoch: 11 cost time: 0.45531368255615234
Epoch: 11, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.867 Vali Acc: 0.789 Test Loss: 0.867 Test Acc: 0.789
Validation loss decreased (-0.740731 --> -0.788880).  Saving model ...
Epoch: 12 cost time: 0.4261629581451416
Epoch: 12, Steps: 2 | Train Loss: 0.746 Vali Loss: 0.782 Vali Acc: 0.807 Test Loss: 0.782 Test Acc: 0.807
Validation loss decreased (-0.788880 --> -0.807400).  Saving model ...
Epoch: 13 cost time: 0.45955610275268555
Epoch: 13, Steps: 2 | Train Loss: 0.682 Vali Loss: 0.708 Vali Acc: 0.837 Test Loss: 0.708 Test Acc: 0.837
Validation loss decreased (-0.807400 --> -0.837030).  Saving model ...
Epoch: 14 cost time: 0.4418795108795166
Epoch: 14, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.644 Vali Acc: 0.848 Test Loss: 0.644 Test Acc: 0.848
Validation loss decreased (-0.837030 --> -0.848142).  Saving model ...
Epoch: 15 cost time: 0.4277191162109375
Epoch: 15, Steps: 2 | Train Loss: 0.529 Vali Loss: 0.589 Vali Acc: 0.859 Test Loss: 0.589 Test Acc: 0.859
Validation loss decreased (-0.848142 --> -0.859253).  Saving model ...
Epoch: 16 cost time: 0.4667818546295166
Epoch: 16, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.539 Vali Acc: 0.870 Test Loss: 0.539 Test Acc: 0.870
Validation loss decreased (-0.859253 --> -0.870365).  Saving model ...
Epoch: 17 cost time: 0.40851712226867676
Epoch: 17, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.496 Vali Acc: 0.870 Test Loss: 0.496 Test Acc: 0.870
Validation loss decreased (-0.870365 --> -0.870365).  Saving model ...
Epoch: 18 cost time: 0.5039651393890381
Epoch: 18, Steps: 2 | Train Loss: 0.319 Vali Loss: 0.457 Vali Acc: 0.885 Test Loss: 0.457 Test Acc: 0.885
Validation loss decreased (-0.870365 --> -0.885181).  Saving model ...
Epoch: 19 cost time: 0.477527379989624
Epoch: 19, Steps: 2 | Train Loss: 0.266 Vali Loss: 0.423 Vali Acc: 0.889 Test Loss: 0.423 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 20 cost time: 0.4303288459777832
Epoch: 20, Steps: 2 | Train Loss: 0.257 Vali Loss: 0.395 Vali Acc: 0.896 Test Loss: 0.395 Test Acc: 0.896
Validation loss decreased (-0.888885 --> -0.896292).  Saving model ...
Epoch: 21 cost time: 0.4920487403869629
Epoch: 21, Steps: 2 | Train Loss: 0.228 Vali Loss: 0.370 Vali Acc: 0.900 Test Loss: 0.370 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 22 cost time: 0.5527713298797607
Epoch: 22, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.350 Vali Acc: 0.907 Test Loss: 0.350 Test Acc: 0.907
Validation loss decreased (-0.899996 --> -0.907404).  Saving model ...
Epoch: 23 cost time: 0.46297192573547363
Epoch: 23, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.907404 --> -0.914811).  Saving model ...
Epoch: 24 cost time: 0.5127654075622559
Epoch: 24, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.315 Vali Acc: 0.919 Test Loss: 0.315 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 25 cost time: 0.5013937950134277
Epoch: 25, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.301 Vali Acc: 0.915 Test Loss: 0.301 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5465257167816162
Epoch: 26, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.5111770629882812
Epoch: 27, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.280 Vali Acc: 0.915 Test Loss: 0.280 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.5004775524139404
Epoch: 28, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.272 Vali Acc: 0.915 Test Loss: 0.272 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.49426794052124023
Epoch: 29, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.266 Vali Acc: 0.915 Test Loss: 0.266 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.49777984619140625
Epoch: 30, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.261 Vali Acc: 0.915 Test Loss: 0.261 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.45764875411987305
Epoch: 31, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.257 Vali Acc: 0.919 Test Loss: 0.257 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 32 cost time: 0.5198764801025391
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.253 Vali Acc: 0.919 Test Loss: 0.253 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 33 cost time: 0.51851487159729
Epoch: 33, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.250 Vali Acc: 0.919 Test Loss: 0.250 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 34 cost time: 0.532905101776123
Epoch: 34, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.248 Vali Acc: 0.919 Test Loss: 0.248 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 35 cost time: 0.5536215305328369
Epoch: 35, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.246 Vali Acc: 0.911 Test Loss: 0.246 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5225675106048584
Epoch: 36, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5463566780090332
Epoch: 37, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.244 Vali Acc: 0.911 Test Loss: 0.244 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5153634548187256
Epoch: 38, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.243 Vali Acc: 0.911 Test Loss: 0.243 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.49567484855651855
Epoch: 39, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.241 Vali Acc: 0.911 Test Loss: 0.241 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.47566652297973633
Epoch: 40, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.239 Vali Acc: 0.911 Test Loss: 0.239 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.4988377094268799
Epoch: 41, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.238 Vali Acc: 0.911 Test Loss: 0.238 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.5109453201293945
Epoch: 42, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.237 Vali Acc: 0.911 Test Loss: 0.237 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.4987044334411621
Epoch: 43, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.235 Vali Acc: 0.907 Test Loss: 0.235 Test Acc: 0.907
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 0.5341157913208008
Epoch: 44, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.234 Vali Acc: 0.911 Test Loss: 0.234 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 51622
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1962764263153076
Epoch: 1, Steps: 2 | Train Loss: 1.990 Vali Loss: 1.786 Vali Acc: 0.163 Test Loss: 1.786 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.4836268424987793
Epoch: 2, Steps: 2 | Train Loss: 1.849 Vali Loss: 1.707 Vali Acc: 0.185 Test Loss: 1.707 Test Acc: 0.185
Validation loss decreased (-0.162945 --> -0.185168).  Saving model ...
Epoch: 3 cost time: 0.5069971084594727
Epoch: 3, Steps: 2 | Train Loss: 1.761 Vali Loss: 1.642 Vali Acc: 0.230 Test Loss: 1.642 Test Acc: 0.230
Validation loss decreased (-0.185168 --> -0.229613).  Saving model ...
Epoch: 4 cost time: 0.502863883972168
Epoch: 4, Steps: 2 | Train Loss: 1.648 Vali Loss: 1.573 Vali Acc: 0.300 Test Loss: 1.573 Test Acc: 0.300
Validation loss decreased (-0.229613 --> -0.299984).  Saving model ...
Epoch: 5 cost time: 0.5311717987060547
Epoch: 5, Steps: 2 | Train Loss: 1.699 Vali Loss: 1.487 Vali Acc: 0.459 Test Loss: 1.487 Test Acc: 0.459
Validation loss decreased (-0.299984 --> -0.459244).  Saving model ...
Epoch: 6 cost time: 0.4925882816314697
Epoch: 6, Steps: 2 | Train Loss: 1.477 Vali Loss: 1.391 Vali Acc: 0.578 Test Loss: 1.391 Test Acc: 0.578
Validation loss decreased (-0.459244 --> -0.577764).  Saving model ...
Epoch: 7 cost time: 0.5085766315460205
Epoch: 7, Steps: 2 | Train Loss: 1.400 Vali Loss: 1.289 Vali Acc: 0.644 Test Loss: 1.289 Test Acc: 0.644
Validation loss decreased (-0.577764 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.5255980491638184
Epoch: 8, Steps: 2 | Train Loss: 1.305 Vali Loss: 1.188 Vali Acc: 0.696 Test Loss: 1.188 Test Acc: 0.696
Validation loss decreased (-0.644432 --> -0.696284).  Saving model ...
Epoch: 9 cost time: 0.5261821746826172
Epoch: 9, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.089 Vali Acc: 0.711 Test Loss: 1.089 Test Acc: 0.711
Validation loss decreased (-0.696284 --> -0.711100).  Saving model ...
Epoch: 10 cost time: 0.49153780937194824
Epoch: 10, Steps: 2 | Train Loss: 1.048 Vali Loss: 0.996 Vali Acc: 0.730 Test Loss: 0.996 Test Acc: 0.730
Validation loss decreased (-0.711100 --> -0.729620).  Saving model ...
Epoch: 11 cost time: 0.5008430480957031
Epoch: 11, Steps: 2 | Train Loss: 0.933 Vali Loss: 0.909 Vali Acc: 0.744 Test Loss: 0.909 Test Acc: 0.744
Validation loss decreased (-0.729620 --> -0.744435).  Saving model ...
Epoch: 12 cost time: 0.5434675216674805
Epoch: 12, Steps: 2 | Train Loss: 0.828 Vali Loss: 0.832 Vali Acc: 0.763 Test Loss: 0.832 Test Acc: 0.763
Validation loss decreased (-0.744435 --> -0.762955).  Saving model ...
Epoch: 13 cost time: 0.522498607635498
Epoch: 13, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.764 Vali Acc: 0.763 Test Loss: 0.764 Test Acc: 0.763
Validation loss decreased (-0.762955 --> -0.762955).  Saving model ...
Epoch: 14 cost time: 0.5381126403808594
Epoch: 14, Steps: 2 | Train Loss: 0.636 Vali Loss: 0.705 Vali Acc: 0.770 Test Loss: 0.705 Test Acc: 0.770
Validation loss decreased (-0.762955 --> -0.770363).  Saving model ...
Epoch: 15 cost time: 0.5202701091766357
Epoch: 15, Steps: 2 | Train Loss: 0.582 Vali Loss: 0.654 Vali Acc: 0.793 Test Loss: 0.654 Test Acc: 0.793
Validation loss decreased (-0.770363 --> -0.792586).  Saving model ...
Epoch: 16 cost time: 0.4601919651031494
Epoch: 16, Steps: 2 | Train Loss: 0.530 Vali Loss: 0.608 Vali Acc: 0.815 Test Loss: 0.608 Test Acc: 0.815
Validation loss decreased (-0.792586 --> -0.814809).  Saving model ...
Epoch: 17 cost time: 0.49849772453308105
Epoch: 17, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.568 Vali Acc: 0.833 Test Loss: 0.568 Test Acc: 0.833
Validation loss decreased (-0.814809 --> -0.833328).  Saving model ...
Epoch: 18 cost time: 0.4922208786010742
Epoch: 18, Steps: 2 | Train Loss: 0.434 Vali Loss: 0.533 Vali Acc: 0.848 Test Loss: 0.533 Test Acc: 0.848
Validation loss decreased (-0.833328 --> -0.848143).  Saving model ...
Epoch: 19 cost time: 0.46993565559387207
Epoch: 19, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.503 Vali Acc: 0.848 Test Loss: 0.503 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 20 cost time: 0.4683690071105957
Epoch: 20, Steps: 2 | Train Loss: 0.347 Vali Loss: 0.477 Vali Acc: 0.848 Test Loss: 0.477 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848143).  Saving model ...
Epoch: 21 cost time: 0.48418593406677246
Epoch: 21, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.455 Vali Acc: 0.848 Test Loss: 0.455 Test Acc: 0.848
Validation loss decreased (-0.848143 --> -0.848144).  Saving model ...
Epoch: 22 cost time: 0.4658660888671875
Epoch: 22, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.436 Vali Acc: 0.852 Test Loss: 0.436 Test Acc: 0.852
Validation loss decreased (-0.848144 --> -0.851847).  Saving model ...
Epoch: 23 cost time: 0.4759202003479004
Epoch: 23, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.418 Vali Acc: 0.859 Test Loss: 0.418 Test Acc: 0.859
Validation loss decreased (-0.851847 --> -0.859255).  Saving model ...
Epoch: 24 cost time: 0.4571990966796875
Epoch: 24, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.400 Vali Acc: 0.863 Test Loss: 0.400 Test Acc: 0.863
Validation loss decreased (-0.859255 --> -0.862959).  Saving model ...
Epoch: 25 cost time: 0.5100157260894775
Epoch: 25, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.385 Vali Acc: 0.878 Test Loss: 0.385 Test Acc: 0.878
Validation loss decreased (-0.862959 --> -0.877774).  Saving model ...
Epoch: 26 cost time: 0.5033152103424072
Epoch: 26, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.373 Vali Acc: 0.881 Test Loss: 0.373 Test Acc: 0.881
Validation loss decreased (-0.877774 --> -0.881478).  Saving model ...
Epoch: 27 cost time: 0.52280592918396
Epoch: 27, Steps: 2 | Train Loss: 0.168 Vali Loss: 0.362 Vali Acc: 0.881 Test Loss: 0.362 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 28 cost time: 0.48931002616882324
Epoch: 28, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.354 Vali Acc: 0.881 Test Loss: 0.354 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 29 cost time: 0.49396300315856934
Epoch: 29, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.347 Vali Acc: 0.881 Test Loss: 0.347 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 30 cost time: 0.5523025989532471
Epoch: 30, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.341 Vali Acc: 0.881 Test Loss: 0.341 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 31 cost time: 0.5186972618103027
Epoch: 31, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.335 Vali Acc: 0.885 Test Loss: 0.335 Test Acc: 0.885
Validation loss decreased (-0.881478 --> -0.885182).  Saving model ...
Epoch: 32 cost time: 0.5086188316345215
Epoch: 32, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.330 Vali Acc: 0.889 Test Loss: 0.330 Test Acc: 0.889
Validation loss decreased (-0.885182 --> -0.888886).  Saving model ...
Epoch: 33 cost time: 0.5032434463500977
Epoch: 33, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.326 Vali Acc: 0.893 Test Loss: 0.326 Test Acc: 0.893
Validation loss decreased (-0.888886 --> -0.892589).  Saving model ...
Epoch: 34 cost time: 0.50030517578125
Epoch: 34, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.322 Vali Acc: 0.896 Test Loss: 0.322 Test Acc: 0.896
Validation loss decreased (-0.892589 --> -0.896293).  Saving model ...
Epoch: 35 cost time: 0.4863853454589844
Epoch: 35, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.319 Vali Acc: 0.885 Test Loss: 0.319 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5067975521087646
Epoch: 36, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.318 Vali Acc: 0.881 Test Loss: 0.318 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.50791335105896
Epoch: 37, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.315 Vali Acc: 0.874 Test Loss: 0.315 Test Acc: 0.874
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5043628215789795
Epoch: 38, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.313 Vali Acc: 0.878 Test Loss: 0.313 Test Acc: 0.878
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5279290676116943
Epoch: 39, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.308 Vali Acc: 0.881 Test Loss: 0.308 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.4891245365142822
Epoch: 40, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.305 Vali Acc: 0.893 Test Loss: 0.305 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.42342615127563477
Epoch: 41, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.303 Vali Acc: 0.900 Test Loss: 0.303 Test Acc: 0.900
Validation loss decreased (-0.896293 --> -0.899997).  Saving model ...
Epoch: 42 cost time: 0.4281940460205078
Epoch: 42, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.300 Vali Acc: 0.900 Test Loss: 0.300 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 43 cost time: 0.3873331546783447
Epoch: 43, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.299 Vali Acc: 0.900 Test Loss: 0.299 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 44 cost time: 0.43653059005737305
Epoch: 44, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.298 Vali Acc: 0.900 Test Loss: 0.298 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 45 cost time: 0.45596742630004883
Epoch: 45, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.297 Vali Acc: 0.900 Test Loss: 0.297 Test Acc: 0.900
Validation loss decreased (-0.899997 --> -0.899997).  Saving model ...
Epoch: 46 cost time: 0.4799537658691406
Epoch: 46, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.297 Vali Acc: 0.893 Test Loss: 0.297 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 47 cost time: 0.45045900344848633
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.298 Vali Acc: 0.885 Test Loss: 0.298 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 48 cost time: 0.45156335830688477
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.297 Vali Acc: 0.896 Test Loss: 0.297 Test Acc: 0.896
EarlyStopping counter: 3 out of 10
Epoch: 49 cost time: 0.4233672618865967
Epoch: 49, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.296 Vali Acc: 0.896 Test Loss: 0.296 Test Acc: 0.896
EarlyStopping counter: 4 out of 10
Epoch: 50 cost time: 0.4737131595611572
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.295 Vali Acc: 0.896 Test Loss: 0.295 Test Acc: 0.896
EarlyStopping counter: 5 out of 10
Epoch: 51 cost time: 0.5259010791778564
Epoch: 51, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.294 Vali Acc: 0.896 Test Loss: 0.294 Test Acc: 0.896
EarlyStopping counter: 6 out of 10
Epoch: 52 cost time: 0.5135283470153809
Epoch: 52, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.294 Vali Acc: 0.896 Test Loss: 0.294 Test Acc: 0.896
EarlyStopping counter: 7 out of 10
Epoch: 53 cost time: 0.490192174911499
Epoch: 53, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.292 Vali Acc: 0.893 Test Loss: 0.292 Test Acc: 0.893
EarlyStopping counter: 8 out of 10
Epoch: 54 cost time: 0.4987654685974121
Epoch: 54, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.291 Vali Acc: 0.893 Test Loss: 0.291 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 55 cost time: 0.4734013080596924
Epoch: 55, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.290 Vali Acc: 0.893 Test Loss: 0.290 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9
model parameter : 51622
model size : 1.43MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1456799507141113
Epoch: 1, Steps: 2 | Train Loss: 2.048 Vali Loss: 1.832 Vali Acc: 0.163 Test Loss: 1.832 Test Acc: 0.163
Validation loss decreased (inf --> -0.162945).  Saving model ...
Epoch: 2 cost time: 0.5191552639007568
Epoch: 2, Steps: 2 | Train Loss: 1.827 Vali Loss: 1.745 Vali Acc: 0.233 Test Loss: 1.745 Test Acc: 0.233
Validation loss decreased (-0.162945 --> -0.233316).  Saving model ...
Epoch: 3 cost time: 0.5019307136535645
Epoch: 3, Steps: 2 | Train Loss: 1.707 Vali Loss: 1.672 Vali Acc: 0.322 Test Loss: 1.672 Test Acc: 0.322
Validation loss decreased (-0.233316 --> -0.322205).  Saving model ...
Epoch: 4 cost time: 0.5026717185974121
Epoch: 4, Steps: 2 | Train Loss: 1.814 Vali Loss: 1.595 Vali Acc: 0.415 Test Loss: 1.595 Test Acc: 0.415
Validation loss decreased (-0.322205 --> -0.414799).  Saving model ...
Epoch: 5 cost time: 0.45232129096984863
Epoch: 5, Steps: 2 | Train Loss: 1.715 Vali Loss: 1.500 Vali Acc: 0.481 Test Loss: 1.500 Test Acc: 0.481
Validation loss decreased (-0.414799 --> -0.481466).  Saving model ...
Epoch: 6 cost time: 0.4251542091369629
Epoch: 6, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.392 Vali Acc: 0.559 Test Loss: 1.392 Test Acc: 0.559
Validation loss decreased (-0.481466 --> -0.559245).  Saving model ...
Epoch: 7 cost time: 0.4372670650482178
Epoch: 7, Steps: 2 | Train Loss: 1.339 Vali Loss: 1.277 Vali Acc: 0.626 Test Loss: 1.277 Test Acc: 0.626
Validation loss decreased (-0.559245 --> -0.625913).  Saving model ...
Epoch: 8 cost time: 0.4780569076538086
Epoch: 8, Steps: 2 | Train Loss: 1.188 Vali Loss: 1.160 Vali Acc: 0.693 Test Loss: 1.160 Test Acc: 0.693
Validation loss decreased (-0.625913 --> -0.692581).  Saving model ...
Epoch: 9 cost time: 0.46172142028808594
Epoch: 9, Steps: 2 | Train Loss: 1.079 Vali Loss: 1.045 Vali Acc: 0.767 Test Loss: 1.045 Test Acc: 0.767
Validation loss decreased (-0.692581 --> -0.766656).  Saving model ...
Epoch: 10 cost time: 0.5245740413665771
Epoch: 10, Steps: 2 | Train Loss: 0.988 Vali Loss: 0.936 Vali Acc: 0.800 Test Loss: 0.936 Test Acc: 0.800
Validation loss decreased (-0.766656 --> -0.799991).  Saving model ...
Epoch: 11 cost time: 0.5059225559234619
Epoch: 11, Steps: 2 | Train Loss: 0.855 Vali Loss: 0.836 Vali Acc: 0.837 Test Loss: 0.836 Test Acc: 0.837
Validation loss decreased (-0.799991 --> -0.837029).  Saving model ...
Epoch: 12 cost time: 0.47701406478881836
Epoch: 12, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.748 Vali Acc: 0.870 Test Loss: 0.748 Test Acc: 0.870
Validation loss decreased (-0.837029 --> -0.870363).  Saving model ...
Epoch: 13 cost time: 0.49551892280578613
Epoch: 13, Steps: 2 | Train Loss: 0.647 Vali Loss: 0.670 Vali Acc: 0.889 Test Loss: 0.670 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888882).  Saving model ...
Epoch: 14 cost time: 0.49422550201416016
Epoch: 14, Steps: 2 | Train Loss: 0.495 Vali Loss: 0.602 Vali Acc: 0.885 Test Loss: 0.602 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 0.5165543556213379
Epoch: 15, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.542 Vali Acc: 0.881 Test Loss: 0.542 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 0.49994325637817383
Epoch: 16, Steps: 2 | Train Loss: 0.379 Vali Loss: 0.492 Vali Acc: 0.885 Test Loss: 0.492 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 0.5513191223144531
Epoch: 17, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.448 Vali Acc: 0.889 Test Loss: 0.448 Test Acc: 0.889
Validation loss decreased (-0.888882 --> -0.888884).  Saving model ...
Epoch: 18 cost time: 0.48774075508117676
Epoch: 18, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.408 Vali Acc: 0.896 Test Loss: 0.408 Test Acc: 0.896
Validation loss decreased (-0.888884 --> -0.896292).  Saving model ...
Epoch: 19 cost time: 0.5024020671844482
Epoch: 19, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.375 Vali Acc: 0.896 Test Loss: 0.375 Test Acc: 0.896
Validation loss decreased (-0.896292 --> -0.896293).  Saving model ...
Epoch: 20 cost time: 0.5085229873657227
Epoch: 20, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.346 Vali Acc: 0.911 Test Loss: 0.346 Test Acc: 0.911
Validation loss decreased (-0.896293 --> -0.911108).  Saving model ...
Epoch: 21 cost time: 0.47125816345214844
Epoch: 21, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.322 Vali Acc: 0.904 Test Loss: 0.322 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5283284187316895
Epoch: 22, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.302 Vali Acc: 0.907 Test Loss: 0.302 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 0.5189723968505859
Epoch: 23, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.285 Vali Acc: 0.915 Test Loss: 0.285 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 24 cost time: 0.5436079502105713
Epoch: 24, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.271 Vali Acc: 0.919 Test Loss: 0.271 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 25 cost time: 0.5926823616027832
Epoch: 25, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.259 Vali Acc: 0.915 Test Loss: 0.259 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5871801376342773
Epoch: 26, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 27 cost time: 0.47045016288757324
Epoch: 27, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.242 Vali Acc: 0.919 Test Loss: 0.242 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.5934906005859375
Epoch: 28, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 29 cost time: 0.5362675189971924
Epoch: 29, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4818100929260254
Epoch: 30, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.227 Vali Acc: 0.922 Test Loss: 0.227 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.42406797409057617
Epoch: 31, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 32 cost time: 0.6154594421386719
Epoch: 32, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 33 cost time: 0.5158226490020752
Epoch: 33, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 34 cost time: 0.5663764476776123
Epoch: 34, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 35 cost time: 0.5284910202026367
Epoch: 35, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 36 cost time: 0.5755302906036377
Epoch: 36, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 37 cost time: 0.6047120094299316
Epoch: 37, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 38 cost time: 0.6458067893981934
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 39 cost time: 0.6586151123046875
Epoch: 39, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 40 cost time: 0.588489294052124
Epoch: 40, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 41 cost time: 0.667252779006958
Epoch: 41, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 42 cost time: 0.6721336841583252
Epoch: 42, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 43 cost time: 0.6994462013244629
Epoch: 43, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.207 Vali Acc: 0.937 Test Loss: 0.207 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.6787972450256348
Epoch: 44, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.6522951126098633
Epoch: 45, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.206 Vali Acc: 0.937 Test Loss: 0.206 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.7057557106018066
Epoch: 46, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 47 cost time: 0.7057642936706543
Epoch: 47, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 48 cost time: 0.6641933917999268
Epoch: 48, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.205 Vali Acc: 0.937 Test Loss: 0.205 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 49 cost time: 0.7007842063903809
Epoch: 49, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 50 cost time: 0.656367301940918
Epoch: 50, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 51 cost time: 0.5486040115356445
Epoch: 51, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 52 cost time: 0.5787184238433838
Epoch: 52, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 53 cost time: 0.5548958778381348
Epoch: 53, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.204 Vali Acc: 0.937 Test Loss: 0.204 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 54 cost time: 0.6008844375610352
Epoch: 54, Steps: 2 | Train Loss: 0.006 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 55 cost time: 0.5651562213897705
Epoch: 55, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 56 cost time: 0.668954610824585
Epoch: 56, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 57 cost time: 0.6881136894226074
Epoch: 57, Steps: 2 | Train Loss: 0.007 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43430
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.044663429260254
Epoch: 1, Steps: 2 | Train Loss: 2.017 Vali Loss: 1.823 Vali Acc: 0.181 Test Loss: 1.823 Test Acc: 0.181
Validation loss decreased (inf --> -0.181463).  Saving model ...
Epoch: 2 cost time: 0.46463727951049805
Epoch: 2, Steps: 2 | Train Loss: 1.797 Vali Loss: 1.737 Vali Acc: 0.256 Test Loss: 1.737 Test Acc: 0.256
Validation loss decreased (-0.181463 --> -0.255538).  Saving model ...
Epoch: 3 cost time: 0.5053942203521729
Epoch: 3, Steps: 2 | Train Loss: 1.712 Vali Loss: 1.665 Vali Acc: 0.319 Test Loss: 1.665 Test Acc: 0.319
Validation loss decreased (-0.255538 --> -0.318502).  Saving model ...
Epoch: 4 cost time: 0.4910910129547119
Epoch: 4, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.589 Vali Acc: 0.407 Test Loss: 1.589 Test Acc: 0.407
Validation loss decreased (-0.318502 --> -0.407392).  Saving model ...
Epoch: 5 cost time: 0.4745349884033203
Epoch: 5, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.495 Vali Acc: 0.493 Test Loss: 1.495 Test Acc: 0.493
Validation loss decreased (-0.407392 --> -0.492578).  Saving model ...
Epoch: 6 cost time: 0.4925861358642578
Epoch: 6, Steps: 2 | Train Loss: 1.466 Vali Loss: 1.388 Vali Acc: 0.563 Test Loss: 1.388 Test Acc: 0.563
Validation loss decreased (-0.492578 --> -0.562949).  Saving model ...
Epoch: 7 cost time: 0.4234483242034912
Epoch: 7, Steps: 2 | Train Loss: 1.357 Vali Loss: 1.275 Vali Acc: 0.615 Test Loss: 1.275 Test Acc: 0.615
Validation loss decreased (-0.562949 --> -0.614802).  Saving model ...
Epoch: 8 cost time: 0.5040826797485352
Epoch: 8, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.159 Vali Acc: 0.674 Test Loss: 1.159 Test Acc: 0.674
Validation loss decreased (-0.614802 --> -0.674062).  Saving model ...
Epoch: 9 cost time: 0.4374668598175049
Epoch: 9, Steps: 2 | Train Loss: 1.087 Vali Loss: 1.046 Vali Acc: 0.733 Test Loss: 1.046 Test Acc: 0.733
Validation loss decreased (-0.674062 --> -0.733323).  Saving model ...
Epoch: 10 cost time: 0.5680227279663086
Epoch: 10, Steps: 2 | Train Loss: 0.987 Vali Loss: 0.938 Vali Acc: 0.793 Test Loss: 0.938 Test Acc: 0.793
Validation loss decreased (-0.733323 --> -0.792583).  Saving model ...
Epoch: 11 cost time: 0.5303783416748047
Epoch: 11, Steps: 2 | Train Loss: 0.877 Vali Loss: 0.839 Vali Acc: 0.830 Test Loss: 0.839 Test Acc: 0.830
Validation loss decreased (-0.792583 --> -0.829621).  Saving model ...
Epoch: 12 cost time: 0.5373213291168213
Epoch: 12, Steps: 2 | Train Loss: 0.711 Vali Loss: 0.751 Vali Acc: 0.863 Test Loss: 0.751 Test Acc: 0.863
Validation loss decreased (-0.829621 --> -0.862955).  Saving model ...
Epoch: 13 cost time: 0.5008251667022705
Epoch: 13, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.674 Vali Acc: 0.870 Test Loss: 0.674 Test Acc: 0.870
Validation loss decreased (-0.862955 --> -0.870364).  Saving model ...
Epoch: 14 cost time: 0.5406923294067383
Epoch: 14, Steps: 2 | Train Loss: 0.505 Vali Loss: 0.606 Vali Acc: 0.878 Test Loss: 0.606 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877772).  Saving model ...
Epoch: 15 cost time: 0.5568158626556396
Epoch: 15, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.546 Vali Acc: 0.885 Test Loss: 0.546 Test Acc: 0.885
Validation loss decreased (-0.877772 --> -0.885180).  Saving model ...
Epoch: 16 cost time: 0.5463860034942627
Epoch: 16, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.495 Vali Acc: 0.896 Test Loss: 0.495 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 17 cost time: 0.6349523067474365
Epoch: 17, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.451 Vali Acc: 0.896 Test Loss: 0.451 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896292).  Saving model ...
Epoch: 18 cost time: 0.5511147975921631
Epoch: 18, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.412 Vali Acc: 0.904 Test Loss: 0.412 Test Acc: 0.904
Validation loss decreased (-0.896292 --> -0.903700).  Saving model ...
Epoch: 19 cost time: 0.5190198421478271
Epoch: 19, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.379 Vali Acc: 0.907 Test Loss: 0.379 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 20 cost time: 0.49573469161987305
Epoch: 20, Steps: 2 | Train Loss: 0.176 Vali Loss: 0.351 Vali Acc: 0.904 Test Loss: 0.351 Test Acc: 0.904
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.5738861560821533
Epoch: 21, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.327 Vali Acc: 0.911 Test Loss: 0.327 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.5158460140228271
Epoch: 22, Steps: 2 | Train Loss: 0.133 Vali Loss: 0.306 Vali Acc: 0.907 Test Loss: 0.306 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5087442398071289
Epoch: 23, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.288 Vali Acc: 0.922 Test Loss: 0.288 Test Acc: 0.922
Validation loss decreased (-0.911108 --> -0.922219).  Saving model ...
Epoch: 24 cost time: 0.5623128414154053
Epoch: 24, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 25 cost time: 0.5941548347473145
Epoch: 25, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.261 Vali Acc: 0.926 Test Loss: 0.261 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 26 cost time: 0.4628467559814453
Epoch: 26, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.251 Vali Acc: 0.930 Test Loss: 0.251 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.5358943939208984
Epoch: 27, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 28 cost time: 0.5149753093719482
Epoch: 28, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 29 cost time: 0.5646874904632568
Epoch: 29, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 30 cost time: 0.5086474418640137
Epoch: 30, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 31 cost time: 0.5068213939666748
Epoch: 31, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 32 cost time: 0.4687652587890625
Epoch: 32, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.941 Test Loss: 0.224 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 33 cost time: 0.48673295974731445
Epoch: 33, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.49237608909606934
Epoch: 34, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4882807731628418
Epoch: 35, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5202188491821289
Epoch: 36, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5182199478149414
Epoch: 37, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.922 Test Loss: 0.216 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.4761369228363037
Epoch: 38, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.215 Vali Acc: 0.922 Test Loss: 0.215 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.4960460662841797
Epoch: 39, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5460774898529053
Epoch: 40, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.214 Vali Acc: 0.922 Test Loss: 0.214 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.5414130687713623
Epoch: 41, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.213 Vali Acc: 0.922 Test Loss: 0.213 Test Acc: 0.922
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5723416805267334
Epoch: 42, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.922 Test Loss: 0.212 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 43430
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.084585428237915
Epoch: 1, Steps: 2 | Train Loss: 1.968 Vali Loss: 1.794 Vali Acc: 0.204 Test Loss: 1.794 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.46363306045532227
Epoch: 2, Steps: 2 | Train Loss: 1.840 Vali Loss: 1.711 Vali Acc: 0.307 Test Loss: 1.711 Test Acc: 0.307
Validation loss decreased (-0.203686 --> -0.307390).  Saving model ...
Epoch: 3 cost time: 0.5507819652557373
Epoch: 3, Steps: 2 | Train Loss: 1.679 Vali Loss: 1.641 Vali Acc: 0.400 Test Loss: 1.641 Test Acc: 0.400
Validation loss decreased (-0.307390 --> -0.399984).  Saving model ...
Epoch: 4 cost time: 0.5350522994995117
Epoch: 4, Steps: 2 | Train Loss: 1.858 Vali Loss: 1.568 Vali Acc: 0.456 Test Loss: 1.568 Test Acc: 0.456
Validation loss decreased (-0.399984 --> -0.455540).  Saving model ...
Epoch: 5 cost time: 0.5252094268798828
Epoch: 5, Steps: 2 | Train Loss: 1.639 Vali Loss: 1.477 Vali Acc: 0.511 Test Loss: 1.477 Test Acc: 0.511
Validation loss decreased (-0.455540 --> -0.511096).  Saving model ...
Epoch: 6 cost time: 0.4861900806427002
Epoch: 6, Steps: 2 | Train Loss: 1.470 Vali Loss: 1.373 Vali Acc: 0.589 Test Loss: 1.373 Test Acc: 0.589
Validation loss decreased (-0.511096 --> -0.588875).  Saving model ...
Epoch: 7 cost time: 0.4270772933959961
Epoch: 7, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.264 Vali Acc: 0.644 Test Loss: 1.264 Test Acc: 0.644
Validation loss decreased (-0.588875 --> -0.644432).  Saving model ...
Epoch: 8 cost time: 0.4353806972503662
Epoch: 8, Steps: 2 | Train Loss: 1.194 Vali Loss: 1.154 Vali Acc: 0.700 Test Loss: 1.154 Test Acc: 0.700
Validation loss decreased (-0.644432 --> -0.699988).  Saving model ...
Epoch: 9 cost time: 0.4395434856414795
Epoch: 9, Steps: 2 | Train Loss: 1.107 Vali Loss: 1.045 Vali Acc: 0.752 Test Loss: 1.045 Test Acc: 0.752
Validation loss decreased (-0.699988 --> -0.751841).  Saving model ...
Epoch: 10 cost time: 0.5436992645263672
Epoch: 10, Steps: 2 | Train Loss: 1.012 Vali Loss: 0.942 Vali Acc: 0.796 Test Loss: 0.942 Test Acc: 0.796
Validation loss decreased (-0.751841 --> -0.796287).  Saving model ...
Epoch: 11 cost time: 0.5091233253479004
Epoch: 11, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.847 Vali Acc: 0.826 Test Loss: 0.847 Test Acc: 0.826
Validation loss decreased (-0.796287 --> -0.825917).  Saving model ...
Epoch: 12 cost time: 0.5063395500183105
Epoch: 12, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.763 Vali Acc: 0.837 Test Loss: 0.763 Test Acc: 0.837
Validation loss decreased (-0.825917 --> -0.837029).  Saving model ...
Epoch: 13 cost time: 0.5050215721130371
Epoch: 13, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.689 Vali Acc: 0.867 Test Loss: 0.689 Test Acc: 0.867
Validation loss decreased (-0.837029 --> -0.866660).  Saving model ...
Epoch: 14 cost time: 0.46570539474487305
Epoch: 14, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.624 Vali Acc: 0.881 Test Loss: 0.624 Test Acc: 0.881
Validation loss decreased (-0.866660 --> -0.881475).  Saving model ...
Epoch: 15 cost time: 0.5460445880889893
Epoch: 15, Steps: 2 | Train Loss: 0.450 Vali Loss: 0.565 Vali Acc: 0.874 Test Loss: 0.565 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 0.4862079620361328
Epoch: 16, Steps: 2 | Train Loss: 0.415 Vali Loss: 0.516 Vali Acc: 0.889 Test Loss: 0.516 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888884).  Saving model ...
Epoch: 17 cost time: 0.4761824607849121
Epoch: 17, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.473 Vali Acc: 0.900 Test Loss: 0.473 Test Acc: 0.900
Validation loss decreased (-0.888884 --> -0.899995).  Saving model ...
Epoch: 18 cost time: 0.5513014793395996
Epoch: 18, Steps: 2 | Train Loss: 0.293 Vali Loss: 0.434 Vali Acc: 0.900 Test Loss: 0.434 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 19 cost time: 0.4936525821685791
Epoch: 19, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.402 Vali Acc: 0.904 Test Loss: 0.402 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 20 cost time: 0.5258102416992188
Epoch: 20, Steps: 2 | Train Loss: 0.204 Vali Loss: 0.375 Vali Acc: 0.907 Test Loss: 0.375 Test Acc: 0.907
Validation loss decreased (-0.903700 --> -0.907404).  Saving model ...
Epoch: 21 cost time: 0.5620987415313721
Epoch: 21, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.352 Vali Acc: 0.911 Test Loss: 0.352 Test Acc: 0.911
Validation loss decreased (-0.907404 --> -0.911108).  Saving model ...
Epoch: 22 cost time: 0.5337858200073242
Epoch: 22, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.331 Vali Acc: 0.907 Test Loss: 0.331 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5468168258666992
Epoch: 23, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.313 Vali Acc: 0.919 Test Loss: 0.313 Test Acc: 0.919
Validation loss decreased (-0.911108 --> -0.918515).  Saving model ...
Epoch: 24 cost time: 0.5116283893585205
Epoch: 24, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.298 Vali Acc: 0.922 Test Loss: 0.298 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 25 cost time: 0.48483896255493164
Epoch: 25, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.285 Vali Acc: 0.930 Test Loss: 0.285 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 26 cost time: 0.46924567222595215
Epoch: 26, Steps: 2 | Train Loss: 0.082 Vali Loss: 0.274 Vali Acc: 0.930 Test Loss: 0.274 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 27 cost time: 0.5513937473297119
Epoch: 27, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.265 Vali Acc: 0.930 Test Loss: 0.265 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 28 cost time: 0.5604190826416016
Epoch: 28, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.259 Vali Acc: 0.926 Test Loss: 0.259 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4573173522949219
Epoch: 29, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 30 cost time: 0.5129785537719727
Epoch: 30, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.249 Vali Acc: 0.933 Test Loss: 0.249 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 31 cost time: 0.48941588401794434
Epoch: 31, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 32 cost time: 0.45359110832214355
Epoch: 32, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.243 Vali Acc: 0.930 Test Loss: 0.243 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.47817397117614746
Epoch: 33, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5999131202697754
Epoch: 34, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.4978773593902588
Epoch: 35, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.517927885055542
Epoch: 36, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5251350402832031
Epoch: 37, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.234 Vali Acc: 0.922 Test Loss: 0.234 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.516571044921875
Epoch: 38, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.232 Vali Acc: 0.922 Test Loss: 0.232 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5332233905792236
Epoch: 39, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.6043365001678467
Epoch: 40, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5228307247161865
Epoch: 41, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 43430
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1061644554138184
Epoch: 1, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.787 Vali Acc: 0.204 Test Loss: 1.787 Test Acc: 0.204
Validation loss decreased (inf --> -0.203686).  Saving model ...
Epoch: 2 cost time: 0.5447826385498047
Epoch: 2, Steps: 2 | Train Loss: 1.756 Vali Loss: 1.708 Vali Acc: 0.337 Test Loss: 1.708 Test Acc: 0.337
Validation loss decreased (-0.203686 --> -0.337020).  Saving model ...
Epoch: 3 cost time: 0.4652574062347412
Epoch: 3, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.643 Vali Acc: 0.437 Test Loss: 1.643 Test Acc: 0.437
Validation loss decreased (-0.337020 --> -0.437021).  Saving model ...
Epoch: 4 cost time: 0.4481017589569092
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.573 Vali Acc: 0.489 Test Loss: 1.573 Test Acc: 0.489
Validation loss decreased (-0.437021 --> -0.488873).  Saving model ...
Epoch: 5 cost time: 0.43312501907348633
Epoch: 5, Steps: 2 | Train Loss: 1.608 Vali Loss: 1.488 Vali Acc: 0.556 Test Loss: 1.488 Test Acc: 0.556
Validation loss decreased (-0.488873 --> -0.555541).  Saving model ...
Epoch: 6 cost time: 0.4987053871154785
Epoch: 6, Steps: 2 | Train Loss: 1.471 Vali Loss: 1.390 Vali Acc: 0.633 Test Loss: 1.390 Test Acc: 0.633
Validation loss decreased (-0.555541 --> -0.633319).  Saving model ...
Epoch: 7 cost time: 0.4484560489654541
Epoch: 7, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.288 Vali Acc: 0.711 Test Loss: 1.288 Test Acc: 0.711
Validation loss decreased (-0.633319 --> -0.711098).  Saving model ...
Epoch: 8 cost time: 0.4297752380371094
Epoch: 8, Steps: 2 | Train Loss: 1.208 Vali Loss: 1.183 Vali Acc: 0.785 Test Loss: 1.183 Test Acc: 0.785
Validation loss decreased (-0.711098 --> -0.785173).  Saving model ...
Epoch: 9 cost time: 0.4063093662261963
Epoch: 9, Steps: 2 | Train Loss: 1.116 Vali Loss: 1.081 Vali Acc: 0.800 Test Loss: 1.081 Test Acc: 0.800
Validation loss decreased (-0.785173 --> -0.799989).  Saving model ...
Epoch: 10 cost time: 0.41858983039855957
Epoch: 10, Steps: 2 | Train Loss: 1.006 Vali Loss: 0.984 Vali Acc: 0.822 Test Loss: 0.984 Test Acc: 0.822
Validation loss decreased (-0.799989 --> -0.822212).  Saving model ...
Epoch: 11 cost time: 0.3952205181121826
Epoch: 11, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.895 Vali Acc: 0.819 Test Loss: 0.895 Test Acc: 0.819
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 0.4435079097747803
Epoch: 12, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.816 Vali Acc: 0.826 Test Loss: 0.816 Test Acc: 0.826
Validation loss decreased (-0.822212 --> -0.825918).  Saving model ...
Epoch: 13 cost time: 0.5120446681976318
Epoch: 13, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.746 Vali Acc: 0.844 Test Loss: 0.746 Test Acc: 0.844
Validation loss decreased (-0.825918 --> -0.844437).  Saving model ...
Epoch: 14 cost time: 0.49199485778808594
Epoch: 14, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.684 Vali Acc: 0.852 Test Loss: 0.684 Test Acc: 0.852
Validation loss decreased (-0.844437 --> -0.851845).  Saving model ...
Epoch: 15 cost time: 0.5757083892822266
Epoch: 15, Steps: 2 | Train Loss: 0.537 Vali Loss: 0.629 Vali Acc: 0.856 Test Loss: 0.629 Test Acc: 0.856
Validation loss decreased (-0.851845 --> -0.855549).  Saving model ...
Epoch: 16 cost time: 0.6104705333709717
Epoch: 16, Steps: 2 | Train Loss: 0.483 Vali Loss: 0.582 Vali Acc: 0.856 Test Loss: 0.582 Test Acc: 0.856
Validation loss decreased (-0.855549 --> -0.855550).  Saving model ...
Epoch: 17 cost time: 0.5708134174346924
Epoch: 17, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.542 Vali Acc: 0.859 Test Loss: 0.542 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 18 cost time: 0.5821049213409424
Epoch: 18, Steps: 2 | Train Loss: 0.373 Vali Loss: 0.506 Vali Acc: 0.874 Test Loss: 0.506 Test Acc: 0.874
Validation loss decreased (-0.859254 --> -0.874069).  Saving model ...
Epoch: 19 cost time: 0.6119158267974854
Epoch: 19, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.476 Vali Acc: 0.885 Test Loss: 0.476 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885180).  Saving model ...
Epoch: 20 cost time: 0.5891101360321045
Epoch: 20, Steps: 2 | Train Loss: 0.285 Vali Loss: 0.450 Vali Acc: 0.889 Test Loss: 0.450 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 21 cost time: 0.594649076461792
Epoch: 21, Steps: 2 | Train Loss: 0.280 Vali Loss: 0.429 Vali Acc: 0.893 Test Loss: 0.429 Test Acc: 0.893
Validation loss decreased (-0.888884 --> -0.892588).  Saving model ...
Epoch: 22 cost time: 0.5546133518218994
Epoch: 22, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.410 Vali Acc: 0.881 Test Loss: 0.410 Test Acc: 0.881
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.5248973369598389
Epoch: 23, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.393 Vali Acc: 0.885 Test Loss: 0.393 Test Acc: 0.885
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 0.549569845199585
Epoch: 24, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.377 Vali Acc: 0.904 Test Loss: 0.377 Test Acc: 0.904
Validation loss decreased (-0.892588 --> -0.903700).  Saving model ...
Epoch: 25 cost time: 0.5329811573028564
Epoch: 25, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.364 Vali Acc: 0.896 Test Loss: 0.364 Test Acc: 0.896
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.47853684425354004
Epoch: 26, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.353 Vali Acc: 0.893 Test Loss: 0.353 Test Acc: 0.893
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 0.4259054660797119
Epoch: 27, Steps: 2 | Train Loss: 0.159 Vali Loss: 0.343 Vali Acc: 0.893 Test Loss: 0.343 Test Acc: 0.893
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 0.44218969345092773
Epoch: 28, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.335 Vali Acc: 0.893 Test Loss: 0.335 Test Acc: 0.893
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 0.4911842346191406
Epoch: 29, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.329 Vali Acc: 0.889 Test Loss: 0.329 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 0.474013090133667
Epoch: 30, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.323 Vali Acc: 0.893 Test Loss: 0.323 Test Acc: 0.893
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 0.5470049381256104
Epoch: 31, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.320 Vali Acc: 0.889 Test Loss: 0.320 Test Acc: 0.889
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 0.5359373092651367
Epoch: 32, Steps: 2 | Train Loss: 0.119 Vali Loss: 0.316 Vali Acc: 0.885 Test Loss: 0.316 Test Acc: 0.885
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 0.5467417240142822
Epoch: 33, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.314 Vali Acc: 0.893 Test Loss: 0.314 Test Acc: 0.893
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 0.5334677696228027
Epoch: 34, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.311 Vali Acc: 0.893 Test Loss: 0.311 Test Acc: 0.893
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9037037037037037
model parameter : 43430
model size : 1.40MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1205124855041504
Epoch: 1, Steps: 2 | Train Loss: 1.958 Vali Loss: 1.892 Vali Acc: 0.219 Test Loss: 1.892 Test Acc: 0.219
Validation loss decreased (inf --> -0.218500).  Saving model ...
Epoch: 2 cost time: 0.4965205192565918
Epoch: 2, Steps: 2 | Train Loss: 1.837 Vali Loss: 1.834 Vali Acc: 0.244 Test Loss: 1.834 Test Acc: 0.244
Validation loss decreased (-0.218500 --> -0.244426).  Saving model ...
Epoch: 3 cost time: 0.5115721225738525
Epoch: 3, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.788 Vali Acc: 0.270 Test Loss: 1.788 Test Acc: 0.270
Validation loss decreased (-0.244426 --> -0.270352).  Saving model ...
Epoch: 4 cost time: 0.5334174633026123
Epoch: 4, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.746 Vali Acc: 0.315 Test Loss: 1.746 Test Acc: 0.315
Validation loss decreased (-0.270352 --> -0.314797).  Saving model ...
Epoch: 5 cost time: 0.5093855857849121
Epoch: 5, Steps: 2 | Train Loss: 1.757 Vali Loss: 1.692 Vali Acc: 0.341 Test Loss: 1.692 Test Acc: 0.341
Validation loss decreased (-0.314797 --> -0.340724).  Saving model ...
Epoch: 6 cost time: 0.49414873123168945
Epoch: 6, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.628 Vali Acc: 0.385 Test Loss: 1.628 Test Acc: 0.385
Validation loss decreased (-0.340724 --> -0.385169).  Saving model ...
Epoch: 7 cost time: 0.5399436950683594
Epoch: 7, Steps: 2 | Train Loss: 1.594 Vali Loss: 1.559 Vali Acc: 0.433 Test Loss: 1.559 Test Acc: 0.433
Validation loss decreased (-0.385169 --> -0.433318).  Saving model ...
Epoch: 8 cost time: 0.5724227428436279
Epoch: 8, Steps: 2 | Train Loss: 1.455 Vali Loss: 1.485 Vali Acc: 0.474 Test Loss: 1.485 Test Acc: 0.474
Validation loss decreased (-0.433318 --> -0.474059).  Saving model ...
Epoch: 9 cost time: 0.5341293811798096
Epoch: 9, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.408 Vali Acc: 0.548 Test Loss: 1.408 Test Acc: 0.548
Validation loss decreased (-0.474059 --> -0.548134).  Saving model ...
Epoch: 10 cost time: 0.5469591617584229
Epoch: 10, Steps: 2 | Train Loss: 1.255 Vali Loss: 1.328 Vali Acc: 0.600 Test Loss: 1.328 Test Acc: 0.600
Validation loss decreased (-0.548134 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.46488046646118164
Epoch: 11, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.249 Vali Acc: 0.674 Test Loss: 1.249 Test Acc: 0.674
Validation loss decreased (-0.599987 --> -0.674062).  Saving model ...
Epoch: 12 cost time: 0.39220309257507324
Epoch: 12, Steps: 2 | Train Loss: 1.103 Vali Loss: 1.171 Vali Acc: 0.711 Test Loss: 1.171 Test Acc: 0.711
Validation loss decreased (-0.674062 --> -0.711099).  Saving model ...
Epoch: 13 cost time: 0.4769446849822998
Epoch: 13, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.095 Vali Acc: 0.744 Test Loss: 1.095 Test Acc: 0.744
Validation loss decreased (-0.711099 --> -0.744433).  Saving model ...
Epoch: 14 cost time: 0.4433097839355469
Epoch: 14, Steps: 2 | Train Loss: 0.926 Vali Loss: 1.022 Vali Acc: 0.752 Test Loss: 1.022 Test Acc: 0.752
Validation loss decreased (-0.744433 --> -0.751842).  Saving model ...
Epoch: 15 cost time: 0.45276713371276855
Epoch: 15, Steps: 2 | Train Loss: 0.824 Vali Loss: 0.951 Vali Acc: 0.774 Test Loss: 0.951 Test Acc: 0.774
Validation loss decreased (-0.751842 --> -0.774065).  Saving model ...
Epoch: 16 cost time: 0.586383581161499
Epoch: 16, Steps: 2 | Train Loss: 0.822 Vali Loss: 0.885 Vali Acc: 0.811 Test Loss: 0.885 Test Acc: 0.811
Validation loss decreased (-0.774065 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 0.4928467273712158
Epoch: 17, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.821 Vali Acc: 0.826 Test Loss: 0.821 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825918).  Saving model ...
Epoch: 18 cost time: 0.535923957824707
Epoch: 18, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.762 Vali Acc: 0.833 Test Loss: 0.762 Test Acc: 0.833
Validation loss decreased (-0.825918 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 0.4939849376678467
Epoch: 19, Steps: 2 | Train Loss: 0.601 Vali Loss: 0.707 Vali Acc: 0.848 Test Loss: 0.707 Test Acc: 0.848
Validation loss decreased (-0.833326 --> -0.848141).  Saving model ...
Epoch: 20 cost time: 0.5169343948364258
Epoch: 20, Steps: 2 | Train Loss: 0.488 Vali Loss: 0.656 Vali Acc: 0.863 Test Loss: 0.656 Test Acc: 0.863
Validation loss decreased (-0.848141 --> -0.862956).  Saving model ...
Epoch: 21 cost time: 0.5087082386016846
Epoch: 21, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.609 Vali Acc: 0.859 Test Loss: 0.609 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5139281749725342
Epoch: 22, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.567 Vali Acc: 0.870 Test Loss: 0.567 Test Acc: 0.870
Validation loss decreased (-0.862956 --> -0.870365).  Saving model ...
Epoch: 23 cost time: 0.4827852249145508
Epoch: 23, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.529 Vali Acc: 0.874 Test Loss: 0.529 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 24 cost time: 0.5391016006469727
Epoch: 24, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.495 Vali Acc: 0.885 Test Loss: 0.495 Test Acc: 0.885
Validation loss decreased (-0.874069 --> -0.885180).  Saving model ...
Epoch: 25 cost time: 0.5333051681518555
Epoch: 25, Steps: 2 | Train Loss: 0.283 Vali Loss: 0.465 Vali Acc: 0.893 Test Loss: 0.465 Test Acc: 0.893
Validation loss decreased (-0.885180 --> -0.892588).  Saving model ...
Epoch: 26 cost time: 0.47977256774902344
Epoch: 26, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.437 Vali Acc: 0.896 Test Loss: 0.437 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 27 cost time: 0.5497643947601318
Epoch: 27, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.413 Vali Acc: 0.900 Test Loss: 0.413 Test Acc: 0.900
Validation loss decreased (-0.896292 --> -0.899996).  Saving model ...
Epoch: 28 cost time: 0.5617742538452148
Epoch: 28, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.390 Vali Acc: 0.904 Test Loss: 0.390 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903700).  Saving model ...
Epoch: 29 cost time: 0.5235192775726318
Epoch: 29, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.371 Vali Acc: 0.911 Test Loss: 0.371 Test Acc: 0.911
Validation loss decreased (-0.903700 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.5314648151397705
Epoch: 30, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.355 Vali Acc: 0.911 Test Loss: 0.355 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 31 cost time: 0.5667159557342529
Epoch: 31, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.339 Vali Acc: 0.915 Test Loss: 0.339 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.5565555095672607
Epoch: 32, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 33 cost time: 0.5204248428344727
Epoch: 33, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 0.5460712909698486
Epoch: 34, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.5327048301696777
Epoch: 35, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.294 Vali Acc: 0.922 Test Loss: 0.294 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.497448205947876
Epoch: 36, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.286 Vali Acc: 0.922 Test Loss: 0.286 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 37 cost time: 0.4731762409210205
Epoch: 37, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.4404306411743164
Epoch: 38, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.273 Vali Acc: 0.926 Test Loss: 0.273 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 39 cost time: 0.4594109058380127
Epoch: 39, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.44384765625
Epoch: 40, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 0.42885279655456543
Epoch: 41, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.257 Vali Acc: 0.926 Test Loss: 0.257 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.45458221435546875
Epoch: 42, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.41695404052734375
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.43582749366760254
Epoch: 44, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.36983704566955566
Epoch: 45, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 46 cost time: 0.4523787498474121
Epoch: 46, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.239 Vali Acc: 0.926 Test Loss: 0.239 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 47 cost time: 0.4692809581756592
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.236 Vali Acc: 0.926 Test Loss: 0.236 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 48 cost time: 0.490922212600708
Epoch: 48, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 49 cost time: 0.5018672943115234
Epoch: 49, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 50 cost time: 0.48161935806274414
Epoch: 50, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 51 cost time: 0.49106335639953613
Epoch: 51, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 52 cost time: 0.47599363327026367
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 53 cost time: 0.473355770111084
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 54 cost time: 0.4534566402435303
Epoch: 54, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 55 cost time: 0.5097122192382812
Epoch: 55, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 56 cost time: 0.48040056228637695
Epoch: 56, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 57 cost time: 0.49910593032836914
Epoch: 57, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 58 cost time: 0.4724612236022949
Epoch: 58, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 59 cost time: 0.4498317241668701
Epoch: 59, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.49579358100891113
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.48420190811157227
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.5265369415283203
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.5256526470184326
Epoch: 63, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.4374370574951172
Epoch: 64, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.408785343170166
Epoch: 65, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.46609973907470703
Epoch: 66, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.930 Test Loss: 0.206 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 67 cost time: 0.38852381706237793
Epoch: 67, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.205 Vali Acc: 0.930 Test Loss: 0.205 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 68 cost time: 0.43359827995300293
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.204 Vali Acc: 0.930 Test Loss: 0.204 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 69 cost time: 0.4728984832763672
Epoch: 69, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.930 Test Loss: 0.203 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 70 cost time: 0.4497032165527344
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.4356687068939209
Epoch: 71, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.48568129539489746
Epoch: 72, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.4782707691192627
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.5661208629608154
Epoch: 74, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.49575281143188477
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.4989631175994873
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.199 Vali Acc: 0.933 Test Loss: 0.199 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.4758927822113037
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.49750423431396484
Epoch: 78, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.5172338485717773
Epoch: 79, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 0.537280797958374
Epoch: 80, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 81 cost time: 0.527064323425293
Epoch: 81, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.937 Test Loss: 0.196 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 82 cost time: 0.5129129886627197
Epoch: 82, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 83 cost time: 0.5041747093200684
Epoch: 83, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 84 cost time: 0.5090582370758057
Epoch: 84, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.937 Test Loss: 0.195 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 85 cost time: 0.5530798435211182
Epoch: 85, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 86 cost time: 0.513608455657959
Epoch: 86, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 87 cost time: 0.4489731788635254
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 88 cost time: 0.4703059196472168
Epoch: 88, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 89 cost time: 0.4856836795806885
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 90 cost time: 0.5767669677734375
Epoch: 90, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 91 cost time: 0.4294428825378418
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 92 cost time: 0.4871034622192383
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 93 cost time: 0.46410036087036133
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.4891469478607178
Epoch: 94, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.5106322765350342
Epoch: 95, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.4869880676269531
Epoch: 96, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.509972333908081
Epoch: 97, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.5453619956970215
Epoch: 98, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.189 Vali Acc: 0.937 Test Loss: 0.189 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.5792920589447021
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.189 Vali Acc: 0.933 Test Loss: 0.189 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.5617203712463379
Epoch: 100, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.933 Test Loss: 0.188 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 146662
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1883068084716797
Epoch: 1, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.892 Vali Acc: 0.215 Test Loss: 1.892 Test Acc: 0.215
Validation loss decreased (inf --> -0.214796).  Saving model ...
Epoch: 2 cost time: 0.5592978000640869
Epoch: 2, Steps: 2 | Train Loss: 1.847 Vali Loss: 1.833 Vali Acc: 0.248 Test Loss: 1.833 Test Acc: 0.248
Validation loss decreased (-0.214796 --> -0.248130).  Saving model ...
Epoch: 3 cost time: 0.5807235240936279
Epoch: 3, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.787 Vali Acc: 0.267 Test Loss: 1.787 Test Acc: 0.267
Validation loss decreased (-0.248130 --> -0.266649).  Saving model ...
Epoch: 4 cost time: 0.5299587249755859
Epoch: 4, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.745 Vali Acc: 0.296 Test Loss: 1.745 Test Acc: 0.296
Validation loss decreased (-0.266649 --> -0.296279).  Saving model ...
Epoch: 5 cost time: 0.4633610248565674
Epoch: 5, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.692 Vali Acc: 0.330 Test Loss: 1.692 Test Acc: 0.330
Validation loss decreased (-0.296279 --> -0.329613).  Saving model ...
Epoch: 6 cost time: 0.46365857124328613
Epoch: 6, Steps: 2 | Train Loss: 1.650 Vali Loss: 1.628 Vali Acc: 0.381 Test Loss: 1.628 Test Acc: 0.381
Validation loss decreased (-0.329613 --> -0.381465).  Saving model ...
Epoch: 7 cost time: 0.4990372657775879
Epoch: 7, Steps: 2 | Train Loss: 1.598 Vali Loss: 1.559 Vali Acc: 0.415 Test Loss: 1.559 Test Acc: 0.415
Validation loss decreased (-0.381465 --> -0.414799).  Saving model ...
Epoch: 8 cost time: 0.5037875175476074
Epoch: 8, Steps: 2 | Train Loss: 1.485 Vali Loss: 1.485 Vali Acc: 0.478 Test Loss: 1.485 Test Acc: 0.478
Validation loss decreased (-0.414799 --> -0.477763).  Saving model ...
Epoch: 9 cost time: 0.49715423583984375
Epoch: 9, Steps: 2 | Train Loss: 1.482 Vali Loss: 1.408 Vali Acc: 0.530 Test Loss: 1.408 Test Acc: 0.530
Validation loss decreased (-0.477763 --> -0.529616).  Saving model ...
Epoch: 10 cost time: 0.5418717861175537
Epoch: 10, Steps: 2 | Train Loss: 1.254 Vali Loss: 1.329 Vali Acc: 0.626 Test Loss: 1.329 Test Acc: 0.626
Validation loss decreased (-0.529616 --> -0.625913).  Saving model ...
Epoch: 11 cost time: 0.5378611087799072
Epoch: 11, Steps: 2 | Train Loss: 1.206 Vali Loss: 1.250 Vali Acc: 0.670 Test Loss: 1.250 Test Acc: 0.670
Validation loss decreased (-0.625913 --> -0.670358).  Saving model ...
Epoch: 12 cost time: 0.47315239906311035
Epoch: 12, Steps: 2 | Train Loss: 1.140 Vali Loss: 1.172 Vali Acc: 0.707 Test Loss: 1.172 Test Acc: 0.707
Validation loss decreased (-0.670358 --> -0.707396).  Saving model ...
Epoch: 13 cost time: 0.565091609954834
Epoch: 13, Steps: 2 | Train Loss: 1.084 Vali Loss: 1.097 Vali Acc: 0.737 Test Loss: 1.097 Test Acc: 0.737
Validation loss decreased (-0.707396 --> -0.737026).  Saving model ...
Epoch: 14 cost time: 0.5433177947998047
Epoch: 14, Steps: 2 | Train Loss: 0.963 Vali Loss: 1.024 Vali Acc: 0.756 Test Loss: 1.024 Test Acc: 0.756
Validation loss decreased (-0.737026 --> -0.755545).  Saving model ...
Epoch: 15 cost time: 0.5533261299133301
Epoch: 15, Steps: 2 | Train Loss: 0.836 Vali Loss: 0.954 Vali Acc: 0.778 Test Loss: 0.954 Test Acc: 0.778
Validation loss decreased (-0.755545 --> -0.777768).  Saving model ...
Epoch: 16 cost time: 0.5147044658660889
Epoch: 16, Steps: 2 | Train Loss: 0.819 Vali Loss: 0.887 Vali Acc: 0.796 Test Loss: 0.887 Test Acc: 0.796
Validation loss decreased (-0.777768 --> -0.796287).  Saving model ...
Epoch: 17 cost time: 0.5353968143463135
Epoch: 17, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.824 Vali Acc: 0.815 Test Loss: 0.824 Test Acc: 0.815
Validation loss decreased (-0.796287 --> -0.814807).  Saving model ...
Epoch: 18 cost time: 0.5139186382293701
Epoch: 18, Steps: 2 | Train Loss: 0.717 Vali Loss: 0.765 Vali Acc: 0.833 Test Loss: 0.765 Test Acc: 0.833
Validation loss decreased (-0.814807 --> -0.833326).  Saving model ...
Epoch: 19 cost time: 0.5552914142608643
Epoch: 19, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.710 Vali Acc: 0.856 Test Loss: 0.710 Test Acc: 0.856
Validation loss decreased (-0.833326 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 0.5418245792388916
Epoch: 20, Steps: 2 | Train Loss: 0.490 Vali Loss: 0.659 Vali Acc: 0.878 Test Loss: 0.659 Test Acc: 0.878
Validation loss decreased (-0.855548 --> -0.877771).  Saving model ...
Epoch: 21 cost time: 0.608640193939209
Epoch: 21, Steps: 2 | Train Loss: 0.465 Vali Loss: 0.612 Vali Acc: 0.881 Test Loss: 0.612 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 22 cost time: 0.6052191257476807
Epoch: 22, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.570 Vali Acc: 0.885 Test Loss: 0.570 Test Acc: 0.885
Validation loss decreased (-0.881475 --> -0.885179).  Saving model ...
Epoch: 23 cost time: 0.5541989803314209
Epoch: 23, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.531 Vali Acc: 0.885 Test Loss: 0.531 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885180).  Saving model ...
Epoch: 24 cost time: 0.5277056694030762
Epoch: 24, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.497 Vali Acc: 0.889 Test Loss: 0.497 Test Acc: 0.889
Validation loss decreased (-0.885180 --> -0.888884).  Saving model ...
Epoch: 25 cost time: 0.5548620223999023
Epoch: 25, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.466 Vali Acc: 0.904 Test Loss: 0.466 Test Acc: 0.904
Validation loss decreased (-0.888884 --> -0.903699).  Saving model ...
Epoch: 26 cost time: 0.656301736831665
Epoch: 26, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.438 Vali Acc: 0.904 Test Loss: 0.438 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 27 cost time: 0.5623793601989746
Epoch: 27, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.413 Vali Acc: 0.915 Test Loss: 0.413 Test Acc: 0.915
Validation loss decreased (-0.903699 --> -0.914811).  Saving model ...
Epoch: 28 cost time: 0.5044574737548828
Epoch: 28, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.391 Vali Acc: 0.915 Test Loss: 0.391 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.510859489440918
Epoch: 29, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.372 Vali Acc: 0.915 Test Loss: 0.372 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.5289185047149658
Epoch: 30, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.355 Vali Acc: 0.915 Test Loss: 0.355 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.5076055526733398
Epoch: 31, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.340 Vali Acc: 0.915 Test Loss: 0.340 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.50844407081604
Epoch: 32, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.326 Vali Acc: 0.922 Test Loss: 0.326 Test Acc: 0.922
Validation loss decreased (-0.914811 --> -0.922219).  Saving model ...
Epoch: 33 cost time: 0.5028893947601318
Epoch: 33, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.314 Vali Acc: 0.922 Test Loss: 0.314 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 34 cost time: 0.5181901454925537
Epoch: 34, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.304 Vali Acc: 0.922 Test Loss: 0.304 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 35 cost time: 0.48044872283935547
Epoch: 35, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.5510106086730957
Epoch: 36, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 0.5348012447357178
Epoch: 37, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.280 Vali Acc: 0.922 Test Loss: 0.280 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 38 cost time: 0.551116943359375
Epoch: 38, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 39 cost time: 0.6315181255340576
Epoch: 39, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.267 Vali Acc: 0.922 Test Loss: 0.267 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 40 cost time: 0.608076810836792
Epoch: 40, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.262 Vali Acc: 0.922 Test Loss: 0.262 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 41 cost time: 0.579195499420166
Epoch: 41, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.257 Vali Acc: 0.922 Test Loss: 0.257 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 42 cost time: 0.559819221496582
Epoch: 42, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.253 Vali Acc: 0.926 Test Loss: 0.253 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.5273947715759277
Epoch: 43, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.249 Vali Acc: 0.926 Test Loss: 0.249 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.504652738571167
Epoch: 44, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.245 Vali Acc: 0.926 Test Loss: 0.245 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.5397248268127441
Epoch: 45, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.242 Vali Acc: 0.926 Test Loss: 0.242 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925924).  Saving model ...
Epoch: 46 cost time: 0.5528256893157959
Epoch: 46, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 47 cost time: 0.5404458045959473
Epoch: 47, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 48 cost time: 0.6350817680358887
Epoch: 48, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.233 Vali Acc: 0.926 Test Loss: 0.233 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 49 cost time: 0.57275390625
Epoch: 49, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 50 cost time: 0.5677931308746338
Epoch: 50, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.228 Vali Acc: 0.926 Test Loss: 0.228 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 51 cost time: 0.5014657974243164
Epoch: 51, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.226 Vali Acc: 0.926 Test Loss: 0.226 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 52 cost time: 0.49134349822998047
Epoch: 52, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.224 Vali Acc: 0.926 Test Loss: 0.224 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 53 cost time: 0.5380656719207764
Epoch: 53, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.222 Vali Acc: 0.926 Test Loss: 0.222 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 54 cost time: 0.5032675266265869
Epoch: 54, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929627).  Saving model ...
Epoch: 55 cost time: 0.5006895065307617
Epoch: 55, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 56 cost time: 0.4868807792663574
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5402123928070068
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.6010124683380127
Epoch: 58, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.5870177745819092
Epoch: 59, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.215 Vali Acc: 0.926 Test Loss: 0.215 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.6097519397735596
Epoch: 60, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.213 Vali Acc: 0.926 Test Loss: 0.213 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.583066463470459
Epoch: 61, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.212 Vali Acc: 0.926 Test Loss: 0.212 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.5503909587860107
Epoch: 62, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.926 Test Loss: 0.211 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.5811061859130859
Epoch: 63, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929628).  Saving model ...
Epoch: 64 cost time: 0.5667004585266113
Epoch: 64, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.929628 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.5286269187927246
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.5579466819763184
Epoch: 66, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.206 Vali Acc: 0.933 Test Loss: 0.206 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 0.5749552249908447
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 0.5418848991394043
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 69 cost time: 0.5985293388366699
Epoch: 69, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.203 Vali Acc: 0.933 Test Loss: 0.203 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.5679326057434082
Epoch: 70, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.5995299816131592
Epoch: 71, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.202 Vali Acc: 0.933 Test Loss: 0.202 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.5689411163330078
Epoch: 72, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.933 Test Loss: 0.201 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.5028526782989502
Epoch: 73, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.5874009132385254
Epoch: 74, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.933 Test Loss: 0.200 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.5027456283569336
Epoch: 75, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.930 Test Loss: 0.199 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 76 cost time: 0.5714232921600342
Epoch: 76, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 77 cost time: 0.5148184299468994
Epoch: 77, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.198 Vali Acc: 0.933 Test Loss: 0.198 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 78 cost time: 0.5350301265716553
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 79 cost time: 0.5031356811523438
Epoch: 79, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.197 Vali Acc: 0.933 Test Loss: 0.197 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 80 cost time: 0.502396821975708
Epoch: 80, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 81 cost time: 0.4791676998138428
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 82 cost time: 0.5107431411743164
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.933 Test Loss: 0.196 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 83 cost time: 0.5084328651428223
Epoch: 83, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 84 cost time: 0.515641450881958
Epoch: 84, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.933 Test Loss: 0.195 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 85 cost time: 0.5725836753845215
Epoch: 85, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 86 cost time: 0.5603141784667969
Epoch: 86, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 87 cost time: 0.5660209655761719
Epoch: 87, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.933 Test Loss: 0.194 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 88 cost time: 0.5340578556060791
Epoch: 88, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 89 cost time: 0.57411789894104
Epoch: 89, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.193 Vali Acc: 0.933 Test Loss: 0.193 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 90 cost time: 0.5733740329742432
Epoch: 90, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 91 cost time: 0.5917816162109375
Epoch: 91, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 92 cost time: 0.5565319061279297
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 93 cost time: 0.6351273059844971
Epoch: 93, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 94 cost time: 0.5812885761260986
Epoch: 94, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.933 Test Loss: 0.192 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 95 cost time: 0.5559720993041992
Epoch: 95, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 96 cost time: 0.5499274730682373
Epoch: 96, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 97 cost time: 0.5222570896148682
Epoch: 97, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 98 cost time: 0.5343570709228516
Epoch: 98, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.190 Vali Acc: 0.937 Test Loss: 0.190 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 99 cost time: 0.5187079906463623
Epoch: 99, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 100 cost time: 0.5262625217437744
Epoch: 100, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.190 Vali Acc: 0.933 Test Loss: 0.190 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 146662
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.077303647994995
Epoch: 1, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.892 Vali Acc: 0.211 Test Loss: 1.892 Test Acc: 0.211
Validation loss decreased (inf --> -0.211092).  Saving model ...
Epoch: 2 cost time: 0.46509385108947754
Epoch: 2, Steps: 2 | Train Loss: 1.834 Vali Loss: 1.835 Vali Acc: 0.252 Test Loss: 1.835 Test Acc: 0.252
Validation loss decreased (-0.211092 --> -0.251834).  Saving model ...
Epoch: 3 cost time: 0.5333738327026367
Epoch: 3, Steps: 2 | Train Loss: 1.785 Vali Loss: 1.790 Vali Acc: 0.285 Test Loss: 1.790 Test Acc: 0.285
Validation loss decreased (-0.251834 --> -0.285167).  Saving model ...
Epoch: 4 cost time: 0.5687296390533447
Epoch: 4, Steps: 2 | Train Loss: 1.830 Vali Loss: 1.750 Vali Acc: 0.311 Test Loss: 1.750 Test Acc: 0.311
Validation loss decreased (-0.285167 --> -0.311094).  Saving model ...
Epoch: 5 cost time: 0.5215673446655273
Epoch: 5, Steps: 2 | Train Loss: 1.760 Vali Loss: 1.698 Vali Acc: 0.337 Test Loss: 1.698 Test Acc: 0.337
Validation loss decreased (-0.311094 --> -0.337020).  Saving model ...
Epoch: 6 cost time: 0.5473942756652832
Epoch: 6, Steps: 2 | Train Loss: 1.664 Vali Loss: 1.636 Vali Acc: 0.378 Test Loss: 1.636 Test Acc: 0.378
Validation loss decreased (-0.337020 --> -0.377761).  Saving model ...
Epoch: 7 cost time: 0.5633349418640137
Epoch: 7, Steps: 2 | Train Loss: 1.637 Vali Loss: 1.569 Vali Acc: 0.411 Test Loss: 1.569 Test Acc: 0.411
Validation loss decreased (-0.377761 --> -0.411095).  Saving model ...
Epoch: 8 cost time: 0.5244450569152832
Epoch: 8, Steps: 2 | Train Loss: 1.548 Vali Loss: 1.497 Vali Acc: 0.478 Test Loss: 1.497 Test Acc: 0.478
Validation loss decreased (-0.411095 --> -0.477763).  Saving model ...
Epoch: 9 cost time: 0.5401561260223389
Epoch: 9, Steps: 2 | Train Loss: 1.499 Vali Loss: 1.422 Vali Acc: 0.544 Test Loss: 1.422 Test Acc: 0.544
Validation loss decreased (-0.477763 --> -0.544430).  Saving model ...
Epoch: 10 cost time: 0.5178635120391846
Epoch: 10, Steps: 2 | Train Loss: 1.260 Vali Loss: 1.345 Vali Acc: 0.615 Test Loss: 1.345 Test Acc: 0.615
Validation loss decreased (-0.544430 --> -0.614801).  Saving model ...
Epoch: 11 cost time: 0.5168342590332031
Epoch: 11, Steps: 2 | Train Loss: 1.243 Vali Loss: 1.268 Vali Acc: 0.667 Test Loss: 1.268 Test Acc: 0.667
Validation loss decreased (-0.614801 --> -0.666654).  Saving model ...
Epoch: 12 cost time: 0.5300478935241699
Epoch: 12, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.192 Vali Acc: 0.696 Test Loss: 1.192 Test Acc: 0.696
Validation loss decreased (-0.666654 --> -0.696284).  Saving model ...
Epoch: 13 cost time: 0.6099069118499756
Epoch: 13, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.118 Vali Acc: 0.719 Test Loss: 1.118 Test Acc: 0.719
Validation loss decreased (-0.696284 --> -0.718507).  Saving model ...
Epoch: 14 cost time: 0.5478174686431885
Epoch: 14, Steps: 2 | Train Loss: 1.019 Vali Loss: 1.047 Vali Acc: 0.730 Test Loss: 1.047 Test Acc: 0.730
Validation loss decreased (-0.718507 --> -0.729619).  Saving model ...
Epoch: 15 cost time: 0.5771377086639404
Epoch: 15, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.979 Vali Acc: 0.781 Test Loss: 0.979 Test Acc: 0.781
Validation loss decreased (-0.729619 --> -0.781472).  Saving model ...
Epoch: 16 cost time: 0.5793647766113281
Epoch: 16, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.914 Vali Acc: 0.800 Test Loss: 0.914 Test Acc: 0.800
Validation loss decreased (-0.781472 --> -0.799991).  Saving model ...
Epoch: 17 cost time: 0.542794942855835
Epoch: 17, Steps: 2 | Train Loss: 0.799 Vali Loss: 0.852 Vali Acc: 0.815 Test Loss: 0.852 Test Acc: 0.815
Validation loss decreased (-0.799991 --> -0.814806).  Saving model ...
Epoch: 18 cost time: 0.5050537586212158
Epoch: 18, Steps: 2 | Train Loss: 0.750 Vali Loss: 0.794 Vali Acc: 0.833 Test Loss: 0.794 Test Acc: 0.833
Validation loss decreased (-0.814806 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 0.5548274517059326
Epoch: 19, Steps: 2 | Train Loss: 0.666 Vali Loss: 0.739 Vali Acc: 0.852 Test Loss: 0.739 Test Acc: 0.852
Validation loss decreased (-0.833325 --> -0.851844).  Saving model ...
Epoch: 20 cost time: 0.5057032108306885
Epoch: 20, Steps: 2 | Train Loss: 0.531 Vali Loss: 0.689 Vali Acc: 0.867 Test Loss: 0.689 Test Acc: 0.867
Validation loss decreased (-0.851844 --> -0.866660).  Saving model ...
Epoch: 21 cost time: 0.4752352237701416
Epoch: 21, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.642 Vali Acc: 0.885 Test Loss: 0.642 Test Acc: 0.885
Validation loss decreased (-0.866660 --> -0.885179).  Saving model ...
Epoch: 22 cost time: 0.44800734519958496
Epoch: 22, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.600 Vali Acc: 0.885 Test Loss: 0.600 Test Acc: 0.885
Validation loss decreased (-0.885179 --> -0.885179).  Saving model ...
Epoch: 23 cost time: 0.5039553642272949
Epoch: 23, Steps: 2 | Train Loss: 0.426 Vali Loss: 0.561 Vali Acc: 0.893 Test Loss: 0.561 Test Acc: 0.893
Validation loss decreased (-0.885179 --> -0.892587).  Saving model ...
Epoch: 24 cost time: 0.5420072078704834
Epoch: 24, Steps: 2 | Train Loss: 0.389 Vali Loss: 0.527 Vali Acc: 0.900 Test Loss: 0.527 Test Acc: 0.900
Validation loss decreased (-0.892587 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.49086880683898926
Epoch: 25, Steps: 2 | Train Loss: 0.339 Vali Loss: 0.495 Vali Acc: 0.900 Test Loss: 0.495 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899995).  Saving model ...
Epoch: 26 cost time: 0.4647228717803955
Epoch: 26, Steps: 2 | Train Loss: 0.318 Vali Loss: 0.466 Vali Acc: 0.907 Test Loss: 0.466 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.4796576499938965
Epoch: 27, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.440 Vali Acc: 0.911 Test Loss: 0.440 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 28 cost time: 0.44230008125305176
Epoch: 28, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.418 Vali Acc: 0.911 Test Loss: 0.418 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 29 cost time: 0.4908597469329834
Epoch: 29, Steps: 2 | Train Loss: 0.238 Vali Loss: 0.398 Vali Acc: 0.911 Test Loss: 0.398 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.4772608280181885
Epoch: 30, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.5761725902557373
Epoch: 31, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.365 Vali Acc: 0.915 Test Loss: 0.365 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.5651936531066895
Epoch: 32, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.351 Vali Acc: 0.919 Test Loss: 0.351 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.554753303527832
Epoch: 33, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.338 Vali Acc: 0.919 Test Loss: 0.338 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.5713977813720703
Epoch: 34, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.328 Vali Acc: 0.919 Test Loss: 0.328 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.5438830852508545
Epoch: 35, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.319 Vali Acc: 0.922 Test Loss: 0.319 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.5432572364807129
Epoch: 36, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.310 Vali Acc: 0.926 Test Loss: 0.310 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 0.5292913913726807
Epoch: 37, Steps: 2 | Train Loss: 0.114 Vali Loss: 0.302 Vali Acc: 0.926 Test Loss: 0.302 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 38 cost time: 0.5667569637298584
Epoch: 38, Steps: 2 | Train Loss: 0.121 Vali Loss: 0.296 Vali Acc: 0.926 Test Loss: 0.296 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 39 cost time: 0.4755713939666748
Epoch: 39, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.289 Vali Acc: 0.926 Test Loss: 0.289 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 40 cost time: 0.5179104804992676
Epoch: 40, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.283 Vali Acc: 0.926 Test Loss: 0.283 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 41 cost time: 0.5406455993652344
Epoch: 41, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.278 Vali Acc: 0.926 Test Loss: 0.278 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.5332138538360596
Epoch: 42, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.274 Vali Acc: 0.926 Test Loss: 0.274 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.5335977077484131
Epoch: 43, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.270 Vali Acc: 0.930 Test Loss: 0.270 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.5538191795349121
Epoch: 44, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 45 cost time: 0.5018739700317383
Epoch: 45, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.262 Vali Acc: 0.930 Test Loss: 0.262 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.5232548713684082
Epoch: 46, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.544806957244873
Epoch: 47, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.255 Vali Acc: 0.926 Test Loss: 0.255 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 48 cost time: 0.4286825656890869
Epoch: 48, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.252 Vali Acc: 0.926 Test Loss: 0.252 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 49 cost time: 0.459979772567749
Epoch: 49, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 50 cost time: 0.5438048839569092
Epoch: 50, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.247 Vali Acc: 0.919 Test Loss: 0.247 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 51 cost time: 0.5609610080718994
Epoch: 51, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.245 Vali Acc: 0.922 Test Loss: 0.245 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 52 cost time: 0.5179297924041748
Epoch: 52, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.242 Vali Acc: 0.922 Test Loss: 0.242 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 53 cost time: 0.4973576068878174
Epoch: 53, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.240 Vali Acc: 0.926 Test Loss: 0.240 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 54 cost time: 0.49030232429504395
Epoch: 54, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.238 Vali Acc: 0.926 Test Loss: 0.238 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 55 cost time: 0.46738290786743164
Epoch: 55, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 56 cost time: 0.4621908664703369
Epoch: 56, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 57 cost time: 0.4908578395843506
Epoch: 57, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 58 cost time: 0.5050058364868164
Epoch: 58, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.232 Vali Acc: 0.926 Test Loss: 0.232 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 59 cost time: 0.5419764518737793
Epoch: 59, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.231 Vali Acc: 0.926 Test Loss: 0.231 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 60 cost time: 0.5210123062133789
Epoch: 60, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.229 Vali Acc: 0.926 Test Loss: 0.229 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 61 cost time: 0.5107178688049316
Epoch: 61, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 62 cost time: 0.5280628204345703
Epoch: 62, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 63 cost time: 0.4823482036590576
Epoch: 63, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 64 cost time: 0.5905468463897705
Epoch: 64, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 65 cost time: 0.47411203384399414
Epoch: 65, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 66 cost time: 0.6290774345397949
Epoch: 66, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 67 cost time: 0.5773890018463135
Epoch: 67, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 68 cost time: 0.5554437637329102
Epoch: 68, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 69 cost time: 0.5665867328643799
Epoch: 69, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.5593245029449463
Epoch: 70, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 71 cost time: 0.6168780326843262
Epoch: 71, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.220 Vali Acc: 0.930 Test Loss: 0.220 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 72 cost time: 0.5912899971008301
Epoch: 72, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.219 Vali Acc: 0.930 Test Loss: 0.219 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 73 cost time: 0.5442960262298584
Epoch: 73, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.218 Vali Acc: 0.930 Test Loss: 0.218 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 74 cost time: 0.5034620761871338
Epoch: 74, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.217 Vali Acc: 0.930 Test Loss: 0.217 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 75 cost time: 0.5013725757598877
Epoch: 75, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.217 Vali Acc: 0.926 Test Loss: 0.217 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 76 cost time: 0.4949948787689209
Epoch: 76, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 77 cost time: 0.4871556758880615
Epoch: 77, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.216 Vali Acc: 0.926 Test Loss: 0.216 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 78 cost time: 0.5102958679199219
Epoch: 78, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.216 Vali Acc: 0.930 Test Loss: 0.216 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 79 cost time: 0.5655004978179932
Epoch: 79, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.930 Test Loss: 0.215 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 146662
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1917834281921387
Epoch: 1, Steps: 2 | Train Loss: 1.974 Vali Loss: 1.845 Vali Acc: 0.215 Test Loss: 1.845 Test Acc: 0.215
Validation loss decreased (inf --> -0.214796).  Saving model ...
Epoch: 2 cost time: 0.5109717845916748
Epoch: 2, Steps: 2 | Train Loss: 1.779 Vali Loss: 1.792 Vali Acc: 0.278 Test Loss: 1.792 Test Acc: 0.278
Validation loss decreased (-0.214796 --> -0.277760).  Saving model ...
Epoch: 3 cost time: 0.593660831451416
Epoch: 3, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.751 Vali Acc: 0.304 Test Loss: 1.751 Test Acc: 0.304
Validation loss decreased (-0.277760 --> -0.303686).  Saving model ...
Epoch: 4 cost time: 0.5669116973876953
Epoch: 4, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.714 Vali Acc: 0.315 Test Loss: 1.714 Test Acc: 0.315
Validation loss decreased (-0.303686 --> -0.314798).  Saving model ...
Epoch: 5 cost time: 0.6217358112335205
Epoch: 5, Steps: 2 | Train Loss: 1.697 Vali Loss: 1.667 Vali Acc: 0.326 Test Loss: 1.667 Test Acc: 0.326
Validation loss decreased (-0.314798 --> -0.325909).  Saving model ...
Epoch: 6 cost time: 0.551649808883667
Epoch: 6, Steps: 2 | Train Loss: 1.619 Vali Loss: 1.611 Vali Acc: 0.359 Test Loss: 1.611 Test Acc: 0.359
Validation loss decreased (-0.325909 --> -0.359243).  Saving model ...
Epoch: 7 cost time: 0.5680370330810547
Epoch: 7, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.550 Vali Acc: 0.415 Test Loss: 1.550 Test Acc: 0.415
Validation loss decreased (-0.359243 --> -0.414799).  Saving model ...
Epoch: 8 cost time: 0.577742338180542
Epoch: 8, Steps: 2 | Train Loss: 1.518 Vali Loss: 1.485 Vali Acc: 0.467 Test Loss: 1.485 Test Acc: 0.467
Validation loss decreased (-0.414799 --> -0.466652).  Saving model ...
Epoch: 9 cost time: 0.6104366779327393
Epoch: 9, Steps: 2 | Train Loss: 1.473 Vali Loss: 1.417 Vali Acc: 0.537 Test Loss: 1.417 Test Acc: 0.537
Validation loss decreased (-0.466652 --> -0.537023).  Saving model ...
Epoch: 10 cost time: 0.5901792049407959
Epoch: 10, Steps: 2 | Train Loss: 1.290 Vali Loss: 1.347 Vali Acc: 0.600 Test Loss: 1.347 Test Acc: 0.600
Validation loss decreased (-0.537023 --> -0.599987).  Saving model ...
Epoch: 11 cost time: 0.5814778804779053
Epoch: 11, Steps: 2 | Train Loss: 1.253 Vali Loss: 1.277 Vali Acc: 0.637 Test Loss: 1.277 Test Acc: 0.637
Validation loss decreased (-0.599987 --> -0.637024).  Saving model ...
Epoch: 12 cost time: 0.6049540042877197
Epoch: 12, Steps: 2 | Train Loss: 1.196 Vali Loss: 1.209 Vali Acc: 0.667 Test Loss: 1.209 Test Acc: 0.667
Validation loss decreased (-0.637024 --> -0.666655).  Saving model ...
Epoch: 13 cost time: 0.5446810722351074
Epoch: 13, Steps: 2 | Train Loss: 1.163 Vali Loss: 1.143 Vali Acc: 0.685 Test Loss: 1.143 Test Acc: 0.685
Validation loss decreased (-0.666655 --> -0.685174).  Saving model ...
Epoch: 14 cost time: 0.5375089645385742
Epoch: 14, Steps: 2 | Train Loss: 1.040 Vali Loss: 1.080 Vali Acc: 0.719 Test Loss: 1.080 Test Acc: 0.719
Validation loss decreased (-0.685174 --> -0.718508).  Saving model ...
Epoch: 15 cost time: 0.549443244934082
Epoch: 15, Steps: 2 | Train Loss: 0.962 Vali Loss: 1.018 Vali Acc: 0.733 Test Loss: 1.018 Test Acc: 0.733
Validation loss decreased (-0.718508 --> -0.733323).  Saving model ...
Epoch: 16 cost time: 0.531264066696167
Epoch: 16, Steps: 2 | Train Loss: 0.905 Vali Loss: 0.961 Vali Acc: 0.763 Test Loss: 0.961 Test Acc: 0.763
Validation loss decreased (-0.733323 --> -0.762953).  Saving model ...
Epoch: 17 cost time: 0.5723567008972168
Epoch: 17, Steps: 2 | Train Loss: 0.873 Vali Loss: 0.906 Vali Acc: 0.774 Test Loss: 0.906 Test Acc: 0.774
Validation loss decreased (-0.762953 --> -0.774065).  Saving model ...
Epoch: 18 cost time: 0.5559375286102295
Epoch: 18, Steps: 2 | Train Loss: 0.807 Vali Loss: 0.854 Vali Acc: 0.804 Test Loss: 0.854 Test Acc: 0.804
Validation loss decreased (-0.774065 --> -0.803695).  Saving model ...
Epoch: 19 cost time: 0.512589693069458
Epoch: 19, Steps: 2 | Train Loss: 0.705 Vali Loss: 0.804 Vali Acc: 0.822 Test Loss: 0.804 Test Acc: 0.822
Validation loss decreased (-0.803695 --> -0.822214).  Saving model ...
Epoch: 20 cost time: 0.5238137245178223
Epoch: 20, Steps: 2 | Train Loss: 0.630 Vali Loss: 0.759 Vali Acc: 0.830 Test Loss: 0.759 Test Acc: 0.830
Validation loss decreased (-0.822214 --> -0.829622).  Saving model ...
Epoch: 21 cost time: 0.5396654605865479
Epoch: 21, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.717 Vali Acc: 0.856 Test Loss: 0.717 Test Acc: 0.856
Validation loss decreased (-0.829622 --> -0.855548).  Saving model ...
Epoch: 22 cost time: 0.5496430397033691
Epoch: 22, Steps: 2 | Train Loss: 0.594 Vali Loss: 0.679 Vali Acc: 0.870 Test Loss: 0.679 Test Acc: 0.870
Validation loss decreased (-0.855548 --> -0.870364).  Saving model ...
Epoch: 23 cost time: 0.46853113174438477
Epoch: 23, Steps: 2 | Train Loss: 0.525 Vali Loss: 0.643 Vali Acc: 0.878 Test Loss: 0.643 Test Acc: 0.878
Validation loss decreased (-0.870364 --> -0.877771).  Saving model ...
Epoch: 24 cost time: 0.5438535213470459
Epoch: 24, Steps: 2 | Train Loss: 0.464 Vali Loss: 0.611 Vali Acc: 0.881 Test Loss: 0.611 Test Acc: 0.881
Validation loss decreased (-0.877771 --> -0.881475).  Saving model ...
Epoch: 25 cost time: 0.5893309116363525
Epoch: 25, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.582 Vali Acc: 0.881 Test Loss: 0.582 Test Acc: 0.881
Validation loss decreased (-0.881475 --> -0.881476).  Saving model ...
Epoch: 26 cost time: 0.5315933227539062
Epoch: 26, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.555 Vali Acc: 0.885 Test Loss: 0.555 Test Acc: 0.885
Validation loss decreased (-0.881476 --> -0.885180).  Saving model ...
Epoch: 27 cost time: 0.5322620868682861
Epoch: 27, Steps: 2 | Train Loss: 0.356 Vali Loss: 0.532 Vali Acc: 0.885 Test Loss: 0.532 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 28 cost time: 0.5710365772247314
Epoch: 28, Steps: 2 | Train Loss: 0.359 Vali Loss: 0.512 Vali Acc: 0.878 Test Loss: 0.512 Test Acc: 0.878
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 0.4921894073486328
Epoch: 29, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.493 Vali Acc: 0.878 Test Loss: 0.493 Test Acc: 0.878
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 0.5312156677246094
Epoch: 30, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.477 Vali Acc: 0.885 Test Loss: 0.477 Test Acc: 0.885
Validation loss decreased (-0.885180 --> -0.885180).  Saving model ...
Epoch: 31 cost time: 0.5220191478729248
Epoch: 31, Steps: 2 | Train Loss: 0.300 Vali Loss: 0.463 Vali Acc: 0.870 Test Loss: 0.463 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5625929832458496
Epoch: 32, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.450 Vali Acc: 0.874 Test Loss: 0.450 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5961291790008545
Epoch: 33, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.438 Vali Acc: 0.870 Test Loss: 0.438 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5712718963623047
Epoch: 34, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.428 Vali Acc: 0.870 Test Loss: 0.428 Test Acc: 0.870
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5268733501434326
Epoch: 35, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.419 Vali Acc: 0.863 Test Loss: 0.419 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.4821329116821289
Epoch: 36, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.411 Vali Acc: 0.878 Test Loss: 0.411 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.48627233505249023
Epoch: 37, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.404 Vali Acc: 0.874 Test Loss: 0.404 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5051143169403076
Epoch: 38, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.397 Vali Acc: 0.870 Test Loss: 0.397 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 0.4770476818084717
Epoch: 39, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.391 Vali Acc: 0.870 Test Loss: 0.391 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 0.4951026439666748
Epoch: 40, Steps: 2 | Train Loss: 0.195 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8851851851851852
model parameter : 146662
model size : 1.18MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.045907974243164
Epoch: 1, Steps: 2 | Train Loss: 1.711 Vali Loss: 1.780 Vali Acc: 0.248 Test Loss: 1.780 Test Acc: 0.248
Validation loss decreased (inf --> -0.248130).  Saving model ...
Epoch: 2 cost time: 0.5092227458953857
Epoch: 2, Steps: 2 | Train Loss: 1.876 Vali Loss: 1.717 Vali Acc: 0.289 Test Loss: 1.717 Test Acc: 0.289
Validation loss decreased (-0.248130 --> -0.288872).  Saving model ...
Epoch: 3 cost time: 0.5296990871429443
Epoch: 3, Steps: 2 | Train Loss: 1.716 Vali Loss: 1.672 Vali Acc: 0.307 Test Loss: 1.672 Test Acc: 0.307
Validation loss decreased (-0.288872 --> -0.307391).  Saving model ...
Epoch: 4 cost time: 0.546600341796875
Epoch: 4, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.631 Vali Acc: 0.330 Test Loss: 1.631 Test Acc: 0.330
Validation loss decreased (-0.307391 --> -0.329613).  Saving model ...
Epoch: 5 cost time: 0.5406417846679688
Epoch: 5, Steps: 2 | Train Loss: 1.540 Vali Loss: 1.580 Vali Acc: 0.363 Test Loss: 1.580 Test Acc: 0.363
Validation loss decreased (-0.329613 --> -0.362947).  Saving model ...
Epoch: 6 cost time: 0.5593578815460205
Epoch: 6, Steps: 2 | Train Loss: 1.609 Vali Loss: 1.521 Vali Acc: 0.415 Test Loss: 1.521 Test Acc: 0.415
Validation loss decreased (-0.362947 --> -0.414800).  Saving model ...
Epoch: 7 cost time: 0.6019470691680908
Epoch: 7, Steps: 2 | Train Loss: 1.527 Vali Loss: 1.457 Vali Acc: 0.463 Test Loss: 1.457 Test Acc: 0.463
Validation loss decreased (-0.414800 --> -0.462948).  Saving model ...
Epoch: 8 cost time: 0.5589911937713623
Epoch: 8, Steps: 2 | Train Loss: 1.381 Vali Loss: 1.391 Vali Acc: 0.511 Test Loss: 1.391 Test Acc: 0.511
Validation loss decreased (-0.462948 --> -0.511097).  Saving model ...
Epoch: 9 cost time: 0.6131103038787842
Epoch: 9, Steps: 2 | Train Loss: 1.373 Vali Loss: 1.321 Vali Acc: 0.593 Test Loss: 1.321 Test Acc: 0.593
Validation loss decreased (-0.511097 --> -0.592579).  Saving model ...
Epoch: 10 cost time: 0.5598862171173096
Epoch: 10, Steps: 2 | Train Loss: 1.162 Vali Loss: 1.250 Vali Acc: 0.644 Test Loss: 1.250 Test Acc: 0.644
Validation loss decreased (-0.592579 --> -0.644432).  Saving model ...
Epoch: 11 cost time: 0.48328208923339844
Epoch: 11, Steps: 2 | Train Loss: 1.164 Vali Loss: 1.179 Vali Acc: 0.685 Test Loss: 1.179 Test Acc: 0.685
Validation loss decreased (-0.644432 --> -0.685173).  Saving model ...
Epoch: 12 cost time: 0.4341304302215576
Epoch: 12, Steps: 2 | Train Loss: 1.053 Vali Loss: 1.108 Vali Acc: 0.733 Test Loss: 1.108 Test Acc: 0.733
Validation loss decreased (-0.685173 --> -0.733322).  Saving model ...
Epoch: 13 cost time: 0.49970126152038574
Epoch: 13, Steps: 2 | Train Loss: 0.988 Vali Loss: 1.038 Vali Acc: 0.770 Test Loss: 1.038 Test Acc: 0.770
Validation loss decreased (-0.733322 --> -0.770360).  Saving model ...
Epoch: 14 cost time: 0.5053040981292725
Epoch: 14, Steps: 2 | Train Loss: 0.907 Vali Loss: 0.971 Vali Acc: 0.793 Test Loss: 0.971 Test Acc: 0.793
Validation loss decreased (-0.770360 --> -0.792583).  Saving model ...
Epoch: 15 cost time: 0.4973480701446533
Epoch: 15, Steps: 2 | Train Loss: 0.841 Vali Loss: 0.907 Vali Acc: 0.822 Test Loss: 0.907 Test Acc: 0.822
Validation loss decreased (-0.792583 --> -0.822213).  Saving model ...
Epoch: 16 cost time: 0.44240260124206543
Epoch: 16, Steps: 2 | Train Loss: 0.757 Vali Loss: 0.846 Vali Acc: 0.833 Test Loss: 0.846 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 17 cost time: 0.4942624568939209
Epoch: 17, Steps: 2 | Train Loss: 0.715 Vali Loss: 0.788 Vali Acc: 0.833 Test Loss: 0.788 Test Acc: 0.833
Validation loss decreased (-0.833325 --> -0.833325).  Saving model ...
Epoch: 18 cost time: 0.47153377532958984
Epoch: 18, Steps: 2 | Train Loss: 0.589 Vali Loss: 0.735 Vali Acc: 0.848 Test Loss: 0.735 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848141).  Saving model ...
Epoch: 19 cost time: 0.5116517543792725
Epoch: 19, Steps: 2 | Train Loss: 0.536 Vali Loss: 0.685 Vali Acc: 0.852 Test Loss: 0.685 Test Acc: 0.852
Validation loss decreased (-0.848141 --> -0.851845).  Saving model ...
Epoch: 20 cost time: 0.6136338710784912
Epoch: 20, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.641 Vali Acc: 0.852 Test Loss: 0.641 Test Acc: 0.852
Validation loss decreased (-0.851845 --> -0.851845).  Saving model ...
Epoch: 21 cost time: 0.640312671661377
Epoch: 21, Steps: 2 | Train Loss: 0.479 Vali Loss: 0.598 Vali Acc: 0.874 Test Loss: 0.598 Test Acc: 0.874
Validation loss decreased (-0.851845 --> -0.874068).  Saving model ...
Epoch: 22 cost time: 0.6130588054656982
Epoch: 22, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.558 Vali Acc: 0.889 Test Loss: 0.558 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 0.5737400054931641
Epoch: 23, Steps: 2 | Train Loss: 0.358 Vali Loss: 0.521 Vali Acc: 0.900 Test Loss: 0.521 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899995).  Saving model ...
Epoch: 24 cost time: 0.5735359191894531
Epoch: 24, Steps: 2 | Train Loss: 0.325 Vali Loss: 0.486 Vali Acc: 0.911 Test Loss: 0.486 Test Acc: 0.911
Validation loss decreased (-0.899995 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.6040387153625488
Epoch: 25, Steps: 2 | Train Loss: 0.307 Vali Loss: 0.455 Vali Acc: 0.911 Test Loss: 0.455 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911107).  Saving model ...
Epoch: 26 cost time: 0.6177055835723877
Epoch: 26, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.427 Vali Acc: 0.915 Test Loss: 0.427 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 27 cost time: 0.5662097930908203
Epoch: 27, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.401 Vali Acc: 0.915 Test Loss: 0.401 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 28 cost time: 0.621760368347168
Epoch: 28, Steps: 2 | Train Loss: 0.218 Vali Loss: 0.379 Vali Acc: 0.915 Test Loss: 0.379 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.5767755508422852
Epoch: 29, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.359 Vali Acc: 0.915 Test Loss: 0.359 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.6153872013092041
Epoch: 30, Steps: 2 | Train Loss: 0.164 Vali Loss: 0.343 Vali Acc: 0.915 Test Loss: 0.343 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 31 cost time: 0.5628066062927246
Epoch: 31, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.329 Vali Acc: 0.915 Test Loss: 0.329 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914812).  Saving model ...
Epoch: 32 cost time: 0.5463624000549316
Epoch: 32, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.316 Vali Acc: 0.911 Test Loss: 0.316 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.594233512878418
Epoch: 33, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.305 Vali Acc: 0.911 Test Loss: 0.305 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.564110517501831
Epoch: 34, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5762572288513184
Epoch: 35, Steps: 2 | Train Loss: 0.103 Vali Loss: 0.286 Vali Acc: 0.911 Test Loss: 0.286 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5176491737365723
Epoch: 36, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.278 Vali Acc: 0.911 Test Loss: 0.278 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5031239986419678
Epoch: 37, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.271 Vali Acc: 0.911 Test Loss: 0.271 Test Acc: 0.911
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 0.5101296901702881
Epoch: 38, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.265 Vali Acc: 0.911 Test Loss: 0.265 Test Acc: 0.911
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 0.5587954521179199
Epoch: 39, Steps: 2 | Train Loss: 0.083 Vali Loss: 0.259 Vali Acc: 0.911 Test Loss: 0.259 Test Acc: 0.911
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 0.5751190185546875
Epoch: 40, Steps: 2 | Train Loss: 0.062 Vali Loss: 0.254 Vali Acc: 0.911 Test Loss: 0.254 Test Acc: 0.911
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 0.5819730758666992
Epoch: 41, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.250 Vali Acc: 0.911 Test Loss: 0.250 Test Acc: 0.911
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9148148148148149
model parameter : 81126
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.309993267059326
Epoch: 1, Steps: 2 | Train Loss: 1.744 Vali Loss: 1.781 Vali Acc: 0.230 Test Loss: 1.781 Test Acc: 0.230
Validation loss decreased (inf --> -0.229612).  Saving model ...
Epoch: 2 cost time: 0.49463939666748047
Epoch: 2, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.718 Vali Acc: 0.278 Test Loss: 1.718 Test Acc: 0.278
Validation loss decreased (-0.229612 --> -0.277761).  Saving model ...
Epoch: 3 cost time: 0.5056140422821045
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.673 Vali Acc: 0.300 Test Loss: 1.673 Test Acc: 0.300
Validation loss decreased (-0.277761 --> -0.299983).  Saving model ...
Epoch: 4 cost time: 0.5085353851318359
Epoch: 4, Steps: 2 | Train Loss: 1.624 Vali Loss: 1.632 Vali Acc: 0.322 Test Loss: 1.632 Test Acc: 0.322
Validation loss decreased (-0.299983 --> -0.322206).  Saving model ...
Epoch: 5 cost time: 0.510042667388916
Epoch: 5, Steps: 2 | Train Loss: 1.569 Vali Loss: 1.580 Vali Acc: 0.359 Test Loss: 1.580 Test Acc: 0.359
Validation loss decreased (-0.322206 --> -0.359243).  Saving model ...
Epoch: 6 cost time: 0.5116338729858398
Epoch: 6, Steps: 2 | Train Loss: 1.597 Vali Loss: 1.522 Vali Acc: 0.422 Test Loss: 1.522 Test Acc: 0.422
Validation loss decreased (-0.359243 --> -0.422207).  Saving model ...
Epoch: 7 cost time: 0.5437524318695068
Epoch: 7, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.457 Vali Acc: 0.489 Test Loss: 1.457 Test Acc: 0.489
Validation loss decreased (-0.422207 --> -0.488874).  Saving model ...
Epoch: 8 cost time: 0.48451900482177734
Epoch: 8, Steps: 2 | Train Loss: 1.419 Vali Loss: 1.391 Vali Acc: 0.544 Test Loss: 1.391 Test Acc: 0.544
Validation loss decreased (-0.488874 --> -0.544431).  Saving model ...
Epoch: 9 cost time: 0.5973870754241943
Epoch: 9, Steps: 2 | Train Loss: 1.388 Vali Loss: 1.322 Vali Acc: 0.604 Test Loss: 1.322 Test Acc: 0.604
Validation loss decreased (-0.544431 --> -0.603690).  Saving model ...
Epoch: 10 cost time: 0.5124127864837646
Epoch: 10, Steps: 2 | Train Loss: 1.183 Vali Loss: 1.251 Vali Acc: 0.663 Test Loss: 1.251 Test Acc: 0.663
Validation loss decreased (-0.603690 --> -0.662950).  Saving model ...
Epoch: 11 cost time: 0.5029935836791992
Epoch: 11, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.179 Vali Acc: 0.719 Test Loss: 1.179 Test Acc: 0.719
Validation loss decreased (-0.662950 --> -0.718507).  Saving model ...
Epoch: 12 cost time: 0.5194950103759766
Epoch: 12, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.108 Vali Acc: 0.767 Test Loss: 1.108 Test Acc: 0.767
Validation loss decreased (-0.718507 --> -0.766656).  Saving model ...
Epoch: 13 cost time: 0.5334570407867432
Epoch: 13, Steps: 2 | Train Loss: 0.996 Vali Loss: 1.038 Vali Acc: 0.789 Test Loss: 1.038 Test Acc: 0.789
Validation loss decreased (-0.766656 --> -0.788879).  Saving model ...
Epoch: 14 cost time: 0.5068321228027344
Epoch: 14, Steps: 2 | Train Loss: 0.941 Vali Loss: 0.971 Vali Acc: 0.804 Test Loss: 0.971 Test Acc: 0.804
Validation loss decreased (-0.788879 --> -0.803694).  Saving model ...
Epoch: 15 cost time: 0.4989619255065918
Epoch: 15, Steps: 2 | Train Loss: 0.856 Vali Loss: 0.907 Vali Acc: 0.830 Test Loss: 0.907 Test Acc: 0.830
Validation loss decreased (-0.803694 --> -0.829621).  Saving model ...
Epoch: 16 cost time: 0.4857161045074463
Epoch: 16, Steps: 2 | Train Loss: 0.788 Vali Loss: 0.845 Vali Acc: 0.837 Test Loss: 0.845 Test Acc: 0.837
Validation loss decreased (-0.829621 --> -0.837029).  Saving model ...
Epoch: 17 cost time: 0.5372557640075684
Epoch: 17, Steps: 2 | Train Loss: 0.723 Vali Loss: 0.787 Vali Acc: 0.852 Test Loss: 0.787 Test Acc: 0.852
Validation loss decreased (-0.837029 --> -0.851844).  Saving model ...
Epoch: 18 cost time: 0.5218682289123535
Epoch: 18, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.735 Vali Acc: 0.856 Test Loss: 0.735 Test Acc: 0.856
Validation loss decreased (-0.851844 --> -0.855548).  Saving model ...
Epoch: 19 cost time: 0.47243523597717285
Epoch: 19, Steps: 2 | Train Loss: 0.573 Vali Loss: 0.685 Vali Acc: 0.859 Test Loss: 0.685 Test Acc: 0.859
Validation loss decreased (-0.855548 --> -0.859252).  Saving model ...
Epoch: 20 cost time: 0.512101411819458
Epoch: 20, Steps: 2 | Train Loss: 0.565 Vali Loss: 0.641 Vali Acc: 0.863 Test Loss: 0.641 Test Acc: 0.863
Validation loss decreased (-0.859252 --> -0.862957).  Saving model ...
Epoch: 21 cost time: 0.5469455718994141
Epoch: 21, Steps: 2 | Train Loss: 0.477 Vali Loss: 0.597 Vali Acc: 0.878 Test Loss: 0.597 Test Acc: 0.878
Validation loss decreased (-0.862957 --> -0.877772).  Saving model ...
Epoch: 22 cost time: 0.4895131587982178
Epoch: 22, Steps: 2 | Train Loss: 0.442 Vali Loss: 0.558 Vali Acc: 0.893 Test Loss: 0.558 Test Acc: 0.893
Validation loss decreased (-0.877772 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.5574667453765869
Epoch: 23, Steps: 2 | Train Loss: 0.368 Vali Loss: 0.521 Vali Acc: 0.896 Test Loss: 0.521 Test Acc: 0.896
Validation loss decreased (-0.892587 --> -0.896291).  Saving model ...
Epoch: 24 cost time: 0.5142123699188232
Epoch: 24, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.487 Vali Acc: 0.900 Test Loss: 0.487 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.5550072193145752
Epoch: 25, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.456 Vali Acc: 0.907 Test Loss: 0.456 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907403).  Saving model ...
Epoch: 26 cost time: 0.5795023441314697
Epoch: 26, Steps: 2 | Train Loss: 0.258 Vali Loss: 0.429 Vali Acc: 0.911 Test Loss: 0.429 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.5109219551086426
Epoch: 27, Steps: 2 | Train Loss: 0.259 Vali Loss: 0.404 Vali Acc: 0.919 Test Loss: 0.404 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918514).  Saving model ...
Epoch: 28 cost time: 0.4342355728149414
Epoch: 28, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.918514 --> -0.918515).  Saving model ...
Epoch: 29 cost time: 0.5915524959564209
Epoch: 29, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.362 Vali Acc: 0.919 Test Loss: 0.362 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 30 cost time: 0.564584493637085
Epoch: 30, Steps: 2 | Train Loss: 0.180 Vali Loss: 0.345 Vali Acc: 0.919 Test Loss: 0.345 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 31 cost time: 0.5420787334442139
Epoch: 31, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.331 Vali Acc: 0.915 Test Loss: 0.331 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5681359767913818
Epoch: 32, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.317 Vali Acc: 0.915 Test Loss: 0.317 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 0.5633594989776611
Epoch: 33, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 0.5358176231384277
Epoch: 34, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.296 Vali Acc: 0.911 Test Loss: 0.296 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 0.5348935127258301
Epoch: 35, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.287 Vali Acc: 0.911 Test Loss: 0.287 Test Acc: 0.911
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 0.5069890022277832
Epoch: 36, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 0.5098085403442383
Epoch: 37, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.273 Vali Acc: 0.915 Test Loss: 0.273 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 0.5562589168548584
Epoch: 38, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.267 Vali Acc: 0.919 Test Loss: 0.267 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.4686295986175537
Epoch: 39, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.261 Vali Acc: 0.919 Test Loss: 0.261 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.5060150623321533
Epoch: 40, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.256 Vali Acc: 0.919 Test Loss: 0.256 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.476010799407959
Epoch: 41, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.251 Vali Acc: 0.915 Test Loss: 0.251 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 42 cost time: 0.5963013172149658
Epoch: 42, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.246 Vali Acc: 0.915 Test Loss: 0.246 Test Acc: 0.915
EarlyStopping counter: 2 out of 10
Epoch: 43 cost time: 0.5195364952087402
Epoch: 43, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.243 Vali Acc: 0.915 Test Loss: 0.243 Test Acc: 0.915
EarlyStopping counter: 3 out of 10
Epoch: 44 cost time: 0.5158493518829346
Epoch: 44, Steps: 2 | Train Loss: 0.057 Vali Loss: 0.239 Vali Acc: 0.915 Test Loss: 0.239 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 45 cost time: 0.5289955139160156
Epoch: 45, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.236 Vali Acc: 0.915 Test Loss: 0.236 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 46 cost time: 0.5478146076202393
Epoch: 46, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.233 Vali Acc: 0.915 Test Loss: 0.233 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 47 cost time: 0.5471997261047363
Epoch: 47, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.230 Vali Acc: 0.915 Test Loss: 0.230 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 48 cost time: 0.5926651954650879
Epoch: 48, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.228 Vali Acc: 0.915 Test Loss: 0.228 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 49 cost time: 0.5665500164031982
Epoch: 49, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.226 Vali Acc: 0.915 Test Loss: 0.226 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 50 cost time: 0.575383186340332
Epoch: 50, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.224 Vali Acc: 0.919 Test Loss: 0.224 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 51 cost time: 0.556464672088623
Epoch: 51, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.222 Vali Acc: 0.919 Test Loss: 0.222 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 52 cost time: 0.5478482246398926
Epoch: 52, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.220 Vali Acc: 0.919 Test Loss: 0.220 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 53 cost time: 0.5344979763031006
Epoch: 53, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.219 Vali Acc: 0.919 Test Loss: 0.219 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 54 cost time: 0.5496907234191895
Epoch: 54, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.919 Test Loss: 0.217 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 55 cost time: 0.5515811443328857
Epoch: 55, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.215 Vali Acc: 0.919 Test Loss: 0.215 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 56 cost time: 0.5518715381622314
Epoch: 56, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.213 Vali Acc: 0.919 Test Loss: 0.213 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 57 cost time: 0.521554708480835
Epoch: 57, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.211 Vali Acc: 0.919 Test Loss: 0.211 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 58 cost time: 0.5674355030059814
Epoch: 58, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.210 Vali Acc: 0.919 Test Loss: 0.210 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 59 cost time: 0.5790235996246338
Epoch: 59, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.919 Test Loss: 0.209 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 60 cost time: 0.5185539722442627
Epoch: 60, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.207 Vali Acc: 0.919 Test Loss: 0.207 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 61 cost time: 0.4547133445739746
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.206 Vali Acc: 0.919 Test Loss: 0.206 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 62 cost time: 0.505131721496582
Epoch: 62, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.922 Test Loss: 0.205 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 63 cost time: 0.513357400894165
Epoch: 63, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
Validation loss decreased (-0.922220 --> -0.925924).  Saving model ...
Epoch: 64 cost time: 0.5109233856201172
Epoch: 64, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.204 Vali Acc: 0.926 Test Loss: 0.204 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 65 cost time: 0.4756946563720703
Epoch: 65, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.926 Test Loss: 0.203 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 66 cost time: 0.4825441837310791
Epoch: 66, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 67 cost time: 0.5027995109558105
Epoch: 67, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.926 Test Loss: 0.202 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 68 cost time: 0.47943925857543945
Epoch: 68, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 69 cost time: 0.5001955032348633
Epoch: 69, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.201 Vali Acc: 0.926 Test Loss: 0.201 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 70 cost time: 0.5118672847747803
Epoch: 70, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.200 Vali Acc: 0.926 Test Loss: 0.200 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 71 cost time: 0.5432882308959961
Epoch: 71, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 72 cost time: 0.4985635280609131
Epoch: 72, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.199 Vali Acc: 0.926 Test Loss: 0.199 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 73 cost time: 0.5399932861328125
Epoch: 73, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.198 Vali Acc: 0.926 Test Loss: 0.198 Test Acc: 0.926
Validation loss decreased (-0.925924 --> -0.925924).  Saving model ...
Epoch: 74 cost time: 0.4975547790527344
Epoch: 74, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.197 Vali Acc: 0.930 Test Loss: 0.197 Test Acc: 0.930
Validation loss decreased (-0.925924 --> -0.929628).  Saving model ...
Epoch: 75 cost time: 0.5538630485534668
Epoch: 75, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 76 cost time: 0.5170414447784424
Epoch: 76, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 77 cost time: 0.5426571369171143
Epoch: 77, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.930 Test Loss: 0.196 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 78 cost time: 0.5016465187072754
Epoch: 78, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 79 cost time: 0.5080640316009521
Epoch: 79, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 80 cost time: 0.49526548385620117
Epoch: 80, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 81 cost time: 0.5741293430328369
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 82 cost time: 0.4747023582458496
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 83 cost time: 0.5154669284820557
Epoch: 83, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 84 cost time: 0.4314422607421875
Epoch: 84, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.195 Vali Acc: 0.930 Test Loss: 0.195 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.47330665588378906
Epoch: 85, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 86 cost time: 0.4815359115600586
Epoch: 86, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 87 cost time: 0.5238375663757324
Epoch: 87, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.194 Vali Acc: 0.930 Test Loss: 0.194 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 88 cost time: 0.5177202224731445
Epoch: 88, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 89 cost time: 0.49569082260131836
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 90 cost time: 0.4872903823852539
Epoch: 90, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.193 Vali Acc: 0.930 Test Loss: 0.193 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 91 cost time: 0.47844958305358887
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.930 Test Loss: 0.192 Test Acc: 0.930
Validation loss decreased (-0.929628 --> -0.929628).  Saving model ...
Epoch: 92 cost time: 0.4530029296875
Epoch: 92, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 93 cost time: 0.496981143951416
Epoch: 93, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 94 cost time: 0.5231575965881348
Epoch: 94, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 95 cost time: 0.5067451000213623
Epoch: 95, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 96 cost time: 0.5397469997406006
Epoch: 96, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.922 Test Loss: 0.192 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 97 cost time: 0.5746779441833496
Epoch: 97, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 98 cost time: 0.49237966537475586
Epoch: 98, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.191 Vali Acc: 0.922 Test Loss: 0.191 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 99 cost time: 0.5239005088806152
Epoch: 99, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.922 Test Loss: 0.190 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 100 cost time: 0.45237016677856445
Epoch: 100, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.190 Vali Acc: 0.926 Test Loss: 0.190 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 81126
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.258861541748047
Epoch: 1, Steps: 2 | Train Loss: 1.728 Vali Loss: 1.794 Vali Acc: 0.167 Test Loss: 1.794 Test Acc: 0.167
Validation loss decreased (inf --> -0.166649).  Saving model ...
Epoch: 2 cost time: 0.5519089698791504
Epoch: 2, Steps: 2 | Train Loss: 1.902 Vali Loss: 1.732 Vali Acc: 0.259 Test Loss: 1.732 Test Acc: 0.259
Validation loss decreased (-0.166649 --> -0.259242).  Saving model ...
Epoch: 3 cost time: 0.4985830783843994
Epoch: 3, Steps: 2 | Train Loss: 1.713 Vali Loss: 1.687 Vali Acc: 0.289 Test Loss: 1.687 Test Acc: 0.289
Validation loss decreased (-0.259242 --> -0.288872).  Saving model ...
Epoch: 4 cost time: 0.5042109489440918
Epoch: 4, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.647 Vali Acc: 0.311 Test Loss: 1.647 Test Acc: 0.311
Validation loss decreased (-0.288872 --> -0.311095).  Saving model ...
Epoch: 5 cost time: 0.5130410194396973
Epoch: 5, Steps: 2 | Train Loss: 1.563 Vali Loss: 1.597 Vali Acc: 0.348 Test Loss: 1.597 Test Acc: 0.348
Validation loss decreased (-0.311095 --> -0.348132).  Saving model ...
Epoch: 6 cost time: 0.5184750556945801
Epoch: 6, Steps: 2 | Train Loss: 1.604 Vali Loss: 1.539 Vali Acc: 0.415 Test Loss: 1.539 Test Acc: 0.415
Validation loss decreased (-0.348132 --> -0.414799).  Saving model ...
Epoch: 7 cost time: 0.4938809871673584
Epoch: 7, Steps: 2 | Train Loss: 1.522 Vali Loss: 1.477 Vali Acc: 0.470 Test Loss: 1.477 Test Acc: 0.470
Validation loss decreased (-0.414799 --> -0.470356).  Saving model ...
Epoch: 8 cost time: 0.49921178817749023
Epoch: 8, Steps: 2 | Train Loss: 1.394 Vali Loss: 1.411 Vali Acc: 0.548 Test Loss: 1.411 Test Acc: 0.548
Validation loss decreased (-0.470356 --> -0.548134).  Saving model ...
Epoch: 9 cost time: 0.5047402381896973
Epoch: 9, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.344 Vali Acc: 0.596 Test Loss: 1.344 Test Acc: 0.596
Validation loss decreased (-0.548134 --> -0.596283).  Saving model ...
Epoch: 10 cost time: 0.5729198455810547
Epoch: 10, Steps: 2 | Train Loss: 1.195 Vali Loss: 1.274 Vali Acc: 0.656 Test Loss: 1.274 Test Acc: 0.656
Validation loss decreased (-0.596283 --> -0.655543).  Saving model ...
Epoch: 11 cost time: 0.5542550086975098
Epoch: 11, Steps: 2 | Train Loss: 1.203 Vali Loss: 1.204 Vali Acc: 0.693 Test Loss: 1.204 Test Acc: 0.693
Validation loss decreased (-0.655543 --> -0.692581).  Saving model ...
Epoch: 12 cost time: 0.5733232498168945
Epoch: 12, Steps: 2 | Train Loss: 1.069 Vali Loss: 1.133 Vali Acc: 0.741 Test Loss: 1.133 Test Acc: 0.741
Validation loss decreased (-0.692581 --> -0.740729).  Saving model ...
Epoch: 13 cost time: 0.5840418338775635
Epoch: 13, Steps: 2 | Train Loss: 0.989 Vali Loss: 1.064 Vali Acc: 0.756 Test Loss: 1.064 Test Acc: 0.756
Validation loss decreased (-0.740729 --> -0.755545).  Saving model ...
Epoch: 14 cost time: 0.5223824977874756
Epoch: 14, Steps: 2 | Train Loss: 0.978 Vali Loss: 0.998 Vali Acc: 0.793 Test Loss: 0.998 Test Acc: 0.793
Validation loss decreased (-0.755545 --> -0.792583).  Saving model ...
Epoch: 15 cost time: 0.6040549278259277
Epoch: 15, Steps: 2 | Train Loss: 0.875 Vali Loss: 0.936 Vali Acc: 0.819 Test Loss: 0.936 Test Acc: 0.819
Validation loss decreased (-0.792583 --> -0.818509).  Saving model ...
Epoch: 16 cost time: 0.6191897392272949
Epoch: 16, Steps: 2 | Train Loss: 0.806 Vali Loss: 0.876 Vali Acc: 0.826 Test Loss: 0.876 Test Acc: 0.826
Validation loss decreased (-0.818509 --> -0.825917).  Saving model ...
Epoch: 17 cost time: 0.6184782981872559
Epoch: 17, Steps: 2 | Train Loss: 0.745 Vali Loss: 0.818 Vali Acc: 0.837 Test Loss: 0.818 Test Acc: 0.837
Validation loss decreased (-0.825917 --> -0.837029).  Saving model ...
Epoch: 18 cost time: 0.5501034259796143
Epoch: 18, Steps: 2 | Train Loss: 0.629 Vali Loss: 0.767 Vali Acc: 0.841 Test Loss: 0.767 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 19 cost time: 0.5709826946258545
Epoch: 19, Steps: 2 | Train Loss: 0.619 Vali Loss: 0.719 Vali Acc: 0.870 Test Loss: 0.719 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870363).  Saving model ...
Epoch: 20 cost time: 0.5866165161132812
Epoch: 20, Steps: 2 | Train Loss: 0.577 Vali Loss: 0.676 Vali Acc: 0.878 Test Loss: 0.676 Test Acc: 0.878
Validation loss decreased (-0.870363 --> -0.877771).  Saving model ...
Epoch: 21 cost time: 0.559333086013794
Epoch: 21, Steps: 2 | Train Loss: 0.506 Vali Loss: 0.634 Vali Acc: 0.874 Test Loss: 0.634 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 0.5901331901550293
Epoch: 22, Steps: 2 | Train Loss: 0.456 Vali Loss: 0.596 Vali Acc: 0.893 Test Loss: 0.596 Test Acc: 0.893
Validation loss decreased (-0.877771 --> -0.892587).  Saving model ...
Epoch: 23 cost time: 0.5565133094787598
Epoch: 23, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.560 Vali Acc: 0.904 Test Loss: 0.560 Test Acc: 0.904
Validation loss decreased (-0.892587 --> -0.903698).  Saving model ...
Epoch: 24 cost time: 0.55790114402771
Epoch: 24, Steps: 2 | Train Loss: 0.376 Vali Loss: 0.526 Vali Acc: 0.911 Test Loss: 0.526 Test Acc: 0.911
Validation loss decreased (-0.903698 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.5493111610412598
Epoch: 25, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.495 Vali Acc: 0.907 Test Loss: 0.495 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5475800037384033
Epoch: 26, Steps: 2 | Train Loss: 0.294 Vali Loss: 0.468 Vali Acc: 0.911 Test Loss: 0.468 Test Acc: 0.911
Validation loss decreased (-0.911106 --> -0.911106).  Saving model ...
Epoch: 27 cost time: 0.5129609107971191
Epoch: 27, Steps: 2 | Train Loss: 0.275 Vali Loss: 0.442 Vali Acc: 0.915 Test Loss: 0.442 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 28 cost time: 0.5337905883789062
Epoch: 28, Steps: 2 | Train Loss: 0.273 Vali Loss: 0.419 Vali Acc: 0.915 Test Loss: 0.419 Test Acc: 0.915
Validation loss decreased (-0.914810 --> -0.914811).  Saving model ...
Epoch: 29 cost time: 0.5141415596008301
Epoch: 29, Steps: 2 | Train Loss: 0.231 Vali Loss: 0.398 Vali Acc: 0.915 Test Loss: 0.398 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 30 cost time: 0.5114796161651611
Epoch: 30, Steps: 2 | Train Loss: 0.217 Vali Loss: 0.381 Vali Acc: 0.919 Test Loss: 0.381 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 31 cost time: 0.4678785800933838
Epoch: 31, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 32 cost time: 0.4724559783935547
Epoch: 32, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.353 Vali Acc: 0.919 Test Loss: 0.353 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 33 cost time: 0.5122418403625488
Epoch: 33, Steps: 2 | Train Loss: 0.155 Vali Loss: 0.342 Vali Acc: 0.907 Test Loss: 0.342 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.5681219100952148
Epoch: 34, Steps: 2 | Train Loss: 0.153 Vali Loss: 0.332 Vali Acc: 0.907 Test Loss: 0.332 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.560246467590332
Epoch: 35, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.322 Vali Acc: 0.907 Test Loss: 0.322 Test Acc: 0.907
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.5511159896850586
Epoch: 36, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.313 Vali Acc: 0.915 Test Loss: 0.313 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.5783672332763672
Epoch: 37, Steps: 2 | Train Loss: 0.107 Vali Loss: 0.306 Vali Acc: 0.915 Test Loss: 0.306 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.5801131725311279
Epoch: 38, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.299 Vali Acc: 0.915 Test Loss: 0.299 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 0.61417555809021
Epoch: 39, Steps: 2 | Train Loss: 0.115 Vali Loss: 0.293 Vali Acc: 0.915 Test Loss: 0.293 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 0.5810894966125488
Epoch: 40, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.287 Vali Acc: 0.915 Test Loss: 0.287 Test Acc: 0.915
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 0.4825444221496582
Epoch: 41, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.282 Vali Acc: 0.915 Test Loss: 0.282 Test Acc: 0.915
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 0.5056664943695068
Epoch: 42, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.277 Vali Acc: 0.915 Test Loss: 0.277 Test Acc: 0.915
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9185185185185185
model parameter : 81126
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.018636465072632
Epoch: 1, Steps: 2 | Train Loss: 1.855 Vali Loss: 1.864 Vali Acc: 0.152 Test Loss: 1.864 Test Acc: 0.152
Validation loss decreased (inf --> -0.151833).  Saving model ...
Epoch: 2 cost time: 0.486053466796875
Epoch: 2, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.806 Vali Acc: 0.207 Test Loss: 1.806 Test Acc: 0.207
Validation loss decreased (-0.151833 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.4332911968231201
Epoch: 3, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.765 Vali Acc: 0.226 Test Loss: 1.765 Test Acc: 0.226
Validation loss decreased (-0.207389 --> -0.225908).  Saving model ...
Epoch: 4 cost time: 0.4778730869293213
Epoch: 4, Steps: 2 | Train Loss: 1.746 Vali Loss: 1.728 Vali Acc: 0.252 Test Loss: 1.728 Test Acc: 0.252
Validation loss decreased (-0.225908 --> -0.251835).  Saving model ...
Epoch: 5 cost time: 0.4339871406555176
Epoch: 5, Steps: 2 | Train Loss: 1.647 Vali Loss: 1.681 Vali Acc: 0.274 Test Loss: 1.681 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274057).  Saving model ...
Epoch: 6 cost time: 0.437333345413208
Epoch: 6, Steps: 2 | Train Loss: 1.714 Vali Loss: 1.628 Vali Acc: 0.311 Test Loss: 1.628 Test Acc: 0.311
Validation loss decreased (-0.274057 --> -0.311095).  Saving model ...
Epoch: 7 cost time: 0.4740321636199951
Epoch: 7, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.570 Vali Acc: 0.359 Test Loss: 1.570 Test Acc: 0.359
Validation loss decreased (-0.311095 --> -0.359244).  Saving model ...
Epoch: 8 cost time: 0.4579441547393799
Epoch: 8, Steps: 2 | Train Loss: 1.508 Vali Loss: 1.509 Vali Acc: 0.415 Test Loss: 1.509 Test Acc: 0.415
Validation loss decreased (-0.359244 --> -0.414800).  Saving model ...
Epoch: 9 cost time: 0.47486162185668945
Epoch: 9, Steps: 2 | Train Loss: 1.479 Vali Loss: 1.446 Vali Acc: 0.470 Test Loss: 1.446 Test Acc: 0.470
Validation loss decreased (-0.414800 --> -0.470356).  Saving model ...
Epoch: 10 cost time: 0.4927678108215332
Epoch: 10, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.381 Vali Acc: 0.541 Test Loss: 1.381 Test Acc: 0.541
Validation loss decreased (-0.470356 --> -0.540727).  Saving model ...
Epoch: 11 cost time: 0.46687746047973633
Epoch: 11, Steps: 2 | Train Loss: 1.324 Vali Loss: 1.314 Vali Acc: 0.596 Test Loss: 1.314 Test Acc: 0.596
Validation loss decreased (-0.540727 --> -0.596283).  Saving model ...
Epoch: 12 cost time: 0.48868227005004883
Epoch: 12, Steps: 2 | Train Loss: 1.201 Vali Loss: 1.248 Vali Acc: 0.633 Test Loss: 1.248 Test Acc: 0.633
Validation loss decreased (-0.596283 --> -0.633321).  Saving model ...
Epoch: 13 cost time: 0.43729329109191895
Epoch: 13, Steps: 2 | Train Loss: 1.166 Vali Loss: 1.183 Vali Acc: 0.656 Test Loss: 1.183 Test Acc: 0.656
Validation loss decreased (-0.633321 --> -0.655544).  Saving model ...
Epoch: 14 cost time: 0.47676753997802734
Epoch: 14, Steps: 2 | Train Loss: 1.099 Vali Loss: 1.121 Vali Acc: 0.685 Test Loss: 1.121 Test Acc: 0.685
Validation loss decreased (-0.655544 --> -0.685174).  Saving model ...
Epoch: 15 cost time: 0.4524047374725342
Epoch: 15, Steps: 2 | Train Loss: 1.017 Vali Loss: 1.062 Vali Acc: 0.704 Test Loss: 1.062 Test Acc: 0.704
Validation loss decreased (-0.685174 --> -0.703693).  Saving model ...
Epoch: 16 cost time: 0.45684075355529785
Epoch: 16, Steps: 2 | Train Loss: 0.952 Vali Loss: 1.004 Vali Acc: 0.704 Test Loss: 1.004 Test Acc: 0.704
Validation loss decreased (-0.703693 --> -0.703694).  Saving model ...
Epoch: 17 cost time: 0.44918084144592285
Epoch: 17, Steps: 2 | Train Loss: 0.909 Vali Loss: 0.948 Vali Acc: 0.730 Test Loss: 0.948 Test Acc: 0.730
Validation loss decreased (-0.703694 --> -0.729620).  Saving model ...
Epoch: 18 cost time: 0.5045323371887207
Epoch: 18, Steps: 2 | Train Loss: 0.767 Vali Loss: 0.898 Vali Acc: 0.733 Test Loss: 0.898 Test Acc: 0.733
Validation loss decreased (-0.729620 --> -0.733324).  Saving model ...
Epoch: 19 cost time: 0.4327259063720703
Epoch: 19, Steps: 2 | Train Loss: 0.768 Vali Loss: 0.850 Vali Acc: 0.744 Test Loss: 0.850 Test Acc: 0.744
Validation loss decreased (-0.733324 --> -0.744436).  Saving model ...
Epoch: 20 cost time: 0.4724242687225342
Epoch: 20, Steps: 2 | Train Loss: 0.719 Vali Loss: 0.806 Vali Acc: 0.763 Test Loss: 0.806 Test Acc: 0.763
Validation loss decreased (-0.744436 --> -0.762955).  Saving model ...
Epoch: 21 cost time: 0.43198609352111816
Epoch: 21, Steps: 2 | Train Loss: 0.661 Vali Loss: 0.765 Vali Acc: 0.774 Test Loss: 0.765 Test Acc: 0.774
Validation loss decreased (-0.762955 --> -0.774066).  Saving model ...
Epoch: 22 cost time: 0.46065211296081543
Epoch: 22, Steps: 2 | Train Loss: 0.632 Vali Loss: 0.727 Vali Acc: 0.781 Test Loss: 0.727 Test Acc: 0.781
Validation loss decreased (-0.774066 --> -0.781474).  Saving model ...
Epoch: 23 cost time: 0.5175490379333496
Epoch: 23, Steps: 2 | Train Loss: 0.546 Vali Loss: 0.691 Vali Acc: 0.804 Test Loss: 0.691 Test Acc: 0.804
Validation loss decreased (-0.781474 --> -0.803697).  Saving model ...
Epoch: 24 cost time: 0.49214792251586914
Epoch: 24, Steps: 2 | Train Loss: 0.524 Vali Loss: 0.658 Vali Acc: 0.819 Test Loss: 0.658 Test Acc: 0.819
Validation loss decreased (-0.803697 --> -0.818512).  Saving model ...
Epoch: 25 cost time: 0.5156991481781006
Epoch: 25, Steps: 2 | Train Loss: 0.507 Vali Loss: 0.628 Vali Acc: 0.830 Test Loss: 0.628 Test Acc: 0.830
Validation loss decreased (-0.818512 --> -0.829623).  Saving model ...
Epoch: 26 cost time: 0.4688148498535156
Epoch: 26, Steps: 2 | Train Loss: 0.427 Vali Loss: 0.600 Vali Acc: 0.830 Test Loss: 0.600 Test Acc: 0.830
Validation loss decreased (-0.829623 --> -0.829624).  Saving model ...
Epoch: 27 cost time: 0.4658377170562744
Epoch: 27, Steps: 2 | Train Loss: 0.392 Vali Loss: 0.575 Vali Acc: 0.852 Test Loss: 0.575 Test Acc: 0.852
Validation loss decreased (-0.829624 --> -0.851846).  Saving model ...
Epoch: 28 cost time: 0.4585287570953369
Epoch: 28, Steps: 2 | Train Loss: 0.399 Vali Loss: 0.552 Vali Acc: 0.856 Test Loss: 0.552 Test Acc: 0.856
Validation loss decreased (-0.851846 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 0.4602837562561035
Epoch: 29, Steps: 2 | Train Loss: 0.342 Vali Loss: 0.531 Vali Acc: 0.859 Test Loss: 0.531 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 30 cost time: 0.4594709873199463
Epoch: 30, Steps: 2 | Train Loss: 0.335 Vali Loss: 0.513 Vali Acc: 0.859 Test Loss: 0.513 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 31 cost time: 0.47080039978027344
Epoch: 31, Steps: 2 | Train Loss: 0.308 Vali Loss: 0.497 Vali Acc: 0.859 Test Loss: 0.497 Test Acc: 0.859
Validation loss decreased (-0.859254 --> -0.859254).  Saving model ...
Epoch: 32 cost time: 0.4466698169708252
Epoch: 32, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.481 Vali Acc: 0.863 Test Loss: 0.481 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 33 cost time: 0.4598395824432373
Epoch: 33, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.468 Vali Acc: 0.863 Test Loss: 0.468 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 34 cost time: 0.41991567611694336
Epoch: 34, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.456 Vali Acc: 0.863 Test Loss: 0.456 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 35 cost time: 0.46963977813720703
Epoch: 35, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.445 Vali Acc: 0.874 Test Loss: 0.445 Test Acc: 0.874
Validation loss decreased (-0.862958 --> -0.874070).  Saving model ...
Epoch: 36 cost time: 0.47580909729003906
Epoch: 36, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.436 Vali Acc: 0.878 Test Loss: 0.436 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877773).  Saving model ...
Epoch: 37 cost time: 0.4856119155883789
Epoch: 37, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.428 Vali Acc: 0.893 Test Loss: 0.428 Test Acc: 0.893
Validation loss decreased (-0.877773 --> -0.892588).  Saving model ...
Epoch: 38 cost time: 0.4643137454986572
Epoch: 38, Steps: 2 | Train Loss: 0.239 Vali Loss: 0.421 Vali Acc: 0.889 Test Loss: 0.421 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.46027374267578125
Epoch: 39, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.414 Vali Acc: 0.896 Test Loss: 0.414 Test Acc: 0.896
Validation loss decreased (-0.892588 --> -0.896292).  Saving model ...
Epoch: 40 cost time: 0.47310352325439453
Epoch: 40, Steps: 2 | Train Loss: 0.173 Vali Loss: 0.407 Vali Acc: 0.893 Test Loss: 0.407 Test Acc: 0.893
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.4556295871734619
Epoch: 41, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.402 Vali Acc: 0.889 Test Loss: 0.402 Test Acc: 0.889
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.4898374080657959
Epoch: 42, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.396 Vali Acc: 0.889 Test Loss: 0.396 Test Acc: 0.889
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5013167858123779
Epoch: 43, Steps: 2 | Train Loss: 0.137 Vali Loss: 0.391 Vali Acc: 0.889 Test Loss: 0.391 Test Acc: 0.889
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.5262455940246582
Epoch: 44, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.387 Vali Acc: 0.889 Test Loss: 0.387 Test Acc: 0.889
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5196950435638428
Epoch: 45, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.383 Vali Acc: 0.878 Test Loss: 0.383 Test Acc: 0.878
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.4903244972229004
Epoch: 46, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.49313783645629883
Epoch: 47, Steps: 2 | Train Loss: 0.148 Vali Loss: 0.375 Vali Acc: 0.874 Test Loss: 0.375 Test Acc: 0.874
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.532468318939209
Epoch: 48, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.372 Vali Acc: 0.870 Test Loss: 0.372 Test Acc: 0.870
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.4999830722808838
Epoch: 49, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.370 Vali Acc: 0.874 Test Loss: 0.370 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8962962962962963
model parameter : 81126
model size : 0.93MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9660444259643555
Epoch: 1, Steps: 2 | Train Loss: 1.929 Vali Loss: 1.935 Vali Acc: 0.193 Test Loss: 1.935 Test Acc: 0.193
Validation loss decreased (inf --> -0.192573).  Saving model ...
Epoch: 2 cost time: 0.4253244400024414
Epoch: 2, Steps: 2 | Train Loss: 1.946 Vali Loss: 1.878 Vali Acc: 0.219 Test Loss: 1.878 Test Acc: 0.219
Validation loss decreased (-0.192573 --> -0.218500).  Saving model ...
Epoch: 3 cost time: 0.4595346450805664
Epoch: 3, Steps: 2 | Train Loss: 1.788 Vali Loss: 1.836 Vali Acc: 0.222 Test Loss: 1.836 Test Acc: 0.222
Validation loss decreased (-0.218500 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.45232439041137695
Epoch: 4, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.796 Vali Acc: 0.237 Test Loss: 1.796 Test Acc: 0.237
Validation loss decreased (-0.222204 --> -0.237019).  Saving model ...
Epoch: 5 cost time: 0.4531974792480469
Epoch: 5, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.745 Vali Acc: 0.241 Test Loss: 1.745 Test Acc: 0.241
Validation loss decreased (-0.237019 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.4670732021331787
Epoch: 6, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.686 Vali Acc: 0.252 Test Loss: 1.686 Test Acc: 0.252
Validation loss decreased (-0.240723 --> -0.251835).  Saving model ...
Epoch: 7 cost time: 0.48747920989990234
Epoch: 7, Steps: 2 | Train Loss: 1.515 Vali Loss: 1.620 Vali Acc: 0.281 Test Loss: 1.620 Test Acc: 0.281
Validation loss decreased (-0.251835 --> -0.281465).  Saving model ...
Epoch: 8 cost time: 0.5186302661895752
Epoch: 8, Steps: 2 | Train Loss: 1.574 Vali Loss: 1.548 Vali Acc: 0.315 Test Loss: 1.548 Test Acc: 0.315
Validation loss decreased (-0.281465 --> -0.314799).  Saving model ...
Epoch: 9 cost time: 0.5122387409210205
Epoch: 9, Steps: 2 | Train Loss: 1.377 Vali Loss: 1.473 Vali Acc: 0.367 Test Loss: 1.473 Test Acc: 0.367
Validation loss decreased (-0.314799 --> -0.366652).  Saving model ...
Epoch: 10 cost time: 0.5412650108337402
Epoch: 10, Steps: 2 | Train Loss: 1.345 Vali Loss: 1.397 Vali Acc: 0.400 Test Loss: 1.397 Test Acc: 0.400
Validation loss decreased (-0.366652 --> -0.399986).  Saving model ...
Epoch: 11 cost time: 0.5116186141967773
Epoch: 11, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.322 Vali Acc: 0.448 Test Loss: 1.322 Test Acc: 0.448
Validation loss decreased (-0.399986 --> -0.448135).  Saving model ...
Epoch: 12 cost time: 0.5049319267272949
Epoch: 12, Steps: 2 | Train Loss: 1.122 Vali Loss: 1.248 Vali Acc: 0.504 Test Loss: 1.248 Test Acc: 0.504
Validation loss decreased (-0.448135 --> -0.503691).  Saving model ...
Epoch: 13 cost time: 0.4803895950317383
Epoch: 13, Steps: 2 | Train Loss: 1.060 Vali Loss: 1.174 Vali Acc: 0.567 Test Loss: 1.174 Test Acc: 0.567
Validation loss decreased (-0.503691 --> -0.566655).  Saving model ...
Epoch: 14 cost time: 0.5045363903045654
Epoch: 14, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.100 Vali Acc: 0.622 Test Loss: 1.100 Test Acc: 0.622
Validation loss decreased (-0.566655 --> -0.622211).  Saving model ...
Epoch: 15 cost time: 0.5024194717407227
Epoch: 15, Steps: 2 | Train Loss: 0.901 Vali Loss: 1.029 Vali Acc: 0.659 Test Loss: 1.029 Test Acc: 0.659
Validation loss decreased (-0.622211 --> -0.659249).  Saving model ...
Epoch: 16 cost time: 0.527388334274292
Epoch: 16, Steps: 2 | Train Loss: 0.872 Vali Loss: 0.962 Vali Acc: 0.715 Test Loss: 0.962 Test Acc: 0.715
Validation loss decreased (-0.659249 --> -0.714805).  Saving model ...
Epoch: 17 cost time: 0.5454282760620117
Epoch: 17, Steps: 2 | Train Loss: 0.729 Vali Loss: 0.897 Vali Acc: 0.759 Test Loss: 0.897 Test Acc: 0.759
Validation loss decreased (-0.714805 --> -0.759250).  Saving model ...
Epoch: 18 cost time: 0.49915409088134766
Epoch: 18, Steps: 2 | Train Loss: 0.709 Vali Loss: 0.836 Vali Acc: 0.793 Test Loss: 0.836 Test Acc: 0.793
Validation loss decreased (-0.759250 --> -0.792584).  Saving model ...
Epoch: 19 cost time: 0.49770426750183105
Epoch: 19, Steps: 2 | Train Loss: 0.645 Vali Loss: 0.778 Vali Acc: 0.826 Test Loss: 0.778 Test Acc: 0.826
Validation loss decreased (-0.792584 --> -0.825918).  Saving model ...
Epoch: 20 cost time: 0.46583032608032227
Epoch: 20, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.724 Vali Acc: 0.848 Test Loss: 0.724 Test Acc: 0.848
Validation loss decreased (-0.825918 --> -0.848141).  Saving model ...
Epoch: 21 cost time: 0.37808871269226074
Epoch: 21, Steps: 2 | Train Loss: 0.451 Vali Loss: 0.674 Vali Acc: 0.867 Test Loss: 0.674 Test Acc: 0.867
Validation loss decreased (-0.848141 --> -0.866660).  Saving model ...
Epoch: 22 cost time: 0.4399096965789795
Epoch: 22, Steps: 2 | Train Loss: 0.453 Vali Loss: 0.628 Vali Acc: 0.870 Test Loss: 0.628 Test Acc: 0.870
Validation loss decreased (-0.866660 --> -0.870364).  Saving model ...
Epoch: 23 cost time: 0.4230353832244873
Epoch: 23, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.586 Vali Acc: 0.874 Test Loss: 0.586 Test Acc: 0.874
Validation loss decreased (-0.870364 --> -0.874068).  Saving model ...
Epoch: 24 cost time: 0.45610666275024414
Epoch: 24, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.548 Vali Acc: 0.885 Test Loss: 0.548 Test Acc: 0.885
Validation loss decreased (-0.874068 --> -0.885180).  Saving model ...
Epoch: 25 cost time: 0.43460583686828613
Epoch: 25, Steps: 2 | Train Loss: 0.350 Vali Loss: 0.513 Vali Acc: 0.896 Test Loss: 0.513 Test Acc: 0.896
Validation loss decreased (-0.885180 --> -0.896291).  Saving model ...
Epoch: 26 cost time: 0.463543176651001
Epoch: 26, Steps: 2 | Train Loss: 0.320 Vali Loss: 0.482 Vali Acc: 0.900 Test Loss: 0.482 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 27 cost time: 0.46004247665405273
Epoch: 27, Steps: 2 | Train Loss: 0.270 Vali Loss: 0.454 Vali Acc: 0.904 Test Loss: 0.454 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 28 cost time: 0.4514274597167969
Epoch: 28, Steps: 2 | Train Loss: 0.246 Vali Loss: 0.429 Vali Acc: 0.904 Test Loss: 0.429 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 29 cost time: 0.457003116607666
Epoch: 29, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.407 Vali Acc: 0.907 Test Loss: 0.407 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 30 cost time: 0.38515210151672363
Epoch: 30, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.388 Vali Acc: 0.911 Test Loss: 0.388 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.5256049633026123
Epoch: 31, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.371 Vali Acc: 0.915 Test Loss: 0.371 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.504422664642334
Epoch: 32, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.358 Vali Acc: 0.911 Test Loss: 0.358 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5171918869018555
Epoch: 33, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.346 Vali Acc: 0.915 Test Loss: 0.346 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 34 cost time: 0.5013806819915771
Epoch: 34, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.333 Vali Acc: 0.919 Test Loss: 0.333 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.5065350532531738
Epoch: 35, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.323 Vali Acc: 0.911 Test Loss: 0.323 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.5110759735107422
Epoch: 36, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.315 Vali Acc: 0.911 Test Loss: 0.315 Test Acc: 0.911
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.4892995357513428
Epoch: 37, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.306 Vali Acc: 0.911 Test Loss: 0.306 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.4648551940917969
Epoch: 38, Steps: 2 | Train Loss: 0.091 Vali Loss: 0.298 Vali Acc: 0.911 Test Loss: 0.298 Test Acc: 0.911
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.4988670349121094
Epoch: 39, Steps: 2 | Train Loss: 0.090 Vali Loss: 0.290 Vali Acc: 0.915 Test Loss: 0.290 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.5238862037658691
Epoch: 40, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.284 Vali Acc: 0.915 Test Loss: 0.284 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.509023904800415
Epoch: 41, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.279 Vali Acc: 0.915 Test Loss: 0.279 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.47642064094543457
Epoch: 42, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.273 Vali Acc: 0.922 Test Loss: 0.273 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 43 cost time: 0.49413275718688965
Epoch: 43, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.267 Vali Acc: 0.926 Test Loss: 0.267 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 44 cost time: 0.5075845718383789
Epoch: 44, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 45 cost time: 0.4904296398162842
Epoch: 45, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.5134360790252686
Epoch: 46, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.253 Vali Acc: 0.930 Test Loss: 0.253 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.4538919925689697
Epoch: 47, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.516711950302124
Epoch: 48, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.247 Vali Acc: 0.930 Test Loss: 0.247 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.47405147552490234
Epoch: 49, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 0.4746520519256592
Epoch: 50, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.241 Vali Acc: 0.933 Test Loss: 0.241 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 51 cost time: 0.5067439079284668
Epoch: 51, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.239 Vali Acc: 0.933 Test Loss: 0.239 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 0.47332191467285156
Epoch: 52, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 0.5183753967285156
Epoch: 53, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.46854138374328613
Epoch: 54, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.235 Vali Acc: 0.933 Test Loss: 0.235 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.47626328468322754
Epoch: 55, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.5027925968170166
Epoch: 56, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.5453500747680664
Epoch: 57, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.230 Vali Acc: 0.933 Test Loss: 0.230 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.5266075134277344
Epoch: 58, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.228 Vali Acc: 0.933 Test Loss: 0.228 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.5352492332458496
Epoch: 59, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.933 Test Loss: 0.227 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.5098443031311035
Epoch: 60, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.5167267322540283
Epoch: 61, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.5215301513671875
Epoch: 62, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.223 Vali Acc: 0.933 Test Loss: 0.223 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.49765801429748535
Epoch: 63, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.5235311985015869
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.474611759185791
Epoch: 65, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.5229992866516113
Epoch: 66, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 0.5234270095825195
Epoch: 67, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 68 cost time: 0.48755884170532227
Epoch: 68, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 69 cost time: 0.5361886024475098
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 70 cost time: 0.5167386531829834
Epoch: 70, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 71 cost time: 0.4988675117492676
Epoch: 71, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 72 cost time: 0.5057840347290039
Epoch: 72, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 73 cost time: 0.49271368980407715
Epoch: 73, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 74 cost time: 0.5191555023193359
Epoch: 74, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 75 cost time: 0.504356861114502
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 76 cost time: 0.46876001358032227
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 1 out of 10
Epoch: 77 cost time: 0.46022796630859375
Epoch: 77, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 78 cost time: 0.4588305950164795
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.212 Vali Acc: 0.930 Test Loss: 0.212 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 79 cost time: 0.47714662551879883
Epoch: 79, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 80 cost time: 0.47829389572143555
Epoch: 80, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.211 Vali Acc: 0.930 Test Loss: 0.211 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 81 cost time: 0.4426100254058838
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.210 Vali Acc: 0.930 Test Loss: 0.210 Test Acc: 0.930
EarlyStopping counter: 6 out of 10
Epoch: 82 cost time: 0.4932119846343994
Epoch: 82, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 7 out of 10
Epoch: 83 cost time: 0.5271644592285156
Epoch: 83, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.209 Vali Acc: 0.930 Test Loss: 0.209 Test Acc: 0.930
EarlyStopping counter: 8 out of 10
Epoch: 84 cost time: 0.5518505573272705
Epoch: 84, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.208 Vali Acc: 0.930 Test Loss: 0.208 Test Acc: 0.930
EarlyStopping counter: 9 out of 10
Epoch: 85 cost time: 0.4890782833099365
Epoch: 85, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.207 Vali Acc: 0.930 Test Loss: 0.207 Test Acc: 0.930
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9333333333333333
model parameter : 48358
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.194777488708496
Epoch: 1, Steps: 2 | Train Loss: 1.925 Vali Loss: 1.921 Vali Acc: 0.193 Test Loss: 1.921 Test Acc: 0.193
Validation loss decreased (inf --> -0.192573).  Saving model ...
Epoch: 2 cost time: 0.46791577339172363
Epoch: 2, Steps: 2 | Train Loss: 1.943 Vali Loss: 1.863 Vali Acc: 0.207 Test Loss: 1.863 Test Acc: 0.207
Validation loss decreased (-0.192573 --> -0.207389).  Saving model ...
Epoch: 3 cost time: 0.44580626487731934
Epoch: 3, Steps: 2 | Train Loss: 1.803 Vali Loss: 1.821 Vali Acc: 0.222 Test Loss: 1.821 Test Acc: 0.222
Validation loss decreased (-0.207389 --> -0.222204).  Saving model ...
Epoch: 4 cost time: 0.39833521842956543
Epoch: 4, Steps: 2 | Train Loss: 1.736 Vali Loss: 1.782 Vali Acc: 0.230 Test Loss: 1.782 Test Acc: 0.230
Validation loss decreased (-0.222204 --> -0.229612).  Saving model ...
Epoch: 5 cost time: 0.4634394645690918
Epoch: 5, Steps: 2 | Train Loss: 1.681 Vali Loss: 1.731 Vali Acc: 0.241 Test Loss: 1.731 Test Acc: 0.241
Validation loss decreased (-0.229612 --> -0.240723).  Saving model ...
Epoch: 6 cost time: 0.4868757724761963
Epoch: 6, Steps: 2 | Train Loss: 1.675 Vali Loss: 1.672 Vali Acc: 0.259 Test Loss: 1.672 Test Acc: 0.259
Validation loss decreased (-0.240723 --> -0.259243).  Saving model ...
Epoch: 7 cost time: 0.42595553398132324
Epoch: 7, Steps: 2 | Train Loss: 1.513 Vali Loss: 1.606 Vali Acc: 0.285 Test Loss: 1.606 Test Acc: 0.285
Validation loss decreased (-0.259243 --> -0.285169).  Saving model ...
Epoch: 8 cost time: 0.468778133392334
Epoch: 8, Steps: 2 | Train Loss: 1.557 Vali Loss: 1.534 Vali Acc: 0.322 Test Loss: 1.534 Test Acc: 0.322
Validation loss decreased (-0.285169 --> -0.322207).  Saving model ...
Epoch: 9 cost time: 0.4938347339630127
Epoch: 9, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.459 Vali Acc: 0.374 Test Loss: 1.459 Test Acc: 0.374
Validation loss decreased (-0.322207 --> -0.374059).  Saving model ...
Epoch: 10 cost time: 0.4412405490875244
Epoch: 10, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.384 Vali Acc: 0.411 Test Loss: 1.384 Test Acc: 0.411
Validation loss decreased (-0.374059 --> -0.411097).  Saving model ...
Epoch: 11 cost time: 0.527897834777832
Epoch: 11, Steps: 2 | Train Loss: 1.274 Vali Loss: 1.309 Vali Acc: 0.456 Test Loss: 1.309 Test Acc: 0.456
Validation loss decreased (-0.411097 --> -0.455542).  Saving model ...
Epoch: 12 cost time: 0.5133397579193115
Epoch: 12, Steps: 2 | Train Loss: 1.124 Vali Loss: 1.235 Vali Acc: 0.526 Test Loss: 1.235 Test Acc: 0.526
Validation loss decreased (-0.455542 --> -0.525914).  Saving model ...
Epoch: 13 cost time: 0.5058085918426514
Epoch: 13, Steps: 2 | Train Loss: 1.075 Vali Loss: 1.162 Vali Acc: 0.596 Test Loss: 1.162 Test Acc: 0.596
Validation loss decreased (-0.525914 --> -0.596285).  Saving model ...
Epoch: 14 cost time: 0.510918378829956
Epoch: 14, Steps: 2 | Train Loss: 0.934 Vali Loss: 1.089 Vali Acc: 0.633 Test Loss: 1.089 Test Acc: 0.633
Validation loss decreased (-0.596285 --> -0.633322).  Saving model ...
Epoch: 15 cost time: 0.5429160594940186
Epoch: 15, Steps: 2 | Train Loss: 0.938 Vali Loss: 1.019 Vali Acc: 0.693 Test Loss: 1.019 Test Acc: 0.693
Validation loss decreased (-0.633322 --> -0.692582).  Saving model ...
Epoch: 16 cost time: 0.45633411407470703
Epoch: 16, Steps: 2 | Train Loss: 0.886 Vali Loss: 0.952 Vali Acc: 0.726 Test Loss: 0.952 Test Acc: 0.726
Validation loss decreased (-0.692582 --> -0.725916).  Saving model ...
Epoch: 17 cost time: 0.5124547481536865
Epoch: 17, Steps: 2 | Train Loss: 0.758 Vali Loss: 0.888 Vali Acc: 0.774 Test Loss: 0.888 Test Acc: 0.774
Validation loss decreased (-0.725916 --> -0.774065).  Saving model ...
Epoch: 18 cost time: 0.5100035667419434
Epoch: 18, Steps: 2 | Train Loss: 0.734 Vali Loss: 0.827 Vali Acc: 0.800 Test Loss: 0.827 Test Acc: 0.800
Validation loss decreased (-0.774065 --> -0.799992).  Saving model ...
Epoch: 19 cost time: 0.5549683570861816
Epoch: 19, Steps: 2 | Train Loss: 0.648 Vali Loss: 0.770 Vali Acc: 0.830 Test Loss: 0.770 Test Acc: 0.830
Validation loss decreased (-0.799992 --> -0.829622).  Saving model ...
Epoch: 20 cost time: 0.5659372806549072
Epoch: 20, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.716 Vali Acc: 0.852 Test Loss: 0.716 Test Acc: 0.852
Validation loss decreased (-0.829622 --> -0.851845).  Saving model ...
Epoch: 21 cost time: 0.5028622150421143
Epoch: 21, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.667 Vali Acc: 0.870 Test Loss: 0.667 Test Acc: 0.870
Validation loss decreased (-0.851845 --> -0.870364).  Saving model ...
Epoch: 22 cost time: 0.46292567253112793
Epoch: 22, Steps: 2 | Train Loss: 0.463 Vali Loss: 0.621 Vali Acc: 0.889 Test Loss: 0.621 Test Acc: 0.889
Validation loss decreased (-0.870364 --> -0.888883).  Saving model ...
Epoch: 23 cost time: 0.5107150077819824
Epoch: 23, Steps: 2 | Train Loss: 0.423 Vali Loss: 0.580 Vali Acc: 0.896 Test Loss: 0.580 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896290).  Saving model ...
Epoch: 24 cost time: 0.514108419418335
Epoch: 24, Steps: 2 | Train Loss: 0.354 Vali Loss: 0.542 Vali Acc: 0.900 Test Loss: 0.542 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899995).  Saving model ...
Epoch: 25 cost time: 0.4619622230529785
Epoch: 25, Steps: 2 | Train Loss: 0.372 Vali Loss: 0.508 Vali Acc: 0.904 Test Loss: 0.508 Test Acc: 0.904
Validation loss decreased (-0.899995 --> -0.903699).  Saving model ...
Epoch: 26 cost time: 0.4495563507080078
Epoch: 26, Steps: 2 | Train Loss: 0.332 Vali Loss: 0.477 Vali Acc: 0.904 Test Loss: 0.477 Test Acc: 0.904
Validation loss decreased (-0.903699 --> -0.903699).  Saving model ...
Epoch: 27 cost time: 0.5224556922912598
Epoch: 27, Steps: 2 | Train Loss: 0.286 Vali Loss: 0.450 Vali Acc: 0.907 Test Loss: 0.450 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 0.48804664611816406
Epoch: 28, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.425 Vali Acc: 0.907 Test Loss: 0.425 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 29 cost time: 0.4895639419555664
Epoch: 29, Steps: 2 | Train Loss: 0.207 Vali Loss: 0.403 Vali Acc: 0.911 Test Loss: 0.403 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.46653032302856445
Epoch: 30, Steps: 2 | Train Loss: 0.191 Vali Loss: 0.384 Vali Acc: 0.911 Test Loss: 0.384 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.5210697650909424
Epoch: 31, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.368 Vali Acc: 0.907 Test Loss: 0.368 Test Acc: 0.907
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 0.5141544342041016
Epoch: 32, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.354 Vali Acc: 0.911 Test Loss: 0.354 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911108).  Saving model ...
Epoch: 33 cost time: 0.49804043769836426
Epoch: 33, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.342 Vali Acc: 0.911 Test Loss: 0.342 Test Acc: 0.911
Validation loss decreased (-0.911108 --> -0.911108).  Saving model ...
Epoch: 34 cost time: 0.5234947204589844
Epoch: 34, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.330 Vali Acc: 0.915 Test Loss: 0.330 Test Acc: 0.915
Validation loss decreased (-0.911108 --> -0.914812).  Saving model ...
Epoch: 35 cost time: 0.47818827629089355
Epoch: 35, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.319 Vali Acc: 0.915 Test Loss: 0.319 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 36 cost time: 0.5268123149871826
Epoch: 36, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.544292688369751
Epoch: 37, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.302 Vali Acc: 0.915 Test Loss: 0.302 Test Acc: 0.915
Validation loss decreased (-0.914812 --> -0.914812).  Saving model ...
Epoch: 38 cost time: 0.5367460250854492
Epoch: 38, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.294 Vali Acc: 0.919 Test Loss: 0.294 Test Acc: 0.919
Validation loss decreased (-0.914812 --> -0.918516).  Saving model ...
Epoch: 39 cost time: 0.5327978134155273
Epoch: 39, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.286 Vali Acc: 0.919 Test Loss: 0.286 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 40 cost time: 0.5428202152252197
Epoch: 40, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.280 Vali Acc: 0.919 Test Loss: 0.280 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 41 cost time: 0.46764230728149414
Epoch: 41, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.275 Vali Acc: 0.919 Test Loss: 0.275 Test Acc: 0.919
Validation loss decreased (-0.918516 --> -0.918516).  Saving model ...
Epoch: 42 cost time: 0.5089254379272461
Epoch: 42, Steps: 2 | Train Loss: 0.080 Vali Loss: 0.270 Vali Acc: 0.922 Test Loss: 0.270 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922220).  Saving model ...
Epoch: 43 cost time: 0.5194704532623291
Epoch: 43, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.264 Vali Acc: 0.930 Test Loss: 0.264 Test Acc: 0.930
Validation loss decreased (-0.922220 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.5679919719696045
Epoch: 44, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.260 Vali Acc: 0.926 Test Loss: 0.260 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 45 cost time: 0.5339772701263428
Epoch: 45, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.256 Vali Acc: 0.922 Test Loss: 0.256 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 46 cost time: 0.5708069801330566
Epoch: 46, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.252 Vali Acc: 0.922 Test Loss: 0.252 Test Acc: 0.922
EarlyStopping counter: 3 out of 10
Epoch: 47 cost time: 0.5271890163421631
Epoch: 47, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.249 Vali Acc: 0.922 Test Loss: 0.249 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 48 cost time: 0.5108447074890137
Epoch: 48, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.246 Vali Acc: 0.922 Test Loss: 0.246 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 49 cost time: 0.5017979145050049
Epoch: 49, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.243 Vali Acc: 0.922 Test Loss: 0.243 Test Acc: 0.922
EarlyStopping counter: 6 out of 10
Epoch: 50 cost time: 0.5530312061309814
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.241 Vali Acc: 0.922 Test Loss: 0.241 Test Acc: 0.922
EarlyStopping counter: 7 out of 10
Epoch: 51 cost time: 0.5117099285125732
Epoch: 51, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.238 Vali Acc: 0.922 Test Loss: 0.238 Test Acc: 0.922
EarlyStopping counter: 8 out of 10
Epoch: 52 cost time: 0.49735379219055176
Epoch: 52, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.237 Vali Acc: 0.926 Test Loss: 0.237 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 53 cost time: 0.5375723838806152
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.235 Vali Acc: 0.926 Test Loss: 0.235 Test Acc: 0.926
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 48358
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1534955501556396
Epoch: 1, Steps: 2 | Train Loss: 1.960 Vali Loss: 1.933 Vali Acc: 0.189 Test Loss: 1.933 Test Acc: 0.189
Validation loss decreased (inf --> -0.188870).  Saving model ...
Epoch: 2 cost time: 0.4359626770019531
Epoch: 2, Steps: 2 | Train Loss: 1.959 Vali Loss: 1.876 Vali Acc: 0.215 Test Loss: 1.876 Test Acc: 0.215
Validation loss decreased (-0.188870 --> -0.214796).  Saving model ...
Epoch: 3 cost time: 0.5020334720611572
Epoch: 3, Steps: 2 | Train Loss: 1.828 Vali Loss: 1.834 Vali Acc: 0.233 Test Loss: 1.834 Test Acc: 0.233
Validation loss decreased (-0.214796 --> -0.233315).  Saving model ...
Epoch: 4 cost time: 0.5205039978027344
Epoch: 4, Steps: 2 | Train Loss: 1.777 Vali Loss: 1.795 Vali Acc: 0.248 Test Loss: 1.795 Test Acc: 0.248
Validation loss decreased (-0.233315 --> -0.248130).  Saving model ...
Epoch: 5 cost time: 0.48992133140563965
Epoch: 5, Steps: 2 | Train Loss: 1.703 Vali Loss: 1.744 Vali Acc: 0.267 Test Loss: 1.744 Test Acc: 0.267
Validation loss decreased (-0.248130 --> -0.266649).  Saving model ...
Epoch: 6 cost time: 0.4924285411834717
Epoch: 6, Steps: 2 | Train Loss: 1.740 Vali Loss: 1.686 Vali Acc: 0.289 Test Loss: 1.686 Test Acc: 0.289
Validation loss decreased (-0.266649 --> -0.288872).  Saving model ...
Epoch: 7 cost time: 0.48816537857055664
Epoch: 7, Steps: 2 | Train Loss: 1.585 Vali Loss: 1.621 Vali Acc: 0.311 Test Loss: 1.621 Test Acc: 0.311
Validation loss decreased (-0.288872 --> -0.311095).  Saving model ...
Epoch: 8 cost time: 0.43442511558532715
Epoch: 8, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.550 Vali Acc: 0.337 Test Loss: 1.550 Test Acc: 0.337
Validation loss decreased (-0.311095 --> -0.337022).  Saving model ...
Epoch: 9 cost time: 0.5131776332855225
Epoch: 9, Steps: 2 | Train Loss: 1.478 Vali Loss: 1.477 Vali Acc: 0.367 Test Loss: 1.477 Test Acc: 0.367
Validation loss decreased (-0.337022 --> -0.366652).  Saving model ...
Epoch: 10 cost time: 0.5612070560455322
Epoch: 10, Steps: 2 | Train Loss: 1.433 Vali Loss: 1.402 Vali Acc: 0.396 Test Loss: 1.402 Test Acc: 0.396
Validation loss decreased (-0.366652 --> -0.396282).  Saving model ...
Epoch: 11 cost time: 0.5489704608917236
Epoch: 11, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.327 Vali Acc: 0.433 Test Loss: 1.327 Test Acc: 0.433
Validation loss decreased (-0.396282 --> -0.433320).  Saving model ...
Epoch: 12 cost time: 0.4536619186401367
Epoch: 12, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.254 Vali Acc: 0.481 Test Loss: 1.254 Test Acc: 0.481
Validation loss decreased (-0.433320 --> -0.481469).  Saving model ...
Epoch: 13 cost time: 0.4817829132080078
Epoch: 13, Steps: 2 | Train Loss: 1.130 Vali Loss: 1.182 Vali Acc: 0.522 Test Loss: 1.182 Test Acc: 0.522
Validation loss decreased (-0.481469 --> -0.522210).  Saving model ...
Epoch: 14 cost time: 0.443636417388916
Epoch: 14, Steps: 2 | Train Loss: 1.000 Vali Loss: 1.109 Vali Acc: 0.604 Test Loss: 1.109 Test Acc: 0.604
Validation loss decreased (-0.522210 --> -0.603693).  Saving model ...
Epoch: 15 cost time: 0.48369550704956055
Epoch: 15, Steps: 2 | Train Loss: 1.001 Vali Loss: 1.040 Vali Acc: 0.667 Test Loss: 1.040 Test Acc: 0.667
Validation loss decreased (-0.603693 --> -0.666656).  Saving model ...
Epoch: 16 cost time: 0.46768808364868164
Epoch: 16, Steps: 2 | Train Loss: 0.931 Vali Loss: 0.973 Vali Acc: 0.715 Test Loss: 0.973 Test Acc: 0.715
Validation loss decreased (-0.666656 --> -0.714805).  Saving model ...
Epoch: 17 cost time: 0.44919896125793457
Epoch: 17, Steps: 2 | Train Loss: 0.820 Vali Loss: 0.909 Vali Acc: 0.744 Test Loss: 0.909 Test Acc: 0.744
Validation loss decreased (-0.714805 --> -0.744435).  Saving model ...
Epoch: 18 cost time: 0.3736536502838135
Epoch: 18, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.849 Vali Acc: 0.781 Test Loss: 0.849 Test Acc: 0.781
Validation loss decreased (-0.744435 --> -0.781473).  Saving model ...
Epoch: 19 cost time: 0.43675923347473145
Epoch: 19, Steps: 2 | Train Loss: 0.670 Vali Loss: 0.792 Vali Acc: 0.807 Test Loss: 0.792 Test Acc: 0.807
Validation loss decreased (-0.781473 --> -0.807399).  Saving model ...
Epoch: 20 cost time: 0.4369196891784668
Epoch: 20, Steps: 2 | Train Loss: 0.592 Vali Loss: 0.738 Vali Acc: 0.826 Test Loss: 0.738 Test Acc: 0.826
Validation loss decreased (-0.807399 --> -0.825919).  Saving model ...
Epoch: 21 cost time: 0.44083619117736816
Epoch: 21, Steps: 2 | Train Loss: 0.519 Vali Loss: 0.689 Vali Acc: 0.852 Test Loss: 0.689 Test Acc: 0.852
Validation loss decreased (-0.825919 --> -0.851845).  Saving model ...
Epoch: 22 cost time: 0.4451265335083008
Epoch: 22, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.644 Vali Acc: 0.874 Test Loss: 0.644 Test Acc: 0.874
Validation loss decreased (-0.851845 --> -0.874068).  Saving model ...
Epoch: 23 cost time: 0.45702147483825684
Epoch: 23, Steps: 2 | Train Loss: 0.455 Vali Loss: 0.602 Vali Acc: 0.889 Test Loss: 0.602 Test Acc: 0.889
Validation loss decreased (-0.874068 --> -0.888883).  Saving model ...
Epoch: 24 cost time: 0.45319437980651855
Epoch: 24, Steps: 2 | Train Loss: 0.407 Vali Loss: 0.564 Vali Acc: 0.896 Test Loss: 0.564 Test Acc: 0.896
Validation loss decreased (-0.888883 --> -0.896291).  Saving model ...
Epoch: 25 cost time: 0.493023157119751
Epoch: 25, Steps: 2 | Train Loss: 0.417 Vali Loss: 0.530 Vali Acc: 0.896 Test Loss: 0.530 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 26 cost time: 0.4756355285644531
Epoch: 26, Steps: 2 | Train Loss: 0.369 Vali Loss: 0.500 Vali Acc: 0.896 Test Loss: 0.500 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 27 cost time: 0.46770763397216797
Epoch: 27, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.472 Vali Acc: 0.900 Test Loss: 0.472 Test Acc: 0.900
Validation loss decreased (-0.896291 --> -0.899995).  Saving model ...
Epoch: 28 cost time: 0.5593914985656738
Epoch: 28, Steps: 2 | Train Loss: 0.282 Vali Loss: 0.447 Vali Acc: 0.900 Test Loss: 0.447 Test Acc: 0.900
Validation loss decreased (-0.899995 --> -0.899996).  Saving model ...
Epoch: 29 cost time: 0.5143797397613525
Epoch: 29, Steps: 2 | Train Loss: 0.243 Vali Loss: 0.424 Vali Acc: 0.904 Test Loss: 0.424 Test Acc: 0.904
Validation loss decreased (-0.899996 --> -0.903699).  Saving model ...
Epoch: 30 cost time: 0.5479021072387695
Epoch: 30, Steps: 2 | Train Loss: 0.230 Vali Loss: 0.404 Vali Acc: 0.907 Test Loss: 0.404 Test Acc: 0.907
Validation loss decreased (-0.903699 --> -0.907403).  Saving model ...
Epoch: 31 cost time: 0.5170412063598633
Epoch: 31, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.387 Vali Acc: 0.915 Test Loss: 0.387 Test Acc: 0.915
Validation loss decreased (-0.907403 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.5843489170074463
Epoch: 32, Steps: 2 | Train Loss: 0.194 Vali Loss: 0.373 Vali Acc: 0.915 Test Loss: 0.373 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.48628973960876465
Epoch: 33, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.360 Vali Acc: 0.919 Test Loss: 0.360 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 34 cost time: 0.5547378063201904
Epoch: 34, Steps: 2 | Train Loss: 0.179 Vali Loss: 0.348 Vali Acc: 0.919 Test Loss: 0.348 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.4881751537322998
Epoch: 35, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.337 Vali Acc: 0.919 Test Loss: 0.337 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 36 cost time: 0.5069215297698975
Epoch: 36, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.328 Vali Acc: 0.911 Test Loss: 0.328 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5054795742034912
Epoch: 37, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.319 Vali Acc: 0.907 Test Loss: 0.319 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.45607686042785645
Epoch: 38, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.310 Vali Acc: 0.911 Test Loss: 0.310 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 0.44762086868286133
Epoch: 39, Steps: 2 | Train Loss: 0.122 Vali Loss: 0.303 Vali Acc: 0.915 Test Loss: 0.303 Test Acc: 0.915
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 0.45479607582092285
Epoch: 40, Steps: 2 | Train Loss: 0.109 Vali Loss: 0.297 Vali Acc: 0.915 Test Loss: 0.297 Test Acc: 0.915
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 0.4871799945831299
Epoch: 41, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.291 Vali Acc: 0.915 Test Loss: 0.291 Test Acc: 0.915
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 0.4714317321777344
Epoch: 42, Steps: 2 | Train Loss: 0.099 Vali Loss: 0.286 Vali Acc: 0.915 Test Loss: 0.286 Test Acc: 0.915
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 0.46642518043518066
Epoch: 43, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.281 Vali Acc: 0.919 Test Loss: 0.281 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918516).  Saving model ...
Epoch: 44 cost time: 0.46605348587036133
Epoch: 44, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.277 Vali Acc: 0.922 Test Loss: 0.277 Test Acc: 0.922
Validation loss decreased (-0.918516 --> -0.922219).  Saving model ...
Epoch: 45 cost time: 0.4586043357849121
Epoch: 45, Steps: 2 | Train Loss: 0.087 Vali Loss: 0.273 Vali Acc: 0.930 Test Loss: 0.273 Test Acc: 0.930
Validation loss decreased (-0.922219 --> -0.929627).  Saving model ...
Epoch: 46 cost time: 0.49307894706726074
Epoch: 46, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.269 Vali Acc: 0.930 Test Loss: 0.269 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 47 cost time: 0.5349419116973877
Epoch: 47, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.266 Vali Acc: 0.930 Test Loss: 0.266 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 48 cost time: 0.5446033477783203
Epoch: 48, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.263 Vali Acc: 0.930 Test Loss: 0.263 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 49 cost time: 0.5292758941650391
Epoch: 49, Steps: 2 | Train Loss: 0.066 Vali Loss: 0.260 Vali Acc: 0.930 Test Loss: 0.260 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 50 cost time: 0.511681079864502
Epoch: 50, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.257 Vali Acc: 0.930 Test Loss: 0.257 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 51 cost time: 0.5280752182006836
Epoch: 51, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.255 Vali Acc: 0.930 Test Loss: 0.255 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 52 cost time: 0.5299372673034668
Epoch: 52, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 53 cost time: 0.5175144672393799
Epoch: 53, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.252 Vali Acc: 0.930 Test Loss: 0.252 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 54 cost time: 0.5704090595245361
Epoch: 54, Steps: 2 | Train Loss: 0.049 Vali Loss: 0.250 Vali Acc: 0.926 Test Loss: 0.250 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 55 cost time: 0.5373885631561279
Epoch: 55, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.248 Vali Acc: 0.926 Test Loss: 0.248 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 56 cost time: 0.5527048110961914
Epoch: 56, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.246 Vali Acc: 0.930 Test Loss: 0.246 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 57 cost time: 0.5666365623474121
Epoch: 57, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.244 Vali Acc: 0.930 Test Loss: 0.244 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 58 cost time: 0.5690269470214844
Epoch: 58, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.242 Vali Acc: 0.930 Test Loss: 0.242 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 59 cost time: 0.6244285106658936
Epoch: 59, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.240 Vali Acc: 0.930 Test Loss: 0.240 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 60 cost time: 0.5731699466705322
Epoch: 60, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.238 Vali Acc: 0.930 Test Loss: 0.238 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 61 cost time: 0.5684680938720703
Epoch: 61, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.236 Vali Acc: 0.930 Test Loss: 0.236 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 62 cost time: 0.5012953281402588
Epoch: 62, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.235 Vali Acc: 0.930 Test Loss: 0.235 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 63 cost time: 0.48219728469848633
Epoch: 63, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.234 Vali Acc: 0.930 Test Loss: 0.234 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 64 cost time: 0.45830202102661133
Epoch: 64, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.233 Vali Acc: 0.930 Test Loss: 0.233 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 65 cost time: 0.47646331787109375
Epoch: 65, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.231 Vali Acc: 0.930 Test Loss: 0.231 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 66 cost time: 0.4997873306274414
Epoch: 66, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.230 Vali Acc: 0.930 Test Loss: 0.230 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 67 cost time: 0.4945640563964844
Epoch: 67, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.229 Vali Acc: 0.930 Test Loss: 0.229 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 68 cost time: 0.5204050540924072
Epoch: 68, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 69 cost time: 0.5098319053649902
Epoch: 69, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.228 Vali Acc: 0.930 Test Loss: 0.228 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 70 cost time: 0.4799513816833496
Epoch: 70, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 71 cost time: 0.5456671714782715
Epoch: 71, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 72 cost time: 0.5902194976806641
Epoch: 72, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.227 Vali Acc: 0.930 Test Loss: 0.227 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 73 cost time: 0.5433568954467773
Epoch: 73, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 74 cost time: 0.5279076099395752
Epoch: 74, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.226 Vali Acc: 0.930 Test Loss: 0.226 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 75 cost time: 0.5684576034545898
Epoch: 75, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 76 cost time: 0.5622007846832275
Epoch: 76, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.225 Vali Acc: 0.930 Test Loss: 0.225 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 77 cost time: 0.5529475212097168
Epoch: 77, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.224 Vali Acc: 0.930 Test Loss: 0.224 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 78 cost time: 0.5079376697540283
Epoch: 78, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 79 cost time: 0.5002486705780029
Epoch: 79, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.223 Vali Acc: 0.930 Test Loss: 0.223 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 80 cost time: 0.51554274559021
Epoch: 80, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 81 cost time: 0.5213706493377686
Epoch: 81, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.222 Vali Acc: 0.930 Test Loss: 0.222 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 82 cost time: 0.507805347442627
Epoch: 82, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.930 Test Loss: 0.221 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 83 cost time: 0.5021703243255615
Epoch: 83, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.221 Vali Acc: 0.926 Test Loss: 0.221 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 84 cost time: 0.5067729949951172
Epoch: 84, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.220 Vali Acc: 0.926 Test Loss: 0.220 Test Acc: 0.926
EarlyStopping counter: 2 out of 10
Epoch: 85 cost time: 0.5126993656158447
Epoch: 85, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 3 out of 10
Epoch: 86 cost time: 0.5109918117523193
Epoch: 86, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 4 out of 10
Epoch: 87 cost time: 0.44669032096862793
Epoch: 87, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 5 out of 10
Epoch: 88 cost time: 0.4595818519592285
Epoch: 88, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.219 Vali Acc: 0.926 Test Loss: 0.219 Test Acc: 0.926
EarlyStopping counter: 6 out of 10
Epoch: 89 cost time: 0.43798828125
Epoch: 89, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 7 out of 10
Epoch: 90 cost time: 0.4365570545196533
Epoch: 90, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 8 out of 10
Epoch: 91 cost time: 0.5223360061645508
Epoch: 91, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.926 Test Loss: 0.218 Test Acc: 0.926
EarlyStopping counter: 9 out of 10
Epoch: 92 cost time: 0.49800610542297363
Epoch: 92, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.217 Vali Acc: 0.922 Test Loss: 0.217 Test Acc: 0.922
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9296296296296296
model parameter : 48358
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.027886152267456
Epoch: 1, Steps: 2 | Train Loss: 1.956 Vali Loss: 1.937 Vali Acc: 0.174 Test Loss: 1.937 Test Acc: 0.174
Validation loss decreased (inf --> -0.174055).  Saving model ...
Epoch: 2 cost time: 0.47214746475219727
Epoch: 2, Steps: 2 | Train Loss: 1.975 Vali Loss: 1.882 Vali Acc: 0.196 Test Loss: 1.882 Test Acc: 0.196
Validation loss decreased (-0.174055 --> -0.196277).  Saving model ...
Epoch: 3 cost time: 0.42405009269714355
Epoch: 3, Steps: 2 | Train Loss: 1.892 Vali Loss: 1.843 Vali Acc: 0.200 Test Loss: 1.843 Test Acc: 0.200
Validation loss decreased (-0.196277 --> -0.199982).  Saving model ...
Epoch: 4 cost time: 0.4512944221496582
Epoch: 4, Steps: 2 | Train Loss: 1.808 Vali Loss: 1.807 Vali Acc: 0.204 Test Loss: 1.807 Test Acc: 0.204
Validation loss decreased (-0.199982 --> -0.203686).  Saving model ...
Epoch: 5 cost time: 0.5047190189361572
Epoch: 5, Steps: 2 | Train Loss: 1.732 Vali Loss: 1.761 Vali Acc: 0.222 Test Loss: 1.761 Test Acc: 0.222
Validation loss decreased (-0.203686 --> -0.222205).  Saving model ...
Epoch: 6 cost time: 0.4813652038574219
Epoch: 6, Steps: 2 | Train Loss: 1.751 Vali Loss: 1.707 Vali Acc: 0.230 Test Loss: 1.707 Test Acc: 0.230
Validation loss decreased (-0.222205 --> -0.229613).  Saving model ...
Epoch: 7 cost time: 0.4687812328338623
Epoch: 7, Steps: 2 | Train Loss: 1.665 Vali Loss: 1.647 Vali Acc: 0.252 Test Loss: 1.647 Test Acc: 0.252
Validation loss decreased (-0.229613 --> -0.251835).  Saving model ...
Epoch: 8 cost time: 0.5199005603790283
Epoch: 8, Steps: 2 | Train Loss: 1.640 Vali Loss: 1.581 Vali Acc: 0.274 Test Loss: 1.581 Test Acc: 0.274
Validation loss decreased (-0.251835 --> -0.274058).  Saving model ...
Epoch: 9 cost time: 0.4877595901489258
Epoch: 9, Steps: 2 | Train Loss: 1.526 Vali Loss: 1.513 Vali Acc: 0.322 Test Loss: 1.513 Test Acc: 0.322
Validation loss decreased (-0.274058 --> -0.322207).  Saving model ...
Epoch: 10 cost time: 0.5272538661956787
Epoch: 10, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.444 Vali Acc: 0.356 Test Loss: 1.444 Test Acc: 0.356
Validation loss decreased (-0.322207 --> -0.355541).  Saving model ...
Epoch: 11 cost time: 0.4904673099517822
Epoch: 11, Steps: 2 | Train Loss: 1.398 Vali Loss: 1.375 Vali Acc: 0.422 Test Loss: 1.375 Test Acc: 0.422
Validation loss decreased (-0.355541 --> -0.422208).  Saving model ...
Epoch: 12 cost time: 0.45770692825317383
Epoch: 12, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.308 Vali Acc: 0.467 Test Loss: 1.308 Test Acc: 0.467
Validation loss decreased (-0.422208 --> -0.466654).  Saving model ...
Epoch: 13 cost time: 0.49031496047973633
Epoch: 13, Steps: 2 | Train Loss: 1.222 Vali Loss: 1.240 Vali Acc: 0.507 Test Loss: 1.240 Test Acc: 0.507
Validation loss decreased (-0.466654 --> -0.507395).  Saving model ...
Epoch: 14 cost time: 0.514763355255127
Epoch: 14, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.173 Vali Acc: 0.537 Test Loss: 1.173 Test Acc: 0.537
Validation loss decreased (-0.507395 --> -0.537025).  Saving model ...
Epoch: 15 cost time: 0.470120906829834
Epoch: 15, Steps: 2 | Train Loss: 1.092 Vali Loss: 1.108 Vali Acc: 0.585 Test Loss: 1.108 Test Acc: 0.585
Validation loss decreased (-0.537025 --> -0.585174).  Saving model ...
Epoch: 16 cost time: 0.4454638957977295
Epoch: 16, Steps: 2 | Train Loss: 1.009 Vali Loss: 1.046 Vali Acc: 0.596 Test Loss: 1.046 Test Acc: 0.596
Validation loss decreased (-0.585174 --> -0.596286).  Saving model ...
Epoch: 17 cost time: 0.43456387519836426
Epoch: 17, Steps: 2 | Train Loss: 0.923 Vali Loss: 0.987 Vali Acc: 0.652 Test Loss: 0.987 Test Acc: 0.652
Validation loss decreased (-0.596286 --> -0.651842).  Saving model ...
Epoch: 18 cost time: 0.48676180839538574
Epoch: 18, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.930 Vali Acc: 0.689 Test Loss: 0.930 Test Acc: 0.689
Validation loss decreased (-0.651842 --> -0.688880).  Saving model ...
Epoch: 19 cost time: 0.43853139877319336
Epoch: 19, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.877 Vali Acc: 0.726 Test Loss: 0.877 Test Acc: 0.726
Validation loss decreased (-0.688880 --> -0.725917).  Saving model ...
Epoch: 20 cost time: 0.4553987979888916
Epoch: 20, Steps: 2 | Train Loss: 0.708 Vali Loss: 0.827 Vali Acc: 0.756 Test Loss: 0.827 Test Acc: 0.756
Validation loss decreased (-0.725917 --> -0.755547).  Saving model ...
Epoch: 21 cost time: 0.47701311111450195
Epoch: 21, Steps: 2 | Train Loss: 0.634 Vali Loss: 0.782 Vali Acc: 0.767 Test Loss: 0.782 Test Acc: 0.767
Validation loss decreased (-0.755547 --> -0.766659).  Saving model ...
Epoch: 22 cost time: 0.48123693466186523
Epoch: 22, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.739 Vali Acc: 0.785 Test Loss: 0.739 Test Acc: 0.785
Validation loss decreased (-0.766659 --> -0.785178).  Saving model ...
Epoch: 23 cost time: 0.4922971725463867
Epoch: 23, Steps: 2 | Train Loss: 0.585 Vali Loss: 0.701 Vali Acc: 0.804 Test Loss: 0.701 Test Acc: 0.804
Validation loss decreased (-0.785178 --> -0.803697).  Saving model ...
Epoch: 24 cost time: 0.512913703918457
Epoch: 24, Steps: 2 | Train Loss: 0.513 Vali Loss: 0.667 Vali Acc: 0.807 Test Loss: 0.667 Test Acc: 0.807
Validation loss decreased (-0.803697 --> -0.807401).  Saving model ...
Epoch: 25 cost time: 0.5171926021575928
Epoch: 25, Steps: 2 | Train Loss: 0.520 Vali Loss: 0.636 Vali Acc: 0.819 Test Loss: 0.636 Test Acc: 0.819
Validation loss decreased (-0.807401 --> -0.818512).  Saving model ...
Epoch: 26 cost time: 0.5140314102172852
Epoch: 26, Steps: 2 | Train Loss: 0.476 Vali Loss: 0.608 Vali Acc: 0.822 Test Loss: 0.608 Test Acc: 0.822
Validation loss decreased (-0.818512 --> -0.822216).  Saving model ...
Epoch: 27 cost time: 0.5340723991394043
Epoch: 27, Steps: 2 | Train Loss: 0.436 Vali Loss: 0.583 Vali Acc: 0.822 Test Loss: 0.583 Test Acc: 0.822
Validation loss decreased (-0.822216 --> -0.822216).  Saving model ...
Epoch: 28 cost time: 0.5187857151031494
Epoch: 28, Steps: 2 | Train Loss: 0.400 Vali Loss: 0.560 Vali Acc: 0.833 Test Loss: 0.560 Test Acc: 0.833
Validation loss decreased (-0.822216 --> -0.833328).  Saving model ...
Epoch: 29 cost time: 0.5822362899780273
Epoch: 29, Steps: 2 | Train Loss: 0.352 Vali Loss: 0.539 Vali Acc: 0.844 Test Loss: 0.539 Test Acc: 0.844
Validation loss decreased (-0.833328 --> -0.844439).  Saving model ...
Epoch: 30 cost time: 0.49295973777770996
Epoch: 30, Steps: 2 | Train Loss: 0.338 Vali Loss: 0.520 Vali Acc: 0.852 Test Loss: 0.520 Test Acc: 0.852
Validation loss decreased (-0.844439 --> -0.851847).  Saving model ...
Epoch: 31 cost time: 0.5060853958129883
Epoch: 31, Steps: 2 | Train Loss: 0.296 Vali Loss: 0.503 Vali Acc: 0.863 Test Loss: 0.503 Test Acc: 0.863
Validation loss decreased (-0.851847 --> -0.862958).  Saving model ...
Epoch: 32 cost time: 0.53397536277771
Epoch: 32, Steps: 2 | Train Loss: 0.311 Vali Loss: 0.488 Vali Acc: 0.859 Test Loss: 0.488 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5171372890472412
Epoch: 33, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.475 Vali Acc: 0.859 Test Loss: 0.475 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5444083213806152
Epoch: 34, Steps: 2 | Train Loss: 0.263 Vali Loss: 0.463 Vali Acc: 0.859 Test Loss: 0.463 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5487771034240723
Epoch: 35, Steps: 2 | Train Loss: 0.244 Vali Loss: 0.452 Vali Acc: 0.859 Test Loss: 0.452 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5050592422485352
Epoch: 36, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.442 Vali Acc: 0.867 Test Loss: 0.442 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 37 cost time: 0.5102603435516357
Epoch: 37, Steps: 2 | Train Loss: 0.235 Vali Loss: 0.434 Vali Acc: 0.867 Test Loss: 0.434 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 38 cost time: 0.48790907859802246
Epoch: 38, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.426 Vali Acc: 0.867 Test Loss: 0.426 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866662).  Saving model ...
Epoch: 39 cost time: 0.44356775283813477
Epoch: 39, Steps: 2 | Train Loss: 0.227 Vali Loss: 0.420 Vali Acc: 0.870 Test Loss: 0.420 Test Acc: 0.870
Validation loss decreased (-0.866662 --> -0.870366).  Saving model ...
Epoch: 40 cost time: 0.514958381652832
Epoch: 40, Steps: 2 | Train Loss: 0.201 Vali Loss: 0.414 Vali Acc: 0.867 Test Loss: 0.414 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.47940826416015625
Epoch: 41, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.409 Vali Acc: 0.867 Test Loss: 0.409 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.573296308517456
Epoch: 42, Steps: 2 | Train Loss: 0.185 Vali Loss: 0.403 Vali Acc: 0.870 Test Loss: 0.403 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870366).  Saving model ...
Epoch: 43 cost time: 0.4852416515350342
Epoch: 43, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.400 Vali Acc: 0.867 Test Loss: 0.400 Test Acc: 0.867
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.5123307704925537
Epoch: 44, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.396 Vali Acc: 0.867 Test Loss: 0.396 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4724690914154053
Epoch: 45, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.393 Vali Acc: 0.863 Test Loss: 0.393 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.5042965412139893
Epoch: 46, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.389 Vali Acc: 0.852 Test Loss: 0.389 Test Acc: 0.852
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.5116133689880371
Epoch: 47, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.384 Vali Acc: 0.867 Test Loss: 0.384 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.5375535488128662
Epoch: 48, Steps: 2 | Train Loss: 0.143 Vali Loss: 0.381 Vali Acc: 0.867 Test Loss: 0.381 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.5424933433532715
Epoch: 49, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.377 Vali Acc: 0.867 Test Loss: 0.377 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.49058032035827637
Epoch: 50, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.375 Vali Acc: 0.863 Test Loss: 0.375 Test Acc: 0.863
EarlyStopping counter: 8 out of 10
Epoch: 51 cost time: 0.5119376182556152
Epoch: 51, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.372 Vali Acc: 0.867 Test Loss: 0.372 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 52 cost time: 0.5334956645965576
Epoch: 52, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
Validation loss decreased (-0.870366 --> -0.870367).  Saving model ...
Epoch: 53 cost time: 0.5276553630828857
Epoch: 53, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.367 Vali Acc: 0.881 Test Loss: 0.367 Test Acc: 0.881
Validation loss decreased (-0.870367 --> -0.881478).  Saving model ...
Epoch: 54 cost time: 0.5489988327026367
Epoch: 54, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.366 Vali Acc: 0.881 Test Loss: 0.366 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 55 cost time: 0.5039069652557373
Epoch: 55, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.364 Vali Acc: 0.881 Test Loss: 0.364 Test Acc: 0.881
Validation loss decreased (-0.881478 --> -0.881478).  Saving model ...
Epoch: 56 cost time: 0.5163121223449707
Epoch: 56, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.361 Vali Acc: 0.874 Test Loss: 0.361 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 57 cost time: 0.5381968021392822
Epoch: 57, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.360 Vali Acc: 0.867 Test Loss: 0.360 Test Acc: 0.867
EarlyStopping counter: 2 out of 10
Epoch: 58 cost time: 0.5445270538330078
Epoch: 58, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.360 Vali Acc: 0.859 Test Loss: 0.360 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 59 cost time: 0.528977632522583
Epoch: 59, Steps: 2 | Train Loss: 0.102 Vali Loss: 0.358 Vali Acc: 0.859 Test Loss: 0.358 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 60 cost time: 0.5382287502288818
Epoch: 60, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.355 Vali Acc: 0.867 Test Loss: 0.355 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 61 cost time: 0.471951961517334
Epoch: 61, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 62 cost time: 0.48691439628601074
Epoch: 62, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.350 Vali Acc: 0.874 Test Loss: 0.350 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 63 cost time: 0.46538329124450684
Epoch: 63, Steps: 2 | Train Loss: 0.085 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
EarlyStopping counter: 8 out of 10
Epoch: 64 cost time: 0.4875307083129883
Epoch: 64, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.347 Vali Acc: 0.878 Test Loss: 0.347 Test Acc: 0.878
EarlyStopping counter: 9 out of 10
Epoch: 65 cost time: 0.42246270179748535
Epoch: 65, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.346 Vali Acc: 0.878 Test Loss: 0.346 Test Acc: 0.878
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8814814814814815
model parameter : 48358
model size : 0.81MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1421661376953125
Epoch: 1, Steps: 2 | Train Loss: 2.327 Vali Loss: 2.139 Vali Acc: 0.163 Test Loss: 2.139 Test Acc: 0.163
Validation loss decreased (inf --> -0.162942).  Saving model ...
Epoch: 2 cost time: 0.6066858768463135
Epoch: 2, Steps: 2 | Train Loss: 2.283 Vali Loss: 2.063 Vali Acc: 0.170 Test Loss: 2.063 Test Acc: 0.170
Validation loss decreased (-0.162942 --> -0.170350).  Saving model ...
Epoch: 3 cost time: 0.5947475433349609
Epoch: 3, Steps: 2 | Train Loss: 2.066 Vali Loss: 2.009 Vali Acc: 0.174 Test Loss: 2.009 Test Acc: 0.174
Validation loss decreased (-0.170350 --> -0.174054).  Saving model ...
Epoch: 4 cost time: 0.5131828784942627
Epoch: 4, Steps: 2 | Train Loss: 2.165 Vali Loss: 1.962 Vali Acc: 0.178 Test Loss: 1.962 Test Acc: 0.178
Validation loss decreased (-0.174054 --> -0.177758).  Saving model ...
Epoch: 5 cost time: 0.5971260070800781
Epoch: 5, Steps: 2 | Train Loss: 2.052 Vali Loss: 1.903 Vali Acc: 0.189 Test Loss: 1.903 Test Acc: 0.189
Validation loss decreased (-0.177758 --> -0.188870).  Saving model ...
Epoch: 6 cost time: 0.5733060836791992
Epoch: 6, Steps: 2 | Train Loss: 1.898 Vali Loss: 1.834 Vali Acc: 0.193 Test Loss: 1.834 Test Acc: 0.193
Validation loss decreased (-0.188870 --> -0.192574).  Saving model ...
Epoch: 7 cost time: 0.5163848400115967
Epoch: 7, Steps: 2 | Train Loss: 1.893 Vali Loss: 1.759 Vali Acc: 0.215 Test Loss: 1.759 Test Acc: 0.215
Validation loss decreased (-0.192574 --> -0.214797).  Saving model ...
Epoch: 8 cost time: 0.5242955684661865
Epoch: 8, Steps: 2 | Train Loss: 1.792 Vali Loss: 1.678 Vali Acc: 0.263 Test Loss: 1.678 Test Acc: 0.263
Validation loss decreased (-0.214797 --> -0.262946).  Saving model ...
Epoch: 9 cost time: 0.5473818778991699
Epoch: 9, Steps: 2 | Train Loss: 1.680 Vali Loss: 1.594 Vali Acc: 0.307 Test Loss: 1.594 Test Acc: 0.307
Validation loss decreased (-0.262946 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.500312328338623
Epoch: 10, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.508 Vali Acc: 0.396 Test Loss: 1.508 Test Acc: 0.396
Validation loss decreased (-0.307391 --> -0.396281).  Saving model ...
Epoch: 11 cost time: 0.5893945693969727
Epoch: 11, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.420 Vali Acc: 0.448 Test Loss: 1.420 Test Acc: 0.448
Validation loss decreased (-0.396281 --> -0.448134).  Saving model ...
Epoch: 12 cost time: 0.5297231674194336
Epoch: 12, Steps: 2 | Train Loss: 1.428 Vali Loss: 1.332 Vali Acc: 0.544 Test Loss: 1.332 Test Acc: 0.544
Validation loss decreased (-0.448134 --> -0.544431).  Saving model ...
Epoch: 13 cost time: 0.5375921726226807
Epoch: 13, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.245 Vali Acc: 0.652 Test Loss: 1.245 Test Acc: 0.652
Validation loss decreased (-0.544431 --> -0.651839).  Saving model ...
Epoch: 14 cost time: 0.5163178443908691
Epoch: 14, Steps: 2 | Train Loss: 1.209 Vali Loss: 1.159 Vali Acc: 0.700 Test Loss: 1.159 Test Acc: 0.700
Validation loss decreased (-0.651839 --> -0.699988).  Saving model ...
Epoch: 15 cost time: 0.5127618312835693
Epoch: 15, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.078 Vali Acc: 0.748 Test Loss: 1.078 Test Acc: 0.748
Validation loss decreased (-0.699988 --> -0.748137).  Saving model ...
Epoch: 16 cost time: 0.4576702117919922
Epoch: 16, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.000 Vali Acc: 0.789 Test Loss: 1.000 Test Acc: 0.789
Validation loss decreased (-0.748137 --> -0.788879).  Saving model ...
Epoch: 17 cost time: 0.5281524658203125
Epoch: 17, Steps: 2 | Train Loss: 0.890 Vali Loss: 0.928 Vali Acc: 0.796 Test Loss: 0.928 Test Acc: 0.796
Validation loss decreased (-0.788879 --> -0.796287).  Saving model ...
Epoch: 18 cost time: 0.49995899200439453
Epoch: 18, Steps: 2 | Train Loss: 0.803 Vali Loss: 0.862 Vali Acc: 0.819 Test Loss: 0.862 Test Acc: 0.819
Validation loss decreased (-0.796287 --> -0.818510).  Saving model ...
Epoch: 19 cost time: 0.5414979457855225
Epoch: 19, Steps: 2 | Train Loss: 0.689 Vali Loss: 0.798 Vali Acc: 0.837 Test Loss: 0.798 Test Acc: 0.837
Validation loss decreased (-0.818510 --> -0.837029).  Saving model ...
Epoch: 20 cost time: 0.5227572917938232
Epoch: 20, Steps: 2 | Train Loss: 0.641 Vali Loss: 0.738 Vali Acc: 0.863 Test Loss: 0.738 Test Acc: 0.863
Validation loss decreased (-0.837029 --> -0.862956).  Saving model ...
Epoch: 21 cost time: 0.46848487854003906
Epoch: 21, Steps: 2 | Train Loss: 0.627 Vali Loss: 0.683 Vali Acc: 0.881 Test Loss: 0.683 Test Acc: 0.881
Validation loss decreased (-0.862956 --> -0.881475).  Saving model ...
Epoch: 22 cost time: 0.4564642906188965
Epoch: 22, Steps: 2 | Train Loss: 0.522 Vali Loss: 0.632 Vali Acc: 0.893 Test Loss: 0.632 Test Acc: 0.893
Validation loss decreased (-0.881475 --> -0.892586).  Saving model ...
Epoch: 23 cost time: 0.4639260768890381
Epoch: 23, Steps: 2 | Train Loss: 0.484 Vali Loss: 0.585 Vali Acc: 0.915 Test Loss: 0.585 Test Acc: 0.915
Validation loss decreased (-0.892586 --> -0.914809).  Saving model ...
Epoch: 24 cost time: 0.504535436630249
Epoch: 24, Steps: 2 | Train Loss: 0.409 Vali Loss: 0.543 Vali Acc: 0.911 Test Loss: 0.543 Test Acc: 0.911
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 0.4966740608215332
Epoch: 25, Steps: 2 | Train Loss: 0.387 Vali Loss: 0.505 Vali Acc: 0.907 Test Loss: 0.505 Test Acc: 0.907
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 0.5233876705169678
Epoch: 26, Steps: 2 | Train Loss: 0.295 Vali Loss: 0.471 Vali Acc: 0.911 Test Loss: 0.471 Test Acc: 0.911
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 0.5805337429046631
Epoch: 27, Steps: 2 | Train Loss: 0.310 Vali Loss: 0.441 Vali Acc: 0.922 Test Loss: 0.441 Test Acc: 0.922
Validation loss decreased (-0.914809 --> -0.922218).  Saving model ...
Epoch: 28 cost time: 0.5564219951629639
Epoch: 28, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.413 Vali Acc: 0.926 Test Loss: 0.413 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.5534849166870117
Epoch: 29, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.389 Vali Acc: 0.926 Test Loss: 0.389 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.5496108531951904
Epoch: 30, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.367 Vali Acc: 0.930 Test Loss: 0.367 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 31 cost time: 0.5492794513702393
Epoch: 31, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.349 Vali Acc: 0.930 Test Loss: 0.349 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 32 cost time: 0.587846040725708
Epoch: 32, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.332 Vali Acc: 0.930 Test Loss: 0.332 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 0.5769155025482178
Epoch: 33, Steps: 2 | Train Loss: 0.163 Vali Loss: 0.317 Vali Acc: 0.937 Test Loss: 0.317 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937034).  Saving model ...
Epoch: 34 cost time: 0.5753347873687744
Epoch: 34, Steps: 2 | Train Loss: 0.125 Vali Loss: 0.305 Vali Acc: 0.937 Test Loss: 0.305 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 35 cost time: 0.5918111801147461
Epoch: 35, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.294 Vali Acc: 0.941 Test Loss: 0.294 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 36 cost time: 0.6392967700958252
Epoch: 36, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.284 Vali Acc: 0.941 Test Loss: 0.284 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 37 cost time: 0.6195030212402344
Epoch: 37, Steps: 2 | Train Loss: 0.105 Vali Loss: 0.275 Vali Acc: 0.941 Test Loss: 0.275 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 38 cost time: 0.6648561954498291
Epoch: 38, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.267 Vali Acc: 0.941 Test Loss: 0.267 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 39 cost time: 0.6203315258026123
Epoch: 39, Steps: 2 | Train Loss: 0.093 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 40 cost time: 0.5085391998291016
Epoch: 40, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.253 Vali Acc: 0.944 Test Loss: 0.253 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.571784496307373
Epoch: 41, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.46420979499816895
Epoch: 42, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.242 Vali Acc: 0.944 Test Loss: 0.242 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.49049925804138184
Epoch: 43, Steps: 2 | Train Loss: 0.077 Vali Loss: 0.238 Vali Acc: 0.944 Test Loss: 0.238 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 44 cost time: 0.511101484298706
Epoch: 44, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.234 Vali Acc: 0.944 Test Loss: 0.234 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 45 cost time: 0.4771156311035156
Epoch: 45, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.231 Vali Acc: 0.944 Test Loss: 0.231 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 46 cost time: 0.47748279571533203
Epoch: 46, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.227 Vali Acc: 0.944 Test Loss: 0.227 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.5066664218902588
Epoch: 47, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.224 Vali Acc: 0.944 Test Loss: 0.224 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.5027780532836914
Epoch: 48, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.222 Vali Acc: 0.944 Test Loss: 0.222 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.5484144687652588
Epoch: 49, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.546959400177002
Epoch: 50, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.217 Vali Acc: 0.944 Test Loss: 0.217 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.5521981716156006
Epoch: 51, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.215 Vali Acc: 0.944 Test Loss: 0.215 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.5725476741790771
Epoch: 52, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.213 Vali Acc: 0.944 Test Loss: 0.213 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.6033086776733398
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.211 Vali Acc: 0.944 Test Loss: 0.211 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.608304500579834
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.209 Vali Acc: 0.944 Test Loss: 0.209 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.5667529106140137
Epoch: 55, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.5549404621124268
Epoch: 56, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.5710489749908447
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.205 Vali Acc: 0.944 Test Loss: 0.205 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.5776767730712891
Epoch: 58, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.5218057632446289
Epoch: 59, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.5338480472564697
Epoch: 60, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 61 cost time: 0.5331077575683594
Epoch: 61, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 62 cost time: 0.5299596786499023
Epoch: 62, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 63 cost time: 0.5526881217956543
Epoch: 63, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 64 cost time: 0.4993417263031006
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 65 cost time: 0.4932880401611328
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 66 cost time: 0.5066759586334229
Epoch: 66, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 67 cost time: 0.5104842185974121
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 68 cost time: 0.47109413146972656
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 69 cost time: 0.48367929458618164
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 31974
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.096432685852051
Epoch: 1, Steps: 2 | Train Loss: 2.279 Vali Loss: 2.137 Vali Acc: 0.163 Test Loss: 2.137 Test Acc: 0.163
Validation loss decreased (inf --> -0.162942).  Saving model ...
Epoch: 2 cost time: 0.4764556884765625
Epoch: 2, Steps: 2 | Train Loss: 2.308 Vali Loss: 2.061 Vali Acc: 0.170 Test Loss: 2.061 Test Acc: 0.170
Validation loss decreased (-0.162942 --> -0.170350).  Saving model ...
Epoch: 3 cost time: 0.4836602210998535
Epoch: 3, Steps: 2 | Train Loss: 2.074 Vali Loss: 2.007 Vali Acc: 0.174 Test Loss: 2.007 Test Acc: 0.174
Validation loss decreased (-0.170350 --> -0.174054).  Saving model ...
Epoch: 4 cost time: 0.4761316776275635
Epoch: 4, Steps: 2 | Train Loss: 2.168 Vali Loss: 1.961 Vali Acc: 0.174 Test Loss: 1.961 Test Acc: 0.174
Validation loss decreased (-0.174054 --> -0.174054).  Saving model ...
Epoch: 5 cost time: 0.48267602920532227
Epoch: 5, Steps: 2 | Train Loss: 2.042 Vali Loss: 1.902 Vali Acc: 0.189 Test Loss: 1.902 Test Acc: 0.189
Validation loss decreased (-0.174054 --> -0.188870).  Saving model ...
Epoch: 6 cost time: 0.5244631767272949
Epoch: 6, Steps: 2 | Train Loss: 1.901 Vali Loss: 1.834 Vali Acc: 0.204 Test Loss: 1.834 Test Acc: 0.204
Validation loss decreased (-0.188870 --> -0.203685).  Saving model ...
Epoch: 7 cost time: 0.45784807205200195
Epoch: 7, Steps: 2 | Train Loss: 1.915 Vali Loss: 1.760 Vali Acc: 0.230 Test Loss: 1.760 Test Acc: 0.230
Validation loss decreased (-0.203685 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 0.44405317306518555
Epoch: 8, Steps: 2 | Train Loss: 1.819 Vali Loss: 1.680 Vali Acc: 0.270 Test Loss: 1.680 Test Acc: 0.270
Validation loss decreased (-0.229612 --> -0.270354).  Saving model ...
Epoch: 9 cost time: 0.6458971500396729
Epoch: 9, Steps: 2 | Train Loss: 1.668 Vali Loss: 1.597 Vali Acc: 0.330 Test Loss: 1.597 Test Acc: 0.330
Validation loss decreased (-0.270354 --> -0.329614).  Saving model ...
Epoch: 10 cost time: 0.4477095603942871
Epoch: 10, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.511 Vali Acc: 0.374 Test Loss: 1.511 Test Acc: 0.374
Validation loss decreased (-0.329614 --> -0.374059).  Saving model ...
Epoch: 11 cost time: 0.4574558734893799
Epoch: 11, Steps: 2 | Train Loss: 1.591 Vali Loss: 1.423 Vali Acc: 0.452 Test Loss: 1.423 Test Acc: 0.452
Validation loss decreased (-0.374059 --> -0.451838).  Saving model ...
Epoch: 12 cost time: 0.4332442283630371
Epoch: 12, Steps: 2 | Train Loss: 1.435 Vali Loss: 1.336 Vali Acc: 0.548 Test Loss: 1.336 Test Acc: 0.548
Validation loss decreased (-0.451838 --> -0.548135).  Saving model ...
Epoch: 13 cost time: 0.45766401290893555
Epoch: 13, Steps: 2 | Train Loss: 1.258 Vali Loss: 1.250 Vali Acc: 0.593 Test Loss: 1.250 Test Acc: 0.593
Validation loss decreased (-0.548135 --> -0.592580).  Saving model ...
Epoch: 14 cost time: 0.4273416996002197
Epoch: 14, Steps: 2 | Train Loss: 1.240 Vali Loss: 1.165 Vali Acc: 0.663 Test Loss: 1.165 Test Acc: 0.663
Validation loss decreased (-0.592580 --> -0.662951).  Saving model ...
Epoch: 15 cost time: 0.4212954044342041
Epoch: 15, Steps: 2 | Train Loss: 1.153 Vali Loss: 1.084 Vali Acc: 0.707 Test Loss: 1.084 Test Acc: 0.707
Validation loss decreased (-0.662951 --> -0.707397).  Saving model ...
Epoch: 16 cost time: 0.46144843101501465
Epoch: 16, Steps: 2 | Train Loss: 0.929 Vali Loss: 1.006 Vali Acc: 0.767 Test Loss: 1.006 Test Acc: 0.767
Validation loss decreased (-0.707397 --> -0.766657).  Saving model ...
Epoch: 17 cost time: 0.4032764434814453
Epoch: 17, Steps: 2 | Train Loss: 0.913 Vali Loss: 0.935 Vali Acc: 0.796 Test Loss: 0.935 Test Acc: 0.796
Validation loss decreased (-0.766657 --> -0.796287).  Saving model ...
Epoch: 18 cost time: 0.4964025020599365
Epoch: 18, Steps: 2 | Train Loss: 0.810 Vali Loss: 0.868 Vali Acc: 0.826 Test Loss: 0.868 Test Acc: 0.826
Validation loss decreased (-0.796287 --> -0.825917).  Saving model ...
Epoch: 19 cost time: 0.42102599143981934
Epoch: 19, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.805 Vali Acc: 0.841 Test Loss: 0.805 Test Acc: 0.841
Validation loss decreased (-0.825917 --> -0.840733).  Saving model ...
Epoch: 20 cost time: 0.4038538932800293
Epoch: 20, Steps: 2 | Train Loss: 0.676 Vali Loss: 0.745 Vali Acc: 0.870 Test Loss: 0.745 Test Acc: 0.870
Validation loss decreased (-0.840733 --> -0.870363).  Saving model ...
Epoch: 21 cost time: 0.3960294723510742
Epoch: 21, Steps: 2 | Train Loss: 0.650 Vali Loss: 0.689 Vali Acc: 0.889 Test Loss: 0.689 Test Acc: 0.889
Validation loss decreased (-0.870363 --> -0.888882).  Saving model ...
Epoch: 22 cost time: 0.43245863914489746
Epoch: 22, Steps: 2 | Train Loss: 0.547 Vali Loss: 0.638 Vali Acc: 0.900 Test Loss: 0.638 Test Acc: 0.900
Validation loss decreased (-0.888882 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.425403356552124
Epoch: 23, Steps: 2 | Train Loss: 0.500 Vali Loss: 0.591 Vali Acc: 0.907 Test Loss: 0.591 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907401).  Saving model ...
Epoch: 24 cost time: 0.5773367881774902
Epoch: 24, Steps: 2 | Train Loss: 0.429 Vali Loss: 0.550 Vali Acc: 0.919 Test Loss: 0.550 Test Acc: 0.919
Validation loss decreased (-0.907401 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.5329313278198242
Epoch: 25, Steps: 2 | Train Loss: 0.408 Vali Loss: 0.511 Vali Acc: 0.915 Test Loss: 0.511 Test Acc: 0.915
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.5034112930297852
Epoch: 26, Steps: 2 | Train Loss: 0.328 Vali Loss: 0.477 Vali Acc: 0.926 Test Loss: 0.477 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 27 cost time: 0.49933505058288574
Epoch: 27, Steps: 2 | Train Loss: 0.324 Vali Loss: 0.445 Vali Acc: 0.926 Test Loss: 0.445 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 28 cost time: 0.44386744499206543
Epoch: 28, Steps: 2 | Train Loss: 0.303 Vali Loss: 0.417 Vali Acc: 0.926 Test Loss: 0.417 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.48391175270080566
Epoch: 29, Steps: 2 | Train Loss: 0.248 Vali Loss: 0.392 Vali Acc: 0.933 Test Loss: 0.392 Test Acc: 0.933
Validation loss decreased (-0.925922 --> -0.933329).  Saving model ...
Epoch: 30 cost time: 0.5208759307861328
Epoch: 30, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.370 Vali Acc: 0.933 Test Loss: 0.370 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933330).  Saving model ...
Epoch: 31 cost time: 0.5081138610839844
Epoch: 31, Steps: 2 | Train Loss: 0.200 Vali Loss: 0.351 Vali Acc: 0.944 Test Loss: 0.351 Test Acc: 0.944
Validation loss decreased (-0.933330 --> -0.944441).  Saving model ...
Epoch: 32 cost time: 0.4797637462615967
Epoch: 32, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.334 Vali Acc: 0.944 Test Loss: 0.334 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 33 cost time: 0.48119521141052246
Epoch: 33, Steps: 2 | Train Loss: 0.174 Vali Loss: 0.319 Vali Acc: 0.944 Test Loss: 0.319 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 34 cost time: 0.48755931854248047
Epoch: 34, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.307 Vali Acc: 0.944 Test Loss: 0.307 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 35 cost time: 0.5001354217529297
Epoch: 35, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.296 Vali Acc: 0.944 Test Loss: 0.296 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944441).  Saving model ...
Epoch: 36 cost time: 0.5204358100891113
Epoch: 36, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.286 Vali Acc: 0.944 Test Loss: 0.286 Test Acc: 0.944
Validation loss decreased (-0.944441 --> -0.944442).  Saving model ...
Epoch: 37 cost time: 0.4953486919403076
Epoch: 37, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.277 Vali Acc: 0.944 Test Loss: 0.277 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 38 cost time: 0.523775577545166
Epoch: 38, Steps: 2 | Train Loss: 0.106 Vali Loss: 0.269 Vali Acc: 0.944 Test Loss: 0.269 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 39 cost time: 0.5219845771789551
Epoch: 39, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.261 Vali Acc: 0.944 Test Loss: 0.261 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 40 cost time: 0.4672408103942871
Epoch: 40, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.254 Vali Acc: 0.944 Test Loss: 0.254 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 41 cost time: 0.4730813503265381
Epoch: 41, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.248 Vali Acc: 0.944 Test Loss: 0.248 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 42 cost time: 0.4604504108428955
Epoch: 42, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.243 Vali Acc: 0.944 Test Loss: 0.243 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 43 cost time: 0.485379695892334
Epoch: 43, Steps: 2 | Train Loss: 0.086 Vali Loss: 0.239 Vali Acc: 0.941 Test Loss: 0.239 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 44 cost time: 0.48727869987487793
Epoch: 44, Steps: 2 | Train Loss: 0.063 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 45 cost time: 0.4558568000793457
Epoch: 45, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 46 cost time: 0.453000545501709
Epoch: 46, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.228 Vali Acc: 0.941 Test Loss: 0.228 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 47 cost time: 0.42716264724731445
Epoch: 47, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.225 Vali Acc: 0.941 Test Loss: 0.225 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 48 cost time: 0.476534366607666
Epoch: 48, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.223 Vali Acc: 0.941 Test Loss: 0.223 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 49 cost time: 0.45674777030944824
Epoch: 49, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.221 Vali Acc: 0.941 Test Loss: 0.221 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 50 cost time: 0.4830501079559326
Epoch: 50, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.218 Vali Acc: 0.944 Test Loss: 0.218 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.523296594619751
Epoch: 51, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.216 Vali Acc: 0.944 Test Loss: 0.216 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.5060100555419922
Epoch: 52, Steps: 2 | Train Loss: 0.041 Vali Loss: 0.214 Vali Acc: 0.944 Test Loss: 0.214 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 53 cost time: 0.4630904197692871
Epoch: 53, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.212 Vali Acc: 0.944 Test Loss: 0.212 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 54 cost time: 0.5317485332489014
Epoch: 54, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.210 Vali Acc: 0.944 Test Loss: 0.210 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 55 cost time: 0.45371294021606445
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.208 Vali Acc: 0.944 Test Loss: 0.208 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 56 cost time: 0.5172984600067139
Epoch: 56, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.207 Vali Acc: 0.944 Test Loss: 0.207 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 57 cost time: 0.4737393856048584
Epoch: 57, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.206 Vali Acc: 0.944 Test Loss: 0.206 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 58 cost time: 0.4871077537536621
Epoch: 58, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.204 Vali Acc: 0.944 Test Loss: 0.204 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 59 cost time: 0.6030192375183105
Epoch: 59, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.203 Vali Acc: 0.944 Test Loss: 0.203 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 60 cost time: 0.5232532024383545
Epoch: 60, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.202 Vali Acc: 0.944 Test Loss: 0.202 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 61 cost time: 0.5276973247528076
Epoch: 61, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.201 Vali Acc: 0.944 Test Loss: 0.201 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 62 cost time: 0.5403342247009277
Epoch: 62, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.200 Vali Acc: 0.948 Test Loss: 0.200 Test Acc: 0.948
Validation loss decreased (-0.944442 --> -0.948146).  Saving model ...
Epoch: 63 cost time: 0.5696926116943359
Epoch: 63, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.199 Vali Acc: 0.948 Test Loss: 0.199 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 64 cost time: 0.5278995037078857
Epoch: 64, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.198 Vali Acc: 0.948 Test Loss: 0.198 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 65 cost time: 0.5647768974304199
Epoch: 65, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.197 Vali Acc: 0.948 Test Loss: 0.197 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 66 cost time: 0.45404911041259766
Epoch: 66, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 67 cost time: 0.4889235496520996
Epoch: 67, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.196 Vali Acc: 0.948 Test Loss: 0.196 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 68 cost time: 0.47293758392333984
Epoch: 68, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.195 Vali Acc: 0.948 Test Loss: 0.195 Test Acc: 0.948
Validation loss decreased (-0.948146 --> -0.948146).  Saving model ...
Epoch: 69 cost time: 0.47661662101745605
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
EarlyStopping counter: 1 out of 10
Epoch: 70 cost time: 0.4169502258300781
Epoch: 70, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 71 cost time: 0.4561619758605957
Epoch: 71, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 72 cost time: 0.4526176452636719
Epoch: 72, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 4 out of 10
Epoch: 73 cost time: 0.4844975471496582
Epoch: 73, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 74 cost time: 0.4594273567199707
Epoch: 74, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 75 cost time: 0.5127749443054199
Epoch: 75, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 76 cost time: 0.5108942985534668
Epoch: 76, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 77 cost time: 0.6551005840301514
Epoch: 77, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 78 cost time: 0.49315929412841797
Epoch: 78, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9481481481481482
model parameter : 31974
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0012731552124023
Epoch: 1, Steps: 2 | Train Loss: 2.267 Vali Loss: 2.140 Vali Acc: 0.174 Test Loss: 2.140 Test Acc: 0.174
Validation loss decreased (inf --> -0.174053).  Saving model ...
Epoch: 2 cost time: 0.3855123519897461
Epoch: 2, Steps: 2 | Train Loss: 2.286 Vali Loss: 2.065 Vali Acc: 0.178 Test Loss: 2.065 Test Acc: 0.178
Validation loss decreased (-0.174053 --> -0.177757).  Saving model ...
Epoch: 3 cost time: 0.4050717353820801
Epoch: 3, Steps: 2 | Train Loss: 2.078 Vali Loss: 2.012 Vali Acc: 0.178 Test Loss: 2.012 Test Acc: 0.178
Validation loss decreased (-0.177757 --> -0.177758).  Saving model ...
Epoch: 4 cost time: 0.45957398414611816
Epoch: 4, Steps: 2 | Train Loss: 2.115 Vali Loss: 1.966 Vali Acc: 0.185 Test Loss: 1.966 Test Acc: 0.185
Validation loss decreased (-0.177758 --> -0.185166).  Saving model ...
Epoch: 5 cost time: 0.4610440731048584
Epoch: 5, Steps: 2 | Train Loss: 2.042 Vali Loss: 1.909 Vali Acc: 0.200 Test Loss: 1.909 Test Acc: 0.200
Validation loss decreased (-0.185166 --> -0.199981).  Saving model ...
Epoch: 6 cost time: 0.4944894313812256
Epoch: 6, Steps: 2 | Train Loss: 1.891 Vali Loss: 1.843 Vali Acc: 0.207 Test Loss: 1.843 Test Acc: 0.207
Validation loss decreased (-0.199981 --> -0.207389).  Saving model ...
Epoch: 7 cost time: 0.5194878578186035
Epoch: 7, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.770 Vali Acc: 0.230 Test Loss: 1.770 Test Acc: 0.230
Validation loss decreased (-0.207389 --> -0.229612).  Saving model ...
Epoch: 8 cost time: 0.48923659324645996
Epoch: 8, Steps: 2 | Train Loss: 1.772 Vali Loss: 1.692 Vali Acc: 0.259 Test Loss: 1.692 Test Acc: 0.259
Validation loss decreased (-0.229612 --> -0.259242).  Saving model ...
Epoch: 9 cost time: 0.43748974800109863
Epoch: 9, Steps: 2 | Train Loss: 1.625 Vali Loss: 1.610 Vali Acc: 0.307 Test Loss: 1.610 Test Acc: 0.307
Validation loss decreased (-0.259242 --> -0.307391).  Saving model ...
Epoch: 10 cost time: 0.5660684108734131
Epoch: 10, Steps: 2 | Train Loss: 1.612 Vali Loss: 1.527 Vali Acc: 0.378 Test Loss: 1.527 Test Acc: 0.378
Validation loss decreased (-0.307391 --> -0.377763).  Saving model ...
Epoch: 11 cost time: 0.4738895893096924
Epoch: 11, Steps: 2 | Train Loss: 1.586 Vali Loss: 1.441 Vali Acc: 0.456 Test Loss: 1.441 Test Acc: 0.456
Validation loss decreased (-0.377763 --> -0.455541).  Saving model ...
Epoch: 12 cost time: 0.48347949981689453
Epoch: 12, Steps: 2 | Train Loss: 1.456 Vali Loss: 1.356 Vali Acc: 0.537 Test Loss: 1.356 Test Acc: 0.537
Validation loss decreased (-0.455541 --> -0.537023).  Saving model ...
Epoch: 13 cost time: 0.5079193115234375
Epoch: 13, Steps: 2 | Train Loss: 1.283 Vali Loss: 1.272 Vali Acc: 0.600 Test Loss: 1.272 Test Acc: 0.600
Validation loss decreased (-0.537023 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 0.5162982940673828
Epoch: 14, Steps: 2 | Train Loss: 1.244 Vali Loss: 1.188 Vali Acc: 0.659 Test Loss: 1.188 Test Acc: 0.659
Validation loss decreased (-0.599987 --> -0.659247).  Saving model ...
Epoch: 15 cost time: 0.41905713081359863
Epoch: 15, Steps: 2 | Train Loss: 1.175 Vali Loss: 1.108 Vali Acc: 0.722 Test Loss: 1.108 Test Acc: 0.722
Validation loss decreased (-0.659247 --> -0.722211).  Saving model ...
Epoch: 16 cost time: 0.4827868938446045
Epoch: 16, Steps: 2 | Train Loss: 0.954 Vali Loss: 1.032 Vali Acc: 0.748 Test Loss: 1.032 Test Acc: 0.748
Validation loss decreased (-0.722211 --> -0.748138).  Saving model ...
Epoch: 17 cost time: 0.4749321937561035
Epoch: 17, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.962 Vali Acc: 0.770 Test Loss: 0.962 Test Acc: 0.770
Validation loss decreased (-0.748138 --> -0.770361).  Saving model ...
Epoch: 18 cost time: 0.4749774932861328
Epoch: 18, Steps: 2 | Train Loss: 0.797 Vali Loss: 0.896 Vali Acc: 0.807 Test Loss: 0.896 Test Acc: 0.807
Validation loss decreased (-0.770361 --> -0.807398).  Saving model ...
Epoch: 19 cost time: 0.48743724822998047
Epoch: 19, Steps: 2 | Train Loss: 0.727 Vali Loss: 0.833 Vali Acc: 0.844 Test Loss: 0.833 Test Acc: 0.844
Validation loss decreased (-0.807398 --> -0.844436).  Saving model ...
Epoch: 20 cost time: 0.46512293815612793
Epoch: 20, Steps: 2 | Train Loss: 0.700 Vali Loss: 0.773 Vali Acc: 0.867 Test Loss: 0.773 Test Acc: 0.867
Validation loss decreased (-0.844436 --> -0.866659).  Saving model ...
Epoch: 21 cost time: 0.5161089897155762
Epoch: 21, Steps: 2 | Train Loss: 0.657 Vali Loss: 0.718 Vali Acc: 0.874 Test Loss: 0.718 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 22 cost time: 0.4967305660247803
Epoch: 22, Steps: 2 | Train Loss: 0.557 Vali Loss: 0.667 Vali Acc: 0.885 Test Loss: 0.667 Test Acc: 0.885
Validation loss decreased (-0.874067 --> -0.885179).  Saving model ...
Epoch: 23 cost time: 0.47391462326049805
Epoch: 23, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.621 Vali Acc: 0.900 Test Loss: 0.621 Test Acc: 0.900
Validation loss decreased (-0.885179 --> -0.899994).  Saving model ...
Epoch: 24 cost time: 0.5013794898986816
Epoch: 24, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.580 Vali Acc: 0.907 Test Loss: 0.580 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.3977365493774414
Epoch: 25, Steps: 2 | Train Loss: 0.420 Vali Loss: 0.542 Vali Acc: 0.919 Test Loss: 0.542 Test Acc: 0.919
Validation loss decreased (-0.907402 --> -0.918513).  Saving model ...
Epoch: 26 cost time: 0.4762744903564453
Epoch: 26, Steps: 2 | Train Loss: 0.348 Vali Loss: 0.507 Vali Acc: 0.922 Test Loss: 0.507 Test Acc: 0.922
Validation loss decreased (-0.918513 --> -0.922217).  Saving model ...
Epoch: 27 cost time: 0.4735093116760254
Epoch: 27, Steps: 2 | Train Loss: 0.355 Vali Loss: 0.476 Vali Acc: 0.919 Test Loss: 0.476 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4366128444671631
Epoch: 28, Steps: 2 | Train Loss: 0.341 Vali Loss: 0.447 Vali Acc: 0.926 Test Loss: 0.447 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 29 cost time: 0.47124624252319336
Epoch: 29, Steps: 2 | Train Loss: 0.268 Vali Loss: 0.422 Vali Acc: 0.926 Test Loss: 0.422 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.4517545700073242
Epoch: 30, Steps: 2 | Train Loss: 0.226 Vali Loss: 0.400 Vali Acc: 0.926 Test Loss: 0.400 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 31 cost time: 0.48722386360168457
Epoch: 31, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.381 Vali Acc: 0.926 Test Loss: 0.381 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 32 cost time: 0.4653024673461914
Epoch: 32, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.365 Vali Acc: 0.930 Test Loss: 0.365 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 33 cost time: 0.485945463180542
Epoch: 33, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.350 Vali Acc: 0.930 Test Loss: 0.350 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 34 cost time: 0.44464993476867676
Epoch: 34, Steps: 2 | Train Loss: 0.161 Vali Loss: 0.337 Vali Acc: 0.930 Test Loss: 0.337 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 35 cost time: 0.47242283821105957
Epoch: 35, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.327 Vali Acc: 0.930 Test Loss: 0.327 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 36 cost time: 0.4536290168762207
Epoch: 36, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.316 Vali Acc: 0.933 Test Loss: 0.316 Test Acc: 0.933
Validation loss decreased (-0.929626 --> -0.933330).  Saving model ...
Epoch: 37 cost time: 0.48851704597473145
Epoch: 37, Steps: 2 | Train Loss: 0.130 Vali Loss: 0.307 Vali Acc: 0.933 Test Loss: 0.307 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 38 cost time: 0.5208384990692139
Epoch: 38, Steps: 2 | Train Loss: 0.140 Vali Loss: 0.298 Vali Acc: 0.933 Test Loss: 0.298 Test Acc: 0.933
Validation loss decreased (-0.933330 --> -0.933330).  Saving model ...
Epoch: 39 cost time: 0.48189830780029297
Epoch: 39, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.290 Vali Acc: 0.937 Test Loss: 0.290 Test Acc: 0.937
Validation loss decreased (-0.933330 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.5071732997894287
Epoch: 40, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.283 Vali Acc: 0.937 Test Loss: 0.283 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.520313024520874
Epoch: 41, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.277 Vali Acc: 0.937 Test Loss: 0.277 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.429049015045166
Epoch: 42, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.272 Vali Acc: 0.937 Test Loss: 0.272 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 43 cost time: 0.45727109909057617
Epoch: 43, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.268 Vali Acc: 0.937 Test Loss: 0.268 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 44 cost time: 0.4638407230377197
Epoch: 44, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.263 Vali Acc: 0.941 Test Loss: 0.263 Test Acc: 0.941
Validation loss decreased (-0.937034 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.5043351650238037
Epoch: 45, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.259 Vali Acc: 0.941 Test Loss: 0.259 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.47020411491394043
Epoch: 46, Steps: 2 | Train Loss: 0.070 Vali Loss: 0.256 Vali Acc: 0.944 Test Loss: 0.256 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 47 cost time: 0.4894599914550781
Epoch: 47, Steps: 2 | Train Loss: 0.059 Vali Loss: 0.252 Vali Acc: 0.944 Test Loss: 0.252 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 48 cost time: 0.47583460807800293
Epoch: 48, Steps: 2 | Train Loss: 0.055 Vali Loss: 0.250 Vali Acc: 0.944 Test Loss: 0.250 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4613680839538574
Epoch: 49, Steps: 2 | Train Loss: 0.064 Vali Loss: 0.247 Vali Acc: 0.944 Test Loss: 0.247 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.44335174560546875
Epoch: 50, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.245 Vali Acc: 0.944 Test Loss: 0.245 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.44289565086364746
Epoch: 51, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.243 Vali Acc: 0.941 Test Loss: 0.243 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 52 cost time: 0.4818270206451416
Epoch: 52, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.241 Vali Acc: 0.941 Test Loss: 0.241 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 53 cost time: 0.4537394046783447
Epoch: 53, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.240 Vali Acc: 0.941 Test Loss: 0.240 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 54 cost time: 0.47540831565856934
Epoch: 54, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 55 cost time: 0.4294240474700928
Epoch: 55, Steps: 2 | Train Loss: 0.045 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 56 cost time: 0.4192843437194824
Epoch: 56, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 57 cost time: 0.4381084442138672
Epoch: 57, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 58 cost time: 0.4542253017425537
Epoch: 58, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.232 Vali Acc: 0.937 Test Loss: 0.232 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 59 cost time: 0.46348023414611816
Epoch: 59, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
EarlyStopping counter: 9 out of 10
Epoch: 60 cost time: 0.5104541778564453
Epoch: 60, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.229 Vali Acc: 0.941 Test Loss: 0.229 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 31974
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0162291526794434
Epoch: 1, Steps: 2 | Train Loss: 2.136 Vali Loss: 2.070 Vali Acc: 0.200 Test Loss: 2.070 Test Acc: 0.200
Validation loss decreased (inf --> -0.199979).  Saving model ...
Epoch: 2 cost time: 0.49696993827819824
Epoch: 2, Steps: 2 | Train Loss: 2.182 Vali Loss: 2.002 Vali Acc: 0.211 Test Loss: 2.002 Test Acc: 0.211
Validation loss decreased (-0.199979 --> -0.211091).  Saving model ...
Epoch: 3 cost time: 0.5236680507659912
Epoch: 3, Steps: 2 | Train Loss: 1.992 Vali Loss: 1.955 Vali Acc: 0.222 Test Loss: 1.955 Test Acc: 0.222
Validation loss decreased (-0.211091 --> -0.222203).  Saving model ...
Epoch: 4 cost time: 0.5168750286102295
Epoch: 4, Steps: 2 | Train Loss: 2.039 Vali Loss: 1.914 Vali Acc: 0.230 Test Loss: 1.914 Test Acc: 0.230
Validation loss decreased (-0.222203 --> -0.229610).  Saving model ...
Epoch: 5 cost time: 0.4990205764770508
Epoch: 5, Steps: 2 | Train Loss: 1.961 Vali Loss: 1.862 Vali Acc: 0.233 Test Loss: 1.862 Test Acc: 0.233
Validation loss decreased (-0.229610 --> -0.233315).  Saving model ...
Epoch: 6 cost time: 0.5354182720184326
Epoch: 6, Steps: 2 | Train Loss: 1.851 Vali Loss: 1.803 Vali Acc: 0.241 Test Loss: 1.803 Test Acc: 0.241
Validation loss decreased (-0.233315 --> -0.240723).  Saving model ...
Epoch: 7 cost time: 0.49217844009399414
Epoch: 7, Steps: 2 | Train Loss: 1.844 Vali Loss: 1.738 Vali Acc: 0.256 Test Loss: 1.738 Test Acc: 0.256
Validation loss decreased (-0.240723 --> -0.255538).  Saving model ...
Epoch: 8 cost time: 0.514354944229126
Epoch: 8, Steps: 2 | Train Loss: 1.759 Vali Loss: 1.668 Vali Acc: 0.304 Test Loss: 1.668 Test Acc: 0.304
Validation loss decreased (-0.255538 --> -0.303687).  Saving model ...
Epoch: 9 cost time: 0.4326310157775879
Epoch: 9, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.596 Vali Acc: 0.348 Test Loss: 1.596 Test Acc: 0.348
Validation loss decreased (-0.303687 --> -0.348132).  Saving model ...
Epoch: 10 cost time: 0.5192182064056396
Epoch: 10, Steps: 2 | Train Loss: 1.605 Vali Loss: 1.521 Vali Acc: 0.400 Test Loss: 1.521 Test Acc: 0.400
Validation loss decreased (-0.348132 --> -0.399985).  Saving model ...
Epoch: 11 cost time: 0.47063541412353516
Epoch: 11, Steps: 2 | Train Loss: 1.593 Vali Loss: 1.444 Vali Acc: 0.463 Test Loss: 1.444 Test Acc: 0.463
Validation loss decreased (-0.399985 --> -0.462949).  Saving model ...
Epoch: 12 cost time: 0.47727060317993164
Epoch: 12, Steps: 2 | Train Loss: 1.440 Vali Loss: 1.369 Vali Acc: 0.504 Test Loss: 1.369 Test Acc: 0.504
Validation loss decreased (-0.462949 --> -0.503690).  Saving model ...
Epoch: 13 cost time: 0.5204446315765381
Epoch: 13, Steps: 2 | Train Loss: 1.292 Vali Loss: 1.293 Vali Acc: 0.600 Test Loss: 1.293 Test Acc: 0.600
Validation loss decreased (-0.503690 --> -0.599987).  Saving model ...
Epoch: 14 cost time: 0.4184756278991699
Epoch: 14, Steps: 2 | Train Loss: 1.271 Vali Loss: 1.219 Vali Acc: 0.652 Test Loss: 1.219 Test Acc: 0.652
Validation loss decreased (-0.599987 --> -0.651840).  Saving model ...
Epoch: 15 cost time: 0.5212192535400391
Epoch: 15, Steps: 2 | Train Loss: 1.151 Vali Loss: 1.148 Vali Acc: 0.678 Test Loss: 1.148 Test Acc: 0.678
Validation loss decreased (-0.651840 --> -0.677766).  Saving model ...
Epoch: 16 cost time: 0.4669055938720703
Epoch: 16, Steps: 2 | Train Loss: 1.021 Vali Loss: 1.080 Vali Acc: 0.719 Test Loss: 1.080 Test Acc: 0.719
Validation loss decreased (-0.677766 --> -0.718508).  Saving model ...
Epoch: 17 cost time: 0.5360140800476074
Epoch: 17, Steps: 2 | Train Loss: 0.939 Vali Loss: 1.017 Vali Acc: 0.737 Test Loss: 1.017 Test Acc: 0.737
Validation loss decreased (-0.718508 --> -0.737027).  Saving model ...
Epoch: 18 cost time: 0.637479305267334
Epoch: 18, Steps: 2 | Train Loss: 0.878 Vali Loss: 0.959 Vali Acc: 0.744 Test Loss: 0.959 Test Acc: 0.744
Validation loss decreased (-0.737027 --> -0.744435).  Saving model ...
Epoch: 19 cost time: 0.5285696983337402
Epoch: 19, Steps: 2 | Train Loss: 0.840 Vali Loss: 0.904 Vali Acc: 0.752 Test Loss: 0.904 Test Acc: 0.752
Validation loss decreased (-0.744435 --> -0.751843).  Saving model ...
Epoch: 20 cost time: 0.5196168422698975
Epoch: 20, Steps: 2 | Train Loss: 0.771 Vali Loss: 0.850 Vali Acc: 0.793 Test Loss: 0.850 Test Acc: 0.793
Validation loss decreased (-0.751843 --> -0.792584).  Saving model ...
Epoch: 21 cost time: 0.5351264476776123
Epoch: 21, Steps: 2 | Train Loss: 0.732 Vali Loss: 0.801 Vali Acc: 0.807 Test Loss: 0.801 Test Acc: 0.807
Validation loss decreased (-0.792584 --> -0.807399).  Saving model ...
Epoch: 22 cost time: 0.5520083904266357
Epoch: 22, Steps: 2 | Train Loss: 0.656 Vali Loss: 0.754 Vali Acc: 0.811 Test Loss: 0.754 Test Acc: 0.811
Validation loss decreased (-0.807399 --> -0.811104).  Saving model ...
Epoch: 23 cost time: 0.5573852062225342
Epoch: 23, Steps: 2 | Train Loss: 0.620 Vali Loss: 0.713 Vali Acc: 0.815 Test Loss: 0.713 Test Acc: 0.815
Validation loss decreased (-0.811104 --> -0.814808).  Saving model ...
Epoch: 24 cost time: 0.5784006118774414
Epoch: 24, Steps: 2 | Train Loss: 0.558 Vali Loss: 0.675 Vali Acc: 0.826 Test Loss: 0.675 Test Acc: 0.826
Validation loss decreased (-0.814808 --> -0.825919).  Saving model ...
Epoch: 25 cost time: 0.5253238677978516
Epoch: 25, Steps: 2 | Train Loss: 0.527 Vali Loss: 0.640 Vali Acc: 0.830 Test Loss: 0.640 Test Acc: 0.830
Validation loss decreased (-0.825919 --> -0.829623).  Saving model ...
Epoch: 26 cost time: 0.5498526096343994
Epoch: 26, Steps: 2 | Train Loss: 0.448 Vali Loss: 0.609 Vali Acc: 0.841 Test Loss: 0.609 Test Acc: 0.841
Validation loss decreased (-0.829623 --> -0.840735).  Saving model ...
Epoch: 27 cost time: 0.5446891784667969
Epoch: 27, Steps: 2 | Train Loss: 0.444 Vali Loss: 0.581 Vali Acc: 0.844 Test Loss: 0.581 Test Acc: 0.844
Validation loss decreased (-0.840735 --> -0.844439).  Saving model ...
Epoch: 28 cost time: 0.562227725982666
Epoch: 28, Steps: 2 | Train Loss: 0.432 Vali Loss: 0.555 Vali Acc: 0.856 Test Loss: 0.555 Test Acc: 0.856
Validation loss decreased (-0.844439 --> -0.855550).  Saving model ...
Epoch: 29 cost time: 0.5475509166717529
Epoch: 29, Steps: 2 | Train Loss: 0.370 Vali Loss: 0.533 Vali Acc: 0.859 Test Loss: 0.533 Test Acc: 0.859
Validation loss decreased (-0.855550 --> -0.859254).  Saving model ...
Epoch: 30 cost time: 0.5176281929016113
Epoch: 30, Steps: 2 | Train Loss: 0.334 Vali Loss: 0.513 Vali Acc: 0.870 Test Loss: 0.513 Test Acc: 0.870
Validation loss decreased (-0.859254 --> -0.870365).  Saving model ...
Epoch: 31 cost time: 0.5462591648101807
Epoch: 31, Steps: 2 | Train Loss: 0.316 Vali Loss: 0.496 Vali Acc: 0.874 Test Loss: 0.496 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 32 cost time: 0.5446956157684326
Epoch: 32, Steps: 2 | Train Loss: 0.305 Vali Loss: 0.480 Vali Acc: 0.870 Test Loss: 0.480 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.4856834411621094
Epoch: 33, Steps: 2 | Train Loss: 0.301 Vali Loss: 0.467 Vali Acc: 0.874 Test Loss: 0.467 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874069).  Saving model ...
Epoch: 34 cost time: 0.5581507682800293
Epoch: 34, Steps: 2 | Train Loss: 0.260 Vali Loss: 0.454 Vali Acc: 0.874 Test Loss: 0.454 Test Acc: 0.874
Validation loss decreased (-0.874069 --> -0.874070).  Saving model ...
Epoch: 35 cost time: 0.5563035011291504
Epoch: 35, Steps: 2 | Train Loss: 0.240 Vali Loss: 0.444 Vali Acc: 0.859 Test Loss: 0.444 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 0.48938941955566406
Epoch: 36, Steps: 2 | Train Loss: 0.245 Vali Loss: 0.434 Vali Acc: 0.863 Test Loss: 0.434 Test Acc: 0.863
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 0.5202436447143555
Epoch: 37, Steps: 2 | Train Loss: 0.225 Vali Loss: 0.425 Vali Acc: 0.863 Test Loss: 0.425 Test Acc: 0.863
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 0.5157313346862793
Epoch: 38, Steps: 2 | Train Loss: 0.219 Vali Loss: 0.417 Vali Acc: 0.856 Test Loss: 0.417 Test Acc: 0.856
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 0.5004487037658691
Epoch: 39, Steps: 2 | Train Loss: 0.193 Vali Loss: 0.408 Vali Acc: 0.863 Test Loss: 0.408 Test Acc: 0.863
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 0.6095409393310547
Epoch: 40, Steps: 2 | Train Loss: 0.189 Vali Loss: 0.401 Vali Acc: 0.870 Test Loss: 0.401 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 0.529172420501709
Epoch: 41, Steps: 2 | Train Loss: 0.184 Vali Loss: 0.395 Vali Acc: 0.870 Test Loss: 0.395 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 0.4663848876953125
Epoch: 42, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.391 Vali Acc: 0.867 Test Loss: 0.391 Test Acc: 0.867
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 0.5357978343963623
Epoch: 43, Steps: 2 | Train Loss: 0.181 Vali Loss: 0.384 Vali Acc: 0.878 Test Loss: 0.384 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 44 cost time: 0.5011227130889893
Epoch: 44, Steps: 2 | Train Loss: 0.132 Vali Loss: 0.379 Vali Acc: 0.878 Test Loss: 0.379 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 45 cost time: 0.4736206531524658
Epoch: 45, Steps: 2 | Train Loss: 0.128 Vali Loss: 0.376 Vali Acc: 0.870 Test Loss: 0.376 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 46 cost time: 0.5470762252807617
Epoch: 46, Steps: 2 | Train Loss: 0.141 Vali Loss: 0.371 Vali Acc: 0.870 Test Loss: 0.371 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 47 cost time: 0.567133903503418
Epoch: 47, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.369 Vali Acc: 0.870 Test Loss: 0.369 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 48 cost time: 0.4893021583557129
Epoch: 48, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.366 Vali Acc: 0.874 Test Loss: 0.366 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 49 cost time: 0.5252962112426758
Epoch: 49, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.364 Vali Acc: 0.874 Test Loss: 0.364 Test Acc: 0.874
EarlyStopping counter: 5 out of 10
Epoch: 50 cost time: 0.5409882068634033
Epoch: 50, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.362 Vali Acc: 0.874 Test Loss: 0.362 Test Acc: 0.874
EarlyStopping counter: 6 out of 10
Epoch: 51 cost time: 0.5473270416259766
Epoch: 51, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 52 cost time: 0.5308303833007812
Epoch: 52, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.359 Vali Acc: 0.878 Test Loss: 0.359 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 53 cost time: 0.5356040000915527
Epoch: 53, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.358 Vali Acc: 0.874 Test Loss: 0.358 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.5393304824829102
Epoch: 54, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 2 out of 10
Epoch: 55 cost time: 0.5739364624023438
Epoch: 55, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.356 Vali Acc: 0.867 Test Loss: 0.356 Test Acc: 0.867
EarlyStopping counter: 3 out of 10
Epoch: 56 cost time: 0.5669057369232178
Epoch: 56, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.354 Vali Acc: 0.867 Test Loss: 0.354 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 57 cost time: 0.5258543491363525
Epoch: 57, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.351 Vali Acc: 0.867 Test Loss: 0.351 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 58 cost time: 0.5159013271331787
Epoch: 58, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.348 Vali Acc: 0.878 Test Loss: 0.348 Test Acc: 0.878
Validation loss decreased (-0.877774 --> -0.877774).  Saving model ...
Epoch: 59 cost time: 0.5263144969940186
Epoch: 59, Steps: 2 | Train Loss: 0.075 Vali Loss: 0.346 Vali Acc: 0.870 Test Loss: 0.346 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 60 cost time: 0.5263113975524902
Epoch: 60, Steps: 2 | Train Loss: 0.067 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 61 cost time: 0.5292155742645264
Epoch: 61, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.341 Vali Acc: 0.870 Test Loss: 0.341 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 62 cost time: 0.4941442012786865
Epoch: 62, Steps: 2 | Train Loss: 0.094 Vali Loss: 0.340 Vali Acc: 0.867 Test Loss: 0.340 Test Acc: 0.867
EarlyStopping counter: 4 out of 10
Epoch: 63 cost time: 0.5386748313903809
Epoch: 63, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.339 Vali Acc: 0.867 Test Loss: 0.339 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 64 cost time: 0.49695801734924316
Epoch: 64, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.339 Vali Acc: 0.870 Test Loss: 0.339 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 65 cost time: 0.4949338436126709
Epoch: 65, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.337 Vali Acc: 0.870 Test Loss: 0.337 Test Acc: 0.870
EarlyStopping counter: 7 out of 10
Epoch: 66 cost time: 0.4832725524902344
Epoch: 66, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.336 Vali Acc: 0.870 Test Loss: 0.336 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 67 cost time: 0.49037814140319824
Epoch: 67, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 68 cost time: 0.5240163803100586
Epoch: 68, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.335 Vali Acc: 0.867 Test Loss: 0.335 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 31974
model size : 0.74MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2357521057128906
Epoch: 1, Steps: 2 | Train Loss: 2.013 Vali Loss: 1.933 Vali Acc: 0.115 Test Loss: 1.933 Test Acc: 0.115
Validation loss decreased (inf --> -0.114795).  Saving model ...
Epoch: 2 cost time: 0.5288949012756348
Epoch: 2, Steps: 2 | Train Loss: 1.913 Vali Loss: 1.871 Vali Acc: 0.122 Test Loss: 1.871 Test Acc: 0.122
Validation loss decreased (-0.114795 --> -0.122204).  Saving model ...
Epoch: 3 cost time: 0.5306077003479004
Epoch: 3, Steps: 2 | Train Loss: 1.745 Vali Loss: 1.825 Vali Acc: 0.141 Test Loss: 1.825 Test Acc: 0.141
Validation loss decreased (-0.122204 --> -0.140722).  Saving model ...
Epoch: 4 cost time: 0.5423643589019775
Epoch: 4, Steps: 2 | Train Loss: 1.748 Vali Loss: 1.783 Vali Acc: 0.152 Test Loss: 1.783 Test Acc: 0.152
Validation loss decreased (-0.140722 --> -0.151834).  Saving model ...
Epoch: 5 cost time: 0.5704307556152344
Epoch: 5, Steps: 2 | Train Loss: 1.655 Vali Loss: 1.729 Vali Acc: 0.189 Test Loss: 1.729 Test Acc: 0.189
Validation loss decreased (-0.151834 --> -0.188872).  Saving model ...
Epoch: 6 cost time: 0.5469865798950195
Epoch: 6, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.666 Vali Acc: 0.274 Test Loss: 1.666 Test Acc: 0.274
Validation loss decreased (-0.188872 --> -0.274057).  Saving model ...
Epoch: 7 cost time: 0.5603814125061035
Epoch: 7, Steps: 2 | Train Loss: 1.627 Vali Loss: 1.595 Vali Acc: 0.348 Test Loss: 1.595 Test Acc: 0.348
Validation loss decreased (-0.274057 --> -0.348132).  Saving model ...
Epoch: 8 cost time: 0.5339133739471436
Epoch: 8, Steps: 2 | Train Loss: 1.524 Vali Loss: 1.520 Vali Acc: 0.407 Test Loss: 1.520 Test Acc: 0.407
Validation loss decreased (-0.348132 --> -0.407392).  Saving model ...
Epoch: 9 cost time: 0.546628475189209
Epoch: 9, Steps: 2 | Train Loss: 1.355 Vali Loss: 1.443 Vali Acc: 0.481 Test Loss: 1.443 Test Acc: 0.481
Validation loss decreased (-0.407392 --> -0.481467).  Saving model ...
Epoch: 10 cost time: 0.5005600452423096
Epoch: 10, Steps: 2 | Train Loss: 1.331 Vali Loss: 1.363 Vali Acc: 0.567 Test Loss: 1.363 Test Acc: 0.567
Validation loss decreased (-0.481467 --> -0.566653).  Saving model ...
Epoch: 11 cost time: 0.5313267707824707
Epoch: 11, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.283 Vali Acc: 0.626 Test Loss: 1.283 Test Acc: 0.626
Validation loss decreased (-0.566653 --> -0.625913).  Saving model ...
Epoch: 12 cost time: 0.5130195617675781
Epoch: 12, Steps: 2 | Train Loss: 1.141 Vali Loss: 1.203 Vali Acc: 0.681 Test Loss: 1.203 Test Acc: 0.681
Validation loss decreased (-0.625913 --> -0.681469).  Saving model ...
Epoch: 13 cost time: 0.48490214347839355
Epoch: 13, Steps: 2 | Train Loss: 1.088 Vali Loss: 1.124 Vali Acc: 0.719 Test Loss: 1.124 Test Acc: 0.719
Validation loss decreased (-0.681469 --> -0.718507).  Saving model ...
Epoch: 14 cost time: 0.5129644870758057
Epoch: 14, Steps: 2 | Train Loss: 1.032 Vali Loss: 1.047 Vali Acc: 0.748 Test Loss: 1.047 Test Acc: 0.748
Validation loss decreased (-0.718507 --> -0.748138).  Saving model ...
Epoch: 15 cost time: 0.45533037185668945
Epoch: 15, Steps: 2 | Train Loss: 0.854 Vali Loss: 0.974 Vali Acc: 0.774 Test Loss: 0.974 Test Acc: 0.774
Validation loss decreased (-0.748138 --> -0.774064).  Saving model ...
Epoch: 16 cost time: 0.561093807220459
Epoch: 16, Steps: 2 | Train Loss: 0.777 Vali Loss: 0.906 Vali Acc: 0.804 Test Loss: 0.906 Test Acc: 0.804
Validation loss decreased (-0.774064 --> -0.803695).  Saving model ...
Epoch: 17 cost time: 0.5205121040344238
Epoch: 17, Steps: 2 | Train Loss: 0.764 Vali Loss: 0.841 Vali Acc: 0.815 Test Loss: 0.841 Test Acc: 0.815
Validation loss decreased (-0.803695 --> -0.814806).  Saving model ...
Epoch: 18 cost time: 0.5464825630187988
Epoch: 18, Steps: 2 | Train Loss: 0.607 Vali Loss: 0.782 Vali Acc: 0.837 Test Loss: 0.782 Test Acc: 0.837
Validation loss decreased (-0.814806 --> -0.837029).  Saving model ...
Epoch: 19 cost time: 0.5349411964416504
Epoch: 19, Steps: 2 | Train Loss: 0.562 Vali Loss: 0.726 Vali Acc: 0.841 Test Loss: 0.726 Test Acc: 0.841
Validation loss decreased (-0.837029 --> -0.840733).  Saving model ...
Epoch: 20 cost time: 0.5201795101165771
Epoch: 20, Steps: 2 | Train Loss: 0.572 Vali Loss: 0.674 Vali Acc: 0.863 Test Loss: 0.674 Test Acc: 0.863
Validation loss decreased (-0.840733 --> -0.862956).  Saving model ...
Epoch: 21 cost time: 0.5163328647613525
Epoch: 21, Steps: 2 | Train Loss: 0.475 Vali Loss: 0.626 Vali Acc: 0.889 Test Loss: 0.626 Test Acc: 0.889
Validation loss decreased (-0.862956 --> -0.888883).  Saving model ...
Epoch: 22 cost time: 0.5241084098815918
Epoch: 22, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.582 Vali Acc: 0.904 Test Loss: 0.582 Test Acc: 0.904
Validation loss decreased (-0.888883 --> -0.903698).  Saving model ...
Epoch: 23 cost time: 0.5664682388305664
Epoch: 23, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.542 Vali Acc: 0.907 Test Loss: 0.542 Test Acc: 0.907
Validation loss decreased (-0.903698 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.5548582077026367
Epoch: 24, Steps: 2 | Train Loss: 0.317 Vali Loss: 0.508 Vali Acc: 0.911 Test Loss: 0.508 Test Acc: 0.911
Validation loss decreased (-0.907402 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.5156092643737793
Epoch: 25, Steps: 2 | Train Loss: 0.323 Vali Loss: 0.477 Vali Acc: 0.915 Test Loss: 0.477 Test Acc: 0.915
Validation loss decreased (-0.911106 --> -0.914810).  Saving model ...
Epoch: 26 cost time: 0.5441579818725586
Epoch: 26, Steps: 2 | Train Loss: 0.288 Vali Loss: 0.448 Vali Acc: 0.919 Test Loss: 0.448 Test Acc: 0.919
Validation loss decreased (-0.914810 --> -0.918514).  Saving model ...
Epoch: 27 cost time: 0.5144717693328857
Epoch: 27, Steps: 2 | Train Loss: 0.255 Vali Loss: 0.422 Vali Acc: 0.926 Test Loss: 0.422 Test Acc: 0.926
Validation loss decreased (-0.918514 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.5299017429351807
Epoch: 28, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.399 Vali Acc: 0.930 Test Loss: 0.399 Test Acc: 0.930
Validation loss decreased (-0.925922 --> -0.929626).  Saving model ...
Epoch: 29 cost time: 0.5142805576324463
Epoch: 29, Steps: 2 | Train Loss: 0.223 Vali Loss: 0.378 Vali Acc: 0.930 Test Loss: 0.378 Test Acc: 0.930
Validation loss decreased (-0.929626 --> -0.929626).  Saving model ...
Epoch: 30 cost time: 0.5518858432769775
Epoch: 30, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.360 Vali Acc: 0.937 Test Loss: 0.360 Test Acc: 0.937
Validation loss decreased (-0.929626 --> -0.937033).  Saving model ...
Epoch: 31 cost time: 0.6007823944091797
Epoch: 31, Steps: 2 | Train Loss: 0.172 Vali Loss: 0.343 Vali Acc: 0.937 Test Loss: 0.343 Test Acc: 0.937
Validation loss decreased (-0.937033 --> -0.937034).  Saving model ...
Epoch: 32 cost time: 0.5131235122680664
Epoch: 32, Steps: 2 | Train Loss: 0.138 Vali Loss: 0.329 Vali Acc: 0.933 Test Loss: 0.329 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 0.5333774089813232
Epoch: 33, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.316 Vali Acc: 0.930 Test Loss: 0.316 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 0.5168139934539795
Epoch: 34, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.305 Vali Acc: 0.933 Test Loss: 0.305 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 0.5543270111083984
Epoch: 35, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.295 Vali Acc: 0.933 Test Loss: 0.295 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 0.5321633815765381
Epoch: 36, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.287 Vali Acc: 0.933 Test Loss: 0.287 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 0.5618047714233398
Epoch: 37, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.279 Vali Acc: 0.937 Test Loss: 0.279 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 38 cost time: 0.5230143070220947
Epoch: 38, Steps: 2 | Train Loss: 0.088 Vali Loss: 0.272 Vali Acc: 0.933 Test Loss: 0.272 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5354831218719482
Epoch: 39, Steps: 2 | Train Loss: 0.078 Vali Loss: 0.266 Vali Acc: 0.937 Test Loss: 0.266 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 40 cost time: 0.4902153015136719
Epoch: 40, Steps: 2 | Train Loss: 0.079 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 41 cost time: 0.49231433868408203
Epoch: 41, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 42 cost time: 0.5031850337982178
Epoch: 42, Steps: 2 | Train Loss: 0.072 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.5153882503509521
Epoch: 43, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 44 cost time: 0.4652211666107178
Epoch: 44, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.241 Vali Acc: 0.937 Test Loss: 0.241 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 45 cost time: 0.4612581729888916
Epoch: 45, Steps: 2 | Train Loss: 0.056 Vali Loss: 0.237 Vali Acc: 0.937 Test Loss: 0.237 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 46 cost time: 0.4114549160003662
Epoch: 46, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 47 cost time: 0.4163994789123535
Epoch: 47, Steps: 2 | Train Loss: 0.051 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 48 cost time: 0.44916582107543945
Epoch: 48, Steps: 2 | Train Loss: 0.036 Vali Loss: 0.228 Vali Acc: 0.937 Test Loss: 0.228 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 49 cost time: 0.5409173965454102
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.5002386569976807
Epoch: 50, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.4912679195404053
Epoch: 51, Steps: 2 | Train Loss: 0.033 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.5052824020385742
Epoch: 52, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.47658610343933105
Epoch: 53, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 54 cost time: 0.5392484664916992
Epoch: 54, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.215 Vali Acc: 0.941 Test Loss: 0.215 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 55 cost time: 0.5727028846740723
Epoch: 55, Steps: 2 | Train Loss: 0.037 Vali Loss: 0.213 Vali Acc: 0.941 Test Loss: 0.213 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 56 cost time: 0.5191895961761475
Epoch: 56, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 57 cost time: 0.5244276523590088
Epoch: 57, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 58 cost time: 0.5349440574645996
Epoch: 58, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 59 cost time: 0.5330634117126465
Epoch: 59, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.207 Vali Acc: 0.941 Test Loss: 0.207 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 60 cost time: 0.5145411491394043
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.941 Test Loss: 0.205 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 61 cost time: 0.5188984870910645
Epoch: 61, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.204 Vali Acc: 0.941 Test Loss: 0.204 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 62 cost time: 0.5258338451385498
Epoch: 62, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 63 cost time: 0.493532657623291
Epoch: 63, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.203 Vali Acc: 0.941 Test Loss: 0.203 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 64 cost time: 0.5030195713043213
Epoch: 64, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.202 Vali Acc: 0.941 Test Loss: 0.202 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 65 cost time: 0.4620330333709717
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.201 Vali Acc: 0.937 Test Loss: 0.201 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 66 cost time: 0.4691779613494873
Epoch: 66, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.200 Vali Acc: 0.937 Test Loss: 0.200 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 67 cost time: 0.5311272144317627
Epoch: 67, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 68 cost time: 0.47247982025146484
Epoch: 68, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 69 cost time: 0.482011079788208
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.937 Test Loss: 0.197 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 70 cost time: 0.48629021644592285
Epoch: 70, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 71 cost time: 0.43404650688171387
Epoch: 71, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.196 Vali Acc: 0.941 Test Loss: 0.196 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 72 cost time: 0.4549558162689209
Epoch: 72, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 73 cost time: 0.4596097469329834
Epoch: 73, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 74 cost time: 0.4940760135650635
Epoch: 74, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 75 cost time: 0.4930870532989502
Epoch: 75, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 76 cost time: 0.5316450595855713
Epoch: 76, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.193 Vali Acc: 0.941 Test Loss: 0.193 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 77 cost time: 0.5630075931549072
Epoch: 77, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 78 cost time: 0.5121517181396484
Epoch: 78, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.192 Vali Acc: 0.941 Test Loss: 0.192 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 79 cost time: 0.5724003314971924
Epoch: 79, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 80 cost time: 0.580984354019165
Epoch: 80, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 81 cost time: 0.5599608421325684
Epoch: 81, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.191 Vali Acc: 0.937 Test Loss: 0.191 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 82 cost time: 0.5679965019226074
Epoch: 82, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 83 cost time: 0.5028059482574463
Epoch: 83, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.190 Vali Acc: 0.941 Test Loss: 0.190 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 84 cost time: 0.5849502086639404
Epoch: 84, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 85 cost time: 0.5304093360900879
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 86 cost time: 0.49171900749206543
Epoch: 86, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.189 Vali Acc: 0.941 Test Loss: 0.189 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 87 cost time: 0.534965991973877
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 88 cost time: 0.5804615020751953
Epoch: 88, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 89 cost time: 0.5174179077148438
Epoch: 89, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.188 Vali Acc: 0.941 Test Loss: 0.188 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 90 cost time: 0.5278275012969971
Epoch: 90, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 91 cost time: 0.5585019588470459
Epoch: 91, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.187 Vali Acc: 0.941 Test Loss: 0.187 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 92 cost time: 0.4831411838531494
Epoch: 92, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.186 Vali Acc: 0.941 Test Loss: 0.186 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 93 cost time: 0.5451977252960205
Epoch: 93, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.185 Vali Acc: 0.944 Test Loss: 0.185 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944443).  Saving model ...
Epoch: 94 cost time: 0.5425190925598145
Epoch: 94, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 95 cost time: 0.4834468364715576
Epoch: 95, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.184 Vali Acc: 0.944 Test Loss: 0.184 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 96 cost time: 0.5202922821044922
Epoch: 96, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 97 cost time: 0.5416309833526611
Epoch: 97, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.183 Vali Acc: 0.944 Test Loss: 0.183 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 98 cost time: 0.4929838180541992
Epoch: 98, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 99 cost time: 0.5082423686981201
Epoch: 99, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
Epoch: 100 cost time: 0.553746223449707
Epoch: 100, Steps: 2 | Train Loss: 0.008 Vali Loss: 0.182 Vali Acc: 0.944 Test Loss: 0.182 Test Acc: 0.944
Validation loss decreased (-0.944443 --> -0.944443).  Saving model ...
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 23782
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.2827000617980957
Epoch: 1, Steps: 2 | Train Loss: 2.038 Vali Loss: 1.912 Vali Acc: 0.119 Test Loss: 1.912 Test Acc: 0.119
Validation loss decreased (inf --> -0.118499).  Saving model ...
Epoch: 2 cost time: 0.4853191375732422
Epoch: 2, Steps: 2 | Train Loss: 1.895 Vali Loss: 1.850 Vali Acc: 0.126 Test Loss: 1.850 Test Acc: 0.126
Validation loss decreased (-0.118499 --> -0.125907).  Saving model ...
Epoch: 3 cost time: 0.48421239852905273
Epoch: 3, Steps: 2 | Train Loss: 1.731 Vali Loss: 1.804 Vali Acc: 0.141 Test Loss: 1.804 Test Acc: 0.141
Validation loss decreased (-0.125907 --> -0.140723).  Saving model ...
Epoch: 4 cost time: 0.4689304828643799
Epoch: 4, Steps: 2 | Train Loss: 1.738 Vali Loss: 1.763 Vali Acc: 0.156 Test Loss: 1.763 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 5 cost time: 0.49860358238220215
Epoch: 5, Steps: 2 | Train Loss: 1.671 Vali Loss: 1.709 Vali Acc: 0.211 Test Loss: 1.709 Test Acc: 0.211
Validation loss decreased (-0.155538 --> -0.211094).  Saving model ...
Epoch: 6 cost time: 0.5326168537139893
Epoch: 6, Steps: 2 | Train Loss: 1.662 Vali Loss: 1.646 Vali Acc: 0.274 Test Loss: 1.646 Test Acc: 0.274
Validation loss decreased (-0.211094 --> -0.274058).  Saving model ...
Epoch: 7 cost time: 0.5157349109649658
Epoch: 7, Steps: 2 | Train Loss: 1.614 Vali Loss: 1.576 Vali Acc: 0.356 Test Loss: 1.576 Test Acc: 0.356
Validation loss decreased (-0.274058 --> -0.355540).  Saving model ...
Epoch: 8 cost time: 0.49570560455322266
Epoch: 8, Steps: 2 | Train Loss: 1.530 Vali Loss: 1.500 Vali Acc: 0.437 Test Loss: 1.500 Test Acc: 0.437
Validation loss decreased (-0.355540 --> -0.437022).  Saving model ...
Epoch: 9 cost time: 0.5237410068511963
Epoch: 9, Steps: 2 | Train Loss: 1.359 Vali Loss: 1.423 Vali Acc: 0.533 Test Loss: 1.423 Test Acc: 0.533
Validation loss decreased (-0.437022 --> -0.533319).  Saving model ...
Epoch: 10 cost time: 0.48655200004577637
Epoch: 10, Steps: 2 | Train Loss: 1.341 Vali Loss: 1.345 Vali Acc: 0.589 Test Loss: 1.345 Test Acc: 0.589
Validation loss decreased (-0.533319 --> -0.588875).  Saving model ...
Epoch: 11 cost time: 0.5153055191040039
Epoch: 11, Steps: 2 | Train Loss: 1.302 Vali Loss: 1.265 Vali Acc: 0.648 Test Loss: 1.265 Test Acc: 0.648
Validation loss decreased (-0.588875 --> -0.648135).  Saving model ...
Epoch: 12 cost time: 0.5745606422424316
Epoch: 12, Steps: 2 | Train Loss: 1.123 Vali Loss: 1.186 Vali Acc: 0.700 Test Loss: 1.186 Test Acc: 0.700
Validation loss decreased (-0.648135 --> -0.699988).  Saving model ...
Epoch: 13 cost time: 0.47410035133361816
Epoch: 13, Steps: 2 | Train Loss: 1.083 Vali Loss: 1.108 Vali Acc: 0.730 Test Loss: 1.108 Test Acc: 0.730
Validation loss decreased (-0.699988 --> -0.729619).  Saving model ...
Epoch: 14 cost time: 0.4739682674407959
Epoch: 14, Steps: 2 | Train Loss: 1.026 Vali Loss: 1.033 Vali Acc: 0.752 Test Loss: 1.033 Test Acc: 0.752
Validation loss decreased (-0.729619 --> -0.751842).  Saving model ...
Epoch: 15 cost time: 0.4200758934020996
Epoch: 15, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.961 Vali Acc: 0.793 Test Loss: 0.961 Test Acc: 0.793
Validation loss decreased (-0.751842 --> -0.792583).  Saving model ...
Epoch: 16 cost time: 0.4354567527770996
Epoch: 16, Steps: 2 | Train Loss: 0.782 Vali Loss: 0.893 Vali Acc: 0.811 Test Loss: 0.893 Test Acc: 0.811
Validation loss decreased (-0.792583 --> -0.811102).  Saving model ...
Epoch: 17 cost time: 0.41628146171569824
Epoch: 17, Steps: 2 | Train Loss: 0.780 Vali Loss: 0.830 Vali Acc: 0.826 Test Loss: 0.830 Test Acc: 0.826
Validation loss decreased (-0.811102 --> -0.825918).  Saving model ...
Epoch: 18 cost time: 0.44934988021850586
Epoch: 18, Steps: 2 | Train Loss: 0.622 Vali Loss: 0.771 Vali Acc: 0.841 Test Loss: 0.771 Test Acc: 0.841
Validation loss decreased (-0.825918 --> -0.840733).  Saving model ...
Epoch: 19 cost time: 0.4376492500305176
Epoch: 19, Steps: 2 | Train Loss: 0.583 Vali Loss: 0.718 Vali Acc: 0.856 Test Loss: 0.718 Test Acc: 0.856
Validation loss decreased (-0.840733 --> -0.855548).  Saving model ...
Epoch: 20 cost time: 0.4417123794555664
Epoch: 20, Steps: 2 | Train Loss: 0.587 Vali Loss: 0.667 Vali Acc: 0.852 Test Loss: 0.667 Test Acc: 0.852
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 0.4428231716156006
Epoch: 21, Steps: 2 | Train Loss: 0.503 Vali Loss: 0.620 Vali Acc: 0.881 Test Loss: 0.620 Test Acc: 0.881
Validation loss decreased (-0.855548 --> -0.881475).  Saving model ...
Epoch: 22 cost time: 0.4454045295715332
Epoch: 22, Steps: 2 | Train Loss: 0.443 Vali Loss: 0.576 Vali Acc: 0.900 Test Loss: 0.576 Test Acc: 0.900
Validation loss decreased (-0.881475 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.41794323921203613
Epoch: 23, Steps: 2 | Train Loss: 0.390 Vali Loss: 0.537 Vali Acc: 0.919 Test Loss: 0.537 Test Acc: 0.919
Validation loss decreased (-0.899994 --> -0.918513).  Saving model ...
Epoch: 24 cost time: 0.4521496295928955
Epoch: 24, Steps: 2 | Train Loss: 0.333 Vali Loss: 0.503 Vali Acc: 0.919 Test Loss: 0.503 Test Acc: 0.919
Validation loss decreased (-0.918513 --> -0.918513).  Saving model ...
Epoch: 25 cost time: 0.4977095127105713
Epoch: 25, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.472 Vali Acc: 0.926 Test Loss: 0.472 Test Acc: 0.926
Validation loss decreased (-0.918513 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.5196659564971924
Epoch: 26, Steps: 2 | Train Loss: 0.291 Vali Loss: 0.444 Vali Acc: 0.933 Test Loss: 0.444 Test Acc: 0.933
Validation loss decreased (-0.925921 --> -0.933329).  Saving model ...
Epoch: 27 cost time: 0.5348939895629883
Epoch: 27, Steps: 2 | Train Loss: 0.274 Vali Loss: 0.419 Vali Acc: 0.933 Test Loss: 0.419 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 28 cost time: 0.5130646228790283
Epoch: 28, Steps: 2 | Train Loss: 0.251 Vali Loss: 0.395 Vali Acc: 0.933 Test Loss: 0.395 Test Acc: 0.933
Validation loss decreased (-0.933329 --> -0.933329).  Saving model ...
Epoch: 29 cost time: 0.4807717800140381
Epoch: 29, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.374 Vali Acc: 0.937 Test Loss: 0.374 Test Acc: 0.937
Validation loss decreased (-0.933329 --> -0.937033).  Saving model ...
Epoch: 30 cost time: 0.5201067924499512
Epoch: 30, Steps: 2 | Train Loss: 0.215 Vali Loss: 0.356 Vali Acc: 0.933 Test Loss: 0.356 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.483823299407959
Epoch: 31, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.340 Vali Acc: 0.930 Test Loss: 0.340 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.45572352409362793
Epoch: 32, Steps: 2 | Train Loss: 0.152 Vali Loss: 0.325 Vali Acc: 0.930 Test Loss: 0.325 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.4636268615722656
Epoch: 33, Steps: 2 | Train Loss: 0.135 Vali Loss: 0.312 Vali Acc: 0.930 Test Loss: 0.312 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.46570658683776855
Epoch: 34, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.301 Vali Acc: 0.933 Test Loss: 0.301 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.4800741672515869
Epoch: 35, Steps: 2 | Train Loss: 0.127 Vali Loss: 0.291 Vali Acc: 0.933 Test Loss: 0.291 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 0.4374690055847168
Epoch: 36, Steps: 2 | Train Loss: 0.129 Vali Loss: 0.282 Vali Acc: 0.933 Test Loss: 0.282 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 0.505774736404419
Epoch: 37, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.275 Vali Acc: 0.933 Test Loss: 0.275 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 0.4814157485961914
Epoch: 38, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.268 Vali Acc: 0.933 Test Loss: 0.268 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 0.4714360237121582
Epoch: 39, Steps: 2 | Train Loss: 0.096 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.937037037037037
model parameter : 23782
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9412899017333984
Epoch: 1, Steps: 2 | Train Loss: 2.003 Vali Loss: 1.885 Vali Acc: 0.144 Test Loss: 1.885 Test Acc: 0.144
Validation loss decreased (inf --> -0.144426).  Saving model ...
Epoch: 2 cost time: 0.4553718566894531
Epoch: 2, Steps: 2 | Train Loss: 1.883 Vali Loss: 1.824 Vali Acc: 0.163 Test Loss: 1.824 Test Acc: 0.163
Validation loss decreased (-0.144426 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.47665953636169434
Epoch: 3, Steps: 2 | Train Loss: 1.724 Vali Loss: 1.779 Vali Acc: 0.167 Test Loss: 1.779 Test Acc: 0.167
Validation loss decreased (-0.162945 --> -0.166649).  Saving model ...
Epoch: 4 cost time: 0.4446146488189697
Epoch: 4, Steps: 2 | Train Loss: 1.743 Vali Loss: 1.738 Vali Acc: 0.178 Test Loss: 1.738 Test Acc: 0.178
Validation loss decreased (-0.166649 --> -0.177760).  Saving model ...
Epoch: 5 cost time: 0.44663166999816895
Epoch: 5, Steps: 2 | Train Loss: 1.636 Vali Loss: 1.686 Vali Acc: 0.196 Test Loss: 1.686 Test Acc: 0.196
Validation loss decreased (-0.177760 --> -0.196279).  Saving model ...
Epoch: 6 cost time: 0.4449758529663086
Epoch: 6, Steps: 2 | Train Loss: 1.674 Vali Loss: 1.624 Vali Acc: 0.241 Test Loss: 1.624 Test Acc: 0.241
Validation loss decreased (-0.196279 --> -0.240725).  Saving model ...
Epoch: 7 cost time: 0.49625277519226074
Epoch: 7, Steps: 2 | Train Loss: 1.589 Vali Loss: 1.556 Vali Acc: 0.356 Test Loss: 1.556 Test Acc: 0.356
Validation loss decreased (-0.240725 --> -0.355540).  Saving model ...
Epoch: 8 cost time: 0.506049633026123
Epoch: 8, Steps: 2 | Train Loss: 1.528 Vali Loss: 1.482 Vali Acc: 0.437 Test Loss: 1.482 Test Acc: 0.437
Validation loss decreased (-0.355540 --> -0.437022).  Saving model ...
Epoch: 9 cost time: 0.46712517738342285
Epoch: 9, Steps: 2 | Train Loss: 1.364 Vali Loss: 1.407 Vali Acc: 0.507 Test Loss: 1.407 Test Acc: 0.507
Validation loss decreased (-0.437022 --> -0.507393).  Saving model ...
Epoch: 10 cost time: 0.4975099563598633
Epoch: 10, Steps: 2 | Train Loss: 1.288 Vali Loss: 1.330 Vali Acc: 0.615 Test Loss: 1.330 Test Acc: 0.615
Validation loss decreased (-0.507393 --> -0.614802).  Saving model ...
Epoch: 11 cost time: 0.44896769523620605
Epoch: 11, Steps: 2 | Train Loss: 1.317 Vali Loss: 1.251 Vali Acc: 0.663 Test Loss: 1.251 Test Acc: 0.663
Validation loss decreased (-0.614802 --> -0.662950).  Saving model ...
Epoch: 12 cost time: 0.4918994903564453
Epoch: 12, Steps: 2 | Train Loss: 1.135 Vali Loss: 1.174 Vali Acc: 0.722 Test Loss: 1.174 Test Acc: 0.722
Validation loss decreased (-0.662950 --> -0.722210).  Saving model ...
Epoch: 13 cost time: 0.4751248359680176
Epoch: 13, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.098 Vali Acc: 0.756 Test Loss: 1.098 Test Acc: 0.756
Validation loss decreased (-0.722210 --> -0.755545).  Saving model ...
Epoch: 14 cost time: 0.46183228492736816
Epoch: 14, Steps: 2 | Train Loss: 1.007 Vali Loss: 1.024 Vali Acc: 0.778 Test Loss: 1.024 Test Acc: 0.778
Validation loss decreased (-0.755545 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 0.48219799995422363
Epoch: 15, Steps: 2 | Train Loss: 0.885 Vali Loss: 0.954 Vali Acc: 0.807 Test Loss: 0.954 Test Acc: 0.807
Validation loss decreased (-0.777768 --> -0.807398).  Saving model ...
Epoch: 16 cost time: 0.4608163833618164
Epoch: 16, Steps: 2 | Train Loss: 0.818 Vali Loss: 0.888 Vali Acc: 0.822 Test Loss: 0.888 Test Acc: 0.822
Validation loss decreased (-0.807398 --> -0.822213).  Saving model ...
Epoch: 17 cost time: 0.5588879585266113
Epoch: 17, Steps: 2 | Train Loss: 0.787 Vali Loss: 0.827 Vali Acc: 0.833 Test Loss: 0.827 Test Acc: 0.833
Validation loss decreased (-0.822213 --> -0.833325).  Saving model ...
Epoch: 18 cost time: 0.525505542755127
Epoch: 18, Steps: 2 | Train Loss: 0.639 Vali Loss: 0.771 Vali Acc: 0.848 Test Loss: 0.771 Test Acc: 0.848
Validation loss decreased (-0.833325 --> -0.848140).  Saving model ...
Epoch: 19 cost time: 0.5688085556030273
Epoch: 19, Steps: 2 | Train Loss: 0.579 Vali Loss: 0.718 Vali Acc: 0.867 Test Loss: 0.718 Test Acc: 0.867
Validation loss decreased (-0.848140 --> -0.866659).  Saving model ...
Epoch: 20 cost time: 0.5373296737670898
Epoch: 20, Steps: 2 | Train Loss: 0.603 Vali Loss: 0.669 Vali Acc: 0.896 Test Loss: 0.669 Test Acc: 0.896
Validation loss decreased (-0.866659 --> -0.896290).  Saving model ...
Epoch: 21 cost time: 0.41913890838623047
Epoch: 21, Steps: 2 | Train Loss: 0.510 Vali Loss: 0.623 Vali Acc: 0.922 Test Loss: 0.623 Test Acc: 0.922
Validation loss decreased (-0.896290 --> -0.922216).  Saving model ...
Epoch: 22 cost time: 0.5495414733886719
Epoch: 22, Steps: 2 | Train Loss: 0.472 Vali Loss: 0.582 Vali Acc: 0.919 Test Loss: 0.582 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 0.4820265769958496
Epoch: 23, Steps: 2 | Train Loss: 0.440 Vali Loss: 0.545 Vali Acc: 0.922 Test Loss: 0.545 Test Acc: 0.922
Validation loss decreased (-0.922216 --> -0.922217).  Saving model ...
Epoch: 24 cost time: 0.4598274230957031
Epoch: 24, Steps: 2 | Train Loss: 0.365 Vali Loss: 0.513 Vali Acc: 0.926 Test Loss: 0.513 Test Acc: 0.926
Validation loss decreased (-0.922217 --> -0.925921).  Saving model ...
Epoch: 25 cost time: 0.4539761543273926
Epoch: 25, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.483 Vali Acc: 0.926 Test Loss: 0.483 Test Acc: 0.926
Validation loss decreased (-0.925921 --> -0.925921).  Saving model ...
Epoch: 26 cost time: 0.4780607223510742
Epoch: 26, Steps: 2 | Train Loss: 0.326 Vali Loss: 0.457 Vali Acc: 0.930 Test Loss: 0.457 Test Acc: 0.930
Validation loss decreased (-0.925921 --> -0.929625).  Saving model ...
Epoch: 27 cost time: 0.44917845726013184
Epoch: 27, Steps: 2 | Train Loss: 0.306 Vali Loss: 0.434 Vali Acc: 0.926 Test Loss: 0.434 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 0.4311635494232178
Epoch: 28, Steps: 2 | Train Loss: 0.281 Vali Loss: 0.412 Vali Acc: 0.941 Test Loss: 0.412 Test Acc: 0.941
Validation loss decreased (-0.929625 --> -0.940737).  Saving model ...
Epoch: 29 cost time: 0.4223184585571289
Epoch: 29, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.391 Vali Acc: 0.933 Test Loss: 0.391 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.41684913635253906
Epoch: 30, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.374 Vali Acc: 0.930 Test Loss: 0.374 Test Acc: 0.930
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.43830156326293945
Epoch: 31, Steps: 2 | Train Loss: 0.213 Vali Loss: 0.358 Vali Acc: 0.930 Test Loss: 0.358 Test Acc: 0.930
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.5478494167327881
Epoch: 32, Steps: 2 | Train Loss: 0.171 Vali Loss: 0.344 Vali Acc: 0.930 Test Loss: 0.344 Test Acc: 0.930
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.441373348236084
Epoch: 33, Steps: 2 | Train Loss: 0.157 Vali Loss: 0.331 Vali Acc: 0.930 Test Loss: 0.331 Test Acc: 0.930
EarlyStopping counter: 5 out of 10
Epoch: 34 cost time: 0.44214963912963867
Epoch: 34, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.320 Vali Acc: 0.937 Test Loss: 0.320 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 35 cost time: 0.44523024559020996
Epoch: 35, Steps: 2 | Train Loss: 0.147 Vali Loss: 0.310 Vali Acc: 0.937 Test Loss: 0.310 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 36 cost time: 0.42855358123779297
Epoch: 36, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.301 Vali Acc: 0.937 Test Loss: 0.301 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 37 cost time: 0.3926875591278076
Epoch: 37, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.292 Vali Acc: 0.933 Test Loss: 0.292 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 38 cost time: 0.44901490211486816
Epoch: 38, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.285 Vali Acc: 0.937 Test Loss: 0.285 Test Acc: 0.937
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 23782
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.1818935871124268
Epoch: 1, Steps: 2 | Train Loss: 1.976 Vali Loss: 1.879 Vali Acc: 0.130 Test Loss: 1.879 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.4596214294433594
Epoch: 2, Steps: 2 | Train Loss: 1.890 Vali Loss: 1.821 Vali Acc: 0.133 Test Loss: 1.821 Test Acc: 0.133
Validation loss decreased (-0.129611 --> -0.133315).  Saving model ...
Epoch: 3 cost time: 0.4370081424713135
Epoch: 3, Steps: 2 | Train Loss: 1.710 Vali Loss: 1.779 Vali Acc: 0.141 Test Loss: 1.779 Test Acc: 0.141
Validation loss decreased (-0.133315 --> -0.140723).  Saving model ...
Epoch: 4 cost time: 0.4700653553009033
Epoch: 4, Steps: 2 | Train Loss: 1.742 Vali Loss: 1.743 Vali Acc: 0.156 Test Loss: 1.743 Test Acc: 0.156
Validation loss decreased (-0.140723 --> -0.155538).  Saving model ...
Epoch: 5 cost time: 0.4623100757598877
Epoch: 5, Steps: 2 | Train Loss: 1.689 Vali Loss: 1.695 Vali Acc: 0.170 Test Loss: 1.695 Test Acc: 0.170
Validation loss decreased (-0.155538 --> -0.170353).  Saving model ...
Epoch: 6 cost time: 0.42409825325012207
Epoch: 6, Steps: 2 | Train Loss: 1.701 Vali Loss: 1.638 Vali Acc: 0.237 Test Loss: 1.638 Test Acc: 0.237
Validation loss decreased (-0.170353 --> -0.237021).  Saving model ...
Epoch: 7 cost time: 0.4368724822998047
Epoch: 7, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.576 Vali Acc: 0.333 Test Loss: 1.576 Test Acc: 0.333
Validation loss decreased (-0.237021 --> -0.333318).  Saving model ...
Epoch: 8 cost time: 0.43784332275390625
Epoch: 8, Steps: 2 | Train Loss: 1.552 Vali Loss: 1.509 Vali Acc: 0.411 Test Loss: 1.509 Test Acc: 0.411
Validation loss decreased (-0.333318 --> -0.411096).  Saving model ...
Epoch: 9 cost time: 0.38323402404785156
Epoch: 9, Steps: 2 | Train Loss: 1.379 Vali Loss: 1.440 Vali Acc: 0.496 Test Loss: 1.440 Test Acc: 0.496
Validation loss decreased (-0.411096 --> -0.496282).  Saving model ...
Epoch: 10 cost time: 0.44487643241882324
Epoch: 10, Steps: 2 | Train Loss: 1.333 Vali Loss: 1.369 Vali Acc: 0.596 Test Loss: 1.369 Test Acc: 0.596
Validation loss decreased (-0.496282 --> -0.596283).  Saving model ...
Epoch: 11 cost time: 0.44982147216796875
Epoch: 11, Steps: 2 | Train Loss: 1.344 Vali Loss: 1.296 Vali Acc: 0.674 Test Loss: 1.296 Test Acc: 0.674
Validation loss decreased (-0.596283 --> -0.674061).  Saving model ...
Epoch: 12 cost time: 0.5962488651275635
Epoch: 12, Steps: 2 | Train Loss: 1.180 Vali Loss: 1.225 Vali Acc: 0.707 Test Loss: 1.225 Test Acc: 0.707
Validation loss decreased (-0.674061 --> -0.707395).  Saving model ...
Epoch: 13 cost time: 0.5671582221984863
Epoch: 13, Steps: 2 | Train Loss: 1.144 Vali Loss: 1.154 Vali Acc: 0.733 Test Loss: 1.154 Test Acc: 0.733
Validation loss decreased (-0.707395 --> -0.733322).  Saving model ...
Epoch: 14 cost time: 0.5957469940185547
Epoch: 14, Steps: 2 | Train Loss: 1.062 Vali Loss: 1.086 Vali Acc: 0.763 Test Loss: 1.086 Test Acc: 0.763
Validation loss decreased (-0.733322 --> -0.762952).  Saving model ...
Epoch: 15 cost time: 0.543461799621582
Epoch: 15, Steps: 2 | Train Loss: 0.970 Vali Loss: 1.020 Vali Acc: 0.789 Test Loss: 1.020 Test Acc: 0.789
Validation loss decreased (-0.762952 --> -0.788879).  Saving model ...
Epoch: 16 cost time: 0.5355310440063477
Epoch: 16, Steps: 2 | Train Loss: 0.893 Vali Loss: 0.958 Vali Acc: 0.807 Test Loss: 0.958 Test Acc: 0.807
Validation loss decreased (-0.788879 --> -0.807398).  Saving model ...
Epoch: 17 cost time: 0.5502409934997559
Epoch: 17, Steps: 2 | Train Loss: 0.869 Vali Loss: 0.901 Vali Acc: 0.826 Test Loss: 0.901 Test Acc: 0.826
Validation loss decreased (-0.807398 --> -0.825917).  Saving model ...
Epoch: 18 cost time: 0.634803295135498
Epoch: 18, Steps: 2 | Train Loss: 0.741 Vali Loss: 0.849 Vali Acc: 0.833 Test Loss: 0.849 Test Acc: 0.833
Validation loss decreased (-0.825917 --> -0.833325).  Saving model ...
Epoch: 19 cost time: 0.5221097469329834
Epoch: 19, Steps: 2 | Train Loss: 0.660 Vali Loss: 0.800 Vali Acc: 0.841 Test Loss: 0.800 Test Acc: 0.841
Validation loss decreased (-0.833325 --> -0.840733).  Saving model ...
Epoch: 20 cost time: 0.6009583473205566
Epoch: 20, Steps: 2 | Train Loss: 0.667 Vali Loss: 0.755 Vali Acc: 0.844 Test Loss: 0.755 Test Acc: 0.844
Validation loss decreased (-0.840733 --> -0.844437).  Saving model ...
Epoch: 21 cost time: 0.5503525733947754
Epoch: 21, Steps: 2 | Train Loss: 0.617 Vali Loss: 0.713 Vali Acc: 0.859 Test Loss: 0.713 Test Acc: 0.859
Validation loss decreased (-0.844437 --> -0.859252).  Saving model ...
Epoch: 22 cost time: 0.5619759559631348
Epoch: 22, Steps: 2 | Train Loss: 0.553 Vali Loss: 0.675 Vali Acc: 0.867 Test Loss: 0.675 Test Acc: 0.867
Validation loss decreased (-0.859252 --> -0.866660).  Saving model ...
Epoch: 23 cost time: 0.5422759056091309
Epoch: 23, Steps: 2 | Train Loss: 0.512 Vali Loss: 0.640 Vali Acc: 0.863 Test Loss: 0.640 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 0.6157658100128174
Epoch: 24, Steps: 2 | Train Loss: 0.449 Vali Loss: 0.610 Vali Acc: 0.867 Test Loss: 0.610 Test Acc: 0.867
Validation loss decreased (-0.866660 --> -0.866661).  Saving model ...
Epoch: 25 cost time: 0.5506560802459717
Epoch: 25, Steps: 2 | Train Loss: 0.466 Vali Loss: 0.582 Vali Acc: 0.863 Test Loss: 0.582 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 0.6279394626617432
Epoch: 26, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.557 Vali Acc: 0.867 Test Loss: 0.557 Test Acc: 0.867
Validation loss decreased (-0.866661 --> -0.866661).  Saving model ...
Epoch: 27 cost time: 0.6186184883117676
Epoch: 27, Steps: 2 | Train Loss: 0.383 Vali Loss: 0.534 Vali Acc: 0.870 Test Loss: 0.534 Test Acc: 0.870
Validation loss decreased (-0.866661 --> -0.870365).  Saving model ...
Epoch: 28 cost time: 0.6354973316192627
Epoch: 28, Steps: 2 | Train Loss: 0.380 Vali Loss: 0.513 Vali Acc: 0.874 Test Loss: 0.513 Test Acc: 0.874
Validation loss decreased (-0.870365 --> -0.874069).  Saving model ...
Epoch: 29 cost time: 0.6312010288238525
Epoch: 29, Steps: 2 | Train Loss: 0.371 Vali Loss: 0.494 Vali Acc: 0.878 Test Loss: 0.494 Test Acc: 0.878
Validation loss decreased (-0.874069 --> -0.877773).  Saving model ...
Epoch: 30 cost time: 0.5933284759521484
Epoch: 30, Steps: 2 | Train Loss: 0.337 Vali Loss: 0.479 Vali Acc: 0.881 Test Loss: 0.479 Test Acc: 0.881
Validation loss decreased (-0.877773 --> -0.881477).  Saving model ...
Epoch: 31 cost time: 0.6494460105895996
Epoch: 31, Steps: 2 | Train Loss: 0.297 Vali Loss: 0.464 Vali Acc: 0.881 Test Loss: 0.464 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 32 cost time: 0.620333194732666
Epoch: 32, Steps: 2 | Train Loss: 0.269 Vali Loss: 0.450 Vali Acc: 0.881 Test Loss: 0.450 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 33 cost time: 0.6298685073852539
Epoch: 33, Steps: 2 | Train Loss: 0.250 Vali Loss: 0.438 Vali Acc: 0.881 Test Loss: 0.438 Test Acc: 0.881
Validation loss decreased (-0.881477 --> -0.881477).  Saving model ...
Epoch: 34 cost time: 0.6278364658355713
Epoch: 34, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.427 Vali Acc: 0.885 Test Loss: 0.427 Test Acc: 0.885
Validation loss decreased (-0.881477 --> -0.885181).  Saving model ...
Epoch: 35 cost time: 0.625638484954834
Epoch: 35, Steps: 2 | Train Loss: 0.264 Vali Loss: 0.417 Vali Acc: 0.885 Test Loss: 0.417 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 36 cost time: 0.5165939331054688
Epoch: 36, Steps: 2 | Train Loss: 0.253 Vali Loss: 0.409 Vali Acc: 0.885 Test Loss: 0.409 Test Acc: 0.885
Validation loss decreased (-0.885181 --> -0.885181).  Saving model ...
Epoch: 37 cost time: 0.6200361251831055
Epoch: 37, Steps: 2 | Train Loss: 0.197 Vali Loss: 0.400 Vali Acc: 0.889 Test Loss: 0.400 Test Acc: 0.889
Validation loss decreased (-0.885181 --> -0.888885).  Saving model ...
Epoch: 38 cost time: 0.573866605758667
Epoch: 38, Steps: 2 | Train Loss: 0.192 Vali Loss: 0.393 Vali Acc: 0.893 Test Loss: 0.393 Test Acc: 0.893
Validation loss decreased (-0.888885 --> -0.892589).  Saving model ...
Epoch: 39 cost time: 0.5341458320617676
Epoch: 39, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.386 Vali Acc: 0.893 Test Loss: 0.386 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 40 cost time: 0.5795371532440186
Epoch: 40, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.380 Vali Acc: 0.889 Test Loss: 0.380 Test Acc: 0.889
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.5652971267700195
Epoch: 41, Steps: 2 | Train Loss: 0.169 Vali Loss: 0.375 Vali Acc: 0.893 Test Loss: 0.375 Test Acc: 0.893
Validation loss decreased (-0.892589 --> -0.892589).  Saving model ...
Epoch: 42 cost time: 0.5499610900878906
Epoch: 42, Steps: 2 | Train Loss: 0.178 Vali Loss: 0.371 Vali Acc: 0.885 Test Loss: 0.371 Test Acc: 0.885
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 0.6538386344909668
Epoch: 43, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.368 Vali Acc: 0.881 Test Loss: 0.368 Test Acc: 0.881
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 0.614699125289917
Epoch: 44, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.364 Vali Acc: 0.885 Test Loss: 0.364 Test Acc: 0.885
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 0.6791715621948242
Epoch: 45, Steps: 2 | Train Loss: 0.160 Vali Loss: 0.361 Vali Acc: 0.881 Test Loss: 0.361 Test Acc: 0.881
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 0.6528761386871338
Epoch: 46, Steps: 2 | Train Loss: 0.150 Vali Loss: 0.357 Vali Acc: 0.881 Test Loss: 0.357 Test Acc: 0.881
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 0.6363108158111572
Epoch: 47, Steps: 2 | Train Loss: 0.158 Vali Loss: 0.355 Vali Acc: 0.881 Test Loss: 0.355 Test Acc: 0.881
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 0.6297969818115234
Epoch: 48, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.351 Vali Acc: 0.881 Test Loss: 0.351 Test Acc: 0.881
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 0.609163761138916
Epoch: 49, Steps: 2 | Train Loss: 0.126 Vali Loss: 0.349 Vali Acc: 0.881 Test Loss: 0.349 Test Acc: 0.881
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 0.6564695835113525
Epoch: 50, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.347 Vali Acc: 0.885 Test Loss: 0.347 Test Acc: 0.885
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 0.6660075187683105
Epoch: 51, Steps: 2 | Train Loss: 0.110 Vali Loss: 0.344 Vali Acc: 0.874 Test Loss: 0.344 Test Acc: 0.874
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8925925925925926
model parameter : 23782
model size : 0.71MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.0991148948669434
Epoch: 1, Steps: 2 | Train Loss: 1.880 Vali Loss: 1.821 Vali Acc: 0.159 Test Loss: 1.821 Test Acc: 0.159
Validation loss decreased (inf --> -0.159241).  Saving model ...
Epoch: 2 cost time: 0.43005847930908203
Epoch: 2, Steps: 2 | Train Loss: 1.801 Vali Loss: 1.755 Vali Acc: 0.196 Test Loss: 1.755 Test Acc: 0.196
Validation loss decreased (-0.159241 --> -0.196279).  Saving model ...
Epoch: 3 cost time: 0.4562339782714844
Epoch: 3, Steps: 2 | Train Loss: 1.691 Vali Loss: 1.708 Vali Acc: 0.215 Test Loss: 1.708 Test Acc: 0.215
Validation loss decreased (-0.196279 --> -0.214798).  Saving model ...
Epoch: 4 cost time: 0.3667330741882324
Epoch: 4, Steps: 2 | Train Loss: 1.654 Vali Loss: 1.666 Vali Acc: 0.244 Test Loss: 1.666 Test Acc: 0.244
Validation loss decreased (-0.214798 --> -0.244428).  Saving model ...
Epoch: 5 cost time: 0.47228121757507324
Epoch: 5, Steps: 2 | Train Loss: 1.657 Vali Loss: 1.612 Vali Acc: 0.293 Test Loss: 1.612 Test Acc: 0.293
Validation loss decreased (-0.244428 --> -0.292576).  Saving model ...
Epoch: 6 cost time: 0.5040485858917236
Epoch: 6, Steps: 2 | Train Loss: 1.590 Vali Loss: 1.551 Vali Acc: 0.378 Test Loss: 1.551 Test Acc: 0.378
Validation loss decreased (-0.292576 --> -0.377762).  Saving model ...
Epoch: 7 cost time: 0.3818705081939697
Epoch: 7, Steps: 2 | Train Loss: 1.474 Vali Loss: 1.483 Vali Acc: 0.470 Test Loss: 1.483 Test Acc: 0.470
Validation loss decreased (-0.377762 --> -0.470356).  Saving model ...
Epoch: 8 cost time: 0.42958521842956543
Epoch: 8, Steps: 2 | Train Loss: 1.391 Vali Loss: 1.411 Vali Acc: 0.567 Test Loss: 1.411 Test Acc: 0.567
Validation loss decreased (-0.470356 --> -0.566653).  Saving model ...
Epoch: 9 cost time: 0.43123602867126465
Epoch: 9, Steps: 2 | Train Loss: 1.402 Vali Loss: 1.336 Vali Acc: 0.626 Test Loss: 1.336 Test Acc: 0.626
Validation loss decreased (-0.566653 --> -0.625913).  Saving model ...
Epoch: 10 cost time: 0.4500133991241455
Epoch: 10, Steps: 2 | Train Loss: 1.187 Vali Loss: 1.259 Vali Acc: 0.663 Test Loss: 1.259 Test Acc: 0.663
Validation loss decreased (-0.625913 --> -0.662950).  Saving model ...
Epoch: 11 cost time: 0.4078032970428467
Epoch: 11, Steps: 2 | Train Loss: 1.177 Vali Loss: 1.181 Vali Acc: 0.744 Test Loss: 1.181 Test Acc: 0.744
Validation loss decreased (-0.662950 --> -0.744433).  Saving model ...
Epoch: 12 cost time: 0.4554421901702881
Epoch: 12, Steps: 2 | Train Loss: 1.035 Vali Loss: 1.104 Vali Acc: 0.774 Test Loss: 1.104 Test Acc: 0.774
Validation loss decreased (-0.744433 --> -0.774063).  Saving model ...
Epoch: 13 cost time: 0.501467227935791
Epoch: 13, Steps: 2 | Train Loss: 0.917 Vali Loss: 1.029 Vali Acc: 0.785 Test Loss: 1.029 Test Acc: 0.785
Validation loss decreased (-0.774063 --> -0.785175).  Saving model ...
Epoch: 14 cost time: 0.5102214813232422
Epoch: 14, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.957 Vali Acc: 0.804 Test Loss: 0.957 Test Acc: 0.804
Validation loss decreased (-0.785175 --> -0.803694).  Saving model ...
Epoch: 15 cost time: 0.546522855758667
Epoch: 15, Steps: 2 | Train Loss: 0.853 Vali Loss: 0.891 Vali Acc: 0.830 Test Loss: 0.891 Test Acc: 0.830
Validation loss decreased (-0.803694 --> -0.829621).  Saving model ...
Epoch: 16 cost time: 0.497955322265625
Epoch: 16, Steps: 2 | Train Loss: 0.798 Vali Loss: 0.828 Vali Acc: 0.848 Test Loss: 0.828 Test Acc: 0.848
Validation loss decreased (-0.829621 --> -0.848140).  Saving model ...
Epoch: 17 cost time: 0.46581411361694336
Epoch: 17, Steps: 2 | Train Loss: 0.669 Vali Loss: 0.769 Vali Acc: 0.870 Test Loss: 0.769 Test Acc: 0.870
Validation loss decreased (-0.848140 --> -0.870363).  Saving model ...
Epoch: 18 cost time: 0.4569838047027588
Epoch: 18, Steps: 2 | Train Loss: 0.595 Vali Loss: 0.714 Vali Acc: 0.881 Test Loss: 0.714 Test Acc: 0.881
Validation loss decreased (-0.870363 --> -0.881474).  Saving model ...
Epoch: 19 cost time: 0.44971561431884766
Epoch: 19, Steps: 2 | Train Loss: 0.532 Vali Loss: 0.663 Vali Acc: 0.881 Test Loss: 0.663 Test Acc: 0.881
Validation loss decreased (-0.881474 --> -0.881475).  Saving model ...
Epoch: 20 cost time: 0.4466733932495117
Epoch: 20, Steps: 2 | Train Loss: 0.471 Vali Loss: 0.615 Vali Acc: 0.889 Test Loss: 0.615 Test Acc: 0.889
Validation loss decreased (-0.881475 --> -0.888883).  Saving model ...
Epoch: 21 cost time: 0.42049574851989746
Epoch: 21, Steps: 2 | Train Loss: 0.454 Vali Loss: 0.573 Vali Acc: 0.900 Test Loss: 0.573 Test Acc: 0.900
Validation loss decreased (-0.888883 --> -0.899994).  Saving model ...
Epoch: 22 cost time: 0.4492049217224121
Epoch: 22, Steps: 2 | Train Loss: 0.378 Vali Loss: 0.535 Vali Acc: 0.900 Test Loss: 0.535 Test Acc: 0.900
Validation loss decreased (-0.899994 --> -0.899995).  Saving model ...
Epoch: 23 cost time: 0.4630861282348633
Epoch: 23, Steps: 2 | Train Loss: 0.345 Vali Loss: 0.500 Vali Acc: 0.907 Test Loss: 0.500 Test Acc: 0.907
Validation loss decreased (-0.899995 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.49114537239074707
Epoch: 24, Steps: 2 | Train Loss: 0.304 Vali Loss: 0.468 Vali Acc: 0.907 Test Loss: 0.468 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 25 cost time: 0.47095441818237305
Epoch: 25, Steps: 2 | Train Loss: 0.278 Vali Loss: 0.438 Vali Acc: 0.911 Test Loss: 0.438 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 26 cost time: 0.45584917068481445
Epoch: 26, Steps: 2 | Train Loss: 0.224 Vali Loss: 0.411 Vali Acc: 0.911 Test Loss: 0.411 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 27 cost time: 0.42354369163513184
Epoch: 27, Steps: 2 | Train Loss: 0.232 Vali Loss: 0.388 Vali Acc: 0.919 Test Loss: 0.388 Test Acc: 0.919
Validation loss decreased (-0.911107 --> -0.918515).  Saving model ...
Epoch: 28 cost time: 0.460939884185791
Epoch: 28, Steps: 2 | Train Loss: 0.188 Vali Loss: 0.367 Vali Acc: 0.919 Test Loss: 0.367 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 29 cost time: 0.488675594329834
Epoch: 29, Steps: 2 | Train Loss: 0.186 Vali Loss: 0.349 Vali Acc: 0.919 Test Loss: 0.349 Test Acc: 0.919
Validation loss decreased (-0.918515 --> -0.918515).  Saving model ...
Epoch: 30 cost time: 0.46318650245666504
Epoch: 30, Steps: 2 | Train Loss: 0.170 Vali Loss: 0.333 Vali Acc: 0.922 Test Loss: 0.333 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 31 cost time: 0.4297175407409668
Epoch: 31, Steps: 2 | Train Loss: 0.151 Vali Loss: 0.320 Vali Acc: 0.926 Test Loss: 0.320 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 32 cost time: 0.4401562213897705
Epoch: 32, Steps: 2 | Train Loss: 0.113 Vali Loss: 0.308 Vali Acc: 0.926 Test Loss: 0.308 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 33 cost time: 0.46655821800231934
Epoch: 33, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.300 Vali Acc: 0.922 Test Loss: 0.300 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 0.4668850898742676
Epoch: 34, Steps: 2 | Train Loss: 0.117 Vali Loss: 0.292 Vali Acc: 0.919 Test Loss: 0.292 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 0.4409325122833252
Epoch: 35, Steps: 2 | Train Loss: 0.092 Vali Loss: 0.284 Vali Acc: 0.919 Test Loss: 0.284 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 0.4206349849700928
Epoch: 36, Steps: 2 | Train Loss: 0.084 Vali Loss: 0.277 Vali Acc: 0.919 Test Loss: 0.277 Test Acc: 0.919
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 0.4137399196624756
Epoch: 37, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.269 Vali Acc: 0.922 Test Loss: 0.269 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 0.42946410179138184
Epoch: 38, Steps: 2 | Train Loss: 0.076 Vali Loss: 0.262 Vali Acc: 0.926 Test Loss: 0.262 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 39 cost time: 0.38242435455322266
Epoch: 39, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.256 Vali Acc: 0.930 Test Loss: 0.256 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.3813815116882324
Epoch: 40, Steps: 2 | Train Loss: 0.058 Vali Loss: 0.250 Vali Acc: 0.930 Test Loss: 0.250 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.39851927757263184
Epoch: 41, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.246 Vali Acc: 0.933 Test Loss: 0.246 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 42 cost time: 0.41661596298217773
Epoch: 42, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 43 cost time: 0.4229135513305664
Epoch: 43, Steps: 2 | Train Loss: 0.042 Vali Loss: 0.238 Vali Acc: 0.941 Test Loss: 0.238 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940738).  Saving model ...
Epoch: 44 cost time: 0.44338226318359375
Epoch: 44, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.235 Vali Acc: 0.941 Test Loss: 0.235 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 45 cost time: 0.4589245319366455
Epoch: 45, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.232 Vali Acc: 0.941 Test Loss: 0.232 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 46 cost time: 0.4327991008758545
Epoch: 46, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.230 Vali Acc: 0.941 Test Loss: 0.230 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 47 cost time: 0.4813497066497803
Epoch: 47, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.227 Vali Acc: 0.941 Test Loss: 0.227 Test Acc: 0.941
Validation loss decreased (-0.940738 --> -0.940738).  Saving model ...
Epoch: 48 cost time: 0.4423339366912842
Epoch: 48, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.225 Vali Acc: 0.944 Test Loss: 0.225 Test Acc: 0.944
Validation loss decreased (-0.940738 --> -0.944442).  Saving model ...
Epoch: 49 cost time: 0.4498434066772461
Epoch: 49, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.223 Vali Acc: 0.944 Test Loss: 0.223 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 50 cost time: 0.43711400032043457
Epoch: 50, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.221 Vali Acc: 0.944 Test Loss: 0.221 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 51 cost time: 0.4907681941986084
Epoch: 51, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.220 Vali Acc: 0.944 Test Loss: 0.220 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 52 cost time: 0.5333037376403809
Epoch: 52, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.218 Vali Acc: 0.941 Test Loss: 0.218 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 53 cost time: 0.5028707981109619
Epoch: 53, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.217 Vali Acc: 0.941 Test Loss: 0.217 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 54 cost time: 0.5058767795562744
Epoch: 54, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.216 Vali Acc: 0.941 Test Loss: 0.216 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 55 cost time: 0.5097789764404297
Epoch: 55, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.215 Vali Acc: 0.937 Test Loss: 0.215 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 56 cost time: 0.4550962448120117
Epoch: 56, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
EarlyStopping counter: 5 out of 10
Epoch: 57 cost time: 0.4775824546813965
Epoch: 57, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.212 Vali Acc: 0.941 Test Loss: 0.212 Test Acc: 0.941
EarlyStopping counter: 6 out of 10
Epoch: 58 cost time: 0.4791421890258789
Epoch: 58, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.211 Vali Acc: 0.941 Test Loss: 0.211 Test Acc: 0.941
EarlyStopping counter: 7 out of 10
Epoch: 59 cost time: 0.4882471561431885
Epoch: 59, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.210 Vali Acc: 0.941 Test Loss: 0.210 Test Acc: 0.941
EarlyStopping counter: 8 out of 10
Epoch: 60 cost time: 0.47508859634399414
Epoch: 60, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.209 Vali Acc: 0.941 Test Loss: 0.209 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 61 cost time: 0.47385406494140625
Epoch: 61, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.208 Vali Acc: 0.941 Test Loss: 0.208 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 19686
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.033256769180298
Epoch: 1, Steps: 2 | Train Loss: 1.869 Vali Loss: 1.819 Vali Acc: 0.130 Test Loss: 1.819 Test Acc: 0.130
Validation loss decreased (inf --> -0.129611).  Saving model ...
Epoch: 2 cost time: 0.4458916187286377
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.753 Vali Acc: 0.174 Test Loss: 1.753 Test Acc: 0.174
Validation loss decreased (-0.129611 --> -0.174057).  Saving model ...
Epoch: 3 cost time: 0.3964519500732422
Epoch: 3, Steps: 2 | Train Loss: 1.652 Vali Loss: 1.706 Vali Acc: 0.196 Test Loss: 1.706 Test Acc: 0.196
Validation loss decreased (-0.174057 --> -0.196279).  Saving model ...
Epoch: 4 cost time: 0.41814184188842773
Epoch: 4, Steps: 2 | Train Loss: 1.615 Vali Loss: 1.664 Vali Acc: 0.244 Test Loss: 1.664 Test Acc: 0.244
Validation loss decreased (-0.196279 --> -0.244428).  Saving model ...
Epoch: 5 cost time: 0.48221850395202637
Epoch: 5, Steps: 2 | Train Loss: 1.649 Vali Loss: 1.611 Vali Acc: 0.319 Test Loss: 1.611 Test Acc: 0.319
Validation loss decreased (-0.244428 --> -0.318502).  Saving model ...
Epoch: 6 cost time: 0.5111372470855713
Epoch: 6, Steps: 2 | Train Loss: 1.567 Vali Loss: 1.549 Vali Acc: 0.400 Test Loss: 1.549 Test Acc: 0.400
Validation loss decreased (-0.318502 --> -0.399985).  Saving model ...
Epoch: 7 cost time: 0.5039896965026855
Epoch: 7, Steps: 2 | Train Loss: 1.459 Vali Loss: 1.482 Vali Acc: 0.470 Test Loss: 1.482 Test Acc: 0.470
Validation loss decreased (-0.399985 --> -0.470356).  Saving model ...
Epoch: 8 cost time: 0.4996678829193115
Epoch: 8, Steps: 2 | Train Loss: 1.363 Vali Loss: 1.411 Vali Acc: 0.556 Test Loss: 1.411 Test Acc: 0.556
Validation loss decreased (-0.470356 --> -0.555541).  Saving model ...
Epoch: 9 cost time: 0.45950984954833984
Epoch: 9, Steps: 2 | Train Loss: 1.382 Vali Loss: 1.336 Vali Acc: 0.633 Test Loss: 1.336 Test Acc: 0.633
Validation loss decreased (-0.555541 --> -0.633320).  Saving model ...
Epoch: 10 cost time: 0.4761819839477539
Epoch: 10, Steps: 2 | Train Loss: 1.157 Vali Loss: 1.260 Vali Acc: 0.696 Test Loss: 1.260 Test Acc: 0.696
Validation loss decreased (-0.633320 --> -0.696284).  Saving model ...
Epoch: 11 cost time: 0.5347578525543213
Epoch: 11, Steps: 2 | Train Loss: 1.181 Vali Loss: 1.183 Vali Acc: 0.733 Test Loss: 1.183 Test Acc: 0.733
Validation loss decreased (-0.696284 --> -0.733322).  Saving model ...
Epoch: 12 cost time: 0.46468544006347656
Epoch: 12, Steps: 2 | Train Loss: 1.039 Vali Loss: 1.106 Vali Acc: 0.785 Test Loss: 1.106 Test Acc: 0.785
Validation loss decreased (-0.733322 --> -0.785174).  Saving model ...
Epoch: 13 cost time: 0.5086255073547363
Epoch: 13, Steps: 2 | Train Loss: 0.921 Vali Loss: 1.031 Vali Acc: 0.800 Test Loss: 1.031 Test Acc: 0.800
Validation loss decreased (-0.785174 --> -0.799990).  Saving model ...
Epoch: 14 cost time: 0.4770190715789795
Epoch: 14, Steps: 2 | Train Loss: 0.911 Vali Loss: 0.959 Vali Acc: 0.819 Test Loss: 0.959 Test Acc: 0.819
Validation loss decreased (-0.799990 --> -0.818509).  Saving model ...
Epoch: 15 cost time: 0.49938416481018066
Epoch: 15, Steps: 2 | Train Loss: 0.831 Vali Loss: 0.893 Vali Acc: 0.833 Test Loss: 0.893 Test Acc: 0.833
Validation loss decreased (-0.818509 --> -0.833324).  Saving model ...
Epoch: 16 cost time: 0.5047478675842285
Epoch: 16, Steps: 2 | Train Loss: 0.784 Vali Loss: 0.830 Vali Acc: 0.844 Test Loss: 0.830 Test Acc: 0.844
Validation loss decreased (-0.833324 --> -0.844436).  Saving model ...
Epoch: 17 cost time: 0.44701576232910156
Epoch: 17, Steps: 2 | Train Loss: 0.640 Vali Loss: 0.772 Vali Acc: 0.867 Test Loss: 0.772 Test Acc: 0.867
Validation loss decreased (-0.844436 --> -0.866659).  Saving model ...
Epoch: 18 cost time: 0.5067312717437744
Epoch: 18, Steps: 2 | Train Loss: 0.599 Vali Loss: 0.717 Vali Acc: 0.874 Test Loss: 0.717 Test Acc: 0.874
Validation loss decreased (-0.866659 --> -0.874067).  Saving model ...
Epoch: 19 cost time: 0.45078516006469727
Epoch: 19, Steps: 2 | Train Loss: 0.548 Vali Loss: 0.666 Vali Acc: 0.878 Test Loss: 0.666 Test Acc: 0.878
Validation loss decreased (-0.874067 --> -0.877771).  Saving model ...
Epoch: 20 cost time: 0.4824209213256836
Epoch: 20, Steps: 2 | Train Loss: 0.482 Vali Loss: 0.619 Vali Acc: 0.878 Test Loss: 0.619 Test Acc: 0.878
Validation loss decreased (-0.877771 --> -0.877772).  Saving model ...
Epoch: 21 cost time: 0.48295044898986816
Epoch: 21, Steps: 2 | Train Loss: 0.445 Vali Loss: 0.577 Vali Acc: 0.896 Test Loss: 0.577 Test Acc: 0.896
Validation loss decreased (-0.877772 --> -0.896291).  Saving model ...
Epoch: 22 cost time: 0.4276754856109619
Epoch: 22, Steps: 2 | Train Loss: 0.374 Vali Loss: 0.539 Vali Acc: 0.896 Test Loss: 0.539 Test Acc: 0.896
Validation loss decreased (-0.896291 --> -0.896291).  Saving model ...
Epoch: 23 cost time: 0.40254640579223633
Epoch: 23, Steps: 2 | Train Loss: 0.340 Vali Loss: 0.504 Vali Acc: 0.904 Test Loss: 0.504 Test Acc: 0.904
Validation loss decreased (-0.896291 --> -0.903699).  Saving model ...
Epoch: 24 cost time: 0.5088334083557129
Epoch: 24, Steps: 2 | Train Loss: 0.298 Vali Loss: 0.472 Vali Acc: 0.911 Test Loss: 0.472 Test Acc: 0.911
Validation loss decreased (-0.903699 --> -0.911106).  Saving model ...
Epoch: 25 cost time: 0.48990941047668457
Epoch: 25, Steps: 2 | Train Loss: 0.276 Vali Loss: 0.442 Vali Acc: 0.922 Test Loss: 0.442 Test Acc: 0.922
Validation loss decreased (-0.911106 --> -0.922218).  Saving model ...
Epoch: 26 cost time: 0.4528672695159912
Epoch: 26, Steps: 2 | Train Loss: 0.236 Vali Loss: 0.416 Vali Acc: 0.922 Test Loss: 0.416 Test Acc: 0.922
Validation loss decreased (-0.922218 --> -0.922218).  Saving model ...
Epoch: 27 cost time: 0.4511270523071289
Epoch: 27, Steps: 2 | Train Loss: 0.234 Vali Loss: 0.392 Vali Acc: 0.926 Test Loss: 0.392 Test Acc: 0.926
Validation loss decreased (-0.922218 --> -0.925922).  Saving model ...
Epoch: 28 cost time: 0.46728038787841797
Epoch: 28, Steps: 2 | Train Loss: 0.198 Vali Loss: 0.371 Vali Acc: 0.926 Test Loss: 0.371 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 29 cost time: 0.4266378879547119
Epoch: 29, Steps: 2 | Train Loss: 0.196 Vali Loss: 0.353 Vali Acc: 0.926 Test Loss: 0.353 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925922).  Saving model ...
Epoch: 30 cost time: 0.488175630569458
Epoch: 30, Steps: 2 | Train Loss: 0.177 Vali Loss: 0.337 Vali Acc: 0.922 Test Loss: 0.337 Test Acc: 0.922
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 0.47464799880981445
Epoch: 31, Steps: 2 | Train Loss: 0.156 Vali Loss: 0.324 Vali Acc: 0.922 Test Loss: 0.324 Test Acc: 0.922
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 0.5821669101715088
Epoch: 32, Steps: 2 | Train Loss: 0.120 Vali Loss: 0.313 Vali Acc: 0.919 Test Loss: 0.313 Test Acc: 0.919
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 0.5764923095703125
Epoch: 33, Steps: 2 | Train Loss: 0.123 Vali Loss: 0.303 Vali Acc: 0.922 Test Loss: 0.303 Test Acc: 0.922
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 0.5637197494506836
Epoch: 34, Steps: 2 | Train Loss: 0.124 Vali Loss: 0.295 Vali Acc: 0.922 Test Loss: 0.295 Test Acc: 0.922
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 0.5454506874084473
Epoch: 35, Steps: 2 | Train Loss: 0.100 Vali Loss: 0.287 Vali Acc: 0.926 Test Loss: 0.287 Test Acc: 0.926
Validation loss decreased (-0.925922 --> -0.925923).  Saving model ...
Epoch: 36 cost time: 0.4997391700744629
Epoch: 36, Steps: 2 | Train Loss: 0.095 Vali Loss: 0.280 Vali Acc: 0.926 Test Loss: 0.280 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 37 cost time: 0.5563080310821533
Epoch: 37, Steps: 2 | Train Loss: 0.101 Vali Loss: 0.272 Vali Acc: 0.930 Test Loss: 0.272 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 38 cost time: 0.5755457878112793
Epoch: 38, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.265 Vali Acc: 0.926 Test Loss: 0.265 Test Acc: 0.926
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.5018527507781982
Epoch: 39, Steps: 2 | Train Loss: 0.089 Vali Loss: 0.259 Vali Acc: 0.930 Test Loss: 0.259 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 40 cost time: 0.5351853370666504
Epoch: 40, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.254 Vali Acc: 0.930 Test Loss: 0.254 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 41 cost time: 0.5293779373168945
Epoch: 41, Steps: 2 | Train Loss: 0.065 Vali Loss: 0.249 Vali Acc: 0.930 Test Loss: 0.249 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 42 cost time: 0.5449700355529785
Epoch: 42, Steps: 2 | Train Loss: 0.060 Vali Loss: 0.245 Vali Acc: 0.930 Test Loss: 0.245 Test Acc: 0.930
Validation loss decreased (-0.929627 --> -0.929627).  Saving model ...
Epoch: 43 cost time: 0.5493316650390625
Epoch: 43, Steps: 2 | Train Loss: 0.046 Vali Loss: 0.242 Vali Acc: 0.933 Test Loss: 0.242 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 44 cost time: 0.6214156150817871
Epoch: 44, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.238 Vali Acc: 0.933 Test Loss: 0.238 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.6056118011474609
Epoch: 45, Steps: 2 | Train Loss: 0.054 Vali Loss: 0.236 Vali Acc: 0.933 Test Loss: 0.236 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.5420467853546143
Epoch: 46, Steps: 2 | Train Loss: 0.050 Vali Loss: 0.233 Vali Acc: 0.933 Test Loss: 0.233 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 47 cost time: 0.5580117702484131
Epoch: 47, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.231 Vali Acc: 0.933 Test Loss: 0.231 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 48 cost time: 0.5142233371734619
Epoch: 48, Steps: 2 | Train Loss: 0.038 Vali Loss: 0.229 Vali Acc: 0.933 Test Loss: 0.229 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 49 cost time: 0.5538544654846191
Epoch: 49, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.226 Vali Acc: 0.933 Test Loss: 0.226 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 50 cost time: 0.5155460834503174
Epoch: 50, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.224 Vali Acc: 0.933 Test Loss: 0.224 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 51 cost time: 0.5484175682067871
Epoch: 51, Steps: 2 | Train Loss: 0.039 Vali Loss: 0.222 Vali Acc: 0.933 Test Loss: 0.222 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 52 cost time: 0.5452990531921387
Epoch: 52, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.221 Vali Acc: 0.933 Test Loss: 0.221 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 53 cost time: 0.5201127529144287
Epoch: 53, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 54 cost time: 0.48893141746520996
Epoch: 54, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 55 cost time: 0.49837231636047363
Epoch: 55, Steps: 2 | Train Loss: 0.035 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 56 cost time: 0.4923722743988037
Epoch: 56, Steps: 2 | Train Loss: 0.029 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 57 cost time: 0.47079038619995117
Epoch: 57, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 58 cost time: 0.5199844837188721
Epoch: 58, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.213 Vali Acc: 0.933 Test Loss: 0.213 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 59 cost time: 0.5005800724029541
Epoch: 59, Steps: 2 | Train Loss: 0.030 Vali Loss: 0.212 Vali Acc: 0.933 Test Loss: 0.212 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 60 cost time: 0.539154052734375
Epoch: 60, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.211 Vali Acc: 0.933 Test Loss: 0.211 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 61 cost time: 0.5830011367797852
Epoch: 61, Steps: 2 | Train Loss: 0.021 Vali Loss: 0.210 Vali Acc: 0.933 Test Loss: 0.210 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 62 cost time: 0.609572172164917
Epoch: 62, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.209 Vali Acc: 0.933 Test Loss: 0.209 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 63 cost time: 0.5717477798461914
Epoch: 63, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.208 Vali Acc: 0.933 Test Loss: 0.208 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 64 cost time: 0.5195343494415283
Epoch: 64, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.207 Vali Acc: 0.933 Test Loss: 0.207 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 65 cost time: 0.5559093952178955
Epoch: 65, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.205 Vali Acc: 0.933 Test Loss: 0.205 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 66 cost time: 0.5449888706207275
Epoch: 66, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.204 Vali Acc: 0.933 Test Loss: 0.204 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 67 cost time: 0.557342529296875
Epoch: 67, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.203 Vali Acc: 0.937 Test Loss: 0.203 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937035).  Saving model ...
Epoch: 68 cost time: 0.5466609001159668
Epoch: 68, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.202 Vali Acc: 0.937 Test Loss: 0.202 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 69 cost time: 0.5599544048309326
Epoch: 69, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.201 Vali Acc: 0.941 Test Loss: 0.201 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 70 cost time: 0.6108179092407227
Epoch: 70, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 71 cost time: 0.6180024147033691
Epoch: 71, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.200 Vali Acc: 0.941 Test Loss: 0.200 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 72 cost time: 0.6421370506286621
Epoch: 72, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.199 Vali Acc: 0.941 Test Loss: 0.199 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 73 cost time: 0.5528240203857422
Epoch: 73, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.199 Vali Acc: 0.937 Test Loss: 0.199 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 74 cost time: 0.5620074272155762
Epoch: 74, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 75 cost time: 0.5256905555725098
Epoch: 75, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.937 Test Loss: 0.198 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 76 cost time: 0.4756777286529541
Epoch: 76, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.198 Vali Acc: 0.941 Test Loss: 0.198 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 77 cost time: 0.46166467666625977
Epoch: 77, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 78 cost time: 0.48734045028686523
Epoch: 78, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.197 Vali Acc: 0.941 Test Loss: 0.197 Test Acc: 0.941
Validation loss decreased (-0.940739 --> -0.940739).  Saving model ...
Epoch: 79 cost time: 0.46140336990356445
Epoch: 79, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.940739 --> -0.944442).  Saving model ...
Epoch: 80 cost time: 0.45307374000549316
Epoch: 80, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 81 cost time: 0.4375002384185791
Epoch: 81, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.196 Vali Acc: 0.944 Test Loss: 0.196 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 82 cost time: 0.45652222633361816
Epoch: 82, Steps: 2 | Train Loss: 0.016 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 83 cost time: 0.4971427917480469
Epoch: 83, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.195 Vali Acc: 0.944 Test Loss: 0.195 Test Acc: 0.944
Validation loss decreased (-0.944442 --> -0.944442).  Saving model ...
Epoch: 84 cost time: 0.4868288040161133
Epoch: 84, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.195 Vali Acc: 0.941 Test Loss: 0.195 Test Acc: 0.941
EarlyStopping counter: 1 out of 10
Epoch: 85 cost time: 0.5015788078308105
Epoch: 85, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 2 out of 10
Epoch: 86 cost time: 0.510683536529541
Epoch: 86, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.194 Vali Acc: 0.941 Test Loss: 0.194 Test Acc: 0.941
EarlyStopping counter: 3 out of 10
Epoch: 87 cost time: 0.512502908706665
Epoch: 87, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.194 Vali Acc: 0.937 Test Loss: 0.194 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 88 cost time: 0.5425384044647217
Epoch: 88, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.193 Vali Acc: 0.937 Test Loss: 0.193 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 89 cost time: 0.5339946746826172
Epoch: 89, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 90 cost time: 0.5447320938110352
Epoch: 90, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 91 cost time: 0.5403454303741455
Epoch: 91, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.192 Vali Acc: 0.937 Test Loss: 0.192 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
Epoch: 92 cost time: 0.4963798522949219
Epoch: 92, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 9 out of 10
Epoch: 93 cost time: 0.6064295768737793
Epoch: 93, Steps: 2 | Train Loss: 0.010 Vali Loss: 0.191 Vali Acc: 0.941 Test Loss: 0.191 Test Acc: 0.941
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9444444444444444
model parameter : 19686
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 1.9911689758300781
Epoch: 1, Steps: 2 | Train Loss: 1.813 Vali Loss: 1.812 Vali Acc: 0.137 Test Loss: 1.812 Test Acc: 0.137
Validation loss decreased (inf --> -0.137019).  Saving model ...
Epoch: 2 cost time: 0.4697854518890381
Epoch: 2, Steps: 2 | Train Loss: 1.789 Vali Loss: 1.747 Vali Acc: 0.163 Test Loss: 1.747 Test Acc: 0.163
Validation loss decreased (-0.137019 --> -0.162945).  Saving model ...
Epoch: 3 cost time: 0.45571398735046387
Epoch: 3, Steps: 2 | Train Loss: 1.658 Vali Loss: 1.700 Vali Acc: 0.185 Test Loss: 1.700 Test Acc: 0.185
Validation loss decreased (-0.162945 --> -0.185168).  Saving model ...
Epoch: 4 cost time: 0.4490664005279541
Epoch: 4, Steps: 2 | Train Loss: 1.644 Vali Loss: 1.659 Vali Acc: 0.215 Test Loss: 1.659 Test Acc: 0.215
Validation loss decreased (-0.185168 --> -0.214798).  Saving model ...
Epoch: 5 cost time: 0.45357227325439453
Epoch: 5, Steps: 2 | Train Loss: 1.634 Vali Loss: 1.607 Vali Acc: 0.259 Test Loss: 1.607 Test Acc: 0.259
Validation loss decreased (-0.214798 --> -0.259243).  Saving model ...
Epoch: 6 cost time: 0.44955968856811523
Epoch: 6, Steps: 2 | Train Loss: 1.587 Vali Loss: 1.547 Vali Acc: 0.370 Test Loss: 1.547 Test Acc: 0.370
Validation loss decreased (-0.259243 --> -0.370355).  Saving model ...
Epoch: 7 cost time: 0.5151677131652832
Epoch: 7, Steps: 2 | Train Loss: 1.472 Vali Loss: 1.481 Vali Acc: 0.467 Test Loss: 1.481 Test Acc: 0.467
Validation loss decreased (-0.370355 --> -0.466652).  Saving model ...
Epoch: 8 cost time: 0.5061233043670654
Epoch: 8, Steps: 2 | Train Loss: 1.384 Vali Loss: 1.411 Vali Acc: 0.593 Test Loss: 1.411 Test Acc: 0.593
Validation loss decreased (-0.466652 --> -0.592578).  Saving model ...
Epoch: 9 cost time: 0.496706485748291
Epoch: 9, Steps: 2 | Train Loss: 1.360 Vali Loss: 1.339 Vali Acc: 0.644 Test Loss: 1.339 Test Acc: 0.644
Validation loss decreased (-0.592578 --> -0.644431).  Saving model ...
Epoch: 10 cost time: 0.5035381317138672
Epoch: 10, Steps: 2 | Train Loss: 1.190 Vali Loss: 1.264 Vali Acc: 0.704 Test Loss: 1.264 Test Acc: 0.704
Validation loss decreased (-0.644431 --> -0.703691).  Saving model ...
Epoch: 11 cost time: 0.5041205883026123
Epoch: 11, Steps: 2 | Train Loss: 1.186 Vali Loss: 1.189 Vali Acc: 0.737 Test Loss: 1.189 Test Acc: 0.737
Validation loss decreased (-0.703691 --> -0.737025).  Saving model ...
Epoch: 12 cost time: 0.5950303077697754
Epoch: 12, Steps: 2 | Train Loss: 1.048 Vali Loss: 1.114 Vali Acc: 0.767 Test Loss: 1.114 Test Acc: 0.767
Validation loss decreased (-0.737025 --> -0.766656).  Saving model ...
Epoch: 13 cost time: 0.5010435581207275
Epoch: 13, Steps: 2 | Train Loss: 0.905 Vali Loss: 1.041 Vali Acc: 0.793 Test Loss: 1.041 Test Acc: 0.793
Validation loss decreased (-0.766656 --> -0.792582).  Saving model ...
Epoch: 14 cost time: 0.48879551887512207
Epoch: 14, Steps: 2 | Train Loss: 0.940 Vali Loss: 0.971 Vali Acc: 0.819 Test Loss: 0.971 Test Acc: 0.819
Validation loss decreased (-0.792582 --> -0.818509).  Saving model ...
Epoch: 15 cost time: 0.5336236953735352
Epoch: 15, Steps: 2 | Train Loss: 0.837 Vali Loss: 0.906 Vali Acc: 0.833 Test Loss: 0.906 Test Acc: 0.833
Validation loss decreased (-0.818509 --> -0.833324).  Saving model ...
Epoch: 16 cost time: 0.493671178817749
Epoch: 16, Steps: 2 | Train Loss: 0.793 Vali Loss: 0.845 Vali Acc: 0.844 Test Loss: 0.845 Test Acc: 0.844
Validation loss decreased (-0.833324 --> -0.844436).  Saving model ...
Epoch: 17 cost time: 0.5287051200866699
Epoch: 17, Steps: 2 | Train Loss: 0.684 Vali Loss: 0.789 Vali Acc: 0.859 Test Loss: 0.789 Test Acc: 0.859
Validation loss decreased (-0.844436 --> -0.859251).  Saving model ...
Epoch: 18 cost time: 0.49310851097106934
Epoch: 18, Steps: 2 | Train Loss: 0.628 Vali Loss: 0.735 Vali Acc: 0.881 Test Loss: 0.735 Test Acc: 0.881
Validation loss decreased (-0.859251 --> -0.881474).  Saving model ...
Epoch: 19 cost time: 0.5167210102081299
Epoch: 19, Steps: 2 | Train Loss: 0.550 Vali Loss: 0.686 Vali Acc: 0.889 Test Loss: 0.686 Test Acc: 0.889
Validation loss decreased (-0.881474 --> -0.888882).  Saving model ...
Epoch: 20 cost time: 0.4765021800994873
Epoch: 20, Steps: 2 | Train Loss: 0.491 Vali Loss: 0.640 Vali Acc: 0.896 Test Loss: 0.640 Test Acc: 0.896
Validation loss decreased (-0.888882 --> -0.896290).  Saving model ...
Epoch: 21 cost time: 0.5004796981811523
Epoch: 21, Steps: 2 | Train Loss: 0.446 Vali Loss: 0.598 Vali Acc: 0.896 Test Loss: 0.598 Test Acc: 0.896
Validation loss decreased (-0.896290 --> -0.896290).  Saving model ...
Epoch: 22 cost time: 0.5031025409698486
Epoch: 22, Steps: 2 | Train Loss: 0.393 Vali Loss: 0.561 Vali Acc: 0.900 Test Loss: 0.561 Test Acc: 0.900
Validation loss decreased (-0.896290 --> -0.899994).  Saving model ...
Epoch: 23 cost time: 0.5000805854797363
Epoch: 23, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.528 Vali Acc: 0.907 Test Loss: 0.528 Test Acc: 0.907
Validation loss decreased (-0.899994 --> -0.907402).  Saving model ...
Epoch: 24 cost time: 0.5253572463989258
Epoch: 24, Steps: 2 | Train Loss: 0.330 Vali Loss: 0.497 Vali Acc: 0.907 Test Loss: 0.497 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907402).  Saving model ...
Epoch: 25 cost time: 0.5514190196990967
Epoch: 25, Steps: 2 | Train Loss: 0.277 Vali Loss: 0.468 Vali Acc: 0.907 Test Loss: 0.468 Test Acc: 0.907
Validation loss decreased (-0.907402 --> -0.907403).  Saving model ...
Epoch: 26 cost time: 0.5016388893127441
Epoch: 26, Steps: 2 | Train Loss: 0.256 Vali Loss: 0.442 Vali Acc: 0.907 Test Loss: 0.442 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 27 cost time: 0.48287200927734375
Epoch: 27, Steps: 2 | Train Loss: 0.252 Vali Loss: 0.419 Vali Acc: 0.907 Test Loss: 0.419 Test Acc: 0.907
Validation loss decreased (-0.907403 --> -0.907403).  Saving model ...
Epoch: 28 cost time: 0.4908292293548584
Epoch: 28, Steps: 2 | Train Loss: 0.220 Vali Loss: 0.399 Vali Acc: 0.911 Test Loss: 0.399 Test Acc: 0.911
Validation loss decreased (-0.907403 --> -0.911107).  Saving model ...
Epoch: 29 cost time: 0.48867011070251465
Epoch: 29, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.381 Vali Acc: 0.911 Test Loss: 0.381 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 30 cost time: 0.5232796669006348
Epoch: 30, Steps: 2 | Train Loss: 0.203 Vali Loss: 0.366 Vali Acc: 0.911 Test Loss: 0.366 Test Acc: 0.911
Validation loss decreased (-0.911107 --> -0.911107).  Saving model ...
Epoch: 31 cost time: 0.49768757820129395
Epoch: 31, Steps: 2 | Train Loss: 0.175 Vali Loss: 0.353 Vali Acc: 0.915 Test Loss: 0.353 Test Acc: 0.915
Validation loss decreased (-0.911107 --> -0.914811).  Saving model ...
Epoch: 32 cost time: 0.4600522518157959
Epoch: 32, Steps: 2 | Train Loss: 0.146 Vali Loss: 0.342 Vali Acc: 0.915 Test Loss: 0.342 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 33 cost time: 0.4908769130706787
Epoch: 33, Steps: 2 | Train Loss: 0.136 Vali Loss: 0.332 Vali Acc: 0.915 Test Loss: 0.332 Test Acc: 0.915
Validation loss decreased (-0.914811 --> -0.914811).  Saving model ...
Epoch: 34 cost time: 0.5046484470367432
Epoch: 34, Steps: 2 | Train Loss: 0.142 Vali Loss: 0.323 Vali Acc: 0.919 Test Loss: 0.323 Test Acc: 0.919
Validation loss decreased (-0.914811 --> -0.918515).  Saving model ...
Epoch: 35 cost time: 0.5282618999481201
Epoch: 35, Steps: 2 | Train Loss: 0.111 Vali Loss: 0.315 Vali Acc: 0.922 Test Loss: 0.315 Test Acc: 0.922
Validation loss decreased (-0.918515 --> -0.922219).  Saving model ...
Epoch: 36 cost time: 0.47899699211120605
Epoch: 36, Steps: 2 | Train Loss: 0.112 Vali Loss: 0.307 Vali Acc: 0.919 Test Loss: 0.307 Test Acc: 0.919
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5058004856109619
Epoch: 37, Steps: 2 | Train Loss: 0.118 Vali Loss: 0.299 Vali Acc: 0.919 Test Loss: 0.299 Test Acc: 0.919
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 0.5227653980255127
Epoch: 38, Steps: 2 | Train Loss: 0.098 Vali Loss: 0.293 Vali Acc: 0.922 Test Loss: 0.293 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 39 cost time: 0.6083810329437256
Epoch: 39, Steps: 2 | Train Loss: 0.097 Vali Loss: 0.287 Vali Acc: 0.922 Test Loss: 0.287 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 40 cost time: 0.5058417320251465
Epoch: 40, Steps: 2 | Train Loss: 0.081 Vali Loss: 0.282 Vali Acc: 0.922 Test Loss: 0.282 Test Acc: 0.922
Validation loss decreased (-0.922219 --> -0.922219).  Saving model ...
Epoch: 41 cost time: 0.5392470359802246
Epoch: 41, Steps: 2 | Train Loss: 0.073 Vali Loss: 0.277 Vali Acc: 0.926 Test Loss: 0.277 Test Acc: 0.926
Validation loss decreased (-0.922219 --> -0.925923).  Saving model ...
Epoch: 42 cost time: 0.5265429019927979
Epoch: 42, Steps: 2 | Train Loss: 0.074 Vali Loss: 0.272 Vali Acc: 0.926 Test Loss: 0.272 Test Acc: 0.926
Validation loss decreased (-0.925923 --> -0.925923).  Saving model ...
Epoch: 43 cost time: 0.4466071128845215
Epoch: 43, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.268 Vali Acc: 0.930 Test Loss: 0.268 Test Acc: 0.930
Validation loss decreased (-0.925923 --> -0.929627).  Saving model ...
Epoch: 44 cost time: 0.5155916213989258
Epoch: 44, Steps: 2 | Train Loss: 0.071 Vali Loss: 0.265 Vali Acc: 0.933 Test Loss: 0.265 Test Acc: 0.933
Validation loss decreased (-0.929627 --> -0.933331).  Saving model ...
Epoch: 45 cost time: 0.5098178386688232
Epoch: 45, Steps: 2 | Train Loss: 0.068 Vali Loss: 0.262 Vali Acc: 0.933 Test Loss: 0.262 Test Acc: 0.933
Validation loss decreased (-0.933331 --> -0.933331).  Saving model ...
Epoch: 46 cost time: 0.5335454940795898
Epoch: 46, Steps: 2 | Train Loss: 0.061 Vali Loss: 0.260 Vali Acc: 0.937 Test Loss: 0.260 Test Acc: 0.937
Validation loss decreased (-0.933331 --> -0.937034).  Saving model ...
Epoch: 47 cost time: 0.5250959396362305
Epoch: 47, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.257 Vali Acc: 0.937 Test Loss: 0.257 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 48 cost time: 0.49007201194763184
Epoch: 48, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.254 Vali Acc: 0.937 Test Loss: 0.254 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937034).  Saving model ...
Epoch: 49 cost time: 0.5379369258880615
Epoch: 49, Steps: 2 | Train Loss: 0.047 Vali Loss: 0.252 Vali Acc: 0.937 Test Loss: 0.252 Test Acc: 0.937
Validation loss decreased (-0.937034 --> -0.937035).  Saving model ...
Epoch: 50 cost time: 0.5171792507171631
Epoch: 50, Steps: 2 | Train Loss: 0.048 Vali Loss: 0.249 Vali Acc: 0.937 Test Loss: 0.249 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 51 cost time: 0.5565645694732666
Epoch: 51, Steps: 2 | Train Loss: 0.052 Vali Loss: 0.247 Vali Acc: 0.937 Test Loss: 0.247 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 52 cost time: 0.5286891460418701
Epoch: 52, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.245 Vali Acc: 0.937 Test Loss: 0.245 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 53 cost time: 0.4802267551422119
Epoch: 53, Steps: 2 | Train Loss: 0.053 Vali Loss: 0.244 Vali Acc: 0.933 Test Loss: 0.244 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 54 cost time: 0.4802083969116211
Epoch: 54, Steps: 2 | Train Loss: 0.043 Vali Loss: 0.242 Vali Acc: 0.937 Test Loss: 0.242 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 55 cost time: 0.4257359504699707
Epoch: 55, Steps: 2 | Train Loss: 0.044 Vali Loss: 0.240 Vali Acc: 0.937 Test Loss: 0.240 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 56 cost time: 0.5095725059509277
Epoch: 56, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.239 Vali Acc: 0.937 Test Loss: 0.239 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 57 cost time: 0.4458949565887451
Epoch: 57, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.238 Vali Acc: 0.937 Test Loss: 0.238 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 58 cost time: 0.47508716583251953
Epoch: 58, Steps: 2 | Train Loss: 0.040 Vali Loss: 0.236 Vali Acc: 0.937 Test Loss: 0.236 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 59 cost time: 0.4439733028411865
Epoch: 59, Steps: 2 | Train Loss: 0.034 Vali Loss: 0.235 Vali Acc: 0.937 Test Loss: 0.235 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 60 cost time: 0.4490494728088379
Epoch: 60, Steps: 2 | Train Loss: 0.032 Vali Loss: 0.234 Vali Acc: 0.937 Test Loss: 0.234 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 61 cost time: 0.4286963939666748
Epoch: 61, Steps: 2 | Train Loss: 0.027 Vali Loss: 0.233 Vali Acc: 0.937 Test Loss: 0.233 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 62 cost time: 0.49501919746398926
Epoch: 62, Steps: 2 | Train Loss: 0.026 Vali Loss: 0.231 Vali Acc: 0.937 Test Loss: 0.231 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 63 cost time: 0.5084772109985352
Epoch: 63, Steps: 2 | Train Loss: 0.031 Vali Loss: 0.230 Vali Acc: 0.937 Test Loss: 0.230 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 64 cost time: 0.5534248352050781
Epoch: 64, Steps: 2 | Train Loss: 0.028 Vali Loss: 0.229 Vali Acc: 0.937 Test Loss: 0.229 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 65 cost time: 0.5782032012939453
Epoch: 65, Steps: 2 | Train Loss: 0.025 Vali Loss: 0.227 Vali Acc: 0.937 Test Loss: 0.227 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 66 cost time: 0.5416750907897949
Epoch: 66, Steps: 2 | Train Loss: 0.023 Vali Loss: 0.226 Vali Acc: 0.937 Test Loss: 0.226 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 67 cost time: 0.5027401447296143
Epoch: 67, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.225 Vali Acc: 0.937 Test Loss: 0.225 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 68 cost time: 0.4938533306121826
Epoch: 68, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 69 cost time: 0.5170011520385742
Epoch: 69, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.224 Vali Acc: 0.937 Test Loss: 0.224 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 70 cost time: 0.5421595573425293
Epoch: 70, Steps: 2 | Train Loss: 0.020 Vali Loss: 0.223 Vali Acc: 0.937 Test Loss: 0.223 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 71 cost time: 0.5855786800384521
Epoch: 71, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 72 cost time: 0.5631701946258545
Epoch: 72, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.222 Vali Acc: 0.937 Test Loss: 0.222 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 73 cost time: 0.5458459854125977
Epoch: 73, Steps: 2 | Train Loss: 0.022 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 74 cost time: 0.5218729972839355
Epoch: 74, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.221 Vali Acc: 0.937 Test Loss: 0.221 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 75 cost time: 0.49994373321533203
Epoch: 75, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 76 cost time: 0.48553037643432617
Epoch: 76, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.220 Vali Acc: 0.937 Test Loss: 0.220 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 77 cost time: 0.5102579593658447
Epoch: 77, Steps: 2 | Train Loss: 0.017 Vali Loss: 0.220 Vali Acc: 0.933 Test Loss: 0.220 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 78 cost time: 0.5460832118988037
Epoch: 78, Steps: 2 | Train Loss: 0.024 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 79 cost time: 0.5147910118103027
Epoch: 79, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.219 Vali Acc: 0.933 Test Loss: 0.219 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 80 cost time: 0.4669761657714844
Epoch: 80, Steps: 2 | Train Loss: 0.019 Vali Loss: 0.219 Vali Acc: 0.937 Test Loss: 0.219 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 81 cost time: 0.4659867286682129
Epoch: 81, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 1 out of 10
Epoch: 82 cost time: 0.5389635562896729
Epoch: 82, Steps: 2 | Train Loss: 0.018 Vali Loss: 0.218 Vali Acc: 0.933 Test Loss: 0.218 Test Acc: 0.933
EarlyStopping counter: 2 out of 10
Epoch: 83 cost time: 0.5116100311279297
Epoch: 83, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 3 out of 10
Epoch: 84 cost time: 0.5151271820068359
Epoch: 84, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.217 Vali Acc: 0.933 Test Loss: 0.217 Test Acc: 0.933
EarlyStopping counter: 4 out of 10
Epoch: 85 cost time: 0.5130045413970947
Epoch: 85, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 5 out of 10
Epoch: 86 cost time: 0.5459136962890625
Epoch: 86, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 6 out of 10
Epoch: 87 cost time: 0.5375187397003174
Epoch: 87, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.216 Vali Acc: 0.933 Test Loss: 0.216 Test Acc: 0.933
EarlyStopping counter: 7 out of 10
Epoch: 88 cost time: 0.5155730247497559
Epoch: 88, Steps: 2 | Train Loss: 0.015 Vali Loss: 0.215 Vali Acc: 0.933 Test Loss: 0.215 Test Acc: 0.933
EarlyStopping counter: 8 out of 10
Epoch: 89 cost time: 0.5605146884918213
Epoch: 89, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.933 Test Loss: 0.214 Test Acc: 0.933
EarlyStopping counter: 9 out of 10
Epoch: 90 cost time: 0.5660951137542725
Epoch: 90, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 91 cost time: 0.5206706523895264
Epoch: 91, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
Validation loss decreased (-0.937035 --> -0.937035).  Saving model ...
Epoch: 92 cost time: 0.5387935638427734
Epoch: 92, Steps: 2 | Train Loss: 0.014 Vali Loss: 0.214 Vali Acc: 0.941 Test Loss: 0.214 Test Acc: 0.941
Validation loss decreased (-0.937035 --> -0.940739).  Saving model ...
Epoch: 93 cost time: 0.5125975608825684
Epoch: 93, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.214 Vali Acc: 0.937 Test Loss: 0.214 Test Acc: 0.937
EarlyStopping counter: 1 out of 10
Epoch: 94 cost time: 0.512904167175293
Epoch: 94, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 2 out of 10
Epoch: 95 cost time: 0.5197603702545166
Epoch: 95, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 3 out of 10
Epoch: 96 cost time: 0.5249571800231934
Epoch: 96, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.213 Vali Acc: 0.937 Test Loss: 0.213 Test Acc: 0.937
EarlyStopping counter: 4 out of 10
Epoch: 97 cost time: 0.5817539691925049
Epoch: 97, Steps: 2 | Train Loss: 0.013 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 5 out of 10
Epoch: 98 cost time: 0.5048472881317139
Epoch: 98, Steps: 2 | Train Loss: 0.009 Vali Loss: 0.212 Vali Acc: 0.937 Test Loss: 0.212 Test Acc: 0.937
EarlyStopping counter: 6 out of 10
Epoch: 99 cost time: 0.47872185707092285
Epoch: 99, Steps: 2 | Train Loss: 0.011 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 7 out of 10
Epoch: 100 cost time: 0.564445972442627
Epoch: 100, Steps: 2 | Train Loss: 0.012 Vali Loss: 0.211 Vali Acc: 0.937 Test Loss: 0.211 Test Acc: 0.937
EarlyStopping counter: 8 out of 10
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.9407407407407408
model parameter : 19686
model size : 0.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_ERing           Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/ERing
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             4                   Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

30
270
>>>>>>>start training : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
30
270
270
Epoch: 1 cost time: 2.129922389984131
Epoch: 1, Steps: 2 | Train Loss: 1.778 Vali Loss: 1.761 Vali Acc: 0.170 Test Loss: 1.761 Test Acc: 0.170
Validation loss decreased (inf --> -0.170353).  Saving model ...
Epoch: 2 cost time: 0.47455382347106934
Epoch: 2, Steps: 2 | Train Loss: 1.767 Vali Loss: 1.703 Vali Acc: 0.200 Test Loss: 1.703 Test Acc: 0.200
Validation loss decreased (-0.170353 --> -0.199983).  Saving model ...
Epoch: 3 cost time: 0.4543113708496094
Epoch: 3, Steps: 2 | Train Loss: 1.651 Vali Loss: 1.661 Vali Acc: 0.256 Test Loss: 1.661 Test Acc: 0.256
Validation loss decreased (-0.199983 --> -0.255539).  Saving model ...
Epoch: 4 cost time: 0.4527254104614258
Epoch: 4, Steps: 2 | Train Loss: 1.620 Vali Loss: 1.624 Vali Acc: 0.311 Test Loss: 1.624 Test Acc: 0.311
Validation loss decreased (-0.255539 --> -0.311095).  Saving model ...
Epoch: 5 cost time: 0.4729633331298828
Epoch: 5, Steps: 2 | Train Loss: 1.603 Vali Loss: 1.576 Vali Acc: 0.370 Test Loss: 1.576 Test Acc: 0.370
Validation loss decreased (-0.311095 --> -0.370355).  Saving model ...
Epoch: 6 cost time: 0.4681398868560791
Epoch: 6, Steps: 2 | Train Loss: 1.560 Vali Loss: 1.522 Vali Acc: 0.422 Test Loss: 1.522 Test Acc: 0.422
Validation loss decreased (-0.370355 --> -0.422207).  Saving model ...
Epoch: 7 cost time: 0.49840879440307617
Epoch: 7, Steps: 2 | Train Loss: 1.492 Vali Loss: 1.462 Vali Acc: 0.493 Test Loss: 1.462 Test Acc: 0.493
Validation loss decreased (-0.422207 --> -0.492578).  Saving model ...
Epoch: 8 cost time: 0.5653741359710693
Epoch: 8, Steps: 2 | Train Loss: 1.421 Vali Loss: 1.400 Vali Acc: 0.574 Test Loss: 1.400 Test Acc: 0.574
Validation loss decreased (-0.492578 --> -0.574060).  Saving model ...
Epoch: 9 cost time: 0.3788282871246338
Epoch: 9, Steps: 2 | Train Loss: 1.358 Vali Loss: 1.334 Vali Acc: 0.622 Test Loss: 1.334 Test Acc: 0.622
Validation loss decreased (-0.574060 --> -0.622209).  Saving model ...
Epoch: 10 cost time: 0.4825584888458252
Epoch: 10, Steps: 2 | Train Loss: 1.234 Vali Loss: 1.267 Vali Acc: 0.667 Test Loss: 1.267 Test Acc: 0.667
Validation loss decreased (-0.622209 --> -0.666654).  Saving model ...
Epoch: 11 cost time: 0.36975765228271484
Epoch: 11, Steps: 2 | Train Loss: 1.207 Vali Loss: 1.199 Vali Acc: 0.711 Test Loss: 1.199 Test Acc: 0.711
Validation loss decreased (-0.666654 --> -0.711099).  Saving model ...
Epoch: 12 cost time: 0.507889986038208
Epoch: 12, Steps: 2 | Train Loss: 1.095 Vali Loss: 1.132 Vali Acc: 0.741 Test Loss: 1.132 Test Acc: 0.741
Validation loss decreased (-0.711099 --> -0.740729).  Saving model ...
Epoch: 13 cost time: 0.4588906764984131
Epoch: 13, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.066 Vali Acc: 0.763 Test Loss: 1.066 Test Acc: 0.763
Validation loss decreased (-0.740729 --> -0.762952).  Saving model ...
Epoch: 14 cost time: 0.44876813888549805
Epoch: 14, Steps: 2 | Train Loss: 0.994 Vali Loss: 1.003 Vali Acc: 0.778 Test Loss: 1.003 Test Acc: 0.778
Validation loss decreased (-0.762952 --> -0.777768).  Saving model ...
Epoch: 15 cost time: 0.43979477882385254
Epoch: 15, Steps: 2 | Train Loss: 0.916 Vali Loss: 0.945 Vali Acc: 0.800 Test Loss: 0.945 Test Acc: 0.800
Validation loss decreased (-0.777768 --> -0.799991).  Saving model ...
Epoch: 16 cost time: 0.4709925651550293
Epoch: 16, Steps: 2 | Train Loss: 0.904 Vali Loss: 0.891 Vali Acc: 0.804 Test Loss: 0.891 Test Acc: 0.804
Validation loss decreased (-0.799991 --> -0.803695).  Saving model ...
Epoch: 17 cost time: 0.5025951862335205
Epoch: 17, Steps: 2 | Train Loss: 0.774 Vali Loss: 0.841 Vali Acc: 0.811 Test Loss: 0.841 Test Acc: 0.811
Validation loss decreased (-0.803695 --> -0.811103).  Saving model ...
Epoch: 18 cost time: 0.5687224864959717
Epoch: 18, Steps: 2 | Train Loss: 0.737 Vali Loss: 0.793 Vali Acc: 0.830 Test Loss: 0.793 Test Acc: 0.830
Validation loss decreased (-0.811103 --> -0.829622).  Saving model ...
Epoch: 19 cost time: 0.49072813987731934
Epoch: 19, Steps: 2 | Train Loss: 0.649 Vali Loss: 0.748 Vali Acc: 0.837 Test Loss: 0.748 Test Acc: 0.837
Validation loss decreased (-0.829622 --> -0.837030).  Saving model ...
Epoch: 20 cost time: 0.4918079376220703
Epoch: 20, Steps: 2 | Train Loss: 0.593 Vali Loss: 0.706 Vali Acc: 0.841 Test Loss: 0.706 Test Acc: 0.841
Validation loss decreased (-0.837030 --> -0.840734).  Saving model ...
Epoch: 21 cost time: 0.4801595211029053
Epoch: 21, Steps: 2 | Train Loss: 0.538 Vali Loss: 0.669 Vali Acc: 0.848 Test Loss: 0.669 Test Acc: 0.848
Validation loss decreased (-0.840734 --> -0.848141).  Saving model ...
Epoch: 22 cost time: 0.5432159900665283
Epoch: 22, Steps: 2 | Train Loss: 0.508 Vali Loss: 0.636 Vali Acc: 0.848 Test Loss: 0.636 Test Acc: 0.848
Validation loss decreased (-0.848141 --> -0.848142).  Saving model ...
Epoch: 23 cost time: 0.5172412395477295
Epoch: 23, Steps: 2 | Train Loss: 0.485 Vali Loss: 0.607 Vali Acc: 0.856 Test Loss: 0.607 Test Acc: 0.856
Validation loss decreased (-0.848142 --> -0.855549).  Saving model ...
Epoch: 24 cost time: 0.5183248519897461
Epoch: 24, Steps: 2 | Train Loss: 0.424 Vali Loss: 0.579 Vali Acc: 0.859 Test Loss: 0.579 Test Acc: 0.859
Validation loss decreased (-0.855549 --> -0.859253).  Saving model ...
Epoch: 25 cost time: 0.498859167098999
Epoch: 25, Steps: 2 | Train Loss: 0.388 Vali Loss: 0.554 Vali Acc: 0.859 Test Loss: 0.554 Test Acc: 0.859
Validation loss decreased (-0.859253 --> -0.859254).  Saving model ...
Epoch: 26 cost time: 0.4998023509979248
Epoch: 26, Steps: 2 | Train Loss: 0.361 Vali Loss: 0.531 Vali Acc: 0.863 Test Loss: 0.531 Test Acc: 0.863
Validation loss decreased (-0.859254 --> -0.862958).  Saving model ...
Epoch: 27 cost time: 0.5633482933044434
Epoch: 27, Steps: 2 | Train Loss: 0.346 Vali Loss: 0.510 Vali Acc: 0.863 Test Loss: 0.510 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 28 cost time: 0.4431607723236084
Epoch: 28, Steps: 2 | Train Loss: 0.327 Vali Loss: 0.491 Vali Acc: 0.863 Test Loss: 0.491 Test Acc: 0.863
Validation loss decreased (-0.862958 --> -0.862958).  Saving model ...
Epoch: 29 cost time: 0.5188443660736084
Epoch: 29, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.474 Vali Acc: 0.859 Test Loss: 0.474 Test Acc: 0.859
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 0.4679906368255615
Epoch: 30, Steps: 2 | Train Loss: 0.312 Vali Loss: 0.459 Vali Acc: 0.859 Test Loss: 0.459 Test Acc: 0.859
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 0.47788357734680176
Epoch: 31, Steps: 2 | Train Loss: 0.279 Vali Loss: 0.446 Vali Acc: 0.859 Test Loss: 0.446 Test Acc: 0.859
EarlyStopping counter: 3 out of 10
Epoch: 32 cost time: 0.4173243045806885
Epoch: 32, Steps: 2 | Train Loss: 0.262 Vali Loss: 0.435 Vali Acc: 0.859 Test Loss: 0.435 Test Acc: 0.859
EarlyStopping counter: 4 out of 10
Epoch: 33 cost time: 0.4301178455352783
Epoch: 33, Steps: 2 | Train Loss: 0.221 Vali Loss: 0.424 Vali Acc: 0.867 Test Loss: 0.424 Test Acc: 0.867
Validation loss decreased (-0.862958 --> -0.866662).  Saving model ...
Epoch: 34 cost time: 0.49521589279174805
Epoch: 34, Steps: 2 | Train Loss: 0.233 Vali Loss: 0.414 Vali Acc: 0.863 Test Loss: 0.414 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 0.5324892997741699
Epoch: 35, Steps: 2 | Train Loss: 0.206 Vali Loss: 0.406 Vali Acc: 0.867 Test Loss: 0.406 Test Acc: 0.867
Validation loss decreased (-0.866662 --> -0.866663).  Saving model ...
Epoch: 36 cost time: 0.43196678161621094
Epoch: 36, Steps: 2 | Train Loss: 0.202 Vali Loss: 0.398 Vali Acc: 0.863 Test Loss: 0.398 Test Acc: 0.863
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 0.5189507007598877
Epoch: 37, Steps: 2 | Train Loss: 0.214 Vali Loss: 0.391 Vali Acc: 0.874 Test Loss: 0.391 Test Acc: 0.874
Validation loss decreased (-0.866663 --> -0.874070).  Saving model ...
Epoch: 38 cost time: 0.44051575660705566
Epoch: 38, Steps: 2 | Train Loss: 0.190 Vali Loss: 0.386 Vali Acc: 0.870 Test Loss: 0.386 Test Acc: 0.870
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 0.49486207962036133
Epoch: 39, Steps: 2 | Train Loss: 0.183 Vali Loss: 0.382 Vali Acc: 0.878 Test Loss: 0.382 Test Acc: 0.878
Validation loss decreased (-0.874070 --> -0.877774).  Saving model ...
Epoch: 40 cost time: 0.4369227886199951
Epoch: 40, Steps: 2 | Train Loss: 0.162 Vali Loss: 0.378 Vali Acc: 0.874 Test Loss: 0.378 Test Acc: 0.874
EarlyStopping counter: 1 out of 10
Epoch: 41 cost time: 0.46869897842407227
Epoch: 41, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.373 Vali Acc: 0.874 Test Loss: 0.373 Test Acc: 0.874
EarlyStopping counter: 2 out of 10
Epoch: 42 cost time: 0.5524280071258545
Epoch: 42, Steps: 2 | Train Loss: 0.154 Vali Loss: 0.370 Vali Acc: 0.870 Test Loss: 0.370 Test Acc: 0.870
EarlyStopping counter: 3 out of 10
Epoch: 43 cost time: 0.5085670948028564
Epoch: 43, Steps: 2 | Train Loss: 0.139 Vali Loss: 0.367 Vali Acc: 0.874 Test Loss: 0.367 Test Acc: 0.874
EarlyStopping counter: 4 out of 10
Epoch: 44 cost time: 0.4784412384033203
Epoch: 44, Steps: 2 | Train Loss: 0.145 Vali Loss: 0.364 Vali Acc: 0.870 Test Loss: 0.364 Test Acc: 0.870
EarlyStopping counter: 5 out of 10
Epoch: 45 cost time: 0.5416009426116943
Epoch: 45, Steps: 2 | Train Loss: 0.144 Vali Loss: 0.361 Vali Acc: 0.870 Test Loss: 0.361 Test Acc: 0.870
EarlyStopping counter: 6 out of 10
Epoch: 46 cost time: 0.5008232593536377
Epoch: 46, Steps: 2 | Train Loss: 0.131 Vali Loss: 0.359 Vali Acc: 0.874 Test Loss: 0.359 Test Acc: 0.874
EarlyStopping counter: 7 out of 10
Epoch: 47 cost time: 0.5160479545593262
Epoch: 47, Steps: 2 | Train Loss: 0.116 Vali Loss: 0.356 Vali Acc: 0.870 Test Loss: 0.356 Test Acc: 0.870
EarlyStopping counter: 8 out of 10
Epoch: 48 cost time: 0.5597610473632812
Epoch: 48, Steps: 2 | Train Loss: 0.108 Vali Loss: 0.353 Vali Acc: 0.867 Test Loss: 0.353 Test Acc: 0.867
EarlyStopping counter: 9 out of 10
Epoch: 49 cost time: 0.5539343357086182
Epoch: 49, Steps: 2 | Train Loss: 0.104 Vali Loss: 0.350 Vali Acc: 0.870 Test Loss: 0.350 Test Acc: 0.870
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_ERing_ETSformer_UEA_ftM_sl65_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
270
test shape: torch.Size([270, 6]) torch.Size([270, 1])
accuracy:0.8777777777777778
model parameter : 19686
model size : 0.70MB
