Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.775705575942993
Epoch: 1, Steps: 17 | Train Loss: 1.888 Vali Loss: 1.353 Vali Acc: 0.353 Test Loss: 1.353 Test Acc: 0.353
Validation loss decreased (inf --> -0.352588).  Saving model ...
Epoch: 2 cost time: 3.850994825363159
Epoch: 2, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.148 Vali Acc: 0.630 Test Loss: 1.148 Test Acc: 0.630
Validation loss decreased (-0.352588 --> -0.630046).  Saving model ...
Epoch: 3 cost time: 3.907097339630127
Epoch: 3, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.910 Vali Acc: 0.688 Test Loss: 0.910 Test Acc: 0.688
Validation loss decreased (-0.630046 --> -0.687852).  Saving model ...
Epoch: 4 cost time: 3.6111385822296143
Epoch: 4, Steps: 17 | Train Loss: 0.606 Vali Loss: 1.028 Vali Acc: 0.705 Test Loss: 1.028 Test Acc: 0.705
Validation loss decreased (-0.687852 --> -0.705192).  Saving model ...
Epoch: 5 cost time: 3.3223977088928223
Epoch: 5, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.832 Vali Acc: 0.705 Test Loss: 0.832 Test Acc: 0.705
Validation loss decreased (-0.705192 --> -0.705194).  Saving model ...
Epoch: 6 cost time: 3.3333394527435303
Epoch: 6, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.807 Vali Acc: 0.792 Test Loss: 0.807 Test Acc: 0.792
Validation loss decreased (-0.705194 --> -0.791899).  Saving model ...
Epoch: 7 cost time: 3.151276111602783
Epoch: 7, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.255 Vali Acc: 0.763 Test Loss: 1.255 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.618673801422119
Epoch: 8, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.842 Vali Acc: 0.815 Test Loss: 0.842 Test Acc: 0.815
Validation loss decreased (-0.791899 --> -0.815020).  Saving model ...
Epoch: 9 cost time: 3.7547757625579834
Epoch: 9, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.037 Vali Acc: 0.792 Test Loss: 1.037 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.242572546005249
Epoch: 10, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.645 Vali Acc: 0.740 Test Loss: 1.645 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.658036231994629
Epoch: 11, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.050 Vali Acc: 0.792 Test Loss: 1.050 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.9793620109558105
Epoch: 12, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.677 Vali Acc: 0.844 Test Loss: 0.677 Test Acc: 0.844
Validation loss decreased (-0.815020 --> -0.843924).  Saving model ...
Epoch: 13 cost time: 3.9638450145721436
Epoch: 13, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.953 Vali Acc: 0.792 Test Loss: 1.953 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.252035140991211
Epoch: 14, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.639 Vali Acc: 0.763 Test Loss: 2.639 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.594557523727417
Epoch: 15, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.359 Vali Acc: 0.867 Test Loss: 1.359 Test Acc: 0.867
Validation loss decreased (-0.843924 --> -0.867038).  Saving model ...
Epoch: 16 cost time: 3.566206216812134
Epoch: 16, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.421 Vali Acc: 0.838 Test Loss: 1.421 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.689039468765259
Epoch: 17, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.747 Vali Acc: 0.803 Test Loss: 1.747 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.7155492305755615
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.035 Vali Acc: 0.838 Test Loss: 2.035 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.672217607498169
Epoch: 19, Steps: 17 | Train Loss: 0.265 Vali Loss: 3.715 Vali Acc: 0.792 Test Loss: 3.715 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 3.3870015144348145
Epoch: 20, Steps: 17 | Train Loss: 0.220 Vali Loss: 2.080 Vali Acc: 0.775 Test Loss: 2.080 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 3.6239359378814697
Epoch: 21, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.101 Vali Acc: 0.803 Test Loss: 2.101 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.6093742847442627
Epoch: 22, Steps: 17 | Train Loss: 0.311 Vali Loss: 3.379 Vali Acc: 0.763 Test Loss: 3.379 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 3.26310658454895
Epoch: 23, Steps: 17 | Train Loss: 0.131 Vali Loss: 3.048 Vali Acc: 0.786 Test Loss: 3.048 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 3.518096446990967
Epoch: 24, Steps: 17 | Train Loss: 0.238 Vali Loss: 3.982 Vali Acc: 0.798 Test Loss: 3.982 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 3.347862958908081
Epoch: 25, Steps: 17 | Train Loss: 0.125 Vali Loss: 2.032 Vali Acc: 0.867 Test Loss: 2.032 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 9228351
model size : 44.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.12455153465271
Epoch: 1, Steps: 17 | Train Loss: 1.877 Vali Loss: 1.363 Vali Acc: 0.347 Test Loss: 1.363 Test Acc: 0.347
Validation loss decreased (inf --> -0.346807).  Saving model ...
Epoch: 2 cost time: 3.0403215885162354
Epoch: 2, Steps: 17 | Train Loss: 0.891 Vali Loss: 1.126 Vali Acc: 0.630 Test Loss: 1.126 Test Acc: 0.630
Validation loss decreased (-0.346807 --> -0.630047).  Saving model ...
Epoch: 3 cost time: 3.388481616973877
Epoch: 3, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.929 Vali Acc: 0.636 Test Loss: 0.929 Test Acc: 0.636
Validation loss decreased (-0.630047 --> -0.635829).  Saving model ...
Epoch: 4 cost time: 3.30647349357605
Epoch: 4, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.784 Vali Acc: 0.734 Test Loss: 0.784 Test Acc: 0.734
Validation loss decreased (-0.635829 --> -0.734096).  Saving model ...
Epoch: 5 cost time: 3.260820150375366
Epoch: 5, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.970 Vali Acc: 0.699 Test Loss: 0.970 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.167248010635376
Epoch: 6, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.056 Vali Acc: 0.769 Test Loss: 1.056 Test Acc: 0.769
Validation loss decreased (-0.734096 --> -0.768776).  Saving model ...
Epoch: 7 cost time: 2.842801809310913
Epoch: 7, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.701 Vali Acc: 0.659 Test Loss: 1.701 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.761589288711548
Epoch: 8, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.069 Vali Acc: 0.694 Test Loss: 1.069 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9603588581085205
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.767 Vali Acc: 0.694 Test Loss: 1.767 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.610306739807129
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.326 Vali Acc: 0.769 Test Loss: 1.326 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.6433169841766357
Epoch: 11, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.765 Vali Acc: 0.763 Test Loss: 1.765 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.0242395401000977
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.700 Vali Acc: 0.786 Test Loss: 1.700 Test Acc: 0.786
Validation loss decreased (-0.768776 --> -0.786110).  Saving model ...
Epoch: 13 cost time: 3.8526129722595215
Epoch: 13, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.627 Vali Acc: 0.763 Test Loss: 1.627 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.671668767929077
Epoch: 14, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.686 Vali Acc: 0.815 Test Loss: 1.686 Test Acc: 0.815
Validation loss decreased (-0.786110 --> -0.815012).  Saving model ...
Epoch: 15 cost time: 3.418701648712158
Epoch: 15, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.010 Vali Acc: 0.786 Test Loss: 2.010 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.3357391357421875
Epoch: 16, Steps: 17 | Train Loss: 0.130 Vali Loss: 3.146 Vali Acc: 0.723 Test Loss: 3.146 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.53922700881958
Epoch: 17, Steps: 17 | Train Loss: 0.393 Vali Loss: 1.721 Vali Acc: 0.803 Test Loss: 1.721 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.538970470428467
Epoch: 18, Steps: 17 | Train Loss: 0.099 Vali Loss: 2.433 Vali Acc: 0.769 Test Loss: 2.433 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.1831603050231934
Epoch: 19, Steps: 17 | Train Loss: 0.221 Vali Loss: 3.707 Vali Acc: 0.769 Test Loss: 3.707 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.3074867725372314
Epoch: 20, Steps: 17 | Train Loss: 0.270 Vali Loss: 3.603 Vali Acc: 0.671 Test Loss: 3.603 Test Acc: 0.671
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.2832071781158447
Epoch: 21, Steps: 17 | Train Loss: 0.201 Vali Loss: 5.125 Vali Acc: 0.717 Test Loss: 5.125 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 3.0650038719177246
Epoch: 22, Steps: 17 | Train Loss: 0.340 Vali Loss: 3.108 Vali Acc: 0.792 Test Loss: 3.108 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.9442007541656494
Epoch: 23, Steps: 17 | Train Loss: 0.762 Vali Loss: 6.240 Vali Acc: 0.728 Test Loss: 6.240 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.435056209564209
Epoch: 24, Steps: 17 | Train Loss: 0.704 Vali Loss: 3.247 Vali Acc: 0.798 Test Loss: 3.247 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 9228351
model size : 44.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.419641971588135
Epoch: 1, Steps: 17 | Train Loss: 1.857 Vali Loss: 1.360 Vali Acc: 0.358 Test Loss: 1.360 Test Acc: 0.358
Validation loss decreased (inf --> -0.358368).  Saving model ...
Epoch: 2 cost time: 3.3638646602630615
Epoch: 2, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.148 Vali Acc: 0.624 Test Loss: 1.148 Test Acc: 0.624
Validation loss decreased (-0.358368 --> -0.624266).  Saving model ...
Epoch: 3 cost time: 3.2497129440307617
Epoch: 3, Steps: 17 | Train Loss: 0.796 Vali Loss: 1.212 Vali Acc: 0.642 Test Loss: 1.212 Test Acc: 0.642
Validation loss decreased (-0.624266 --> -0.641606).  Saving model ...
Epoch: 4 cost time: 3.127591848373413
Epoch: 4, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
Validation loss decreased (-0.641606 --> -0.809242).  Saving model ...
Epoch: 5 cost time: 3.140002489089966
Epoch: 5, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.800 Vali Acc: 0.769 Test Loss: 0.800 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.880673408508301
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.009 Vali Acc: 0.694 Test Loss: 1.009 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.90278697013855
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.146 Vali Acc: 0.786 Test Loss: 1.146 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7184410095214844
Epoch: 8, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.930 Vali Acc: 0.838 Test Loss: 0.930 Test Acc: 0.838
Validation loss decreased (-0.809242 --> -0.838141).  Saving model ...
Epoch: 9 cost time: 3.162541151046753
Epoch: 9, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.249 Vali Acc: 0.734 Test Loss: 1.249 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.1751110553741455
Epoch: 10, Steps: 17 | Train Loss: 0.275 Vali Loss: 1.521 Vali Acc: 0.734 Test Loss: 1.521 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1064798831939697
Epoch: 11, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.610 Vali Acc: 0.798 Test Loss: 1.610 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.540114641189575
Epoch: 12, Steps: 17 | Train Loss: 0.346 Vali Loss: 1.903 Vali Acc: 0.798 Test Loss: 1.903 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.326770067214966
Epoch: 13, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.314 Vali Acc: 0.786 Test Loss: 1.314 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.991381883621216
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.183 Vali Acc: 0.751 Test Loss: 2.183 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.001648187637329
Epoch: 15, Steps: 17 | Train Loss: 0.271 Vali Loss: 3.865 Vali Acc: 0.549 Test Loss: 3.865 Test Acc: 0.549
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.2895419597625732
Epoch: 16, Steps: 17 | Train Loss: 0.178 Vali Loss: 3.498 Vali Acc: 0.676 Test Loss: 3.498 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.1919991970062256
Epoch: 17, Steps: 17 | Train Loss: 0.975 Vali Loss: 1.652 Vali Acc: 0.786 Test Loss: 1.652 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.2452054023742676
Epoch: 18, Steps: 17 | Train Loss: 0.305 Vali Loss: 3.553 Vali Acc: 0.728 Test Loss: 3.553 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 9228351
model size : 44.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.129234790802002
Epoch: 1, Steps: 17 | Train Loss: 1.865 Vali Loss: 1.382 Vali Acc: 0.393 Test Loss: 1.382 Test Acc: 0.393
Validation loss decreased (inf --> -0.393050).  Saving model ...
Epoch: 2 cost time: 2.737626075744629
Epoch: 2, Steps: 17 | Train Loss: 0.998 Vali Loss: 1.026 Vali Acc: 0.624 Test Loss: 1.026 Test Acc: 0.624
Validation loss decreased (-0.393050 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 3.0491511821746826
Epoch: 3, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.844 Vali Acc: 0.653 Test Loss: 0.844 Test Acc: 0.653
Validation loss decreased (-0.624267 --> -0.653171).  Saving model ...
Epoch: 4 cost time: 3.0642783641815186
Epoch: 4, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.744 Vali Acc: 0.728 Test Loss: 0.744 Test Acc: 0.728
Validation loss decreased (-0.653171 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 2.852062225341797
Epoch: 5, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.813 Vali Acc: 0.775 Test Loss: 0.813 Test Acc: 0.775
Validation loss decreased (-0.728316 --> -0.774558).  Saving model ...
Epoch: 6 cost time: 2.9759535789489746
Epoch: 6, Steps: 17 | Train Loss: 0.248 Vali Loss: 2.170 Vali Acc: 0.659 Test Loss: 2.170 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8498635292053223
Epoch: 7, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.825 Vali Acc: 0.595 Test Loss: 1.825 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.923935890197754
Epoch: 8, Steps: 17 | Train Loss: 0.369 Vali Loss: 1.318 Vali Acc: 0.694 Test Loss: 1.318 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8292605876922607
Epoch: 9, Steps: 17 | Train Loss: 0.360 Vali Loss: 2.321 Vali Acc: 0.665 Test Loss: 2.321 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.747795820236206
Epoch: 10, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.096 Vali Acc: 0.775 Test Loss: 1.096 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.562413215637207
Epoch: 11, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.460 Vali Acc: 0.769 Test Loss: 1.460 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.7596588134765625
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 3.388 Vali Acc: 0.694 Test Loss: 3.388 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.988210439682007
Epoch: 13, Steps: 17 | Train Loss: 0.385 Vali Loss: 2.121 Vali Acc: 0.746 Test Loss: 2.121 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.4106669425964355
Epoch: 14, Steps: 17 | Train Loss: 0.486 Vali Loss: 2.513 Vali Acc: 0.757 Test Loss: 2.513 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.316596269607544
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 2.066 Vali Acc: 0.746 Test Loss: 2.066 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7745664739884393
model parameter : 9228351
model size : 44.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.158482789993286
Epoch: 1, Steps: 17 | Train Loss: 1.835 Vali Loss: 1.587 Vali Acc: 0.301 Test Loss: 1.587 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 2.699660062789917
Epoch: 2, Steps: 17 | Train Loss: 1.110 Vali Loss: 1.070 Vali Acc: 0.578 Test Loss: 1.070 Test Acc: 0.578
Validation loss decreased (-0.300562 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 3.0375747680664062
Epoch: 3, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.940 Vali Acc: 0.555 Test Loss: 0.940 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.309086799621582
Epoch: 4, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.789 Vali Acc: 0.740 Test Loss: 0.789 Test Acc: 0.740
Validation loss decreased (-0.578024 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 3.2682056427001953
Epoch: 5, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.032 Vali Acc: 0.740 Test Loss: 1.032 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1088175773620605
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 2.179 Vali Acc: 0.647 Test Loss: 2.179 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.085526466369629
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.728 Vali Acc: 0.734 Test Loss: 0.728 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.0949995517730713
Epoch: 8, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.013 Vali Acc: 0.769 Test Loss: 1.013 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768776).  Saving model ...
Epoch: 9 cost time: 3.4425697326660156
Epoch: 9, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.866 Vali Acc: 0.792 Test Loss: 0.866 Test Acc: 0.792
Validation loss decreased (-0.768776 --> -0.791899).  Saving model ...
Epoch: 10 cost time: 3.218817710876465
Epoch: 10, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.175 Vali Acc: 0.717 Test Loss: 1.175 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.2033796310424805
Epoch: 11, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.244 Vali Acc: 0.786 Test Loss: 1.244 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.651690721511841
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.487 Vali Acc: 0.763 Test Loss: 1.487 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.778775453567505
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.470 Vali Acc: 0.751 Test Loss: 2.470 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8903753757476807
Epoch: 14, Steps: 17 | Train Loss: 0.184 Vali Loss: 2.331 Vali Acc: 0.711 Test Loss: 2.331 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.487631320953369
Epoch: 15, Steps: 17 | Train Loss: 0.340 Vali Loss: 2.063 Vali Acc: 0.780 Test Loss: 2.063 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.562445640563965
Epoch: 16, Steps: 17 | Train Loss: 0.235 Vali Loss: 2.542 Vali Acc: 0.751 Test Loss: 2.542 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.662642478942871
Epoch: 17, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.919 Vali Acc: 0.792 Test Loss: 1.919 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.6989572048187256
Epoch: 18, Steps: 17 | Train Loss: 0.129 Vali Loss: 2.004 Vali Acc: 0.792 Test Loss: 2.004 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.4864344596862793
Epoch: 19, Steps: 17 | Train Loss: 0.207 Vali Loss: 2.616 Vali Acc: 0.786 Test Loss: 2.616 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 7131199
model size : 36.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.371264934539795
Epoch: 1, Steps: 17 | Train Loss: 1.849 Vali Loss: 1.606 Vali Acc: 0.306 Test Loss: 1.606 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 3.430762767791748
Epoch: 2, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.102 Vali Acc: 0.584 Test Loss: 1.102 Test Acc: 0.584
Validation loss decreased (-0.306342 --> -0.583804).  Saving model ...
Epoch: 3 cost time: 3.272010087966919
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 1.022 Vali Acc: 0.538 Test Loss: 1.022 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7940073013305664
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.789 Vali Acc: 0.734 Test Loss: 0.789 Test Acc: 0.734
Validation loss decreased (-0.583804 --> -0.734096).  Saving model ...
Epoch: 5 cost time: 2.6697580814361572
Epoch: 5, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.981 Vali Acc: 0.717 Test Loss: 0.981 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.062831163406372
Epoch: 6, Steps: 17 | Train Loss: 0.482 Vali Loss: 1.960 Vali Acc: 0.671 Test Loss: 1.960 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.0123510360717773
Epoch: 7, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.390 Vali Acc: 0.694 Test Loss: 1.390 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.910740613937378
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.073 Vali Acc: 0.769 Test Loss: 1.073 Test Acc: 0.769
Validation loss decreased (-0.734096 --> -0.768775).  Saving model ...
Epoch: 9 cost time: 3.173283100128174
Epoch: 9, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.937 Vali Acc: 0.751 Test Loss: 0.937 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.2083237171173096
Epoch: 10, Steps: 17 | Train Loss: 0.142 Vali Loss: 3.376 Vali Acc: 0.607 Test Loss: 3.376 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2132229804992676
Epoch: 11, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.105 Vali Acc: 0.815 Test Loss: 1.105 Test Acc: 0.815
Validation loss decreased (-0.768775 --> -0.815018).  Saving model ...
Epoch: 12 cost time: 3.1922857761383057
Epoch: 12, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.944 Vali Acc: 0.723 Test Loss: 1.944 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3876113891601562
Epoch: 13, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.693 Vali Acc: 0.780 Test Loss: 1.693 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.0231447219848633
Epoch: 14, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.642 Vali Acc: 0.671 Test Loss: 2.642 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.3451614379882812
Epoch: 15, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.649 Vali Acc: 0.780 Test Loss: 1.649 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.342338800430298
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.729 Vali Acc: 0.676 Test Loss: 2.729 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9988811016082764
Epoch: 17, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.153 Vali Acc: 0.803 Test Loss: 2.153 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9969701766967773
Epoch: 18, Steps: 17 | Train Loss: 0.352 Vali Loss: 3.149 Vali Acc: 0.705 Test Loss: 3.149 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.340442657470703
Epoch: 19, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.672 Vali Acc: 0.827 Test Loss: 1.672 Test Acc: 0.827
Validation loss decreased (-0.815018 --> -0.826573).  Saving model ...
Epoch: 20 cost time: 3.43528413772583
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 3.185 Vali Acc: 0.780 Test Loss: 3.185 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.984360694885254
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.474 Vali Acc: 0.775 Test Loss: 2.474 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.203367233276367
Epoch: 22, Steps: 17 | Train Loss: 0.132 Vali Loss: 2.576 Vali Acc: 0.780 Test Loss: 2.576 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.3370590209960938
Epoch: 23, Steps: 17 | Train Loss: 0.028 Vali Loss: 4.367 Vali Acc: 0.728 Test Loss: 4.367 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.4631056785583496
Epoch: 24, Steps: 17 | Train Loss: 0.508 Vali Loss: 2.194 Vali Acc: 0.775 Test Loss: 2.194 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6231536865234375
Epoch: 25, Steps: 17 | Train Loss: 0.583 Vali Loss: 4.716 Vali Acc: 0.723 Test Loss: 4.716 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5701181888580322
Epoch: 26, Steps: 17 | Train Loss: 0.395 Vali Loss: 3.623 Vali Acc: 0.815 Test Loss: 3.623 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.057244300842285
Epoch: 27, Steps: 17 | Train Loss: 0.560 Vali Loss: 3.879 Vali Acc: 0.775 Test Loss: 3.879 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.0766634941101074
Epoch: 28, Steps: 17 | Train Loss: 0.613 Vali Loss: 8.454 Vali Acc: 0.723 Test Loss: 8.454 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.9471147060394287
Epoch: 29, Steps: 17 | Train Loss: 0.970 Vali Loss: 5.998 Vali Acc: 0.717 Test Loss: 5.998 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7131199
model size : 36.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.491759777069092
Epoch: 1, Steps: 17 | Train Loss: 1.836 Vali Loss: 1.649 Vali Acc: 0.295 Test Loss: 1.649 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 3.45068097114563
Epoch: 2, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.141 Vali Acc: 0.555 Test Loss: 1.141 Test Acc: 0.555
Validation loss decreased (-0.294781 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 3.3221216201782227
Epoch: 3, Steps: 17 | Train Loss: 0.630 Vali Loss: 1.003 Vali Acc: 0.555 Test Loss: 1.003 Test Acc: 0.555
Validation loss decreased (-0.554902 --> -0.554903).  Saving model ...
Epoch: 4 cost time: 3.0060534477233887
Epoch: 4, Steps: 17 | Train Loss: 0.411 Vali Loss: 0.852 Vali Acc: 0.717 Test Loss: 0.852 Test Acc: 0.717
Validation loss decreased (-0.554903 --> -0.716754).  Saving model ...
Epoch: 5 cost time: 2.99576473236084
Epoch: 5, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.764 Vali Acc: 0.740 Test Loss: 0.764 Test Acc: 0.740
Validation loss decreased (-0.716754 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 3.067267656326294
Epoch: 6, Steps: 17 | Train Loss: 0.411 Vali Loss: 1.802 Vali Acc: 0.699 Test Loss: 1.802 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.155026912689209
Epoch: 7, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.321 Vali Acc: 0.705 Test Loss: 1.321 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.5025277137756348
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.396 Vali Acc: 0.757 Test Loss: 1.396 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757211).  Saving model ...
Epoch: 9 cost time: 3.0259695053100586
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 1.311 Vali Acc: 0.723 Test Loss: 1.311 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.5176753997802734
Epoch: 10, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.961 Vali Acc: 0.832 Test Loss: 0.961 Test Acc: 0.832
Validation loss decreased (-0.757211 --> -0.832360).  Saving model ...
Epoch: 11 cost time: 2.859480142593384
Epoch: 11, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.350 Vali Acc: 0.798 Test Loss: 1.350 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.9824345111846924
Epoch: 12, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.206 Vali Acc: 0.757 Test Loss: 2.206 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.672835111618042
Epoch: 13, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.147 Vali Acc: 0.734 Test Loss: 2.147 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.3612284660339355
Epoch: 14, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.562 Vali Acc: 0.699 Test Loss: 2.562 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.3141186237335205
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 2.826 Vali Acc: 0.699 Test Loss: 2.826 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.117971181869507
Epoch: 16, Steps: 17 | Train Loss: 0.197 Vali Loss: 3.278 Vali Acc: 0.717 Test Loss: 3.278 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.465254783630371
Epoch: 17, Steps: 17 | Train Loss: 0.183 Vali Loss: 2.169 Vali Acc: 0.775 Test Loss: 2.169 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.4362094402313232
Epoch: 18, Steps: 17 | Train Loss: 0.324 Vali Loss: 2.405 Vali Acc: 0.763 Test Loss: 2.405 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.178983449935913
Epoch: 19, Steps: 17 | Train Loss: 0.223 Vali Loss: 2.016 Vali Acc: 0.815 Test Loss: 2.016 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.3587112426757812
Epoch: 20, Steps: 17 | Train Loss: 0.197 Vali Loss: 3.251 Vali Acc: 0.769 Test Loss: 3.251 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 7131199
model size : 36.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.313749551773071
Epoch: 1, Steps: 17 | Train Loss: 1.842 Vali Loss: 1.720 Vali Acc: 0.283 Test Loss: 1.720 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 3.067450523376465
Epoch: 2, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.116 Vali Acc: 0.491 Test Loss: 1.116 Test Acc: 0.491
Validation loss decreased (-0.283220 --> -0.491318).  Saving model ...
Epoch: 3 cost time: 2.6881415843963623
Epoch: 3, Steps: 17 | Train Loss: 0.660 Vali Loss: 1.069 Vali Acc: 0.526 Test Loss: 1.069 Test Acc: 0.526
Validation loss decreased (-0.491318 --> -0.526001).  Saving model ...
Epoch: 4 cost time: 2.606172800064087
Epoch: 4, Steps: 17 | Train Loss: 0.486 Vali Loss: 1.072 Vali Acc: 0.590 Test Loss: 1.072 Test Acc: 0.590
Validation loss decreased (-0.526001 --> -0.589585).  Saving model ...
Epoch: 5 cost time: 2.7328147888183594
Epoch: 5, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
Validation loss decreased (-0.589585 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 3.0053870677948
Epoch: 6, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.676 Vali Acc: 0.676 Test Loss: 1.676 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9785048961639404
Epoch: 7, Steps: 17 | Train Loss: 0.365 Vali Loss: 1.160 Vali Acc: 0.717 Test Loss: 1.160 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.035860776901245
Epoch: 8, Steps: 17 | Train Loss: 0.307 Vali Loss: 2.278 Vali Acc: 0.711 Test Loss: 2.278 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.119880199432373
Epoch: 9, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.011 Vali Acc: 0.786 Test Loss: 1.011 Test Acc: 0.786
Validation loss decreased (-0.774560 --> -0.786117).  Saving model ...
Epoch: 10 cost time: 3.3284711837768555
Epoch: 10, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.361 Vali Acc: 0.786 Test Loss: 1.361 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0300254821777344
Epoch: 11, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.953 Vali Acc: 0.705 Test Loss: 1.953 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0595078468322754
Epoch: 12, Steps: 17 | Train Loss: 0.367 Vali Loss: 3.021 Vali Acc: 0.769 Test Loss: 3.021 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.1760897636413574
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 2.294 Vali Acc: 0.694 Test Loss: 2.294 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.694946527481079
Epoch: 14, Steps: 17 | Train Loss: 0.279 Vali Loss: 2.187 Vali Acc: 0.705 Test Loss: 2.187 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.7147905826568604
Epoch: 15, Steps: 17 | Train Loss: 0.639 Vali Loss: 4.285 Vali Acc: 0.717 Test Loss: 4.285 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.874560832977295
Epoch: 16, Steps: 17 | Train Loss: 0.401 Vali Loss: 1.916 Vali Acc: 0.723 Test Loss: 1.916 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6446125507354736
Epoch: 17, Steps: 17 | Train Loss: 0.218 Vali Loss: 2.130 Vali Acc: 0.775 Test Loss: 2.130 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8461060523986816
Epoch: 18, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.482 Vali Acc: 0.792 Test Loss: 2.482 Test Acc: 0.792
Validation loss decreased (-0.786117 --> -0.791883).  Saving model ...
Epoch: 19 cost time: 3.3180594444274902
Epoch: 19, Steps: 17 | Train Loss: 0.343 Vali Loss: 4.676 Vali Acc: 0.728 Test Loss: 4.676 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.7078440189361572
Epoch: 20, Steps: 17 | Train Loss: 0.518 Vali Loss: 2.408 Vali Acc: 0.792 Test Loss: 2.408 Test Acc: 0.792
Validation loss decreased (-0.791883 --> -0.791883).  Saving model ...
Epoch: 21 cost time: 3.6737589836120605
Epoch: 21, Steps: 17 | Train Loss: 1.110 Vali Loss: 5.148 Vali Acc: 0.717 Test Loss: 5.148 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5120627880096436
Epoch: 22, Steps: 17 | Train Loss: 0.762 Vali Loss: 4.321 Vali Acc: 0.792 Test Loss: 4.321 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.417729139328003
Epoch: 23, Steps: 17 | Train Loss: 0.960 Vali Loss: 5.830 Vali Acc: 0.734 Test Loss: 5.830 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.2744367122650146
Epoch: 24, Steps: 17 | Train Loss: 0.549 Vali Loss: 3.299 Vali Acc: 0.775 Test Loss: 3.299 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.428501605987549
Epoch: 25, Steps: 17 | Train Loss: 0.324 Vali Loss: 5.542 Vali Acc: 0.723 Test Loss: 5.542 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.2405266761779785
Epoch: 26, Steps: 17 | Train Loss: 0.247 Vali Loss: 3.875 Vali Acc: 0.769 Test Loss: 3.875 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.087174892425537
Epoch: 27, Steps: 17 | Train Loss: 0.382 Vali Loss: 5.733 Vali Acc: 0.775 Test Loss: 5.733 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.565195083618164
Epoch: 28, Steps: 17 | Train Loss: 0.723 Vali Loss: 3.269 Vali Acc: 0.757 Test Loss: 3.269 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.411501407623291
Epoch: 29, Steps: 17 | Train Loss: 0.194 Vali Loss: 4.549 Vali Acc: 0.827 Test Loss: 4.549 Test Acc: 0.827
Validation loss decreased (-0.791883 --> -0.826544).  Saving model ...
Epoch: 30 cost time: 3.565481185913086
Epoch: 30, Steps: 17 | Train Loss: 0.473 Vali Loss: 4.727 Vali Acc: 0.809 Test Loss: 4.727 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 3.8346805572509766
Epoch: 31, Steps: 17 | Train Loss: 0.405 Vali Loss: 6.074 Vali Acc: 0.769 Test Loss: 6.074 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.4169328212738037
Epoch: 32, Steps: 17 | Train Loss: 0.305 Vali Loss: 5.324 Vali Acc: 0.769 Test Loss: 5.324 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.284433364868164
Epoch: 33, Steps: 17 | Train Loss: 0.148 Vali Loss: 4.577 Vali Acc: 0.769 Test Loss: 4.577 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.3248603343963623
Epoch: 34, Steps: 17 | Train Loss: 0.060 Vali Loss: 4.783 Vali Acc: 0.792 Test Loss: 4.783 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.4384500980377197
Epoch: 35, Steps: 17 | Train Loss: 0.052 Vali Loss: 5.300 Vali Acc: 0.780 Test Loss: 5.300 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.4443390369415283
Epoch: 36, Steps: 17 | Train Loss: 0.374 Vali Loss: 5.189 Vali Acc: 0.786 Test Loss: 5.189 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.5808327198028564
Epoch: 37, Steps: 17 | Train Loss: 0.348 Vali Loss: 12.106 Vali Acc: 0.595 Test Loss: 12.106 Test Acc: 0.595
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.745283603668213
Epoch: 38, Steps: 17 | Train Loss: 1.605 Vali Loss: 5.971 Vali Acc: 0.734 Test Loss: 5.971 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 3.510361909866333
Epoch: 39, Steps: 17 | Train Loss: 0.652 Vali Loss: 11.258 Vali Acc: 0.728 Test Loss: 11.258 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 7131199
model size : 36.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.517151355743408
Epoch: 1, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.178 Vali Acc: 0.480 Test Loss: 1.178 Test Acc: 0.480
Validation loss decreased (inf --> -0.479757).  Saving model ...
Epoch: 2 cost time: 4.009487867355347
Epoch: 2, Steps: 17 | Train Loss: 1.045 Vali Loss: 0.906 Vali Acc: 0.642 Test Loss: 0.906 Test Acc: 0.642
Validation loss decreased (-0.479757 --> -0.641609).  Saving model ...
Epoch: 3 cost time: 3.930053472518921
Epoch: 3, Steps: 17 | Train Loss: 0.495 Vali Loss: 1.084 Vali Acc: 0.595 Test Loss: 1.084 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.8753905296325684
Epoch: 4, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.858 Vali Acc: 0.688 Test Loss: 0.858 Test Acc: 0.688
Validation loss decreased (-0.641609 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 3.625149965286255
Epoch: 5, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.766 Vali Acc: 0.757 Test Loss: 0.766 Test Acc: 0.757
Validation loss decreased (-0.687853 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 4.099139451980591
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.956 Vali Acc: 0.786 Test Loss: 0.956 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786118).  Saving model ...
Epoch: 7 cost time: 3.7434771060943604
Epoch: 7, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.072 Vali Acc: 0.746 Test Loss: 1.072 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 4.397874593734741
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.207 Vali Acc: 0.682 Test Loss: 1.207 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.201580286026001
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.510 Vali Acc: 0.723 Test Loss: 1.510 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.330138206481934
Epoch: 10, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.062 Vali Acc: 0.780 Test Loss: 1.062 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.510239362716675
Epoch: 11, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.244 Vali Acc: 0.792 Test Loss: 1.244 Test Acc: 0.792
Validation loss decreased (-0.786118 --> -0.791895).  Saving model ...
Epoch: 12 cost time: 4.327183961868286
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.836 Vali Acc: 0.873 Test Loss: 0.836 Test Acc: 0.873
Validation loss decreased (-0.791895 --> -0.872824).  Saving model ...
Epoch: 13 cost time: 4.149435758590698
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.458 Vali Acc: 0.815 Test Loss: 1.458 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.808765411376953
Epoch: 14, Steps: 17 | Train Loss: 0.127 Vali Loss: 2.447 Vali Acc: 0.734 Test Loss: 2.447 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 4.050970077514648
Epoch: 15, Steps: 17 | Train Loss: 0.229 Vali Loss: 2.266 Vali Acc: 0.775 Test Loss: 2.266 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.890137195587158
Epoch: 16, Steps: 17 | Train Loss: 0.403 Vali Loss: 1.908 Vali Acc: 0.757 Test Loss: 1.908 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 4.138850927352905
Epoch: 17, Steps: 17 | Train Loss: 0.242 Vali Loss: 3.747 Vali Acc: 0.694 Test Loss: 3.747 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.88689923286438
Epoch: 18, Steps: 17 | Train Loss: 0.511 Vali Loss: 1.680 Vali Acc: 0.850 Test Loss: 1.680 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.8128108978271484
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 3.646 Vali Acc: 0.786 Test Loss: 3.646 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.46919846534729
Epoch: 20, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.899 Vali Acc: 0.815 Test Loss: 1.899 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.5081465244293213
Epoch: 21, Steps: 17 | Train Loss: 0.383 Vali Loss: 2.680 Vali Acc: 0.803 Test Loss: 2.680 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 4.361283779144287
Epoch: 22, Steps: 17 | Train Loss: 0.277 Vali Loss: 3.254 Vali Acc: 0.734 Test Loss: 3.254 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 6082623
model size : 32.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.74317741394043
Epoch: 1, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.205 Vali Acc: 0.486 Test Loss: 1.205 Test Acc: 0.486
Validation loss decreased (inf --> -0.485537).  Saving model ...
Epoch: 2 cost time: 3.686285972595215
Epoch: 2, Steps: 17 | Train Loss: 1.063 Vali Loss: 0.887 Vali Acc: 0.613 Test Loss: 0.887 Test Acc: 0.613
Validation loss decreased (-0.485537 --> -0.612708).  Saving model ...
Epoch: 3 cost time: 3.676952838897705
Epoch: 3, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.938 Vali Acc: 0.694 Test Loss: 0.938 Test Acc: 0.694
Validation loss decreased (-0.612708 --> -0.693632).  Saving model ...
Epoch: 4 cost time: 3.36904239654541
Epoch: 4, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.830 Vali Acc: 0.717 Test Loss: 0.830 Test Acc: 0.717
Validation loss decreased (-0.693632 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 3.3676810264587402
Epoch: 5, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.587 Vali Acc: 0.809 Test Loss: 0.587 Test Acc: 0.809
Validation loss decreased (-0.716755 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 4.017874717712402
Epoch: 6, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.62284779548645
Epoch: 7, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.095 Vali Acc: 0.734 Test Loss: 1.095 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.7534821033477783
Epoch: 8, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.441 Vali Acc: 0.630 Test Loss: 1.441 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.209240674972534
Epoch: 9, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.889 Vali Acc: 0.763 Test Loss: 0.889 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.490725517272949
Epoch: 10, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.212 Vali Acc: 0.786 Test Loss: 1.212 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8406412601470947
Epoch: 11, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.207 Vali Acc: 0.775 Test Loss: 1.207 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.8431057929992676
Epoch: 12, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.316 Vali Acc: 0.746 Test Loss: 2.316 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.648620128631592
Epoch: 13, Steps: 17 | Train Loss: 0.360 Vali Loss: 2.086 Vali Acc: 0.676 Test Loss: 2.086 Test Acc: 0.676
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.77477765083313
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.160 Vali Acc: 0.809 Test Loss: 2.160 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.694410800933838
Epoch: 15, Steps: 17 | Train Loss: 0.153 Vali Loss: 2.479 Vali Acc: 0.809 Test Loss: 2.479 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 6082623
model size : 32.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.9954588413238525
Epoch: 1, Steps: 17 | Train Loss: 1.783 Vali Loss: 1.208 Vali Acc: 0.434 Test Loss: 1.208 Test Acc: 0.434
Validation loss decreased (inf --> -0.433514).  Saving model ...
Epoch: 2 cost time: 3.612015724182129
Epoch: 2, Steps: 17 | Train Loss: 1.103 Vali Loss: 0.905 Vali Acc: 0.590 Test Loss: 0.905 Test Acc: 0.590
Validation loss decreased (-0.433514 --> -0.589586).  Saving model ...
Epoch: 3 cost time: 3.5383474826812744
Epoch: 3, Steps: 17 | Train Loss: 0.551 Vali Loss: 1.132 Vali Acc: 0.653 Test Loss: 1.132 Test Acc: 0.653
Validation loss decreased (-0.589586 --> -0.653168).  Saving model ...
Epoch: 4 cost time: 3.0278267860412598
Epoch: 4, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.846 Vali Acc: 0.717 Test Loss: 0.846 Test Acc: 0.717
Validation loss decreased (-0.653168 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 3.229456663131714
Epoch: 5, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.843 Vali Acc: 0.763 Test Loss: 0.843 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.762997).  Saving model ...
Epoch: 6 cost time: 3.624321222305298
Epoch: 6, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.945 Vali Acc: 0.769 Test Loss: 0.945 Test Acc: 0.769
Validation loss decreased (-0.762997 --> -0.768777).  Saving model ...
Epoch: 7 cost time: 4.180124998092651
Epoch: 7, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.938 Vali Acc: 0.734 Test Loss: 0.938 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.8880980014801025
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.568 Vali Acc: 0.699 Test Loss: 1.568 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 4.083778619766235
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 2.053 Vali Acc: 0.688 Test Loss: 2.053 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 4.291220426559448
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.896 Vali Acc: 0.659 Test Loss: 1.896 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 4.162944793701172
Epoch: 11, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.018 Vali Acc: 0.780 Test Loss: 1.018 Test Acc: 0.780
Validation loss decreased (-0.768777 --> -0.780337).  Saving model ...
Epoch: 12 cost time: 3.946223497390747
Epoch: 12, Steps: 17 | Train Loss: 0.126 Vali Loss: 1.238 Vali Acc: 0.821 Test Loss: 1.238 Test Acc: 0.821
Validation loss decreased (-0.780337 --> -0.820797).  Saving model ...
Epoch: 13 cost time: 3.816295623779297
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.957 Vali Acc: 0.769 Test Loss: 1.957 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 4.149137735366821
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.264 Vali Acc: 0.751 Test Loss: 2.264 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.9590132236480713
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 3.188 Vali Acc: 0.578 Test Loss: 3.188 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.7432215213775635
Epoch: 16, Steps: 17 | Train Loss: 0.658 Vali Loss: 2.999 Vali Acc: 0.711 Test Loss: 2.999 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.6525402069091797
Epoch: 17, Steps: 17 | Train Loss: 0.290 Vali Loss: 2.273 Vali Acc: 0.786 Test Loss: 2.273 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.655172109603882
Epoch: 18, Steps: 17 | Train Loss: 0.169 Vali Loss: 4.186 Vali Acc: 0.763 Test Loss: 4.186 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 4.057638645172119
Epoch: 19, Steps: 17 | Train Loss: 0.227 Vali Loss: 3.009 Vali Acc: 0.786 Test Loss: 3.009 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 4.16431188583374
Epoch: 20, Steps: 17 | Train Loss: 0.191 Vali Loss: 3.436 Vali Acc: 0.763 Test Loss: 3.436 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.9379849433898926
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.524 Vali Acc: 0.827 Test Loss: 2.524 Test Acc: 0.827
Validation loss decreased (-0.820797 --> -0.826564).  Saving model ...
Epoch: 22 cost time: 3.939552068710327
Epoch: 22, Steps: 17 | Train Loss: 0.246 Vali Loss: 3.869 Vali Acc: 0.757 Test Loss: 3.869 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 4.049238681793213
Epoch: 23, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.617 Vali Acc: 0.838 Test Loss: 2.617 Test Acc: 0.838
Validation loss decreased (-0.826564 --> -0.838124).  Saving model ...
Epoch: 24 cost time: 3.4986233711242676
Epoch: 24, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.079 Vali Acc: 0.809 Test Loss: 2.079 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 3.6922354698181152
Epoch: 25, Steps: 17 | Train Loss: 0.081 Vali Loss: 4.368 Vali Acc: 0.821 Test Loss: 4.368 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 3.9382412433624268
Epoch: 26, Steps: 17 | Train Loss: 0.231 Vali Loss: 3.453 Vali Acc: 0.786 Test Loss: 3.453 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 3.978710889816284
Epoch: 27, Steps: 17 | Train Loss: 0.208 Vali Loss: 5.469 Vali Acc: 0.769 Test Loss: 5.469 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 3.9185845851898193
Epoch: 28, Steps: 17 | Train Loss: 0.705 Vali Loss: 4.707 Vali Acc: 0.728 Test Loss: 4.707 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 4.411923408508301
Epoch: 29, Steps: 17 | Train Loss: 0.721 Vali Loss: 10.810 Vali Acc: 0.566 Test Loss: 10.810 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 4.210419178009033
Epoch: 30, Steps: 17 | Train Loss: 0.982 Vali Loss: 5.891 Vali Acc: 0.792 Test Loss: 5.891 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 4.243008613586426
Epoch: 31, Steps: 17 | Train Loss: 0.128 Vali Loss: 6.735 Vali Acc: 0.740 Test Loss: 6.735 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 3.9819393157958984
Epoch: 32, Steps: 17 | Train Loss: 0.499 Vali Loss: 3.707 Vali Acc: 0.832 Test Loss: 3.707 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 3.675107479095459
Epoch: 33, Steps: 17 | Train Loss: 1.759 Vali Loss: 4.898 Vali Acc: 0.798 Test Loss: 4.898 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 6082623
model size : 32.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.449275732040405
Epoch: 1, Steps: 17 | Train Loss: 1.801 Vali Loss: 1.257 Vali Acc: 0.405 Test Loss: 1.257 Test Acc: 0.405
Validation loss decreased (inf --> -0.404612).  Saving model ...
Epoch: 2 cost time: 3.1954033374786377
Epoch: 2, Steps: 17 | Train Loss: 1.171 Vali Loss: 0.950 Vali Acc: 0.561 Test Loss: 0.950 Test Acc: 0.561
Validation loss decreased (-0.404612 --> -0.560684).  Saving model ...
Epoch: 3 cost time: 3.329900026321411
Epoch: 3, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.983 Vali Acc: 0.636 Test Loss: 0.983 Test Acc: 0.636
Validation loss decreased (-0.560684 --> -0.635828).  Saving model ...
Epoch: 4 cost time: 3.290687084197998
Epoch: 4, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.701 Vali Acc: 0.757 Test Loss: 0.701 Test Acc: 0.757
Validation loss decreased (-0.635828 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 3.358550548553467
Epoch: 5, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.781 Vali Acc: 0.694 Test Loss: 0.781 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.4405789375305176
Epoch: 6, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.854 Vali Acc: 0.740 Test Loss: 0.854 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.4607226848602295
Epoch: 7, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.953 Vali Acc: 0.780 Test Loss: 0.953 Test Acc: 0.780
Validation loss decreased (-0.757218 --> -0.780337).  Saving model ...
Epoch: 8 cost time: 3.6198270320892334
Epoch: 8, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.872 Vali Acc: 0.821 Test Loss: 0.872 Test Acc: 0.821
Validation loss decreased (-0.780337 --> -0.820801).  Saving model ...
Epoch: 9 cost time: 3.034867286682129
Epoch: 9, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.389 Vali Acc: 0.751 Test Loss: 1.389 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9096322059631348
Epoch: 10, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.008 Vali Acc: 0.809 Test Loss: 1.008 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3269128799438477
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.378 Vali Acc: 0.775 Test Loss: 1.378 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.341750144958496
Epoch: 12, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.994 Vali Acc: 0.647 Test Loss: 1.994 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.5202507972717285
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.503 Vali Acc: 0.821 Test Loss: 1.503 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.0790176391601562
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.299 Vali Acc: 0.757 Test Loss: 1.299 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.405641794204712
Epoch: 15, Steps: 17 | Train Loss: 0.268 Vali Loss: 1.699 Vali Acc: 0.775 Test Loss: 1.699 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.732187509536743
Epoch: 16, Steps: 17 | Train Loss: 0.400 Vali Loss: 2.428 Vali Acc: 0.723 Test Loss: 2.428 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.6958224773406982
Epoch: 17, Steps: 17 | Train Loss: 0.405 Vali Loss: 3.466 Vali Acc: 0.694 Test Loss: 3.466 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.4730312824249268
Epoch: 18, Steps: 17 | Train Loss: 0.341 Vali Loss: 2.981 Vali Acc: 0.688 Test Loss: 2.981 Test Acc: 0.688
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 6082623
model size : 32.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.472289800643921
Epoch: 1, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.192 Vali Acc: 0.480 Test Loss: 1.192 Test Acc: 0.480
Validation loss decreased (inf --> -0.479757).  Saving model ...
Epoch: 2 cost time: 3.485940933227539
Epoch: 2, Steps: 17 | Train Loss: 0.990 Vali Loss: 1.293 Vali Acc: 0.514 Test Loss: 1.293 Test Acc: 0.514
Validation loss decreased (-0.479757 --> -0.514438).  Saving model ...
Epoch: 3 cost time: 3.7005972862243652
Epoch: 3, Steps: 17 | Train Loss: 0.642 Vali Loss: 0.901 Vali Acc: 0.682 Test Loss: 0.901 Test Acc: 0.682
Validation loss decreased (-0.514438 --> -0.682072).  Saving model ...
Epoch: 4 cost time: 3.6680829524993896
Epoch: 4, Steps: 17 | Train Loss: 0.424 Vali Loss: 1.355 Vali Acc: 0.630 Test Loss: 1.355 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.783625841140747
Epoch: 5, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.623 Vali Acc: 0.798 Test Loss: 0.623 Test Acc: 0.798
Validation loss decreased (-0.682072 --> -0.797682).  Saving model ...
Epoch: 6 cost time: 3.8969411849975586
Epoch: 6, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.837 Vali Acc: 0.757 Test Loss: 0.837 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 4.254607677459717
Epoch: 7, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.150 Vali Acc: 0.694 Test Loss: 1.150 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 4.588210105895996
Epoch: 8, Steps: 17 | Train Loss: 0.265 Vali Loss: 1.132 Vali Acc: 0.711 Test Loss: 1.132 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 4.01914119720459
Epoch: 9, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.496 Vali Acc: 0.711 Test Loss: 1.496 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.308215379714966
Epoch: 10, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.279 Vali Acc: 0.763 Test Loss: 1.279 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 4.038534879684448
Epoch: 11, Steps: 17 | Train Loss: 0.182 Vali Loss: 1.013 Vali Acc: 0.798 Test Loss: 1.013 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 4.489026308059692
Epoch: 12, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.054 Vali Acc: 0.740 Test Loss: 2.054 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 4.054995775222778
Epoch: 13, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.568 Vali Acc: 0.803 Test Loss: 1.568 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803453).  Saving model ...
Epoch: 14 cost time: 3.600480556488037
Epoch: 14, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.514 Vali Acc: 0.786 Test Loss: 1.514 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.7256438732147217
Epoch: 15, Steps: 17 | Train Loss: 0.116 Vali Loss: 2.777 Vali Acc: 0.746 Test Loss: 2.777 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 4.084151029586792
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.458 Vali Acc: 0.803 Test Loss: 1.458 Test Acc: 0.803
Validation loss decreased (-0.803453 --> -0.803454).  Saving model ...
Epoch: 17 cost time: 4.131855010986328
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.171 Vali Acc: 0.809 Test Loss: 1.171 Test Acc: 0.809
Validation loss decreased (-0.803454 --> -0.809237).  Saving model ...
Epoch: 18 cost time: 4.240736484527588
Epoch: 18, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.350 Vali Acc: 0.786 Test Loss: 1.350 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 4.636850357055664
Epoch: 19, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.282 Vali Acc: 0.838 Test Loss: 1.282 Test Acc: 0.838
Validation loss decreased (-0.809237 --> -0.838137).  Saving model ...
Epoch: 20 cost time: 4.543863773345947
Epoch: 20, Steps: 17 | Train Loss: 0.166 Vali Loss: 2.421 Vali Acc: 0.798 Test Loss: 2.421 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 4.221631288528442
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.165 Vali Acc: 0.751 Test Loss: 2.165 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.7116053104400635
Epoch: 22, Steps: 17 | Train Loss: 0.560 Vali Loss: 2.557 Vali Acc: 0.734 Test Loss: 2.557 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.554317951202393
Epoch: 23, Steps: 17 | Train Loss: 0.258 Vali Loss: 6.259 Vali Acc: 0.549 Test Loss: 6.259 Test Acc: 0.549
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.303251266479492
Epoch: 24, Steps: 17 | Train Loss: 0.316 Vali Loss: 2.320 Vali Acc: 0.827 Test Loss: 2.320 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.957303524017334
Epoch: 25, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.917 Vali Acc: 0.798 Test Loss: 1.917 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.768717050552368
Epoch: 26, Steps: 17 | Train Loss: 0.142 Vali Loss: 10.400 Vali Acc: 0.555 Test Loss: 10.400 Test Acc: 0.555
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 4.094449043273926
Epoch: 27, Steps: 17 | Train Loss: 0.874 Vali Loss: 2.737 Vali Acc: 0.798 Test Loss: 2.737 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 4.233220338821411
Epoch: 28, Steps: 17 | Train Loss: 0.172 Vali Loss: 5.774 Vali Acc: 0.740 Test Loss: 5.774 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 4.220521926879883
Epoch: 29, Steps: 17 | Train Loss: 0.317 Vali Loss: 4.987 Vali Acc: 0.751 Test Loss: 4.987 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 5558335
model size : 30.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.512557506561279
Epoch: 1, Steps: 17 | Train Loss: 1.655 Vali Loss: 1.209 Vali Acc: 0.503 Test Loss: 1.209 Test Acc: 0.503
Validation loss decreased (inf --> -0.502878).  Saving model ...
Epoch: 2 cost time: 3.9567437171936035
Epoch: 2, Steps: 17 | Train Loss: 1.021 Vali Loss: 1.365 Vali Acc: 0.468 Test Loss: 1.365 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.9639439582824707
Epoch: 3, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.906 Vali Acc: 0.676 Test Loss: 0.906 Test Acc: 0.676
Validation loss decreased (-0.502878 --> -0.676292).  Saving model ...
Epoch: 4 cost time: 3.7384376525878906
Epoch: 4, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.307 Vali Acc: 0.665 Test Loss: 1.307 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.8233182430267334
Epoch: 5, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.747 Vali Acc: 0.798 Test Loss: 0.747 Test Acc: 0.798
Validation loss decreased (-0.676292 --> -0.797680).  Saving model ...
Epoch: 6 cost time: 3.8905322551727295
Epoch: 6, Steps: 17 | Train Loss: 0.184 Vali Loss: 1.363 Vali Acc: 0.728 Test Loss: 1.363 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.572854995727539
Epoch: 7, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.821 Vali Acc: 0.769 Test Loss: 0.821 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.8044028282165527
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.523 Vali Acc: 0.717 Test Loss: 1.523 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.7743678092956543
Epoch: 9, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.139 Vali Acc: 0.798 Test Loss: 1.139 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 4.017616271972656
Epoch: 10, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.615 Vali Acc: 0.775 Test Loss: 1.615 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.8489129543304443
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.286 Vali Acc: 0.705 Test Loss: 1.286 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.879732847213745
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.818 Vali Acc: 0.751 Test Loss: 1.818 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5210697650909424
Epoch: 13, Steps: 17 | Train Loss: 0.304 Vali Loss: 2.033 Vali Acc: 0.711 Test Loss: 2.033 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 4.29738450050354
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 2.307 Vali Acc: 0.717 Test Loss: 2.307 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 4.180352449417114
Epoch: 15, Steps: 17 | Train Loss: 0.262 Vali Loss: 2.349 Vali Acc: 0.809 Test Loss: 2.349 Test Acc: 0.809
Validation loss decreased (-0.797680 --> -0.809225).  Saving model ...
Epoch: 16 cost time: 3.575949192047119
Epoch: 16, Steps: 17 | Train Loss: 0.369 Vali Loss: 2.375 Vali Acc: 0.746 Test Loss: 2.375 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.4550046920776367
Epoch: 17, Steps: 17 | Train Loss: 0.235 Vali Loss: 2.369 Vali Acc: 0.763 Test Loss: 2.369 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 4.341468811035156
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 3.377 Vali Acc: 0.734 Test Loss: 3.377 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 4.167731285095215
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 2.394 Vali Acc: 0.803 Test Loss: 2.394 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 4.2372448444366455
Epoch: 20, Steps: 17 | Train Loss: 0.106 Vali Loss: 2.776 Vali Acc: 0.809 Test Loss: 2.776 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 4.232271671295166
Epoch: 21, Steps: 17 | Train Loss: 0.264 Vali Loss: 2.044 Vali Acc: 0.832 Test Loss: 2.044 Test Acc: 0.832
Validation loss decreased (-0.809225 --> -0.832349).  Saving model ...
Epoch: 22 cost time: 3.0764217376708984
Epoch: 22, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.493 Vali Acc: 0.792 Test Loss: 2.493 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.9211626052856445
Epoch: 23, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.488 Vali Acc: 0.821 Test Loss: 2.488 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 4.306395530700684
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.283 Vali Acc: 0.815 Test Loss: 2.283 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 4.033608675003052
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 5.239 Vali Acc: 0.746 Test Loss: 5.239 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 4.137237310409546
Epoch: 26, Steps: 17 | Train Loss: 0.049 Vali Loss: 3.704 Vali Acc: 0.763 Test Loss: 3.704 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 3.781355381011963
Epoch: 27, Steps: 17 | Train Loss: 0.272 Vali Loss: 3.696 Vali Acc: 0.763 Test Loss: 3.696 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.7437872886657715
Epoch: 28, Steps: 17 | Train Loss: 0.123 Vali Loss: 4.049 Vali Acc: 0.786 Test Loss: 4.049 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.5888922214508057
Epoch: 29, Steps: 17 | Train Loss: 0.597 Vali Loss: 2.984 Vali Acc: 0.740 Test Loss: 2.984 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.7308459281921387
Epoch: 30, Steps: 17 | Train Loss: 0.788 Vali Loss: 4.770 Vali Acc: 0.763 Test Loss: 4.770 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.766759157180786
Epoch: 31, Steps: 17 | Train Loss: 1.691 Vali Loss: 6.099 Vali Acc: 0.746 Test Loss: 6.099 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 5558335
model size : 30.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.762967824935913
Epoch: 1, Steps: 17 | Train Loss: 1.660 Vali Loss: 1.232 Vali Acc: 0.474 Test Loss: 1.232 Test Acc: 0.474
Validation loss decreased (inf --> -0.473976).  Saving model ...
Epoch: 2 cost time: 3.6341702938079834
Epoch: 2, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.543 Vali Acc: 0.468 Test Loss: 1.543 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.635481357574463
Epoch: 3, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.871 Vali Acc: 0.688 Test Loss: 0.871 Test Acc: 0.688
Validation loss decreased (-0.473976 --> -0.687853).  Saving model ...
Epoch: 4 cost time: 3.7574713230133057
Epoch: 4, Steps: 17 | Train Loss: 0.352 Vali Loss: 1.065 Vali Acc: 0.624 Test Loss: 1.065 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.64973783493042
Epoch: 5, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.662 Vali Acc: 0.809 Test Loss: 0.662 Test Acc: 0.809
Validation loss decreased (-0.687853 --> -0.809242).  Saving model ...
Epoch: 6 cost time: 3.4924540519714355
Epoch: 6, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.039 Vali Acc: 0.734 Test Loss: 1.039 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3815150260925293
Epoch: 7, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.745 Vali Acc: 0.711 Test Loss: 1.745 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.3142879009246826
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.709 Vali Acc: 0.844 Test Loss: 0.709 Test Acc: 0.844
Validation loss decreased (-0.809242 --> -0.843924).  Saving model ...
Epoch: 9 cost time: 3.717888593673706
Epoch: 9, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.221 Vali Acc: 0.746 Test Loss: 1.221 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3723645210266113
Epoch: 10, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.175 Vali Acc: 0.775 Test Loss: 1.175 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.1152663230895996
Epoch: 11, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.441 Vali Acc: 0.723 Test Loss: 2.441 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.8087873458862305
Epoch: 12, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.253 Vali Acc: 0.786 Test Loss: 1.253 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.752095937728882
Epoch: 13, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.540 Vali Acc: 0.809 Test Loss: 1.540 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.425028085708618
Epoch: 14, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.562 Vali Acc: 0.803 Test Loss: 1.562 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.578307867050171
Epoch: 15, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.503 Vali Acc: 0.780 Test Loss: 1.503 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.6377925872802734
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.389 Vali Acc: 0.821 Test Loss: 1.389 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3310799598693848
Epoch: 17, Steps: 17 | Train Loss: 0.059 Vali Loss: 2.439 Vali Acc: 0.751 Test Loss: 2.439 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.642763376235962
Epoch: 18, Steps: 17 | Train Loss: 0.161 Vali Loss: 5.997 Vali Acc: 0.671 Test Loss: 5.997 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 5558335
model size : 30.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.332503080368042
Epoch: 1, Steps: 17 | Train Loss: 1.691 Vali Loss: 1.278 Vali Acc: 0.457 Test Loss: 1.278 Test Acc: 0.457
Validation loss decreased (inf --> -0.456635).  Saving model ...
Epoch: 2 cost time: 3.683149576187134
Epoch: 2, Steps: 17 | Train Loss: 1.142 Vali Loss: 1.440 Vali Acc: 0.457 Test Loss: 1.440 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 3.8220467567443848
Epoch: 3, Steps: 17 | Train Loss: 0.910 Vali Loss: 1.005 Vali Acc: 0.699 Test Loss: 1.005 Test Acc: 0.699
Validation loss decreased (-0.456635 --> -0.699412).  Saving model ...
Epoch: 4 cost time: 3.688255548477173
Epoch: 4, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.894 Vali Acc: 0.624 Test Loss: 0.894 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.542344570159912
Epoch: 5, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.785 Vali Acc: 0.780 Test Loss: 0.785 Test Acc: 0.780
Validation loss decreased (-0.699412 --> -0.780339).  Saving model ...
Epoch: 6 cost time: 3.3830337524414062
Epoch: 6, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.363 Vali Acc: 0.665 Test Loss: 1.363 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.144244909286499
Epoch: 7, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.951 Vali Acc: 0.763 Test Loss: 0.951 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2980408668518066
Epoch: 8, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.396 Vali Acc: 0.763 Test Loss: 1.396 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 3.4472508430480957
Epoch: 9, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.688 Vali Acc: 0.723 Test Loss: 1.688 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.6742498874664307
Epoch: 10, Steps: 17 | Train Loss: 0.470 Vali Loss: 1.141 Vali Acc: 0.763 Test Loss: 1.141 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.807725191116333
Epoch: 11, Steps: 17 | Train Loss: 0.518 Vali Loss: 1.728 Vali Acc: 0.746 Test Loss: 1.728 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.687678813934326
Epoch: 12, Steps: 17 | Train Loss: 0.369 Vali Loss: 1.654 Vali Acc: 0.775 Test Loss: 1.654 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.5791311264038086
Epoch: 13, Steps: 17 | Train Loss: 0.273 Vali Loss: 1.768 Vali Acc: 0.751 Test Loss: 1.768 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.713578701019287
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.231 Vali Acc: 0.809 Test Loss: 1.231 Test Acc: 0.809
Validation loss decreased (-0.780339 --> -0.809236).  Saving model ...
Epoch: 15 cost time: 3.6655900478363037
Epoch: 15, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.246 Vali Acc: 0.757 Test Loss: 2.246 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.4725425243377686
Epoch: 16, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.714 Vali Acc: 0.798 Test Loss: 1.714 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.536564588546753
Epoch: 17, Steps: 17 | Train Loss: 0.188 Vali Loss: 2.488 Vali Acc: 0.780 Test Loss: 2.488 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.78884220123291
Epoch: 18, Steps: 17 | Train Loss: 0.295 Vali Loss: 2.455 Vali Acc: 0.809 Test Loss: 2.455 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.420092821121216
Epoch: 19, Steps: 17 | Train Loss: 0.455 Vali Loss: 2.912 Vali Acc: 0.659 Test Loss: 2.912 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.1785120964050293
Epoch: 20, Steps: 17 | Train Loss: 0.422 Vali Loss: 6.299 Vali Acc: 0.676 Test Loss: 6.299 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 3.45401668548584
Epoch: 21, Steps: 17 | Train Loss: 0.384 Vali Loss: 3.269 Vali Acc: 0.769 Test Loss: 3.269 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 4.015098571777344
Epoch: 22, Steps: 17 | Train Loss: 0.112 Vali Loss: 5.718 Vali Acc: 0.607 Test Loss: 5.718 Test Acc: 0.607
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 3.635396957397461
Epoch: 23, Steps: 17 | Train Loss: 0.327 Vali Loss: 4.261 Vali Acc: 0.734 Test Loss: 4.261 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 3.8862555027008057
Epoch: 24, Steps: 17 | Train Loss: 0.481 Vali Loss: 5.350 Vali Acc: 0.705 Test Loss: 5.350 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 5558335
model size : 30.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.099912643432617
Epoch: 1, Steps: 17 | Train Loss: 1.714 Vali Loss: 1.292 Vali Acc: 0.370 Test Loss: 1.292 Test Acc: 0.370
Validation loss decreased (inf --> -0.369929).  Saving model ...
Epoch: 2 cost time: 3.63555908203125
Epoch: 2, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.953 Vali Acc: 0.717 Test Loss: 0.953 Test Acc: 0.717
Validation loss decreased (-0.369929 --> -0.716753).  Saving model ...
Epoch: 3 cost time: 3.7025146484375
Epoch: 3, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.718 Vali Acc: 0.659 Test Loss: 0.718 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.6113476753234863
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 1.452 Vali Acc: 0.665 Test Loss: 1.452 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.6488242149353027
Epoch: 5, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.897 Vali Acc: 0.734 Test Loss: 0.897 Test Acc: 0.734
Validation loss decreased (-0.716753 --> -0.734095).  Saving model ...
Epoch: 6 cost time: 3.6206297874450684
Epoch: 6, Steps: 17 | Train Loss: 0.229 Vali Loss: 1.497 Vali Acc: 0.694 Test Loss: 1.497 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.838920831680298
Epoch: 7, Steps: 17 | Train Loss: 0.465 Vali Loss: 1.127 Vali Acc: 0.734 Test Loss: 1.127 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.9679672718048096
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.018 Vali Acc: 0.792 Test Loss: 1.018 Test Acc: 0.792
Validation loss decreased (-0.734095 --> -0.791897).  Saving model ...
Epoch: 9 cost time: 3.389613151550293
Epoch: 9, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.036 Vali Acc: 0.740 Test Loss: 1.036 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 4.151126146316528
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.994 Vali Acc: 0.809 Test Loss: 0.994 Test Acc: 0.809
Validation loss decreased (-0.791897 --> -0.809239).  Saving model ...
Epoch: 11 cost time: 3.819190263748169
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.135 Vali Acc: 0.728 Test Loss: 2.135 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4539942741394043
Epoch: 12, Steps: 17 | Train Loss: 0.173 Vali Loss: 1.561 Vali Acc: 0.757 Test Loss: 1.561 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.4852006435394287
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 2.256 Vali Acc: 0.746 Test Loss: 2.256 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.812039613723755
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.546 Vali Acc: 0.821 Test Loss: 1.546 Test Acc: 0.821
Validation loss decreased (-0.809239 --> -0.820794).  Saving model ...
Epoch: 15 cost time: 3.3181471824645996
Epoch: 15, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.439 Vali Acc: 0.798 Test Loss: 1.439 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.7206146717071533
Epoch: 16, Steps: 17 | Train Loss: 0.363 Vali Loss: 2.232 Vali Acc: 0.798 Test Loss: 2.232 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.6487960815429688
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 2.443 Vali Acc: 0.775 Test Loss: 2.443 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 4.345154523849487
Epoch: 18, Steps: 17 | Train Loss: 0.245 Vali Loss: 2.156 Vali Acc: 0.775 Test Loss: 2.156 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 3.693932294845581
Epoch: 19, Steps: 17 | Train Loss: 0.175 Vali Loss: 3.936 Vali Acc: 0.671 Test Loss: 3.936 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 3.9550774097442627
Epoch: 20, Steps: 17 | Train Loss: 0.467 Vali Loss: 1.160 Vali Acc: 0.867 Test Loss: 1.160 Test Acc: 0.867
Validation loss decreased (-0.820794 --> -0.867040).  Saving model ...
Epoch: 21 cost time: 3.88873553276062
Epoch: 21, Steps: 17 | Train Loss: 0.231 Vali Loss: 5.046 Vali Acc: 0.717 Test Loss: 5.046 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.470076084136963
Epoch: 22, Steps: 17 | Train Loss: 0.258 Vali Loss: 2.522 Vali Acc: 0.815 Test Loss: 2.522 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 3.3211100101470947
Epoch: 23, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.331 Vali Acc: 0.792 Test Loss: 3.331 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.4813785552978516
Epoch: 24, Steps: 17 | Train Loss: 0.090 Vali Loss: 3.897 Vali Acc: 0.792 Test Loss: 3.897 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.285966157913208
Epoch: 25, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.143 Vali Acc: 0.821 Test Loss: 2.143 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.5292410850524902
Epoch: 26, Steps: 17 | Train Loss: 0.113 Vali Loss: 3.594 Vali Acc: 0.786 Test Loss: 3.594 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 3.8542635440826416
Epoch: 27, Steps: 17 | Train Loss: 0.348 Vali Loss: 3.639 Vali Acc: 0.809 Test Loss: 3.639 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.5301263332366943
Epoch: 28, Steps: 17 | Train Loss: 0.234 Vali Loss: 2.269 Vali Acc: 0.803 Test Loss: 2.269 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 3.3208343982696533
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 3.881 Vali Acc: 0.827 Test Loss: 3.881 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.7830817699432373
Epoch: 30, Steps: 17 | Train Loss: 0.125 Vali Loss: 4.591 Vali Acc: 0.740 Test Loss: 4.591 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 5296191
model size : 29.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.908653497695923
Epoch: 1, Steps: 17 | Train Loss: 1.720 Vali Loss: 1.265 Vali Acc: 0.387 Test Loss: 1.265 Test Acc: 0.387
Validation loss decreased (inf --> -0.387271).  Saving model ...
Epoch: 2 cost time: 3.5594098567962646
Epoch: 2, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.978 Vali Acc: 0.705 Test Loss: 0.978 Test Acc: 0.705
Validation loss decreased (-0.387271 --> -0.705193).  Saving model ...
Epoch: 3 cost time: 3.165283679962158
Epoch: 3, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.707 Vali Acc: 0.676 Test Loss: 0.707 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.5086634159088135
Epoch: 4, Steps: 17 | Train Loss: 0.387 Vali Loss: 1.453 Vali Acc: 0.688 Test Loss: 1.453 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.096238374710083
Epoch: 5, Steps: 17 | Train Loss: 0.498 Vali Loss: 1.015 Vali Acc: 0.723 Test Loss: 1.015 Test Acc: 0.723
Validation loss decreased (-0.705193 --> -0.722533).  Saving model ...
Epoch: 6 cost time: 3.489198684692383
Epoch: 6, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.765 Vali Acc: 0.803 Test Loss: 0.765 Test Acc: 0.803
Validation loss decreased (-0.722533 --> -0.803461).  Saving model ...
Epoch: 7 cost time: 3.555408239364624
Epoch: 7, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.253 Vali Acc: 0.751 Test Loss: 1.253 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.479208469390869
Epoch: 8, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.190 Vali Acc: 0.786 Test Loss: 1.190 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.65181827545166
Epoch: 9, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.117 Vali Acc: 0.746 Test Loss: 1.117 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.946486473083496
Epoch: 10, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.642 Vali Acc: 0.746 Test Loss: 1.642 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.4649336338043213
Epoch: 11, Steps: 17 | Train Loss: 0.065 Vali Loss: 2.343 Vali Acc: 0.676 Test Loss: 2.343 Test Acc: 0.676
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.348602771759033
Epoch: 12, Steps: 17 | Train Loss: 0.241 Vali Loss: 1.102 Vali Acc: 0.821 Test Loss: 1.102 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820798).  Saving model ...
Epoch: 13 cost time: 3.580176591873169
Epoch: 13, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.254 Vali Acc: 0.809 Test Loss: 1.254 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.9454097747802734
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 2.126 Vali Acc: 0.769 Test Loss: 2.126 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.574401378631592
Epoch: 15, Steps: 17 | Train Loss: 0.252 Vali Loss: 2.165 Vali Acc: 0.769 Test Loss: 2.165 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.546499252319336
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.809 Vali Acc: 0.699 Test Loss: 2.809 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.7038137912750244
Epoch: 17, Steps: 17 | Train Loss: 0.112 Vali Loss: 2.174 Vali Acc: 0.809 Test Loss: 2.174 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.8633337020874023
Epoch: 18, Steps: 17 | Train Loss: 0.311 Vali Loss: 2.960 Vali Acc: 0.786 Test Loss: 2.960 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.373734712600708
Epoch: 19, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.959 Vali Acc: 0.861 Test Loss: 1.959 Test Acc: 0.861
Validation loss decreased (-0.820798 --> -0.861252).  Saving model ...
Epoch: 20 cost time: 3.2710249423980713
Epoch: 20, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.767 Vali Acc: 0.792 Test Loss: 1.767 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.4404094219207764
Epoch: 21, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.095 Vali Acc: 0.821 Test Loss: 2.095 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.500953435897827
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 3.197 Vali Acc: 0.815 Test Loss: 3.197 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.7584917545318604
Epoch: 23, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.749 Vali Acc: 0.809 Test Loss: 2.749 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.6514365673065186
Epoch: 24, Steps: 17 | Train Loss: 0.078 Vali Loss: 3.493 Vali Acc: 0.780 Test Loss: 3.493 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.6704161167144775
Epoch: 25, Steps: 17 | Train Loss: 0.382 Vali Loss: 5.587 Vali Acc: 0.699 Test Loss: 5.587 Test Acc: 0.699
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.8770053386688232
Epoch: 26, Steps: 17 | Train Loss: 0.229 Vali Loss: 9.742 Vali Acc: 0.642 Test Loss: 9.742 Test Acc: 0.642
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.5880978107452393
Epoch: 27, Steps: 17 | Train Loss: 1.334 Vali Loss: 9.386 Vali Acc: 0.740 Test Loss: 9.386 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.422504186630249
Epoch: 28, Steps: 17 | Train Loss: 1.282 Vali Loss: 2.658 Vali Acc: 0.827 Test Loss: 2.658 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.282611131668091
Epoch: 29, Steps: 17 | Train Loss: 0.510 Vali Loss: 6.223 Vali Acc: 0.751 Test Loss: 6.223 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 5296191
model size : 29.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.815759897232056
Epoch: 1, Steps: 17 | Train Loss: 1.723 Vali Loss: 1.285 Vali Acc: 0.387 Test Loss: 1.285 Test Acc: 0.387
Validation loss decreased (inf --> -0.387270).  Saving model ...
Epoch: 2 cost time: 3.171995162963867
Epoch: 2, Steps: 17 | Train Loss: 0.929 Vali Loss: 1.028 Vali Acc: 0.653 Test Loss: 1.028 Test Acc: 0.653
Validation loss decreased (-0.387270 --> -0.653169).  Saving model ...
Epoch: 3 cost time: 3.2855288982391357
Epoch: 3, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.799 Vali Acc: 0.653 Test Loss: 0.799 Test Acc: 0.653
Validation loss decreased (-0.653169 --> -0.653171).  Saving model ...
Epoch: 4 cost time: 3.362952709197998
Epoch: 4, Steps: 17 | Train Loss: 0.442 Vali Loss: 1.370 Vali Acc: 0.642 Test Loss: 1.370 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.580872058868408
Epoch: 5, Steps: 17 | Train Loss: 0.511 Vali Loss: 1.070 Vali Acc: 0.734 Test Loss: 1.070 Test Acc: 0.734
Validation loss decreased (-0.653171 --> -0.734093).  Saving model ...
Epoch: 6 cost time: 3.31878662109375
Epoch: 6, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.329 Vali Acc: 0.780 Test Loss: 1.329 Test Acc: 0.780
Validation loss decreased (-0.734093 --> -0.780334).  Saving model ...
Epoch: 7 cost time: 3.3345541954040527
Epoch: 7, Steps: 17 | Train Loss: 0.493 Vali Loss: 1.176 Vali Acc: 0.688 Test Loss: 1.176 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2685368061065674
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.515 Vali Acc: 0.642 Test Loss: 1.515 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.410369634628296
Epoch: 9, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.290 Vali Acc: 0.705 Test Loss: 1.290 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.51857328414917
Epoch: 10, Steps: 17 | Train Loss: 0.189 Vali Loss: 2.595 Vali Acc: 0.659 Test Loss: 2.595 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.045870065689087
Epoch: 11, Steps: 17 | Train Loss: 0.186 Vali Loss: 1.034 Vali Acc: 0.815 Test Loss: 1.034 Test Acc: 0.815
Validation loss decreased (-0.780334 --> -0.815019).  Saving model ...
Epoch: 12 cost time: 3.3309874534606934
Epoch: 12, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.680 Vali Acc: 0.780 Test Loss: 1.680 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.3740670680999756
Epoch: 13, Steps: 17 | Train Loss: 0.153 Vali Loss: 2.777 Vali Acc: 0.728 Test Loss: 2.777 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.75203537940979
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.715 Vali Acc: 0.763 Test Loss: 2.715 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 4.268893241882324
Epoch: 15, Steps: 17 | Train Loss: 0.183 Vali Loss: 3.764 Vali Acc: 0.717 Test Loss: 3.764 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.8097615242004395
Epoch: 16, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.932 Vali Acc: 0.803 Test Loss: 1.932 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.6757450103759766
Epoch: 17, Steps: 17 | Train Loss: 0.534 Vali Loss: 3.364 Vali Acc: 0.780 Test Loss: 3.364 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 4.119632959365845
Epoch: 18, Steps: 17 | Train Loss: 0.110 Vali Loss: 2.376 Vali Acc: 0.792 Test Loss: 2.376 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 4.081167221069336
Epoch: 19, Steps: 17 | Train Loss: 0.273 Vali Loss: 2.963 Vali Acc: 0.821 Test Loss: 2.963 Test Acc: 0.821
Validation loss decreased (-0.815019 --> -0.820780).  Saving model ...
Epoch: 20 cost time: 4.017039775848389
Epoch: 20, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.562 Vali Acc: 0.786 Test Loss: 2.562 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.7821996212005615
Epoch: 21, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.936 Vali Acc: 0.763 Test Loss: 2.936 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.947324275970459
Epoch: 22, Steps: 17 | Train Loss: 0.155 Vali Loss: 2.554 Vali Acc: 0.815 Test Loss: 2.554 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 4.152757883071899
Epoch: 23, Steps: 17 | Train Loss: 0.210 Vali Loss: 2.679 Vali Acc: 0.809 Test Loss: 2.679 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 4.09919548034668
Epoch: 24, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.761 Vali Acc: 0.815 Test Loss: 2.761 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.847134828567505
Epoch: 25, Steps: 17 | Train Loss: 0.189 Vali Loss: 3.671 Vali Acc: 0.798 Test Loss: 3.671 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.5262677669525146
Epoch: 26, Steps: 17 | Train Loss: 0.119 Vali Loss: 4.361 Vali Acc: 0.769 Test Loss: 4.361 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.8032407760620117
Epoch: 27, Steps: 17 | Train Loss: 0.196 Vali Loss: 4.974 Vali Acc: 0.734 Test Loss: 4.974 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.8288774490356445
Epoch: 28, Steps: 17 | Train Loss: 0.201 Vali Loss: 3.705 Vali Acc: 0.815 Test Loss: 3.705 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.5599281787872314
Epoch: 29, Steps: 17 | Train Loss: 0.183 Vali Loss: 7.325 Vali Acc: 0.694 Test Loss: 7.325 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 5296191
model size : 29.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.729182481765747
Epoch: 1, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.377 Vali Acc: 0.312 Test Loss: 1.377 Test Acc: 0.312
Validation loss decreased (inf --> -0.312125).  Saving model ...
Epoch: 2 cost time: 3.431931495666504
Epoch: 2, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.001 Vali Acc: 0.699 Test Loss: 1.001 Test Acc: 0.699
Validation loss decreased (-0.312125 --> -0.699412).  Saving model ...
Epoch: 3 cost time: 3.080824851989746
Epoch: 3, Steps: 17 | Train Loss: 0.647 Vali Loss: 0.854 Vali Acc: 0.676 Test Loss: 0.854 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.865427255630493
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.080 Vali Acc: 0.642 Test Loss: 1.080 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 3.078859567642212
Epoch: 5, Steps: 17 | Train Loss: 0.587 Vali Loss: 1.344 Vali Acc: 0.676 Test Loss: 1.344 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 3.219008445739746
Epoch: 6, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.360 Vali Acc: 0.723 Test Loss: 1.360 Test Acc: 0.723
Validation loss decreased (-0.699412 --> -0.722530).  Saving model ...
Epoch: 7 cost time: 3.0673487186431885
Epoch: 7, Steps: 17 | Train Loss: 0.426 Vali Loss: 1.754 Vali Acc: 0.676 Test Loss: 1.754 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5522077083587646
Epoch: 8, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.471 Vali Acc: 0.671 Test Loss: 1.471 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1555652618408203
Epoch: 9, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.471 Vali Acc: 0.682 Test Loss: 1.471 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.007840156555176
Epoch: 10, Steps: 17 | Train Loss: 0.410 Vali Loss: 1.776 Vali Acc: 0.746 Test Loss: 1.776 Test Acc: 0.746
Validation loss decreased (-0.722530 --> -0.745647).  Saving model ...
Epoch: 11 cost time: 3.218384027481079
Epoch: 11, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.530 Vali Acc: 0.734 Test Loss: 1.530 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3571417331695557
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.773 Vali Acc: 0.746 Test Loss: 1.773 Test Acc: 0.746
Validation loss decreased (-0.745647 --> -0.745647).  Saving model ...
Epoch: 13 cost time: 3.3839423656463623
Epoch: 13, Steps: 17 | Train Loss: 0.246 Vali Loss: 2.351 Vali Acc: 0.746 Test Loss: 2.351 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.4851021766662598
Epoch: 14, Steps: 17 | Train Loss: 0.522 Vali Loss: 1.838 Vali Acc: 0.751 Test Loss: 1.838 Test Acc: 0.751
Validation loss decreased (-0.745647 --> -0.751427).  Saving model ...
Epoch: 15 cost time: 3.3014729022979736
Epoch: 15, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.938 Vali Acc: 0.751 Test Loss: 1.938 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.0421030521392822
Epoch: 16, Steps: 17 | Train Loss: 0.360 Vali Loss: 3.399 Vali Acc: 0.607 Test Loss: 3.399 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0080363750457764
Epoch: 17, Steps: 17 | Train Loss: 0.200 Vali Loss: 2.348 Vali Acc: 0.775 Test Loss: 2.348 Test Acc: 0.775
Validation loss decreased (-0.751427 --> -0.774543).  Saving model ...
Epoch: 18 cost time: 2.7658262252807617
Epoch: 18, Steps: 17 | Train Loss: 0.312 Vali Loss: 2.460 Vali Acc: 0.740 Test Loss: 2.460 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.854316234588623
Epoch: 19, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.243 Vali Acc: 0.815 Test Loss: 2.243 Test Acc: 0.815
Validation loss decreased (-0.774543 --> -0.815006).  Saving model ...
Epoch: 20 cost time: 2.88305401802063
Epoch: 20, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.093 Vali Acc: 0.815 Test Loss: 2.093 Test Acc: 0.815
Validation loss decreased (-0.815006 --> -0.815008).  Saving model ...
Epoch: 21 cost time: 3.0899927616119385
Epoch: 21, Steps: 17 | Train Loss: 0.293 Vali Loss: 3.447 Vali Acc: 0.769 Test Loss: 3.447 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 3.5159599781036377
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.368 Vali Acc: 0.832 Test Loss: 2.368 Test Acc: 0.832
Validation loss decreased (-0.815008 --> -0.832346).  Saving model ...
Epoch: 23 cost time: 3.6334173679351807
Epoch: 23, Steps: 17 | Train Loss: 0.366 Vali Loss: 4.540 Vali Acc: 0.705 Test Loss: 4.540 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.3440065383911133
Epoch: 24, Steps: 17 | Train Loss: 0.818 Vali Loss: 2.661 Vali Acc: 0.757 Test Loss: 2.661 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3805065155029297
Epoch: 25, Steps: 17 | Train Loss: 0.200 Vali Loss: 3.736 Vali Acc: 0.757 Test Loss: 3.736 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.0425710678100586
Epoch: 26, Steps: 17 | Train Loss: 0.402 Vali Loss: 7.106 Vali Acc: 0.601 Test Loss: 7.106 Test Acc: 0.601
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.970977783203125
Epoch: 27, Steps: 17 | Train Loss: 0.375 Vali Loss: 4.247 Vali Acc: 0.792 Test Loss: 4.247 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.210599422454834
Epoch: 28, Steps: 17 | Train Loss: 0.419 Vali Loss: 8.538 Vali Acc: 0.566 Test Loss: 8.538 Test Acc: 0.566
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.1955554485321045
Epoch: 29, Steps: 17 | Train Loss: 0.593 Vali Loss: 6.317 Vali Acc: 0.751 Test Loss: 6.317 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.1893064975738525
Epoch: 30, Steps: 17 | Train Loss: 0.743 Vali Loss: 6.235 Vali Acc: 0.775 Test Loss: 6.235 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.071052312850952
Epoch: 31, Steps: 17 | Train Loss: 0.242 Vali Loss: 4.941 Vali Acc: 0.757 Test Loss: 4.941 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.1068410873413086
Epoch: 32, Steps: 17 | Train Loss: 0.454 Vali Loss: 5.813 Vali Acc: 0.780 Test Loss: 5.813 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 5296191
model size : 29.99MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.3671934604644775
Epoch: 1, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.132 Vali Acc: 0.468 Test Loss: 1.132 Test Acc: 0.468
Validation loss decreased (inf --> -0.468197).  Saving model ...
Epoch: 2 cost time: 3.544314384460449
Epoch: 2, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.813 Vali Acc: 0.717 Test Loss: 0.813 Test Acc: 0.717
Validation loss decreased (-0.468197 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 3.2423806190490723
Epoch: 3, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.852 Vali Acc: 0.624 Test Loss: 0.852 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.240727663040161
Epoch: 4, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.887 Vali Acc: 0.723 Test Loss: 0.887 Test Acc: 0.723
Validation loss decreased (-0.716755 --> -0.722534).  Saving model ...
Epoch: 5 cost time: 3.3350541591644287
Epoch: 5, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.697 Vali Acc: 0.763 Test Loss: 0.697 Test Acc: 0.763
Validation loss decreased (-0.722534 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 3.227649450302124
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 3.3070666790008545
Epoch: 7, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.062 Vali Acc: 0.763 Test Loss: 1.062 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.5469753742218018
Epoch: 8, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.759 Vali Acc: 0.809 Test Loss: 0.759 Test Acc: 0.809
Validation loss decreased (-0.774559 --> -0.809241).  Saving model ...
Epoch: 9 cost time: 3.6142337322235107
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.616 Vali Acc: 0.775 Test Loss: 1.616 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.3019285202026367
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.433 Vali Acc: 0.740 Test Loss: 1.433 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.3729779720306396
Epoch: 11, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.414 Vali Acc: 0.757 Test Loss: 1.414 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.1182737350463867
Epoch: 12, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.372 Vali Acc: 0.815 Test Loss: 1.372 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815015).  Saving model ...
Epoch: 13 cost time: 3.5257632732391357
Epoch: 13, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.132 Vali Acc: 0.757 Test Loss: 2.132 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.457503318786621
Epoch: 14, Steps: 17 | Train Loss: 0.439 Vali Loss: 1.588 Vali Acc: 0.792 Test Loss: 1.588 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.2040226459503174
Epoch: 15, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.076 Vali Acc: 0.809 Test Loss: 2.076 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.0772294998168945
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.614 Vali Acc: 0.827 Test Loss: 1.614 Test Acc: 0.827
Validation loss decreased (-0.815015 --> -0.826573).  Saving model ...
Epoch: 17 cost time: 3.6127021312713623
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.302 Vali Acc: 0.821 Test Loss: 1.302 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 4.02622389793396
Epoch: 18, Steps: 17 | Train Loss: 0.225 Vali Loss: 2.367 Vali Acc: 0.803 Test Loss: 2.367 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.7648816108703613
Epoch: 19, Steps: 17 | Train Loss: 0.262 Vali Loss: 3.911 Vali Acc: 0.711 Test Loss: 3.911 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.707144021987915
Epoch: 20, Steps: 17 | Train Loss: 0.291 Vali Loss: 3.821 Vali Acc: 0.746 Test Loss: 3.821 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.866858720779419
Epoch: 21, Steps: 17 | Train Loss: 0.143 Vali Loss: 3.459 Vali Acc: 0.780 Test Loss: 3.459 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 4.259443759918213
Epoch: 22, Steps: 17 | Train Loss: 0.142 Vali Loss: 2.868 Vali Acc: 0.815 Test Loss: 2.868 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.5230329036712646
Epoch: 23, Steps: 17 | Train Loss: 0.217 Vali Loss: 3.852 Vali Acc: 0.815 Test Loss: 3.852 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.3675129413604736
Epoch: 24, Steps: 17 | Train Loss: 0.259 Vali Loss: 3.602 Vali Acc: 0.827 Test Loss: 3.602 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 3.403047800064087
Epoch: 25, Steps: 17 | Train Loss: 0.394 Vali Loss: 4.204 Vali Acc: 0.757 Test Loss: 4.204 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.210512161254883
Epoch: 26, Steps: 17 | Train Loss: 0.173 Vali Loss: 4.559 Vali Acc: 0.809 Test Loss: 4.559 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5165119
model size : 29.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.225204229354858
Epoch: 1, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.145 Vali Acc: 0.462 Test Loss: 1.145 Test Acc: 0.462
Validation loss decreased (inf --> -0.462416).  Saving model ...
Epoch: 2 cost time: 3.772707223892212
Epoch: 2, Steps: 17 | Train Loss: 0.897 Vali Loss: 0.815 Vali Acc: 0.694 Test Loss: 0.815 Test Acc: 0.694
Validation loss decreased (-0.462416 --> -0.693633).  Saving model ...
Epoch: 3 cost time: 3.8633413314819336
Epoch: 3, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.846 Vali Acc: 0.671 Test Loss: 0.846 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.3854820728302
Epoch: 4, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.703 Vali Acc: 0.792 Test Loss: 0.703 Test Acc: 0.792
Validation loss decreased (-0.693633 --> -0.791900).  Saving model ...
Epoch: 5 cost time: 3.0605030059814453
Epoch: 5, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.929 Vali Acc: 0.682 Test Loss: 0.929 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1510202884674072
Epoch: 6, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.741 Vali Acc: 0.757 Test Loss: 0.741 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.3444766998291016
Epoch: 7, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.069 Vali Acc: 0.792 Test Loss: 1.069 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.142639636993408
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.734 Vali Acc: 0.827 Test Loss: 0.734 Test Acc: 0.827
Validation loss decreased (-0.791900 --> -0.826582).  Saving model ...
Epoch: 9 cost time: 3.0912489891052246
Epoch: 9, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.207 Vali Acc: 0.734 Test Loss: 1.207 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.4201340675354004
Epoch: 10, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.400 Vali Acc: 0.751 Test Loss: 1.400 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.368973731994629
Epoch: 11, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.728 Vali Acc: 0.694 Test Loss: 1.728 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.4738290309906006
Epoch: 12, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.565 Vali Acc: 0.803 Test Loss: 1.565 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.4090700149536133
Epoch: 13, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.276 Vali Acc: 0.763 Test Loss: 2.276 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 3.430849552154541
Epoch: 14, Steps: 17 | Train Loss: 0.161 Vali Loss: 2.005 Vali Acc: 0.780 Test Loss: 2.005 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.153486728668213
Epoch: 15, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.397 Vali Acc: 0.798 Test Loss: 1.397 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.119511365890503
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.677 Vali Acc: 0.815 Test Loss: 1.677 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 3.3926730155944824
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.958 Vali Acc: 0.798 Test Loss: 1.958 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.3675708770751953
Epoch: 18, Steps: 17 | Train Loss: 0.245 Vali Loss: 2.336 Vali Acc: 0.780 Test Loss: 2.336 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5165119
model size : 29.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.619253396987915
Epoch: 1, Steps: 17 | Train Loss: 1.692 Vali Loss: 1.180 Vali Acc: 0.416 Test Loss: 1.180 Test Acc: 0.416
Validation loss decreased (inf --> -0.416173).  Saving model ...
Epoch: 2 cost time: 3.250764846801758
Epoch: 2, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.799 Vali Acc: 0.746 Test Loss: 0.799 Test Acc: 0.746
Validation loss decreased (-0.416173 --> -0.745657).  Saving model ...
Epoch: 3 cost time: 3.1809399127960205
Epoch: 3, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.732 Vali Acc: 0.676 Test Loss: 0.732 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.955737352371216
Epoch: 4, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.603 Vali Acc: 0.815 Test Loss: 0.603 Test Acc: 0.815
Validation loss decreased (-0.745657 --> -0.815023).  Saving model ...
Epoch: 5 cost time: 3.197230577468872
Epoch: 5, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.973 Vali Acc: 0.751 Test Loss: 0.973 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0379397869110107
Epoch: 6, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.911 Vali Acc: 0.717 Test Loss: 0.911 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.598560333251953
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.132 Vali Acc: 0.751 Test Loss: 1.132 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.151080369949341
Epoch: 8, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.712 Vali Acc: 0.798 Test Loss: 0.712 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.926347017288208
Epoch: 9, Steps: 17 | Train Loss: 0.331 Vali Loss: 1.476 Vali Acc: 0.798 Test Loss: 1.476 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.4754865169525146
Epoch: 10, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.085 Vali Acc: 0.786 Test Loss: 1.085 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 3.707341432571411
Epoch: 11, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.671 Vali Acc: 0.769 Test Loss: 1.671 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 3.35235857963562
Epoch: 12, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.595 Vali Acc: 0.792 Test Loss: 1.595 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 3.4762938022613525
Epoch: 13, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.711 Vali Acc: 0.763 Test Loss: 1.711 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 3.2158825397491455
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 2.685 Vali Acc: 0.763 Test Loss: 2.685 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 5165119
model size : 29.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 6.022611618041992
Epoch: 1, Steps: 17 | Train Loss: 1.757 Vali Loss: 1.247 Vali Acc: 0.451 Test Loss: 1.247 Test Acc: 0.451
Validation loss decreased (inf --> -0.450855).  Saving model ...
Epoch: 2 cost time: 3.240699052810669
Epoch: 2, Steps: 17 | Train Loss: 1.051 Vali Loss: 0.830 Vali Acc: 0.671 Test Loss: 0.830 Test Acc: 0.671
Validation loss decreased (-0.450855 --> -0.670512).  Saving model ...
Epoch: 3 cost time: 3.5187861919403076
Epoch: 3, Steps: 17 | Train Loss: 0.669 Vali Loss: 1.113 Vali Acc: 0.630 Test Loss: 1.113 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 3.1793317794799805
Epoch: 4, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.615 Vali Acc: 0.792 Test Loss: 0.615 Test Acc: 0.792
Validation loss decreased (-0.670512 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 3.0736746788024902
Epoch: 5, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.883 Vali Acc: 0.676 Test Loss: 0.883 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.292344570159912
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.116 Vali Acc: 0.699 Test Loss: 1.116 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 3.298823833465576
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.968 Vali Acc: 0.699 Test Loss: 0.968 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 3.316450595855713
Epoch: 8, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.511 Vali Acc: 0.665 Test Loss: 1.511 Test Acc: 0.665
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 3.2133665084838867
Epoch: 9, Steps: 17 | Train Loss: 0.268 Vali Loss: 1.669 Vali Acc: 0.740 Test Loss: 1.669 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 3.127793312072754
Epoch: 10, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.954 Vali Acc: 0.798 Test Loss: 0.954 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797678).  Saving model ...
Epoch: 11 cost time: 3.343430757522583
Epoch: 11, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.210 Vali Acc: 0.780 Test Loss: 1.210 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.3352577686309814
Epoch: 12, Steps: 17 | Train Loss: 0.218 Vali Loss: 2.250 Vali Acc: 0.728 Test Loss: 2.250 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 3.557516574859619
Epoch: 13, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.823 Vali Acc: 0.723 Test Loss: 1.823 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.611597776412964
Epoch: 14, Steps: 17 | Train Loss: 0.297 Vali Loss: 2.708 Vali Acc: 0.688 Test Loss: 2.708 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 3.463233232498169
Epoch: 15, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.666 Vali Acc: 0.734 Test Loss: 2.666 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.3997597694396973
Epoch: 16, Steps: 17 | Train Loss: 0.233 Vali Loss: 1.992 Vali Acc: 0.723 Test Loss: 1.992 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.3222169876098633
Epoch: 17, Steps: 17 | Train Loss: 0.224 Vali Loss: 2.490 Vali Acc: 0.757 Test Loss: 2.490 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.1298394203186035
Epoch: 18, Steps: 17 | Train Loss: 0.104 Vali Loss: 2.595 Vali Acc: 0.734 Test Loss: 2.595 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8983395099639893
Epoch: 19, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.887 Vali Acc: 0.728 Test Loss: 2.887 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.2253634929656982
Epoch: 20, Steps: 17 | Train Loss: 0.157 Vali Loss: 5.691 Vali Acc: 0.671 Test Loss: 5.691 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 5165119
model size : 29.49MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.259850740432739
Epoch: 1, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.329 Vali Acc: 0.474 Test Loss: 1.329 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 3.0436787605285645
Epoch: 2, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.029 Vali Acc: 0.607 Test Loss: 1.029 Test Acc: 0.607
Validation loss decreased (-0.473975 --> -0.606926).  Saving model ...
Epoch: 3 cost time: 2.886362075805664
Epoch: 3, Steps: 17 | Train Loss: 0.685 Vali Loss: 0.659 Vali Acc: 0.798 Test Loss: 0.659 Test Acc: 0.798
Validation loss decreased (-0.606926 --> -0.797681).  Saving model ...
Epoch: 4 cost time: 3.0297555923461914
Epoch: 4, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.069 Vali Acc: 0.555 Test Loss: 1.069 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9437177181243896
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.512 Vali Acc: 0.832 Test Loss: 0.512 Test Acc: 0.832
Validation loss decreased (-0.797681 --> -0.832365).  Saving model ...
Epoch: 6 cost time: 3.264664649963379
Epoch: 6, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.665 Vali Acc: 0.792 Test Loss: 0.665 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1738407611846924
Epoch: 7, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.641 Vali Acc: 0.792 Test Loss: 0.641 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2208492755889893
Epoch: 8, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.800 Vali Acc: 0.734 Test Loss: 0.800 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8234171867370605
Epoch: 9, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0225918292999268
Epoch: 10, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.704 Vali Acc: 0.821 Test Loss: 0.704 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7390294075012207
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.670 Vali Acc: 0.827 Test Loss: 0.670 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.822930335998535
Epoch: 12, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.064 Vali Acc: 0.798 Test Loss: 1.064 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.008514642715454
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.832365 --> -0.849705).  Saving model ...
Epoch: 14 cost time: 2.814305305480957
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.875 Vali Acc: 0.821 Test Loss: 0.875 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8568878173828125
Epoch: 15, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.259 Vali Acc: 0.717 Test Loss: 2.259 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8755953311920166
Epoch: 16, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.362 Vali Acc: 0.786 Test Loss: 1.362 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.1449570655822754
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.356 Vali Acc: 0.815 Test Loss: 1.356 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.054736375808716
Epoch: 18, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.916 Vali Acc: 0.792 Test Loss: 1.916 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1075708866119385
Epoch: 19, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.377 Vali Acc: 0.746 Test Loss: 1.377 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.84919810295105
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.291 Vali Acc: 0.815 Test Loss: 1.291 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.764594554901123
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.481 Vali Acc: 0.827 Test Loss: 1.481 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.081634283065796
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.734 Vali Acc: 0.757 Test Loss: 2.734 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8420541286468506
Epoch: 23, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.787 Vali Acc: 0.780 Test Loss: 1.787 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 4355903
model size : 21.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.896316051483154
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.332 Vali Acc: 0.462 Test Loss: 1.332 Test Acc: 0.462
Validation loss decreased (inf --> -0.462414).  Saving model ...
Epoch: 2 cost time: 3.0962347984313965
Epoch: 2, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.019 Vali Acc: 0.618 Test Loss: 1.019 Test Acc: 0.618
Validation loss decreased (-0.462414 --> -0.618487).  Saving model ...
Epoch: 3 cost time: 2.983555316925049
Epoch: 3, Steps: 17 | Train Loss: 0.702 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.618487 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 2.9607479572296143
Epoch: 4, Steps: 17 | Train Loss: 0.399 Vali Loss: 1.148 Vali Acc: 0.532 Test Loss: 1.148 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9757447242736816
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.790 Vali Acc: 0.705 Test Loss: 0.790 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3983025550842285
Epoch: 6, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.007 Vali Acc: 0.705 Test Loss: 1.007 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.307835340499878
Epoch: 7, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.749 Vali Acc: 0.775 Test Loss: 0.749 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774559).  Saving model ...
Epoch: 8 cost time: 3.029113292694092
Epoch: 8, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.626 Vali Acc: 0.786 Test Loss: 0.626 Test Acc: 0.786
Validation loss decreased (-0.774559 --> -0.786121).  Saving model ...
Epoch: 9 cost time: 2.817354440689087
Epoch: 9, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.979 Vali Acc: 0.694 Test Loss: 0.979 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.9667837619781494
Epoch: 10, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.758 Vali Acc: 0.821 Test Loss: 0.758 Test Acc: 0.821
Validation loss decreased (-0.786121 --> -0.820802).  Saving model ...
Epoch: 11 cost time: 3.171229124069214
Epoch: 11, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.938 Vali Acc: 0.769 Test Loss: 0.938 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.0838468074798584
Epoch: 12, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.684 Vali Acc: 0.838 Test Loss: 0.684 Test Acc: 0.838
Validation loss decreased (-0.820802 --> -0.838143).  Saving model ...
Epoch: 13 cost time: 3.3951754570007324
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.741 Vali Acc: 0.821 Test Loss: 0.741 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.3955183029174805
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.305 Vali Acc: 0.815 Test Loss: 1.305 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.1011171340942383
Epoch: 15, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.190 Vali Acc: 0.786 Test Loss: 1.190 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.1366851329803467
Epoch: 16, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.526 Vali Acc: 0.769 Test Loss: 1.526 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.897681951522827
Epoch: 17, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.363 Vali Acc: 0.809 Test Loss: 1.363 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.0032315254211426
Epoch: 18, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.938 Vali Acc: 0.786 Test Loss: 1.938 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.08115291595459
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.630 Vali Acc: 0.694 Test Loss: 2.630 Test Acc: 0.694
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.3352253437042236
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.559 Vali Acc: 0.728 Test Loss: 2.559 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.2397711277008057
Epoch: 21, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.711 Vali Acc: 0.688 Test Loss: 2.711 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 3.160019874572754
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.513 Vali Acc: 0.803 Test Loss: 1.513 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 4355903
model size : 21.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.076782703399658
Epoch: 1, Steps: 17 | Train Loss: 1.878 Vali Loss: 1.343 Vali Acc: 0.457 Test Loss: 1.343 Test Acc: 0.457
Validation loss decreased (inf --> -0.456634).  Saving model ...
Epoch: 2 cost time: 2.7015905380249023
Epoch: 2, Steps: 17 | Train Loss: 1.141 Vali Loss: 1.061 Vali Acc: 0.595 Test Loss: 1.061 Test Acc: 0.595
Validation loss decreased (-0.456634 --> -0.595365).  Saving model ...
Epoch: 3 cost time: 3.034374237060547
Epoch: 3, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.688 Vali Acc: 0.769 Test Loss: 0.688 Test Acc: 0.769
Validation loss decreased (-0.595365 --> -0.768779).  Saving model ...
Epoch: 4 cost time: 3.1136348247528076
Epoch: 4, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.997 Vali Acc: 0.555 Test Loss: 0.997 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.0660390853881836
Epoch: 5, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.704 Vali Acc: 0.757 Test Loss: 0.704 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.85508131980896
Epoch: 6, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
Validation loss decreased (-0.768779 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 3.12133526802063
Epoch: 7, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.741 Vali Acc: 0.803 Test Loss: 0.741 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.781897783279419
Epoch: 8, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7148683071136475
Epoch: 9, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.793 Vali Acc: 0.740 Test Loss: 0.793 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.538414716720581
Epoch: 10, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.098 Vali Acc: 0.740 Test Loss: 1.098 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.870067834854126
Epoch: 11, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.997 Vali Acc: 0.775 Test Loss: 0.997 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.764813184738159
Epoch: 12, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.823 Vali Acc: 0.827 Test Loss: 0.823 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826581).  Saving model ...
Epoch: 13 cost time: 2.8915390968322754
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.056 Vali Acc: 0.809 Test Loss: 1.056 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.7820723056793213
Epoch: 14, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.227 Vali Acc: 0.798 Test Loss: 1.227 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.17832088470459
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.052 Vali Acc: 0.803 Test Loss: 1.052 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 3.037132978439331
Epoch: 16, Steps: 17 | Train Loss: 0.100 Vali Loss: 2.347 Vali Acc: 0.751 Test Loss: 2.347 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.903315782546997
Epoch: 17, Steps: 17 | Train Loss: 0.289 Vali Loss: 1.314 Vali Acc: 0.786 Test Loss: 1.314 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.838486433029175
Epoch: 18, Steps: 17 | Train Loss: 0.069 Vali Loss: 2.274 Vali Acc: 0.751 Test Loss: 2.274 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.8238136768341064
Epoch: 19, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.191 Vali Acc: 0.815 Test Loss: 1.191 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.8456428050994873
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.665 Vali Acc: 0.803 Test Loss: 1.665 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.770224094390869
Epoch: 21, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.300 Vali Acc: 0.838 Test Loss: 1.300 Test Acc: 0.838
Validation loss decreased (-0.826581 --> -0.838137).  Saving model ...
Epoch: 22 cost time: 2.868074655532837
Epoch: 22, Steps: 17 | Train Loss: 0.047 Vali Loss: 2.009 Vali Acc: 0.803 Test Loss: 2.009 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.97678542137146
Epoch: 23, Steps: 17 | Train Loss: 0.050 Vali Loss: 2.605 Vali Acc: 0.734 Test Loss: 2.605 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6299383640289307
Epoch: 24, Steps: 17 | Train Loss: 0.166 Vali Loss: 2.778 Vali Acc: 0.728 Test Loss: 2.778 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.9976582527160645
Epoch: 25, Steps: 17 | Train Loss: 0.220 Vali Loss: 3.218 Vali Acc: 0.775 Test Loss: 3.218 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.075122833251953
Epoch: 26, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.758 Vali Acc: 0.798 Test Loss: 1.758 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.982609987258911
Epoch: 27, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.344 Vali Acc: 0.780 Test Loss: 2.344 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.7387304306030273
Epoch: 28, Steps: 17 | Train Loss: 0.145 Vali Loss: 3.242 Vali Acc: 0.798 Test Loss: 3.242 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.771099328994751
Epoch: 29, Steps: 17 | Train Loss: 0.064 Vali Loss: 3.199 Vali Acc: 0.815 Test Loss: 3.199 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.9225494861602783
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 3.319 Vali Acc: 0.786 Test Loss: 3.319 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8551456928253174
Epoch: 31, Steps: 17 | Train Loss: 0.336 Vali Loss: 2.676 Vali Acc: 0.803 Test Loss: 2.676 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 4355903
model size : 21.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.267362117767334
Epoch: 1, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.379 Vali Acc: 0.439 Test Loss: 1.379 Test Acc: 0.439
Validation loss decreased (inf --> -0.439293).  Saving model ...
Epoch: 2 cost time: 3.0327136516571045
Epoch: 2, Steps: 17 | Train Loss: 1.190 Vali Loss: 1.145 Vali Acc: 0.584 Test Loss: 1.145 Test Acc: 0.584
Validation loss decreased (-0.439293 --> -0.583804).  Saving model ...
Epoch: 3 cost time: 3.104210615158081
Epoch: 3, Steps: 17 | Train Loss: 0.820 Vali Loss: 0.741 Vali Acc: 0.775 Test Loss: 0.741 Test Acc: 0.775
Validation loss decreased (-0.583804 --> -0.774559).  Saving model ...
Epoch: 4 cost time: 2.8739426136016846
Epoch: 4, Steps: 17 | Train Loss: 0.520 Vali Loss: 1.048 Vali Acc: 0.555 Test Loss: 1.048 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.766663074493408
Epoch: 5, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.961 Vali Acc: 0.584 Test Loss: 0.961 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.3130650520324707
Epoch: 6, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.835 Vali Acc: 0.792 Test Loss: 0.835 Test Acc: 0.792
Validation loss decreased (-0.774559 --> -0.791899).  Saving model ...
Epoch: 7 cost time: 2.598715305328369
Epoch: 7, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.739 Vali Acc: 0.780 Test Loss: 0.739 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.9497501850128174
Epoch: 8, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.936 Vali Acc: 0.757 Test Loss: 0.936 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.1844687461853027
Epoch: 9, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.929733991622925
Epoch: 10, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.066 Vali Acc: 0.746 Test Loss: 1.066 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.3721444606781006
Epoch: 11, Steps: 17 | Train Loss: 0.238 Vali Loss: 1.379 Vali Acc: 0.723 Test Loss: 1.379 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.4804039001464844
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.185 Vali Acc: 0.757 Test Loss: 1.185 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.958899974822998
Epoch: 13, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.961 Vali Acc: 0.775 Test Loss: 0.961 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.8612136840820312
Epoch: 14, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.944 Vali Acc: 0.751 Test Loss: 1.944 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.907001256942749
Epoch: 15, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.477 Vali Acc: 0.694 Test Loss: 1.477 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 16 cost time: 2.9978904724121094
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.648 Vali Acc: 0.775 Test Loss: 1.648 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 4355903
model size : 21.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.347301721572876
Epoch: 1, Steps: 17 | Train Loss: 1.789 Vali Loss: 1.332 Vali Acc: 0.370 Test Loss: 1.332 Test Acc: 0.370
Validation loss decreased (inf --> -0.369929).  Saving model ...
Epoch: 2 cost time: 2.647967576980591
Epoch: 2, Steps: 17 | Train Loss: 1.023 Vali Loss: 0.964 Vali Acc: 0.613 Test Loss: 0.964 Test Acc: 0.613
Validation loss decreased (-0.369929 --> -0.612707).  Saving model ...
Epoch: 3 cost time: 2.522407054901123
Epoch: 3, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.743 Vali Acc: 0.705 Test Loss: 0.743 Test Acc: 0.705
Validation loss decreased (-0.612707 --> -0.705195).  Saving model ...
Epoch: 4 cost time: 2.461707830429077
Epoch: 4, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.625 Vali Acc: 0.751 Test Loss: 0.625 Test Acc: 0.751
Validation loss decreased (-0.705195 --> -0.751439).  Saving model ...
Epoch: 5 cost time: 2.7689414024353027
Epoch: 5, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.634 Vali Acc: 0.775 Test Loss: 0.634 Test Acc: 0.775
Validation loss decreased (-0.751439 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 2.5452961921691895
Epoch: 6, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.614 Vali Acc: 0.809 Test Loss: 0.614 Test Acc: 0.809
Validation loss decreased (-0.774560 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 2.7284629344940186
Epoch: 7, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.560 Vali Acc: 0.798 Test Loss: 0.560 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.1988818645477295
Epoch: 8, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.705 Vali Acc: 0.827 Test Loss: 0.705 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826583).  Saving model ...
Epoch: 9 cost time: 2.6379265785217285
Epoch: 9, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.923 Vali Acc: 0.769 Test Loss: 0.923 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7903926372528076
Epoch: 10, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.755 Vali Acc: 0.832 Test Loss: 0.755 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832362).  Saving model ...
Epoch: 11 cost time: 3.1048836708068848
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.410 Vali Acc: 0.717 Test Loss: 1.410 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7963414192199707
Epoch: 12, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.879 Vali Acc: 0.769 Test Loss: 0.879 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5909759998321533
Epoch: 13, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.927 Vali Acc: 0.792 Test Loss: 0.927 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0019092559814453
Epoch: 14, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.966 Vali Acc: 0.803 Test Loss: 0.966 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5847926139831543
Epoch: 15, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.657 Vali Acc: 0.827 Test Loss: 0.657 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.5164389610290527
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.076 Vali Acc: 0.809 Test Loss: 1.076 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.721637487411499
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.743 Vali Acc: 0.821 Test Loss: 0.743 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.832909107208252
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.373 Vali Acc: 0.751 Test Loss: 1.373 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.4309544563293457
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.634 Vali Acc: 0.873 Test Loss: 0.634 Test Acc: 0.873
Validation loss decreased (-0.832362 --> -0.872826).  Saving model ...
Epoch: 20 cost time: 2.7953600883483887
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.910 Vali Acc: 0.815 Test Loss: 0.910 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.4853057861328125
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.390 Vali Acc: 0.815 Test Loss: 1.390 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.648268222808838
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.170 Vali Acc: 0.821 Test Loss: 1.170 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.753176212310791
Epoch: 23, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.782 Vali Acc: 0.850 Test Loss: 0.782 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.0192267894744873
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.729 Vali Acc: 0.798 Test Loss: 1.729 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.900904417037964
Epoch: 25, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.475 Vali Acc: 0.827 Test Loss: 1.475 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.0122427940368652
Epoch: 26, Steps: 17 | Train Loss: 0.117 Vali Loss: 3.281 Vali Acc: 0.746 Test Loss: 3.281 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.060720205307007
Epoch: 27, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.108 Vali Acc: 0.861 Test Loss: 1.108 Test Acc: 0.861
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.825967788696289
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.223 Vali Acc: 0.827 Test Loss: 2.223 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.400407075881958
Epoch: 29, Steps: 17 | Train Loss: 0.319 Vali Loss: 1.319 Vali Acc: 0.879 Test Loss: 1.319 Test Acc: 0.879
Validation loss decreased (-0.872826 --> -0.878600).  Saving model ...
Epoch: 30 cost time: 3.291203737258911
Epoch: 30, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.924 Vali Acc: 0.832 Test Loss: 1.924 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.909067153930664
Epoch: 31, Steps: 17 | Train Loss: 0.396 Vali Loss: 2.838 Vali Acc: 0.815 Test Loss: 2.838 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.992264747619629
Epoch: 32, Steps: 17 | Train Loss: 0.329 Vali Loss: 3.871 Vali Acc: 0.792 Test Loss: 3.871 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.2616469860076904
Epoch: 33, Steps: 17 | Train Loss: 0.097 Vali Loss: 3.282 Vali Acc: 0.786 Test Loss: 3.282 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 3.039700746536255
Epoch: 34, Steps: 17 | Train Loss: 0.254 Vali Loss: 3.383 Vali Acc: 0.821 Test Loss: 3.383 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 3.3813061714172363
Epoch: 35, Steps: 17 | Train Loss: 0.137 Vali Loss: 3.623 Vali Acc: 0.792 Test Loss: 3.623 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 3.1753201484680176
Epoch: 36, Steps: 17 | Train Loss: 0.073 Vali Loss: 3.075 Vali Acc: 0.809 Test Loss: 3.075 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 3.122023105621338
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 3.315 Vali Acc: 0.838 Test Loss: 3.315 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.0633299350738525
Epoch: 38, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.230 Vali Acc: 0.844 Test Loss: 2.230 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.9170730113983154
Epoch: 39, Steps: 17 | Train Loss: 0.109 Vali Loss: 3.674 Vali Acc: 0.763 Test Loss: 3.674 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 3307327
model size : 17.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.175016164779663
Epoch: 1, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.329 Vali Acc: 0.393 Test Loss: 1.329 Test Acc: 0.393
Validation loss decreased (inf --> -0.393050).  Saving model ...
Epoch: 2 cost time: 2.8497626781463623
Epoch: 2, Steps: 17 | Train Loss: 1.025 Vali Loss: 0.972 Vali Acc: 0.624 Test Loss: 0.972 Test Acc: 0.624
Validation loss decreased (-0.393050 --> -0.624268).  Saving model ...
Epoch: 3 cost time: 2.685621738433838
Epoch: 3, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.791 Vali Acc: 0.665 Test Loss: 0.791 Test Acc: 0.665
Validation loss decreased (-0.624268 --> -0.664732).  Saving model ...
Epoch: 4 cost time: 2.798872470855713
Epoch: 4, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.711 Vali Acc: 0.740 Test Loss: 0.711 Test Acc: 0.740
Validation loss decreased (-0.664732 --> -0.739877).  Saving model ...
Epoch: 5 cost time: 2.799734354019165
Epoch: 5, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.648 Vali Acc: 0.792 Test Loss: 0.648 Test Acc: 0.792
Validation loss decreased (-0.739877 --> -0.791901).  Saving model ...
Epoch: 6 cost time: 2.8279330730438232
Epoch: 6, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.863 Vali Acc: 0.740 Test Loss: 0.863 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.92810320854187
Epoch: 7, Steps: 17 | Train Loss: 0.347 Vali Loss: 0.738 Vali Acc: 0.792 Test Loss: 0.738 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.870596170425415
Epoch: 8, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.591 Vali Acc: 0.786 Test Loss: 0.591 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.669428825378418
Epoch: 9, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.497 Vali Acc: 0.815 Test Loss: 0.497 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815024).  Saving model ...
Epoch: 10 cost time: 2.4822356700897217
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.794 Vali Acc: 0.827 Test Loss: 0.794 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826582).  Saving model ...
Epoch: 11 cost time: 2.666149854660034
Epoch: 11, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.835 Vali Acc: 0.798 Test Loss: 0.835 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8136792182922363
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8285160064697266
Epoch: 13, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.577 Vali Acc: 0.838 Test Loss: 0.577 Test Acc: 0.838
Validation loss decreased (-0.826582 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 2.7990615367889404
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.285799741744995
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.220 Vali Acc: 0.763 Test Loss: 1.220 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.2853803634643555
Epoch: 16, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.156 Vali Acc: 0.803 Test Loss: 1.156 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.3265817165374756
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.799 Vali Acc: 0.827 Test Loss: 0.799 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.3912556171417236
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.468 Vali Acc: 0.809 Test Loss: 1.468 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.541027784347534
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.244 Vali Acc: 0.780 Test Loss: 1.244 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.793719530105591
Epoch: 20, Steps: 17 | Train Loss: 0.170 Vali Loss: 1.333 Vali Acc: 0.803 Test Loss: 1.333 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 3.641535997390747
Epoch: 21, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.122 Vali Acc: 0.832 Test Loss: 1.122 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.681609869003296
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.125 Vali Acc: 0.844 Test Loss: 1.125 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843919).  Saving model ...
Epoch: 23 cost time: 3.454699993133545
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.530 Vali Acc: 0.838 Test Loss: 1.530 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 3.4453423023223877
Epoch: 24, Steps: 17 | Train Loss: 0.058 Vali Loss: 3.339 Vali Acc: 0.746 Test Loss: 3.339 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 3.3863072395324707
Epoch: 25, Steps: 17 | Train Loss: 0.079 Vali Loss: 3.937 Vali Acc: 0.671 Test Loss: 3.937 Test Acc: 0.671
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 3.5541763305664062
Epoch: 26, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.195 Vali Acc: 0.803 Test Loss: 2.195 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 3.505986452102661
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 2.016 Vali Acc: 0.815 Test Loss: 2.016 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 3.4604568481445312
Epoch: 28, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.424 Vali Acc: 0.803 Test Loss: 1.424 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 3.101475954055786
Epoch: 29, Steps: 17 | Train Loss: 0.421 Vali Loss: 2.661 Vali Acc: 0.780 Test Loss: 2.661 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 3.149181604385376
Epoch: 30, Steps: 17 | Train Loss: 0.260 Vali Loss: 5.142 Vali Acc: 0.740 Test Loss: 5.142 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.129833698272705
Epoch: 31, Steps: 17 | Train Loss: 0.206 Vali Loss: 2.536 Vali Acc: 0.838 Test Loss: 2.536 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 3.420790672302246
Epoch: 32, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.875 Vali Acc: 0.775 Test Loss: 2.875 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3307327
model size : 17.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.905032396316528
Epoch: 1, Steps: 17 | Train Loss: 1.780 Vali Loss: 1.339 Vali Acc: 0.393 Test Loss: 1.339 Test Acc: 0.393
Validation loss decreased (inf --> -0.393050).  Saving model ...
Epoch: 2 cost time: 2.65012788772583
Epoch: 2, Steps: 17 | Train Loss: 1.061 Vali Loss: 0.981 Vali Acc: 0.590 Test Loss: 0.981 Test Acc: 0.590
Validation loss decreased (-0.393050 --> -0.589586).  Saving model ...
Epoch: 3 cost time: 2.7514243125915527
Epoch: 3, Steps: 17 | Train Loss: 0.785 Vali Loss: 0.767 Vali Acc: 0.717 Test Loss: 0.767 Test Acc: 0.717
Validation loss decreased (-0.589586 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 2.4988019466400146
Epoch: 4, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.609 Vali Acc: 0.751 Test Loss: 0.609 Test Acc: 0.751
Validation loss decreased (-0.716755 --> -0.751439).  Saving model ...
Epoch: 5 cost time: 2.8244922161102295
Epoch: 5, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.666 Vali Acc: 0.775 Test Loss: 0.666 Test Acc: 0.775
Validation loss decreased (-0.751439 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 2.965956449508667
Epoch: 6, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.065 Vali Acc: 0.723 Test Loss: 1.065 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.719902276992798
Epoch: 7, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.693 Vali Acc: 0.769 Test Loss: 0.693 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.1024434566497803
Epoch: 8, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.972 Vali Acc: 0.734 Test Loss: 0.972 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.7897002696990967
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.592 Vali Acc: 0.798 Test Loss: 0.592 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 2.8130383491516113
Epoch: 10, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.845 Vali Acc: 0.827 Test Loss: 0.845 Test Acc: 0.827
Validation loss decreased (-0.797682 --> -0.826581).  Saving model ...
Epoch: 11 cost time: 2.561249017715454
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.897 Vali Acc: 0.775 Test Loss: 0.897 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7196948528289795
Epoch: 12, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.571 Vali Acc: 0.844 Test Loss: 0.571 Test Acc: 0.844
Validation loss decreased (-0.826581 --> -0.843925).  Saving model ...
Epoch: 13 cost time: 2.977004051208496
Epoch: 13, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.736 Vali Acc: 0.838 Test Loss: 0.736 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.2020387649536133
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.161 Vali Acc: 0.769 Test Loss: 1.161 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 3.0736894607543945
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.399 Vali Acc: 0.688 Test Loss: 1.399 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.8153207302093506
Epoch: 16, Steps: 17 | Train Loss: 0.450 Vali Loss: 1.284 Vali Acc: 0.786 Test Loss: 1.284 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 3.0440380573272705
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.206 Vali Acc: 0.821 Test Loss: 1.206 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 3.137528657913208
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.193 Vali Acc: 0.786 Test Loss: 1.193 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 3.1266603469848633
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.368 Vali Acc: 0.803 Test Loss: 1.368 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0517735481262207
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.695 Vali Acc: 0.786 Test Loss: 1.695 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 3.0207715034484863
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.344 Vali Acc: 0.792 Test Loss: 1.344 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.999033212661743
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.526 Vali Acc: 0.792 Test Loss: 1.526 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3307327
model size : 17.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.970340728759766
Epoch: 1, Steps: 17 | Train Loss: 1.807 Vali Loss: 1.402 Vali Acc: 0.370 Test Loss: 1.402 Test Acc: 0.370
Validation loss decreased (inf --> -0.369928).  Saving model ...
Epoch: 2 cost time: 3.0438716411590576
Epoch: 2, Steps: 17 | Train Loss: 1.149 Vali Loss: 1.059 Vali Acc: 0.555 Test Loss: 1.059 Test Acc: 0.555
Validation loss decreased (-0.369928 --> -0.554903).  Saving model ...
Epoch: 3 cost time: 3.013770818710327
Epoch: 3, Steps: 17 | Train Loss: 0.900 Vali Loss: 0.860 Vali Acc: 0.676 Test Loss: 0.860 Test Acc: 0.676
Validation loss decreased (-0.554903 --> -0.676292).  Saving model ...
Epoch: 4 cost time: 2.8324315547943115
Epoch: 4, Steps: 17 | Train Loss: 0.550 Vali Loss: 0.820 Vali Acc: 0.717 Test Loss: 0.820 Test Acc: 0.717
Validation loss decreased (-0.676292 --> -0.716755).  Saving model ...
Epoch: 5 cost time: 2.9896080493927
Epoch: 5, Steps: 17 | Train Loss: 0.386 Vali Loss: 0.754 Vali Acc: 0.763 Test Loss: 0.754 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.762998).  Saving model ...
Epoch: 6 cost time: 2.8352389335632324
Epoch: 6, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.947 Vali Acc: 0.723 Test Loss: 0.947 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9080917835235596
Epoch: 7, Steps: 17 | Train Loss: 0.596 Vali Loss: 0.866 Vali Acc: 0.728 Test Loss: 0.866 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.7732958793640137
Epoch: 8, Steps: 17 | Train Loss: 0.385 Vali Loss: 0.926 Vali Acc: 0.728 Test Loss: 0.926 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.679064989089966
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.661 Vali Acc: 0.827 Test Loss: 0.661 Test Acc: 0.827
Validation loss decreased (-0.762998 --> -0.826583).  Saving model ...
Epoch: 10 cost time: 2.8308825492858887
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.226 Vali Acc: 0.630 Test Loss: 1.226 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0011348724365234
Epoch: 11, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.185 Vali Acc: 0.728 Test Loss: 1.185 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6127984523773193
Epoch: 12, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.887 Vali Acc: 0.809 Test Loss: 0.887 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.934053659439087
Epoch: 13, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.776 Vali Acc: 0.827 Test Loss: 0.776 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.365368127822876
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.220 Vali Acc: 0.792 Test Loss: 1.220 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.679300546646118
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.894 Vali Acc: 0.821 Test Loss: 0.894 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.7509477138519287
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.725 Vali Acc: 0.780 Test Loss: 1.725 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.983322858810425
Epoch: 17, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.936 Vali Acc: 0.757 Test Loss: 1.936 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.023164749145508
Epoch: 18, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.856 Vali Acc: 0.717 Test Loss: 1.856 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.9399898052215576
Epoch: 19, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.378 Vali Acc: 0.775 Test Loss: 1.378 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3307327
model size : 17.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.413859128952026
Epoch: 1, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.505 Vali Acc: 0.358 Test Loss: 1.505 Test Acc: 0.358
Validation loss decreased (inf --> -0.358366).  Saving model ...
Epoch: 2 cost time: 2.7118945121765137
Epoch: 2, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.123 Vali Acc: 0.520 Test Loss: 1.123 Test Acc: 0.520
Validation loss decreased (-0.358366 --> -0.520220).  Saving model ...
Epoch: 3 cost time: 3.0092267990112305
Epoch: 3, Steps: 17 | Train Loss: 0.699 Vali Loss: 0.723 Vali Acc: 0.740 Test Loss: 0.723 Test Acc: 0.740
Validation loss decreased (-0.520220 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 3.030583143234253
Epoch: 4, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.756 Vali Acc: 0.746 Test Loss: 0.756 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 2.9597532749176025
Epoch: 5, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.814 Vali Acc: 0.734 Test Loss: 0.814 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.1195895671844482
Epoch: 6, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.887 Vali Acc: 0.751 Test Loss: 0.887 Test Acc: 0.751
Validation loss decreased (-0.745657 --> -0.751436).  Saving model ...
Epoch: 7 cost time: 2.6143126487731934
Epoch: 7, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
Validation loss decreased (-0.751436 --> -0.838144).  Saving model ...
Epoch: 8 cost time: 2.6936914920806885
Epoch: 8, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.294 Vali Acc: 0.705 Test Loss: 1.294 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7601945400238037
Epoch: 9, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.874 Vali Acc: 0.786 Test Loss: 0.874 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.7793047428131104
Epoch: 10, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.557 Vali Acc: 0.861 Test Loss: 0.557 Test Acc: 0.861
Validation loss decreased (-0.838144 --> -0.861266).  Saving model ...
Epoch: 11 cost time: 2.63312029838562
Epoch: 11, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.717 Vali Acc: 0.844 Test Loss: 0.717 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8590292930603027
Epoch: 12, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.588 Vali Acc: 0.844 Test Loss: 0.588 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7789599895477295
Epoch: 13, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.827 Test Loss: 0.596 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.8096413612365723
Epoch: 14, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.753 Vali Acc: 0.821 Test Loss: 0.753 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.837473154067993
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.655 Vali Acc: 0.850 Test Loss: 0.655 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.867201805114746
Epoch: 16, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.668 Vali Acc: 0.815 Test Loss: 0.668 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.870976686477661
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.888014078140259
Epoch: 18, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.709 Vali Acc: 0.844 Test Loss: 0.709 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.9684553146362305
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.040 Vali Acc: 0.821 Test Loss: 1.040 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7570037841796875
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 2.433 Vali Acc: 0.728 Test Loss: 2.433 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 2783039
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.276695728302002
Epoch: 1, Steps: 17 | Train Loss: 1.808 Vali Loss: 1.520 Vali Acc: 0.353 Test Loss: 1.520 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 2.793698787689209
Epoch: 2, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.125 Vali Acc: 0.514 Test Loss: 1.125 Test Acc: 0.514
Validation loss decreased (-0.352586 --> -0.514440).  Saving model ...
Epoch: 3 cost time: 2.9418954849243164
Epoch: 3, Steps: 17 | Train Loss: 0.723 Vali Loss: 0.728 Vali Acc: 0.728 Test Loss: 0.728 Test Acc: 0.728
Validation loss decreased (-0.514440 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.6431984901428223
Epoch: 4, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.804 Vali Acc: 0.769 Test Loss: 0.804 Test Acc: 0.769
Validation loss decreased (-0.728316 --> -0.768778).  Saving model ...
Epoch: 5 cost time: 2.6994152069091797
Epoch: 5, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.758 Vali Acc: 0.746 Test Loss: 0.758 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.615821599960327
Epoch: 6, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.878 Vali Acc: 0.728 Test Loss: 0.878 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8667404651641846
Epoch: 7, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.884 Vali Acc: 0.769 Test Loss: 0.884 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7650668621063232
Epoch: 8, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.877 Vali Acc: 0.751 Test Loss: 0.877 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9090447425842285
Epoch: 9, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.671 Vali Acc: 0.832 Test Loss: 0.671 Test Acc: 0.832
Validation loss decreased (-0.768778 --> -0.832363).  Saving model ...
Epoch: 10 cost time: 2.685758352279663
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8193395137786865
Epoch: 11, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.781 Vali Acc: 0.803 Test Loss: 0.781 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.9648163318634033
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.654 Vali Acc: 0.815 Test Loss: 0.654 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.0175986289978027
Epoch: 13, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.857 Vali Acc: 0.803 Test Loss: 0.857 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.8733160495758057
Epoch: 14, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.910 Vali Acc: 0.775 Test Loss: 0.910 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.034538984298706
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.075 Vali Acc: 0.809 Test Loss: 1.075 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.039806365966797
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.693 Vali Acc: 0.832 Test Loss: 0.693 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.964759588241577
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.765 Vali Acc: 0.855 Test Loss: 0.765 Test Acc: 0.855
Validation loss decreased (-0.832363 --> -0.855484).  Saving model ...
Epoch: 18 cost time: 2.9316601753234863
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.749 Vali Acc: 0.838 Test Loss: 0.749 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.851163625717163
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 2.343 Vali Acc: 0.711 Test Loss: 2.343 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.958505392074585
Epoch: 20, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.895 Vali Acc: 0.763 Test Loss: 1.895 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.2496893405914307
Epoch: 21, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.907 Vali Acc: 0.867 Test Loss: 0.907 Test Acc: 0.867
Validation loss decreased (-0.855484 --> -0.867043).  Saving model ...
Epoch: 22 cost time: 3.2455952167510986
Epoch: 22, Steps: 17 | Train Loss: 0.184 Vali Loss: 2.790 Vali Acc: 0.780 Test Loss: 2.790 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.004237651824951
Epoch: 23, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.451 Vali Acc: 0.821 Test Loss: 1.451 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.860905170440674
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.744 Vali Acc: 0.803 Test Loss: 1.744 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 3.3592946529388428
Epoch: 25, Steps: 17 | Train Loss: 0.199 Vali Loss: 2.244 Vali Acc: 0.815 Test Loss: 2.244 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 3.060779333114624
Epoch: 26, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.131 Vali Acc: 0.792 Test Loss: 2.131 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.9362449645996094
Epoch: 27, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.689 Vali Acc: 0.798 Test Loss: 2.689 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 3.3772547245025635
Epoch: 28, Steps: 17 | Train Loss: 0.117 Vali Loss: 2.964 Vali Acc: 0.786 Test Loss: 2.964 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 3.145245313644409
Epoch: 29, Steps: 17 | Train Loss: 0.243 Vali Loss: 5.543 Vali Acc: 0.694 Test Loss: 5.543 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.2701468467712402
Epoch: 30, Steps: 17 | Train Loss: 0.498 Vali Loss: 1.952 Vali Acc: 0.838 Test Loss: 1.952 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 3.368149995803833
Epoch: 31, Steps: 17 | Train Loss: 0.150 Vali Loss: 3.765 Vali Acc: 0.751 Test Loss: 3.765 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2783039
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.9812912940979
Epoch: 1, Steps: 17 | Train Loss: 1.809 Vali Loss: 1.504 Vali Acc: 0.353 Test Loss: 1.504 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 2.6677134037017822
Epoch: 2, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.109 Vali Acc: 0.503 Test Loss: 1.109 Test Acc: 0.503
Validation loss decreased (-0.352586 --> -0.502879).  Saving model ...
Epoch: 3 cost time: 2.685817003250122
Epoch: 3, Steps: 17 | Train Loss: 0.783 Vali Loss: 0.722 Vali Acc: 0.763 Test Loss: 0.722 Test Acc: 0.763
Validation loss decreased (-0.502879 --> -0.762999).  Saving model ...
Epoch: 4 cost time: 2.715593099594116
Epoch: 4, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.721 Vali Acc: 0.740 Test Loss: 0.721 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7121987342834473
Epoch: 5, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.813 Vali Acc: 0.751 Test Loss: 0.813 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.965933084487915
Epoch: 6, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.089 Vali Acc: 0.694 Test Loss: 1.089 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 3.140801429748535
Epoch: 7, Steps: 17 | Train Loss: 0.159 Vali Loss: 1.466 Vali Acc: 0.717 Test Loss: 1.466 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.0116283893585205
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.977 Vali Acc: 0.734 Test Loss: 0.977 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 3.3666372299194336
Epoch: 9, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.944 Vali Acc: 0.832 Test Loss: 0.944 Test Acc: 0.832
Validation loss decreased (-0.762999 --> -0.832361).  Saving model ...
Epoch: 10 cost time: 3.124635934829712
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 1.231 Vali Acc: 0.780 Test Loss: 1.231 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.006225824356079
Epoch: 11, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.754 Vali Acc: 0.769 Test Loss: 0.754 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.028545618057251
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.171 Vali Acc: 0.763 Test Loss: 1.171 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 3.3545143604278564
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.429 Vali Acc: 0.723 Test Loss: 2.429 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 3.3801205158233643
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.106 Vali Acc: 0.786 Test Loss: 1.106 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 3.693054676055908
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.848 Vali Acc: 0.734 Test Loss: 1.848 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 3.6035776138305664
Epoch: 16, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.419 Vali Acc: 0.809 Test Loss: 1.419 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 3.109070062637329
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.893 Vali Acc: 0.798 Test Loss: 1.893 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 3.622230291366577
Epoch: 18, Steps: 17 | Train Loss: 0.259 Vali Loss: 1.975 Vali Acc: 0.798 Test Loss: 1.975 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 3.5592775344848633
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 2.050 Vali Acc: 0.751 Test Loss: 2.050 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2783039
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.467960357666016
Epoch: 1, Steps: 17 | Train Loss: 1.825 Vali Loss: 1.529 Vali Acc: 0.353 Test Loss: 1.529 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 3.0863184928894043
Epoch: 2, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.118 Vali Acc: 0.497 Test Loss: 1.118 Test Acc: 0.497
Validation loss decreased (-0.352586 --> -0.497099).  Saving model ...
Epoch: 3 cost time: 2.7427127361297607
Epoch: 3, Steps: 17 | Train Loss: 0.861 Vali Loss: 0.786 Vali Acc: 0.705 Test Loss: 0.786 Test Acc: 0.705
Validation loss decreased (-0.497099 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 2.838183879852295
Epoch: 4, Steps: 17 | Train Loss: 0.553 Vali Loss: 0.789 Vali Acc: 0.728 Test Loss: 0.789 Test Acc: 0.728
Validation loss decreased (-0.705194 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 2.412576675415039
Epoch: 5, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.895 Vali Acc: 0.711 Test Loss: 0.895 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6361541748046875
Epoch: 6, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.842 Vali Acc: 0.636 Test Loss: 0.842 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.695768356323242
Epoch: 7, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.759 Vali Acc: 0.757 Test Loss: 0.759 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.6713669300079346
Epoch: 8, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.851 Vali Acc: 0.717 Test Loss: 0.851 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.661261796951294
Epoch: 9, Steps: 17 | Train Loss: 0.354 Vali Loss: 1.825 Vali Acc: 0.578 Test Loss: 1.825 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.756864547729492
Epoch: 10, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.719 Vali Acc: 0.786 Test Loss: 0.719 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786120).  Saving model ...
Epoch: 11 cost time: 2.755974054336548
Epoch: 11, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
Validation loss decreased (-0.786120 --> -0.809241).  Saving model ...
Epoch: 12 cost time: 2.620521306991577
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.089 Vali Acc: 0.751 Test Loss: 1.089 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9432320594787598
Epoch: 13, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.816 Vali Acc: 0.786 Test Loss: 1.816 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.754648447036743
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.111 Vali Acc: 0.694 Test Loss: 1.111 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6167314052581787
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.066 Vali Acc: 0.798 Test Loss: 1.066 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.64665150642395
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 2.229 Vali Acc: 0.775 Test Loss: 2.229 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6868231296539307
Epoch: 17, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.538 Vali Acc: 0.780 Test Loss: 1.538 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9639859199523926
Epoch: 18, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.667 Vali Acc: 0.809 Test Loss: 1.667 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.614105224609375
Epoch: 19, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.043 Vali Acc: 0.798 Test Loss: 1.043 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.6100900173187256
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.295 Vali Acc: 0.815 Test Loss: 1.295 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815016).  Saving model ...
Epoch: 21 cost time: 2.7945241928100586
Epoch: 21, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.758 Vali Acc: 0.803 Test Loss: 1.758 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.874746561050415
Epoch: 22, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.549 Vali Acc: 0.775 Test Loss: 1.549 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.9230551719665527
Epoch: 23, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.579 Vali Acc: 0.763 Test Loss: 1.579 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.045229196548462
Epoch: 24, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.720 Vali Acc: 0.809 Test Loss: 1.720 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 3.12139892578125
Epoch: 25, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.548 Vali Acc: 0.746 Test Loss: 2.548 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 3.0288853645324707
Epoch: 26, Steps: 17 | Train Loss: 0.198 Vali Loss: 2.155 Vali Acc: 0.757 Test Loss: 2.155 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.855689764022827
Epoch: 27, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.943 Vali Acc: 0.740 Test Loss: 2.943 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 3.3592660427093506
Epoch: 28, Steps: 17 | Train Loss: 0.229 Vali Loss: 2.841 Vali Acc: 0.763 Test Loss: 2.841 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6668550968170166
Epoch: 29, Steps: 17 | Train Loss: 0.270 Vali Loss: 2.706 Vali Acc: 0.746 Test Loss: 2.706 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 3.1578516960144043
Epoch: 30, Steps: 17 | Train Loss: 0.495 Vali Loss: 3.967 Vali Acc: 0.780 Test Loss: 3.967 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2783039
model size : 15.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.7878782749176025
Epoch: 1, Steps: 17 | Train Loss: 1.738 Vali Loss: 1.404 Vali Acc: 0.376 Test Loss: 1.404 Test Acc: 0.376
Validation loss decreased (inf --> -0.375709).  Saving model ...
Epoch: 2 cost time: 3.2549026012420654
Epoch: 2, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.117 Vali Acc: 0.636 Test Loss: 1.117 Test Acc: 0.636
Validation loss decreased (-0.375709 --> -0.635827).  Saving model ...
Epoch: 3 cost time: 2.5253424644470215
Epoch: 3, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.121 Vali Acc: 0.480 Test Loss: 1.121 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.7278239727020264
Epoch: 4, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.658 Vali Acc: 0.723 Test Loss: 0.658 Test Acc: 0.723
Validation loss decreased (-0.635827 --> -0.722537).  Saving model ...
Epoch: 5 cost time: 2.972428798675537
Epoch: 5, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
Validation loss decreased (-0.722537 --> -0.797681).  Saving model ...
Epoch: 6 cost time: 3.0007221698760986
Epoch: 6, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.466 Vali Acc: 0.803 Test Loss: 0.466 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803464).  Saving model ...
Epoch: 7 cost time: 2.9560365676879883
Epoch: 7, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.620 Vali Acc: 0.803 Test Loss: 0.620 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.911505937576294
Epoch: 8, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.717 Vali Acc: 0.803 Test Loss: 0.717 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.984272003173828
Epoch: 9, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.744 Vali Acc: 0.798 Test Loss: 0.744 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.964871406555176
Epoch: 10, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.536 Vali Acc: 0.850 Test Loss: 0.536 Test Acc: 0.850
Validation loss decreased (-0.803464 --> -0.849706).  Saving model ...
Epoch: 11 cost time: 2.8480703830718994
Epoch: 11, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.674 Vali Acc: 0.809 Test Loss: 0.674 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.936870574951172
Epoch: 12, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.867 Vali Acc: 0.821 Test Loss: 0.867 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.994319438934326
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.860 Vali Acc: 0.798 Test Loss: 0.860 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.1305480003356934
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.832 Test Loss: 0.718 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7696430683135986
Epoch: 15, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.681 Vali Acc: 0.855 Test Loss: 0.681 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855485).  Saving model ...
Epoch: 16 cost time: 2.930896043777466
Epoch: 16, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.149829149246216
Epoch: 17, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.600 Vali Acc: 0.832 Test Loss: 0.600 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9708669185638428
Epoch: 18, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.624 Vali Acc: 0.821 Test Loss: 0.624 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.597285032272339
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.604 Vali Acc: 0.821 Test Loss: 0.604 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.6686413288116455
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9832522869110107
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.635 Vali Acc: 0.809 Test Loss: 0.635 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.8931236267089844
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.642 Vali Acc: 0.809 Test Loss: 0.642 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9585494995117188
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.658 Vali Acc: 0.809 Test Loss: 0.658 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.8321056365966797
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.809 Test Loss: 0.654 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.9917945861816406
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.657 Vali Acc: 0.809 Test Loss: 0.657 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2520895
model size : 14.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.454238176345825
Epoch: 1, Steps: 17 | Train Loss: 1.742 Vali Loss: 1.421 Vali Acc: 0.410 Test Loss: 1.421 Test Acc: 0.410
Validation loss decreased (inf --> -0.410390).  Saving model ...
Epoch: 2 cost time: 2.4264426231384277
Epoch: 2, Steps: 17 | Train Loss: 1.075 Vali Loss: 1.164 Vali Acc: 0.590 Test Loss: 1.164 Test Acc: 0.590
Validation loss decreased (-0.410390 --> -0.589584).  Saving model ...
Epoch: 3 cost time: 2.859947919845581
Epoch: 3, Steps: 17 | Train Loss: 0.687 Vali Loss: 1.145 Vali Acc: 0.462 Test Loss: 1.145 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9133830070495605
Epoch: 4, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.649 Vali Acc: 0.740 Test Loss: 0.649 Test Acc: 0.740
Validation loss decreased (-0.589584 --> -0.739878).  Saving model ...
Epoch: 5 cost time: 2.2577695846557617
Epoch: 5, Steps: 17 | Train Loss: 0.293 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
Validation loss decreased (-0.739878 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 2.5954012870788574
Epoch: 6, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.524 Vali Acc: 0.803 Test Loss: 0.524 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803463).  Saving model ...
Epoch: 7 cost time: 2.4453420639038086
Epoch: 7, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.694 Vali Acc: 0.763 Test Loss: 0.694 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.505206823348999
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.627 Vali Acc: 0.821 Test Loss: 0.627 Test Acc: 0.821
Validation loss decreased (-0.803463 --> -0.820803).  Saving model ...
Epoch: 9 cost time: 2.500581979751587
Epoch: 9, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 2.380767583847046
Epoch: 10, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.477 Vali Acc: 0.855 Test Loss: 0.477 Test Acc: 0.855
Validation loss decreased (-0.826584 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 2.276952028274536
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.789 Vali Acc: 0.803 Test Loss: 0.789 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2305784225463867
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.684 Vali Acc: 0.809 Test Loss: 0.684 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.827967405319214
Epoch: 13, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.699 Vali Acc: 0.786 Test Loss: 1.699 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.4102303981781006
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.775 Vali Acc: 0.815 Test Loss: 0.775 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5418708324432373
Epoch: 15, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.350 Vali Acc: 0.780 Test Loss: 1.350 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.55649471282959
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.514 Vali Acc: 0.815 Test Loss: 1.514 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.9372148513793945
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.313 Vali Acc: 0.734 Test Loss: 1.313 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.7798027992248535
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 2.278 Vali Acc: 0.769 Test Loss: 2.278 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7027699947357178
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.255 Vali Acc: 0.821 Test Loss: 1.255 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.39977765083313
Epoch: 20, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.178 Vali Acc: 0.879 Test Loss: 1.178 Test Acc: 0.879
Validation loss decreased (-0.855487 --> -0.878601).  Saving model ...
Epoch: 21 cost time: 2.454392194747925
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.559 Vali Acc: 0.815 Test Loss: 1.559 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.814378023147583
Epoch: 22, Steps: 17 | Train Loss: 0.086 Vali Loss: 2.367 Vali Acc: 0.757 Test Loss: 2.367 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.7526512145996094
Epoch: 23, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.397 Vali Acc: 0.827 Test Loss: 1.397 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5709927082061768
Epoch: 24, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.696 Vali Acc: 0.821 Test Loss: 1.696 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.3053336143493652
Epoch: 25, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.299 Vali Acc: 0.832 Test Loss: 1.299 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.677299976348877
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.419 Vali Acc: 0.832 Test Loss: 1.419 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.769681453704834
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.644 Vali Acc: 0.827 Test Loss: 1.644 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.1972410678863525
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.731 Vali Acc: 0.821 Test Loss: 1.731 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.6044301986694336
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.701 Vali Acc: 0.815 Test Loss: 1.701 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.3334691524505615
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.674 Vali Acc: 0.815 Test Loss: 1.674 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 2520895
model size : 14.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.299309492111206
Epoch: 1, Steps: 17 | Train Loss: 1.733 Vali Loss: 1.430 Vali Acc: 0.347 Test Loss: 1.430 Test Acc: 0.347
Validation loss decreased (inf --> -0.346807).  Saving model ...
Epoch: 2 cost time: 2.7740817070007324
Epoch: 2, Steps: 17 | Train Loss: 1.087 Vali Loss: 1.134 Vali Acc: 0.566 Test Loss: 1.134 Test Acc: 0.566
Validation loss decreased (-0.346807 --> -0.566463).  Saving model ...
Epoch: 3 cost time: 2.701679229736328
Epoch: 3, Steps: 17 | Train Loss: 0.698 Vali Loss: 1.166 Vali Acc: 0.480 Test Loss: 1.166 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.962151288986206
Epoch: 4, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.632 Vali Acc: 0.786 Test Loss: 0.632 Test Acc: 0.786
Validation loss decreased (-0.566463 --> -0.786121).  Saving model ...
Epoch: 5 cost time: 2.8292410373687744
Epoch: 5, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.563 Vali Acc: 0.815 Test Loss: 0.563 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815023).  Saving model ...
Epoch: 6 cost time: 2.6646862030029297
Epoch: 6, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.727 Vali Acc: 0.780 Test Loss: 0.727 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7081491947174072
Epoch: 7, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5542001724243164
Epoch: 8, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.924 Vali Acc: 0.769 Test Loss: 0.924 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.996965169906616
Epoch: 9, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.749 Vali Acc: 0.780 Test Loss: 0.749 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.0620334148406982
Epoch: 10, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.766 Vali Acc: 0.809 Test Loss: 0.766 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.008241653442383
Epoch: 11, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.802 Vali Acc: 0.827 Test Loss: 0.802 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826582).  Saving model ...
Epoch: 12 cost time: 2.8494248390197754
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.808 Vali Acc: 0.821 Test Loss: 0.808 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.158454418182373
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.185 Vali Acc: 0.792 Test Loss: 1.185 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 3.092055320739746
Epoch: 14, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.022 Vali Acc: 0.798 Test Loss: 1.022 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.013301134109497
Epoch: 15, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.663 Vali Acc: 0.821 Test Loss: 1.663 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8968393802642822
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.444 Vali Acc: 0.757 Test Loss: 1.444 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.9580538272857666
Epoch: 17, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.374 Vali Acc: 0.746 Test Loss: 1.374 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8350887298583984
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 2.929 Vali Acc: 0.671 Test Loss: 2.929 Test Acc: 0.671
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.782985210418701
Epoch: 19, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.940 Vali Acc: 0.630 Test Loss: 1.940 Test Acc: 0.630
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.5660884380340576
Epoch: 20, Steps: 17 | Train Loss: 0.195 Vali Loss: 3.231 Vali Acc: 0.694 Test Loss: 3.231 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.069434404373169
Epoch: 21, Steps: 17 | Train Loss: 0.187 Vali Loss: 2.108 Vali Acc: 0.711 Test Loss: 2.108 Test Acc: 0.711
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2520895
model size : 14.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.038341522216797
Epoch: 1, Steps: 17 | Train Loss: 1.764 Vali Loss: 1.532 Vali Acc: 0.393 Test Loss: 1.532 Test Acc: 0.393
Validation loss decreased (inf --> -0.393048).  Saving model ...
Epoch: 2 cost time: 2.6488919258117676
Epoch: 2, Steps: 17 | Train Loss: 1.207 Vali Loss: 1.316 Vali Acc: 0.480 Test Loss: 1.316 Test Acc: 0.480
Validation loss decreased (-0.393048 --> -0.479756).  Saving model ...
Epoch: 3 cost time: 2.792555332183838
Epoch: 3, Steps: 17 | Train Loss: 0.800 Vali Loss: 1.138 Vali Acc: 0.526 Test Loss: 1.138 Test Acc: 0.526
Validation loss decreased (-0.479756 --> -0.526000).  Saving model ...
Epoch: 4 cost time: 2.760406255722046
Epoch: 4, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.700 Vali Acc: 0.751 Test Loss: 0.700 Test Acc: 0.751
Validation loss decreased (-0.526000 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 2.755650043487549
Epoch: 5, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.719 Vali Acc: 0.734 Test Loss: 0.719 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.704615592956543
Epoch: 6, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.616 Vali Acc: 0.780 Test Loss: 0.616 Test Acc: 0.780
Validation loss decreased (-0.751438 --> -0.780341).  Saving model ...
Epoch: 7 cost time: 3.06359601020813
Epoch: 7, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.689 Vali Acc: 0.803 Test Loss: 0.689 Test Acc: 0.803
Validation loss decreased (-0.780341 --> -0.803461).  Saving model ...
Epoch: 8 cost time: 2.949906826019287
Epoch: 8, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.738 Vali Acc: 0.792 Test Loss: 0.738 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.772521495819092
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.019 Vali Acc: 0.763 Test Loss: 1.019 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.818572759628296
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.673 Vali Acc: 0.821 Test Loss: 0.673 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820803).  Saving model ...
Epoch: 11 cost time: 2.8945634365081787
Epoch: 11, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.283 Vali Acc: 0.751 Test Loss: 1.283 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.689197063446045
Epoch: 12, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.048 Vali Acc: 0.786 Test Loss: 1.048 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.793458938598633
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.312 Vali Acc: 0.827 Test Loss: 1.312 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826576).  Saving model ...
Epoch: 14 cost time: 2.735159158706665
Epoch: 14, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.124 Vali Acc: 0.780 Test Loss: 1.124 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7935831546783447
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.037 Vali Acc: 0.809 Test Loss: 1.037 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8406713008880615
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 2.541 Vali Acc: 0.751 Test Loss: 2.541 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.752521514892578
Epoch: 17, Steps: 17 | Train Loss: 0.304 Vali Loss: 1.385 Vali Acc: 0.780 Test Loss: 1.385 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.817429304122925
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 2.301 Vali Acc: 0.740 Test Loss: 2.301 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7326738834381104
Epoch: 19, Steps: 17 | Train Loss: 0.210 Vali Loss: 1.309 Vali Acc: 0.757 Test Loss: 1.309 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7484071254730225
Epoch: 20, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.297 Vali Acc: 0.792 Test Loss: 1.297 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.7528676986694336
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.298 Vali Acc: 0.763 Test Loss: 1.298 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.767672538757324
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.927 Vali Acc: 0.688 Test Loss: 1.927 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.033719778060913
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 1.851 Vali Acc: 0.746 Test Loss: 1.851 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2520895
model size : 14.52MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.7073071002960205
Epoch: 1, Steps: 17 | Train Loss: 1.806 Vali Loss: 1.379 Vali Acc: 0.480 Test Loss: 1.379 Test Acc: 0.480
Validation loss decreased (inf --> -0.479755).  Saving model ...
Epoch: 2 cost time: 3.079967737197876
Epoch: 2, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.015 Vali Acc: 0.532 Test Loss: 1.015 Test Acc: 0.532
Validation loss decreased (-0.479755 --> -0.531782).  Saving model ...
Epoch: 3 cost time: 2.9472975730895996
Epoch: 3, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.701 Vali Acc: 0.734 Test Loss: 0.701 Test Acc: 0.734
Validation loss decreased (-0.531782 --> -0.734097).  Saving model ...
Epoch: 4 cost time: 3.5489399433135986
Epoch: 4, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.846 Vali Acc: 0.676 Test Loss: 0.846 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.2486610412597656
Epoch: 5, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.777 Vali Acc: 0.775 Test Loss: 0.777 Test Acc: 0.775
Validation loss decreased (-0.734097 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 3.250572443008423
Epoch: 6, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.773 Vali Acc: 0.728 Test Loss: 0.773 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.3421688079833984
Epoch: 7, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.499 Vali Acc: 0.827 Test Loss: 0.499 Test Acc: 0.827
Validation loss decreased (-0.774559 --> -0.826585).  Saving model ...
Epoch: 8 cost time: 2.7894723415374756
Epoch: 8, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.86468505859375
Epoch: 9, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.738 Vali Acc: 0.832 Test Loss: 0.738 Test Acc: 0.832
Validation loss decreased (-0.826585 --> -0.832363).  Saving model ...
Epoch: 10 cost time: 2.7044830322265625
Epoch: 10, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.547 Vali Acc: 0.855 Test Loss: 0.547 Test Acc: 0.855
Validation loss decreased (-0.832363 --> -0.855486).  Saving model ...
Epoch: 11 cost time: 2.6172521114349365
Epoch: 11, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.581 Vali Acc: 0.832 Test Loss: 0.581 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.2230162620544434
Epoch: 12, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.697 Vali Acc: 0.855 Test Loss: 0.697 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8534951210021973
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.540 Vali Acc: 0.844 Test Loss: 0.540 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9682512283325195
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.790 Vali Acc: 0.821 Test Loss: 0.790 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8974554538726807
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.966 Vali Acc: 0.792 Test Loss: 0.966 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.948202610015869
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.268 Vali Acc: 0.792 Test Loss: 1.268 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 3.011593818664551
Epoch: 17, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.123 Vali Acc: 0.786 Test Loss: 1.123 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.726346492767334
Epoch: 18, Steps: 17 | Train Loss: 0.179 Vali Loss: 2.502 Vali Acc: 0.740 Test Loss: 2.502 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.907792329788208
Epoch: 19, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.810 Vali Acc: 0.751 Test Loss: 1.810 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.131631374359131
Epoch: 20, Steps: 17 | Train Loss: 0.351 Vali Loss: 1.943 Vali Acc: 0.751 Test Loss: 1.943 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2389823
model size : 14.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.141078233718872
Epoch: 1, Steps: 17 | Train Loss: 1.813 Vali Loss: 1.381 Vali Acc: 0.509 Test Loss: 1.381 Test Acc: 0.509
Validation loss decreased (inf --> -0.508657).  Saving model ...
Epoch: 2 cost time: 2.9691059589385986
Epoch: 2, Steps: 17 | Train Loss: 1.102 Vali Loss: 1.047 Vali Acc: 0.549 Test Loss: 1.047 Test Acc: 0.549
Validation loss decreased (-0.508657 --> -0.549122).  Saving model ...
Epoch: 3 cost time: 2.9765360355377197
Epoch: 3, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.724 Vali Acc: 0.723 Test Loss: 0.724 Test Acc: 0.723
Validation loss decreased (-0.549122 --> -0.722536).  Saving model ...
Epoch: 4 cost time: 3.1753084659576416
Epoch: 4, Steps: 17 | Train Loss: 0.471 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.936405897140503
Epoch: 5, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.588 Vali Acc: 0.827 Test Loss: 0.588 Test Acc: 0.827
Validation loss decreased (-0.722536 --> -0.826584).  Saving model ...
Epoch: 6 cost time: 2.9248647689819336
Epoch: 6, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.617 Vali Acc: 0.798 Test Loss: 0.617 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.184058904647827
Epoch: 7, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.794 Vali Acc: 0.728 Test Loss: 0.794 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.821584939956665
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.786 Vali Acc: 0.792 Test Loss: 0.786 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.9190237522125244
Epoch: 9, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.676 Vali Acc: 0.827 Test Loss: 0.676 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.18037486076355
Epoch: 10, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.022 Vali Acc: 0.798 Test Loss: 1.022 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.2138726711273193
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.958 Vali Acc: 0.769 Test Loss: 0.958 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 3.0990490913391113
Epoch: 12, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.925 Vali Acc: 0.815 Test Loss: 0.925 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 3.104397773742676
Epoch: 13, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.974 Vali Acc: 0.815 Test Loss: 0.974 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 3.0118513107299805
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.133 Vali Acc: 0.798 Test Loss: 1.133 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.051121711730957
Epoch: 15, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.774 Vali Acc: 0.850 Test Loss: 0.774 Test Acc: 0.850
Validation loss decreased (-0.826584 --> -0.849703).  Saving model ...
Epoch: 16 cost time: 3.294705629348755
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.777 Vali Acc: 0.809 Test Loss: 0.777 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.219482898712158
Epoch: 17, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.628 Vali Acc: 0.763 Test Loss: 1.628 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 3.1468698978424072
Epoch: 18, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.993 Vali Acc: 0.740 Test Loss: 2.993 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 3.10768461227417
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.143 Vali Acc: 0.821 Test Loss: 1.143 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.966315507888794
Epoch: 20, Steps: 17 | Train Loss: 0.373 Vali Loss: 1.858 Vali Acc: 0.792 Test Loss: 1.858 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.779865264892578
Epoch: 21, Steps: 17 | Train Loss: 0.054 Vali Loss: 2.249 Vali Acc: 0.769 Test Loss: 2.249 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.7769041061401367
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.809 Vali Acc: 0.780 Test Loss: 1.809 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.9223334789276123
Epoch: 23, Steps: 17 | Train Loss: 0.229 Vali Loss: 2.949 Vali Acc: 0.746 Test Loss: 2.949 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.946366548538208
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 2.573 Vali Acc: 0.769 Test Loss: 2.573 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.9206435680389404
Epoch: 25, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.919 Vali Acc: 0.786 Test Loss: 1.919 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2389823
model size : 14.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.214031219482422
Epoch: 1, Steps: 17 | Train Loss: 1.826 Vali Loss: 1.388 Vali Acc: 0.526 Test Loss: 1.388 Test Acc: 0.526
Validation loss decreased (inf --> -0.525998).  Saving model ...
Epoch: 2 cost time: 3.026665449142456
Epoch: 2, Steps: 17 | Train Loss: 1.123 Vali Loss: 1.050 Vali Acc: 0.532 Test Loss: 1.050 Test Acc: 0.532
Validation loss decreased (-0.525998 --> -0.531781).  Saving model ...
Epoch: 3 cost time: 2.839384078979492
Epoch: 3, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.755 Vali Acc: 0.711 Test Loss: 0.755 Test Acc: 0.711
Validation loss decreased (-0.531781 --> -0.710975).  Saving model ...
Epoch: 4 cost time: 2.767024040222168
Epoch: 4, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.965 Vali Acc: 0.630 Test Loss: 0.965 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.9210686683654785
Epoch: 5, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.818 Vali Acc: 0.734 Test Loss: 0.818 Test Acc: 0.734
Validation loss decreased (-0.710975 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 3.066676616668701
Epoch: 6, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.670 Vali Acc: 0.792 Test Loss: 0.670 Test Acc: 0.792
Validation loss decreased (-0.734096 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 2.854767322540283
Epoch: 7, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.909 Vali Acc: 0.711 Test Loss: 0.909 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.983232259750366
Epoch: 8, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.674 Vali Acc: 0.838 Test Loss: 0.674 Test Acc: 0.838
Validation loss decreased (-0.791901 --> -0.838144).  Saving model ...
Epoch: 9 cost time: 3.093315839767456
Epoch: 9, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.031 Vali Acc: 0.786 Test Loss: 1.031 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0081567764282227
Epoch: 10, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.647 Vali Acc: 0.792 Test Loss: 0.647 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.2270047664642334
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.046 Vali Acc: 0.769 Test Loss: 1.046 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 3.102315664291382
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.034 Vali Acc: 0.803 Test Loss: 1.034 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.1762049198150635
Epoch: 13, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.735 Vali Acc: 0.717 Test Loss: 1.735 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9169669151306152
Epoch: 14, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.781 Vali Acc: 0.792 Test Loss: 1.781 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 3.081265687942505
Epoch: 15, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.786 Vali Acc: 0.769 Test Loss: 1.786 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.9480466842651367
Epoch: 16, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.561 Vali Acc: 0.786 Test Loss: 1.561 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.909879446029663
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.063 Vali Acc: 0.751 Test Loss: 2.063 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 3.076812744140625
Epoch: 18, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.053 Vali Acc: 0.827 Test Loss: 1.053 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2389823
model size : 14.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.3142170906066895
Epoch: 1, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.408 Vali Acc: 0.486 Test Loss: 1.408 Test Acc: 0.486
Validation loss decreased (inf --> -0.485535).  Saving model ...
Epoch: 2 cost time: 2.962714672088623
Epoch: 2, Steps: 17 | Train Loss: 1.194 Vali Loss: 1.090 Vali Acc: 0.543 Test Loss: 1.090 Test Acc: 0.543
Validation loss decreased (-0.485535 --> -0.543342).  Saving model ...
Epoch: 3 cost time: 2.56658673286438
Epoch: 3, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.013 Vali Acc: 0.590 Test Loss: 1.013 Test Acc: 0.590
Validation loss decreased (-0.543342 --> -0.589585).  Saving model ...
Epoch: 4 cost time: 2.8482518196105957
Epoch: 4, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.904 Vali Acc: 0.688 Test Loss: 0.904 Test Acc: 0.688
Validation loss decreased (-0.589585 --> -0.687852).  Saving model ...
Epoch: 5 cost time: 2.915513515472412
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.856 Vali Acc: 0.630 Test Loss: 0.856 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 3.0123143196105957
Epoch: 6, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.602 Vali Acc: 0.827 Test Loss: 0.602 Test Acc: 0.827
Validation loss decreased (-0.687852 --> -0.826584).  Saving model ...
Epoch: 7 cost time: 2.8106114864349365
Epoch: 7, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.892 Vali Acc: 0.705 Test Loss: 0.892 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.2136709690093994
Epoch: 8, Steps: 17 | Train Loss: 0.234 Vali Loss: 0.855 Vali Acc: 0.792 Test Loss: 0.855 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 3.022650957107544
Epoch: 9, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.816 Vali Acc: 0.780 Test Loss: 0.816 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.059199094772339
Epoch: 10, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.731 Vali Acc: 0.827 Test Loss: 0.731 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.1902854442596436
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.392 Vali Acc: 0.740 Test Loss: 1.392 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 3.3005378246307373
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.974 Vali Acc: 0.694 Test Loss: 1.974 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 3.1304476261138916
Epoch: 13, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.954 Vali Acc: 0.832 Test Loss: 0.954 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832360).  Saving model ...
Epoch: 14 cost time: 2.873474597930908
Epoch: 14, Steps: 17 | Train Loss: 0.064 Vali Loss: 2.146 Vali Acc: 0.694 Test Loss: 2.146 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0240213871002197
Epoch: 15, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.348 Vali Acc: 0.757 Test Loss: 1.348 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.1202776432037354
Epoch: 16, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.835 Vali Acc: 0.734 Test Loss: 1.835 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.182222604751587
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.513 Vali Acc: 0.786 Test Loss: 1.513 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2219111919403076
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.592 Vali Acc: 0.780 Test Loss: 1.592 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 3.1223130226135254
Epoch: 19, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.379 Vali Acc: 0.798 Test Loss: 1.379 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 3.1394026279449463
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.922 Vali Acc: 0.705 Test Loss: 1.922 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.90254807472229
Epoch: 21, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.120 Vali Acc: 0.699 Test Loss: 2.120 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 3.029597043991089
Epoch: 22, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.654 Vali Acc: 0.798 Test Loss: 1.654 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 3.0216803550720215
Epoch: 23, Steps: 17 | Train Loss: 0.136 Vali Loss: 3.624 Vali Acc: 0.671 Test Loss: 3.624 Test Acc: 0.671
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2389823
model size : 14.02MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.791524648666382
Epoch: 1, Steps: 17 | Train Loss: 1.798 Vali Loss: 1.345 Vali Acc: 0.370 Test Loss: 1.345 Test Acc: 0.370
Validation loss decreased (inf --> -0.369929).  Saving model ...
Epoch: 2 cost time: 2.5672829151153564
Epoch: 2, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.018 Vali Acc: 0.618 Test Loss: 1.018 Test Acc: 0.618
Validation loss decreased (-0.369929 --> -0.618487).  Saving model ...
Epoch: 3 cost time: 2.628704309463501
Epoch: 3, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.660 Vali Acc: 0.792 Test Loss: 0.660 Test Acc: 0.792
Validation loss decreased (-0.618487 --> -0.791901).  Saving model ...
Epoch: 4 cost time: 2.691101551055908
Epoch: 4, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.624 Vali Acc: 0.786 Test Loss: 0.624 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.756307363510132
Epoch: 5, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.590 Vali Acc: 0.786 Test Loss: 0.590 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.6878468990325928
Epoch: 6, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.7136237621307373
Epoch: 7, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.864 Vali Acc: 0.723 Test Loss: 0.864 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.520918607711792
Epoch: 8, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.070 Vali Acc: 0.659 Test Loss: 1.070 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.890634059906006
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.675 Vali Acc: 0.844 Test Loss: 0.675 Test Acc: 0.844
Validation loss decreased (-0.791901 --> -0.843924).  Saving model ...
Epoch: 10 cost time: 2.8220739364624023
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.492 Vali Acc: 0.844 Test Loss: 0.492 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843926).  Saving model ...
Epoch: 11 cost time: 2.8346307277679443
Epoch: 11, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8045284748077393
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.699 Vali Acc: 0.838 Test Loss: 0.699 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6886801719665527
Epoch: 13, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.967 Vali Acc: 0.792 Test Loss: 0.967 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.745163917541504
Epoch: 14, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.748 Vali Acc: 0.827 Test Loss: 0.748 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.805065393447876
Epoch: 15, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.997 Vali Acc: 0.786 Test Loss: 0.997 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.879371166229248
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.371 Vali Acc: 0.763 Test Loss: 1.371 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.6520161628723145
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.073 Vali Acc: 0.792 Test Loss: 1.073 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.795464515686035
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.112 Vali Acc: 0.786 Test Loss: 1.112 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.6227993965148926
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.953 Vali Acc: 0.734 Test Loss: 1.953 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.6556034088134766
Epoch: 20, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.642 Vali Acc: 0.786 Test Loss: 1.642 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 2324287
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.837568759918213
Epoch: 1, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.360 Vali Acc: 0.376 Test Loss: 1.360 Test Acc: 0.376
Validation loss decreased (inf --> -0.375709).  Saving model ...
Epoch: 2 cost time: 2.4223525524139404
Epoch: 2, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.062 Vali Acc: 0.624 Test Loss: 1.062 Test Acc: 0.624
Validation loss decreased (-0.375709 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 2.512078046798706
Epoch: 3, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.671 Vali Acc: 0.786 Test Loss: 0.671 Test Acc: 0.786
Validation loss decreased (-0.624267 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 2.3364691734313965
Epoch: 4, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.626 Vali Acc: 0.786 Test Loss: 0.626 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786121).  Saving model ...
Epoch: 5 cost time: 2.7975404262542725
Epoch: 5, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.614 Vali Acc: 0.757 Test Loss: 0.614 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.773712635040283
Epoch: 6, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.636 Vali Acc: 0.792 Test Loss: 0.636 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 2.6760857105255127
Epoch: 7, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.677 Vali Acc: 0.798 Test Loss: 0.677 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 2.874030351638794
Epoch: 8, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.726 Vali Acc: 0.775 Test Loss: 0.726 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.788590669631958
Epoch: 9, Steps: 17 | Train Loss: 0.137 Vali Loss: 1.135 Vali Acc: 0.769 Test Loss: 1.135 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.8413493633270264
Epoch: 10, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.018 Vali Acc: 0.786 Test Loss: 1.018 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.944222927093506
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.131 Vali Acc: 0.809 Test Loss: 1.131 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809237).  Saving model ...
Epoch: 12 cost time: 2.79166316986084
Epoch: 12, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.184 Vali Acc: 0.815 Test Loss: 1.184 Test Acc: 0.815
Validation loss decreased (-0.809237 --> -0.815017).  Saving model ...
Epoch: 13 cost time: 2.7142317295074463
Epoch: 13, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.354 Vali Acc: 0.803 Test Loss: 1.354 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6638691425323486
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.055 Vali Acc: 0.792 Test Loss: 1.055 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5722358226776123
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.957 Vali Acc: 0.723 Test Loss: 1.957 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.695767879486084
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.029 Vali Acc: 0.809 Test Loss: 1.029 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.908181667327881
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.365 Vali Acc: 0.792 Test Loss: 1.365 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.960908889770508
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.599 Vali Acc: 0.792 Test Loss: 1.599 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.927157402038574
Epoch: 19, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.192 Vali Acc: 0.815 Test Loss: 1.192 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 3.0348610877990723
Epoch: 20, Steps: 17 | Train Loss: 0.168 Vali Loss: 2.007 Vali Acc: 0.746 Test Loss: 2.007 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.823235034942627
Epoch: 21, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.577 Vali Acc: 0.786 Test Loss: 1.577 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.533600330352783
Epoch: 22, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.686 Vali Acc: 0.798 Test Loss: 1.686 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2324287
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.358598947525024
Epoch: 1, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.367 Vali Acc: 0.376 Test Loss: 1.367 Test Acc: 0.376
Validation loss decreased (inf --> -0.375709).  Saving model ...
Epoch: 2 cost time: 2.861293077468872
Epoch: 2, Steps: 17 | Train Loss: 1.145 Vali Loss: 1.071 Vali Acc: 0.618 Test Loss: 1.071 Test Acc: 0.618
Validation loss decreased (-0.375709 --> -0.618486).  Saving model ...
Epoch: 3 cost time: 2.4850122928619385
Epoch: 3, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.678 Vali Acc: 0.786 Test Loss: 0.678 Test Acc: 0.786
Validation loss decreased (-0.618486 --> -0.786120).  Saving model ...
Epoch: 4 cost time: 2.640958547592163
Epoch: 4, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.618 Vali Acc: 0.769 Test Loss: 0.618 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6240434646606445
Epoch: 5, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.570 Vali Acc: 0.786 Test Loss: 0.570 Test Acc: 0.786
Validation loss decreased (-0.786120 --> -0.786121).  Saving model ...
Epoch: 6 cost time: 2.6758413314819336
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.706 Vali Acc: 0.734 Test Loss: 0.706 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8055660724639893
Epoch: 7, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.738 Vali Acc: 0.786 Test Loss: 0.738 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.668931484222412
Epoch: 8, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.104 Vali Acc: 0.642 Test Loss: 1.104 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.578613758087158
Epoch: 9, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.867 Vali Acc: 0.769 Test Loss: 0.867 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.6711485385894775
Epoch: 10, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.861 Vali Acc: 0.786 Test Loss: 0.861 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.388097047805786
Epoch: 11, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.843 Vali Acc: 0.786 Test Loss: 0.843 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.71956205368042
Epoch: 12, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.258 Vali Acc: 0.775 Test Loss: 1.258 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.594102144241333
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.979 Vali Acc: 0.809 Test Loss: 0.979 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809239).  Saving model ...
Epoch: 14 cost time: 2.607924222946167
Epoch: 14, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.802 Vali Acc: 0.832 Test Loss: 0.802 Test Acc: 0.832
Validation loss decreased (-0.809239 --> -0.832362).  Saving model ...
Epoch: 15 cost time: 2.9954586029052734
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.940 Vali Acc: 0.775 Test Loss: 0.940 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9706315994262695
Epoch: 16, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.650 Vali Acc: 0.786 Test Loss: 1.650 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.099456310272217
Epoch: 17, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.502 Vali Acc: 0.717 Test Loss: 1.502 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.868142604827881
Epoch: 18, Steps: 17 | Train Loss: 0.242 Vali Loss: 1.703 Vali Acc: 0.751 Test Loss: 1.703 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.659450054168701
Epoch: 19, Steps: 17 | Train Loss: 0.187 Vali Loss: 3.694 Vali Acc: 0.734 Test Loss: 3.694 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.743851661682129
Epoch: 20, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.635 Vali Acc: 0.798 Test Loss: 1.635 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.8756043910980225
Epoch: 21, Steps: 17 | Train Loss: 0.101 Vali Loss: 3.578 Vali Acc: 0.711 Test Loss: 3.578 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.513051986694336
Epoch: 22, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.362 Vali Acc: 0.821 Test Loss: 1.362 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.7878613471984863
Epoch: 23, Steps: 17 | Train Loss: 0.232 Vali Loss: 2.624 Vali Acc: 0.740 Test Loss: 2.624 Test Acc: 0.740
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.8048675060272217
Epoch: 24, Steps: 17 | Train Loss: 0.315 Vali Loss: 3.531 Vali Acc: 0.757 Test Loss: 3.531 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2324287
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.481434106826782
Epoch: 1, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.438 Vali Acc: 0.382 Test Loss: 1.438 Test Acc: 0.382
Validation loss decreased (inf --> -0.381489).  Saving model ...
Epoch: 2 cost time: 2.7839579582214355
Epoch: 2, Steps: 17 | Train Loss: 1.233 Vali Loss: 1.180 Vali Acc: 0.514 Test Loss: 1.180 Test Acc: 0.514
Validation loss decreased (-0.381489 --> -0.514439).  Saving model ...
Epoch: 3 cost time: 2.7656068801879883
Epoch: 3, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.835 Vali Acc: 0.671 Test Loss: 0.835 Test Acc: 0.671
Validation loss decreased (-0.514439 --> -0.670512).  Saving model ...
Epoch: 4 cost time: 2.699615001678467
Epoch: 4, Steps: 17 | Train Loss: 0.648 Vali Loss: 0.722 Vali Acc: 0.728 Test Loss: 0.722 Test Acc: 0.728
Validation loss decreased (-0.670512 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 2.7346930503845215
Epoch: 5, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.714 Vali Acc: 0.688 Test Loss: 0.714 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.684661626815796
Epoch: 6, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.748 Vali Acc: 0.746 Test Loss: 0.748 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 2.790022850036621
Epoch: 7, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.737 Vali Acc: 0.792 Test Loss: 0.737 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791900).  Saving model ...
Epoch: 8 cost time: 2.7932865619659424
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.367 Vali Acc: 0.595 Test Loss: 1.367 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.896005153656006
Epoch: 9, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.976 Vali Acc: 0.717 Test Loss: 0.976 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.386821746826172
Epoch: 10, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.726 Vali Acc: 0.751 Test Loss: 0.726 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.4006006717681885
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.811 Vali Acc: 0.798 Test Loss: 0.811 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797680).  Saving model ...
Epoch: 12 cost time: 2.3987205028533936
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.195 Vali Acc: 0.803 Test Loss: 1.195 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803456).  Saving model ...
Epoch: 13 cost time: 2.5311391353607178
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.919 Vali Acc: 0.775 Test Loss: 0.919 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6443233489990234
Epoch: 14, Steps: 17 | Train Loss: 0.130 Vali Loss: 2.142 Vali Acc: 0.705 Test Loss: 2.142 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.6556766033172607
Epoch: 15, Steps: 17 | Train Loss: 0.310 Vali Loss: 1.316 Vali Acc: 0.775 Test Loss: 1.316 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.673058271408081
Epoch: 16, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.448 Vali Acc: 0.792 Test Loss: 1.448 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7654318809509277
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.508 Vali Acc: 0.815 Test Loss: 1.508 Test Acc: 0.815
Validation loss decreased (-0.803456 --> -0.815014).  Saving model ...
Epoch: 18 cost time: 2.5842130184173584
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.066 Vali Acc: 0.780 Test Loss: 1.066 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8100316524505615
Epoch: 19, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.668 Vali Acc: 0.827 Test Loss: 1.668 Test Acc: 0.827
Validation loss decreased (-0.815014 --> -0.826573).  Saving model ...
Epoch: 20 cost time: 2.859849691390991
Epoch: 20, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.637 Vali Acc: 0.792 Test Loss: 1.637 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.699364185333252
Epoch: 21, Steps: 17 | Train Loss: 0.163 Vali Loss: 1.811 Vali Acc: 0.809 Test Loss: 1.811 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0154733657836914
Epoch: 22, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.011 Vali Acc: 0.809 Test Loss: 2.011 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.865030527114868
Epoch: 23, Steps: 17 | Train Loss: 0.058 Vali Loss: 3.483 Vali Acc: 0.740 Test Loss: 3.483 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.9356844425201416
Epoch: 24, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.603 Vali Acc: 0.798 Test Loss: 1.603 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9685018062591553
Epoch: 25, Steps: 17 | Train Loss: 0.273 Vali Loss: 3.396 Vali Acc: 0.734 Test Loss: 3.396 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.1859021186828613
Epoch: 26, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.744 Vali Acc: 0.746 Test Loss: 2.744 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.9520814418792725
Epoch: 27, Steps: 17 | Train Loss: 0.087 Vali Loss: 3.799 Vali Acc: 0.734 Test Loss: 3.799 Test Acc: 0.734
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.8145248889923096
Epoch: 28, Steps: 17 | Train Loss: 0.240 Vali Loss: 2.631 Vali Acc: 0.792 Test Loss: 2.631 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.7819743156433105
Epoch: 29, Steps: 17 | Train Loss: 0.348 Vali Loss: 3.059 Vali Acc: 0.723 Test Loss: 3.059 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2324287
model size : 13.77MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.292404413223267
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.525 Vali Acc: 0.301 Test Loss: 1.525 Test Acc: 0.301
Validation loss decreased (inf --> -0.300563).  Saving model ...
Epoch: 2 cost time: 2.8485260009765625
Epoch: 2, Steps: 17 | Train Loss: 1.264 Vali Loss: 1.127 Vali Acc: 0.434 Test Loss: 1.127 Test Acc: 0.434
Validation loss decreased (-0.300563 --> -0.433515).  Saving model ...
Epoch: 3 cost time: 2.6513545513153076
Epoch: 3, Steps: 17 | Train Loss: 0.905 Vali Loss: 0.966 Vali Acc: 0.578 Test Loss: 0.966 Test Acc: 0.578
Validation loss decreased (-0.433515 --> -0.578025).  Saving model ...
Epoch: 4 cost time: 2.63297438621521
Epoch: 4, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.785 Vali Acc: 0.705 Test Loss: 0.785 Test Acc: 0.705
Validation loss decreased (-0.578025 --> -0.705194).  Saving model ...
Epoch: 5 cost time: 2.5976176261901855
Epoch: 5, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.648 Vali Acc: 0.763 Test Loss: 0.648 Test Acc: 0.763
Validation loss decreased (-0.705194 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 2.6199610233306885
Epoch: 6, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.626 Vali Acc: 0.786 Test Loss: 0.626 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 2.7395036220550537
Epoch: 7, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.673 Vali Acc: 0.792 Test Loss: 0.673 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 2.6324048042297363
Epoch: 8, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.484 Vali Acc: 0.867 Test Loss: 0.484 Test Acc: 0.867
Validation loss decreased (-0.791901 --> -0.867047).  Saving model ...
Epoch: 9 cost time: 2.524862051010132
Epoch: 9, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.670 Vali Acc: 0.763 Test Loss: 0.670 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2868659496307373
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.576 Vali Acc: 0.821 Test Loss: 0.576 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.7956900596618652
Epoch: 11, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.539 Vali Acc: 0.798 Test Loss: 0.539 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8396480083465576
Epoch: 12, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.742 Vali Acc: 0.757 Test Loss: 0.742 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6762917041778564
Epoch: 13, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.513 Vali Acc: 0.850 Test Loss: 0.513 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.6914687156677246
Epoch: 14, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.542 Vali Acc: 0.832 Test Loss: 0.542 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5876967906951904
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.608 Vali Acc: 0.850 Test Loss: 0.608 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.67510986328125
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.720 Vali Acc: 0.832 Test Loss: 0.720 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.525566577911377
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.828 Vali Acc: 0.798 Test Loss: 0.828 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.621946334838867
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.722 Vali Acc: 0.844 Test Loss: 0.722 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 2116287
model size : 10.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.0754125118255615
Epoch: 1, Steps: 17 | Train Loss: 1.957 Vali Loss: 1.523 Vali Acc: 0.289 Test Loss: 1.523 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 3.0418307781219482
Epoch: 2, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.130 Vali Acc: 0.434 Test Loss: 1.130 Test Acc: 0.434
Validation loss decreased (-0.289002 --> -0.433515).  Saving model ...
Epoch: 3 cost time: 2.9495084285736084
Epoch: 3, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.970 Vali Acc: 0.584 Test Loss: 0.970 Test Acc: 0.584
Validation loss decreased (-0.433515 --> -0.583805).  Saving model ...
Epoch: 4 cost time: 3.088426113128662
Epoch: 4, Steps: 17 | Train Loss: 0.693 Vali Loss: 0.782 Vali Acc: 0.694 Test Loss: 0.782 Test Acc: 0.694
Validation loss decreased (-0.583805 --> -0.693634).  Saving model ...
Epoch: 5 cost time: 3.1603446006774902
Epoch: 5, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.621 Vali Acc: 0.780 Test Loss: 0.621 Test Acc: 0.780
Validation loss decreased (-0.693634 --> -0.780341).  Saving model ...
Epoch: 6 cost time: 2.7691755294799805
Epoch: 6, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.660 Vali Acc: 0.780 Test Loss: 0.660 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.73270845413208
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.618 Vali Acc: 0.775 Test Loss: 0.618 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.906688928604126
Epoch: 8, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.625 Vali Acc: 0.775 Test Loss: 0.625 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.889622926712036
Epoch: 9, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.640 Vali Acc: 0.792 Test Loss: 0.640 Test Acc: 0.792
Validation loss decreased (-0.780341 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 3.139514207839966
Epoch: 10, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.631 Vali Acc: 0.815 Test Loss: 0.631 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815023).  Saving model ...
Epoch: 11 cost time: 3.11335825920105
Epoch: 11, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 3.4937925338745117
Epoch: 12, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.724 Vali Acc: 0.798 Test Loss: 0.724 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.9646952152252197
Epoch: 13, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.944 Vali Acc: 0.809 Test Loss: 0.944 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9457995891571045
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.627 Vali Acc: 0.855 Test Loss: 0.627 Test Acc: 0.855
Validation loss decreased (-0.815023 --> -0.855485).  Saving model ...
Epoch: 15 cost time: 2.9944510459899902
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.603 Vali Acc: 0.838 Test Loss: 0.603 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.2067084312438965
Epoch: 16, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.662 Vali Acc: 0.855 Test Loss: 0.662 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.007678270339966
Epoch: 17, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.559 Vali Acc: 0.861 Test Loss: 0.559 Test Acc: 0.861
Validation loss decreased (-0.855485 --> -0.861266).  Saving model ...
Epoch: 18 cost time: 2.9539456367492676
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.607 Vali Acc: 0.855 Test Loss: 0.607 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 3.2675728797912598
Epoch: 19, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.590 Vali Acc: 0.855 Test Loss: 0.590 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.9973039627075195
Epoch: 20, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 3.1356682777404785
Epoch: 21, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.601 Vali Acc: 0.844 Test Loss: 0.601 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.2458512783050537
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.654 Vali Acc: 0.850 Test Loss: 0.654 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 3.3760437965393066
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.637 Vali Acc: 0.827 Test Loss: 0.637 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 3.0099127292633057
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.633 Vali Acc: 0.832 Test Loss: 0.633 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.2669496536254883
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.621 Vali Acc: 0.850 Test Loss: 0.621 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.0865695476531982
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.708 Vali Acc: 0.838 Test Loss: 0.708 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.77820086479187
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.643 Vali Acc: 0.832 Test Loss: 0.643 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 2116287
model size : 10.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.895672082901001
Epoch: 1, Steps: 17 | Train Loss: 1.928 Vali Loss: 1.519 Vali Acc: 0.295 Test Loss: 1.519 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 2.9314279556274414
Epoch: 2, Steps: 17 | Train Loss: 1.272 Vali Loss: 1.139 Vali Acc: 0.434 Test Loss: 1.139 Test Acc: 0.434
Validation loss decreased (-0.294782 --> -0.433515).  Saving model ...
Epoch: 3 cost time: 2.8811488151550293
Epoch: 3, Steps: 17 | Train Loss: 0.922 Vali Loss: 0.959 Vali Acc: 0.613 Test Loss: 0.959 Test Acc: 0.613
Validation loss decreased (-0.433515 --> -0.612707).  Saving model ...
Epoch: 4 cost time: 3.0011398792266846
Epoch: 4, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.798 Vali Acc: 0.746 Test Loss: 0.798 Test Acc: 0.746
Validation loss decreased (-0.612707 --> -0.745657).  Saving model ...
Epoch: 5 cost time: 2.6106369495391846
Epoch: 5, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
Validation loss decreased (-0.745657 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 2.7125449180603027
Epoch: 6, Steps: 17 | Train Loss: 0.394 Vali Loss: 0.633 Vali Acc: 0.786 Test Loss: 0.633 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 2.6017062664031982
Epoch: 7, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.798 Vali Acc: 0.717 Test Loss: 0.798 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.917583465576172
Epoch: 8, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.786121 --> -0.849706).  Saving model ...
Epoch: 9 cost time: 2.560793399810791
Epoch: 9, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.520 Vali Acc: 0.815 Test Loss: 0.520 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5531537532806396
Epoch: 10, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.663 Vali Acc: 0.832 Test Loss: 0.663 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6180777549743652
Epoch: 11, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.817 Vali Acc: 0.763 Test Loss: 0.817 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.929884910583496
Epoch: 12, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.696 Vali Acc: 0.798 Test Loss: 0.696 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 3.089454412460327
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.785 Vali Acc: 0.827 Test Loss: 0.785 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.9797539710998535
Epoch: 14, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.785 Vali Acc: 0.809 Test Loss: 0.785 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.6607730388641357
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.788 Vali Acc: 0.855 Test Loss: 0.788 Test Acc: 0.855
Validation loss decreased (-0.849706 --> -0.855483).  Saving model ...
Epoch: 16 cost time: 3.109407663345337
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.962 Vali Acc: 0.838 Test Loss: 0.962 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 3.0054078102111816
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.100 Vali Acc: 0.832 Test Loss: 1.100 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9445717334747314
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.988 Vali Acc: 0.821 Test Loss: 0.988 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.705235242843628
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.058 Vali Acc: 0.827 Test Loss: 1.058 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.853928804397583
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.021 Vali Acc: 0.821 Test Loss: 1.021 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.862131357192993
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.933 Vali Acc: 0.809 Test Loss: 0.933 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.800522565841675
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.813 Vali Acc: 0.838 Test Loss: 0.813 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.6477479934692383
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.827 Test Loss: 0.896 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.5196497440338135
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.922 Vali Acc: 0.821 Test Loss: 0.922 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.5800862312316895
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.838 Test Loss: 0.847 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2116287
model size : 10.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.871243000030518
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.588 Vali Acc: 0.295 Test Loss: 1.588 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 2.3505513668060303
Epoch: 2, Steps: 17 | Train Loss: 1.351 Vali Loss: 1.188 Vali Acc: 0.393 Test Loss: 1.188 Test Acc: 0.393
Validation loss decreased (-0.294782 --> -0.393052).  Saving model ...
Epoch: 3 cost time: 2.556636095046997
Epoch: 3, Steps: 17 | Train Loss: 1.039 Vali Loss: 0.987 Vali Acc: 0.520 Test Loss: 0.987 Test Acc: 0.520
Validation loss decreased (-0.393052 --> -0.520221).  Saving model ...
Epoch: 4 cost time: 2.6441800594329834
Epoch: 4, Steps: 17 | Train Loss: 0.777 Vali Loss: 0.826 Vali Acc: 0.682 Test Loss: 0.826 Test Acc: 0.682
Validation loss decreased (-0.520221 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 2.5551836490631104
Epoch: 5, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.767 Vali Acc: 0.659 Test Loss: 0.767 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.48003888130188
Epoch: 6, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.699 Vali Acc: 0.734 Test Loss: 0.699 Test Acc: 0.734
Validation loss decreased (-0.682073 --> -0.734097).  Saving model ...
Epoch: 7 cost time: 2.534576654434204
Epoch: 7, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.781 Vali Acc: 0.711 Test Loss: 0.781 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4764511585235596
Epoch: 8, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.749 Vali Acc: 0.740 Test Loss: 0.749 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739877).  Saving model ...
Epoch: 9 cost time: 2.2693891525268555
Epoch: 9, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.639 Vali Acc: 0.780 Test Loss: 0.639 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780340).  Saving model ...
Epoch: 10 cost time: 2.3025059700012207
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.157 Vali Acc: 0.659 Test Loss: 1.157 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.396174669265747
Epoch: 11, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.881 Vali Acc: 0.751 Test Loss: 0.881 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4860620498657227
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.924 Vali Acc: 0.757 Test Loss: 0.924 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.6430647373199463
Epoch: 13, Steps: 17 | Train Loss: 0.141 Vali Loss: 1.008 Vali Acc: 0.751 Test Loss: 1.008 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.392754077911377
Epoch: 14, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.873 Vali Acc: 0.809 Test Loss: 0.873 Test Acc: 0.809
Validation loss decreased (-0.780340 --> -0.809240).  Saving model ...
Epoch: 15 cost time: 2.574208974838257
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.731 Vali Acc: 0.786 Test Loss: 0.731 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.5736069679260254
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.512 Vali Acc: 0.775 Test Loss: 1.512 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.5876352787017822
Epoch: 17, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.086 Vali Acc: 0.815 Test Loss: 1.086 Test Acc: 0.815
Validation loss decreased (-0.809240 --> -0.815018).  Saving model ...
Epoch: 18 cost time: 2.7400717735290527
Epoch: 18, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.227 Vali Acc: 0.763 Test Loss: 1.227 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.6206724643707275
Epoch: 19, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.937 Vali Acc: 0.809 Test Loss: 0.937 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.4621174335479736
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.451 Vali Acc: 0.786 Test Loss: 1.451 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.728088140487671
Epoch: 21, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.839 Vali Acc: 0.734 Test Loss: 1.839 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.716010332107544
Epoch: 22, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.248 Vali Acc: 0.780 Test Loss: 1.248 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.76084303855896
Epoch: 23, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.631 Vali Acc: 0.676 Test Loss: 1.631 Test Acc: 0.676
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.653834819793701
Epoch: 24, Steps: 17 | Train Loss: 0.077 Vali Loss: 1.557 Vali Acc: 0.792 Test Loss: 1.557 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.468402862548828
Epoch: 25, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.377 Vali Acc: 0.827 Test Loss: 1.377 Test Acc: 0.827
Validation loss decreased (-0.815018 --> -0.826576).  Saving model ...
Epoch: 26 cost time: 2.6705234050750732
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.377 Vali Acc: 0.798 Test Loss: 1.377 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.7745649814605713
Epoch: 27, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.889 Vali Acc: 0.757 Test Loss: 1.889 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.7440850734710693
Epoch: 28, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.653 Vali Acc: 0.792 Test Loss: 1.653 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.6199090480804443
Epoch: 29, Steps: 17 | Train Loss: 0.091 Vali Loss: 2.238 Vali Acc: 0.746 Test Loss: 2.238 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.6799824237823486
Epoch: 30, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.756 Vali Acc: 0.751 Test Loss: 1.756 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.664560556411743
Epoch: 31, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.682 Vali Acc: 0.792 Test Loss: 1.682 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.818105936050415
Epoch: 32, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.640 Vali Acc: 0.786 Test Loss: 1.640 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.479889392852783
Epoch: 33, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.809 Vali Acc: 0.792 Test Loss: 1.809 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.4846484661102295
Epoch: 34, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.802 Vali Acc: 0.734 Test Loss: 2.802 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.5225751399993896
Epoch: 35, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.404 Vali Acc: 0.751 Test Loss: 3.404 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2116287
model size : 10.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.7750585079193115
Epoch: 1, Steps: 17 | Train Loss: 1.897 Vali Loss: 1.533 Vali Acc: 0.335 Test Loss: 1.533 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 2.5872292518615723
Epoch: 2, Steps: 17 | Train Loss: 1.250 Vali Loss: 1.175 Vali Acc: 0.393 Test Loss: 1.175 Test Acc: 0.393
Validation loss decreased (-0.335245 --> -0.393052).  Saving model ...
Epoch: 3 cost time: 2.349599838256836
Epoch: 3, Steps: 17 | Train Loss: 0.818 Vali Loss: 0.783 Vali Acc: 0.728 Test Loss: 0.783 Test Acc: 0.728
Validation loss decreased (-0.393052 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.8392441272735596
Epoch: 4, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.732 Vali Acc: 0.699 Test Loss: 0.732 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.737800121307373
Epoch: 5, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.895 Vali Acc: 0.723 Test Loss: 0.895 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.602020263671875
Epoch: 6, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.664 Vali Acc: 0.740 Test Loss: 0.664 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739878).  Saving model ...
Epoch: 7 cost time: 2.7528505325317383
Epoch: 7, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.562 Vali Acc: 0.803 Test Loss: 0.562 Test Acc: 0.803
Validation loss decreased (-0.739878 --> -0.803463).  Saving model ...
Epoch: 8 cost time: 2.6764252185821533
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.593 Vali Acc: 0.815 Test Loss: 0.593 Test Acc: 0.815
Validation loss decreased (-0.803463 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 2.699719190597534
Epoch: 9, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.665 Vali Acc: 0.838 Test Loss: 0.665 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838144).  Saving model ...
Epoch: 10 cost time: 2.8547542095184326
Epoch: 10, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.886 Vali Acc: 0.746 Test Loss: 0.886 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.128417491912842
Epoch: 11, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.465 Vali Acc: 0.867 Test Loss: 0.465 Test Acc: 0.867
Validation loss decreased (-0.838144 --> -0.867047).  Saving model ...
Epoch: 12 cost time: 3.0602810382843018
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.892 Vali Acc: 0.809 Test Loss: 0.892 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9073312282562256
Epoch: 13, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.553 Vali Acc: 0.844 Test Loss: 0.553 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6443300247192383
Epoch: 14, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.951 Vali Acc: 0.832 Test Loss: 0.951 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.6631014347076416
Epoch: 15, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.695 Vali Acc: 0.815 Test Loss: 0.695 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.966212749481201
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.649 Vali Acc: 0.815 Test Loss: 0.649 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.7940094470977783
Epoch: 17, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.690 Vali Acc: 0.821 Test Loss: 0.690 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.0255041122436523
Epoch: 18, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2700674533843994
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.835 Vali Acc: 0.832 Test Loss: 0.835 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.602241039276123
Epoch: 20, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.595 Vali Acc: 0.855 Test Loss: 0.595 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.267817735671997
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.815 Test Loss: 0.666 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1591999
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.669459581375122
Epoch: 1, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.506 Vali Acc: 0.370 Test Loss: 1.506 Test Acc: 0.370
Validation loss decreased (inf --> -0.369927).  Saving model ...
Epoch: 2 cost time: 2.304419994354248
Epoch: 2, Steps: 17 | Train Loss: 1.262 Vali Loss: 1.157 Vali Acc: 0.428 Test Loss: 1.157 Test Acc: 0.428
Validation loss decreased (-0.369927 --> -0.427734).  Saving model ...
Epoch: 3 cost time: 2.396315336227417
Epoch: 3, Steps: 17 | Train Loss: 0.839 Vali Loss: 0.795 Vali Acc: 0.717 Test Loss: 0.795 Test Acc: 0.717
Validation loss decreased (-0.427734 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 2.76308536529541
Epoch: 4, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.731 Vali Acc: 0.694 Test Loss: 0.731 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7207226753234863
Epoch: 5, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.929 Vali Acc: 0.705 Test Loss: 0.929 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9003114700317383
Epoch: 6, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.691 Vali Acc: 0.751 Test Loss: 0.691 Test Acc: 0.751
Validation loss decreased (-0.716755 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 2.955195426940918
Epoch: 7, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
Validation loss decreased (-0.751438 --> -0.855487).  Saving model ...
Epoch: 8 cost time: 3.186473846435547
Epoch: 8, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.604 Vali Acc: 0.832 Test Loss: 0.604 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.6881611347198486
Epoch: 9, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.531749725341797
Epoch: 10, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.557 Vali Acc: 0.832 Test Loss: 0.557 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.710292100906372
Epoch: 11, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.634 Vali Acc: 0.815 Test Loss: 0.634 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.820632219314575
Epoch: 12, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.986227512359619
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.825 Vali Acc: 0.809 Test Loss: 0.825 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.7652974128723145
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.8288941383361816
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.628 Vali Acc: 0.844 Test Loss: 0.628 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.828200578689575
Epoch: 16, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.778 Vali Acc: 0.821 Test Loss: 0.778 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.830127239227295
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.178 Vali Acc: 0.763 Test Loss: 1.178 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1591999
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.976865768432617
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.521 Vali Acc: 0.376 Test Loss: 1.521 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 2.916008949279785
Epoch: 2, Steps: 17 | Train Loss: 1.302 Vali Loss: 1.169 Vali Acc: 0.387 Test Loss: 1.169 Test Acc: 0.387
Validation loss decreased (-0.375707 --> -0.387272).  Saving model ...
Epoch: 3 cost time: 2.7846906185150146
Epoch: 3, Steps: 17 | Train Loss: 0.867 Vali Loss: 0.805 Vali Acc: 0.723 Test Loss: 0.805 Test Acc: 0.723
Validation loss decreased (-0.387272 --> -0.722535).  Saving model ...
Epoch: 4 cost time: 2.5989511013031006
Epoch: 4, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.763 Vali Acc: 0.665 Test Loss: 0.763 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.681809902191162
Epoch: 5, Steps: 17 | Train Loss: 0.481 Vali Loss: 0.924 Vali Acc: 0.705 Test Loss: 0.924 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9335503578186035
Epoch: 6, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.711 Vali Acc: 0.723 Test Loss: 0.711 Test Acc: 0.723
Validation loss decreased (-0.722535 --> -0.722536).  Saving model ...
Epoch: 7 cost time: 2.6235265731811523
Epoch: 7, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.494 Vali Acc: 0.844 Test Loss: 0.494 Test Acc: 0.844
Validation loss decreased (-0.722536 --> -0.843926).  Saving model ...
Epoch: 8 cost time: 2.716132402420044
Epoch: 8, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.795 Vali Acc: 0.734 Test Loss: 0.795 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.725796699523926
Epoch: 9, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.875 Vali Acc: 0.827 Test Loss: 0.875 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 3.067556619644165
Epoch: 10, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.951 Vali Acc: 0.682 Test Loss: 0.951 Test Acc: 0.682
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.7391505241394043
Epoch: 11, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.626 Vali Acc: 0.821 Test Loss: 0.626 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.876997470855713
Epoch: 12, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.888 Vali Acc: 0.809 Test Loss: 0.888 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.968876361846924
Epoch: 13, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.709 Vali Acc: 0.832 Test Loss: 0.709 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.841137170791626
Epoch: 14, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.959 Vali Acc: 0.803 Test Loss: 0.959 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.699768304824829
Epoch: 15, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.7923836708068848
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.132 Vali Acc: 0.815 Test Loss: 1.132 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.5254294872283936
Epoch: 17, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.727 Vali Acc: 0.821 Test Loss: 0.727 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1591999
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.0739476680755615
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.605 Vali Acc: 0.324 Test Loss: 1.605 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 2.8702492713928223
Epoch: 2, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.274 Vali Acc: 0.358 Test Loss: 1.274 Test Acc: 0.358
Validation loss decreased (-0.323683 --> -0.358369).  Saving model ...
Epoch: 3 cost time: 2.771329164505005
Epoch: 3, Steps: 17 | Train Loss: 1.003 Vali Loss: 0.941 Vali Acc: 0.607 Test Loss: 0.941 Test Acc: 0.607
Validation loss decreased (-0.358369 --> -0.606927).  Saving model ...
Epoch: 4 cost time: 2.5140678882598877
Epoch: 4, Steps: 17 | Train Loss: 0.760 Vali Loss: 0.853 Vali Acc: 0.636 Test Loss: 0.853 Test Acc: 0.636
Validation loss decreased (-0.606927 --> -0.635830).  Saving model ...
Epoch: 5 cost time: 2.444633722305298
Epoch: 5, Steps: 17 | Train Loss: 0.564 Vali Loss: 1.028 Vali Acc: 0.595 Test Loss: 1.028 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3570704460144043
Epoch: 6, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.825 Vali Acc: 0.659 Test Loss: 0.825 Test Acc: 0.659
Validation loss decreased (-0.635830 --> -0.658951).  Saving model ...
Epoch: 7 cost time: 2.4708826541900635
Epoch: 7, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.639 Vali Acc: 0.792 Test Loss: 0.639 Test Acc: 0.792
Validation loss decreased (-0.658951 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 2.546626091003418
Epoch: 8, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.821 Vali Acc: 0.740 Test Loss: 0.821 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.518897294998169
Epoch: 9, Steps: 17 | Train Loss: 0.254 Vali Loss: 0.919 Vali Acc: 0.746 Test Loss: 0.919 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.555227279663086
Epoch: 10, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.743 Vali Acc: 0.792 Test Loss: 0.743 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5580334663391113
Epoch: 11, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.837 Vali Acc: 0.763 Test Loss: 0.837 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.468034267425537
Epoch: 12, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.770 Vali Acc: 0.809 Test Loss: 0.770 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809241).  Saving model ...
Epoch: 13 cost time: 2.3445701599121094
Epoch: 13, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.437 Vali Acc: 0.740 Test Loss: 1.437 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.429229497909546
Epoch: 14, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.881 Vali Acc: 0.792 Test Loss: 0.881 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5249650478363037
Epoch: 15, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.818 Vali Acc: 0.792 Test Loss: 0.818 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.5252280235290527
Epoch: 16, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.008 Vali Acc: 0.803 Test Loss: 1.008 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.5096373558044434
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.224 Vali Acc: 0.798 Test Loss: 1.224 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.533914804458618
Epoch: 18, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.274 Vali Acc: 0.763 Test Loss: 1.274 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.670074462890625
Epoch: 19, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.985 Vali Acc: 0.809 Test Loss: 0.985 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.841440439224243
Epoch: 20, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.456 Vali Acc: 0.786 Test Loss: 1.456 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.5435779094696045
Epoch: 21, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.170 Vali Acc: 0.751 Test Loss: 1.170 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.429185152053833
Epoch: 22, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.713 Vali Acc: 0.775 Test Loss: 1.713 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1591999
model size : 8.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.749516725540161
Epoch: 1, Steps: 17 | Train Loss: 1.817 Vali Loss: 1.480 Vali Acc: 0.324 Test Loss: 1.480 Test Acc: 0.324
Validation loss decreased (inf --> -0.323685).  Saving model ...
Epoch: 2 cost time: 2.8148114681243896
Epoch: 2, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.217 Vali Acc: 0.434 Test Loss: 1.217 Test Acc: 0.434
Validation loss decreased (-0.323685 --> -0.433514).  Saving model ...
Epoch: 3 cost time: 2.715925931930542
Epoch: 3, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.020 Vali Acc: 0.601 Test Loss: 1.020 Test Acc: 0.601
Validation loss decreased (-0.433514 --> -0.601146).  Saving model ...
Epoch: 4 cost time: 3.0744664669036865
Epoch: 4, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.905 Vali Acc: 0.653 Test Loss: 0.905 Test Acc: 0.653
Validation loss decreased (-0.601146 --> -0.653170).  Saving model ...
Epoch: 5 cost time: 3.0452187061309814
Epoch: 5, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.635 Vali Acc: 0.769 Test Loss: 0.635 Test Acc: 0.769
Validation loss decreased (-0.653170 --> -0.768780).  Saving model ...
Epoch: 6 cost time: 2.919525623321533
Epoch: 6, Steps: 17 | Train Loss: 0.430 Vali Loss: 0.751 Vali Acc: 0.699 Test Loss: 0.751 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.8173985481262207
Epoch: 7, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.620 Vali Acc: 0.786 Test Loss: 0.620 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 2.5971450805664062
Epoch: 8, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.559 Vali Acc: 0.775 Test Loss: 0.559 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1463050842285156
Epoch: 9, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.485 Vali Acc: 0.844 Test Loss: 0.485 Test Acc: 0.844
Validation loss decreased (-0.786121 --> -0.843926).  Saving model ...
Epoch: 10 cost time: 2.6087019443511963
Epoch: 10, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.540 Vali Acc: 0.855 Test Loss: 0.540 Test Acc: 0.855
Validation loss decreased (-0.843926 --> -0.855486).  Saving model ...
Epoch: 11 cost time: 2.7926504611968994
Epoch: 11, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4328157901763916
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.968 Vali Acc: 0.775 Test Loss: 0.968 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7319014072418213
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.622 Vali Acc: 0.821 Test Loss: 0.622 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.0135529041290283
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.555 Vali Acc: 0.838 Test Loss: 0.555 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.828946828842163
Epoch: 15, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.770 Vali Acc: 0.821 Test Loss: 0.770 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.827861785888672
Epoch: 16, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.296 Vali Acc: 0.780 Test Loss: 1.296 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.712463617324829
Epoch: 17, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.8267171382904053
Epoch: 18, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.5254456996917725
Epoch: 19, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.885 Vali Acc: 0.815 Test Loss: 0.885 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.7698974609375
Epoch: 20, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.819 Vali Acc: 0.798 Test Loss: 0.819 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1329855
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.003273248672485
Epoch: 1, Steps: 17 | Train Loss: 1.797 Vali Loss: 1.475 Vali Acc: 0.347 Test Loss: 1.475 Test Acc: 0.347
Validation loss decreased (inf --> -0.346806).  Saving model ...
Epoch: 2 cost time: 2.57951283454895
Epoch: 2, Steps: 17 | Train Loss: 1.247 Vali Loss: 1.226 Vali Acc: 0.416 Test Loss: 1.226 Test Acc: 0.416
Validation loss decreased (-0.346806 --> -0.416173).  Saving model ...
Epoch: 3 cost time: 2.860640048980713
Epoch: 3, Steps: 17 | Train Loss: 0.920 Vali Loss: 1.087 Vali Acc: 0.578 Test Loss: 1.087 Test Acc: 0.578
Validation loss decreased (-0.416173 --> -0.578024).  Saving model ...
Epoch: 4 cost time: 3.0357513427734375
Epoch: 4, Steps: 17 | Train Loss: 0.695 Vali Loss: 0.978 Vali Acc: 0.642 Test Loss: 0.978 Test Acc: 0.642
Validation loss decreased (-0.578024 --> -0.641609).  Saving model ...
Epoch: 5 cost time: 3.037205934524536
Epoch: 5, Steps: 17 | Train Loss: 0.606 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
Validation loss decreased (-0.641609 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 3.1051321029663086
Epoch: 6, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6570067405700684
Epoch: 7, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.761 Vali Acc: 0.746 Test Loss: 0.761 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.705620050430298
Epoch: 8, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774559).  Saving model ...
Epoch: 9 cost time: 2.8067543506622314
Epoch: 9, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.648 Vali Acc: 0.815 Test Loss: 0.648 Test Acc: 0.815
Validation loss decreased (-0.774559 --> -0.815022).  Saving model ...
Epoch: 10 cost time: 2.6285486221313477
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.445 Vali Acc: 0.855 Test Loss: 0.445 Test Acc: 0.855
Validation loss decreased (-0.815022 --> -0.855487).  Saving model ...
Epoch: 11 cost time: 2.5452585220336914
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.794 Vali Acc: 0.775 Test Loss: 0.794 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.6378324031829834
Epoch: 12, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.708 Vali Acc: 0.844 Test Loss: 0.708 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.6198689937591553
Epoch: 13, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.756 Vali Acc: 0.792 Test Loss: 0.756 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 3.051276922225952
Epoch: 14, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.644 Vali Acc: 0.855 Test Loss: 0.644 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.950124979019165
Epoch: 15, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.643 Vali Acc: 0.792 Test Loss: 0.643 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.746522903442383
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.121 Vali Acc: 0.798 Test Loss: 1.121 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.839630365371704
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.033 Vali Acc: 0.827 Test Loss: 1.033 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.895850658416748
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.960 Vali Acc: 0.821 Test Loss: 0.960 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8742716312408447
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.791 Vali Acc: 0.821 Test Loss: 0.791 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.882486581802368
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.981 Vali Acc: 0.803 Test Loss: 0.981 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1329855
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.828525066375732
Epoch: 1, Steps: 17 | Train Loss: 1.819 Vali Loss: 1.500 Vali Acc: 0.329 Test Loss: 1.500 Test Acc: 0.329
Validation loss decreased (inf --> -0.329465).  Saving model ...
Epoch: 2 cost time: 2.544088125228882
Epoch: 2, Steps: 17 | Train Loss: 1.271 Vali Loss: 1.211 Vali Acc: 0.410 Test Loss: 1.211 Test Acc: 0.410
Validation loss decreased (-0.329465 --> -0.410393).  Saving model ...
Epoch: 3 cost time: 2.491396427154541
Epoch: 3, Steps: 17 | Train Loss: 0.947 Vali Loss: 1.136 Vali Acc: 0.566 Test Loss: 1.136 Test Acc: 0.566
Validation loss decreased (-0.410393 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 2.4978530406951904
Epoch: 4, Steps: 17 | Train Loss: 0.756 Vali Loss: 1.030 Vali Acc: 0.601 Test Loss: 1.030 Test Acc: 0.601
Validation loss decreased (-0.566463 --> -0.601146).  Saving model ...
Epoch: 5 cost time: 2.7819910049438477
Epoch: 5, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.667 Vali Acc: 0.751 Test Loss: 0.667 Test Acc: 0.751
Validation loss decreased (-0.601146 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 2.532130002975464
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.710 Vali Acc: 0.717 Test Loss: 0.710 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9703564643859863
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.697 Vali Acc: 0.786 Test Loss: 0.697 Test Acc: 0.786
Validation loss decreased (-0.751438 --> -0.786120).  Saving model ...
Epoch: 8 cost time: 2.9727234840393066
Epoch: 8, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797681).  Saving model ...
Epoch: 9 cost time: 2.6152870655059814
Epoch: 9, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.553 Vali Acc: 0.827 Test Loss: 0.553 Test Acc: 0.827
Validation loss decreased (-0.797681 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 2.8977952003479004
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.705 Vali Acc: 0.815 Test Loss: 0.705 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.7689385414123535
Epoch: 11, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.932 Vali Acc: 0.746 Test Loss: 0.932 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8731558322906494
Epoch: 12, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.740 Vali Acc: 0.827 Test Loss: 0.740 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.711087703704834
Epoch: 13, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.700 Vali Acc: 0.809 Test Loss: 0.700 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7056186199188232
Epoch: 14, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.816 Vali Acc: 0.821 Test Loss: 0.816 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.6351077556610107
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.171 Vali Acc: 0.705 Test Loss: 1.171 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.5897092819213867
Epoch: 16, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.227 Vali Acc: 0.803 Test Loss: 1.227 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.540309429168701
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.724 Vali Acc: 0.827 Test Loss: 0.724 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6978681087493896
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.337 Vali Acc: 0.769 Test Loss: 1.337 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.8422129154205322
Epoch: 19, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.873 Vali Acc: 0.844 Test Loss: 0.873 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843922).  Saving model ...
Epoch: 20 cost time: 2.911996841430664
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.952 Vali Acc: 0.832 Test Loss: 0.952 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.8324978351593018
Epoch: 21, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.558 Vali Acc: 0.775 Test Loss: 1.558 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.000610589981079
Epoch: 22, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.461 Vali Acc: 0.769 Test Loss: 1.461 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6527671813964844
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.966 Vali Acc: 0.798 Test Loss: 0.966 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.7517662048339844
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.704 Vali Acc: 0.809 Test Loss: 1.704 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.662379503250122
Epoch: 25, Steps: 17 | Train Loss: 0.027 Vali Loss: 2.229 Vali Acc: 0.757 Test Loss: 2.229 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.7624080181121826
Epoch: 26, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.510 Vali Acc: 0.780 Test Loss: 1.510 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.733285665512085
Epoch: 27, Steps: 17 | Train Loss: 0.072 Vali Loss: 2.617 Vali Acc: 0.717 Test Loss: 2.617 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.9799916744232178
Epoch: 28, Steps: 17 | Train Loss: 0.041 Vali Loss: 2.059 Vali Acc: 0.815 Test Loss: 2.059 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.9129176139831543
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 2.195 Vali Acc: 0.786 Test Loss: 2.195 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1329855
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.662869453430176
Epoch: 1, Steps: 17 | Train Loss: 1.851 Vali Loss: 1.577 Vali Acc: 0.364 Test Loss: 1.577 Test Acc: 0.364
Validation loss decreased (inf --> -0.364146).  Saving model ...
Epoch: 2 cost time: 2.7477426528930664
Epoch: 2, Steps: 17 | Train Loss: 1.352 Vali Loss: 1.325 Vali Acc: 0.376 Test Loss: 1.325 Test Acc: 0.376
Validation loss decreased (-0.364146 --> -0.375709).  Saving model ...
Epoch: 3 cost time: 2.492187023162842
Epoch: 3, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.220 Vali Acc: 0.526 Test Loss: 1.220 Test Acc: 0.526
Validation loss decreased (-0.375709 --> -0.525999).  Saving model ...
Epoch: 4 cost time: 2.7408556938171387
Epoch: 4, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.273 Vali Acc: 0.457 Test Loss: 1.273 Test Acc: 0.457
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4169280529022217
Epoch: 5, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.821 Vali Acc: 0.688 Test Loss: 0.821 Test Acc: 0.688
Validation loss decreased (-0.525999 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 2.647937774658203
Epoch: 6, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.781 Vali Acc: 0.682 Test Loss: 0.781 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.6491570472717285
Epoch: 7, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.830 Vali Acc: 0.676 Test Loss: 0.830 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6348817348480225
Epoch: 8, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.778 Vali Acc: 0.740 Test Loss: 0.778 Test Acc: 0.740
Validation loss decreased (-0.687853 --> -0.739877).  Saving model ...
Epoch: 9 cost time: 2.5987770557403564
Epoch: 9, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.683 Vali Acc: 0.780 Test Loss: 0.683 Test Acc: 0.780
Validation loss decreased (-0.739877 --> -0.780340).  Saving model ...
Epoch: 10 cost time: 2.73887038230896
Epoch: 10, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.914 Vali Acc: 0.688 Test Loss: 0.914 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.624656915664673
Epoch: 11, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.808 Vali Acc: 0.769 Test Loss: 0.808 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4235572814941406
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.857 Vali Acc: 0.780 Test Loss: 0.857 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5055091381073
Epoch: 13, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.712 Vali Acc: 0.792 Test Loss: 0.712 Test Acc: 0.792
Validation loss decreased (-0.780340 --> -0.791900).  Saving model ...
Epoch: 14 cost time: 2.409337282180786
Epoch: 14, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.860 Vali Acc: 0.792 Test Loss: 0.860 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.551131248474121
Epoch: 15, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.868 Vali Acc: 0.775 Test Loss: 0.868 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.346450090408325
Epoch: 16, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.386 Vali Acc: 0.780 Test Loss: 1.386 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.1980631351470947
Epoch: 17, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.900 Vali Acc: 0.832 Test Loss: 0.900 Test Acc: 0.832
Validation loss decreased (-0.791900 --> -0.832361).  Saving model ...
Epoch: 18 cost time: 2.190232276916504
Epoch: 18, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.030 Vali Acc: 0.711 Test Loss: 1.030 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.527212381362915
Epoch: 19, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.944 Vali Acc: 0.746 Test Loss: 0.944 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.481489658355713
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.863 Vali Acc: 0.798 Test Loss: 0.863 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.344348430633545
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.936 Vali Acc: 0.855 Test Loss: 0.936 Test Acc: 0.855
Validation loss decreased (-0.832361 --> -0.855482).  Saving model ...
Epoch: 22 cost time: 2.3100740909576416
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.104 Vali Acc: 0.803 Test Loss: 1.104 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.5196139812469482
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.108 Vali Acc: 0.798 Test Loss: 1.108 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.4350125789642334
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.497 Vali Acc: 0.821 Test Loss: 1.497 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.3974921703338623
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.555 Vali Acc: 0.815 Test Loss: 1.555 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.845735549926758
Epoch: 26, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.550 Vali Acc: 0.809 Test Loss: 1.550 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.671163558959961
Epoch: 27, Steps: 17 | Train Loss: 0.049 Vali Loss: 2.033 Vali Acc: 0.751 Test Loss: 2.033 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.559668779373169
Epoch: 28, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.644 Vali Acc: 0.803 Test Loss: 1.644 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.5327696800231934
Epoch: 29, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.510 Vali Acc: 0.798 Test Loss: 1.510 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.3897502422332764
Epoch: 30, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.248 Vali Acc: 0.809 Test Loss: 1.248 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.586153268814087
Epoch: 31, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.991 Vali Acc: 0.780 Test Loss: 1.991 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1329855
model size : 7.53MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.087021350860596
Epoch: 1, Steps: 17 | Train Loss: 1.863 Vali Loss: 1.485 Vali Acc: 0.341 Test Loss: 1.485 Test Acc: 0.341
Validation loss decreased (inf --> -0.341026).  Saving model ...
Epoch: 2 cost time: 2.8825912475585938
Epoch: 2, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.219 Vali Acc: 0.451 Test Loss: 1.219 Test Acc: 0.451
Validation loss decreased (-0.341026 --> -0.450855).  Saving model ...
Epoch: 3 cost time: 2.706223726272583
Epoch: 3, Steps: 17 | Train Loss: 0.930 Vali Loss: 1.054 Vali Acc: 0.491 Test Loss: 1.054 Test Acc: 0.491
Validation loss decreased (-0.450855 --> -0.491319).  Saving model ...
Epoch: 4 cost time: 2.5767874717712402
Epoch: 4, Steps: 17 | Train Loss: 0.646 Vali Loss: 0.991 Vali Acc: 0.711 Test Loss: 0.991 Test Acc: 0.711
Validation loss decreased (-0.491319 --> -0.710973).  Saving model ...
Epoch: 5 cost time: 2.9316742420196533
Epoch: 5, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.878 Vali Acc: 0.711 Test Loss: 0.878 Test Acc: 0.711
Validation loss decreased (-0.710973 --> -0.710974).  Saving model ...
Epoch: 6 cost time: 2.951476812362671
Epoch: 6, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
Validation loss decreased (-0.710974 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 2.8812918663024902
Epoch: 7, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.614 Vali Acc: 0.786 Test Loss: 0.614 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 2.9992616176605225
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.549 Vali Acc: 0.815 Test Loss: 0.549 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815023).  Saving model ...
Epoch: 9 cost time: 2.901667594909668
Epoch: 9, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.596 Vali Acc: 0.815 Test Loss: 0.596 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.0921902656555176
Epoch: 10, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.621 Vali Acc: 0.780 Test Loss: 0.621 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9729955196380615
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.492 Vali Acc: 0.867 Test Loss: 0.492 Test Acc: 0.867
Validation loss decreased (-0.815023 --> -0.867047).  Saving model ...
Epoch: 12 cost time: 2.7444047927856445
Epoch: 12, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.038 Vali Acc: 0.792 Test Loss: 1.038 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9760632514953613
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.473 Vali Acc: 0.844 Test Loss: 0.473 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.8317904472351074
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.502 Vali Acc: 0.827 Test Loss: 0.502 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 3.0622730255126953
Epoch: 15, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.8924028873443604
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.935 Vali Acc: 0.821 Test Loss: 0.935 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 3.173067569732666
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.836 Vali Acc: 0.815 Test Loss: 0.836 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.8774523735046387
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9721057415008545
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.029 Vali Acc: 0.821 Test Loss: 1.029 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.669921875
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.826 Vali Acc: 0.792 Test Loss: 0.826 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.4790401458740234
Epoch: 21, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.672 Vali Acc: 0.867 Test Loss: 0.672 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1198783
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.488199710845947
Epoch: 1, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.490 Vali Acc: 0.329 Test Loss: 1.490 Test Acc: 0.329
Validation loss decreased (inf --> -0.329465).  Saving model ...
Epoch: 2 cost time: 3.136188507080078
Epoch: 2, Steps: 17 | Train Loss: 1.329 Vali Loss: 1.218 Vali Acc: 0.439 Test Loss: 1.218 Test Acc: 0.439
Validation loss decreased (-0.329465 --> -0.439294).  Saving model ...
Epoch: 3 cost time: 2.7866005897521973
Epoch: 3, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.069 Vali Acc: 0.503 Test Loss: 1.069 Test Acc: 0.503
Validation loss decreased (-0.439294 --> -0.502879).  Saving model ...
Epoch: 4 cost time: 3.072967529296875
Epoch: 4, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.951 Vali Acc: 0.717 Test Loss: 0.951 Test Acc: 0.717
Validation loss decreased (-0.502879 --> -0.716753).  Saving model ...
Epoch: 5 cost time: 3.128516435623169
Epoch: 5, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.734 Vali Acc: 0.740 Test Loss: 0.734 Test Acc: 0.740
Validation loss decreased (-0.716753 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 2.6143670082092285
Epoch: 6, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.823 Vali Acc: 0.717 Test Loss: 0.823 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7597930431365967
Epoch: 7, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.594 Vali Acc: 0.803 Test Loss: 0.594 Test Acc: 0.803
Validation loss decreased (-0.739877 --> -0.803462).  Saving model ...
Epoch: 8 cost time: 2.7784457206726074
Epoch: 8, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.621 Vali Acc: 0.786 Test Loss: 0.621 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7166616916656494
Epoch: 9, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.642 Vali Acc: 0.798 Test Loss: 0.642 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.776444435119629
Epoch: 10, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.597 Vali Acc: 0.821 Test Loss: 0.597 Test Acc: 0.821
Validation loss decreased (-0.803462 --> -0.820803).  Saving model ...
Epoch: 11 cost time: 2.7032737731933594
Epoch: 11, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.462 Vali Acc: 0.855 Test Loss: 0.462 Test Acc: 0.855
Validation loss decreased (-0.820803 --> -0.855487).  Saving model ...
Epoch: 12 cost time: 2.8729395866394043
Epoch: 12, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.707 Vali Acc: 0.815 Test Loss: 0.707 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.9161901473999023
Epoch: 13, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.537 Vali Acc: 0.844 Test Loss: 0.537 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.927783250808716
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.864 Vali Acc: 0.832 Test Loss: 0.864 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.919039249420166
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.945589065551758
Epoch: 16, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.664 Vali Acc: 0.798 Test Loss: 0.664 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.886461019515991
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.980 Vali Acc: 0.798 Test Loss: 0.980 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.9782536029815674
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.192 Vali Acc: 0.803 Test Loss: 1.192 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 3.2617928981781006
Epoch: 19, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.994 Vali Acc: 0.803 Test Loss: 0.994 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.976562738418579
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.258 Vali Acc: 0.798 Test Loss: 1.258 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.849371910095215
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.357 Vali Acc: 0.780 Test Loss: 1.357 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1198783
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.491817235946655
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.509 Vali Acc: 0.335 Test Loss: 1.509 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 3.0277388095855713
Epoch: 2, Steps: 17 | Train Loss: 1.340 Vali Loss: 1.232 Vali Acc: 0.451 Test Loss: 1.232 Test Acc: 0.451
Validation loss decreased (-0.335245 --> -0.450855).  Saving model ...
Epoch: 3 cost time: 3.2457997798919678
Epoch: 3, Steps: 17 | Train Loss: 0.974 Vali Loss: 1.029 Vali Acc: 0.514 Test Loss: 1.029 Test Acc: 0.514
Validation loss decreased (-0.450855 --> -0.514441).  Saving model ...
Epoch: 4 cost time: 2.885890245437622
Epoch: 4, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.949 Vali Acc: 0.694 Test Loss: 0.949 Test Acc: 0.694
Validation loss decreased (-0.514441 --> -0.693632).  Saving model ...
Epoch: 5 cost time: 2.999528646469116
Epoch: 5, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.681 Vali Acc: 0.740 Test Loss: 0.681 Test Acc: 0.740
Validation loss decreased (-0.693632 --> -0.739878).  Saving model ...
Epoch: 6 cost time: 3.165412425994873
Epoch: 6, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.682 Vali Acc: 0.751 Test Loss: 0.682 Test Acc: 0.751
Validation loss decreased (-0.739878 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 2.8303308486938477
Epoch: 7, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.628 Vali Acc: 0.769 Test Loss: 0.628 Test Acc: 0.769
Validation loss decreased (-0.751438 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 2.7247655391693115
Epoch: 8, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.746 Vali Acc: 0.746 Test Loss: 0.746 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.72066593170166
Epoch: 9, Steps: 17 | Train Loss: 0.371 Vali Loss: 1.161 Vali Acc: 0.676 Test Loss: 1.161 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.9522931575775146
Epoch: 10, Steps: 17 | Train Loss: 0.212 Vali Loss: 0.536 Vali Acc: 0.827 Test Loss: 0.536 Test Acc: 0.827
Validation loss decreased (-0.768780 --> -0.826584).  Saving model ...
Epoch: 11 cost time: 2.7225489616394043
Epoch: 11, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.646 Vali Acc: 0.786 Test Loss: 0.646 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.854931592941284
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.662 Vali Acc: 0.832 Test Loss: 0.662 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832363).  Saving model ...
Epoch: 13 cost time: 2.925548791885376
Epoch: 13, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.587 Vali Acc: 0.838 Test Loss: 0.587 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838144).  Saving model ...
Epoch: 14 cost time: 2.9839401245117188
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8004941940307617
Epoch: 15, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.797 Vali Acc: 0.832 Test Loss: 0.797 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.041140079498291
Epoch: 16, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.871 Vali Acc: 0.815 Test Loss: 0.871 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9498324394226074
Epoch: 17, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.165 Vali Acc: 0.798 Test Loss: 1.165 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.8442747592926025
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.826 Vali Acc: 0.832 Test Loss: 0.826 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.8225462436676025
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.941 Vali Acc: 0.867 Test Loss: 0.941 Test Acc: 0.867
Validation loss decreased (-0.838144 --> -0.867043).  Saving model ...
Epoch: 20 cost time: 2.676424264907837
Epoch: 20, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.874 Vali Acc: 0.821 Test Loss: 0.874 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 3.188196897506714
Epoch: 21, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.053 Vali Acc: 0.844 Test Loss: 1.053 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 3.0578725337982178
Epoch: 22, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.255 Vali Acc: 0.815 Test Loss: 1.255 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 3.124725580215454
Epoch: 23, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.611 Vali Acc: 0.786 Test Loss: 1.611 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 3.015805721282959
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.119 Vali Acc: 0.815 Test Loss: 1.119 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 3.0180628299713135
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.282 Vali Acc: 0.821 Test Loss: 1.282 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 3.0549182891845703
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.524 Vali Acc: 0.815 Test Loss: 1.524 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 3.1949589252471924
Epoch: 27, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.095 Vali Acc: 0.815 Test Loss: 1.095 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 3.3701984882354736
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.974 Vali Acc: 0.850 Test Loss: 0.974 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 3.195452928543091
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.855 Test Loss: 0.862 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 1198783
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.991351127624512
Epoch: 1, Steps: 17 | Train Loss: 1.912 Vali Loss: 1.585 Vali Acc: 0.376 Test Loss: 1.585 Test Acc: 0.376
Validation loss decreased (inf --> -0.375707).  Saving model ...
Epoch: 2 cost time: 2.584129571914673
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.304 Vali Acc: 0.410 Test Loss: 1.304 Test Acc: 0.410
Validation loss decreased (-0.375707 --> -0.410392).  Saving model ...
Epoch: 3 cost time: 2.6538076400756836
Epoch: 3, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.096 Vali Acc: 0.486 Test Loss: 1.096 Test Acc: 0.486
Validation loss decreased (-0.410392 --> -0.485538).  Saving model ...
Epoch: 4 cost time: 2.6274447441101074
Epoch: 4, Steps: 17 | Train Loss: 0.807 Vali Loss: 0.989 Vali Acc: 0.624 Test Loss: 0.989 Test Acc: 0.624
Validation loss decreased (-0.485538 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 2.6396052837371826
Epoch: 5, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.779 Vali Acc: 0.688 Test Loss: 0.779 Test Acc: 0.688
Validation loss decreased (-0.624268 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 2.565397024154663
Epoch: 6, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.743 Vali Acc: 0.723 Test Loss: 0.743 Test Acc: 0.723
Validation loss decreased (-0.687853 --> -0.722536).  Saving model ...
Epoch: 7 cost time: 2.2209084033966064
Epoch: 7, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.692 Vali Acc: 0.746 Test Loss: 0.692 Test Acc: 0.746
Validation loss decreased (-0.722536 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 2.3711347579956055
Epoch: 8, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.800 Vali Acc: 0.728 Test Loss: 0.800 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.329862117767334
Epoch: 9, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.972 Vali Acc: 0.717 Test Loss: 0.972 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2627782821655273
Epoch: 10, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.687 Vali Acc: 0.798 Test Loss: 0.687 Test Acc: 0.798
Validation loss decreased (-0.745658 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 2.3574109077453613
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.654 Vali Acc: 0.757 Test Loss: 0.654 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.742431879043579
Epoch: 12, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
Validation loss decreased (-0.797681 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 2.6519155502319336
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.711 Vali Acc: 0.827 Test Loss: 0.711 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826582).  Saving model ...
Epoch: 14 cost time: 2.8619606494903564
Epoch: 14, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.934 Vali Acc: 0.809 Test Loss: 0.934 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.778064012527466
Epoch: 15, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.818 Vali Acc: 0.786 Test Loss: 0.818 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.893871784210205
Epoch: 16, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.906 Vali Acc: 0.798 Test Loss: 0.906 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 3.091339349746704
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.829 Vali Acc: 0.786 Test Loss: 0.829 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.944732666015625
Epoch: 18, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.941 Vali Acc: 0.694 Test Loss: 1.941 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.950730323791504
Epoch: 19, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.560 Vali Acc: 0.723 Test Loss: 1.560 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.664232015609741
Epoch: 20, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.917 Vali Acc: 0.815 Test Loss: 0.917 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.755720376968384
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.881 Vali Acc: 0.809 Test Loss: 0.881 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6346166133880615
Epoch: 22, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.424 Vali Acc: 0.815 Test Loss: 1.424 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.917675256729126
Epoch: 23, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.952 Vali Acc: 0.815 Test Loss: 0.952 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1198783
model size : 7.03MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.9565324783325195
Epoch: 1, Steps: 17 | Train Loss: 1.820 Vali Loss: 1.425 Vali Acc: 0.405 Test Loss: 1.425 Test Acc: 0.405
Validation loss decreased (inf --> -0.404610).  Saving model ...
Epoch: 2 cost time: 2.8091022968292236
Epoch: 2, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.128 Vali Acc: 0.503 Test Loss: 1.128 Test Acc: 0.503
Validation loss decreased (-0.404610 --> -0.502879).  Saving model ...
Epoch: 3 cost time: 2.7381789684295654
Epoch: 3, Steps: 17 | Train Loss: 0.928 Vali Loss: 0.910 Vali Acc: 0.688 Test Loss: 0.910 Test Acc: 0.688
Validation loss decreased (-0.502879 --> -0.687852).  Saving model ...
Epoch: 4 cost time: 2.919978141784668
Epoch: 4, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.678 Vali Acc: 0.792 Test Loss: 0.678 Test Acc: 0.792
Validation loss decreased (-0.687852 --> -0.791901).  Saving model ...
Epoch: 5 cost time: 3.0799758434295654
Epoch: 5, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.774 Vali Acc: 0.734 Test Loss: 0.774 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7275848388671875
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.885 Vali Acc: 0.717 Test Loss: 0.885 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.8417840003967285
Epoch: 7, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.647 Vali Acc: 0.775 Test Loss: 0.647 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.621273994445801
Epoch: 8, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.471 Vali Acc: 0.855 Test Loss: 0.471 Test Acc: 0.855
Validation loss decreased (-0.791901 --> -0.855487).  Saving model ...
Epoch: 9 cost time: 2.5229876041412354
Epoch: 9, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.659 Vali Acc: 0.844 Test Loss: 0.659 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6898012161254883
Epoch: 10, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.633 Vali Acc: 0.815 Test Loss: 0.633 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.697610378265381
Epoch: 11, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.636 Vali Acc: 0.827 Test Loss: 0.636 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6817538738250732
Epoch: 12, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.994630813598633
Epoch: 13, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.567 Vali Acc: 0.850 Test Loss: 0.567 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.436922311782837
Epoch: 14, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.103 Vali Acc: 0.809 Test Loss: 1.103 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.685535192489624
Epoch: 15, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.586 Vali Acc: 0.855 Test Loss: 0.586 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.5220041275024414
Epoch: 16, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.867 Vali Acc: 0.809 Test Loss: 0.867 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.7773277759552
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.687 Vali Acc: 0.861 Test Loss: 0.687 Test Acc: 0.861
Validation loss decreased (-0.855487 --> -0.861265).  Saving model ...
Epoch: 18 cost time: 2.8660645484924316
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.691 Vali Acc: 0.838 Test Loss: 0.691 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.5201854705810547
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.028 Vali Acc: 0.803 Test Loss: 1.028 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8682470321655273
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.020 Vali Acc: 0.803 Test Loss: 1.020 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4447007179260254
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.870 Vali Acc: 0.815 Test Loss: 0.870 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.425842761993408
Epoch: 22, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.392 Vali Acc: 0.792 Test Loss: 1.392 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.491420269012451
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.557 Vali Acc: 0.763 Test Loss: 1.557 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.466026782989502
Epoch: 24, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.093 Vali Acc: 0.815 Test Loss: 1.093 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.6361887454986572
Epoch: 25, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.336 Vali Acc: 0.803 Test Loss: 1.336 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.8186287879943848
Epoch: 26, Steps: 17 | Train Loss: 0.098 Vali Loss: 2.788 Vali Acc: 0.699 Test Loss: 2.788 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.735280752182007
Epoch: 27, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.931 Vali Acc: 0.769 Test Loss: 1.931 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1133247
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.473150730133057
Epoch: 1, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.425 Vali Acc: 0.416 Test Loss: 1.425 Test Acc: 0.416
Validation loss decreased (inf --> -0.416171).  Saving model ...
Epoch: 2 cost time: 2.2747740745544434
Epoch: 2, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.114 Vali Acc: 0.509 Test Loss: 1.114 Test Acc: 0.509
Validation loss decreased (-0.416171 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 2.309441328048706
Epoch: 3, Steps: 17 | Train Loss: 0.940 Vali Loss: 0.894 Vali Acc: 0.711 Test Loss: 0.894 Test Acc: 0.711
Validation loss decreased (-0.508659 --> -0.710974).  Saving model ...
Epoch: 4 cost time: 2.5961036682128906
Epoch: 4, Steps: 17 | Train Loss: 0.638 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.710974 --> -0.757219).  Saving model ...
Epoch: 5 cost time: 2.4856951236724854
Epoch: 5, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.785 Vali Acc: 0.723 Test Loss: 0.785 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.4013049602508545
Epoch: 6, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.929 Vali Acc: 0.671 Test Loss: 0.929 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3004519939422607
Epoch: 7, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.787 Vali Acc: 0.746 Test Loss: 0.787 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.489485263824463
Epoch: 8, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.524 Vali Acc: 0.821 Test Loss: 0.524 Test Acc: 0.821
Validation loss decreased (-0.757219 --> -0.820804).  Saving model ...
Epoch: 9 cost time: 2.5575122833251953
Epoch: 9, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.704 Vali Acc: 0.809 Test Loss: 0.704 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6247735023498535
Epoch: 10, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.672 Vali Acc: 0.832 Test Loss: 0.672 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832363).  Saving model ...
Epoch: 11 cost time: 2.431152582168579
Epoch: 11, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.585 Vali Acc: 0.821 Test Loss: 0.585 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5123233795166016
Epoch: 12, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.499 Vali Acc: 0.850 Test Loss: 0.499 Test Acc: 0.850
Validation loss decreased (-0.832363 --> -0.849706).  Saving model ...
Epoch: 13 cost time: 2.6464362144470215
Epoch: 13, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.607 Vali Acc: 0.815 Test Loss: 0.607 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.413961887359619
Epoch: 14, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.689 Vali Acc: 0.815 Test Loss: 0.689 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.317265272140503
Epoch: 15, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.697 Vali Acc: 0.809 Test Loss: 0.697 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1964499950408936
Epoch: 16, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.740 Vali Acc: 0.809 Test Loss: 0.740 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7071645259857178
Epoch: 17, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.872 Vali Acc: 0.798 Test Loss: 0.872 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.646064281463623
Epoch: 18, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.898 Vali Acc: 0.821 Test Loss: 0.898 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.4993557929992676
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.469 Vali Acc: 0.751 Test Loss: 1.469 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.90696120262146
Epoch: 20, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.190 Vali Acc: 0.757 Test Loss: 1.190 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.787362575531006
Epoch: 21, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.972 Vali Acc: 0.798 Test Loss: 0.972 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.907135486602783
Epoch: 22, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.352 Vali Acc: 0.803 Test Loss: 1.352 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1133247
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.219111204147339
Epoch: 1, Steps: 17 | Train Loss: 1.833 Vali Loss: 1.458 Vali Acc: 0.393 Test Loss: 1.458 Test Acc: 0.393
Validation loss decreased (inf --> -0.393049).  Saving model ...
Epoch: 2 cost time: 2.6912827491760254
Epoch: 2, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.146 Vali Acc: 0.480 Test Loss: 1.146 Test Acc: 0.480
Validation loss decreased (-0.393049 --> -0.479757).  Saving model ...
Epoch: 3 cost time: 2.667093276977539
Epoch: 3, Steps: 17 | Train Loss: 0.952 Vali Loss: 0.907 Vali Acc: 0.676 Test Loss: 0.907 Test Acc: 0.676
Validation loss decreased (-0.479757 --> -0.676292).  Saving model ...
Epoch: 4 cost time: 3.0085794925689697
Epoch: 4, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.717 Vali Acc: 0.711 Test Loss: 0.717 Test Acc: 0.711
Validation loss decreased (-0.676292 --> -0.710975).  Saving model ...
Epoch: 5 cost time: 2.8800270557403564
Epoch: 5, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.849 Vali Acc: 0.682 Test Loss: 0.849 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.6687378883361816
Epoch: 6, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.800 Vali Acc: 0.705 Test Loss: 0.800 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.9141387939453125
Epoch: 7, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.696 Vali Acc: 0.769 Test Loss: 0.696 Test Acc: 0.769
Validation loss decreased (-0.710975 --> -0.768779).  Saving model ...
Epoch: 8 cost time: 2.5571563243865967
Epoch: 8, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.607 Vali Acc: 0.798 Test Loss: 0.607 Test Acc: 0.798
Validation loss decreased (-0.768779 --> -0.797682).  Saving model ...
Epoch: 9 cost time: 2.6079354286193848
Epoch: 9, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.723 Vali Acc: 0.780 Test Loss: 0.723 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.76279616355896
Epoch: 10, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.679 Vali Acc: 0.821 Test Loss: 0.679 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820802).  Saving model ...
Epoch: 11 cost time: 2.466804265975952
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.765 Vali Acc: 0.775 Test Loss: 0.765 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.3542089462280273
Epoch: 12, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3859200477600098
Epoch: 13, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.564 Vali Acc: 0.855 Test Loss: 0.564 Test Acc: 0.855
Validation loss decreased (-0.820802 --> -0.855486).  Saving model ...
Epoch: 14 cost time: 2.786081314086914
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.993 Vali Acc: 0.827 Test Loss: 0.993 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.71089768409729
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.765 Vali Acc: 0.821 Test Loss: 0.765 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7683420181274414
Epoch: 16, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.941 Vali Acc: 0.803 Test Loss: 0.941 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.7206335067749023
Epoch: 17, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.761 Vali Acc: 0.838 Test Loss: 0.761 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3169291019439697
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.818 Vali Acc: 0.821 Test Loss: 0.818 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.744001865386963
Epoch: 19, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.863 Vali Acc: 0.809 Test Loss: 0.863 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.5259995460510254
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.373 Vali Acc: 0.803 Test Loss: 1.373 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.5654869079589844
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.973 Vali Acc: 0.792 Test Loss: 0.973 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.509525775909424
Epoch: 22, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.092 Vali Acc: 0.792 Test Loss: 1.092 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.619865894317627
Epoch: 23, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.126 Vali Acc: 0.780 Test Loss: 1.126 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1133247
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.340730905532837
Epoch: 1, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.539 Vali Acc: 0.329 Test Loss: 1.539 Test Acc: 0.329
Validation loss decreased (inf --> -0.329464).  Saving model ...
Epoch: 2 cost time: 2.503023147583008
Epoch: 2, Steps: 17 | Train Loss: 1.363 Vali Loss: 1.238 Vali Acc: 0.486 Test Loss: 1.238 Test Acc: 0.486
Validation loss decreased (-0.329464 --> -0.485537).  Saving model ...
Epoch: 3 cost time: 2.6459388732910156
Epoch: 3, Steps: 17 | Train Loss: 1.044 Vali Loss: 1.035 Vali Acc: 0.561 Test Loss: 1.035 Test Acc: 0.561
Validation loss decreased (-0.485537 --> -0.560683).  Saving model ...
Epoch: 4 cost time: 2.7118072509765625
Epoch: 4, Steps: 17 | Train Loss: 0.837 Vali Loss: 0.927 Vali Acc: 0.642 Test Loss: 0.927 Test Acc: 0.642
Validation loss decreased (-0.560683 --> -0.641609).  Saving model ...
Epoch: 5 cost time: 2.707446813583374
Epoch: 5, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.795 Vali Acc: 0.688 Test Loss: 0.795 Test Acc: 0.688
Validation loss decreased (-0.641609 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 2.450796127319336
Epoch: 6, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.978 Vali Acc: 0.636 Test Loss: 0.978 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.4344072341918945
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.729 Vali Acc: 0.751 Test Loss: 0.729 Test Acc: 0.751
Validation loss decreased (-0.687853 --> -0.751438).  Saving model ...
Epoch: 8 cost time: 2.431766986846924
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.591 Vali Acc: 0.809 Test Loss: 0.591 Test Acc: 0.809
Validation loss decreased (-0.751438 --> -0.809243).  Saving model ...
Epoch: 9 cost time: 2.51235294342041
Epoch: 9, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.691 Vali Acc: 0.775 Test Loss: 0.691 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.447643280029297
Epoch: 10, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.861 Vali Acc: 0.728 Test Loss: 0.861 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5068211555480957
Epoch: 11, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.791 Vali Acc: 0.757 Test Loss: 0.791 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.6828055381774902
Epoch: 12, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.860 Vali Acc: 0.723 Test Loss: 0.860 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.6578831672668457
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.831 Vali Acc: 0.792 Test Loss: 0.831 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.614922523498535
Epoch: 14, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.171 Vali Acc: 0.751 Test Loss: 1.171 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5687673091888428
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.174 Vali Acc: 0.780 Test Loss: 1.174 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.617079734802246
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.081 Vali Acc: 0.792 Test Loss: 1.081 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.462167739868164
Epoch: 17, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.054 Vali Acc: 0.763 Test Loss: 1.054 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.365748405456543
Epoch: 18, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.443 Vali Acc: 0.780 Test Loss: 1.443 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1133247
model size : 6.78MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.1127026081085205
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.588 Vali Acc: 0.370 Test Loss: 1.588 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 2.3103485107421875
Epoch: 2, Steps: 17 | Train Loss: 1.376 Vali Loss: 1.383 Vali Acc: 0.422 Test Loss: 1.383 Test Acc: 0.422
Validation loss decreased (-0.369926 --> -0.421951).  Saving model ...
Epoch: 3 cost time: 2.519538640975952
Epoch: 3, Steps: 17 | Train Loss: 1.018 Vali Loss: 1.079 Vali Acc: 0.549 Test Loss: 1.079 Test Acc: 0.549
Validation loss decreased (-0.421951 --> -0.549122).  Saving model ...
Epoch: 4 cost time: 2.6003963947296143
Epoch: 4, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.656 Vali Acc: 0.815 Test Loss: 0.656 Test Acc: 0.815
Validation loss decreased (-0.549122 --> -0.815022).  Saving model ...
Epoch: 5 cost time: 2.494107246398926
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.747 Vali Acc: 0.723 Test Loss: 0.747 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.8962862491607666
Epoch: 6, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.841 Vali Acc: 0.682 Test Loss: 0.841 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6593241691589355
Epoch: 7, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.549 Vali Acc: 0.798 Test Loss: 0.549 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.7452774047851562
Epoch: 8, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.648 Vali Acc: 0.803 Test Loss: 0.648 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.628756284713745
Epoch: 9, Steps: 17 | Train Loss: 0.108 Vali Loss: 0.516 Vali Acc: 0.838 Test Loss: 0.516 Test Acc: 0.838
Validation loss decreased (-0.815022 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 2.6269123554229736
Epoch: 10, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.640 Vali Acc: 0.821 Test Loss: 0.640 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6078004837036133
Epoch: 11, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.806 Vali Acc: 0.763 Test Loss: 0.806 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.5308024883270264
Epoch: 12, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.616 Vali Acc: 0.815 Test Loss: 0.616 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5417563915252686
Epoch: 13, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.771 Vali Acc: 0.815 Test Loss: 0.771 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.689328193664551
Epoch: 14, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.793 Vali Acc: 0.798 Test Loss: 0.793 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.3791379928588867
Epoch: 15, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.613 Vali Acc: 0.815 Test Loss: 0.613 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.700784683227539
Epoch: 16, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.921 Vali Acc: 0.832 Test Loss: 0.921 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.6755483150482178
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.942 Vali Acc: 0.798 Test Loss: 0.942 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.8420629501342773
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.859 Vali Acc: 0.809 Test Loss: 0.859 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.694944143295288
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.539 Vali Acc: 0.775 Test Loss: 1.539 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1100479
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.041040420532227
Epoch: 1, Steps: 17 | Train Loss: 1.949 Vali Loss: 1.577 Vali Acc: 0.341 Test Loss: 1.577 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 2.554454803466797
Epoch: 2, Steps: 17 | Train Loss: 1.366 Vali Loss: 1.384 Vali Acc: 0.393 Test Loss: 1.384 Test Acc: 0.393
Validation loss decreased (-0.341025 --> -0.393050).  Saving model ...
Epoch: 3 cost time: 2.640293836593628
Epoch: 3, Steps: 17 | Train Loss: 1.029 Vali Loss: 1.091 Vali Acc: 0.555 Test Loss: 1.091 Test Acc: 0.555
Validation loss decreased (-0.393050 --> -0.554902).  Saving model ...
Epoch: 4 cost time: 2.7744038105010986
Epoch: 4, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.673 Vali Acc: 0.815 Test Loss: 0.673 Test Acc: 0.815
Validation loss decreased (-0.554902 --> -0.815022).  Saving model ...
Epoch: 5 cost time: 2.5997798442840576
Epoch: 5, Steps: 17 | Train Loss: 0.424 Vali Loss: 0.756 Vali Acc: 0.711 Test Loss: 0.756 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.832031726837158
Epoch: 6, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.787 Vali Acc: 0.723 Test Loss: 0.787 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.55879282951355
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.554 Vali Acc: 0.786 Test Loss: 0.554 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3440611362457275
Epoch: 8, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.709 Vali Acc: 0.780 Test Loss: 0.709 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.237938642501831
Epoch: 9, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.666 Vali Acc: 0.786 Test Loss: 0.666 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.4882657527923584
Epoch: 10, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.658 Vali Acc: 0.827 Test Loss: 0.658 Test Acc: 0.827
Validation loss decreased (-0.815022 --> -0.826583).  Saving model ...
Epoch: 11 cost time: 2.4235517978668213
Epoch: 11, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.591 Vali Acc: 0.827 Test Loss: 0.591 Test Acc: 0.827
Validation loss decreased (-0.826583 --> -0.826584).  Saving model ...
Epoch: 12 cost time: 2.425384044647217
Epoch: 12, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.762 Vali Acc: 0.809 Test Loss: 0.762 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4330759048461914
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.039 Vali Acc: 0.786 Test Loss: 1.039 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.610990285873413
Epoch: 14, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.807 Vali Acc: 0.792 Test Loss: 0.807 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.565509796142578
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.272 Vali Acc: 0.775 Test Loss: 1.272 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.6554999351501465
Epoch: 16, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.873 Vali Acc: 0.803 Test Loss: 0.873 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.5067336559295654
Epoch: 17, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.987 Vali Acc: 0.821 Test Loss: 0.987 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.5375120639801025
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.952 Vali Acc: 0.815 Test Loss: 0.952 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.312168598175049
Epoch: 19, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.969 Vali Acc: 0.821 Test Loss: 0.969 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4308700561523438
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.993 Vali Acc: 0.832 Test Loss: 0.993 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832360).  Saving model ...
Epoch: 21 cost time: 2.6754660606384277
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.234 Vali Acc: 0.809 Test Loss: 1.234 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.743253469467163
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.258 Vali Acc: 0.815 Test Loss: 1.258 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.702230453491211
Epoch: 23, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.248 Vali Acc: 0.803 Test Loss: 1.248 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.321866035461426
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.013 Vali Acc: 0.809 Test Loss: 1.013 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.6082303524017334
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.295 Vali Acc: 0.792 Test Loss: 1.295 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.7438113689422607
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.254 Vali Acc: 0.809 Test Loss: 1.254 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.4471850395202637
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.421 Vali Acc: 0.809 Test Loss: 1.421 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.552231788635254
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.292 Vali Acc: 0.803 Test Loss: 1.292 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4820759296417236
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.431 Vali Acc: 0.815 Test Loss: 1.431 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.7101993560791016
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.285 Vali Acc: 0.803 Test Loss: 1.285 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1100479
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.102414131164551
Epoch: 1, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.586 Vali Acc: 0.358 Test Loss: 1.586 Test Acc: 0.358
Validation loss decreased (inf --> -0.358366).  Saving model ...
Epoch: 2 cost time: 2.7276833057403564
Epoch: 2, Steps: 17 | Train Loss: 1.372 Vali Loss: 1.402 Vali Acc: 0.416 Test Loss: 1.402 Test Acc: 0.416
Validation loss decreased (-0.358366 --> -0.416171).  Saving model ...
Epoch: 3 cost time: 2.977625608444214
Epoch: 3, Steps: 17 | Train Loss: 1.042 Vali Loss: 1.063 Vali Acc: 0.584 Test Loss: 1.063 Test Acc: 0.584
Validation loss decreased (-0.416171 --> -0.583804).  Saving model ...
Epoch: 4 cost time: 2.957289218902588
Epoch: 4, Steps: 17 | Train Loss: 0.661 Vali Loss: 0.676 Vali Acc: 0.832 Test Loss: 0.676 Test Acc: 0.832
Validation loss decreased (-0.583804 --> -0.832363).  Saving model ...
Epoch: 5 cost time: 2.75470232963562
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.800 Vali Acc: 0.682 Test Loss: 0.800 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.771766185760498
Epoch: 6, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.879 Vali Acc: 0.688 Test Loss: 0.879 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.854170560836792
Epoch: 7, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.696 Vali Acc: 0.728 Test Loss: 0.696 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.8977630138397217
Epoch: 8, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.738 Vali Acc: 0.780 Test Loss: 0.738 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.9182915687561035
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.575 Vali Acc: 0.821 Test Loss: 0.575 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.8633692264556885
Epoch: 10, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.849 Vali Acc: 0.798 Test Loss: 0.849 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.7973029613494873
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.645 Vali Acc: 0.798 Test Loss: 0.645 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.698786973953247
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.660 Vali Acc: 0.827 Test Loss: 0.660 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.643125295639038
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.914 Vali Acc: 0.798 Test Loss: 0.914 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.3966078758239746
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.297 Vali Acc: 0.746 Test Loss: 1.297 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1100479
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.76911735534668
Epoch: 1, Steps: 17 | Train Loss: 1.921 Vali Loss: 1.644 Vali Acc: 0.335 Test Loss: 1.644 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 2.333448648452759
Epoch: 2, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.467 Vali Acc: 0.370 Test Loss: 1.467 Test Acc: 0.370
Validation loss decreased (-0.335244 --> -0.369928).  Saving model ...
Epoch: 3 cost time: 2.277341604232788
Epoch: 3, Steps: 17 | Train Loss: 1.115 Vali Loss: 1.151 Vali Acc: 0.543 Test Loss: 1.151 Test Acc: 0.543
Validation loss decreased (-0.369928 --> -0.543341).  Saving model ...
Epoch: 4 cost time: 2.2748239040374756
Epoch: 4, Steps: 17 | Train Loss: 0.817 Vali Loss: 0.825 Vali Acc: 0.751 Test Loss: 0.825 Test Acc: 0.751
Validation loss decreased (-0.543341 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 2.405076026916504
Epoch: 5, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.764 Vali Acc: 0.705 Test Loss: 0.764 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.241502046585083
Epoch: 6, Steps: 17 | Train Loss: 0.541 Vali Loss: 0.785 Vali Acc: 0.746 Test Loss: 0.785 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.22455096244812
Epoch: 7, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.875 Vali Acc: 0.636 Test Loss: 0.875 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.210665225982666
Epoch: 8, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.654 Vali Acc: 0.769 Test Loss: 0.654 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768780).  Saving model ...
Epoch: 9 cost time: 2.395843505859375
Epoch: 9, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.878 Vali Acc: 0.746 Test Loss: 0.878 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4187450408935547
Epoch: 10, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.987 Vali Acc: 0.757 Test Loss: 0.987 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.484278440475464
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 1.017 Vali Acc: 0.717 Test Loss: 1.017 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.400655508041382
Epoch: 12, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.618 Vali Acc: 0.809 Test Loss: 0.618 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809242).  Saving model ...
Epoch: 13 cost time: 2.2986769676208496
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.214 Vali Acc: 0.728 Test Loss: 1.214 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2563719749450684
Epoch: 14, Steps: 17 | Train Loss: 0.102 Vali Loss: 1.052 Vali Acc: 0.763 Test Loss: 1.052 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.621554136276245
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.910 Vali Acc: 0.763 Test Loss: 0.910 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.535287380218506
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.269 Vali Acc: 0.792 Test Loss: 1.269 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4245591163635254
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.842 Vali Acc: 0.792 Test Loss: 0.842 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.513706684112549
Epoch: 18, Steps: 17 | Train Loss: 0.158 Vali Loss: 3.098 Vali Acc: 0.659 Test Loss: 3.098 Test Acc: 0.659
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.434298038482666
Epoch: 19, Steps: 17 | Train Loss: 0.287 Vali Loss: 1.152 Vali Acc: 0.746 Test Loss: 1.152 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3409788608551025
Epoch: 20, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.485 Vali Acc: 0.763 Test Loss: 1.485 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.500861167907715
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.295 Vali Acc: 0.798 Test Loss: 1.295 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4794094562530518
Epoch: 22, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.186 Vali Acc: 0.734 Test Loss: 1.186 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 1100479
model size : 6.66MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.1726250648498535
Epoch: 1, Steps: 17 | Train Loss: 1.922 Vali Loss: 1.728 Vali Acc: 0.249 Test Loss: 1.728 Test Acc: 0.249
Validation loss decreased (inf --> -0.248538).  Saving model ...
Epoch: 2 cost time: 2.782625436782837
Epoch: 2, Steps: 17 | Train Loss: 1.468 Vali Loss: 1.420 Vali Acc: 0.376 Test Loss: 1.420 Test Acc: 0.376
Validation loss decreased (-0.248538 --> -0.375708).  Saving model ...
Epoch: 3 cost time: 2.373117446899414
Epoch: 3, Steps: 17 | Train Loss: 1.159 Vali Loss: 1.062 Vali Acc: 0.624 Test Loss: 1.062 Test Acc: 0.624
Validation loss decreased (-0.375708 --> -0.624267).  Saving model ...
Epoch: 4 cost time: 2.695411205291748
Epoch: 4, Steps: 17 | Train Loss: 0.886 Vali Loss: 0.899 Vali Acc: 0.671 Test Loss: 0.899 Test Acc: 0.671
Validation loss decreased (-0.624267 --> -0.670511).  Saving model ...
Epoch: 5 cost time: 2.591155767440796
Epoch: 5, Steps: 17 | Train Loss: 0.743 Vali Loss: 0.744 Vali Acc: 0.757 Test Loss: 0.744 Test Acc: 0.757
Validation loss decreased (-0.670511 --> -0.757218).  Saving model ...
Epoch: 6 cost time: 2.382267713546753
Epoch: 6, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.716 Vali Acc: 0.786 Test Loss: 0.716 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786120).  Saving model ...
Epoch: 7 cost time: 2.497215986251831
Epoch: 7, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.630 Vali Acc: 0.775 Test Loss: 0.630 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.702449083328247
Epoch: 8, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.934 Vali Acc: 0.647 Test Loss: 0.934 Test Acc: 0.647
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6001815795898438
Epoch: 9, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.646 Vali Acc: 0.775 Test Loss: 0.646 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.588618755340576
Epoch: 10, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.641 Vali Acc: 0.792 Test Loss: 0.641 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791901).  Saving model ...
Epoch: 11 cost time: 2.679802894592285
Epoch: 11, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.545 Vali Acc: 0.803 Test Loss: 0.545 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 12 cost time: 2.7683444023132324
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.535 Vali Acc: 0.844 Test Loss: 0.535 Test Acc: 0.844
Validation loss decreased (-0.803463 --> -0.843925).  Saving model ...
Epoch: 13 cost time: 2.5584299564361572
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.704 Vali Acc: 0.786 Test Loss: 0.704 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6239378452301025
Epoch: 14, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.619 Vali Acc: 0.827 Test Loss: 0.619 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5649948120117188
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.753 Vali Acc: 0.809 Test Loss: 0.753 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.4557385444641113
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.830 Vali Acc: 0.792 Test Loss: 0.830 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.8102755546569824
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.7486891746520996
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.644 Vali Acc: 0.821 Test Loss: 0.644 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.7048726081848145
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.738 Vali Acc: 0.798 Test Loss: 0.738 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.6501336097717285
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.008 Vali Acc: 0.821 Test Loss: 1.008 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.742971897125244
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.709 Vali Acc: 0.827 Test Loss: 0.709 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.4014437198638916
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.815 Test Loss: 0.717 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1045631
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.0088887214660645
Epoch: 1, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.724 Vali Acc: 0.260 Test Loss: 1.724 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 2.7206008434295654
Epoch: 2, Steps: 17 | Train Loss: 1.474 Vali Loss: 1.411 Vali Acc: 0.358 Test Loss: 1.411 Test Acc: 0.358
Validation loss decreased (-0.260098 --> -0.358367).  Saving model ...
Epoch: 3 cost time: 2.723353862762451
Epoch: 3, Steps: 17 | Train Loss: 1.151 Vali Loss: 1.068 Vali Acc: 0.607 Test Loss: 1.068 Test Acc: 0.607
Validation loss decreased (-0.358367 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 2.6438050270080566
Epoch: 4, Steps: 17 | Train Loss: 0.897 Vali Loss: 0.900 Vali Acc: 0.671 Test Loss: 0.900 Test Acc: 0.671
Validation loss decreased (-0.606926 --> -0.670511).  Saving model ...
Epoch: 5 cost time: 2.548435926437378
Epoch: 5, Steps: 17 | Train Loss: 0.744 Vali Loss: 0.766 Vali Acc: 0.711 Test Loss: 0.766 Test Acc: 0.711
Validation loss decreased (-0.670511 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 2.5256707668304443
Epoch: 6, Steps: 17 | Train Loss: 0.590 Vali Loss: 0.704 Vali Acc: 0.763 Test Loss: 0.704 Test Acc: 0.763
Validation loss decreased (-0.710975 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 2.4952895641326904
Epoch: 7, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.755 Vali Acc: 0.705 Test Loss: 0.755 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.67635440826416
Epoch: 8, Steps: 17 | Train Loss: 0.442 Vali Loss: 0.924 Vali Acc: 0.659 Test Loss: 0.924 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.623497486114502
Epoch: 9, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.642 Vali Acc: 0.792 Test Loss: 0.642 Test Acc: 0.792
Validation loss decreased (-0.762999 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 2.5650177001953125
Epoch: 10, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.649 Vali Acc: 0.792 Test Loss: 0.649 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.530233383178711
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.666 Vali Acc: 0.798 Test Loss: 0.666 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 12 cost time: 2.345555305480957
Epoch: 12, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.570 Vali Acc: 0.838 Test Loss: 0.570 Test Acc: 0.838
Validation loss decreased (-0.797681 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 2.966013193130493
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.611 Vali Acc: 0.838 Test Loss: 0.611 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.906052589416504
Epoch: 14, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.699 Vali Acc: 0.827 Test Loss: 0.699 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.692424774169922
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.734 Vali Acc: 0.798 Test Loss: 0.734 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.783676862716675
Epoch: 16, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.752 Vali Acc: 0.798 Test Loss: 0.752 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.737213611602783
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.743 Vali Acc: 0.803 Test Loss: 0.743 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.5798745155334473
Epoch: 18, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.734 Vali Acc: 0.855 Test Loss: 0.734 Test Acc: 0.855
Validation loss decreased (-0.838145 --> -0.855484).  Saving model ...
Epoch: 19 cost time: 2.499906539916992
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.844 Vali Acc: 0.809 Test Loss: 0.844 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.754650354385376
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.884 Vali Acc: 0.815 Test Loss: 0.884 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.6384825706481934
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.672 Vali Acc: 0.861 Test Loss: 0.672 Test Acc: 0.861
Validation loss decreased (-0.855484 --> -0.861265).  Saving model ...
Epoch: 22 cost time: 2.541149854660034
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.008 Vali Acc: 0.827 Test Loss: 1.008 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.490260362625122
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.897 Vali Acc: 0.815 Test Loss: 0.897 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.6118886470794678
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.880 Vali Acc: 0.827 Test Loss: 0.880 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.5865981578826904
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.922 Vali Acc: 0.809 Test Loss: 0.922 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.5894880294799805
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.719 Vali Acc: 0.827 Test Loss: 0.719 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.583946466445923
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.815 Test Loss: 0.735 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.695801019668579
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.702 Vali Acc: 0.827 Test Loss: 0.702 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.4474923610687256
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.690 Vali Acc: 0.827 Test Loss: 0.690 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 2.3989715576171875
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.821 Test Loss: 0.703 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 2.8095791339874268
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.686 Vali Acc: 0.815 Test Loss: 0.686 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1045631
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.1995768547058105
Epoch: 1, Steps: 17 | Train Loss: 1.936 Vali Loss: 1.740 Vali Acc: 0.277 Test Loss: 1.740 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 2.6734201908111572
Epoch: 2, Steps: 17 | Train Loss: 1.490 Vali Loss: 1.407 Vali Acc: 0.341 Test Loss: 1.407 Test Acc: 0.341
Validation loss decreased (-0.277439 --> -0.341026).  Saving model ...
Epoch: 3 cost time: 2.6278433799743652
Epoch: 3, Steps: 17 | Train Loss: 1.158 Vali Loss: 1.078 Vali Acc: 0.607 Test Loss: 1.078 Test Acc: 0.607
Validation loss decreased (-0.341026 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 2.7769477367401123
Epoch: 4, Steps: 17 | Train Loss: 0.925 Vali Loss: 0.948 Vali Acc: 0.630 Test Loss: 0.948 Test Acc: 0.630
Validation loss decreased (-0.606926 --> -0.630048).  Saving model ...
Epoch: 5 cost time: 2.906790018081665
Epoch: 5, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.785 Vali Acc: 0.723 Test Loss: 0.785 Test Acc: 0.723
Validation loss decreased (-0.630048 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 2.7764081954956055
Epoch: 6, Steps: 17 | Train Loss: 0.622 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
Validation loss decreased (-0.722536 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 2.867386817932129
Epoch: 7, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.730 Vali Acc: 0.740 Test Loss: 0.730 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6433768272399902
Epoch: 8, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.797 Vali Acc: 0.671 Test Loss: 0.797 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.37538743019104
Epoch: 9, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.745 Vali Acc: 0.711 Test Loss: 0.745 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9548230171203613
Epoch: 10, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.631 Vali Acc: 0.786 Test Loss: 0.631 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786121).  Saving model ...
Epoch: 11 cost time: 2.6446099281311035
Epoch: 11, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.705 Vali Acc: 0.786 Test Loss: 0.705 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.982388496398926
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.734 Vali Acc: 0.740 Test Loss: 0.734 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8140218257904053
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.654 Vali Acc: 0.815 Test Loss: 0.654 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 2.739861488342285
Epoch: 14, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.836 Vali Acc: 0.786 Test Loss: 0.836 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.9291934967041016
Epoch: 15, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.722 Vali Acc: 0.821 Test Loss: 0.722 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820802).  Saving model ...
Epoch: 16 cost time: 2.6561529636383057
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.895 Vali Acc: 0.763 Test Loss: 0.895 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5908074378967285
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.927 Vali Acc: 0.821 Test Loss: 0.927 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.6133081912994385
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.006 Vali Acc: 0.809 Test Loss: 1.006 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.730132818222046
Epoch: 19, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.868 Vali Acc: 0.809 Test Loss: 0.868 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.5968942642211914
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.750 Vali Acc: 0.798 Test Loss: 0.750 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.6352200508117676
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.058 Vali Acc: 0.769 Test Loss: 1.058 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.359961748123169
Epoch: 22, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.950 Vali Acc: 0.780 Test Loss: 0.950 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7096128463745117
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.836 Vali Acc: 0.798 Test Loss: 0.836 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.707285165786743
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.768 Vali Acc: 0.855 Test Loss: 0.768 Test Acc: 0.855
Validation loss decreased (-0.820802 --> -0.855484).  Saving model ...
Epoch: 25 cost time: 2.8928799629211426
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.126 Vali Acc: 0.798 Test Loss: 1.126 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.6445600986480713
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.828 Vali Acc: 0.763 Test Loss: 1.828 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.574862480163574
Epoch: 27, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.832 Vali Acc: 0.757 Test Loss: 1.832 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.594015121459961
Epoch: 28, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.886 Vali Acc: 0.757 Test Loss: 1.886 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.6339542865753174
Epoch: 29, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.237 Vali Acc: 0.809 Test Loss: 1.237 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.6816718578338623
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.871 Vali Acc: 0.780 Test Loss: 1.871 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.669588565826416
Epoch: 31, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.193 Vali Acc: 0.803 Test Loss: 1.193 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.6058850288391113
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.221 Vali Acc: 0.815 Test Loss: 1.221 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.6696243286132812
Epoch: 33, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.619 Vali Acc: 0.786 Test Loss: 1.619 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.621579885482788
Epoch: 34, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.175 Vali Acc: 0.844 Test Loss: 1.175 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 1045631
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.020874500274658
Epoch: 1, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.781 Vali Acc: 0.272 Test Loss: 1.781 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 2.7422540187835693
Epoch: 2, Steps: 17 | Train Loss: 1.556 Vali Loss: 1.423 Vali Acc: 0.329 Test Loss: 1.423 Test Acc: 0.329
Validation loss decreased (-0.271658 --> -0.329466).  Saving model ...
Epoch: 3 cost time: 2.656006097793579
Epoch: 3, Steps: 17 | Train Loss: 1.235 Vali Loss: 1.170 Vali Acc: 0.538 Test Loss: 1.170 Test Acc: 0.538
Validation loss decreased (-0.329466 --> -0.537561).  Saving model ...
Epoch: 4 cost time: 2.6083261966705322
Epoch: 4, Steps: 17 | Train Loss: 1.010 Vali Loss: 1.010 Vali Acc: 0.624 Test Loss: 1.010 Test Acc: 0.624
Validation loss decreased (-0.537561 --> -0.624267).  Saving model ...
Epoch: 5 cost time: 2.844144344329834
Epoch: 5, Steps: 17 | Train Loss: 0.852 Vali Loss: 0.852 Vali Acc: 0.682 Test Loss: 0.852 Test Acc: 0.682
Validation loss decreased (-0.624267 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 2.636842966079712
Epoch: 6, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.803 Vali Acc: 0.728 Test Loss: 0.803 Test Acc: 0.728
Validation loss decreased (-0.682072 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 2.7372212409973145
Epoch: 7, Steps: 17 | Train Loss: 0.560 Vali Loss: 0.796 Vali Acc: 0.688 Test Loss: 0.796 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.543618679046631
Epoch: 8, Steps: 17 | Train Loss: 0.543 Vali Loss: 1.010 Vali Acc: 0.630 Test Loss: 1.010 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.6863272190093994
Epoch: 9, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.722 Vali Acc: 0.757 Test Loss: 0.722 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757218).  Saving model ...
Epoch: 10 cost time: 2.5930473804473877
Epoch: 10, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.674 Vali Acc: 0.763 Test Loss: 0.674 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 11 cost time: 2.883275270462036
Epoch: 11, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.848 Vali Acc: 0.775 Test Loss: 0.848 Test Acc: 0.775
Validation loss decreased (-0.762999 --> -0.774558).  Saving model ...
Epoch: 12 cost time: 2.8520991802215576
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.799 Vali Acc: 0.734 Test Loss: 0.799 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.688680648803711
Epoch: 13, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.889 Vali Acc: 0.757 Test Loss: 0.889 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.653372049331665
Epoch: 14, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.888 Vali Acc: 0.792 Test Loss: 0.888 Test Acc: 0.792
Validation loss decreased (-0.774558 --> -0.791899).  Saving model ...
Epoch: 15 cost time: 2.652155637741089
Epoch: 15, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.869 Vali Acc: 0.786 Test Loss: 0.869 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.60817551612854
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.987 Vali Acc: 0.821 Test Loss: 0.987 Test Acc: 0.821
Validation loss decreased (-0.791899 --> -0.820799).  Saving model ...
Epoch: 17 cost time: 2.6262102127075195
Epoch: 17, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.953 Vali Acc: 0.792 Test Loss: 0.953 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6193599700927734
Epoch: 18, Steps: 17 | Train Loss: 0.109 Vali Loss: 1.104 Vali Acc: 0.775 Test Loss: 1.104 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.484161853790283
Epoch: 19, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.509 Vali Acc: 0.740 Test Loss: 1.509 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.700399875640869
Epoch: 20, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.585 Vali Acc: 0.780 Test Loss: 1.585 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.667198657989502
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.932 Vali Acc: 0.786 Test Loss: 0.932 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6313233375549316
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.940 Vali Acc: 0.803 Test Loss: 0.940 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.657263994216919
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.182 Vali Acc: 0.769 Test Loss: 1.182 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.6776726245880127
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.156 Vali Acc: 0.786 Test Loss: 1.156 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.568861722946167
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.114 Vali Acc: 0.780 Test Loss: 1.114 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.6842706203460693
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.070 Vali Acc: 0.786 Test Loss: 1.070 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 1045631
model size : 5.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.022144794464111
Epoch: 1, Steps: 17 | Train Loss: 2.029 Vali Loss: 1.704 Vali Acc: 0.272 Test Loss: 1.704 Test Acc: 0.272
Validation loss decreased (inf --> -0.271659).  Saving model ...
Epoch: 2 cost time: 2.533445358276367
Epoch: 2, Steps: 17 | Train Loss: 1.515 Vali Loss: 1.380 Vali Acc: 0.410 Test Loss: 1.380 Test Acc: 0.410
Validation loss decreased (-0.271659 --> -0.410391).  Saving model ...
Epoch: 3 cost time: 2.6186487674713135
Epoch: 3, Steps: 17 | Train Loss: 1.111 Vali Loss: 1.016 Vali Acc: 0.642 Test Loss: 1.016 Test Acc: 0.642
Validation loss decreased (-0.410391 --> -0.641608).  Saving model ...
Epoch: 4 cost time: 2.9789681434631348
Epoch: 4, Steps: 17 | Train Loss: 0.918 Vali Loss: 1.045 Vali Acc: 0.526 Test Loss: 1.045 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.171311140060425
Epoch: 5, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.892 Vali Acc: 0.624 Test Loss: 0.892 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.968275547027588
Epoch: 6, Steps: 17 | Train Loss: 0.611 Vali Loss: 0.729 Vali Acc: 0.775 Test Loss: 0.729 Test Acc: 0.775
Validation loss decreased (-0.641608 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 2.9979352951049805
Epoch: 7, Steps: 17 | Train Loss: 0.406 Vali Loss: 0.792 Vali Acc: 0.694 Test Loss: 0.792 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.6533589363098145
Epoch: 8, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.615 Vali Acc: 0.798 Test Loss: 0.615 Test Acc: 0.798
Validation loss decreased (-0.774559 --> -0.797682).  Saving model ...
Epoch: 9 cost time: 2.732851266860962
Epoch: 9, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803462).  Saving model ...
Epoch: 10 cost time: 2.785426378250122
Epoch: 10, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.767 Vali Acc: 0.769 Test Loss: 0.767 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.8181569576263428
Epoch: 11, Steps: 17 | Train Loss: 0.117 Vali Loss: 0.613 Vali Acc: 0.780 Test Loss: 0.613 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.625375509262085
Epoch: 12, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.543 Vali Acc: 0.838 Test Loss: 0.543 Test Acc: 0.838
Validation loss decreased (-0.803462 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 2.913790464401245
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.838145 --> -0.849705).  Saving model ...
Epoch: 14 cost time: 2.6479973793029785
Epoch: 14, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.536 Vali Acc: 0.815 Test Loss: 0.536 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.782925605773926
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.678 Vali Acc: 0.832 Test Loss: 0.678 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.7965333461761475
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.644 Vali Acc: 0.815 Test Loss: 0.644 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.589517116546631
Epoch: 17, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.746 Vali Acc: 0.821 Test Loss: 0.746 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6497814655303955
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.630 Vali Acc: 0.809 Test Loss: 0.630 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.7292892932891846
Epoch: 19, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.654 Vali Acc: 0.832 Test Loss: 0.654 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.7057533264160156
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.4934065341949463
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.581 Vali Acc: 0.850 Test Loss: 0.581 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.462523937225342
Epoch: 22, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.752 Vali Acc: 0.827 Test Loss: 0.752 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.634423017501831
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.785 Vali Acc: 0.821 Test Loss: 0.785 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 783487
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.975239515304565
Epoch: 1, Steps: 17 | Train Loss: 2.028 Vali Loss: 1.702 Vali Acc: 0.312 Test Loss: 1.702 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 2.5951225757598877
Epoch: 2, Steps: 17 | Train Loss: 1.523 Vali Loss: 1.396 Vali Acc: 0.358 Test Loss: 1.396 Test Acc: 0.358
Validation loss decreased (-0.312122 --> -0.358368).  Saving model ...
Epoch: 3 cost time: 2.6382172107696533
Epoch: 3, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.033 Vali Acc: 0.636 Test Loss: 1.033 Test Acc: 0.636
Validation loss decreased (-0.358368 --> -0.635828).  Saving model ...
Epoch: 4 cost time: 2.9014110565185547
Epoch: 4, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.053 Vali Acc: 0.538 Test Loss: 1.053 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.898653030395508
Epoch: 5, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.900 Vali Acc: 0.659 Test Loss: 0.900 Test Acc: 0.659
Validation loss decreased (-0.635828 --> -0.658951).  Saving model ...
Epoch: 6 cost time: 2.852369546890259
Epoch: 6, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
Validation loss decreased (-0.658951 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 3.0286812782287598
Epoch: 7, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.790 Vali Acc: 0.688 Test Loss: 0.790 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 3.0233609676361084
Epoch: 8, Steps: 17 | Train Loss: 0.408 Vali Loss: 0.677 Vali Acc: 0.792 Test Loss: 0.677 Test Acc: 0.792
Validation loss decreased (-0.757218 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 3.098001480102539
Epoch: 9, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.644 Vali Acc: 0.798 Test Loss: 0.644 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 10 cost time: 2.9816176891326904
Epoch: 10, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.114 Vali Acc: 0.723 Test Loss: 1.114 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.1836299896240234
Epoch: 11, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.678 Vali Acc: 0.786 Test Loss: 0.678 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.269563913345337
Epoch: 12, Steps: 17 | Train Loss: 0.105 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809241).  Saving model ...
Epoch: 13 cost time: 3.0650691986083984
Epoch: 13, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.777 Vali Acc: 0.757 Test Loss: 0.777 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 3.141430139541626
Epoch: 14, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.787 Vali Acc: 0.827 Test Loss: 0.787 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826582).  Saving model ...
Epoch: 15 cost time: 3.036010980606079
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.726 Vali Acc: 0.809 Test Loss: 0.726 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 3.1532206535339355
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.646 Vali Acc: 0.844 Test Loss: 0.646 Test Acc: 0.844
Validation loss decreased (-0.826582 --> -0.843924).  Saving model ...
Epoch: 17 cost time: 3.414884328842163
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 3.2189040184020996
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.685 Vali Acc: 0.838 Test Loss: 0.685 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 3.093122720718384
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.712 Vali Acc: 0.815 Test Loss: 0.712 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.1493844985961914
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.760 Vali Acc: 0.838 Test Loss: 0.760 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.002441167831421
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.815 Test Loss: 0.744 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8766987323760986
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.735 Vali Acc: 0.821 Test Loss: 0.735 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.1743056774139404
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.753 Vali Acc: 0.827 Test Loss: 0.753 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.9551141262054443
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.744 Vali Acc: 0.827 Test Loss: 0.744 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.7653748989105225
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.771 Vali Acc: 0.832 Test Loss: 0.771 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.146756410598755
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.756 Vali Acc: 0.821 Test Loss: 0.756 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 783487
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.744850397109985
Epoch: 1, Steps: 17 | Train Loss: 2.033 Vali Loss: 1.728 Vali Acc: 0.283 Test Loss: 1.728 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 2.436555862426758
Epoch: 2, Steps: 17 | Train Loss: 1.553 Vali Loss: 1.427 Vali Acc: 0.341 Test Loss: 1.427 Test Acc: 0.341
Validation loss decreased (-0.283220 --> -0.341026).  Saving model ...
Epoch: 3 cost time: 2.460073947906494
Epoch: 3, Steps: 17 | Train Loss: 1.174 Vali Loss: 1.084 Vali Acc: 0.607 Test Loss: 1.084 Test Acc: 0.607
Validation loss decreased (-0.341026 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 2.799633502960205
Epoch: 4, Steps: 17 | Train Loss: 0.977 Vali Loss: 1.011 Vali Acc: 0.520 Test Loss: 1.011 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5024828910827637
Epoch: 5, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.919 Vali Acc: 0.630 Test Loss: 0.919 Test Acc: 0.630
Validation loss decreased (-0.606926 --> -0.630049).  Saving model ...
Epoch: 6 cost time: 2.453108549118042
Epoch: 6, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
Validation loss decreased (-0.630049 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 2.3144636154174805
Epoch: 7, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.773 Vali Acc: 0.688 Test Loss: 0.773 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.4800188541412354
Epoch: 8, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.673 Vali Acc: 0.757 Test Loss: 0.673 Test Acc: 0.757
Validation loss decreased (-0.757218 --> -0.757219).  Saving model ...
Epoch: 9 cost time: 2.4325637817382812
Epoch: 9, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.678 Vali Acc: 0.803 Test Loss: 0.678 Test Acc: 0.803
Validation loss decreased (-0.757219 --> -0.803461).  Saving model ...
Epoch: 10 cost time: 2.2300775051116943
Epoch: 10, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.778 Vali Acc: 0.786 Test Loss: 0.778 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2040293216705322
Epoch: 11, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.047 Vali Acc: 0.665 Test Loss: 1.047 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.282198429107666
Epoch: 12, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.731 Vali Acc: 0.821 Test Loss: 0.731 Test Acc: 0.821
Validation loss decreased (-0.803461 --> -0.820802).  Saving model ...
Epoch: 13 cost time: 2.6752665042877197
Epoch: 13, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.861 Vali Acc: 0.780 Test Loss: 0.861 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.6165390014648438
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.775 Vali Acc: 0.815 Test Loss: 0.775 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.425156354904175
Epoch: 15, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.856 Vali Acc: 0.832 Test Loss: 0.856 Test Acc: 0.832
Validation loss decreased (-0.820802 --> -0.832361).  Saving model ...
Epoch: 16 cost time: 2.5906898975372314
Epoch: 16, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.705 Vali Acc: 0.821 Test Loss: 0.705 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.3785927295684814
Epoch: 17, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.987 Vali Acc: 0.792 Test Loss: 0.987 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.447566032409668
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.907 Vali Acc: 0.803 Test Loss: 0.907 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.57667875289917
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.886 Vali Acc: 0.821 Test Loss: 0.886 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.651280641555786
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.792 Vali Acc: 0.821 Test Loss: 0.792 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.645989418029785
Epoch: 21, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.914 Vali Acc: 0.803 Test Loss: 0.914 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.6236977577209473
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.013 Vali Acc: 0.821 Test Loss: 1.013 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.559370517730713
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.191 Vali Acc: 0.798 Test Loss: 1.191 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.507707357406616
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.989 Vali Acc: 0.821 Test Loss: 0.989 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4205427169799805
Epoch: 25, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.117 Vali Acc: 0.798 Test Loss: 1.117 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 783487
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.598318099975586
Epoch: 1, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.748 Vali Acc: 0.283 Test Loss: 1.748 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 2.415442943572998
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.485 Vali Acc: 0.335 Test Loss: 1.485 Test Acc: 0.335
Validation loss decreased (-0.283220 --> -0.335245).  Saving model ...
Epoch: 3 cost time: 2.328287363052368
Epoch: 3, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.164 Vali Acc: 0.526 Test Loss: 1.164 Test Acc: 0.526
Validation loss decreased (-0.335245 --> -0.526000).  Saving model ...
Epoch: 4 cost time: 2.3207592964172363
Epoch: 4, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.125 Vali Acc: 0.439 Test Loss: 1.125 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.40440034866333
Epoch: 5, Steps: 17 | Train Loss: 0.901 Vali Loss: 0.972 Vali Acc: 0.572 Test Loss: 0.972 Test Acc: 0.572
Validation loss decreased (-0.526000 --> -0.572245).  Saving model ...
Epoch: 6 cost time: 2.143541097640991
Epoch: 6, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.826 Vali Acc: 0.694 Test Loss: 0.826 Test Acc: 0.694
Validation loss decreased (-0.572245 --> -0.693633).  Saving model ...
Epoch: 7 cost time: 2.33212947845459
Epoch: 7, Steps: 17 | Train Loss: 0.589 Vali Loss: 0.775 Vali Acc: 0.642 Test Loss: 0.775 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1854898929595947
Epoch: 8, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.792 Vali Acc: 0.705 Test Loss: 0.792 Test Acc: 0.705
Validation loss decreased (-0.693633 --> -0.705194).  Saving model ...
Epoch: 9 cost time: 2.30125093460083
Epoch: 9, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.794 Vali Acc: 0.682 Test Loss: 0.794 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.425340414047241
Epoch: 10, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.009 Vali Acc: 0.671 Test Loss: 1.009 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.481034278869629
Epoch: 11, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.908 Vali Acc: 0.694 Test Loss: 0.908 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.314467191696167
Epoch: 12, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.816 Vali Acc: 0.763 Test Loss: 0.816 Test Acc: 0.763
Validation loss decreased (-0.705194 --> -0.762998).  Saving model ...
Epoch: 13 cost time: 2.458390474319458
Epoch: 13, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.776 Vali Acc: 0.803 Test Loss: 0.776 Test Acc: 0.803
Validation loss decreased (-0.762998 --> -0.803460).  Saving model ...
Epoch: 14 cost time: 2.2042675018310547
Epoch: 14, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.758 Vali Acc: 0.792 Test Loss: 0.758 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.405132293701172
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.048 Vali Acc: 0.809 Test Loss: 1.048 Test Acc: 0.809
Validation loss decreased (-0.803460 --> -0.809238).  Saving model ...
Epoch: 16 cost time: 2.4405641555786133
Epoch: 16, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.829 Vali Acc: 0.827 Test Loss: 0.829 Test Acc: 0.827
Validation loss decreased (-0.809238 --> -0.826581).  Saving model ...
Epoch: 17 cost time: 2.3547723293304443
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.084 Vali Acc: 0.798 Test Loss: 1.084 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.43172550201416
Epoch: 18, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.168 Vali Acc: 0.792 Test Loss: 1.168 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.398315668106079
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.000 Vali Acc: 0.792 Test Loss: 1.000 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.337509870529175
Epoch: 20, Steps: 17 | Train Loss: 0.053 Vali Loss: 0.869 Vali Acc: 0.792 Test Loss: 0.869 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3775577545166016
Epoch: 21, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.314 Vali Acc: 0.775 Test Loss: 1.314 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4203507900238037
Epoch: 22, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.466 Vali Acc: 0.740 Test Loss: 1.466 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5933029651641846
Epoch: 23, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.280 Vali Acc: 0.780 Test Loss: 1.280 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.436819314956665
Epoch: 24, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.137 Vali Acc: 0.821 Test Loss: 1.137 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.337169647216797
Epoch: 25, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.532 Vali Acc: 0.803 Test Loss: 1.532 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4572017192840576
Epoch: 26, Steps: 17 | Train Loss: 0.112 Vali Loss: 1.319 Vali Acc: 0.792 Test Loss: 1.319 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 783487
model size : 4.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.677323818206787
Epoch: 1, Steps: 17 | Train Loss: 1.920 Vali Loss: 1.634 Vali Acc: 0.335 Test Loss: 1.634 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 2.7949483394622803
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.347 Vali Acc: 0.370 Test Loss: 1.347 Test Acc: 0.370
Validation loss decreased (-0.335244 --> -0.369929).  Saving model ...
Epoch: 3 cost time: 2.5393595695495605
Epoch: 3, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.004 Vali Acc: 0.578 Test Loss: 1.004 Test Acc: 0.578
Validation loss decreased (-0.369929 --> -0.578025).  Saving model ...
Epoch: 4 cost time: 2.6336069107055664
Epoch: 4, Steps: 17 | Train Loss: 0.888 Vali Loss: 0.838 Vali Acc: 0.699 Test Loss: 0.838 Test Acc: 0.699
Validation loss decreased (-0.578025 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 2.565511703491211
Epoch: 5, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.873 Vali Acc: 0.642 Test Loss: 0.873 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.7396481037139893
Epoch: 6, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.712 Vali Acc: 0.746 Test Loss: 0.712 Test Acc: 0.746
Validation loss decreased (-0.699414 --> -0.745658).  Saving model ...
Epoch: 7 cost time: 2.8337748050689697
Epoch: 7, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
Validation loss decreased (-0.745658 --> -0.774560).  Saving model ...
Epoch: 8 cost time: 2.366933584213257
Epoch: 8, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.615 Vali Acc: 0.769 Test Loss: 0.615 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.268047332763672
Epoch: 9, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.618 Vali Acc: 0.798 Test Loss: 0.618 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 2.4033291339874268
Epoch: 10, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.657 Vali Acc: 0.775 Test Loss: 0.657 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.252394199371338
Epoch: 11, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.659 Vali Acc: 0.827 Test Loss: 0.659 Test Acc: 0.827
Validation loss decreased (-0.797682 --> -0.826583).  Saving model ...
Epoch: 12 cost time: 2.5502231121063232
Epoch: 12, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.759 Vali Acc: 0.815 Test Loss: 0.759 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.518738031387329
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.586 Vali Acc: 0.827 Test Loss: 0.586 Test Acc: 0.827
Validation loss decreased (-0.826583 --> -0.826584).  Saving model ...
Epoch: 14 cost time: 2.319392681121826
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.733 Vali Acc: 0.809 Test Loss: 0.733 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.524454355239868
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.645 Vali Acc: 0.803 Test Loss: 0.645 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.635894536972046
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.590 Vali Acc: 0.861 Test Loss: 0.590 Test Acc: 0.861
Validation loss decreased (-0.826584 --> -0.861266).  Saving model ...
Epoch: 17 cost time: 2.837230682373047
Epoch: 17, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.688 Vali Acc: 0.809 Test Loss: 0.688 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6394221782684326
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.904 Vali Acc: 0.792 Test Loss: 0.904 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.325375556945801
Epoch: 19, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.583 Vali Acc: 0.827 Test Loss: 0.583 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5699143409729004
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.632 Vali Acc: 0.832 Test Loss: 0.632 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4036126136779785
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.665 Vali Acc: 0.850 Test Loss: 0.665 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.7233893871307373
Epoch: 22, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.671 Vali Acc: 0.809 Test Loss: 0.671 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.8602309226989746
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.832 Vali Acc: 0.815 Test Loss: 0.832 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.4383277893066406
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.691 Vali Acc: 0.827 Test Loss: 0.691 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.376535177230835
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.792 Vali Acc: 0.809 Test Loss: 0.792 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.486327648162842
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.750 Vali Acc: 0.821 Test Loss: 0.750 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 652415
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.112152338027954
Epoch: 1, Steps: 17 | Train Loss: 1.916 Vali Loss: 1.633 Vali Acc: 0.318 Test Loss: 1.633 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
Epoch: 2 cost time: 2.7358787059783936
Epoch: 2, Steps: 17 | Train Loss: 1.478 Vali Loss: 1.351 Vali Acc: 0.341 Test Loss: 1.351 Test Acc: 0.341
Validation loss decreased (-0.317903 --> -0.341027).  Saving model ...
Epoch: 3 cost time: 2.824585437774658
Epoch: 3, Steps: 17 | Train Loss: 1.117 Vali Loss: 1.006 Vali Acc: 0.595 Test Loss: 1.006 Test Acc: 0.595
Validation loss decreased (-0.341027 --> -0.595366).  Saving model ...
Epoch: 4 cost time: 2.6764938831329346
Epoch: 4, Steps: 17 | Train Loss: 0.898 Vali Loss: 0.856 Vali Acc: 0.694 Test Loss: 0.856 Test Acc: 0.694
Validation loss decreased (-0.595366 --> -0.693633).  Saving model ...
Epoch: 5 cost time: 2.864611864089966
Epoch: 5, Steps: 17 | Train Loss: 0.754 Vali Loss: 0.875 Vali Acc: 0.653 Test Loss: 0.875 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5494191646575928
Epoch: 6, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.732 Vali Acc: 0.711 Test Loss: 0.732 Test Acc: 0.711
Validation loss decreased (-0.693633 --> -0.710975).  Saving model ...
Epoch: 7 cost time: 2.523195743560791
Epoch: 7, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.704 Vali Acc: 0.746 Test Loss: 0.704 Test Acc: 0.746
Validation loss decreased (-0.710975 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 2.697866916656494
Epoch: 8, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.673 Vali Acc: 0.746 Test Loss: 0.673 Test Acc: 0.746
Validation loss decreased (-0.745658 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 2.6209876537323
Epoch: 9, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.622 Vali Acc: 0.827 Test Loss: 0.622 Test Acc: 0.827
Validation loss decreased (-0.745658 --> -0.826583).  Saving model ...
Epoch: 10 cost time: 2.577622652053833
Epoch: 10, Steps: 17 | Train Loss: 0.251 Vali Loss: 0.849 Vali Acc: 0.717 Test Loss: 0.849 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.596688747406006
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.757 Vali Acc: 0.740 Test Loss: 0.757 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.7468366622924805
Epoch: 12, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.622 Vali Acc: 0.809 Test Loss: 0.622 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.922224283218384
Epoch: 13, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.619 Vali Acc: 0.798 Test Loss: 0.619 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.7868998050689697
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.741 Vali Acc: 0.815 Test Loss: 0.741 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.823737621307373
Epoch: 15, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.733 Vali Acc: 0.775 Test Loss: 0.733 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.887195348739624
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.884 Vali Acc: 0.792 Test Loss: 0.884 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4353106021881104
Epoch: 17, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.703 Vali Acc: 0.832 Test Loss: 0.703 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832363).  Saving model ...
Epoch: 18 cost time: 2.6359310150146484
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.385174512863159
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.600 Vali Acc: 0.844 Test Loss: 0.600 Test Acc: 0.844
Validation loss decreased (-0.832363 --> -0.843925).  Saving model ...
Epoch: 20 cost time: 2.673996925354004
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849704).  Saving model ...
Epoch: 21 cost time: 2.4425747394561768
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.815 Test Loss: 0.684 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.596308469772339
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.999 Vali Acc: 0.815 Test Loss: 0.999 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3901591300964355
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.903 Vali Acc: 0.792 Test Loss: 0.903 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.6926186084747314
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.823 Vali Acc: 0.815 Test Loss: 0.823 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.538376569747925
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.858 Vali Acc: 0.809 Test Loss: 0.858 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6380929946899414
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.746 Vali Acc: 0.815 Test Loss: 0.746 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.7491438388824463
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.648 Vali Acc: 0.809 Test Loss: 0.648 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.4367787837982178
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.694 Vali Acc: 0.809 Test Loss: 0.694 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.5436019897460938
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.717 Vali Acc: 0.809 Test Loss: 0.717 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.506199359893799
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.700 Vali Acc: 0.815 Test Loss: 0.700 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 652415
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.844788312911987
Epoch: 1, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.645 Vali Acc: 0.329 Test Loss: 1.645 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 2.505356550216675
Epoch: 2, Steps: 17 | Train Loss: 1.475 Vali Loss: 1.366 Vali Acc: 0.341 Test Loss: 1.366 Test Acc: 0.341
Validation loss decreased (-0.329463 --> -0.341027).  Saving model ...
Epoch: 3 cost time: 2.5677578449249268
Epoch: 3, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.037 Vali Acc: 0.566 Test Loss: 1.037 Test Acc: 0.566
Validation loss decreased (-0.341027 --> -0.566464).  Saving model ...
Epoch: 4 cost time: 2.443909168243408
Epoch: 4, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.899 Vali Acc: 0.671 Test Loss: 0.899 Test Acc: 0.671
Validation loss decreased (-0.566464 --> -0.670511).  Saving model ...
Epoch: 5 cost time: 2.2916266918182373
Epoch: 5, Steps: 17 | Train Loss: 0.786 Vali Loss: 0.913 Vali Acc: 0.618 Test Loss: 0.913 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3825061321258545
Epoch: 6, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.753 Vali Acc: 0.676 Test Loss: 0.753 Test Acc: 0.676
Validation loss decreased (-0.670511 --> -0.676293).  Saving model ...
Epoch: 7 cost time: 2.4701719284057617
Epoch: 7, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.743 Vali Acc: 0.734 Test Loss: 0.743 Test Acc: 0.734
Validation loss decreased (-0.676293 --> -0.734097).  Saving model ...
Epoch: 8 cost time: 2.403174877166748
Epoch: 8, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.714 Vali Acc: 0.746 Test Loss: 0.714 Test Acc: 0.746
Validation loss decreased (-0.734097 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 2.3915464878082275
Epoch: 9, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.658 Vali Acc: 0.775 Test Loss: 0.658 Test Acc: 0.775
Validation loss decreased (-0.745658 --> -0.774560).  Saving model ...
Epoch: 10 cost time: 2.5217432975769043
Epoch: 10, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.847 Vali Acc: 0.711 Test Loss: 0.847 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.430957078933716
Epoch: 11, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.880 Vali Acc: 0.740 Test Loss: 0.880 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.767653465270996
Epoch: 12, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.703 Vali Acc: 0.775 Test Loss: 0.703 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5357701778411865
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.677 Vali Acc: 0.798 Test Loss: 0.677 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797681).  Saving model ...
Epoch: 14 cost time: 2.4980552196502686
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.798 Vali Acc: 0.769 Test Loss: 0.798 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.7901461124420166
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.695 Vali Acc: 0.786 Test Loss: 0.695 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.469069242477417
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.156 Vali Acc: 0.751 Test Loss: 1.156 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4609081745147705
Epoch: 17, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.710 Vali Acc: 0.809 Test Loss: 0.710 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809241).  Saving model ...
Epoch: 18 cost time: 2.3402881622314453
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.643 Vali Acc: 0.827 Test Loss: 0.643 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826583).  Saving model ...
Epoch: 19 cost time: 2.4473025798797607
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.703 Vali Acc: 0.832 Test Loss: 0.703 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832363).  Saving model ...
Epoch: 20 cost time: 2.564795970916748
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.821 Test Loss: 0.781 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5783350467681885
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.742 Vali Acc: 0.827 Test Loss: 0.742 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3007102012634277
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.912 Vali Acc: 0.809 Test Loss: 0.912 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.2978103160858154
Epoch: 23, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.751 Vali Acc: 0.838 Test Loss: 0.751 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838143).  Saving model ...
Epoch: 24 cost time: 2.1822075843811035
Epoch: 24, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.691 Vali Acc: 0.827 Test Loss: 0.691 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.351365566253662
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.015 Vali Acc: 0.792 Test Loss: 1.015 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.1736321449279785
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.912 Vali Acc: 0.832 Test Loss: 0.912 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.4275665283203125
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.815 Test Loss: 0.791 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.5652544498443604
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.948 Vali Acc: 0.803 Test Loss: 0.948 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.399956226348877
Epoch: 29, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.106 Vali Acc: 0.815 Test Loss: 1.106 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.435478448867798
Epoch: 30, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.300 Vali Acc: 0.763 Test Loss: 1.300 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.237375259399414
Epoch: 31, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.982 Vali Acc: 0.827 Test Loss: 0.982 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.2994556427001953
Epoch: 32, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.177 Vali Acc: 0.780 Test Loss: 1.177 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.3673503398895264
Epoch: 33, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.040 Vali Acc: 0.809 Test Loss: 1.040 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 652415
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.614947557449341
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.696 Vali Acc: 0.301 Test Loss: 1.696 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 2.637084722518921
Epoch: 2, Steps: 17 | Train Loss: 1.520 Vali Loss: 1.388 Vali Acc: 0.318 Test Loss: 1.388 Test Acc: 0.318
Validation loss decreased (-0.300561 --> -0.317905).  Saving model ...
Epoch: 3 cost time: 2.4245471954345703
Epoch: 3, Steps: 17 | Train Loss: 1.203 Vali Loss: 1.119 Vali Acc: 0.555 Test Loss: 1.119 Test Acc: 0.555
Validation loss decreased (-0.317905 --> -0.554902).  Saving model ...
Epoch: 4 cost time: 2.5658364295959473
Epoch: 4, Steps: 17 | Train Loss: 1.045 Vali Loss: 1.002 Vali Acc: 0.590 Test Loss: 1.002 Test Acc: 0.590
Validation loss decreased (-0.554902 --> -0.589585).  Saving model ...
Epoch: 5 cost time: 2.5773837566375732
Epoch: 5, Steps: 17 | Train Loss: 0.879 Vali Loss: 0.953 Vali Acc: 0.665 Test Loss: 0.953 Test Acc: 0.665
Validation loss decreased (-0.589585 --> -0.664730).  Saving model ...
Epoch: 6 cost time: 2.5247395038604736
Epoch: 6, Steps: 17 | Train Loss: 0.736 Vali Loss: 0.881 Vali Acc: 0.636 Test Loss: 0.881 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.515627145767212
Epoch: 7, Steps: 17 | Train Loss: 0.580 Vali Loss: 0.753 Vali Acc: 0.780 Test Loss: 0.753 Test Acc: 0.780
Validation loss decreased (-0.664730 --> -0.780339).  Saving model ...
Epoch: 8 cost time: 2.4541707038879395
Epoch: 8, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.880 Vali Acc: 0.647 Test Loss: 0.880 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.673459768295288
Epoch: 9, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.730 Vali Acc: 0.775 Test Loss: 0.730 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3587958812713623
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.905 Vali Acc: 0.653 Test Loss: 0.905 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5842466354370117
Epoch: 11, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.926 Vali Acc: 0.653 Test Loss: 0.926 Test Acc: 0.653
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 3.1422269344329834
Epoch: 12, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.769 Vali Acc: 0.723 Test Loss: 0.769 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.8190901279449463
Epoch: 13, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.798 Vali Acc: 0.728 Test Loss: 0.798 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.9514012336730957
Epoch: 14, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.492 Vali Acc: 0.676 Test Loss: 1.492 Test Acc: 0.676
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 3.3800179958343506
Epoch: 15, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.763 Vali Acc: 0.786 Test Loss: 0.763 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786120).  Saving model ...
Epoch: 16 cost time: 2.8195385932922363
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.113 Vali Acc: 0.734 Test Loss: 1.113 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.93038010597229
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.791 Vali Acc: 0.809 Test Loss: 0.791 Test Acc: 0.809
Validation loss decreased (-0.786120 --> -0.809241).  Saving model ...
Epoch: 18 cost time: 2.7825090885162354
Epoch: 18, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.988 Vali Acc: 0.780 Test Loss: 0.988 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.974743604660034
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.602 Vali Acc: 0.717 Test Loss: 1.602 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.867530107498169
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.155 Vali Acc: 0.780 Test Loss: 1.155 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.831652879714966
Epoch: 21, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.564 Vali Acc: 0.728 Test Loss: 1.564 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.8501436710357666
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.964 Vali Acc: 0.792 Test Loss: 0.964 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.7188987731933594
Epoch: 23, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.002 Vali Acc: 0.786 Test Loss: 1.002 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.684796094894409
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.047 Vali Acc: 0.775 Test Loss: 1.047 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 3.3213062286376953
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.556 Vali Acc: 0.751 Test Loss: 1.556 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.201112985610962
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.213 Vali Acc: 0.798 Test Loss: 1.213 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8018107414245605
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.272 Vali Acc: 0.815 Test Loss: 1.272 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815016).  Saving model ...
Epoch: 28 cost time: 2.9296762943267822
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.332 Vali Acc: 0.815 Test Loss: 1.332 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 3.0453898906707764
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.061 Vali Acc: 0.815 Test Loss: 1.061 Test Acc: 0.815
Validation loss decreased (-0.815016 --> -0.815018).  Saving model ...
Epoch: 30 cost time: 2.8730382919311523
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.122 Vali Acc: 0.815 Test Loss: 1.122 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.6322174072265625
Epoch: 31, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.245 Vali Acc: 0.803 Test Loss: 1.245 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 3.0714213848114014
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.613 Vali Acc: 0.780 Test Loss: 1.613 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 3.064330816268921
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.742 Vali Acc: 0.792 Test Loss: 1.742 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.824028730392456
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.167 Vali Acc: 0.780 Test Loss: 1.167 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 2.982936143875122
Epoch: 35, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.577 Vali Acc: 0.775 Test Loss: 1.577 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 2.8134429454803467
Epoch: 36, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.331 Vali Acc: 0.815 Test Loss: 1.331 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.863042116165161
Epoch: 37, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.653 Vali Acc: 0.809 Test Loss: 1.653 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 3.2020726203918457
Epoch: 38, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.533 Vali Acc: 0.798 Test Loss: 1.533 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.742223024368286
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.347 Vali Acc: 0.803 Test Loss: 1.347 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 652415
model size : 3.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.676177501678467
Epoch: 1, Steps: 17 | Train Loss: 1.890 Vali Loss: 1.641 Vali Acc: 0.306 Test Loss: 1.641 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.496540069580078
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.296 Vali Acc: 0.486 Test Loss: 1.296 Test Acc: 0.486
Validation loss decreased (-0.306342 --> -0.485536).  Saving model ...
Epoch: 3 cost time: 2.5394341945648193
Epoch: 3, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.090 Vali Acc: 0.468 Test Loss: 1.090 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3035576343536377
Epoch: 4, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.991 Vali Acc: 0.514 Test Loss: 0.991 Test Acc: 0.514
Validation loss decreased (-0.485536 --> -0.514441).  Saving model ...
Epoch: 5 cost time: 2.3057756423950195
Epoch: 5, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.962 Vali Acc: 0.642 Test Loss: 0.962 Test Acc: 0.642
Validation loss decreased (-0.514441 --> -0.641609).  Saving model ...
Epoch: 6 cost time: 2.4195587635040283
Epoch: 6, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.743 Vali Acc: 0.757 Test Loss: 0.743 Test Acc: 0.757
Validation loss decreased (-0.641609 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 2.394958257675171
Epoch: 7, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.678 Vali Acc: 0.769 Test Loss: 0.678 Test Acc: 0.769
Validation loss decreased (-0.757218 --> -0.768779).  Saving model ...
Epoch: 8 cost time: 2.392646551132202
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.656 Vali Acc: 0.763 Test Loss: 0.656 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4163119792938232
Epoch: 9, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.678 Vali Acc: 0.780 Test Loss: 0.678 Test Acc: 0.780
Validation loss decreased (-0.768779 --> -0.780340).  Saving model ...
Epoch: 10 cost time: 2.3811748027801514
Epoch: 10, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.618 Vali Acc: 0.792 Test Loss: 0.618 Test Acc: 0.792
Validation loss decreased (-0.780340 --> -0.791901).  Saving model ...
Epoch: 11 cost time: 2.7470955848693848
Epoch: 11, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.548 Vali Acc: 0.850 Test Loss: 0.548 Test Acc: 0.850
Validation loss decreased (-0.791901 --> -0.849706).  Saving model ...
Epoch: 12 cost time: 2.808168888092041
Epoch: 12, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.567 Vali Acc: 0.821 Test Loss: 0.567 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.6796488761901855
Epoch: 13, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.688 Vali Acc: 0.803 Test Loss: 0.688 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.4642245769500732
Epoch: 14, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.688 Vali Acc: 0.867 Test Loss: 0.688 Test Acc: 0.867
Validation loss decreased (-0.849706 --> -0.867045).  Saving model ...
Epoch: 15 cost time: 2.4278690814971924
Epoch: 15, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.876 Vali Acc: 0.803 Test Loss: 0.876 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.3909873962402344
Epoch: 16, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.697 Vali Acc: 0.827 Test Loss: 0.697 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.2944843769073486
Epoch: 17, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.627 Vali Acc: 0.844 Test Loss: 0.627 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.39968204498291
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.796 Vali Acc: 0.844 Test Loss: 0.796 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.5024664402008057
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.885 Vali Acc: 0.780 Test Loss: 0.885 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.611647844314575
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.857 Vali Acc: 0.832 Test Loss: 0.857 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.7225372791290283
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.865 Vali Acc: 0.838 Test Loss: 0.865 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.5946807861328125
Epoch: 22, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.940 Vali Acc: 0.838 Test Loss: 0.940 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 2.696295738220215
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.882 Vali Acc: 0.769 Test Loss: 0.882 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.350182056427002
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.639 Vali Acc: 0.699 Test Loss: 1.639 Test Acc: 0.699
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 586879
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.775359630584717
Epoch: 1, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.640 Vali Acc: 0.306 Test Loss: 1.640 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.591823101043701
Epoch: 2, Steps: 17 | Train Loss: 1.488 Vali Loss: 1.300 Vali Acc: 0.497 Test Loss: 1.300 Test Acc: 0.497
Validation loss decreased (-0.306342 --> -0.497097).  Saving model ...
Epoch: 3 cost time: 2.6420817375183105
Epoch: 3, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.097 Vali Acc: 0.468 Test Loss: 1.097 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.894914388656616
Epoch: 4, Steps: 17 | Train Loss: 0.959 Vali Loss: 1.014 Vali Acc: 0.480 Test Loss: 1.014 Test Acc: 0.480
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.6066272258758545
Epoch: 5, Steps: 17 | Train Loss: 0.823 Vali Loss: 0.973 Vali Acc: 0.642 Test Loss: 0.973 Test Acc: 0.642
Validation loss decreased (-0.497097 --> -0.641609).  Saving model ...
Epoch: 6 cost time: 2.6348683834075928
Epoch: 6, Steps: 17 | Train Loss: 0.615 Vali Loss: 0.804 Vali Acc: 0.711 Test Loss: 0.804 Test Acc: 0.711
Validation loss decreased (-0.641609 --> -0.710975).  Saving model ...
Epoch: 7 cost time: 2.6534061431884766
Epoch: 7, Steps: 17 | Train Loss: 0.491 Vali Loss: 0.725 Vali Acc: 0.757 Test Loss: 0.725 Test Acc: 0.757
Validation loss decreased (-0.710975 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 2.5752108097076416
Epoch: 8, Steps: 17 | Train Loss: 0.398 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5234973430633545
Epoch: 9, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.707 Vali Acc: 0.775 Test Loss: 0.707 Test Acc: 0.775
Validation loss decreased (-0.757218 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 2.6773438453674316
Epoch: 10, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.586 Vali Acc: 0.803 Test Loss: 0.586 Test Acc: 0.803
Validation loss decreased (-0.774559 --> -0.803462).  Saving model ...
Epoch: 11 cost time: 2.705479621887207
Epoch: 11, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.500 Vali Acc: 0.850 Test Loss: 0.500 Test Acc: 0.850
Validation loss decreased (-0.803462 --> -0.849706).  Saving model ...
Epoch: 12 cost time: 2.294935941696167
Epoch: 12, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.670 Vali Acc: 0.780 Test Loss: 0.670 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.7646896839141846
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.940 Vali Acc: 0.734 Test Loss: 0.940 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.7940540313720703
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8486711978912354
Epoch: 15, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.765 Vali Acc: 0.821 Test Loss: 0.765 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7884671688079834
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.631 Vali Acc: 0.844 Test Loss: 0.631 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.6249072551727295
Epoch: 17, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.302572011947632
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.707 Vali Acc: 0.792 Test Loss: 0.707 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.327754497528076
Epoch: 19, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.2620182037353516
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.973 Vali Acc: 0.792 Test Loss: 0.973 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.470681667327881
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.776 Vali Acc: 0.815 Test Loss: 0.776 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 586879
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.952785015106201
Epoch: 1, Steps: 17 | Train Loss: 1.898 Vali Loss: 1.645 Vali Acc: 0.324 Test Loss: 1.645 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 2.466207981109619
Epoch: 2, Steps: 17 | Train Loss: 1.511 Vali Loss: 1.317 Vali Acc: 0.451 Test Loss: 1.317 Test Acc: 0.451
Validation loss decreased (-0.323683 --> -0.450854).  Saving model ...
Epoch: 3 cost time: 2.36875581741333
Epoch: 3, Steps: 17 | Train Loss: 1.176 Vali Loss: 1.125 Vali Acc: 0.462 Test Loss: 1.125 Test Acc: 0.462
Validation loss decreased (-0.450854 --> -0.462416).  Saving model ...
Epoch: 4 cost time: 2.3484761714935303
Epoch: 4, Steps: 17 | Train Loss: 0.988 Vali Loss: 1.055 Vali Acc: 0.451 Test Loss: 1.055 Test Acc: 0.451
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7932162284851074
Epoch: 5, Steps: 17 | Train Loss: 0.844 Vali Loss: 0.977 Vali Acc: 0.618 Test Loss: 0.977 Test Acc: 0.618
Validation loss decreased (-0.462416 --> -0.618487).  Saving model ...
Epoch: 6 cost time: 2.4336743354797363
Epoch: 6, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.813 Vali Acc: 0.682 Test Loss: 0.813 Test Acc: 0.682
Validation loss decreased (-0.618487 --> -0.682073).  Saving model ...
Epoch: 7 cost time: 2.3130810260772705
Epoch: 7, Steps: 17 | Train Loss: 0.520 Vali Loss: 0.738 Vali Acc: 0.763 Test Loss: 0.738 Test Acc: 0.763
Validation loss decreased (-0.682073 --> -0.762998).  Saving model ...
Epoch: 8 cost time: 2.3480122089385986
Epoch: 8, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.762 Vali Acc: 0.723 Test Loss: 0.762 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.5096828937530518
Epoch: 9, Steps: 17 | Train Loss: 0.369 Vali Loss: 0.594 Vali Acc: 0.815 Test Loss: 0.594 Test Acc: 0.815
Validation loss decreased (-0.762998 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 2.3662002086639404
Epoch: 10, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.732 Vali Acc: 0.763 Test Loss: 0.732 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6367738246917725
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
Validation loss decreased (-0.815023 --> -0.849705).  Saving model ...
Epoch: 12 cost time: 2.3323678970336914
Epoch: 12, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.734 Vali Acc: 0.769 Test Loss: 0.734 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.541400909423828
Epoch: 13, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.764 Vali Acc: 0.746 Test Loss: 0.764 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.5261001586914062
Epoch: 14, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.657 Vali Acc: 0.832 Test Loss: 0.657 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.447216272354126
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.716 Vali Acc: 0.798 Test Loss: 0.716 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.361292839050293
Epoch: 16, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.682 Vali Acc: 0.821 Test Loss: 0.682 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.55405855178833
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.855 Vali Acc: 0.786 Test Loss: 0.855 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.536243200302124
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.746 Vali Acc: 0.792 Test Loss: 0.746 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.624619245529175
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.903 Vali Acc: 0.821 Test Loss: 0.903 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.4951975345611572
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.803 Test Loss: 0.781 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.5306992530822754
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.798 Vali Acc: 0.803 Test Loss: 0.798 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 586879
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.499669313430786
Epoch: 1, Steps: 17 | Train Loss: 1.909 Vali Loss: 1.701 Vali Acc: 0.318 Test Loss: 1.701 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
Epoch: 2 cost time: 2.564025402069092
Epoch: 2, Steps: 17 | Train Loss: 1.571 Vali Loss: 1.385 Vali Acc: 0.405 Test Loss: 1.385 Test Acc: 0.405
Validation loss decreased (-0.317902 --> -0.404610).  Saving model ...
Epoch: 3 cost time: 2.4457414150238037
Epoch: 3, Steps: 17 | Train Loss: 1.241 Vali Loss: 1.187 Vali Acc: 0.434 Test Loss: 1.187 Test Acc: 0.434
Validation loss decreased (-0.404610 --> -0.433514).  Saving model ...
Epoch: 4 cost time: 2.749307870864868
Epoch: 4, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.121 Vali Acc: 0.462 Test Loss: 1.121 Test Acc: 0.462
Validation loss decreased (-0.433514 --> -0.462417).  Saving model ...
Epoch: 5 cost time: 2.1788489818573
Epoch: 5, Steps: 17 | Train Loss: 0.921 Vali Loss: 1.041 Vali Acc: 0.665 Test Loss: 1.041 Test Acc: 0.665
Validation loss decreased (-0.462417 --> -0.664729).  Saving model ...
Epoch: 6 cost time: 2.214317798614502
Epoch: 6, Steps: 17 | Train Loss: 0.747 Vali Loss: 0.911 Vali Acc: 0.659 Test Loss: 0.911 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.162282705307007
Epoch: 7, Steps: 17 | Train Loss: 0.627 Vali Loss: 0.881 Vali Acc: 0.653 Test Loss: 0.881 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.1639206409454346
Epoch: 8, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.823 Vali Acc: 0.688 Test Loss: 0.823 Test Acc: 0.688
Validation loss decreased (-0.664729 --> -0.687853).  Saving model ...
Epoch: 9 cost time: 2.3895792961120605
Epoch: 9, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.870 Vali Acc: 0.688 Test Loss: 0.870 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1387362480163574
Epoch: 10, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.658 Vali Acc: 0.775 Test Loss: 0.658 Test Acc: 0.775
Validation loss decreased (-0.687853 --> -0.774560).  Saving model ...
Epoch: 11 cost time: 2.1206586360931396
Epoch: 11, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.875 Vali Acc: 0.728 Test Loss: 0.875 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2071449756622314
Epoch: 12, Steps: 17 | Train Loss: 0.235 Vali Loss: 0.730 Vali Acc: 0.746 Test Loss: 0.730 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3393280506134033
Epoch: 13, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.137 Vali Acc: 0.694 Test Loss: 1.137 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.238389492034912
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.021 Vali Acc: 0.723 Test Loss: 1.021 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.3098182678222656
Epoch: 15, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.923 Vali Acc: 0.809 Test Loss: 0.923 Test Acc: 0.809
Validation loss decreased (-0.774560 --> -0.809239).  Saving model ...
Epoch: 16 cost time: 2.207974433898926
Epoch: 16, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.931 Vali Acc: 0.775 Test Loss: 0.931 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.376023769378662
Epoch: 17, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.827 Vali Acc: 0.798 Test Loss: 0.827 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.217872381210327
Epoch: 18, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.773 Vali Acc: 0.832 Test Loss: 0.773 Test Acc: 0.832
Validation loss decreased (-0.809239 --> -0.832362).  Saving model ...
Epoch: 19 cost time: 2.318943500518799
Epoch: 19, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.450 Vali Acc: 0.699 Test Loss: 1.450 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.231071949005127
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.905 Vali Acc: 0.763 Test Loss: 0.905 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2729339599609375
Epoch: 21, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.897 Vali Acc: 0.769 Test Loss: 0.897 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.273282766342163
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.031 Vali Acc: 0.763 Test Loss: 1.031 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.401059865951538
Epoch: 23, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.931 Vali Acc: 0.780 Test Loss: 0.931 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.3368208408355713
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.939 Vali Acc: 0.780 Test Loss: 0.939 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.3008975982666016
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.789 Vali Acc: 0.844 Test Loss: 0.789 Test Acc: 0.844
Validation loss decreased (-0.832362 --> -0.843923).  Saving model ...
Epoch: 26 cost time: 2.3744261264801025
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.850 Test Loss: 0.897 Test Acc: 0.850
Validation loss decreased (-0.843923 --> -0.849702).  Saving model ...
Epoch: 27 cost time: 2.3470797538757324
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.809 Test Loss: 0.800 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.2895331382751465
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.832 Test Loss: 0.854 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.2736642360687256
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.869 Vali Acc: 0.815 Test Loss: 0.869 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.440797805786133
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.833 Vali Acc: 0.821 Test Loss: 0.833 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.5273234844207764
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.832 Test Loss: 0.861 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.4792189598083496
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.846 Vali Acc: 0.827 Test Loss: 0.846 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.2288904190063477
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.844 Vali Acc: 0.832 Test Loss: 0.844 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.354513168334961
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.821 Test Loss: 0.826 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.3453481197357178
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.880 Vali Acc: 0.838 Test Loss: 0.880 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.529534339904785
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.884 Vali Acc: 0.809 Test Loss: 0.884 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 586879
model size : 3.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.870699644088745
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.690 Vali Acc: 0.301 Test Loss: 1.690 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 2.384182929992676
Epoch: 2, Steps: 17 | Train Loss: 1.446 Vali Loss: 1.262 Vali Acc: 0.457 Test Loss: 1.262 Test Acc: 0.457
Validation loss decreased (-0.300561 --> -0.456635).  Saving model ...
Epoch: 3 cost time: 2.2438814640045166
Epoch: 3, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.042 Vali Acc: 0.630 Test Loss: 1.042 Test Acc: 0.630
Validation loss decreased (-0.456635 --> -0.630047).  Saving model ...
Epoch: 4 cost time: 2.2586681842803955
Epoch: 4, Steps: 17 | Train Loss: 0.856 Vali Loss: 0.875 Vali Acc: 0.694 Test Loss: 0.875 Test Acc: 0.694
Validation loss decreased (-0.630047 --> -0.693633).  Saving model ...
Epoch: 5 cost time: 2.5056705474853516
Epoch: 5, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.876 Vali Acc: 0.636 Test Loss: 0.876 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.796473503112793
Epoch: 6, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.709 Vali Acc: 0.780 Test Loss: 0.709 Test Acc: 0.780
Validation loss decreased (-0.693633 --> -0.780340).  Saving model ...
Epoch: 7 cost time: 2.7034311294555664
Epoch: 7, Steps: 17 | Train Loss: 0.507 Vali Loss: 0.685 Vali Acc: 0.751 Test Loss: 0.685 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.61742901802063
Epoch: 8, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.719 Vali Acc: 0.740 Test Loss: 0.719 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.533135414123535
Epoch: 9, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.520 Vali Acc: 0.821 Test Loss: 0.520 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820804).  Saving model ...
Epoch: 10 cost time: 2.6996240615844727
Epoch: 10, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.705 Vali Acc: 0.757 Test Loss: 0.705 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.534511089324951
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.697 Vali Acc: 0.751 Test Loss: 0.697 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6151649951934814
Epoch: 12, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.910 Vali Acc: 0.769 Test Loss: 0.910 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.8466365337371826
Epoch: 13, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.558 Vali Acc: 0.879 Test Loss: 0.558 Test Acc: 0.879
Validation loss decreased (-0.820804 --> -0.878607).  Saving model ...
Epoch: 14 cost time: 2.8634965419769287
Epoch: 14, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.626 Vali Acc: 0.832 Test Loss: 0.626 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.0627450942993164
Epoch: 15, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.710 Vali Acc: 0.803 Test Loss: 0.710 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8058056831359863
Epoch: 16, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.678 Vali Acc: 0.844 Test Loss: 0.678 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9279415607452393
Epoch: 17, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.9029500484466553
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.757 Vali Acc: 0.832 Test Loss: 0.757 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.652557849884033
Epoch: 19, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.035 Vali Acc: 0.751 Test Loss: 1.035 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.829585552215576
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.617 Vali Acc: 0.838 Test Loss: 0.617 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.6513144969940186
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.883 Vali Acc: 0.809 Test Loss: 0.883 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.6954843997955322
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.860 Vali Acc: 0.809 Test Loss: 0.860 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.8421549797058105
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.004 Vali Acc: 0.815 Test Loss: 1.004 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8786127167630058
model parameter : 554111
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.447476625442505
Epoch: 1, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.687 Vali Acc: 0.306 Test Loss: 1.687 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.5124056339263916
Epoch: 2, Steps: 17 | Train Loss: 1.469 Vali Loss: 1.276 Vali Acc: 0.457 Test Loss: 1.276 Test Acc: 0.457
Validation loss decreased (-0.306342 --> -0.456635).  Saving model ...
Epoch: 3 cost time: 2.447021007537842
Epoch: 3, Steps: 17 | Train Loss: 1.137 Vali Loss: 1.065 Vali Acc: 0.595 Test Loss: 1.065 Test Acc: 0.595
Validation loss decreased (-0.456635 --> -0.595365).  Saving model ...
Epoch: 4 cost time: 2.5451650619506836
Epoch: 4, Steps: 17 | Train Loss: 0.884 Vali Loss: 0.908 Vali Acc: 0.659 Test Loss: 0.908 Test Acc: 0.659
Validation loss decreased (-0.595365 --> -0.658950).  Saving model ...
Epoch: 5 cost time: 2.6384758949279785
Epoch: 5, Steps: 17 | Train Loss: 0.772 Vali Loss: 0.887 Vali Acc: 0.630 Test Loss: 0.887 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3776626586914062
Epoch: 6, Steps: 17 | Train Loss: 0.618 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.658950 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 2.4254066944122314
Epoch: 7, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.727 Vali Acc: 0.728 Test Loss: 0.727 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.686887264251709
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.753 Vali Acc: 0.717 Test Loss: 0.753 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4951484203338623
Epoch: 9, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.549 Vali Acc: 0.815 Test Loss: 0.549 Test Acc: 0.815
Validation loss decreased (-0.774559 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 2.528510570526123
Epoch: 10, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.715 Vali Acc: 0.786 Test Loss: 0.715 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.509774684906006
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.656 Vali Acc: 0.757 Test Loss: 0.656 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2605693340301514
Epoch: 12, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.132 Vali Acc: 0.740 Test Loss: 1.132 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.3920631408691406
Epoch: 13, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.561 Vali Acc: 0.827 Test Loss: 0.561 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 14 cost time: 2.6346943378448486
Epoch: 14, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.665 Vali Acc: 0.827 Test Loss: 0.665 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.551301956176758
Epoch: 15, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.658 Vali Acc: 0.815 Test Loss: 0.658 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3414790630340576
Epoch: 16, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.648 Vali Acc: 0.844 Test Loss: 0.648 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843924).  Saving model ...
Epoch: 17 cost time: 2.3174068927764893
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.744 Vali Acc: 0.803 Test Loss: 0.744 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4911153316497803
Epoch: 18, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.805 Vali Acc: 0.763 Test Loss: 0.805 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.4717798233032227
Epoch: 19, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.821 Test Loss: 0.809 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.2964110374450684
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.111 Vali Acc: 0.763 Test Loss: 1.111 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3014397621154785
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.844 Vali Acc: 0.809 Test Loss: 0.844 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.363701105117798
Epoch: 22, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.911 Vali Acc: 0.821 Test Loss: 0.911 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.5773332118988037
Epoch: 23, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.467 Vali Acc: 0.763 Test Loss: 1.467 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5158188343048096
Epoch: 24, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.884 Vali Acc: 0.815 Test Loss: 0.884 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5262155532836914
Epoch: 25, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.039 Vali Acc: 0.821 Test Loss: 1.039 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.4613921642303467
Epoch: 26, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.023 Vali Acc: 0.827 Test Loss: 1.023 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 554111
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.381054639816284
Epoch: 1, Steps: 17 | Train Loss: 1.862 Vali Loss: 1.714 Vali Acc: 0.318 Test Loss: 1.714 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
Epoch: 2 cost time: 2.201221466064453
Epoch: 2, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.290 Vali Acc: 0.462 Test Loss: 1.290 Test Acc: 0.462
Validation loss decreased (-0.317902 --> -0.462415).  Saving model ...
Epoch: 3 cost time: 2.17864990234375
Epoch: 3, Steps: 17 | Train Loss: 1.161 Vali Loss: 1.068 Vali Acc: 0.607 Test Loss: 1.068 Test Acc: 0.607
Validation loss decreased (-0.462415 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 2.3229939937591553
Epoch: 4, Steps: 17 | Train Loss: 0.909 Vali Loss: 0.935 Vali Acc: 0.676 Test Loss: 0.935 Test Acc: 0.676
Validation loss decreased (-0.606926 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 2.5525386333465576
Epoch: 5, Steps: 17 | Train Loss: 0.801 Vali Loss: 0.992 Vali Acc: 0.532 Test Loss: 0.992 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.494018793106079
Epoch: 6, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.771 Vali Acc: 0.705 Test Loss: 0.771 Test Acc: 0.705
Validation loss decreased (-0.676291 --> -0.705195).  Saving model ...
Epoch: 7 cost time: 2.2235498428344727
Epoch: 7, Steps: 17 | Train Loss: 0.515 Vali Loss: 0.697 Vali Acc: 0.746 Test Loss: 0.697 Test Acc: 0.746
Validation loss decreased (-0.705195 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 2.253753185272217
Epoch: 8, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.774 Vali Acc: 0.728 Test Loss: 0.774 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.205888271331787
Epoch: 9, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.611 Vali Acc: 0.827 Test Loss: 0.611 Test Acc: 0.827
Validation loss decreased (-0.745658 --> -0.826583).  Saving model ...
Epoch: 10 cost time: 2.314903736114502
Epoch: 10, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.690 Vali Acc: 0.792 Test Loss: 0.690 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4629921913146973
Epoch: 11, Steps: 17 | Train Loss: 0.189 Vali Loss: 0.678 Vali Acc: 0.769 Test Loss: 0.678 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.259593963623047
Epoch: 12, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.028 Vali Acc: 0.734 Test Loss: 1.028 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.156776189804077
Epoch: 13, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.537 Vali Acc: 0.838 Test Loss: 0.537 Test Acc: 0.838
Validation loss decreased (-0.826583 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 2.3079004287719727
Epoch: 14, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.706 Vali Acc: 0.775 Test Loss: 0.706 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.315143346786499
Epoch: 15, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843924).  Saving model ...
Epoch: 16 cost time: 2.3570008277893066
Epoch: 16, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.778 Vali Acc: 0.827 Test Loss: 0.778 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.5140743255615234
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.793 Vali Acc: 0.821 Test Loss: 0.793 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.393209218978882
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.756 Vali Acc: 0.821 Test Loss: 0.756 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.1273415088653564
Epoch: 19, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.650 Vali Acc: 0.832 Test Loss: 0.650 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.098010540008545
Epoch: 20, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.741 Vali Acc: 0.815 Test Loss: 0.741 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.1026086807250977
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.721 Vali Acc: 0.827 Test Loss: 0.721 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2636642456054688
Epoch: 22, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.795 Vali Acc: 0.827 Test Loss: 0.795 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.5767242908477783
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.832 Test Loss: 0.800 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.733146905899048
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.824 Vali Acc: 0.809 Test Loss: 0.824 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.4993693828582764
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.828 Vali Acc: 0.827 Test Loss: 0.828 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 554111
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.460248708724976
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.747 Vali Acc: 0.295 Test Loss: 1.747 Test Acc: 0.295
Validation loss decreased (inf --> -0.294780).  Saving model ...
Epoch: 2 cost time: 2.2196178436279297
Epoch: 2, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.350 Vali Acc: 0.462 Test Loss: 1.350 Test Acc: 0.462
Validation loss decreased (-0.294780 --> -0.462414).  Saving model ...
Epoch: 3 cost time: 2.3149924278259277
Epoch: 3, Steps: 17 | Train Loss: 1.215 Vali Loss: 1.121 Vali Acc: 0.555 Test Loss: 1.121 Test Acc: 0.555
Validation loss decreased (-0.462414 --> -0.554902).  Saving model ...
Epoch: 4 cost time: 2.2409191131591797
Epoch: 4, Steps: 17 | Train Loss: 0.983 Vali Loss: 1.032 Vali Acc: 0.584 Test Loss: 1.032 Test Acc: 0.584
Validation loss decreased (-0.554902 --> -0.583805).  Saving model ...
Epoch: 5 cost time: 2.262266159057617
Epoch: 5, Steps: 17 | Train Loss: 0.919 Vali Loss: 1.112 Vali Acc: 0.480 Test Loss: 1.112 Test Acc: 0.480
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2989754676818848
Epoch: 6, Steps: 17 | Train Loss: 0.768 Vali Loss: 0.940 Vali Acc: 0.543 Test Loss: 0.940 Test Acc: 0.543
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.3270883560180664
Epoch: 7, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.812 Vali Acc: 0.688 Test Loss: 0.812 Test Acc: 0.688
Validation loss decreased (-0.583805 --> -0.687853).  Saving model ...
Epoch: 8 cost time: 2.3177108764648438
Epoch: 8, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.803 Vali Acc: 0.671 Test Loss: 0.803 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1160738468170166
Epoch: 9, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.689 Vali Acc: 0.775 Test Loss: 0.689 Test Acc: 0.775
Validation loss decreased (-0.687853 --> -0.774560).  Saving model ...
Epoch: 10 cost time: 2.2112536430358887
Epoch: 10, Steps: 17 | Train Loss: 0.324 Vali Loss: 0.785 Vali Acc: 0.740 Test Loss: 0.785 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4980664253234863
Epoch: 11, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.791 Vali Acc: 0.717 Test Loss: 0.791 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.569652795791626
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.950 Vali Acc: 0.723 Test Loss: 0.950 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5837464332580566
Epoch: 13, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.759 Vali Acc: 0.723 Test Loss: 0.759 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.4148781299591064
Epoch: 14, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.805 Vali Acc: 0.803 Test Loss: 0.805 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803460).  Saving model ...
Epoch: 15 cost time: 2.4468681812286377
Epoch: 15, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.663 Vali Acc: 0.803 Test Loss: 0.663 Test Acc: 0.803
Validation loss decreased (-0.803460 --> -0.803462).  Saving model ...
Epoch: 16 cost time: 2.467334508895874
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.794 Vali Acc: 0.809 Test Loss: 0.794 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809241).  Saving model ...
Epoch: 17 cost time: 2.3561642169952393
Epoch: 17, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
Validation loss decreased (-0.809241 --> -0.809241).  Saving model ...
Epoch: 18 cost time: 2.390164375305176
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.704 Vali Acc: 0.821 Test Loss: 0.704 Test Acc: 0.821
Validation loss decreased (-0.809241 --> -0.820802).  Saving model ...
Epoch: 19 cost time: 2.644195795059204
Epoch: 19, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.954 Vali Acc: 0.832 Test Loss: 0.954 Test Acc: 0.832
Validation loss decreased (-0.820802 --> -0.832360).  Saving model ...
Epoch: 20 cost time: 2.478203535079956
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.800 Vali Acc: 0.792 Test Loss: 0.800 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.472414970397949
Epoch: 21, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.121 Vali Acc: 0.786 Test Loss: 1.121 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.3807950019836426
Epoch: 22, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.962 Vali Acc: 0.809 Test Loss: 0.962 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.472503900527954
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.083 Vali Acc: 0.798 Test Loss: 1.083 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.5579302310943604
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.292 Vali Acc: 0.740 Test Loss: 1.292 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.468754768371582
Epoch: 25, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.057 Vali Acc: 0.803 Test Loss: 1.057 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.2956275939941406
Epoch: 26, Steps: 17 | Train Loss: 0.071 Vali Loss: 1.239 Vali Acc: 0.815 Test Loss: 1.239 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3069093227386475
Epoch: 27, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.240 Vali Acc: 0.798 Test Loss: 1.240 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.331207275390625
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.261 Vali Acc: 0.821 Test Loss: 1.261 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3735458850860596
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.164 Vali Acc: 0.792 Test Loss: 1.164 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 554111
model size : 3.35MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.406604528427124
Epoch: 1, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.652 Vali Acc: 0.283 Test Loss: 1.652 Test Acc: 0.283
Validation loss decreased (inf --> -0.283220).  Saving model ...
Epoch: 2 cost time: 2.358062744140625
Epoch: 2, Steps: 17 | Train Loss: 1.502 Vali Loss: 1.306 Vali Acc: 0.468 Test Loss: 1.306 Test Acc: 0.468
Validation loss decreased (-0.283220 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 2.504063367843628
Epoch: 3, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.103 Vali Acc: 0.480 Test Loss: 1.103 Test Acc: 0.480
Validation loss decreased (-0.468195 --> -0.479758).  Saving model ...
Epoch: 4 cost time: 2.1853184700012207
Epoch: 4, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.938 Vali Acc: 0.601 Test Loss: 0.938 Test Acc: 0.601
Validation loss decreased (-0.479758 --> -0.601147).  Saving model ...
Epoch: 5 cost time: 2.194753885269165
Epoch: 5, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.887 Vali Acc: 0.607 Test Loss: 0.887 Test Acc: 0.607
Validation loss decreased (-0.601147 --> -0.606928).  Saving model ...
Epoch: 6 cost time: 2.2939040660858154
Epoch: 6, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
Validation loss decreased (-0.606928 --> -0.809242).  Saving model ...
Epoch: 7 cost time: 2.286381244659424
Epoch: 7, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.683 Vali Acc: 0.786 Test Loss: 0.683 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.3001344203948975
Epoch: 8, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.781 Vali Acc: 0.757 Test Loss: 0.781 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2052600383758545
Epoch: 9, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.613 Vali Acc: 0.786 Test Loss: 0.613 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.3469440937042236
Epoch: 10, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.788 Vali Acc: 0.775 Test Loss: 0.788 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.440535306930542
Epoch: 11, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.687 Vali Acc: 0.798 Test Loss: 0.687 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.3094255924224854
Epoch: 12, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.531 Vali Acc: 0.838 Test Loss: 0.531 Test Acc: 0.838
Validation loss decreased (-0.809242 --> -0.838145).  Saving model ...
Epoch: 13 cost time: 2.382063388824463
Epoch: 13, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.574 Vali Acc: 0.809 Test Loss: 0.574 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.2320122718811035
Epoch: 14, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.274634599685669
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.831 Vali Acc: 0.798 Test Loss: 0.831 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.3561127185821533
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.785 Vali Acc: 0.832 Test Loss: 0.785 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.303040027618408
Epoch: 17, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.657 Vali Acc: 0.792 Test Loss: 0.657 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.3313350677490234
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.815 Vali Acc: 0.832 Test Loss: 0.815 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.3089003562927246
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.690 Vali Acc: 0.815 Test Loss: 0.690 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.432382106781006
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.815 Test Loss: 0.685 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.2744171619415283
Epoch: 21, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.866 Vali Acc: 0.803 Test Loss: 0.866 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.3193023204803467
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.976 Vali Acc: 0.803 Test Loss: 0.976 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 537727
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.844838380813599
Epoch: 1, Steps: 17 | Train Loss: 1.909 Vali Loss: 1.648 Vali Acc: 0.306 Test Loss: 1.648 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.5953266620635986
Epoch: 2, Steps: 17 | Train Loss: 1.501 Vali Loss: 1.329 Vali Acc: 0.457 Test Loss: 1.329 Test Acc: 0.457
Validation loss decreased (-0.306342 --> -0.456634).  Saving model ...
Epoch: 3 cost time: 2.492027997970581
Epoch: 3, Steps: 17 | Train Loss: 1.107 Vali Loss: 1.107 Vali Acc: 0.474 Test Loss: 1.107 Test Acc: 0.474
Validation loss decreased (-0.456634 --> -0.473977).  Saving model ...
Epoch: 4 cost time: 2.5189671516418457
Epoch: 4, Steps: 17 | Train Loss: 0.943 Vali Loss: 0.952 Vali Acc: 0.607 Test Loss: 0.952 Test Acc: 0.607
Validation loss decreased (-0.473977 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 2.6608328819274902
Epoch: 5, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.885 Vali Acc: 0.624 Test Loss: 0.885 Test Acc: 0.624
Validation loss decreased (-0.606927 --> -0.624269).  Saving model ...
Epoch: 6 cost time: 2.5125389099121094
Epoch: 6, Steps: 17 | Train Loss: 0.518 Vali Loss: 0.735 Vali Acc: 0.763 Test Loss: 0.735 Test Acc: 0.763
Validation loss decreased (-0.624269 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 2.450491428375244
Epoch: 7, Steps: 17 | Train Loss: 0.416 Vali Loss: 0.700 Vali Acc: 0.763 Test Loss: 0.700 Test Acc: 0.763
Validation loss decreased (-0.762998 --> -0.762999).  Saving model ...
Epoch: 8 cost time: 2.5313167572021484
Epoch: 8, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.785 Vali Acc: 0.746 Test Loss: 0.785 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.429499626159668
Epoch: 9, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.623 Vali Acc: 0.792 Test Loss: 0.623 Test Acc: 0.792
Validation loss decreased (-0.762999 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 2.589067220687866
Epoch: 10, Steps: 17 | Train Loss: 0.198 Vali Loss: 0.648 Vali Acc: 0.786 Test Loss: 0.648 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.719243288040161
Epoch: 11, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.638 Vali Acc: 0.803 Test Loss: 0.638 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803462).  Saving model ...
Epoch: 12 cost time: 2.3539793491363525
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.722 Vali Acc: 0.763 Test Loss: 0.722 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4335875511169434
Epoch: 13, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.547 Vali Acc: 0.844 Test Loss: 0.547 Test Acc: 0.844
Validation loss decreased (-0.803462 --> -0.843925).  Saving model ...
Epoch: 14 cost time: 2.4820172786712646
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.625 Vali Acc: 0.827 Test Loss: 0.625 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.616905927658081
Epoch: 15, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.693 Vali Acc: 0.815 Test Loss: 0.693 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1931512355804443
Epoch: 16, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.670 Vali Acc: 0.855 Test Loss: 0.670 Test Acc: 0.855
Validation loss decreased (-0.843925 --> -0.855485).  Saving model ...
Epoch: 17 cost time: 2.567897081375122
Epoch: 17, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.622 Vali Acc: 0.827 Test Loss: 0.622 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.836153745651245
Epoch: 18, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.646 Vali Acc: 0.838 Test Loss: 0.646 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.587524890899658
Epoch: 19, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.726 Vali Acc: 0.844 Test Loss: 0.726 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.5097620487213135
Epoch: 20, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.886 Vali Acc: 0.815 Test Loss: 0.886 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.461825132369995
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.790 Vali Acc: 0.792 Test Loss: 0.790 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.630704879760742
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.815 Test Loss: 0.728 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3944051265716553
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.791 Vali Acc: 0.821 Test Loss: 0.791 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3151190280914307
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.728 Vali Acc: 0.832 Test Loss: 0.728 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5811946392059326
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.736 Vali Acc: 0.821 Test Loss: 0.736 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5936062335968018
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.827 Test Loss: 0.701 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 537727
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.413189649581909
Epoch: 1, Steps: 17 | Train Loss: 1.910 Vali Loss: 1.666 Vali Acc: 0.353 Test Loss: 1.666 Test Acc: 0.353
Validation loss decreased (inf --> -0.352584).  Saving model ...
Epoch: 2 cost time: 2.192589521408081
Epoch: 2, Steps: 17 | Train Loss: 1.516 Vali Loss: 1.338 Vali Acc: 0.480 Test Loss: 1.338 Test Acc: 0.480
Validation loss decreased (-0.352584 --> -0.479755).  Saving model ...
Epoch: 3 cost time: 2.25093936920166
Epoch: 3, Steps: 17 | Train Loss: 1.133 Vali Loss: 1.115 Vali Acc: 0.526 Test Loss: 1.115 Test Acc: 0.526
Validation loss decreased (-0.479755 --> -0.526000).  Saving model ...
Epoch: 4 cost time: 2.2752742767333984
Epoch: 4, Steps: 17 | Train Loss: 0.978 Vali Loss: 0.964 Vali Acc: 0.607 Test Loss: 0.964 Test Acc: 0.607
Validation loss decreased (-0.526000 --> -0.606927).  Saving model ...
Epoch: 5 cost time: 2.4914333820343018
Epoch: 5, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.932 Vali Acc: 0.590 Test Loss: 0.932 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.037994146347046
Epoch: 6, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.765 Vali Acc: 0.740 Test Loss: 0.765 Test Acc: 0.740
Validation loss decreased (-0.606927 --> -0.739877).  Saving model ...
Epoch: 7 cost time: 2.1048762798309326
Epoch: 7, Steps: 17 | Train Loss: 0.460 Vali Loss: 0.742 Vali Acc: 0.728 Test Loss: 0.742 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2072341442108154
Epoch: 8, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.735 Vali Acc: 0.746 Test Loss: 0.735 Test Acc: 0.746
Validation loss decreased (-0.739877 --> -0.745657).  Saving model ...
Epoch: 9 cost time: 2.317067861557007
Epoch: 9, Steps: 17 | Train Loss: 0.265 Vali Loss: 0.633 Vali Acc: 0.763 Test Loss: 0.633 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 2.18884539604187
Epoch: 10, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.677 Vali Acc: 0.786 Test Loss: 0.677 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786120).  Saving model ...
Epoch: 11 cost time: 2.1231493949890137
Epoch: 11, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.732 Vali Acc: 0.792 Test Loss: 0.732 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791900).  Saving model ...
Epoch: 12 cost time: 2.1788406372070312
Epoch: 12, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.887 Vali Acc: 0.775 Test Loss: 0.887 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1747524738311768
Epoch: 13, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.913 Vali Acc: 0.757 Test Loss: 0.913 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.3245654106140137
Epoch: 14, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.814 Vali Acc: 0.832 Test Loss: 0.814 Test Acc: 0.832
Validation loss decreased (-0.791900 --> -0.832362).  Saving model ...
Epoch: 15 cost time: 2.3243062496185303
Epoch: 15, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.805 Vali Acc: 0.780 Test Loss: 0.805 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1183924674987793
Epoch: 16, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.630 Vali Acc: 0.832 Test Loss: 0.630 Test Acc: 0.832
Validation loss decreased (-0.832362 --> -0.832364).  Saving model ...
Epoch: 17 cost time: 2.02221417427063
Epoch: 17, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.890 Vali Acc: 0.798 Test Loss: 0.890 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.143843650817871
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.172 Vali Acc: 0.740 Test Loss: 1.172 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.322078227996826
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.853 Vali Acc: 0.809 Test Loss: 0.853 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1956188678741455
Epoch: 20, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.719 Vali Acc: 0.815 Test Loss: 0.719 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.5619678497314453
Epoch: 21, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.749 Vali Acc: 0.832 Test Loss: 0.749 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.3862154483795166
Epoch: 22, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.680 Vali Acc: 0.746 Test Loss: 1.680 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.243190288543701
Epoch: 23, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.804 Vali Acc: 0.821 Test Loss: 0.804 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.3704380989074707
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.214 Vali Acc: 0.780 Test Loss: 1.214 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.5019776821136475
Epoch: 25, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.895 Vali Acc: 0.838 Test Loss: 0.895 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838141).  Saving model ...
Epoch: 26 cost time: 2.615189790725708
Epoch: 26, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.118 Vali Acc: 0.803 Test Loss: 1.118 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.3678221702575684
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.346 Vali Acc: 0.780 Test Loss: 1.346 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3847687244415283
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.109 Vali Acc: 0.815 Test Loss: 1.109 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.4656240940093994
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.086 Vali Acc: 0.792 Test Loss: 1.086 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.2064356803894043
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.318 Vali Acc: 0.780 Test Loss: 1.318 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2790420055389404
Epoch: 31, Steps: 17 | Train Loss: 0.076 Vali Loss: 1.163 Vali Acc: 0.792 Test Loss: 1.163 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.744720220565796
Epoch: 32, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.889 Vali Acc: 0.815 Test Loss: 0.889 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.4909050464630127
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.041 Vali Acc: 0.815 Test Loss: 1.041 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.5751497745513916
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.819 Vali Acc: 0.861 Test Loss: 0.819 Test Acc: 0.861
Validation loss decreased (-0.838141 --> -0.861263).  Saving model ...
Epoch: 35 cost time: 2.6643762588500977
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.123 Vali Acc: 0.786 Test Loss: 1.123 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 2.4894611835479736
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.101 Vali Acc: 0.792 Test Loss: 1.101 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 2.4904441833496094
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.077 Vali Acc: 0.815 Test Loss: 1.077 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 2.5782041549682617
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.104 Vali Acc: 0.815 Test Loss: 1.104 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 2.703725576400757
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.089 Vali Acc: 0.809 Test Loss: 1.089 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 2.7321882247924805
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.098 Vali Acc: 0.780 Test Loss: 1.098 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 2.614982843399048
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.181 Vali Acc: 0.792 Test Loss: 1.181 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 2.851746082305908
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.163 Vali Acc: 0.792 Test Loss: 1.163 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 2.509002208709717
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.107 Vali Acc: 0.792 Test Loss: 1.107 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 2.622145175933838
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.078 Vali Acc: 0.792 Test Loss: 1.078 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 537727
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.494922637939453
Epoch: 1, Steps: 17 | Train Loss: 1.914 Vali Loss: 1.702 Vali Acc: 0.312 Test Loss: 1.702 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 2.3528599739074707
Epoch: 2, Steps: 17 | Train Loss: 1.586 Vali Loss: 1.379 Vali Acc: 0.462 Test Loss: 1.379 Test Acc: 0.462
Validation loss decreased (-0.312122 --> -0.462414).  Saving model ...
Epoch: 3 cost time: 2.2231605052948
Epoch: 3, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.170 Vali Acc: 0.491 Test Loss: 1.170 Test Acc: 0.491
Validation loss decreased (-0.462414 --> -0.491318).  Saving model ...
Epoch: 4 cost time: 2.0155153274536133
Epoch: 4, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.053 Vali Acc: 0.543 Test Loss: 1.053 Test Acc: 0.543
Validation loss decreased (-0.491318 --> -0.543342).  Saving model ...
Epoch: 5 cost time: 2.1511003971099854
Epoch: 5, Steps: 17 | Train Loss: 0.899 Vali Loss: 1.056 Vali Acc: 0.509 Test Loss: 1.056 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2632510662078857
Epoch: 6, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.917 Vali Acc: 0.572 Test Loss: 0.917 Test Acc: 0.572
Validation loss decreased (-0.543342 --> -0.572245).  Saving model ...
Epoch: 7 cost time: 2.1657612323760986
Epoch: 7, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.801 Vali Acc: 0.665 Test Loss: 0.801 Test Acc: 0.665
Validation loss decreased (-0.572245 --> -0.664732).  Saving model ...
Epoch: 8 cost time: 2.0948398113250732
Epoch: 8, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.780 Vali Acc: 0.769 Test Loss: 0.780 Test Acc: 0.769
Validation loss decreased (-0.664732 --> -0.768778).  Saving model ...
Epoch: 9 cost time: 2.2471230030059814
Epoch: 9, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.757 Vali Acc: 0.746 Test Loss: 0.757 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.321535110473633
Epoch: 10, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.668 Vali Acc: 0.751 Test Loss: 0.668 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1272244453430176
Epoch: 11, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
Validation loss decreased (-0.768778 --> -0.809242).  Saving model ...
Epoch: 12 cost time: 2.0941007137298584
Epoch: 12, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.760 Vali Acc: 0.786 Test Loss: 0.760 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.299055337905884
Epoch: 13, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.772 Vali Acc: 0.780 Test Loss: 0.772 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.256242036819458
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.767 Vali Acc: 0.792 Test Loss: 0.767 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.275338649749756
Epoch: 15, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.937 Vali Acc: 0.705 Test Loss: 0.937 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.1857311725616455
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.944 Vali Acc: 0.780 Test Loss: 0.944 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.238377809524536
Epoch: 17, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.811 Vali Acc: 0.792 Test Loss: 0.811 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.3359200954437256
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.246 Vali Acc: 0.757 Test Loss: 1.246 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2346694469451904
Epoch: 19, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.830 Vali Acc: 0.815 Test Loss: 0.830 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815021).  Saving model ...
Epoch: 20 cost time: 2.12926983833313
Epoch: 20, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.940 Vali Acc: 0.803 Test Loss: 0.940 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2046329975128174
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.162 Vali Acc: 0.792 Test Loss: 1.162 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1354589462280273
Epoch: 22, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.988 Vali Acc: 0.780 Test Loss: 0.988 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.288950204849243
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.128 Vali Acc: 0.815 Test Loss: 1.128 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.2878708839416504
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.197 Vali Acc: 0.815 Test Loss: 1.197 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.421005964279175
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.243 Vali Acc: 0.821 Test Loss: 1.243 Test Acc: 0.821
Validation loss decreased (-0.815021 --> -0.820797).  Saving model ...
Epoch: 26 cost time: 2.4594478607177734
Epoch: 26, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.141 Vali Acc: 0.798 Test Loss: 1.141 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.195446252822876
Epoch: 27, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.225 Vali Acc: 0.809 Test Loss: 1.225 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.2315268516540527
Epoch: 28, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.263 Vali Acc: 0.769 Test Loss: 1.263 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.2540531158447266
Epoch: 29, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.283 Vali Acc: 0.792 Test Loss: 1.283 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.297488212585449
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.268 Vali Acc: 0.792 Test Loss: 1.268 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.2510194778442383
Epoch: 31, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.374 Vali Acc: 0.798 Test Loss: 1.374 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.689741849899292
Epoch: 32, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.380 Vali Acc: 0.803 Test Loss: 1.380 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.727735757827759
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.329 Vali Acc: 0.815 Test Loss: 1.329 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.65509295463562
Epoch: 34, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.563 Vali Acc: 0.775 Test Loss: 1.563 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.2980809211730957
Epoch: 35, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.132 Vali Acc: 0.786 Test Loss: 1.132 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 537727
model size : 3.29MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.766488075256348
Epoch: 1, Steps: 17 | Train Loss: 1.974 Vali Loss: 1.827 Vali Acc: 0.237 Test Loss: 1.827 Test Acc: 0.237
Validation loss decreased (inf --> -0.236976).  Saving model ...
Epoch: 2 cost time: 2.5138401985168457
Epoch: 2, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.523 Vali Acc: 0.266 Test Loss: 1.523 Test Acc: 0.266
Validation loss decreased (-0.236976 --> -0.265881).  Saving model ...
Epoch: 3 cost time: 2.4116077423095703
Epoch: 3, Steps: 17 | Train Loss: 1.269 Vali Loss: 1.238 Vali Acc: 0.428 Test Loss: 1.238 Test Acc: 0.428
Validation loss decreased (-0.265881 --> -0.427733).  Saving model ...
Epoch: 4 cost time: 2.3616368770599365
Epoch: 4, Steps: 17 | Train Loss: 1.101 Vali Loss: 1.184 Vali Acc: 0.428 Test Loss: 1.184 Test Acc: 0.428
Validation loss decreased (-0.427733 --> -0.427734).  Saving model ...
Epoch: 5 cost time: 2.411921262741089
Epoch: 5, Steps: 17 | Train Loss: 0.939 Vali Loss: 0.996 Vali Acc: 0.555 Test Loss: 0.996 Test Acc: 0.555
Validation loss decreased (-0.427734 --> -0.554903).  Saving model ...
Epoch: 6 cost time: 2.4559948444366455
Epoch: 6, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.954 Vali Acc: 0.613 Test Loss: 0.954 Test Acc: 0.613
Validation loss decreased (-0.554903 --> -0.612707).  Saving model ...
Epoch: 7 cost time: 2.010190725326538
Epoch: 7, Steps: 17 | Train Loss: 0.714 Vali Loss: 0.787 Vali Acc: 0.653 Test Loss: 0.787 Test Acc: 0.653
Validation loss decreased (-0.612707 --> -0.653171).  Saving model ...
Epoch: 8 cost time: 2.2234179973602295
Epoch: 8, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.660 Vali Acc: 0.786 Test Loss: 0.660 Test Acc: 0.786
Validation loss decreased (-0.653171 --> -0.786121).  Saving model ...
Epoch: 9 cost time: 2.470963954925537
Epoch: 9, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.719 Vali Acc: 0.763 Test Loss: 0.719 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.56245493888855
Epoch: 10, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.613 Vali Acc: 0.751 Test Loss: 0.613 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5662999153137207
Epoch: 11, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.551 Vali Acc: 0.792 Test Loss: 0.551 Test Acc: 0.792
Validation loss decreased (-0.786121 --> -0.791902).  Saving model ...
Epoch: 12 cost time: 2.3145697116851807
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.531 Vali Acc: 0.803 Test Loss: 0.531 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803463).  Saving model ...
Epoch: 13 cost time: 2.4421274662017822
Epoch: 13, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.496 Vali Acc: 0.827 Test Loss: 0.496 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826585).  Saving model ...
Epoch: 14 cost time: 2.339045763015747
Epoch: 14, Steps: 17 | Train Loss: 0.124 Vali Loss: 0.637 Vali Acc: 0.769 Test Loss: 0.637 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.150829792022705
Epoch: 15, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.640 Vali Acc: 0.803 Test Loss: 0.640 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.411935567855835
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.751 Vali Acc: 0.792 Test Loss: 0.751 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.439789295196533
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.668 Vali Acc: 0.786 Test Loss: 0.668 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.433563709259033
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.694 Vali Acc: 0.792 Test Loss: 0.694 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.3717939853668213
Epoch: 19, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.764 Vali Acc: 0.815 Test Loss: 0.764 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.266934633255005
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
Validation loss decreased (-0.826585 --> -0.843925).  Saving model ...
Epoch: 21 cost time: 2.280243396759033
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.873 Vali Acc: 0.798 Test Loss: 0.873 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2449240684509277
Epoch: 22, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.746 Vali Acc: 0.809 Test Loss: 0.746 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.240781545639038
Epoch: 23, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.808 Vali Acc: 0.815 Test Loss: 0.808 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.335916519165039
Epoch: 24, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.761 Vali Acc: 0.786 Test Loss: 0.761 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.470881223678589
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.786 Vali Acc: 0.792 Test Loss: 0.786 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.3677101135253906
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.764 Vali Acc: 0.815 Test Loss: 0.764 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.42061185836792
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.809 Test Loss: 0.796 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.7169852256774902
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.753 Vali Acc: 0.815 Test Loss: 0.753 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4662551879882812
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.801 Vali Acc: 0.809 Test Loss: 0.801 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1482441425323486
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.809 Test Loss: 0.787 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 522591
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.838532447814941
Epoch: 1, Steps: 17 | Train Loss: 1.975 Vali Loss: 1.821 Vali Acc: 0.254 Test Loss: 1.821 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 2.2651848793029785
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.515 Vali Acc: 0.231 Test Loss: 1.515 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.3819315433502197
Epoch: 3, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.248 Vali Acc: 0.445 Test Loss: 1.248 Test Acc: 0.445
Validation loss decreased (-0.254317 --> -0.445074).  Saving model ...
Epoch: 4 cost time: 2.473621368408203
Epoch: 4, Steps: 17 | Train Loss: 1.122 Vali Loss: 1.192 Vali Acc: 0.439 Test Loss: 1.192 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.6343719959259033
Epoch: 5, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.998 Vali Acc: 0.549 Test Loss: 0.998 Test Acc: 0.549
Validation loss decreased (-0.445074 --> -0.549123).  Saving model ...
Epoch: 6 cost time: 2.782198905944824
Epoch: 6, Steps: 17 | Train Loss: 0.775 Vali Loss: 0.952 Vali Acc: 0.607 Test Loss: 0.952 Test Acc: 0.607
Validation loss decreased (-0.549123 --> -0.606927).  Saving model ...
Epoch: 7 cost time: 2.455347776412964
Epoch: 7, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.779 Vali Acc: 0.705 Test Loss: 0.779 Test Acc: 0.705
Validation loss decreased (-0.606927 --> -0.705195).  Saving model ...
Epoch: 8 cost time: 2.5714850425720215
Epoch: 8, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.690 Vali Acc: 0.786 Test Loss: 0.690 Test Acc: 0.786
Validation loss decreased (-0.705195 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.5189380645751953
Epoch: 9, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.3886258602142334
Epoch: 10, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.624 Vali Acc: 0.751 Test Loss: 0.624 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.3275113105773926
Epoch: 11, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.558 Vali Acc: 0.815 Test Loss: 0.558 Test Acc: 0.815
Validation loss decreased (-0.786120 --> -0.815023).  Saving model ...
Epoch: 12 cost time: 2.526155948638916
Epoch: 12, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.545 Vali Acc: 0.832 Test Loss: 0.545 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832364).  Saving model ...
Epoch: 13 cost time: 2.344000816345215
Epoch: 13, Steps: 17 | Train Loss: 0.202 Vali Loss: 0.551 Vali Acc: 0.803 Test Loss: 0.551 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.3875551223754883
Epoch: 14, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.618 Vali Acc: 0.803 Test Loss: 0.618 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.4578685760498047
Epoch: 15, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.619 Vali Acc: 0.827 Test Loss: 0.619 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.408917188644409
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.629 Vali Acc: 0.798 Test Loss: 0.629 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4213743209838867
Epoch: 17, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.626 Vali Acc: 0.821 Test Loss: 0.626 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.2151429653167725
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.664 Vali Acc: 0.832 Test Loss: 0.664 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.522613525390625
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.754 Vali Acc: 0.809 Test Loss: 0.754 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.2594680786132812
Epoch: 20, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.585 Vali Acc: 0.873 Test Loss: 0.585 Test Acc: 0.873
Validation loss decreased (-0.832364 --> -0.872827).  Saving model ...
Epoch: 21 cost time: 2.3507063388824463
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.653 Vali Acc: 0.850 Test Loss: 0.653 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.6502315998077393
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.681 Vali Acc: 0.832 Test Loss: 0.681 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.210143804550171
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.630 Vali Acc: 0.827 Test Loss: 0.630 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.4645893573760986
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.615 Vali Acc: 0.838 Test Loss: 0.615 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.4306819438934326
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.642 Vali Acc: 0.832 Test Loss: 0.642 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.243420124053955
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.622 Vali Acc: 0.850 Test Loss: 0.622 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.2374446392059326
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.821 Test Loss: 0.688 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.623828172683716
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.729 Vali Acc: 0.815 Test Loss: 0.729 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.4709296226501465
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.832 Test Loss: 0.679 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.5580430030822754
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.720 Vali Acc: 0.809 Test Loss: 0.720 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 522591
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.155676364898682
Epoch: 1, Steps: 17 | Train Loss: 1.966 Vali Loss: 1.816 Vali Acc: 0.260 Test Loss: 1.816 Test Acc: 0.260
Validation loss decreased (inf --> -0.260097).  Saving model ...
Epoch: 2 cost time: 2.2676539421081543
Epoch: 2, Steps: 17 | Train Loss: 1.625 Vali Loss: 1.534 Vali Acc: 0.231 Test Loss: 1.534 Test Acc: 0.231
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.249293565750122
Epoch: 3, Steps: 17 | Train Loss: 1.307 Vali Loss: 1.247 Vali Acc: 0.416 Test Loss: 1.247 Test Acc: 0.416
Validation loss decreased (-0.260097 --> -0.416173).  Saving model ...
Epoch: 4 cost time: 2.1639020442962646
Epoch: 4, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.197 Vali Acc: 0.405 Test Loss: 1.197 Test Acc: 0.405
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.344071865081787
Epoch: 5, Steps: 17 | Train Loss: 0.962 Vali Loss: 0.972 Vali Acc: 0.647 Test Loss: 0.972 Test Acc: 0.647
Validation loss decreased (-0.416173 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 2.117161989212036
Epoch: 6, Steps: 17 | Train Loss: 0.792 Vali Loss: 0.938 Vali Acc: 0.647 Test Loss: 0.938 Test Acc: 0.647
Validation loss decreased (-0.647389 --> -0.647389).  Saving model ...
Epoch: 7 cost time: 2.216001272201538
Epoch: 7, Steps: 17 | Train Loss: 0.730 Vali Loss: 0.762 Vali Acc: 0.682 Test Loss: 0.762 Test Acc: 0.682
Validation loss decreased (-0.647389 --> -0.682073).  Saving model ...
Epoch: 8 cost time: 2.296353340148926
Epoch: 8, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.688 Vali Acc: 0.786 Test Loss: 0.688 Test Acc: 0.786
Validation loss decreased (-0.682073 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.269512176513672
Epoch: 9, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.738 Vali Acc: 0.723 Test Loss: 0.738 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2745792865753174
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.602 Vali Acc: 0.821 Test Loss: 0.602 Test Acc: 0.821
Validation loss decreased (-0.786120 --> -0.820803).  Saving model ...
Epoch: 11 cost time: 2.2690229415893555
Epoch: 11, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.680 Vali Acc: 0.769 Test Loss: 0.680 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.212728500366211
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.535 Vali Acc: 0.815 Test Loss: 0.535 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1469831466674805
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.558 Vali Acc: 0.855 Test Loss: 0.558 Test Acc: 0.855
Validation loss decreased (-0.820803 --> -0.855486).  Saving model ...
Epoch: 14 cost time: 2.136242628097534
Epoch: 14, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.779 Vali Acc: 0.792 Test Loss: 0.779 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.302166223526001
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.674 Vali Acc: 0.844 Test Loss: 0.674 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.2510876655578613
Epoch: 16, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.632 Vali Acc: 0.780 Test Loss: 0.632 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2620034217834473
Epoch: 17, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.582 Vali Acc: 0.815 Test Loss: 0.582 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.33667254447937
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.682 Vali Acc: 0.821 Test Loss: 0.682 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.322087287902832
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.896 Vali Acc: 0.798 Test Loss: 0.896 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1073756217956543
Epoch: 20, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.680 Vali Acc: 0.838 Test Loss: 0.680 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3903040885925293
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.765 Vali Acc: 0.798 Test Loss: 0.765 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.552459716796875
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.780 Vali Acc: 0.815 Test Loss: 0.780 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.2665698528289795
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.784 Vali Acc: 0.803 Test Loss: 0.784 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 522591
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.516680717468262
Epoch: 1, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.808 Vali Acc: 0.318 Test Loss: 1.808 Test Acc: 0.318
Validation loss decreased (inf --> -0.317901).  Saving model ...
Epoch: 2 cost time: 2.3415310382843018
Epoch: 2, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.557 Vali Acc: 0.260 Test Loss: 1.557 Test Acc: 0.260
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.635540723800659
Epoch: 3, Steps: 17 | Train Loss: 1.371 Vali Loss: 1.307 Vali Acc: 0.376 Test Loss: 1.307 Test Acc: 0.376
Validation loss decreased (-0.317901 --> -0.375709).  Saving model ...
Epoch: 4 cost time: 2.2552201747894287
Epoch: 4, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.284 Vali Acc: 0.358 Test Loss: 1.284 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3745014667510986
Epoch: 5, Steps: 17 | Train Loss: 1.053 Vali Loss: 1.063 Vali Acc: 0.578 Test Loss: 1.063 Test Acc: 0.578
Validation loss decreased (-0.375709 --> -0.578024).  Saving model ...
Epoch: 6 cost time: 2.4246199131011963
Epoch: 6, Steps: 17 | Train Loss: 0.904 Vali Loss: 0.998 Vali Acc: 0.624 Test Loss: 0.998 Test Acc: 0.624
Validation loss decreased (-0.578024 --> -0.624267).  Saving model ...
Epoch: 7 cost time: 2.5263659954071045
Epoch: 7, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.818 Vali Acc: 0.682 Test Loss: 0.818 Test Acc: 0.682
Validation loss decreased (-0.624267 --> -0.682073).  Saving model ...
Epoch: 8 cost time: 2.210054397583008
Epoch: 8, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.770 Vali Acc: 0.728 Test Loss: 0.770 Test Acc: 0.728
Validation loss decreased (-0.682073 --> -0.728316).  Saving model ...
Epoch: 9 cost time: 2.243928909301758
Epoch: 9, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.866 Vali Acc: 0.688 Test Loss: 0.866 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6971216201782227
Epoch: 10, Steps: 17 | Train Loss: 0.469 Vali Loss: 0.769 Vali Acc: 0.699 Test Loss: 0.769 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.5316591262817383
Epoch: 11, Steps: 17 | Train Loss: 0.395 Vali Loss: 0.666 Vali Acc: 0.757 Test Loss: 0.666 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 2.3139827251434326
Epoch: 12, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.677 Vali Acc: 0.751 Test Loss: 0.677 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.662937879562378
Epoch: 13, Steps: 17 | Train Loss: 0.299 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
Validation loss decreased (-0.757219 --> -0.815023).  Saving model ...
Epoch: 14 cost time: 2.223719835281372
Epoch: 14, Steps: 17 | Train Loss: 0.233 Vali Loss: 0.715 Vali Acc: 0.786 Test Loss: 0.715 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.592480421066284
Epoch: 15, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.842 Vali Acc: 0.769 Test Loss: 0.842 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.8437068462371826
Epoch: 16, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.797 Vali Acc: 0.803 Test Loss: 0.797 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.5647237300872803
Epoch: 17, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.715 Vali Acc: 0.815 Test Loss: 0.715 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1697566509246826
Epoch: 18, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.662 Vali Acc: 0.815 Test Loss: 0.662 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.572098970413208
Epoch: 19, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.951 Vali Acc: 0.809 Test Loss: 0.951 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.572335720062256
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.3411331176757812
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.027 Vali Acc: 0.769 Test Loss: 1.027 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.527700424194336
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.830 Vali Acc: 0.803 Test Loss: 0.830 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.40914249420166
Epoch: 23, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.749 Vali Acc: 0.815 Test Loss: 0.749 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 522591
model size : 2.62MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.502695322036743
Epoch: 1, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.738 Vali Acc: 0.220 Test Loss: 1.738 Test Acc: 0.220
Validation loss decreased (inf --> -0.219636).  Saving model ...
Epoch: 2 cost time: 2.142922878265381
Epoch: 2, Steps: 17 | Train Loss: 1.606 Vali Loss: 1.346 Vali Acc: 0.526 Test Loss: 1.346 Test Acc: 0.526
Validation loss decreased (-0.219636 --> -0.525998).  Saving model ...
Epoch: 3 cost time: 2.1366868019104004
Epoch: 3, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.157 Vali Acc: 0.618 Test Loss: 1.157 Test Acc: 0.618
Validation loss decreased (-0.525998 --> -0.618486).  Saving model ...
Epoch: 4 cost time: 2.141437292098999
Epoch: 4, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.019 Vali Acc: 0.584 Test Loss: 1.019 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3754124641418457
Epoch: 5, Steps: 17 | Train Loss: 0.914 Vali Loss: 0.912 Vali Acc: 0.624 Test Loss: 0.912 Test Acc: 0.624
Validation loss decreased (-0.618486 --> -0.624268).  Saving model ...
Epoch: 6 cost time: 2.246882915496826
Epoch: 6, Steps: 17 | Train Loss: 0.805 Vali Loss: 0.859 Vali Acc: 0.682 Test Loss: 0.859 Test Acc: 0.682
Validation loss decreased (-0.624268 --> -0.682072).  Saving model ...
Epoch: 7 cost time: 2.5231778621673584
Epoch: 7, Steps: 17 | Train Loss: 0.706 Vali Loss: 0.834 Vali Acc: 0.711 Test Loss: 0.834 Test Acc: 0.711
Validation loss decreased (-0.682072 --> -0.710974).  Saving model ...
Epoch: 8 cost time: 2.272815704345703
Epoch: 8, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.677 Vali Acc: 0.723 Test Loss: 0.677 Test Acc: 0.723
Validation loss decreased (-0.710974 --> -0.722537).  Saving model ...
Epoch: 9 cost time: 2.2914183139801025
Epoch: 9, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
Validation loss decreased (-0.722537 --> -0.745658).  Saving model ...
Epoch: 10 cost time: 2.100426197052002
Epoch: 10, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.560 Vali Acc: 0.786 Test Loss: 0.560 Test Acc: 0.786
Validation loss decreased (-0.745658 --> -0.786122).  Saving model ...
Epoch: 11 cost time: 2.2062668800354004
Epoch: 11, Steps: 17 | Train Loss: 0.297 Vali Loss: 0.526 Vali Acc: 0.809 Test Loss: 0.526 Test Acc: 0.809
Validation loss decreased (-0.786122 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 2.1923739910125732
Epoch: 12, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.665 Vali Acc: 0.809 Test Loss: 0.665 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.3343753814697266
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.508 Vali Acc: 0.821 Test Loss: 0.508 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820804).  Saving model ...
Epoch: 14 cost time: 2.2118701934814453
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.5925114154815674
Epoch: 15, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.526 Vali Acc: 0.792 Test Loss: 0.526 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.5624887943267822
Epoch: 16, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4297754764556885
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.458 Vali Acc: 0.873 Test Loss: 0.458 Test Acc: 0.873
Validation loss decreased (-0.820804 --> -0.872828).  Saving model ...
Epoch: 18 cost time: 2.4669134616851807
Epoch: 18, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.596 Vali Acc: 0.844 Test Loss: 0.596 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.9048547744750977
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.727 Vali Acc: 0.838 Test Loss: 0.727 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.8582112789154053
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.718 Vali Acc: 0.827 Test Loss: 0.718 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.7708725929260254
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.663 Vali Acc: 0.832 Test Loss: 0.663 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.6702773571014404
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.703254222869873
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.844 Test Loss: 0.662 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.722360610961914
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8990232944488525
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.710 Vali Acc: 0.838 Test Loss: 0.710 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 3.02030086517334
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.591 Vali Acc: 0.838 Test Loss: 0.591 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.5326504707336426
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.737 Vali Acc: 0.850 Test Loss: 0.737 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 391519
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.575275182723999
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.730 Vali Acc: 0.249 Test Loss: 1.730 Test Acc: 0.249
Validation loss decreased (inf --> -0.248538).  Saving model ...
Epoch: 2 cost time: 2.294344425201416
Epoch: 2, Steps: 17 | Train Loss: 1.596 Vali Loss: 1.339 Vali Acc: 0.520 Test Loss: 1.339 Test Acc: 0.520
Validation loss decreased (-0.248538 --> -0.520218).  Saving model ...
Epoch: 3 cost time: 2.154837131500244
Epoch: 3, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.152 Vali Acc: 0.618 Test Loss: 1.152 Test Acc: 0.618
Validation loss decreased (-0.520218 --> -0.618486).  Saving model ...
Epoch: 4 cost time: 2.1863186359405518
Epoch: 4, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.003 Vali Acc: 0.618 Test Loss: 1.003 Test Acc: 0.618
Validation loss decreased (-0.618486 --> -0.618487).  Saving model ...
Epoch: 5 cost time: 2.17279314994812
Epoch: 5, Steps: 17 | Train Loss: 0.908 Vali Loss: 0.895 Vali Acc: 0.624 Test Loss: 0.895 Test Acc: 0.624
Validation loss decreased (-0.618487 --> -0.624269).  Saving model ...
Epoch: 6 cost time: 2.281998634338379
Epoch: 6, Steps: 17 | Train Loss: 0.791 Vali Loss: 0.857 Vali Acc: 0.694 Test Loss: 0.857 Test Acc: 0.694
Validation loss decreased (-0.624269 --> -0.693633).  Saving model ...
Epoch: 7 cost time: 2.261333703994751
Epoch: 7, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.861 Vali Acc: 0.705 Test Loss: 0.861 Test Acc: 0.705
Validation loss decreased (-0.693633 --> -0.705194).  Saving model ...
Epoch: 8 cost time: 2.0805139541625977
Epoch: 8, Steps: 17 | Train Loss: 0.620 Vali Loss: 0.668 Vali Acc: 0.746 Test Loss: 0.668 Test Acc: 0.746
Validation loss decreased (-0.705194 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 2.045808792114258
Epoch: 9, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.659 Vali Acc: 0.763 Test Loss: 0.659 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 2.152257204055786
Epoch: 10, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.557 Vali Acc: 0.798 Test Loss: 0.557 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 2.2256758213043213
Epoch: 11, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.548 Vali Acc: 0.803 Test Loss: 0.548 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803463).  Saving model ...
Epoch: 12 cost time: 2.102769613265991
Epoch: 12, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.663 Vali Acc: 0.803 Test Loss: 0.663 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.2310891151428223
Epoch: 13, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.516 Vali Acc: 0.861 Test Loss: 0.516 Test Acc: 0.861
Validation loss decreased (-0.803463 --> -0.861267).  Saving model ...
Epoch: 14 cost time: 2.3047168254852295
Epoch: 14, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.599 Vali Acc: 0.827 Test Loss: 0.599 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.256136655807495
Epoch: 15, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.501 Vali Acc: 0.844 Test Loss: 0.501 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3609836101531982
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.646 Vali Acc: 0.821 Test Loss: 0.646 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.3300490379333496
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.514 Vali Acc: 0.838 Test Loss: 0.514 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2780022621154785
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.630 Vali Acc: 0.861 Test Loss: 0.630 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.185213327407837
Epoch: 19, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.676 Vali Acc: 0.861 Test Loss: 0.676 Test Acc: 0.861
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.2433178424835205
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.599 Vali Acc: 0.850 Test Loss: 0.599 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.313284158706665
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.2066307067871094
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.603 Vali Acc: 0.861 Test Loss: 0.603 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.1912407875061035
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.645 Vali Acc: 0.850 Test Loss: 0.645 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 391519
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.554832935333252
Epoch: 1, Steps: 17 | Train Loss: 1.882 Vali Loss: 1.723 Vali Acc: 0.329 Test Loss: 1.723 Test Acc: 0.329
Validation loss decreased (inf --> -0.329463).  Saving model ...
Epoch: 2 cost time: 2.0858242511749268
Epoch: 2, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.348 Vali Acc: 0.514 Test Loss: 1.348 Test Acc: 0.514
Validation loss decreased (-0.329463 --> -0.514437).  Saving model ...
Epoch: 3 cost time: 2.1423819065093994
Epoch: 3, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.155 Vali Acc: 0.590 Test Loss: 1.155 Test Acc: 0.590
Validation loss decreased (-0.514437 --> -0.589584).  Saving model ...
Epoch: 4 cost time: 2.1960506439208984
Epoch: 4, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.012 Vali Acc: 0.601 Test Loss: 1.012 Test Acc: 0.601
Validation loss decreased (-0.589584 --> -0.601146).  Saving model ...
Epoch: 5 cost time: 2.3066904544830322
Epoch: 5, Steps: 17 | Train Loss: 0.941 Vali Loss: 0.898 Vali Acc: 0.630 Test Loss: 0.898 Test Acc: 0.630
Validation loss decreased (-0.601146 --> -0.630049).  Saving model ...
Epoch: 6 cost time: 2.4178895950317383
Epoch: 6, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.867 Vali Acc: 0.676 Test Loss: 0.867 Test Acc: 0.676
Validation loss decreased (-0.630049 --> -0.676292).  Saving model ...
Epoch: 7 cost time: 2.262073040008545
Epoch: 7, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.880 Vali Acc: 0.699 Test Loss: 0.880 Test Acc: 0.699
Validation loss decreased (-0.676292 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 2.4176528453826904
Epoch: 8, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.713 Vali Acc: 0.723 Test Loss: 0.713 Test Acc: 0.723
Validation loss decreased (-0.699413 --> -0.722536).  Saving model ...
Epoch: 9 cost time: 2.224123954772949
Epoch: 9, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.714 Vali Acc: 0.717 Test Loss: 0.714 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0485806465148926
Epoch: 10, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
Validation loss decreased (-0.722536 --> -0.809243).  Saving model ...
Epoch: 11 cost time: 2.3437843322753906
Epoch: 11, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.586 Vali Acc: 0.792 Test Loss: 0.586 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.260188102722168
Epoch: 12, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.661 Vali Acc: 0.827 Test Loss: 0.661 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826583).  Saving model ...
Epoch: 13 cost time: 2.1362149715423584
Epoch: 13, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.558 Vali Acc: 0.838 Test Loss: 0.558 Test Acc: 0.838
Validation loss decreased (-0.826583 --> -0.838145).  Saving model ...
Epoch: 14 cost time: 2.2624800205230713
Epoch: 14, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.605 Vali Acc: 0.844 Test Loss: 0.605 Test Acc: 0.844
Validation loss decreased (-0.838145 --> -0.843925).  Saving model ...
Epoch: 15 cost time: 2.2546334266662598
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.564 Vali Acc: 0.827 Test Loss: 0.564 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.1360039710998535
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.594 Vali Acc: 0.850 Test Loss: 0.594 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849705).  Saving model ...
Epoch: 17 cost time: 2.273853302001953
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.629 Vali Acc: 0.827 Test Loss: 0.629 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.212775468826294
Epoch: 18, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.661 Vali Acc: 0.809 Test Loss: 0.661 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.31571888923645
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.888 Vali Acc: 0.844 Test Loss: 0.888 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0155904293060303
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.759 Vali Acc: 0.838 Test Loss: 0.759 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.1692793369293213
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2167892456054688
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.657 Vali Acc: 0.844 Test Loss: 0.657 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3109028339385986
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.679 Vali Acc: 0.844 Test Loss: 0.679 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.0982890129089355
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.779 Vali Acc: 0.861 Test Loss: 0.779 Test Acc: 0.861
Validation loss decreased (-0.849705 --> -0.861264).  Saving model ...
Epoch: 25 cost time: 2.157308340072632
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.716 Vali Acc: 0.867 Test Loss: 0.716 Test Acc: 0.867
Validation loss decreased (-0.861264 --> -0.867045).  Saving model ...
Epoch: 26 cost time: 2.226806402206421
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.729 Vali Acc: 0.844 Test Loss: 0.729 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1921300888061523
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.929 Vali Acc: 0.850 Test Loss: 0.929 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.3657338619232178
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.844 Test Loss: 0.768 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.249586820602417
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.855 Test Loss: 0.785 Test Acc: 0.855
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.3842108249664307
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.827 Vali Acc: 0.867 Test Loss: 0.827 Test Acc: 0.867
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.3213603496551514
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.885 Vali Acc: 0.867 Test Loss: 0.885 Test Acc: 0.867
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.5322208404541016
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.867 Test Loss: 0.821 Test Acc: 0.867
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.4370265007019043
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.875 Vali Acc: 0.850 Test Loss: 0.875 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.3372366428375244
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.848 Vali Acc: 0.861 Test Loss: 0.848 Test Acc: 0.861
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.191807270050049
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.822 Vali Acc: 0.867 Test Loss: 0.822 Test Acc: 0.867
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 391519
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.672516822814941
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.806 Vali Acc: 0.231 Test Loss: 1.806 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 2.262077808380127
Epoch: 2, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.469 Vali Acc: 0.451 Test Loss: 1.469 Test Acc: 0.451
Validation loss decreased (-0.231196 --> -0.450852).  Saving model ...
Epoch: 3 cost time: 2.483372926712036
Epoch: 3, Steps: 17 | Train Loss: 1.392 Vali Loss: 1.284 Vali Acc: 0.555 Test Loss: 1.284 Test Acc: 0.555
Validation loss decreased (-0.450852 --> -0.554900).  Saving model ...
Epoch: 4 cost time: 2.1820247173309326
Epoch: 4, Steps: 17 | Train Loss: 1.192 Vali Loss: 1.140 Vali Acc: 0.509 Test Loss: 1.140 Test Acc: 0.509
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.167323112487793
Epoch: 5, Steps: 17 | Train Loss: 1.041 Vali Loss: 0.997 Vali Acc: 0.601 Test Loss: 0.997 Test Acc: 0.601
Validation loss decreased (-0.554900 --> -0.601146).  Saving model ...
Epoch: 6 cost time: 2.3453476428985596
Epoch: 6, Steps: 17 | Train Loss: 0.937 Vali Loss: 0.952 Vali Acc: 0.653 Test Loss: 0.952 Test Acc: 0.653
Validation loss decreased (-0.601146 --> -0.653170).  Saving model ...
Epoch: 7 cost time: 2.2205276489257812
Epoch: 7, Steps: 17 | Train Loss: 0.838 Vali Loss: 0.944 Vali Acc: 0.665 Test Loss: 0.944 Test Acc: 0.665
Validation loss decreased (-0.653170 --> -0.664730).  Saving model ...
Epoch: 8 cost time: 2.2542359828948975
Epoch: 8, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.809 Vali Acc: 0.694 Test Loss: 0.809 Test Acc: 0.694
Validation loss decreased (-0.664730 --> -0.693634).  Saving model ...
Epoch: 9 cost time: 2.310703754425049
Epoch: 9, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.784 Vali Acc: 0.688 Test Loss: 0.784 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.5662834644317627
Epoch: 10, Steps: 17 | Train Loss: 0.487 Vali Loss: 0.673 Vali Acc: 0.757 Test Loss: 0.673 Test Acc: 0.757
Validation loss decreased (-0.693634 --> -0.757219).  Saving model ...
Epoch: 11 cost time: 2.4944167137145996
Epoch: 11, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.713 Vali Acc: 0.746 Test Loss: 0.713 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.650407314300537
Epoch: 12, Steps: 17 | Train Loss: 0.319 Vali Loss: 0.760 Vali Acc: 0.757 Test Loss: 0.760 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4116036891937256
Epoch: 13, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.590 Vali Acc: 0.792 Test Loss: 0.590 Test Acc: 0.792
Validation loss decreased (-0.757219 --> -0.791902).  Saving model ...
Epoch: 14 cost time: 2.1248438358306885
Epoch: 14, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.670 Vali Acc: 0.723 Test Loss: 0.670 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.4714560508728027
Epoch: 15, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.713 Vali Acc: 0.798 Test Loss: 0.713 Test Acc: 0.798
Validation loss decreased (-0.791902 --> -0.797681).  Saving model ...
Epoch: 16 cost time: 2.2248263359069824
Epoch: 16, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809242).  Saving model ...
Epoch: 17 cost time: 2.2094850540161133
Epoch: 17, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.700 Vali Acc: 0.809 Test Loss: 0.700 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.335357666015625
Epoch: 18, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.715 Vali Acc: 0.809 Test Loss: 0.715 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.102593183517456
Epoch: 19, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.840 Vali Acc: 0.827 Test Loss: 0.840 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826581).  Saving model ...
Epoch: 20 cost time: 2.116572856903076
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.669 Vali Acc: 0.798 Test Loss: 0.669 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.194312334060669
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.965 Vali Acc: 0.780 Test Loss: 0.965 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1487889289855957
Epoch: 22, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.707 Vali Acc: 0.850 Test Loss: 0.707 Test Acc: 0.850
Validation loss decreased (-0.826581 --> -0.849704).  Saving model ...
Epoch: 23 cost time: 2.1779441833496094
Epoch: 23, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.041 Vali Acc: 0.769 Test Loss: 1.041 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.3072431087493896
Epoch: 24, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.938 Vali Acc: 0.798 Test Loss: 0.938 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.3391122817993164
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.816 Vali Acc: 0.803 Test Loss: 0.816 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.118999481201172
Epoch: 26, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.226 Vali Acc: 0.780 Test Loss: 1.226 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.140605926513672
Epoch: 27, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.009 Vali Acc: 0.803 Test Loss: 1.009 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.166818141937256
Epoch: 28, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.043 Vali Acc: 0.792 Test Loss: 1.043 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.1300320625305176
Epoch: 29, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.044 Vali Acc: 0.786 Test Loss: 1.044 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.131441354751587
Epoch: 30, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.026 Vali Acc: 0.780 Test Loss: 1.026 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.116607904434204
Epoch: 31, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.056 Vali Acc: 0.780 Test Loss: 1.056 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.185614585876465
Epoch: 32, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.282 Vali Acc: 0.798 Test Loss: 1.282 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 391519
model size : 2.12MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.266230344772339
Epoch: 1, Steps: 17 | Train Loss: 2.022 Vali Loss: 1.809 Vali Acc: 0.214 Test Loss: 1.809 Test Acc: 0.214
Validation loss decreased (inf --> -0.213855).  Saving model ...
Epoch: 2 cost time: 2.4821765422821045
Epoch: 2, Steps: 17 | Train Loss: 1.702 Vali Loss: 1.469 Vali Acc: 0.468 Test Loss: 1.469 Test Acc: 0.468
Validation loss decreased (-0.213855 --> -0.468193).  Saving model ...
Epoch: 3 cost time: 2.2323620319366455
Epoch: 3, Steps: 17 | Train Loss: 1.384 Vali Loss: 1.270 Vali Acc: 0.445 Test Loss: 1.270 Test Acc: 0.445
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3547720909118652
Epoch: 4, Steps: 17 | Train Loss: 1.139 Vali Loss: 1.131 Vali Acc: 0.439 Test Loss: 1.131 Test Acc: 0.439
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.373671770095825
Epoch: 5, Steps: 17 | Train Loss: 0.982 Vali Loss: 0.971 Vali Acc: 0.694 Test Loss: 0.971 Test Acc: 0.694
Validation loss decreased (-0.468193 --> -0.693632).  Saving model ...
Epoch: 6 cost time: 2.3835294246673584
Epoch: 6, Steps: 17 | Train Loss: 0.799 Vali Loss: 0.940 Vali Acc: 0.555 Test Loss: 0.940 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2863073348999023
Epoch: 7, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.937 Vali Acc: 0.624 Test Loss: 0.937 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.5277388095855713
Epoch: 8, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.887 Vali Acc: 0.642 Test Loss: 0.887 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.1825218200683594
Epoch: 9, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.745 Vali Acc: 0.740 Test Loss: 0.745 Test Acc: 0.740
Validation loss decreased (-0.693632 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 2.207551956176758
Epoch: 10, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.620 Vali Acc: 0.798 Test Loss: 0.620 Test Acc: 0.798
Validation loss decreased (-0.739877 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 2.204418420791626
Epoch: 11, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.601 Vali Acc: 0.757 Test Loss: 0.601 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.510735511779785
Epoch: 12, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.788 Vali Acc: 0.780 Test Loss: 0.788 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.4490580558776855
Epoch: 13, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.638 Vali Acc: 0.786 Test Loss: 0.638 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.271578073501587
Epoch: 14, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.553 Vali Acc: 0.815 Test Loss: 0.553 Test Acc: 0.815
Validation loss decreased (-0.797682 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 2.233804702758789
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.762 Vali Acc: 0.769 Test Loss: 0.762 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.2639195919036865
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.547 Vali Acc: 0.850 Test Loss: 0.547 Test Acc: 0.850
Validation loss decreased (-0.815023 --> -0.849706).  Saving model ...
Epoch: 17 cost time: 2.413114547729492
Epoch: 17, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.537 Vali Acc: 0.821 Test Loss: 0.537 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.357822895050049
Epoch: 18, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.664 Vali Acc: 0.803 Test Loss: 0.664 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1210033893585205
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.555 Vali Acc: 0.832 Test Loss: 0.555 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.1817309856414795
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.537 Vali Acc: 0.832 Test Loss: 0.537 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.3361473083496094
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.589 Vali Acc: 0.832 Test Loss: 0.589 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.2488064765930176
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.630 Vali Acc: 0.838 Test Loss: 0.630 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9950120449066162
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.632 Vali Acc: 0.844 Test Loss: 0.632 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.1503612995147705
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.604 Vali Acc: 0.838 Test Loss: 0.604 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.254244565963745
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.655 Vali Acc: 0.844 Test Loss: 0.655 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1875975131988525
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.670 Vali Acc: 0.844 Test Loss: 0.670 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 325983
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.385546445846558
Epoch: 1, Steps: 17 | Train Loss: 2.027 Vali Loss: 1.800 Vali Acc: 0.168 Test Loss: 1.800 Test Acc: 0.168
Validation loss decreased (inf --> -0.167612).  Saving model ...
Epoch: 2 cost time: 1.972102165222168
Epoch: 2, Steps: 17 | Train Loss: 1.700 Vali Loss: 1.471 Vali Acc: 0.457 Test Loss: 1.471 Test Acc: 0.457
Validation loss decreased (-0.167612 --> -0.456633).  Saving model ...
Epoch: 3 cost time: 2.0887234210968018
Epoch: 3, Steps: 17 | Train Loss: 1.397 Vali Loss: 1.281 Vali Acc: 0.382 Test Loss: 1.281 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.197174549102783
Epoch: 4, Steps: 17 | Train Loss: 1.163 Vali Loss: 1.158 Vali Acc: 0.434 Test Loss: 1.158 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.591930627822876
Epoch: 5, Steps: 17 | Train Loss: 1.009 Vali Loss: 0.978 Vali Acc: 0.647 Test Loss: 0.978 Test Acc: 0.647
Validation loss decreased (-0.456633 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 2.406909227371216
Epoch: 6, Steps: 17 | Train Loss: 0.821 Vali Loss: 0.952 Vali Acc: 0.555 Test Loss: 0.952 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.3007779121398926
Epoch: 7, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.924 Vali Acc: 0.647 Test Loss: 0.924 Test Acc: 0.647
Validation loss decreased (-0.647389 --> -0.647390).  Saving model ...
Epoch: 8 cost time: 2.439255714416504
Epoch: 8, Steps: 17 | Train Loss: 0.517 Vali Loss: 0.829 Vali Acc: 0.659 Test Loss: 0.829 Test Acc: 0.659
Validation loss decreased (-0.647390 --> -0.658951).  Saving model ...
Epoch: 9 cost time: 2.2836804389953613
Epoch: 9, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.721 Vali Acc: 0.728 Test Loss: 0.721 Test Acc: 0.728
Validation loss decreased (-0.658951 --> -0.728316).  Saving model ...
Epoch: 10 cost time: 2.5510220527648926
Epoch: 10, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.648 Vali Acc: 0.769 Test Loss: 0.648 Test Acc: 0.769
Validation loss decreased (-0.728316 --> -0.768780).  Saving model ...
Epoch: 11 cost time: 2.304335594177246
Epoch: 11, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.616 Vali Acc: 0.786 Test Loss: 0.616 Test Acc: 0.786
Validation loss decreased (-0.768780 --> -0.786121).  Saving model ...
Epoch: 12 cost time: 2.3027870655059814
Epoch: 12, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.759 Vali Acc: 0.757 Test Loss: 0.759 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4349968433380127
Epoch: 13, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.565 Vali Acc: 0.850 Test Loss: 0.565 Test Acc: 0.850
Validation loss decreased (-0.786121 --> -0.849705).  Saving model ...
Epoch: 14 cost time: 2.846872091293335
Epoch: 14, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.499 Vali Acc: 0.838 Test Loss: 0.499 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.637505531311035
Epoch: 15, Steps: 17 | Train Loss: 0.148 Vali Loss: 0.674 Vali Acc: 0.792 Test Loss: 0.674 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6557345390319824
Epoch: 16, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.562 Vali Acc: 0.832 Test Loss: 0.562 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.4695611000061035
Epoch: 17, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.580 Vali Acc: 0.809 Test Loss: 0.580 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 3.2318103313446045
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.584 Vali Acc: 0.855 Test Loss: 0.584 Test Acc: 0.855
Validation loss decreased (-0.849705 --> -0.855485).  Saving model ...
Epoch: 19 cost time: 3.1035826206207275
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.582 Vali Acc: 0.844 Test Loss: 0.582 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.840562582015991
Epoch: 20, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.562 Vali Acc: 0.838 Test Loss: 0.562 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.18097186088562
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.650 Vali Acc: 0.827 Test Loss: 0.650 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.7832701206207275
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.711 Vali Acc: 0.827 Test Loss: 0.711 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.8512794971466064
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.793 Vali Acc: 0.821 Test Loss: 0.793 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.873696804046631
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.652 Vali Acc: 0.827 Test Loss: 0.652 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.7030575275421143
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.655 Vali Acc: 0.827 Test Loss: 0.655 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7571780681610107
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.796 Vali Acc: 0.815 Test Loss: 0.796 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.651775360107422
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.694 Vali Acc: 0.827 Test Loss: 0.694 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.8733882904052734
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.757 Vali Acc: 0.821 Test Loss: 0.757 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 325983
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.817814826965332
Epoch: 1, Steps: 17 | Train Loss: 2.010 Vali Loss: 1.807 Vali Acc: 0.231 Test Loss: 1.807 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 2.1378562450408936
Epoch: 2, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.483 Vali Acc: 0.445 Test Loss: 1.483 Test Acc: 0.445
Validation loss decreased (-0.231196 --> -0.445072).  Saving model ...
Epoch: 3 cost time: 2.2594971656799316
Epoch: 3, Steps: 17 | Train Loss: 1.417 Vali Loss: 1.288 Vali Acc: 0.358 Test Loss: 1.288 Test Acc: 0.358
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.233755111694336
Epoch: 4, Steps: 17 | Train Loss: 1.191 Vali Loss: 1.194 Vali Acc: 0.434 Test Loss: 1.194 Test Acc: 0.434
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.194721221923828
Epoch: 5, Steps: 17 | Train Loss: 1.027 Vali Loss: 1.003 Vali Acc: 0.613 Test Loss: 1.003 Test Acc: 0.613
Validation loss decreased (-0.445072 --> -0.612707).  Saving model ...
Epoch: 6 cost time: 2.4184908866882324
Epoch: 6, Steps: 17 | Train Loss: 0.853 Vali Loss: 1.022 Vali Acc: 0.503 Test Loss: 1.022 Test Acc: 0.503
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.382843494415283
Epoch: 7, Steps: 17 | Train Loss: 0.781 Vali Loss: 1.039 Vali Acc: 0.584 Test Loss: 1.039 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.4079465866088867
Epoch: 8, Steps: 17 | Train Loss: 0.587 Vali Loss: 0.985 Vali Acc: 0.630 Test Loss: 0.985 Test Acc: 0.630
Validation loss decreased (-0.612707 --> -0.630048).  Saving model ...
Epoch: 9 cost time: 2.317260503768921
Epoch: 9, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.759 Vali Acc: 0.688 Test Loss: 0.759 Test Acc: 0.688
Validation loss decreased (-0.630048 --> -0.687854).  Saving model ...
Epoch: 10 cost time: 2.525207281112671
Epoch: 10, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.712 Vali Acc: 0.734 Test Loss: 0.712 Test Acc: 0.734
Validation loss decreased (-0.687854 --> -0.734097).  Saving model ...
Epoch: 11 cost time: 2.514622688293457
Epoch: 11, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.727 Vali Acc: 0.717 Test Loss: 0.727 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.2851219177246094
Epoch: 12, Steps: 17 | Train Loss: 0.286 Vali Loss: 0.730 Vali Acc: 0.734 Test Loss: 0.730 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.3231353759765625
Epoch: 13, Steps: 17 | Train Loss: 0.216 Vali Loss: 0.668 Vali Acc: 0.763 Test Loss: 0.668 Test Acc: 0.763
Validation loss decreased (-0.734097 --> -0.762999).  Saving model ...
Epoch: 14 cost time: 2.5082764625549316
Epoch: 14, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.656 Vali Acc: 0.780 Test Loss: 0.656 Test Acc: 0.780
Validation loss decreased (-0.762999 --> -0.780340).  Saving model ...
Epoch: 15 cost time: 2.3730897903442383
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.807 Vali Acc: 0.734 Test Loss: 0.807 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.437136650085449
Epoch: 16, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.546 Vali Acc: 0.844 Test Loss: 0.546 Test Acc: 0.844
Validation loss decreased (-0.780340 --> -0.843925).  Saving model ...
Epoch: 17 cost time: 2.29845929145813
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.662 Vali Acc: 0.792 Test Loss: 0.662 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.599263906478882
Epoch: 18, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.778 Vali Acc: 0.763 Test Loss: 0.778 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3167548179626465
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.676 Vali Acc: 0.827 Test Loss: 0.676 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.509035587310791
Epoch: 20, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.706 Vali Acc: 0.827 Test Loss: 0.706 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.136547803878784
Epoch: 21, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.671 Vali Acc: 0.832 Test Loss: 0.671 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.351393222808838
Epoch: 22, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.712 Vali Acc: 0.821 Test Loss: 0.712 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.42979097366333
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.691 Vali Acc: 0.850 Test Loss: 0.691 Test Acc: 0.850
Validation loss decreased (-0.843925 --> -0.849704).  Saving model ...
Epoch: 24 cost time: 2.3590574264526367
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.719 Vali Acc: 0.855 Test Loss: 0.719 Test Acc: 0.855
Validation loss decreased (-0.849704 --> -0.855484).  Saving model ...
Epoch: 25 cost time: 2.235898971557617
Epoch: 25, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.651 Vali Acc: 0.855 Test Loss: 0.651 Test Acc: 0.855
Validation loss decreased (-0.855484 --> -0.855485).  Saving model ...
Epoch: 26 cost time: 2.101572036743164
Epoch: 26, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.833 Vali Acc: 0.821 Test Loss: 0.833 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.1324639320373535
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.669 Vali Acc: 0.827 Test Loss: 0.669 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.4638121128082275
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.717 Vali Acc: 0.850 Test Loss: 0.717 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.3353936672210693
Epoch: 29, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.767 Vali Acc: 0.815 Test Loss: 0.767 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.1884942054748535
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.768 Vali Acc: 0.850 Test Loss: 0.768 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.3152365684509277
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.711 Vali Acc: 0.855 Test Loss: 0.711 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.272754192352295
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.855 Test Loss: 0.749 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.4066669940948486
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.774 Vali Acc: 0.850 Test Loss: 0.774 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.203425168991089
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.737 Vali Acc: 0.855 Test Loss: 0.737 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.132824659347534
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.735 Vali Acc: 0.855 Test Loss: 0.735 Test Acc: 0.855
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 325983
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9379770755767822
Epoch: 1, Steps: 17 | Train Loss: 1.991 Vali Loss: 1.843 Vali Acc: 0.185 Test Loss: 1.843 Test Acc: 0.185
Validation loss decreased (inf --> -0.184953).  Saving model ...
Epoch: 2 cost time: 2.007516860961914
Epoch: 2, Steps: 17 | Train Loss: 1.721 Vali Loss: 1.551 Vali Acc: 0.335 Test Loss: 1.551 Test Acc: 0.335
Validation loss decreased (-0.184953 --> -0.335245).  Saving model ...
Epoch: 3 cost time: 2.114408016204834
Epoch: 3, Steps: 17 | Train Loss: 1.459 Vali Loss: 1.316 Vali Acc: 0.434 Test Loss: 1.316 Test Acc: 0.434
Validation loss decreased (-0.335245 --> -0.433513).  Saving model ...
Epoch: 4 cost time: 2.0952935218811035
Epoch: 4, Steps: 17 | Train Loss: 1.255 Vali Loss: 1.257 Vali Acc: 0.364 Test Loss: 1.257 Test Acc: 0.364
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.0439341068267822
Epoch: 5, Steps: 17 | Train Loss: 1.090 Vali Loss: 1.083 Vali Acc: 0.549 Test Loss: 1.083 Test Acc: 0.549
Validation loss decreased (-0.433513 --> -0.549122).  Saving model ...
Epoch: 6 cost time: 2.067431926727295
Epoch: 6, Steps: 17 | Train Loss: 0.939 Vali Loss: 1.106 Vali Acc: 0.462 Test Loss: 1.106 Test Acc: 0.462
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9625139236450195
Epoch: 7, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.003 Vali Acc: 0.590 Test Loss: 1.003 Test Acc: 0.590
Validation loss decreased (-0.549122 --> -0.589585).  Saving model ...
Epoch: 8 cost time: 2.0258960723876953
Epoch: 8, Steps: 17 | Train Loss: 0.667 Vali Loss: 1.090 Vali Acc: 0.642 Test Loss: 1.090 Test Acc: 0.642
Validation loss decreased (-0.589585 --> -0.641608).  Saving model ...
Epoch: 9 cost time: 2.1112682819366455
Epoch: 9, Steps: 17 | Train Loss: 0.641 Vali Loss: 0.852 Vali Acc: 0.682 Test Loss: 0.852 Test Acc: 0.682
Validation loss decreased (-0.641608 --> -0.682072).  Saving model ...
Epoch: 10 cost time: 2.133246421813965
Epoch: 10, Steps: 17 | Train Loss: 0.549 Vali Loss: 0.836 Vali Acc: 0.630 Test Loss: 0.836 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0035908222198486
Epoch: 11, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.871 Vali Acc: 0.717 Test Loss: 0.871 Test Acc: 0.717
Validation loss decreased (-0.682072 --> -0.716754).  Saving model ...
Epoch: 12 cost time: 2.1467790603637695
Epoch: 12, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.869 Vali Acc: 0.694 Test Loss: 0.869 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1051971912384033
Epoch: 13, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.699 Vali Acc: 0.751 Test Loss: 0.699 Test Acc: 0.751
Validation loss decreased (-0.716754 --> -0.751438).  Saving model ...
Epoch: 14 cost time: 2.085211992263794
Epoch: 14, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.584 Vali Acc: 0.809 Test Loss: 0.584 Test Acc: 0.809
Validation loss decreased (-0.751438 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 2.1955859661102295
Epoch: 15, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.886 Vali Acc: 0.746 Test Loss: 0.886 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9640843868255615
Epoch: 16, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.566 Vali Acc: 0.792 Test Loss: 0.566 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.1461243629455566
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.796 Vali Acc: 0.757 Test Loss: 0.796 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.290529489517212
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.806 Vali Acc: 0.780 Test Loss: 0.806 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.104508876800537
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.786 Vali Acc: 0.792 Test Loss: 0.786 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.093583106994629
Epoch: 20, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.640 Vali Acc: 0.832 Test Loss: 0.640 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832364).  Saving model ...
Epoch: 21 cost time: 2.108703136444092
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.824 Vali Acc: 0.803 Test Loss: 0.824 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.069307804107666
Epoch: 22, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.100 Vali Acc: 0.798 Test Loss: 1.100 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1360862255096436
Epoch: 23, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.16321063041687
Epoch: 24, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.814 Vali Acc: 0.798 Test Loss: 0.814 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.008589744567871
Epoch: 25, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.176 Vali Acc: 0.775 Test Loss: 1.176 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.120134115219116
Epoch: 26, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.962 Vali Acc: 0.775 Test Loss: 0.962 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.036886215209961
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.959 Vali Acc: 0.803 Test Loss: 0.959 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.120213508605957
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.096 Vali Acc: 0.803 Test Loss: 1.096 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.1257312297821045
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.327 Vali Acc: 0.809 Test Loss: 1.327 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.0887160301208496
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.991 Vali Acc: 0.780 Test Loss: 0.991 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 325983
model size : 1.87MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.295051336288452
Epoch: 1, Steps: 17 | Train Loss: 1.948 Vali Loss: 1.784 Vali Acc: 0.249 Test Loss: 1.784 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 2.131420612335205
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.437 Vali Acc: 0.364 Test Loss: 1.437 Test Acc: 0.364
Validation loss decreased (-0.248537 --> -0.364147).  Saving model ...
Epoch: 3 cost time: 2.079714775085449
Epoch: 3, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.216 Vali Acc: 0.486 Test Loss: 1.216 Test Acc: 0.486
Validation loss decreased (-0.364147 --> -0.485537).  Saving model ...
Epoch: 4 cost time: 2.196423053741455
Epoch: 4, Steps: 17 | Train Loss: 1.086 Vali Loss: 1.001 Vali Acc: 0.613 Test Loss: 1.001 Test Acc: 0.613
Validation loss decreased (-0.485537 --> -0.612707).  Saving model ...
Epoch: 5 cost time: 2.309924364089966
Epoch: 5, Steps: 17 | Train Loss: 0.910 Vali Loss: 0.873 Vali Acc: 0.647 Test Loss: 0.873 Test Acc: 0.647
Validation loss decreased (-0.612707 --> -0.647390).  Saving model ...
Epoch: 6 cost time: 2.083148717880249
Epoch: 6, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.879 Vali Acc: 0.665 Test Loss: 0.879 Test Acc: 0.665
Validation loss decreased (-0.647390 --> -0.664731).  Saving model ...
Epoch: 7 cost time: 2.225259304046631
Epoch: 7, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.758 Vali Acc: 0.740 Test Loss: 0.758 Test Acc: 0.740
Validation loss decreased (-0.664731 --> -0.739877).  Saving model ...
Epoch: 8 cost time: 2.015571117401123
Epoch: 8, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.743 Vali Acc: 0.699 Test Loss: 0.743 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1212430000305176
Epoch: 9, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.783 Vali Acc: 0.694 Test Loss: 0.783 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.006472110748291
Epoch: 10, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.04256272315979
Epoch: 11, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.651 Vali Acc: 0.757 Test Loss: 0.651 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 2.0377726554870605
Epoch: 12, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.740 Vali Acc: 0.757 Test Loss: 0.740 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.243068218231201
Epoch: 13, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.572 Vali Acc: 0.815 Test Loss: 0.572 Test Acc: 0.815
Validation loss decreased (-0.757219 --> -0.815023).  Saving model ...
Epoch: 14 cost time: 2.229097366333008
Epoch: 14, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.567 Vali Acc: 0.803 Test Loss: 0.567 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.1676759719848633
Epoch: 15, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.766 Vali Acc: 0.763 Test Loss: 0.766 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1067535877227783
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.677 Vali Acc: 0.775 Test Loss: 0.677 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.120068073272705
Epoch: 17, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.725 Vali Acc: 0.803 Test Loss: 0.725 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.2989017963409424
Epoch: 18, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.036799907684326
Epoch: 19, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.607 Vali Acc: 0.832 Test Loss: 0.607 Test Acc: 0.832
Validation loss decreased (-0.815023 --> -0.832364).  Saving model ...
Epoch: 20 cost time: 2.112865447998047
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.832364 --> -0.849704).  Saving model ...
Epoch: 21 cost time: 2.0661864280700684
Epoch: 21, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.621 Vali Acc: 0.821 Test Loss: 0.621 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.2317698001861572
Epoch: 22, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.718 Vali Acc: 0.838 Test Loss: 0.718 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.3024303913116455
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.1884593963623047
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.757 Vali Acc: 0.815 Test Loss: 0.757 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.192504405975342
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.739 Vali Acc: 0.827 Test Loss: 0.739 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.059692621231079
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.647 Vali Acc: 0.821 Test Loss: 0.647 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.08467698097229
Epoch: 27, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.729 Vali Acc: 0.803 Test Loss: 0.729 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.112522840499878
Epoch: 28, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.786 Vali Acc: 0.815 Test Loss: 0.786 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.2287909984588623
Epoch: 29, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.688 Vali Acc: 0.815 Test Loss: 0.688 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.375499963760376
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.689 Vali Acc: 0.827 Test Loss: 0.689 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 293215
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.10355281829834
Epoch: 1, Steps: 17 | Train Loss: 1.950 Vali Loss: 1.786 Vali Acc: 0.254 Test Loss: 1.786 Test Acc: 0.254
Validation loss decreased (inf --> -0.254317).  Saving model ...
Epoch: 2 cost time: 2.1729490756988525
Epoch: 2, Steps: 17 | Train Loss: 1.618 Vali Loss: 1.438 Vali Acc: 0.347 Test Loss: 1.438 Test Acc: 0.347
Validation loss decreased (-0.254317 --> -0.346806).  Saving model ...
Epoch: 3 cost time: 2.249124526977539
Epoch: 3, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.214 Vali Acc: 0.509 Test Loss: 1.214 Test Acc: 0.509
Validation loss decreased (-0.346806 --> -0.508658).  Saving model ...
Epoch: 4 cost time: 2.1092207431793213
Epoch: 4, Steps: 17 | Train Loss: 1.085 Vali Loss: 0.980 Vali Acc: 0.659 Test Loss: 0.980 Test Acc: 0.659
Validation loss decreased (-0.508658 --> -0.658950).  Saving model ...
Epoch: 5 cost time: 1.9943485260009766
Epoch: 5, Steps: 17 | Train Loss: 0.923 Vali Loss: 0.868 Vali Acc: 0.688 Test Loss: 0.868 Test Acc: 0.688
Validation loss decreased (-0.658950 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 2.151470184326172
Epoch: 6, Steps: 17 | Train Loss: 0.789 Vali Loss: 0.850 Vali Acc: 0.682 Test Loss: 0.850 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.252532958984375
Epoch: 7, Steps: 17 | Train Loss: 0.698 Vali Loss: 0.749 Vali Acc: 0.746 Test Loss: 0.749 Test Acc: 0.746
Validation loss decreased (-0.687853 --> -0.745657).  Saving model ...
Epoch: 8 cost time: 2.1638360023498535
Epoch: 8, Steps: 17 | Train Loss: 0.561 Vali Loss: 0.739 Vali Acc: 0.723 Test Loss: 0.739 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.055757999420166
Epoch: 9, Steps: 17 | Train Loss: 0.497 Vali Loss: 0.786 Vali Acc: 0.734 Test Loss: 0.786 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2675955295562744
Epoch: 10, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
Validation loss decreased (-0.745657 --> -0.774560).  Saving model ...
Epoch: 11 cost time: 2.2859280109405518
Epoch: 11, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.716 Vali Acc: 0.740 Test Loss: 0.716 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1525166034698486
Epoch: 12, Steps: 17 | Train Loss: 0.231 Vali Loss: 0.755 Vali Acc: 0.757 Test Loss: 0.755 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1644628047943115
Epoch: 13, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.645 Vali Acc: 0.792 Test Loss: 0.645 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791901).  Saving model ...
Epoch: 14 cost time: 2.1945459842681885
Epoch: 14, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.574 Vali Acc: 0.792 Test Loss: 0.574 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791902).  Saving model ...
Epoch: 15 cost time: 2.066495656967163
Epoch: 15, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.743 Vali Acc: 0.803 Test Loss: 0.743 Test Acc: 0.803
Validation loss decreased (-0.791902 --> -0.803461).  Saving model ...
Epoch: 16 cost time: 2.0219674110412598
Epoch: 16, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.641 Vali Acc: 0.815 Test Loss: 0.641 Test Acc: 0.815
Validation loss decreased (-0.803461 --> -0.815022).  Saving model ...
Epoch: 17 cost time: 2.1203441619873047
Epoch: 17, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.825 Vali Acc: 0.792 Test Loss: 0.825 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.174590826034546
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.933 Vali Acc: 0.786 Test Loss: 0.933 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1555979251861572
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.653 Vali Acc: 0.821 Test Loss: 0.653 Test Acc: 0.821
Validation loss decreased (-0.815022 --> -0.820803).  Saving model ...
Epoch: 20 cost time: 2.2738137245178223
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.941 Vali Acc: 0.815 Test Loss: 0.941 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.2067723274230957
Epoch: 21, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.698 Vali Acc: 0.815 Test Loss: 0.698 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.0693581104278564
Epoch: 22, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.749 Vali Acc: 0.827 Test Loss: 0.749 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826582).  Saving model ...
Epoch: 23 cost time: 2.103023052215576
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.708 Vali Acc: 0.815 Test Loss: 0.708 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.020494222640991
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.781 Vali Acc: 0.798 Test Loss: 0.781 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.1994199752807617
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.047 Vali Acc: 0.815 Test Loss: 1.047 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.095170497894287
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.864 Vali Acc: 0.821 Test Loss: 0.864 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.0555851459503174
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.745 Vali Acc: 0.809 Test Loss: 0.745 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.0449976921081543
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.891 Vali Acc: 0.798 Test Loss: 0.891 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.15425705909729
Epoch: 29, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.846 Vali Acc: 0.827 Test Loss: 0.846 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1059579849243164
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.823 Vali Acc: 0.815 Test Loss: 0.823 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.049224853515625
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.832 Vali Acc: 0.861 Test Loss: 0.832 Test Acc: 0.861
Validation loss decreased (-0.826582 --> -0.861263).  Saving model ...
Epoch: 32 cost time: 2.038255214691162
Epoch: 32, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.713 Vali Acc: 0.832 Test Loss: 0.713 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.1293671131134033
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.963 Vali Acc: 0.815 Test Loss: 0.963 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0572550296783447
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.810 Vali Acc: 0.815 Test Loss: 0.810 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.103149175643921
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.827 Test Loss: 0.803 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.2840542793273926
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.839 Vali Acc: 0.832 Test Loss: 0.839 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.2799501419067383
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.811 Vali Acc: 0.827 Test Loss: 0.811 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 2.2211897373199463
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.814 Vali Acc: 0.827 Test Loss: 0.814 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.183317184448242
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.826 Vali Acc: 0.827 Test Loss: 0.826 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.266709089279175
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.876 Vali Acc: 0.821 Test Loss: 0.876 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.102846384048462
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.854 Vali Acc: 0.832 Test Loss: 0.854 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 293215
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.797742128372192
Epoch: 1, Steps: 17 | Train Loss: 1.939 Vali Loss: 1.779 Vali Acc: 0.266 Test Loss: 1.779 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 2.4856016635894775
Epoch: 2, Steps: 17 | Train Loss: 1.602 Vali Loss: 1.428 Vali Acc: 0.416 Test Loss: 1.428 Test Acc: 0.416
Validation loss decreased (-0.265878 --> -0.416171).  Saving model ...
Epoch: 3 cost time: 2.2549214363098145
Epoch: 3, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.203 Vali Acc: 0.538 Test Loss: 1.203 Test Acc: 0.538
Validation loss decreased (-0.416171 --> -0.537560).  Saving model ...
Epoch: 4 cost time: 2.1022121906280518
Epoch: 4, Steps: 17 | Train Loss: 1.106 Vali Loss: 0.971 Vali Acc: 0.676 Test Loss: 0.971 Test Acc: 0.676
Validation loss decreased (-0.537560 --> -0.676291).  Saving model ...
Epoch: 5 cost time: 2.4171459674835205
Epoch: 5, Steps: 17 | Train Loss: 0.921 Vali Loss: 0.865 Vali Acc: 0.699 Test Loss: 0.865 Test Acc: 0.699
Validation loss decreased (-0.676291 --> -0.699413).  Saving model ...
Epoch: 6 cost time: 2.524250030517578
Epoch: 6, Steps: 17 | Train Loss: 0.813 Vali Loss: 0.821 Vali Acc: 0.705 Test Loss: 0.821 Test Acc: 0.705
Validation loss decreased (-0.699413 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 2.222132682800293
Epoch: 7, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.780 Vali Acc: 0.694 Test Loss: 0.780 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.305037498474121
Epoch: 8, Steps: 17 | Train Loss: 0.605 Vali Loss: 0.780 Vali Acc: 0.659 Test Loss: 0.780 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.4478750228881836
Epoch: 9, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.785 Vali Acc: 0.688 Test Loss: 0.785 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.486518144607544
Epoch: 10, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.680 Vali Acc: 0.751 Test Loss: 0.680 Test Acc: 0.751
Validation loss decreased (-0.705194 --> -0.751438).  Saving model ...
Epoch: 11 cost time: 2.3180935382843018
Epoch: 11, Steps: 17 | Train Loss: 0.355 Vali Loss: 0.952 Vali Acc: 0.705 Test Loss: 0.952 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.251941442489624
Epoch: 12, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.789 Vali Acc: 0.751 Test Loss: 0.789 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.171664237976074
Epoch: 13, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.634 Vali Acc: 0.751 Test Loss: 0.634 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751439).  Saving model ...
Epoch: 14 cost time: 2.2598819732666016
Epoch: 14, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.709 Vali Acc: 0.769 Test Loss: 0.709 Test Acc: 0.769
Validation loss decreased (-0.751439 --> -0.768779).  Saving model ...
Epoch: 15 cost time: 2.068387746810913
Epoch: 15, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.858 Vali Acc: 0.775 Test Loss: 0.858 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774558).  Saving model ...
Epoch: 16 cost time: 2.3837246894836426
Epoch: 16, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.780 Vali Acc: 0.792 Test Loss: 0.780 Test Acc: 0.792
Validation loss decreased (-0.774558 --> -0.791900).  Saving model ...
Epoch: 17 cost time: 2.3810617923736572
Epoch: 17, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.787 Vali Acc: 0.798 Test Loss: 0.787 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797680).  Saving model ...
Epoch: 18 cost time: 2.3827786445617676
Epoch: 18, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.837 Vali Acc: 0.751 Test Loss: 0.837 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.188204526901245
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.761 Vali Acc: 0.775 Test Loss: 0.761 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.168694496154785
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.843 Vali Acc: 0.792 Test Loss: 0.843 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.251824140548706
Epoch: 21, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
Validation loss decreased (-0.797680 --> -0.809241).  Saving model ...
Epoch: 22 cost time: 2.256504535675049
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.752 Vali Acc: 0.815 Test Loss: 0.752 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815021).  Saving model ...
Epoch: 23 cost time: 2.0424540042877197
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.146541118621826
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.738 Vali Acc: 0.809 Test Loss: 0.738 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.4099509716033936
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.984 Vali Acc: 0.827 Test Loss: 0.984 Test Acc: 0.827
Validation loss decreased (-0.815021 --> -0.826580).  Saving model ...
Epoch: 26 cost time: 2.2360386848449707
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.137 Vali Acc: 0.827 Test Loss: 1.137 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.0915703773498535
Epoch: 27, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.005 Vali Acc: 0.821 Test Loss: 1.005 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0904171466827393
Epoch: 28, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.812 Vali Acc: 0.821 Test Loss: 0.812 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 2.206458568572998
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.794 Vali Acc: 0.821 Test Loss: 0.794 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 2.0693774223327637
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.854 Vali Acc: 0.798 Test Loss: 0.854 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.149163007736206
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.964 Vali Acc: 0.798 Test Loss: 0.964 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 32 cost time: 2.0779829025268555
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.887 Vali Acc: 0.792 Test Loss: 0.887 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 33 cost time: 2.290825605392456
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.918 Vali Acc: 0.792 Test Loss: 0.918 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 34 cost time: 2.187673568725586
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.924 Vali Acc: 0.780 Test Loss: 0.924 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 35 cost time: 2.1151931285858154
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.792 Test Loss: 0.897 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 293215
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.327082633972168
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.833 Vali Acc: 0.266 Test Loss: 1.833 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 2.337643623352051
Epoch: 2, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.538 Vali Acc: 0.399 Test Loss: 1.538 Test Acc: 0.399
Validation loss decreased (-0.265878 --> -0.398829).  Saving model ...
Epoch: 3 cost time: 2.223304271697998
Epoch: 3, Steps: 17 | Train Loss: 1.419 Vali Loss: 1.360 Vali Acc: 0.387 Test Loss: 1.360 Test Acc: 0.387
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.3531994819641113
Epoch: 4, Steps: 17 | Train Loss: 1.219 Vali Loss: 1.147 Vali Acc: 0.520 Test Loss: 1.147 Test Acc: 0.520
Validation loss decreased (-0.398829 --> -0.520220).  Saving model ...
Epoch: 5 cost time: 2.424726963043213
Epoch: 5, Steps: 17 | Train Loss: 1.040 Vali Loss: 1.002 Vali Acc: 0.618 Test Loss: 1.002 Test Acc: 0.618
Validation loss decreased (-0.520220 --> -0.618487).  Saving model ...
Epoch: 6 cost time: 2.3615434169769287
Epoch: 6, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.957 Vali Acc: 0.613 Test Loss: 0.957 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2127339839935303
Epoch: 7, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.925 Vali Acc: 0.590 Test Loss: 0.925 Test Acc: 0.590
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.330152750015259
Epoch: 8, Steps: 17 | Train Loss: 0.703 Vali Loss: 0.852 Vali Acc: 0.671 Test Loss: 0.852 Test Acc: 0.671
Validation loss decreased (-0.618487 --> -0.670512).  Saving model ...
Epoch: 9 cost time: 2.316506862640381
Epoch: 9, Steps: 17 | Train Loss: 0.636 Vali Loss: 0.805 Vali Acc: 0.723 Test Loss: 0.805 Test Acc: 0.723
Validation loss decreased (-0.670512 --> -0.722535).  Saving model ...
Epoch: 10 cost time: 2.351435661315918
Epoch: 10, Steps: 17 | Train Loss: 0.522 Vali Loss: 0.840 Vali Acc: 0.653 Test Loss: 0.840 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.216909646987915
Epoch: 11, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.927 Vali Acc: 0.659 Test Loss: 0.927 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.227977991104126
Epoch: 12, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.775 Vali Acc: 0.717 Test Loss: 0.775 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.370943069458008
Epoch: 13, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.698 Vali Acc: 0.746 Test Loss: 0.698 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745658).  Saving model ...
Epoch: 14 cost time: 2.320880651473999
Epoch: 14, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.741 Vali Acc: 0.751 Test Loss: 0.741 Test Acc: 0.751
Validation loss decreased (-0.745658 --> -0.751438).  Saving model ...
Epoch: 15 cost time: 2.026780128479004
Epoch: 15, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.743 Vali Acc: 0.798 Test Loss: 0.743 Test Acc: 0.798
Validation loss decreased (-0.751438 --> -0.797680).  Saving model ...
Epoch: 16 cost time: 2.0811514854431152
Epoch: 16, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.900 Vali Acc: 0.728 Test Loss: 0.900 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.054717779159546
Epoch: 17, Steps: 17 | Train Loss: 0.206 Vali Loss: 0.842 Vali Acc: 0.769 Test Loss: 0.842 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0751705169677734
Epoch: 18, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.768 Vali Acc: 0.786 Test Loss: 0.768 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.119647741317749
Epoch: 19, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.995 Vali Acc: 0.775 Test Loss: 0.995 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.473531484603882
Epoch: 20, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.973 Vali Acc: 0.798 Test Loss: 0.973 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.7051308155059814
Epoch: 21, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.764 Vali Acc: 0.809 Test Loss: 0.764 Test Acc: 0.809
Validation loss decreased (-0.797680 --> -0.809241).  Saving model ...
Epoch: 22 cost time: 2.251338243484497
Epoch: 22, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.809 Vali Acc: 0.757 Test Loss: 0.809 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.546715497970581
Epoch: 23, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.840 Vali Acc: 0.786 Test Loss: 0.840 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.780679225921631
Epoch: 24, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.998 Vali Acc: 0.803 Test Loss: 0.998 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.411639928817749
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.050 Vali Acc: 0.815 Test Loss: 1.050 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815018).  Saving model ...
Epoch: 26 cost time: 2.782607078552246
Epoch: 26, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.158 Vali Acc: 0.780 Test Loss: 1.158 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 2.5260398387908936
Epoch: 27, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.949 Vali Acc: 0.815 Test Loss: 0.949 Test Acc: 0.815
Validation loss decreased (-0.815018 --> -0.815019).  Saving model ...
Epoch: 28 cost time: 2.589346408843994
Epoch: 28, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.995 Vali Acc: 0.803 Test Loss: 0.995 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.773010730743408
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.943 Vali Acc: 0.821 Test Loss: 0.943 Test Acc: 0.821
Validation loss decreased (-0.815019 --> -0.820800).  Saving model ...
Epoch: 30 cost time: 2.752487897872925
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.847 Vali Acc: 0.821 Test Loss: 0.847 Test Acc: 0.821
Validation loss decreased (-0.820800 --> -0.820801).  Saving model ...
Epoch: 31 cost time: 2.5821409225463867
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.890 Vali Acc: 0.815 Test Loss: 0.890 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.401491403579712
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.924 Vali Acc: 0.815 Test Loss: 0.924 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.5856664180755615
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.886 Vali Acc: 0.809 Test Loss: 0.886 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.362370491027832
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.984 Vali Acc: 0.792 Test Loss: 0.984 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.5651450157165527
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.960 Vali Acc: 0.821 Test Loss: 0.960 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 3.129739761352539
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.007 Vali Acc: 0.821 Test Loss: 1.007 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.6831002235412598
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.949 Vali Acc: 0.827 Test Loss: 0.949 Test Acc: 0.827
Validation loss decreased (-0.820801 --> -0.826580).  Saving model ...
Epoch: 38 cost time: 2.8070168495178223
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.970 Vali Acc: 0.815 Test Loss: 0.970 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.7038702964782715
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.815 Test Loss: 0.962 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.4656989574432373
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.992 Vali Acc: 0.815 Test Loss: 0.992 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.6769063472747803
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.995 Vali Acc: 0.815 Test Loss: 0.995 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.6490938663482666
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.996 Vali Acc: 0.803 Test Loss: 0.996 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.938180685043335
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.998 Vali Acc: 0.815 Test Loss: 0.998 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.83463454246521
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.011 Vali Acc: 0.815 Test Loss: 1.011 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.5377275943756104
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.001 Vali Acc: 0.821 Test Loss: 1.001 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 2.6209709644317627
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.815 Test Loss: 1.020 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.5470194816589355
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.021 Vali Acc: 0.815 Test Loss: 1.021 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 293215
model size : 1.75MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.244251251220703
Epoch: 1, Steps: 17 | Train Loss: 2.099 Vali Loss: 1.870 Vali Acc: 0.162 Test Loss: 1.870 Test Acc: 0.162
Validation loss decreased (inf --> -0.161831).  Saving model ...
Epoch: 2 cost time: 2.1899194717407227
Epoch: 2, Steps: 17 | Train Loss: 1.684 Vali Loss: 1.506 Vali Acc: 0.376 Test Loss: 1.506 Test Acc: 0.376
Validation loss decreased (-0.161831 --> -0.375707).  Saving model ...
Epoch: 3 cost time: 2.4561150074005127
Epoch: 3, Steps: 17 | Train Loss: 1.443 Vali Loss: 1.361 Vali Acc: 0.393 Test Loss: 1.361 Test Acc: 0.393
Validation loss decreased (-0.375707 --> -0.393050).  Saving model ...
Epoch: 4 cost time: 2.2156519889831543
Epoch: 4, Steps: 17 | Train Loss: 1.181 Vali Loss: 1.125 Vali Acc: 0.451 Test Loss: 1.125 Test Acc: 0.451
Validation loss decreased (-0.393050 --> -0.450856).  Saving model ...
Epoch: 5 cost time: 2.507037878036499
Epoch: 5, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.000 Vali Acc: 0.642 Test Loss: 1.000 Test Acc: 0.642
Validation loss decreased (-0.450856 --> -0.641608).  Saving model ...
Epoch: 6 cost time: 2.6902010440826416
Epoch: 6, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.816 Vali Acc: 0.659 Test Loss: 0.816 Test Acc: 0.659
Validation loss decreased (-0.641608 --> -0.658951).  Saving model ...
Epoch: 7 cost time: 2.247100830078125
Epoch: 7, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.758 Vali Acc: 0.775 Test Loss: 0.758 Test Acc: 0.775
Validation loss decreased (-0.658951 --> -0.774559).  Saving model ...
Epoch: 8 cost time: 2.3631415367126465
Epoch: 8, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.721 Vali Acc: 0.751 Test Loss: 0.721 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.35343074798584
Epoch: 9, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.638 Vali Acc: 0.798 Test Loss: 0.638 Test Acc: 0.798
Validation loss decreased (-0.774559 --> -0.797681).  Saving model ...
Epoch: 10 cost time: 2.29536509513855
Epoch: 10, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.652 Vali Acc: 0.746 Test Loss: 0.652 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4257917404174805
Epoch: 11, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.585 Vali Acc: 0.809 Test Loss: 0.585 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809243).  Saving model ...
Epoch: 12 cost time: 2.417583465576172
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.814 Vali Acc: 0.757 Test Loss: 0.814 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4003636837005615
Epoch: 13, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.542 Vali Acc: 0.844 Test Loss: 0.542 Test Acc: 0.844
Validation loss decreased (-0.809243 --> -0.843925).  Saving model ...
Epoch: 14 cost time: 2.375373125076294
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.580 Vali Acc: 0.832 Test Loss: 0.580 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.3257341384887695
Epoch: 15, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.532 Vali Acc: 0.838 Test Loss: 0.532 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.536478042602539
Epoch: 16, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.526 Vali Acc: 0.861 Test Loss: 0.526 Test Acc: 0.861
Validation loss decreased (-0.843925 --> -0.861266).  Saving model ...
Epoch: 17 cost time: 2.7849037647247314
Epoch: 17, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.610 Vali Acc: 0.798 Test Loss: 0.610 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.6638734340667725
Epoch: 18, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.629 Vali Acc: 0.838 Test Loss: 0.629 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.7213985919952393
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.702 Vali Acc: 0.821 Test Loss: 0.702 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.6095974445343018
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.45778226852417
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.693 Vali Acc: 0.832 Test Loss: 0.693 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.8728725910186768
Epoch: 22, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.684 Vali Acc: 0.844 Test Loss: 0.684 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.6262195110321045
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.664 Vali Acc: 0.844 Test Loss: 0.664 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.703345775604248
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.832 Test Loss: 0.707 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.9365527629852295
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.666 Vali Acc: 0.850 Test Loss: 0.666 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.942350387573242
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.844 Test Loss: 0.770 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 276831
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.641394138336182
Epoch: 1, Steps: 17 | Train Loss: 2.097 Vali Loss: 1.862 Vali Acc: 0.191 Test Loss: 1.862 Test Acc: 0.191
Validation loss decreased (inf --> -0.190733).  Saving model ...
Epoch: 2 cost time: 3.003126382827759
Epoch: 2, Steps: 17 | Train Loss: 1.679 Vali Loss: 1.510 Vali Acc: 0.341 Test Loss: 1.510 Test Acc: 0.341
Validation loss decreased (-0.190733 --> -0.341025).  Saving model ...
Epoch: 3 cost time: 2.892789125442505
Epoch: 3, Steps: 17 | Train Loss: 1.455 Vali Loss: 1.380 Vali Acc: 0.405 Test Loss: 1.380 Test Acc: 0.405
Validation loss decreased (-0.341025 --> -0.404610).  Saving model ...
Epoch: 4 cost time: 2.902362585067749
Epoch: 4, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.128 Vali Acc: 0.468 Test Loss: 1.128 Test Acc: 0.468
Validation loss decreased (-0.404610 --> -0.468197).  Saving model ...
Epoch: 5 cost time: 2.834942102432251
Epoch: 5, Steps: 17 | Train Loss: 0.958 Vali Loss: 1.018 Vali Acc: 0.636 Test Loss: 1.018 Test Acc: 0.636
Validation loss decreased (-0.468197 --> -0.635828).  Saving model ...
Epoch: 6 cost time: 2.8745498657226562
Epoch: 6, Steps: 17 | Train Loss: 0.806 Vali Loss: 0.835 Vali Acc: 0.642 Test Loss: 0.835 Test Acc: 0.642
Validation loss decreased (-0.635828 --> -0.641610).  Saving model ...
Epoch: 7 cost time: 2.9151854515075684
Epoch: 7, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.822 Vali Acc: 0.734 Test Loss: 0.822 Test Acc: 0.734
Validation loss decreased (-0.641610 --> -0.734096).  Saving model ...
Epoch: 8 cost time: 2.699852228164673
Epoch: 8, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.699 Vali Acc: 0.751 Test Loss: 0.699 Test Acc: 0.751
Validation loss decreased (-0.734096 --> -0.751438).  Saving model ...
Epoch: 9 cost time: 2.6077215671539307
Epoch: 9, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.653 Vali Acc: 0.763 Test Loss: 0.653 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 2.792469024658203
Epoch: 10, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.678 Vali Acc: 0.728 Test Loss: 0.678 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.6614434719085693
Epoch: 11, Steps: 17 | Train Loss: 0.354 Vali Loss: 0.608 Vali Acc: 0.803 Test Loss: 0.608 Test Acc: 0.803
Validation loss decreased (-0.762999 --> -0.803462).  Saving model ...
Epoch: 12 cost time: 2.622081995010376
Epoch: 12, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.671 Vali Acc: 0.763 Test Loss: 0.671 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.055899143218994
Epoch: 13, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.533 Vali Acc: 0.855 Test Loss: 0.533 Test Acc: 0.855
Validation loss decreased (-0.803462 --> -0.855486).  Saving model ...
Epoch: 14 cost time: 2.845923900604248
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.529 Vali Acc: 0.838 Test Loss: 0.529 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.553929090499878
Epoch: 15, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.586 Vali Acc: 0.855 Test Loss: 0.586 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.6829402446746826
Epoch: 16, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.647 Vali Acc: 0.815 Test Loss: 0.647 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.841334342956543
Epoch: 17, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.555 Vali Acc: 0.827 Test Loss: 0.555 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.7461650371551514
Epoch: 18, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.631 Vali Acc: 0.867 Test Loss: 0.631 Test Acc: 0.867
Validation loss decreased (-0.855486 --> -0.867046).  Saving model ...
Epoch: 19 cost time: 2.56113600730896
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.636 Vali Acc: 0.844 Test Loss: 0.636 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.5780398845672607
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.652 Vali Acc: 0.827 Test Loss: 0.652 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.315995693206787
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.702 Vali Acc: 0.821 Test Loss: 0.702 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.427865505218506
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.694 Vali Acc: 0.850 Test Loss: 0.694 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.7977468967437744
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.660 Vali Acc: 0.832 Test Loss: 0.660 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.871256113052368
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.730 Vali Acc: 0.815 Test Loss: 0.730 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.8042094707489014
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.690 Vali Acc: 0.838 Test Loss: 0.690 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.7440993785858154
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.844 Test Loss: 0.750 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.7643158435821533
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.856989860534668
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.667 Vali Acc: 0.844 Test Loss: 0.667 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 276831
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.216213703155518
Epoch: 1, Steps: 17 | Train Loss: 2.085 Vali Loss: 1.850 Vali Acc: 0.173 Test Loss: 1.850 Test Acc: 0.173
Validation loss decreased (inf --> -0.173392).  Saving model ...
Epoch: 2 cost time: 2.5781445503234863
Epoch: 2, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.530 Vali Acc: 0.376 Test Loss: 1.530 Test Acc: 0.376
Validation loss decreased (-0.173392 --> -0.375707).  Saving model ...
Epoch: 3 cost time: 2.9408223628997803
Epoch: 3, Steps: 17 | Train Loss: 1.456 Vali Loss: 1.390 Vali Acc: 0.416 Test Loss: 1.390 Test Acc: 0.416
Validation loss decreased (-0.375707 --> -0.416171).  Saving model ...
Epoch: 4 cost time: 3.0437850952148438
Epoch: 4, Steps: 17 | Train Loss: 1.224 Vali Loss: 1.160 Vali Acc: 0.399 Test Loss: 1.160 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.730133295059204
Epoch: 5, Steps: 17 | Train Loss: 0.981 Vali Loss: 1.029 Vali Acc: 0.601 Test Loss: 1.029 Test Acc: 0.601
Validation loss decreased (-0.416171 --> -0.601146).  Saving model ...
Epoch: 6 cost time: 2.686577081680298
Epoch: 6, Steps: 17 | Train Loss: 0.847 Vali Loss: 0.848 Vali Acc: 0.613 Test Loss: 0.848 Test Acc: 0.613
Validation loss decreased (-0.601146 --> -0.612708).  Saving model ...
Epoch: 7 cost time: 2.954624652862549
Epoch: 7, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.814 Vali Acc: 0.734 Test Loss: 0.814 Test Acc: 0.734
Validation loss decreased (-0.612708 --> -0.734096).  Saving model ...
Epoch: 8 cost time: 2.8794186115264893
Epoch: 8, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.703 Vali Acc: 0.786 Test Loss: 0.703 Test Acc: 0.786
Validation loss decreased (-0.734096 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 2.7061710357666016
Epoch: 9, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.665 Vali Acc: 0.728 Test Loss: 0.665 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.812671422958374
Epoch: 10, Steps: 17 | Train Loss: 0.373 Vali Loss: 0.724 Vali Acc: 0.734 Test Loss: 0.724 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.9819819927215576
Epoch: 11, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.606 Vali Acc: 0.803 Test Loss: 0.606 Test Acc: 0.803
Validation loss decreased (-0.786120 --> -0.803462).  Saving model ...
Epoch: 12 cost time: 2.8639163970947266
Epoch: 12, Steps: 17 | Train Loss: 0.304 Vali Loss: 0.694 Vali Acc: 0.763 Test Loss: 0.694 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.887442111968994
Epoch: 13, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.564 Vali Acc: 0.803 Test Loss: 0.564 Test Acc: 0.803
Validation loss decreased (-0.803462 --> -0.803463).  Saving model ...
Epoch: 14 cost time: 2.8552589416503906
Epoch: 14, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.555 Vali Acc: 0.827 Test Loss: 0.555 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826584).  Saving model ...
Epoch: 15 cost time: 2.7495946884155273
Epoch: 15, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.649 Vali Acc: 0.809 Test Loss: 0.649 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.9255027770996094
Epoch: 16, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.693 Vali Acc: 0.815 Test Loss: 0.693 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 3.0808298587799072
Epoch: 17, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.686 Vali Acc: 0.798 Test Loss: 0.686 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 3.15043306350708
Epoch: 18, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.624 Vali Acc: 0.832 Test Loss: 0.624 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832364).  Saving model ...
Epoch: 19 cost time: 3.074622392654419
Epoch: 19, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.646 Vali Acc: 0.832 Test Loss: 0.646 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 3.0602357387542725
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.640 Vali Acc: 0.809 Test Loss: 0.640 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 3.082127094268799
Epoch: 21, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.895 Vali Acc: 0.786 Test Loss: 0.895 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 3.279515027999878
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.975 Vali Acc: 0.803 Test Loss: 0.975 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 3.174988031387329
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.878 Vali Acc: 0.803 Test Loss: 0.878 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.9630541801452637
Epoch: 24, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.938 Vali Acc: 0.798 Test Loss: 0.938 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 3.1011178493499756
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.849 Vali Acc: 0.792 Test Loss: 0.849 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.0785114765167236
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.855 Vali Acc: 0.815 Test Loss: 0.855 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 3.5319607257843018
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.7898457050323486
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.857 Vali Acc: 0.803 Test Loss: 0.857 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 276831
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.886194467544556
Epoch: 1, Steps: 17 | Train Loss: 2.032 Vali Loss: 1.849 Vali Acc: 0.249 Test Loss: 1.849 Test Acc: 0.249
Validation loss decreased (inf --> -0.248536).  Saving model ...
Epoch: 2 cost time: 2.815929889678955
Epoch: 2, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.550 Vali Acc: 0.405 Test Loss: 1.550 Test Acc: 0.405
Validation loss decreased (-0.248536 --> -0.404609).  Saving model ...
Epoch: 3 cost time: 2.9924190044403076
Epoch: 3, Steps: 17 | Train Loss: 1.493 Vali Loss: 1.419 Vali Acc: 0.295 Test Loss: 1.419 Test Acc: 0.295
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9516355991363525
Epoch: 4, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.236 Vali Acc: 0.439 Test Loss: 1.236 Test Acc: 0.439
Validation loss decreased (-0.404609 --> -0.439294).  Saving model ...
Epoch: 5 cost time: 2.7211787700653076
Epoch: 5, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.190 Vali Acc: 0.457 Test Loss: 1.190 Test Acc: 0.457
Validation loss decreased (-0.439294 --> -0.456635).  Saving model ...
Epoch: 6 cost time: 2.784684181213379
Epoch: 6, Steps: 17 | Train Loss: 0.995 Vali Loss: 0.995 Vali Acc: 0.532 Test Loss: 0.995 Test Acc: 0.532
Validation loss decreased (-0.456635 --> -0.531782).  Saving model ...
Epoch: 7 cost time: 2.718526601791382
Epoch: 7, Steps: 17 | Train Loss: 0.884 Vali Loss: 0.950 Vali Acc: 0.624 Test Loss: 0.950 Test Acc: 0.624
Validation loss decreased (-0.531782 --> -0.624268).  Saving model ...
Epoch: 8 cost time: 2.7339184284210205
Epoch: 8, Steps: 17 | Train Loss: 0.724 Vali Loss: 0.824 Vali Acc: 0.705 Test Loss: 0.824 Test Acc: 0.705
Validation loss decreased (-0.624268 --> -0.705194).  Saving model ...
Epoch: 9 cost time: 2.9260594844818115
Epoch: 9, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.741 Vali Acc: 0.746 Test Loss: 0.741 Test Acc: 0.746
Validation loss decreased (-0.705194 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 2.9339399337768555
Epoch: 10, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.726 Vali Acc: 0.734 Test Loss: 0.726 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 3.0913889408111572
Epoch: 11, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.890 Vali Acc: 0.717 Test Loss: 0.890 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.8656859397888184
Epoch: 12, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.683 Vali Acc: 0.734 Test Loss: 0.683 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.7252891063690186
Epoch: 13, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.710 Vali Acc: 0.786 Test Loss: 0.710 Test Acc: 0.786
Validation loss decreased (-0.745657 --> -0.786120).  Saving model ...
Epoch: 14 cost time: 2.860663890838623
Epoch: 14, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.734 Vali Acc: 0.769 Test Loss: 0.734 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.8372554779052734
Epoch: 15, Steps: 17 | Train Loss: 0.260 Vali Loss: 0.758 Vali Acc: 0.751 Test Loss: 0.758 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.961219549179077
Epoch: 16, Steps: 17 | Train Loss: 0.209 Vali Loss: 0.776 Vali Acc: 0.798 Test Loss: 0.776 Test Acc: 0.798
Validation loss decreased (-0.786120 --> -0.797680).  Saving model ...
Epoch: 17 cost time: 2.9296600818634033
Epoch: 17, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.693 Vali Acc: 0.803 Test Loss: 0.693 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803461).  Saving model ...
Epoch: 18 cost time: 2.8713479042053223
Epoch: 18, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.628 Vali Acc: 0.786 Test Loss: 0.628 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.798492670059204
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.845 Vali Acc: 0.809 Test Loss: 0.845 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809240).  Saving model ...
Epoch: 20 cost time: 2.8793368339538574
Epoch: 20, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.797 Vali Acc: 0.809 Test Loss: 0.797 Test Acc: 0.809
Validation loss decreased (-0.809240 --> -0.809241).  Saving model ...
Epoch: 21 cost time: 3.1088411808013916
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.683 Vali Acc: 0.798 Test Loss: 0.683 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.85396409034729
Epoch: 22, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.871 Vali Acc: 0.780 Test Loss: 0.871 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.597031354904175
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.793 Vali Acc: 0.827 Test Loss: 0.793 Test Acc: 0.827
Validation loss decreased (-0.809241 --> -0.826582).  Saving model ...
Epoch: 24 cost time: 2.8182592391967773
Epoch: 24, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.893 Vali Acc: 0.751 Test Loss: 0.893 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.8604650497436523
Epoch: 25, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.894 Vali Acc: 0.821 Test Loss: 0.894 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.662198543548584
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.073 Vali Acc: 0.786 Test Loss: 1.073 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.7241835594177246
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.870 Vali Acc: 0.809 Test Loss: 0.870 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 2.700810194015503
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.837 Vali Acc: 0.821 Test Loss: 0.837 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.677630662918091
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.910 Vali Acc: 0.803 Test Loss: 0.910 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 2.3241336345672607
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.103 Vali Acc: 0.803 Test Loss: 1.103 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.654231309890747
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.042 Vali Acc: 0.798 Test Loss: 1.042 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.7816524505615234
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.995 Vali Acc: 0.803 Test Loss: 0.995 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 2.93778133392334
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.017 Vali Acc: 0.803 Test Loss: 1.017 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 276831
model size : 1.68MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.479924917221069
Epoch: 1, Steps: 17 | Train Loss: 1.942 Vali Loss: 1.780 Vali Acc: 0.231 Test Loss: 1.780 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 2.856233835220337
Epoch: 2, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.396 Vali Acc: 0.393 Test Loss: 1.396 Test Acc: 0.393
Validation loss decreased (-0.231196 --> -0.393050).  Saving model ...
Epoch: 3 cost time: 2.510389804840088
Epoch: 3, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.138 Vali Acc: 0.566 Test Loss: 1.138 Test Acc: 0.566
Validation loss decreased (-0.393050 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 2.5179953575134277
Epoch: 4, Steps: 17 | Train Loss: 1.115 Vali Loss: 0.981 Vali Acc: 0.543 Test Loss: 0.981 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 3.027747631072998
Epoch: 5, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.895 Vali Acc: 0.624 Test Loss: 0.895 Test Acc: 0.624
Validation loss decreased (-0.566463 --> -0.624269).  Saving model ...
Epoch: 6 cost time: 2.90329647064209
Epoch: 6, Steps: 17 | Train Loss: 0.748 Vali Loss: 0.790 Vali Acc: 0.653 Test Loss: 0.790 Test Acc: 0.653
Validation loss decreased (-0.624269 --> -0.653171).  Saving model ...
Epoch: 7 cost time: 2.8763365745544434
Epoch: 7, Steps: 17 | Train Loss: 0.671 Vali Loss: 0.800 Vali Acc: 0.671 Test Loss: 0.800 Test Acc: 0.671
Validation loss decreased (-0.653171 --> -0.670512).  Saving model ...
Epoch: 8 cost time: 3.087289810180664
Epoch: 8, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.851 Vali Acc: 0.601 Test Loss: 0.851 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 3.1580653190612793
Epoch: 9, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.687 Vali Acc: 0.723 Test Loss: 0.687 Test Acc: 0.723
Validation loss decreased (-0.670512 --> -0.722536).  Saving model ...
Epoch: 10 cost time: 3.2002315521240234
Epoch: 10, Steps: 17 | Train Loss: 0.372 Vali Loss: 0.710 Vali Acc: 0.740 Test Loss: 0.710 Test Acc: 0.740
Validation loss decreased (-0.722536 --> -0.739877).  Saving model ...
Epoch: 11 cost time: 2.9951610565185547
Epoch: 11, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.543 Vali Acc: 0.803 Test Loss: 0.543 Test Acc: 0.803
Validation loss decreased (-0.739877 --> -0.803463).  Saving model ...
Epoch: 12 cost time: 3.256098747253418
Epoch: 12, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.546 Vali Acc: 0.827 Test Loss: 0.546 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826584).  Saving model ...
Epoch: 13 cost time: 3.1887614727020264
Epoch: 13, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.502 Vali Acc: 0.844 Test Loss: 0.502 Test Acc: 0.844
Validation loss decreased (-0.826584 --> -0.843926).  Saving model ...
Epoch: 14 cost time: 3.047271251678467
Epoch: 14, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.612 Vali Acc: 0.832 Test Loss: 0.612 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 3.021273374557495
Epoch: 15, Steps: 17 | Train Loss: 0.079 Vali Loss: 0.637 Vali Acc: 0.803 Test Loss: 0.637 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 3.4539895057678223
Epoch: 16, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.577 Vali Acc: 0.827 Test Loss: 0.577 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.9479029178619385
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.600 Vali Acc: 0.832 Test Loss: 0.600 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.6650166511535645
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.542 Vali Acc: 0.838 Test Loss: 0.542 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.783597946166992
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.532 Vali Acc: 0.821 Test Loss: 0.532 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.9795379638671875
Epoch: 20, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.601 Vali Acc: 0.827 Test Loss: 0.601 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.7862753868103027
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.600 Vali Acc: 0.832 Test Loss: 0.600 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.852590560913086
Epoch: 22, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.604 Vali Acc: 0.827 Test Loss: 0.604 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.790663719177246
Epoch: 23, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.861 Vali Acc: 0.803 Test Loss: 0.861 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 268639
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.391594409942627
Epoch: 1, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.780 Vali Acc: 0.220 Test Loss: 1.780 Test Acc: 0.220
Validation loss decreased (inf --> -0.219635).  Saving model ...
Epoch: 2 cost time: 2.6779897212982178
Epoch: 2, Steps: 17 | Train Loss: 1.599 Vali Loss: 1.396 Vali Acc: 0.376 Test Loss: 1.396 Test Acc: 0.376
Validation loss decreased (-0.219635 --> -0.375709).  Saving model ...
Epoch: 3 cost time: 2.3860116004943848
Epoch: 3, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.170 Vali Acc: 0.555 Test Loss: 1.170 Test Acc: 0.555
Validation loss decreased (-0.375709 --> -0.554902).  Saving model ...
Epoch: 4 cost time: 2.5753560066223145
Epoch: 4, Steps: 17 | Train Loss: 1.122 Vali Loss: 0.999 Vali Acc: 0.543 Test Loss: 0.999 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.5811920166015625
Epoch: 5, Steps: 17 | Train Loss: 0.949 Vali Loss: 0.935 Vali Acc: 0.578 Test Loss: 0.935 Test Acc: 0.578
Validation loss decreased (-0.554902 --> -0.578025).  Saving model ...
Epoch: 6 cost time: 2.5208349227905273
Epoch: 6, Steps: 17 | Train Loss: 0.763 Vali Loss: 0.808 Vali Acc: 0.647 Test Loss: 0.808 Test Acc: 0.647
Validation loss decreased (-0.578025 --> -0.647391).  Saving model ...
Epoch: 7 cost time: 2.6814045906066895
Epoch: 7, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.807 Vali Acc: 0.647 Test Loss: 0.807 Test Acc: 0.647
Validation loss decreased (-0.647391 --> -0.647391).  Saving model ...
Epoch: 8 cost time: 2.4453377723693848
Epoch: 8, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.843 Vali Acc: 0.607 Test Loss: 0.843 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4380033016204834
Epoch: 9, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.764 Vali Acc: 0.694 Test Loss: 0.764 Test Acc: 0.694
Validation loss decreased (-0.647391 --> -0.693634).  Saving model ...
Epoch: 10 cost time: 2.4926586151123047
Epoch: 10, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.718 Vali Acc: 0.723 Test Loss: 0.718 Test Acc: 0.723
Validation loss decreased (-0.693634 --> -0.722536).  Saving model ...
Epoch: 11 cost time: 2.518301248550415
Epoch: 11, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.574 Vali Acc: 0.798 Test Loss: 0.574 Test Acc: 0.798
Validation loss decreased (-0.722536 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 2.6128833293914795
Epoch: 12, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.552 Vali Acc: 0.786 Test Loss: 0.552 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.37257981300354
Epoch: 13, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.610 Vali Acc: 0.792 Test Loss: 0.610 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6042726039886475
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.615 Vali Acc: 0.821 Test Loss: 0.615 Test Acc: 0.821
Validation loss decreased (-0.797682 --> -0.820803).  Saving model ...
Epoch: 15 cost time: 2.6182310581207275
Epoch: 15, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.878 Vali Acc: 0.780 Test Loss: 0.878 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.267132043838501
Epoch: 16, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.574 Vali Acc: 0.832 Test Loss: 0.574 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832364).  Saving model ...
Epoch: 17 cost time: 2.2584779262542725
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.625 Vali Acc: 0.821 Test Loss: 0.625 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.4859509468078613
Epoch: 18, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.549 Vali Acc: 0.815 Test Loss: 0.549 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.688549280166626
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.595 Vali Acc: 0.832 Test Loss: 0.595 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0586180686950684
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.615 Vali Acc: 0.855 Test Loss: 0.615 Test Acc: 0.855
Validation loss decreased (-0.832364 --> -0.855485).  Saving model ...
Epoch: 21 cost time: 3.0000147819519043
Epoch: 21, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.596 Vali Acc: 0.832 Test Loss: 0.596 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.8915350437164307
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.623 Vali Acc: 0.821 Test Loss: 0.623 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.8623206615448
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.633 Vali Acc: 0.821 Test Loss: 0.633 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 3.3182730674743652
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.707 Vali Acc: 0.821 Test Loss: 0.707 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.722848653793335
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.672 Vali Acc: 0.838 Test Loss: 0.672 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.6490745544433594
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.628 Vali Acc: 0.867 Test Loss: 0.628 Test Acc: 0.867
Validation loss decreased (-0.855485 --> -0.867046).  Saving model ...
Epoch: 27 cost time: 2.809216022491455
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.693 Vali Acc: 0.844 Test Loss: 0.693 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.8414573669433594
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.702 Vali Acc: 0.838 Test Loss: 0.702 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.787034034729004
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.674 Vali Acc: 0.827 Test Loss: 0.674 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 3.157017707824707
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.660 Vali Acc: 0.850 Test Loss: 0.660 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.6220295429229736
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.844 Test Loss: 0.785 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.65049409866333
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.850 Test Loss: 0.687 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 3.0148556232452393
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.717 Vali Acc: 0.855 Test Loss: 0.717 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.613938570022583
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.709 Vali Acc: 0.815 Test Loss: 0.709 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.6919097900390625
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.724 Vali Acc: 0.827 Test Loss: 0.724 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.9127085208892822
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.705 Vali Acc: 0.844 Test Loss: 0.705 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 268639
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.350645303726196
Epoch: 1, Steps: 17 | Train Loss: 1.908 Vali Loss: 1.769 Vali Acc: 0.243 Test Loss: 1.769 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 2.5261197090148926
Epoch: 2, Steps: 17 | Train Loss: 1.598 Vali Loss: 1.407 Vali Acc: 0.370 Test Loss: 1.407 Test Acc: 0.370
Validation loss decreased (-0.242757 --> -0.369928).  Saving model ...
Epoch: 3 cost time: 2.5972189903259277
Epoch: 3, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.205 Vali Acc: 0.520 Test Loss: 1.205 Test Acc: 0.520
Validation loss decreased (-0.369928 --> -0.520219).  Saving model ...
Epoch: 4 cost time: 2.692056655883789
Epoch: 4, Steps: 17 | Train Loss: 1.135 Vali Loss: 1.037 Vali Acc: 0.520 Test Loss: 1.037 Test Acc: 0.520
Validation loss decreased (-0.520219 --> -0.520221).  Saving model ...
Epoch: 5 cost time: 2.6676478385925293
Epoch: 5, Steps: 17 | Train Loss: 0.961 Vali Loss: 0.960 Vali Acc: 0.578 Test Loss: 0.960 Test Acc: 0.578
Validation loss decreased (-0.520221 --> -0.578025).  Saving model ...
Epoch: 6 cost time: 2.6539132595062256
Epoch: 6, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.860 Vali Acc: 0.618 Test Loss: 0.860 Test Acc: 0.618
Validation loss decreased (-0.578025 --> -0.618489).  Saving model ...
Epoch: 7 cost time: 2.620093584060669
Epoch: 7, Steps: 17 | Train Loss: 0.700 Vali Loss: 0.809 Vali Acc: 0.711 Test Loss: 0.809 Test Acc: 0.711
Validation loss decreased (-0.618489 --> -0.710975).  Saving model ...
Epoch: 8 cost time: 2.631361722946167
Epoch: 8, Steps: 17 | Train Loss: 0.525 Vali Loss: 0.812 Vali Acc: 0.601 Test Loss: 0.812 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4705193042755127
Epoch: 9, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.731 Vali Acc: 0.728 Test Loss: 0.731 Test Acc: 0.728
Validation loss decreased (-0.710975 --> -0.728316).  Saving model ...
Epoch: 10 cost time: 2.736804485321045
Epoch: 10, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.755 Vali Acc: 0.740 Test Loss: 0.755 Test Acc: 0.740
Validation loss decreased (-0.728316 --> -0.739877).  Saving model ...
Epoch: 11 cost time: 2.5774338245391846
Epoch: 11, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.601 Vali Acc: 0.769 Test Loss: 0.601 Test Acc: 0.769
Validation loss decreased (-0.739877 --> -0.768780).  Saving model ...
Epoch: 12 cost time: 2.4892001152038574
Epoch: 12, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.591 Vali Acc: 0.792 Test Loss: 0.591 Test Acc: 0.792
Validation loss decreased (-0.768780 --> -0.791902).  Saving model ...
Epoch: 13 cost time: 2.7557666301727295
Epoch: 13, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.542 Vali Acc: 0.827 Test Loss: 0.542 Test Acc: 0.827
Validation loss decreased (-0.791902 --> -0.826584).  Saving model ...
Epoch: 14 cost time: 2.4694936275482178
Epoch: 14, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.667 Vali Acc: 0.786 Test Loss: 0.667 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.161205530166626
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.734 Vali Acc: 0.838 Test Loss: 0.734 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838143).  Saving model ...
Epoch: 16 cost time: 2.486372470855713
Epoch: 16, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.569 Vali Acc: 0.827 Test Loss: 0.569 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.711695671081543
Epoch: 17, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.619 Vali Acc: 0.792 Test Loss: 0.619 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.8171329498291016
Epoch: 18, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.609 Vali Acc: 0.827 Test Loss: 0.609 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.62984299659729
Epoch: 19, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.661 Vali Acc: 0.792 Test Loss: 0.661 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.496384620666504
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.595 Vali Acc: 0.838 Test Loss: 0.595 Test Acc: 0.838
Validation loss decreased (-0.838143 --> -0.838144).  Saving model ...
Epoch: 21 cost time: 2.6957836151123047
Epoch: 21, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.809 Vali Acc: 0.803 Test Loss: 0.809 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.664517879486084
Epoch: 22, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.786 Vali Acc: 0.809 Test Loss: 0.786 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.6726503372192383
Epoch: 23, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.710 Vali Acc: 0.821 Test Loss: 0.710 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.5288798809051514
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.793 Vali Acc: 0.827 Test Loss: 0.793 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.7913830280303955
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.784 Vali Acc: 0.815 Test Loss: 0.784 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.589750289916992
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.846 Vali Acc: 0.809 Test Loss: 0.846 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.4261114597320557
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.747 Vali Acc: 0.821 Test Loss: 0.747 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.5517828464508057
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.722 Vali Acc: 0.821 Test Loss: 0.722 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.766897439956665
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.730 Vali Acc: 0.815 Test Loss: 0.730 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.634965181350708
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.756 Vali Acc: 0.815 Test Loss: 0.756 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 268639
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           2                   
  d layers:           2                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.4148499965667725
Epoch: 1, Steps: 17 | Train Loss: 1.927 Vali Loss: 1.825 Vali Acc: 0.231 Test Loss: 1.825 Test Acc: 0.231
Validation loss decreased (inf --> -0.231196).  Saving model ...
Epoch: 2 cost time: 2.6519134044647217
Epoch: 2, Steps: 17 | Train Loss: 1.637 Vali Loss: 1.478 Vali Acc: 0.312 Test Loss: 1.478 Test Acc: 0.312
Validation loss decreased (-0.231196 --> -0.312124).  Saving model ...
Epoch: 3 cost time: 2.494051933288574
Epoch: 3, Steps: 17 | Train Loss: 1.383 Vali Loss: 1.290 Vali Acc: 0.439 Test Loss: 1.290 Test Acc: 0.439
Validation loss decreased (-0.312124 --> -0.439293).  Saving model ...
Epoch: 4 cost time: 2.7888967990875244
Epoch: 4, Steps: 17 | Train Loss: 1.222 Vali Loss: 1.204 Vali Acc: 0.341 Test Loss: 1.204 Test Acc: 0.341
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.352583408355713
Epoch: 5, Steps: 17 | Train Loss: 1.051 Vali Loss: 1.040 Vali Acc: 0.578 Test Loss: 1.040 Test Acc: 0.578
Validation loss decreased (-0.439293 --> -0.578024).  Saving model ...
Epoch: 6 cost time: 2.651718854904175
Epoch: 6, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.953 Vali Acc: 0.578 Test Loss: 0.953 Test Acc: 0.578
Validation loss decreased (-0.578024 --> -0.578025).  Saving model ...
Epoch: 7 cost time: 2.9882776737213135
Epoch: 7, Steps: 17 | Train Loss: 0.808 Vali Loss: 0.907 Vali Acc: 0.699 Test Loss: 0.907 Test Acc: 0.699
Validation loss decreased (-0.578025 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 2.6130940914154053
Epoch: 8, Steps: 17 | Train Loss: 0.655 Vali Loss: 0.898 Vali Acc: 0.590 Test Loss: 0.898 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.7007036209106445
Epoch: 9, Steps: 17 | Train Loss: 0.658 Vali Loss: 0.883 Vali Acc: 0.607 Test Loss: 0.883 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.6342029571533203
Epoch: 10, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.915 Vali Acc: 0.734 Test Loss: 0.915 Test Acc: 0.734
Validation loss decreased (-0.699413 --> -0.734095).  Saving model ...
Epoch: 11 cost time: 2.514467716217041
Epoch: 11, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.695 Vali Acc: 0.728 Test Loss: 0.695 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.66219425201416
Epoch: 12, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.687 Vali Acc: 0.792 Test Loss: 0.687 Test Acc: 0.792
Validation loss decreased (-0.734095 --> -0.791901).  Saving model ...
Epoch: 13 cost time: 2.566300630569458
Epoch: 13, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.661 Vali Acc: 0.757 Test Loss: 0.661 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.64212965965271
Epoch: 14, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.568 Vali Acc: 0.815 Test Loss: 0.568 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 2.704267740249634
Epoch: 15, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.865 Vali Acc: 0.751 Test Loss: 0.865 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.555763006210327
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.564 Vali Acc: 0.827 Test Loss: 0.564 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 17 cost time: 2.593580722808838
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.702 Vali Acc: 0.780 Test Loss: 0.702 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.5136284828186035
Epoch: 18, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.685 Vali Acc: 0.792 Test Loss: 0.685 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3608362674713135
Epoch: 19, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.728 Vali Acc: 0.740 Test Loss: 0.728 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.752464771270752
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.847 Vali Acc: 0.775 Test Loss: 0.847 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.4771039485931396
Epoch: 21, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.885 Vali Acc: 0.798 Test Loss: 0.885 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.5553791522979736
Epoch: 22, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.646 Vali Acc: 0.798 Test Loss: 0.646 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.635589838027954
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.758 Vali Acc: 0.792 Test Loss: 0.758 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.5905935764312744
Epoch: 24, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.004 Vali Acc: 0.780 Test Loss: 1.004 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.4865915775299072
Epoch: 25, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.051 Vali Acc: 0.821 Test Loss: 1.051 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.5191831588745117
Epoch: 26, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.020 Vali Acc: 0.780 Test Loss: 1.020 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el2_dl2_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 268639
model size : 1.65MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.821340560913086
Epoch: 1, Steps: 17 | Train Loss: 1.784 Vali Loss: 1.259 Vali Acc: 0.364 Test Loss: 1.259 Test Acc: 0.364
Validation loss decreased (inf --> -0.364149).  Saving model ...
Epoch: 2 cost time: 2.956044912338257
Epoch: 2, Steps: 17 | Train Loss: 0.857 Vali Loss: 0.739 Vali Acc: 0.734 Test Loss: 0.739 Test Acc: 0.734
Validation loss decreased (-0.364149 --> -0.734097).  Saving model ...
Epoch: 3 cost time: 3.0234363079071045
Epoch: 3, Steps: 17 | Train Loss: 0.382 Vali Loss: 0.759 Vali Acc: 0.751 Test Loss: 0.759 Test Acc: 0.751
Validation loss decreased (-0.734097 --> -0.751438).  Saving model ...
Epoch: 4 cost time: 2.4072954654693604
Epoch: 4, Steps: 17 | Train Loss: 0.462 Vali Loss: 1.744 Vali Acc: 0.601 Test Loss: 1.744 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.501441478729248
Epoch: 5, Steps: 17 | Train Loss: 0.499 Vali Loss: 0.788 Vali Acc: 0.740 Test Loss: 0.788 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 3.05792236328125
Epoch: 6, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.937 Vali Acc: 0.757 Test Loss: 0.937 Test Acc: 0.757
Validation loss decreased (-0.751438 --> -0.757216).  Saving model ...
Epoch: 7 cost time: 2.70644211769104
Epoch: 7, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.115 Vali Acc: 0.728 Test Loss: 1.115 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.728898763656616
Epoch: 8, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.950 Vali Acc: 0.780 Test Loss: 0.950 Test Acc: 0.780
Validation loss decreased (-0.757216 --> -0.780337).  Saving model ...
Epoch: 9 cost time: 2.945005178451538
Epoch: 9, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.855 Vali Acc: 0.821 Test Loss: 0.855 Test Acc: 0.821
Validation loss decreased (-0.780337 --> -0.820801).  Saving model ...
Epoch: 10 cost time: 2.8133273124694824
Epoch: 10, Steps: 17 | Train Loss: 0.221 Vali Loss: 1.198 Vali Acc: 0.780 Test Loss: 1.198 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.766050338745117
Epoch: 11, Steps: 17 | Train Loss: 0.089 Vali Loss: 2.182 Vali Acc: 0.728 Test Loss: 2.182 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 3.0773770809173584
Epoch: 12, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.980 Vali Acc: 0.798 Test Loss: 1.980 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.485929250717163
Epoch: 13, Steps: 17 | Train Loss: 0.257 Vali Loss: 1.293 Vali Acc: 0.786 Test Loss: 1.293 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.6592462062835693
Epoch: 14, Steps: 17 | Train Loss: 0.504 Vali Loss: 1.346 Vali Acc: 0.821 Test Loss: 1.346 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.527334451675415
Epoch: 15, Steps: 17 | Train Loss: 0.461 Vali Loss: 3.057 Vali Acc: 0.665 Test Loss: 3.057 Test Acc: 0.665
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.379075765609741
Epoch: 16, Steps: 17 | Train Loss: 0.526 Vali Loss: 3.421 Vali Acc: 0.775 Test Loss: 3.421 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3849940299987793
Epoch: 17, Steps: 17 | Train Loss: 0.156 Vali Loss: 2.425 Vali Acc: 0.827 Test Loss: 2.425 Test Acc: 0.827
Validation loss decreased (-0.820801 --> -0.826565).  Saving model ...
Epoch: 18 cost time: 3.0139284133911133
Epoch: 18, Steps: 17 | Train Loss: 0.231 Vali Loss: 1.888 Vali Acc: 0.792 Test Loss: 1.888 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.8302929401397705
Epoch: 19, Steps: 17 | Train Loss: 0.174 Vali Loss: 3.340 Vali Acc: 0.676 Test Loss: 3.340 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.5164918899536133
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 2.509 Vali Acc: 0.798 Test Loss: 2.509 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.476632595062256
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 2.260 Vali Acc: 0.809 Test Loss: 2.260 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 3.0213894844055176
Epoch: 22, Steps: 17 | Train Loss: 0.159 Vali Loss: 3.737 Vali Acc: 0.786 Test Loss: 3.737 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.8387274742126465
Epoch: 23, Steps: 17 | Train Loss: 0.423 Vali Loss: 4.405 Vali Acc: 0.763 Test Loss: 4.405 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.850281000137329
Epoch: 24, Steps: 17 | Train Loss: 0.166 Vali Loss: 4.209 Vali Acc: 0.751 Test Loss: 4.209 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.939432144165039
Epoch: 25, Steps: 17 | Train Loss: 0.338 Vali Loss: 6.052 Vali Acc: 0.659 Test Loss: 6.052 Test Acc: 0.659
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.7670693397521973
Epoch: 26, Steps: 17 | Train Loss: 0.458 Vali Loss: 3.341 Vali Acc: 0.821 Test Loss: 3.341 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.8582053184509277
Epoch: 27, Steps: 17 | Train Loss: 0.461 Vali Loss: 6.898 Vali Acc: 0.705 Test Loss: 6.898 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 5612835
model size : 31.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.396114826202393
Epoch: 1, Steps: 17 | Train Loss: 1.767 Vali Loss: 1.265 Vali Acc: 0.382 Test Loss: 1.265 Test Acc: 0.382
Validation loss decreased (inf --> -0.381490).  Saving model ...
Epoch: 2 cost time: 2.1475257873535156
Epoch: 2, Steps: 17 | Train Loss: 0.884 Vali Loss: 0.762 Vali Acc: 0.705 Test Loss: 0.762 Test Acc: 0.705
Validation loss decreased (-0.381490 --> -0.705195).  Saving model ...
Epoch: 3 cost time: 2.3051857948303223
Epoch: 3, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.696 Vali Acc: 0.757 Test Loss: 0.696 Test Acc: 0.757
Validation loss decreased (-0.705195 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 3.0078885555267334
Epoch: 4, Steps: 17 | Train Loss: 0.412 Vali Loss: 1.261 Vali Acc: 0.647 Test Loss: 1.261 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.835219383239746
Epoch: 5, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.731 Vali Acc: 0.775 Test Loss: 0.731 Test Acc: 0.775
Validation loss decreased (-0.757218 --> -0.774559).  Saving model ...
Epoch: 6 cost time: 2.7105910778045654
Epoch: 6, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.971 Vali Acc: 0.705 Test Loss: 0.971 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 3.1329503059387207
Epoch: 7, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.273 Vali Acc: 0.642 Test Loss: 1.273 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.754965305328369
Epoch: 8, Steps: 17 | Train Loss: 0.269 Vali Loss: 1.114 Vali Acc: 0.780 Test Loss: 1.114 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780336).  Saving model ...
Epoch: 9 cost time: 2.4093732833862305
Epoch: 9, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.470 Vali Acc: 0.705 Test Loss: 1.470 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 3.078359842300415
Epoch: 10, Steps: 17 | Train Loss: 0.157 Vali Loss: 1.273 Vali Acc: 0.809 Test Loss: 1.273 Test Acc: 0.809
Validation loss decreased (-0.780336 --> -0.809236).  Saving model ...
Epoch: 11 cost time: 2.1999735832214355
Epoch: 11, Steps: 17 | Train Loss: 0.394 Vali Loss: 2.065 Vali Acc: 0.746 Test Loss: 2.065 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7152621746063232
Epoch: 12, Steps: 17 | Train Loss: 0.297 Vali Loss: 2.135 Vali Acc: 0.775 Test Loss: 2.135 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5139358043670654
Epoch: 13, Steps: 17 | Train Loss: 0.480 Vali Loss: 2.908 Vali Acc: 0.676 Test Loss: 2.908 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6065571308135986
Epoch: 14, Steps: 17 | Train Loss: 0.397 Vali Loss: 2.548 Vali Acc: 0.717 Test Loss: 2.548 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7958157062530518
Epoch: 15, Steps: 17 | Train Loss: 0.384 Vali Loss: 3.322 Vali Acc: 0.671 Test Loss: 3.322 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 3.1915292739868164
Epoch: 16, Steps: 17 | Train Loss: 0.094 Vali Loss: 2.832 Vali Acc: 0.717 Test Loss: 2.832 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.7760837078094482
Epoch: 17, Steps: 17 | Train Loss: 0.256 Vali Loss: 3.893 Vali Acc: 0.740 Test Loss: 3.893 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 3.0348050594329834
Epoch: 18, Steps: 17 | Train Loss: 0.648 Vali Loss: 2.660 Vali Acc: 0.775 Test Loss: 2.660 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.073589324951172
Epoch: 19, Steps: 17 | Train Loss: 0.241 Vali Loss: 2.132 Vali Acc: 0.809 Test Loss: 2.132 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.6798715591430664
Epoch: 20, Steps: 17 | Train Loss: 0.096 Vali Loss: 5.467 Vali Acc: 0.717 Test Loss: 5.467 Test Acc: 0.717
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 5612835
model size : 31.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.863802433013916
Epoch: 1, Steps: 17 | Train Loss: 1.766 Vali Loss: 1.283 Vali Acc: 0.335 Test Loss: 1.283 Test Acc: 0.335
Validation loss decreased (inf --> -0.335247).  Saving model ...
Epoch: 2 cost time: 2.3904201984405518
Epoch: 2, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.944 Vali Acc: 0.566 Test Loss: 0.944 Test Acc: 0.566
Validation loss decreased (-0.335247 --> -0.566465).  Saving model ...
Epoch: 3 cost time: 2.48088002204895
Epoch: 3, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.751 Vali Acc: 0.694 Test Loss: 0.751 Test Acc: 0.694
Validation loss decreased (-0.566465 --> -0.693634).  Saving model ...
Epoch: 4 cost time: 2.589214563369751
Epoch: 4, Steps: 17 | Train Loss: 0.540 Vali Loss: 1.627 Vali Acc: 0.549 Test Loss: 1.627 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.3836801052093506
Epoch: 5, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.683 Vali Acc: 0.763 Test Loss: 0.683 Test Acc: 0.763
Validation loss decreased (-0.693634 --> -0.762999).  Saving model ...
Epoch: 6 cost time: 2.36901593208313
Epoch: 6, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.110 Vali Acc: 0.688 Test Loss: 1.110 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7367429733276367
Epoch: 7, Steps: 17 | Train Loss: 0.395 Vali Loss: 1.189 Vali Acc: 0.757 Test Loss: 1.189 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.552950859069824
Epoch: 8, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.953 Vali Acc: 0.688 Test Loss: 1.953 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.039120674133301
Epoch: 9, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.999 Vali Acc: 0.763 Test Loss: 0.999 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1503984928131104
Epoch: 10, Steps: 17 | Train Loss: 0.285 Vali Loss: 1.855 Vali Acc: 0.734 Test Loss: 1.855 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.7303431034088135
Epoch: 11, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.934 Vali Acc: 0.711 Test Loss: 1.934 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.55118989944458
Epoch: 12, Steps: 17 | Train Loss: 0.316 Vali Loss: 1.748 Vali Acc: 0.723 Test Loss: 1.748 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.367556095123291
Epoch: 13, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.324 Vali Acc: 0.746 Test Loss: 2.324 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.762859582901001
Epoch: 14, Steps: 17 | Train Loss: 0.559 Vali Loss: 5.437 Vali Acc: 0.665 Test Loss: 5.437 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.81596040725708
Epoch: 15, Steps: 17 | Train Loss: 0.624 Vali Loss: 3.695 Vali Acc: 0.740 Test Loss: 3.695 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7630057803468208
model parameter : 5612835
model size : 31.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.088083028793335
Epoch: 1, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.316 Vali Acc: 0.347 Test Loss: 1.316 Test Acc: 0.347
Validation loss decreased (inf --> -0.346808).  Saving model ...
Epoch: 2 cost time: 2.807476282119751
Epoch: 2, Steps: 17 | Train Loss: 1.030 Vali Loss: 1.173 Vali Acc: 0.538 Test Loss: 1.173 Test Acc: 0.538
Validation loss decreased (-0.346808 --> -0.537561).  Saving model ...
Epoch: 3 cost time: 2.750352621078491
Epoch: 3, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.809 Vali Acc: 0.705 Test Loss: 0.809 Test Acc: 0.705
Validation loss decreased (-0.537561 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 2.8379316329956055
Epoch: 4, Steps: 17 | Train Loss: 0.590 Vali Loss: 1.072 Vali Acc: 0.613 Test Loss: 1.072 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.799114465713501
Epoch: 5, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.942 Vali Acc: 0.682 Test Loss: 0.942 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7721750736236572
Epoch: 6, Steps: 17 | Train Loss: 0.406 Vali Loss: 1.024 Vali Acc: 0.705 Test Loss: 1.024 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.552137613296509
Epoch: 7, Steps: 17 | Train Loss: 0.291 Vali Loss: 1.378 Vali Acc: 0.624 Test Loss: 1.378 Test Acc: 0.624
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.8547849655151367
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.147 Vali Acc: 0.763 Test Loss: 1.147 Test Acc: 0.763
Validation loss decreased (-0.705194 --> -0.762994).  Saving model ...
Epoch: 9 cost time: 2.74190616607666
Epoch: 9, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.976 Vali Acc: 0.711 Test Loss: 0.976 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.6549630165100098
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 1.382 Vali Acc: 0.734 Test Loss: 1.382 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.6633737087249756
Epoch: 11, Steps: 17 | Train Loss: 0.463 Vali Loss: 1.245 Vali Acc: 0.769 Test Loss: 1.245 Test Acc: 0.769
Validation loss decreased (-0.762994 --> -0.768774).  Saving model ...
Epoch: 12 cost time: 2.2068941593170166
Epoch: 12, Steps: 17 | Train Loss: 0.536 Vali Loss: 3.510 Vali Acc: 0.665 Test Loss: 3.510 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.4979732036590576
Epoch: 13, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.918 Vali Acc: 0.746 Test Loss: 1.918 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.0845353603363037
Epoch: 14, Steps: 17 | Train Loss: 0.406 Vali Loss: 2.681 Vali Acc: 0.653 Test Loss: 2.681 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.5818607807159424
Epoch: 15, Steps: 17 | Train Loss: 0.845 Vali Loss: 3.203 Vali Acc: 0.613 Test Loss: 3.203 Test Acc: 0.613
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.7915048599243164
Epoch: 16, Steps: 17 | Train Loss: 0.461 Vali Loss: 3.099 Vali Acc: 0.694 Test Loss: 3.099 Test Acc: 0.694
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.8149642944335938
Epoch: 17, Steps: 17 | Train Loss: 0.714 Vali Loss: 1.907 Vali Acc: 0.763 Test Loss: 1.907 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.076204538345337
Epoch: 18, Steps: 17 | Train Loss: 0.293 Vali Loss: 1.664 Vali Acc: 0.803 Test Loss: 1.664 Test Acc: 0.803
Validation loss decreased (-0.768774 --> -0.803452).  Saving model ...
Epoch: 19 cost time: 2.8279807567596436
Epoch: 19, Steps: 17 | Train Loss: 0.483 Vali Loss: 4.337 Vali Acc: 0.642 Test Loss: 4.337 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.7231109142303467
Epoch: 20, Steps: 17 | Train Loss: 0.461 Vali Loss: 2.824 Vali Acc: 0.751 Test Loss: 2.824 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.7862820625305176
Epoch: 21, Steps: 17 | Train Loss: 0.161 Vali Loss: 3.431 Vali Acc: 0.647 Test Loss: 3.431 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.9650518894195557
Epoch: 22, Steps: 17 | Train Loss: 0.402 Vali Loss: 4.427 Vali Acc: 0.705 Test Loss: 4.427 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.874612331390381
Epoch: 23, Steps: 17 | Train Loss: 0.314 Vali Loss: 6.096 Vali Acc: 0.636 Test Loss: 6.096 Test Acc: 0.636
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 3.124124526977539
Epoch: 24, Steps: 17 | Train Loss: 1.097 Vali Loss: 5.390 Vali Acc: 0.613 Test Loss: 5.390 Test Acc: 0.613
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.819260835647583
Epoch: 25, Steps: 17 | Train Loss: 0.898 Vali Loss: 7.156 Vali Acc: 0.682 Test Loss: 7.156 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 3.14697003364563
Epoch: 26, Steps: 17 | Train Loss: 0.561 Vali Loss: 5.348 Vali Acc: 0.711 Test Loss: 5.348 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.413530111312866
Epoch: 27, Steps: 17 | Train Loss: 0.536 Vali Loss: 9.379 Vali Acc: 0.503 Test Loss: 9.379 Test Acc: 0.503
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 3.168597936630249
Epoch: 28, Steps: 17 | Train Loss: 1.157 Vali Loss: 6.936 Vali Acc: 0.682 Test Loss: 6.936 Test Acc: 0.682
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 5612835
model size : 31.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.481398582458496
Epoch: 1, Steps: 17 | Train Loss: 1.675 Vali Loss: 1.170 Vali Acc: 0.462 Test Loss: 1.170 Test Acc: 0.462
Validation loss decreased (inf --> -0.462416).  Saving model ...
Epoch: 2 cost time: 2.6835520267486572
Epoch: 2, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.827 Vali Acc: 0.705 Test Loss: 0.827 Test Acc: 0.705
Validation loss decreased (-0.462416 --> -0.705194).  Saving model ...
Epoch: 3 cost time: 2.5315611362457275
Epoch: 3, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.733 Vali Acc: 0.757 Test Loss: 0.733 Test Acc: 0.757
Validation loss decreased (-0.705194 --> -0.757218).  Saving model ...
Epoch: 4 cost time: 2.7725510597229004
Epoch: 4, Steps: 17 | Train Loss: 0.421 Vali Loss: 0.893 Vali Acc: 0.740 Test Loss: 0.893 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.352857828140259
Epoch: 5, Steps: 17 | Train Loss: 0.229 Vali Loss: 0.981 Vali Acc: 0.671 Test Loss: 0.981 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.819500684738159
Epoch: 6, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.749 Vali Acc: 0.763 Test Loss: 0.749 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762998).  Saving model ...
Epoch: 7 cost time: 2.8620359897613525
Epoch: 7, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.720 Vali Acc: 0.780 Test Loss: 0.720 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780340).  Saving model ...
Epoch: 8 cost time: 2.275360584259033
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.237 Vali Acc: 0.757 Test Loss: 1.237 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.843006134033203
Epoch: 9, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.616 Vali Acc: 0.705 Test Loss: 1.616 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.4491753578186035
Epoch: 10, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.623 Vali Acc: 0.769 Test Loss: 1.623 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.917026996612549
Epoch: 11, Steps: 17 | Train Loss: 0.652 Vali Loss: 2.197 Vali Acc: 0.647 Test Loss: 2.197 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.8802788257598877
Epoch: 12, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.309 Vali Acc: 0.734 Test Loss: 2.309 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.871020555496216
Epoch: 13, Steps: 17 | Train Loss: 0.283 Vali Loss: 4.276 Vali Acc: 0.647 Test Loss: 4.276 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.8489699363708496
Epoch: 14, Steps: 17 | Train Loss: 0.255 Vali Loss: 2.294 Vali Acc: 0.798 Test Loss: 2.294 Test Acc: 0.798
Validation loss decreased (-0.780340 --> -0.797665).  Saving model ...
Epoch: 15 cost time: 2.9701225757598877
Epoch: 15, Steps: 17 | Train Loss: 0.303 Vali Loss: 2.620 Vali Acc: 0.757 Test Loss: 2.620 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.7221264839172363
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 2.393 Vali Acc: 0.809 Test Loss: 2.393 Test Acc: 0.809
Validation loss decreased (-0.797665 --> -0.809225).  Saving model ...
Epoch: 17 cost time: 2.544443130493164
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 2.845 Vali Acc: 0.775 Test Loss: 2.845 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.7397563457489014
Epoch: 18, Steps: 17 | Train Loss: 0.271 Vali Loss: 2.263 Vali Acc: 0.798 Test Loss: 2.263 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.5707712173461914
Epoch: 19, Steps: 17 | Train Loss: 0.065 Vali Loss: 4.272 Vali Acc: 0.740 Test Loss: 4.272 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.8344671726226807
Epoch: 20, Steps: 17 | Train Loss: 0.137 Vali Loss: 3.409 Vali Acc: 0.786 Test Loss: 3.409 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.733727216720581
Epoch: 21, Steps: 17 | Train Loss: 0.433 Vali Loss: 2.660 Vali Acc: 0.815 Test Loss: 2.660 Test Acc: 0.815
Validation loss decreased (-0.809225 --> -0.815002).  Saving model ...
Epoch: 22 cost time: 2.8304107189178467
Epoch: 22, Steps: 17 | Train Loss: 0.264 Vali Loss: 4.488 Vali Acc: 0.792 Test Loss: 4.488 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 3.0934371948242188
Epoch: 23, Steps: 17 | Train Loss: 0.369 Vali Loss: 4.571 Vali Acc: 0.757 Test Loss: 4.571 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.5820767879486084
Epoch: 24, Steps: 17 | Train Loss: 0.598 Vali Loss: 5.921 Vali Acc: 0.769 Test Loss: 5.921 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 2.4678895473480225
Epoch: 25, Steps: 17 | Train Loss: 0.751 Vali Loss: 2.773 Vali Acc: 0.815 Test Loss: 2.773 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 2.7319977283477783
Epoch: 26, Steps: 17 | Train Loss: 0.181 Vali Loss: 7.411 Vali Acc: 0.671 Test Loss: 7.411 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 2.6463286876678467
Epoch: 27, Steps: 17 | Train Loss: 0.224 Vali Loss: 3.296 Vali Acc: 0.809 Test Loss: 3.296 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 2.9143810272216797
Epoch: 28, Steps: 17 | Train Loss: 0.088 Vali Loss: 3.958 Vali Acc: 0.815 Test Loss: 3.958 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 2.845942735671997
Epoch: 29, Steps: 17 | Train Loss: 0.093 Vali Loss: 5.011 Vali Acc: 0.786 Test Loss: 5.011 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 3.020151376724243
Epoch: 30, Steps: 17 | Train Loss: 0.195 Vali Loss: 3.432 Vali Acc: 0.832 Test Loss: 3.432 Test Acc: 0.832
Validation loss decreased (-0.815002 --> -0.832336).  Saving model ...
Epoch: 31 cost time: 2.8494930267333984
Epoch: 31, Steps: 17 | Train Loss: 0.293 Vali Loss: 4.596 Vali Acc: 0.832 Test Loss: 4.596 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 2.513812780380249
Epoch: 32, Steps: 17 | Train Loss: 0.105 Vali Loss: 8.272 Vali Acc: 0.723 Test Loss: 8.272 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 2.5710461139678955
Epoch: 33, Steps: 17 | Train Loss: 0.447 Vali Loss: 8.792 Vali Acc: 0.717 Test Loss: 8.792 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 2.8590309619903564
Epoch: 34, Steps: 17 | Train Loss: 1.230 Vali Loss: 12.607 Vali Acc: 0.711 Test Loss: 12.607 Test Acc: 0.711
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 2.4322447776794434
Epoch: 35, Steps: 17 | Train Loss: 0.476 Vali Loss: 8.165 Vali Acc: 0.763 Test Loss: 8.165 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 2.628493309020996
Epoch: 36, Steps: 17 | Train Loss: 0.624 Vali Loss: 5.721 Vali Acc: 0.798 Test Loss: 5.721 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 2.577960729598999
Epoch: 37, Steps: 17 | Train Loss: 1.048 Vali Loss: 14.322 Vali Acc: 0.613 Test Loss: 14.322 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 2.8328158855438232
Epoch: 38, Steps: 17 | Train Loss: 0.883 Vali Loss: 6.324 Vali Acc: 0.803 Test Loss: 6.324 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 2.8624112606048584
Epoch: 39, Steps: 17 | Train Loss: 0.065 Vali Loss: 8.806 Vali Acc: 0.728 Test Loss: 8.806 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 2.9102439880371094
Epoch: 40, Steps: 17 | Train Loss: 0.608 Vali Loss: 6.075 Vali Acc: 0.803 Test Loss: 6.075 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4564259
model size : 27.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.442927837371826
Epoch: 1, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.184 Vali Acc: 0.491 Test Loss: 1.184 Test Acc: 0.491
Validation loss decreased (inf --> -0.491318).  Saving model ...
Epoch: 2 cost time: 2.6844375133514404
Epoch: 2, Steps: 17 | Train Loss: 0.804 Vali Loss: 0.877 Vali Acc: 0.624 Test Loss: 0.877 Test Acc: 0.624
Validation loss decreased (-0.491318 --> -0.624269).  Saving model ...
Epoch: 3 cost time: 2.600879192352295
Epoch: 3, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.776 Vali Acc: 0.728 Test Loss: 0.776 Test Acc: 0.728
Validation loss decreased (-0.624269 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.1349754333496094
Epoch: 4, Steps: 17 | Train Loss: 0.370 Vali Loss: 1.061 Vali Acc: 0.705 Test Loss: 1.061 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.705821990966797
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.905 Vali Acc: 0.688 Test Loss: 0.905 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.9471824169158936
Epoch: 6, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.853 Vali Acc: 0.699 Test Loss: 0.853 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.80877947807312
Epoch: 7, Steps: 17 | Train Loss: 0.531 Vali Loss: 1.898 Vali Acc: 0.688 Test Loss: 1.898 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 3.124033212661743
Epoch: 8, Steps: 17 | Train Loss: 0.215 Vali Loss: 1.013 Vali Acc: 0.746 Test Loss: 1.013 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745655).  Saving model ...
Epoch: 9 cost time: 3.1212713718414307
Epoch: 9, Steps: 17 | Train Loss: 0.178 Vali Loss: 2.097 Vali Acc: 0.694 Test Loss: 2.097 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8333656787872314
Epoch: 10, Steps: 17 | Train Loss: 0.439 Vali Loss: 2.357 Vali Acc: 0.682 Test Loss: 2.357 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 3.019979238510132
Epoch: 11, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.116 Vali Acc: 0.832 Test Loss: 1.116 Test Acc: 0.832
Validation loss decreased (-0.745655 --> -0.832359).  Saving model ...
Epoch: 12 cost time: 2.796705484390259
Epoch: 12, Steps: 17 | Train Loss: 0.523 Vali Loss: 3.552 Vali Acc: 0.636 Test Loss: 3.552 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0300333499908447
Epoch: 13, Steps: 17 | Train Loss: 0.169 Vali Loss: 1.616 Vali Acc: 0.792 Test Loss: 1.616 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.6340041160583496
Epoch: 14, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.788 Vali Acc: 0.728 Test Loss: 1.788 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.8257203102111816
Epoch: 15, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.537 Vali Acc: 0.798 Test Loss: 1.537 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 3.0691182613372803
Epoch: 16, Steps: 17 | Train Loss: 0.326 Vali Loss: 2.147 Vali Acc: 0.751 Test Loss: 2.147 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.732241153717041
Epoch: 17, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.701 Vali Acc: 0.798 Test Loss: 1.701 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 2.792025566101074
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 3.202 Vali Acc: 0.746 Test Loss: 3.202 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.5321695804595947
Epoch: 19, Steps: 17 | Train Loss: 0.217 Vali Loss: 3.703 Vali Acc: 0.671 Test Loss: 3.703 Test Acc: 0.671
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.902907371520996
Epoch: 20, Steps: 17 | Train Loss: 0.403 Vali Loss: 3.947 Vali Acc: 0.694 Test Loss: 3.947 Test Acc: 0.694
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.577254295349121
Epoch: 21, Steps: 17 | Train Loss: 0.468 Vali Loss: 3.589 Vali Acc: 0.728 Test Loss: 3.589 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 4564259
model size : 27.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.274753093719482
Epoch: 1, Steps: 17 | Train Loss: 1.680 Vali Loss: 1.176 Vali Acc: 0.491 Test Loss: 1.176 Test Acc: 0.491
Validation loss decreased (inf --> -0.491318).  Saving model ...
Epoch: 2 cost time: 2.4912281036376953
Epoch: 2, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.800 Vali Acc: 0.717 Test Loss: 0.800 Test Acc: 0.717
Validation loss decreased (-0.491318 --> -0.716755).  Saving model ...
Epoch: 3 cost time: 2.5829079151153564
Epoch: 3, Steps: 17 | Train Loss: 0.451 Vali Loss: 0.791 Vali Acc: 0.734 Test Loss: 0.791 Test Acc: 0.734
Validation loss decreased (-0.716755 --> -0.734096).  Saving model ...
Epoch: 4 cost time: 2.451479196548462
Epoch: 4, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.171 Vali Acc: 0.688 Test Loss: 1.171 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7167983055114746
Epoch: 5, Steps: 17 | Train Loss: 0.353 Vali Loss: 1.186 Vali Acc: 0.624 Test Loss: 1.186 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.7901737689971924
Epoch: 6, Steps: 17 | Train Loss: 0.388 Vali Loss: 1.073 Vali Acc: 0.723 Test Loss: 1.073 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 2.708406925201416
Epoch: 7, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.163 Vali Acc: 0.746 Test Loss: 1.163 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745653).  Saving model ...
Epoch: 8 cost time: 2.410597562789917
Epoch: 8, Steps: 17 | Train Loss: 0.277 Vali Loss: 2.199 Vali Acc: 0.699 Test Loss: 2.199 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.8299899101257324
Epoch: 9, Steps: 17 | Train Loss: 0.720 Vali Loss: 1.575 Vali Acc: 0.751 Test Loss: 1.575 Test Acc: 0.751
Validation loss decreased (-0.745653 --> -0.751429).  Saving model ...
Epoch: 10 cost time: 2.4757046699523926
Epoch: 10, Steps: 17 | Train Loss: 0.645 Vali Loss: 1.265 Vali Acc: 0.786 Test Loss: 1.265 Test Acc: 0.786
Validation loss decreased (-0.751429 --> -0.786115).  Saving model ...
Epoch: 11 cost time: 2.694587469100952
Epoch: 11, Steps: 17 | Train Loss: 0.396 Vali Loss: 1.566 Vali Acc: 0.728 Test Loss: 1.566 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.475365400314331
Epoch: 12, Steps: 17 | Train Loss: 0.391 Vali Loss: 1.197 Vali Acc: 0.757 Test Loss: 1.197 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.5451533794403076
Epoch: 13, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.784 Vali Acc: 0.763 Test Loss: 1.784 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.601109266281128
Epoch: 14, Steps: 17 | Train Loss: 0.651 Vali Loss: 2.187 Vali Acc: 0.775 Test Loss: 2.187 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.7887682914733887
Epoch: 15, Steps: 17 | Train Loss: 0.090 Vali Loss: 2.474 Vali Acc: 0.705 Test Loss: 2.474 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.339106559753418
Epoch: 16, Steps: 17 | Train Loss: 0.190 Vali Loss: 2.638 Vali Acc: 0.682 Test Loss: 2.638 Test Acc: 0.682
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.4950387477874756
Epoch: 17, Steps: 17 | Train Loss: 0.197 Vali Loss: 1.904 Vali Acc: 0.798 Test Loss: 1.904 Test Acc: 0.798
Validation loss decreased (-0.786115 --> -0.797669).  Saving model ...
Epoch: 18 cost time: 2.766105890274048
Epoch: 18, Steps: 17 | Train Loss: 0.359 Vali Loss: 5.270 Vali Acc: 0.618 Test Loss: 5.270 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.433286666870117
Epoch: 19, Steps: 17 | Train Loss: 0.354 Vali Loss: 2.979 Vali Acc: 0.751 Test Loss: 2.979 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.514647960662842
Epoch: 20, Steps: 17 | Train Loss: 0.544 Vali Loss: 4.397 Vali Acc: 0.688 Test Loss: 4.397 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.5495715141296387
Epoch: 21, Steps: 17 | Train Loss: 0.647 Vali Loss: 4.623 Vali Acc: 0.792 Test Loss: 4.623 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.5338895320892334
Epoch: 22, Steps: 17 | Train Loss: 0.825 Vali Loss: 4.545 Vali Acc: 0.723 Test Loss: 4.545 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.997488260269165
Epoch: 23, Steps: 17 | Train Loss: 1.016 Vali Loss: 5.608 Vali Acc: 0.740 Test Loss: 5.608 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.9002573490142822
Epoch: 24, Steps: 17 | Train Loss: 0.794 Vali Loss: 4.007 Vali Acc: 0.775 Test Loss: 4.007 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.78983211517334
Epoch: 25, Steps: 17 | Train Loss: 0.237 Vali Loss: 4.063 Vali Acc: 0.792 Test Loss: 4.063 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.612670660018921
Epoch: 26, Steps: 17 | Train Loss: 0.348 Vali Loss: 3.425 Vali Acc: 0.821 Test Loss: 3.425 Test Acc: 0.821
Validation loss decreased (-0.797669 --> -0.820775).  Saving model ...
Epoch: 27 cost time: 2.6878821849823
Epoch: 27, Steps: 17 | Train Loss: 0.466 Vali Loss: 6.387 Vali Acc: 0.728 Test Loss: 6.387 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.6135873794555664
Epoch: 28, Steps: 17 | Train Loss: 0.665 Vali Loss: 7.934 Vali Acc: 0.728 Test Loss: 7.934 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.8612329959869385
Epoch: 29, Steps: 17 | Train Loss: 0.829 Vali Loss: 7.611 Vali Acc: 0.740 Test Loss: 7.611 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.696927785873413
Epoch: 30, Steps: 17 | Train Loss: 0.143 Vali Loss: 8.310 Vali Acc: 0.734 Test Loss: 8.310 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.617936849594116
Epoch: 31, Steps: 17 | Train Loss: 0.600 Vali Loss: 3.727 Vali Acc: 0.815 Test Loss: 3.727 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.8707785606384277
Epoch: 32, Steps: 17 | Train Loss: 0.209 Vali Loss: 7.291 Vali Acc: 0.757 Test Loss: 7.291 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.462080955505371
Epoch: 33, Steps: 17 | Train Loss: 0.540 Vali Loss: 5.605 Vali Acc: 0.769 Test Loss: 5.605 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.8291685581207275
Epoch: 34, Steps: 17 | Train Loss: 0.378 Vali Loss: 7.198 Vali Acc: 0.705 Test Loss: 7.198 Test Acc: 0.705
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.505566358566284
Epoch: 35, Steps: 17 | Train Loss: 0.546 Vali Loss: 8.986 Vali Acc: 0.728 Test Loss: 8.986 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.461716413497925
Epoch: 36, Steps: 17 | Train Loss: 0.606 Vali Loss: 8.718 Vali Acc: 0.763 Test Loss: 8.718 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 4564259
model size : 27.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.301536798477173
Epoch: 1, Steps: 17 | Train Loss: 1.729 Vali Loss: 1.221 Vali Acc: 0.520 Test Loss: 1.221 Test Acc: 0.520
Validation loss decreased (inf --> -0.520219).  Saving model ...
Epoch: 2 cost time: 2.525052547454834
Epoch: 2, Steps: 17 | Train Loss: 0.907 Vali Loss: 0.891 Vali Acc: 0.630 Test Loss: 0.891 Test Acc: 0.630
Validation loss decreased (-0.520219 --> -0.630049).  Saving model ...
Epoch: 3 cost time: 2.4101879596710205
Epoch: 3, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.885 Vali Acc: 0.694 Test Loss: 0.885 Test Acc: 0.694
Validation loss decreased (-0.630049 --> -0.693633).  Saving model ...
Epoch: 4 cost time: 2.4629039764404297
Epoch: 4, Steps: 17 | Train Loss: 0.538 Vali Loss: 1.435 Vali Acc: 0.624 Test Loss: 1.435 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.321664333343506
Epoch: 5, Steps: 17 | Train Loss: 0.421 Vali Loss: 1.080 Vali Acc: 0.624 Test Loss: 1.080 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.469006061553955
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 0.700 Vali Acc: 0.757 Test Loss: 0.700 Test Acc: 0.757
Validation loss decreased (-0.693633 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 2.6060945987701416
Epoch: 7, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.258 Vali Acc: 0.630 Test Loss: 1.258 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.7369322776794434
Epoch: 8, Steps: 17 | Train Loss: 0.331 Vali Loss: 1.113 Vali Acc: 0.705 Test Loss: 1.113 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.7059364318847656
Epoch: 9, Steps: 17 | Train Loss: 0.434 Vali Loss: 1.170 Vali Acc: 0.734 Test Loss: 1.170 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 3.036794662475586
Epoch: 10, Steps: 17 | Train Loss: 0.524 Vali Loss: 0.879 Vali Acc: 0.786 Test Loss: 0.879 Test Acc: 0.786
Validation loss decreased (-0.757218 --> -0.786118).  Saving model ...
Epoch: 11 cost time: 2.6661038398742676
Epoch: 11, Steps: 17 | Train Loss: 0.432 Vali Loss: 1.475 Vali Acc: 0.775 Test Loss: 1.475 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7545864582061768
Epoch: 12, Steps: 17 | Train Loss: 0.391 Vali Loss: 2.408 Vali Acc: 0.665 Test Loss: 2.408 Test Acc: 0.665
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.874201536178589
Epoch: 13, Steps: 17 | Train Loss: 0.998 Vali Loss: 4.218 Vali Acc: 0.578 Test Loss: 4.218 Test Acc: 0.578
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.802772045135498
Epoch: 14, Steps: 17 | Train Loss: 0.487 Vali Loss: 1.751 Vali Acc: 0.734 Test Loss: 1.751 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.8433403968811035
Epoch: 15, Steps: 17 | Train Loss: 0.306 Vali Loss: 2.028 Vali Acc: 0.746 Test Loss: 2.028 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.653869152069092
Epoch: 16, Steps: 17 | Train Loss: 0.255 Vali Loss: 2.113 Vali Acc: 0.711 Test Loss: 2.113 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.730354070663452
Epoch: 17, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.251 Vali Acc: 0.705 Test Loss: 2.251 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.6705822944641113
Epoch: 18, Steps: 17 | Train Loss: 0.356 Vali Loss: 3.192 Vali Acc: 0.717 Test Loss: 3.192 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.876338243484497
Epoch: 19, Steps: 17 | Train Loss: 0.527 Vali Loss: 3.710 Vali Acc: 0.723 Test Loss: 3.710 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.8046960830688477
Epoch: 20, Steps: 17 | Train Loss: 0.880 Vali Loss: 2.624 Vali Acc: 0.775 Test Loss: 2.624 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 4564259
model size : 27.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.9397361278533936
Epoch: 1, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.679 Vali Acc: 0.324 Test Loss: 1.679 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 2.9342339038848877
Epoch: 2, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.183 Vali Acc: 0.457 Test Loss: 1.183 Test Acc: 0.457
Validation loss decreased (-0.323683 --> -0.456636).  Saving model ...
Epoch: 3 cost time: 2.626157283782959
Epoch: 3, Steps: 17 | Train Loss: 0.637 Vali Loss: 0.833 Vali Acc: 0.659 Test Loss: 0.833 Test Acc: 0.659
Validation loss decreased (-0.456636 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 2.6566686630249023
Epoch: 4, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.792 Vali Acc: 0.734 Test Loss: 0.792 Test Acc: 0.734
Validation loss decreased (-0.658951 --> -0.734096).  Saving model ...
Epoch: 5 cost time: 2.826413154602051
Epoch: 5, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.057 Vali Acc: 0.705 Test Loss: 1.057 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5170645713806152
Epoch: 6, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.075 Vali Acc: 0.705 Test Loss: 1.075 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.7049787044525146
Epoch: 7, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.739 Vali Acc: 0.809 Test Loss: 0.739 Test Acc: 0.809
Validation loss decreased (-0.734096 --> -0.809241).  Saving model ...
Epoch: 8 cost time: 2.950650453567505
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.752 Vali Acc: 0.815 Test Loss: 0.752 Test Acc: 0.815
Validation loss decreased (-0.809241 --> -0.815021).  Saving model ...
Epoch: 9 cost time: 2.735795497894287
Epoch: 9, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.929 Vali Acc: 0.803 Test Loss: 0.929 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.8687565326690674
Epoch: 10, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.423 Vali Acc: 0.792 Test Loss: 1.423 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.797314405441284
Epoch: 11, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.402 Vali Acc: 0.786 Test Loss: 1.402 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.915935516357422
Epoch: 12, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.273 Vali Acc: 0.740 Test Loss: 2.273 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.8264622688293457
Epoch: 13, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.676 Vali Acc: 0.734 Test Loss: 1.676 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.8796353340148926
Epoch: 14, Steps: 17 | Train Loss: 0.289 Vali Loss: 2.234 Vali Acc: 0.740 Test Loss: 2.234 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.7924108505249023
Epoch: 15, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.708 Vali Acc: 0.775 Test Loss: 1.708 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 3.097100019454956
Epoch: 16, Steps: 17 | Train Loss: 0.379 Vali Loss: 1.607 Vali Acc: 0.798 Test Loss: 1.607 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.8989152908325195
Epoch: 17, Steps: 17 | Train Loss: 0.200 Vali Loss: 2.280 Vali Acc: 0.780 Test Loss: 2.280 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.8674497604370117
Epoch: 18, Steps: 17 | Train Loss: 0.084 Vali Loss: 4.723 Vali Acc: 0.676 Test Loss: 4.723 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 4039971
model size : 25.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.636616945266724
Epoch: 1, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.653 Vali Acc: 0.301 Test Loss: 1.653 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 2.9799821376800537
Epoch: 2, Steps: 17 | Train Loss: 0.928 Vali Loss: 1.230 Vali Acc: 0.457 Test Loss: 1.230 Test Acc: 0.457
Validation loss decreased (-0.300561 --> -0.456635).  Saving model ...
Epoch: 3 cost time: 2.7637789249420166
Epoch: 3, Steps: 17 | Train Loss: 0.676 Vali Loss: 0.866 Vali Acc: 0.671 Test Loss: 0.866 Test Acc: 0.671
Validation loss decreased (-0.456635 --> -0.670512).  Saving model ...
Epoch: 4 cost time: 3.128695487976074
Epoch: 4, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.807 Vali Acc: 0.751 Test Loss: 0.807 Test Acc: 0.751
Validation loss decreased (-0.670512 --> -0.751437).  Saving model ...
Epoch: 5 cost time: 2.702176332473755
Epoch: 5, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.602 Vali Acc: 0.815 Test Loss: 0.602 Test Acc: 0.815
Validation loss decreased (-0.751437 --> -0.815023).  Saving model ...
Epoch: 6 cost time: 2.8690977096557617
Epoch: 6, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.229 Vali Acc: 0.665 Test Loss: 1.229 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7168490886688232
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.839 Vali Acc: 0.780 Test Loss: 0.839 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 3.2140307426452637
Epoch: 8, Steps: 17 | Train Loss: 0.429 Vali Loss: 1.429 Vali Acc: 0.757 Test Loss: 1.429 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.896061420440674
Epoch: 9, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.422 Vali Acc: 0.699 Test Loss: 1.422 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.4400243759155273
Epoch: 10, Steps: 17 | Train Loss: 0.322 Vali Loss: 1.420 Vali Acc: 0.775 Test Loss: 1.420 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0093283653259277
Epoch: 11, Steps: 17 | Train Loss: 0.619 Vali Loss: 2.582 Vali Acc: 0.694 Test Loss: 2.582 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.329695701599121
Epoch: 12, Steps: 17 | Train Loss: 0.448 Vali Loss: 1.375 Vali Acc: 0.798 Test Loss: 1.375 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.5907082557678223
Epoch: 13, Steps: 17 | Train Loss: 0.544 Vali Loss: 3.040 Vali Acc: 0.688 Test Loss: 3.040 Test Acc: 0.688
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.7811474800109863
Epoch: 14, Steps: 17 | Train Loss: 0.270 Vali Loss: 2.343 Vali Acc: 0.769 Test Loss: 2.343 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 3.0053162574768066
Epoch: 15, Steps: 17 | Train Loss: 0.230 Vali Loss: 3.394 Vali Acc: 0.734 Test Loss: 3.394 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 4039971
model size : 25.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.693434715270996
Epoch: 1, Steps: 17 | Train Loss: 1.770 Vali Loss: 1.647 Vali Acc: 0.318 Test Loss: 1.647 Test Acc: 0.318
Validation loss decreased (inf --> -0.317903).  Saving model ...
Epoch: 2 cost time: 2.7737936973571777
Epoch: 2, Steps: 17 | Train Loss: 0.978 Vali Loss: 1.174 Vali Acc: 0.480 Test Loss: 1.174 Test Acc: 0.480
Validation loss decreased (-0.317903 --> -0.479757).  Saving model ...
Epoch: 3 cost time: 2.712876319885254
Epoch: 3, Steps: 17 | Train Loss: 0.671 Vali Loss: 1.091 Vali Acc: 0.607 Test Loss: 1.091 Test Acc: 0.607
Validation loss decreased (-0.479757 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 2.8885395526885986
Epoch: 4, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.797 Vali Acc: 0.757 Test Loss: 0.797 Test Acc: 0.757
Validation loss decreased (-0.606926 --> -0.757217).  Saving model ...
Epoch: 5 cost time: 2.283832311630249
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.603 Vali Acc: 0.798 Test Loss: 0.603 Test Acc: 0.798
Validation loss decreased (-0.757217 --> -0.797682).  Saving model ...
Epoch: 6 cost time: 2.5883126258850098
Epoch: 6, Steps: 17 | Train Loss: 0.288 Vali Loss: 1.037 Vali Acc: 0.763 Test Loss: 1.037 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.5721075534820557
Epoch: 7, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.590 Vali Acc: 0.642 Test Loss: 1.590 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.696784734725952
Epoch: 8, Steps: 17 | Train Loss: 0.300 Vali Loss: 1.094 Vali Acc: 0.751 Test Loss: 1.094 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.894047975540161
Epoch: 9, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.627 Vali Acc: 0.746 Test Loss: 1.627 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.474989414215088
Epoch: 10, Steps: 17 | Train Loss: 0.356 Vali Loss: 1.409 Vali Acc: 0.769 Test Loss: 1.409 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 2.586073160171509
Epoch: 11, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.653 Vali Acc: 0.780 Test Loss: 1.653 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.824296236038208
Epoch: 12, Steps: 17 | Train Loss: 0.210 Vali Loss: 2.417 Vali Acc: 0.717 Test Loss: 2.417 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.4872868061065674
Epoch: 13, Steps: 17 | Train Loss: 0.824 Vali Loss: 2.749 Vali Acc: 0.711 Test Loss: 2.749 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 14 cost time: 2.3635847568511963
Epoch: 14, Steps: 17 | Train Loss: 0.575 Vali Loss: 2.754 Vali Acc: 0.613 Test Loss: 2.754 Test Acc: 0.613
EarlyStopping counter: 9 out of 10
Epoch: 15 cost time: 2.5686194896698
Epoch: 15, Steps: 17 | Train Loss: 0.331 Vali Loss: 3.244 Vali Acc: 0.728 Test Loss: 3.244 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 4039971
model size : 25.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.222368478775024
Epoch: 1, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.721 Vali Acc: 0.306 Test Loss: 1.721 Test Acc: 0.306
Validation loss decreased (inf --> -0.306341).  Saving model ...
Epoch: 2 cost time: 2.211984157562256
Epoch: 2, Steps: 17 | Train Loss: 1.068 Vali Loss: 1.270 Vali Acc: 0.474 Test Loss: 1.270 Test Acc: 0.474
Validation loss decreased (-0.306341 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 2.5712671279907227
Epoch: 3, Steps: 17 | Train Loss: 0.803 Vali Loss: 1.186 Vali Acc: 0.549 Test Loss: 1.186 Test Acc: 0.549
Validation loss decreased (-0.473976 --> -0.549121).  Saving model ...
Epoch: 4 cost time: 2.4721992015838623
Epoch: 4, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.912 Vali Acc: 0.642 Test Loss: 0.912 Test Acc: 0.642
Validation loss decreased (-0.549121 --> -0.641609).  Saving model ...
Epoch: 5 cost time: 2.6253578662872314
Epoch: 5, Steps: 17 | Train Loss: 0.367 Vali Loss: 0.733 Vali Acc: 0.728 Test Loss: 0.733 Test Acc: 0.728
Validation loss decreased (-0.641609 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 2.31042218208313
Epoch: 6, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.943 Vali Acc: 0.694 Test Loss: 0.943 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.7431674003601074
Epoch: 7, Steps: 17 | Train Loss: 0.223 Vali Loss: 0.997 Vali Acc: 0.699 Test Loss: 0.997 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.6312687397003174
Epoch: 8, Steps: 17 | Train Loss: 0.337 Vali Loss: 0.739 Vali Acc: 0.775 Test Loss: 0.739 Test Acc: 0.775
Validation loss decreased (-0.728316 --> -0.774559).  Saving model ...
Epoch: 9 cost time: 2.6481285095214844
Epoch: 9, Steps: 17 | Train Loss: 0.242 Vali Loss: 1.161 Vali Acc: 0.780 Test Loss: 1.161 Test Acc: 0.780
Validation loss decreased (-0.774559 --> -0.780335).  Saving model ...
Epoch: 10 cost time: 2.3329014778137207
Epoch: 10, Steps: 17 | Train Loss: 0.346 Vali Loss: 1.135 Vali Acc: 0.728 Test Loss: 1.135 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.5560381412506104
Epoch: 11, Steps: 17 | Train Loss: 0.699 Vali Loss: 1.851 Vali Acc: 0.711 Test Loss: 1.851 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.4939818382263184
Epoch: 12, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.309 Vali Acc: 0.780 Test Loss: 1.309 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5982913970947266
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.555 Vali Acc: 0.780 Test Loss: 1.555 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.589911699295044
Epoch: 14, Steps: 17 | Train Loss: 0.503 Vali Loss: 3.865 Vali Acc: 0.566 Test Loss: 3.865 Test Acc: 0.566
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.423610210418701
Epoch: 15, Steps: 17 | Train Loss: 0.403 Vali Loss: 2.641 Vali Acc: 0.705 Test Loss: 2.641 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.126558780670166
Epoch: 16, Steps: 17 | Train Loss: 0.417 Vali Loss: 2.722 Vali Acc: 0.734 Test Loss: 2.722 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.786142349243164
Epoch: 17, Steps: 17 | Train Loss: 0.242 Vali Loss: 1.575 Vali Acc: 0.815 Test Loss: 1.575 Test Acc: 0.815
Validation loss decreased (-0.780335 --> -0.815013).  Saving model ...
Epoch: 18 cost time: 2.5950496196746826
Epoch: 18, Steps: 17 | Train Loss: 0.097 Vali Loss: 2.280 Vali Acc: 0.803 Test Loss: 2.280 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.3749821186065674
Epoch: 19, Steps: 17 | Train Loss: 0.469 Vali Loss: 2.702 Vali Acc: 0.780 Test Loss: 2.702 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.6876845359802246
Epoch: 20, Steps: 17 | Train Loss: 0.590 Vali Loss: 2.404 Vali Acc: 0.780 Test Loss: 2.404 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.4065685272216797
Epoch: 21, Steps: 17 | Train Loss: 0.328 Vali Loss: 2.714 Vali Acc: 0.740 Test Loss: 2.714 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2989025115966797
Epoch: 22, Steps: 17 | Train Loss: 0.261 Vali Loss: 6.025 Vali Acc: 0.734 Test Loss: 6.025 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.6852612495422363
Epoch: 23, Steps: 17 | Train Loss: 1.020 Vali Loss: 2.201 Vali Acc: 0.803 Test Loss: 2.201 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.252572536468506
Epoch: 24, Steps: 17 | Train Loss: 1.084 Vali Loss: 3.444 Vali Acc: 0.763 Test Loss: 3.444 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.545048952102661
Epoch: 25, Steps: 17 | Train Loss: 0.390 Vali Loss: 4.521 Vali Acc: 0.601 Test Loss: 4.521 Test Acc: 0.601
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.6913533210754395
Epoch: 26, Steps: 17 | Train Loss: 0.623 Vali Loss: 3.949 Vali Acc: 0.757 Test Loss: 3.949 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.458767890930176
Epoch: 27, Steps: 17 | Train Loss: 0.414 Vali Loss: 4.579 Vali Acc: 0.705 Test Loss: 4.579 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 4039971
model size : 25.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.947389364242554
Epoch: 1, Steps: 17 | Train Loss: 1.654 Vali Loss: 1.169 Vali Acc: 0.462 Test Loss: 1.169 Test Acc: 0.462
Validation loss decreased (inf --> -0.462416).  Saving model ...
Epoch: 2 cost time: 2.794149875640869
Epoch: 2, Steps: 17 | Train Loss: 0.751 Vali Loss: 0.899 Vali Acc: 0.676 Test Loss: 0.899 Test Acc: 0.676
Validation loss decreased (-0.462416 --> -0.676292).  Saving model ...
Epoch: 3 cost time: 2.7810819149017334
Epoch: 3, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.804 Vali Acc: 0.728 Test Loss: 0.804 Test Acc: 0.728
Validation loss decreased (-0.676292 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.9445056915283203
Epoch: 4, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.877 Vali Acc: 0.728 Test Loss: 0.877 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.66355299949646
Epoch: 5, Steps: 17 | Train Loss: 0.200 Vali Loss: 1.380 Vali Acc: 0.699 Test Loss: 1.380 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 2.723667860031128
Epoch: 6, Steps: 17 | Train Loss: 0.222 Vali Loss: 0.960 Vali Acc: 0.769 Test Loss: 0.960 Test Acc: 0.769
Validation loss decreased (-0.728316 --> -0.768777).  Saving model ...
Epoch: 7 cost time: 2.759809970855713
Epoch: 7, Steps: 17 | Train Loss: 0.237 Vali Loss: 1.469 Vali Acc: 0.624 Test Loss: 1.469 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.521190881729126
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 1.459 Vali Acc: 0.792 Test Loss: 1.459 Test Acc: 0.792
Validation loss decreased (-0.768777 --> -0.791893).  Saving model ...
Epoch: 9 cost time: 2.7161731719970703
Epoch: 9, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.273 Vali Acc: 0.769 Test Loss: 1.273 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.7340896129608154
Epoch: 10, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.557 Vali Acc: 0.775 Test Loss: 1.557 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4483907222747803
Epoch: 11, Steps: 17 | Train Loss: 0.187 Vali Loss: 2.162 Vali Acc: 0.746 Test Loss: 2.162 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.7750353813171387
Epoch: 12, Steps: 17 | Train Loss: 0.189 Vali Loss: 1.210 Vali Acc: 0.815 Test Loss: 1.210 Test Acc: 0.815
Validation loss decreased (-0.791893 --> -0.815017).  Saving model ...
Epoch: 13 cost time: 2.354466438293457
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.633 Vali Acc: 0.798 Test Loss: 1.633 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.813934564590454
Epoch: 14, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.858 Vali Acc: 0.798 Test Loss: 1.858 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.166738986968994
Epoch: 15, Steps: 17 | Train Loss: 0.155 Vali Loss: 3.000 Vali Acc: 0.699 Test Loss: 3.000 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.501236915588379
Epoch: 16, Steps: 17 | Train Loss: 0.312 Vali Loss: 3.612 Vali Acc: 0.717 Test Loss: 3.612 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.7549829483032227
Epoch: 17, Steps: 17 | Train Loss: 0.480 Vali Loss: 1.891 Vali Acc: 0.832 Test Loss: 1.891 Test Acc: 0.832
Validation loss decreased (-0.815017 --> -0.832351).  Saving model ...
Epoch: 18 cost time: 2.783041477203369
Epoch: 18, Steps: 17 | Train Loss: 0.158 Vali Loss: 6.133 Vali Acc: 0.561 Test Loss: 6.133 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.500173568725586
Epoch: 19, Steps: 17 | Train Loss: 0.315 Vali Loss: 3.786 Vali Acc: 0.734 Test Loss: 3.786 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.766771078109741
Epoch: 20, Steps: 17 | Train Loss: 0.644 Vali Loss: 4.561 Vali Acc: 0.757 Test Loss: 4.561 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.8029298782348633
Epoch: 21, Steps: 17 | Train Loss: 0.460 Vali Loss: 3.343 Vali Acc: 0.746 Test Loss: 3.343 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.531503677368164
Epoch: 22, Steps: 17 | Train Loss: 0.291 Vali Loss: 2.795 Vali Acc: 0.798 Test Loss: 2.795 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.819979429244995
Epoch: 23, Steps: 17 | Train Loss: 0.661 Vali Loss: 5.263 Vali Acc: 0.647 Test Loss: 5.263 Test Acc: 0.647
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.664304256439209
Epoch: 24, Steps: 17 | Train Loss: 0.355 Vali Loss: 3.654 Vali Acc: 0.769 Test Loss: 3.654 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.8220982551574707
Epoch: 25, Steps: 17 | Train Loss: 0.435 Vali Loss: 8.794 Vali Acc: 0.717 Test Loss: 8.794 Test Acc: 0.717
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.5130398273468018
Epoch: 26, Steps: 17 | Train Loss: 0.480 Vali Loss: 7.433 Vali Acc: 0.734 Test Loss: 7.433 Test Acc: 0.734
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4644901752471924
Epoch: 27, Steps: 17 | Train Loss: 0.192 Vali Loss: 3.228 Vali Acc: 0.809 Test Loss: 3.228 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 3777827
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.010080814361572
Epoch: 1, Steps: 17 | Train Loss: 1.658 Vali Loss: 1.201 Vali Acc: 0.405 Test Loss: 1.201 Test Acc: 0.405
Validation loss decreased (inf --> -0.404612).  Saving model ...
Epoch: 2 cost time: 2.3459861278533936
Epoch: 2, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.921 Vali Acc: 0.676 Test Loss: 0.921 Test Acc: 0.676
Validation loss decreased (-0.404612 --> -0.676291).  Saving model ...
Epoch: 3 cost time: 2.2927112579345703
Epoch: 3, Steps: 17 | Train Loss: 0.565 Vali Loss: 0.746 Vali Acc: 0.740 Test Loss: 0.746 Test Acc: 0.740
Validation loss decreased (-0.676291 --> -0.739877).  Saving model ...
Epoch: 4 cost time: 2.5635266304016113
Epoch: 4, Steps: 17 | Train Loss: 0.294 Vali Loss: 0.911 Vali Acc: 0.653 Test Loss: 0.911 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.7524189949035645
Epoch: 5, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.797 Vali Acc: 0.734 Test Loss: 0.797 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.9911134243011475
Epoch: 6, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.811 Vali Acc: 0.728 Test Loss: 0.811 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 7 cost time: 1.9939680099487305
Epoch: 7, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.969 Vali Acc: 0.688 Test Loss: 0.969 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 8 cost time: 2.0584802627563477
Epoch: 8, Steps: 17 | Train Loss: 0.357 Vali Loss: 1.917 Vali Acc: 0.728 Test Loss: 1.917 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 9 cost time: 2.13447642326355
Epoch: 9, Steps: 17 | Train Loss: 0.650 Vali Loss: 2.006 Vali Acc: 0.757 Test Loss: 2.006 Test Acc: 0.757
Validation loss decreased (-0.739877 --> -0.757205).  Saving model ...
Epoch: 10 cost time: 2.561976194381714
Epoch: 10, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.742 Vali Acc: 0.751 Test Loss: 1.742 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.4238264560699463
Epoch: 11, Steps: 17 | Train Loss: 0.151 Vali Loss: 2.225 Vali Acc: 0.723 Test Loss: 2.225 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.6607108116149902
Epoch: 12, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.334 Vali Acc: 0.809 Test Loss: 1.334 Test Acc: 0.809
Validation loss decreased (-0.757205 --> -0.809235).  Saving model ...
Epoch: 13 cost time: 2.797980785369873
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.661 Vali Acc: 0.780 Test Loss: 1.661 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.9869067668914795
Epoch: 14, Steps: 17 | Train Loss: 0.182 Vali Loss: 2.078 Vali Acc: 0.734 Test Loss: 2.078 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.5548722743988037
Epoch: 15, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.995 Vali Acc: 0.775 Test Loss: 1.995 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.812131643295288
Epoch: 16, Steps: 17 | Train Loss: 0.312 Vali Loss: 3.007 Vali Acc: 0.688 Test Loss: 3.007 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.4273674488067627
Epoch: 17, Steps: 17 | Train Loss: 0.374 Vali Loss: 3.011 Vali Acc: 0.763 Test Loss: 3.011 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.793121099472046
Epoch: 18, Steps: 17 | Train Loss: 0.201 Vali Loss: 3.414 Vali Acc: 0.711 Test Loss: 3.414 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.710655689239502
Epoch: 19, Steps: 17 | Train Loss: 0.390 Vali Loss: 3.214 Vali Acc: 0.757 Test Loss: 3.214 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.3760955333709717
Epoch: 20, Steps: 17 | Train Loss: 0.334 Vali Loss: 2.519 Vali Acc: 0.769 Test Loss: 2.519 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.7440683841705322
Epoch: 21, Steps: 17 | Train Loss: 0.334 Vali Loss: 3.080 Vali Acc: 0.775 Test Loss: 3.080 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.7732865810394287
Epoch: 22, Steps: 17 | Train Loss: 0.252 Vali Loss: 2.928 Vali Acc: 0.821 Test Loss: 2.928 Test Acc: 0.821
Validation loss decreased (-0.809235 --> -0.820780).  Saving model ...
Epoch: 23 cost time: 2.851459503173828
Epoch: 23, Steps: 17 | Train Loss: 0.178 Vali Loss: 3.477 Vali Acc: 0.792 Test Loss: 3.477 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.61270809173584
Epoch: 24, Steps: 17 | Train Loss: 0.520 Vali Loss: 4.861 Vali Acc: 0.786 Test Loss: 4.861 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.6338276863098145
Epoch: 25, Steps: 17 | Train Loss: 0.408 Vali Loss: 3.598 Vali Acc: 0.769 Test Loss: 3.598 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 2.845341205596924
Epoch: 26, Steps: 17 | Train Loss: 0.260 Vali Loss: 5.449 Vali Acc: 0.780 Test Loss: 5.449 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 2.279630422592163
Epoch: 27, Steps: 17 | Train Loss: 0.276 Vali Loss: 3.729 Vali Acc: 0.786 Test Loss: 3.729 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.75812029838562
Epoch: 28, Steps: 17 | Train Loss: 0.245 Vali Loss: 4.110 Vali Acc: 0.815 Test Loss: 4.110 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.5856733322143555
Epoch: 29, Steps: 17 | Train Loss: 0.040 Vali Loss: 4.520 Vali Acc: 0.780 Test Loss: 4.520 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.9884321689605713
Epoch: 30, Steps: 17 | Train Loss: 0.763 Vali Loss: 5.638 Vali Acc: 0.769 Test Loss: 5.638 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 3.034538745880127
Epoch: 31, Steps: 17 | Train Loss: 0.375 Vali Loss: 8.380 Vali Acc: 0.746 Test Loss: 8.380 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.8157882690429688
Epoch: 32, Steps: 17 | Train Loss: 0.731 Vali Loss: 9.167 Vali Acc: 0.694 Test Loss: 9.167 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 3777827
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.411720037460327
Epoch: 1, Steps: 17 | Train Loss: 1.674 Vali Loss: 1.214 Vali Acc: 0.405 Test Loss: 1.214 Test Acc: 0.405
Validation loss decreased (inf --> -0.404612).  Saving model ...
Epoch: 2 cost time: 2.5468666553497314
Epoch: 2, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.861 Vali Acc: 0.699 Test Loss: 0.861 Test Acc: 0.699
Validation loss decreased (-0.404612 --> -0.699413).  Saving model ...
Epoch: 3 cost time: 2.6387970447540283
Epoch: 3, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.880 Vali Acc: 0.618 Test Loss: 0.880 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.618363618850708
Epoch: 4, Steps: 17 | Train Loss: 0.337 Vali Loss: 1.208 Vali Acc: 0.624 Test Loss: 1.208 Test Acc: 0.624
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.453415632247925
Epoch: 5, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.974 Vali Acc: 0.659 Test Loss: 0.974 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 6 cost time: 2.5399975776672363
Epoch: 6, Steps: 17 | Train Loss: 0.264 Vali Loss: 1.317 Vali Acc: 0.659 Test Loss: 1.317 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 7 cost time: 2.4869236946105957
Epoch: 7, Steps: 17 | Train Loss: 0.701 Vali Loss: 1.469 Vali Acc: 0.659 Test Loss: 1.469 Test Acc: 0.659
EarlyStopping counter: 5 out of 10
Epoch: 8 cost time: 2.144775867462158
Epoch: 8, Steps: 17 | Train Loss: 0.261 Vali Loss: 1.212 Vali Acc: 0.786 Test Loss: 1.212 Test Acc: 0.786
Validation loss decreased (-0.699413 --> -0.786115).  Saving model ...
Epoch: 9 cost time: 2.0349864959716797
Epoch: 9, Steps: 17 | Train Loss: 0.670 Vali Loss: 2.728 Vali Acc: 0.676 Test Loss: 2.728 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.0714454650878906
Epoch: 10, Steps: 17 | Train Loss: 0.270 Vali Loss: 1.401 Vali Acc: 0.757 Test Loss: 1.401 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4970898628234863
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 1.533 Vali Acc: 0.769 Test Loss: 1.533 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.406635284423828
Epoch: 12, Steps: 17 | Train Loss: 0.164 Vali Loss: 2.235 Vali Acc: 0.694 Test Loss: 2.235 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.190807342529297
Epoch: 13, Steps: 17 | Train Loss: 0.444 Vali Loss: 1.222 Vali Acc: 0.769 Test Loss: 1.222 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2406435012817383
Epoch: 14, Steps: 17 | Train Loss: 0.155 Vali Loss: 2.183 Vali Acc: 0.775 Test Loss: 2.183 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5662379264831543
Epoch: 15, Steps: 17 | Train Loss: 0.192 Vali Loss: 2.444 Vali Acc: 0.757 Test Loss: 2.444 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.755537748336792
Epoch: 16, Steps: 17 | Train Loss: 0.346 Vali Loss: 3.332 Vali Acc: 0.711 Test Loss: 3.332 Test Acc: 0.711
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.597968101501465
Epoch: 17, Steps: 17 | Train Loss: 0.830 Vali Loss: 2.349 Vali Acc: 0.780 Test Loss: 2.349 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.894214630126953
Epoch: 18, Steps: 17 | Train Loss: 0.229 Vali Loss: 2.641 Vali Acc: 0.763 Test Loss: 2.641 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7861271676300579
model parameter : 3777827
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.883949279785156
Epoch: 1, Steps: 17 | Train Loss: 1.737 Vali Loss: 1.296 Vali Acc: 0.405 Test Loss: 1.296 Test Acc: 0.405
Validation loss decreased (inf --> -0.404611).  Saving model ...
Epoch: 2 cost time: 2.330260753631592
Epoch: 2, Steps: 17 | Train Loss: 0.959 Vali Loss: 0.894 Vali Acc: 0.653 Test Loss: 0.894 Test Acc: 0.653
Validation loss decreased (-0.404611 --> -0.653170).  Saving model ...
Epoch: 3 cost time: 2.624683380126953
Epoch: 3, Steps: 17 | Train Loss: 0.621 Vali Loss: 0.983 Vali Acc: 0.590 Test Loss: 0.983 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.768061876296997
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.973 Vali Acc: 0.613 Test Loss: 0.973 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 2.5089051723480225
Epoch: 5, Steps: 17 | Train Loss: 0.384 Vali Loss: 0.849 Vali Acc: 0.751 Test Loss: 0.849 Test Acc: 0.751
Validation loss decreased (-0.653170 --> -0.751437).  Saving model ...
Epoch: 6 cost time: 2.55216646194458
Epoch: 6, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.091 Vali Acc: 0.734 Test Loss: 1.091 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.550135850906372
Epoch: 7, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.348 Vali Acc: 0.636 Test Loss: 1.348 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.465653896331787
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.959 Vali Acc: 0.746 Test Loss: 0.959 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.8419461250305176
Epoch: 9, Steps: 17 | Train Loss: 0.624 Vali Loss: 4.392 Vali Acc: 0.451 Test Loss: 4.392 Test Acc: 0.451
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.3419034481048584
Epoch: 10, Steps: 17 | Train Loss: 0.658 Vali Loss: 1.325 Vali Acc: 0.757 Test Loss: 1.325 Test Acc: 0.757
Validation loss decreased (-0.751437 --> -0.757212).  Saving model ...
Epoch: 11 cost time: 2.054313898086548
Epoch: 11, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.387 Vali Acc: 0.746 Test Loss: 1.387 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.5620226860046387
Epoch: 12, Steps: 17 | Train Loss: 0.273 Vali Loss: 2.331 Vali Acc: 0.653 Test Loss: 2.331 Test Acc: 0.653
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.293165683746338
Epoch: 13, Steps: 17 | Train Loss: 0.285 Vali Loss: 3.082 Vali Acc: 0.572 Test Loss: 3.082 Test Acc: 0.572
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.6325156688690186
Epoch: 14, Steps: 17 | Train Loss: 0.323 Vali Loss: 2.947 Vali Acc: 0.694 Test Loss: 2.947 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.5764715671539307
Epoch: 15, Steps: 17 | Train Loss: 0.416 Vali Loss: 1.339 Vali Acc: 0.792 Test Loss: 1.339 Test Acc: 0.792
Validation loss decreased (-0.757212 --> -0.791894).  Saving model ...
Epoch: 16 cost time: 2.292494535446167
Epoch: 16, Steps: 17 | Train Loss: 0.349 Vali Loss: 2.503 Vali Acc: 0.751 Test Loss: 2.503 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.6247568130493164
Epoch: 17, Steps: 17 | Train Loss: 0.613 Vali Loss: 2.002 Vali Acc: 0.769 Test Loss: 2.002 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.810683250427246
Epoch: 18, Steps: 17 | Train Loss: 0.114 Vali Loss: 2.681 Vali Acc: 0.769 Test Loss: 2.681 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.6979477405548096
Epoch: 19, Steps: 17 | Train Loss: 0.394 Vali Loss: 3.852 Vali Acc: 0.803 Test Loss: 3.852 Test Acc: 0.803
Validation loss decreased (-0.791894 --> -0.803430).  Saving model ...
Epoch: 20 cost time: 2.486208200454712
Epoch: 20, Steps: 17 | Train Loss: 0.247 Vali Loss: 3.616 Vali Acc: 0.717 Test Loss: 3.616 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 2.5422449111938477
Epoch: 21, Steps: 17 | Train Loss: 0.667 Vali Loss: 3.200 Vali Acc: 0.717 Test Loss: 3.200 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.6699576377868652
Epoch: 22, Steps: 17 | Train Loss: 0.854 Vali Loss: 3.426 Vali Acc: 0.734 Test Loss: 3.426 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6824357509613037
Epoch: 23, Steps: 17 | Train Loss: 0.338 Vali Loss: 5.201 Vali Acc: 0.746 Test Loss: 5.201 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.9470248222351074
Epoch: 24, Steps: 17 | Train Loss: 0.488 Vali Loss: 4.518 Vali Acc: 0.723 Test Loss: 4.518 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.9448750019073486
Epoch: 25, Steps: 17 | Train Loss: 0.289 Vali Loss: 4.463 Vali Acc: 0.746 Test Loss: 4.463 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 2.9173619747161865
Epoch: 26, Steps: 17 | Train Loss: 0.239 Vali Loss: 3.547 Vali Acc: 0.780 Test Loss: 3.547 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.7184529304504395
Epoch: 27, Steps: 17 | Train Loss: 0.605 Vali Loss: 3.760 Vali Acc: 0.786 Test Loss: 3.760 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.920428991317749
Epoch: 28, Steps: 17 | Train Loss: 0.136 Vali Loss: 5.982 Vali Acc: 0.688 Test Loss: 5.982 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.3899285793304443
Epoch: 29, Steps: 17 | Train Loss: 0.555 Vali Loss: 7.958 Vali Acc: 0.694 Test Loss: 7.958 Test Acc: 0.694
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3777827
model size : 24.19MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.62558126449585
Epoch: 1, Steps: 17 | Train Loss: 1.667 Vali Loss: 1.155 Vali Acc: 0.428 Test Loss: 1.155 Test Acc: 0.428
Validation loss decreased (inf --> -0.427734).  Saving model ...
Epoch: 2 cost time: 2.696070671081543
Epoch: 2, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.128 Vali Acc: 0.572 Test Loss: 1.128 Test Acc: 0.572
Validation loss decreased (-0.427734 --> -0.572243).  Saving model ...
Epoch: 3 cost time: 2.65812611579895
Epoch: 3, Steps: 17 | Train Loss: 0.566 Vali Loss: 1.245 Vali Acc: 0.566 Test Loss: 1.245 Test Acc: 0.566
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.381559133529663
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.003 Vali Acc: 0.682 Test Loss: 1.003 Test Acc: 0.682
Validation loss decreased (-0.572243 --> -0.682071).  Saving model ...
Epoch: 5 cost time: 2.4655966758728027
Epoch: 5, Steps: 17 | Train Loss: 0.250 Vali Loss: 1.193 Vali Acc: 0.694 Test Loss: 1.193 Test Acc: 0.694
Validation loss decreased (-0.682071 --> -0.693630).  Saving model ...
Epoch: 6 cost time: 2.622588634490967
Epoch: 6, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.769 Vali Acc: 0.792 Test Loss: 0.769 Test Acc: 0.792
Validation loss decreased (-0.693630 --> -0.791900).  Saving model ...
Epoch: 7 cost time: 2.835691213607788
Epoch: 7, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.664 Vali Acc: 0.798 Test Loss: 0.664 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 2.5070626735687256
Epoch: 8, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.978 Vali Acc: 0.809 Test Loss: 0.978 Test Acc: 0.809
Validation loss decreased (-0.797681 --> -0.809239).  Saving model ...
Epoch: 9 cost time: 2.9274868965148926
Epoch: 9, Steps: 17 | Train Loss: 0.296 Vali Loss: 1.433 Vali Acc: 0.775 Test Loss: 1.433 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.4750611782073975
Epoch: 10, Steps: 17 | Train Loss: 0.147 Vali Loss: 2.044 Vali Acc: 0.711 Test Loss: 2.044 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.757514476776123
Epoch: 11, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.302 Vali Acc: 0.740 Test Loss: 1.302 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.8053245544433594
Epoch: 12, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.865 Vali Acc: 0.763 Test Loss: 1.865 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.554767370223999
Epoch: 13, Steps: 17 | Train Loss: 0.475 Vali Loss: 2.162 Vali Acc: 0.792 Test Loss: 2.162 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.491658926010132
Epoch: 14, Steps: 17 | Train Loss: 0.382 Vali Loss: 1.336 Vali Acc: 0.809 Test Loss: 1.336 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.5573065280914307
Epoch: 15, Steps: 17 | Train Loss: 0.163 Vali Loss: 2.008 Vali Acc: 0.780 Test Loss: 2.008 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.6797866821289062
Epoch: 16, Steps: 17 | Train Loss: 0.124 Vali Loss: 1.508 Vali Acc: 0.832 Test Loss: 1.508 Test Acc: 0.832
Validation loss decreased (-0.809239 --> -0.832355).  Saving model ...
Epoch: 17 cost time: 2.007957935333252
Epoch: 17, Steps: 17 | Train Loss: 0.404 Vali Loss: 3.248 Vali Acc: 0.699 Test Loss: 3.248 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.118028402328491
Epoch: 18, Steps: 17 | Train Loss: 0.359 Vali Loss: 4.108 Vali Acc: 0.728 Test Loss: 4.108 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.3844144344329834
Epoch: 19, Steps: 17 | Train Loss: 0.819 Vali Loss: 3.225 Vali Acc: 0.780 Test Loss: 3.225 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 3.0565147399902344
Epoch: 20, Steps: 17 | Train Loss: 0.534 Vali Loss: 2.299 Vali Acc: 0.769 Test Loss: 2.299 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 3.1528708934783936
Epoch: 21, Steps: 17 | Train Loss: 0.442 Vali Loss: 6.974 Vali Acc: 0.723 Test Loss: 6.974 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.6442387104034424
Epoch: 22, Steps: 17 | Train Loss: 0.264 Vali Loss: 3.186 Vali Acc: 0.809 Test Loss: 3.186 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 3.1857502460479736
Epoch: 23, Steps: 17 | Train Loss: 0.308 Vali Loss: 4.680 Vali Acc: 0.763 Test Loss: 4.680 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 3.1969563961029053
Epoch: 24, Steps: 17 | Train Loss: 0.339 Vali Loss: 3.689 Vali Acc: 0.815 Test Loss: 3.689 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.692927122116089
Epoch: 25, Steps: 17 | Train Loss: 0.088 Vali Loss: 6.562 Vali Acc: 0.699 Test Loss: 6.562 Test Acc: 0.699
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 3.1061744689941406
Epoch: 26, Steps: 17 | Train Loss: 0.364 Vali Loss: 3.468 Vali Acc: 0.861 Test Loss: 3.468 Test Acc: 0.861
Validation loss decreased (-0.832355 --> -0.861237).  Saving model ...
Epoch: 27 cost time: 2.892407178878784
Epoch: 27, Steps: 17 | Train Loss: 0.275 Vali Loss: 4.458 Vali Acc: 0.757 Test Loss: 4.458 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.4803690910339355
Epoch: 28, Steps: 17 | Train Loss: 0.397 Vali Loss: 4.903 Vali Acc: 0.815 Test Loss: 4.903 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.9917376041412354
Epoch: 29, Steps: 17 | Train Loss: 0.245 Vali Loss: 5.219 Vali Acc: 0.780 Test Loss: 5.219 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.611794948577881
Epoch: 30, Steps: 17 | Train Loss: 1.227 Vali Loss: 5.061 Vali Acc: 0.798 Test Loss: 5.061 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.8974688053131104
Epoch: 31, Steps: 17 | Train Loss: 0.400 Vali Loss: 12.024 Vali Acc: 0.711 Test Loss: 12.024 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.9504387378692627
Epoch: 32, Steps: 17 | Train Loss: 0.745 Vali Loss: 9.306 Vali Acc: 0.775 Test Loss: 9.306 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 2.807285785675049
Epoch: 33, Steps: 17 | Train Loss: 0.275 Vali Loss: 8.310 Vali Acc: 0.815 Test Loss: 8.310 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.8812355995178223
Epoch: 34, Steps: 17 | Train Loss: 0.064 Vali Loss: 5.207 Vali Acc: 0.838 Test Loss: 5.207 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 2.859750986099243
Epoch: 35, Steps: 17 | Train Loss: 0.191 Vali Loss: 9.498 Vali Acc: 0.803 Test Loss: 9.498 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 2.6816160678863525
Epoch: 36, Steps: 17 | Train Loss: 0.676 Vali Loss: 7.709 Vali Acc: 0.769 Test Loss: 7.709 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 3646755
model size : 23.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.014732599258423
Epoch: 1, Steps: 17 | Train Loss: 1.651 Vali Loss: 1.157 Vali Acc: 0.457 Test Loss: 1.157 Test Acc: 0.457
Validation loss decreased (inf --> -0.456636).  Saving model ...
Epoch: 2 cost time: 2.5794553756713867
Epoch: 2, Steps: 17 | Train Loss: 0.865 Vali Loss: 1.138 Vali Acc: 0.543 Test Loss: 1.138 Test Acc: 0.543
Validation loss decreased (-0.456636 --> -0.543341).  Saving model ...
Epoch: 3 cost time: 2.6346213817596436
Epoch: 3, Steps: 17 | Train Loss: 0.616 Vali Loss: 1.454 Vali Acc: 0.491 Test Loss: 1.454 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.9978575706481934
Epoch: 4, Steps: 17 | Train Loss: 0.545 Vali Loss: 0.912 Vali Acc: 0.705 Test Loss: 0.912 Test Acc: 0.705
Validation loss decreased (-0.543341 --> -0.705193).  Saving model ...
Epoch: 5 cost time: 2.763507604598999
Epoch: 5, Steps: 17 | Train Loss: 0.267 Vali Loss: 1.264 Vali Acc: 0.630 Test Loss: 1.264 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.565671682357788
Epoch: 6, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.036 Vali Acc: 0.746 Test Loss: 1.036 Test Acc: 0.746
Validation loss decreased (-0.705193 --> -0.745654).  Saving model ...
Epoch: 7 cost time: 2.900067090988159
Epoch: 7, Steps: 17 | Train Loss: 0.437 Vali Loss: 0.742 Vali Acc: 0.792 Test Loss: 0.742 Test Acc: 0.792
Validation loss decreased (-0.745654 --> -0.791900).  Saving model ...
Epoch: 8 cost time: 2.3749775886535645
Epoch: 8, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.794 Vali Acc: 0.792 Test Loss: 0.794 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.662174701690674
Epoch: 9, Steps: 17 | Train Loss: 0.339 Vali Loss: 1.772 Vali Acc: 0.723 Test Loss: 1.772 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.5862483978271484
Epoch: 10, Steps: 17 | Train Loss: 0.513 Vali Loss: 1.882 Vali Acc: 0.751 Test Loss: 1.882 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.5464415550231934
Epoch: 11, Steps: 17 | Train Loss: 0.414 Vali Loss: 1.219 Vali Acc: 0.786 Test Loss: 1.219 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.858181953430176
Epoch: 12, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.749 Vali Acc: 0.792 Test Loss: 1.749 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.326089382171631
Epoch: 13, Steps: 17 | Train Loss: 0.228 Vali Loss: 3.244 Vali Acc: 0.711 Test Loss: 3.244 Test Acc: 0.711
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.576677083969116
Epoch: 14, Steps: 17 | Train Loss: 0.569 Vali Loss: 2.389 Vali Acc: 0.769 Test Loss: 2.389 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.6965601444244385
Epoch: 15, Steps: 17 | Train Loss: 0.343 Vali Loss: 2.407 Vali Acc: 0.786 Test Loss: 2.407 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.578657627105713
Epoch: 16, Steps: 17 | Train Loss: 0.188 Vali Loss: 2.177 Vali Acc: 0.775 Test Loss: 2.177 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.9376940727233887
Epoch: 17, Steps: 17 | Train Loss: 0.242 Vali Loss: 3.842 Vali Acc: 0.728 Test Loss: 3.842 Test Acc: 0.728
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.791907514450867
model parameter : 3646755
model size : 23.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.5183424949646
Epoch: 1, Steps: 17 | Train Loss: 1.649 Vali Loss: 1.216 Vali Acc: 0.480 Test Loss: 1.216 Test Acc: 0.480
Validation loss decreased (inf --> -0.479757).  Saving model ...
Epoch: 2 cost time: 2.3903613090515137
Epoch: 2, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.066 Vali Acc: 0.584 Test Loss: 1.066 Test Acc: 0.584
Validation loss decreased (-0.479757 --> -0.583804).  Saving model ...
Epoch: 3 cost time: 2.350989818572998
Epoch: 3, Steps: 17 | Train Loss: 0.593 Vali Loss: 1.435 Vali Acc: 0.538 Test Loss: 1.435 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.405749559402466
Epoch: 4, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.970 Vali Acc: 0.717 Test Loss: 0.970 Test Acc: 0.717
Validation loss decreased (-0.583804 --> -0.716753).  Saving model ...
Epoch: 5 cost time: 2.3275341987609863
Epoch: 5, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.951 Vali Acc: 0.671 Test Loss: 0.951 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.564199209213257
Epoch: 6, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.674 Vali Acc: 0.792 Test Loss: 0.674 Test Acc: 0.792
Validation loss decreased (-0.716753 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 2.7016777992248535
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 0.885 Vali Acc: 0.751 Test Loss: 0.885 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.654184341430664
Epoch: 8, Steps: 17 | Train Loss: 0.440 Vali Loss: 1.490 Vali Acc: 0.723 Test Loss: 1.490 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.780932903289795
Epoch: 9, Steps: 17 | Train Loss: 0.321 Vali Loss: 1.857 Vali Acc: 0.653 Test Loss: 1.857 Test Acc: 0.653
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.9462714195251465
Epoch: 10, Steps: 17 | Train Loss: 0.319 Vali Loss: 2.236 Vali Acc: 0.647 Test Loss: 2.236 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 3.0132713317871094
Epoch: 11, Steps: 17 | Train Loss: 0.354 Vali Loss: 1.235 Vali Acc: 0.792 Test Loss: 1.235 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.5859057903289795
Epoch: 12, Steps: 17 | Train Loss: 0.267 Vali Loss: 2.260 Vali Acc: 0.734 Test Loss: 2.260 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.927685260772705
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 2.432 Vali Acc: 0.740 Test Loss: 2.432 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 14 cost time: 2.49501371383667
Epoch: 14, Steps: 17 | Train Loss: 0.552 Vali Loss: 2.547 Vali Acc: 0.728 Test Loss: 2.547 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 15 cost time: 2.8404204845428467
Epoch: 15, Steps: 17 | Train Loss: 0.169 Vali Loss: 2.033 Vali Acc: 0.803 Test Loss: 2.033 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803448).  Saving model ...
Epoch: 16 cost time: 2.4819750785827637
Epoch: 16, Steps: 17 | Train Loss: 0.234 Vali Loss: 2.059 Vali Acc: 0.798 Test Loss: 2.059 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.9376020431518555
Epoch: 17, Steps: 17 | Train Loss: 0.194 Vali Loss: 3.628 Vali Acc: 0.723 Test Loss: 3.628 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.9737184047698975
Epoch: 18, Steps: 17 | Train Loss: 0.381 Vali Loss: 6.358 Vali Acc: 0.746 Test Loss: 6.358 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.4479382038116455
Epoch: 19, Steps: 17 | Train Loss: 0.674 Vali Loss: 6.147 Vali Acc: 0.728 Test Loss: 6.147 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.429091453552246
Epoch: 20, Steps: 17 | Train Loss: 0.451 Vali Loss: 2.511 Vali Acc: 0.786 Test Loss: 2.511 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.9362478256225586
Epoch: 21, Steps: 17 | Train Loss: 0.143 Vali Loss: 3.793 Vali Acc: 0.775 Test Loss: 3.793 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 3.0633254051208496
Epoch: 22, Steps: 17 | Train Loss: 0.703 Vali Loss: 4.651 Vali Acc: 0.699 Test Loss: 4.651 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.7756547927856445
Epoch: 23, Steps: 17 | Train Loss: 0.603 Vali Loss: 4.891 Vali Acc: 0.769 Test Loss: 4.891 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.744084358215332
Epoch: 24, Steps: 17 | Train Loss: 0.536 Vali Loss: 3.734 Vali Acc: 0.798 Test Loss: 3.734 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.555316209793091
Epoch: 25, Steps: 17 | Train Loss: 0.675 Vali Loss: 3.904 Vali Acc: 0.757 Test Loss: 3.904 Test Acc: 0.757
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3646755
model size : 23.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.081108331680298
Epoch: 1, Steps: 17 | Train Loss: 1.749 Vali Loss: 1.295 Vali Acc: 0.468 Test Loss: 1.295 Test Acc: 0.468
Validation loss decreased (inf --> -0.468195).  Saving model ...
Epoch: 2 cost time: 2.500821113586426
Epoch: 2, Steps: 17 | Train Loss: 1.012 Vali Loss: 1.196 Vali Acc: 0.480 Test Loss: 1.196 Test Acc: 0.480
Validation loss decreased (-0.468195 --> -0.479757).  Saving model ...
Epoch: 3 cost time: 2.3992221355438232
Epoch: 3, Steps: 17 | Train Loss: 0.722 Vali Loss: 1.550 Vali Acc: 0.468 Test Loss: 1.550 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.802002191543579
Epoch: 4, Steps: 17 | Train Loss: 0.762 Vali Loss: 1.027 Vali Acc: 0.699 Test Loss: 1.027 Test Acc: 0.699
Validation loss decreased (-0.479757 --> -0.699412).  Saving model ...
Epoch: 5 cost time: 2.4409186840057373
Epoch: 5, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.850 Vali Acc: 0.734 Test Loss: 0.850 Test Acc: 0.734
Validation loss decreased (-0.699412 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 2.25124454498291
Epoch: 6, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.938 Vali Acc: 0.740 Test Loss: 0.938 Test Acc: 0.740
Validation loss decreased (-0.734096 --> -0.739875).  Saving model ...
Epoch: 7 cost time: 2.359084367752075
Epoch: 7, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.832 Vali Acc: 0.746 Test Loss: 0.832 Test Acc: 0.746
Validation loss decreased (-0.739875 --> -0.745656).  Saving model ...
Epoch: 8 cost time: 2.3454346656799316
Epoch: 8, Steps: 17 | Train Loss: 0.236 Vali Loss: 1.247 Vali Acc: 0.723 Test Loss: 1.247 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.358508348464966
Epoch: 9, Steps: 17 | Train Loss: 0.424 Vali Loss: 1.158 Vali Acc: 0.757 Test Loss: 1.158 Test Acc: 0.757
Validation loss decreased (-0.745656 --> -0.757214).  Saving model ...
Epoch: 10 cost time: 2.5102860927581787
Epoch: 10, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.951 Vali Acc: 0.746 Test Loss: 0.951 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1545767784118652
Epoch: 11, Steps: 17 | Train Loss: 0.261 Vali Loss: 2.760 Vali Acc: 0.688 Test Loss: 2.760 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.466500759124756
Epoch: 12, Steps: 17 | Train Loss: 0.243 Vali Loss: 2.134 Vali Acc: 0.665 Test Loss: 2.134 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.5140228271484375
Epoch: 13, Steps: 17 | Train Loss: 0.624 Vali Loss: 2.235 Vali Acc: 0.647 Test Loss: 2.235 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1399431228637695
Epoch: 14, Steps: 17 | Train Loss: 0.356 Vali Loss: 3.705 Vali Acc: 0.671 Test Loss: 3.705 Test Acc: 0.671
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.477581262588501
Epoch: 15, Steps: 17 | Train Loss: 0.463 Vali Loss: 2.736 Vali Acc: 0.734 Test Loss: 2.736 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.2496821880340576
Epoch: 16, Steps: 17 | Train Loss: 0.557 Vali Loss: 6.732 Vali Acc: 0.561 Test Loss: 6.732 Test Acc: 0.561
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3187668323516846
Epoch: 17, Steps: 17 | Train Loss: 0.833 Vali Loss: 2.424 Vali Acc: 0.694 Test Loss: 2.424 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.6716206073760986
Epoch: 18, Steps: 17 | Train Loss: 0.962 Vali Loss: 4.753 Vali Acc: 0.682 Test Loss: 4.753 Test Acc: 0.682
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3375275135040283
Epoch: 19, Steps: 17 | Train Loss: 0.394 Vali Loss: 5.552 Vali Acc: 0.584 Test Loss: 5.552 Test Acc: 0.584
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7572254335260116
model parameter : 3646755
model size : 23.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.292824983596802
Epoch: 1, Steps: 17 | Train Loss: 1.671 Vali Loss: 1.235 Vali Acc: 0.439 Test Loss: 1.235 Test Acc: 0.439
Validation loss decreased (inf --> -0.439294).  Saving model ...
Epoch: 2 cost time: 2.585503339767456
Epoch: 2, Steps: 17 | Train Loss: 0.930 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
Validation loss decreased (-0.439294 --> -0.710974).  Saving model ...
Epoch: 3 cost time: 2.7764596939086914
Epoch: 3, Steps: 17 | Train Loss: 0.467 Vali Loss: 0.756 Vali Acc: 0.728 Test Loss: 0.756 Test Acc: 0.728
Validation loss decreased (-0.710974 --> -0.728316).  Saving model ...
Epoch: 4 cost time: 2.83606219291687
Epoch: 4, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.879 Vali Acc: 0.746 Test Loss: 0.879 Test Acc: 0.746
Validation loss decreased (-0.728316 --> -0.745656).  Saving model ...
Epoch: 5 cost time: 2.7241876125335693
Epoch: 5, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.832 Vali Acc: 0.798 Test Loss: 0.832 Test Acc: 0.798
Validation loss decreased (-0.745656 --> -0.797680).  Saving model ...
Epoch: 6 cost time: 2.65602970123291
Epoch: 6, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.932 Vali Acc: 0.699 Test Loss: 0.932 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.9836316108703613
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 1.205 Vali Acc: 0.705 Test Loss: 1.205 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.777038335800171
Epoch: 8, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.311 Vali Acc: 0.723 Test Loss: 1.311 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 2.4710588455200195
Epoch: 9, Steps: 17 | Train Loss: 0.163 Vali Loss: 2.200 Vali Acc: 0.671 Test Loss: 2.200 Test Acc: 0.671
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 3.1289165019989014
Epoch: 10, Steps: 17 | Train Loss: 0.474 Vali Loss: 2.704 Vali Acc: 0.699 Test Loss: 2.704 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 3.0428998470306396
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.963 Vali Acc: 0.827 Test Loss: 0.963 Test Acc: 0.827
Validation loss decreased (-0.797680 --> -0.826580).  Saving model ...
Epoch: 12 cost time: 2.974355936050415
Epoch: 12, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.666 Vali Acc: 0.769 Test Loss: 1.666 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 3.0433130264282227
Epoch: 13, Steps: 17 | Train Loss: 0.544 Vali Loss: 2.296 Vali Acc: 0.746 Test Loss: 2.296 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.610295295715332
Epoch: 14, Steps: 17 | Train Loss: 0.469 Vali Loss: 2.159 Vali Acc: 0.769 Test Loss: 2.159 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.298542022705078
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 2.056 Vali Acc: 0.769 Test Loss: 2.056 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.4172024726867676
Epoch: 16, Steps: 17 | Train Loss: 0.153 Vali Loss: 4.967 Vali Acc: 0.682 Test Loss: 4.967 Test Acc: 0.682
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.654843807220459
Epoch: 17, Steps: 17 | Train Loss: 0.376 Vali Loss: 2.707 Vali Acc: 0.751 Test Loss: 2.707 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 3.2381014823913574
Epoch: 18, Steps: 17 | Train Loss: 0.202 Vali Loss: 2.483 Vali Acc: 0.763 Test Loss: 2.483 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.9912712574005127
Epoch: 19, Steps: 17 | Train Loss: 0.295 Vali Loss: 2.892 Vali Acc: 0.798 Test Loss: 2.892 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 3.2320544719696045
Epoch: 20, Steps: 17 | Train Loss: 0.154 Vali Loss: 5.381 Vali Acc: 0.728 Test Loss: 5.381 Test Acc: 0.728
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 3.0052103996276855
Epoch: 21, Steps: 17 | Train Loss: 0.261 Vali Loss: 2.771 Vali Acc: 0.809 Test Loss: 2.771 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 3581219
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.148970127105713
Epoch: 1, Steps: 17 | Train Loss: 1.656 Vali Loss: 1.215 Vali Acc: 0.445 Test Loss: 1.215 Test Acc: 0.445
Validation loss decreased (inf --> -0.445075).  Saving model ...
Epoch: 2 cost time: 2.58135986328125
Epoch: 2, Steps: 17 | Train Loss: 0.934 Vali Loss: 0.853 Vali Acc: 0.688 Test Loss: 0.853 Test Acc: 0.688
Validation loss decreased (-0.445075 --> -0.687853).  Saving model ...
Epoch: 3 cost time: 2.398632526397705
Epoch: 3, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.741 Vali Acc: 0.705 Test Loss: 0.741 Test Acc: 0.705
Validation loss decreased (-0.687853 --> -0.705195).  Saving model ...
Epoch: 4 cost time: 2.7182273864746094
Epoch: 4, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.939 Vali Acc: 0.699 Test Loss: 0.939 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.4562783241271973
Epoch: 5, Steps: 17 | Train Loss: 0.286 Vali Loss: 1.158 Vali Acc: 0.717 Test Loss: 1.158 Test Acc: 0.717
Validation loss decreased (-0.705195 --> -0.716751).  Saving model ...
Epoch: 6 cost time: 2.5955286026000977
Epoch: 6, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.884 Vali Acc: 0.705 Test Loss: 0.884 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.304051160812378
Epoch: 7, Steps: 17 | Train Loss: 0.191 Vali Loss: 1.708 Vali Acc: 0.630 Test Loss: 1.708 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.3623666763305664
Epoch: 8, Steps: 17 | Train Loss: 0.464 Vali Loss: 1.065 Vali Acc: 0.769 Test Loss: 1.065 Test Acc: 0.769
Validation loss decreased (-0.716751 --> -0.768775).  Saving model ...
Epoch: 9 cost time: 2.689328670501709
Epoch: 9, Steps: 17 | Train Loss: 0.207 Vali Loss: 1.056 Vali Acc: 0.815 Test Loss: 1.056 Test Acc: 0.815
Validation loss decreased (-0.768775 --> -0.815018).  Saving model ...
Epoch: 10 cost time: 2.7107152938842773
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.781 Vali Acc: 0.844 Test Loss: 0.781 Test Acc: 0.844
Validation loss decreased (-0.815018 --> -0.843923).  Saving model ...
Epoch: 11 cost time: 2.988868474960327
Epoch: 11, Steps: 17 | Train Loss: 0.220 Vali Loss: 2.048 Vali Acc: 0.751 Test Loss: 2.048 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.7170169353485107
Epoch: 12, Steps: 17 | Train Loss: 0.248 Vali Loss: 1.499 Vali Acc: 0.809 Test Loss: 1.499 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.7166476249694824
Epoch: 13, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.251 Vali Acc: 0.815 Test Loss: 1.251 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.7073757648468018
Epoch: 14, Steps: 17 | Train Loss: 0.274 Vali Loss: 2.240 Vali Acc: 0.757 Test Loss: 2.240 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.755593776702881
Epoch: 15, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.869 Vali Acc: 0.838 Test Loss: 1.869 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.705335855484009
Epoch: 16, Steps: 17 | Train Loss: 0.228 Vali Loss: 2.189 Vali Acc: 0.792 Test Loss: 2.189 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.825028419494629
Epoch: 17, Steps: 17 | Train Loss: 0.096 Vali Loss: 2.267 Vali Acc: 0.775 Test Loss: 2.267 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.1695191860198975
Epoch: 18, Steps: 17 | Train Loss: 0.494 Vali Loss: 3.031 Vali Acc: 0.746 Test Loss: 3.031 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 3.0068979263305664
Epoch: 19, Steps: 17 | Train Loss: 0.371 Vali Loss: 2.603 Vali Acc: 0.803 Test Loss: 2.603 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.058426856994629
Epoch: 20, Steps: 17 | Train Loss: 0.274 Vali Loss: 3.133 Vali Acc: 0.832 Test Loss: 3.133 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 3581219
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.660475492477417
Epoch: 1, Steps: 17 | Train Loss: 1.666 Vali Loss: 1.218 Vali Acc: 0.439 Test Loss: 1.218 Test Acc: 0.439
Validation loss decreased (inf --> -0.439294).  Saving model ...
Epoch: 2 cost time: 2.2183785438537598
Epoch: 2, Steps: 17 | Train Loss: 0.969 Vali Loss: 0.885 Vali Acc: 0.642 Test Loss: 0.885 Test Acc: 0.642
Validation loss decreased (-0.439294 --> -0.641610).  Saving model ...
Epoch: 3 cost time: 2.317063331604004
Epoch: 3, Steps: 17 | Train Loss: 0.474 Vali Loss: 0.752 Vali Acc: 0.717 Test Loss: 0.752 Test Acc: 0.717
Validation loss decreased (-0.641610 --> -0.716755).  Saving model ...
Epoch: 4 cost time: 2.719290018081665
Epoch: 4, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.603 Vali Acc: 0.786 Test Loss: 0.603 Test Acc: 0.786
Validation loss decreased (-0.716755 --> -0.786121).  Saving model ...
Epoch: 5 cost time: 2.5583348274230957
Epoch: 5, Steps: 17 | Train Loss: 0.303 Vali Loss: 1.844 Vali Acc: 0.601 Test Loss: 1.844 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.5094804763793945
Epoch: 6, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.409 Vali Acc: 0.601 Test Loss: 1.409 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.6225452423095703
Epoch: 7, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.209 Vali Acc: 0.717 Test Loss: 1.209 Test Acc: 0.717
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.6241936683654785
Epoch: 8, Steps: 17 | Train Loss: 0.227 Vali Loss: 1.729 Vali Acc: 0.728 Test Loss: 1.729 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.7809603214263916
Epoch: 9, Steps: 17 | Train Loss: 0.425 Vali Loss: 1.302 Vali Acc: 0.728 Test Loss: 1.302 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.988581895828247
Epoch: 10, Steps: 17 | Train Loss: 0.178 Vali Loss: 1.042 Vali Acc: 0.803 Test Loss: 1.042 Test Acc: 0.803
Validation loss decreased (-0.786121 --> -0.803458).  Saving model ...
Epoch: 11 cost time: 3.234039068222046
Epoch: 11, Steps: 17 | Train Loss: 0.665 Vali Loss: 1.904 Vali Acc: 0.746 Test Loss: 1.904 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.8878226280212402
Epoch: 12, Steps: 17 | Train Loss: 0.178 Vali Loss: 2.669 Vali Acc: 0.699 Test Loss: 2.669 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.8280487060546875
Epoch: 13, Steps: 17 | Train Loss: 0.709 Vali Loss: 2.797 Vali Acc: 0.699 Test Loss: 2.797 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.9911553859710693
Epoch: 14, Steps: 17 | Train Loss: 0.447 Vali Loss: 2.652 Vali Acc: 0.746 Test Loss: 2.652 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.687643527984619
Epoch: 15, Steps: 17 | Train Loss: 0.423 Vali Loss: 2.032 Vali Acc: 0.746 Test Loss: 2.032 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.842057943344116
Epoch: 16, Steps: 17 | Train Loss: 0.308 Vali Loss: 2.909 Vali Acc: 0.740 Test Loss: 2.909 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5122337341308594
Epoch: 17, Steps: 17 | Train Loss: 0.420 Vali Loss: 2.763 Vali Acc: 0.705 Test Loss: 2.763 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.971796989440918
Epoch: 18, Steps: 17 | Train Loss: 0.357 Vali Loss: 2.720 Vali Acc: 0.786 Test Loss: 2.720 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.8105874061584473
Epoch: 19, Steps: 17 | Train Loss: 0.339 Vali Loss: 2.517 Vali Acc: 0.786 Test Loss: 2.517 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 3.1442325115203857
Epoch: 20, Steps: 17 | Train Loss: 0.758 Vali Loss: 8.962 Vali Acc: 0.618 Test Loss: 8.962 Test Acc: 0.618
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 3581219
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            512                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.471585750579834
Epoch: 1, Steps: 17 | Train Loss: 1.725 Vali Loss: 1.295 Vali Acc: 0.399 Test Loss: 1.295 Test Acc: 0.399
Validation loss decreased (inf --> -0.398831).  Saving model ...
Epoch: 2 cost time: 2.4009976387023926
Epoch: 2, Steps: 17 | Train Loss: 1.070 Vali Loss: 1.039 Vali Acc: 0.601 Test Loss: 1.039 Test Acc: 0.601
Validation loss decreased (-0.398831 --> -0.601146).  Saving model ...
Epoch: 3 cost time: 2.3483824729919434
Epoch: 3, Steps: 17 | Train Loss: 0.607 Vali Loss: 0.825 Vali Acc: 0.694 Test Loss: 0.825 Test Acc: 0.694
Validation loss decreased (-0.601146 --> -0.693633).  Saving model ...
Epoch: 4 cost time: 2.4520926475524902
Epoch: 4, Steps: 17 | Train Loss: 0.530 Vali Loss: 0.792 Vali Acc: 0.734 Test Loss: 0.792 Test Acc: 0.734
Validation loss decreased (-0.693633 --> -0.734096).  Saving model ...
Epoch: 5 cost time: 2.5642030239105225
Epoch: 5, Steps: 17 | Train Loss: 0.378 Vali Loss: 0.914 Vali Acc: 0.711 Test Loss: 0.914 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2679555416107178
Epoch: 6, Steps: 17 | Train Loss: 0.308 Vali Loss: 1.165 Vali Acc: 0.636 Test Loss: 1.165 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.338881492614746
Epoch: 7, Steps: 17 | Train Loss: 0.483 Vali Loss: 2.013 Vali Acc: 0.624 Test Loss: 2.013 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.134714126586914
Epoch: 8, Steps: 17 | Train Loss: 0.445 Vali Loss: 2.159 Vali Acc: 0.520 Test Loss: 2.159 Test Acc: 0.520
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.363431930541992
Epoch: 9, Steps: 17 | Train Loss: 0.563 Vali Loss: 1.663 Vali Acc: 0.717 Test Loss: 1.663 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 2.7439982891082764
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 1.180 Vali Acc: 0.780 Test Loss: 1.180 Test Acc: 0.780
Validation loss decreased (-0.734096 --> -0.780335).  Saving model ...
Epoch: 11 cost time: 2.4638943672180176
Epoch: 11, Steps: 17 | Train Loss: 0.500 Vali Loss: 0.926 Vali Acc: 0.751 Test Loss: 0.926 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.4727365970611572
Epoch: 12, Steps: 17 | Train Loss: 0.426 Vali Loss: 3.470 Vali Acc: 0.671 Test Loss: 3.470 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.2019991874694824
Epoch: 13, Steps: 17 | Train Loss: 0.558 Vali Loss: 1.507 Vali Acc: 0.780 Test Loss: 1.507 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.5180916786193848
Epoch: 14, Steps: 17 | Train Loss: 0.966 Vali Loss: 4.126 Vali Acc: 0.642 Test Loss: 4.126 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.251314640045166
Epoch: 15, Steps: 17 | Train Loss: 0.421 Vali Loss: 1.856 Vali Acc: 0.751 Test Loss: 1.856 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.388625144958496
Epoch: 16, Steps: 17 | Train Loss: 0.444 Vali Loss: 3.270 Vali Acc: 0.717 Test Loss: 3.270 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.5275280475616455
Epoch: 17, Steps: 17 | Train Loss: 0.292 Vali Loss: 1.952 Vali Acc: 0.809 Test Loss: 1.952 Test Acc: 0.809
Validation loss decreased (-0.780335 --> -0.809229).  Saving model ...
Epoch: 18 cost time: 2.7883808612823486
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.581 Vali Acc: 0.751 Test Loss: 1.581 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2737863063812256
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 2.018 Vali Acc: 0.751 Test Loss: 2.018 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.3822734355926514
Epoch: 20, Steps: 17 | Train Loss: 0.401 Vali Loss: 2.646 Vali Acc: 0.734 Test Loss: 2.646 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.44514799118042
Epoch: 21, Steps: 17 | Train Loss: 0.575 Vali Loss: 5.157 Vali Acc: 0.584 Test Loss: 5.157 Test Acc: 0.584
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.588073968887329
Epoch: 22, Steps: 17 | Train Loss: 0.511 Vali Loss: 3.735 Vali Acc: 0.688 Test Loss: 3.735 Test Acc: 0.688
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.4165613651275635
Epoch: 23, Steps: 17 | Train Loss: 1.505 Vali Loss: 7.819 Vali Acc: 0.595 Test Loss: 7.819 Test Acc: 0.595
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3289003372192383
Epoch: 24, Steps: 17 | Train Loss: 1.508 Vali Loss: 8.767 Vali Acc: 0.613 Test Loss: 8.767 Test Acc: 0.613
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.3323755264282227
Epoch: 25, Steps: 17 | Train Loss: 0.827 Vali Loss: 3.464 Vali Acc: 0.751 Test Loss: 3.464 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.340764045715332
Epoch: 26, Steps: 17 | Train Loss: 0.377 Vali Loss: 3.457 Vali Acc: 0.746 Test Loss: 3.457 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.4574577808380127
Epoch: 27, Steps: 17 | Train Loss: 0.225 Vali Loss: 5.769 Vali Acc: 0.705 Test Loss: 5.769 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm512_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8092485549132948
model parameter : 3581219
model size : 23.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.33704137802124
Epoch: 1, Steps: 17 | Train Loss: 1.837 Vali Loss: 1.453 Vali Acc: 0.295 Test Loss: 1.453 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 1.6718223094940186
Epoch: 2, Steps: 17 | Train Loss: 1.044 Vali Loss: 0.904 Vali Acc: 0.665 Test Loss: 0.904 Test Acc: 0.665
Validation loss decreased (-0.294783 --> -0.664731).  Saving model ...
Epoch: 3 cost time: 1.935201644897461
Epoch: 3, Steps: 17 | Train Loss: 0.672 Vali Loss: 0.854 Vali Acc: 0.642 Test Loss: 0.854 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.1539793014526367
Epoch: 4, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.724 Vali Acc: 0.694 Test Loss: 0.724 Test Acc: 0.694
Validation loss decreased (-0.664731 --> -0.693634).  Saving model ...
Epoch: 5 cost time: 2.264798402786255
Epoch: 5, Steps: 17 | Train Loss: 0.282 Vali Loss: 0.914 Vali Acc: 0.694 Test Loss: 0.914 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.251715898513794
Epoch: 6, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.698 Vali Acc: 0.757 Test Loss: 0.698 Test Acc: 0.757
Validation loss decreased (-0.693634 --> -0.757218).  Saving model ...
Epoch: 7 cost time: 2.4566078186035156
Epoch: 7, Steps: 17 | Train Loss: 0.139 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809242).  Saving model ...
Epoch: 8 cost time: 2.324302911758423
Epoch: 8, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.842 Vali Acc: 0.769 Test Loss: 0.842 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.4241063594818115
Epoch: 9, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.851 Vali Acc: 0.757 Test Loss: 0.851 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.599935531616211
Epoch: 10, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.894 Vali Acc: 0.734 Test Loss: 0.894 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.3203489780426025
Epoch: 11, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.159 Vali Acc: 0.798 Test Loss: 1.159 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.071068048477173
Epoch: 12, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.790 Vali Acc: 0.827 Test Loss: 0.790 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826582).  Saving model ...
Epoch: 13 cost time: 2.3863275051116943
Epoch: 13, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.786 Vali Acc: 0.832 Test Loss: 0.786 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832362).  Saving model ...
Epoch: 14 cost time: 2.5482330322265625
Epoch: 14, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.127 Vali Acc: 0.780 Test Loss: 1.127 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.508596420288086
Epoch: 15, Steps: 17 | Train Loss: 0.186 Vali Loss: 1.329 Vali Acc: 0.780 Test Loss: 1.329 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.391677141189575
Epoch: 16, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.390 Vali Acc: 0.775 Test Loss: 1.390 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.351840019226074
Epoch: 17, Steps: 17 | Train Loss: 0.114 Vali Loss: 3.119 Vali Acc: 0.728 Test Loss: 3.119 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.3905396461486816
Epoch: 18, Steps: 17 | Train Loss: 0.216 Vali Loss: 1.523 Vali Acc: 0.769 Test Loss: 1.523 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.437163829803467
Epoch: 19, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.118 Vali Acc: 0.850 Test Loss: 1.118 Test Acc: 0.850
Validation loss decreased (-0.832362 --> -0.849700).  Saving model ...
Epoch: 20 cost time: 2.411961317062378
Epoch: 20, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.523 Vali Acc: 0.728 Test Loss: 1.523 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8874938488006592
Epoch: 21, Steps: 17 | Train Loss: 0.181 Vali Loss: 1.573 Vali Acc: 0.803 Test Loss: 1.573 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.267990827560425
Epoch: 22, Steps: 17 | Train Loss: 0.237 Vali Loss: 1.855 Vali Acc: 0.763 Test Loss: 1.855 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 2.6493496894836426
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.348 Vali Acc: 0.803 Test Loss: 2.348 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 2.492526054382324
Epoch: 24, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.686 Vali Acc: 0.775 Test Loss: 2.686 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 2.00905179977417
Epoch: 25, Steps: 17 | Train Loss: 0.102 Vali Loss: 2.141 Vali Acc: 0.780 Test Loss: 2.141 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9691495895385742
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 2.721 Vali Acc: 0.780 Test Loss: 2.721 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 2.3657801151275635
Epoch: 27, Steps: 17 | Train Loss: 0.118 Vali Loss: 2.198 Vali Acc: 0.803 Test Loss: 2.198 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.150845527648926
Epoch: 28, Steps: 17 | Train Loss: 0.070 Vali Loss: 2.517 Vali Acc: 0.798 Test Loss: 2.517 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 2.40167498588562
Epoch: 29, Steps: 17 | Train Loss: 0.089 Vali Loss: 3.045 Vali Acc: 0.775 Test Loss: 3.045 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 2677283
model size : 15.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.547102451324463
Epoch: 1, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.463 Vali Acc: 0.295 Test Loss: 1.463 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 1.996842622756958
Epoch: 2, Steps: 17 | Train Loss: 1.071 Vali Loss: 0.948 Vali Acc: 0.636 Test Loss: 0.948 Test Acc: 0.636
Validation loss decreased (-0.294783 --> -0.635829).  Saving model ...
Epoch: 3 cost time: 1.8139703273773193
Epoch: 3, Steps: 17 | Train Loss: 0.737 Vali Loss: 0.907 Vali Acc: 0.665 Test Loss: 0.907 Test Acc: 0.665
Validation loss decreased (-0.635829 --> -0.664731).  Saving model ...
Epoch: 4 cost time: 2.167552947998047
Epoch: 4, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.722 Vali Acc: 0.659 Test Loss: 0.722 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.020754098892212
Epoch: 5, Steps: 17 | Train Loss: 0.321 Vali Loss: 0.690 Vali Acc: 0.751 Test Loss: 0.690 Test Acc: 0.751
Validation loss decreased (-0.664731 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 1.8643431663513184
Epoch: 6, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.582 Vali Acc: 0.803 Test Loss: 0.582 Test Acc: 0.803
Validation loss decreased (-0.751438 --> -0.803462).  Saving model ...
Epoch: 7 cost time: 2.222956418991089
Epoch: 7, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.870 Vali Acc: 0.769 Test Loss: 0.870 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.300443410873413
Epoch: 8, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.621 Vali Acc: 0.803 Test Loss: 0.621 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1242523193359375
Epoch: 9, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.699 Vali Acc: 0.786 Test Loss: 0.699 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.2607951164245605
Epoch: 10, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.037 Vali Acc: 0.780 Test Loss: 1.037 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 11 cost time: 2.140504837036133
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.491 Vali Acc: 0.763 Test Loss: 1.491 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 12 cost time: 2.082040309906006
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.166 Vali Acc: 0.786 Test Loss: 1.166 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 13 cost time: 2.276043653488159
Epoch: 13, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.082 Vali Acc: 0.832 Test Loss: 1.082 Test Acc: 0.832
Validation loss decreased (-0.803462 --> -0.832359).  Saving model ...
Epoch: 14 cost time: 2.1865596771240234
Epoch: 14, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.251 Vali Acc: 0.809 Test Loss: 1.251 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0796024799346924
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.320 Vali Acc: 0.803 Test Loss: 1.320 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0258407592773438
Epoch: 16, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.201 Vali Acc: 0.780 Test Loss: 1.201 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.303457260131836
Epoch: 17, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.925 Vali Acc: 0.827 Test Loss: 0.925 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.143681049346924
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.891 Vali Acc: 0.798 Test Loss: 0.891 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.2074570655822754
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.542 Vali Acc: 0.775 Test Loss: 1.542 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.3052492141723633
Epoch: 20, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.346 Vali Acc: 0.792 Test Loss: 1.346 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2776007652282715
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.098 Vali Acc: 0.792 Test Loss: 2.098 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.258944034576416
Epoch: 22, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.551 Vali Acc: 0.815 Test Loss: 1.551 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.6263186931610107
Epoch: 23, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.808 Vali Acc: 0.746 Test Loss: 1.808 Test Acc: 0.746
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2677283
model size : 15.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.835899829864502
Epoch: 1, Steps: 17 | Train Loss: 1.850 Vali Loss: 1.473 Vali Acc: 0.301 Test Loss: 1.473 Test Acc: 0.301
Validation loss decreased (inf --> -0.300563).  Saving model ...
Epoch: 2 cost time: 2.0138936042785645
Epoch: 2, Steps: 17 | Train Loss: 1.101 Vali Loss: 0.985 Vali Acc: 0.647 Test Loss: 0.985 Test Acc: 0.647
Validation loss decreased (-0.300563 --> -0.647389).  Saving model ...
Epoch: 3 cost time: 1.9108686447143555
Epoch: 3, Steps: 17 | Train Loss: 0.749 Vali Loss: 0.937 Vali Acc: 0.543 Test Loss: 0.937 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9600720405578613
Epoch: 4, Steps: 17 | Train Loss: 0.603 Vali Loss: 0.711 Vali Acc: 0.711 Test Loss: 0.711 Test Acc: 0.711
Validation loss decreased (-0.647389 --> -0.710976).  Saving model ...
Epoch: 5 cost time: 2.2017202377319336
Epoch: 5, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.911 Vali Acc: 0.723 Test Loss: 0.911 Test Acc: 0.723
Validation loss decreased (-0.710976 --> -0.722534).  Saving model ...
Epoch: 6 cost time: 2.0711591243743896
Epoch: 6, Steps: 17 | Train Loss: 0.290 Vali Loss: 0.742 Vali Acc: 0.775 Test Loss: 0.742 Test Acc: 0.775
Validation loss decreased (-0.722534 --> -0.774559).  Saving model ...
Epoch: 7 cost time: 2.064607620239258
Epoch: 7, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.750 Vali Acc: 0.815 Test Loss: 0.750 Test Acc: 0.815
Validation loss decreased (-0.774559 --> -0.815021).  Saving model ...
Epoch: 8 cost time: 2.2262096405029297
Epoch: 8, Steps: 17 | Train Loss: 0.152 Vali Loss: 0.797 Vali Acc: 0.803 Test Loss: 0.797 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7253892421722412
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.279 Vali Acc: 0.717 Test Loss: 1.279 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0613977909088135
Epoch: 10, Steps: 17 | Train Loss: 0.330 Vali Loss: 1.200 Vali Acc: 0.734 Test Loss: 1.200 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.353220224380493
Epoch: 11, Steps: 17 | Train Loss: 0.163 Vali Loss: 0.777 Vali Acc: 0.798 Test Loss: 0.777 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.2263965606689453
Epoch: 12, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.789 Vali Acc: 0.711 Test Loss: 1.789 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.727876901626587
Epoch: 13, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.390 Vali Acc: 0.775 Test Loss: 1.390 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.228358745574951
Epoch: 14, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.175 Vali Acc: 0.815 Test Loss: 1.175 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.228395700454712
Epoch: 15, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.198 Vali Acc: 0.746 Test Loss: 2.198 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.1149184703826904
Epoch: 16, Steps: 17 | Train Loss: 0.265 Vali Loss: 2.088 Vali Acc: 0.757 Test Loss: 2.088 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.1675565242767334
Epoch: 17, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.041 Vali Acc: 0.821 Test Loss: 1.041 Test Acc: 0.821
Validation loss decreased (-0.815021 --> -0.820799).  Saving model ...
Epoch: 18 cost time: 1.7495872974395752
Epoch: 18, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.446 Vali Acc: 0.809 Test Loss: 1.446 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.9268362522125244
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.461 Vali Acc: 0.792 Test Loss: 1.461 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.9332971572875977
Epoch: 20, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.506 Vali Acc: 0.775 Test Loss: 1.506 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.8895902633666992
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.312 Vali Acc: 0.803 Test Loss: 1.312 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.528611898422241
Epoch: 22, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.292 Vali Acc: 0.734 Test Loss: 2.292 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.2824132442474365
Epoch: 23, Steps: 17 | Train Loss: 0.127 Vali Loss: 1.822 Vali Acc: 0.780 Test Loss: 1.822 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.3153762817382812
Epoch: 24, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.413 Vali Acc: 0.838 Test Loss: 1.413 Test Acc: 0.838
Validation loss decreased (-0.820799 --> -0.838136).  Saving model ...
Epoch: 25 cost time: 2.260685682296753
Epoch: 25, Steps: 17 | Train Loss: 0.111 Vali Loss: 2.586 Vali Acc: 0.728 Test Loss: 2.586 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.0448832511901855
Epoch: 26, Steps: 17 | Train Loss: 0.411 Vali Loss: 3.620 Vali Acc: 0.751 Test Loss: 3.620 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.181720018386841
Epoch: 27, Steps: 17 | Train Loss: 0.327 Vali Loss: 2.098 Vali Acc: 0.809 Test Loss: 2.098 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.2424116134643555
Epoch: 28, Steps: 17 | Train Loss: 0.078 Vali Loss: 3.219 Vali Acc: 0.740 Test Loss: 3.219 Test Acc: 0.740
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.2217016220092773
Epoch: 29, Steps: 17 | Train Loss: 0.137 Vali Loss: 3.696 Vali Acc: 0.723 Test Loss: 3.696 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9607131481170654
Epoch: 30, Steps: 17 | Train Loss: 0.254 Vali Loss: 3.156 Vali Acc: 0.728 Test Loss: 3.156 Test Acc: 0.728
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.227318048477173
Epoch: 31, Steps: 17 | Train Loss: 0.346 Vali Loss: 3.933 Vali Acc: 0.775 Test Loss: 3.933 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.1653366088867188
Epoch: 32, Steps: 17 | Train Loss: 0.431 Vali Loss: 3.385 Vali Acc: 0.792 Test Loss: 3.385 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.2108402252197266
Epoch: 33, Steps: 17 | Train Loss: 0.101 Vali Loss: 2.858 Vali Acc: 0.780 Test Loss: 2.858 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.2081871032714844
Epoch: 34, Steps: 17 | Train Loss: 0.103 Vali Loss: 2.793 Vali Acc: 0.780 Test Loss: 2.793 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 2677283
model size : 15.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.387040138244629
Epoch: 1, Steps: 17 | Train Loss: 1.891 Vali Loss: 1.599 Vali Acc: 0.249 Test Loss: 1.599 Test Acc: 0.249
Validation loss decreased (inf --> -0.248539).  Saving model ...
Epoch: 2 cost time: 2.0721306800842285
Epoch: 2, Steps: 17 | Train Loss: 1.211 Vali Loss: 1.086 Vali Acc: 0.578 Test Loss: 1.086 Test Acc: 0.578
Validation loss decreased (-0.248539 --> -0.578024).  Saving model ...
Epoch: 3 cost time: 1.9418549537658691
Epoch: 3, Steps: 17 | Train Loss: 0.900 Vali Loss: 1.160 Vali Acc: 0.439 Test Loss: 1.160 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.6715967655181885
Epoch: 4, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.861 Vali Acc: 0.676 Test Loss: 0.861 Test Acc: 0.676
Validation loss decreased (-0.578024 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 2.212677240371704
Epoch: 5, Steps: 17 | Train Loss: 0.445 Vali Loss: 0.891 Vali Acc: 0.688 Test Loss: 0.891 Test Acc: 0.688
Validation loss decreased (-0.676292 --> -0.687852).  Saving model ...
Epoch: 6 cost time: 2.1130435466766357
Epoch: 6, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.902 Vali Acc: 0.682 Test Loss: 0.902 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.825798511505127
Epoch: 7, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.687 Vali Acc: 0.798 Test Loss: 0.687 Test Acc: 0.798
Validation loss decreased (-0.687852 --> -0.797681).  Saving model ...
Epoch: 8 cost time: 1.9248652458190918
Epoch: 8, Steps: 17 | Train Loss: 0.274 Vali Loss: 1.381 Vali Acc: 0.647 Test Loss: 1.381 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.239022970199585
Epoch: 9, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.839 Vali Acc: 0.757 Test Loss: 0.839 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.3038272857666016
Epoch: 10, Steps: 17 | Train Loss: 0.307 Vali Loss: 1.462 Vali Acc: 0.694 Test Loss: 1.462 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9764039516448975
Epoch: 11, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
Validation loss decreased (-0.797681 --> -0.797681).  Saving model ...
Epoch: 12 cost time: 2.0767717361450195
Epoch: 12, Steps: 17 | Train Loss: 0.142 Vali Loss: 1.476 Vali Acc: 0.699 Test Loss: 1.476 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1378977298736572
Epoch: 13, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.557 Vali Acc: 0.676 Test Loss: 1.557 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.175875663757324
Epoch: 14, Steps: 17 | Train Loss: 0.192 Vali Loss: 1.574 Vali Acc: 0.711 Test Loss: 1.574 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.1831791400909424
Epoch: 15, Steps: 17 | Train Loss: 0.241 Vali Loss: 2.137 Vali Acc: 0.676 Test Loss: 2.137 Test Acc: 0.676
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.109492540359497
Epoch: 16, Steps: 17 | Train Loss: 0.250 Vali Loss: 1.110 Vali Acc: 0.786 Test Loss: 1.110 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.0538506507873535
Epoch: 17, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.261 Vali Acc: 0.815 Test Loss: 1.261 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815016).  Saving model ...
Epoch: 18 cost time: 2.1048338413238525
Epoch: 18, Steps: 17 | Train Loss: 0.244 Vali Loss: 1.307 Vali Acc: 0.786 Test Loss: 1.307 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2081565856933594
Epoch: 19, Steps: 17 | Train Loss: 0.061 Vali Loss: 2.465 Vali Acc: 0.676 Test Loss: 2.465 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.002000570297241
Epoch: 20, Steps: 17 | Train Loss: 0.192 Vali Loss: 2.885 Vali Acc: 0.647 Test Loss: 2.885 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 2.1579763889312744
Epoch: 21, Steps: 17 | Train Loss: 0.398 Vali Loss: 1.545 Vali Acc: 0.763 Test Loss: 1.545 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2514054775238037
Epoch: 22, Steps: 17 | Train Loss: 0.136 Vali Loss: 2.446 Vali Acc: 0.740 Test Loss: 2.446 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9415643215179443
Epoch: 23, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.865 Vali Acc: 0.775 Test Loss: 1.865 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.091853141784668
Epoch: 24, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.830 Vali Acc: 0.757 Test Loss: 1.830 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.1784682273864746
Epoch: 25, Steps: 17 | Train Loss: 0.082 Vali Loss: 3.139 Vali Acc: 0.694 Test Loss: 3.139 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 2.1114819049835205
Epoch: 26, Steps: 17 | Train Loss: 0.314 Vali Loss: 2.332 Vali Acc: 0.775 Test Loss: 2.332 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8912158012390137
Epoch: 27, Steps: 17 | Train Loss: 0.266 Vali Loss: 1.925 Vali Acc: 0.803 Test Loss: 1.925 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 2677283
model size : 15.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.539959907531738
Epoch: 1, Steps: 17 | Train Loss: 1.824 Vali Loss: 1.557 Vali Acc: 0.272 Test Loss: 1.557 Test Acc: 0.272
Validation loss decreased (inf --> -0.271661).  Saving model ...
Epoch: 2 cost time: 2.181588888168335
Epoch: 2, Steps: 17 | Train Loss: 1.132 Vali Loss: 0.969 Vali Acc: 0.572 Test Loss: 0.969 Test Acc: 0.572
Validation loss decreased (-0.271661 --> -0.572245).  Saving model ...
Epoch: 3 cost time: 2.0223841667175293
Epoch: 3, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.934 Vali Acc: 0.630 Test Loss: 0.934 Test Acc: 0.630
Validation loss decreased (-0.572245 --> -0.630048).  Saving model ...
Epoch: 4 cost time: 2.0979833602905273
Epoch: 4, Steps: 17 | Train Loss: 0.459 Vali Loss: 0.661 Vali Acc: 0.751 Test Loss: 0.661 Test Acc: 0.751
Validation loss decreased (-0.630048 --> -0.751438).  Saving model ...
Epoch: 5 cost time: 2.208780527114868
Epoch: 5, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.734 Vali Acc: 0.751 Test Loss: 0.734 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1927783489227295
Epoch: 6, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.685 Vali Acc: 0.734 Test Loss: 0.685 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.479868173599243
Epoch: 7, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.780 Vali Acc: 0.728 Test Loss: 0.780 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.244201183319092
Epoch: 8, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.975 Vali Acc: 0.694 Test Loss: 0.975 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.0078721046447754
Epoch: 9, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.633 Vali Acc: 0.827 Test Loss: 0.633 Test Acc: 0.827
Validation loss decreased (-0.751438 --> -0.826583).  Saving model ...
Epoch: 10 cost time: 2.276327610015869
Epoch: 10, Steps: 17 | Train Loss: 0.074 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.2936973571777344
Epoch: 11, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.313 Vali Acc: 0.751 Test Loss: 1.313 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.2364752292633057
Epoch: 12, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.703 Vali Acc: 0.821 Test Loss: 0.703 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.160318613052368
Epoch: 13, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.763 Vali Acc: 0.827 Test Loss: 0.763 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.399226188659668
Epoch: 14, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.093 Vali Acc: 0.803 Test Loss: 1.093 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.501403570175171
Epoch: 15, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.231 Vali Acc: 0.786 Test Loss: 1.231 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3297810554504395
Epoch: 16, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.172 Vali Acc: 0.803 Test Loss: 1.172 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.4472060203552246
Epoch: 17, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.914 Vali Acc: 0.809 Test Loss: 0.914 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.3779897689819336
Epoch: 18, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.773 Vali Acc: 0.815 Test Loss: 0.773 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.2967982292175293
Epoch: 19, Steps: 17 | Train Loss: 0.062 Vali Loss: 1.381 Vali Acc: 0.798 Test Loss: 1.381 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 2152995
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.360522985458374
Epoch: 1, Steps: 17 | Train Loss: 1.823 Vali Loss: 1.566 Vali Acc: 0.272 Test Loss: 1.566 Test Acc: 0.272
Validation loss decreased (inf --> -0.271661).  Saving model ...
Epoch: 2 cost time: 2.252235174179077
Epoch: 2, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.012 Vali Acc: 0.584 Test Loss: 1.012 Test Acc: 0.584
Validation loss decreased (-0.271661 --> -0.583805).  Saving model ...
Epoch: 3 cost time: 2.3526217937469482
Epoch: 3, Steps: 17 | Train Loss: 0.689 Vali Loss: 0.928 Vali Acc: 0.624 Test Loss: 0.928 Test Acc: 0.624
Validation loss decreased (-0.583805 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 2.324481725692749
Epoch: 4, Steps: 17 | Train Loss: 0.501 Vali Loss: 0.738 Vali Acc: 0.728 Test Loss: 0.738 Test Acc: 0.728
Validation loss decreased (-0.624268 --> -0.728316).  Saving model ...
Epoch: 5 cost time: 2.1597368717193604
Epoch: 5, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.589 Vali Acc: 0.792 Test Loss: 0.589 Test Acc: 0.792
Validation loss decreased (-0.728316 --> -0.791902).  Saving model ...
Epoch: 6 cost time: 2.1776223182678223
Epoch: 6, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.829 Vali Acc: 0.717 Test Loss: 0.829 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2862014770507812
Epoch: 7, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.571 Vali Acc: 0.821 Test Loss: 0.571 Test Acc: 0.821
Validation loss decreased (-0.791902 --> -0.820804).  Saving model ...
Epoch: 8 cost time: 2.2555594444274902
Epoch: 8, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.331 Vali Acc: 0.723 Test Loss: 1.331 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.1133346557617188
Epoch: 9, Steps: 17 | Train Loss: 0.243 Vali Loss: 0.922 Vali Acc: 0.746 Test Loss: 0.922 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.342867374420166
Epoch: 10, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.978503942489624
Epoch: 11, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.055 Vali Acc: 0.751 Test Loss: 1.055 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.1624770164489746
Epoch: 12, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.789 Vali Acc: 0.832 Test Loss: 0.789 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832362).  Saving model ...
Epoch: 13 cost time: 2.3070247173309326
Epoch: 13, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.888 Vali Acc: 0.821 Test Loss: 0.888 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.238950252532959
Epoch: 14, Steps: 17 | Train Loss: 0.136 Vali Loss: 1.158 Vali Acc: 0.798 Test Loss: 1.158 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.165102243423462
Epoch: 15, Steps: 17 | Train Loss: 0.174 Vali Loss: 1.571 Vali Acc: 0.786 Test Loss: 1.571 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.26277232170105
Epoch: 16, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.270 Vali Acc: 0.607 Test Loss: 2.270 Test Acc: 0.607
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 2.137570858001709
Epoch: 17, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.765 Vali Acc: 0.734 Test Loss: 1.765 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.239046573638916
Epoch: 18, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.963 Vali Acc: 0.855 Test Loss: 0.963 Test Acc: 0.855
Validation loss decreased (-0.832362 --> -0.855482).  Saving model ...
Epoch: 19 cost time: 2.184265375137329
Epoch: 19, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.335 Vali Acc: 0.809 Test Loss: 1.335 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.3254737854003906
Epoch: 20, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.927 Vali Acc: 0.850 Test Loss: 0.927 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1768476963043213
Epoch: 21, Steps: 17 | Train Loss: 0.056 Vali Loss: 1.888 Vali Acc: 0.844 Test Loss: 1.888 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.24998140335083
Epoch: 22, Steps: 17 | Train Loss: 0.267 Vali Loss: 1.368 Vali Acc: 0.844 Test Loss: 1.368 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 2.229762077331543
Epoch: 23, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.537 Vali Acc: 0.792 Test Loss: 1.537 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 2.1127355098724365
Epoch: 24, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.767 Vali Acc: 0.827 Test Loss: 1.767 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 2.176335096359253
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.661 Vali Acc: 0.786 Test Loss: 1.661 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 2.42004656791687
Epoch: 26, Steps: 17 | Train Loss: 0.104 Vali Loss: 2.771 Vali Acc: 0.763 Test Loss: 2.771 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.2347066402435303
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.657 Vali Acc: 0.832 Test Loss: 1.657 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.211733818054199
Epoch: 28, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.851 Vali Acc: 0.803 Test Loss: 1.851 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 2152995
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.544192552566528
Epoch: 1, Steps: 17 | Train Loss: 1.845 Vali Loss: 1.581 Vali Acc: 0.266 Test Loss: 1.581 Test Acc: 0.266
Validation loss decreased (inf --> -0.265880).  Saving model ...
Epoch: 2 cost time: 2.1071701049804688
Epoch: 2, Steps: 17 | Train Loss: 1.177 Vali Loss: 1.117 Vali Acc: 0.514 Test Loss: 1.117 Test Acc: 0.514
Validation loss decreased (-0.265880 --> -0.514440).  Saving model ...
Epoch: 3 cost time: 2.0901315212249756
Epoch: 3, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.880 Vali Acc: 0.647 Test Loss: 0.880 Test Acc: 0.647
Validation loss decreased (-0.514440 --> -0.647390).  Saving model ...
Epoch: 4 cost time: 2.1525442600250244
Epoch: 4, Steps: 17 | Train Loss: 0.546 Vali Loss: 0.791 Vali Acc: 0.688 Test Loss: 0.791 Test Acc: 0.688
Validation loss decreased (-0.647390 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 1.9964995384216309
Epoch: 5, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.713 Vali Acc: 0.769 Test Loss: 0.713 Test Acc: 0.769
Validation loss decreased (-0.687853 --> -0.768779).  Saving model ...
Epoch: 6 cost time: 2.132157564163208
Epoch: 6, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.880 Vali Acc: 0.671 Test Loss: 0.880 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2149248123168945
Epoch: 7, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.558 Vali Acc: 0.809 Test Loss: 0.558 Test Acc: 0.809
Validation loss decreased (-0.768779 --> -0.809243).  Saving model ...
Epoch: 8 cost time: 2.016390085220337
Epoch: 8, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.185 Vali Acc: 0.676 Test Loss: 1.185 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.031925678253174
Epoch: 9, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.668 Vali Acc: 0.803 Test Loss: 0.668 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.312838077545166
Epoch: 10, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.878 Vali Acc: 0.775 Test Loss: 0.878 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.011686325073242
Epoch: 11, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.699 Vali Acc: 0.809 Test Loss: 0.699 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 2.241658926010132
Epoch: 12, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.005 Vali Acc: 0.751 Test Loss: 1.005 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.3527791500091553
Epoch: 13, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.310 Vali Acc: 0.734 Test Loss: 1.310 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.298590660095215
Epoch: 14, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.213 Vali Acc: 0.763 Test Loss: 1.213 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 2.1204993724823
Epoch: 15, Steps: 17 | Train Loss: 0.192 Vali Loss: 0.967 Vali Acc: 0.832 Test Loss: 0.967 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832360).  Saving model ...
Epoch: 16 cost time: 2.2617180347442627
Epoch: 16, Steps: 17 | Train Loss: 0.106 Vali Loss: 1.137 Vali Acc: 0.798 Test Loss: 1.137 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9778916835784912
Epoch: 17, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.235 Vali Acc: 0.786 Test Loss: 1.235 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.0759832859039307
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.505 Vali Acc: 0.780 Test Loss: 1.505 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.097383975982666
Epoch: 19, Steps: 17 | Train Loss: 0.108 Vali Loss: 2.035 Vali Acc: 0.734 Test Loss: 2.035 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.323930501937866
Epoch: 20, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.963 Vali Acc: 0.809 Test Loss: 1.963 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.487072229385376
Epoch: 21, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.516 Vali Acc: 0.827 Test Loss: 1.516 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.2628262042999268
Epoch: 22, Steps: 17 | Train Loss: 0.252 Vali Loss: 3.181 Vali Acc: 0.780 Test Loss: 3.181 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.4095356464385986
Epoch: 23, Steps: 17 | Train Loss: 0.184 Vali Loss: 2.716 Vali Acc: 0.757 Test Loss: 2.716 Test Acc: 0.757
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.4210829734802246
Epoch: 24, Steps: 17 | Train Loss: 0.222 Vali Loss: 2.618 Vali Acc: 0.763 Test Loss: 2.618 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0751914978027344
Epoch: 25, Steps: 17 | Train Loss: 0.119 Vali Loss: 2.872 Vali Acc: 0.815 Test Loss: 2.872 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 2152995
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.162337303161621
Epoch: 1, Steps: 17 | Train Loss: 1.867 Vali Loss: 1.724 Vali Acc: 0.266 Test Loss: 1.724 Test Acc: 0.266
Validation loss decreased (inf --> -0.265879).  Saving model ...
Epoch: 2 cost time: 1.9678747653961182
Epoch: 2, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.235 Vali Acc: 0.428 Test Loss: 1.235 Test Acc: 0.428
Validation loss decreased (-0.265879 --> -0.427733).  Saving model ...
Epoch: 3 cost time: 1.9490153789520264
Epoch: 3, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.940 Vali Acc: 0.676 Test Loss: 0.940 Test Acc: 0.676
Validation loss decreased (-0.427733 --> -0.676291).  Saving model ...
Epoch: 4 cost time: 1.8765223026275635
Epoch: 4, Steps: 17 | Train Loss: 0.710 Vali Loss: 0.815 Vali Acc: 0.676 Test Loss: 0.815 Test Acc: 0.676
Validation loss decreased (-0.676291 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 2.1407723426818848
Epoch: 5, Steps: 17 | Train Loss: 0.438 Vali Loss: 0.705 Vali Acc: 0.746 Test Loss: 0.705 Test Acc: 0.746
Validation loss decreased (-0.676292 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 1.9789373874664307
Epoch: 6, Steps: 17 | Train Loss: 0.370 Vali Loss: 1.017 Vali Acc: 0.665 Test Loss: 1.017 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0900754928588867
Epoch: 7, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.638 Vali Acc: 0.757 Test Loss: 0.638 Test Acc: 0.757
Validation loss decreased (-0.745658 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 1.951052188873291
Epoch: 8, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.967 Vali Acc: 0.665 Test Loss: 0.967 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.076758623123169
Epoch: 9, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.825 Vali Acc: 0.711 Test Loss: 0.825 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0020864009857178
Epoch: 10, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.703 Vali Acc: 0.798 Test Loss: 0.703 Test Acc: 0.798
Validation loss decreased (-0.757219 --> -0.797681).  Saving model ...
Epoch: 11 cost time: 1.9359791278839111
Epoch: 11, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.137 Vali Acc: 0.734 Test Loss: 1.137 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1230483055114746
Epoch: 12, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.401 Vali Acc: 0.723 Test Loss: 1.401 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9627265930175781
Epoch: 13, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.863 Vali Acc: 0.798 Test Loss: 0.863 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.0626025199890137
Epoch: 14, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.099 Vali Acc: 0.757 Test Loss: 1.099 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.320404291152954
Epoch: 15, Steps: 17 | Train Loss: 0.302 Vali Loss: 1.578 Vali Acc: 0.723 Test Loss: 1.578 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.7365069389343262
Epoch: 16, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.774 Vali Acc: 0.775 Test Loss: 1.774 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.185100555419922
Epoch: 17, Steps: 17 | Train Loss: 0.425 Vali Loss: 2.512 Vali Acc: 0.653 Test Loss: 2.512 Test Acc: 0.653
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.0949580669403076
Epoch: 18, Steps: 17 | Train Loss: 0.468 Vali Loss: 3.225 Vali Acc: 0.636 Test Loss: 3.225 Test Acc: 0.636
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.3736464977264404
Epoch: 19, Steps: 17 | Train Loss: 0.437 Vali Loss: 1.599 Vali Acc: 0.717 Test Loss: 1.599 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1192033290863037
Epoch: 20, Steps: 17 | Train Loss: 0.168 Vali Loss: 1.654 Vali Acc: 0.705 Test Loss: 1.654 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.7976878612716763
model parameter : 2152995
model size : 13.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.744236707687378
Epoch: 1, Steps: 17 | Train Loss: 1.745 Vali Loss: 1.328 Vali Acc: 0.439 Test Loss: 1.328 Test Acc: 0.439
Validation loss decreased (inf --> -0.439293).  Saving model ...
Epoch: 2 cost time: 2.0895657539367676
Epoch: 2, Steps: 17 | Train Loss: 1.050 Vali Loss: 1.156 Vali Acc: 0.497 Test Loss: 1.156 Test Acc: 0.497
Validation loss decreased (-0.439293 --> -0.497098).  Saving model ...
Epoch: 3 cost time: 1.9527878761291504
Epoch: 3, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.866 Vali Acc: 0.630 Test Loss: 0.866 Test Acc: 0.630
Validation loss decreased (-0.497098 --> -0.630049).  Saving model ...
Epoch: 4 cost time: 1.9236323833465576
Epoch: 4, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.979 Vali Acc: 0.711 Test Loss: 0.979 Test Acc: 0.711
Validation loss decreased (-0.630049 --> -0.710973).  Saving model ...
Epoch: 5 cost time: 1.7740585803985596
Epoch: 5, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.830 Vali Acc: 0.699 Test Loss: 0.830 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7238452434539795
Epoch: 6, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.906 Vali Acc: 0.734 Test Loss: 0.906 Test Acc: 0.734
Validation loss decreased (-0.710973 --> -0.734095).  Saving model ...
Epoch: 7 cost time: 1.658658504486084
Epoch: 7, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.644 Vali Acc: 0.775 Test Loss: 0.644 Test Acc: 0.775
Validation loss decreased (-0.734095 --> -0.774560).  Saving model ...
Epoch: 8 cost time: 2.236788511276245
Epoch: 8, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.802 Vali Acc: 0.751 Test Loss: 0.802 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0694327354431152
Epoch: 9, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.543 Vali Acc: 0.850 Test Loss: 0.543 Test Acc: 0.850
Validation loss decreased (-0.774560 --> -0.849706).  Saving model ...
Epoch: 10 cost time: 2.0137178897857666
Epoch: 10, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.962 Vali Acc: 0.815 Test Loss: 0.962 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0674824714660645
Epoch: 11, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.902 Vali Acc: 0.821 Test Loss: 0.902 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.0734286308288574
Epoch: 12, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.803 Vali Acc: 0.803 Test Loss: 0.803 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0977861881256104
Epoch: 13, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.994 Vali Acc: 0.798 Test Loss: 0.994 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.0323922634124756
Epoch: 14, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.022 Vali Acc: 0.786 Test Loss: 2.022 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.0109634399414062
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.341 Vali Acc: 0.792 Test Loss: 1.341 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3413538932800293
Epoch: 16, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.262 Vali Acc: 0.798 Test Loss: 1.262 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.281639575958252
Epoch: 17, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.150 Vali Acc: 0.815 Test Loss: 1.150 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 1.8750531673431396
Epoch: 18, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.964 Vali Acc: 0.792 Test Loss: 1.964 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.187039375305176
Epoch: 19, Steps: 17 | Train Loss: 0.163 Vali Loss: 1.200 Vali Acc: 0.809 Test Loss: 1.200 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1890851
model size : 12.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.192572355270386
Epoch: 1, Steps: 17 | Train Loss: 1.736 Vali Loss: 1.319 Vali Acc: 0.457 Test Loss: 1.319 Test Acc: 0.457
Validation loss decreased (inf --> -0.456634).  Saving model ...
Epoch: 2 cost time: 2.0694801807403564
Epoch: 2, Steps: 17 | Train Loss: 1.065 Vali Loss: 1.174 Vali Acc: 0.532 Test Loss: 1.174 Test Acc: 0.532
Validation loss decreased (-0.456634 --> -0.531780).  Saving model ...
Epoch: 3 cost time: 2.158233880996704
Epoch: 3, Steps: 17 | Train Loss: 0.758 Vali Loss: 0.857 Vali Acc: 0.659 Test Loss: 0.857 Test Acc: 0.659
Validation loss decreased (-0.531780 --> -0.658951).  Saving model ...
Epoch: 4 cost time: 2.133732795715332
Epoch: 4, Steps: 17 | Train Loss: 0.438 Vali Loss: 1.007 Vali Acc: 0.699 Test Loss: 1.007 Test Acc: 0.699
Validation loss decreased (-0.658951 --> -0.699412).  Saving model ...
Epoch: 5 cost time: 2.132477283477783
Epoch: 5, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.937 Vali Acc: 0.665 Test Loss: 0.937 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.3146393299102783
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.934 Vali Acc: 0.723 Test Loss: 0.934 Test Acc: 0.723
Validation loss decreased (-0.699412 --> -0.722534).  Saving model ...
Epoch: 7 cost time: 2.1684257984161377
Epoch: 7, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.913 Vali Acc: 0.751 Test Loss: 0.913 Test Acc: 0.751
Validation loss decreased (-0.722534 --> -0.751436).  Saving model ...
Epoch: 8 cost time: 2.2949564456939697
Epoch: 8, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.876 Vali Acc: 0.769 Test Loss: 0.876 Test Acc: 0.769
Validation loss decreased (-0.751436 --> -0.768777).  Saving model ...
Epoch: 9 cost time: 2.170565605163574
Epoch: 9, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.737 Vali Acc: 0.775 Test Loss: 0.737 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774559).  Saving model ...
Epoch: 10 cost time: 2.225736379623413
Epoch: 10, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.715 Vali Acc: 0.844 Test Loss: 0.715 Test Acc: 0.844
Validation loss decreased (-0.774559 --> -0.843923).  Saving model ...
Epoch: 11 cost time: 2.166055202484131
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.241 Vali Acc: 0.723 Test Loss: 1.241 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.104146718978882
Epoch: 12, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.100 Vali Acc: 0.786 Test Loss: 1.100 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1621806621551514
Epoch: 13, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.540 Vali Acc: 0.734 Test Loss: 1.540 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1692216396331787
Epoch: 14, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.473 Vali Acc: 0.757 Test Loss: 1.473 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9050025939941406
Epoch: 15, Steps: 17 | Train Loss: 0.170 Vali Loss: 2.234 Vali Acc: 0.734 Test Loss: 2.234 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.190627098083496
Epoch: 16, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.439 Vali Acc: 0.780 Test Loss: 1.439 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8573055267333984
Epoch: 17, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.674 Vali Acc: 0.792 Test Loss: 1.674 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.2492942810058594
Epoch: 18, Steps: 17 | Train Loss: 0.209 Vali Loss: 1.280 Vali Acc: 0.821 Test Loss: 1.280 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 2.131655216217041
Epoch: 19, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.316 Vali Acc: 0.798 Test Loss: 1.316 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.989135980606079
Epoch: 20, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.648 Vali Acc: 0.798 Test Loss: 1.648 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1890851
model size : 12.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.278855562210083
Epoch: 1, Steps: 17 | Train Loss: 1.752 Vali Loss: 1.317 Vali Acc: 0.474 Test Loss: 1.317 Test Acc: 0.474
Validation loss decreased (inf --> -0.473975).  Saving model ...
Epoch: 2 cost time: 2.067983865737915
Epoch: 2, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.187 Vali Acc: 0.514 Test Loss: 1.187 Test Acc: 0.514
Validation loss decreased (-0.473975 --> -0.514439).  Saving model ...
Epoch: 3 cost time: 2.0762107372283936
Epoch: 3, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.912 Vali Acc: 0.647 Test Loss: 0.912 Test Acc: 0.647
Validation loss decreased (-0.514439 --> -0.647390).  Saving model ...
Epoch: 4 cost time: 2.081339120864868
Epoch: 4, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.852 Vali Acc: 0.711 Test Loss: 0.852 Test Acc: 0.711
Validation loss decreased (-0.647390 --> -0.710974).  Saving model ...
Epoch: 5 cost time: 2.166544198989868
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.937 Vali Acc: 0.659 Test Loss: 0.937 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.046557903289795
Epoch: 6, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.938 Vali Acc: 0.705 Test Loss: 0.938 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.0652012825012207
Epoch: 7, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.044 Vali Acc: 0.717 Test Loss: 1.044 Test Acc: 0.717
Validation loss decreased (-0.710974 --> -0.716753).  Saving model ...
Epoch: 8 cost time: 2.1339287757873535
Epoch: 8, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.619 Vali Acc: 0.803 Test Loss: 0.619 Test Acc: 0.803
Validation loss decreased (-0.716753 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 2.051755666732788
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 1.013 Vali Acc: 0.763 Test Loss: 1.013 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.208223342895508
Epoch: 10, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.767 Vali Acc: 0.815 Test Loss: 0.767 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815021).  Saving model ...
Epoch: 11 cost time: 2.07600474357605
Epoch: 11, Steps: 17 | Train Loss: 0.133 Vali Loss: 1.803 Vali Acc: 0.659 Test Loss: 1.803 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.0679259300231934
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.748 Vali Acc: 0.827 Test Loss: 0.748 Test Acc: 0.827
Validation loss decreased (-0.815021 --> -0.826582).  Saving model ...
Epoch: 13 cost time: 2.0236501693725586
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.863 Vali Acc: 0.757 Test Loss: 0.863 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.1130197048187256
Epoch: 14, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.142 Vali Acc: 0.763 Test Loss: 1.142 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.12917423248291
Epoch: 15, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.160 Vali Acc: 0.798 Test Loss: 1.160 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.1742072105407715
Epoch: 16, Steps: 17 | Train Loss: 0.254 Vali Loss: 1.585 Vali Acc: 0.786 Test Loss: 1.585 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.771658182144165
Epoch: 17, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.398 Vali Acc: 0.792 Test Loss: 1.398 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.149818181991577
Epoch: 18, Steps: 17 | Train Loss: 0.130 Vali Loss: 2.188 Vali Acc: 0.769 Test Loss: 2.188 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0998754501342773
Epoch: 19, Steps: 17 | Train Loss: 0.262 Vali Loss: 2.433 Vali Acc: 0.699 Test Loss: 2.433 Test Acc: 0.699
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.1512551307678223
Epoch: 20, Steps: 17 | Train Loss: 0.277 Vali Loss: 2.580 Vali Acc: 0.769 Test Loss: 2.580 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 2.0249712467193604
Epoch: 21, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.361 Vali Acc: 0.798 Test Loss: 1.361 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9285423755645752
Epoch: 22, Steps: 17 | Train Loss: 0.193 Vali Loss: 2.971 Vali Acc: 0.763 Test Loss: 2.971 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 1890851
model size : 12.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.113641262054443
Epoch: 1, Steps: 17 | Train Loss: 1.814 Vali Loss: 1.455 Vali Acc: 0.382 Test Loss: 1.455 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 1.9155020713806152
Epoch: 2, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.280 Vali Acc: 0.434 Test Loss: 1.280 Test Acc: 0.434
Validation loss decreased (-0.381488 --> -0.433513).  Saving model ...
Epoch: 3 cost time: 2.1886794567108154
Epoch: 3, Steps: 17 | Train Loss: 0.917 Vali Loss: 1.016 Vali Acc: 0.555 Test Loss: 1.016 Test Acc: 0.555
Validation loss decreased (-0.433513 --> -0.554903).  Saving model ...
Epoch: 4 cost time: 2.3520755767822266
Epoch: 4, Steps: 17 | Train Loss: 0.669 Vali Loss: 0.919 Vali Acc: 0.584 Test Loss: 0.919 Test Acc: 0.584
Validation loss decreased (-0.554903 --> -0.583806).  Saving model ...
Epoch: 5 cost time: 2.209305763244629
Epoch: 5, Steps: 17 | Train Loss: 0.462 Vali Loss: 0.709 Vali Acc: 0.711 Test Loss: 0.709 Test Acc: 0.711
Validation loss decreased (-0.583806 --> -0.710976).  Saving model ...
Epoch: 6 cost time: 2.154583692550659
Epoch: 6, Steps: 17 | Train Loss: 0.392 Vali Loss: 1.028 Vali Acc: 0.653 Test Loss: 1.028 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.283752918243408
Epoch: 7, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.665 Vali Acc: 0.757 Test Loss: 0.665 Test Acc: 0.757
Validation loss decreased (-0.710976 --> -0.757219).  Saving model ...
Epoch: 8 cost time: 1.9877550601959229
Epoch: 8, Steps: 17 | Train Loss: 0.298 Vali Loss: 0.802 Vali Acc: 0.728 Test Loss: 0.802 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8619701862335205
Epoch: 9, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.033 Vali Acc: 0.723 Test Loss: 1.033 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2402055263519287
Epoch: 10, Steps: 17 | Train Loss: 0.151 Vali Loss: 0.815 Vali Acc: 0.734 Test Loss: 0.815 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 2.1044437885284424
Epoch: 11, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.861 Vali Acc: 0.751 Test Loss: 0.861 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.8996422290802002
Epoch: 12, Steps: 17 | Train Loss: 0.298 Vali Loss: 1.396 Vali Acc: 0.699 Test Loss: 1.396 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.333102226257324
Epoch: 13, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.818 Vali Acc: 0.786 Test Loss: 0.818 Test Acc: 0.786
Validation loss decreased (-0.757219 --> -0.786119).  Saving model ...
Epoch: 14 cost time: 2.1127192974090576
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.246 Vali Acc: 0.763 Test Loss: 1.246 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9688434600830078
Epoch: 15, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.470 Vali Acc: 0.769 Test Loss: 1.470 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.465106725692749
Epoch: 16, Steps: 17 | Train Loss: 0.159 Vali Loss: 2.290 Vali Acc: 0.647 Test Loss: 2.290 Test Acc: 0.647
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.205386161804199
Epoch: 17, Steps: 17 | Train Loss: 0.312 Vali Loss: 1.511 Vali Acc: 0.757 Test Loss: 1.511 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.850496768951416
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.087 Vali Acc: 0.803 Test Loss: 1.087 Test Acc: 0.803
Validation loss decreased (-0.786119 --> -0.803457).  Saving model ...
Epoch: 19 cost time: 2.41994047164917
Epoch: 19, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.247 Vali Acc: 0.792 Test Loss: 1.247 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.2077598571777344
Epoch: 20, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.960 Vali Acc: 0.694 Test Loss: 1.960 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.2968056201934814
Epoch: 21, Steps: 17 | Train Loss: 0.212 Vali Loss: 1.288 Vali Acc: 0.832 Test Loss: 1.288 Test Acc: 0.832
Validation loss decreased (-0.803457 --> -0.832357).  Saving model ...
Epoch: 22 cost time: 2.1185240745544434
Epoch: 22, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.650 Vali Acc: 0.850 Test Loss: 1.650 Test Acc: 0.850
Validation loss decreased (-0.832357 --> -0.849694).  Saving model ...
Epoch: 23 cost time: 2.0855233669281006
Epoch: 23, Steps: 17 | Train Loss: 0.233 Vali Loss: 2.300 Vali Acc: 0.723 Test Loss: 2.300 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.1218481063842773
Epoch: 24, Steps: 17 | Train Loss: 0.352 Vali Loss: 2.710 Vali Acc: 0.763 Test Loss: 2.710 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 2.159916639328003
Epoch: 25, Steps: 17 | Train Loss: 0.355 Vali Loss: 2.094 Vali Acc: 0.786 Test Loss: 2.094 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.9819214344024658
Epoch: 26, Steps: 17 | Train Loss: 0.287 Vali Loss: 2.651 Vali Acc: 0.815 Test Loss: 2.651 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.933762788772583
Epoch: 27, Steps: 17 | Train Loss: 0.379 Vali Loss: 2.701 Vali Acc: 0.751 Test Loss: 2.701 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 2.117741584777832
Epoch: 28, Steps: 17 | Train Loss: 0.240 Vali Loss: 3.217 Vali Acc: 0.740 Test Loss: 3.217 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.9708547592163086
Epoch: 29, Steps: 17 | Train Loss: 0.098 Vali Loss: 3.142 Vali Acc: 0.734 Test Loss: 3.142 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 2.1489484310150146
Epoch: 30, Steps: 17 | Train Loss: 0.141 Vali Loss: 2.783 Vali Acc: 0.723 Test Loss: 2.783 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.125495433807373
Epoch: 31, Steps: 17 | Train Loss: 0.082 Vali Loss: 2.662 Vali Acc: 0.786 Test Loss: 2.662 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.086542844772339
Epoch: 32, Steps: 17 | Train Loss: 0.087 Vali Loss: 2.638 Vali Acc: 0.798 Test Loss: 2.638 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1890851
model size : 12.11MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.035213232040405
Epoch: 1, Steps: 17 | Train Loss: 1.777 Vali Loss: 1.308 Vali Acc: 0.370 Test Loss: 1.308 Test Acc: 0.370
Validation loss decreased (inf --> -0.369929).  Saving model ...
Epoch: 2 cost time: 2.2342569828033447
Epoch: 2, Steps: 17 | Train Loss: 1.113 Vali Loss: 1.093 Vali Acc: 0.555 Test Loss: 1.093 Test Acc: 0.555
Validation loss decreased (-0.369929 --> -0.554902).  Saving model ...
Epoch: 3 cost time: 2.1732113361358643
Epoch: 3, Steps: 17 | Train Loss: 0.765 Vali Loss: 1.413 Vali Acc: 0.538 Test Loss: 1.413 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 2.062582015991211
Epoch: 4, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.719 Vali Acc: 0.723 Test Loss: 0.719 Test Acc: 0.723
Validation loss decreased (-0.554902 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 2.1964337825775146
Epoch: 5, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.706 Vali Acc: 0.711 Test Loss: 0.706 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.057347059249878
Epoch: 6, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.963 Vali Acc: 0.711 Test Loss: 0.963 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1870627403259277
Epoch: 7, Steps: 17 | Train Loss: 0.292 Vali Loss: 0.900 Vali Acc: 0.763 Test Loss: 0.900 Test Acc: 0.763
Validation loss decreased (-0.722536 --> -0.762997).  Saving model ...
Epoch: 8 cost time: 2.1836047172546387
Epoch: 8, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.604 Vali Acc: 0.832 Test Loss: 0.604 Test Acc: 0.832
Validation loss decreased (-0.762997 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 2.05226731300354
Epoch: 9, Steps: 17 | Train Loss: 0.128 Vali Loss: 1.172 Vali Acc: 0.711 Test Loss: 1.172 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.765906572341919
Epoch: 10, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.836 Vali Acc: 0.763 Test Loss: 0.836 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0019614696502686
Epoch: 11, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.770 Vali Acc: 0.827 Test Loss: 0.770 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1016013622283936
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.886 Vali Acc: 0.786 Test Loss: 0.886 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1384835243225098
Epoch: 13, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.277 Vali Acc: 0.775 Test Loss: 1.277 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1079859733581543
Epoch: 14, Steps: 17 | Train Loss: 0.211 Vali Loss: 1.360 Vali Acc: 0.769 Test Loss: 1.360 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9535224437713623
Epoch: 15, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.888 Vali Acc: 0.861 Test Loss: 0.888 Test Acc: 0.861
Validation loss decreased (-0.832364 --> -0.861263).  Saving model ...
Epoch: 16 cost time: 2.087148427963257
Epoch: 16, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.404 Vali Acc: 0.751 Test Loss: 1.404 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.2478599548339844
Epoch: 17, Steps: 17 | Train Loss: 0.092 Vali Loss: 2.073 Vali Acc: 0.746 Test Loss: 2.073 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2585761547088623
Epoch: 18, Steps: 17 | Train Loss: 0.165 Vali Loss: 1.548 Vali Acc: 0.763 Test Loss: 1.548 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.20143461227417
Epoch: 19, Steps: 17 | Train Loss: 0.056 Vali Loss: 2.129 Vali Acc: 0.775 Test Loss: 2.129 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.1408402919769287
Epoch: 20, Steps: 17 | Train Loss: 0.240 Vali Loss: 1.587 Vali Acc: 0.792 Test Loss: 1.587 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9276950359344482
Epoch: 21, Steps: 17 | Train Loss: 0.123 Vali Loss: 3.058 Vali Acc: 0.734 Test Loss: 3.058 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.3720879554748535
Epoch: 22, Steps: 17 | Train Loss: 0.169 Vali Loss: 2.285 Vali Acc: 0.769 Test Loss: 2.285 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.9879956245422363
Epoch: 23, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.951 Vali Acc: 0.815 Test Loss: 1.951 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.118459463119507
Epoch: 24, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.150 Vali Acc: 0.746 Test Loss: 2.150 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.16555118560791
Epoch: 25, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.924 Vali Acc: 0.763 Test Loss: 1.924 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1759779
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.348602771759033
Epoch: 1, Steps: 17 | Train Loss: 1.788 Vali Loss: 1.314 Vali Acc: 0.358 Test Loss: 1.314 Test Acc: 0.358
Validation loss decreased (inf --> -0.358368).  Saving model ...
Epoch: 2 cost time: 2.289421319961548
Epoch: 2, Steps: 17 | Train Loss: 1.128 Vali Loss: 1.113 Vali Acc: 0.543 Test Loss: 1.113 Test Acc: 0.543
Validation loss decreased (-0.358368 --> -0.543341).  Saving model ...
Epoch: 3 cost time: 1.8567264080047607
Epoch: 3, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.499 Vali Acc: 0.532 Test Loss: 1.499 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9266357421875
Epoch: 4, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.752 Vali Acc: 0.699 Test Loss: 0.752 Test Acc: 0.699
Validation loss decreased (-0.543341 --> -0.699414).  Saving model ...
Epoch: 5 cost time: 1.7819418907165527
Epoch: 5, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.701 Vali Acc: 0.717 Test Loss: 0.701 Test Acc: 0.717
Validation loss decreased (-0.699414 --> -0.716756).  Saving model ...
Epoch: 6 cost time: 1.8077306747436523
Epoch: 6, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.936 Vali Acc: 0.699 Test Loss: 0.936 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8800904750823975
Epoch: 7, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.883 Vali Acc: 0.757 Test Loss: 0.883 Test Acc: 0.757
Validation loss decreased (-0.716756 --> -0.757217).  Saving model ...
Epoch: 8 cost time: 2.2931675910949707
Epoch: 8, Steps: 17 | Train Loss: 0.219 Vali Loss: 0.486 Vali Acc: 0.838 Test Loss: 0.486 Test Acc: 0.838
Validation loss decreased (-0.757217 --> -0.838145).  Saving model ...
Epoch: 9 cost time: 2.3982396125793457
Epoch: 9, Steps: 17 | Train Loss: 0.129 Vali Loss: 1.141 Vali Acc: 0.740 Test Loss: 1.141 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1584112644195557
Epoch: 10, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.937 Vali Acc: 0.792 Test Loss: 0.937 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.4201877117156982
Epoch: 11, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.822 Vali Acc: 0.803 Test Loss: 0.822 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.347923755645752
Epoch: 12, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.089 Vali Acc: 0.809 Test Loss: 1.089 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1626813411712646
Epoch: 13, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.196 Vali Acc: 0.757 Test Loss: 1.196 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.2322070598602295
Epoch: 14, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.246 Vali Acc: 0.769 Test Loss: 1.246 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.2981033325195312
Epoch: 15, Steps: 17 | Train Loss: 0.151 Vali Loss: 2.350 Vali Acc: 0.717 Test Loss: 2.350 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.077989339828491
Epoch: 16, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.708 Vali Acc: 0.769 Test Loss: 1.708 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1964921951293945
Epoch: 17, Steps: 17 | Train Loss: 0.121 Vali Loss: 1.345 Vali Acc: 0.792 Test Loss: 1.345 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.127565622329712
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.698 Vali Acc: 0.798 Test Loss: 1.698 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1759779
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.493593454360962
Epoch: 1, Steps: 17 | Train Loss: 1.805 Vali Loss: 1.344 Vali Acc: 0.329 Test Loss: 1.344 Test Acc: 0.329
Validation loss decreased (inf --> -0.329466).  Saving model ...
Epoch: 2 cost time: 2.0646393299102783
Epoch: 2, Steps: 17 | Train Loss: 1.160 Vali Loss: 1.144 Vali Acc: 0.520 Test Loss: 1.144 Test Acc: 0.520
Validation loss decreased (-0.329466 --> -0.520220).  Saving model ...
Epoch: 3 cost time: 2.100450038909912
Epoch: 3, Steps: 17 | Train Loss: 0.830 Vali Loss: 1.513 Vali Acc: 0.514 Test Loss: 1.513 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.9327077865600586
Epoch: 4, Steps: 17 | Train Loss: 0.616 Vali Loss: 0.815 Vali Acc: 0.682 Test Loss: 0.815 Test Acc: 0.682
Validation loss decreased (-0.520220 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 1.9949705600738525
Epoch: 5, Steps: 17 | Train Loss: 0.425 Vali Loss: 0.721 Vali Acc: 0.711 Test Loss: 0.721 Test Acc: 0.711
Validation loss decreased (-0.682073 --> -0.710975).  Saving model ...
Epoch: 6 cost time: 1.9675815105438232
Epoch: 6, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.840 Vali Acc: 0.728 Test Loss: 0.840 Test Acc: 0.728
Validation loss decreased (-0.710975 --> -0.728315).  Saving model ...
Epoch: 7 cost time: 2.0784430503845215
Epoch: 7, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.931 Vali Acc: 0.734 Test Loss: 0.931 Test Acc: 0.734
Validation loss decreased (-0.728315 --> -0.734095).  Saving model ...
Epoch: 8 cost time: 2.2593178749084473
Epoch: 8, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.652 Vali Acc: 0.815 Test Loss: 0.652 Test Acc: 0.815
Validation loss decreased (-0.734095 --> -0.815022).  Saving model ...
Epoch: 9 cost time: 2.156186819076538
Epoch: 9, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.001 Vali Acc: 0.757 Test Loss: 1.001 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1566925048828125
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 1.139 Vali Acc: 0.769 Test Loss: 1.139 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.172086238861084
Epoch: 11, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.207 Vali Acc: 0.769 Test Loss: 1.207 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0353572368621826
Epoch: 12, Steps: 17 | Train Loss: 0.176 Vali Loss: 1.127 Vali Acc: 0.803 Test Loss: 1.127 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1879968643188477
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.333 Vali Acc: 0.751 Test Loss: 1.333 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3758859634399414
Epoch: 14, Steps: 17 | Train Loss: 0.120 Vali Loss: 1.413 Vali Acc: 0.757 Test Loss: 1.413 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.194579839706421
Epoch: 15, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.181 Vali Acc: 0.786 Test Loss: 1.181 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.208129644393921
Epoch: 16, Steps: 17 | Train Loss: 0.170 Vali Loss: 2.900 Vali Acc: 0.746 Test Loss: 2.900 Test Acc: 0.746
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.1467881202697754
Epoch: 17, Steps: 17 | Train Loss: 0.286 Vali Loss: 2.706 Vali Acc: 0.688 Test Loss: 2.706 Test Acc: 0.688
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 2.359402894973755
Epoch: 18, Steps: 17 | Train Loss: 0.223 Vali Loss: 1.189 Vali Acc: 0.803 Test Loss: 1.189 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1759779
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.227855682373047
Epoch: 1, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.424 Vali Acc: 0.358 Test Loss: 1.424 Test Acc: 0.358
Validation loss decreased (inf --> -0.358367).  Saving model ...
Epoch: 2 cost time: 2.013371229171753
Epoch: 2, Steps: 17 | Train Loss: 1.258 Vali Loss: 1.172 Vali Acc: 0.503 Test Loss: 1.172 Test Acc: 0.503
Validation loss decreased (-0.358367 --> -0.502878).  Saving model ...
Epoch: 3 cost time: 2.102257490158081
Epoch: 3, Steps: 17 | Train Loss: 0.961 Vali Loss: 1.545 Vali Acc: 0.393 Test Loss: 1.545 Test Acc: 0.393
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.978611707687378
Epoch: 4, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.744 Vali Acc: 0.757 Test Loss: 0.744 Test Acc: 0.757
Validation loss decreased (-0.502878 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 2.097316026687622
Epoch: 5, Steps: 17 | Train Loss: 0.537 Vali Loss: 0.941 Vali Acc: 0.613 Test Loss: 0.941 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.121513605117798
Epoch: 6, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.944 Vali Acc: 0.630 Test Loss: 0.944 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 1.900322675704956
Epoch: 7, Steps: 17 | Train Loss: 0.431 Vali Loss: 1.181 Vali Acc: 0.659 Test Loss: 1.181 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9888651371002197
Epoch: 8, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.662 Vali Acc: 0.763 Test Loss: 0.662 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 9 cost time: 2.1556198596954346
Epoch: 9, Steps: 17 | Train Loss: 0.315 Vali Loss: 1.518 Vali Acc: 0.711 Test Loss: 1.518 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.011918544769287
Epoch: 10, Steps: 17 | Train Loss: 0.421 Vali Loss: 1.138 Vali Acc: 0.746 Test Loss: 1.138 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9743108749389648
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.878 Vali Acc: 0.769 Test Loss: 0.878 Test Acc: 0.769
Validation loss decreased (-0.762999 --> -0.768777).  Saving model ...
Epoch: 12 cost time: 2.1195871829986572
Epoch: 12, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.856 Vali Acc: 0.775 Test Loss: 0.856 Test Acc: 0.775
Validation loss decreased (-0.768777 --> -0.774558).  Saving model ...
Epoch: 13 cost time: 1.9287891387939453
Epoch: 13, Steps: 17 | Train Loss: 0.235 Vali Loss: 1.678 Vali Acc: 0.711 Test Loss: 1.678 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.26577091217041
Epoch: 14, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.271 Vali Acc: 0.711 Test Loss: 1.271 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.2472119331359863
Epoch: 15, Steps: 17 | Train Loss: 0.119 Vali Loss: 1.135 Vali Acc: 0.740 Test Loss: 1.135 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.103846788406372
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 2.350 Vali Acc: 0.659 Test Loss: 2.350 Test Acc: 0.659
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8518385887145996
Epoch: 17, Steps: 17 | Train Loss: 0.217 Vali Loss: 1.231 Vali Acc: 0.780 Test Loss: 1.231 Test Acc: 0.780
Validation loss decreased (-0.774558 --> -0.780335).  Saving model ...
Epoch: 18 cost time: 2.2261619567871094
Epoch: 18, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.517 Vali Acc: 0.751 Test Loss: 1.517 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.7018988132476807
Epoch: 19, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.809 Vali Acc: 0.780 Test Loss: 1.809 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7083849906921387
Epoch: 20, Steps: 17 | Train Loss: 0.167 Vali Loss: 1.841 Vali Acc: 0.705 Test Loss: 1.841 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9526546001434326
Epoch: 21, Steps: 17 | Train Loss: 0.292 Vali Loss: 3.121 Vali Acc: 0.728 Test Loss: 3.121 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.069073438644409
Epoch: 22, Steps: 17 | Train Loss: 0.207 Vali Loss: 3.354 Vali Acc: 0.751 Test Loss: 3.354 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.231558084487915
Epoch: 23, Steps: 17 | Train Loss: 0.749 Vali Loss: 1.702 Vali Acc: 0.792 Test Loss: 1.702 Test Acc: 0.792
Validation loss decreased (-0.780335 --> -0.791890).  Saving model ...
Epoch: 24 cost time: 2.131606101989746
Epoch: 24, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.251 Vali Acc: 0.740 Test Loss: 2.251 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9079022407531738
Epoch: 25, Steps: 17 | Train Loss: 0.345 Vali Loss: 2.881 Vali Acc: 0.728 Test Loss: 2.881 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.214256525039673
Epoch: 26, Steps: 17 | Train Loss: 0.482 Vali Loss: 2.320 Vali Acc: 0.723 Test Loss: 2.320 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.882979393005371
Epoch: 27, Steps: 17 | Train Loss: 0.169 Vali Loss: 3.785 Vali Acc: 0.705 Test Loss: 3.785 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9445075988769531
Epoch: 28, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.674 Vali Acc: 0.769 Test Loss: 1.674 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.18509578704834
Epoch: 29, Steps: 17 | Train Loss: 0.151 Vali Loss: 3.081 Vali Acc: 0.751 Test Loss: 3.081 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9205052852630615
Epoch: 30, Steps: 17 | Train Loss: 0.208 Vali Loss: 3.604 Vali Acc: 0.717 Test Loss: 3.604 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.265589714050293
Epoch: 31, Steps: 17 | Train Loss: 0.105 Vali Loss: 2.796 Vali Acc: 0.844 Test Loss: 2.796 Test Acc: 0.844
Validation loss decreased (-0.791890 --> -0.843903).  Saving model ...
Epoch: 32 cost time: 2.1040854454040527
Epoch: 32, Steps: 17 | Train Loss: 0.125 Vali Loss: 2.237 Vali Acc: 0.832 Test Loss: 2.237 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.959561824798584
Epoch: 33, Steps: 17 | Train Loss: 0.051 Vali Loss: 3.007 Vali Acc: 0.792 Test Loss: 3.007 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.251965284347534
Epoch: 34, Steps: 17 | Train Loss: 0.065 Vali Loss: 4.715 Vali Acc: 0.757 Test Loss: 4.715 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 2.076139211654663
Epoch: 35, Steps: 17 | Train Loss: 0.385 Vali Loss: 3.283 Vali Acc: 0.792 Test Loss: 3.283 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0409748554229736
Epoch: 36, Steps: 17 | Train Loss: 0.450 Vali Loss: 2.706 Vali Acc: 0.809 Test Loss: 2.706 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.08070969581604
Epoch: 37, Steps: 17 | Train Loss: 0.144 Vali Loss: 2.869 Vali Acc: 0.780 Test Loss: 2.869 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.9478473663330078
Epoch: 38, Steps: 17 | Train Loss: 0.067 Vali Loss: 5.901 Vali Acc: 0.717 Test Loss: 5.901 Test Acc: 0.717
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 2.0255491733551025
Epoch: 39, Steps: 17 | Train Loss: 0.295 Vali Loss: 3.375 Vali Acc: 0.803 Test Loss: 3.375 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 2.1444108486175537
Epoch: 40, Steps: 17 | Train Loss: 0.305 Vali Loss: 7.450 Vali Acc: 0.746 Test Loss: 7.450 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 2.006202220916748
Epoch: 41, Steps: 17 | Train Loss: 0.373 Vali Loss: 4.522 Vali Acc: 0.780 Test Loss: 4.522 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1759779
model size : 11.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.546597003936768
Epoch: 1, Steps: 17 | Train Loss: 1.829 Vali Loss: 1.485 Vali Acc: 0.312 Test Loss: 1.485 Test Acc: 0.312
Validation loss decreased (inf --> -0.312124).  Saving model ...
Epoch: 2 cost time: 2.029404401779175
Epoch: 2, Steps: 17 | Train Loss: 1.152 Vali Loss: 1.130 Vali Acc: 0.474 Test Loss: 1.130 Test Acc: 0.474
Validation loss decreased (-0.312124 --> -0.473977).  Saving model ...
Epoch: 3 cost time: 2.0977888107299805
Epoch: 3, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.879 Vali Acc: 0.566 Test Loss: 0.879 Test Acc: 0.566
Validation loss decreased (-0.473977 --> -0.566465).  Saving model ...
Epoch: 4 cost time: 2.279252529144287
Epoch: 4, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.774 Vali Acc: 0.694 Test Loss: 0.774 Test Acc: 0.694
Validation loss decreased (-0.566465 --> -0.693634).  Saving model ...
Epoch: 5 cost time: 2.1319327354431152
Epoch: 5, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
Validation loss decreased (-0.693634 --> -0.763000).  Saving model ...
Epoch: 6 cost time: 2.0440995693206787
Epoch: 6, Steps: 17 | Train Loss: 0.271 Vali Loss: 0.655 Vali Acc: 0.775 Test Loss: 0.655 Test Acc: 0.775
Validation loss decreased (-0.763000 --> -0.774560).  Saving model ...
Epoch: 7 cost time: 2.2229695320129395
Epoch: 7, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.387 Vali Acc: 0.630 Test Loss: 1.387 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2153372764587402
Epoch: 8, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.772 Vali Acc: 0.775 Test Loss: 0.772 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.2996068000793457
Epoch: 9, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.739 Vali Acc: 0.803 Test Loss: 0.739 Test Acc: 0.803
Validation loss decreased (-0.774560 --> -0.803461).  Saving model ...
Epoch: 10 cost time: 2.120307445526123
Epoch: 10, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.0879147052764893
Epoch: 11, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.881 Vali Acc: 0.844 Test Loss: 0.881 Test Acc: 0.844
Validation loss decreased (-0.803461 --> -0.843922).  Saving model ...
Epoch: 12 cost time: 2.2923378944396973
Epoch: 12, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.923 Vali Acc: 0.803 Test Loss: 0.923 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.1063692569732666
Epoch: 13, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.062 Vali Acc: 0.798 Test Loss: 1.062 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.998703956604004
Epoch: 14, Steps: 17 | Train Loss: 0.155 Vali Loss: 0.932 Vali Acc: 0.780 Test Loss: 0.932 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.0519790649414062
Epoch: 15, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.826 Vali Acc: 0.809 Test Loss: 0.826 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.9209539890289307
Epoch: 16, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.455 Vali Acc: 0.798 Test Loss: 1.455 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 2.155330181121826
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.887 Vali Acc: 0.803 Test Loss: 0.887 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.9970602989196777
Epoch: 18, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.752 Vali Acc: 0.780 Test Loss: 1.752 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2263989448547363
Epoch: 19, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.309 Vali Acc: 0.786 Test Loss: 1.309 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 2.0061581134796143
Epoch: 20, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.027 Vali Acc: 0.827 Test Loss: 1.027 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 2.114865779876709
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.427 Vali Acc: 0.821 Test Loss: 1.427 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1694243
model size : 11.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.551531076431274
Epoch: 1, Steps: 17 | Train Loss: 1.830 Vali Loss: 1.491 Vali Acc: 0.277 Test Loss: 1.491 Test Acc: 0.277
Validation loss decreased (inf --> -0.277442).  Saving model ...
Epoch: 2 cost time: 2.1480250358581543
Epoch: 2, Steps: 17 | Train Loss: 1.169 Vali Loss: 1.120 Vali Acc: 0.503 Test Loss: 1.120 Test Acc: 0.503
Validation loss decreased (-0.277442 --> -0.502879).  Saving model ...
Epoch: 3 cost time: 1.9177758693695068
Epoch: 3, Steps: 17 | Train Loss: 0.755 Vali Loss: 0.894 Vali Acc: 0.566 Test Loss: 0.894 Test Acc: 0.566
Validation loss decreased (-0.502879 --> -0.566465).  Saving model ...
Epoch: 4 cost time: 1.6946330070495605
Epoch: 4, Steps: 17 | Train Loss: 0.505 Vali Loss: 0.732 Vali Acc: 0.723 Test Loss: 0.732 Test Acc: 0.723
Validation loss decreased (-0.566465 --> -0.722536).  Saving model ...
Epoch: 5 cost time: 2.3468077182769775
Epoch: 5, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.617 Vali Acc: 0.775 Test Loss: 0.617 Test Acc: 0.775
Validation loss decreased (-0.722536 --> -0.774560).  Saving model ...
Epoch: 6 cost time: 1.9203946590423584
Epoch: 6, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.877 Vali Acc: 0.694 Test Loss: 0.877 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0840609073638916
Epoch: 7, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.904 Vali Acc: 0.723 Test Loss: 0.904 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.003140926361084
Epoch: 8, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.810 Vali Acc: 0.780 Test Loss: 0.810 Test Acc: 0.780
Validation loss decreased (-0.774560 --> -0.780339).  Saving model ...
Epoch: 9 cost time: 2.00549578666687
Epoch: 9, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.804 Vali Acc: 0.786 Test Loss: 0.804 Test Acc: 0.786
Validation loss decreased (-0.780339 --> -0.786119).  Saving model ...
Epoch: 10 cost time: 2.1492562294006348
Epoch: 10, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.592 Vali Acc: 0.844 Test Loss: 0.592 Test Acc: 0.844
Validation loss decreased (-0.786119 --> -0.843925).  Saving model ...
Epoch: 11 cost time: 2.002190589904785
Epoch: 11, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.891 Vali Acc: 0.723 Test Loss: 0.891 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.104409694671631
Epoch: 12, Steps: 17 | Train Loss: 0.452 Vali Loss: 1.270 Vali Acc: 0.694 Test Loss: 1.270 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.276583433151245
Epoch: 13, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.513 Vali Acc: 0.746 Test Loss: 1.513 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 2.1606273651123047
Epoch: 14, Steps: 17 | Train Loss: 0.545 Vali Loss: 1.546 Vali Acc: 0.763 Test Loss: 1.546 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.9309968948364258
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.431 Vali Acc: 0.751 Test Loss: 1.431 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.667588233947754
Epoch: 16, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.207 Vali Acc: 0.821 Test Loss: 1.207 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8228695392608643
Epoch: 17, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.682 Vali Acc: 0.757 Test Loss: 1.682 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6827688217163086
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.781 Vali Acc: 0.728 Test Loss: 1.781 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.7353060245513916
Epoch: 19, Steps: 17 | Train Loss: 0.278 Vali Loss: 1.861 Vali Acc: 0.803 Test Loss: 1.861 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.1408355236053467
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.878 Vali Acc: 0.792 Test Loss: 1.878 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1694243
model size : 11.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.496510982513428
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.533 Vali Acc: 0.306 Test Loss: 1.533 Test Acc: 0.306
Validation loss decreased (inf --> -0.306343).  Saving model ...
Epoch: 2 cost time: 2.0219409465789795
Epoch: 2, Steps: 17 | Train Loss: 1.213 Vali Loss: 1.101 Vali Acc: 0.538 Test Loss: 1.101 Test Acc: 0.538
Validation loss decreased (-0.306343 --> -0.537561).  Saving model ...
Epoch: 3 cost time: 2.0330746173858643
Epoch: 3, Steps: 17 | Train Loss: 0.797 Vali Loss: 0.910 Vali Acc: 0.613 Test Loss: 0.910 Test Acc: 0.613
Validation loss decreased (-0.537561 --> -0.612708).  Saving model ...
Epoch: 4 cost time: 1.8756513595581055
Epoch: 4, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.787 Vali Acc: 0.682 Test Loss: 0.787 Test Acc: 0.682
Validation loss decreased (-0.612708 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 2.238522529602051
Epoch: 5, Steps: 17 | Train Loss: 0.360 Vali Loss: 0.754 Vali Acc: 0.682 Test Loss: 0.754 Test Acc: 0.682
Validation loss decreased (-0.682073 --> -0.682073).  Saving model ...
Epoch: 6 cost time: 2.237429141998291
Epoch: 6, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.741 Vali Acc: 0.723 Test Loss: 0.741 Test Acc: 0.723
Validation loss decreased (-0.682073 --> -0.722536).  Saving model ...
Epoch: 7 cost time: 2.1018640995025635
Epoch: 7, Steps: 17 | Train Loss: 0.376 Vali Loss: 1.684 Vali Acc: 0.653 Test Loss: 1.684 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.2245876789093018
Epoch: 8, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.976 Vali Acc: 0.746 Test Loss: 0.976 Test Acc: 0.746
Validation loss decreased (-0.722536 --> -0.745655).  Saving model ...
Epoch: 9 cost time: 1.9692270755767822
Epoch: 9, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.040 Vali Acc: 0.751 Test Loss: 1.040 Test Acc: 0.751
Validation loss decreased (-0.745655 --> -0.751435).  Saving model ...
Epoch: 10 cost time: 2.2751781940460205
Epoch: 10, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.629 Vali Acc: 0.653 Test Loss: 1.629 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9610354900360107
Epoch: 11, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.220 Vali Acc: 0.711 Test Loss: 1.220 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.180471420288086
Epoch: 12, Steps: 17 | Train Loss: 0.096 Vali Loss: 1.398 Vali Acc: 0.676 Test Loss: 1.398 Test Acc: 0.676
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1879355907440186
Epoch: 13, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.976 Vali Acc: 0.769 Test Loss: 1.976 Test Acc: 0.769
Validation loss decreased (-0.751435 --> -0.768766).  Saving model ...
Epoch: 14 cost time: 2.178785562515259
Epoch: 14, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.854 Vali Acc: 0.838 Test Loss: 0.854 Test Acc: 0.838
Validation loss decreased (-0.768766 --> -0.838142).  Saving model ...
Epoch: 15 cost time: 2.1644532680511475
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.457 Vali Acc: 0.763 Test Loss: 1.457 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.158923387527466
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.302 Vali Acc: 0.792 Test Loss: 1.302 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.102003574371338
Epoch: 17, Steps: 17 | Train Loss: 0.185 Vali Loss: 1.129 Vali Acc: 0.786 Test Loss: 1.129 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.3036346435546875
Epoch: 18, Steps: 17 | Train Loss: 0.252 Vali Loss: 1.811 Vali Acc: 0.746 Test Loss: 1.811 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.9099349975585938
Epoch: 19, Steps: 17 | Train Loss: 0.150 Vali Loss: 1.452 Vali Acc: 0.798 Test Loss: 1.452 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.167320489883423
Epoch: 20, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.999 Vali Acc: 0.775 Test Loss: 1.999 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.185055732727051
Epoch: 21, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.596 Vali Acc: 0.705 Test Loss: 3.596 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 2.089980125427246
Epoch: 22, Steps: 17 | Train Loss: 0.121 Vali Loss: 2.653 Vali Acc: 0.775 Test Loss: 2.653 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.929199457168579
Epoch: 23, Steps: 17 | Train Loss: 0.187 Vali Loss: 2.260 Vali Acc: 0.798 Test Loss: 2.260 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.085437774658203
Epoch: 24, Steps: 17 | Train Loss: 0.101 Vali Loss: 3.965 Vali Acc: 0.751 Test Loss: 3.965 Test Acc: 0.751
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1694243
model size : 11.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.4473960399627686
Epoch: 1, Steps: 17 | Train Loss: 1.879 Vali Loss: 1.562 Vali Acc: 0.312 Test Loss: 1.562 Test Acc: 0.312
Validation loss decreased (inf --> -0.312123).  Saving model ...
Epoch: 2 cost time: 2.008721113204956
Epoch: 2, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.238 Vali Acc: 0.428 Test Loss: 1.238 Test Acc: 0.428
Validation loss decreased (-0.312123 --> -0.427733).  Saving model ...
Epoch: 3 cost time: 2.058246374130249
Epoch: 3, Steps: 17 | Train Loss: 0.916 Vali Loss: 1.017 Vali Acc: 0.561 Test Loss: 1.017 Test Acc: 0.561
Validation loss decreased (-0.427733 --> -0.560683).  Saving model ...
Epoch: 4 cost time: 2.1547598838806152
Epoch: 4, Steps: 17 | Train Loss: 0.731 Vali Loss: 1.017 Vali Acc: 0.630 Test Loss: 1.017 Test Acc: 0.630
Validation loss decreased (-0.560683 --> -0.630048).  Saving model ...
Epoch: 5 cost time: 1.8036692142486572
Epoch: 5, Steps: 17 | Train Loss: 0.503 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.1215622425079346
Epoch: 6, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.925 Vali Acc: 0.688 Test Loss: 0.925 Test Acc: 0.688
Validation loss decreased (-0.630048 --> -0.687852).  Saving model ...
Epoch: 7 cost time: 2.05454683303833
Epoch: 7, Steps: 17 | Train Loss: 0.378 Vali Loss: 1.133 Vali Acc: 0.642 Test Loss: 1.133 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.119551658630371
Epoch: 8, Steps: 17 | Train Loss: 0.311 Vali Loss: 0.913 Vali Acc: 0.705 Test Loss: 0.913 Test Acc: 0.705
Validation loss decreased (-0.687852 --> -0.705193).  Saving model ...
Epoch: 9 cost time: 1.9508397579193115
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.687 Vali Acc: 0.769 Test Loss: 0.687 Test Acc: 0.769
Validation loss decreased (-0.705193 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 2.1102821826934814
Epoch: 10, Steps: 17 | Train Loss: 0.185 Vali Loss: 0.880 Vali Acc: 0.775 Test Loss: 0.880 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774558).  Saving model ...
Epoch: 11 cost time: 2.3259944915771484
Epoch: 11, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.827 Vali Acc: 0.751 Test Loss: 0.827 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.1324515342712402
Epoch: 12, Steps: 17 | Train Loss: 0.295 Vali Loss: 1.145 Vali Acc: 0.671 Test Loss: 1.145 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.940476655960083
Epoch: 13, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.649 Vali Acc: 0.642 Test Loss: 1.649 Test Acc: 0.642
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.7530882358551025
Epoch: 14, Steps: 17 | Train Loss: 0.323 Vali Loss: 0.938 Vali Acc: 0.769 Test Loss: 0.938 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7570757865905762
Epoch: 15, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.655 Vali Acc: 0.699 Test Loss: 1.655 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.830402135848999
Epoch: 16, Steps: 17 | Train Loss: 0.305 Vali Loss: 2.004 Vali Acc: 0.705 Test Loss: 2.004 Test Acc: 0.705
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.8780789375305176
Epoch: 17, Steps: 17 | Train Loss: 0.160 Vali Loss: 0.929 Vali Acc: 0.798 Test Loss: 0.929 Test Acc: 0.798
Validation loss decreased (-0.774558 --> -0.797679).  Saving model ...
Epoch: 18 cost time: 2.152045965194702
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.071 Vali Acc: 0.711 Test Loss: 2.071 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8888580799102783
Epoch: 19, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.234 Vali Acc: 0.751 Test Loss: 1.234 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 2.0382256507873535
Epoch: 20, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.551 Vali Acc: 0.775 Test Loss: 1.551 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.7314085960388184
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.779 Vali Acc: 0.734 Test Loss: 1.779 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.2232964038848877
Epoch: 22, Steps: 17 | Train Loss: 0.246 Vali Loss: 2.096 Vali Acc: 0.699 Test Loss: 2.096 Test Acc: 0.699
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 2.059424877166748
Epoch: 23, Steps: 17 | Train Loss: 0.328 Vali Loss: 3.652 Vali Acc: 0.723 Test Loss: 3.652 Test Acc: 0.723
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 2.1735849380493164
Epoch: 24, Steps: 17 | Train Loss: 0.618 Vali Loss: 2.508 Vali Acc: 0.723 Test Loss: 2.508 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 2.265974283218384
Epoch: 25, Steps: 17 | Train Loss: 0.422 Vali Loss: 4.395 Vali Acc: 0.694 Test Loss: 4.395 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8891303539276123
Epoch: 26, Steps: 17 | Train Loss: 0.374 Vali Loss: 3.178 Vali Acc: 0.717 Test Loss: 3.178 Test Acc: 0.717
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 2.1514885425567627
Epoch: 27, Steps: 17 | Train Loss: 0.424 Vali Loss: 2.323 Vali Acc: 0.803 Test Loss: 2.323 Test Acc: 0.803
Validation loss decreased (-0.797679 --> -0.803445).  Saving model ...
Epoch: 28 cost time: 2.1043717861175537
Epoch: 28, Steps: 17 | Train Loss: 0.339 Vali Loss: 2.843 Vali Acc: 0.682 Test Loss: 2.843 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.1894681453704834
Epoch: 29, Steps: 17 | Train Loss: 0.084 Vali Loss: 2.087 Vali Acc: 0.803 Test Loss: 2.087 Test Acc: 0.803
Validation loss decreased (-0.803445 --> -0.803447).  Saving model ...
Epoch: 30 cost time: 2.046621322631836
Epoch: 30, Steps: 17 | Train Loss: 0.162 Vali Loss: 2.197 Vali Acc: 0.780 Test Loss: 2.197 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.027479648590088
Epoch: 31, Steps: 17 | Train Loss: 0.095 Vali Loss: 2.981 Vali Acc: 0.757 Test Loss: 2.981 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 2.053600549697876
Epoch: 32, Steps: 17 | Train Loss: 0.190 Vali Loss: 2.200 Vali Acc: 0.798 Test Loss: 2.200 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 2.169426679611206
Epoch: 33, Steps: 17 | Train Loss: 0.262 Vali Loss: 3.637 Vali Acc: 0.786 Test Loss: 3.637 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.020433187484741
Epoch: 34, Steps: 17 | Train Loss: 0.231 Vali Loss: 4.175 Vali Acc: 0.717 Test Loss: 4.175 Test Acc: 0.717
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7876653671264648
Epoch: 35, Steps: 17 | Train Loss: 0.020 Vali Loss: 2.733 Vali Acc: 0.769 Test Loss: 2.733 Test Acc: 0.769
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.8907909393310547
Epoch: 36, Steps: 17 | Train Loss: 0.014 Vali Loss: 3.106 Vali Acc: 0.751 Test Loss: 3.106 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.0112617015838623
Epoch: 37, Steps: 17 | Train Loss: 0.385 Vali Loss: 4.616 Vali Acc: 0.699 Test Loss: 4.616 Test Acc: 0.699
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.9960567951202393
Epoch: 38, Steps: 17 | Train Loss: 0.219 Vali Loss: 3.662 Vali Acc: 0.723 Test Loss: 3.662 Test Acc: 0.723
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.1346726417541504
Epoch: 39, Steps: 17 | Train Loss: 0.275 Vali Loss: 3.670 Vali Acc: 0.798 Test Loss: 3.670 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 1694243
model size : 11.36MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.413955211639404
Epoch: 1, Steps: 17 | Train Loss: 1.803 Vali Loss: 1.436 Vali Acc: 0.416 Test Loss: 1.436 Test Acc: 0.416
Validation loss decreased (inf --> -0.416171).  Saving model ...
Epoch: 2 cost time: 2.153731346130371
Epoch: 2, Steps: 17 | Train Loss: 1.045 Vali Loss: 0.963 Vali Acc: 0.613 Test Loss: 0.963 Test Acc: 0.613
Validation loss decreased (-0.416171 --> -0.612707).  Saving model ...
Epoch: 3 cost time: 2.1090335845947266
Epoch: 3, Steps: 17 | Train Loss: 0.742 Vali Loss: 0.887 Vali Acc: 0.624 Test Loss: 0.887 Test Acc: 0.624
Validation loss decreased (-0.612707 --> -0.624269).  Saving model ...
Epoch: 4 cost time: 2.1619319915771484
Epoch: 4, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.613 Vali Acc: 0.746 Test Loss: 0.613 Test Acc: 0.746
Validation loss decreased (-0.624269 --> -0.745659).  Saving model ...
Epoch: 5 cost time: 2.0535290241241455
Epoch: 5, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.865 Vali Acc: 0.728 Test Loss: 0.865 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.206960439682007
Epoch: 6, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.899 Vali Acc: 0.728 Test Loss: 0.899 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2302305698394775
Epoch: 7, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.536 Vali Acc: 0.861 Test Loss: 0.536 Test Acc: 0.861
Validation loss decreased (-0.745659 --> -0.861266).  Saving model ...
Epoch: 8 cost time: 2.114603281021118
Epoch: 8, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.770 Vali Acc: 0.827 Test Loss: 0.770 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0635650157928467
Epoch: 9, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.631 Vali Acc: 0.838 Test Loss: 0.631 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.2059903144836426
Epoch: 10, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.729 Vali Acc: 0.844 Test Loss: 0.729 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.9559299945831299
Epoch: 11, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.721 Vali Acc: 0.792 Test Loss: 0.721 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.764714241027832
Epoch: 12, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 2.0179734230041504
Epoch: 13, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.170 Vali Acc: 0.803 Test Loss: 1.170 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 14 cost time: 2.1238489151000977
Epoch: 14, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.705 Vali Acc: 0.723 Test Loss: 1.705 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 15 cost time: 1.9608302116394043
Epoch: 15, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.899 Vali Acc: 0.815 Test Loss: 0.899 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 16 cost time: 2.302659034729004
Epoch: 16, Steps: 17 | Train Loss: 0.145 Vali Loss: 1.157 Vali Acc: 0.827 Test Loss: 1.157 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 17 cost time: 2.298635959625244
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.686 Vali Acc: 0.780 Test Loss: 1.686 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1661475
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.754619598388672
Epoch: 1, Steps: 17 | Train Loss: 1.804 Vali Loss: 1.437 Vali Acc: 0.405 Test Loss: 1.437 Test Acc: 0.405
Validation loss decreased (inf --> -0.404610).  Saving model ...
Epoch: 2 cost time: 2.0908734798431396
Epoch: 2, Steps: 17 | Train Loss: 1.075 Vali Loss: 0.966 Vali Acc: 0.613 Test Loss: 0.966 Test Acc: 0.613
Validation loss decreased (-0.404610 --> -0.612707).  Saving model ...
Epoch: 3 cost time: 2.2986669540405273
Epoch: 3, Steps: 17 | Train Loss: 0.769 Vali Loss: 0.875 Vali Acc: 0.618 Test Loss: 0.875 Test Acc: 0.618
Validation loss decreased (-0.612707 --> -0.618488).  Saving model ...
Epoch: 4 cost time: 2.3575439453125
Epoch: 4, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.578 Vali Acc: 0.821 Test Loss: 0.578 Test Acc: 0.821
Validation loss decreased (-0.618488 --> -0.820803).  Saving model ...
Epoch: 5 cost time: 2.2266764640808105
Epoch: 5, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.954 Vali Acc: 0.746 Test Loss: 0.954 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.088239908218384
Epoch: 6, Steps: 17 | Train Loss: 0.331 Vali Loss: 1.150 Vali Acc: 0.694 Test Loss: 1.150 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.2357730865478516
Epoch: 7, Steps: 17 | Train Loss: 0.178 Vali Loss: 0.743 Vali Acc: 0.769 Test Loss: 0.743 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.2647628784179688
Epoch: 8, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.620 Vali Acc: 0.844 Test Loss: 0.620 Test Acc: 0.844
Validation loss decreased (-0.820803 --> -0.843924).  Saving model ...
Epoch: 9 cost time: 2.155278444290161
Epoch: 9, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.567 Vali Acc: 0.844 Test Loss: 0.567 Test Acc: 0.844
Validation loss decreased (-0.843924 --> -0.843925).  Saving model ...
Epoch: 10 cost time: 2.336667060852051
Epoch: 10, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.945 Vali Acc: 0.798 Test Loss: 0.945 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.3237876892089844
Epoch: 11, Steps: 17 | Train Loss: 0.201 Vali Loss: 1.202 Vali Acc: 0.780 Test Loss: 1.202 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.05652117729187
Epoch: 12, Steps: 17 | Train Loss: 0.246 Vali Loss: 1.658 Vali Acc: 0.746 Test Loss: 1.658 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.1755261421203613
Epoch: 13, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.823 Vali Acc: 0.844 Test Loss: 0.823 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.1506099700927734
Epoch: 14, Steps: 17 | Train Loss: 0.128 Vali Loss: 2.720 Vali Acc: 0.618 Test Loss: 2.720 Test Acc: 0.618
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 2.297520637512207
Epoch: 15, Steps: 17 | Train Loss: 0.283 Vali Loss: 1.482 Vali Acc: 0.809 Test Loss: 1.482 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 2.3342995643615723
Epoch: 16, Steps: 17 | Train Loss: 0.101 Vali Loss: 1.352 Vali Acc: 0.815 Test Loss: 1.352 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 17 cost time: 2.3671376705169678
Epoch: 17, Steps: 17 | Train Loss: 0.257 Vali Loss: 2.195 Vali Acc: 0.728 Test Loss: 2.195 Test Acc: 0.728
EarlyStopping counter: 8 out of 10
Epoch: 18 cost time: 2.2880630493164062
Epoch: 18, Steps: 17 | Train Loss: 0.197 Vali Loss: 2.334 Vali Acc: 0.665 Test Loss: 2.334 Test Acc: 0.665
EarlyStopping counter: 9 out of 10
Epoch: 19 cost time: 2.3026814460754395
Epoch: 19, Steps: 17 | Train Loss: 0.256 Vali Loss: 2.491 Vali Acc: 0.665 Test Loss: 2.491 Test Acc: 0.665
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1661475
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.347007513046265
Epoch: 1, Steps: 17 | Train Loss: 1.811 Vali Loss: 1.452 Vali Acc: 0.364 Test Loss: 1.452 Test Acc: 0.364
Validation loss decreased (inf --> -0.364147).  Saving model ...
Epoch: 2 cost time: 1.908310890197754
Epoch: 2, Steps: 17 | Train Loss: 1.088 Vali Loss: 0.971 Vali Acc: 0.618 Test Loss: 0.971 Test Acc: 0.618
Validation loss decreased (-0.364147 --> -0.618487).  Saving model ...
Epoch: 3 cost time: 2.093782663345337
Epoch: 3, Steps: 17 | Train Loss: 0.782 Vali Loss: 0.852 Vali Acc: 0.647 Test Loss: 0.852 Test Acc: 0.647
Validation loss decreased (-0.618487 --> -0.647390).  Saving model ...
Epoch: 4 cost time: 2.2867231369018555
Epoch: 4, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.620 Vali Acc: 0.815 Test Loss: 0.620 Test Acc: 0.815
Validation loss decreased (-0.647390 --> -0.815023).  Saving model ...
Epoch: 5 cost time: 1.957991123199463
Epoch: 5, Steps: 17 | Train Loss: 0.363 Vali Loss: 0.687 Vali Acc: 0.775 Test Loss: 0.687 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.358006238937378
Epoch: 6, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.778 Vali Acc: 0.734 Test Loss: 0.778 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1225476264953613
Epoch: 7, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.624 Vali Acc: 0.809 Test Loss: 0.624 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 2.3522415161132812
Epoch: 8, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.817 Vali Acc: 0.734 Test Loss: 0.817 Test Acc: 0.734
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.113020658493042
Epoch: 9, Steps: 17 | Train Loss: 0.149 Vali Loss: 1.354 Vali Acc: 0.705 Test Loss: 1.354 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9091596603393555
Epoch: 10, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.775 Vali Acc: 0.815 Test Loss: 0.775 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 1.9669692516326904
Epoch: 11, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.166 Vali Acc: 0.763 Test Loss: 1.166 Test Acc: 0.763
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 2.160452365875244
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.910 Vali Acc: 0.803 Test Loss: 0.910 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.109027862548828
Epoch: 13, Steps: 17 | Train Loss: 0.156 Vali Loss: 1.256 Vali Acc: 0.757 Test Loss: 1.256 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.230649948120117
Epoch: 14, Steps: 17 | Train Loss: 0.219 Vali Loss: 1.090 Vali Acc: 0.775 Test Loss: 1.090 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 1661475
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            256                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.536484003067017
Epoch: 1, Steps: 17 | Train Loss: 1.843 Vali Loss: 1.541 Vali Acc: 0.341 Test Loss: 1.541 Test Acc: 0.341
Validation loss decreased (inf --> -0.341025).  Saving model ...
Epoch: 2 cost time: 1.9746711254119873
Epoch: 2, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.129 Vali Acc: 0.549 Test Loss: 1.129 Test Acc: 0.549
Validation loss decreased (-0.341025 --> -0.549122).  Saving model ...
Epoch: 3 cost time: 1.9597914218902588
Epoch: 3, Steps: 17 | Train Loss: 0.887 Vali Loss: 0.854 Vali Acc: 0.630 Test Loss: 0.854 Test Acc: 0.630
Validation loss decreased (-0.549122 --> -0.630049).  Saving model ...
Epoch: 4 cost time: 2.046693801879883
Epoch: 4, Steps: 17 | Train Loss: 0.718 Vali Loss: 0.662 Vali Acc: 0.861 Test Loss: 0.662 Test Acc: 0.861
Validation loss decreased (-0.630049 --> -0.861265).  Saving model ...
Epoch: 5 cost time: 1.840409755706787
Epoch: 5, Steps: 17 | Train Loss: 0.529 Vali Loss: 0.690 Vali Acc: 0.746 Test Loss: 0.690 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 2.2196545600891113
Epoch: 6, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.842 Vali Acc: 0.705 Test Loss: 0.842 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 7 cost time: 2.1382155418395996
Epoch: 7, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.607 Vali Acc: 0.769 Test Loss: 0.607 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 8 cost time: 1.9462499618530273
Epoch: 8, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.963 Vali Acc: 0.694 Test Loss: 0.963 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 9 cost time: 2.099163055419922
Epoch: 9, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.760 Vali Acc: 0.757 Test Loss: 0.760 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 10 cost time: 1.9628105163574219
Epoch: 10, Steps: 17 | Train Loss: 0.272 Vali Loss: 1.291 Vali Acc: 0.624 Test Loss: 1.291 Test Acc: 0.624
EarlyStopping counter: 6 out of 10
Epoch: 11 cost time: 2.1901657581329346
Epoch: 11, Steps: 17 | Train Loss: 0.295 Vali Loss: 1.285 Vali Acc: 0.723 Test Loss: 1.285 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 12 cost time: 1.920109510421753
Epoch: 12, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.030 Vali Acc: 0.694 Test Loss: 1.030 Test Acc: 0.694
EarlyStopping counter: 8 out of 10
Epoch: 13 cost time: 2.0111498832702637
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.808 Vali Acc: 0.798 Test Loss: 0.808 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 14 cost time: 2.227308511734009
Epoch: 14, Steps: 17 | Train Loss: 0.205 Vali Loss: 1.247 Vali Acc: 0.740 Test Loss: 1.247 Test Acc: 0.740
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm256_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1661475
model size : 11.23MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.5270678997039795
Epoch: 1, Steps: 17 | Train Loss: 1.840 Vali Loss: 1.517 Vali Acc: 0.306 Test Loss: 1.517 Test Acc: 0.306
Validation loss decreased (inf --> -0.306343).  Saving model ...
Epoch: 2 cost time: 2.13191819190979
Epoch: 2, Steps: 17 | Train Loss: 1.238 Vali Loss: 1.243 Vali Acc: 0.376 Test Loss: 1.243 Test Acc: 0.376
Validation loss decreased (-0.306343 --> -0.375710).  Saving model ...
Epoch: 3 cost time: 2.0310885906219482
Epoch: 3, Steps: 17 | Train Loss: 0.909 Vali Loss: 1.020 Vali Acc: 0.497 Test Loss: 1.020 Test Acc: 0.497
Validation loss decreased (-0.375710 --> -0.497100).  Saving model ...
Epoch: 4 cost time: 2.127490282058716
Epoch: 4, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.781 Vali Acc: 0.688 Test Loss: 0.781 Test Acc: 0.688
Validation loss decreased (-0.497100 --> -0.687853).  Saving model ...
Epoch: 5 cost time: 1.9880297183990479
Epoch: 5, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.697 Vali Acc: 0.769 Test Loss: 0.697 Test Acc: 0.769
Validation loss decreased (-0.687853 --> -0.768779).  Saving model ...
Epoch: 6 cost time: 1.9457802772521973
Epoch: 6, Steps: 17 | Train Loss: 0.366 Vali Loss: 0.568 Vali Acc: 0.786 Test Loss: 0.568 Test Acc: 0.786
Validation loss decreased (-0.768779 --> -0.786121).  Saving model ...
Epoch: 7 cost time: 1.9975261688232422
Epoch: 7, Steps: 17 | Train Loss: 0.336 Vali Loss: 1.020 Vali Acc: 0.642 Test Loss: 1.020 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1020238399505615
Epoch: 8, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.518 Vali Acc: 0.832 Test Loss: 0.518 Test Acc: 0.832
Validation loss decreased (-0.786121 --> -0.832365).  Saving model ...
Epoch: 9 cost time: 2.063469409942627
Epoch: 9, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.538 Vali Acc: 0.815 Test Loss: 0.538 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.160074234008789
Epoch: 10, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.651 Vali Acc: 0.763 Test Loss: 0.651 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1179635524749756
Epoch: 11, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.606 Vali Acc: 0.827 Test Loss: 0.606 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.1523704528808594
Epoch: 12, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.508 Vali Acc: 0.861 Test Loss: 0.508 Test Acc: 0.861
Validation loss decreased (-0.832365 --> -0.861267).  Saving model ...
Epoch: 13 cost time: 2.146665096282959
Epoch: 13, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.632 Vali Acc: 0.815 Test Loss: 0.632 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8316104412078857
Epoch: 14, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.873 Vali Acc: 0.832 Test Loss: 0.873 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.900813102722168
Epoch: 15, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.677 Vali Acc: 0.827 Test Loss: 0.677 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.219876289367676
Epoch: 16, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.918 Vali Acc: 0.832 Test Loss: 0.918 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9948203563690186
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.872 Vali Acc: 0.832 Test Loss: 0.872 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.8703083992004395
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.760 Vali Acc: 0.855 Test Loss: 0.760 Test Acc: 0.855
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 2.0692903995513916
Epoch: 19, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.979 Vali Acc: 0.827 Test Loss: 0.979 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.8680870532989502
Epoch: 20, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.121 Vali Acc: 0.809 Test Loss: 1.121 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.7572622299194336
Epoch: 21, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.211 Vali Acc: 0.780 Test Loss: 1.211 Test Acc: 0.780
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.6789917945861816
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.356 Vali Acc: 0.815 Test Loss: 1.356 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1307811
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 5.036573886871338
Epoch: 1, Steps: 17 | Train Loss: 1.841 Vali Loss: 1.514 Vali Acc: 0.295 Test Loss: 1.514 Test Acc: 0.295
Validation loss decreased (inf --> -0.294783).  Saving model ...
Epoch: 2 cost time: 2.2858083248138428
Epoch: 2, Steps: 17 | Train Loss: 1.249 Vali Loss: 1.278 Vali Acc: 0.382 Test Loss: 1.278 Test Acc: 0.382
Validation loss decreased (-0.294783 --> -0.381490).  Saving model ...
Epoch: 3 cost time: 2.1773040294647217
Epoch: 3, Steps: 17 | Train Loss: 0.949 Vali Loss: 1.040 Vali Acc: 0.491 Test Loss: 1.040 Test Acc: 0.491
Validation loss decreased (-0.381490 --> -0.491319).  Saving model ...
Epoch: 4 cost time: 2.437678337097168
Epoch: 4, Steps: 17 | Train Loss: 0.725 Vali Loss: 0.804 Vali Acc: 0.682 Test Loss: 0.804 Test Acc: 0.682
Validation loss decreased (-0.491319 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 2.034200429916382
Epoch: 5, Steps: 17 | Train Loss: 0.508 Vali Loss: 0.720 Vali Acc: 0.746 Test Loss: 0.720 Test Acc: 0.746
Validation loss decreased (-0.682073 --> -0.745658).  Saving model ...
Epoch: 6 cost time: 2.161407470703125
Epoch: 6, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.613 Vali Acc: 0.769 Test Loss: 0.613 Test Acc: 0.769
Validation loss decreased (-0.745658 --> -0.768780).  Saving model ...
Epoch: 7 cost time: 2.178816556930542
Epoch: 7, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.979 Vali Acc: 0.665 Test Loss: 0.979 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.1298069953918457
Epoch: 8, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.709 Vali Acc: 0.757 Test Loss: 0.709 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.9198014736175537
Epoch: 9, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.793 Vali Acc: 0.694 Test Loss: 0.793 Test Acc: 0.694
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.516505718231201
Epoch: 10, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.578 Vali Acc: 0.775 Test Loss: 0.578 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774561).  Saving model ...
Epoch: 11 cost time: 2.2624123096466064
Epoch: 11, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.790 Vali Acc: 0.780 Test Loss: 0.790 Test Acc: 0.780
Validation loss decreased (-0.774561 --> -0.780339).  Saving model ...
Epoch: 12 cost time: 2.334895372390747
Epoch: 12, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.546 Vali Acc: 0.832 Test Loss: 0.546 Test Acc: 0.832
Validation loss decreased (-0.780339 --> -0.832364).  Saving model ...
Epoch: 13 cost time: 2.1025912761688232
Epoch: 13, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.950 Vali Acc: 0.780 Test Loss: 0.950 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 2.310621738433838
Epoch: 14, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.055 Vali Acc: 0.780 Test Loss: 1.055 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.303136110305786
Epoch: 15, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.884 Vali Acc: 0.763 Test Loss: 0.884 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 2.31778883934021
Epoch: 16, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.882 Vali Acc: 0.844 Test Loss: 0.882 Test Acc: 0.844
Validation loss decreased (-0.832364 --> -0.843922).  Saving model ...
Epoch: 17 cost time: 2.0891523361206055
Epoch: 17, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.480 Vali Acc: 0.792 Test Loss: 1.480 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.3140528202056885
Epoch: 18, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.742 Vali Acc: 0.757 Test Loss: 1.742 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.292133331298828
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.984 Vali Acc: 0.815 Test Loss: 0.984 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.42915415763855
Epoch: 20, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.941 Vali Acc: 0.832 Test Loss: 0.941 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.19245982170105
Epoch: 21, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.036 Vali Acc: 0.809 Test Loss: 1.036 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.4664156436920166
Epoch: 22, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.045 Vali Acc: 0.832 Test Loss: 1.045 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.3006973266601562
Epoch: 23, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.154 Vali Acc: 0.827 Test Loss: 1.154 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.130859375
Epoch: 24, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.049 Vali Acc: 0.838 Test Loss: 1.049 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.3565778732299805
Epoch: 25, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.376 Vali Acc: 0.803 Test Loss: 1.376 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.1535801887512207
Epoch: 26, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.630 Vali Acc: 0.827 Test Loss: 1.630 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1307811
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.487830400466919
Epoch: 1, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.565 Vali Acc: 0.329 Test Loss: 1.565 Test Acc: 0.329
Validation loss decreased (inf --> -0.329464).  Saving model ...
Epoch: 2 cost time: 1.7598183155059814
Epoch: 2, Steps: 17 | Train Loss: 1.290 Vali Loss: 1.340 Vali Acc: 0.376 Test Loss: 1.340 Test Acc: 0.376
Validation loss decreased (-0.329464 --> -0.375709).  Saving model ...
Epoch: 3 cost time: 1.9005250930786133
Epoch: 3, Steps: 17 | Train Loss: 0.965 Vali Loss: 1.005 Vali Acc: 0.509 Test Loss: 1.005 Test Acc: 0.509
Validation loss decreased (-0.375709 --> -0.508660).  Saving model ...
Epoch: 4 cost time: 1.9903607368469238
Epoch: 4, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.837 Vali Acc: 0.671 Test Loss: 0.837 Test Acc: 0.671
Validation loss decreased (-0.508660 --> -0.670512).  Saving model ...
Epoch: 5 cost time: 1.8281340599060059
Epoch: 5, Steps: 17 | Train Loss: 0.568 Vali Loss: 0.789 Vali Acc: 0.734 Test Loss: 0.789 Test Acc: 0.734
Validation loss decreased (-0.670512 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 1.7511374950408936
Epoch: 6, Steps: 17 | Train Loss: 0.452 Vali Loss: 0.597 Vali Acc: 0.757 Test Loss: 0.597 Test Acc: 0.757
Validation loss decreased (-0.734096 --> -0.757219).  Saving model ...
Epoch: 7 cost time: 1.9299280643463135
Epoch: 7, Steps: 17 | Train Loss: 0.449 Vali Loss: 1.384 Vali Acc: 0.543 Test Loss: 1.384 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.670912504196167
Epoch: 8, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.748 Vali Acc: 0.699 Test Loss: 0.748 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.7404251098632812
Epoch: 9, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.994 Vali Acc: 0.705 Test Loss: 0.994 Test Acc: 0.705
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9888849258422852
Epoch: 10, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.547 Vali Acc: 0.786 Test Loss: 0.547 Test Acc: 0.786
Validation loss decreased (-0.757219 --> -0.786122).  Saving model ...
Epoch: 11 cost time: 1.955580711364746
Epoch: 11, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.713 Vali Acc: 0.780 Test Loss: 0.713 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9199647903442383
Epoch: 12, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.849 Vali Acc: 0.751 Test Loss: 0.849 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.1782479286193848
Epoch: 13, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.756 Vali Acc: 0.792 Test Loss: 0.756 Test Acc: 0.792
Validation loss decreased (-0.786122 --> -0.791900).  Saving model ...
Epoch: 14 cost time: 1.7300639152526855
Epoch: 14, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.925 Vali Acc: 0.757 Test Loss: 0.925 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0123989582061768
Epoch: 15, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.617 Vali Acc: 0.844 Test Loss: 0.617 Test Acc: 0.844
Validation loss decreased (-0.791900 --> -0.843924).  Saving model ...
Epoch: 16 cost time: 1.8995468616485596
Epoch: 16, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.200 Vali Acc: 0.751 Test Loss: 1.200 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.0344250202178955
Epoch: 17, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.865 Vali Acc: 0.792 Test Loss: 0.865 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9187512397766113
Epoch: 18, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.174 Vali Acc: 0.815 Test Loss: 1.174 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7965776920318604
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.021 Vali Acc: 0.827 Test Loss: 1.021 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.0414161682128906
Epoch: 20, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.633 Vali Acc: 0.723 Test Loss: 1.633 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8847970962524414
Epoch: 21, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.362 Vali Acc: 0.798 Test Loss: 1.362 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.9977121353149414
Epoch: 22, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.973 Vali Acc: 0.861 Test Loss: 0.973 Test Acc: 0.861
Validation loss decreased (-0.843924 --> -0.861262).  Saving model ...
Epoch: 23 cost time: 2.0296285152435303
Epoch: 23, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.058 Vali Acc: 0.809 Test Loss: 1.058 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.997316598892212
Epoch: 24, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.657 Vali Acc: 0.809 Test Loss: 1.657 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.887164831161499
Epoch: 25, Steps: 17 | Train Loss: 0.037 Vali Loss: 2.367 Vali Acc: 0.746 Test Loss: 2.367 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.950256109237671
Epoch: 26, Steps: 17 | Train Loss: 0.076 Vali Loss: 2.623 Vali Acc: 0.746 Test Loss: 2.623 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.939629077911377
Epoch: 27, Steps: 17 | Train Loss: 0.123 Vali Loss: 2.514 Vali Acc: 0.728 Test Loss: 2.514 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9282310009002686
Epoch: 28, Steps: 17 | Train Loss: 0.163 Vali Loss: 2.325 Vali Acc: 0.775 Test Loss: 2.325 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 2.0691235065460205
Epoch: 29, Steps: 17 | Train Loss: 0.030 Vali Loss: 2.030 Vali Acc: 0.803 Test Loss: 2.030 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9619441032409668
Epoch: 30, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.880 Vali Acc: 0.786 Test Loss: 1.880 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.0260634422302246
Epoch: 31, Steps: 17 | Train Loss: 0.058 Vali Loss: 2.499 Vali Acc: 0.751 Test Loss: 2.499 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.1376001834869385
Epoch: 32, Steps: 17 | Train Loss: 0.123 Vali Loss: 1.930 Vali Acc: 0.786 Test Loss: 1.930 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 1307811
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.815239906311035
Epoch: 1, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.641 Vali Acc: 0.306 Test Loss: 1.641 Test Acc: 0.306
Validation loss decreased (inf --> -0.306342).  Saving model ...
Epoch: 2 cost time: 2.1937198638916016
Epoch: 2, Steps: 17 | Train Loss: 1.407 Vali Loss: 1.412 Vali Acc: 0.376 Test Loss: 1.412 Test Acc: 0.376
Validation loss decreased (-0.306342 --> -0.375708).  Saving model ...
Epoch: 3 cost time: 2.036999464035034
Epoch: 3, Steps: 17 | Train Loss: 1.094 Vali Loss: 1.097 Vali Acc: 0.462 Test Loss: 1.097 Test Acc: 0.462
Validation loss decreased (-0.375708 --> -0.462417).  Saving model ...
Epoch: 4 cost time: 2.080685615539551
Epoch: 4, Steps: 17 | Train Loss: 0.881 Vali Loss: 0.998 Vali Acc: 0.636 Test Loss: 0.998 Test Acc: 0.636
Validation loss decreased (-0.462417 --> -0.635828).  Saving model ...
Epoch: 5 cost time: 2.0132105350494385
Epoch: 5, Steps: 17 | Train Loss: 0.740 Vali Loss: 0.845 Vali Acc: 0.740 Test Loss: 0.845 Test Acc: 0.740
Validation loss decreased (-0.635828 --> -0.739876).  Saving model ...
Epoch: 6 cost time: 2.119664192199707
Epoch: 6, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.765 Vali Acc: 0.705 Test Loss: 0.765 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.365879774093628
Epoch: 7, Steps: 17 | Train Loss: 0.623 Vali Loss: 1.291 Vali Acc: 0.549 Test Loss: 1.291 Test Acc: 0.549
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.027439594268799
Epoch: 8, Steps: 17 | Train Loss: 0.463 Vali Loss: 0.873 Vali Acc: 0.636 Test Loss: 0.873 Test Acc: 0.636
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9745190143585205
Epoch: 9, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.903 Vali Acc: 0.699 Test Loss: 0.903 Test Acc: 0.699
EarlyStopping counter: 4 out of 10
Epoch: 10 cost time: 2.1091456413269043
Epoch: 10, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.837 Vali Acc: 0.705 Test Loss: 0.837 Test Acc: 0.705
EarlyStopping counter: 5 out of 10
Epoch: 11 cost time: 1.9383618831634521
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.157 Vali Acc: 0.694 Test Loss: 1.157 Test Acc: 0.694
EarlyStopping counter: 6 out of 10
Epoch: 12 cost time: 2.070080041885376
Epoch: 12, Steps: 17 | Train Loss: 0.211 Vali Loss: 0.864 Vali Acc: 0.734 Test Loss: 0.864 Test Acc: 0.734
EarlyStopping counter: 7 out of 10
Epoch: 13 cost time: 2.17038893699646
Epoch: 13, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.998 Vali Acc: 0.751 Test Loss: 0.998 Test Acc: 0.751
Validation loss decreased (-0.739876 --> -0.751435).  Saving model ...
Epoch: 14 cost time: 2.0688204765319824
Epoch: 14, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.848 Vali Acc: 0.751 Test Loss: 0.848 Test Acc: 0.751
Validation loss decreased (-0.751435 --> -0.751437).  Saving model ...
Epoch: 15 cost time: 2.214813709259033
Epoch: 15, Steps: 17 | Train Loss: 0.263 Vali Loss: 1.261 Vali Acc: 0.751 Test Loss: 1.261 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.02142071723938
Epoch: 16, Steps: 17 | Train Loss: 0.353 Vali Loss: 1.032 Vali Acc: 0.751 Test Loss: 1.032 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.13716459274292
Epoch: 17, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.413 Vali Acc: 0.728 Test Loss: 1.413 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.081367254257202
Epoch: 18, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.920 Vali Acc: 0.769 Test Loss: 0.920 Test Acc: 0.769
Validation loss decreased (-0.751437 --> -0.768777).  Saving model ...
Epoch: 19 cost time: 2.085414171218872
Epoch: 19, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.404 Vali Acc: 0.694 Test Loss: 1.404 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9060959815979004
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.679 Vali Acc: 0.723 Test Loss: 1.679 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.09810471534729
Epoch: 21, Steps: 17 | Train Loss: 0.190 Vali Loss: 1.467 Vali Acc: 0.728 Test Loss: 1.467 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0056111812591553
Epoch: 22, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.163 Vali Acc: 0.786 Test Loss: 1.163 Test Acc: 0.786
Validation loss decreased (-0.768777 --> -0.786116).  Saving model ...
Epoch: 23 cost time: 1.9274773597717285
Epoch: 23, Steps: 17 | Train Loss: 0.094 Vali Loss: 1.156 Vali Acc: 0.780 Test Loss: 1.156 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.039098024368286
Epoch: 24, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.247 Vali Acc: 0.798 Test Loss: 1.247 Test Acc: 0.798
Validation loss decreased (-0.786116 --> -0.797675).  Saving model ...
Epoch: 25 cost time: 1.7167296409606934
Epoch: 25, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.328 Vali Acc: 0.780 Test Loss: 1.328 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7291135787963867
Epoch: 26, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.490 Vali Acc: 0.832 Test Loss: 1.490 Test Acc: 0.832
Validation loss decreased (-0.797675 --> -0.832355).  Saving model ...
Epoch: 27 cost time: 2.150174617767334
Epoch: 27, Steps: 17 | Train Loss: 0.480 Vali Loss: 2.237 Vali Acc: 0.751 Test Loss: 2.237 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.7593905925750732
Epoch: 28, Steps: 17 | Train Loss: 0.172 Vali Loss: 1.280 Vali Acc: 0.809 Test Loss: 1.280 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.968627691268921
Epoch: 29, Steps: 17 | Train Loss: 0.179 Vali Loss: 1.924 Vali Acc: 0.746 Test Loss: 1.924 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.1323835849761963
Epoch: 30, Steps: 17 | Train Loss: 0.149 Vali Loss: 2.624 Vali Acc: 0.757 Test Loss: 2.624 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.8898286819458008
Epoch: 31, Steps: 17 | Train Loss: 0.081 Vali Loss: 2.335 Vali Acc: 0.775 Test Loss: 2.335 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.0944745540618896
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.594 Vali Acc: 0.803 Test Loss: 1.594 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.9846327304840088
Epoch: 33, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.745 Vali Acc: 0.798 Test Loss: 1.745 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 2.058030128479004
Epoch: 34, Steps: 17 | Train Loss: 0.063 Vali Loss: 2.072 Vali Acc: 0.809 Test Loss: 2.072 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.9758358001708984
Epoch: 35, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.614 Vali Acc: 0.775 Test Loss: 2.614 Test Acc: 0.775
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.9841251373291016
Epoch: 36, Steps: 17 | Train Loss: 0.138 Vali Loss: 2.170 Vali Acc: 0.780 Test Loss: 2.170 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 1307811
model size : 7.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.248192310333252
Epoch: 1, Steps: 17 | Train Loss: 1.859 Vali Loss: 1.545 Vali Acc: 0.295 Test Loss: 1.545 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 2.0168919563293457
Epoch: 2, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.237 Vali Acc: 0.532 Test Loss: 1.237 Test Acc: 0.532
Validation loss decreased (-0.294782 --> -0.531780).  Saving model ...
Epoch: 3 cost time: 2.087979555130005
Epoch: 3, Steps: 17 | Train Loss: 0.878 Vali Loss: 0.934 Vali Acc: 0.613 Test Loss: 0.934 Test Acc: 0.613
Validation loss decreased (-0.531780 --> -0.612707).  Saving model ...
Epoch: 4 cost time: 2.082883596420288
Epoch: 4, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.986 Vali Acc: 0.595 Test Loss: 0.986 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.037745475769043
Epoch: 5, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.733 Vali Acc: 0.699 Test Loss: 0.733 Test Acc: 0.699
Validation loss decreased (-0.612707 --> -0.699415).  Saving model ...
Epoch: 6 cost time: 2.3721840381622314
Epoch: 6, Steps: 17 | Train Loss: 0.357 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
Validation loss decreased (-0.699415 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 2.2115654945373535
Epoch: 7, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.617 Vali Acc: 0.786 Test Loss: 0.617 Test Acc: 0.786
Validation loss decreased (-0.751438 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 2.000410795211792
Epoch: 8, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.724 Vali Acc: 0.838 Test Loss: 0.724 Test Acc: 0.838
Validation loss decreased (-0.786121 --> -0.838143).  Saving model ...
Epoch: 9 cost time: 2.1316967010498047
Epoch: 9, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.626 Vali Acc: 0.769 Test Loss: 0.626 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.1213552951812744
Epoch: 10, Steps: 17 | Train Loss: 0.130 Vali Loss: 0.696 Vali Acc: 0.786 Test Loss: 0.696 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.037745237350464
Epoch: 11, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.800 Vali Acc: 0.711 Test Loss: 0.800 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2445099353790283
Epoch: 12, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.679 Vali Acc: 0.809 Test Loss: 0.679 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.1578969955444336
Epoch: 13, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.3124642372131348
Epoch: 14, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.609 Vali Acc: 0.821 Test Loss: 0.609 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.990785837173462
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.876 Vali Acc: 0.803 Test Loss: 0.876 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.202321767807007
Epoch: 16, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.260 Vali Acc: 0.769 Test Loss: 1.260 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 2.0658442974090576
Epoch: 17, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.005 Vali Acc: 0.815 Test Loss: 1.005 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9021742343902588
Epoch: 18, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.060 Vali Acc: 0.803 Test Loss: 1.060 Test Acc: 0.803
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 1045667
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.356374502182007
Epoch: 1, Steps: 17 | Train Loss: 1.856 Vali Loss: 1.547 Vali Acc: 0.289 Test Loss: 1.547 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 1.8118870258331299
Epoch: 2, Steps: 17 | Train Loss: 1.278 Vali Loss: 1.219 Vali Acc: 0.532 Test Loss: 1.219 Test Acc: 0.532
Validation loss decreased (-0.289002 --> -0.531780).  Saving model ...
Epoch: 3 cost time: 1.915553331375122
Epoch: 3, Steps: 17 | Train Loss: 0.894 Vali Loss: 0.954 Vali Acc: 0.607 Test Loss: 0.954 Test Acc: 0.607
Validation loss decreased (-0.531780 --> -0.606927).  Saving model ...
Epoch: 4 cost time: 2.043196678161621
Epoch: 4, Steps: 17 | Train Loss: 0.634 Vali Loss: 1.053 Vali Acc: 0.538 Test Loss: 1.053 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9006359577178955
Epoch: 5, Steps: 17 | Train Loss: 0.514 Vali Loss: 0.819 Vali Acc: 0.659 Test Loss: 0.819 Test Acc: 0.659
Validation loss decreased (-0.606927 --> -0.658951).  Saving model ...
Epoch: 6 cost time: 1.9533898830413818
Epoch: 6, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.638 Vali Acc: 0.763 Test Loss: 0.638 Test Acc: 0.763
Validation loss decreased (-0.658951 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 1.9026753902435303
Epoch: 7, Steps: 17 | Train Loss: 0.329 Vali Loss: 0.726 Vali Acc: 0.751 Test Loss: 0.726 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9470441341400146
Epoch: 8, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.697 Vali Acc: 0.827 Test Loss: 0.697 Test Acc: 0.827
Validation loss decreased (-0.762999 --> -0.826583).  Saving model ...
Epoch: 9 cost time: 1.7539739608764648
Epoch: 9, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.523 Vali Acc: 0.821 Test Loss: 0.523 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8366451263427734
Epoch: 10, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.645 Vali Acc: 0.763 Test Loss: 0.645 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8669664859771729
Epoch: 11, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.960 Vali Acc: 0.769 Test Loss: 0.960 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.7135438919067383
Epoch: 12, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.786 Vali Acc: 0.780 Test Loss: 0.786 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8145411014556885
Epoch: 13, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.791 Vali Acc: 0.844 Test Loss: 0.791 Test Acc: 0.844
Validation loss decreased (-0.826583 --> -0.843923).  Saving model ...
Epoch: 14 cost time: 1.9533436298370361
Epoch: 14, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.069 Vali Acc: 0.769 Test Loss: 1.069 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9448859691619873
Epoch: 15, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.832 Vali Acc: 0.798 Test Loss: 0.832 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9079437255859375
Epoch: 16, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.914 Vali Acc: 0.821 Test Loss: 0.914 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.2498958110809326
Epoch: 17, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.791 Vali Acc: 0.850 Test Loss: 0.791 Test Acc: 0.850
Validation loss decreased (-0.843923 --> -0.849703).  Saving model ...
Epoch: 18 cost time: 1.918421745300293
Epoch: 18, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.742 Vali Acc: 0.821 Test Loss: 0.742 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 2.2309515476226807
Epoch: 19, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.766 Vali Acc: 0.821 Test Loss: 0.766 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.932671070098877
Epoch: 20, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.758 Vali Acc: 0.850 Test Loss: 0.758 Test Acc: 0.850
Validation loss decreased (-0.849703 --> -0.849703).  Saving model ...
Epoch: 21 cost time: 2.102694511413574
Epoch: 21, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.659 Vali Acc: 0.838 Test Loss: 0.659 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 2.0490529537200928
Epoch: 22, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.844 Test Loss: 0.744 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.1381661891937256
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.697 Vali Acc: 0.838 Test Loss: 0.697 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.125241994857788
Epoch: 24, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.705 Vali Acc: 0.838 Test Loss: 0.705 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.1355466842651367
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.703 Vali Acc: 0.832 Test Loss: 0.703 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 2.1424081325531006
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.711 Vali Acc: 0.832 Test Loss: 0.711 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 2.0394017696380615
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.724 Vali Acc: 0.832 Test Loss: 0.724 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.122023344039917
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.0112080574035645
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.720 Vali Acc: 0.832 Test Loss: 0.720 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.1680915355682373
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.844 Test Loss: 0.775 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 1045667
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.265990972518921
Epoch: 1, Steps: 17 | Train Loss: 1.870 Vali Loss: 1.578 Vali Acc: 0.283 Test Loss: 1.578 Test Acc: 0.283
Validation loss decreased (inf --> -0.283221).  Saving model ...
Epoch: 2 cost time: 1.819939374923706
Epoch: 2, Steps: 17 | Train Loss: 1.312 Vali Loss: 1.233 Vali Acc: 0.555 Test Loss: 1.233 Test Acc: 0.555
Validation loss decreased (-0.283221 --> -0.554901).  Saving model ...
Epoch: 3 cost time: 1.8172416687011719
Epoch: 3, Steps: 17 | Train Loss: 0.933 Vali Loss: 0.940 Vali Acc: 0.624 Test Loss: 0.940 Test Acc: 0.624
Validation loss decreased (-0.554901 --> -0.624268).  Saving model ...
Epoch: 4 cost time: 1.7081222534179688
Epoch: 4, Steps: 17 | Train Loss: 0.650 Vali Loss: 0.978 Vali Acc: 0.601 Test Loss: 0.978 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.709475040435791
Epoch: 5, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.763 Vali Acc: 0.728 Test Loss: 0.763 Test Acc: 0.728
Validation loss decreased (-0.624268 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 1.9227051734924316
Epoch: 6, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.643 Vali Acc: 0.775 Test Loss: 0.643 Test Acc: 0.775
Validation loss decreased (-0.728316 --> -0.774560).  Saving model ...
Epoch: 7 cost time: 1.9072554111480713
Epoch: 7, Steps: 17 | Train Loss: 0.371 Vali Loss: 0.778 Vali Acc: 0.734 Test Loss: 0.778 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9938180446624756
Epoch: 8, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.859 Vali Acc: 0.757 Test Loss: 0.859 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.011962890625
Epoch: 9, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.953 Vali Acc: 0.665 Test Loss: 0.953 Test Acc: 0.665
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.8984375
Epoch: 10, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.755 Vali Acc: 0.798 Test Loss: 0.755 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797680).  Saving model ...
Epoch: 11 cost time: 1.7129874229431152
Epoch: 11, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.804 Vali Acc: 0.763 Test Loss: 0.804 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 2.325191020965576
Epoch: 12, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.638 Vali Acc: 0.827 Test Loss: 0.638 Test Acc: 0.827
Validation loss decreased (-0.797680 --> -0.826583).  Saving model ...
Epoch: 13 cost time: 1.9808557033538818
Epoch: 13, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832364).  Saving model ...
Epoch: 14 cost time: 1.6255180835723877
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.738 Vali Acc: 0.827 Test Loss: 0.738 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8748371601104736
Epoch: 15, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.827 Vali Acc: 0.798 Test Loss: 0.827 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9395768642425537
Epoch: 16, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.923 Vali Acc: 0.763 Test Loss: 0.923 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.957561731338501
Epoch: 17, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.032 Vali Acc: 0.815 Test Loss: 1.032 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0755956172943115
Epoch: 18, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.110 Vali Acc: 0.798 Test Loss: 1.110 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.702411413192749
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.891 Vali Acc: 0.844 Test Loss: 0.891 Test Acc: 0.844
Validation loss decreased (-0.832364 --> -0.843922).  Saving model ...
Epoch: 20 cost time: 1.8332200050354004
Epoch: 20, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.750 Vali Acc: 0.786 Test Loss: 1.750 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7740774154663086
Epoch: 21, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.107 Vali Acc: 0.792 Test Loss: 1.107 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 2.1906065940856934
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.418 Vali Acc: 0.780 Test Loss: 1.418 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8610618114471436
Epoch: 23, Steps: 17 | Train Loss: 0.132 Vali Loss: 1.150 Vali Acc: 0.815 Test Loss: 1.150 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.733611822128296
Epoch: 24, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.378 Vali Acc: 0.803 Test Loss: 1.378 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8796639442443848
Epoch: 25, Steps: 17 | Train Loss: 0.077 Vali Loss: 2.447 Vali Acc: 0.757 Test Loss: 2.447 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.87994384765625
Epoch: 26, Steps: 17 | Train Loss: 0.078 Vali Loss: 2.823 Vali Acc: 0.740 Test Loss: 2.823 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7152249813079834
Epoch: 27, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.734 Vali Acc: 0.798 Test Loss: 1.734 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8037688732147217
Epoch: 28, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.927 Vali Acc: 0.798 Test Loss: 1.927 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.8898389339447021
Epoch: 29, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.921 Vali Acc: 0.780 Test Loss: 1.921 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1045667
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9335265159606934
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.642 Vali Acc: 0.272 Test Loss: 1.642 Test Acc: 0.272
Validation loss decreased (inf --> -0.271660).  Saving model ...
Epoch: 2 cost time: 1.7149782180786133
Epoch: 2, Steps: 17 | Train Loss: 1.420 Vali Loss: 1.306 Vali Acc: 0.497 Test Loss: 1.306 Test Acc: 0.497
Validation loss decreased (-0.271660 --> -0.497097).  Saving model ...
Epoch: 3 cost time: 1.9135336875915527
Epoch: 3, Steps: 17 | Train Loss: 1.047 Vali Loss: 1.084 Vali Acc: 0.520 Test Loss: 1.084 Test Acc: 0.520
Validation loss decreased (-0.497097 --> -0.520220).  Saving model ...
Epoch: 4 cost time: 1.692880392074585
Epoch: 4, Steps: 17 | Train Loss: 0.821 Vali Loss: 1.104 Vali Acc: 0.538 Test Loss: 1.104 Test Acc: 0.538
Validation loss decreased (-0.520220 --> -0.537561).  Saving model ...
Epoch: 5 cost time: 1.6950671672821045
Epoch: 5, Steps: 17 | Train Loss: 0.726 Vali Loss: 1.026 Vali Acc: 0.566 Test Loss: 1.026 Test Acc: 0.566
Validation loss decreased (-0.537561 --> -0.566464).  Saving model ...
Epoch: 6 cost time: 1.7349653244018555
Epoch: 6, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.827 Vali Acc: 0.694 Test Loss: 0.827 Test Acc: 0.694
Validation loss decreased (-0.566464 --> -0.693633).  Saving model ...
Epoch: 7 cost time: 1.6751856803894043
Epoch: 7, Steps: 17 | Train Loss: 0.551 Vali Loss: 0.756 Vali Acc: 0.711 Test Loss: 0.756 Test Acc: 0.711
Validation loss decreased (-0.693633 --> -0.710975).  Saving model ...
Epoch: 8 cost time: 1.663071632385254
Epoch: 8, Steps: 17 | Train Loss: 0.413 Vali Loss: 0.922 Vali Acc: 0.647 Test Loss: 0.922 Test Acc: 0.647
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5962014198303223
Epoch: 9, Steps: 17 | Train Loss: 0.413 Vali Loss: 1.050 Vali Acc: 0.584 Test Loss: 1.050 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.696826696395874
Epoch: 10, Steps: 17 | Train Loss: 0.362 Vali Loss: 1.119 Vali Acc: 0.613 Test Loss: 1.119 Test Acc: 0.613
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.752269983291626
Epoch: 11, Steps: 17 | Train Loss: 0.238 Vali Loss: 0.782 Vali Acc: 0.694 Test Loss: 0.782 Test Acc: 0.694
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.7273998260498047
Epoch: 12, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.718 Vali Acc: 0.717 Test Loss: 0.718 Test Acc: 0.717
Validation loss decreased (-0.710975 --> -0.716756).  Saving model ...
Epoch: 13 cost time: 1.839120626449585
Epoch: 13, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.996 Vali Acc: 0.769 Test Loss: 0.996 Test Acc: 0.769
Validation loss decreased (-0.716756 --> -0.768776).  Saving model ...
Epoch: 14 cost time: 1.7470550537109375
Epoch: 14, Steps: 17 | Train Loss: 0.160 Vali Loss: 1.003 Vali Acc: 0.717 Test Loss: 1.003 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8526005744934082
Epoch: 15, Steps: 17 | Train Loss: 0.154 Vali Loss: 0.960 Vali Acc: 0.734 Test Loss: 0.960 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7495510578155518
Epoch: 16, Steps: 17 | Train Loss: 0.242 Vali Loss: 0.742 Vali Acc: 0.792 Test Loss: 0.742 Test Acc: 0.792
Validation loss decreased (-0.768776 --> -0.791900).  Saving model ...
Epoch: 17 cost time: 1.7073559761047363
Epoch: 17, Steps: 17 | Train Loss: 0.139 Vali Loss: 1.114 Vali Acc: 0.751 Test Loss: 1.114 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8279080390930176
Epoch: 18, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.478 Vali Acc: 0.757 Test Loss: 1.478 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.643064022064209
Epoch: 19, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.000 Vali Acc: 0.786 Test Loss: 1.000 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5821866989135742
Epoch: 20, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.361 Vali Acc: 0.769 Test Loss: 1.361 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.5728302001953125
Epoch: 21, Steps: 17 | Train Loss: 0.148 Vali Loss: 1.598 Vali Acc: 0.769 Test Loss: 1.598 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.705160140991211
Epoch: 22, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.231 Vali Acc: 0.798 Test Loss: 1.231 Test Acc: 0.798
Validation loss decreased (-0.791900 --> -0.797676).  Saving model ...
Epoch: 23 cost time: 1.8369872570037842
Epoch: 23, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.704 Vali Acc: 0.746 Test Loss: 1.704 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8749608993530273
Epoch: 24, Steps: 17 | Train Loss: 0.089 Vali Loss: 1.527 Vali Acc: 0.734 Test Loss: 1.527 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8677749633789062
Epoch: 25, Steps: 17 | Train Loss: 0.024 Vali Loss: 2.493 Vali Acc: 0.630 Test Loss: 2.493 Test Acc: 0.630
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.854170322418213
Epoch: 26, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.491 Vali Acc: 0.780 Test Loss: 1.491 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.6208629608154297
Epoch: 27, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.248 Vali Acc: 0.809 Test Loss: 1.248 Test Acc: 0.809
Validation loss decreased (-0.797676 --> -0.809236).  Saving model ...
Epoch: 28 cost time: 1.812150001525879
Epoch: 28, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.216 Vali Acc: 0.763 Test Loss: 2.216 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.907341480255127
Epoch: 29, Steps: 17 | Train Loss: 0.154 Vali Loss: 2.629 Vali Acc: 0.769 Test Loss: 2.629 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9537620544433594
Epoch: 30, Steps: 17 | Train Loss: 0.300 Vali Loss: 2.281 Vali Acc: 0.775 Test Loss: 2.281 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.6677241325378418
Epoch: 31, Steps: 17 | Train Loss: 0.196 Vali Loss: 1.697 Vali Acc: 0.792 Test Loss: 1.697 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.8014204502105713
Epoch: 32, Steps: 17 | Train Loss: 0.217 Vali Loss: 3.029 Vali Acc: 0.763 Test Loss: 3.029 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.7123603820800781
Epoch: 33, Steps: 17 | Train Loss: 0.023 Vali Loss: 2.087 Vali Acc: 0.803 Test Loss: 2.087 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.0283727645874023
Epoch: 34, Steps: 17 | Train Loss: 0.263 Vali Loss: 3.162 Vali Acc: 0.659 Test Loss: 3.162 Test Acc: 0.659
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.8669073581695557
Epoch: 35, Steps: 17 | Train Loss: 0.222 Vali Loss: 2.393 Vali Acc: 0.763 Test Loss: 2.393 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.8854827880859375
Epoch: 36, Steps: 17 | Train Loss: 0.104 Vali Loss: 2.886 Vali Acc: 0.630 Test Loss: 2.886 Test Acc: 0.630
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.9878361225128174
Epoch: 37, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.660 Vali Acc: 0.815 Test Loss: 1.660 Test Acc: 0.815
Validation loss decreased (-0.809236 --> -0.815012).  Saving model ...
Epoch: 38 cost time: 1.9163806438446045
Epoch: 38, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.366 Vali Acc: 0.844 Test Loss: 1.366 Test Acc: 0.844
Validation loss decreased (-0.815012 --> -0.843917).  Saving model ...
Epoch: 39 cost time: 1.8842110633850098
Epoch: 39, Steps: 17 | Train Loss: 0.046 Vali Loss: 3.549 Vali Acc: 0.740 Test Loss: 3.549 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 40 cost time: 1.8909385204315186
Epoch: 40, Steps: 17 | Train Loss: 0.176 Vali Loss: 2.812 Vali Acc: 0.763 Test Loss: 2.812 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 41 cost time: 1.7767658233642578
Epoch: 41, Steps: 17 | Train Loss: 0.443 Vali Loss: 2.819 Vali Acc: 0.775 Test Loss: 2.819 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 42 cost time: 1.8053841590881348
Epoch: 42, Steps: 17 | Train Loss: 0.148 Vali Loss: 3.039 Vali Acc: 0.746 Test Loss: 3.039 Test Acc: 0.746
EarlyStopping counter: 4 out of 10
Epoch: 43 cost time: 1.9220142364501953
Epoch: 43, Steps: 17 | Train Loss: 0.178 Vali Loss: 2.938 Vali Acc: 0.775 Test Loss: 2.938 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 44 cost time: 1.8633060455322266
Epoch: 44, Steps: 17 | Train Loss: 0.224 Vali Loss: 3.135 Vali Acc: 0.821 Test Loss: 3.135 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 45 cost time: 1.7411863803863525
Epoch: 45, Steps: 17 | Train Loss: 0.016 Vali Loss: 3.249 Vali Acc: 0.815 Test Loss: 3.249 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 46 cost time: 1.9037797451019287
Epoch: 46, Steps: 17 | Train Loss: 0.248 Vali Loss: 3.505 Vali Acc: 0.763 Test Loss: 3.505 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 47 cost time: 2.0356802940368652
Epoch: 47, Steps: 17 | Train Loss: 0.076 Vali Loss: 3.099 Vali Acc: 0.798 Test Loss: 3.099 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 48 cost time: 1.8467795848846436
Epoch: 48, Steps: 17 | Train Loss: 0.027 Vali Loss: 5.661 Vali Acc: 0.705 Test Loss: 5.661 Test Acc: 0.705
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 1045667
model size : 6.44MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.014424800872803
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.518 Vali Acc: 0.353 Test Loss: 1.518 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 2.0416419506073
Epoch: 2, Steps: 17 | Train Loss: 1.263 Vali Loss: 1.261 Vali Acc: 0.514 Test Loss: 1.261 Test Acc: 0.514
Validation loss decreased (-0.352586 --> -0.514438).  Saving model ...
Epoch: 3 cost time: 1.7580370903015137
Epoch: 3, Steps: 17 | Train Loss: 0.897 Vali Loss: 1.115 Vali Acc: 0.549 Test Loss: 1.115 Test Acc: 0.549
Validation loss decreased (-0.514438 --> -0.549122).  Saving model ...
Epoch: 4 cost time: 2.09818172454834
Epoch: 4, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.877 Vali Acc: 0.630 Test Loss: 0.877 Test Acc: 0.630
Validation loss decreased (-0.549122 --> -0.630049).  Saving model ...
Epoch: 5 cost time: 1.8133697509765625
Epoch: 5, Steps: 17 | Train Loss: 0.550 Vali Loss: 1.005 Vali Acc: 0.676 Test Loss: 1.005 Test Acc: 0.676
Validation loss decreased (-0.630049 --> -0.676291).  Saving model ...
Epoch: 6 cost time: 2.1694064140319824
Epoch: 6, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.910 Vali Acc: 0.595 Test Loss: 0.910 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0480809211730957
Epoch: 7, Steps: 17 | Train Loss: 0.309 Vali Loss: 0.594 Vali Acc: 0.769 Test Loss: 0.594 Test Acc: 0.769
Validation loss decreased (-0.676291 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 2.0372767448425293
Epoch: 8, Steps: 17 | Train Loss: 0.168 Vali Loss: 0.561 Vali Acc: 0.803 Test Loss: 0.561 Test Acc: 0.803
Validation loss decreased (-0.768780 --> -0.803463).  Saving model ...
Epoch: 9 cost time: 2.2946810722351074
Epoch: 9, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.598 Vali Acc: 0.832 Test Loss: 0.598 Test Acc: 0.832
Validation loss decreased (-0.803463 --> -0.832364).  Saving model ...
Epoch: 10 cost time: 2.296801805496216
Epoch: 10, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.836 Vali Acc: 0.798 Test Loss: 0.836 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.101607084274292
Epoch: 11, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.711 Vali Acc: 0.815 Test Loss: 0.711 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.096099615097046
Epoch: 12, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.777 Vali Acc: 0.832 Test Loss: 0.777 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.2173609733581543
Epoch: 13, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.067 Vali Acc: 0.803 Test Loss: 1.067 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.13777756690979
Epoch: 14, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.801 Vali Acc: 0.838 Test Loss: 0.801 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838142).  Saving model ...
Epoch: 15 cost time: 2.082517385482788
Epoch: 15, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.727 Vali Acc: 0.838 Test Loss: 0.727 Test Acc: 0.838
Validation loss decreased (-0.838142 --> -0.838143).  Saving model ...
Epoch: 16 cost time: 2.0706567764282227
Epoch: 16, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.203 Vali Acc: 0.792 Test Loss: 1.203 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1508548259735107
Epoch: 17, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.926 Vali Acc: 0.809 Test Loss: 0.926 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.2139744758605957
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.077 Vali Acc: 0.780 Test Loss: 1.077 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.038975715637207
Epoch: 19, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.877 Vali Acc: 0.815 Test Loss: 0.877 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7797589302062988
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.883 Vali Acc: 0.792 Test Loss: 0.883 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.0167367458343506
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.155 Vali Acc: 0.803 Test Loss: 1.155 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.8650081157684326
Epoch: 22, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.197 Vali Acc: 0.844 Test Loss: 1.197 Test Acc: 0.844
Validation loss decreased (-0.838143 --> -0.843919).  Saving model ...
Epoch: 23 cost time: 1.981874942779541
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.429 Vali Acc: 0.815 Test Loss: 1.429 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.728395700454712
Epoch: 24, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.291 Vali Acc: 0.757 Test Loss: 1.291 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.973097801208496
Epoch: 25, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.773 Vali Acc: 0.786 Test Loss: 1.773 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.5809166431427002
Epoch: 26, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.218 Vali Acc: 0.827 Test Loss: 1.218 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.554567575454712
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.618 Vali Acc: 0.809 Test Loss: 1.618 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.5705366134643555
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.730 Vali Acc: 0.798 Test Loss: 1.730 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.8978519439697266
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.319 Vali Acc: 0.821 Test Loss: 1.319 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.9485104084014893
Epoch: 30, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.622 Vali Acc: 0.827 Test Loss: 1.622 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.9805631637573242
Epoch: 31, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.405 Vali Acc: 0.838 Test Loss: 1.405 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 2.0348384380340576
Epoch: 32, Steps: 17 | Train Loss: 0.187 Vali Loss: 3.081 Vali Acc: 0.723 Test Loss: 3.081 Test Acc: 0.723
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 914595
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.523726463317871
Epoch: 1, Steps: 17 | Train Loss: 1.860 Vali Loss: 1.533 Vali Acc: 0.335 Test Loss: 1.533 Test Acc: 0.335
Validation loss decreased (inf --> -0.335245).  Saving model ...
Epoch: 2 cost time: 1.8748974800109863
Epoch: 2, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.275 Vali Acc: 0.532 Test Loss: 1.275 Test Acc: 0.532
Validation loss decreased (-0.335245 --> -0.531779).  Saving model ...
Epoch: 3 cost time: 2.0784831047058105
Epoch: 3, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.125 Vali Acc: 0.566 Test Loss: 1.125 Test Acc: 0.566
Validation loss decreased (-0.531779 --> -0.566463).  Saving model ...
Epoch: 4 cost time: 1.830930233001709
Epoch: 4, Steps: 17 | Train Loss: 0.733 Vali Loss: 0.960 Vali Acc: 0.584 Test Loss: 0.960 Test Acc: 0.584
Validation loss decreased (-0.566463 --> -0.583805).  Saving model ...
Epoch: 5 cost time: 1.9134013652801514
Epoch: 5, Steps: 17 | Train Loss: 0.593 Vali Loss: 0.966 Vali Acc: 0.647 Test Loss: 0.966 Test Acc: 0.647
Validation loss decreased (-0.583805 --> -0.647389).  Saving model ...
Epoch: 6 cost time: 2.0382795333862305
Epoch: 6, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.856 Vali Acc: 0.618 Test Loss: 0.856 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.8901069164276123
Epoch: 7, Steps: 17 | Train Loss: 0.338 Vali Loss: 0.616 Vali Acc: 0.769 Test Loss: 0.616 Test Acc: 0.769
Validation loss decreased (-0.647389 --> -0.768780).  Saving model ...
Epoch: 8 cost time: 1.9970757961273193
Epoch: 8, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.549 Vali Acc: 0.832 Test Loss: 0.549 Test Acc: 0.832
Validation loss decreased (-0.768780 --> -0.832364).  Saving model ...
Epoch: 9 cost time: 1.9753985404968262
Epoch: 9, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.731 Vali Acc: 0.815 Test Loss: 0.731 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9825289249420166
Epoch: 10, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.840 Vali Acc: 0.775 Test Loss: 0.840 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.189582347869873
Epoch: 11, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.784 Vali Acc: 0.786 Test Loss: 0.784 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8321025371551514
Epoch: 12, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.807 Vali Acc: 0.798 Test Loss: 0.807 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.0327584743499756
Epoch: 13, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.985 Vali Acc: 0.786 Test Loss: 0.985 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0394229888916016
Epoch: 14, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.259 Vali Acc: 0.775 Test Loss: 1.259 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1528677940368652
Epoch: 15, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.817 Vali Acc: 0.723 Test Loss: 1.817 Test Acc: 0.723
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9474701881408691
Epoch: 16, Steps: 17 | Train Loss: 0.100 Vali Loss: 0.841 Vali Acc: 0.838 Test Loss: 0.841 Test Acc: 0.838
Validation loss decreased (-0.832364 --> -0.838142).  Saving model ...
Epoch: 17 cost time: 1.7533516883850098
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.230 Vali Acc: 0.769 Test Loss: 1.230 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.0186989307403564
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 1.669 Vali Acc: 0.746 Test Loss: 1.669 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.902019739151001
Epoch: 19, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.479 Vali Acc: 0.798 Test Loss: 1.479 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.0594546794891357
Epoch: 20, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.170 Vali Acc: 0.803 Test Loss: 1.170 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.029385805130005
Epoch: 21, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.405 Vali Acc: 0.827 Test Loss: 1.405 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9339332580566406
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.592 Vali Acc: 0.780 Test Loss: 1.592 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9775810241699219
Epoch: 23, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.644 Vali Acc: 0.751 Test Loss: 1.644 Test Acc: 0.751
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 2.017627239227295
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.120 Vali Acc: 0.850 Test Loss: 1.120 Test Acc: 0.850
Validation loss decreased (-0.838142 --> -0.849700).  Saving model ...
Epoch: 25 cost time: 2.0398855209350586
Epoch: 25, Steps: 17 | Train Loss: 0.090 Vali Loss: 1.696 Vali Acc: 0.844 Test Loss: 1.696 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7259998321533203
Epoch: 26, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.975 Vali Acc: 0.832 Test Loss: 0.975 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0071699619293213
Epoch: 27, Steps: 17 | Train Loss: 0.120 Vali Loss: 2.273 Vali Acc: 0.763 Test Loss: 2.273 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9060249328613281
Epoch: 28, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.298 Vali Acc: 0.827 Test Loss: 1.298 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.077251434326172
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.458 Vali Acc: 0.809 Test Loss: 1.458 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9792487621307373
Epoch: 30, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.366 Vali Acc: 0.827 Test Loss: 1.366 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.7614524364471436
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.718 Vali Acc: 0.803 Test Loss: 1.718 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9383065700531006
Epoch: 32, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.217 Vali Acc: 0.832 Test Loss: 1.217 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.142127513885498
Epoch: 33, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.437 Vali Acc: 0.786 Test Loss: 1.437 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.8248045444488525
Epoch: 34, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.908 Vali Acc: 0.798 Test Loss: 1.908 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 914595
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.060822010040283
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.566 Vali Acc: 0.335 Test Loss: 1.566 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 1.6850130558013916
Epoch: 2, Steps: 17 | Train Loss: 1.291 Vali Loss: 1.296 Vali Acc: 0.497 Test Loss: 1.296 Test Acc: 0.497
Validation loss decreased (-0.335244 --> -0.497097).  Saving model ...
Epoch: 3 cost time: 1.9344847202301025
Epoch: 3, Steps: 17 | Train Loss: 0.934 Vali Loss: 1.219 Vali Acc: 0.538 Test Loss: 1.219 Test Acc: 0.538
Validation loss decreased (-0.497097 --> -0.537560).  Saving model ...
Epoch: 4 cost time: 1.7386367321014404
Epoch: 4, Steps: 17 | Train Loss: 0.777 Vali Loss: 0.997 Vali Acc: 0.578 Test Loss: 0.997 Test Acc: 0.578
Validation loss decreased (-0.537560 --> -0.578025).  Saving model ...
Epoch: 5 cost time: 1.7553644180297852
Epoch: 5, Steps: 17 | Train Loss: 0.668 Vali Loss: 0.839 Vali Acc: 0.636 Test Loss: 0.839 Test Acc: 0.636
Validation loss decreased (-0.578025 --> -0.635830).  Saving model ...
Epoch: 6 cost time: 1.822761058807373
Epoch: 6, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.854 Vali Acc: 0.618 Test Loss: 0.854 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0044009685516357
Epoch: 7, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.701 Vali Acc: 0.751 Test Loss: 0.701 Test Acc: 0.751
Validation loss decreased (-0.635830 --> -0.751438).  Saving model ...
Epoch: 8 cost time: 2.130049705505371
Epoch: 8, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.684 Vali Acc: 0.792 Test Loss: 0.684 Test Acc: 0.792
Validation loss decreased (-0.751438 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 1.8717808723449707
Epoch: 9, Steps: 17 | Train Loss: 0.230 Vali Loss: 0.759 Vali Acc: 0.775 Test Loss: 0.759 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6953887939453125
Epoch: 10, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.917 Vali Acc: 0.746 Test Loss: 0.917 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.025116443634033
Epoch: 11, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.659 Vali Acc: 0.786 Test Loss: 0.659 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.044818878173828
Epoch: 12, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.777 Vali Acc: 0.763 Test Loss: 0.777 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.9208762645721436
Epoch: 13, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.941 Vali Acc: 0.809 Test Loss: 0.941 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809239).  Saving model ...
Epoch: 14 cost time: 1.9892027378082275
Epoch: 14, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.918 Vali Acc: 0.803 Test Loss: 0.918 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9419457912445068
Epoch: 15, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.789 Vali Acc: 0.832 Test Loss: 0.789 Test Acc: 0.832
Validation loss decreased (-0.809239 --> -0.832362).  Saving model ...
Epoch: 16 cost time: 2.0540683269500732
Epoch: 16, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.782 Vali Acc: 0.844 Test Loss: 0.782 Test Acc: 0.844
Validation loss decreased (-0.832362 --> -0.843923).  Saving model ...
Epoch: 17 cost time: 1.967763900756836
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 1.583 Vali Acc: 0.763 Test Loss: 1.583 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9260873794555664
Epoch: 18, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.003 Vali Acc: 0.786 Test Loss: 1.003 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.9571967124938965
Epoch: 19, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.149 Vali Acc: 0.821 Test Loss: 1.149 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.038931131362915
Epoch: 20, Steps: 17 | Train Loss: 0.147 Vali Loss: 1.233 Vali Acc: 0.798 Test Loss: 1.233 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.858412742614746
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.757 Vali Acc: 0.757 Test Loss: 1.757 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1296563148498535
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.432 Vali Acc: 0.809 Test Loss: 1.432 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.1461517810821533
Epoch: 23, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.131 Vali Acc: 0.798 Test Loss: 1.131 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.995579719543457
Epoch: 24, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.849 Vali Acc: 0.769 Test Loss: 1.849 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.041660785675049
Epoch: 25, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.640 Vali Acc: 0.809 Test Loss: 1.640 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.9686095714569092
Epoch: 26, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.457 Vali Acc: 0.775 Test Loss: 1.457 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 914595
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8930351734161377
Epoch: 1, Steps: 17 | Train Loss: 1.892 Vali Loss: 1.639 Vali Acc: 0.324 Test Loss: 1.639 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 1.8106138706207275
Epoch: 2, Steps: 17 | Train Loss: 1.398 Vali Loss: 1.328 Vali Acc: 0.416 Test Loss: 1.328 Test Acc: 0.416
Validation loss decreased (-0.323683 --> -0.416172).  Saving model ...
Epoch: 3 cost time: 1.7924187183380127
Epoch: 3, Steps: 17 | Train Loss: 1.078 Vali Loss: 1.222 Vali Acc: 0.497 Test Loss: 1.222 Test Acc: 0.497
Validation loss decreased (-0.416172 --> -0.497098).  Saving model ...
Epoch: 4 cost time: 2.020317554473877
Epoch: 4, Steps: 17 | Train Loss: 0.956 Vali Loss: 1.109 Vali Acc: 0.491 Test Loss: 1.109 Test Acc: 0.491
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8344955444335938
Epoch: 5, Steps: 17 | Train Loss: 0.790 Vali Loss: 0.990 Vali Acc: 0.572 Test Loss: 0.990 Test Acc: 0.572
Validation loss decreased (-0.497098 --> -0.572244).  Saving model ...
Epoch: 6 cost time: 1.9869928359985352
Epoch: 6, Steps: 17 | Train Loss: 0.651 Vali Loss: 0.856 Vali Acc: 0.659 Test Loss: 0.856 Test Acc: 0.659
Validation loss decreased (-0.572244 --> -0.658951).  Saving model ...
Epoch: 7 cost time: 1.7921102046966553
Epoch: 7, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.828 Vali Acc: 0.671 Test Loss: 0.828 Test Acc: 0.671
Validation loss decreased (-0.658951 --> -0.670512).  Saving model ...
Epoch: 8 cost time: 2.104335308074951
Epoch: 8, Steps: 17 | Train Loss: 0.449 Vali Loss: 0.813 Vali Acc: 0.723 Test Loss: 0.813 Test Acc: 0.723
Validation loss decreased (-0.670512 --> -0.722535).  Saving model ...
Epoch: 9 cost time: 1.9261136054992676
Epoch: 9, Steps: 17 | Train Loss: 0.342 Vali Loss: 0.701 Vali Acc: 0.746 Test Loss: 0.701 Test Acc: 0.746
Validation loss decreased (-0.722535 --> -0.745658).  Saving model ...
Epoch: 10 cost time: 1.8034894466400146
Epoch: 10, Steps: 17 | Train Loss: 0.332 Vali Loss: 0.915 Vali Acc: 0.780 Test Loss: 0.915 Test Acc: 0.780
Validation loss decreased (-0.745658 --> -0.780338).  Saving model ...
Epoch: 11 cost time: 2.0188331604003906
Epoch: 11, Steps: 17 | Train Loss: 0.302 Vali Loss: 0.677 Vali Acc: 0.803 Test Loss: 0.677 Test Acc: 0.803
Validation loss decreased (-0.780338 --> -0.803461).  Saving model ...
Epoch: 12 cost time: 1.6232967376708984
Epoch: 12, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.874 Vali Acc: 0.740 Test Loss: 0.874 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9228219985961914
Epoch: 13, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.733 Vali Acc: 0.780 Test Loss: 0.733 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8481810092926025
Epoch: 14, Steps: 17 | Train Loss: 0.104 Vali Loss: 1.118 Vali Acc: 0.757 Test Loss: 1.118 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.92274808883667
Epoch: 15, Steps: 17 | Train Loss: 0.228 Vali Loss: 1.150 Vali Acc: 0.775 Test Loss: 1.150 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.816993236541748
Epoch: 16, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.943 Vali Acc: 0.763 Test Loss: 0.943 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.8932549953460693
Epoch: 17, Steps: 17 | Train Loss: 0.177 Vali Loss: 1.727 Vali Acc: 0.636 Test Loss: 1.727 Test Acc: 0.636
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6682078838348389
Epoch: 18, Steps: 17 | Train Loss: 0.380 Vali Loss: 1.545 Vali Acc: 0.705 Test Loss: 1.545 Test Acc: 0.705
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.9620096683502197
Epoch: 19, Steps: 17 | Train Loss: 0.151 Vali Loss: 1.236 Vali Acc: 0.769 Test Loss: 1.236 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.7279913425445557
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.045 Vali Acc: 0.769 Test Loss: 1.045 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.7230992317199707
Epoch: 21, Steps: 17 | Train Loss: 0.157 Vali Loss: 0.937 Vali Acc: 0.798 Test Loss: 0.937 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8034682080924855
model parameter : 914595
model size : 5.94MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.067729949951172
Epoch: 1, Steps: 17 | Train Loss: 1.866 Vali Loss: 1.534 Vali Acc: 0.324 Test Loss: 1.534 Test Acc: 0.324
Validation loss decreased (inf --> -0.323684).  Saving model ...
Epoch: 2 cost time: 1.937448501586914
Epoch: 2, Steps: 17 | Train Loss: 1.297 Vali Loss: 1.192 Vali Acc: 0.428 Test Loss: 1.192 Test Acc: 0.428
Validation loss decreased (-0.323684 --> -0.427734).  Saving model ...
Epoch: 3 cost time: 1.928431510925293
Epoch: 3, Steps: 17 | Train Loss: 0.939 Vali Loss: 0.943 Vali Acc: 0.676 Test Loss: 0.943 Test Acc: 0.676
Validation loss decreased (-0.427734 --> -0.676291).  Saving model ...
Epoch: 4 cost time: 1.7476000785827637
Epoch: 4, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.976 Vali Acc: 0.636 Test Loss: 0.976 Test Acc: 0.636
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.948127031326294
Epoch: 5, Steps: 17 | Train Loss: 0.583 Vali Loss: 0.694 Vali Acc: 0.740 Test Loss: 0.694 Test Acc: 0.740
Validation loss decreased (-0.676291 --> -0.739877).  Saving model ...
Epoch: 6 cost time: 1.8056843280792236
Epoch: 6, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.662 Vali Acc: 0.723 Test Loss: 0.662 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9394326210021973
Epoch: 7, Steps: 17 | Train Loss: 0.313 Vali Loss: 0.609 Vali Acc: 0.786 Test Loss: 0.609 Test Acc: 0.786
Validation loss decreased (-0.739877 --> -0.786121).  Saving model ...
Epoch: 8 cost time: 1.943795919418335
Epoch: 8, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.611 Vali Acc: 0.763 Test Loss: 0.611 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9083735942840576
Epoch: 9, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.471 Vali Acc: 0.832 Test Loss: 0.471 Test Acc: 0.832
Validation loss decreased (-0.786121 --> -0.832365).  Saving model ...
Epoch: 10 cost time: 1.9515492916107178
Epoch: 10, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.739 Vali Acc: 0.798 Test Loss: 0.739 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9548697471618652
Epoch: 11, Steps: 17 | Train Loss: 0.102 Vali Loss: 0.975 Vali Acc: 0.786 Test Loss: 0.975 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.058701276779175
Epoch: 12, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.939 Vali Acc: 0.780 Test Loss: 0.939 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8439669609069824
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.573 Vali Acc: 0.821 Test Loss: 0.573 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9888644218444824
Epoch: 14, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.539 Vali Acc: 0.838 Test Loss: 0.539 Test Acc: 0.838
Validation loss decreased (-0.832365 --> -0.838145).  Saving model ...
Epoch: 15 cost time: 1.829662561416626
Epoch: 15, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.767 Vali Acc: 0.815 Test Loss: 0.767 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 2.041933059692383
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.568 Vali Acc: 0.855 Test Loss: 0.568 Test Acc: 0.855
Validation loss decreased (-0.838145 --> -0.855486).  Saving model ...
Epoch: 17 cost time: 2.0324525833129883
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.874 Vali Acc: 0.821 Test Loss: 0.874 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7171223163604736
Epoch: 18, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.687 Vali Acc: 0.838 Test Loss: 0.687 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.7381041049957275
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.881 Vali Acc: 0.803 Test Loss: 0.881 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9882094860076904
Epoch: 20, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.798 Vali Acc: 0.827 Test Loss: 0.798 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 2.055595874786377
Epoch: 21, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.417 Vali Acc: 0.746 Test Loss: 1.417 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.083998680114746
Epoch: 22, Steps: 17 | Train Loss: 0.171 Vali Loss: 0.889 Vali Acc: 0.809 Test Loss: 0.889 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9571034908294678
Epoch: 23, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.228 Vali Acc: 0.740 Test Loss: 1.228 Test Acc: 0.740
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.929225206375122
Epoch: 24, Steps: 17 | Train Loss: 0.092 Vali Loss: 1.311 Vali Acc: 0.809 Test Loss: 1.311 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 2.174065589904785
Epoch: 25, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.111 Vali Acc: 0.815 Test Loss: 1.111 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.841491937637329
Epoch: 26, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.765 Vali Acc: 0.769 Test Loss: 1.765 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 849059
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.02735161781311
Epoch: 1, Steps: 17 | Train Loss: 1.847 Vali Loss: 1.538 Vali Acc: 0.382 Test Loss: 1.538 Test Acc: 0.382
Validation loss decreased (inf --> -0.381488).  Saving model ...
Epoch: 2 cost time: 2.1937148571014404
Epoch: 2, Steps: 17 | Train Loss: 1.309 Vali Loss: 1.216 Vali Acc: 0.410 Test Loss: 1.216 Test Acc: 0.410
Validation loss decreased (-0.381488 --> -0.410392).  Saving model ...
Epoch: 3 cost time: 1.9903926849365234
Epoch: 3, Steps: 17 | Train Loss: 0.951 Vali Loss: 0.979 Vali Acc: 0.676 Test Loss: 0.979 Test Acc: 0.676
Validation loss decreased (-0.410392 --> -0.676291).  Saving model ...
Epoch: 4 cost time: 2.1703433990478516
Epoch: 4, Steps: 17 | Train Loss: 0.911 Vali Loss: 1.098 Vali Acc: 0.543 Test Loss: 1.098 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.936249017715454
Epoch: 5, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.842 Vali Acc: 0.694 Test Loss: 0.842 Test Acc: 0.694
Validation loss decreased (-0.676291 --> -0.693633).  Saving model ...
Epoch: 6 cost time: 2.2134268283843994
Epoch: 6, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.816 Vali Acc: 0.676 Test Loss: 0.816 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.013012170791626
Epoch: 7, Steps: 17 | Train Loss: 0.396 Vali Loss: 0.633 Vali Acc: 0.792 Test Loss: 0.633 Test Acc: 0.792
Validation loss decreased (-0.693633 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 2.0557618141174316
Epoch: 8, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.646 Vali Acc: 0.786 Test Loss: 0.646 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9325194358825684
Epoch: 9, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.550 Vali Acc: 0.838 Test Loss: 0.550 Test Acc: 0.838
Validation loss decreased (-0.791901 --> -0.838145).  Saving model ...
Epoch: 10 cost time: 2.0932841300964355
Epoch: 10, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.528 Vali Acc: 0.838 Test Loss: 0.528 Test Acc: 0.838
Validation loss decreased (-0.838145 --> -0.838145).  Saving model ...
Epoch: 11 cost time: 2.1902377605438232
Epoch: 11, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.879 Vali Acc: 0.763 Test Loss: 0.879 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9260177612304688
Epoch: 12, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.894 Vali Acc: 0.798 Test Loss: 0.894 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 2.040747880935669
Epoch: 13, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.756 Vali Acc: 0.780 Test Loss: 0.756 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9774444103240967
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.929 Vali Acc: 0.803 Test Loss: 0.929 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.1840803623199463
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.862 Vali Acc: 0.763 Test Loss: 0.862 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 2.068887710571289
Epoch: 16, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.800 Vali Acc: 0.803 Test Loss: 0.800 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 2.0192253589630127
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.964 Vali Acc: 0.821 Test Loss: 0.964 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 2.3580281734466553
Epoch: 18, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.942 Vali Acc: 0.792 Test Loss: 0.942 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.9890491962432861
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.936 Vali Acc: 0.803 Test Loss: 0.936 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 2.035447835922241
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.777 Vali Acc: 0.827 Test Loss: 0.777 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 849059
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.771796464920044
Epoch: 1, Steps: 17 | Train Loss: 1.887 Vali Loss: 1.561 Vali Acc: 0.353 Test Loss: 1.561 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 1.9726901054382324
Epoch: 2, Steps: 17 | Train Loss: 1.356 Vali Loss: 1.216 Vali Acc: 0.439 Test Loss: 1.216 Test Acc: 0.439
Validation loss decreased (-0.352586 --> -0.439294).  Saving model ...
Epoch: 3 cost time: 2.0196707248687744
Epoch: 3, Steps: 17 | Train Loss: 0.966 Vali Loss: 0.991 Vali Acc: 0.613 Test Loss: 0.991 Test Acc: 0.613
Validation loss decreased (-0.439294 --> -0.612707).  Saving model ...
Epoch: 4 cost time: 1.9514212608337402
Epoch: 4, Steps: 17 | Train Loss: 0.890 Vali Loss: 1.079 Vali Acc: 0.532 Test Loss: 1.079 Test Acc: 0.532
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.083054780960083
Epoch: 5, Steps: 17 | Train Loss: 0.614 Vali Loss: 0.740 Vali Acc: 0.723 Test Loss: 0.740 Test Acc: 0.723
Validation loss decreased (-0.612707 --> -0.722536).  Saving model ...
Epoch: 6 cost time: 1.9012353420257568
Epoch: 6, Steps: 17 | Train Loss: 0.415 Vali Loss: 0.769 Vali Acc: 0.705 Test Loss: 0.769 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9947988986968994
Epoch: 7, Steps: 17 | Train Loss: 0.383 Vali Loss: 0.723 Vali Acc: 0.746 Test Loss: 0.723 Test Acc: 0.746
Validation loss decreased (-0.722536 --> -0.745658).  Saving model ...
Epoch: 8 cost time: 1.7944221496582031
Epoch: 8, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.789 Vali Acc: 0.740 Test Loss: 0.789 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 2.0622520446777344
Epoch: 9, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.580 Vali Acc: 0.803 Test Loss: 0.580 Test Acc: 0.803
Validation loss decreased (-0.745658 --> -0.803462).  Saving model ...
Epoch: 10 cost time: 1.9201922416687012
Epoch: 10, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.724 Vali Acc: 0.775 Test Loss: 0.724 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.046963691711426
Epoch: 11, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.002 Vali Acc: 0.746 Test Loss: 1.002 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8946077823638916
Epoch: 12, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.948 Vali Acc: 0.740 Test Loss: 0.948 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0767674446105957
Epoch: 13, Steps: 17 | Train Loss: 0.132 Vali Loss: 0.873 Vali Acc: 0.763 Test Loss: 0.873 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.9382271766662598
Epoch: 14, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.014 Vali Acc: 0.728 Test Loss: 1.014 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 15 cost time: 1.738471508026123
Epoch: 15, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.827 Vali Acc: 0.803 Test Loss: 0.827 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 16 cost time: 1.8215391635894775
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.776 Vali Acc: 0.809 Test Loss: 0.776 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809241).  Saving model ...
Epoch: 17 cost time: 1.969522476196289
Epoch: 17, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.962 Vali Acc: 0.798 Test Loss: 0.962 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9995663166046143
Epoch: 18, Steps: 17 | Train Loss: 0.155 Vali Loss: 1.995 Vali Acc: 0.734 Test Loss: 1.995 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 2.1014137268066406
Epoch: 19, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.741 Vali Acc: 0.751 Test Loss: 1.741 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 2.3080873489379883
Epoch: 20, Steps: 17 | Train Loss: 0.135 Vali Loss: 1.414 Vali Acc: 0.786 Test Loss: 1.414 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9574649333953857
Epoch: 21, Steps: 17 | Train Loss: 0.105 Vali Loss: 1.059 Vali Acc: 0.798 Test Loss: 1.059 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.1656687259674072
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.333 Vali Acc: 0.792 Test Loss: 1.333 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9808506965637207
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.457 Vali Acc: 0.792 Test Loss: 1.457 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.877310037612915
Epoch: 24, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.258 Vali Acc: 0.838 Test Loss: 1.258 Test Acc: 0.838
Validation loss decreased (-0.809241 --> -0.838138).  Saving model ...
Epoch: 25 cost time: 1.9659805297851562
Epoch: 25, Steps: 17 | Train Loss: 0.085 Vali Loss: 1.374 Vali Acc: 0.803 Test Loss: 1.374 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 2.377249002456665
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.542 Vali Acc: 0.786 Test Loss: 1.542 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.071406364440918
Epoch: 27, Steps: 17 | Train Loss: 0.042 Vali Loss: 1.826 Vali Acc: 0.803 Test Loss: 1.826 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.288012742996216
Epoch: 28, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.495 Vali Acc: 0.809 Test Loss: 1.495 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1463074684143066
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.679 Vali Acc: 0.815 Test Loss: 1.679 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.0684750080108643
Epoch: 30, Steps: 17 | Train Loss: 0.124 Vali Loss: 2.439 Vali Acc: 0.763 Test Loss: 2.439 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.1035518646240234
Epoch: 31, Steps: 17 | Train Loss: 0.107 Vali Loss: 2.594 Vali Acc: 0.728 Test Loss: 2.594 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.0810723304748535
Epoch: 32, Steps: 17 | Train Loss: 0.072 Vali Loss: 1.399 Vali Acc: 0.815 Test Loss: 1.399 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.179464101791382
Epoch: 33, Steps: 17 | Train Loss: 0.068 Vali Loss: 2.267 Vali Acc: 0.751 Test Loss: 2.267 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.197141408920288
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.985 Vali Acc: 0.780 Test Loss: 1.985 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 849059
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.055651903152466
Epoch: 1, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.637 Vali Acc: 0.358 Test Loss: 1.637 Test Acc: 0.358
Validation loss decreased (inf --> -0.358365).  Saving model ...
Epoch: 2 cost time: 2.0789682865142822
Epoch: 2, Steps: 17 | Train Loss: 1.421 Vali Loss: 1.295 Vali Acc: 0.410 Test Loss: 1.295 Test Acc: 0.410
Validation loss decreased (-0.358365 --> -0.410392).  Saving model ...
Epoch: 3 cost time: 1.8084933757781982
Epoch: 3, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.135 Vali Acc: 0.572 Test Loss: 1.135 Test Acc: 0.572
Validation loss decreased (-0.410392 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 1.8557143211364746
Epoch: 4, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.325 Vali Acc: 0.486 Test Loss: 1.325 Test Acc: 0.486
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 2.197305202484131
Epoch: 5, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.938 Vali Acc: 0.624 Test Loss: 0.938 Test Acc: 0.624
Validation loss decreased (-0.572243 --> -0.624268).  Saving model ...
Epoch: 6 cost time: 1.7024095058441162
Epoch: 6, Steps: 17 | Train Loss: 0.576 Vali Loss: 0.913 Vali Acc: 0.624 Test Loss: 0.913 Test Acc: 0.624
Validation loss decreased (-0.624268 --> -0.624268).  Saving model ...
Epoch: 7 cost time: 1.849740743637085
Epoch: 7, Steps: 17 | Train Loss: 0.567 Vali Loss: 0.962 Vali Acc: 0.671 Test Loss: 0.962 Test Acc: 0.671
Validation loss decreased (-0.624268 --> -0.670511).  Saving model ...
Epoch: 8 cost time: 2.0066826343536377
Epoch: 8, Steps: 17 | Train Loss: 0.446 Vali Loss: 0.870 Vali Acc: 0.676 Test Loss: 0.870 Test Acc: 0.676
Validation loss decreased (-0.670511 --> -0.676292).  Saving model ...
Epoch: 9 cost time: 1.81636643409729
Epoch: 9, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.817 Vali Acc: 0.717 Test Loss: 0.817 Test Acc: 0.717
Validation loss decreased (-0.676292 --> -0.716755).  Saving model ...
Epoch: 10 cost time: 1.8627104759216309
Epoch: 10, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.793 Vali Acc: 0.763 Test Loss: 0.793 Test Acc: 0.763
Validation loss decreased (-0.716755 --> -0.762998).  Saving model ...
Epoch: 11 cost time: 1.9601051807403564
Epoch: 11, Steps: 17 | Train Loss: 0.234 Vali Loss: 1.115 Vali Acc: 0.699 Test Loss: 1.115 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.762995958328247
Epoch: 12, Steps: 17 | Train Loss: 0.171 Vali Loss: 1.571 Vali Acc: 0.682 Test Loss: 1.571 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7373812198638916
Epoch: 13, Steps: 17 | Train Loss: 0.372 Vali Loss: 1.048 Vali Acc: 0.728 Test Loss: 1.048 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6795566082000732
Epoch: 14, Steps: 17 | Train Loss: 0.214 Vali Loss: 1.310 Vali Acc: 0.642 Test Loss: 1.310 Test Acc: 0.642
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7299189567565918
Epoch: 15, Steps: 17 | Train Loss: 0.153 Vali Loss: 0.836 Vali Acc: 0.798 Test Loss: 0.836 Test Acc: 0.798
Validation loss decreased (-0.762998 --> -0.797679).  Saving model ...
Epoch: 16 cost time: 1.811035394668579
Epoch: 16, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.001 Vali Acc: 0.763 Test Loss: 1.001 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.884014368057251
Epoch: 17, Steps: 17 | Train Loss: 0.162 Vali Loss: 1.235 Vali Acc: 0.705 Test Loss: 1.235 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.100569248199463
Epoch: 18, Steps: 17 | Train Loss: 0.125 Vali Loss: 1.136 Vali Acc: 0.792 Test Loss: 1.136 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7230916023254395
Epoch: 19, Steps: 17 | Train Loss: 0.117 Vali Loss: 1.279 Vali Acc: 0.769 Test Loss: 1.279 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8716797828674316
Epoch: 20, Steps: 17 | Train Loss: 0.193 Vali Loss: 2.214 Vali Acc: 0.746 Test Loss: 2.214 Test Acc: 0.746
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.9708669185638428
Epoch: 21, Steps: 17 | Train Loss: 0.163 Vali Loss: 1.454 Vali Acc: 0.815 Test Loss: 1.454 Test Acc: 0.815
Validation loss decreased (-0.797679 --> -0.815014).  Saving model ...
Epoch: 22 cost time: 1.8934240341186523
Epoch: 22, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.196 Vali Acc: 0.809 Test Loss: 1.196 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6690466403961182
Epoch: 23, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.339 Vali Acc: 0.780 Test Loss: 1.339 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.8927230834960938
Epoch: 24, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.491 Vali Acc: 0.792 Test Loss: 1.491 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6753871440887451
Epoch: 25, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.171 Vali Acc: 0.821 Test Loss: 1.171 Test Acc: 0.821
Validation loss decreased (-0.815014 --> -0.820798).  Saving model ...
Epoch: 26 cost time: 1.5086984634399414
Epoch: 26, Steps: 17 | Train Loss: 0.063 Vali Loss: 1.484 Vali Acc: 0.711 Test Loss: 1.484 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 27 cost time: 1.7435474395751953
Epoch: 27, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.323 Vali Acc: 0.798 Test Loss: 1.323 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 28 cost time: 2.0284578800201416
Epoch: 28, Steps: 17 | Train Loss: 0.108 Vali Loss: 1.987 Vali Acc: 0.723 Test Loss: 1.987 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 29 cost time: 1.7942214012145996
Epoch: 29, Steps: 17 | Train Loss: 0.104 Vali Loss: 2.463 Vali Acc: 0.723 Test Loss: 2.463 Test Acc: 0.723
EarlyStopping counter: 4 out of 10
Epoch: 30 cost time: 1.9257025718688965
Epoch: 30, Steps: 17 | Train Loss: 0.080 Vali Loss: 2.703 Vali Acc: 0.740 Test Loss: 2.703 Test Acc: 0.740
EarlyStopping counter: 5 out of 10
Epoch: 31 cost time: 2.099252462387085
Epoch: 31, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.130 Vali Acc: 0.838 Test Loss: 1.130 Test Acc: 0.838
Validation loss decreased (-0.820798 --> -0.838139).  Saving model ...
Epoch: 32 cost time: 2.0127744674682617
Epoch: 32, Steps: 17 | Train Loss: 0.122 Vali Loss: 2.001 Vali Acc: 0.809 Test Loss: 2.001 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 2.0334601402282715
Epoch: 33, Steps: 17 | Train Loss: 0.253 Vali Loss: 1.502 Vali Acc: 0.780 Test Loss: 1.502 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 2.0267221927642822
Epoch: 34, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.905 Vali Acc: 0.786 Test Loss: 1.905 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.9926855564117432
Epoch: 35, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.700 Vali Acc: 0.809 Test Loss: 1.700 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 2.0017008781433105
Epoch: 36, Steps: 17 | Train Loss: 0.026 Vali Loss: 2.026 Vali Acc: 0.815 Test Loss: 2.026 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 2.0672991275787354
Epoch: 37, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.825 Vali Acc: 0.844 Test Loss: 1.825 Test Acc: 0.844
Validation loss decreased (-0.838139 --> -0.843912).  Saving model ...
Epoch: 38 cost time: 2.0449790954589844
Epoch: 38, Steps: 17 | Train Loss: 0.005 Vali Loss: 2.406 Vali Acc: 0.757 Test Loss: 2.406 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 39 cost time: 2.116028070449829
Epoch: 39, Steps: 17 | Train Loss: 0.025 Vali Loss: 2.875 Vali Acc: 0.775 Test Loss: 2.875 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 40 cost time: 2.0180416107177734
Epoch: 40, Steps: 17 | Train Loss: 0.035 Vali Loss: 2.712 Vali Acc: 0.769 Test Loss: 2.712 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 41 cost time: 2.2952284812927246
Epoch: 41, Steps: 17 | Train Loss: 0.128 Vali Loss: 2.617 Vali Acc: 0.803 Test Loss: 2.617 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 42 cost time: 2.2570154666900635
Epoch: 42, Steps: 17 | Train Loss: 0.150 Vali Loss: 2.382 Vali Acc: 0.780 Test Loss: 2.382 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 43 cost time: 2.258021831512451
Epoch: 43, Steps: 17 | Train Loss: 0.036 Vali Loss: 3.159 Vali Acc: 0.740 Test Loss: 3.159 Test Acc: 0.740
EarlyStopping counter: 6 out of 10
Epoch: 44 cost time: 2.191573143005371
Epoch: 44, Steps: 17 | Train Loss: 0.102 Vali Loss: 4.286 Vali Acc: 0.711 Test Loss: 4.286 Test Acc: 0.711
EarlyStopping counter: 7 out of 10
Epoch: 45 cost time: 2.1262199878692627
Epoch: 45, Steps: 17 | Train Loss: 0.997 Vali Loss: 4.678 Vali Acc: 0.769 Test Loss: 4.678 Test Acc: 0.769
EarlyStopping counter: 8 out of 10
Epoch: 46 cost time: 1.9409384727478027
Epoch: 46, Steps: 17 | Train Loss: 0.306 Vali Loss: 2.882 Vali Acc: 0.763 Test Loss: 2.882 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 47 cost time: 2.042889356613159
Epoch: 47, Steps: 17 | Train Loss: 0.176 Vali Loss: 3.233 Vali Acc: 0.676 Test Loss: 3.233 Test Acc: 0.676
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 849059
model size : 5.69MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.068502902984619
Epoch: 1, Steps: 17 | Train Loss: 1.848 Vali Loss: 1.433 Vali Acc: 0.341 Test Loss: 1.433 Test Acc: 0.341
Validation loss decreased (inf --> -0.341026).  Saving model ...
Epoch: 2 cost time: 2.089874744415283
Epoch: 2, Steps: 17 | Train Loss: 1.289 Vali Loss: 1.022 Vali Acc: 0.642 Test Loss: 1.022 Test Acc: 0.642
Validation loss decreased (-0.341026 --> -0.641608).  Saving model ...
Epoch: 3 cost time: 2.117586135864258
Epoch: 3, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.834 Vali Acc: 0.705 Test Loss: 0.834 Test Acc: 0.705
Validation loss decreased (-0.641608 --> -0.705194).  Saving model ...
Epoch: 4 cost time: 2.020284652709961
Epoch: 4, Steps: 17 | Train Loss: 0.649 Vali Loss: 0.705 Vali Acc: 0.757 Test Loss: 0.705 Test Acc: 0.757
Validation loss decreased (-0.705194 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 1.93389892578125
Epoch: 5, Steps: 17 | Train Loss: 0.464 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 2.0767226219177246
Epoch: 6, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.639 Vali Acc: 0.786 Test Loss: 0.639 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.030094623565674
Epoch: 7, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.540 Vali Acc: 0.815 Test Loss: 0.540 Test Acc: 0.815
Validation loss decreased (-0.809243 --> -0.815024).  Saving model ...
Epoch: 8 cost time: 1.8017394542694092
Epoch: 8, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.541 Vali Acc: 0.827 Test Loss: 0.541 Test Acc: 0.827
Validation loss decreased (-0.815024 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 2.090733051300049
Epoch: 9, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.564 Vali Acc: 0.821 Test Loss: 0.564 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.024325132369995
Epoch: 10, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.689 Vali Acc: 0.821 Test Loss: 0.689 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8344762325286865
Epoch: 11, Steps: 17 | Train Loss: 0.097 Vali Loss: 1.021 Vali Acc: 0.728 Test Loss: 1.021 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8246750831604004
Epoch: 12, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.931 Vali Acc: 0.809 Test Loss: 0.931 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.7865092754364014
Epoch: 13, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.866 Vali Acc: 0.821 Test Loss: 0.866 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.0193896293640137
Epoch: 14, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.860 Vali Acc: 0.803 Test Loss: 0.860 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.6825165748596191
Epoch: 15, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.822 Vali Acc: 0.832 Test Loss: 0.822 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832362).  Saving model ...
Epoch: 16 cost time: 1.974463939666748
Epoch: 16, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.909 Vali Acc: 0.786 Test Loss: 0.909 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 2.1031675338745117
Epoch: 17, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.901 Vali Acc: 0.827 Test Loss: 0.901 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.9403367042541504
Epoch: 18, Steps: 17 | Train Loss: 0.113 Vali Loss: 1.278 Vali Acc: 0.798 Test Loss: 1.278 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7913737297058105
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.918 Vali Acc: 0.844 Test Loss: 0.918 Test Acc: 0.844
Validation loss decreased (-0.832362 --> -0.843921).  Saving model ...
Epoch: 20 cost time: 1.95554518699646
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.807 Vali Acc: 0.855 Test Loss: 0.807 Test Acc: 0.855
Validation loss decreased (-0.843921 --> -0.855483).  Saving model ...
Epoch: 21 cost time: 2.1842010021209717
Epoch: 21, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.018 Vali Acc: 0.803 Test Loss: 1.018 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8688759803771973
Epoch: 22, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.245 Vali Acc: 0.827 Test Loss: 1.245 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 2.2677764892578125
Epoch: 23, Steps: 17 | Train Loss: 0.044 Vali Loss: 2.420 Vali Acc: 0.728 Test Loss: 2.420 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.142997980117798
Epoch: 24, Steps: 17 | Train Loss: 0.133 Vali Loss: 2.464 Vali Acc: 0.705 Test Loss: 2.464 Test Acc: 0.705
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.092761754989624
Epoch: 25, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.244 Vali Acc: 0.844 Test Loss: 1.244 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.9740376472473145
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.470 Vali Acc: 0.792 Test Loss: 1.470 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.8364105224609375
Epoch: 27, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.511 Vali Acc: 0.815 Test Loss: 1.511 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 2.2078464031219482
Epoch: 28, Steps: 17 | Train Loss: 0.045 Vali Loss: 2.520 Vali Acc: 0.775 Test Loss: 2.520 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 2.15464448928833
Epoch: 29, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.433 Vali Acc: 0.798 Test Loss: 1.433 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 2.050769805908203
Epoch: 30, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.638 Vali Acc: 0.827 Test Loss: 1.638 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 816291
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.683132886886597
Epoch: 1, Steps: 17 | Train Loss: 1.864 Vali Loss: 1.437 Vali Acc: 0.335 Test Loss: 1.437 Test Acc: 0.335
Validation loss decreased (inf --> -0.335246).  Saving model ...
Epoch: 2 cost time: 1.9331238269805908
Epoch: 2, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.039 Vali Acc: 0.624 Test Loss: 1.039 Test Acc: 0.624
Validation loss decreased (-0.335246 --> -0.624267).  Saving model ...
Epoch: 3 cost time: 2.0937321186065674
Epoch: 3, Steps: 17 | Train Loss: 0.860 Vali Loss: 0.863 Vali Acc: 0.682 Test Loss: 0.863 Test Acc: 0.682
Validation loss decreased (-0.624267 --> -0.682072).  Saving model ...
Epoch: 4 cost time: 1.7756469249725342
Epoch: 4, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.716 Vali Acc: 0.757 Test Loss: 0.716 Test Acc: 0.757
Validation loss decreased (-0.682072 --> -0.757218).  Saving model ...
Epoch: 5 cost time: 1.658062219619751
Epoch: 5, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
Validation loss decreased (-0.757218 --> -0.809243).  Saving model ...
Epoch: 6 cost time: 1.7241487503051758
Epoch: 6, Steps: 17 | Train Loss: 0.325 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9392120838165283
Epoch: 7, Steps: 17 | Train Loss: 0.374 Vali Loss: 0.592 Vali Acc: 0.763 Test Loss: 0.592 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 2.2304742336273193
Epoch: 8, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.701 Vali Acc: 0.769 Test Loss: 0.701 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 9 cost time: 1.9989476203918457
Epoch: 9, Steps: 17 | Train Loss: 0.267 Vali Loss: 0.660 Vali Acc: 0.821 Test Loss: 0.660 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 10 cost time: 2.2331111431121826
Epoch: 10, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.909 Vali Acc: 0.740 Test Loss: 0.909 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8042895793914795
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.800 Vali Acc: 0.757 Test Loss: 0.800 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 2.050199508666992
Epoch: 12, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.794 Vali Acc: 0.809 Test Loss: 0.794 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0081374645233154
Epoch: 13, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.862 Vali Acc: 0.809 Test Loss: 0.862 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 2.190019369125366
Epoch: 14, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.711 Vali Acc: 0.873 Test Loss: 0.711 Test Acc: 0.873
Validation loss decreased (-0.820803 --> -0.872825).  Saving model ...
Epoch: 15 cost time: 2.0815963745117188
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 1.103 Vali Acc: 0.775 Test Loss: 1.103 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.9060792922973633
Epoch: 16, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.775 Vali Acc: 0.821 Test Loss: 0.775 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0323033332824707
Epoch: 17, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.046 Vali Acc: 0.786 Test Loss: 1.046 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 2.102191686630249
Epoch: 18, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.930 Vali Acc: 0.821 Test Loss: 0.930 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 2.1128134727478027
Epoch: 19, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.238 Vali Acc: 0.809 Test Loss: 1.238 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9762825965881348
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.054 Vali Acc: 0.809 Test Loss: 1.054 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.05873703956604
Epoch: 21, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.495 Vali Acc: 0.780 Test Loss: 1.495 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7401459217071533
Epoch: 22, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.139 Vali Acc: 0.827 Test Loss: 1.139 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9673140048980713
Epoch: 23, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.616 Vali Acc: 0.769 Test Loss: 1.616 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.048651695251465
Epoch: 24, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.238 Vali Acc: 0.815 Test Loss: 1.238 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8728323699421965
model parameter : 816291
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.480407238006592
Epoch: 1, Steps: 17 | Train Loss: 1.873 Vali Loss: 1.504 Vali Acc: 0.353 Test Loss: 1.504 Test Acc: 0.353
Validation loss decreased (inf --> -0.352586).  Saving model ...
Epoch: 2 cost time: 1.855694055557251
Epoch: 2, Steps: 17 | Train Loss: 1.334 Vali Loss: 1.076 Vali Acc: 0.636 Test Loss: 1.076 Test Acc: 0.636
Validation loss decreased (-0.352586 --> -0.635827).  Saving model ...
Epoch: 3 cost time: 2.232672691345215
Epoch: 3, Steps: 17 | Train Loss: 0.873 Vali Loss: 0.893 Vali Acc: 0.642 Test Loss: 0.893 Test Acc: 0.642
Validation loss decreased (-0.635827 --> -0.641610).  Saving model ...
Epoch: 4 cost time: 1.9441173076629639
Epoch: 4, Steps: 17 | Train Loss: 0.692 Vali Loss: 0.760 Vali Acc: 0.682 Test Loss: 0.760 Test Acc: 0.682
Validation loss decreased (-0.641610 --> -0.682073).  Saving model ...
Epoch: 5 cost time: 1.8976240158081055
Epoch: 5, Steps: 17 | Train Loss: 0.506 Vali Loss: 0.646 Vali Acc: 0.803 Test Loss: 0.646 Test Acc: 0.803
Validation loss decreased (-0.682073 --> -0.803462).  Saving model ...
Epoch: 6 cost time: 1.9155235290527344
Epoch: 6, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.642 Vali Acc: 0.769 Test Loss: 0.642 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.913285493850708
Epoch: 7, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.629 Vali Acc: 0.815 Test Loss: 0.629 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815023).  Saving model ...
Epoch: 8 cost time: 1.8102316856384277
Epoch: 8, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.533 Vali Acc: 0.838 Test Loss: 0.533 Test Acc: 0.838
Validation loss decreased (-0.815023 --> -0.838145).  Saving model ...
Epoch: 9 cost time: 2.0776705741882324
Epoch: 9, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.748 Vali Acc: 0.746 Test Loss: 0.748 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.129983425140381
Epoch: 10, Steps: 17 | Train Loss: 0.187 Vali Loss: 1.022 Vali Acc: 0.746 Test Loss: 1.022 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.9350590705871582
Epoch: 11, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.632 Vali Acc: 0.590 Test Loss: 1.632 Test Acc: 0.590
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.0792760848999023
Epoch: 12, Steps: 17 | Train Loss: 0.177 Vali Loss: 0.903 Vali Acc: 0.780 Test Loss: 0.903 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.930737018585205
Epoch: 13, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.823 Vali Acc: 0.798 Test Loss: 0.823 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.074903726577759
Epoch: 14, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.807 Vali Acc: 0.798 Test Loss: 0.807 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 2.1808407306671143
Epoch: 15, Steps: 17 | Train Loss: 0.070 Vali Loss: 0.976 Vali Acc: 0.798 Test Loss: 0.976 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 1.9636797904968262
Epoch: 16, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.887 Vali Acc: 0.798 Test Loss: 0.887 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.8322911262512207
Epoch: 17, Steps: 17 | Train Loss: 0.063 Vali Loss: 0.855 Vali Acc: 0.832 Test Loss: 0.855 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.9934492111206055
Epoch: 18, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.962 Vali Acc: 0.838 Test Loss: 0.962 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 816291
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7857329845428467
Epoch: 1, Steps: 17 | Train Loss: 1.893 Vali Loss: 1.602 Vali Acc: 0.335 Test Loss: 1.602 Test Acc: 0.335
Validation loss decreased (inf --> -0.335244).  Saving model ...
Epoch: 2 cost time: 1.7346992492675781
Epoch: 2, Steps: 17 | Train Loss: 1.435 Vali Loss: 1.190 Vali Acc: 0.509 Test Loss: 1.190 Test Acc: 0.509
Validation loss decreased (-0.335244 --> -0.508659).  Saving model ...
Epoch: 3 cost time: 1.7381675243377686
Epoch: 3, Steps: 17 | Train Loss: 1.011 Vali Loss: 1.067 Vali Acc: 0.514 Test Loss: 1.067 Test Acc: 0.514
Validation loss decreased (-0.508659 --> -0.514440).  Saving model ...
Epoch: 4 cost time: 1.9610164165496826
Epoch: 4, Steps: 17 | Train Loss: 0.851 Vali Loss: 0.889 Vali Acc: 0.665 Test Loss: 0.889 Test Acc: 0.665
Validation loss decreased (-0.514440 --> -0.664731).  Saving model ...
Epoch: 5 cost time: 2.003580093383789
Epoch: 5, Steps: 17 | Train Loss: 0.691 Vali Loss: 0.809 Vali Acc: 0.705 Test Loss: 0.809 Test Acc: 0.705
Validation loss decreased (-0.664731 --> -0.705194).  Saving model ...
Epoch: 6 cost time: 1.8613736629486084
Epoch: 6, Steps: 17 | Train Loss: 0.523 Vali Loss: 0.757 Vali Acc: 0.711 Test Loss: 0.757 Test Acc: 0.711
Validation loss decreased (-0.705194 --> -0.710975).  Saving model ...
Epoch: 7 cost time: 1.9736828804016113
Epoch: 7, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.708 Vali Acc: 0.763 Test Loss: 0.708 Test Acc: 0.763
Validation loss decreased (-0.710975 --> -0.762999).  Saving model ...
Epoch: 8 cost time: 1.8578128814697266
Epoch: 8, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.631 Vali Acc: 0.786 Test Loss: 0.631 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786121).  Saving model ...
Epoch: 9 cost time: 1.8362884521484375
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.847 Vali Acc: 0.699 Test Loss: 0.847 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.854396104812622
Epoch: 10, Steps: 17 | Train Loss: 0.388 Vali Loss: 1.067 Vali Acc: 0.676 Test Loss: 1.067 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.011464834213257
Epoch: 11, Steps: 17 | Train Loss: 0.404 Vali Loss: 1.234 Vali Acc: 0.624 Test Loss: 1.234 Test Acc: 0.624
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.047243595123291
Epoch: 12, Steps: 17 | Train Loss: 0.333 Vali Loss: 0.801 Vali Acc: 0.751 Test Loss: 0.801 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 2.147883892059326
Epoch: 13, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.728 Vali Acc: 0.757 Test Loss: 0.728 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 2.1244564056396484
Epoch: 14, Steps: 17 | Train Loss: 0.206 Vali Loss: 1.220 Vali Acc: 0.717 Test Loss: 1.220 Test Acc: 0.717
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9726848602294922
Epoch: 15, Steps: 17 | Train Loss: 0.224 Vali Loss: 1.751 Vali Acc: 0.682 Test Loss: 1.751 Test Acc: 0.682
EarlyStopping counter: 7 out of 10
Epoch: 16 cost time: 2.0291426181793213
Epoch: 16, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.949 Vali Acc: 0.751 Test Loss: 0.949 Test Acc: 0.751
EarlyStopping counter: 8 out of 10
Epoch: 17 cost time: 1.9529049396514893
Epoch: 17, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.118 Vali Acc: 0.757 Test Loss: 1.118 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 18 cost time: 1.992682933807373
Epoch: 18, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.974 Vali Acc: 0.798 Test Loss: 0.974 Test Acc: 0.798
Validation loss decreased (-0.786121 --> -0.797678).  Saving model ...
Epoch: 19 cost time: 1.7484755516052246
Epoch: 19, Steps: 17 | Train Loss: 0.111 Vali Loss: 1.014 Vali Acc: 0.798 Test Loss: 1.014 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9395999908447266
Epoch: 20, Steps: 17 | Train Loss: 0.256 Vali Loss: 1.378 Vali Acc: 0.775 Test Loss: 1.378 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.054854393005371
Epoch: 21, Steps: 17 | Train Loss: 0.271 Vali Loss: 1.340 Vali Acc: 0.751 Test Loss: 1.340 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.0063650608062744
Epoch: 22, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.957 Vali Acc: 0.815 Test Loss: 0.957 Test Acc: 0.815
Validation loss decreased (-0.797678 --> -0.815019).  Saving model ...
Epoch: 23 cost time: 1.6414198875427246
Epoch: 23, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.035 Vali Acc: 0.815 Test Loss: 1.035 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.8132643699645996
Epoch: 24, Steps: 17 | Train Loss: 0.180 Vali Loss: 1.467 Vali Acc: 0.798 Test Loss: 1.467 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8195695877075195
Epoch: 25, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.634 Vali Acc: 0.786 Test Loss: 1.634 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.943394422531128
Epoch: 26, Steps: 17 | Train Loss: 0.098 Vali Loss: 1.876 Vali Acc: 0.775 Test Loss: 1.876 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.9092018604278564
Epoch: 27, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.808 Vali Acc: 0.728 Test Loss: 1.808 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.902207851409912
Epoch: 28, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.705 Vali Acc: 0.780 Test Loss: 1.705 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.6207411289215088
Epoch: 29, Steps: 17 | Train Loss: 0.266 Vali Loss: 2.065 Vali Acc: 0.769 Test Loss: 2.065 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8416073322296143
Epoch: 30, Steps: 17 | Train Loss: 0.205 Vali Loss: 2.267 Vali Acc: 0.642 Test Loss: 2.267 Test Acc: 0.642
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8695874214172363
Epoch: 31, Steps: 17 | Train Loss: 0.148 Vali Loss: 2.147 Vali Acc: 0.786 Test Loss: 2.147 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.740290641784668
Epoch: 32, Steps: 17 | Train Loss: 0.122 Vali Loss: 1.918 Vali Acc: 0.775 Test Loss: 1.918 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 816291
model size : 5.57MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.337834596633911
Epoch: 1, Steps: 17 | Train Loss: 1.906 Vali Loss: 1.547 Vali Acc: 0.295 Test Loss: 1.547 Test Acc: 0.295
Validation loss decreased (inf --> -0.294782).  Saving model ...
Epoch: 2 cost time: 1.8650355339050293
Epoch: 2, Steps: 17 | Train Loss: 1.209 Vali Loss: 1.278 Vali Acc: 0.462 Test Loss: 1.278 Test Acc: 0.462
Validation loss decreased (-0.294782 --> -0.462415).  Saving model ...
Epoch: 3 cost time: 1.9124243259429932
Epoch: 3, Steps: 17 | Train Loss: 0.877 Vali Loss: 0.950 Vali Acc: 0.543 Test Loss: 0.950 Test Acc: 0.543
Validation loss decreased (-0.462415 --> -0.543343).  Saving model ...
Epoch: 4 cost time: 2.1451144218444824
Epoch: 4, Steps: 17 | Train Loss: 0.643 Vali Loss: 0.941 Vali Acc: 0.595 Test Loss: 0.941 Test Acc: 0.595
Validation loss decreased (-0.543343 --> -0.595366).  Saving model ...
Epoch: 5 cost time: 1.9392356872558594
Epoch: 5, Steps: 17 | Train Loss: 0.563 Vali Loss: 0.804 Vali Acc: 0.734 Test Loss: 0.804 Test Acc: 0.734
Validation loss decreased (-0.595366 --> -0.734096).  Saving model ...
Epoch: 6 cost time: 2.0323946475982666
Epoch: 6, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.635 Vali Acc: 0.792 Test Loss: 0.635 Test Acc: 0.792
Validation loss decreased (-0.734096 --> -0.791901).  Saving model ...
Epoch: 7 cost time: 2.1052496433258057
Epoch: 7, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.735 Vali Acc: 0.751 Test Loss: 0.735 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0403761863708496
Epoch: 8, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.641 Vali Acc: 0.775 Test Loss: 0.641 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9542572498321533
Epoch: 9, Steps: 17 | Train Loss: 0.143 Vali Loss: 1.136 Vali Acc: 0.659 Test Loss: 1.136 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.9623241424560547
Epoch: 10, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.541 Vali Acc: 0.821 Test Loss: 0.541 Test Acc: 0.821
Validation loss decreased (-0.791901 --> -0.820804).  Saving model ...
Epoch: 11 cost time: 1.7170794010162354
Epoch: 11, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.740 Vali Acc: 0.786 Test Loss: 0.740 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9162383079528809
Epoch: 12, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.670 Vali Acc: 0.832 Test Loss: 0.670 Test Acc: 0.832
Validation loss decreased (-0.820804 --> -0.832363).  Saving model ...
Epoch: 13 cost time: 1.821183681488037
Epoch: 13, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.588 Vali Acc: 0.821 Test Loss: 0.588 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9571483135223389
Epoch: 14, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.781 Vali Acc: 0.798 Test Loss: 0.781 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.8540120124816895
Epoch: 15, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.643 Vali Acc: 0.855 Test Loss: 0.643 Test Acc: 0.855
Validation loss decreased (-0.832363 --> -0.855485).  Saving model ...
Epoch: 16 cost time: 1.9216701984405518
Epoch: 16, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.986 Vali Acc: 0.769 Test Loss: 0.986 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9080355167388916
Epoch: 17, Steps: 17 | Train Loss: 0.085 Vali Loss: 0.713 Vali Acc: 0.821 Test Loss: 0.713 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 2.233964443206787
Epoch: 18, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.852 Vali Acc: 0.832 Test Loss: 0.852 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 2.0264079570770264
Epoch: 19, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.375 Vali Acc: 0.751 Test Loss: 1.375 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 2.202472448348999
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.062 Vali Acc: 0.809 Test Loss: 1.062 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 2.243387460708618
Epoch: 21, Steps: 17 | Train Loss: 0.073 Vali Loss: 1.304 Vali Acc: 0.792 Test Loss: 1.304 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 2.0605669021606445
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.376 Vali Acc: 0.809 Test Loss: 1.376 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 2.2024290561676025
Epoch: 23, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.082 Vali Acc: 0.844 Test Loss: 1.082 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 2.2518105506896973
Epoch: 24, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.268 Vali Acc: 0.827 Test Loss: 1.268 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 2.0122861862182617
Epoch: 25, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.020 Vali Acc: 0.832 Test Loss: 1.020 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 799907
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.092360019683838
Epoch: 1, Steps: 17 | Train Loss: 1.902 Vali Loss: 1.558 Vali Acc: 0.289 Test Loss: 1.558 Test Acc: 0.289
Validation loss decreased (inf --> -0.289002).  Saving model ...
Epoch: 2 cost time: 1.8948395252227783
Epoch: 2, Steps: 17 | Train Loss: 1.226 Vali Loss: 1.293 Vali Acc: 0.439 Test Loss: 1.293 Test Acc: 0.439
Validation loss decreased (-0.289002 --> -0.439293).  Saving model ...
Epoch: 3 cost time: 1.8916375637054443
Epoch: 3, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.982 Vali Acc: 0.532 Test Loss: 0.982 Test Acc: 0.532
Validation loss decreased (-0.439293 --> -0.531782).  Saving model ...
Epoch: 4 cost time: 1.774557113647461
Epoch: 4, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.888 Vali Acc: 0.624 Test Loss: 0.888 Test Acc: 0.624
Validation loss decreased (-0.531782 --> -0.624269).  Saving model ...
Epoch: 5 cost time: 2.244262933731079
Epoch: 5, Steps: 17 | Train Loss: 0.599 Vali Loss: 0.871 Vali Acc: 0.723 Test Loss: 0.871 Test Acc: 0.723
Validation loss decreased (-0.624269 --> -0.722535).  Saving model ...
Epoch: 6 cost time: 1.9264283180236816
Epoch: 6, Steps: 17 | Train Loss: 0.494 Vali Loss: 0.658 Vali Acc: 0.798 Test Loss: 0.658 Test Acc: 0.798
Validation loss decreased (-0.722535 --> -0.797681).  Saving model ...
Epoch: 7 cost time: 1.9573237895965576
Epoch: 7, Steps: 17 | Train Loss: 0.326 Vali Loss: 0.904 Vali Acc: 0.676 Test Loss: 0.904 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.935361623764038
Epoch: 8, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.722 Vali Acc: 0.751 Test Loss: 0.722 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.0407280921936035
Epoch: 9, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.588 Vali Acc: 0.815 Test Loss: 0.588 Test Acc: 0.815
Validation loss decreased (-0.797681 --> -0.815023).  Saving model ...
Epoch: 10 cost time: 1.7901597023010254
Epoch: 10, Steps: 17 | Train Loss: 0.232 Vali Loss: 0.595 Vali Acc: 0.786 Test Loss: 0.595 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.989274263381958
Epoch: 11, Steps: 17 | Train Loss: 0.115 Vali Loss: 0.804 Vali Acc: 0.780 Test Loss: 0.804 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.9576852321624756
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.748 Vali Acc: 0.769 Test Loss: 0.748 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.8264777660369873
Epoch: 13, Steps: 17 | Train Loss: 0.107 Vali Loss: 0.717 Vali Acc: 0.861 Test Loss: 0.717 Test Acc: 0.861
Validation loss decreased (-0.815023 --> -0.861265).  Saving model ...
Epoch: 14 cost time: 1.7530686855316162
Epoch: 14, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.981 Vali Acc: 0.775 Test Loss: 0.981 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.704864740371704
Epoch: 15, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.661 Vali Acc: 0.844 Test Loss: 0.661 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.6544413566589355
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.430 Vali Acc: 0.751 Test Loss: 1.430 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.791834831237793
Epoch: 17, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.990 Vali Acc: 0.786 Test Loss: 0.990 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.1020541191101074
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.014 Vali Acc: 0.792 Test Loss: 1.014 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.270148515701294
Epoch: 19, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.617 Vali Acc: 0.746 Test Loss: 1.617 Test Acc: 0.746
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.0929479598999023
Epoch: 20, Steps: 17 | Train Loss: 0.091 Vali Loss: 1.361 Vali Acc: 0.803 Test Loss: 1.361 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.1979095935821533
Epoch: 21, Steps: 17 | Train Loss: 0.052 Vali Loss: 1.271 Vali Acc: 0.775 Test Loss: 1.271 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 2.1495556831359863
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.993 Vali Acc: 0.809 Test Loss: 0.993 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 2.17710280418396
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.141 Vali Acc: 0.809 Test Loss: 1.141 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 799907
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.930457592010498
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.615 Vali Acc: 0.301 Test Loss: 1.615 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 1.9768874645233154
Epoch: 2, Steps: 17 | Train Loss: 1.265 Vali Loss: 1.301 Vali Acc: 0.428 Test Loss: 1.301 Test Acc: 0.428
Validation loss decreased (-0.300562 --> -0.427733).  Saving model ...
Epoch: 3 cost time: 2.0854594707489014
Epoch: 3, Steps: 17 | Train Loss: 0.952 Vali Loss: 1.089 Vali Acc: 0.509 Test Loss: 1.089 Test Acc: 0.509
Validation loss decreased (-0.427733 --> -0.508660).  Saving model ...
Epoch: 4 cost time: 1.9737422466278076
Epoch: 4, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.974 Vali Acc: 0.624 Test Loss: 0.974 Test Acc: 0.624
Validation loss decreased (-0.508660 --> -0.624268).  Saving model ...
Epoch: 5 cost time: 2.1377503871917725
Epoch: 5, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.946 Vali Acc: 0.694 Test Loss: 0.946 Test Acc: 0.694
Validation loss decreased (-0.624268 --> -0.693632).  Saving model ...
Epoch: 6 cost time: 1.8857450485229492
Epoch: 6, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.745 Vali Acc: 0.728 Test Loss: 0.745 Test Acc: 0.728
Validation loss decreased (-0.693632 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 2.1544673442840576
Epoch: 7, Steps: 17 | Train Loss: 0.320 Vali Loss: 0.871 Vali Acc: 0.694 Test Loss: 0.871 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0835421085357666
Epoch: 8, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.636 Vali Acc: 0.780 Test Loss: 0.636 Test Acc: 0.780
Validation loss decreased (-0.728316 --> -0.780340).  Saving model ...
Epoch: 9 cost time: 2.04817795753479
Epoch: 9, Steps: 17 | Train Loss: 0.183 Vali Loss: 1.441 Vali Acc: 0.624 Test Loss: 1.441 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 2.2996389865875244
Epoch: 10, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.872 Vali Acc: 0.723 Test Loss: 0.872 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0898969173431396
Epoch: 11, Steps: 17 | Train Loss: 0.162 Vali Loss: 0.982 Vali Acc: 0.740 Test Loss: 0.982 Test Acc: 0.740
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9658544063568115
Epoch: 12, Steps: 17 | Train Loss: 0.405 Vali Loss: 0.944 Vali Acc: 0.780 Test Loss: 0.944 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.842545509338379
Epoch: 13, Steps: 17 | Train Loss: 0.204 Vali Loss: 0.809 Vali Acc: 0.803 Test Loss: 0.809 Test Acc: 0.803
Validation loss decreased (-0.780340 --> -0.803460).  Saving model ...
Epoch: 14 cost time: 1.757852554321289
Epoch: 14, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.958 Vali Acc: 0.792 Test Loss: 0.958 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.0021073818206787
Epoch: 15, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.181 Vali Acc: 0.757 Test Loss: 1.181 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.3109941482543945
Epoch: 16, Steps: 17 | Train Loss: 0.218 Vali Loss: 1.881 Vali Acc: 0.688 Test Loss: 1.881 Test Acc: 0.688
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 2.046867847442627
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.188 Vali Acc: 0.786 Test Loss: 1.188 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 2.0123462677001953
Epoch: 18, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.018 Vali Acc: 0.780 Test Loss: 1.018 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 2.129256010055542
Epoch: 19, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.767 Vali Acc: 0.757 Test Loss: 1.767 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 2.1677892208099365
Epoch: 20, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.955 Vali Acc: 0.746 Test Loss: 1.955 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 2.2426583766937256
Epoch: 21, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.449 Vali Acc: 0.815 Test Loss: 1.449 Test Acc: 0.815
Validation loss decreased (-0.803460 --> -0.815014).  Saving model ...
Epoch: 22 cost time: 2.2569003105163574
Epoch: 22, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.168 Vali Acc: 0.775 Test Loss: 1.168 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 2.086045742034912
Epoch: 23, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.383 Vali Acc: 0.792 Test Loss: 1.383 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 2.3479087352752686
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.277 Vali Acc: 0.815 Test Loss: 1.277 Test Acc: 0.815
Validation loss decreased (-0.815014 --> -0.815016).  Saving model ...
Epoch: 25 cost time: 2.2441771030426025
Epoch: 25, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.630 Vali Acc: 0.798 Test Loss: 1.630 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9913275241851807
Epoch: 26, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.678 Vali Acc: 0.786 Test Loss: 1.678 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9911065101623535
Epoch: 27, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.678 Vali Acc: 0.815 Test Loss: 1.678 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 2.1043155193328857
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.558 Vali Acc: 0.798 Test Loss: 1.558 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.1335978507995605
Epoch: 29, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.876 Vali Acc: 0.780 Test Loss: 1.876 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.108757734298706
Epoch: 30, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.840 Vali Acc: 0.798 Test Loss: 1.840 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 2.181381940841675
Epoch: 31, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.661 Vali Acc: 0.798 Test Loss: 1.661 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 2.2209315299987793
Epoch: 32, Steps: 17 | Train Loss: 0.083 Vali Loss: 2.375 Vali Acc: 0.723 Test Loss: 2.375 Test Acc: 0.723
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.205787420272827
Epoch: 33, Steps: 17 | Train Loss: 0.230 Vali Loss: 2.190 Vali Acc: 0.786 Test Loss: 2.190 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.9823768138885498
Epoch: 34, Steps: 17 | Train Loss: 0.096 Vali Loss: 2.617 Vali Acc: 0.734 Test Loss: 2.617 Test Acc: 0.734
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 799907
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            128                 
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.175470590591431
Epoch: 1, Steps: 17 | Train Loss: 1.929 Vali Loss: 1.660 Vali Acc: 0.277 Test Loss: 1.660 Test Acc: 0.277
Validation loss decreased (inf --> -0.277440).  Saving model ...
Epoch: 2 cost time: 1.7006654739379883
Epoch: 2, Steps: 17 | Train Loss: 1.360 Vali Loss: 1.393 Vali Acc: 0.480 Test Loss: 1.393 Test Acc: 0.480
Validation loss decreased (-0.277440 --> -0.479755).  Saving model ...
Epoch: 3 cost time: 1.7384440898895264
Epoch: 3, Steps: 17 | Train Loss: 1.098 Vali Loss: 1.268 Vali Acc: 0.434 Test Loss: 1.268 Test Acc: 0.434
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7662086486816406
Epoch: 4, Steps: 17 | Train Loss: 0.876 Vali Loss: 0.986 Vali Acc: 0.578 Test Loss: 0.986 Test Acc: 0.578
Validation loss decreased (-0.479755 --> -0.578025).  Saving model ...
Epoch: 5 cost time: 1.6549787521362305
Epoch: 5, Steps: 17 | Train Loss: 0.709 Vali Loss: 1.019 Vali Acc: 0.636 Test Loss: 1.019 Test Acc: 0.636
Validation loss decreased (-0.578025 --> -0.635828).  Saving model ...
Epoch: 6 cost time: 1.964953899383545
Epoch: 6, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.817 Vali Acc: 0.694 Test Loss: 0.817 Test Acc: 0.694
Validation loss decreased (-0.635828 --> -0.693633).  Saving model ...
Epoch: 7 cost time: 1.7614789009094238
Epoch: 7, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.738 Vali Acc: 0.711 Test Loss: 0.738 Test Acc: 0.711
Validation loss decreased (-0.693633 --> -0.710975).  Saving model ...
Epoch: 8 cost time: 1.8033347129821777
Epoch: 8, Steps: 17 | Train Loss: 0.533 Vali Loss: 0.824 Vali Acc: 0.694 Test Loss: 0.824 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7476553916931152
Epoch: 9, Steps: 17 | Train Loss: 0.319 Vali Loss: 1.005 Vali Acc: 0.676 Test Loss: 1.005 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.714853048324585
Epoch: 10, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.576 Vali Acc: 0.769 Test Loss: 0.576 Test Acc: 0.769
Validation loss decreased (-0.710975 --> -0.768780).  Saving model ...
Epoch: 11 cost time: 1.8625080585479736
Epoch: 11, Steps: 17 | Train Loss: 0.291 Vali Loss: 0.825 Vali Acc: 0.775 Test Loss: 0.825 Test Acc: 0.775
Validation loss decreased (-0.768780 --> -0.774558).  Saving model ...
Epoch: 12 cost time: 1.842104196548462
Epoch: 12, Steps: 17 | Train Loss: 0.287 Vali Loss: 0.890 Vali Acc: 0.682 Test Loss: 0.890 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7679672241210938
Epoch: 13, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.630 Vali Acc: 0.821 Test Loss: 0.630 Test Acc: 0.821
Validation loss decreased (-0.774558 --> -0.820803).  Saving model ...
Epoch: 14 cost time: 1.6645238399505615
Epoch: 14, Steps: 17 | Train Loss: 0.144 Vali Loss: 0.743 Vali Acc: 0.769 Test Loss: 0.743 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7454650402069092
Epoch: 15, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.973 Vali Acc: 0.717 Test Loss: 0.973 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.7184398174285889
Epoch: 16, Steps: 17 | Train Loss: 0.311 Vali Loss: 1.576 Vali Acc: 0.699 Test Loss: 1.576 Test Acc: 0.699
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.6728191375732422
Epoch: 17, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.890 Vali Acc: 0.757 Test Loss: 0.890 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.6514348983764648
Epoch: 18, Steps: 17 | Train Loss: 0.290 Vali Loss: 1.361 Vali Acc: 0.723 Test Loss: 1.361 Test Acc: 0.723
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.5103447437286377
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 1.237 Vali Acc: 0.734 Test Loss: 1.237 Test Acc: 0.734
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.6014437675476074
Epoch: 20, Steps: 17 | Train Loss: 0.202 Vali Loss: 1.070 Vali Acc: 0.769 Test Loss: 1.070 Test Acc: 0.769
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.5328593254089355
Epoch: 21, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.430 Vali Acc: 0.763 Test Loss: 1.430 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.9474542140960693
Epoch: 22, Steps: 17 | Train Loss: 0.153 Vali Loss: 1.197 Vali Acc: 0.751 Test Loss: 1.197 Test Acc: 0.751
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.7840070724487305
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.135 Vali Acc: 0.792 Test Loss: 1.135 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm128_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 799907
model size : 5.50MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.050790786743164
Epoch: 1, Steps: 17 | Train Loss: 1.886 Vali Loss: 1.680 Vali Acc: 0.295 Test Loss: 1.680 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 2.0814709663391113
Epoch: 2, Steps: 17 | Train Loss: 1.466 Vali Loss: 1.335 Vali Acc: 0.277 Test Loss: 1.335 Test Acc: 0.277
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9817523956298828
Epoch: 3, Steps: 17 | Train Loss: 1.085 Vali Loss: 1.050 Vali Acc: 0.543 Test Loss: 1.050 Test Acc: 0.543
Validation loss decreased (-0.294781 --> -0.543342).  Saving model ...
Epoch: 4 cost time: 1.7171764373779297
Epoch: 4, Steps: 17 | Train Loss: 0.892 Vali Loss: 0.950 Vali Acc: 0.630 Test Loss: 0.950 Test Acc: 0.630
Validation loss decreased (-0.543342 --> -0.630048).  Saving model ...
Epoch: 5 cost time: 1.524193525314331
Epoch: 5, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.850 Vali Acc: 0.682 Test Loss: 0.850 Test Acc: 0.682
Validation loss decreased (-0.630048 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 1.8393242359161377
Epoch: 6, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.807 Vali Acc: 0.705 Test Loss: 0.807 Test Acc: 0.705
Validation loss decreased (-0.682072 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 2.0739572048187256
Epoch: 7, Steps: 17 | Train Loss: 0.510 Vali Loss: 0.693 Vali Acc: 0.728 Test Loss: 0.693 Test Acc: 0.728
Validation loss decreased (-0.705194 --> -0.728317).  Saving model ...
Epoch: 8 cost time: 1.811708688735962
Epoch: 8, Steps: 17 | Train Loss: 0.402 Vali Loss: 0.600 Vali Acc: 0.827 Test Loss: 0.600 Test Acc: 0.827
Validation loss decreased (-0.728317 --> -0.826584).  Saving model ...
Epoch: 9 cost time: 1.9945785999298096
Epoch: 9, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.591 Vali Acc: 0.798 Test Loss: 0.591 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8792054653167725
Epoch: 10, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.1655046939849854
Epoch: 11, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.9427237510681152
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 1.035 Vali Acc: 0.717 Test Loss: 1.035 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8685779571533203
Epoch: 13, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.593 Vali Acc: 0.850 Test Loss: 0.593 Test Acc: 0.850
Validation loss decreased (-0.826584 --> -0.849705).  Saving model ...
Epoch: 14 cost time: 1.7728941440582275
Epoch: 14, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.652 Vali Acc: 0.803 Test Loss: 0.652 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.9408035278320312
Epoch: 15, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.779 Vali Acc: 0.832 Test Loss: 0.779 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.083292245864868
Epoch: 16, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.759 Vali Acc: 0.798 Test Loss: 0.759 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7218842506408691
Epoch: 17, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.713 Vali Acc: 0.832 Test Loss: 0.713 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.9920930862426758
Epoch: 18, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.690 Vali Acc: 0.827 Test Loss: 0.690 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8904612064361572
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.790 Vali Acc: 0.803 Test Loss: 0.790 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7582430839538574
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.697 Vali Acc: 0.844 Test Loss: 0.697 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.7816953659057617
Epoch: 21, Steps: 17 | Train Loss: 0.065 Vali Loss: 0.714 Vali Acc: 0.832 Test Loss: 0.714 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.8477416038513184
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.991 Vali Acc: 0.803 Test Loss: 0.991 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.9092788696289062
Epoch: 23, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.929 Vali Acc: 0.786 Test Loss: 0.929 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 647651
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.065903186798096
Epoch: 1, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.692 Vali Acc: 0.318 Test Loss: 1.692 Test Acc: 0.318
Validation loss decreased (inf --> -0.317902).  Saving model ...
Epoch: 2 cost time: 1.9730329513549805
Epoch: 2, Steps: 17 | Train Loss: 1.482 Vali Loss: 1.353 Vali Acc: 0.272 Test Loss: 1.353 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 1.9507734775543213
Epoch: 3, Steps: 17 | Train Loss: 1.114 Vali Loss: 1.089 Vali Acc: 0.509 Test Loss: 1.089 Test Acc: 0.509
Validation loss decreased (-0.317902 --> -0.508660).  Saving model ...
Epoch: 4 cost time: 1.8605072498321533
Epoch: 4, Steps: 17 | Train Loss: 0.936 Vali Loss: 0.986 Vali Acc: 0.636 Test Loss: 0.986 Test Acc: 0.636
Validation loss decreased (-0.508660 --> -0.635828).  Saving model ...
Epoch: 5 cost time: 2.0048394203186035
Epoch: 5, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.884 Vali Acc: 0.676 Test Loss: 0.884 Test Acc: 0.676
Validation loss decreased (-0.635828 --> -0.676292).  Saving model ...
Epoch: 6 cost time: 1.8853716850280762
Epoch: 6, Steps: 17 | Train Loss: 0.697 Vali Loss: 0.818 Vali Acc: 0.671 Test Loss: 0.818 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.0443153381347656
Epoch: 7, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.739 Vali Acc: 0.734 Test Loss: 0.739 Test Acc: 0.734
Validation loss decreased (-0.676292 --> -0.734097).  Saving model ...
Epoch: 8 cost time: 1.9232568740844727
Epoch: 8, Steps: 17 | Train Loss: 0.429 Vali Loss: 0.647 Vali Acc: 0.803 Test Loss: 0.647 Test Acc: 0.803
Validation loss decreased (-0.734097 --> -0.803462).  Saving model ...
Epoch: 9 cost time: 2.0202507972717285
Epoch: 9, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.694 Vali Acc: 0.769 Test Loss: 0.694 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9225504398345947
Epoch: 10, Steps: 17 | Train Loss: 0.227 Vali Loss: 0.766 Vali Acc: 0.780 Test Loss: 0.766 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.0849766731262207
Epoch: 11, Steps: 17 | Train Loss: 0.259 Vali Loss: 0.793 Vali Acc: 0.780 Test Loss: 0.793 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.105799674987793
Epoch: 12, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.779 Vali Acc: 0.775 Test Loss: 0.779 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.821943998336792
Epoch: 13, Steps: 17 | Train Loss: 0.173 Vali Loss: 0.692 Vali Acc: 0.815 Test Loss: 0.692 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815022).  Saving model ...
Epoch: 14 cost time: 1.8717222213745117
Epoch: 14, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.700 Vali Acc: 0.780 Test Loss: 0.700 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 2.020958423614502
Epoch: 15, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.926 Vali Acc: 0.803 Test Loss: 0.926 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.0789718627929688
Epoch: 16, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.638 Vali Acc: 0.832 Test Loss: 0.638 Test Acc: 0.832
Validation loss decreased (-0.815022 --> -0.832364).  Saving model ...
Epoch: 17 cost time: 1.9405596256256104
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.792 Vali Acc: 0.815 Test Loss: 0.792 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.9971907138824463
Epoch: 18, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.902 Vali Acc: 0.792 Test Loss: 0.902 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.6361775398254395
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.634 Vali Acc: 0.821 Test Loss: 0.634 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.948493480682373
Epoch: 20, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.896 Vali Acc: 0.815 Test Loss: 0.896 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8141789436340332
Epoch: 21, Steps: 17 | Train Loss: 0.092 Vali Loss: 0.786 Vali Acc: 0.780 Test Loss: 0.786 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0218992233276367
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.063 Vali Acc: 0.827 Test Loss: 1.063 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.9094536304473877
Epoch: 23, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.929 Vali Acc: 0.798 Test Loss: 0.929 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.7828657627105713
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.447 Vali Acc: 0.775 Test Loss: 1.447 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.9408750534057617
Epoch: 25, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.050 Vali Acc: 0.798 Test Loss: 1.050 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 2.146467924118042
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.188 Vali Acc: 0.815 Test Loss: 1.188 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 647651
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.098300457000732
Epoch: 1, Steps: 17 | Train Loss: 1.896 Vali Loss: 1.716 Vali Acc: 0.301 Test Loss: 1.716 Test Acc: 0.301
Validation loss decreased (inf --> -0.300561).  Saving model ...
Epoch: 2 cost time: 2.127000093460083
Epoch: 2, Steps: 17 | Train Loss: 1.526 Vali Loss: 1.385 Vali Acc: 0.272 Test Loss: 1.385 Test Acc: 0.272
EarlyStopping counter: 1 out of 10
Epoch: 3 cost time: 2.294605255126953
Epoch: 3, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.102 Vali Acc: 0.486 Test Loss: 1.102 Test Acc: 0.486
Validation loss decreased (-0.300561 --> -0.485538).  Saving model ...
Epoch: 4 cost time: 2.0542030334472656
Epoch: 4, Steps: 17 | Train Loss: 0.938 Vali Loss: 1.004 Vali Acc: 0.618 Test Loss: 1.004 Test Acc: 0.618
Validation loss decreased (-0.485538 --> -0.618487).  Saving model ...
Epoch: 5 cost time: 1.9340081214904785
Epoch: 5, Steps: 17 | Train Loss: 0.829 Vali Loss: 0.883 Vali Acc: 0.676 Test Loss: 0.883 Test Acc: 0.676
Validation loss decreased (-0.618487 --> -0.676292).  Saving model ...
Epoch: 6 cost time: 1.8441145420074463
Epoch: 6, Steps: 17 | Train Loss: 0.739 Vali Loss: 0.878 Vali Acc: 0.659 Test Loss: 0.878 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 2.2031590938568115
Epoch: 7, Steps: 17 | Train Loss: 0.539 Vali Loss: 0.750 Vali Acc: 0.705 Test Loss: 0.750 Test Acc: 0.705
Validation loss decreased (-0.676292 --> -0.705195).  Saving model ...
Epoch: 8 cost time: 2.0941059589385986
Epoch: 8, Steps: 17 | Train Loss: 0.476 Vali Loss: 0.716 Vali Acc: 0.786 Test Loss: 0.716 Test Acc: 0.786
Validation loss decreased (-0.705195 --> -0.786120).  Saving model ...
Epoch: 9 cost time: 1.9519176483154297
Epoch: 9, Steps: 17 | Train Loss: 0.390 Vali Loss: 0.774 Vali Acc: 0.751 Test Loss: 0.774 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9068636894226074
Epoch: 10, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.789 Vali Acc: 0.740 Test Loss: 0.789 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 2.335320234298706
Epoch: 11, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.684 Vali Acc: 0.775 Test Loss: 0.684 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 2.2435967922210693
Epoch: 12, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.897 Vali Acc: 0.763 Test Loss: 0.897 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8874452114105225
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 1.005 Vali Acc: 0.728 Test Loss: 1.005 Test Acc: 0.728
EarlyStopping counter: 5 out of 10
Epoch: 14 cost time: 1.690253496170044
Epoch: 14, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.754 Vali Acc: 0.786 Test Loss: 0.754 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 15 cost time: 1.9932217597961426
Epoch: 15, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.862 Vali Acc: 0.809 Test Loss: 0.862 Test Acc: 0.809
Validation loss decreased (-0.786120 --> -0.809240).  Saving model ...
Epoch: 16 cost time: 2.0086910724639893
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.718 Vali Acc: 0.815 Test Loss: 0.718 Test Acc: 0.815
Validation loss decreased (-0.809240 --> -0.815022).  Saving model ...
Epoch: 17 cost time: 1.7790603637695312
Epoch: 17, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.830 Vali Acc: 0.803 Test Loss: 0.830 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8548059463500977
Epoch: 18, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.064 Vali Acc: 0.769 Test Loss: 1.064 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8811500072479248
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.847 Vali Acc: 0.838 Test Loss: 0.847 Test Acc: 0.838
Validation loss decreased (-0.815022 --> -0.838142).  Saving model ...
Epoch: 20 cost time: 1.9769854545593262
Epoch: 20, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.293 Vali Acc: 0.803 Test Loss: 1.293 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8618600368499756
Epoch: 21, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.967 Vali Acc: 0.827 Test Loss: 0.967 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9167940616607666
Epoch: 22, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.139 Vali Acc: 0.803 Test Loss: 1.139 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8497121334075928
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.205 Vali Acc: 0.803 Test Loss: 1.205 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.7966525554656982
Epoch: 24, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.278 Vali Acc: 0.769 Test Loss: 1.278 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.8151533603668213
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.292 Vali Acc: 0.792 Test Loss: 1.292 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.9489905834197998
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.207 Vali Acc: 0.798 Test Loss: 1.207 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.9322783946990967
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.062 Vali Acc: 0.803 Test Loss: 1.062 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8716487884521484
Epoch: 28, Steps: 17 | Train Loss: 0.010 Vali Loss: 1.507 Vali Acc: 0.786 Test Loss: 1.507 Test Acc: 0.786
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9791531562805176
Epoch: 29, Steps: 17 | Train Loss: 0.138 Vali Loss: 1.899 Vali Acc: 0.769 Test Loss: 1.899 Test Acc: 0.769
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 647651
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8315014839172363
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.775 Vali Acc: 0.225 Test Loss: 1.775 Test Acc: 0.225
Validation loss decreased (inf --> -0.225416).  Saving model ...
Epoch: 2 cost time: 1.685856580734253
Epoch: 2, Steps: 17 | Train Loss: 1.604 Vali Loss: 1.489 Vali Acc: 0.260 Test Loss: 1.489 Test Acc: 0.260
Validation loss decreased (-0.225416 --> -0.260101).  Saving model ...
Epoch: 3 cost time: 1.7366065979003906
Epoch: 3, Steps: 17 | Train Loss: 1.242 Vali Loss: 1.217 Vali Acc: 0.480 Test Loss: 1.217 Test Acc: 0.480
Validation loss decreased (-0.260101 --> -0.479757).  Saving model ...
Epoch: 4 cost time: 1.5177433490753174
Epoch: 4, Steps: 17 | Train Loss: 1.081 Vali Loss: 1.107 Vali Acc: 0.474 Test Loss: 1.107 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.678187608718872
Epoch: 5, Steps: 17 | Train Loss: 0.955 Vali Loss: 0.978 Vali Acc: 0.590 Test Loss: 0.978 Test Acc: 0.590
Validation loss decreased (-0.479757 --> -0.589586).  Saving model ...
Epoch: 6 cost time: 1.5976715087890625
Epoch: 6, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.990 Vali Acc: 0.659 Test Loss: 0.990 Test Acc: 0.659
Validation loss decreased (-0.589586 --> -0.658950).  Saving model ...
Epoch: 7 cost time: 1.7720561027526855
Epoch: 7, Steps: 17 | Train Loss: 0.688 Vali Loss: 0.872 Vali Acc: 0.665 Test Loss: 0.872 Test Acc: 0.665
Validation loss decreased (-0.658950 --> -0.664731).  Saving model ...
Epoch: 8 cost time: 1.7410364151000977
Epoch: 8, Steps: 17 | Train Loss: 0.684 Vali Loss: 0.922 Vali Acc: 0.653 Test Loss: 0.922 Test Acc: 0.653
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.6815733909606934
Epoch: 9, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.770 Vali Acc: 0.688 Test Loss: 0.770 Test Acc: 0.688
Validation loss decreased (-0.664731 --> -0.687854).  Saving model ...
Epoch: 10 cost time: 1.8858790397644043
Epoch: 10, Steps: 17 | Train Loss: 0.399 Vali Loss: 0.993 Vali Acc: 0.694 Test Loss: 0.993 Test Acc: 0.694
Validation loss decreased (-0.687854 --> -0.693632).  Saving model ...
Epoch: 11 cost time: 1.7422473430633545
Epoch: 11, Steps: 17 | Train Loss: 0.450 Vali Loss: 0.794 Vali Acc: 0.763 Test Loss: 0.794 Test Acc: 0.763
Validation loss decreased (-0.693632 --> -0.762998).  Saving model ...
Epoch: 12 cost time: 1.9120116233825684
Epoch: 12, Steps: 17 | Train Loss: 0.312 Vali Loss: 0.838 Vali Acc: 0.723 Test Loss: 0.838 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7344162464141846
Epoch: 13, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.844 Vali Acc: 0.734 Test Loss: 0.844 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9493248462677002
Epoch: 14, Steps: 17 | Train Loss: 0.316 Vali Loss: 0.908 Vali Acc: 0.723 Test Loss: 0.908 Test Acc: 0.723
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.787874698638916
Epoch: 15, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.834 Vali Acc: 0.792 Test Loss: 0.834 Test Acc: 0.792
Validation loss decreased (-0.762998 --> -0.791899).  Saving model ...
Epoch: 16 cost time: 1.9636120796203613
Epoch: 16, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.788 Vali Acc: 0.815 Test Loss: 0.788 Test Acc: 0.815
Validation loss decreased (-0.791899 --> -0.815021).  Saving model ...
Epoch: 17 cost time: 1.6931157112121582
Epoch: 17, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.935 Vali Acc: 0.780 Test Loss: 0.935 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8784232139587402
Epoch: 18, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.841 Vali Acc: 0.757 Test Loss: 0.841 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8018193244934082
Epoch: 19, Steps: 17 | Train Loss: 0.158 Vali Loss: 1.136 Vali Acc: 0.734 Test Loss: 1.136 Test Acc: 0.734
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.5721218585968018
Epoch: 20, Steps: 17 | Train Loss: 0.133 Vali Loss: 0.819 Vali Acc: 0.815 Test Loss: 0.819 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6048030853271484
Epoch: 21, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.909 Vali Acc: 0.809 Test Loss: 0.909 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5958607196807861
Epoch: 22, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.014 Vali Acc: 0.798 Test Loss: 1.014 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.679560899734497
Epoch: 23, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.007 Vali Acc: 0.792 Test Loss: 1.007 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.6416234970092773
Epoch: 24, Steps: 17 | Train Loss: 0.100 Vali Loss: 1.336 Vali Acc: 0.763 Test Loss: 1.336 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7918360233306885
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.014 Vali Acc: 0.798 Test Loss: 1.014 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.751835584640503
Epoch: 26, Steps: 17 | Train Loss: 0.081 Vali Loss: 1.087 Vali Acc: 0.780 Test Loss: 1.087 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.815028901734104
model parameter : 647651
model size : 3.70MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8230433464050293
Epoch: 1, Steps: 17 | Train Loss: 1.904 Vali Loss: 1.647 Vali Acc: 0.364 Test Loss: 1.647 Test Acc: 0.364
Validation loss decreased (inf --> -0.364145).  Saving model ...
Epoch: 2 cost time: 1.5882225036621094
Epoch: 2, Steps: 17 | Train Loss: 1.431 Vali Loss: 1.270 Vali Acc: 0.416 Test Loss: 1.270 Test Acc: 0.416
Validation loss decreased (-0.364145 --> -0.416172).  Saving model ...
Epoch: 3 cost time: 1.9637610912322998
Epoch: 3, Steps: 17 | Train Loss: 1.077 Vali Loss: 1.062 Vali Acc: 0.526 Test Loss: 1.062 Test Acc: 0.526
Validation loss decreased (-0.416172 --> -0.526001).  Saving model ...
Epoch: 4 cost time: 1.8039910793304443
Epoch: 4, Steps: 17 | Train Loss: 0.879 Vali Loss: 1.088 Vali Acc: 0.543 Test Loss: 1.088 Test Acc: 0.543
Validation loss decreased (-0.526001 --> -0.543342).  Saving model ...
Epoch: 5 cost time: 1.7612361907958984
Epoch: 5, Steps: 17 | Train Loss: 0.776 Vali Loss: 0.843 Vali Acc: 0.688 Test Loss: 0.843 Test Acc: 0.688
Validation loss decreased (-0.543342 --> -0.687853).  Saving model ...
Epoch: 6 cost time: 1.7989697456359863
Epoch: 6, Steps: 17 | Train Loss: 0.604 Vali Loss: 0.805 Vali Acc: 0.699 Test Loss: 0.805 Test Acc: 0.699
Validation loss decreased (-0.687853 --> -0.699414).  Saving model ...
Epoch: 7 cost time: 1.8728744983673096
Epoch: 7, Steps: 17 | Train Loss: 0.490 Vali Loss: 0.753 Vali Acc: 0.728 Test Loss: 0.753 Test Acc: 0.728
Validation loss decreased (-0.699414 --> -0.728316).  Saving model ...
Epoch: 8 cost time: 1.865530014038086
Epoch: 8, Steps: 17 | Train Loss: 0.368 Vali Loss: 0.720 Vali Acc: 0.728 Test Loss: 0.720 Test Acc: 0.728
Validation loss decreased (-0.728316 --> -0.728317).  Saving model ...
Epoch: 9 cost time: 1.8460495471954346
Epoch: 9, Steps: 17 | Train Loss: 0.349 Vali Loss: 0.589 Vali Acc: 0.798 Test Loss: 0.589 Test Acc: 0.798
Validation loss decreased (-0.728317 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 1.8960847854614258
Epoch: 10, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.543 Vali Acc: 0.798 Test Loss: 0.543 Test Acc: 0.798
Validation loss decreased (-0.797682 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 1.786909818649292
Epoch: 11, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.858 Vali Acc: 0.723 Test Loss: 0.858 Test Acc: 0.723
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6727676391601562
Epoch: 12, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.567 Vali Acc: 0.867 Test Loss: 0.567 Test Acc: 0.867
Validation loss decreased (-0.797682 --> -0.867046).  Saving model ...
Epoch: 13 cost time: 1.772010087966919
Epoch: 13, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.837 Vali Acc: 0.780 Test Loss: 0.837 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7161731719970703
Epoch: 14, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.003 Vali Acc: 0.751 Test Loss: 1.003 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.0174484252929688
Epoch: 15, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.827 Vali Acc: 0.775 Test Loss: 0.827 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7268991470336914
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.140 Vali Acc: 0.798 Test Loss: 1.140 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.9929940700531006
Epoch: 17, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.897 Vali Acc: 0.792 Test Loss: 0.897 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.811737060546875
Epoch: 18, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.838 Vali Acc: 0.809 Test Loss: 0.838 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.909313440322876
Epoch: 19, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.743 Vali Acc: 0.832 Test Loss: 0.743 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0452237129211426
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.846 Vali Acc: 0.815 Test Loss: 0.846 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8606083393096924
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.619 Vali Acc: 0.832 Test Loss: 0.619 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 2.034275531768799
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.755 Vali Acc: 0.832 Test Loss: 0.755 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 516579
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7979090213775635
Epoch: 1, Steps: 17 | Train Loss: 1.899 Vali Loss: 1.651 Vali Acc: 0.370 Test Loss: 1.651 Test Acc: 0.370
Validation loss decreased (inf --> -0.369926).  Saving model ...
Epoch: 2 cost time: 1.7787621021270752
Epoch: 2, Steps: 17 | Train Loss: 1.433 Vali Loss: 1.284 Vali Acc: 0.399 Test Loss: 1.284 Test Acc: 0.399
Validation loss decreased (-0.369926 --> -0.398831).  Saving model ...
Epoch: 3 cost time: 1.5957896709442139
Epoch: 3, Steps: 17 | Train Loss: 1.084 Vali Loss: 1.074 Vali Acc: 0.561 Test Loss: 1.074 Test Acc: 0.561
Validation loss decreased (-0.398831 --> -0.560683).  Saving model ...
Epoch: 4 cost time: 1.8110613822937012
Epoch: 4, Steps: 17 | Train Loss: 0.922 Vali Loss: 1.116 Vali Acc: 0.549 Test Loss: 1.116 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.7160272598266602
Epoch: 5, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.858 Vali Acc: 0.665 Test Loss: 0.858 Test Acc: 0.665
Validation loss decreased (-0.560683 --> -0.664731).  Saving model ...
Epoch: 6 cost time: 1.4423253536224365
Epoch: 6, Steps: 17 | Train Loss: 0.644 Vali Loss: 0.832 Vali Acc: 0.699 Test Loss: 0.832 Test Acc: 0.699
Validation loss decreased (-0.664731 --> -0.699414).  Saving model ...
Epoch: 7 cost time: 1.7917637825012207
Epoch: 7, Steps: 17 | Train Loss: 0.536 Vali Loss: 0.829 Vali Acc: 0.694 Test Loss: 0.829 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.040501356124878
Epoch: 8, Steps: 17 | Train Loss: 0.431 Vali Loss: 0.747 Vali Acc: 0.734 Test Loss: 0.747 Test Acc: 0.734
Validation loss decreased (-0.699414 --> -0.734097).  Saving model ...
Epoch: 9 cost time: 1.90301513671875
Epoch: 9, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.654 Vali Acc: 0.769 Test Loss: 0.654 Test Acc: 0.769
Validation loss decreased (-0.734097 --> -0.768780).  Saving model ...
Epoch: 10 cost time: 1.846773386001587
Epoch: 10, Steps: 17 | Train Loss: 0.264 Vali Loss: 0.618 Vali Acc: 0.815 Test Loss: 0.618 Test Acc: 0.815
Validation loss decreased (-0.768780 --> -0.815023).  Saving model ...
Epoch: 11 cost time: 1.930506944656372
Epoch: 11, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.854 Vali Acc: 0.746 Test Loss: 0.854 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.86808443069458
Epoch: 12, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.656 Vali Acc: 0.775 Test Loss: 0.656 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.9884757995605469
Epoch: 13, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.088 Vali Acc: 0.746 Test Loss: 1.088 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.687631607055664
Epoch: 14, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.942 Vali Acc: 0.780 Test Loss: 0.942 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 2.0810024738311768
Epoch: 15, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.799 Vali Acc: 0.798 Test Loss: 0.799 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.705653190612793
Epoch: 16, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.742 Vali Acc: 0.827 Test Loss: 0.742 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826582).  Saving model ...
Epoch: 17 cost time: 1.8634095191955566
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.723 Vali Acc: 0.803 Test Loss: 0.723 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7357971668243408
Epoch: 18, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.918 Vali Acc: 0.803 Test Loss: 0.918 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8769822120666504
Epoch: 19, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.879 Vali Acc: 0.803 Test Loss: 0.879 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.9802072048187256
Epoch: 20, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.788 Vali Acc: 0.809 Test Loss: 0.788 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9934492111206055
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.745 Vali Acc: 0.821 Test Loss: 0.745 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 2.0764431953430176
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.696 Vali Acc: 0.855 Test Loss: 0.696 Test Acc: 0.855
Validation loss decreased (-0.826582 --> -0.855484).  Saving model ...
Epoch: 23 cost time: 1.9171996116638184
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.800 Vali Acc: 0.815 Test Loss: 0.800 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 2.0309014320373535
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.762 Vali Acc: 0.815 Test Loss: 0.762 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.8618440628051758
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.838 Test Loss: 0.739 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.7272100448608398
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.798 Vali Acc: 0.832 Test Loss: 0.798 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8356337547302246
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.746 Vali Acc: 0.815 Test Loss: 0.746 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.6068987846374512
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.827 Test Loss: 0.744 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.7622449398040771
Epoch: 29, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.750 Vali Acc: 0.815 Test Loss: 0.750 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.791118860244751
Epoch: 30, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.744 Vali Acc: 0.815 Test Loss: 0.744 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 2.0320684909820557
Epoch: 31, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.742 Vali Acc: 0.809 Test Loss: 0.742 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.7496938705444336
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.799 Vali Acc: 0.821 Test Loss: 0.799 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 516579
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.123513221740723
Epoch: 1, Steps: 17 | Train Loss: 1.913 Vali Loss: 1.695 Vali Acc: 0.364 Test Loss: 1.695 Test Acc: 0.364
Validation loss decreased (inf --> -0.364145).  Saving model ...
Epoch: 2 cost time: 1.7093079090118408
Epoch: 2, Steps: 17 | Train Loss: 1.486 Vali Loss: 1.309 Vali Acc: 0.393 Test Loss: 1.309 Test Acc: 0.393
Validation loss decreased (-0.364145 --> -0.393050).  Saving model ...
Epoch: 3 cost time: 1.6655116081237793
Epoch: 3, Steps: 17 | Train Loss: 1.116 Vali Loss: 1.046 Vali Acc: 0.584 Test Loss: 1.046 Test Acc: 0.584
Validation loss decreased (-0.393050 --> -0.583805).  Saving model ...
Epoch: 4 cost time: 1.7769060134887695
Epoch: 4, Steps: 17 | Train Loss: 0.925 Vali Loss: 1.074 Vali Acc: 0.561 Test Loss: 1.074 Test Acc: 0.561
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.655869722366333
Epoch: 5, Steps: 17 | Train Loss: 0.809 Vali Loss: 0.839 Vali Acc: 0.705 Test Loss: 0.839 Test Acc: 0.705
Validation loss decreased (-0.583805 --> -0.705194).  Saving model ...
Epoch: 6 cost time: 1.8736555576324463
Epoch: 6, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.802 Vali Acc: 0.705 Test Loss: 0.802 Test Acc: 0.705
Validation loss decreased (-0.705194 --> -0.705194).  Saving model ...
Epoch: 7 cost time: 1.8269734382629395
Epoch: 7, Steps: 17 | Train Loss: 0.591 Vali Loss: 0.874 Vali Acc: 0.682 Test Loss: 0.874 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9156572818756104
Epoch: 8, Steps: 17 | Train Loss: 0.475 Vali Loss: 0.847 Vali Acc: 0.688 Test Loss: 0.847 Test Acc: 0.688
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.9238018989562988
Epoch: 9, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.739 Vali Acc: 0.734 Test Loss: 0.739 Test Acc: 0.734
Validation loss decreased (-0.705194 --> -0.734097).  Saving model ...
Epoch: 10 cost time: 1.6644413471221924
Epoch: 10, Steps: 17 | Train Loss: 0.317 Vali Loss: 0.686 Vali Acc: 0.775 Test Loss: 0.686 Test Acc: 0.775
Validation loss decreased (-0.734097 --> -0.774560).  Saving model ...
Epoch: 11 cost time: 1.8355309963226318
Epoch: 11, Steps: 17 | Train Loss: 0.241 Vali Loss: 0.706 Vali Acc: 0.757 Test Loss: 0.706 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8744332790374756
Epoch: 12, Steps: 17 | Train Loss: 0.205 Vali Loss: 0.766 Vali Acc: 0.769 Test Loss: 0.766 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.712691307067871
Epoch: 13, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.683 Vali Acc: 0.809 Test Loss: 0.683 Test Acc: 0.809
Validation loss decreased (-0.774560 --> -0.809242).  Saving model ...
Epoch: 14 cost time: 1.8293201923370361
Epoch: 14, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.666 Vali Acc: 0.803 Test Loss: 0.666 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.817230463027954
Epoch: 15, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.798 Vali Acc: 0.763 Test Loss: 0.798 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.8675096035003662
Epoch: 16, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.841 Vali Acc: 0.775 Test Loss: 0.841 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.673567295074463
Epoch: 17, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.782 Vali Acc: 0.815 Test Loss: 0.782 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815021).  Saving model ...
Epoch: 18 cost time: 1.9505038261413574
Epoch: 18, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.866 Vali Acc: 0.792 Test Loss: 0.866 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.747546911239624
Epoch: 19, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.477 Vali Acc: 0.763 Test Loss: 1.477 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.6783668994903564
Epoch: 20, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.984 Vali Acc: 0.780 Test Loss: 0.984 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9326791763305664
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.197 Vali Acc: 0.780 Test Loss: 1.197 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.9325616359710693
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 1.341 Vali Acc: 0.786 Test Loss: 1.341 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.7518155574798584
Epoch: 23, Steps: 17 | Train Loss: 0.082 Vali Loss: 1.054 Vali Acc: 0.821 Test Loss: 1.054 Test Acc: 0.821
Validation loss decreased (-0.815021 --> -0.820799).  Saving model ...
Epoch: 24 cost time: 1.8461804389953613
Epoch: 24, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.522 Vali Acc: 0.780 Test Loss: 1.522 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9812474250793457
Epoch: 25, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.374 Vali Acc: 0.803 Test Loss: 1.374 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9171273708343506
Epoch: 26, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.931 Vali Acc: 0.827 Test Loss: 0.931 Test Acc: 0.827
Validation loss decreased (-0.820799 --> -0.826580).  Saving model ...
Epoch: 27 cost time: 2.028714656829834
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.512 Vali Acc: 0.780 Test Loss: 1.512 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 2.479423999786377
Epoch: 28, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.315 Vali Acc: 0.809 Test Loss: 1.315 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 2.094461441040039
Epoch: 29, Steps: 17 | Train Loss: 0.088 Vali Loss: 1.174 Vali Acc: 0.780 Test Loss: 1.174 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 2.2485501766204834
Epoch: 30, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.220 Vali Acc: 0.775 Test Loss: 1.220 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 2.296900749206543
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.092 Vali Acc: 0.792 Test Loss: 1.092 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 2.1262588500976562
Epoch: 32, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.939 Vali Acc: 0.850 Test Loss: 0.939 Test Acc: 0.850
Validation loss decreased (-0.826580 --> -0.849702).  Saving model ...
Epoch: 33 cost time: 2.104990005493164
Epoch: 33, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.341 Vali Acc: 0.844 Test Loss: 1.341 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 2.254236936569214
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.135 Vali Acc: 0.850 Test Loss: 1.135 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 2.208392858505249
Epoch: 35, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.368 Vali Acc: 0.786 Test Loss: 1.368 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 2.143263816833496
Epoch: 36, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.460 Vali Acc: 0.803 Test Loss: 1.460 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 2.3820526599884033
Epoch: 37, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.202 Vali Acc: 0.838 Test Loss: 1.202 Test Acc: 0.838
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 2.2317986488342285
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.328 Vali Acc: 0.803 Test Loss: 1.328 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 2.169219732284546
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.365 Vali Acc: 0.815 Test Loss: 1.365 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 2.062403440475464
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.513 Vali Acc: 0.832 Test Loss: 1.513 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 2.186729669570923
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.427 Vali Acc: 0.827 Test Loss: 1.427 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.8771960735321045
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.297 Vali Acc: 0.827 Test Loss: 1.297 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 516579
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.853806257247925
Epoch: 1, Steps: 17 | Train Loss: 1.923 Vali Loss: 1.746 Vali Acc: 0.295 Test Loss: 1.746 Test Acc: 0.295
Validation loss decreased (inf --> -0.294780).  Saving model ...
Epoch: 2 cost time: 1.6531586647033691
Epoch: 2, Steps: 17 | Train Loss: 1.595 Vali Loss: 1.406 Vali Acc: 0.393 Test Loss: 1.406 Test Acc: 0.393
Validation loss decreased (-0.294780 --> -0.393050).  Saving model ...
Epoch: 3 cost time: 1.9577810764312744
Epoch: 3, Steps: 17 | Train Loss: 1.282 Vali Loss: 1.173 Vali Acc: 0.486 Test Loss: 1.173 Test Acc: 0.486
Validation loss decreased (-0.393050 --> -0.485537).  Saving model ...
Epoch: 4 cost time: 1.8279728889465332
Epoch: 4, Steps: 17 | Train Loss: 1.074 Vali Loss: 1.296 Vali Acc: 0.474 Test Loss: 1.296 Test Acc: 0.474
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6095495223999023
Epoch: 5, Steps: 17 | Train Loss: 1.015 Vali Loss: 1.002 Vali Acc: 0.642 Test Loss: 1.002 Test Acc: 0.642
Validation loss decreased (-0.485537 --> -0.641608).  Saving model ...
Epoch: 6 cost time: 1.7883164882659912
Epoch: 6, Steps: 17 | Train Loss: 0.832 Vali Loss: 1.042 Vali Acc: 0.607 Test Loss: 1.042 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.970102310180664
Epoch: 7, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.892 Vali Acc: 0.699 Test Loss: 0.892 Test Acc: 0.699
Validation loss decreased (-0.641608 --> -0.699413).  Saving model ...
Epoch: 8 cost time: 1.6255762577056885
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.937 Vali Acc: 0.624 Test Loss: 0.937 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.646272897720337
Epoch: 9, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.825 Vali Acc: 0.671 Test Loss: 0.825 Test Acc: 0.671
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.780024528503418
Epoch: 10, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.823 Vali Acc: 0.763 Test Loss: 0.823 Test Acc: 0.763
Validation loss decreased (-0.699413 --> -0.762998).  Saving model ...
Epoch: 11 cost time: 1.6907145977020264
Epoch: 11, Steps: 17 | Train Loss: 0.409 Vali Loss: 0.966 Vali Acc: 0.688 Test Loss: 0.966 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.7920386791229248
Epoch: 12, Steps: 17 | Train Loss: 0.327 Vali Loss: 0.662 Vali Acc: 0.798 Test Loss: 0.662 Test Acc: 0.798
Validation loss decreased (-0.762998 --> -0.797681).  Saving model ...
Epoch: 13 cost time: 1.7484769821166992
Epoch: 13, Steps: 17 | Train Loss: 0.213 Vali Loss: 0.724 Vali Acc: 0.763 Test Loss: 0.724 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7344706058502197
Epoch: 14, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.964 Vali Acc: 0.699 Test Loss: 0.964 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7000200748443604
Epoch: 15, Steps: 17 | Train Loss: 0.277 Vali Loss: 1.055 Vali Acc: 0.659 Test Loss: 1.055 Test Acc: 0.659
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.8377008438110352
Epoch: 16, Steps: 17 | Train Loss: 0.222 Vali Loss: 1.123 Vali Acc: 0.682 Test Loss: 1.123 Test Acc: 0.682
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8776533603668213
Epoch: 17, Steps: 17 | Train Loss: 0.166 Vali Loss: 1.044 Vali Acc: 0.757 Test Loss: 1.044 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7367103099822998
Epoch: 18, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.715 Vali Acc: 0.775 Test Loss: 0.715 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.8729186058044434
Epoch: 19, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.005 Vali Acc: 0.775 Test Loss: 1.005 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.776244878768921
Epoch: 20, Steps: 17 | Train Loss: 0.069 Vali Loss: 1.045 Vali Acc: 0.827 Test Loss: 1.045 Test Acc: 0.827
Validation loss decreased (-0.797681 --> -0.826579).  Saving model ...
Epoch: 21 cost time: 1.7658014297485352
Epoch: 21, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.128 Vali Acc: 0.792 Test Loss: 1.128 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.776017665863037
Epoch: 22, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.010 Vali Acc: 0.803 Test Loss: 1.010 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7753407955169678
Epoch: 23, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.987 Vali Acc: 0.832 Test Loss: 0.987 Test Acc: 0.832
Validation loss decreased (-0.826579 --> -0.832360).  Saving model ...
Epoch: 24 cost time: 1.7771828174591064
Epoch: 24, Steps: 17 | Train Loss: 0.332 Vali Loss: 1.370 Vali Acc: 0.763 Test Loss: 1.370 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.9571864604949951
Epoch: 25, Steps: 17 | Train Loss: 0.064 Vali Loss: 1.397 Vali Acc: 0.711 Test Loss: 1.397 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 2.025057792663574
Epoch: 26, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.343 Vali Acc: 0.775 Test Loss: 1.343 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.930521011352539
Epoch: 27, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.040 Vali Acc: 0.809 Test Loss: 1.040 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.7751355171203613
Epoch: 28, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.308 Vali Acc: 0.763 Test Loss: 1.308 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8849027156829834
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.446 Vali Acc: 0.763 Test Loss: 1.446 Test Acc: 0.763
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.749406337738037
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.367 Vali Acc: 0.809 Test Loss: 1.367 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.8052763938903809
Epoch: 31, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.333 Vali Acc: 0.809 Test Loss: 1.333 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.8002774715423584
Epoch: 32, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.463 Vali Acc: 0.815 Test Loss: 1.463 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7865855693817139
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.164 Vali Acc: 0.792 Test Loss: 1.164 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 516579
model size : 3.20MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.219319820404053
Epoch: 1, Steps: 17 | Train Loss: 1.889 Vali Loss: 1.668 Vali Acc: 0.312 Test Loss: 1.668 Test Acc: 0.312
Validation loss decreased (inf --> -0.312122).  Saving model ...
Epoch: 2 cost time: 1.9104900360107422
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.269 Vali Acc: 0.486 Test Loss: 1.269 Test Acc: 0.486
Validation loss decreased (-0.312122 --> -0.485536).  Saving model ...
Epoch: 3 cost time: 1.9106483459472656
Epoch: 3, Steps: 17 | Train Loss: 1.053 Vali Loss: 0.990 Vali Acc: 0.636 Test Loss: 0.990 Test Acc: 0.636
Validation loss decreased (-0.485536 --> -0.635828).  Saving model ...
Epoch: 4 cost time: 1.6550745964050293
Epoch: 4, Steps: 17 | Train Loss: 0.815 Vali Loss: 0.862 Vali Acc: 0.676 Test Loss: 0.862 Test Acc: 0.676
Validation loss decreased (-0.635828 --> -0.676292).  Saving model ...
Epoch: 5 cost time: 1.898728609085083
Epoch: 5, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.811 Vali Acc: 0.659 Test Loss: 0.811 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8815653324127197
Epoch: 6, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.718 Vali Acc: 0.751 Test Loss: 0.718 Test Acc: 0.751
Validation loss decreased (-0.676292 --> -0.751438).  Saving model ...
Epoch: 7 cost time: 1.794137716293335
Epoch: 7, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.639 Vali Acc: 0.821 Test Loss: 0.639 Test Acc: 0.821
Validation loss decreased (-0.751438 --> -0.820803).  Saving model ...
Epoch: 8 cost time: 1.6209485530853271
Epoch: 8, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.691 Vali Acc: 0.757 Test Loss: 0.691 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7202880382537842
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 1.193 Vali Acc: 0.711 Test Loss: 1.193 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6985046863555908
Epoch: 10, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.603 Vali Acc: 0.827 Test Loss: 0.603 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826584).  Saving model ...
Epoch: 11 cost time: 2.0274815559387207
Epoch: 11, Steps: 17 | Train Loss: 0.165 Vali Loss: 0.588 Vali Acc: 0.832 Test Loss: 0.588 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832364).  Saving model ...
Epoch: 12 cost time: 1.8748524188995361
Epoch: 12, Steps: 17 | Train Loss: 0.101 Vali Loss: 0.656 Vali Acc: 0.809 Test Loss: 0.656 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9276325702667236
Epoch: 13, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.859 Vali Acc: 0.757 Test Loss: 0.859 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.924072504043579
Epoch: 14, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.567 Vali Acc: 0.827 Test Loss: 0.567 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7465970516204834
Epoch: 15, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.769 Vali Acc: 0.792 Test Loss: 0.769 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.0445446968078613
Epoch: 16, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.793 Vali Acc: 0.780 Test Loss: 0.793 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.5602495670318604
Epoch: 17, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.954 Vali Acc: 0.803 Test Loss: 0.954 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.842106580734253
Epoch: 18, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.815 Vali Acc: 0.832 Test Loss: 0.815 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 2.2602319717407227
Epoch: 19, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.907 Vali Acc: 0.798 Test Loss: 0.907 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.990419626235962
Epoch: 20, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.802 Vali Acc: 0.827 Test Loss: 0.802 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8836150169372559
Epoch: 21, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.988 Vali Acc: 0.809 Test Loss: 0.988 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 451043
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.196662425994873
Epoch: 1, Steps: 17 | Train Loss: 1.881 Vali Loss: 1.668 Vali Acc: 0.295 Test Loss: 1.668 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 1.9518756866455078
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.269 Vali Acc: 0.474 Test Loss: 1.269 Test Acc: 0.474
Validation loss decreased (-0.294781 --> -0.473976).  Saving model ...
Epoch: 3 cost time: 1.8607540130615234
Epoch: 3, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.012 Vali Acc: 0.607 Test Loss: 1.012 Test Acc: 0.607
Validation loss decreased (-0.473976 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 1.7668688297271729
Epoch: 4, Steps: 17 | Train Loss: 0.841 Vali Loss: 0.903 Vali Acc: 0.659 Test Loss: 0.903 Test Acc: 0.659
Validation loss decreased (-0.606926 --> -0.658951).  Saving model ...
Epoch: 5 cost time: 1.7148849964141846
Epoch: 5, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.882 Vali Acc: 0.624 Test Loss: 0.882 Test Acc: 0.624
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.8669285774230957
Epoch: 6, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.762 Vali Acc: 0.746 Test Loss: 0.762 Test Acc: 0.746
Validation loss decreased (-0.658951 --> -0.745657).  Saving model ...
Epoch: 7 cost time: 2.0287859439849854
Epoch: 7, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.693 Vali Acc: 0.792 Test Loss: 0.693 Test Acc: 0.792
Validation loss decreased (-0.745657 --> -0.791901).  Saving model ...
Epoch: 8 cost time: 1.7443995475769043
Epoch: 8, Steps: 17 | Train Loss: 0.387 Vali Loss: 0.732 Vali Acc: 0.728 Test Loss: 0.732 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.9325180053710938
Epoch: 9, Steps: 17 | Train Loss: 0.353 Vali Loss: 1.172 Vali Acc: 0.682 Test Loss: 1.172 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 2.0083398818969727
Epoch: 10, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.579 Vali Acc: 0.815 Test Loss: 0.579 Test Acc: 0.815
Validation loss decreased (-0.791901 --> -0.815023).  Saving model ...
Epoch: 11 cost time: 1.8166675567626953
Epoch: 11, Steps: 17 | Train Loss: 0.170 Vali Loss: 0.641 Vali Acc: 0.821 Test Loss: 0.641 Test Acc: 0.821
Validation loss decreased (-0.815023 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 2.0217909812927246
Epoch: 12, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.695 Vali Acc: 0.798 Test Loss: 0.695 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9184017181396484
Epoch: 13, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.751 Vali Acc: 0.751 Test Loss: 0.751 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.8050644397735596
Epoch: 14, Steps: 17 | Train Loss: 0.077 Vali Loss: 0.601 Vali Acc: 0.838 Test Loss: 0.601 Test Acc: 0.838
Validation loss decreased (-0.820803 --> -0.838144).  Saving model ...
Epoch: 15 cost time: 1.9671530723571777
Epoch: 15, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.840 Vali Acc: 0.815 Test Loss: 0.840 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.925896167755127
Epoch: 16, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7025938034057617
Epoch: 17, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.735 Vali Acc: 0.850 Test Loss: 0.735 Test Acc: 0.850
Validation loss decreased (-0.838144 --> -0.849704).  Saving model ...
Epoch: 18 cost time: 1.8566057682037354
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.738 Vali Acc: 0.809 Test Loss: 0.738 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8540427684783936
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 1.039 Vali Acc: 0.786 Test Loss: 1.039 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7584021091461182
Epoch: 20, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.685 Vali Acc: 0.850 Test Loss: 0.685 Test Acc: 0.850
Validation loss decreased (-0.849704 --> -0.849704).  Saving model ...
Epoch: 21 cost time: 1.606482982635498
Epoch: 21, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.850 Test Loss: 0.736 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8940298557281494
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.832 Test Loss: 0.796 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9736833572387695
Epoch: 23, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.772 Vali Acc: 0.832 Test Loss: 0.772 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.896188497543335
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.779 Vali Acc: 0.821 Test Loss: 0.779 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 2.0138790607452393
Epoch: 25, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.767 Vali Acc: 0.821 Test Loss: 0.767 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.8032705783843994
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.806 Vali Acc: 0.809 Test Loss: 0.806 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.764268398284912
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.864 Vali Acc: 0.809 Test Loss: 0.864 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.6780140399932861
Epoch: 28, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.756 Vali Acc: 0.809 Test Loss: 0.756 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.8751580715179443
Epoch: 29, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.782 Vali Acc: 0.838 Test Loss: 0.782 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.9705054759979248
Epoch: 30, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.794 Vali Acc: 0.844 Test Loss: 0.794 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 451043
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.40861964225769
Epoch: 1, Steps: 17 | Train Loss: 1.885 Vali Loss: 1.687 Vali Acc: 0.324 Test Loss: 1.687 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 2.0311708450317383
Epoch: 2, Steps: 17 | Train Loss: 1.487 Vali Loss: 1.305 Vali Acc: 0.445 Test Loss: 1.305 Test Acc: 0.445
Validation loss decreased (-0.323683 --> -0.445074).  Saving model ...
Epoch: 3 cost time: 2.062124013900757
Epoch: 3, Steps: 17 | Train Loss: 1.104 Vali Loss: 1.059 Vali Acc: 0.607 Test Loss: 1.059 Test Acc: 0.607
Validation loss decreased (-0.445074 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 1.745269536972046
Epoch: 4, Steps: 17 | Train Loss: 0.870 Vali Loss: 0.918 Vali Acc: 0.694 Test Loss: 0.918 Test Acc: 0.694
Validation loss decreased (-0.606926 --> -0.693632).  Saving model ...
Epoch: 5 cost time: 1.6716101169586182
Epoch: 5, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.985 Vali Acc: 0.613 Test Loss: 0.985 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.748654842376709
Epoch: 6, Steps: 17 | Train Loss: 0.683 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.693632 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 1.8101980686187744
Epoch: 7, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.756 Vali Acc: 0.734 Test Loss: 0.756 Test Acc: 0.734
Validation loss decreased (-0.728316 --> -0.734096).  Saving model ...
Epoch: 8 cost time: 1.7378308773040771
Epoch: 8, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.788 Vali Acc: 0.694 Test Loss: 0.788 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7999775409698486
Epoch: 9, Steps: 17 | Train Loss: 0.405 Vali Loss: 1.300 Vali Acc: 0.694 Test Loss: 1.300 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.779381513595581
Epoch: 10, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.614 Vali Acc: 0.803 Test Loss: 0.614 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803462).  Saving model ...
Epoch: 11 cost time: 1.873767375946045
Epoch: 11, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.778 Vali Acc: 0.775 Test Loss: 0.778 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.795041561126709
Epoch: 12, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.844 Vali Acc: 0.769 Test Loss: 0.844 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7070703506469727
Epoch: 13, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.811 Vali Acc: 0.798 Test Loss: 0.811 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.696455478668213
Epoch: 14, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.962 Vali Acc: 0.780 Test Loss: 0.962 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7722892761230469
Epoch: 15, Steps: 17 | Train Loss: 0.121 Vali Loss: 0.954 Vali Acc: 0.827 Test Loss: 0.954 Test Acc: 0.827
Validation loss decreased (-0.803462 --> -0.826580).  Saving model ...
Epoch: 16 cost time: 1.7999813556671143
Epoch: 16, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.866 Vali Acc: 0.803 Test Loss: 0.866 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.9183127880096436
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.857 Vali Acc: 0.832 Test Loss: 0.857 Test Acc: 0.832
Validation loss decreased (-0.826580 --> -0.832361).  Saving model ...
Epoch: 18 cost time: 1.7926015853881836
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.902 Vali Acc: 0.821 Test Loss: 0.902 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8161346912384033
Epoch: 19, Steps: 17 | Train Loss: 0.080 Vali Loss: 1.075 Vali Acc: 0.786 Test Loss: 1.075 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8371477127075195
Epoch: 20, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.301 Vali Acc: 0.757 Test Loss: 1.301 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.9189367294311523
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.063 Vali Acc: 0.809 Test Loss: 1.063 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.7940974235534668
Epoch: 22, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.920 Vali Acc: 0.855 Test Loss: 0.920 Test Acc: 0.855
Validation loss decreased (-0.832361 --> -0.855482).  Saving model ...
Epoch: 23 cost time: 1.9571161270141602
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.123 Vali Acc: 0.798 Test Loss: 1.123 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.9375057220458984
Epoch: 24, Steps: 17 | Train Loss: 0.074 Vali Loss: 1.238 Vali Acc: 0.838 Test Loss: 1.238 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.865999698638916
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.150 Vali Acc: 0.798 Test Loss: 1.150 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.784651517868042
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.320 Vali Acc: 0.775 Test Loss: 1.320 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.7475841045379639
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.132 Vali Acc: 0.792 Test Loss: 1.132 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.9264304637908936
Epoch: 28, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.131 Vali Acc: 0.780 Test Loss: 1.131 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 29 cost time: 1.930436372756958
Epoch: 29, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.522 Vali Acc: 0.792 Test Loss: 1.522 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 30 cost time: 1.8407373428344727
Epoch: 30, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.491 Vali Acc: 0.809 Test Loss: 1.491 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 31 cost time: 1.8177828788757324
Epoch: 31, Steps: 17 | Train Loss: 0.009 Vali Loss: 1.256 Vali Acc: 0.809 Test Loss: 1.256 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 32 cost time: 1.8161933422088623
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.084 Vali Acc: 0.815 Test Loss: 1.084 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 451043
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6374130249023438
Epoch: 1, Steps: 17 | Train Loss: 1.902 Vali Loss: 1.751 Vali Acc: 0.306 Test Loss: 1.751 Test Acc: 0.306
Validation loss decreased (inf --> -0.306341).  Saving model ...
Epoch: 2 cost time: 1.6472256183624268
Epoch: 2, Steps: 17 | Train Loss: 1.574 Vali Loss: 1.359 Vali Acc: 0.503 Test Loss: 1.359 Test Acc: 0.503
Validation loss decreased (-0.306341 --> -0.502877).  Saving model ...
Epoch: 3 cost time: 1.8710978031158447
Epoch: 3, Steps: 17 | Train Loss: 1.237 Vali Loss: 1.141 Vali Acc: 0.578 Test Loss: 1.141 Test Acc: 0.578
Validation loss decreased (-0.502877 --> -0.578023).  Saving model ...
Epoch: 4 cost time: 1.8699612617492676
Epoch: 4, Steps: 17 | Train Loss: 1.023 Vali Loss: 1.051 Vali Acc: 0.607 Test Loss: 1.051 Test Acc: 0.607
Validation loss decreased (-0.578023 --> -0.606926).  Saving model ...
Epoch: 5 cost time: 1.9978344440460205
Epoch: 5, Steps: 17 | Train Loss: 0.823 Vali Loss: 1.166 Vali Acc: 0.526 Test Loss: 1.166 Test Acc: 0.526
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.7440574169158936
Epoch: 6, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.875 Vali Acc: 0.659 Test Loss: 0.875 Test Acc: 0.659
Validation loss decreased (-0.606926 --> -0.658951).  Saving model ...
Epoch: 7 cost time: 1.8317058086395264
Epoch: 7, Steps: 17 | Train Loss: 0.602 Vali Loss: 0.819 Vali Acc: 0.665 Test Loss: 0.819 Test Acc: 0.665
Validation loss decreased (-0.658951 --> -0.664732).  Saving model ...
Epoch: 8 cost time: 1.7273731231689453
Epoch: 8, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.836 Vali Acc: 0.688 Test Loss: 0.836 Test Acc: 0.688
Validation loss decreased (-0.664732 --> -0.687853).  Saving model ...
Epoch: 9 cost time: 1.937800407409668
Epoch: 9, Steps: 17 | Train Loss: 0.600 Vali Loss: 1.088 Vali Acc: 0.676 Test Loss: 1.088 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.9688127040863037
Epoch: 10, Steps: 17 | Train Loss: 0.513 Vali Loss: 0.955 Vali Acc: 0.699 Test Loss: 0.955 Test Acc: 0.699
Validation loss decreased (-0.687853 --> -0.699412).  Saving model ...
Epoch: 11 cost time: 1.898103952407837
Epoch: 11, Steps: 17 | Train Loss: 0.414 Vali Loss: 0.689 Vali Acc: 0.757 Test Loss: 0.689 Test Acc: 0.757
Validation loss decreased (-0.699412 --> -0.757219).  Saving model ...
Epoch: 12 cost time: 1.953425407409668
Epoch: 12, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.838 Vali Acc: 0.757 Test Loss: 0.838 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.818150281906128
Epoch: 13, Steps: 17 | Train Loss: 0.296 Vali Loss: 0.725 Vali Acc: 0.723 Test Loss: 0.725 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.9560997486114502
Epoch: 14, Steps: 17 | Train Loss: 0.196 Vali Loss: 0.755 Vali Acc: 0.809 Test Loss: 0.755 Test Acc: 0.809
Validation loss decreased (-0.757219 --> -0.809241).  Saving model ...
Epoch: 15 cost time: 1.9693658351898193
Epoch: 15, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.862 Vali Acc: 0.763 Test Loss: 0.862 Test Acc: 0.763
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8725051879882812
Epoch: 16, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.904 Vali Acc: 0.769 Test Loss: 0.904 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.703737497329712
Epoch: 17, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.894 Vali Acc: 0.769 Test Loss: 0.894 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.9815475940704346
Epoch: 18, Steps: 17 | Train Loss: 0.224 Vali Loss: 0.736 Vali Acc: 0.803 Test Loss: 0.736 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8785881996154785
Epoch: 19, Steps: 17 | Train Loss: 0.116 Vali Loss: 1.292 Vali Acc: 0.734 Test Loss: 1.292 Test Acc: 0.734
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.9942450523376465
Epoch: 20, Steps: 17 | Train Loss: 0.152 Vali Loss: 1.295 Vali Acc: 0.757 Test Loss: 1.295 Test Acc: 0.757
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.2371954917907715
Epoch: 21, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.860 Vali Acc: 0.809 Test Loss: 0.860 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.9749839305877686
Epoch: 22, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.421 Vali Acc: 0.763 Test Loss: 1.421 Test Acc: 0.763
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.9189393520355225
Epoch: 23, Steps: 17 | Train Loss: 0.086 Vali Loss: 1.402 Vali Acc: 0.757 Test Loss: 1.402 Test Acc: 0.757
EarlyStopping counter: 9 out of 10
Epoch: 24 cost time: 2.048745632171631
Epoch: 24, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.022 Vali Acc: 0.821 Test Loss: 1.022 Test Acc: 0.821
Validation loss decreased (-0.809241 --> -0.820799).  Saving model ...
Epoch: 25 cost time: 1.9629476070404053
Epoch: 25, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.465 Vali Acc: 0.769 Test Loss: 1.465 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9133119583129883
Epoch: 26, Steps: 17 | Train Loss: 0.046 Vali Loss: 1.142 Vali Acc: 0.786 Test Loss: 1.142 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.9758961200714111
Epoch: 27, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.313 Vali Acc: 0.786 Test Loss: 1.313 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.9543681144714355
Epoch: 28, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.497 Vali Acc: 0.792 Test Loss: 1.497 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.001322031021118
Epoch: 29, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.177 Vali Acc: 0.798 Test Loss: 1.177 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 2.051025152206421
Epoch: 30, Steps: 17 | Train Loss: 0.045 Vali Loss: 1.683 Vali Acc: 0.792 Test Loss: 1.683 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9565951824188232
Epoch: 31, Steps: 17 | Train Loss: 0.039 Vali Loss: 1.307 Vali Acc: 0.786 Test Loss: 1.307 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9237549304962158
Epoch: 32, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.436 Vali Acc: 0.780 Test Loss: 1.436 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 2.02293062210083
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.500 Vali Acc: 0.769 Test Loss: 1.500 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 2.081575632095337
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.451 Vali Acc: 0.780 Test Loss: 1.451 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 451043
model size : 2.95MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.121624946594238
Epoch: 1, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.627 Vali Acc: 0.301 Test Loss: 1.627 Test Acc: 0.301
Validation loss decreased (inf --> -0.300562).  Saving model ...
Epoch: 2 cost time: 1.8428728580474854
Epoch: 2, Steps: 17 | Train Loss: 1.399 Vali Loss: 1.229 Vali Acc: 0.457 Test Loss: 1.229 Test Acc: 0.457
Validation loss decreased (-0.300562 --> -0.456635).  Saving model ...
Epoch: 3 cost time: 1.6448259353637695
Epoch: 3, Steps: 17 | Train Loss: 1.089 Vali Loss: 1.066 Vali Acc: 0.607 Test Loss: 1.066 Test Acc: 0.607
Validation loss decreased (-0.456635 --> -0.606926).  Saving model ...
Epoch: 4 cost time: 1.703216552734375
Epoch: 4, Steps: 17 | Train Loss: 0.862 Vali Loss: 0.956 Vali Acc: 0.584 Test Loss: 0.956 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8979902267456055
Epoch: 5, Steps: 17 | Train Loss: 0.741 Vali Loss: 0.949 Vali Acc: 0.601 Test Loss: 0.949 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.8885161876678467
Epoch: 6, Steps: 17 | Train Loss: 0.631 Vali Loss: 0.756 Vali Acc: 0.723 Test Loss: 0.756 Test Acc: 0.723
Validation loss decreased (-0.606926 --> -0.722536).  Saving model ...
Epoch: 7 cost time: 1.819213628768921
Epoch: 7, Steps: 17 | Train Loss: 0.521 Vali Loss: 0.775 Vali Acc: 0.671 Test Loss: 0.775 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.0178864002227783
Epoch: 8, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.753 Vali Acc: 0.734 Test Loss: 0.753 Test Acc: 0.734
Validation loss decreased (-0.722536 --> -0.734097).  Saving model ...
Epoch: 9 cost time: 1.85322904586792
Epoch: 9, Steps: 17 | Train Loss: 0.339 Vali Loss: 0.714 Vali Acc: 0.740 Test Loss: 0.714 Test Acc: 0.740
Validation loss decreased (-0.734097 --> -0.739877).  Saving model ...
Epoch: 10 cost time: 1.794969081878662
Epoch: 10, Steps: 17 | Train Loss: 0.218 Vali Loss: 0.600 Vali Acc: 0.792 Test Loss: 0.600 Test Acc: 0.792
Validation loss decreased (-0.739877 --> -0.791902).  Saving model ...
Epoch: 11 cost time: 1.898895502090454
Epoch: 11, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.675 Vali Acc: 0.792 Test Loss: 0.675 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9319243431091309
Epoch: 12, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.616 Vali Acc: 0.838 Test Loss: 0.616 Test Acc: 0.838
Validation loss decreased (-0.791902 --> -0.838144).  Saving model ...
Epoch: 13 cost time: 2.084275960922241
Epoch: 13, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.757 Vali Acc: 0.792 Test Loss: 0.757 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9316482543945312
Epoch: 14, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.687 Vali Acc: 0.821 Test Loss: 0.687 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7573575973510742
Epoch: 15, Steps: 17 | Train Loss: 0.046 Vali Loss: 0.664 Vali Acc: 0.809 Test Loss: 0.664 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.9114456176757812
Epoch: 16, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.778 Vali Acc: 0.809 Test Loss: 0.778 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.88637113571167
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.965 Vali Acc: 0.798 Test Loss: 0.965 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 2.284172773361206
Epoch: 18, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.932 Vali Acc: 0.832 Test Loss: 0.932 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.9490280151367188
Epoch: 19, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.855 Vali Acc: 0.809 Test Loss: 0.855 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 2.0125114917755127
Epoch: 20, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.943 Vali Acc: 0.827 Test Loss: 0.943 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.8547439575195312
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.794 Vali Acc: 0.821 Test Loss: 0.794 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 22 cost time: 1.9865343570709229
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.931 Vali Acc: 0.780 Test Loss: 0.931 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 418275
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.191284418106079
Epoch: 1, Steps: 17 | Train Loss: 1.915 Vali Loss: 1.626 Vali Acc: 0.324 Test Loss: 1.626 Test Acc: 0.324
Validation loss decreased (inf --> -0.323683).  Saving model ...
Epoch: 2 cost time: 1.811401128768921
Epoch: 2, Steps: 17 | Train Loss: 1.409 Vali Loss: 1.214 Vali Acc: 0.462 Test Loss: 1.214 Test Acc: 0.462
Validation loss decreased (-0.323683 --> -0.462416).  Saving model ...
Epoch: 3 cost time: 1.7671747207641602
Epoch: 3, Steps: 17 | Train Loss: 1.097 Vali Loss: 1.064 Vali Acc: 0.630 Test Loss: 1.064 Test Acc: 0.630
Validation loss decreased (-0.462416 --> -0.630047).  Saving model ...
Epoch: 4 cost time: 1.7890732288360596
Epoch: 4, Steps: 17 | Train Loss: 0.864 Vali Loss: 0.975 Vali Acc: 0.572 Test Loss: 0.975 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.9116084575653076
Epoch: 5, Steps: 17 | Train Loss: 0.759 Vali Loss: 0.929 Vali Acc: 0.613 Test Loss: 0.929 Test Acc: 0.613
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7084331512451172
Epoch: 6, Steps: 17 | Train Loss: 0.664 Vali Loss: 0.751 Vali Acc: 0.723 Test Loss: 0.751 Test Acc: 0.723
Validation loss decreased (-0.630047 --> -0.722536).  Saving model ...
Epoch: 7 cost time: 1.7324860095977783
Epoch: 7, Steps: 17 | Train Loss: 0.570 Vali Loss: 0.785 Vali Acc: 0.665 Test Loss: 0.785 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7359919548034668
Epoch: 8, Steps: 17 | Train Loss: 0.400 Vali Loss: 0.903 Vali Acc: 0.699 Test Loss: 0.903 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8898978233337402
Epoch: 9, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.790 Vali Acc: 0.711 Test Loss: 0.790 Test Acc: 0.711
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 2.0169565677642822
Epoch: 10, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.557 Vali Acc: 0.815 Test Loss: 0.557 Test Acc: 0.815
Validation loss decreased (-0.722536 --> -0.815023).  Saving model ...
Epoch: 11 cost time: 1.844435214996338
Epoch: 11, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8350884914398193
Epoch: 12, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.682 Vali Acc: 0.798 Test Loss: 0.682 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.7732923030853271
Epoch: 13, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.649 Vali Acc: 0.803 Test Loss: 0.649 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.9461405277252197
Epoch: 14, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.682 Vali Acc: 0.809 Test Loss: 0.682 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.93044114112854
Epoch: 15, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.585 Vali Acc: 0.861 Test Loss: 0.585 Test Acc: 0.861
Validation loss decreased (-0.815023 --> -0.861266).  Saving model ...
Epoch: 16 cost time: 1.763942003250122
Epoch: 16, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.835 Vali Acc: 0.798 Test Loss: 0.835 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.6555371284484863
Epoch: 17, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.952 Vali Acc: 0.775 Test Loss: 0.952 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.6685352325439453
Epoch: 18, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.825 Vali Acc: 0.844 Test Loss: 0.825 Test Acc: 0.844
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.7650434970855713
Epoch: 19, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.094 Vali Acc: 0.798 Test Loss: 1.094 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.8777263164520264
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.970 Vali Acc: 0.844 Test Loss: 0.970 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.6913340091705322
Epoch: 21, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.919 Vali Acc: 0.821 Test Loss: 0.919 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7212588787078857
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.166 Vali Acc: 0.775 Test Loss: 1.166 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4740607738494873
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.832 Vali Acc: 0.844 Test Loss: 0.832 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.740790843963623
Epoch: 24, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.063 Vali Acc: 0.821 Test Loss: 1.063 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 25 cost time: 1.9353363513946533
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.775 Vali Acc: 0.838 Test Loss: 0.775 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 418275
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7211029529571533
Epoch: 1, Steps: 17 | Train Loss: 1.944 Vali Loss: 1.704 Vali Acc: 0.260 Test Loss: 1.704 Test Acc: 0.260
Validation loss decreased (inf --> -0.260099).  Saving model ...
Epoch: 2 cost time: 1.5979969501495361
Epoch: 2, Steps: 17 | Train Loss: 1.464 Vali Loss: 1.264 Vali Acc: 0.468 Test Loss: 1.264 Test Acc: 0.468
Validation loss decreased (-0.260099 --> -0.468195).  Saving model ...
Epoch: 3 cost time: 1.6731996536254883
Epoch: 3, Steps: 17 | Train Loss: 1.130 Vali Loss: 1.086 Vali Acc: 0.659 Test Loss: 1.086 Test Acc: 0.659
Validation loss decreased (-0.468195 --> -0.658949).  Saving model ...
Epoch: 4 cost time: 1.7119030952453613
Epoch: 4, Steps: 17 | Train Loss: 0.891 Vali Loss: 0.965 Vali Acc: 0.555 Test Loss: 0.965 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.5537340641021729
Epoch: 5, Steps: 17 | Train Loss: 0.795 Vali Loss: 0.943 Vali Acc: 0.584 Test Loss: 0.943 Test Acc: 0.584
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.928215742111206
Epoch: 6, Steps: 17 | Train Loss: 0.715 Vali Loss: 0.868 Vali Acc: 0.671 Test Loss: 0.868 Test Acc: 0.671
Validation loss decreased (-0.658949 --> -0.670512).  Saving model ...
Epoch: 7 cost time: 1.8622078895568848
Epoch: 7, Steps: 17 | Train Loss: 0.562 Vali Loss: 0.719 Vali Acc: 0.792 Test Loss: 0.719 Test Acc: 0.792
Validation loss decreased (-0.670512 --> -0.791900).  Saving model ...
Epoch: 8 cost time: 1.701533317565918
Epoch: 8, Steps: 17 | Train Loss: 0.375 Vali Loss: 0.981 Vali Acc: 0.688 Test Loss: 0.981 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.8823249340057373
Epoch: 9, Steps: 17 | Train Loss: 0.511 Vali Loss: 0.648 Vali Acc: 0.786 Test Loss: 0.648 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.828371524810791
Epoch: 10, Steps: 17 | Train Loss: 0.288 Vali Loss: 0.646 Vali Acc: 0.769 Test Loss: 0.646 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 11 cost time: 1.601050615310669
Epoch: 11, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.722 Vali Acc: 0.786 Test Loss: 0.722 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 12 cost time: 1.630321979522705
Epoch: 12, Steps: 17 | Train Loss: 0.262 Vali Loss: 1.083 Vali Acc: 0.751 Test Loss: 1.083 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 13 cost time: 1.5808417797088623
Epoch: 13, Steps: 17 | Train Loss: 0.210 Vali Loss: 0.653 Vali Acc: 0.821 Test Loss: 0.653 Test Acc: 0.821
Validation loss decreased (-0.791900 --> -0.820803).  Saving model ...
Epoch: 14 cost time: 1.768141746520996
Epoch: 14, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.743 Vali Acc: 0.827 Test Loss: 0.743 Test Acc: 0.827
Validation loss decreased (-0.820803 --> -0.826582).  Saving model ...
Epoch: 15 cost time: 1.7864210605621338
Epoch: 15, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.626 Vali Acc: 0.803 Test Loss: 0.626 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.762303113937378
Epoch: 16, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.902 Vali Acc: 0.821 Test Loss: 0.902 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.873647689819336
Epoch: 17, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.021 Vali Acc: 0.798 Test Loss: 1.021 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.915759801864624
Epoch: 18, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.771 Vali Acc: 0.809 Test Loss: 0.771 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8766546249389648
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.098 Vali Acc: 0.821 Test Loss: 1.098 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 2.0696778297424316
Epoch: 20, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.823 Vali Acc: 0.832 Test Loss: 0.823 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832362).  Saving model ...
Epoch: 21 cost time: 1.8832988739013672
Epoch: 21, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.933 Vali Acc: 0.803 Test Loss: 0.933 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9421775341033936
Epoch: 22, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.901 Vali Acc: 0.832 Test Loss: 0.901 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.9214589595794678
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.994 Vali Acc: 0.821 Test Loss: 0.994 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 2.019630193710327
Epoch: 24, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.317 Vali Acc: 0.838 Test Loss: 1.317 Test Acc: 0.838
Validation loss decreased (-0.832362 --> -0.838137).  Saving model ...
Epoch: 25 cost time: 1.9214062690734863
Epoch: 25, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.497 Vali Acc: 0.798 Test Loss: 1.497 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.8461623191833496
Epoch: 26, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.138 Vali Acc: 0.832 Test Loss: 1.138 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.8698160648345947
Epoch: 27, Steps: 17 | Train Loss: 0.044 Vali Loss: 1.308 Vali Acc: 0.775 Test Loss: 1.308 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.752776861190796
Epoch: 28, Steps: 17 | Train Loss: 0.061 Vali Loss: 1.141 Vali Acc: 0.798 Test Loss: 1.141 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 2.128527879714966
Epoch: 29, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.462 Vali Acc: 0.792 Test Loss: 1.462 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.9362659454345703
Epoch: 30, Steps: 17 | Train Loss: 0.027 Vali Loss: 1.183 Vali Acc: 0.827 Test Loss: 1.183 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.8740262985229492
Epoch: 31, Steps: 17 | Train Loss: 0.016 Vali Loss: 1.529 Vali Acc: 0.798 Test Loss: 1.529 Test Acc: 0.798
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.9001777172088623
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.172 Vali Acc: 0.844 Test Loss: 1.172 Test Acc: 0.844
Validation loss decreased (-0.838137 --> -0.843919).  Saving model ...
Epoch: 33 cost time: 1.8629188537597656
Epoch: 33, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.201 Vali Acc: 0.827 Test Loss: 1.201 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 34 cost time: 1.9336376190185547
Epoch: 34, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.551 Vali Acc: 0.780 Test Loss: 1.551 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 35 cost time: 1.7073068618774414
Epoch: 35, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.981 Vali Acc: 0.757 Test Loss: 1.981 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 36 cost time: 1.8848838806152344
Epoch: 36, Steps: 17 | Train Loss: 0.019 Vali Loss: 1.682 Vali Acc: 0.803 Test Loss: 1.682 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 37 cost time: 1.8418848514556885
Epoch: 37, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.564 Vali Acc: 0.775 Test Loss: 1.564 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 38 cost time: 1.8695523738861084
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.728 Vali Acc: 0.786 Test Loss: 1.728 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 39 cost time: 1.8907699584960938
Epoch: 39, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.863 Vali Acc: 0.809 Test Loss: 1.863 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 40 cost time: 1.7328484058380127
Epoch: 40, Steps: 17 | Train Loss: 0.038 Vali Loss: 2.025 Vali Acc: 0.821 Test Loss: 2.025 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 41 cost time: 1.7843003273010254
Epoch: 41, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.721 Vali Acc: 0.827 Test Loss: 1.721 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 42 cost time: 1.702979564666748
Epoch: 42, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.812 Vali Acc: 0.815 Test Loss: 1.812 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 418275
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9315598011016846
Epoch: 1, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.763 Vali Acc: 0.225 Test Loss: 1.763 Test Acc: 0.225
Validation loss decreased (inf --> -0.225416).  Saving model ...
Epoch: 2 cost time: 1.6517105102539062
Epoch: 2, Steps: 17 | Train Loss: 1.573 Vali Loss: 1.390 Vali Acc: 0.410 Test Loss: 1.390 Test Acc: 0.410
Validation loss decreased (-0.225416 --> -0.410391).  Saving model ...
Epoch: 3 cost time: 1.4492383003234863
Epoch: 3, Steps: 17 | Train Loss: 1.266 Vali Loss: 1.197 Vali Acc: 0.572 Test Loss: 1.197 Test Acc: 0.572
Validation loss decreased (-0.410391 --> -0.572242).  Saving model ...
Epoch: 4 cost time: 1.462156057357788
Epoch: 4, Steps: 17 | Train Loss: 1.062 Vali Loss: 1.111 Vali Acc: 0.468 Test Loss: 1.111 Test Acc: 0.468
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4593956470489502
Epoch: 5, Steps: 17 | Train Loss: 0.957 Vali Loss: 1.096 Vali Acc: 0.503 Test Loss: 1.096 Test Acc: 0.503
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.6757457256317139
Epoch: 6, Steps: 17 | Train Loss: 0.874 Vali Loss: 0.956 Vali Acc: 0.653 Test Loss: 0.956 Test Acc: 0.653
Validation loss decreased (-0.572242 --> -0.653170).  Saving model ...
Epoch: 7 cost time: 1.6435258388519287
Epoch: 7, Steps: 17 | Train Loss: 0.726 Vali Loss: 0.861 Vali Acc: 0.607 Test Loss: 0.861 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.594085693359375
Epoch: 8, Steps: 17 | Train Loss: 0.591 Vali Loss: 1.080 Vali Acc: 0.642 Test Loss: 1.080 Test Acc: 0.642
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.76747727394104
Epoch: 9, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.833 Vali Acc: 0.688 Test Loss: 0.833 Test Acc: 0.688
Validation loss decreased (-0.653170 --> -0.687853).  Saving model ...
Epoch: 10 cost time: 1.558030605316162
Epoch: 10, Steps: 17 | Train Loss: 0.439 Vali Loss: 0.748 Vali Acc: 0.717 Test Loss: 0.748 Test Acc: 0.717
Validation loss decreased (-0.687853 --> -0.716756).  Saving model ...
Epoch: 11 cost time: 1.5965321063995361
Epoch: 11, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.779 Vali Acc: 0.757 Test Loss: 0.779 Test Acc: 0.757
Validation loss decreased (-0.716756 --> -0.757218).  Saving model ...
Epoch: 12 cost time: 1.5669059753417969
Epoch: 12, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.687 Vali Acc: 0.763 Test Loss: 0.687 Test Acc: 0.763
Validation loss decreased (-0.757218 --> -0.762999).  Saving model ...
Epoch: 13 cost time: 1.6090502738952637
Epoch: 13, Steps: 17 | Train Loss: 0.328 Vali Loss: 0.687 Vali Acc: 0.780 Test Loss: 0.687 Test Acc: 0.780
Validation loss decreased (-0.762999 --> -0.780340).  Saving model ...
Epoch: 14 cost time: 1.6225864887237549
Epoch: 14, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.940 Vali Acc: 0.746 Test Loss: 0.940 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.717921257019043
Epoch: 15, Steps: 17 | Train Loss: 0.195 Vali Loss: 1.106 Vali Acc: 0.682 Test Loss: 1.106 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.588730812072754
Epoch: 16, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.765 Vali Acc: 0.827 Test Loss: 0.765 Test Acc: 0.827
Validation loss decreased (-0.780340 --> -0.826582).  Saving model ...
Epoch: 17 cost time: 1.6999232769012451
Epoch: 17, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.960 Vali Acc: 0.775 Test Loss: 0.960 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 2.128216505050659
Epoch: 18, Steps: 17 | Train Loss: 0.145 Vali Loss: 0.815 Vali Acc: 0.792 Test Loss: 0.815 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.806459665298462
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.886 Vali Acc: 0.786 Test Loss: 0.886 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.872819185256958
Epoch: 20, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.883 Vali Acc: 0.763 Test Loss: 0.883 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6582245826721191
Epoch: 21, Steps: 17 | Train Loss: 0.113 Vali Loss: 0.920 Vali Acc: 0.792 Test Loss: 0.920 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.6545770168304443
Epoch: 22, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.785 Vali Acc: 0.832 Test Loss: 0.785 Test Acc: 0.832
Validation loss decreased (-0.826582 --> -0.832362).  Saving model ...
Epoch: 23 cost time: 1.7318766117095947
Epoch: 23, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.804 Vali Acc: 0.838 Test Loss: 0.804 Test Acc: 0.838
Validation loss decreased (-0.832362 --> -0.838142).  Saving model ...
Epoch: 24 cost time: 2.0165772438049316
Epoch: 24, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.015 Vali Acc: 0.815 Test Loss: 1.015 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.892496109008789
Epoch: 25, Steps: 17 | Train Loss: 0.051 Vali Loss: 1.140 Vali Acc: 0.792 Test Loss: 1.140 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6333351135253906
Epoch: 26, Steps: 17 | Train Loss: 0.060 Vali Loss: 1.014 Vali Acc: 0.803 Test Loss: 1.014 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.9035027027130127
Epoch: 27, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.072 Vali Acc: 0.798 Test Loss: 1.072 Test Acc: 0.798
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.8754699230194092
Epoch: 28, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.950 Vali Acc: 0.815 Test Loss: 0.950 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.860353708267212
Epoch: 29, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.878 Vali Acc: 0.803 Test Loss: 0.878 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7700412273406982
Epoch: 30, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.233 Vali Acc: 0.832 Test Loss: 1.233 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.6415882110595703
Epoch: 31, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.115 Vali Acc: 0.792 Test Loss: 1.115 Test Acc: 0.792
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.673461675643921
Epoch: 32, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.111 Vali Acc: 0.815 Test Loss: 1.111 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.5854213237762451
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.027 Vali Acc: 0.827 Test Loss: 1.027 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 418275
model size : 2.83MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.1909565925598145
Epoch: 1, Steps: 17 | Train Loss: 1.868 Vali Loss: 1.672 Vali Acc: 0.266 Test Loss: 1.672 Test Acc: 0.266
Validation loss decreased (inf --> -0.265879).  Saving model ...
Epoch: 2 cost time: 2.097670316696167
Epoch: 2, Steps: 17 | Train Loss: 1.428 Vali Loss: 1.253 Vali Acc: 0.538 Test Loss: 1.253 Test Acc: 0.538
Validation loss decreased (-0.265879 --> -0.537560).  Saving model ...
Epoch: 3 cost time: 1.804635763168335
Epoch: 3, Steps: 17 | Train Loss: 1.076 Vali Loss: 1.034 Vali Acc: 0.647 Test Loss: 1.034 Test Acc: 0.647
Validation loss decreased (-0.537560 --> -0.647389).  Saving model ...
Epoch: 4 cost time: 1.8946306705474854
Epoch: 4, Steps: 17 | Train Loss: 0.859 Vali Loss: 0.952 Vali Acc: 0.705 Test Loss: 0.952 Test Acc: 0.705
Validation loss decreased (-0.647389 --> -0.705193).  Saving model ...
Epoch: 5 cost time: 1.9832427501678467
Epoch: 5, Steps: 17 | Train Loss: 0.732 Vali Loss: 0.761 Vali Acc: 0.717 Test Loss: 0.761 Test Acc: 0.717
Validation loss decreased (-0.705193 --> -0.716755).  Saving model ...
Epoch: 6 cost time: 2.03658390045166
Epoch: 6, Steps: 17 | Train Loss: 0.556 Vali Loss: 0.724 Vali Acc: 0.711 Test Loss: 0.724 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.9514586925506592
Epoch: 7, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.787 Vali Acc: 0.728 Test Loss: 0.787 Test Acc: 0.728
Validation loss decreased (-0.716755 --> -0.728316).  Saving model ...
Epoch: 8 cost time: 1.957185983657837
Epoch: 8, Steps: 17 | Train Loss: 0.444 Vali Loss: 0.673 Vali Acc: 0.734 Test Loss: 0.673 Test Acc: 0.734
Validation loss decreased (-0.728316 --> -0.734097).  Saving model ...
Epoch: 9 cost time: 1.9142820835113525
Epoch: 9, Steps: 17 | Train Loss: 0.272 Vali Loss: 0.529 Vali Acc: 0.827 Test Loss: 0.529 Test Acc: 0.827
Validation loss decreased (-0.734097 --> -0.826584).  Saving model ...
Epoch: 10 cost time: 1.7031242847442627
Epoch: 10, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.603 Vali Acc: 0.775 Test Loss: 0.603 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6620380878448486
Epoch: 11, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.725 Vali Acc: 0.763 Test Loss: 0.725 Test Acc: 0.763
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.699192762374878
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.585 Vali Acc: 0.815 Test Loss: 0.585 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 1.5767335891723633
Epoch: 13, Steps: 17 | Train Loss: 0.091 Vali Loss: 0.621 Vali Acc: 0.809 Test Loss: 0.621 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 14 cost time: 1.861354112625122
Epoch: 14, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.723 Vali Acc: 0.838 Test Loss: 0.723 Test Acc: 0.838
Validation loss decreased (-0.826584 --> -0.838143).  Saving model ...
Epoch: 15 cost time: 2.0182340145111084
Epoch: 15, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.654 Vali Acc: 0.798 Test Loss: 0.654 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7754404544830322
Epoch: 16, Steps: 17 | Train Loss: 0.067 Vali Loss: 1.153 Vali Acc: 0.769 Test Loss: 1.153 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 2.0395100116729736
Epoch: 17, Steps: 17 | Train Loss: 0.070 Vali Loss: 1.099 Vali Acc: 0.751 Test Loss: 1.099 Test Acc: 0.751
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.903766393661499
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.129 Vali Acc: 0.757 Test Loss: 1.129 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.834061622619629
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.857 Vali Acc: 0.815 Test Loss: 0.857 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.761826753616333
Epoch: 20, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.734 Vali Acc: 0.815 Test Loss: 0.734 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 2.198859214782715
Epoch: 21, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.924 Vali Acc: 0.786 Test Loss: 0.924 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.7457232475280762
Epoch: 22, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.764 Vali Acc: 0.815 Test Loss: 0.764 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 23 cost time: 1.6094021797180176
Epoch: 23, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.762 Vali Acc: 0.844 Test Loss: 0.762 Test Acc: 0.844
Validation loss decreased (-0.838143 --> -0.843923).  Saving model ...
Epoch: 24 cost time: 1.842965841293335
Epoch: 24, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.876 Vali Acc: 0.803 Test Loss: 0.876 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.8585052490234375
Epoch: 25, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.832 Vali Acc: 0.809 Test Loss: 0.832 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9655160903930664
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.914 Vali Acc: 0.809 Test Loss: 0.914 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.815659523010254
Epoch: 27, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.785 Vali Acc: 0.827 Test Loss: 0.785 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.9515044689178467
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.883 Vali Acc: 0.821 Test Loss: 0.883 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 2.0029642581939697
Epoch: 29, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.997 Vali Acc: 0.815 Test Loss: 0.997 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.9798758029937744
Epoch: 30, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.327 Vali Acc: 0.792 Test Loss: 1.327 Test Acc: 0.792
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 2.1496973037719727
Epoch: 31, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.099 Vali Acc: 0.780 Test Loss: 1.099 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 2.312999725341797
Epoch: 32, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.921 Vali Acc: 0.827 Test Loss: 0.921 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.827948808670044
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.917 Vali Acc: 0.838 Test Loss: 0.917 Test Acc: 0.838
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 401891
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.573396444320679
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.684 Vali Acc: 0.260 Test Loss: 1.684 Test Acc: 0.260
Validation loss decreased (inf --> -0.260099).  Saving model ...
Epoch: 2 cost time: 1.7799208164215088
Epoch: 2, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.264 Vali Acc: 0.532 Test Loss: 1.264 Test Acc: 0.532
Validation loss decreased (-0.260099 --> -0.531779).  Saving model ...
Epoch: 3 cost time: 2.3070080280303955
Epoch: 3, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.066 Vali Acc: 0.642 Test Loss: 1.066 Test Acc: 0.642
Validation loss decreased (-0.531779 --> -0.641608).  Saving model ...
Epoch: 4 cost time: 2.0194883346557617
Epoch: 4, Steps: 17 | Train Loss: 0.923 Vali Loss: 1.065 Vali Acc: 0.653 Test Loss: 1.065 Test Acc: 0.653
Validation loss decreased (-0.641608 --> -0.653169).  Saving model ...
Epoch: 5 cost time: 2.0371742248535156
Epoch: 5, Steps: 17 | Train Loss: 0.750 Vali Loss: 0.753 Vali Acc: 0.751 Test Loss: 0.753 Test Acc: 0.751
Validation loss decreased (-0.653169 --> -0.751438).  Saving model ...
Epoch: 6 cost time: 1.76072359085083
Epoch: 6, Steps: 17 | Train Loss: 0.594 Vali Loss: 0.707 Vali Acc: 0.763 Test Loss: 0.707 Test Acc: 0.763
Validation loss decreased (-0.751438 --> -0.762999).  Saving model ...
Epoch: 7 cost time: 1.6799790859222412
Epoch: 7, Steps: 17 | Train Loss: 0.470 Vali Loss: 0.680 Vali Acc: 0.757 Test Loss: 0.680 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.980780839920044
Epoch: 8, Steps: 17 | Train Loss: 0.461 Vali Loss: 0.758 Vali Acc: 0.728 Test Loss: 0.758 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.1535778045654297
Epoch: 9, Steps: 17 | Train Loss: 0.330 Vali Loss: 0.568 Vali Acc: 0.809 Test Loss: 0.568 Test Acc: 0.809
Validation loss decreased (-0.762999 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 2.0592823028564453
Epoch: 10, Steps: 17 | Train Loss: 0.214 Vali Loss: 0.718 Vali Acc: 0.751 Test Loss: 0.718 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.9552626609802246
Epoch: 11, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.796 Vali Acc: 0.705 Test Loss: 0.796 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.8873660564422607
Epoch: 12, Steps: 17 | Train Loss: 0.125 Vali Loss: 0.679 Vali Acc: 0.780 Test Loss: 0.679 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 13 cost time: 2.0012457370758057
Epoch: 13, Steps: 17 | Train Loss: 0.120 Vali Loss: 0.725 Vali Acc: 0.832 Test Loss: 0.725 Test Acc: 0.832
Validation loss decreased (-0.809243 --> -0.832363).  Saving model ...
Epoch: 14 cost time: 1.911736249923706
Epoch: 14, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.871 Vali Acc: 0.769 Test Loss: 0.871 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8328418731689453
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.752 Vali Acc: 0.775 Test Loss: 0.752 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.9263916015625
Epoch: 16, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.765 Vali Acc: 0.798 Test Loss: 0.765 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.9024875164031982
Epoch: 17, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.947 Vali Acc: 0.815 Test Loss: 0.947 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.8698952198028564
Epoch: 18, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.161 Vali Acc: 0.751 Test Loss: 1.161 Test Acc: 0.751
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.8729174137115479
Epoch: 19, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.972 Vali Acc: 0.751 Test Loss: 0.972 Test Acc: 0.751
EarlyStopping counter: 6 out of 10
Epoch: 20 cost time: 1.7449755668640137
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.982 Vali Acc: 0.803 Test Loss: 0.982 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 21 cost time: 1.8879046440124512
Epoch: 21, Steps: 17 | Train Loss: 0.047 Vali Loss: 0.973 Vali Acc: 0.798 Test Loss: 0.973 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 22 cost time: 1.5146923065185547
Epoch: 22, Steps: 17 | Train Loss: 0.093 Vali Loss: 1.012 Vali Acc: 0.798 Test Loss: 1.012 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 23 cost time: 1.691925287246704
Epoch: 23, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.982 Vali Acc: 0.780 Test Loss: 0.982 Test Acc: 0.780
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 401891
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8243279457092285
Epoch: 1, Steps: 17 | Train Loss: 1.911 Vali Loss: 1.746 Vali Acc: 0.277 Test Loss: 1.746 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 1.8015456199645996
Epoch: 2, Steps: 17 | Train Loss: 1.508 Vali Loss: 1.309 Vali Acc: 0.480 Test Loss: 1.309 Test Acc: 0.480
Validation loss decreased (-0.277439 --> -0.479756).  Saving model ...
Epoch: 3 cost time: 1.7346174716949463
Epoch: 3, Steps: 17 | Train Loss: 1.131 Vali Loss: 1.105 Vali Acc: 0.555 Test Loss: 1.105 Test Acc: 0.555
Validation loss decreased (-0.479756 --> -0.554902).  Saving model ...
Epoch: 4 cost time: 1.8531620502471924
Epoch: 4, Steps: 17 | Train Loss: 0.982 Vali Loss: 1.153 Vali Acc: 0.590 Test Loss: 1.153 Test Acc: 0.590
Validation loss decreased (-0.554902 --> -0.589584).  Saving model ...
Epoch: 5 cost time: 1.7652273178100586
Epoch: 5, Steps: 17 | Train Loss: 0.811 Vali Loss: 0.793 Vali Acc: 0.728 Test Loss: 0.793 Test Acc: 0.728
Validation loss decreased (-0.589584 --> -0.728316).  Saving model ...
Epoch: 6 cost time: 1.815922498703003
Epoch: 6, Steps: 17 | Train Loss: 0.623 Vali Loss: 0.804 Vali Acc: 0.705 Test Loss: 0.804 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7098567485809326
Epoch: 7, Steps: 17 | Train Loss: 0.554 Vali Loss: 0.895 Vali Acc: 0.711 Test Loss: 0.895 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.7176573276519775
Epoch: 8, Steps: 17 | Train Loss: 0.488 Vali Loss: 0.657 Vali Acc: 0.792 Test Loss: 0.657 Test Acc: 0.792
Validation loss decreased (-0.728316 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 1.8914241790771484
Epoch: 9, Steps: 17 | Train Loss: 0.335 Vali Loss: 0.601 Vali Acc: 0.786 Test Loss: 0.601 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7055346965789795
Epoch: 10, Steps: 17 | Train Loss: 0.263 Vali Loss: 0.745 Vali Acc: 0.728 Test Loss: 0.745 Test Acc: 0.728
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.7264385223388672
Epoch: 11, Steps: 17 | Train Loss: 0.215 Vali Loss: 0.659 Vali Acc: 0.792 Test Loss: 0.659 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.6949996948242188
Epoch: 12, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.609 Vali Acc: 0.792 Test Loss: 0.609 Test Acc: 0.792
Validation loss decreased (-0.791901 --> -0.791901).  Saving model ...
Epoch: 13 cost time: 1.6430158615112305
Epoch: 13, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.852 Vali Acc: 0.769 Test Loss: 0.852 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.7290923595428467
Epoch: 14, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.761 Vali Acc: 0.803 Test Loss: 0.761 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803461).  Saving model ...
Epoch: 15 cost time: 1.6935889720916748
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.877 Vali Acc: 0.792 Test Loss: 0.877 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7807729244232178
Epoch: 16, Steps: 17 | Train Loss: 0.075 Vali Loss: 0.867 Vali Acc: 0.792 Test Loss: 0.867 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6299848556518555
Epoch: 17, Steps: 17 | Train Loss: 0.037 Vali Loss: 1.014 Vali Acc: 0.798 Test Loss: 1.014 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.5521256923675537
Epoch: 18, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.031 Vali Acc: 0.809 Test Loss: 1.031 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809238).  Saving model ...
Epoch: 19 cost time: 1.7868859767913818
Epoch: 19, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.883 Vali Acc: 0.798 Test Loss: 0.883 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.9370899200439453
Epoch: 20, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.965 Vali Acc: 0.832 Test Loss: 0.965 Test Acc: 0.832
Validation loss decreased (-0.809238 --> -0.832360).  Saving model ...
Epoch: 21 cost time: 1.7450110912322998
Epoch: 21, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.103 Vali Acc: 0.775 Test Loss: 1.103 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.8796491622924805
Epoch: 22, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.614 Vali Acc: 0.780 Test Loss: 1.614 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.792349100112915
Epoch: 23, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.238 Vali Acc: 0.763 Test Loss: 1.238 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.8904316425323486
Epoch: 24, Steps: 17 | Train Loss: 0.134 Vali Loss: 1.303 Vali Acc: 0.803 Test Loss: 1.303 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.7566251754760742
Epoch: 25, Steps: 17 | Train Loss: 0.058 Vali Loss: 1.354 Vali Acc: 0.763 Test Loss: 1.354 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.847795009613037
Epoch: 26, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.962 Vali Acc: 0.798 Test Loss: 0.962 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.682013988494873
Epoch: 27, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.448 Vali Acc: 0.775 Test Loss: 1.448 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.8284997940063477
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.216 Vali Acc: 0.832 Test Loss: 1.216 Test Acc: 0.832
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.5359084606170654
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 1.106 Vali Acc: 0.803 Test Loss: 1.106 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.8117396831512451
Epoch: 30, Steps: 17 | Train Loss: 0.007 Vali Loss: 1.687 Vali Acc: 0.775 Test Loss: 1.687 Test Acc: 0.775
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 401891
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.003108739852905
Epoch: 1, Steps: 17 | Train Loss: 1.962 Vali Loss: 1.819 Vali Acc: 0.220 Test Loss: 1.819 Test Acc: 0.220
Validation loss decreased (inf --> -0.219635).  Saving model ...
Epoch: 2 cost time: 1.7801141738891602
Epoch: 2, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.435 Vali Acc: 0.393 Test Loss: 1.435 Test Acc: 0.393
Validation loss decreased (-0.219635 --> -0.393049).  Saving model ...
Epoch: 3 cost time: 1.7115199565887451
Epoch: 3, Steps: 17 | Train Loss: 1.280 Vali Loss: 1.261 Vali Acc: 0.457 Test Loss: 1.261 Test Acc: 0.457
Validation loss decreased (-0.393049 --> -0.456635).  Saving model ...
Epoch: 4 cost time: 1.6202733516693115
Epoch: 4, Steps: 17 | Train Loss: 1.150 Vali Loss: 1.351 Vali Acc: 0.514 Test Loss: 1.351 Test Acc: 0.514
Validation loss decreased (-0.456635 --> -0.514437).  Saving model ...
Epoch: 5 cost time: 1.631295919418335
Epoch: 5, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.013 Vali Acc: 0.653 Test Loss: 1.013 Test Acc: 0.653
Validation loss decreased (-0.514437 --> -0.653169).  Saving model ...
Epoch: 6 cost time: 1.7317843437194824
Epoch: 6, Steps: 17 | Train Loss: 0.801 Vali Loss: 1.004 Vali Acc: 0.555 Test Loss: 1.004 Test Acc: 0.555
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.6345775127410889
Epoch: 7, Steps: 17 | Train Loss: 0.734 Vali Loss: 0.936 Vali Acc: 0.682 Test Loss: 0.936 Test Acc: 0.682
Validation loss decreased (-0.653169 --> -0.682072).  Saving model ...
Epoch: 8 cost time: 1.5441246032714844
Epoch: 8, Steps: 17 | Train Loss: 0.612 Vali Loss: 0.777 Vali Acc: 0.705 Test Loss: 0.777 Test Acc: 0.705
Validation loss decreased (-0.682072 --> -0.705195).  Saving model ...
Epoch: 9 cost time: 1.8371572494506836
Epoch: 9, Steps: 17 | Train Loss: 0.498 Vali Loss: 0.791 Vali Acc: 0.746 Test Loss: 0.791 Test Acc: 0.746
Validation loss decreased (-0.705195 --> -0.745657).  Saving model ...
Epoch: 10 cost time: 1.4175994396209717
Epoch: 10, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.950 Vali Acc: 0.676 Test Loss: 0.950 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.710805892944336
Epoch: 11, Steps: 17 | Train Loss: 0.379 Vali Loss: 0.875 Vali Acc: 0.636 Test Loss: 0.875 Test Acc: 0.636
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7018795013427734
Epoch: 12, Steps: 17 | Train Loss: 0.250 Vali Loss: 0.700 Vali Acc: 0.780 Test Loss: 0.700 Test Acc: 0.780
Validation loss decreased (-0.745657 --> -0.780340).  Saving model ...
Epoch: 13 cost time: 1.588792324066162
Epoch: 13, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.879 Vali Acc: 0.717 Test Loss: 0.879 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9999678134918213
Epoch: 14, Steps: 17 | Train Loss: 0.203 Vali Loss: 0.949 Vali Acc: 0.723 Test Loss: 0.949 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.640702724456787
Epoch: 15, Steps: 17 | Train Loss: 0.249 Vali Loss: 0.773 Vali Acc: 0.780 Test Loss: 0.773 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.6924805641174316
Epoch: 16, Steps: 17 | Train Loss: 0.156 Vali Loss: 0.936 Vali Acc: 0.751 Test Loss: 0.936 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.8520948886871338
Epoch: 17, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.856 Vali Acc: 0.780 Test Loss: 0.856 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.9670422077178955
Epoch: 18, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.966 Vali Acc: 0.792 Test Loss: 0.966 Test Acc: 0.792
Validation loss decreased (-0.780340 --> -0.791898).  Saving model ...
Epoch: 19 cost time: 1.7534778118133545
Epoch: 19, Steps: 17 | Train Loss: 0.130 Vali Loss: 1.515 Vali Acc: 0.728 Test Loss: 1.515 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8004441261291504
Epoch: 20, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.866 Vali Acc: 0.769 Test Loss: 0.866 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.819892168045044
Epoch: 21, Steps: 17 | Train Loss: 0.114 Vali Loss: 1.021 Vali Acc: 0.798 Test Loss: 1.021 Test Acc: 0.798
Validation loss decreased (-0.791898 --> -0.797678).  Saving model ...
Epoch: 22 cost time: 1.6775658130645752
Epoch: 22, Steps: 17 | Train Loss: 0.131 Vali Loss: 1.345 Vali Acc: 0.705 Test Loss: 1.345 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.6791412830352783
Epoch: 23, Steps: 17 | Train Loss: 0.030 Vali Loss: 1.224 Vali Acc: 0.740 Test Loss: 1.224 Test Acc: 0.740
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.860982894897461
Epoch: 24, Steps: 17 | Train Loss: 0.065 Vali Loss: 1.447 Vali Acc: 0.763 Test Loss: 1.447 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.6904327869415283
Epoch: 25, Steps: 17 | Train Loss: 0.175 Vali Loss: 1.079 Vali Acc: 0.775 Test Loss: 1.079 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.8820321559906006
Epoch: 26, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.262 Vali Acc: 0.792 Test Loss: 1.262 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.8600749969482422
Epoch: 27, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.101 Vali Acc: 0.792 Test Loss: 1.101 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.9090685844421387
Epoch: 28, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.170 Vali Acc: 0.786 Test Loss: 1.170 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6384451389312744
Epoch: 29, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.096 Vali Acc: 0.838 Test Loss: 1.096 Test Acc: 0.838
Validation loss decreased (-0.797678 --> -0.838139).  Saving model ...
Epoch: 30 cost time: 1.796670913696289
Epoch: 30, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.279 Vali Acc: 0.809 Test Loss: 1.279 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.758803129196167
Epoch: 31, Steps: 17 | Train Loss: 0.023 Vali Loss: 1.170 Vali Acc: 0.809 Test Loss: 1.170 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7727689743041992
Epoch: 32, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.457 Vali Acc: 0.786 Test Loss: 1.457 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.6184582710266113
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.322 Vali Acc: 0.757 Test Loss: 1.322 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.6580383777618408
Epoch: 34, Steps: 17 | Train Loss: 0.050 Vali Loss: 1.075 Vali Acc: 0.786 Test Loss: 1.075 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.7496063709259033
Epoch: 35, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.345 Vali Acc: 0.792 Test Loss: 1.345 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5514740943908691
Epoch: 36, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.396 Vali Acc: 0.757 Test Loss: 1.396 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.6859025955200195
Epoch: 37, Steps: 17 | Train Loss: 0.028 Vali Loss: 1.388 Vali Acc: 0.815 Test Loss: 1.388 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.7833774089813232
Epoch: 38, Steps: 17 | Train Loss: 0.014 Vali Loss: 1.439 Vali Acc: 0.803 Test Loss: 1.439 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.9813406467437744
Epoch: 39, Steps: 17 | Train Loss: 0.212 Vali Loss: 2.063 Vali Acc: 0.763 Test Loss: 2.063 Test Acc: 0.763
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 401891
model size : 2.76MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.137715101242065
Epoch: 1, Steps: 17 | Train Loss: 1.945 Vali Loss: 1.690 Vali Acc: 0.277 Test Loss: 1.690 Test Acc: 0.277
Validation loss decreased (inf --> -0.277440).  Saving model ...
Epoch: 2 cost time: 2.153604030609131
Epoch: 2, Steps: 17 | Train Loss: 1.491 Vali Loss: 1.344 Vali Acc: 0.358 Test Loss: 1.344 Test Acc: 0.358
Validation loss decreased (-0.277440 --> -0.358368).  Saving model ...
Epoch: 3 cost time: 2.090867757797241
Epoch: 3, Steps: 17 | Train Loss: 1.125 Vali Loss: 1.118 Vali Acc: 0.462 Test Loss: 1.118 Test Acc: 0.462
Validation loss decreased (-0.358368 --> -0.462417).  Saving model ...
Epoch: 4 cost time: 2.1698975563049316
Epoch: 4, Steps: 17 | Train Loss: 0.880 Vali Loss: 1.255 Vali Acc: 0.561 Test Loss: 1.255 Test Acc: 0.561
Validation loss decreased (-0.462417 --> -0.560681).  Saving model ...
Epoch: 5 cost time: 2.120880603790283
Epoch: 5, Steps: 17 | Train Loss: 0.767 Vali Loss: 0.888 Vali Acc: 0.694 Test Loss: 0.888 Test Acc: 0.694
Validation loss decreased (-0.560681 --> -0.693633).  Saving model ...
Epoch: 6 cost time: 2.053309917449951
Epoch: 6, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.760 Vali Acc: 0.705 Test Loss: 0.760 Test Acc: 0.705
Validation loss decreased (-0.693633 --> -0.705195).  Saving model ...
Epoch: 7 cost time: 1.7838399410247803
Epoch: 7, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.799 Vali Acc: 0.688 Test Loss: 0.799 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 2.459611415863037
Epoch: 8, Steps: 17 | Train Loss: 0.388 Vali Loss: 0.752 Vali Acc: 0.769 Test Loss: 0.752 Test Acc: 0.769
Validation loss decreased (-0.705195 --> -0.768779).  Saving model ...
Epoch: 9 cost time: 2.073112726211548
Epoch: 9, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.599 Vali Acc: 0.809 Test Loss: 0.599 Test Acc: 0.809
Validation loss decreased (-0.768779 --> -0.809243).  Saving model ...
Epoch: 10 cost time: 2.157562732696533
Epoch: 10, Steps: 17 | Train Loss: 0.274 Vali Loss: 0.685 Vali Acc: 0.780 Test Loss: 0.685 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 2.1864969730377197
Epoch: 11, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.583 Vali Acc: 0.838 Test Loss: 0.583 Test Acc: 0.838
Validation loss decreased (-0.809243 --> -0.838144).  Saving model ...
Epoch: 12 cost time: 2.052926778793335
Epoch: 12, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.639 Vali Acc: 0.832 Test Loss: 0.639 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 2.192932367324829
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.720 Vali Acc: 0.809 Test Loss: 0.720 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 2.1781110763549805
Epoch: 14, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.708 Vali Acc: 0.809 Test Loss: 0.708 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 2.088207483291626
Epoch: 15, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.787 Vali Acc: 0.815 Test Loss: 0.787 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 2.074063539505005
Epoch: 16, Steps: 17 | Train Loss: 0.049 Vali Loss: 0.729 Vali Acc: 0.821 Test Loss: 0.729 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.7292063236236572
Epoch: 17, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.727 Vali Acc: 0.798 Test Loss: 0.727 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.8009803295135498
Epoch: 18, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.676 Vali Acc: 0.867 Test Loss: 0.676 Test Acc: 0.867
Validation loss decreased (-0.838144 --> -0.867045).  Saving model ...
Epoch: 19 cost time: 2.071909189224243
Epoch: 19, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.710 Vali Acc: 0.844 Test Loss: 0.710 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 2.170973539352417
Epoch: 20, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.900 Vali Acc: 0.827 Test Loss: 0.900 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 2.1706960201263428
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.663 Vali Acc: 0.827 Test Loss: 0.663 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 2.104367733001709
Epoch: 22, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.982 Vali Acc: 0.821 Test Loss: 0.982 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.924820899963379
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.721 Vali Acc: 0.855 Test Loss: 0.721 Test Acc: 0.855
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.8415703773498535
Epoch: 24, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.809 Vali Acc: 0.821 Test Loss: 0.809 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.9057509899139404
Epoch: 25, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.832 Test Loss: 0.820 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.963090181350708
Epoch: 26, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.780 Vali Acc: 0.827 Test Loss: 0.780 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 2.036914110183716
Epoch: 27, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.775 Vali Acc: 0.821 Test Loss: 0.775 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 2.251585006713867
Epoch: 28, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.771 Vali Acc: 0.821 Test Loss: 0.771 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 393699
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.466562509536743
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.696 Vali Acc: 0.272 Test Loss: 1.696 Test Acc: 0.272
Validation loss decreased (inf --> -0.271659).  Saving model ...
Epoch: 2 cost time: 1.5673935413360596
Epoch: 2, Steps: 17 | Train Loss: 1.497 Vali Loss: 1.337 Vali Acc: 0.335 Test Loss: 1.337 Test Acc: 0.335
Validation loss decreased (-0.271659 --> -0.335247).  Saving model ...
Epoch: 3 cost time: 1.7966606616973877
Epoch: 3, Steps: 17 | Train Loss: 1.140 Vali Loss: 1.129 Vali Acc: 0.410 Test Loss: 1.129 Test Acc: 0.410
Validation loss decreased (-0.335247 --> -0.410393).  Saving model ...
Epoch: 4 cost time: 1.8692712783813477
Epoch: 4, Steps: 17 | Train Loss: 0.915 Vali Loss: 1.275 Vali Acc: 0.549 Test Loss: 1.275 Test Acc: 0.549
Validation loss decreased (-0.410393 --> -0.549120).  Saving model ...
Epoch: 5 cost time: 1.7925496101379395
Epoch: 5, Steps: 17 | Train Loss: 0.798 Vali Loss: 0.905 Vali Acc: 0.653 Test Loss: 0.905 Test Acc: 0.653
Validation loss decreased (-0.549120 --> -0.653170).  Saving model ...
Epoch: 6 cost time: 1.9882409572601318
Epoch: 6, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.830 Vali Acc: 0.688 Test Loss: 0.830 Test Acc: 0.688
Validation loss decreased (-0.653170 --> -0.687853).  Saving model ...
Epoch: 7 cost time: 1.9949300289154053
Epoch: 7, Steps: 17 | Train Loss: 0.504 Vali Loss: 0.799 Vali Acc: 0.676 Test Loss: 0.799 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8112921714782715
Epoch: 8, Steps: 17 | Train Loss: 0.412 Vali Loss: 0.723 Vali Acc: 0.769 Test Loss: 0.723 Test Acc: 0.769
Validation loss decreased (-0.687853 --> -0.768779).  Saving model ...
Epoch: 9 cost time: 1.8968496322631836
Epoch: 9, Steps: 17 | Train Loss: 0.364 Vali Loss: 0.598 Vali Acc: 0.798 Test Loss: 0.598 Test Acc: 0.798
Validation loss decreased (-0.768779 --> -0.797682).  Saving model ...
Epoch: 10 cost time: 1.995659589767456
Epoch: 10, Steps: 17 | Train Loss: 0.300 Vali Loss: 0.683 Vali Acc: 0.786 Test Loss: 0.683 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.683671236038208
Epoch: 11, Steps: 17 | Train Loss: 0.207 Vali Loss: 0.663 Vali Acc: 0.809 Test Loss: 0.663 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809242).  Saving model ...
Epoch: 12 cost time: 1.6997215747833252
Epoch: 12, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.731 Vali Acc: 0.757 Test Loss: 0.731 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.9281578063964844
Epoch: 13, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.746 Vali Acc: 0.798 Test Loss: 0.746 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7495908737182617
Epoch: 14, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.708 Vali Acc: 0.803 Test Loss: 0.708 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7391889095306396
Epoch: 15, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.738 Vali Acc: 0.815 Test Loss: 0.738 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815022).  Saving model ...
Epoch: 16 cost time: 1.751359462738037
Epoch: 16, Steps: 17 | Train Loss: 0.078 Vali Loss: 0.770 Vali Acc: 0.803 Test Loss: 0.770 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.831068992614746
Epoch: 17, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.037 Vali Acc: 0.827 Test Loss: 1.037 Test Acc: 0.827
Validation loss decreased (-0.815022 --> -0.826579).  Saving model ...
Epoch: 18 cost time: 1.9921629428863525
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.743 Vali Acc: 0.821 Test Loss: 0.743 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.8306915760040283
Epoch: 19, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.816 Vali Acc: 0.809 Test Loss: 0.816 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.8026294708251953
Epoch: 20, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.769 Vali Acc: 0.827 Test Loss: 0.769 Test Acc: 0.827
Validation loss decreased (-0.826579 --> -0.826582).  Saving model ...
Epoch: 21 cost time: 2.049691915512085
Epoch: 21, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.741 Vali Acc: 0.827 Test Loss: 0.741 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826582).  Saving model ...
Epoch: 22 cost time: 2.0574731826782227
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 1.073 Vali Acc: 0.815 Test Loss: 1.073 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.9637374877929688
Epoch: 23, Steps: 17 | Train Loss: 0.066 Vali Loss: 1.076 Vali Acc: 0.855 Test Loss: 1.076 Test Acc: 0.855
Validation loss decreased (-0.826582 --> -0.855481).  Saving model ...
Epoch: 24 cost time: 2.1710002422332764
Epoch: 24, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.077 Vali Acc: 0.798 Test Loss: 1.077 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 2.129547595977783
Epoch: 25, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.749 Vali Acc: 0.815 Test Loss: 0.749 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.9934332370758057
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.183 Vali Acc: 0.786 Test Loss: 1.183 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 2.1330103874206543
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.193 Vali Acc: 0.827 Test Loss: 1.193 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.917248010635376
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.944 Vali Acc: 0.850 Test Loss: 0.944 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.8589270114898682
Epoch: 29, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.845 Vali Acc: 0.855 Test Loss: 0.845 Test Acc: 0.855
Validation loss decreased (-0.855481 --> -0.855483).  Saving model ...
Epoch: 30 cost time: 1.9878666400909424
Epoch: 30, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.842 Vali Acc: 0.850 Test Loss: 0.842 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 2.1269047260284424
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.851 Vali Acc: 0.855 Test Loss: 0.851 Test Acc: 0.855
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.7578706741333008
Epoch: 32, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.855 Vali Acc: 0.850 Test Loss: 0.855 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.8427045345306396
Epoch: 33, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.896 Vali Acc: 0.844 Test Loss: 0.896 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 2.1373119354248047
Epoch: 34, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.899 Vali Acc: 0.844 Test Loss: 0.899 Test Acc: 0.844
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.838343620300293
Epoch: 35, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.882 Vali Acc: 0.850 Test Loss: 0.882 Test Acc: 0.850
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.9197759628295898
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.871 Vali Acc: 0.855 Test Loss: 0.871 Test Acc: 0.855
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 2.3305420875549316
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.891 Vali Acc: 0.850 Test Loss: 0.891 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 2.0739102363586426
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.904 Vali Acc: 0.855 Test Loss: 0.904 Test Acc: 0.855
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 2.0419604778289795
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.919 Vali Acc: 0.850 Test Loss: 0.919 Test Acc: 0.850
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 393699
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.305247783660889
Epoch: 1, Steps: 17 | Train Loss: 1.940 Vali Loss: 1.714 Vali Acc: 0.295 Test Loss: 1.714 Test Acc: 0.295
Validation loss decreased (inf --> -0.294781).  Saving model ...
Epoch: 2 cost time: 1.8134644031524658
Epoch: 2, Steps: 17 | Train Loss: 1.528 Vali Loss: 1.391 Vali Acc: 0.324 Test Loss: 1.391 Test Acc: 0.324
Validation loss decreased (-0.294781 --> -0.323686).  Saving model ...
Epoch: 3 cost time: 1.6884386539459229
Epoch: 3, Steps: 17 | Train Loss: 1.187 Vali Loss: 1.160 Vali Acc: 0.428 Test Loss: 1.160 Test Acc: 0.428
Validation loss decreased (-0.323686 --> -0.427734).  Saving model ...
Epoch: 4 cost time: 1.679598093032837
Epoch: 4, Steps: 17 | Train Loss: 0.970 Vali Loss: 1.254 Vali Acc: 0.590 Test Loss: 1.254 Test Acc: 0.590
Validation loss decreased (-0.427734 --> -0.589583).  Saving model ...
Epoch: 5 cost time: 1.6431536674499512
Epoch: 5, Steps: 17 | Train Loss: 0.834 Vali Loss: 0.924 Vali Acc: 0.653 Test Loss: 0.924 Test Acc: 0.653
Validation loss decreased (-0.589583 --> -0.653170).  Saving model ...
Epoch: 6 cost time: 1.6668024063110352
Epoch: 6, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.822 Vali Acc: 0.682 Test Loss: 0.822 Test Acc: 0.682
Validation loss decreased (-0.653170 --> -0.682073).  Saving model ...
Epoch: 7 cost time: 1.735351800918579
Epoch: 7, Steps: 17 | Train Loss: 0.542 Vali Loss: 0.822 Vali Acc: 0.676 Test Loss: 0.822 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7371785640716553
Epoch: 8, Steps: 17 | Train Loss: 0.465 Vali Loss: 0.814 Vali Acc: 0.740 Test Loss: 0.814 Test Acc: 0.740
Validation loss decreased (-0.682073 --> -0.739876).  Saving model ...
Epoch: 9 cost time: 1.739018440246582
Epoch: 9, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.689 Vali Acc: 0.769 Test Loss: 0.689 Test Acc: 0.769
Validation loss decreased (-0.739876 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 1.66597580909729
Epoch: 10, Steps: 17 | Train Loss: 0.420 Vali Loss: 0.623 Vali Acc: 0.809 Test Loss: 0.623 Test Acc: 0.809
Validation loss decreased (-0.768779 --> -0.809242).  Saving model ...
Epoch: 11 cost time: 1.8136451244354248
Epoch: 11, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.617 Vali Acc: 0.821 Test Loss: 0.617 Test Acc: 0.821
Validation loss decreased (-0.809242 --> -0.820803).  Saving model ...
Epoch: 12 cost time: 1.8124279975891113
Epoch: 12, Steps: 17 | Train Loss: 0.200 Vali Loss: 0.603 Vali Acc: 0.809 Test Loss: 0.603 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.7236464023590088
Epoch: 13, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.642 Vali Acc: 0.780 Test Loss: 0.642 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6818575859069824
Epoch: 14, Steps: 17 | Train Loss: 0.159 Vali Loss: 0.838 Vali Acc: 0.775 Test Loss: 0.838 Test Acc: 0.775
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.850527048110962
Epoch: 15, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.851 Vali Acc: 0.763 Test Loss: 0.851 Test Acc: 0.763
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.8853867053985596
Epoch: 16, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.830 Vali Acc: 0.809 Test Loss: 0.830 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 17 cost time: 1.6684963703155518
Epoch: 17, Steps: 17 | Train Loss: 0.079 Vali Loss: 1.112 Vali Acc: 0.798 Test Loss: 1.112 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 18 cost time: 1.6209182739257812
Epoch: 18, Steps: 17 | Train Loss: 0.141 Vali Loss: 0.818 Vali Acc: 0.821 Test Loss: 0.818 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 19 cost time: 1.562243938446045
Epoch: 19, Steps: 17 | Train Loss: 0.038 Vali Loss: 0.823 Vali Acc: 0.809 Test Loss: 0.823 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 20 cost time: 1.764815092086792
Epoch: 20, Steps: 17 | Train Loss: 0.021 Vali Loss: 1.064 Vali Acc: 0.769 Test Loss: 1.064 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 21 cost time: 1.8308501243591309
Epoch: 21, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.033 Vali Acc: 0.798 Test Loss: 1.033 Test Acc: 0.798
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8208092485549133
model parameter : 393699
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            64                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.065741777420044
Epoch: 1, Steps: 17 | Train Loss: 1.924 Vali Loss: 1.759 Vali Acc: 0.277 Test Loss: 1.759 Test Acc: 0.277
Validation loss decreased (inf --> -0.277439).  Saving model ...
Epoch: 2 cost time: 1.6316070556640625
Epoch: 2, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.469 Vali Acc: 0.277 Test Loss: 1.469 Test Acc: 0.277
Validation loss decreased (-0.277439 --> -0.277442).  Saving model ...
Epoch: 3 cost time: 1.7237954139709473
Epoch: 3, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.222 Vali Acc: 0.405 Test Loss: 1.222 Test Acc: 0.405
Validation loss decreased (-0.277442 --> -0.404612).  Saving model ...
Epoch: 4 cost time: 1.7295506000518799
Epoch: 4, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.335 Vali Acc: 0.578 Test Loss: 1.335 Test Acc: 0.578
Validation loss decreased (-0.404612 --> -0.578021).  Saving model ...
Epoch: 5 cost time: 1.8074285984039307
Epoch: 5, Steps: 17 | Train Loss: 0.981 Vali Loss: 0.994 Vali Acc: 0.613 Test Loss: 0.994 Test Acc: 0.613
Validation loss decreased (-0.578021 --> -0.612707).  Saving model ...
Epoch: 6 cost time: 1.7296056747436523
Epoch: 6, Steps: 17 | Train Loss: 0.896 Vali Loss: 0.980 Vali Acc: 0.613 Test Loss: 0.980 Test Acc: 0.613
Validation loss decreased (-0.612707 --> -0.612707).  Saving model ...
Epoch: 7 cost time: 1.818291425704956
Epoch: 7, Steps: 17 | Train Loss: 0.731 Vali Loss: 0.993 Vali Acc: 0.624 Test Loss: 0.993 Test Acc: 0.624
Validation loss decreased (-0.612707 --> -0.624268).  Saving model ...
Epoch: 8 cost time: 1.6342387199401855
Epoch: 8, Steps: 17 | Train Loss: 0.617 Vali Loss: 0.949 Vali Acc: 0.665 Test Loss: 0.949 Test Acc: 0.665
Validation loss decreased (-0.624268 --> -0.664730).  Saving model ...
Epoch: 9 cost time: 1.7345614433288574
Epoch: 9, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.849 Vali Acc: 0.699 Test Loss: 0.849 Test Acc: 0.699
Validation loss decreased (-0.664730 --> -0.699413).  Saving model ...
Epoch: 10 cost time: 1.8719573020935059
Epoch: 10, Steps: 17 | Train Loss: 0.485 Vali Loss: 0.793 Vali Acc: 0.734 Test Loss: 0.793 Test Acc: 0.734
Validation loss decreased (-0.699413 --> -0.734096).  Saving model ...
Epoch: 11 cost time: 1.7576258182525635
Epoch: 11, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.807 Vali Acc: 0.665 Test Loss: 0.807 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.613846778869629
Epoch: 12, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.772 Vali Acc: 0.746 Test Loss: 0.772 Test Acc: 0.746
Validation loss decreased (-0.734096 --> -0.745657).  Saving model ...
Epoch: 13 cost time: 1.6194992065429688
Epoch: 13, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.770 Vali Acc: 0.763 Test Loss: 0.770 Test Acc: 0.763
Validation loss decreased (-0.745657 --> -0.762998).  Saving model ...
Epoch: 14 cost time: 1.5301451683044434
Epoch: 14, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.852 Vali Acc: 0.746 Test Loss: 0.852 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.7189531326293945
Epoch: 15, Steps: 17 | Train Loss: 0.140 Vali Loss: 0.742 Vali Acc: 0.780 Test Loss: 0.742 Test Acc: 0.780
Validation loss decreased (-0.762998 --> -0.780339).  Saving model ...
Epoch: 16 cost time: 1.8003344535827637
Epoch: 16, Steps: 17 | Train Loss: 0.257 Vali Loss: 0.857 Vali Acc: 0.769 Test Loss: 0.857 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7995657920837402
Epoch: 17, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.997 Vali Acc: 0.769 Test Loss: 0.997 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7415335178375244
Epoch: 18, Steps: 17 | Train Loss: 0.154 Vali Loss: 1.102 Vali Acc: 0.763 Test Loss: 1.102 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.8779902458190918
Epoch: 19, Steps: 17 | Train Loss: 0.107 Vali Loss: 1.032 Vali Acc: 0.757 Test Loss: 1.032 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.7940478324890137
Epoch: 20, Steps: 17 | Train Loss: 0.080 Vali Loss: 0.912 Vali Acc: 0.780 Test Loss: 0.912 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.7274894714355469
Epoch: 21, Steps: 17 | Train Loss: 0.103 Vali Loss: 1.050 Vali Acc: 0.775 Test Loss: 1.050 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6958246231079102
Epoch: 22, Steps: 17 | Train Loss: 0.078 Vali Loss: 1.349 Vali Acc: 0.757 Test Loss: 1.349 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.8020756244659424
Epoch: 23, Steps: 17 | Train Loss: 0.307 Vali Loss: 1.018 Vali Acc: 0.780 Test Loss: 1.018 Test Acc: 0.780
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.620168924331665
Epoch: 24, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.069 Vali Acc: 0.803 Test Loss: 1.069 Test Acc: 0.803
Validation loss decreased (-0.780339 --> -0.803458).  Saving model ...
Epoch: 25 cost time: 1.725813388824463
Epoch: 25, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.403 Vali Acc: 0.740 Test Loss: 1.403 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7903640270233154
Epoch: 26, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.943 Vali Acc: 0.815 Test Loss: 0.943 Test Acc: 0.815
Validation loss decreased (-0.803458 --> -0.815019).  Saving model ...
Epoch: 27 cost time: 1.641209602355957
Epoch: 27, Steps: 17 | Train Loss: 0.041 Vali Loss: 1.171 Vali Acc: 0.803 Test Loss: 1.171 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.680474042892456
Epoch: 28, Steps: 17 | Train Loss: 0.038 Vali Loss: 1.369 Vali Acc: 0.780 Test Loss: 1.369 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8492052555084229
Epoch: 29, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.967 Vali Acc: 0.815 Test Loss: 0.967 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.7901215553283691
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.007 Vali Acc: 0.827 Test Loss: 1.007 Test Acc: 0.827
Validation loss decreased (-0.815019 --> -0.826580).  Saving model ...
Epoch: 31 cost time: 1.7227191925048828
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.026 Vali Acc: 0.844 Test Loss: 1.026 Test Acc: 0.844
Validation loss decreased (-0.826580 --> -0.843920).  Saving model ...
Epoch: 32 cost time: 1.7619984149932861
Epoch: 32, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.187 Vali Acc: 0.827 Test Loss: 1.187 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.674316167831421
Epoch: 33, Steps: 17 | Train Loss: 0.084 Vali Loss: 1.253 Vali Acc: 0.780 Test Loss: 1.253 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.6570334434509277
Epoch: 34, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.969 Vali Acc: 0.815 Test Loss: 0.969 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.6045024394989014
Epoch: 35, Steps: 17 | Train Loss: 0.018 Vali Loss: 1.653 Vali Acc: 0.780 Test Loss: 1.653 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 36 cost time: 1.8916573524475098
Epoch: 36, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.412 Vali Acc: 0.815 Test Loss: 1.412 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 37 cost time: 1.7553482055664062
Epoch: 37, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.383 Vali Acc: 0.798 Test Loss: 1.383 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 38 cost time: 1.8400814533233643
Epoch: 38, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.199 Vali Acc: 0.803 Test Loss: 1.199 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 39 cost time: 1.8666372299194336
Epoch: 39, Steps: 17 | Train Loss: 0.004 Vali Loss: 1.445 Vali Acc: 0.809 Test Loss: 1.445 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 40 cost time: 1.6068732738494873
Epoch: 40, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.468 Vali Acc: 0.798 Test Loss: 1.468 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 41 cost time: 1.6273224353790283
Epoch: 41, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.485 Vali Acc: 0.792 Test Loss: 1.485 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm64_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 393699
model size : 2.73MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.953126907348633
Epoch: 1, Steps: 17 | Train Loss: 1.947 Vali Loss: 1.756 Vali Acc: 0.254 Test Loss: 1.756 Test Acc: 0.254
Validation loss decreased (inf --> -0.254318).  Saving model ...
Epoch: 2 cost time: 1.7631678581237793
Epoch: 2, Steps: 17 | Train Loss: 1.534 Vali Loss: 1.422 Vali Acc: 0.329 Test Loss: 1.422 Test Acc: 0.329
Validation loss decreased (-0.254318 --> -0.329466).  Saving model ...
Epoch: 3 cost time: 1.7597792148590088
Epoch: 3, Steps: 17 | Train Loss: 1.248 Vali Loss: 1.244 Vali Acc: 0.341 Test Loss: 1.244 Test Acc: 0.341
Validation loss decreased (-0.329466 --> -0.341028).  Saving model ...
Epoch: 4 cost time: 1.9048125743865967
Epoch: 4, Steps: 17 | Train Loss: 1.060 Vali Loss: 1.069 Vali Acc: 0.491 Test Loss: 1.069 Test Acc: 0.491
Validation loss decreased (-0.341028 --> -0.491319).  Saving model ...
Epoch: 5 cost time: 1.5764501094818115
Epoch: 5, Steps: 17 | Train Loss: 0.863 Vali Loss: 0.879 Vali Acc: 0.728 Test Loss: 0.879 Test Acc: 0.728
Validation loss decreased (-0.491319 --> -0.728315).  Saving model ...
Epoch: 6 cost time: 1.7562181949615479
Epoch: 6, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.818 Vali Acc: 0.688 Test Loss: 0.818 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5816664695739746
Epoch: 7, Steps: 17 | Train Loss: 0.598 Vali Loss: 0.832 Vali Acc: 0.659 Test Loss: 0.832 Test Acc: 0.659
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.5327229499816895
Epoch: 8, Steps: 17 | Train Loss: 0.543 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
Validation loss decreased (-0.728315 --> -0.745658).  Saving model ...
Epoch: 9 cost time: 1.630042314529419
Epoch: 9, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.716 Vali Acc: 0.763 Test Loss: 0.716 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 1.781620740890503
Epoch: 10, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.581 Vali Acc: 0.803 Test Loss: 0.581 Test Acc: 0.803
Validation loss decreased (-0.762999 --> -0.803462).  Saving model ...
Epoch: 11 cost time: 1.6622273921966553
Epoch: 11, Steps: 17 | Train Loss: 0.253 Vali Loss: 0.609 Vali Acc: 0.792 Test Loss: 0.609 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8975863456726074
Epoch: 12, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.630 Vali Acc: 0.815 Test Loss: 0.630 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815023).  Saving model ...
Epoch: 13 cost time: 1.7205479145050049
Epoch: 13, Steps: 17 | Train Loss: 0.136 Vali Loss: 0.546 Vali Acc: 0.798 Test Loss: 0.546 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.670158863067627
Epoch: 14, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.645 Vali Acc: 0.809 Test Loss: 0.645 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6998560428619385
Epoch: 15, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.582 Vali Acc: 0.827 Test Loss: 0.582 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826584).  Saving model ...
Epoch: 16 cost time: 1.7542643547058105
Epoch: 16, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.873 Vali Acc: 0.757 Test Loss: 0.873 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.7613348960876465
Epoch: 17, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.646 Vali Acc: 0.832 Test Loss: 0.646 Test Acc: 0.832
Validation loss decreased (-0.826584 --> -0.832363).  Saving model ...
Epoch: 18 cost time: 1.6993188858032227
Epoch: 18, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.662 Vali Acc: 0.838 Test Loss: 0.662 Test Acc: 0.838
Validation loss decreased (-0.832363 --> -0.838144).  Saving model ...
Epoch: 19 cost time: 1.8011174201965332
Epoch: 19, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.677 Vali Acc: 0.827 Test Loss: 0.677 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.8493459224700928
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.721 Vali Acc: 0.792 Test Loss: 0.721 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.8402206897735596
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.756 Vali Acc: 0.838 Test Loss: 0.756 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7850401401519775
Epoch: 22, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.718 Vali Acc: 0.775 Test Loss: 0.718 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6391842365264893
Epoch: 23, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.670 Vali Acc: 0.827 Test Loss: 0.670 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.613487720489502
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.791 Vali Acc: 0.827 Test Loss: 0.791 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.625854253768921
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.714 Vali Acc: 0.827 Test Loss: 0.714 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.7598011493682861
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.844 Test Loss: 0.749 Test Acc: 0.844
Validation loss decreased (-0.838144 --> -0.843923).  Saving model ...
Epoch: 27 cost time: 1.7128584384918213
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.699 Vali Acc: 0.844 Test Loss: 0.699 Test Acc: 0.844
Validation loss decreased (-0.843923 --> -0.843924).  Saving model ...
Epoch: 28 cost time: 1.7499268054962158
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.838 Test Loss: 0.749 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 1.7025768756866455
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.712 Vali Acc: 0.838 Test Loss: 0.712 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.639704942703247
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.749 Vali Acc: 0.850 Test Loss: 0.749 Test Acc: 0.850
Validation loss decreased (-0.843924 --> -0.849703).  Saving model ...
Epoch: 31 cost time: 1.605760097503662
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.721 Vali Acc: 0.838 Test Loss: 0.721 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.748992919921875
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.739 Vali Acc: 0.838 Test Loss: 0.739 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.6337053775787354
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.855 Test Loss: 0.747 Test Acc: 0.855
Validation loss decreased (-0.849703 --> -0.855484).  Saving model ...
Epoch: 34 cost time: 1.743290901184082
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.747 Vali Acc: 0.838 Test Loss: 0.747 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 35 cost time: 1.7458584308624268
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.775 Vali Acc: 0.809 Test Loss: 0.775 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 36 cost time: 1.6652843952178955
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.770 Vali Acc: 0.832 Test Loss: 0.770 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 37 cost time: 1.744736671447754
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.777 Vali Acc: 0.832 Test Loss: 0.777 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 38 cost time: 1.6614055633544922
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.774 Vali Acc: 0.821 Test Loss: 0.774 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 39 cost time: 1.64487886428833
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.827 Test Loss: 0.815 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 40 cost time: 1.7645845413208008
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.764 Vali Acc: 0.838 Test Loss: 0.764 Test Acc: 0.838
EarlyStopping counter: 7 out of 10
Epoch: 41 cost time: 1.6363520622253418
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.802 Vali Acc: 0.821 Test Loss: 0.802 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 42 cost time: 1.722036600112915
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.801 Vali Acc: 0.844 Test Loss: 0.801 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 43 cost time: 1.817162275314331
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.796 Vali Acc: 0.827 Test Loss: 0.796 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 323715
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.010860919952393
Epoch: 1, Steps: 17 | Train Loss: 1.960 Vali Loss: 1.779 Vali Acc: 0.243 Test Loss: 1.779 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 1.8383374214172363
Epoch: 2, Steps: 17 | Train Loss: 1.561 Vali Loss: 1.457 Vali Acc: 0.301 Test Loss: 1.457 Test Acc: 0.301
Validation loss decreased (-0.242757 --> -0.300563).  Saving model ...
Epoch: 3 cost time: 1.923232078552246
Epoch: 3, Steps: 17 | Train Loss: 1.268 Vali Loss: 1.259 Vali Acc: 0.335 Test Loss: 1.259 Test Acc: 0.335
Validation loss decreased (-0.300563 --> -0.335248).  Saving model ...
Epoch: 4 cost time: 1.7678935527801514
Epoch: 4, Steps: 17 | Train Loss: 1.093 Vali Loss: 1.104 Vali Acc: 0.422 Test Loss: 1.104 Test Acc: 0.422
Validation loss decreased (-0.335248 --> -0.421954).  Saving model ...
Epoch: 5 cost time: 1.8600997924804688
Epoch: 5, Steps: 17 | Train Loss: 0.893 Vali Loss: 0.916 Vali Acc: 0.671 Test Loss: 0.916 Test Acc: 0.671
Validation loss decreased (-0.421954 --> -0.670511).  Saving model ...
Epoch: 6 cost time: 1.7364585399627686
Epoch: 6, Steps: 17 | Train Loss: 0.780 Vali Loss: 0.839 Vali Acc: 0.659 Test Loss: 0.839 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.889129638671875
Epoch: 7, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.815 Vali Acc: 0.676 Test Loss: 0.815 Test Acc: 0.676
Validation loss decreased (-0.670511 --> -0.676292).  Saving model ...
Epoch: 8 cost time: 1.8531005382537842
Epoch: 8, Steps: 17 | Train Loss: 0.557 Vali Loss: 0.714 Vali Acc: 0.751 Test Loss: 0.714 Test Acc: 0.751
Validation loss decreased (-0.676292 --> -0.751438).  Saving model ...
Epoch: 9 cost time: 1.869842529296875
Epoch: 9, Steps: 17 | Train Loss: 0.417 Vali Loss: 0.700 Vali Acc: 0.751 Test Loss: 0.700 Test Acc: 0.751
Validation loss decreased (-0.751438 --> -0.751438).  Saving model ...
Epoch: 10 cost time: 1.9609019756317139
Epoch: 10, Steps: 17 | Train Loss: 0.356 Vali Loss: 0.625 Vali Acc: 0.803 Test Loss: 0.625 Test Acc: 0.803
Validation loss decreased (-0.751438 --> -0.803462).  Saving model ...
Epoch: 11 cost time: 2.0669405460357666
Epoch: 11, Steps: 17 | Train Loss: 0.283 Vali Loss: 0.631 Vali Acc: 0.775 Test Loss: 0.631 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.8260653018951416
Epoch: 12, Steps: 17 | Train Loss: 0.266 Vali Loss: 0.668 Vali Acc: 0.809 Test Loss: 0.668 Test Acc: 0.809
Validation loss decreased (-0.803462 --> -0.809242).  Saving model ...
Epoch: 13 cost time: 2.022775888442993
Epoch: 13, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.570 Vali Acc: 0.798 Test Loss: 0.570 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8875155448913574
Epoch: 14, Steps: 17 | Train Loss: 0.199 Vali Loss: 0.688 Vali Acc: 0.780 Test Loss: 0.688 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7930324077606201
Epoch: 15, Steps: 17 | Train Loss: 0.088 Vali Loss: 0.595 Vali Acc: 0.815 Test Loss: 0.595 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815023).  Saving model ...
Epoch: 16 cost time: 1.9044196605682373
Epoch: 16, Steps: 17 | Train Loss: 0.057 Vali Loss: 0.614 Vali Acc: 0.827 Test Loss: 0.614 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826583).  Saving model ...
Epoch: 17 cost time: 2.039632797241211
Epoch: 17, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.545 Vali Acc: 0.832 Test Loss: 0.545 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832364).  Saving model ...
Epoch: 18 cost time: 1.7681200504302979
Epoch: 18, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.831 Vali Acc: 0.803 Test Loss: 0.831 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.537271499633789
Epoch: 19, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.604 Vali Acc: 0.867 Test Loss: 0.604 Test Acc: 0.867
Validation loss decreased (-0.832364 --> -0.867046).  Saving model ...
Epoch: 20 cost time: 1.5911953449249268
Epoch: 20, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.721 Vali Acc: 0.838 Test Loss: 0.721 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.6997075080871582
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.6251001358032227
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.783 Vali Acc: 0.821 Test Loss: 0.783 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.8688549995422363
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.710 Vali Acc: 0.821 Test Loss: 0.710 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.9157462120056152
Epoch: 24, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.725 Vali Acc: 0.815 Test Loss: 0.725 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.800760269165039
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.778 Vali Acc: 0.838 Test Loss: 0.778 Test Acc: 0.838
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.87791109085083
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.728 Vali Acc: 0.832 Test Loss: 0.728 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.859410285949707
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.797 Vali Acc: 0.815 Test Loss: 0.797 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 2.0436813831329346
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.810 Vali Acc: 0.838 Test Loss: 0.810 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.9504215717315674
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.713 Vali Acc: 0.832 Test Loss: 0.713 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 323715
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.047755718231201
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.817 Vali Acc: 0.208 Test Loss: 1.817 Test Acc: 0.208
Validation loss decreased (inf --> -0.208074).  Saving model ...
Epoch: 2 cost time: 1.7345986366271973
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.523 Vali Acc: 0.301 Test Loss: 1.523 Test Acc: 0.301
Validation loss decreased (-0.208074 --> -0.300563).  Saving model ...
Epoch: 3 cost time: 1.6402711868286133
Epoch: 3, Steps: 17 | Train Loss: 1.304 Vali Loss: 1.301 Vali Acc: 0.329 Test Loss: 1.301 Test Acc: 0.329
Validation loss decreased (-0.300563 --> -0.329467).  Saving model ...
Epoch: 4 cost time: 1.6749777793884277
Epoch: 4, Steps: 17 | Train Loss: 1.127 Vali Loss: 1.131 Vali Acc: 0.434 Test Loss: 1.131 Test Acc: 0.434
Validation loss decreased (-0.329467 --> -0.433515).  Saving model ...
Epoch: 5 cost time: 1.704613447189331
Epoch: 5, Steps: 17 | Train Loss: 0.919 Vali Loss: 0.938 Vali Acc: 0.676 Test Loss: 0.938 Test Acc: 0.676
Validation loss decreased (-0.433515 --> -0.676291).  Saving model ...
Epoch: 6 cost time: 1.6364026069641113
Epoch: 6, Steps: 17 | Train Loss: 0.788 Vali Loss: 0.856 Vali Acc: 0.699 Test Loss: 0.856 Test Acc: 0.699
Validation loss decreased (-0.676291 --> -0.699413).  Saving model ...
Epoch: 7 cost time: 1.6027085781097412
Epoch: 7, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.851 Vali Acc: 0.665 Test Loss: 0.851 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.7046847343444824
Epoch: 8, Steps: 17 | Train Loss: 0.573 Vali Loss: 0.719 Vali Acc: 0.769 Test Loss: 0.719 Test Acc: 0.769
Validation loss decreased (-0.699413 --> -0.768779).  Saving model ...
Epoch: 9 cost time: 1.8166179656982422
Epoch: 9, Steps: 17 | Train Loss: 0.458 Vali Loss: 0.671 Vali Acc: 0.757 Test Loss: 0.671 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6971807479858398
Epoch: 10, Steps: 17 | Train Loss: 0.376 Vali Loss: 0.627 Vali Acc: 0.775 Test Loss: 0.627 Test Acc: 0.775
Validation loss decreased (-0.768779 --> -0.774560).  Saving model ...
Epoch: 11 cost time: 1.6615493297576904
Epoch: 11, Steps: 17 | Train Loss: 0.315 Vali Loss: 0.579 Vali Acc: 0.798 Test Loss: 0.579 Test Acc: 0.798
Validation loss decreased (-0.774560 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 1.6836020946502686
Epoch: 12, Steps: 17 | Train Loss: 0.280 Vali Loss: 0.681 Vali Acc: 0.798 Test Loss: 0.681 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6635150909423828
Epoch: 13, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.577 Vali Acc: 0.792 Test Loss: 0.577 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.799896478652954
Epoch: 14, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.626 Vali Acc: 0.792 Test Loss: 0.626 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.7146203517913818
Epoch: 15, Steps: 17 | Train Loss: 0.110 Vali Loss: 0.746 Vali Acc: 0.775 Test Loss: 0.746 Test Acc: 0.775
EarlyStopping counter: 4 out of 10
Epoch: 16 cost time: 1.6373169422149658
Epoch: 16, Steps: 17 | Train Loss: 0.093 Vali Loss: 0.732 Vali Acc: 0.803 Test Loss: 0.732 Test Acc: 0.803
Validation loss decreased (-0.797682 --> -0.803461).  Saving model ...
Epoch: 17 cost time: 1.7467405796051025
Epoch: 17, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.546 Vali Acc: 0.838 Test Loss: 0.546 Test Acc: 0.838
Validation loss decreased (-0.803461 --> -0.838145).  Saving model ...
Epoch: 18 cost time: 1.6878561973571777
Epoch: 18, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.809 Vali Acc: 0.786 Test Loss: 0.809 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.5580568313598633
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.817 Vali Acc: 0.769 Test Loss: 0.817 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7705154418945312
Epoch: 20, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.672 Vali Acc: 0.809 Test Loss: 0.672 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.796281099319458
Epoch: 21, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.991 Vali Acc: 0.792 Test Loss: 0.991 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.0020577907562256
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.915 Vali Acc: 0.809 Test Loss: 0.915 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9242527484893799
Epoch: 23, Steps: 17 | Train Loss: 0.033 Vali Loss: 1.120 Vali Acc: 0.786 Test Loss: 1.120 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.794881820678711
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.041 Vali Acc: 0.827 Test Loss: 1.041 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7697360515594482
Epoch: 25, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.029 Vali Acc: 0.798 Test Loss: 1.029 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8779733180999756
Epoch: 26, Steps: 17 | Train Loss: 0.043 Vali Loss: 1.199 Vali Acc: 0.769 Test Loss: 1.199 Test Acc: 0.769
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.9036409854888916
Epoch: 27, Steps: 17 | Train Loss: 0.015 Vali Loss: 1.017 Vali Acc: 0.792 Test Loss: 1.017 Test Acc: 0.792
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 323715
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               2048                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.152973651885986
Epoch: 1, Steps: 17 | Train Loss: 1.973 Vali Loss: 1.869 Vali Acc: 0.150 Test Loss: 1.869 Test Acc: 0.150
Validation loss decreased (inf --> -0.150270).  Saving model ...
Epoch: 2 cost time: 1.8456108570098877
Epoch: 2, Steps: 17 | Train Loss: 1.706 Vali Loss: 1.611 Vali Acc: 0.318 Test Loss: 1.611 Test Acc: 0.318
Validation loss decreased (-0.150270 --> -0.317903).  Saving model ...
Epoch: 3 cost time: 1.7476541996002197
Epoch: 3, Steps: 17 | Train Loss: 1.451 Vali Loss: 1.404 Vali Acc: 0.306 Test Loss: 1.404 Test Acc: 0.306
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.7397642135620117
Epoch: 4, Steps: 17 | Train Loss: 1.256 Vali Loss: 1.232 Vali Acc: 0.405 Test Loss: 1.232 Test Acc: 0.405
Validation loss decreased (-0.317903 --> -0.404612).  Saving model ...
Epoch: 5 cost time: 1.8449158668518066
Epoch: 5, Steps: 17 | Train Loss: 1.073 Vali Loss: 1.070 Vali Acc: 0.572 Test Loss: 1.070 Test Acc: 0.572
Validation loss decreased (-0.404612 --> -0.572244).  Saving model ...
Epoch: 6 cost time: 1.7360408306121826
Epoch: 6, Steps: 17 | Train Loss: 0.956 Vali Loss: 0.970 Vali Acc: 0.671 Test Loss: 0.970 Test Acc: 0.671
Validation loss decreased (-0.572244 --> -0.670511).  Saving model ...
Epoch: 7 cost time: 1.8069555759429932
Epoch: 7, Steps: 17 | Train Loss: 0.825 Vali Loss: 1.060 Vali Acc: 0.572 Test Loss: 1.060 Test Acc: 0.572
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.706812858581543
Epoch: 8, Steps: 17 | Train Loss: 0.826 Vali Loss: 0.882 Vali Acc: 0.601 Test Loss: 0.882 Test Acc: 0.601
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.8516628742218018
Epoch: 9, Steps: 17 | Train Loss: 0.656 Vali Loss: 0.802 Vali Acc: 0.711 Test Loss: 0.802 Test Acc: 0.711
Validation loss decreased (-0.670511 --> -0.710975).  Saving model ...
Epoch: 10 cost time: 1.8126349449157715
Epoch: 10, Steps: 17 | Train Loss: 0.555 Vali Loss: 0.808 Vali Acc: 0.688 Test Loss: 0.808 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7183783054351807
Epoch: 11, Steps: 17 | Train Loss: 0.492 Vali Loss: 0.709 Vali Acc: 0.699 Test Loss: 0.709 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.7374415397644043
Epoch: 12, Steps: 17 | Train Loss: 0.410 Vali Loss: 0.709 Vali Acc: 0.746 Test Loss: 0.709 Test Acc: 0.746
Validation loss decreased (-0.710975 --> -0.745658).  Saving model ...
Epoch: 13 cost time: 1.641465187072754
Epoch: 13, Steps: 17 | Train Loss: 0.348 Vali Loss: 0.619 Vali Acc: 0.763 Test Loss: 0.619 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.763000).  Saving model ...
Epoch: 14 cost time: 1.8008897304534912
Epoch: 14, Steps: 17 | Train Loss: 0.305 Vali Loss: 0.663 Vali Acc: 0.786 Test Loss: 0.663 Test Acc: 0.786
Validation loss decreased (-0.763000 --> -0.786121).  Saving model ...
Epoch: 15 cost time: 1.4835796356201172
Epoch: 15, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.952 Vali Acc: 0.694 Test Loss: 0.952 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.694176197052002
Epoch: 16, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.869 Vali Acc: 0.699 Test Loss: 0.869 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.6293840408325195
Epoch: 17, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.677 Vali Acc: 0.815 Test Loss: 0.677 Test Acc: 0.815
Validation loss decreased (-0.786121 --> -0.815022).  Saving model ...
Epoch: 18 cost time: 1.7185943126678467
Epoch: 18, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.788 Vali Acc: 0.798 Test Loss: 0.788 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.526965856552124
Epoch: 19, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.643 Vali Acc: 0.803 Test Loss: 0.643 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.562371015548706
Epoch: 20, Steps: 17 | Train Loss: 0.138 Vali Loss: 0.842 Vali Acc: 0.792 Test Loss: 0.842 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.539841651916504
Epoch: 21, Steps: 17 | Train Loss: 0.103 Vali Loss: 0.726 Vali Acc: 0.815 Test Loss: 0.726 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.577017068862915
Epoch: 22, Steps: 17 | Train Loss: 0.053 Vali Loss: 1.001 Vali Acc: 0.786 Test Loss: 1.001 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.5652475357055664
Epoch: 23, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.657 Vali Acc: 0.861 Test Loss: 0.657 Test Acc: 0.861
Validation loss decreased (-0.815022 --> -0.861265).  Saving model ...
Epoch: 24 cost time: 1.6337580680847168
Epoch: 24, Steps: 17 | Train Loss: 0.062 Vali Loss: 0.892 Vali Acc: 0.775 Test Loss: 0.892 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.599607229232788
Epoch: 25, Steps: 17 | Train Loss: 0.104 Vali Loss: 0.994 Vali Acc: 0.792 Test Loss: 0.994 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.7006657123565674
Epoch: 26, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.925 Vali Acc: 0.780 Test Loss: 0.925 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6595022678375244
Epoch: 27, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.840 Vali Acc: 0.815 Test Loss: 0.840 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5429317951202393
Epoch: 28, Steps: 17 | Train Loss: 0.059 Vali Loss: 1.020 Vali Acc: 0.786 Test Loss: 1.020 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.75193190574646
Epoch: 29, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.911 Vali Acc: 0.792 Test Loss: 0.911 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.7005808353424072
Epoch: 30, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.161 Vali Acc: 0.746 Test Loss: 1.161 Test Acc: 0.746
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.574247121810913
Epoch: 31, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.922 Vali Acc: 0.798 Test Loss: 0.922 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.6812529563903809
Epoch: 32, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.758 Vali Acc: 0.815 Test Loss: 0.758 Test Acc: 0.815
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.4929544925689697
Epoch: 33, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.954 Vali Acc: 0.815 Test Loss: 0.954 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df2048_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 323715
model size : 1.86MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.974168300628662
Epoch: 1, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.779 Vali Acc: 0.260 Test Loss: 1.779 Test Acc: 0.260
Validation loss decreased (inf --> -0.260098).  Saving model ...
Epoch: 2 cost time: 1.8216955661773682
Epoch: 2, Steps: 17 | Train Loss: 1.580 Vali Loss: 1.411 Vali Acc: 0.347 Test Loss: 1.411 Test Acc: 0.347
Validation loss decreased (-0.260098 --> -0.346807).  Saving model ...
Epoch: 3 cost time: 1.9216020107269287
Epoch: 3, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.237 Vali Acc: 0.474 Test Loss: 1.237 Test Acc: 0.474
Validation loss decreased (-0.346807 --> -0.473976).  Saving model ...
Epoch: 4 cost time: 1.9155030250549316
Epoch: 4, Steps: 17 | Train Loss: 1.048 Vali Loss: 1.083 Vali Acc: 0.572 Test Loss: 1.083 Test Acc: 0.572
Validation loss decreased (-0.473976 --> -0.572244).  Saving model ...
Epoch: 5 cost time: 1.798358678817749
Epoch: 5, Steps: 17 | Train Loss: 0.916 Vali Loss: 0.966 Vali Acc: 0.538 Test Loss: 0.966 Test Acc: 0.538
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.808401346206665
Epoch: 6, Steps: 17 | Train Loss: 0.816 Vali Loss: 0.872 Vali Acc: 0.647 Test Loss: 0.872 Test Acc: 0.647
Validation loss decreased (-0.572244 --> -0.647390).  Saving model ...
Epoch: 7 cost time: 1.7913153171539307
Epoch: 7, Steps: 17 | Train Loss: 0.633 Vali Loss: 0.810 Vali Acc: 0.688 Test Loss: 0.810 Test Acc: 0.688
Validation loss decreased (-0.647390 --> -0.687853).  Saving model ...
Epoch: 8 cost time: 1.717149257659912
Epoch: 8, Steps: 17 | Train Loss: 0.608 Vali Loss: 0.674 Vali Acc: 0.792 Test Loss: 0.674 Test Acc: 0.792
Validation loss decreased (-0.687853 --> -0.791901).  Saving model ...
Epoch: 9 cost time: 1.740473985671997
Epoch: 9, Steps: 17 | Train Loss: 0.483 Vali Loss: 0.682 Vali Acc: 0.746 Test Loss: 0.682 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.8119091987609863
Epoch: 10, Steps: 17 | Train Loss: 0.377 Vali Loss: 0.756 Vali Acc: 0.723 Test Loss: 0.756 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8810360431671143
Epoch: 11, Steps: 17 | Train Loss: 0.353 Vali Loss: 0.715 Vali Acc: 0.728 Test Loss: 0.715 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8371567726135254
Epoch: 12, Steps: 17 | Train Loss: 0.226 Vali Loss: 0.782 Vali Acc: 0.717 Test Loss: 0.782 Test Acc: 0.717
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.8230407238006592
Epoch: 13, Steps: 17 | Train Loss: 0.164 Vali Loss: 0.649 Vali Acc: 0.798 Test Loss: 0.649 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797681).  Saving model ...
Epoch: 14 cost time: 1.7766389846801758
Epoch: 14, Steps: 17 | Train Loss: 0.175 Vali Loss: 0.642 Vali Acc: 0.786 Test Loss: 0.642 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.839015245437622
Epoch: 15, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.534 Vali Acc: 0.850 Test Loss: 0.534 Test Acc: 0.850
Validation loss decreased (-0.797681 --> -0.849706).  Saving model ...
Epoch: 16 cost time: 1.8560562133789062
Epoch: 16, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.617 Vali Acc: 0.850 Test Loss: 0.617 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.8957371711730957
Epoch: 17, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.756 Vali Acc: 0.821 Test Loss: 0.756 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7942306995391846
Epoch: 18, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.709 Vali Acc: 0.821 Test Loss: 0.709 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.706756830215454
Epoch: 19, Steps: 17 | Train Loss: 0.028 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
Validation loss decreased (-0.849706 --> -0.861266).  Saving model ...
Epoch: 20 cost time: 1.693260908126831
Epoch: 20, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.774 Vali Acc: 0.821 Test Loss: 0.774 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.8740222454071045
Epoch: 21, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.744 Vali Acc: 0.861 Test Loss: 0.744 Test Acc: 0.861
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.9274194240570068
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.682 Vali Acc: 0.827 Test Loss: 0.682 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.7373638153076172
Epoch: 23, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.733 Vali Acc: 0.844 Test Loss: 0.733 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.634833574295044
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.702 Vali Acc: 0.827 Test Loss: 0.702 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.6451647281646729
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.668 Vali Acc: 0.815 Test Loss: 0.668 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.7200074195861816
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.695 Vali Acc: 0.832 Test Loss: 0.695 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.7347111701965332
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.821 Test Loss: 0.673 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.8161933422088623
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.669 Vali Acc: 0.832 Test Loss: 0.669 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 29 cost time: 1.7595596313476562
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.787 Vali Acc: 0.827 Test Loss: 0.787 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.861271676300578
model parameter : 258179
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.799858331680298
Epoch: 1, Steps: 17 | Train Loss: 1.900 Vali Loss: 1.776 Vali Acc: 0.266 Test Loss: 1.776 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 1.6550140380859375
Epoch: 2, Steps: 17 | Train Loss: 1.572 Vali Loss: 1.404 Vali Acc: 0.364 Test Loss: 1.404 Test Acc: 0.364
Validation loss decreased (-0.265878 --> -0.364148).  Saving model ...
Epoch: 3 cost time: 1.6097331047058105
Epoch: 3, Steps: 17 | Train Loss: 1.276 Vali Loss: 1.235 Vali Acc: 0.474 Test Loss: 1.235 Test Acc: 0.474
Validation loss decreased (-0.364148 --> -0.473976).  Saving model ...
Epoch: 4 cost time: 1.607445478439331
Epoch: 4, Steps: 17 | Train Loss: 1.064 Vali Loss: 1.106 Vali Acc: 0.520 Test Loss: 1.106 Test Acc: 0.520
Validation loss decreased (-0.473976 --> -0.520220).  Saving model ...
Epoch: 5 cost time: 1.5283522605895996
Epoch: 5, Steps: 17 | Train Loss: 0.938 Vali Loss: 0.972 Vali Acc: 0.526 Test Loss: 0.972 Test Acc: 0.526
Validation loss decreased (-0.520220 --> -0.526002).  Saving model ...
Epoch: 6 cost time: 1.648573875427246
Epoch: 6, Steps: 17 | Train Loss: 0.839 Vali Loss: 0.861 Vali Acc: 0.671 Test Loss: 0.861 Test Acc: 0.671
Validation loss decreased (-0.526002 --> -0.670512).  Saving model ...
Epoch: 7 cost time: 1.6046478748321533
Epoch: 7, Steps: 17 | Train Loss: 0.673 Vali Loss: 0.847 Vali Acc: 0.630 Test Loss: 0.847 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5780539512634277
Epoch: 8, Steps: 17 | Train Loss: 0.666 Vali Loss: 0.697 Vali Acc: 0.763 Test Loss: 0.697 Test Acc: 0.763
Validation loss decreased (-0.670512 --> -0.762999).  Saving model ...
Epoch: 9 cost time: 1.7142999172210693
Epoch: 9, Steps: 17 | Train Loss: 0.569 Vali Loss: 0.750 Vali Acc: 0.728 Test Loss: 0.750 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.6954619884490967
Epoch: 10, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.828 Vali Acc: 0.694 Test Loss: 0.828 Test Acc: 0.694
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.8446035385131836
Epoch: 11, Steps: 17 | Train Loss: 0.427 Vali Loss: 0.781 Vali Acc: 0.746 Test Loss: 0.781 Test Acc: 0.746
EarlyStopping counter: 3 out of 10
Epoch: 12 cost time: 1.8010399341583252
Epoch: 12, Steps: 17 | Train Loss: 0.276 Vali Loss: 0.832 Vali Acc: 0.647 Test Loss: 0.832 Test Acc: 0.647
EarlyStopping counter: 4 out of 10
Epoch: 13 cost time: 1.582801103591919
Epoch: 13, Steps: 17 | Train Loss: 0.197 Vali Loss: 0.629 Vali Acc: 0.792 Test Loss: 0.629 Test Acc: 0.792
Validation loss decreased (-0.762999 --> -0.791901).  Saving model ...
Epoch: 14 cost time: 1.609499454498291
Epoch: 14, Steps: 17 | Train Loss: 0.179 Vali Loss: 0.599 Vali Acc: 0.786 Test Loss: 0.599 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.766202449798584
Epoch: 15, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.666 Vali Acc: 0.809 Test Loss: 0.666 Test Acc: 0.809
Validation loss decreased (-0.791901 --> -0.809242).  Saving model ...
Epoch: 16 cost time: 1.846527099609375
Epoch: 16, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.602 Vali Acc: 0.809 Test Loss: 0.602 Test Acc: 0.809
Validation loss decreased (-0.809242 --> -0.809243).  Saving model ...
Epoch: 17 cost time: 1.6672651767730713
Epoch: 17, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.618 Vali Acc: 0.850 Test Loss: 0.618 Test Acc: 0.850
Validation loss decreased (-0.809243 --> -0.849705).  Saving model ...
Epoch: 18 cost time: 1.5991582870483398
Epoch: 18, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.641 Vali Acc: 0.850 Test Loss: 0.641 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6048779487609863
Epoch: 19, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.715 Vali Acc: 0.821 Test Loss: 0.715 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7443320751190186
Epoch: 20, Steps: 17 | Train Loss: 0.048 Vali Loss: 0.781 Vali Acc: 0.827 Test Loss: 0.781 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.995008945465088
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.669 Vali Acc: 0.844 Test Loss: 0.669 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 2.079529285430908
Epoch: 22, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.743 Vali Acc: 0.803 Test Loss: 0.743 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.9923655986785889
Epoch: 23, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.686 Vali Acc: 0.844 Test Loss: 0.686 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7573866844177246
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.722 Vali Acc: 0.832 Test Loss: 0.722 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.8864853382110596
Epoch: 25, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.698 Vali Acc: 0.838 Test Loss: 0.698 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.8537523746490479
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.699 Vali Acc: 0.850 Test Loss: 0.699 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 27 cost time: 1.8629062175750732
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.741 Vali Acc: 0.832 Test Loss: 0.741 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 258179
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8509154319763184
Epoch: 1, Steps: 17 | Train Loss: 1.905 Vali Loss: 1.781 Vali Acc: 0.295 Test Loss: 1.781 Test Acc: 0.295
Validation loss decreased (inf --> -0.294780).  Saving model ...
Epoch: 2 cost time: 1.6646137237548828
Epoch: 2, Steps: 17 | Train Loss: 1.615 Vali Loss: 1.441 Vali Acc: 0.376 Test Loss: 1.441 Test Acc: 0.376
Validation loss decreased (-0.294780 --> -0.375708).  Saving model ...
Epoch: 3 cost time: 1.8327124118804932
Epoch: 3, Steps: 17 | Train Loss: 1.331 Vali Loss: 1.252 Vali Acc: 0.474 Test Loss: 1.252 Test Acc: 0.474
Validation loss decreased (-0.375708 --> -0.473976).  Saving model ...
Epoch: 4 cost time: 1.825117826461792
Epoch: 4, Steps: 17 | Train Loss: 1.071 Vali Loss: 1.134 Vali Acc: 0.486 Test Loss: 1.134 Test Acc: 0.486
Validation loss decreased (-0.473976 --> -0.485538).  Saving model ...
Epoch: 5 cost time: 2.011212110519409
Epoch: 5, Steps: 17 | Train Loss: 0.964 Vali Loss: 1.002 Vali Acc: 0.578 Test Loss: 1.002 Test Acc: 0.578
Validation loss decreased (-0.485538 --> -0.578025).  Saving model ...
Epoch: 6 cost time: 1.6195077896118164
Epoch: 6, Steps: 17 | Train Loss: 0.850 Vali Loss: 0.891 Vali Acc: 0.671 Test Loss: 0.891 Test Acc: 0.671
Validation loss decreased (-0.578025 --> -0.670511).  Saving model ...
Epoch: 7 cost time: 1.6514112949371338
Epoch: 7, Steps: 17 | Train Loss: 0.690 Vali Loss: 0.935 Vali Acc: 0.584 Test Loss: 0.935 Test Acc: 0.584
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6693682670593262
Epoch: 8, Steps: 17 | Train Loss: 0.701 Vali Loss: 0.770 Vali Acc: 0.705 Test Loss: 0.770 Test Acc: 0.705
Validation loss decreased (-0.670511 --> -0.705195).  Saving model ...
Epoch: 9 cost time: 1.8112285137176514
Epoch: 9, Steps: 17 | Train Loss: 0.588 Vali Loss: 0.788 Vali Acc: 0.671 Test Loss: 0.788 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7218573093414307
Epoch: 10, Steps: 17 | Train Loss: 0.477 Vali Loss: 0.848 Vali Acc: 0.699 Test Loss: 0.848 Test Acc: 0.699
EarlyStopping counter: 2 out of 10
Epoch: 11 cost time: 1.6334218978881836
Epoch: 11, Steps: 17 | Train Loss: 0.448 Vali Loss: 0.748 Vali Acc: 0.711 Test Loss: 0.748 Test Acc: 0.711
Validation loss decreased (-0.705195 --> -0.710975).  Saving model ...
Epoch: 12 cost time: 1.5651111602783203
Epoch: 12, Steps: 17 | Train Loss: 0.306 Vali Loss: 0.772 Vali Acc: 0.694 Test Loss: 0.772 Test Acc: 0.694
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.5442516803741455
Epoch: 13, Steps: 17 | Train Loss: 0.237 Vali Loss: 0.798 Vali Acc: 0.728 Test Loss: 0.798 Test Acc: 0.728
Validation loss decreased (-0.710975 --> -0.728316).  Saving model ...
Epoch: 14 cost time: 1.7649569511413574
Epoch: 14, Steps: 17 | Train Loss: 0.278 Vali Loss: 0.619 Vali Acc: 0.815 Test Loss: 0.619 Test Acc: 0.815
Validation loss decreased (-0.728316 --> -0.815023).  Saving model ...
Epoch: 15 cost time: 1.849003791809082
Epoch: 15, Steps: 17 | Train Loss: 0.166 Vali Loss: 0.674 Vali Acc: 0.786 Test Loss: 0.674 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.718785285949707
Epoch: 16, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.693 Vali Acc: 0.809 Test Loss: 0.693 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.638643503189087
Epoch: 17, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.7275018692016602
Epoch: 18, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.735 Vali Acc: 0.757 Test Loss: 0.735 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.8225831985473633
Epoch: 19, Steps: 17 | Train Loss: 0.075 Vali Loss: 1.115 Vali Acc: 0.780 Test Loss: 1.115 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.745391607284546
Epoch: 20, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.784 Vali Acc: 0.809 Test Loss: 0.784 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.7221291065216064
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.800 Vali Acc: 0.827 Test Loss: 0.800 Test Acc: 0.827
Validation loss decreased (-0.815023 --> -0.826582).  Saving model ...
Epoch: 22 cost time: 1.8640999794006348
Epoch: 22, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.851 Vali Acc: 0.786 Test Loss: 0.851 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.7892043590545654
Epoch: 23, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.819 Vali Acc: 0.827 Test Loss: 0.819 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.938401222229004
Epoch: 24, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.807 Vali Acc: 0.838 Test Loss: 0.807 Test Acc: 0.838
Validation loss decreased (-0.826582 --> -0.838142).  Saving model ...
Epoch: 25 cost time: 1.9053399562835693
Epoch: 25, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.941 Vali Acc: 0.803 Test Loss: 0.941 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.9109549522399902
Epoch: 26, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.673 Vali Acc: 0.827 Test Loss: 0.673 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.7079734802246094
Epoch: 27, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.789 Vali Acc: 0.844 Test Loss: 0.789 Test Acc: 0.844
Validation loss decreased (-0.838142 --> -0.843923).  Saving model ...
Epoch: 28 cost time: 1.8914906978607178
Epoch: 28, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.702 Vali Acc: 0.827 Test Loss: 0.702 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 29 cost time: 2.017434597015381
Epoch: 29, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.902 Vali Acc: 0.815 Test Loss: 0.902 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 30 cost time: 1.9434685707092285
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.843 Vali Acc: 0.832 Test Loss: 0.843 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 31 cost time: 1.7803401947021484
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.796 Vali Acc: 0.821 Test Loss: 0.796 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 32 cost time: 1.7858808040618896
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.816 Vali Acc: 0.809 Test Loss: 0.816 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 33 cost time: 1.8811402320861816
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.829 Vali Acc: 0.809 Test Loss: 0.829 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 34 cost time: 2.0579285621643066
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.808 Vali Acc: 0.809 Test Loss: 0.808 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 35 cost time: 1.9210140705108643
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.803 Vali Acc: 0.809 Test Loss: 0.803 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 36 cost time: 1.757838249206543
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.820 Vali Acc: 0.821 Test Loss: 0.820 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 37 cost time: 1.7007689476013184
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.815 Vali Acc: 0.815 Test Loss: 0.815 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 258179
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               1024                
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.533886671066284
Epoch: 1, Steps: 17 | Train Loss: 1.872 Vali Loss: 1.791 Vali Acc: 0.306 Test Loss: 1.791 Test Acc: 0.306
Validation loss decreased (inf --> -0.306340).  Saving model ...
Epoch: 2 cost time: 1.6395931243896484
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.509 Vali Acc: 0.370 Test Loss: 1.509 Test Acc: 0.370
Validation loss decreased (-0.306340 --> -0.369927).  Saving model ...
Epoch: 3 cost time: 1.7170138359069824
Epoch: 3, Steps: 17 | Train Loss: 1.394 Vali Loss: 1.316 Vali Acc: 0.474 Test Loss: 1.316 Test Acc: 0.474
Validation loss decreased (-0.369927 --> -0.473975).  Saving model ...
Epoch: 4 cost time: 1.5851433277130127
Epoch: 4, Steps: 17 | Train Loss: 1.175 Vali Loss: 1.243 Vali Acc: 0.439 Test Loss: 1.243 Test Acc: 0.439
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6890921592712402
Epoch: 5, Steps: 17 | Train Loss: 1.092 Vali Loss: 1.100 Vali Acc: 0.497 Test Loss: 1.100 Test Acc: 0.497
Validation loss decreased (-0.473975 --> -0.497099).  Saving model ...
Epoch: 6 cost time: 1.5388283729553223
Epoch: 6, Steps: 17 | Train Loss: 0.950 Vali Loss: 0.995 Vali Acc: 0.601 Test Loss: 0.995 Test Acc: 0.601
Validation loss decreased (-0.497099 --> -0.601146).  Saving model ...
Epoch: 7 cost time: 1.4182612895965576
Epoch: 7, Steps: 17 | Train Loss: 0.849 Vali Loss: 1.017 Vali Acc: 0.514 Test Loss: 1.017 Test Acc: 0.514
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5125596523284912
Epoch: 8, Steps: 17 | Train Loss: 0.800 Vali Loss: 0.889 Vali Acc: 0.618 Test Loss: 0.889 Test Acc: 0.618
Validation loss decreased (-0.601146 --> -0.618488).  Saving model ...
Epoch: 9 cost time: 1.5857186317443848
Epoch: 9, Steps: 17 | Train Loss: 0.704 Vali Loss: 0.943 Vali Acc: 0.578 Test Loss: 0.943 Test Acc: 0.578
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.3273687362670898
Epoch: 10, Steps: 17 | Train Loss: 0.597 Vali Loss: 0.863 Vali Acc: 0.624 Test Loss: 0.863 Test Acc: 0.624
Validation loss decreased (-0.618488 --> -0.624269).  Saving model ...
Epoch: 11 cost time: 1.4970507621765137
Epoch: 11, Steps: 17 | Train Loss: 0.564 Vali Loss: 0.803 Vali Acc: 0.694 Test Loss: 0.803 Test Acc: 0.694
Validation loss decreased (-0.624269 --> -0.693634).  Saving model ...
Epoch: 12 cost time: 1.5076680183410645
Epoch: 12, Steps: 17 | Train Loss: 0.447 Vali Loss: 0.923 Vali Acc: 0.590 Test Loss: 0.923 Test Acc: 0.590
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.617201566696167
Epoch: 13, Steps: 17 | Train Loss: 0.428 Vali Loss: 0.778 Vali Acc: 0.682 Test Loss: 0.778 Test Acc: 0.682
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.4873452186584473
Epoch: 14, Steps: 17 | Train Loss: 0.359 Vali Loss: 0.679 Vali Acc: 0.746 Test Loss: 0.679 Test Acc: 0.746
Validation loss decreased (-0.693634 --> -0.745658).  Saving model ...
Epoch: 15 cost time: 1.6560251712799072
Epoch: 15, Steps: 17 | Train Loss: 0.345 Vali Loss: 0.861 Vali Acc: 0.740 Test Loss: 0.861 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.6458699703216553
Epoch: 16, Steps: 17 | Train Loss: 0.244 Vali Loss: 0.693 Vali Acc: 0.763 Test Loss: 0.693 Test Acc: 0.763
Validation loss decreased (-0.745658 --> -0.762999).  Saving model ...
Epoch: 17 cost time: 1.7651939392089844
Epoch: 17, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.671 Vali Acc: 0.786 Test Loss: 0.671 Test Acc: 0.786
Validation loss decreased (-0.762999 --> -0.786120).  Saving model ...
Epoch: 18 cost time: 1.8038849830627441
Epoch: 18, Steps: 17 | Train Loss: 0.193 Vali Loss: 0.685 Vali Acc: 0.792 Test Loss: 0.685 Test Acc: 0.792
Validation loss decreased (-0.786120 --> -0.791901).  Saving model ...
Epoch: 19 cost time: 1.8099865913391113
Epoch: 19, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.797 Vali Acc: 0.775 Test Loss: 0.797 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.805612564086914
Epoch: 20, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.765 Vali Acc: 0.746 Test Loss: 0.765 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6722795963287354
Epoch: 21, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.849 Vali Acc: 0.769 Test Loss: 0.849 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.7689261436462402
Epoch: 22, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.799 Vali Acc: 0.798 Test Loss: 0.799 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797680).  Saving model ...
Epoch: 23 cost time: 1.800445795059204
Epoch: 23, Steps: 17 | Train Loss: 0.111 Vali Loss: 0.653 Vali Acc: 0.792 Test Loss: 0.653 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 24 cost time: 1.7099881172180176
Epoch: 24, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.225 Vali Acc: 0.717 Test Loss: 1.225 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 25 cost time: 1.7182931900024414
Epoch: 25, Steps: 17 | Train Loss: 0.213 Vali Loss: 1.352 Vali Acc: 0.757 Test Loss: 1.352 Test Acc: 0.757
EarlyStopping counter: 3 out of 10
Epoch: 26 cost time: 1.801365852355957
Epoch: 26, Steps: 17 | Train Loss: 0.194 Vali Loss: 0.919 Vali Acc: 0.792 Test Loss: 0.919 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 27 cost time: 1.8338632583618164
Epoch: 27, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.895 Vali Acc: 0.775 Test Loss: 0.895 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 28 cost time: 1.7731373310089111
Epoch: 28, Steps: 17 | Train Loss: 0.047 Vali Loss: 1.132 Vali Acc: 0.803 Test Loss: 1.132 Test Acc: 0.803
Validation loss decreased (-0.797680 --> -0.803457).  Saving model ...
Epoch: 29 cost time: 1.771240472793579
Epoch: 29, Steps: 17 | Train Loss: 0.068 Vali Loss: 1.150 Vali Acc: 0.786 Test Loss: 1.150 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.8028762340545654
Epoch: 30, Steps: 17 | Train Loss: 0.043 Vali Loss: 0.881 Vali Acc: 0.798 Test Loss: 0.881 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 31 cost time: 1.6981232166290283
Epoch: 31, Steps: 17 | Train Loss: 0.011 Vali Loss: 1.022 Vali Acc: 0.832 Test Loss: 1.022 Test Acc: 0.832
Validation loss decreased (-0.803457 --> -0.832360).  Saving model ...
Epoch: 32 cost time: 1.494055986404419
Epoch: 32, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.953 Vali Acc: 0.809 Test Loss: 0.953 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.627615213394165
Epoch: 33, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.888 Vali Acc: 0.803 Test Loss: 0.888 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7337627410888672
Epoch: 34, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.868 Vali Acc: 0.809 Test Loss: 0.868 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 35 cost time: 1.7449617385864258
Epoch: 35, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.823 Vali Acc: 0.838 Test Loss: 0.823 Test Acc: 0.838
Validation loss decreased (-0.832360 --> -0.838142).  Saving model ...
Epoch: 36 cost time: 1.784043788909912
Epoch: 36, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.886 Vali Acc: 0.838 Test Loss: 0.886 Test Acc: 0.838
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.6927809715270996
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.913 Vali Acc: 0.838 Test Loss: 0.913 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.7159738540649414
Epoch: 38, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.875 Vali Acc: 0.821 Test Loss: 0.875 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.6456308364868164
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.897 Vali Acc: 0.827 Test Loss: 0.897 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.7978167533874512
Epoch: 40, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.916 Vali Acc: 0.821 Test Loss: 0.916 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.7507574558258057
Epoch: 41, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.872 Vali Acc: 0.850 Test Loss: 0.872 Test Acc: 0.850
Validation loss decreased (-0.838142 --> -0.849702).  Saving model ...
Epoch: 42 cost time: 1.6620512008666992
Epoch: 42, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.834 Vali Acc: 0.827 Test Loss: 0.834 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 43 cost time: 1.5923349857330322
Epoch: 43, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.852 Vali Acc: 0.832 Test Loss: 0.852 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 44 cost time: 1.6856591701507568
Epoch: 44, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.862 Vali Acc: 0.827 Test Loss: 0.862 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 45 cost time: 1.6570558547973633
Epoch: 45, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.874 Vali Acc: 0.844 Test Loss: 0.874 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 46 cost time: 1.6889643669128418
Epoch: 46, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.861 Vali Acc: 0.827 Test Loss: 0.861 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 47 cost time: 1.6701023578643799
Epoch: 47, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.832 Test Loss: 0.853 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 48 cost time: 1.5247063636779785
Epoch: 48, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.858 Vali Acc: 0.821 Test Loss: 0.858 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 49 cost time: 1.647676706314087
Epoch: 49, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.849 Vali Acc: 0.821 Test Loss: 0.849 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 50 cost time: 1.7675867080688477
Epoch: 50, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.853 Vali Acc: 0.827 Test Loss: 0.853 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 51 cost time: 1.7095682621002197
Epoch: 51, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.847 Vali Acc: 0.821 Test Loss: 0.847 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df1024_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 258179
model size : 1.61MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8255536556243896
Epoch: 1, Steps: 17 | Train Loss: 1.931 Vali Loss: 1.750 Vali Acc: 0.249 Test Loss: 1.750 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 1.6005566120147705
Epoch: 2, Steps: 17 | Train Loss: 1.614 Vali Loss: 1.414 Vali Acc: 0.358 Test Loss: 1.414 Test Acc: 0.358
Validation loss decreased (-0.248537 --> -0.358367).  Saving model ...
Epoch: 3 cost time: 1.471961498260498
Epoch: 3, Steps: 17 | Train Loss: 1.270 Vali Loss: 1.173 Vali Acc: 0.572 Test Loss: 1.173 Test Acc: 0.572
Validation loss decreased (-0.358367 --> -0.572243).  Saving model ...
Epoch: 4 cost time: 1.5911304950714111
Epoch: 4, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.115 Vali Acc: 0.422 Test Loss: 1.115 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.4844958782196045
Epoch: 5, Steps: 17 | Train Loss: 0.968 Vali Loss: 1.126 Vali Acc: 0.486 Test Loss: 1.126 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.5035977363586426
Epoch: 6, Steps: 17 | Train Loss: 0.866 Vali Loss: 0.875 Vali Acc: 0.682 Test Loss: 0.875 Test Acc: 0.682
Validation loss decreased (-0.572243 --> -0.682072).  Saving model ...
Epoch: 7 cost time: 1.6728136539459229
Epoch: 7, Steps: 17 | Train Loss: 0.720 Vali Loss: 0.939 Vali Acc: 0.607 Test Loss: 0.939 Test Acc: 0.607
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8760261535644531
Epoch: 8, Steps: 17 | Train Loss: 0.585 Vali Loss: 0.751 Vali Acc: 0.757 Test Loss: 0.751 Test Acc: 0.757
Validation loss decreased (-0.682072 --> -0.757218).  Saving model ...
Epoch: 9 cost time: 1.754570484161377
Epoch: 9, Steps: 17 | Train Loss: 0.436 Vali Loss: 0.658 Vali Acc: 0.792 Test Loss: 0.658 Test Acc: 0.792
Validation loss decreased (-0.757218 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 1.6550958156585693
Epoch: 10, Steps: 17 | Train Loss: 0.401 Vali Loss: 0.660 Vali Acc: 0.775 Test Loss: 0.660 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6260695457458496
Epoch: 11, Steps: 17 | Train Loss: 0.273 Vali Loss: 0.668 Vali Acc: 0.769 Test Loss: 0.668 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.6474230289459229
Epoch: 12, Steps: 17 | Train Loss: 0.225 Vali Loss: 0.563 Vali Acc: 0.844 Test Loss: 0.563 Test Acc: 0.844
Validation loss decreased (-0.791901 --> -0.843925).  Saving model ...
Epoch: 13 cost time: 1.7075979709625244
Epoch: 13, Steps: 17 | Train Loss: 0.245 Vali Loss: 0.798 Vali Acc: 0.775 Test Loss: 0.798 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8017041683197021
Epoch: 14, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.652 Vali Acc: 0.821 Test Loss: 0.652 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6500577926635742
Epoch: 15, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.752 Vali Acc: 0.803 Test Loss: 0.752 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.614539384841919
Epoch: 16, Steps: 17 | Train Loss: 0.076 Vali Loss: 0.692 Vali Acc: 0.809 Test Loss: 0.692 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6671106815338135
Epoch: 17, Steps: 17 | Train Loss: 0.134 Vali Loss: 0.778 Vali Acc: 0.827 Test Loss: 0.778 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6339640617370605
Epoch: 18, Steps: 17 | Train Loss: 0.090 Vali Loss: 0.632 Vali Acc: 0.815 Test Loss: 0.632 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.379868507385254
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.669 Vali Acc: 0.832 Test Loss: 0.669 Test Acc: 0.832
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.5547029972076416
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.688 Vali Acc: 0.798 Test Loss: 0.688 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 21 cost time: 1.6400210857391357
Epoch: 21, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.576 Vali Acc: 0.855 Test Loss: 0.576 Test Acc: 0.855
Validation loss decreased (-0.843925 --> -0.855486).  Saving model ...
Epoch: 22 cost time: 1.779905080795288
Epoch: 22, Steps: 17 | Train Loss: 0.011 Vali Loss: 0.792 Vali Acc: 0.792 Test Loss: 0.792 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5921573638916016
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.916 Vali Acc: 0.832 Test Loss: 0.916 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.748997449874878
Epoch: 24, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.732 Vali Acc: 0.815 Test Loss: 0.732 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.7064502239227295
Epoch: 25, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.750 Vali Acc: 0.809 Test Loss: 0.750 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.7000703811645508
Epoch: 26, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.679 Vali Acc: 0.832 Test Loss: 0.679 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.597522497177124
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.701 Vali Acc: 0.827 Test Loss: 0.701 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5636529922485352
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.785 Vali Acc: 0.827 Test Loss: 0.785 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6398875713348389
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.688 Vali Acc: 0.815 Test Loss: 0.688 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6875097751617432
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.761 Vali Acc: 0.827 Test Loss: 0.761 Test Acc: 0.827
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.6730265617370605
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.740 Vali Acc: 0.827 Test Loss: 0.740 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 225411
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.9789352416992188
Epoch: 1, Steps: 17 | Train Loss: 1.937 Vali Loss: 1.768 Vali Acc: 0.289 Test Loss: 1.768 Test Acc: 0.289
Validation loss decreased (inf --> -0.289000).  Saving model ...
Epoch: 2 cost time: 1.7263617515563965
Epoch: 2, Steps: 17 | Train Loss: 1.627 Vali Loss: 1.427 Vali Acc: 0.335 Test Loss: 1.427 Test Acc: 0.335
Validation loss decreased (-0.289000 --> -0.335246).  Saving model ...
Epoch: 3 cost time: 1.776148796081543
Epoch: 3, Steps: 17 | Train Loss: 1.279 Vali Loss: 1.187 Vali Acc: 0.601 Test Loss: 1.187 Test Acc: 0.601
Validation loss decreased (-0.335246 --> -0.601144).  Saving model ...
Epoch: 4 cost time: 2.0249996185302734
Epoch: 4, Steps: 17 | Train Loss: 1.144 Vali Loss: 1.140 Vali Acc: 0.399 Test Loss: 1.140 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.800614356994629
Epoch: 5, Steps: 17 | Train Loss: 0.996 Vali Loss: 1.095 Vali Acc: 0.526 Test Loss: 1.095 Test Acc: 0.526
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7859725952148438
Epoch: 6, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.902 Vali Acc: 0.694 Test Loss: 0.902 Test Acc: 0.694
Validation loss decreased (-0.601144 --> -0.693633).  Saving model ...
Epoch: 7 cost time: 1.5236823558807373
Epoch: 7, Steps: 17 | Train Loss: 0.757 Vali Loss: 0.917 Vali Acc: 0.671 Test Loss: 0.917 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.745427131652832
Epoch: 8, Steps: 17 | Train Loss: 0.628 Vali Loss: 0.756 Vali Acc: 0.723 Test Loss: 0.756 Test Acc: 0.723
Validation loss decreased (-0.693633 --> -0.722536).  Saving model ...
Epoch: 9 cost time: 1.768134355545044
Epoch: 9, Steps: 17 | Train Loss: 0.495 Vali Loss: 0.673 Vali Acc: 0.780 Test Loss: 0.673 Test Acc: 0.780
Validation loss decreased (-0.722536 --> -0.780340).  Saving model ...
Epoch: 10 cost time: 1.6093244552612305
Epoch: 10, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.685 Vali Acc: 0.780 Test Loss: 0.685 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.6879289150238037
Epoch: 11, Steps: 17 | Train Loss: 0.322 Vali Loss: 0.688 Vali Acc: 0.751 Test Loss: 0.688 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 12 cost time: 1.647552490234375
Epoch: 12, Steps: 17 | Train Loss: 0.262 Vali Loss: 0.601 Vali Acc: 0.821 Test Loss: 0.601 Test Acc: 0.821
Validation loss decreased (-0.780340 --> -0.820803).  Saving model ...
Epoch: 13 cost time: 1.8264141082763672
Epoch: 13, Steps: 17 | Train Loss: 0.256 Vali Loss: 0.737 Vali Acc: 0.757 Test Loss: 0.737 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.8359076976776123
Epoch: 14, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.795 Vali Acc: 0.786 Test Loss: 0.795 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6842219829559326
Epoch: 15, Steps: 17 | Train Loss: 0.135 Vali Loss: 0.691 Vali Acc: 0.809 Test Loss: 0.691 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.581540822982788
Epoch: 16, Steps: 17 | Train Loss: 0.073 Vali Loss: 0.641 Vali Acc: 0.809 Test Loss: 0.641 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.6352458000183105
Epoch: 17, Steps: 17 | Train Loss: 0.122 Vali Loss: 0.816 Vali Acc: 0.821 Test Loss: 0.816 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.6506516933441162
Epoch: 18, Steps: 17 | Train Loss: 0.106 Vali Loss: 0.560 Vali Acc: 0.850 Test Loss: 0.560 Test Acc: 0.850
Validation loss decreased (-0.820803 --> -0.849705).  Saving model ...
Epoch: 19 cost time: 1.547351598739624
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.602 Vali Acc: 0.850 Test Loss: 0.602 Test Acc: 0.850
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.546710729598999
Epoch: 20, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.545 Vali Acc: 0.832 Test Loss: 0.545 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.7464678287506104
Epoch: 21, Steps: 17 | Train Loss: 0.023 Vali Loss: 0.578 Vali Acc: 0.850 Test Loss: 0.578 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5851471424102783
Epoch: 22, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.626 Vali Acc: 0.844 Test Loss: 0.626 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4161698818206787
Epoch: 23, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.676 Vali Acc: 0.832 Test Loss: 0.676 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.6136720180511475
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.829 Vali Acc: 0.827 Test Loss: 0.829 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8316268920898438
Epoch: 25, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.723 Vali Acc: 0.815 Test Loss: 0.723 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.6513090133666992
Epoch: 26, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6329600811004639
Epoch: 27, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.673 Vali Acc: 0.850 Test Loss: 0.673 Test Acc: 0.850
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.8345839977264404
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.729 Vali Acc: 0.827 Test Loss: 0.729 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 225411
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.145460844039917
Epoch: 1, Steps: 17 | Train Loss: 1.925 Vali Loss: 1.755 Vali Acc: 0.237 Test Loss: 1.755 Test Acc: 0.237
Validation loss decreased (inf --> -0.236977).  Saving model ...
Epoch: 2 cost time: 1.8459391593933105
Epoch: 2, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.419 Vali Acc: 0.289 Test Loss: 1.419 Test Acc: 0.289
Validation loss decreased (-0.236977 --> -0.289003).  Saving model ...
Epoch: 3 cost time: 1.661872148513794
Epoch: 3, Steps: 17 | Train Loss: 1.294 Vali Loss: 1.175 Vali Acc: 0.584 Test Loss: 1.175 Test Acc: 0.584
Validation loss decreased (-0.289003 --> -0.583803).  Saving model ...
Epoch: 4 cost time: 1.5749456882476807
Epoch: 4, Steps: 17 | Train Loss: 1.172 Vali Loss: 1.143 Vali Acc: 0.399 Test Loss: 1.143 Test Acc: 0.399
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.6343235969543457
Epoch: 5, Steps: 17 | Train Loss: 1.002 Vali Loss: 1.035 Vali Acc: 0.578 Test Loss: 1.035 Test Acc: 0.578
EarlyStopping counter: 2 out of 10
Epoch: 6 cost time: 1.7848081588745117
Epoch: 6, Steps: 17 | Train Loss: 0.900 Vali Loss: 0.895 Vali Acc: 0.676 Test Loss: 0.895 Test Acc: 0.676
Validation loss decreased (-0.583803 --> -0.676292).  Saving model ...
Epoch: 7 cost time: 1.6604244709014893
Epoch: 7, Steps: 17 | Train Loss: 0.779 Vali Loss: 0.988 Vali Acc: 0.630 Test Loss: 0.988 Test Acc: 0.630
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.756756067276001
Epoch: 8, Steps: 17 | Train Loss: 0.682 Vali Loss: 0.777 Vali Acc: 0.728 Test Loss: 0.777 Test Acc: 0.728
Validation loss decreased (-0.676292 --> -0.728316).  Saving model ...
Epoch: 9 cost time: 2.1746020317077637
Epoch: 9, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.750 Vali Acc: 0.717 Test Loss: 0.750 Test Acc: 0.717
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7331290245056152
Epoch: 10, Steps: 17 | Train Loss: 0.466 Vali Loss: 0.704 Vali Acc: 0.728 Test Loss: 0.704 Test Acc: 0.728
Validation loss decreased (-0.728316 --> -0.728317).  Saving model ...
Epoch: 11 cost time: 1.7931416034698486
Epoch: 11, Steps: 17 | Train Loss: 0.361 Vali Loss: 0.735 Vali Acc: 0.757 Test Loss: 0.735 Test Acc: 0.757
Validation loss decreased (-0.728317 --> -0.757218).  Saving model ...
Epoch: 12 cost time: 2.0018632411956787
Epoch: 12, Steps: 17 | Train Loss: 0.344 Vali Loss: 0.686 Vali Acc: 0.757 Test Loss: 0.686 Test Acc: 0.757
Validation loss decreased (-0.757218 --> -0.757219).  Saving model ...
Epoch: 13 cost time: 1.8011972904205322
Epoch: 13, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.751 Vali Acc: 0.798 Test Loss: 0.751 Test Acc: 0.798
Validation loss decreased (-0.757219 --> -0.797680).  Saving model ...
Epoch: 14 cost time: 1.7858998775482178
Epoch: 14, Steps: 17 | Train Loss: 0.252 Vali Loss: 0.735 Vali Acc: 0.792 Test Loss: 0.735 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.8594486713409424
Epoch: 15, Steps: 17 | Train Loss: 0.204 Vali Loss: 1.014 Vali Acc: 0.746 Test Loss: 1.014 Test Acc: 0.746
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 2.1080448627471924
Epoch: 16, Steps: 17 | Train Loss: 0.187 Vali Loss: 0.696 Vali Acc: 0.780 Test Loss: 0.696 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.7917280197143555
Epoch: 17, Steps: 17 | Train Loss: 0.129 Vali Loss: 0.973 Vali Acc: 0.757 Test Loss: 0.973 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.758150339126587
Epoch: 18, Steps: 17 | Train Loss: 0.086 Vali Loss: 0.726 Vali Acc: 0.827 Test Loss: 0.726 Test Acc: 0.827
Validation loss decreased (-0.797680 --> -0.826582).  Saving model ...
Epoch: 19 cost time: 1.769181251525879
Epoch: 19, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.694 Vali Acc: 0.821 Test Loss: 0.694 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7721145153045654
Epoch: 20, Steps: 17 | Train Loss: 0.030 Vali Loss: 0.770 Vali Acc: 0.815 Test Loss: 0.770 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5390594005584717
Epoch: 21, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.979 Vali Acc: 0.809 Test Loss: 0.979 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.5716910362243652
Epoch: 22, Steps: 17 | Train Loss: 0.055 Vali Loss: 0.914 Vali Acc: 0.809 Test Loss: 0.914 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.7196481227874756
Epoch: 23, Steps: 17 | Train Loss: 0.050 Vali Loss: 0.798 Vali Acc: 0.855 Test Loss: 0.798 Test Acc: 0.855
Validation loss decreased (-0.826582 --> -0.855483).  Saving model ...
Epoch: 24 cost time: 1.4825599193572998
Epoch: 24, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.857 Vali Acc: 0.821 Test Loss: 0.857 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5527911186218262
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.999 Vali Acc: 0.815 Test Loss: 0.999 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.6990714073181152
Epoch: 26, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.881 Vali Acc: 0.815 Test Loss: 0.881 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6283636093139648
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.866 Vali Acc: 0.838 Test Loss: 0.866 Test Acc: 0.838
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.6519641876220703
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.831 Vali Acc: 0.827 Test Loss: 0.831 Test Acc: 0.827
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.6827096939086914
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.854 Vali Acc: 0.821 Test Loss: 0.854 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 30 cost time: 1.6006889343261719
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.836 Vali Acc: 0.821 Test Loss: 0.836 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 31 cost time: 1.5595500469207764
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.844 Vali Acc: 0.827 Test Loss: 0.844 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 32 cost time: 1.5268940925598145
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.818 Vali Acc: 0.809 Test Loss: 0.818 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 33 cost time: 1.7279760837554932
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.838 Vali Acc: 0.821 Test Loss: 0.838 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 225411
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               512                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 4.1815104484558105
Epoch: 1, Steps: 17 | Train Loss: 1.918 Vali Loss: 1.826 Vali Acc: 0.266 Test Loss: 1.826 Test Acc: 0.266
Validation loss decreased (inf --> -0.265878).  Saving model ...
Epoch: 2 cost time: 1.7311341762542725
Epoch: 2, Steps: 17 | Train Loss: 1.701 Vali Loss: 1.533 Vali Acc: 0.370 Test Loss: 1.533 Test Acc: 0.370
Validation loss decreased (-0.265878 --> -0.369927).  Saving model ...
Epoch: 3 cost time: 1.6031060218811035
Epoch: 3, Steps: 17 | Train Loss: 1.385 Vali Loss: 1.271 Vali Acc: 0.491 Test Loss: 1.271 Test Acc: 0.491
Validation loss decreased (-0.369927 --> -0.491317).  Saving model ...
Epoch: 4 cost time: 1.844362735748291
Epoch: 4, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.215 Vali Acc: 0.382 Test Loss: 1.215 Test Acc: 0.382
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.8062105178833008
Epoch: 5, Steps: 17 | Train Loss: 1.091 Vali Loss: 1.138 Vali Acc: 0.538 Test Loss: 1.138 Test Acc: 0.538
Validation loss decreased (-0.491317 --> -0.537561).  Saving model ...
Epoch: 6 cost time: 1.7310855388641357
Epoch: 6, Steps: 17 | Train Loss: 0.969 Vali Loss: 1.014 Vali Acc: 0.630 Test Loss: 1.014 Test Acc: 0.630
Validation loss decreased (-0.537561 --> -0.630048).  Saving model ...
Epoch: 7 cost time: 1.8925631046295166
Epoch: 7, Steps: 17 | Train Loss: 0.855 Vali Loss: 1.065 Vali Acc: 0.520 Test Loss: 1.065 Test Acc: 0.520
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.9387106895446777
Epoch: 8, Steps: 17 | Train Loss: 0.784 Vali Loss: 0.908 Vali Acc: 0.607 Test Loss: 0.908 Test Acc: 0.607
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 2.046112298965454
Epoch: 9, Steps: 17 | Train Loss: 0.670 Vali Loss: 0.821 Vali Acc: 0.711 Test Loss: 0.821 Test Acc: 0.711
Validation loss decreased (-0.630048 --> -0.710974).  Saving model ...
Epoch: 10 cost time: 1.8359925746917725
Epoch: 10, Steps: 17 | Train Loss: 0.626 Vali Loss: 0.806 Vali Acc: 0.688 Test Loss: 0.806 Test Acc: 0.688
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.8507730960845947
Epoch: 11, Steps: 17 | Train Loss: 0.509 Vali Loss: 0.782 Vali Acc: 0.723 Test Loss: 0.782 Test Acc: 0.723
Validation loss decreased (-0.710974 --> -0.722536).  Saving model ...
Epoch: 12 cost time: 2.146397352218628
Epoch: 12, Steps: 17 | Train Loss: 0.393 Vali Loss: 0.635 Vali Acc: 0.827 Test Loss: 0.635 Test Acc: 0.827
Validation loss decreased (-0.722536 --> -0.826583).  Saving model ...
Epoch: 13 cost time: 1.843679428100586
Epoch: 13, Steps: 17 | Train Loss: 0.392 Vali Loss: 0.700 Vali Acc: 0.798 Test Loss: 0.700 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.9263744354248047
Epoch: 14, Steps: 17 | Train Loss: 0.281 Vali Loss: 0.765 Vali Acc: 0.723 Test Loss: 0.765 Test Acc: 0.723
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 2.001962900161743
Epoch: 15, Steps: 17 | Train Loss: 0.331 Vali Loss: 0.959 Vali Acc: 0.728 Test Loss: 0.959 Test Acc: 0.728
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.5917291641235352
Epoch: 16, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.749 Vali Acc: 0.728 Test Loss: 0.749 Test Acc: 0.728
EarlyStopping counter: 4 out of 10
Epoch: 17 cost time: 1.7018437385559082
Epoch: 17, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.891 Vali Acc: 0.711 Test Loss: 0.891 Test Acc: 0.711
EarlyStopping counter: 5 out of 10
Epoch: 18 cost time: 1.7754957675933838
Epoch: 18, Steps: 17 | Train Loss: 0.228 Vali Loss: 0.820 Vali Acc: 0.780 Test Loss: 0.820 Test Acc: 0.780
EarlyStopping counter: 6 out of 10
Epoch: 19 cost time: 1.6559717655181885
Epoch: 19, Steps: 17 | Train Loss: 0.128 Vali Loss: 0.690 Vali Acc: 0.775 Test Loss: 0.690 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 20 cost time: 1.6486656665802002
Epoch: 20, Steps: 17 | Train Loss: 0.097 Vali Loss: 0.689 Vali Acc: 0.838 Test Loss: 0.689 Test Acc: 0.838
Validation loss decreased (-0.826583 --> -0.838143).  Saving model ...
Epoch: 21 cost time: 1.9012730121612549
Epoch: 21, Steps: 17 | Train Loss: 0.045 Vali Loss: 0.799 Vali Acc: 0.792 Test Loss: 0.799 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 22 cost time: 1.9257988929748535
Epoch: 22, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.872 Vali Acc: 0.780 Test Loss: 0.872 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 23 cost time: 1.7300069332122803
Epoch: 23, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.762 Vali Acc: 0.832 Test Loss: 0.762 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 24 cost time: 1.7604191303253174
Epoch: 24, Steps: 17 | Train Loss: 0.071 Vali Loss: 0.741 Vali Acc: 0.792 Test Loss: 0.741 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 25 cost time: 1.9923665523529053
Epoch: 25, Steps: 17 | Train Loss: 0.081 Vali Loss: 0.908 Vali Acc: 0.803 Test Loss: 0.908 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 26 cost time: 1.7521438598632812
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.077 Vali Acc: 0.775 Test Loss: 1.077 Test Acc: 0.775
EarlyStopping counter: 6 out of 10
Epoch: 27 cost time: 1.7518424987792969
Epoch: 27, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.819 Vali Acc: 0.809 Test Loss: 0.819 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 28 cost time: 1.7051267623901367
Epoch: 28, Steps: 17 | Train Loss: 0.026 Vali Loss: 1.146 Vali Acc: 0.786 Test Loss: 1.146 Test Acc: 0.786
EarlyStopping counter: 8 out of 10
Epoch: 29 cost time: 1.6567599773406982
Epoch: 29, Steps: 17 | Train Loss: 0.036 Vali Loss: 1.005 Vali Acc: 0.763 Test Loss: 1.005 Test Acc: 0.763
EarlyStopping counter: 9 out of 10
Epoch: 30 cost time: 1.7191758155822754
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.946 Vali Acc: 0.827 Test Loss: 0.946 Test Acc: 0.827
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df512_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 225411
model size : 1.48MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.619293451309204
Epoch: 1, Steps: 17 | Train Loss: 2.001 Vali Loss: 1.791 Vali Acc: 0.243 Test Loss: 1.791 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 1.5955240726470947
Epoch: 2, Steps: 17 | Train Loss: 1.622 Vali Loss: 1.392 Vali Acc: 0.382 Test Loss: 1.392 Test Acc: 0.382
Validation loss decreased (-0.242757 --> -0.381489).  Saving model ...
Epoch: 3 cost time: 1.7236309051513672
Epoch: 3, Steps: 17 | Train Loss: 1.275 Vali Loss: 1.148 Vali Acc: 0.624 Test Loss: 1.148 Test Acc: 0.624
Validation loss decreased (-0.381489 --> -0.624266).  Saving model ...
Epoch: 4 cost time: 1.9285304546356201
Epoch: 4, Steps: 17 | Train Loss: 1.080 Vali Loss: 1.060 Vali Acc: 0.595 Test Loss: 1.060 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 5 cost time: 1.752722978591919
Epoch: 5, Steps: 17 | Train Loss: 0.919 Vali Loss: 0.968 Vali Acc: 0.630 Test Loss: 0.968 Test Acc: 0.630
Validation loss decreased (-0.624266 --> -0.630048).  Saving model ...
Epoch: 6 cost time: 1.7318975925445557
Epoch: 6, Steps: 17 | Train Loss: 0.825 Vali Loss: 0.812 Vali Acc: 0.723 Test Loss: 0.812 Test Acc: 0.723
Validation loss decreased (-0.630048 --> -0.722535).  Saving model ...
Epoch: 7 cost time: 1.7271270751953125
Epoch: 7, Steps: 17 | Train Loss: 0.624 Vali Loss: 0.735 Vali Acc: 0.740 Test Loss: 0.735 Test Acc: 0.740
Validation loss decreased (-0.722535 --> -0.739877).  Saving model ...
Epoch: 8 cost time: 1.6839079856872559
Epoch: 8, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.713 Vali Acc: 0.711 Test Loss: 0.713 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.7900316715240479
Epoch: 9, Steps: 17 | Train Loss: 0.581 Vali Loss: 0.679 Vali Acc: 0.751 Test Loss: 0.679 Test Acc: 0.751
Validation loss decreased (-0.739877 --> -0.751438).  Saving model ...
Epoch: 10 cost time: 2.2048141956329346
Epoch: 10, Steps: 17 | Train Loss: 0.404 Vali Loss: 0.574 Vali Acc: 0.832 Test Loss: 0.574 Test Acc: 0.832
Validation loss decreased (-0.751438 --> -0.832364).  Saving model ...
Epoch: 11 cost time: 1.79036545753479
Epoch: 11, Steps: 17 | Train Loss: 0.419 Vali Loss: 0.925 Vali Acc: 0.676 Test Loss: 0.925 Test Acc: 0.676
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.528677225112915
Epoch: 12, Steps: 17 | Train Loss: 0.310 Vali Loss: 0.557 Vali Acc: 0.821 Test Loss: 0.557 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6780126094818115
Epoch: 13, Steps: 17 | Train Loss: 0.191 Vali Loss: 0.550 Vali Acc: 0.803 Test Loss: 0.550 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.8319222927093506
Epoch: 14, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.639 Vali Acc: 0.769 Test Loss: 0.639 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.7384612560272217
Epoch: 15, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.640 Vali Acc: 0.786 Test Loss: 0.640 Test Acc: 0.786
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.9614150524139404
Epoch: 16, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.469 Vali Acc: 0.844 Test Loss: 0.469 Test Acc: 0.844
Validation loss decreased (-0.832364 --> -0.843926).  Saving model ...
Epoch: 17 cost time: 1.7621197700500488
Epoch: 17, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.578 Vali Acc: 0.792 Test Loss: 0.578 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.8113741874694824
Epoch: 18, Steps: 17 | Train Loss: 0.042 Vali Loss: 0.712 Vali Acc: 0.798 Test Loss: 0.712 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8024451732635498
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.648 Vali Acc: 0.827 Test Loss: 0.648 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.8310942649841309
Epoch: 20, Steps: 17 | Train Loss: 0.034 Vali Loss: 0.645 Vali Acc: 0.844 Test Loss: 0.645 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.8337290287017822
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.790 Vali Acc: 0.809 Test Loss: 0.790 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.9955220222473145
Epoch: 22, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.635 Vali Acc: 0.821 Test Loss: 0.635 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 2.10237717628479
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.770 Vali Acc: 0.815 Test Loss: 0.770 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.730083703994751
Epoch: 24, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.690 Vali Acc: 0.850 Test Loss: 0.690 Test Acc: 0.850
Validation loss decreased (-0.843926 --> -0.849704).  Saving model ...
Epoch: 25 cost time: 1.8369121551513672
Epoch: 25, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.761 Vali Acc: 0.809 Test Loss: 0.761 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.805330514907837
Epoch: 26, Steps: 17 | Train Loss: 0.004 Vali Loss: 0.637 Vali Acc: 0.827 Test Loss: 0.637 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.753843069076538
Epoch: 27, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.724 Vali Acc: 0.832 Test Loss: 0.724 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.7665457725524902
Epoch: 28, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.638 Vali Acc: 0.844 Test Loss: 0.638 Test Acc: 0.844
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.7612345218658447
Epoch: 29, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.683 Vali Acc: 0.832 Test Loss: 0.683 Test Acc: 0.832
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.7261555194854736
Epoch: 30, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.666 Vali Acc: 0.827 Test Loss: 0.666 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.700544834136963
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.624 Vali Acc: 0.850 Test Loss: 0.624 Test Acc: 0.850
Validation loss decreased (-0.849704 --> -0.849705).  Saving model ...
Epoch: 32 cost time: 1.5824337005615234
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.639 Vali Acc: 0.844 Test Loss: 0.639 Test Acc: 0.844
EarlyStopping counter: 1 out of 10
Epoch: 33 cost time: 1.6221973896026611
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.661 Vali Acc: 0.838 Test Loss: 0.661 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 34 cost time: 1.7362380027770996
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.623 Vali Acc: 0.855 Test Loss: 0.623 Test Acc: 0.855
Validation loss decreased (-0.849705 --> -0.855485).  Saving model ...
Epoch: 35 cost time: 1.6782734394073486
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.644 Vali Acc: 0.832 Test Loss: 0.644 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.6899135112762451
Epoch: 36, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.683 Vali Acc: 0.850 Test Loss: 0.683 Test Acc: 0.850
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.727290391921997
Epoch: 37, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.832 Test Loss: 0.698 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.669506311416626
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.680 Vali Acc: 0.827 Test Loss: 0.680 Test Acc: 0.827
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.6781349182128906
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.698 Vali Acc: 0.815 Test Loss: 0.698 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.630950689315796
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.668 Vali Acc: 0.844 Test Loss: 0.668 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5507662296295166
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.682 Vali Acc: 0.850 Test Loss: 0.682 Test Acc: 0.850
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.61053466796875
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.669 Vali Acc: 0.850 Test Loss: 0.669 Test Acc: 0.850
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.8038866519927979
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.660 Vali Acc: 0.844 Test Loss: 0.660 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.7014989852905273
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.688 Vali Acc: 0.844 Test Loss: 0.688 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8554913294797688
model parameter : 209027
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6804404258728027
Epoch: 1, Steps: 17 | Train Loss: 2.007 Vali Loss: 1.814 Vali Acc: 0.208 Test Loss: 1.814 Test Acc: 0.208
Validation loss decreased (inf --> -0.208074).  Saving model ...
Epoch: 2 cost time: 1.6039345264434814
Epoch: 2, Steps: 17 | Train Loss: 1.636 Vali Loss: 1.410 Vali Acc: 0.393 Test Loss: 1.410 Test Acc: 0.393
Validation loss decreased (-0.208074 --> -0.393049).  Saving model ...
Epoch: 3 cost time: 1.5265071392059326
Epoch: 3, Steps: 17 | Train Loss: 1.293 Vali Loss: 1.153 Vali Acc: 0.607 Test Loss: 1.153 Test Acc: 0.607
Validation loss decreased (-0.393049 --> -0.606925).  Saving model ...
Epoch: 4 cost time: 1.5045897960662842
Epoch: 4, Steps: 17 | Train Loss: 1.108 Vali Loss: 1.075 Vali Acc: 0.618 Test Loss: 1.075 Test Acc: 0.618
Validation loss decreased (-0.606925 --> -0.618486).  Saving model ...
Epoch: 5 cost time: 1.6802401542663574
Epoch: 5, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.955 Vali Acc: 0.624 Test Loss: 0.955 Test Acc: 0.624
Validation loss decreased (-0.618486 --> -0.624268).  Saving model ...
Epoch: 6 cost time: 1.6969528198242188
Epoch: 6, Steps: 17 | Train Loss: 0.840 Vali Loss: 0.792 Vali Acc: 0.728 Test Loss: 0.792 Test Acc: 0.728
Validation loss decreased (-0.624268 --> -0.728316).  Saving model ...
Epoch: 7 cost time: 1.7264084815979004
Epoch: 7, Steps: 17 | Train Loss: 0.625 Vali Loss: 0.734 Vali Acc: 0.757 Test Loss: 0.734 Test Acc: 0.757
Validation loss decreased (-0.728316 --> -0.757218).  Saving model ...
Epoch: 8 cost time: 1.5728003978729248
Epoch: 8, Steps: 17 | Train Loss: 0.654 Vali Loss: 0.704 Vali Acc: 0.711 Test Loss: 0.704 Test Acc: 0.711
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.683351755142212
Epoch: 9, Steps: 17 | Train Loss: 0.578 Vali Loss: 0.713 Vali Acc: 0.717 Test Loss: 0.713 Test Acc: 0.717
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.6026558876037598
Epoch: 10, Steps: 17 | Train Loss: 0.407 Vali Loss: 0.577 Vali Acc: 0.844 Test Loss: 0.577 Test Acc: 0.844
Validation loss decreased (-0.757218 --> -0.843925).  Saving model ...
Epoch: 11 cost time: 1.5956058502197266
Epoch: 11, Steps: 17 | Train Loss: 0.446 Vali Loss: 1.016 Vali Acc: 0.665 Test Loss: 1.016 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.6678636074066162
Epoch: 12, Steps: 17 | Train Loss: 0.346 Vali Loss: 0.601 Vali Acc: 0.786 Test Loss: 0.601 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6157052516937256
Epoch: 13, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.571 Vali Acc: 0.809 Test Loss: 0.571 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.5694847106933594
Epoch: 14, Steps: 17 | Train Loss: 0.208 Vali Loss: 0.646 Vali Acc: 0.786 Test Loss: 0.646 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.5933113098144531
Epoch: 15, Steps: 17 | Train Loss: 0.190 Vali Loss: 0.701 Vali Acc: 0.763 Test Loss: 0.701 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.4872360229492188
Epoch: 16, Steps: 17 | Train Loss: 0.112 Vali Loss: 0.615 Vali Acc: 0.815 Test Loss: 0.615 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 17 cost time: 1.687713384628296
Epoch: 17, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.577 Vali Acc: 0.827 Test Loss: 0.577 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 18 cost time: 1.6865997314453125
Epoch: 18, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.560 Vali Acc: 0.809 Test Loss: 0.560 Test Acc: 0.809
EarlyStopping counter: 8 out of 10
Epoch: 19 cost time: 1.6305184364318848
Epoch: 19, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.641 Vali Acc: 0.844 Test Loss: 0.641 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 20 cost time: 1.5939676761627197
Epoch: 20, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.648 Vali Acc: 0.832 Test Loss: 0.648 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 209027
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8167688846588135
Epoch: 1, Steps: 17 | Train Loss: 1.986 Vali Loss: 1.804 Vali Acc: 0.249 Test Loss: 1.804 Test Acc: 0.249
Validation loss decreased (inf --> -0.248537).  Saving model ...
Epoch: 2 cost time: 1.653398036956787
Epoch: 2, Steps: 17 | Train Loss: 1.646 Vali Loss: 1.443 Vali Acc: 0.399 Test Loss: 1.443 Test Acc: 0.399
Validation loss decreased (-0.248537 --> -0.398830).  Saving model ...
Epoch: 3 cost time: 1.6134397983551025
Epoch: 3, Steps: 17 | Train Loss: 1.306 Vali Loss: 1.183 Vali Acc: 0.607 Test Loss: 1.183 Test Acc: 0.607
Validation loss decreased (-0.398830 --> -0.606925).  Saving model ...
Epoch: 4 cost time: 1.6465320587158203
Epoch: 4, Steps: 17 | Train Loss: 1.119 Vali Loss: 1.080 Vali Acc: 0.613 Test Loss: 1.080 Test Acc: 0.613
Validation loss decreased (-0.606925 --> -0.612706).  Saving model ...
Epoch: 5 cost time: 1.600572109222412
Epoch: 5, Steps: 17 | Train Loss: 0.950 Vali Loss: 1.020 Vali Acc: 0.636 Test Loss: 1.020 Test Acc: 0.636
Validation loss decreased (-0.612706 --> -0.635828).  Saving model ...
Epoch: 6 cost time: 1.7199058532714844
Epoch: 6, Steps: 17 | Train Loss: 0.882 Vali Loss: 0.832 Vali Acc: 0.682 Test Loss: 0.832 Test Acc: 0.682
Validation loss decreased (-0.635828 --> -0.682073).  Saving model ...
Epoch: 7 cost time: 1.5999689102172852
Epoch: 7, Steps: 17 | Train Loss: 0.678 Vali Loss: 0.766 Vali Acc: 0.734 Test Loss: 0.766 Test Acc: 0.734
Validation loss decreased (-0.682073 --> -0.734096).  Saving model ...
Epoch: 8 cost time: 1.5282869338989258
Epoch: 8, Steps: 17 | Train Loss: 0.662 Vali Loss: 0.778 Vali Acc: 0.682 Test Loss: 0.778 Test Acc: 0.682
EarlyStopping counter: 1 out of 10
Epoch: 9 cost time: 1.5940256118774414
Epoch: 9, Steps: 17 | Train Loss: 0.595 Vali Loss: 0.714 Vali Acc: 0.711 Test Loss: 0.714 Test Acc: 0.711
EarlyStopping counter: 2 out of 10
Epoch: 10 cost time: 1.5167343616485596
Epoch: 10, Steps: 17 | Train Loss: 0.397 Vali Loss: 0.609 Vali Acc: 0.803 Test Loss: 0.609 Test Acc: 0.803
Validation loss decreased (-0.734096 --> -0.803462).  Saving model ...
Epoch: 11 cost time: 1.462683916091919
Epoch: 11, Steps: 17 | Train Loss: 0.435 Vali Loss: 0.786 Vali Acc: 0.705 Test Loss: 0.786 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.616076946258545
Epoch: 12, Steps: 17 | Train Loss: 0.389 Vali Loss: 0.574 Vali Acc: 0.798 Test Loss: 0.574 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.6742193698883057
Epoch: 13, Steps: 17 | Train Loss: 0.279 Vali Loss: 0.695 Vali Acc: 0.769 Test Loss: 0.695 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 14 cost time: 1.6653482913970947
Epoch: 14, Steps: 17 | Train Loss: 0.284 Vali Loss: 0.769 Vali Acc: 0.751 Test Loss: 0.769 Test Acc: 0.751
EarlyStopping counter: 4 out of 10
Epoch: 15 cost time: 1.6201624870300293
Epoch: 15, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.748 Vali Acc: 0.757 Test Loss: 0.748 Test Acc: 0.757
EarlyStopping counter: 5 out of 10
Epoch: 16 cost time: 1.6385374069213867
Epoch: 16, Steps: 17 | Train Loss: 0.161 Vali Loss: 0.655 Vali Acc: 0.815 Test Loss: 0.655 Test Acc: 0.815
Validation loss decreased (-0.803462 --> -0.815022).  Saving model ...
Epoch: 17 cost time: 1.4405343532562256
Epoch: 17, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.652 Vali Acc: 0.832 Test Loss: 0.652 Test Acc: 0.832
Validation loss decreased (-0.815022 --> -0.832363).  Saving model ...
Epoch: 18 cost time: 1.6252083778381348
Epoch: 18, Steps: 17 | Train Loss: 0.089 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 19 cost time: 1.6629977226257324
Epoch: 19, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.710 Vali Acc: 0.821 Test Loss: 0.710 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 20 cost time: 1.7403619289398193
Epoch: 20, Steps: 17 | Train Loss: 0.069 Vali Loss: 0.838 Vali Acc: 0.827 Test Loss: 0.838 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 21 cost time: 1.5548200607299805
Epoch: 21, Steps: 17 | Train Loss: 0.037 Vali Loss: 0.720 Vali Acc: 0.832 Test Loss: 0.720 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 22 cost time: 1.6495957374572754
Epoch: 22, Steps: 17 | Train Loss: 0.058 Vali Loss: 0.777 Vali Acc: 0.821 Test Loss: 0.777 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 23 cost time: 1.6463747024536133
Epoch: 23, Steps: 17 | Train Loss: 0.061 Vali Loss: 0.743 Vali Acc: 0.832 Test Loss: 0.743 Test Acc: 0.832
EarlyStopping counter: 6 out of 10
Epoch: 24 cost time: 1.7556614875793457
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.767 Vali Acc: 0.827 Test Loss: 0.767 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 25 cost time: 1.7792890071868896
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.782 Vali Acc: 0.827 Test Loss: 0.782 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 26 cost time: 1.5494778156280518
Epoch: 26, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
Validation loss decreased (-0.832363 --> -0.843924).  Saving model ...
Epoch: 27 cost time: 1.659529209136963
Epoch: 27, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.713 Vali Acc: 0.832 Test Loss: 0.713 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.619347095489502
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.704 Vali Acc: 0.838 Test Loss: 0.704 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.5652282238006592
Epoch: 29, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.716 Vali Acc: 0.832 Test Loss: 0.716 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6519138813018799
Epoch: 30, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.730 Vali Acc: 0.803 Test Loss: 0.730 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.7574889659881592
Epoch: 31, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.867 Vali Acc: 0.803 Test Loss: 0.867 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.6248927116394043
Epoch: 32, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.806 Vali Acc: 0.809 Test Loss: 0.806 Test Acc: 0.809
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6335008144378662
Epoch: 33, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.782 Vali Acc: 0.827 Test Loss: 0.782 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5945627689361572
Epoch: 34, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.757 Vali Acc: 0.838 Test Loss: 0.757 Test Acc: 0.838
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.7391631603240967
Epoch: 35, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.782 Vali Acc: 0.832 Test Loss: 0.782 Test Acc: 0.832
EarlyStopping counter: 9 out of 10
Epoch: 36 cost time: 1.8089790344238281
Epoch: 36, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.825 Vali Acc: 0.821 Test Loss: 0.825 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 209027
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               256                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6510517597198486
Epoch: 1, Steps: 17 | Train Loss: 1.961 Vali Loss: 1.831 Vali Acc: 0.237 Test Loss: 1.831 Test Acc: 0.237
Validation loss decreased (inf --> -0.236976).  Saving model ...
Epoch: 2 cost time: 1.7617802619934082
Epoch: 2, Steps: 17 | Train Loss: 1.699 Vali Loss: 1.542 Vali Acc: 0.329 Test Loss: 1.542 Test Acc: 0.329
Validation loss decreased (-0.236976 --> -0.329464).  Saving model ...
Epoch: 3 cost time: 1.5976431369781494
Epoch: 3, Steps: 17 | Train Loss: 1.410 Vali Loss: 1.308 Vali Acc: 0.474 Test Loss: 1.308 Test Acc: 0.474
Validation loss decreased (-0.329464 --> -0.473975).  Saving model ...
Epoch: 4 cost time: 1.5254247188568115
Epoch: 4, Steps: 17 | Train Loss: 1.212 Vali Loss: 1.186 Vali Acc: 0.526 Test Loss: 1.186 Test Acc: 0.526
Validation loss decreased (-0.473975 --> -0.526000).  Saving model ...
Epoch: 5 cost time: 1.5786492824554443
Epoch: 5, Steps: 17 | Train Loss: 1.033 Vali Loss: 1.137 Vali Acc: 0.566 Test Loss: 1.137 Test Acc: 0.566
Validation loss decreased (-0.526000 --> -0.566463).  Saving model ...
Epoch: 6 cost time: 1.6266841888427734
Epoch: 6, Steps: 17 | Train Loss: 1.006 Vali Loss: 0.942 Vali Acc: 0.671 Test Loss: 0.942 Test Acc: 0.671
Validation loss decreased (-0.566463 --> -0.670511).  Saving model ...
Epoch: 7 cost time: 1.68100905418396
Epoch: 7, Steps: 17 | Train Loss: 0.810 Vali Loss: 0.888 Vali Acc: 0.671 Test Loss: 0.888 Test Acc: 0.671
Validation loss decreased (-0.670511 --> -0.670511).  Saving model ...
Epoch: 8 cost time: 1.6551227569580078
Epoch: 8, Steps: 17 | Train Loss: 0.764 Vali Loss: 0.836 Vali Acc: 0.682 Test Loss: 0.836 Test Acc: 0.682
Validation loss decreased (-0.670511 --> -0.682073).  Saving model ...
Epoch: 9 cost time: 1.7041256427764893
Epoch: 9, Steps: 17 | Train Loss: 0.716 Vali Loss: 0.822 Vali Acc: 0.671 Test Loss: 0.822 Test Acc: 0.671
EarlyStopping counter: 1 out of 10
Epoch: 10 cost time: 1.7756400108337402
Epoch: 10, Steps: 17 | Train Loss: 0.574 Vali Loss: 0.794 Vali Acc: 0.688 Test Loss: 0.794 Test Acc: 0.688
Validation loss decreased (-0.682073 --> -0.687853).  Saving model ...
Epoch: 11 cost time: 1.6301651000976562
Epoch: 11, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.951 Vali Acc: 0.659 Test Loss: 0.951 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5746963024139404
Epoch: 12, Steps: 17 | Train Loss: 0.516 Vali Loss: 0.636 Vali Acc: 0.780 Test Loss: 0.636 Test Acc: 0.780
Validation loss decreased (-0.687853 --> -0.780340).  Saving model ...
Epoch: 13 cost time: 1.5838773250579834
Epoch: 13, Steps: 17 | Train Loss: 0.362 Vali Loss: 0.624 Vali Acc: 0.786 Test Loss: 0.624 Test Acc: 0.786
Validation loss decreased (-0.780340 --> -0.786121).  Saving model ...
Epoch: 14 cost time: 1.5946691036224365
Epoch: 14, Steps: 17 | Train Loss: 0.334 Vali Loss: 0.742 Vali Acc: 0.757 Test Loss: 0.742 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5799434185028076
Epoch: 15, Steps: 17 | Train Loss: 0.261 Vali Loss: 0.684 Vali Acc: 0.751 Test Loss: 0.684 Test Acc: 0.751
EarlyStopping counter: 2 out of 10
Epoch: 16 cost time: 1.52152681350708
Epoch: 16, Steps: 17 | Train Loss: 0.239 Vali Loss: 0.690 Vali Acc: 0.763 Test Loss: 0.690 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 17 cost time: 1.490365743637085
Epoch: 17, Steps: 17 | Train Loss: 0.147 Vali Loss: 0.761 Vali Acc: 0.757 Test Loss: 0.761 Test Acc: 0.757
EarlyStopping counter: 4 out of 10
Epoch: 18 cost time: 1.5849339962005615
Epoch: 18, Steps: 17 | Train Loss: 0.255 Vali Loss: 0.790 Vali Acc: 0.780 Test Loss: 0.790 Test Acc: 0.780
EarlyStopping counter: 5 out of 10
Epoch: 19 cost time: 1.489539384841919
Epoch: 19, Steps: 17 | Train Loss: 0.142 Vali Loss: 0.659 Vali Acc: 0.809 Test Loss: 0.659 Test Acc: 0.809
Validation loss decreased (-0.786121 --> -0.809242).  Saving model ...
Epoch: 20 cost time: 1.5679454803466797
Epoch: 20, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.772 Vali Acc: 0.786 Test Loss: 0.772 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 21 cost time: 1.7105872631072998
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.694 Vali Acc: 0.786 Test Loss: 0.694 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 22 cost time: 1.5789594650268555
Epoch: 22, Steps: 17 | Train Loss: 0.082 Vali Loss: 0.740 Vali Acc: 0.792 Test Loss: 0.740 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 23 cost time: 1.5635430812835693
Epoch: 23, Steps: 17 | Train Loss: 0.099 Vali Loss: 0.843 Vali Acc: 0.780 Test Loss: 0.843 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 24 cost time: 1.5620946884155273
Epoch: 24, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.788 Vali Acc: 0.769 Test Loss: 0.788 Test Acc: 0.769
EarlyStopping counter: 5 out of 10
Epoch: 25 cost time: 1.5836448669433594
Epoch: 25, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.794 Vali Acc: 0.798 Test Loss: 0.794 Test Acc: 0.798
EarlyStopping counter: 6 out of 10
Epoch: 26 cost time: 1.5936846733093262
Epoch: 26, Steps: 17 | Train Loss: 0.059 Vali Loss: 0.811 Vali Acc: 0.803 Test Loss: 0.811 Test Acc: 0.803
EarlyStopping counter: 7 out of 10
Epoch: 27 cost time: 1.6126785278320312
Epoch: 27, Steps: 17 | Train Loss: 0.034 Vali Loss: 1.070 Vali Acc: 0.798 Test Loss: 1.070 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 28 cost time: 1.623403787612915
Epoch: 28, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.930 Vali Acc: 0.815 Test Loss: 0.930 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815020).  Saving model ...
Epoch: 29 cost time: 1.5467100143432617
Epoch: 29, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.809 Vali Acc: 0.792 Test Loss: 0.809 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 30 cost time: 1.5287888050079346
Epoch: 30, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.800 Vali Acc: 0.827 Test Loss: 0.800 Test Acc: 0.827
Validation loss decreased (-0.815020 --> -0.826582).  Saving model ...
Epoch: 31 cost time: 1.5119764804840088
Epoch: 31, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.793 Vali Acc: 0.821 Test Loss: 0.793 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 32 cost time: 1.565103530883789
Epoch: 32, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.794 Vali Acc: 0.809 Test Loss: 0.794 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 33 cost time: 1.5821466445922852
Epoch: 33, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.821 Vali Acc: 0.821 Test Loss: 0.821 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 34 cost time: 1.69071364402771
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.821 Vali Acc: 0.821 Test Loss: 0.821 Test Acc: 0.821
EarlyStopping counter: 4 out of 10
Epoch: 35 cost time: 1.6348586082458496
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.919 Vali Acc: 0.803 Test Loss: 0.919 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 36 cost time: 1.5488543510437012
Epoch: 36, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.876 Vali Acc: 0.821 Test Loss: 0.876 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 37 cost time: 1.6753082275390625
Epoch: 37, Steps: 17 | Train Loss: 0.095 Vali Loss: 1.258 Vali Acc: 0.757 Test Loss: 1.258 Test Acc: 0.757
EarlyStopping counter: 7 out of 10
Epoch: 38 cost time: 1.523298978805542
Epoch: 38, Steps: 17 | Train Loss: 0.049 Vali Loss: 1.539 Vali Acc: 0.740 Test Loss: 1.539 Test Acc: 0.740
EarlyStopping counter: 8 out of 10
Epoch: 39 cost time: 1.8379037380218506
Epoch: 39, Steps: 17 | Train Loss: 0.054 Vali Loss: 1.140 Vali Acc: 0.821 Test Loss: 1.140 Test Acc: 0.821
EarlyStopping counter: 9 out of 10
Epoch: 40 cost time: 1.6639430522918701
Epoch: 40, Steps: 17 | Train Loss: 0.035 Vali Loss: 1.668 Vali Acc: 0.786 Test Loss: 1.668 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df256_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 209027
model size : 1.42MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.917083501815796
Epoch: 1, Steps: 17 | Train Loss: 1.982 Vali Loss: 1.787 Vali Acc: 0.301 Test Loss: 1.787 Test Acc: 0.301
Validation loss decreased (inf --> -0.300560).  Saving model ...
Epoch: 2 cost time: 1.8215789794921875
Epoch: 2, Steps: 17 | Train Loss: 1.631 Vali Loss: 1.501 Vali Acc: 0.376 Test Loss: 1.501 Test Acc: 0.376
Validation loss decreased (-0.300560 --> -0.375708).  Saving model ...
Epoch: 3 cost time: 1.5314817428588867
Epoch: 3, Steps: 17 | Train Loss: 1.281 Vali Loss: 1.185 Vali Acc: 0.520 Test Loss: 1.185 Test Acc: 0.520
Validation loss decreased (-0.375708 --> -0.520219).  Saving model ...
Epoch: 4 cost time: 1.6005618572235107
Epoch: 4, Steps: 17 | Train Loss: 1.013 Vali Loss: 0.980 Vali Acc: 0.636 Test Loss: 0.980 Test Acc: 0.636
Validation loss decreased (-0.520219 --> -0.635828).  Saving model ...
Epoch: 5 cost time: 1.5015876293182373
Epoch: 5, Steps: 17 | Train Loss: 0.854 Vali Loss: 0.878 Vali Acc: 0.688 Test Loss: 0.878 Test Acc: 0.688
Validation loss decreased (-0.635828 --> -0.687852).  Saving model ...
Epoch: 6 cost time: 1.702735185623169
Epoch: 6, Steps: 17 | Train Loss: 0.709 Vali Loss: 0.803 Vali Acc: 0.688 Test Loss: 0.803 Test Acc: 0.688
Validation loss decreased (-0.687852 --> -0.687853).  Saving model ...
Epoch: 7 cost time: 1.677344560623169
Epoch: 7, Steps: 17 | Train Loss: 0.601 Vali Loss: 0.890 Vali Acc: 0.659 Test Loss: 0.890 Test Acc: 0.659
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6037113666534424
Epoch: 8, Steps: 17 | Train Loss: 0.619 Vali Loss: 0.816 Vali Acc: 0.676 Test Loss: 0.816 Test Acc: 0.676
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5803320407867432
Epoch: 9, Steps: 17 | Train Loss: 0.552 Vali Loss: 0.718 Vali Acc: 0.769 Test Loss: 0.718 Test Acc: 0.769
Validation loss decreased (-0.687853 --> -0.768779).  Saving model ...
Epoch: 10 cost time: 1.576399326324463
Epoch: 10, Steps: 17 | Train Loss: 0.532 Vali Loss: 0.673 Vali Acc: 0.792 Test Loss: 0.673 Test Acc: 0.792
Validation loss decreased (-0.768779 --> -0.791901).  Saving model ...
Epoch: 11 cost time: 1.4815423488616943
Epoch: 11, Steps: 17 | Train Loss: 0.343 Vali Loss: 0.616 Vali Acc: 0.798 Test Loss: 0.616 Test Acc: 0.798
Validation loss decreased (-0.791901 --> -0.797682).  Saving model ...
Epoch: 12 cost time: 1.4760992527008057
Epoch: 12, Steps: 17 | Train Loss: 0.308 Vali Loss: 0.581 Vali Acc: 0.809 Test Loss: 0.581 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809243).  Saving model ...
Epoch: 13 cost time: 1.619617223739624
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.619 Vali Acc: 0.809 Test Loss: 0.619 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.5767295360565186
Epoch: 14, Steps: 17 | Train Loss: 0.169 Vali Loss: 0.648 Vali Acc: 0.798 Test Loss: 0.648 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.6654963493347168
Epoch: 15, Steps: 17 | Train Loss: 0.116 Vali Loss: 0.584 Vali Acc: 0.821 Test Loss: 0.584 Test Acc: 0.821
Validation loss decreased (-0.809243 --> -0.820803).  Saving model ...
Epoch: 16 cost time: 1.5094482898712158
Epoch: 16, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.764 Vali Acc: 0.798 Test Loss: 0.764 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.4986603260040283
Epoch: 17, Steps: 17 | Train Loss: 0.072 Vali Loss: 0.763 Vali Acc: 0.769 Test Loss: 0.763 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.4474904537200928
Epoch: 18, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.593 Vali Acc: 0.844 Test Loss: 0.593 Test Acc: 0.844
Validation loss decreased (-0.820803 --> -0.843925).  Saving model ...
Epoch: 19 cost time: 1.4454572200775146
Epoch: 19, Steps: 17 | Train Loss: 0.044 Vali Loss: 0.701 Vali Acc: 0.798 Test Loss: 0.701 Test Acc: 0.798
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6362457275390625
Epoch: 20, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.695 Vali Acc: 0.844 Test Loss: 0.695 Test Acc: 0.844
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.5898146629333496
Epoch: 21, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.672 Vali Acc: 0.832 Test Loss: 0.672 Test Acc: 0.832
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.441847562789917
Epoch: 22, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.754 Vali Acc: 0.792 Test Loss: 0.754 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.4643723964691162
Epoch: 23, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.798 Vali Acc: 0.809 Test Loss: 0.798 Test Acc: 0.809
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.551448106765747
Epoch: 24, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.720 Vali Acc: 0.827 Test Loss: 0.720 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.5969200134277344
Epoch: 25, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.825 Vali Acc: 0.827 Test Loss: 0.825 Test Acc: 0.827
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.542494535446167
Epoch: 26, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.830 Vali Acc: 0.827 Test Loss: 0.830 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.5944099426269531
Epoch: 27, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.715 Vali Acc: 0.838 Test Loss: 0.715 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6658568382263184
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.732 Vali Acc: 0.832 Test Loss: 0.732 Test Acc: 0.832
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8439306358381503
model parameter : 200835
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.8231892585754395
Epoch: 1, Steps: 17 | Train Loss: 1.980 Vali Loss: 1.790 Vali Acc: 0.272 Test Loss: 1.790 Test Acc: 0.272
Validation loss decreased (inf --> -0.271658).  Saving model ...
Epoch: 2 cost time: 1.5609569549560547
Epoch: 2, Steps: 17 | Train Loss: 1.644 Vali Loss: 1.495 Vali Acc: 0.399 Test Loss: 1.495 Test Acc: 0.399
Validation loss decreased (-0.271658 --> -0.398829).  Saving model ...
Epoch: 3 cost time: 1.541783094406128
Epoch: 3, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.197 Vali Acc: 0.549 Test Loss: 1.197 Test Acc: 0.549
Validation loss decreased (-0.398829 --> -0.549121).  Saving model ...
Epoch: 4 cost time: 1.8898117542266846
Epoch: 4, Steps: 17 | Train Loss: 1.027 Vali Loss: 0.983 Vali Acc: 0.642 Test Loss: 0.983 Test Acc: 0.642
Validation loss decreased (-0.549121 --> -0.641609).  Saving model ...
Epoch: 5 cost time: 1.6055302619934082
Epoch: 5, Steps: 17 | Train Loss: 0.880 Vali Loss: 0.881 Vali Acc: 0.676 Test Loss: 0.881 Test Acc: 0.676
Validation loss decreased (-0.641609 --> -0.676292).  Saving model ...
Epoch: 6 cost time: 1.7408981323242188
Epoch: 6, Steps: 17 | Train Loss: 0.722 Vali Loss: 0.824 Vali Acc: 0.665 Test Loss: 0.824 Test Acc: 0.665
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.7219650745391846
Epoch: 7, Steps: 17 | Train Loss: 0.652 Vali Loss: 0.953 Vali Acc: 0.630 Test Loss: 0.953 Test Acc: 0.630
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.685642957687378
Epoch: 8, Steps: 17 | Train Loss: 0.632 Vali Loss: 0.810 Vali Acc: 0.682 Test Loss: 0.810 Test Acc: 0.682
Validation loss decreased (-0.676292 --> -0.682073).  Saving model ...
Epoch: 9 cost time: 1.8790531158447266
Epoch: 9, Steps: 17 | Train Loss: 0.572 Vali Loss: 0.758 Vali Acc: 0.728 Test Loss: 0.758 Test Acc: 0.728
Validation loss decreased (-0.682073 --> -0.728316).  Saving model ...
Epoch: 10 cost time: 1.7706372737884521
Epoch: 10, Steps: 17 | Train Loss: 0.534 Vali Loss: 0.640 Vali Acc: 0.775 Test Loss: 0.640 Test Acc: 0.775
Validation loss decreased (-0.728316 --> -0.774560).  Saving model ...
Epoch: 11 cost time: 1.7770724296569824
Epoch: 11, Steps: 17 | Train Loss: 0.350 Vali Loss: 0.588 Vali Acc: 0.792 Test Loss: 0.588 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791902).  Saving model ...
Epoch: 12 cost time: 1.7395293712615967
Epoch: 12, Steps: 17 | Train Loss: 0.351 Vali Loss: 0.632 Vali Acc: 0.780 Test Loss: 0.632 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.6199750900268555
Epoch: 13, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.649 Vali Acc: 0.775 Test Loss: 0.649 Test Acc: 0.775
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.7393486499786377
Epoch: 14, Steps: 17 | Train Loss: 0.183 Vali Loss: 0.642 Vali Acc: 0.786 Test Loss: 0.642 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 15 cost time: 1.8037869930267334
Epoch: 15, Steps: 17 | Train Loss: 0.143 Vali Loss: 0.571 Vali Acc: 0.827 Test Loss: 0.571 Test Acc: 0.827
Validation loss decreased (-0.791902 --> -0.826584).  Saving model ...
Epoch: 16 cost time: 1.7010912895202637
Epoch: 16, Steps: 17 | Train Loss: 0.126 Vali Loss: 0.878 Vali Acc: 0.769 Test Loss: 0.878 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.556302547454834
Epoch: 17, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.755 Vali Acc: 0.792 Test Loss: 0.755 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.7556633949279785
Epoch: 18, Steps: 17 | Train Loss: 0.064 Vali Loss: 0.626 Vali Acc: 0.809 Test Loss: 0.626 Test Acc: 0.809
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.9083771705627441
Epoch: 19, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.699 Vali Acc: 0.815 Test Loss: 0.699 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6326777935028076
Epoch: 20, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.647 Vali Acc: 0.815 Test Loss: 0.647 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.8855805397033691
Epoch: 21, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.719 Vali Acc: 0.803 Test Loss: 0.719 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.7979621887207031
Epoch: 22, Steps: 17 | Train Loss: 0.024 Vali Loss: 0.798 Vali Acc: 0.815 Test Loss: 0.798 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.5986013412475586
Epoch: 23, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.769 Vali Acc: 0.803 Test Loss: 0.769 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.637113094329834
Epoch: 24, Steps: 17 | Train Loss: 0.031 Vali Loss: 0.816 Vali Acc: 0.850 Test Loss: 0.816 Test Acc: 0.850
Validation loss decreased (-0.826584 --> -0.849703).  Saving model ...
Epoch: 25 cost time: 1.6406986713409424
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.693 Vali Acc: 0.821 Test Loss: 0.693 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.7128796577453613
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.861 Vali Acc: 0.838 Test Loss: 0.861 Test Acc: 0.838
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 2.0122146606445312
Epoch: 27, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.889 Vali Acc: 0.798 Test Loss: 0.889 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.5856659412384033
Epoch: 28, Steps: 17 | Train Loss: 0.031 Vali Loss: 1.394 Vali Acc: 0.769 Test Loss: 1.394 Test Acc: 0.769
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.5392100811004639
Epoch: 29, Steps: 17 | Train Loss: 0.057 Vali Loss: 1.031 Vali Acc: 0.803 Test Loss: 1.031 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.6527745723724365
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.839 Vali Acc: 0.844 Test Loss: 0.839 Test Acc: 0.844
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.9318842887878418
Epoch: 31, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.863 Vali Acc: 0.815 Test Loss: 0.863 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.7277066707611084
Epoch: 32, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.754 Vali Acc: 0.827 Test Loss: 0.754 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.6835448741912842
Epoch: 33, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.868 Vali Acc: 0.838 Test Loss: 0.868 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.593674659729004
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.164 Vali Acc: 0.809 Test Loss: 1.164 Test Acc: 0.809
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8497109826589595
model parameter : 200835
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6907970905303955
Epoch: 1, Steps: 17 | Train Loss: 1.972 Vali Loss: 1.808 Vali Acc: 0.243 Test Loss: 1.808 Test Acc: 0.243
Validation loss decreased (inf --> -0.242756).  Saving model ...
Epoch: 2 cost time: 1.4763753414154053
Epoch: 2, Steps: 17 | Train Loss: 1.653 Vali Loss: 1.533 Vali Acc: 0.341 Test Loss: 1.533 Test Acc: 0.341
Validation loss decreased (-0.242756 --> -0.341025).  Saving model ...
Epoch: 3 cost time: 1.605879306793213
Epoch: 3, Steps: 17 | Train Loss: 1.342 Vali Loss: 1.226 Vali Acc: 0.445 Test Loss: 1.226 Test Acc: 0.445
Validation loss decreased (-0.341025 --> -0.445074).  Saving model ...
Epoch: 4 cost time: 1.5748178958892822
Epoch: 4, Steps: 17 | Train Loss: 1.052 Vali Loss: 1.015 Vali Acc: 0.647 Test Loss: 1.015 Test Acc: 0.647
Validation loss decreased (-0.445074 --> -0.647389).  Saving model ...
Epoch: 5 cost time: 1.5014369487762451
Epoch: 5, Steps: 17 | Train Loss: 0.915 Vali Loss: 0.925 Vali Acc: 0.642 Test Loss: 0.925 Test Acc: 0.642
EarlyStopping counter: 1 out of 10
Epoch: 6 cost time: 1.474630355834961
Epoch: 6, Steps: 17 | Train Loss: 0.738 Vali Loss: 0.874 Vali Acc: 0.653 Test Loss: 0.874 Test Acc: 0.653
Validation loss decreased (-0.647389 --> -0.653170).  Saving model ...
Epoch: 7 cost time: 1.455902099609375
Epoch: 7, Steps: 17 | Train Loss: 0.696 Vali Loss: 1.001 Vali Acc: 0.595 Test Loss: 1.001 Test Acc: 0.595
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6054060459136963
Epoch: 8, Steps: 17 | Train Loss: 0.674 Vali Loss: 0.989 Vali Acc: 0.595 Test Loss: 0.989 Test Acc: 0.595
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.5080540180206299
Epoch: 9, Steps: 17 | Train Loss: 0.634 Vali Loss: 0.828 Vali Acc: 0.618 Test Loss: 0.828 Test Acc: 0.618
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.523195505142212
Epoch: 10, Steps: 17 | Train Loss: 0.579 Vali Loss: 0.664 Vali Acc: 0.763 Test Loss: 0.664 Test Acc: 0.763
Validation loss decreased (-0.653170 --> -0.762999).  Saving model ...
Epoch: 11 cost time: 1.5219709873199463
Epoch: 11, Steps: 17 | Train Loss: 0.418 Vali Loss: 0.656 Vali Acc: 0.757 Test Loss: 0.656 Test Acc: 0.757
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.4300692081451416
Epoch: 12, Steps: 17 | Train Loss: 0.422 Vali Loss: 0.703 Vali Acc: 0.757 Test Loss: 0.703 Test Acc: 0.757
EarlyStopping counter: 2 out of 10
Epoch: 13 cost time: 1.438371181488037
Epoch: 13, Steps: 17 | Train Loss: 0.301 Vali Loss: 0.675 Vali Acc: 0.803 Test Loss: 0.675 Test Acc: 0.803
Validation loss decreased (-0.762999 --> -0.803461).  Saving model ...
Epoch: 14 cost time: 1.4478130340576172
Epoch: 14, Steps: 17 | Train Loss: 0.248 Vali Loss: 0.779 Vali Acc: 0.705 Test Loss: 0.779 Test Acc: 0.705
EarlyStopping counter: 1 out of 10
Epoch: 15 cost time: 1.5092203617095947
Epoch: 15, Steps: 17 | Train Loss: 0.184 Vali Loss: 0.625 Vali Acc: 0.809 Test Loss: 0.625 Test Acc: 0.809
Validation loss decreased (-0.803461 --> -0.809242).  Saving model ...
Epoch: 16 cost time: 1.49076509475708
Epoch: 16, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.921 Vali Acc: 0.734 Test Loss: 0.921 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 17 cost time: 1.5885393619537354
Epoch: 17, Steps: 17 | Train Loss: 0.146 Vali Loss: 0.862 Vali Acc: 0.734 Test Loss: 0.862 Test Acc: 0.734
EarlyStopping counter: 2 out of 10
Epoch: 18 cost time: 1.5731375217437744
Epoch: 18, Steps: 17 | Train Loss: 0.137 Vali Loss: 0.612 Vali Acc: 0.780 Test Loss: 0.612 Test Acc: 0.780
EarlyStopping counter: 3 out of 10
Epoch: 19 cost time: 1.5274043083190918
Epoch: 19, Steps: 17 | Train Loss: 0.144 Vali Loss: 1.075 Vali Acc: 0.688 Test Loss: 1.075 Test Acc: 0.688
EarlyStopping counter: 4 out of 10
Epoch: 20 cost time: 1.6148524284362793
Epoch: 20, Steps: 17 | Train Loss: 0.127 Vali Loss: 0.920 Vali Acc: 0.763 Test Loss: 0.920 Test Acc: 0.763
EarlyStopping counter: 5 out of 10
Epoch: 21 cost time: 1.5754039287567139
Epoch: 21, Steps: 17 | Train Loss: 0.052 Vali Loss: 0.707 Vali Acc: 0.786 Test Loss: 0.707 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 22 cost time: 1.6021780967712402
Epoch: 22, Steps: 17 | Train Loss: 0.033 Vali Loss: 0.886 Vali Acc: 0.786 Test Loss: 0.886 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 23 cost time: 1.4419009685516357
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 1.027 Vali Acc: 0.798 Test Loss: 1.027 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 24 cost time: 1.5656278133392334
Epoch: 24, Steps: 17 | Train Loss: 0.041 Vali Loss: 0.697 Vali Acc: 0.815 Test Loss: 0.697 Test Acc: 0.815
Validation loss decreased (-0.809242 --> -0.815022).  Saving model ...
Epoch: 25 cost time: 1.5233018398284912
Epoch: 25, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.942 Vali Acc: 0.780 Test Loss: 0.942 Test Acc: 0.780
EarlyStopping counter: 1 out of 10
Epoch: 26 cost time: 1.5307714939117432
Epoch: 26, Steps: 17 | Train Loss: 0.012 Vali Loss: 1.071 Vali Acc: 0.780 Test Loss: 1.071 Test Acc: 0.780
EarlyStopping counter: 2 out of 10
Epoch: 27 cost time: 1.653977870941162
Epoch: 27, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.896 Vali Acc: 0.792 Test Loss: 0.896 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 28 cost time: 1.6515660285949707
Epoch: 28, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.933 Vali Acc: 0.809 Test Loss: 0.933 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 29 cost time: 1.676274061203003
Epoch: 29, Steps: 17 | Train Loss: 0.024 Vali Loss: 1.077 Vali Acc: 0.775 Test Loss: 1.077 Test Acc: 0.775
EarlyStopping counter: 5 out of 10
Epoch: 30 cost time: 1.4837160110473633
Epoch: 30, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.968 Vali Acc: 0.786 Test Loss: 0.968 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 31 cost time: 1.5838000774383545
Epoch: 31, Steps: 17 | Train Loss: 0.025 Vali Loss: 1.181 Vali Acc: 0.775 Test Loss: 1.181 Test Acc: 0.775
EarlyStopping counter: 7 out of 10
Epoch: 32 cost time: 1.5274591445922852
Epoch: 32, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.950 Vali Acc: 0.815 Test Loss: 0.950 Test Acc: 0.815
EarlyStopping counter: 8 out of 10
Epoch: 33 cost time: 1.5631625652313232
Epoch: 33, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.932 Vali Acc: 0.798 Test Loss: 0.932 Test Acc: 0.798
EarlyStopping counter: 9 out of 10
Epoch: 34 cost time: 1.5404314994812012
Epoch: 34, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.965 Vali Acc: 0.827 Test Loss: 0.965 Test Acc: 0.827
Validation loss decreased (-0.815022 --> -0.826580).  Saving model ...
Epoch: 35 cost time: 1.5875115394592285
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 1.126 Vali Acc: 0.803 Test Loss: 1.126 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 36 cost time: 1.5881567001342773
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 1.035 Vali Acc: 0.815 Test Loss: 1.035 Test Acc: 0.815
EarlyStopping counter: 2 out of 10
Epoch: 37 cost time: 1.5905954837799072
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.977 Vali Acc: 0.798 Test Loss: 0.977 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 38 cost time: 1.5104682445526123
Epoch: 38, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.975 Vali Acc: 0.803 Test Loss: 0.975 Test Acc: 0.803
EarlyStopping counter: 4 out of 10
Epoch: 39 cost time: 1.4708914756774902
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.024 Vali Acc: 0.803 Test Loss: 1.024 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 40 cost time: 1.6155190467834473
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.033 Vali Acc: 0.786 Test Loss: 1.033 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 41 cost time: 1.5952436923980713
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.020 Vali Acc: 0.786 Test Loss: 1.020 Test Acc: 0.786
EarlyStopping counter: 7 out of 10
Epoch: 42 cost time: 1.554943561553955
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.060 Vali Acc: 0.803 Test Loss: 1.060 Test Acc: 0.803
EarlyStopping counter: 8 out of 10
Epoch: 43 cost time: 1.5838415622711182
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.071 Vali Acc: 0.803 Test Loss: 1.071 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 44 cost time: 1.6483488082885742
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 1.075 Vali Acc: 0.786 Test Loss: 1.075 Test Acc: 0.786
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8265895953757225
model parameter : 200835
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               128                 
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.507946491241455
Epoch: 1, Steps: 17 | Train Loss: 1.971 Vali Loss: 1.837 Vali Acc: 0.197 Test Loss: 1.837 Test Acc: 0.197
Validation loss decreased (inf --> -0.196513).  Saving model ...
Epoch: 2 cost time: 1.557750940322876
Epoch: 2, Steps: 17 | Train Loss: 1.707 Vali Loss: 1.610 Vali Acc: 0.301 Test Loss: 1.610 Test Acc: 0.301
Validation loss decreased (-0.196513 --> -0.300562).  Saving model ...
Epoch: 3 cost time: 1.5900804996490479
Epoch: 3, Steps: 17 | Train Loss: 1.457 Vali Loss: 1.321 Vali Acc: 0.457 Test Loss: 1.321 Test Acc: 0.457
Validation loss decreased (-0.300562 --> -0.456634).  Saving model ...
Epoch: 4 cost time: 1.529693841934204
Epoch: 4, Steps: 17 | Train Loss: 1.195 Vali Loss: 1.154 Vali Acc: 0.509 Test Loss: 1.154 Test Acc: 0.509
Validation loss decreased (-0.456634 --> -0.508659).  Saving model ...
Epoch: 5 cost time: 1.3921916484832764
Epoch: 5, Steps: 17 | Train Loss: 1.057 Vali Loss: 1.042 Vali Acc: 0.532 Test Loss: 1.042 Test Acc: 0.532
Validation loss decreased (-0.508659 --> -0.531781).  Saving model ...
Epoch: 6 cost time: 1.505993127822876
Epoch: 6, Steps: 17 | Train Loss: 0.911 Vali Loss: 0.982 Vali Acc: 0.636 Test Loss: 0.982 Test Acc: 0.636
Validation loss decreased (-0.531781 --> -0.635828).  Saving model ...
Epoch: 7 cost time: 1.5739831924438477
Epoch: 7, Steps: 17 | Train Loss: 0.852 Vali Loss: 1.107 Vali Acc: 0.543 Test Loss: 1.107 Test Acc: 0.543
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.8363640308380127
Epoch: 8, Steps: 17 | Train Loss: 0.838 Vali Loss: 1.170 Vali Acc: 0.486 Test Loss: 1.170 Test Acc: 0.486
EarlyStopping counter: 2 out of 10
Epoch: 9 cost time: 1.609541893005371
Epoch: 9, Steps: 17 | Train Loss: 0.729 Vali Loss: 0.923 Vali Acc: 0.601 Test Loss: 0.923 Test Acc: 0.601
EarlyStopping counter: 3 out of 10
Epoch: 10 cost time: 1.605492353439331
Epoch: 10, Steps: 17 | Train Loss: 0.680 Vali Loss: 0.719 Vali Acc: 0.757 Test Loss: 0.719 Test Acc: 0.757
Validation loss decreased (-0.635828 --> -0.757218).  Saving model ...
Epoch: 11 cost time: 1.5776951313018799
Epoch: 11, Steps: 17 | Train Loss: 0.531 Vali Loss: 0.678 Vali Acc: 0.746 Test Loss: 0.678 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.582519292831421
Epoch: 12, Steps: 17 | Train Loss: 0.502 Vali Loss: 0.661 Vali Acc: 0.769 Test Loss: 0.661 Test Acc: 0.769
Validation loss decreased (-0.757218 --> -0.768780).  Saving model ...
Epoch: 13 cost time: 1.6153833866119385
Epoch: 13, Steps: 17 | Train Loss: 0.391 Vali Loss: 0.729 Vali Acc: 0.734 Test Loss: 0.729 Test Acc: 0.734
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6039628982543945
Epoch: 14, Steps: 17 | Train Loss: 0.336 Vali Loss: 0.745 Vali Acc: 0.705 Test Loss: 0.745 Test Acc: 0.705
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.5395054817199707
Epoch: 15, Steps: 17 | Train Loss: 0.295 Vali Loss: 0.702 Vali Acc: 0.763 Test Loss: 0.702 Test Acc: 0.763
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7416064739227295
Epoch: 16, Steps: 17 | Train Loss: 0.217 Vali Loss: 0.618 Vali Acc: 0.821 Test Loss: 0.618 Test Acc: 0.821
Validation loss decreased (-0.768780 --> -0.820803).  Saving model ...
Epoch: 17 cost time: 1.612304925918579
Epoch: 17, Steps: 17 | Train Loss: 0.201 Vali Loss: 0.664 Vali Acc: 0.775 Test Loss: 0.664 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.5787971019744873
Epoch: 18, Steps: 17 | Train Loss: 0.150 Vali Loss: 0.611 Vali Acc: 0.798 Test Loss: 0.611 Test Acc: 0.798
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.66912841796875
Epoch: 19, Steps: 17 | Train Loss: 0.119 Vali Loss: 0.815 Vali Acc: 0.792 Test Loss: 0.815 Test Acc: 0.792
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.806298017501831
Epoch: 20, Steps: 17 | Train Loss: 0.181 Vali Loss: 0.771 Vali Acc: 0.792 Test Loss: 0.771 Test Acc: 0.792
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.6989059448242188
Epoch: 21, Steps: 17 | Train Loss: 0.068 Vali Loss: 0.727 Vali Acc: 0.798 Test Loss: 0.727 Test Acc: 0.798
EarlyStopping counter: 5 out of 10
Epoch: 22 cost time: 1.5746042728424072
Epoch: 22, Steps: 17 | Train Loss: 0.067 Vali Loss: 0.690 Vali Acc: 0.815 Test Loss: 0.690 Test Acc: 0.815
EarlyStopping counter: 6 out of 10
Epoch: 23 cost time: 1.4857690334320068
Epoch: 23, Steps: 17 | Train Loss: 0.109 Vali Loss: 0.985 Vali Acc: 0.728 Test Loss: 0.985 Test Acc: 0.728
EarlyStopping counter: 7 out of 10
Epoch: 24 cost time: 1.5946390628814697
Epoch: 24, Steps: 17 | Train Loss: 0.123 Vali Loss: 0.992 Vali Acc: 0.775 Test Loss: 0.992 Test Acc: 0.775
EarlyStopping counter: 8 out of 10
Epoch: 25 cost time: 1.7092006206512451
Epoch: 25, Steps: 17 | Train Loss: 0.115 Vali Loss: 1.181 Vali Acc: 0.746 Test Loss: 1.181 Test Acc: 0.746
EarlyStopping counter: 9 out of 10
Epoch: 26 cost time: 1.6790752410888672
Epoch: 26, Steps: 17 | Train Loss: 0.094 Vali Loss: 0.833 Vali Acc: 0.832 Test Loss: 0.833 Test Acc: 0.832
Validation loss decreased (-0.820803 --> -0.832362).  Saving model ...
Epoch: 27 cost time: 1.7461707592010498
Epoch: 27, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.873 Vali Acc: 0.832 Test Loss: 0.873 Test Acc: 0.832
EarlyStopping counter: 1 out of 10
Epoch: 28 cost time: 1.5410659313201904
Epoch: 28, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.963 Vali Acc: 0.809 Test Loss: 0.963 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 29 cost time: 1.8236801624298096
Epoch: 29, Steps: 17 | Train Loss: 0.035 Vali Loss: 0.900 Vali Acc: 0.798 Test Loss: 0.900 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 30 cost time: 1.6315550804138184
Epoch: 30, Steps: 17 | Train Loss: 0.051 Vali Loss: 0.972 Vali Acc: 0.786 Test Loss: 0.972 Test Acc: 0.786
EarlyStopping counter: 4 out of 10
Epoch: 31 cost time: 1.6166753768920898
Epoch: 31, Steps: 17 | Train Loss: 0.084 Vali Loss: 0.894 Vali Acc: 0.803 Test Loss: 0.894 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 32 cost time: 1.5945162773132324
Epoch: 32, Steps: 17 | Train Loss: 0.022 Vali Loss: 0.961 Vali Acc: 0.803 Test Loss: 0.961 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 33 cost time: 1.6764237880706787
Epoch: 33, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.925 Vali Acc: 0.809 Test Loss: 0.925 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 34 cost time: 1.5883150100708008
Epoch: 34, Steps: 17 | Train Loss: 0.032 Vali Loss: 0.920 Vali Acc: 0.827 Test Loss: 0.920 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 35 cost time: 1.505101203918457
Epoch: 35, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.798 Vali Acc: 0.832 Test Loss: 0.798 Test Acc: 0.832
Validation loss decreased (-0.832362 --> -0.832362).  Saving model ...
Epoch: 36 cost time: 1.743699312210083
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.770 Vali Acc: 0.821 Test Loss: 0.770 Test Acc: 0.821
EarlyStopping counter: 1 out of 10
Epoch: 37 cost time: 1.5984151363372803
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.823 Vali Acc: 0.821 Test Loss: 0.823 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 38 cost time: 1.5273964405059814
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.899 Vali Acc: 0.815 Test Loss: 0.899 Test Acc: 0.815
EarlyStopping counter: 3 out of 10
Epoch: 39 cost time: 1.5053400993347168
Epoch: 39, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.825 Vali Acc: 0.815 Test Loss: 0.825 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 40 cost time: 1.4885025024414062
Epoch: 40, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.816 Vali Acc: 0.821 Test Loss: 0.816 Test Acc: 0.821
EarlyStopping counter: 5 out of 10
Epoch: 41 cost time: 1.4358088970184326
Epoch: 41, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.818 Vali Acc: 0.821 Test Loss: 0.818 Test Acc: 0.821
EarlyStopping counter: 6 out of 10
Epoch: 42 cost time: 1.5192341804504395
Epoch: 42, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.840 Vali Acc: 0.821 Test Loss: 0.840 Test Acc: 0.821
EarlyStopping counter: 7 out of 10
Epoch: 43 cost time: 1.5478260517120361
Epoch: 43, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.830 Vali Acc: 0.827 Test Loss: 0.830 Test Acc: 0.827
EarlyStopping counter: 8 out of 10
Epoch: 44 cost time: 1.6943097114562988
Epoch: 44, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.863 Vali Acc: 0.809 Test Loss: 0.863 Test Acc: 0.809
EarlyStopping counter: 9 out of 10
Epoch: 45 cost time: 1.5982844829559326
Epoch: 45, Steps: 17 | Train Loss: 0.000 Vali Loss: 0.862 Vali Acc: 0.815 Test Loss: 0.862 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df128_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 200835
model size : 1.39MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              4                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.5553972721099854
Epoch: 1, Steps: 17 | Train Loss: 1.979 Vali Loss: 1.783 Vali Acc: 0.225 Test Loss: 1.783 Test Acc: 0.225
Validation loss decreased (inf --> -0.225416).  Saving model ...
Epoch: 2 cost time: 1.4592266082763672
Epoch: 2, Steps: 17 | Train Loss: 1.617 Vali Loss: 1.415 Vali Acc: 0.497 Test Loss: 1.415 Test Acc: 0.497
Validation loss decreased (-0.225416 --> -0.497096).  Saving model ...
Epoch: 3 cost time: 1.7687122821807861
Epoch: 3, Steps: 17 | Train Loss: 1.292 Vali Loss: 1.172 Vali Acc: 0.520 Test Loss: 1.172 Test Acc: 0.520
Validation loss decreased (-0.497096 --> -0.520219).  Saving model ...
Epoch: 4 cost time: 1.7154536247253418
Epoch: 4, Steps: 17 | Train Loss: 1.100 Vali Loss: 1.013 Vali Acc: 0.624 Test Loss: 1.013 Test Acc: 0.624
Validation loss decreased (-0.520219 --> -0.624267).  Saving model ...
Epoch: 5 cost time: 1.577655553817749
Epoch: 5, Steps: 17 | Train Loss: 0.924 Vali Loss: 0.910 Vali Acc: 0.682 Test Loss: 0.910 Test Acc: 0.682
Validation loss decreased (-0.624267 --> -0.682072).  Saving model ...
Epoch: 6 cost time: 1.6612017154693604
Epoch: 6, Steps: 17 | Train Loss: 0.846 Vali Loss: 0.919 Vali Acc: 0.711 Test Loss: 0.919 Test Acc: 0.711
Validation loss decreased (-0.682072 --> -0.710973).  Saving model ...
Epoch: 7 cost time: 1.6747236251831055
Epoch: 7, Steps: 17 | Train Loss: 0.728 Vali Loss: 0.847 Vali Acc: 0.601 Test Loss: 0.847 Test Acc: 0.601
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6020212173461914
Epoch: 8, Steps: 17 | Train Loss: 0.629 Vali Loss: 0.738 Vali Acc: 0.775 Test Loss: 0.738 Test Acc: 0.775
Validation loss decreased (-0.710973 --> -0.774559).  Saving model ...
Epoch: 9 cost time: 1.5338160991668701
Epoch: 9, Steps: 17 | Train Loss: 0.486 Vali Loss: 0.660 Vali Acc: 0.792 Test Loss: 0.660 Test Acc: 0.792
Validation loss decreased (-0.774559 --> -0.791901).  Saving model ...
Epoch: 10 cost time: 1.605107069015503
Epoch: 10, Steps: 17 | Train Loss: 0.456 Vali Loss: 0.631 Vali Acc: 0.827 Test Loss: 0.631 Test Acc: 0.827
Validation loss decreased (-0.791901 --> -0.826583).  Saving model ...
Epoch: 11 cost time: 1.7211201190948486
Epoch: 11, Steps: 17 | Train Loss: 0.453 Vali Loss: 0.598 Vali Acc: 0.809 Test Loss: 0.598 Test Acc: 0.809
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.577596664428711
Epoch: 12, Steps: 17 | Train Loss: 0.258 Vali Loss: 0.556 Vali Acc: 0.850 Test Loss: 0.556 Test Acc: 0.850
Validation loss decreased (-0.826583 --> -0.849705).  Saving model ...
Epoch: 13 cost time: 1.7194180488586426
Epoch: 13, Steps: 17 | Train Loss: 0.221 Vali Loss: 0.592 Vali Acc: 0.803 Test Loss: 0.592 Test Acc: 0.803
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6407334804534912
Epoch: 14, Steps: 17 | Train Loss: 0.167 Vali Loss: 0.631 Vali Acc: 0.786 Test Loss: 0.631 Test Acc: 0.786
EarlyStopping counter: 2 out of 10
Epoch: 15 cost time: 1.7299273014068604
Epoch: 15, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.631 Vali Acc: 0.803 Test Loss: 0.631 Test Acc: 0.803
EarlyStopping counter: 3 out of 10
Epoch: 16 cost time: 1.7586345672607422
Epoch: 16, Steps: 17 | Train Loss: 0.149 Vali Loss: 0.577 Vali Acc: 0.855 Test Loss: 0.577 Test Acc: 0.855
Validation loss decreased (-0.849705 --> -0.855486).  Saving model ...
Epoch: 17 cost time: 1.6291420459747314
Epoch: 17, Steps: 17 | Train Loss: 0.056 Vali Loss: 0.655 Vali Acc: 0.855 Test Loss: 0.655 Test Acc: 0.855
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7763478755950928
Epoch: 18, Steps: 17 | Train Loss: 0.087 Vali Loss: 0.688 Vali Acc: 0.821 Test Loss: 0.688 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 19 cost time: 1.8135390281677246
Epoch: 19, Steps: 17 | Train Loss: 0.029 Vali Loss: 0.693 Vali Acc: 0.798 Test Loss: 0.693 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 20 cost time: 1.6569793224334717
Epoch: 20, Steps: 17 | Train Loss: 0.025 Vali Loss: 0.747 Vali Acc: 0.809 Test Loss: 0.747 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 21 cost time: 1.9030513763427734
Epoch: 21, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.549 Vali Acc: 0.867 Test Loss: 0.549 Test Acc: 0.867
Validation loss decreased (-0.855486 --> -0.867047).  Saving model ...
Epoch: 22 cost time: 1.6211888790130615
Epoch: 22, Steps: 17 | Train Loss: 0.027 Vali Loss: 0.684 Vali Acc: 0.827 Test Loss: 0.684 Test Acc: 0.827
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.5880744457244873
Epoch: 23, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.654 Vali Acc: 0.821 Test Loss: 0.654 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.5542984008789062
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.654 Vali Acc: 0.838 Test Loss: 0.654 Test Acc: 0.838
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.558471441268921
Epoch: 25, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.618 Vali Acc: 0.832 Test Loss: 0.618 Test Acc: 0.832
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.5733299255371094
Epoch: 26, Steps: 17 | Train Loss: 0.006 Vali Loss: 0.820 Vali Acc: 0.850 Test Loss: 0.820 Test Acc: 0.850
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.7868497371673584
Epoch: 27, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.676 Vali Acc: 0.827 Test Loss: 0.676 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.701474905014038
Epoch: 28, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.736 Vali Acc: 0.844 Test Loss: 0.736 Test Acc: 0.844
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.6186754703521729
Epoch: 29, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.725 Vali Acc: 0.821 Test Loss: 0.725 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.6936368942260742
Epoch: 30, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.802 Vali Acc: 0.838 Test Loss: 0.802 Test Acc: 0.838
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.656135082244873
Epoch: 31, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.687 Vali Acc: 0.844 Test Loss: 0.687 Test Acc: 0.844
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk4_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 196739
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              3                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.477940797805786
Epoch: 1, Steps: 17 | Train Loss: 1.976 Vali Loss: 1.796 Vali Acc: 0.214 Test Loss: 1.796 Test Acc: 0.214
Validation loss decreased (inf --> -0.213855).  Saving model ...
Epoch: 2 cost time: 1.546612024307251
Epoch: 2, Steps: 17 | Train Loss: 1.612 Vali Loss: 1.416 Vali Acc: 0.491 Test Loss: 1.416 Test Acc: 0.491
Validation loss decreased (-0.213855 --> -0.491315).  Saving model ...
Epoch: 3 cost time: 1.586019515991211
Epoch: 3, Steps: 17 | Train Loss: 1.288 Vali Loss: 1.187 Vali Acc: 0.509 Test Loss: 1.187 Test Acc: 0.509
Validation loss decreased (-0.491315 --> -0.508659).  Saving model ...
Epoch: 4 cost time: 1.5022656917572021
Epoch: 4, Steps: 17 | Train Loss: 1.112 Vali Loss: 1.021 Vali Acc: 0.618 Test Loss: 1.021 Test Acc: 0.618
Validation loss decreased (-0.508659 --> -0.618487).  Saving model ...
Epoch: 5 cost time: 1.6231412887573242
Epoch: 5, Steps: 17 | Train Loss: 0.931 Vali Loss: 0.936 Vali Acc: 0.636 Test Loss: 0.936 Test Acc: 0.636
Validation loss decreased (-0.618487 --> -0.635829).  Saving model ...
Epoch: 6 cost time: 1.4467623233795166
Epoch: 6, Steps: 17 | Train Loss: 0.848 Vali Loss: 0.920 Vali Acc: 0.723 Test Loss: 0.920 Test Acc: 0.723
Validation loss decreased (-0.635829 --> -0.722534).  Saving model ...
Epoch: 7 cost time: 1.4147183895111084
Epoch: 7, Steps: 17 | Train Loss: 0.765 Vali Loss: 0.876 Vali Acc: 0.618 Test Loss: 0.876 Test Acc: 0.618
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.6303465366363525
Epoch: 8, Steps: 17 | Train Loss: 0.663 Vali Loss: 0.757 Vali Acc: 0.734 Test Loss: 0.757 Test Acc: 0.734
Validation loss decreased (-0.722534 --> -0.734096).  Saving model ...
Epoch: 9 cost time: 1.5283629894256592
Epoch: 9, Steps: 17 | Train Loss: 0.535 Vali Loss: 0.695 Vali Acc: 0.763 Test Loss: 0.695 Test Acc: 0.763
Validation loss decreased (-0.734096 --> -0.762999).  Saving model ...
Epoch: 10 cost time: 1.587876796722412
Epoch: 10, Steps: 17 | Train Loss: 0.482 Vali Loss: 0.636 Vali Acc: 0.798 Test Loss: 0.636 Test Acc: 0.798
Validation loss decreased (-0.762999 --> -0.797682).  Saving model ...
Epoch: 11 cost time: 1.766362190246582
Epoch: 11, Steps: 17 | Train Loss: 0.455 Vali Loss: 0.641 Vali Acc: 0.786 Test Loss: 0.641 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.5808055400848389
Epoch: 12, Steps: 17 | Train Loss: 0.285 Vali Loss: 0.627 Vali Acc: 0.809 Test Loss: 0.627 Test Acc: 0.809
Validation loss decreased (-0.797682 --> -0.809242).  Saving model ...
Epoch: 13 cost time: 1.577784776687622
Epoch: 13, Steps: 17 | Train Loss: 0.275 Vali Loss: 0.662 Vali Acc: 0.775 Test Loss: 0.662 Test Acc: 0.775
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6138885021209717
Epoch: 14, Steps: 17 | Train Loss: 0.176 Vali Loss: 0.553 Vali Acc: 0.827 Test Loss: 0.553 Test Acc: 0.827
Validation loss decreased (-0.809242 --> -0.826584).  Saving model ...
Epoch: 15 cost time: 1.5333526134490967
Epoch: 15, Steps: 17 | Train Loss: 0.172 Vali Loss: 0.626 Vali Acc: 0.815 Test Loss: 0.626 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7975101470947266
Epoch: 16, Steps: 17 | Train Loss: 0.182 Vali Loss: 0.799 Vali Acc: 0.809 Test Loss: 0.799 Test Acc: 0.809
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.619870901107788
Epoch: 17, Steps: 17 | Train Loss: 0.096 Vali Loss: 0.723 Vali Acc: 0.827 Test Loss: 0.723 Test Acc: 0.827
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.6421406269073486
Epoch: 18, Steps: 17 | Train Loss: 0.131 Vali Loss: 0.612 Vali Acc: 0.867 Test Loss: 0.612 Test Acc: 0.867
Validation loss decreased (-0.826584 --> -0.867046).  Saving model ...
Epoch: 19 cost time: 1.583724021911621
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.654 Vali Acc: 0.815 Test Loss: 0.654 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.7481098175048828
Epoch: 20, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.714 Vali Acc: 0.832 Test Loss: 0.714 Test Acc: 0.832
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6132500171661377
Epoch: 21, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.577 Vali Acc: 0.850 Test Loss: 0.577 Test Acc: 0.850
EarlyStopping counter: 3 out of 10
Epoch: 22 cost time: 1.610783576965332
Epoch: 22, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.588 Vali Acc: 0.850 Test Loss: 0.588 Test Acc: 0.850
EarlyStopping counter: 4 out of 10
Epoch: 23 cost time: 1.6177797317504883
Epoch: 23, Steps: 17 | Train Loss: 0.009 Vali Loss: 0.608 Vali Acc: 0.861 Test Loss: 0.608 Test Acc: 0.861
EarlyStopping counter: 5 out of 10
Epoch: 24 cost time: 1.5170776844024658
Epoch: 24, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.667 Vali Acc: 0.827 Test Loss: 0.667 Test Acc: 0.827
EarlyStopping counter: 6 out of 10
Epoch: 25 cost time: 1.8553831577301025
Epoch: 25, Steps: 17 | Train Loss: 0.026 Vali Loss: 0.725 Vali Acc: 0.815 Test Loss: 0.725 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 26 cost time: 1.687192678451538
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.671 Vali Acc: 0.844 Test Loss: 0.671 Test Acc: 0.844
EarlyStopping counter: 8 out of 10
Epoch: 27 cost time: 1.6699414253234863
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.642 Vali Acc: 0.844 Test Loss: 0.642 Test Acc: 0.844
EarlyStopping counter: 9 out of 10
Epoch: 28 cost time: 1.6958622932434082
Epoch: 28, Steps: 17 | Train Loss: 0.003 Vali Loss: 0.782 Vali Acc: 0.821 Test Loss: 0.782 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk3_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8670520231213873
model parameter : 196739
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              2                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.6023032665252686
Epoch: 1, Steps: 17 | Train Loss: 1.955 Vali Loss: 1.793 Vali Acc: 0.243 Test Loss: 1.793 Test Acc: 0.243
Validation loss decreased (inf --> -0.242757).  Saving model ...
Epoch: 2 cost time: 1.5790705680847168
Epoch: 2, Steps: 17 | Train Loss: 1.619 Vali Loss: 1.423 Vali Acc: 0.491 Test Loss: 1.423 Test Acc: 0.491
Validation loss decreased (-0.242757 --> -0.491315).  Saving model ...
Epoch: 3 cost time: 1.5137488842010498
Epoch: 3, Steps: 17 | Train Loss: 1.301 Vali Loss: 1.207 Vali Acc: 0.422 Test Loss: 1.207 Test Acc: 0.422
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.510969877243042
Epoch: 4, Steps: 17 | Train Loss: 1.143 Vali Loss: 1.043 Vali Acc: 0.555 Test Loss: 1.043 Test Acc: 0.555
Validation loss decreased (-0.491315 --> -0.554903).  Saving model ...
Epoch: 5 cost time: 1.4714221954345703
Epoch: 5, Steps: 17 | Train Loss: 0.962 Vali Loss: 0.994 Vali Acc: 0.595 Test Loss: 0.994 Test Acc: 0.595
Validation loss decreased (-0.554903 --> -0.595366).  Saving model ...
Epoch: 6 cost time: 1.5451323986053467
Epoch: 6, Steps: 17 | Train Loss: 0.885 Vali Loss: 0.980 Vali Acc: 0.659 Test Loss: 0.980 Test Acc: 0.659
Validation loss decreased (-0.595366 --> -0.658950).  Saving model ...
Epoch: 7 cost time: 1.641099214553833
Epoch: 7, Steps: 17 | Train Loss: 0.794 Vali Loss: 0.899 Vali Acc: 0.613 Test Loss: 0.899 Test Acc: 0.613
EarlyStopping counter: 1 out of 10
Epoch: 8 cost time: 1.5742993354797363
Epoch: 8, Steps: 17 | Train Loss: 0.686 Vali Loss: 0.795 Vali Acc: 0.688 Test Loss: 0.795 Test Acc: 0.688
Validation loss decreased (-0.658950 --> -0.687853).  Saving model ...
Epoch: 9 cost time: 1.7948107719421387
Epoch: 9, Steps: 17 | Train Loss: 0.577 Vali Loss: 0.698 Vali Acc: 0.751 Test Loss: 0.698 Test Acc: 0.751
Validation loss decreased (-0.687853 --> -0.751438).  Saving model ...
Epoch: 10 cost time: 1.7110483646392822
Epoch: 10, Steps: 17 | Train Loss: 0.489 Vali Loss: 0.678 Vali Acc: 0.740 Test Loss: 0.678 Test Acc: 0.740
EarlyStopping counter: 1 out of 10
Epoch: 11 cost time: 1.7199501991271973
Epoch: 11, Steps: 17 | Train Loss: 0.457 Vali Loss: 0.665 Vali Acc: 0.775 Test Loss: 0.665 Test Acc: 0.775
Validation loss decreased (-0.751438 --> -0.774560).  Saving model ...
Epoch: 12 cost time: 1.703312635421753
Epoch: 12, Steps: 17 | Train Loss: 0.318 Vali Loss: 0.673 Vali Acc: 0.751 Test Loss: 0.673 Test Acc: 0.751
EarlyStopping counter: 1 out of 10
Epoch: 13 cost time: 1.580744743347168
Epoch: 13, Steps: 17 | Train Loss: 0.289 Vali Loss: 0.655 Vali Acc: 0.769 Test Loss: 0.655 Test Acc: 0.769
EarlyStopping counter: 2 out of 10
Epoch: 14 cost time: 1.6735284328460693
Epoch: 14, Steps: 17 | Train Loss: 0.195 Vali Loss: 0.648 Vali Acc: 0.792 Test Loss: 0.648 Test Acc: 0.792
Validation loss decreased (-0.774560 --> -0.791901).  Saving model ...
Epoch: 15 cost time: 1.6701815128326416
Epoch: 15, Steps: 17 | Train Loss: 0.188 Vali Loss: 0.722 Vali Acc: 0.746 Test Loss: 0.722 Test Acc: 0.746
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.8524606227874756
Epoch: 16, Steps: 17 | Train Loss: 0.174 Vali Loss: 0.555 Vali Acc: 0.803 Test Loss: 0.555 Test Acc: 0.803
Validation loss decreased (-0.791901 --> -0.803463).  Saving model ...
Epoch: 17 cost time: 1.6755990982055664
Epoch: 17, Steps: 17 | Train Loss: 0.158 Vali Loss: 0.709 Vali Acc: 0.786 Test Loss: 0.709 Test Acc: 0.786
EarlyStopping counter: 1 out of 10
Epoch: 18 cost time: 1.7073299884796143
Epoch: 18, Steps: 17 | Train Loss: 0.118 Vali Loss: 0.667 Vali Acc: 0.827 Test Loss: 0.667 Test Acc: 0.827
Validation loss decreased (-0.803463 --> -0.826583).  Saving model ...
Epoch: 19 cost time: 1.594376564025879
Epoch: 19, Steps: 17 | Train Loss: 0.054 Vali Loss: 0.683 Vali Acc: 0.792 Test Loss: 0.683 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 20 cost time: 1.6266777515411377
Epoch: 20, Steps: 17 | Train Loss: 0.060 Vali Loss: 0.747 Vali Acc: 0.803 Test Loss: 0.747 Test Acc: 0.803
EarlyStopping counter: 2 out of 10
Epoch: 21 cost time: 1.6681528091430664
Epoch: 21, Steps: 17 | Train Loss: 0.021 Vali Loss: 0.685 Vali Acc: 0.838 Test Loss: 0.685 Test Acc: 0.838
Validation loss decreased (-0.826583 --> -0.838143).  Saving model ...
Epoch: 22 cost time: 1.6093709468841553
Epoch: 22, Steps: 17 | Train Loss: 0.017 Vali Loss: 0.752 Vali Acc: 0.815 Test Loss: 0.752 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 23 cost time: 1.728022575378418
Epoch: 23, Steps: 17 | Train Loss: 0.012 Vali Loss: 0.793 Vali Acc: 0.827 Test Loss: 0.793 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 24 cost time: 1.7922914028167725
Epoch: 24, Steps: 17 | Train Loss: 0.016 Vali Loss: 0.874 Vali Acc: 0.798 Test Loss: 0.874 Test Acc: 0.798
EarlyStopping counter: 3 out of 10
Epoch: 25 cost time: 1.8331263065338135
Epoch: 25, Steps: 17 | Train Loss: 0.036 Vali Loss: 0.893 Vali Acc: 0.815 Test Loss: 0.893 Test Acc: 0.815
EarlyStopping counter: 4 out of 10
Epoch: 26 cost time: 1.6973044872283936
Epoch: 26, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.826 Vali Acc: 0.815 Test Loss: 0.826 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 27 cost time: 1.6461238861083984
Epoch: 27, Steps: 17 | Train Loss: 0.008 Vali Loss: 0.886 Vali Acc: 0.792 Test Loss: 0.886 Test Acc: 0.792
EarlyStopping counter: 6 out of 10
Epoch: 28 cost time: 1.5450613498687744
Epoch: 28, Steps: 17 | Train Loss: 0.005 Vali Loss: 0.909 Vali Acc: 0.815 Test Loss: 0.909 Test Acc: 0.815
EarlyStopping counter: 7 out of 10
Epoch: 29 cost time: 1.5907442569732666
Epoch: 29, Steps: 17 | Train Loss: 0.005 Vali Loss: 1.040 Vali Acc: 0.798 Test Loss: 1.040 Test Acc: 0.798
EarlyStopping counter: 8 out of 10
Epoch: 30 cost time: 1.7663252353668213
Epoch: 30, Steps: 17 | Train Loss: 0.006 Vali Loss: 1.077 Vali Acc: 0.792 Test Loss: 1.077 Test Acc: 0.792
EarlyStopping counter: 9 out of 10
Epoch: 31 cost time: 1.536026954650879
Epoch: 31, Steps: 17 | Train Loss: 0.007 Vali Loss: 0.890 Vali Acc: 0.821 Test Loss: 0.890 Test Acc: 0.821
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk2_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.838150289017341
model parameter : 196739
model size : 1.37MB
Using GPU
Args in experiment:
[1mBasic Config[0m
  Task Name:          classification      Is Training:        1                   
  Model ID:           CLS_PEMS-SF         Model:              ETSformer           

[1mData Loader[0m
  Data:               UEA                 Root Path:          /data/yoom618/TSLib/dataset/PEMS-SF/
  Data Path:          ETTh1.csv           Features:           M                   
  Target:             OT                  Freq:               h                   
  Checkpoints:        /data/yoom618/TSLib/checkpoints

[1mModel Parameters[0m
  Top k:              1                   Num Kernels:        6                   
  Enc In:             963                 Dec In:             7                   
  C Out:              0                   d model:            32                  
  n heads:            8                   e layers:           1                   
  d layers:           1                   d FF:               64                  
  Moving Avg:         25                  Factor:             1                   
  Distil:             1                   Dropout:            0.1                 
  Embed:              timeF               Activation:         gelu                

[1mRun Parameters[0m
  Num Workers:        10                  Itr:                1                   
  Train Epochs:       100                 Batch Size:         16                  
  Patience:           10                  Learning Rate:      0.001               
  Des:                Exp                 Loss:               MSE                 
  Lradj:              type1               Use Amp:            0                   

[1mGPU[0m
  Use GPU:            1                   GPU:                1                   
  Use Multi GPU:      0                   Devices:            0,1,2,3             

[1mDe-stationary Projector Params[0m
  P Hidden Dims:      128, 128            P Hidden Layers:    2                   

267
173
>>>>>>>start training : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0>>>>>>>>>>>>>>>>>>>>>>>>>>
267
173
173
Epoch: 1 cost time: 3.7963125705718994
Epoch: 1, Steps: 17 | Train Loss: 1.964 Vali Loss: 1.852 Vali Acc: 0.202 Test Loss: 1.852 Test Acc: 0.202
Validation loss decreased (inf --> -0.202294).  Saving model ...
Epoch: 2 cost time: 1.6455621719360352
Epoch: 2, Steps: 17 | Train Loss: 1.697 Vali Loss: 1.517 Vali Acc: 0.509 Test Loss: 1.517 Test Acc: 0.509
Validation loss decreased (-0.202294 --> -0.508655).  Saving model ...
Epoch: 3 cost time: 1.698267936706543
Epoch: 3, Steps: 17 | Train Loss: 1.414 Vali Loss: 1.305 Vali Acc: 0.410 Test Loss: 1.305 Test Acc: 0.410
EarlyStopping counter: 1 out of 10
Epoch: 4 cost time: 1.5429658889770508
Epoch: 4, Steps: 17 | Train Loss: 1.257 Vali Loss: 1.186 Vali Acc: 0.457 Test Loss: 1.186 Test Acc: 0.457
EarlyStopping counter: 2 out of 10
Epoch: 5 cost time: 1.5219426155090332
Epoch: 5, Steps: 17 | Train Loss: 1.069 Vali Loss: 1.059 Vali Acc: 0.572 Test Loss: 1.059 Test Acc: 0.572
Validation loss decreased (-0.508655 --> -0.572244).  Saving model ...
Epoch: 6 cost time: 1.6574361324310303
Epoch: 6, Steps: 17 | Train Loss: 0.994 Vali Loss: 1.074 Vali Acc: 0.549 Test Loss: 1.074 Test Acc: 0.549
EarlyStopping counter: 1 out of 10
Epoch: 7 cost time: 1.5620265007019043
Epoch: 7, Steps: 17 | Train Loss: 0.926 Vali Loss: 1.066 Vali Acc: 0.474 Test Loss: 1.066 Test Acc: 0.474
EarlyStopping counter: 2 out of 10
Epoch: 8 cost time: 1.6206600666046143
Epoch: 8, Steps: 17 | Train Loss: 0.802 Vali Loss: 0.912 Vali Acc: 0.595 Test Loss: 0.912 Test Acc: 0.595
Validation loss decreased (-0.572244 --> -0.595367).  Saving model ...
Epoch: 9 cost time: 1.485948085784912
Epoch: 9, Steps: 17 | Train Loss: 0.708 Vali Loss: 0.792 Vali Acc: 0.665 Test Loss: 0.792 Test Acc: 0.665
Validation loss decreased (-0.595367 --> -0.664732).  Saving model ...
Epoch: 10 cost time: 1.5540149211883545
Epoch: 10, Steps: 17 | Train Loss: 0.558 Vali Loss: 0.722 Vali Acc: 0.728 Test Loss: 0.722 Test Acc: 0.728
Validation loss decreased (-0.664732 --> -0.728316).  Saving model ...
Epoch: 11 cost time: 1.5626521110534668
Epoch: 11, Steps: 17 | Train Loss: 0.566 Vali Loss: 0.767 Vali Acc: 0.728 Test Loss: 0.767 Test Acc: 0.728
EarlyStopping counter: 1 out of 10
Epoch: 12 cost time: 1.9269757270812988
Epoch: 12, Steps: 17 | Train Loss: 0.403 Vali Loss: 0.643 Vali Acc: 0.769 Test Loss: 0.643 Test Acc: 0.769
Validation loss decreased (-0.728316 --> -0.768780).  Saving model ...
Epoch: 13 cost time: 1.7823855876922607
Epoch: 13, Steps: 17 | Train Loss: 0.365 Vali Loss: 0.713 Vali Acc: 0.769 Test Loss: 0.713 Test Acc: 0.769
EarlyStopping counter: 1 out of 10
Epoch: 14 cost time: 1.6682844161987305
Epoch: 14, Steps: 17 | Train Loss: 0.277 Vali Loss: 0.601 Vali Acc: 0.809 Test Loss: 0.601 Test Acc: 0.809
Validation loss decreased (-0.768780 --> -0.809243).  Saving model ...
Epoch: 15 cost time: 1.7066633701324463
Epoch: 15, Steps: 17 | Train Loss: 0.247 Vali Loss: 0.853 Vali Acc: 0.699 Test Loss: 0.853 Test Acc: 0.699
EarlyStopping counter: 1 out of 10
Epoch: 16 cost time: 1.7744314670562744
Epoch: 16, Steps: 17 | Train Loss: 0.303 Vali Loss: 0.668 Vali Acc: 0.792 Test Loss: 0.668 Test Acc: 0.792
EarlyStopping counter: 2 out of 10
Epoch: 17 cost time: 1.7983407974243164
Epoch: 17, Steps: 17 | Train Loss: 0.180 Vali Loss: 0.688 Vali Acc: 0.769 Test Loss: 0.688 Test Acc: 0.769
EarlyStopping counter: 3 out of 10
Epoch: 18 cost time: 1.766003131866455
Epoch: 18, Steps: 17 | Train Loss: 0.186 Vali Loss: 0.701 Vali Acc: 0.780 Test Loss: 0.701 Test Acc: 0.780
EarlyStopping counter: 4 out of 10
Epoch: 19 cost time: 1.631845235824585
Epoch: 19, Steps: 17 | Train Loss: 0.114 Vali Loss: 0.622 Vali Acc: 0.803 Test Loss: 0.622 Test Acc: 0.803
EarlyStopping counter: 5 out of 10
Epoch: 20 cost time: 1.6131575107574463
Epoch: 20, Steps: 17 | Train Loss: 0.083 Vali Loss: 0.731 Vali Acc: 0.786 Test Loss: 0.731 Test Acc: 0.786
EarlyStopping counter: 6 out of 10
Epoch: 21 cost time: 1.8978312015533447
Epoch: 21, Steps: 17 | Train Loss: 0.066 Vali Loss: 0.783 Vali Acc: 0.780 Test Loss: 0.783 Test Acc: 0.780
EarlyStopping counter: 7 out of 10
Epoch: 22 cost time: 1.821545124053955
Epoch: 22, Steps: 17 | Train Loss: 0.095 Vali Loss: 0.747 Vali Acc: 0.827 Test Loss: 0.747 Test Acc: 0.827
Validation loss decreased (-0.809243 --> -0.826582).  Saving model ...
Epoch: 23 cost time: 1.6689703464508057
Epoch: 23, Steps: 17 | Train Loss: 0.040 Vali Loss: 0.708 Vali Acc: 0.827 Test Loss: 0.708 Test Acc: 0.827
Validation loss decreased (-0.826582 --> -0.826583).  Saving model ...
Epoch: 24 cost time: 1.6631135940551758
Epoch: 24, Steps: 17 | Train Loss: 0.039 Vali Loss: 0.905 Vali Acc: 0.792 Test Loss: 0.905 Test Acc: 0.792
EarlyStopping counter: 1 out of 10
Epoch: 25 cost time: 1.5622401237487793
Epoch: 25, Steps: 17 | Train Loss: 0.019 Vali Loss: 0.666 Vali Acc: 0.821 Test Loss: 0.666 Test Acc: 0.821
EarlyStopping counter: 2 out of 10
Epoch: 26 cost time: 1.797194242477417
Epoch: 26, Steps: 17 | Train Loss: 0.010 Vali Loss: 0.688 Vali Acc: 0.786 Test Loss: 0.688 Test Acc: 0.786
EarlyStopping counter: 3 out of 10
Epoch: 27 cost time: 1.6741390228271484
Epoch: 27, Steps: 17 | Train Loss: 0.018 Vali Loss: 0.767 Vali Acc: 0.809 Test Loss: 0.767 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 28 cost time: 1.5957438945770264
Epoch: 28, Steps: 17 | Train Loss: 0.014 Vali Loss: 0.842 Vali Acc: 0.815 Test Loss: 0.842 Test Acc: 0.815
EarlyStopping counter: 5 out of 10
Epoch: 29 cost time: 1.709765911102295
Epoch: 29, Steps: 17 | Train Loss: 0.013 Vali Loss: 0.810 Vali Acc: 0.832 Test Loss: 0.810 Test Acc: 0.832
Validation loss decreased (-0.826583 --> -0.832362).  Saving model ...
Epoch: 30 cost time: 1.5899899005889893
Epoch: 30, Steps: 17 | Train Loss: 0.020 Vali Loss: 0.827 Vali Acc: 0.815 Test Loss: 0.827 Test Acc: 0.815
EarlyStopping counter: 1 out of 10
Epoch: 31 cost time: 1.587341547012329
Epoch: 31, Steps: 17 | Train Loss: 0.017 Vali Loss: 1.056 Vali Acc: 0.827 Test Loss: 1.056 Test Acc: 0.827
EarlyStopping counter: 2 out of 10
Epoch: 32 cost time: 1.495572566986084
Epoch: 32, Steps: 17 | Train Loss: 0.098 Vali Loss: 0.983 Vali Acc: 0.821 Test Loss: 0.983 Test Acc: 0.821
EarlyStopping counter: 3 out of 10
Epoch: 33 cost time: 1.5319671630859375
Epoch: 33, Steps: 17 | Train Loss: 0.020 Vali Loss: 1.046 Vali Acc: 0.809 Test Loss: 1.046 Test Acc: 0.809
EarlyStopping counter: 4 out of 10
Epoch: 34 cost time: 1.4855475425720215
Epoch: 34, Steps: 17 | Train Loss: 0.022 Vali Loss: 1.157 Vali Acc: 0.792 Test Loss: 1.157 Test Acc: 0.792
EarlyStopping counter: 5 out of 10
Epoch: 35 cost time: 1.5816001892089844
Epoch: 35, Steps: 17 | Train Loss: 0.015 Vali Loss: 0.957 Vali Acc: 0.803 Test Loss: 0.957 Test Acc: 0.803
EarlyStopping counter: 6 out of 10
Epoch: 36 cost time: 1.5956134796142578
Epoch: 36, Steps: 17 | Train Loss: 0.002 Vali Loss: 0.971 Vali Acc: 0.809 Test Loss: 0.971 Test Acc: 0.809
EarlyStopping counter: 7 out of 10
Epoch: 37 cost time: 1.5294029712677002
Epoch: 37, Steps: 17 | Train Loss: 0.001 Vali Loss: 1.013 Vali Acc: 0.821 Test Loss: 1.013 Test Acc: 0.821
EarlyStopping counter: 8 out of 10
Epoch: 38 cost time: 1.535033941268921
Epoch: 38, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.986 Vali Acc: 0.803 Test Loss: 0.986 Test Acc: 0.803
EarlyStopping counter: 9 out of 10
Epoch: 39 cost time: 1.5716934204101562
Epoch: 39, Steps: 17 | Train Loss: 0.001 Vali Loss: 0.962 Vali Acc: 0.815 Test Loss: 0.962 Test Acc: 0.815
EarlyStopping counter: 10 out of 10
Early stopping
>>>>>>>testing : classification_CLS_PEMS-SF_ETSformer_UEA_ftM_sl144_ll0_pl0_dm32_nh8_el1_dl1_df64_tk1_Exp_0<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
173
test shape: torch.Size([173, 7]) torch.Size([173, 1])
accuracy:0.8323699421965318
model parameter : 196739
model size : 1.37MB
